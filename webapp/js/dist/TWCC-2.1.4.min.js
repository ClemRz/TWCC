/*!  * TWCC - Version 2.1.4
 * The World Coordinate Converter
 * Author: Clément Ronzon - clem.rz@gmail.com
 * Build date: 2018-09-26 04:09:34
 * Copyright (c) 2018 
 * Released under the AGPL-3.0 license
 *
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 Clément Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */
function d(a){var b,c;return this.length?(b=this[0],b.ownerDocument?c=b.ownerDocument:(c=b,b=c.documentElement),null==a?c.cancelFullScreen||c.webkitCancelFullScreen||c.mozCancelFullScreen?(a=!!c.fullScreen||!!c.webkitIsFullScreen||!!c.mozFullScreen,a?c.fullScreenElement||c.webkitCurrentFullScreenElement||c.mozFullScreenElement||a:a):null:(a?(a=b.requestFullScreen||b.webkitRequestFullScreen||b.mozRequestFullScreen)&&a.call(b,Element.ALLOW_KEYBOARD_INPUT):(a=c.cancelFullScreen||c.webkitCancelFullScreen||c.mozCancelFullScreen)&&a.call(c),this)):this}function cof2Obj(a){"use strict";var b,c,d,e,f,g=a.split("\n"),h=[];for(b in g)g.hasOwnProperty(b)&&(c=g[b].replace(/^\s+|\s+$/g,"").split(/\s+/),3===c.length?(d=parseFloat(c[0]),e=c[1],f=c[2]):6===c.length&&h.push({n:parseInt(c[0],10),m:parseInt(c[1],10),gnm:parseFloat(c[2]),hnm:parseFloat(c[3]),dgnm:parseFloat(c[4]),dhnm:parseFloat(c[5])}));return{epoch:d,model:e,modelDate:f,wmm:h}}function geoMagFactory(a){"use strict";function b(a){return a*(180/Math.PI)}function c(a){return a*(Math.PI/180)}var d,e,f,g,h,i,j,k=a.epoch,l=[0,0,0,0,0,0,0,0,0,0,0,0,0],m=12,n=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],o=l.slice(),p=l.slice(),q=l.slice(),r=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],s=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],t=6378.137,u=6356.7523142,v=6371.2,w=t*t,x=u*u,y=w-x,z=w*w,A=x*x,B=z-A,C=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],D=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],E=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],F=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],G=[0,2,3,4,5,6,7,8,9,10,11,12,13],H=[0,1,2,3,4,5,6,7,8,9,10,11,12];n[0][0]=0,o[0]=0,p[0]=1,q[0]=1,r[0][0]=1,e=a.wmm;for(d in e)e.hasOwnProperty(d)&&e[d].m<=e[d].n&&(C[e[d].m][e[d].n]=e[d].gnm,D[e[d].m][e[d].n]=e[d].dgnm,0!==e[d].m&&(C[e[d].n][e[d].m-1]=e[d].hnm,D[e[d].n][e[d].m-1]=e[d].dhnm));for(a=null,e=null,E[0][0]=1,f=1;m>=f;f++)for(E[0][f]=E[0][f-1]*(2*f-1)/f,h=2,g=0,j=f-g+1;j>0;j--,g++)F[g][f]=((f-1)*(f-1)-g*g)/((2*f-1)*(2*f-3)),g>0&&(i=(f-g+1)*h/(f+g),E[g][f]=E[g-1][f]*Math.sqrt(i),h=1,C[f][g-1]=E[g][f]*C[f][g-1],D[f][g-1]=E[g][f]*D[f][g-1]),C[g][f]=E[g][f]*C[g][f],D[g][f]=E[g][f]*D[g][f];return F[1][1]=0,function(a,d,e,h){function i(a){a=a||new Date;var b=a.getFullYear(),c=365+(b%400===0||b%4===0&&b%100>0?1:0),d=24*c*60*60*1e3;return a.getFullYear()+(a.valueOf()-new Date(b,0).valueOf())/d}var j,l,t,u,A,E,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=e/3280.8399||0,ab=i(h),bb=ab-k,cb=c(a),db=c(d),eb=Math.sin(db),fb=Math.sin(cb),gb=Math.cos(db),hb=Math.cos(cb),ib=fb*fb,jb=hb*hb,kb=0,lb=0,mb=0,nb=0;for(o[1]=eb,p[1]=gb,j=Math.sqrt(w-y*ib),l=_*j,t=(l+w)/(l+x)*((l+w)/(l+x)),u=fb/Math.sqrt(t*jb+ib),A=Math.sqrt(1-u*u),E=_*_+2*l+(z-B*ib)/(j*j),I=Math.sqrt(E),J=Math.sqrt(w*jb+x*ib),K=(_+J)/I,L=y*hb*fb/(I*J),g=2;m>=g;g++)o[g]=o[1]*p[g-1]+p[1]*o[g-1],p[g]=p[1]*p[g-1]-o[1]*o[g-1];for(M=v/I,N=M*M,f=1;m>=f;f++)for(N*=M,g=0,S=f+g+1;S>0;S--,g++)f===g?(r[g][f]=A*r[g-1][f-1],s[g][f]=A*s[g-1][f-1]+u*r[g-1][f-1]):1===f&&0===g?(r[g][f]=u*r[g][f-1],s[g][f]=u*s[g][f-1]-A*r[g][f-1]):f>1&&f!==g&&(g>f-2&&(r[g][f-2]=0),g>f-2&&(s[g][f-2]=0),r[g][f]=u*r[g][f-1]-F[g][f]*r[g][f-2],s[g][f]=u*s[g][f-1]-A*r[g][f-1]-F[g][f]*s[g][f-2]),n[g][f]=C[g][f]+bb*D[g][f],0!==g&&(n[f][g-1]=C[f][g-1]+bb*D[f][g-1]),O=N*r[g][f],0===g?(P=n[g][f]*p[g],Q=n[g][f]*o[g]):(P=n[g][f]*p[g]+n[f][g-1]*o[g],Q=n[g][f]*o[g]-n[f][g-1]*p[g]),lb-=N*P*s[g][f],mb+=H[g]*Q*O,kb+=G[f]*P*O,0===A&&1===g&&(q[f]=1===f?q[f-1]:u*q[f-1]-F[g][f]*q[f-2],R=N*q[f],nb+=H[g]*Q*R);return mb=0===A?nb:mb/A,T=-lb*K-kb*L,U=mb,V=lb*L-kb*K,W=Math.sqrt(T*T+U*U),X=Math.sqrt(W*W+V*V),Y=b(Math.atan2(U,T)),Z=b(Math.atan2(V,W)),Math.abs(a)>=55&&(a>0&&d>=0?$=Y-d:a>0&&0>d?$=Y+Math.abs(d):0>a&&d>=0?$=Y+d:0>a&&0>d&&($=Y-Math.abs(d)),$>180?$-=360:-180>$&&($+=360)),{dec:Y,dip:Z,ti:X,bh:W,bx:T,by:U,bz:V,lat:a,lon:d,gv:$,epoch:k}}}!function(a,b){"use strict";var c,d,e,f=a,g=f.document,h=f.navigator,i=f.setTimeout,j=f.clearTimeout,k=f.setInterval,l=f.clearInterval,m=f.getComputedStyle,n=f.encodeURIComponent,o=f.ActiveXObject,p=f.Error,q=f.Number.parseInt||f.parseInt,r=f.Number.parseFloat||f.parseFloat,s=f.Number.isNaN||f.isNaN,t=f.Date.now,u=f.Object.keys,v=f.Object.defineProperty,w=f.Object.prototype.hasOwnProperty,x=f.Array.prototype.slice,y=function(){var a=function(a){return a};if("function"==typeof f.wrap&&"function"==typeof f.unwrap)try{var b=g.createElement("div"),c=f.unwrap(b);1===b.nodeType&&c&&1===c.nodeType&&(a=f.unwrap)}catch(d){}return a}(),z=function(a){return x.call(a,0)},A=function(){var a,c,d,e,f,g,h=z(arguments),i=h[0]||{};for(a=1,c=h.length;c>a;a++)if(null!=(d=h[a]))for(e in d)w.call(d,e)&&(f=i[e],g=d[e],i!==g&&g!==b&&(i[e]=g));return i},B=function(a){var b,c,d,e;if("object"!=typeof a||null==a||"number"==typeof a.nodeType)b=a;else if("number"==typeof a.length)for(b=[],c=0,d=a.length;d>c;c++)w.call(a,c)&&(b[c]=B(a[c]));else{b={};for(e in a)w.call(a,e)&&(b[e]=B(a[e]))}return b},C=function(a,b){for(var c={},d=0,e=b.length;e>d;d++)b[d]in a&&(c[b[d]]=a[b[d]]);return c},D=function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},E=function(a){if(a)for(var b in a)w.call(a,b)&&delete a[b];return a},F=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument))do{if(a===b)return!0;a=a.parentNode}while(a);return!1},G=function(a){var b;return"string"==typeof a&&a&&(b=a.split("#")[0].split("?")[0],b=a.slice(0,a.lastIndexOf("/")+1)),b},H=function(a){var b,c;return"string"==typeof a&&a&&(c=a.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]?b=c[1]:(c=a.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]&&(b=c[1]))),b},I=function(){var a,b;try{throw new p}catch(c){b=c}return b&&(a=b.sourceURL||b.fileName||H(b.stack)),a},J=function(){var a,c,d;if(g.currentScript&&(a=g.currentScript.src))return a;if(c=g.getElementsByTagName("script"),1===c.length)return c[0].src||b;if("readyState"in c[0])for(d=c.length;d--;)if("interactive"===c[d].readyState&&(a=c[d].src))return a;return"loading"===g.readyState&&(a=c[c.length-1].src)?a:(a=I())?a:b},K=function(){var a,c,d,e=g.getElementsByTagName("script");for(a=e.length;a--;){if(!(d=e[a].src)){c=null;break}if(d=G(d),null==c)c=d;else if(c!==d){c=null;break}}return c||b},L=function(){var a=G(J())||K()||"";return a+"ZeroClipboard.swf"},M=function(){return null==a.opener&&(!!a.top&&a!=a.top||!!a.parent&&a!=a.parent)}(),N={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},O="11.0.0",P={},Q={},R=null,S=0,T=0,U={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},V=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],W=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],X=new RegExp("^flash-("+W.map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),Y=new RegExp("^flash-("+W.slice(1).map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),Z={swfPath:L(),trustedDomains:a.location.host?[a.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},$=function(a){if("object"==typeof a&&null!==a)for(var b in a)if(w.call(a,b))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(b))Z[b]=a[b];else if(null==N.bridge)if("containerId"===b||"swfObjectId"===b){if(!nb(a[b]))throw new Error("The specified `"+b+"` value is not valid as an HTML4 Element ID");Z[b]=a[b]}else Z[b]=a[b];return"string"==typeof a&&a?w.call(Z,a)?Z[a]:void 0:B(Z)},_=function(){return Tb(),{browser:C(h,["userAgent","platform","appName"]),flash:D(N,["bridge"]),zeroclipboard:{version:Vb.version,config:Vb.config()}}},ab=function(){return!!(N.disabled||N.outdated||N.sandboxed||N.unavailable||N.degraded||N.deactivated)},bb=function(a,d){var e,f,g,h={};if("string"==typeof a&&a)g=a.toLowerCase().split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof d)for(e in a)w.call(a,e)&&"string"==typeof e&&e&&"function"==typeof a[e]&&Vb.on(e,a[e]);if(g&&g.length){for(e=0,f=g.length;f>e;e++)a=g[e].replace(/^on/,""),h[a]=!0,P[a]||(P[a]=[]),P[a].push(d);if(h.ready&&N.ready&&Vb.emit({type:"ready"}),h.error){for(e=0,f=W.length;f>e;e++)if(N[W[e].replace(/^flash-/,"")]===!0){Vb.emit({type:"error",name:W[e]});break}c!==b&&Vb.version!==c&&Vb.emit({type:"error",name:"version-mismatch",jsVersion:Vb.version,swfVersion:c})}}return Vb},cb=function(a,b){var c,d,e,f,g;if(0===arguments.length)f=u(P);else if("string"==typeof a&&a)f=a.split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)w.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&Vb.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,""),g=P[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return Vb},db=function(a){var b;return b="string"==typeof a&&a?B(P[a])||null:B(P)},eb=function(a){var b,c,d;return a=ob(a),a&&!vb(a)?"ready"===a.type&&N.overdue===!0?Vb.emit({type:"error",name:"flash-overdue"}):(b=A({},a),tb.call(this,b),"copy"===a.type&&(d=Db(Q),c=d.data,R=d.formatMap),c):void 0},fb=function(){var a=N.sandboxed;if(Tb(),"boolean"!=typeof N.ready&&(N.ready=!1),N.sandboxed!==a&&N.sandboxed===!0)N.ready=!1,Vb.emit({type:"error",name:"flash-sandboxed"});else if(!Vb.isFlashUnusable()&&null===N.bridge){var b=Z.flashLoadTimeout;"number"==typeof b&&b>=0&&(S=i(function(){"boolean"!=typeof N.deactivated&&(N.deactivated=!0),N.deactivated===!0&&Vb.emit({type:"error",name:"flash-deactivated"})},b)),N.overdue=!1,Bb()}},gb=function(){Vb.clearData(),Vb.blur(),Vb.emit("destroy"),Cb(),Vb.off()},hb=function(a,b){var c;if("object"==typeof a&&a&&"undefined"==typeof b)c=a,Vb.clearData();else{if("string"!=typeof a||!a)return;c={},c[a]=b}for(var d in c)"string"==typeof d&&d&&w.call(c,d)&&"string"==typeof c[d]&&c[d]&&(Q[d]=c[d])},ib=function(a){"undefined"==typeof a?(E(Q),R=null):"string"==typeof a&&w.call(Q,a)&&delete Q[a]},jb=function(a){return"undefined"==typeof a?B(Q):"string"==typeof a&&w.call(Q,a)?Q[a]:void 0},kb=function(a){if(a&&1===a.nodeType){d&&(Lb(d,Z.activeClass),d!==a&&Lb(d,Z.hoverClass)),d=a,Kb(a,Z.hoverClass);var b=a.getAttribute("title")||Z.title;if("string"==typeof b&&b){var c=Ab(N.bridge);c&&c.setAttribute("title",b)}var e=Z.forceHandCursor===!0||"pointer"===Mb(a,"cursor");Rb(e),Qb()}},lb=function(){var a=Ab(N.bridge);a&&(a.removeAttribute("title"),a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px"),d&&(Lb(d,Z.hoverClass),Lb(d,Z.activeClass),d=null)},mb=function(){return d||null},nb=function(a){return"string"==typeof a&&a&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(a)},ob=function(a){var b;if("string"==typeof a&&a?(b=a,a={}):"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(b=a.type),b){b=b.toLowerCase(),!a.target&&(/^(copy|aftercopy|_click)$/.test(b)||"error"===b&&"clipboard-error"===a.name)&&(a.target=e),A(a,{type:b,target:a.target||d||null,relatedTarget:a.relatedTarget||null,currentTarget:N&&N.bridge||null,timeStamp:a.timeStamp||t()||null});var c=U[a.type];return"error"===a.type&&a.name&&c&&(c=c[a.name]),c&&(a.message=c),"ready"===a.type&&A(a,{target:null,version:N.version}),"error"===a.type&&(X.test(a.name)&&A(a,{target:null,minimumVersion:O}),Y.test(a.name)&&A(a,{version:N.version})),"copy"===a.type&&(a.clipboardData={setData:Vb.setData,clearData:Vb.clearData}),"aftercopy"===a.type&&(a=Eb(a,R)),a.target&&!a.relatedTarget&&(a.relatedTarget=pb(a.target)),qb(a)}},pb=function(a){var b=a&&a.getAttribute&&a.getAttribute("data-clipboard-target");return b?g.getElementById(b):null},qb=function(a){if(a&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)){var c=a.target,d="_mouseover"===a.type&&a.relatedTarget?a.relatedTarget:b,e="_mouseout"===a.type&&a.relatedTarget?a.relatedTarget:b,h=Nb(c),i=f.screenLeft||f.screenX||0,j=f.screenTop||f.screenY||0,k=g.body.scrollLeft+g.documentElement.scrollLeft,l=g.body.scrollTop+g.documentElement.scrollTop,m=h.left+("number"==typeof a._stageX?a._stageX:0),n=h.top+("number"==typeof a._stageY?a._stageY:0),o=m-k,p=n-l,q=i+o,r=j+p,s="number"==typeof a.movementX?a.movementX:0,t="number"==typeof a.movementY?a.movementY:0;delete a._stageX,delete a._stageY,A(a,{srcElement:c,fromElement:d,toElement:e,screenX:q,screenY:r,pageX:m,pageY:n,clientX:o,clientY:p,x:o,y:p,movementX:s,movementY:t,offsetX:0,offsetY:0,layerX:0,layerY:0})}return a},rb=function(a){var b=a&&"string"==typeof a.type&&a.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(b)},sb=function(a,b,c,d){d?i(function(){a.apply(b,c)},0):a.apply(b,c)},tb=function(a){if("object"==typeof a&&a&&a.type){var b=rb(a),c=P["*"]||[],d=P[a.type]||[],e=c.concat(d);if(e&&e.length){var g,h,i,j,k,l=this;for(g=0,h=e.length;h>g;g++)i=e[g],j=l,"string"==typeof i&&"function"==typeof f[i]&&(i=f[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(j=i,i=i.handleEvent),"function"==typeof i&&(k=A({},a),sb(i,j,[k],b))}return this}},ub=function(a){var b=null;return(M===!1||a&&"error"===a.type&&a.name&&-1!==V.indexOf(a.name))&&(b=!1),b},vb=function(a){var b=a.target||d||null,f="swf"===a._source;switch(delete a._source,a.type){case"error":var g="flash-sandboxed"===a.name||ub(a);"boolean"==typeof g&&(N.sandboxed=g),-1!==W.indexOf(a.name)?A(N,{disabled:"flash-disabled"===a.name,outdated:"flash-outdated"===a.name,unavailable:"flash-unavailable"===a.name,degraded:"flash-degraded"===a.name,deactivated:"flash-deactivated"===a.name,overdue:"flash-overdue"===a.name,ready:!1}):"version-mismatch"===a.name&&(c=a.swfVersion,A(N,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Pb();break;case"ready":c=a.swfVersion;var h=N.deactivated===!0;A(N,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:h,ready:!h}),Pb();break;case"beforecopy":e=b;break;case"copy":var i,j,k=a.relatedTarget;!Q["text/html"]&&!Q["text/plain"]&&k&&(j=k.value||k.outerHTML||k.innerHTML)&&(i=k.value||k.textContent||k.innerText)?(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",i),j!==i&&a.clipboardData.setData("text/html",j)):!Q["text/plain"]&&a.target&&(i=a.target.getAttribute("data-clipboard-text"))&&(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",i));break;case"aftercopy":wb(a),Vb.clearData(),b&&b!==Jb()&&b.focus&&b.focus();break;case"_mouseover":Vb.focus(b),Z.bubbleEvents===!0&&f&&(b&&b!==a.relatedTarget&&!F(a.relatedTarget,b)&&xb(A({},a,{type:"mouseenter",bubbles:!1,cancelable:!1})),xb(A({},a,{type:"mouseover"})));break;case"_mouseout":Vb.blur(),Z.bubbleEvents===!0&&f&&(b&&b!==a.relatedTarget&&!F(a.relatedTarget,b)&&xb(A({},a,{type:"mouseleave",bubbles:!1,cancelable:!1})),xb(A({},a,{type:"mouseout"})));break;case"_mousedown":Kb(b,Z.activeClass),Z.bubbleEvents===!0&&f&&xb(A({},a,{type:a.type.slice(1)}));break;case"_mouseup":Lb(b,Z.activeClass),Z.bubbleEvents===!0&&f&&xb(A({},a,{type:a.type.slice(1)}));break;case"_click":e=null,Z.bubbleEvents===!0&&f&&xb(A({},a,{type:a.type.slice(1)}));break;case"_mousemove":Z.bubbleEvents===!0&&f&&xb(A({},a,{type:a.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)?!0:void 0},wb=function(a){if(a.errors&&a.errors.length>0){var b=B(a);A(b,{type:"error",name:"clipboard-error"}),delete b.success,i(function(){Vb.emit(b)},0)}},xb=function(a){if(a&&"string"==typeof a.type&&a){var b,c=a.target||null,d=c&&c.ownerDocument||g,e={view:d.defaultView||f,canBubble:!0,cancelable:!0,detail:"click"===a.type?1:0,button:"number"==typeof a.which?a.which-1:"number"==typeof a.button?a.button:d.createEvent?0:1},h=A(e,a);c&&d.createEvent&&c.dispatchEvent&&(h=[h.type,h.canBubble,h.cancelable,h.view,h.detail,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget],b=d.createEvent("MouseEvents"),b.initMouseEvent&&(b.initMouseEvent.apply(b,h),b._source="js",c.dispatchEvent(b)))}},yb=function(){var a=Z.flashLoadTimeout;if("number"==typeof a&&a>=0){var b=Math.min(1e3,a/10),c=Z.swfObjectId+"_fallbackContent";T=k(function(){var a=g.getElementById(c);Ob(a)&&(Pb(),N.deactivated=null,Vb.emit({type:"error",name:"swf-not-found"}))},b)}},zb=function(){var a=g.createElement("div");return a.id=Z.containerId,a.className=Z.containerClass,a.style.position="absolute",a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px",a.style.zIndex=""+Sb(Z.zIndex),a},Ab=function(a){for(var b=a&&a.parentNode;b&&"OBJECT"===b.nodeName&&b.parentNode;)b=b.parentNode;return b||null},Bb=function(){var a,b=N.bridge,c=Ab(b);if(!b){var d=Ib(f.location.host,Z),e="never"===d?"none":"all",h=Gb(A({jsVersion:Vb.version},Z)),i=Z.swfPath+Fb(Z.swfPath,Z);c=zb();var j=g.createElement("div");c.appendChild(j),g.body.appendChild(c);var k=g.createElement("div"),l="activex"===N.pluginType;k.innerHTML='<object id="'+Z.swfObjectId+'" name="'+Z.swfObjectId+'" width="100%" height="100%" '+(l?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+i+'"')+">"+(l?'<param name="movie" value="'+i+'"/>':"")+'<param name="allowScriptAccess" value="'+d+'"/><param name="allowNetworking" value="'+e+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+h+'"/><div id="'+Z.swfObjectId+'_fallbackContent">&nbsp;</div></object>',b=k.firstChild,k=null,y(b).ZeroClipboard=Vb,c.replaceChild(b,j),yb()}return b||(b=g[Z.swfObjectId],b&&(a=b.length)&&(b=b[a-1]),!b&&c&&(b=c.firstChild)),N.bridge=b||null,b},Cb=function(){var a=N.bridge;if(a){var d=Ab(a);d&&("activex"===N.pluginType&&"readyState"in a?(a.style.display="none",function e(){if(4===a.readyState){for(var b in a)"function"==typeof a[b]&&(a[b]=null);a.parentNode&&a.parentNode.removeChild(a),d.parentNode&&d.parentNode.removeChild(d)}else i(e,10)}()):(a.parentNode&&a.parentNode.removeChild(a),d.parentNode&&d.parentNode.removeChild(d))),Pb(),N.ready=null,N.bridge=null,N.deactivated=null,c=b}},Db=function(a){var b={},c={};if("object"==typeof a&&a){for(var d in a)if(d&&w.call(a,d)&&"string"==typeof a[d]&&a[d])switch(d.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":b.text=a[d],c.text=d;break;case"text/html":case"html":case"air:html":case"flash:html":b.html=a[d],c.html=d;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":b.rtf=a[d],c.rtf=d}return{data:b,formatMap:c}}},Eb=function(a,b){if("object"!=typeof a||!a||"object"!=typeof b||!b)return a;var c={};for(var d in a)if(w.call(a,d))if("errors"===d){c[d]=a[d]?a[d].slice():[];for(var e=0,f=c[d].length;f>e;e++)c[d][e].format=b[c[d][e].format]}else if("success"!==d&&"data"!==d)c[d]=a[d];else{c[d]={};var g=a[d];for(var h in g)h&&w.call(g,h)&&w.call(b,h)&&(c[d][b[h]]=g[h])}return c},Fb=function(a,b){var c=null==b||b&&b.cacheBust===!0;return c?(-1===a.indexOf("?")?"?":"&")+"noCache="+t():""},Gb=function(a){var b,c,d,e,g="",h=[];if(a.trustedDomains&&("string"==typeof a.trustedDomains?e=[a.trustedDomains]:"object"==typeof a.trustedDomains&&"length"in a.trustedDomains&&(e=a.trustedDomains)),e&&e.length)for(b=0,c=e.length;c>b;b++)if(w.call(e,b)&&e[b]&&"string"==typeof e[b]){if(d=Hb(e[b]),!d)continue;if("*"===d){h.length=0,h.push(d);break}h.push.apply(h,[d,"//"+d,f.location.protocol+"//"+d])}return h.length&&(g+="trustedOrigins="+n(h.join(","))),a.forceEnhancedClipboard===!0&&(g+=(g?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof a.swfObjectId&&a.swfObjectId&&(g+=(g?"&":"")+"swfObjectId="+n(a.swfObjectId)),"string"==typeof a.jsVersion&&a.jsVersion&&(g+=(g?"&":"")+"jsVersion="+n(a.jsVersion)),g},Hb=function(a){if(null==a||""===a)return null;if(a=a.replace(/^\s+|\s+$/g,""),""===a)return null;var b=a.indexOf("//");a=-1===b?a:a.slice(b+2);var c=a.indexOf("/");return a=-1===c?a:-1===b||0===c?null:a.slice(0,c),a&&".swf"===a.slice(-4).toLowerCase()?null:a||null},Ib=function(){var a=function(a){var b,c,d,e=[];if("string"==typeof a&&(a=[a]),"object"!=typeof a||!a||"number"!=typeof a.length)return e;for(b=0,c=a.length;c>b;b++)if(w.call(a,b)&&(d=Hb(a[b]))){if("*"===d){e.length=0,e.push("*");break}-1===e.indexOf(d)&&e.push(d)}return e};return function(b,c){var d=Hb(c.swfPath);null===d&&(d=b);var e=a(c.trustedDomains),f=e.length;if(f>0){if(1===f&&"*"===e[0])return"always";if(-1!==e.indexOf(b))return 1===f&&b===d?"sameDomain":"always"}return"never"}}(),Jb=function(){try{return g.activeElement}catch(a){return null}},Kb=function(a,b){var c,d,e,f=[];if("string"==typeof b&&b&&(f=b.split(/\s+/)),a&&1===a.nodeType&&f.length>0)if(a.classList)for(c=0,d=f.length;d>c;c++)a.classList.add(f[c]);else if(a.hasOwnProperty("className")){for(e=" "+a.className+" ",c=0,d=f.length;d>c;c++)-1===e.indexOf(" "+f[c]+" ")&&(e+=f[c]+" ");a.className=e.replace(/^\s+|\s+$/g,"")}return a},Lb=function(a,b){var c,d,e,f=[];if("string"==typeof b&&b&&(f=b.split(/\s+/)),a&&1===a.nodeType&&f.length>0)if(a.classList&&a.classList.length>0)for(c=0,d=f.length;d>c;c++)a.classList.remove(f[c]);else if(a.className){for(e=(" "+a.className+" ").replace(/[\r\n\t]/g," "),c=0,d=f.length;d>c;c++)e=e.replace(" "+f[c]+" "," ");a.className=e.replace(/^\s+|\s+$/g,"")}return a},Mb=function(a,b){var c=m(a,null).getPropertyValue(b);return"cursor"!==b||c&&"auto"!==c||"A"!==a.nodeName?c:"pointer"},Nb=function(a){var b={left:0,top:0,width:0,height:0};if(a.getBoundingClientRect){var c=a.getBoundingClientRect(),d=f.pageXOffset,e=f.pageYOffset,h=g.documentElement.clientLeft||0,i=g.documentElement.clientTop||0,j=0,k=0;if("relative"===Mb(g.body,"position")){var l=g.body.getBoundingClientRect(),m=g.documentElement.getBoundingClientRect();j=l.left-m.left||0,k=l.top-m.top||0}b.left=c.left+d-h-j,b.top=c.top+e-i-k,b.width="width"in c?c.width:c.right-c.left,b.height="height"in c?c.height:c.bottom-c.top}return b},Ob=function(a){if(!a)return!1;var b=m(a,null),c=r(b.height)>0,d=r(b.width)>0,e=r(b.top)>=0,f=r(b.left)>=0,g=c&&d&&e&&f,h=g?null:Nb(a),i="none"!==b.display&&"collapse"!==b.visibility&&(g||!!h&&(c||h.height>0)&&(d||h.width>0)&&(e||h.top>=0)&&(f||h.left>=0));return i},Pb=function(){j(S),S=0,l(T),T=0},Qb=function(){var a;if(d&&(a=Ab(N.bridge))){var b=Nb(d);A(a.style,{width:b.width+"px",height:b.height+"px",top:b.top+"px",left:b.left+"px",zIndex:""+Sb(Z.zIndex)})}},Rb=function(a){N.ready===!0&&(N.bridge&&"function"==typeof N.bridge.setHandCursor?N.bridge.setHandCursor(a):N.ready=!1)},Sb=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;return"number"!=typeof a||s(a)?"string"==typeof a&&(b=Sb(q(a,10))):b=a,"number"==typeof b?b:"auto"},Tb=function(b){var c,d,e,f=N.sandboxed,g=null;if(b=b===!0,M===!1)g=!1;else{try{d=a.frameElement||null}catch(h){e={name:h.name,message:h.message}}if(d&&1===d.nodeType&&"IFRAME"===d.nodeName)try{g=d.hasAttribute("sandbox")}catch(h){g=null}else{try{c=document.domain||null}catch(h){c=null}(null===c||e&&"SecurityError"===e.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(e.message.toLowerCase()))&&(g=!0)}}return N.sandboxed=g,f===g||b||Ub(o),g},Ub=function(a){function b(a){var b=a.match(/[\d]+/g);return b.length=3,b.join(".")}function c(a){return!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a)||"chrome.plugin"===a.slice(-13))}function d(a){a&&(i=!0,a.version&&(l=b(a.version)),!l&&a.description&&(l=b(a.description)),a.filename&&(k=c(a.filename)))}var e,f,g,i=!1,j=!1,k=!1,l="";if(h.plugins&&h.plugins.length)e=h.plugins["Shockwave Flash"],d(e),h.plugins["Shockwave Flash 2.0"]&&(i=!0,l="2.0.0.11");else if(h.mimeTypes&&h.mimeTypes.length)g=h.mimeTypes["application/x-shockwave-flash"],e=g&&g.enabledPlugin,d(e);else if("undefined"!=typeof a){j=!0;try{f=new a("ShockwaveFlash.ShockwaveFlash.7"),i=!0,l=b(f.GetVariable("$version"))}catch(m){try{f=new a("ShockwaveFlash.ShockwaveFlash.6"),i=!0,l="6.0.21"}catch(n){try{f=new a("ShockwaveFlash.ShockwaveFlash"),i=!0,l=b(f.GetVariable("$version"))}catch(o){j=!1}}}}N.disabled=i!==!0,N.outdated=l&&r(l)<r(O),N.version=l||"0.0.0",N.pluginType=k?"pepper":j?"activex":i?"netscape":"unknown"};Ub(o),Tb(!0);var Vb=function(){return this instanceof Vb?void("function"==typeof Vb._createClient&&Vb._createClient.apply(this,z(arguments))):new Vb};v(Vb,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0}),Vb.config=function(){return $.apply(this,z(arguments))},Vb.state=function(){return _.apply(this,z(arguments))},Vb.isFlashUnusable=function(){return ab.apply(this,z(arguments))},Vb.on=function(){return bb.apply(this,z(arguments))},Vb.off=function(){return cb.apply(this,z(arguments))},Vb.handlers=function(){return db.apply(this,z(arguments))},Vb.emit=function(){return eb.apply(this,z(arguments))},Vb.create=function(){return fb.apply(this,z(arguments))},Vb.destroy=function(){return gb.apply(this,z(arguments))},Vb.setData=function(){return hb.apply(this,z(arguments))},Vb.clearData=function(){return ib.apply(this,z(arguments))},Vb.getData=function(){return jb.apply(this,z(arguments))},Vb.focus=Vb.activate=function(){return kb.apply(this,z(arguments))},Vb.blur=Vb.deactivate=function(){return lb.apply(this,z(arguments))},Vb.activeElement=function(){return mb.apply(this,z(arguments))};var Wb=0,Xb={},Yb=0,Zb={},$b={};A(Z,{autoActivate:!0});var _b=function(a){var b=this;b.id=""+Wb++,Xb[b.id]={instance:b,elements:[],handlers:{}},a&&b.clip(a),Vb.on("*",function(a){return b.emit(a)}),Vb.on("destroy",function(){b.destroy()}),Vb.create()},ac=function(a,d){var e,f,g,h={},i=Xb[this.id],j=i&&i.handlers;if(!i)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof a&&a)g=a.toLowerCase().split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof d)for(e in a)w.call(a,e)&&"string"==typeof e&&e&&"function"==typeof a[e]&&this.on(e,a[e]);if(g&&g.length){for(e=0,f=g.length;f>e;e++)a=g[e].replace(/^on/,""),h[a]=!0,j[a]||(j[a]=[]),j[a].push(d);if(h.ready&&N.ready&&this.emit({type:"ready",client:this}),h.error){for(e=0,f=W.length;f>e;e++)if(N[W[e].replace(/^flash-/,"")]){this.emit({type:"error",name:W[e],client:this});break}c!==b&&Vb.version!==c&&this.emit({type:"error",name:"version-mismatch",jsVersion:Vb.version,swfVersion:c})}}return this},bc=function(a,b){var c,d,e,f,g,h=Xb[this.id],i=h&&h.handlers;if(!i)return this;if(0===arguments.length)f=u(i);else if("string"==typeof a&&a)f=a.split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)w.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&this.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,""),g=i[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return this},cc=function(a){var b=null,c=Xb[this.id]&&Xb[this.id].handlers;return c&&(b="string"==typeof a&&a?c[a]?c[a].slice(0):[]:B(c)),b},dc=function(a){if(ic.call(this,a)){"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(a=A({},a));var b=A({},ob(a),{client:this});jc.call(this,b)}return this},ec=function(a){if(!Xb[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");a=kc(a);for(var b=0;b<a.length;b++)if(w.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===Zb[a[b].zcClippingId].indexOf(this.id)&&Zb[a[b].zcClippingId].push(this.id):(a[b].zcClippingId="zcClippingId_"+Yb++,Zb[a[b].zcClippingId]=[this.id],Z.autoActivate===!0&&lc(a[b]));var c=Xb[this.id]&&Xb[this.id].elements;-1===c.indexOf(a[b])&&c.push(a[b])}return this},fc=function(a){var b=Xb[this.id];if(!b)return this;var c,d=b.elements;a="undefined"==typeof a?d.slice(0):kc(a);for(var e=a.length;e--;)if(w.call(a,e)&&a[e]&&1===a[e].nodeType){for(c=0;-1!==(c=d.indexOf(a[e],c));)d.splice(c,1);var f=Zb[a[e].zcClippingId];if(f){for(c=0;-1!==(c=f.indexOf(this.id,c));)f.splice(c,1);0===f.length&&(Z.autoActivate===!0&&mc(a[e]),delete a[e].zcClippingId)}}return this},gc=function(){var a=Xb[this.id];return a&&a.elements?a.elements.slice(0):[]},hc=function(){Xb[this.id]&&(this.unclip(),this.off(),delete Xb[this.id])},ic=function(a){if(!a||!a.type)return!1;if(a.client&&a.client!==this)return!1;var b=Xb[this.id],c=b&&b.elements,d=!!c&&c.length>0,e=!a.target||d&&-1!==c.indexOf(a.target),f=a.relatedTarget&&d&&-1!==c.indexOf(a.relatedTarget),g=a.client&&a.client===this;return b&&(e||f||g)?!0:!1},jc=function(a){var b=Xb[this.id];if("object"==typeof a&&a&&a.type&&b){var c=rb(a),d=b&&b.handlers["*"]||[],e=b&&b.handlers[a.type]||[],g=d.concat(e);if(g&&g.length){var h,i,j,k,l,m=this;for(h=0,i=g.length;i>h;h++)j=g[h],k=m,"string"==typeof j&&"function"==typeof f[j]&&(j=f[j]),"object"==typeof j&&j&&"function"==typeof j.handleEvent&&(k=j,j=j.handleEvent),"function"==typeof j&&(l=A({},a),sb(j,k,[l],c))}}},kc=function(a){return"string"==typeof a&&(a=[]),"number"!=typeof a.length?[a]:a},lc=function(a){if(a&&1===a.nodeType){var b=function(a){(a||(a=f.event))&&("js"!==a._source&&(a.stopImmediatePropagation(),a.preventDefault()),delete a._source)},c=function(c){(c||(c=f.event))&&(b(c),Vb.focus(a))};a.addEventListener("mouseover",c,!1),a.addEventListener("mouseout",b,!1),a.addEventListener("mouseenter",b,!1),a.addEventListener("mouseleave",b,!1),a.addEventListener("mousemove",b,!1),$b[a.zcClippingId]={mouseover:c,mouseout:b,mouseenter:b,mouseleave:b,mousemove:b}}},mc=function(a){if(a&&1===a.nodeType){var b=$b[a.zcClippingId];if("object"==typeof b&&b){for(var c,d,e=["move","leave","enter","out","over"],f=0,g=e.length;g>f;f++)c="mouse"+e[f],d=b[c],"function"==typeof d&&a.removeEventListener(c,d,!1);delete $b[a.zcClippingId]}}};Vb._createClient=function(){_b.apply(this,z(arguments))
},Vb.prototype.on=function(){return ac.apply(this,z(arguments))},Vb.prototype.off=function(){return bc.apply(this,z(arguments))},Vb.prototype.handlers=function(){return cc.apply(this,z(arguments))},Vb.prototype.emit=function(){return dc.apply(this,z(arguments))},Vb.prototype.clip=function(){return ec.apply(this,z(arguments))},Vb.prototype.unclip=function(){return fc.apply(this,z(arguments))},Vb.prototype.elements=function(){return gc.apply(this,z(arguments))},Vb.prototype.destroy=function(){return hc.apply(this,z(arguments))},Vb.prototype.setText=function(a){if(!Xb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Vb.setData("text/plain",a),this},Vb.prototype.setHtml=function(a){if(!Xb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Vb.setData("text/html",a),this},Vb.prototype.setRichText=function(a){if(!Xb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Vb.setData("application/rtf",a),this},Vb.prototype.setData=function(){if(!Xb[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Vb.setData.apply(this,z(arguments)),this},Vb.prototype.clearData=function(){if(!Xb[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Vb.clearData.apply(this,z(arguments)),this},Vb.prototype.getData=function(){if(!Xb[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Vb.getData.apply(this,z(arguments))},"function"==typeof define&&define.amd?define(function(){return Vb}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=Vb:a.ZeroClipboard=Vb}(function(){return this||window}()),function(a){"use strict";if(void 0===window.TWCCHistory){var b,c=function(b){function c(a){var b,d;if(null===a||"object"!=typeof a)return a;b=a.constructor();for(d in a)a.hasOwnProperty(d)&&(b[d]=c(a[d]));return b}function d(){u=w.utils.getCookieContent(y),a.isEmptyObject(u)&&(u=[]),j(i())}function e(){return u}function f(){w.utils.setCookieContent(y,e())}function g(a){u=a}function h(a){x=a}function i(){return e().length-1}function j(b){v=Math.min(Math.abs(b),A),w.utils.trigger(a("body"),"history.indexchanged",{currentIndex:b,maxIndex:i(),currentValue:l()})}function k(){j(i())}function l(){return e()[v]}function m(a){u.push(a)}function n(a){return j(a),l()}function o(){g(e().slice(z,v+1))}function p(){g(e().slice(-A))}function q(a){x&&a&&(a.wgs84=c(a.wgs84),JSON.stringify(a)!==JSON.stringify(l())&&(o(),m(a),p(),k(),f()))}function r(){return v>z?n(v-1):l()}function s(){return v<i()?n(v+1):l()}function t(){d()}var u,v,w=a.extend(!0,{},b),x=!0,y=w.system.historyCookie,z=0,A=w.system.historyLimit;return t(),{toggle:h,isEnabled:function(){return x},add:q,moveToPrevious:r,moveToNext:s,getCurrentValue:l}};window.TWCCHistory={getInstance:function(a){return b=b||c(a)}}}}(jQuery),function(a,b){"use strict";function c(c,e,g){var h=new a.Deferred(function(){f(a("body"),"main.start",{name:c})});return e=e||b.system.timeout,g=g||0,setTimeout(function i(){g>0?(g--,h.notify("retry"),setTimeout(i,e)):h.reject(c+" timed out")},e),setTimeout(function j(){"pending"===h.state()&&(h.notify(c+" pending"),setTimeout(j,500))},1),d(h,c),h}function d(b,c){a.when(b).then(function(){f(a("body"),"main.succeeded",{name:c})},function(b){f(a("body"),"main.failed",{name:c,message:b})},function(b){f(a("body"),"main.progress",{name:c,message:b})})}function e(a){return b.translations.hasOwnProperty(a)?b.translations[a]:a}function f(a,b,c){a.trigger(b,{data:c})}function g(c,d,f){var g,h;return d=d?d:b.system.applicationNoreply,h=b.system.httpServer+"/"+b.system.dirWsIncludes+"s.php",g=a.ajax({type:"POST",url:h,async:!1,cache:!1,data:"ff=g"}).responseText,g.length<10?(alert(e("messageNotSent")+g),!1):(m(b.system.tokenName,g),a.post(h,{ff:"d",f:d,b:c,l:b.context.languageCode},function(a){"function"==typeof f&&f(a)}),!0)}function h(a,b,c,d){var e=k(a);e[b]=c,j(a,e,d)}function i(a,b){var c=k(a);return c[b]}function j(a,b,c){m(a,JSON.stringify(b),c)}function k(b){var c=l(b);return c?a.parseJSON(l(b)):{}}function l(b){return a.cookie(b)}function m(b,c,d){d=d||30,a.cookie(b,c,{expires:d})}function n(b,c,d,e){var f=proj4.defs(c),g=f?f.title||c:p(e,c),h='optgroup[label="'+b+'"]';d.find(h).length||d.append(a("<optgroup>",{label:b})),d.find(h).append(a("<option>",{val:c,text:g}))}function o(){var b=a("#map");b.on("linestring.edit_end",function(a,b){u(b.data)}),b.on("map.click",function(a,b){v(b.data)}),b.on("marker.drag_end",function(a,b){v(b.data)}),b.on("linestring.add_vertice",function(a,b){if(y()){var c=t();c.push(x(b.data)),w(c)}}),b.on("linestring.remove_vertice",function(a,b){if(y()){var c=x(b.data),d=t().filter(function(a){return!(a.x===c.x&&a.y===c.y)});w(d)}}),b.on("place.changed",function(a,b){v(b.data)})}function p(a,b){var c=/\+title=/gi,d=/.*\+title=([^\+]+).*/gi;return c.test(a)?a.replace(d,"$1"):b}function q(){var c="https://maps.googleapis.com/maps/api/staticmap?",d=t();if(c+="&zoom="+A(),c+="&size=640x640",c+="&visual_refresh=true",c+="&language="+b.context.languageCode,1==d.length)c+="&markers="+d[0].y+","+d[0].x;else{var e=[];a.each(d,function(a,b){e.push(b.y+","+b.x)}),c+="&path=geodesic:true|"+e.join("|")}return c+="&sensor=false"}function r(){window.open(q(),"_blank")}function s(){var a=b.math.getRandomInteger(0,K.length-1),c=K[a].lng,d=K[a].lat;return{x:c,y:d}}function t(){return I.wgs84().slice()}function u(a){w(a.map(x))}function v(a){w([x(a)])}function w(a){I.transform({wgs84:a})}function x(a){return{x:a[0],y:a[1]}}function y(){return I.csv()}function z(){return b.TWCCUi.getConvergenceConvention()}function A(){var a=b.map.getView();return a.getZoom()}function B(a){b.TWCCMap.model.setBoolean("autoZoom",a)}function C(){return J}function D(b){var c;switch(a.type(b)){case"object":c={},a.each(b,function(b,d){if(d&&"number"!==a.type(d))throw"Wrong data type";c[b]=D(d)});break;case"number":c="number"===a.type(b)?b*Math.PI/180:void 0}return c}function E(b){return"number"===a.type(b)?180*b/Math.PI:void 0}function F(){var c="*GPS (WGS84) (deg)",d={title:c,defData:"+title="+c+" +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees",isConnector:!1};"function"!==a.type(Math.sinh)&&(Math.sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2}),a.ajax({url:"/js/data/WMM.COF",cache:!0,dataType:"text"}).done(function(a){J=geoMagFactory(cof2Obj(a))}).fail(function(){J=function(){return{}}}),a.extend(proj4.WGS84,d),a.extend(proj4.defs("WGS84"),d),b.initialisers.initializeUi().done(G)}function G(){b.initialisers.initializeMap().done(H)}function H(){b.initialisers.initializeConverter().done(function(c){b.context.GET.isSetGraticule&&b.TWCCMap.setGraticule(),b.TWCCUi.startHelp(),f(a("body"),"main.ready",c)})}var I,J,K=b.locations.capitals;a.fn.extend({sort:function(){return this.pushStack([].sort.apply(this,arguments),[])},sortOptions:function(a){return jQuery("option",this).sort(a).appendTo(this),this},sortGroups:function(a){return jQuery("optgroup",this).sort(a).appendTo(this),this},sortOptionsByText:function(){return this.sortOptions(function(a,b){var c=jQuery(a).text().toUpperCase(),d=jQuery(b).text().toUpperCase();return d>c?-1:c>d?1:0})},sortOptgroupsByLabel:function(){return this.sortGroups(function(a,b){var c=jQuery(a).prop("label").toUpperCase(),d=jQuery(b).prop("label").toUpperCase();return d>c?-1:c>d?1:0})},sortGrpsNOptionsByText:function(){var b=this;return a("optgroup",this).each(function(c){a("optgroup:eq("+c+")",b).sortOptionsByText()}),this.sortOptgroupsByLabel()},getXDomain:function(c){var d=b.system.httpServer+"/"+b.system.dirWsIncludes+"proxy.php",e=c.data?"?"+a.param(c.data,!0):"";return a.ajax(a.extend({dataType:"script"},c,{url:d,cache:!0,data:{u:c.url+e}}))}}),a.extend(b,{utils:{addOptionToSelect:n,degToRad:D,enableAutoZoom:B,getConvergenceConvention:z,getCookieContent:k,getCookieParam:i,getRandomCityLocation:s,getTitleFromDefinitionString:p,getWMM:C,newDeferred:c,openStaticMap:r,radToDeg:E,sendMsg:g,setCookie:m,setCookieContent:j,setCookieParam:h,t:e,trigger:f}}),a.extend(b,{constants:{keyboard:{RETURN:13}}}),a.extend(b,{Class:function(a){var b=function(){this.initialize.apply(this,arguments)};for(var c in a)a.hasOwnProperty(c)&&(b.prototype[c]=a[c]);return b.prototype.initialize=b.prototype.initialize||function(){},b}}),a.extend(b,{initialisers:{initializeMap:function(){var c=a.extend(!0,{},b,b.TWCCMapOptions);return delete c.TWCCMapOptions,b.TWCCMap=window.TWCCMap.getInstance(c),b.map=b.TWCCMap.getMap(),o(),b.TWCCMap.promise},initializeUi:function(){var c=a.extend(!0,{},b);return b.TWCCUi=window.TWCCUi.getInstance(c),b.TWCCUi.promise},initializeConverter:function(){var c=a.extend(!0,{},b,b.TWCCConverterOptions);return delete c.TWCCConverterOptions,b.TWCCConverter=window.TWCCConverter.getInstance(c),I=b.TWCCConverter.converterWidget,b.TWCCConverter.promise}}}),a(document).ready(F)}(jQuery,App),function(a,b){"use strict";function c(a,b){var c,d,e;return c=b-a,d=a,e=Math.random()*c+d,Math.round(e)}function d(a,b){var c;return b=void 0===b?0:b,c=a.toString(),""===c||"NaN"==c?"":Math.round(e(a)*Math.pow(10,e(b)))/Math.pow(10,e(b))}function e(a){return a=a.toString().replace(/,/gi,"."),isNaN(a)&&(a=0),parseFloat(a)}a.extend(b,{math:{getRandomInteger:c,round:d,parseFloat:e}})}(jQuery,App),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(a){return a&&a.constructor===Number?a+"px":a}a.fn.bgiframe=function(c){if(c=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;",conditional:/MSIE 6\.0/.test(navigator.userAgent)},c),!a.isFunction(c.conditional)){var d=c.conditional;c.conditional=function(){return d}}var e=a('<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+c.src+'"style="display:block;position:absolute;z-index:-1;"/>');return this.each(function(){var d=a(this);if(c.conditional(this)!==!1){var f=d.children("iframe.bgiframe"),g=0===f.length?e.clone():f;g.css({top:"auto"==c.top?-1*(parseInt(d.css("borderTopWidth"),10)||0)+"px":b(c.top),left:"auto"==c.left?-1*(parseInt(d.css("borderLeftWidth"),10)||0)+"px":b(c.left),width:"auto"==c.width?this.offsetWidth+"px":b(c.width),height:"auto"==c.height?this.offsetHeight+"px":b(c.height),opacity:c.opacity===!0?0:void 0}),0===f.length&&d.prepend(g)}})},a.fn.bgIframe=a.fn.bgiframe}),jQuery.bt={version:"0.9.5-rc1"},function($){jQuery.fn.bt=function(content,options){function drawIt(a,b){for(this.moveTo(a[0].x,a[0].y),i=1;i<a.length;i++)"arcStart"==a[i-1].type?(this.quadraticCurveTo(round5(a[i].x,b),round5(a[i].y,b),round5(a[(i+1)%a.length].x,b),round5(a[(i+1)%a.length].y,b)),i++):this.lineTo(round5(a[i].x,b),round5(a[i].y,b))}function round5(a,b){var c;return b=numb(b),c=b%2?a:Math.round(a-.5)+.5}function numb(a){return parseInt(a)||0}function arrayRemove(a,b){var c,d=new Array;for(c in a)a[c]!=b&&d.push(a[c]);return d}function canvasSupport(){var a=!1;try{a=!!document.createElement("canvas").getContext("2d")}catch(b){a=!!document.createElement("canvas").getContext}return a}function shadowSupport(){try{var a=navigator.userAgent.toLowerCase();if(/webkit/.test(a))return!0;if(/gecko|mozilla/.test(a)&&parseFloat(a.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1)return!0}catch(b){}return!1}function betweenPoint(a,b,c){var d,e;return a.x==b.x?(d=a.y<b.y?a.y+c:a.y-c,{x:a.x,y:d}):a.y==b.y?(e=a.x<b.x?a.x+c:a.x-c,{x:e,y:a.y}):void 0}function centerPoint(a,b,c){var d,e,f=b.x==a.x?c.x:a.x,g=b.y==a.y?c.y:a.y;return a.x<c.x?a.y>c.y?(d=Math.PI/180*180,e=Math.PI/180*90):(d=Math.PI/180*90,e=0):a.y>c.y?(d=Math.PI/180*270,e=Math.PI/180*180):(d=0,e=Math.PI/180*270),{x:f,y:g,type:"center",startAngle:d,endAngle:e}}function findIntersect(a,b,c,d,e,f,g,h){if(e==g)return findIntersectY(a,b,c,d,e);if(f==h)return findIntersectX(a,b,c,d,f);var i=(b-d)/(a-c),j=b-i*a,k=(f-h)/(e-g),l=f-k*e,m=(l-j)/(i-k),n=i*m+j;return{x:m,y:n}}function findIntersectY(a,b,c,d,e){if(b==d)return{x:e,y:b};var f=(b-d)/(a-c),g=b-f*a,h=f*e+g;return{x:e,y:h}}function findIntersectX(a,b,c,d,e){if(a==c)return{x:a,y:e};var f=(b-d)/(a-c),g=b-f*a,h=(e-g)/f;return{x:h,y:e}}if("string"!=typeof content){var contentSelect=!0;options=content,content=!1}else var contentSelect=!1;return jQuery.fn.hoverIntent&&"hover"==jQuery.bt.defaults.trigger&&(jQuery.bt.defaults.trigger="hoverIntent"),this.each(function(index){var opts=jQuery.extend(!1,jQuery.bt.defaults,jQuery.bt.options,options);opts.spikeLength=numb(opts.spikeLength),opts.spikeGirth=numb(opts.spikeGirth),opts.overlap=numb(opts.overlap);var ajaxTimeout=!1;if(opts.killTitle&&$(this).find("[title]").addBack().each(function(){$(this).prop("bt-xTitle")||$(this).prop("bt-xTitle",$(this).prop("title")).prop("title","")}),"string"==typeof opts.tpropigger&&(opts.trigger=[opts.trigger]),"hoverIntent"==opts.trigger[0]){var hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn()},out:function(){this.btOff()}});$(this).hoverIntent(hoverOpts)}else"hover"==opts.trigger[0]?$(this).hover(function(){this.btOn()},function(){this.btOff()}):"now"==opts.trigger[0]?$(this).hasClass("bt-active")?this.btOff():this.btOn():"none"==opts.trigger[0]||(opts.trigger.length>1&&opts.trigger[0]!=opts.trigger[1]?$(this).bind(opts.trigger[0],function(){this.btOn()}).bind(opts.trigger[1],function(){this.btOff()}):$(this).bind(opts.trigger[0],function(){$(this).hasClass("bt-active")?this.btOff():this.btOn()}));this.btOn=function(){if("object"==typeof $(this).data("bt-box")&&this.btOff(),opts.preBuild.apply(this),$(jQuery.bt.vars.closeWhenOpenStack).btOff(),$(this).addClass("bt-active "+opts.activeClass),contentSelect&&null==opts.ajaxPath&&(opts.killTitle&&$(this).prop("title",$(this).prop("bt-xTitle")),content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector),opts.killTitle&&$(this).prop("title","")),null!=opts.ajaxPath&&0==content){if("object"==typeof opts.ajaxPath){var url=eval(opts.ajaxPath[0]);url+=opts.ajaxPath[1]?" "+opts.ajaxPath[1]:""}else var url=opts.ajaxPath;var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var cacheData=opts.ajaxCache?$(document.body).data("btCache-"+url.replace(/\./g,"")):null;if("string"==typeof cacheData)content=selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData;else{var target=this,ajaxOpts=jQuery.extend(!1,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(a,b){"success"==b||"notmodified"==b?(opts.ajaxCache&&$(document.body).data("btCache-"+url.replace(/\./g,""),a.responseText),ajaxTimeout=!1,content=selector?$("<div/>").append(a.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):a.responseText):("timeout"==b&&(ajaxTimeout=!0),content=opts.ajaxError.replace(/%error/g,a.statusText)),$(target).hasClass("bt-active")&&target.btOn()}},opts.ajaxOpts);jQuery.ajax(ajaxOpts),content=opts.ajaxLoading}}var shadowMarginX=0,shadowMarginY=0,shadowShiftX=0,shadowShiftY=0;if(opts.shadow&&!shadowSupport()&&(opts.shadow=!1,jQuery.extend(opts,opts.noShadowOpts)),opts.shadow&&(shadowMarginX=opts.shadowBlur>Math.abs(opts.shadowOffsetX)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetX),shadowShiftX=opts.shadowBlur-opts.shadowOffsetX>0?opts.shadowBlur-opts.shadowOffsetX:0,shadowMarginY=opts.shadowBlur>Math.abs(opts.shadowOffsetY)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetY),shadowShiftY=opts.shadowBlur-opts.shadowOffsetY>0?opts.shadowBlur-opts.shadowOffsetY:0),opts.offsetParent)var offsetParent=$(opts.offsetParent),offsetParentPos=offsetParent.offset(),pos=$(this).offset(),top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css("margin-top"))-shadowShiftY,left=numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css("margin-left"))-shadowShiftX;else var offsetParent="absolute"==$(this).css("position")?$(this).parents().eq(0).offsetParent():$(this).offsetParent(),pos=$(this).btPosition(),top=numb(pos.top)+numb($(this).css("margin-top"))-shadowShiftY,left=numb(pos.left)+numb($(this).css("margin-left"))-shadowShiftX;var width=$(this).btOuterWidth(),height=$(this).outerHeight();if("object"==typeof content){if(null==content)return;var original=content,clone=$(original).clone(!0).show(),origClones=$(original).data("bt-clones")||[];origClones.push(clone),$(original).data("bt-clones",origClones),$(clone).data("bt-orig",original),$(this).data("bt-content-orig",{original:original,clone:clone}),content=clone}if("null"!=typeof content&&""!=content){var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:"absolute",width:opts.shrinkToFit?"auto":opts.width,zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles),$box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:"absolute",width:opts.width,zIndex:opts.wrapperzIndex,visibility:"hidden"}).appendTo(offsetParent);jQuery.fn.bgiframe&&($text.bgiframe(),$box.bgiframe()),$(this).data("bt-box",$box);var scrollTop=numb($(document).scrollTop()),scrollLeft=numb($(document).scrollLeft()),docWidth=numb($(window).width()),docHeight=numb($(window).height()),winRight=scrollLeft+docWidth,winBottom=scrollTop+docHeight,space=new Object,thisOffset=$(this).offset();space.top=thisOffset.top-scrollTop,space.bottom=docHeight-(thisOffset+height-scrollTop),space.left=thisOffset.left-scrollLeft,space.right=docWidth-(thisOffset.left+width-scrollLeft);var textOutHeight=numb($text.outerHeight()),textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String&&(opts.positions=opts.positions.replace(/ /,"").split(",")),"most"==opts.positions[0]){var position="top";for(var pig in space)position=space[pig]>space[position]?pig:position}else for(var x in opts.positions){var position=opts.positions[x];if(("left"==position||"right"==position)&&space[position]>textOutWidth+opts.spikeLength)break;if(("top"==position||"bottom"==position)&&space[position]>textOutHeight+opts.spikeLength)break}var horiz=left+.5*(width-textOutWidth),vert=top+.5*(height-textOutHeight),points=new Array,textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(position){case"top":$text.css("margin-bottom",opts.spikeLength+"px"),$box.css({top:top-$text.outerHeight(!0)+opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;0>textRightSpace&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),0>textLeftSpace&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:.5*(textRight-textLeft)+xShift,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.CornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]=spikePoint;break;case"left":$text.css("margin-right",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left-$text.btOuterWidth(!0)+opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;0>textBottomSpace&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),0>textTopSpace&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint;break;case"bottom":$text.css("margin-top",opts.spikeLength+"px"),$box.css({top:top+height-opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;0>textRightSpace&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),0>textLeftSpace&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:.5*(textRight-textLeft)+xShift,y:shadowShiftY,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.cornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]=spikePoint;break;case"right":$text.css("margin-left",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left+width-opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;0>textBottomSpace&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),0>textTopSpace&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:shadowShiftX,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint}var canvas=document.createElement("canvas");if($(canvas).prop("width",numb($text.btOuterWidth(!0))+2*opts.strokeWidth+shadowMarginX).prop("height",numb($text.outerHeight(!0))+2*opts.strokeWidth+shadowMarginY).appendTo($box).css({position:"absolute",zIndex:opts.boxzIndex}),"undefined"!=typeof G_vmlCanvasManager&&(canvas=G_vmlCanvasManager.initElement(canvas)),opts.cornerRadius>0){for(var newPoints=new Array,newPoint,i=0;i<points.length;i++)"corner"==points[i].type?(newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius),newPoint.type="arcStart",newPoints[newPoints.length]=newPoint,newPoints[newPoints.length]=points[i],newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius),newPoint.type="arcEnd",newPoints[newPoints.length]=newPoint):newPoints[newPoints.length]=points[i];points=newPoints}var ctx=canvas.getContext("2d");if(opts.shadow&&opts.shadowOverlap!==!0){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case"top":opts.shadowOffsetX+opts.shadowBlur-shadowOverlap>0&&$box.css("top",numb($box.css("top"))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap));break;case"right":shadowShiftX-shadowOverlap>0&&$box.css("left",numb($box.css("left"))+shadowShiftX-shadowOverlap);break;case"bottom":shadowShiftY-shadowOverlap>0&&$box.css("top",numb($box.css("top"))+shadowShiftY-shadowOverlap);break;case"left":opts.shadowOffsetY+opts.shadowBlur-shadowOverlap>0&&$box.css("left",numb($box.css("left"))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap))}}if(drawIt.apply(ctx,[points],opts.strokeWidth),ctx.fillStyle=opts.fill,opts.shadow&&(ctx.shadowOffsetX=opts.shadowOffsetX,ctx.shadowOffsetY=opts.shadowOffsetY,ctx.shadowBlur=opts.shadowBlur,ctx.shadowColor=opts.shadowColor),ctx.closePath(),ctx.fill(),opts.strokeWidth>0&&(ctx.shadowColor="rgba(0, 0, 0, 0)",ctx.lineWidth=opts.strokeWidth,ctx.strokeStyle=opts.strokeStyle,ctx.beginPath(),drawIt.apply(ctx,[points],opts.strokeWidth),ctx.closePath(),ctx.stroke()),opts.preShow.apply(this,[$box[0]]),$box.css({display:"none",visibility:"visible"}),opts.showTip.apply(this,[$box[0]]),opts.overlay){var overlay=$('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:top,left:left,width:width,height:height,opacity:".2"}).appendTo(offsetParent);$(this).data("overlay",overlay)}(null!=opts.ajaxPath&&0==opts.ajaxCache||ajaxTimeout)&&(content=!1),opts.clickAnywhereToClose&&(jQuery.bt.vars.clickAnywhereStack.push(this),$(document).click(jQuery.bt.docClick)),opts.closeWhenOthersOpen&&jQuery.bt.vars.closeWhenOpenStack.push(this),opts.postShow.apply(this,[$box[0]])}},this.btOff=function(){var a=$(this).data("bt-box");if("undefined"!=typeof a){opts.preHide.apply(this,[a]);var b=this;b.btCleanup=function(){var a=$(b).data("bt-box"),c=$(b).data("bt-content-orig"),d=$(b).data("bt-overlay");if("object"==typeof a&&($(a).remove(),$(b).removeData("bt-box")),"object"==typeof c){var e=$(c.original).data("bt-clones");$(c).data("bt-clones",arrayRemove(e,c.clone))}"object"==typeof d&&($(d).remove(),$(b).removeData("bt-overlay")),jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,b),jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,b),$(b).removeClass("bt-active "+opts.activeClass),opts.postHide.apply(b)},opts.hideTip.apply(this,[a,b.btCleanup])}};var refresh=this.btRefresh=function(){this.btOff(),this.btOn()}})},jQuery.fn.btPosition=function(){function a(a,b){return a[0]&&parseInt(jQuery.css(a[0],b,!0),10)||0}var b;if(this[0]){var c=this.offsetParent(),d=this.offset(),e=/^body|html$/i.test(c[0].tagName)?{top:0,left:0}:c.offset();d.top-=a(this,"marginTop"),d.left-=a(this,"marginLeft"),e.top+=a(c,"borderTopWidth"),e.left+=a(c,"borderLeftWidth"),b={top:d.top-e.top,left:d.left-e.left}}return b},jQuery.fn.btOuterWidth=function(a){function b(a,b){return a[0]&&parseInt(jQuery.css(a[0],b,!0),10)||0}return this.innerWidth()+b(this,"borderLeftWidth")+b(this,"borderRightWidth")+(a?b(this,"marginLeft")+b(this,"marginRight"):0)},jQuery.fn.btOn=function(){return this.each(function(){jQuery.isFunction(this.btOn)&&this.btOn()})},jQuery.fn.btOff=function(){return this.each(function(){jQuery.isFunction(this.btOff)&&this.btOff()})},jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]},jQuery.bt.docClick=function(a){if(!a)var a=window.event;!$(a.target).parents().addBack().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length&&($(jQuery.bt.vars.clickAnywhereStack).btOff(),$(document).unbind("click",jQuery.bt.docClick))},jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:!0,closeWhenOthersOpen:!1,shrinkToFit:!1,width:"200px",padding:"10px",spikeGirth:10,spikeLength:15,overlap:0,overlay:!1,killTitle:!0,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:.5,centerPointY:.5,shadow:!1,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",contentSelector:"$(this).prop('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:!0,ajaxOpts:{},preBuild:function(){},preShow:function(){},showTip:function(a){$(a).show()},postShow:function(){},preHide:function(){},hideTip:function(a,b){$(a).hide(),b()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}},jQuery.bt.options={}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,d){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap='#"+f+"']")[0],!!g&&c(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||d:d)&&c(b)}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}function d(a){for(var b,c;a.length&&a[0]!==document;){if(b=a.css("position"),("absolute"===b||"relative"===b||"fixed"===b)&&(c=parseInt(a.css("zIndex"),10),!isNaN(c)&&0!==c))return c;a=a.parent()}return 0}function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},a.extend(this._defaults,this.regional[""]),this.regional.en=a.extend(!0,{},this.regional[""]),this.regional["en-US"]=a.extend(!0,{},this.regional.en),this.dpDiv=f(a("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
}function f(b){var c="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return b.delegate(c,"mouseout",function(){a(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate(c,"mouseover",g)}function g(){a.datepicker._isDisabledDatepicker(r.inline?r.dpDiv.parent()[0]:r.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))}function h(b,c){a.extend(b,c);for(var d in c)null==c[d]&&(b[d]=c[d]);return b}function i(a){return function(){var b=this.element.val();a.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("change")}}a.ui=a.ui||{},a.extend(a.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({scrollParent:function(b){var c=this.css("position"),d="absolute"===c,e=b?/(auto|scroll|hidden)/:/(auto|scroll)/,f=this.parents().filter(function(){var b=a(this);return d&&"static"===b.css("position")?!1:e.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&f.length?f:a(this[0].ownerDocument||document)},uniqueId:function(){var a=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(c){return b(c,!isNaN(a.attr(c,"tabindex")))},tabbable:function(c){var d=a.attr(c,"tabindex"),e=isNaN(d);return(e||d>=0)&&b(c,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(b,c){function d(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),f&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var e="Width"===c?["Left","Right"]:["Top","Bottom"],f=c.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(b){return void 0===b?g["inner"+c].call(this):this.each(function(){a(this).css(f,d(this,b)+"px")})},a.fn["outer"+c]=function(b,e){return"number"!=typeof b?g["outer"+c].call(this,b):this.each(function(){a(this).css(f,d(this,b,!0,e)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(b){if(void 0!==b)return this.css("zIndex",b);if(this.length)for(var c,d,e=a(this[0]);e.length&&e[0]!==document;){if(c=e.css("position"),("absolute"===c||"relative"===c||"fixed"===c)&&(d=parseInt(e.css("zIndex"),10),!isNaN(d)&&0!==d))return d;e=e.parent()}return 0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;f.length>e;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}};var j=0,k=Array.prototype.slice;a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{d=a._data(e,"events"),d&&d.remove&&a(e).triggerHandler("remove")}catch(g){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(b){for(var c,d,e=k.call(arguments,1),f=0,g=e.length;g>f;f++)for(c in e[f])d=e[f][c],e[f].hasOwnProperty(c)&&void 0!==d&&(b[c]=a.isPlainObject(d)?a.isPlainObject(b[c])?a.widget.extend({},b[c],d):a.widget.extend({},d):d);return b},a.widget.bridge=function(b,c){var d=c.prototype.widgetFullName||b;a.fn[b]=function(e){var f="string"==typeof e,g=k.call(arguments,1),h=this;return e=!f&&g.length?a.widget.extend.apply(null,[e].concat(g)):e,this.each(f?function(){var c,f=a.data(this,d);return"instance"===e?(h=f,!1):f?a.isFunction(f[e])&&"_"!==e.charAt(0)?(c=f[e].apply(f,g),c!==f&&void 0!==c?(h=c&&c.jquery?h.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+e+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+e+"'")}:function(){var b=a.data(this,d);b?(b.option(e||{}),b._init&&b._init()):a.data(this,d,new c(e,this))}),h}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.uuid=j++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===c&&this.destroy()}}),this.document=a(c.style?c.ownerDocument:c.document||c),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;d.length-1>f;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),b&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.unbind(c).undelegate(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.widget;var l=!1;a(document).mouseup(function(){l=!1}),a.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!l){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var c=this,d=1===b.which,e="string"==typeof this.options.cancel&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;return d&&!e&&this._mouseCapture(b)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(b)!==!1,!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return c._mouseMove(a)},this._mouseUpDelegate=function(a){return c._mouseUp(a)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),l=!0,!0)):!0}},_mouseMove:function(b){if(this._mouseMoved){if(a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button)return this._mouseUp(b);if(!b.which)return this._mouseUp(b)}return(b.which||b.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),l=!1,!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function b(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function c(b,c){return parseInt(a.css(b,c),10)||0}function d(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var e,f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(void 0!==e)return e;var b,c,d=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),f=d.children()[0];return a("body").append(d),b=f.offsetWidth,d.css("overflow","scroll"),c=f.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),e=b-c},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d||e?c.width():c.outerWidth(),height:d||e?c.height():c.outerHeight()}}},a.fn.position=function(e){if(!e||!e.of)return o.apply(this,arguments);e=a.extend({},e);var n,p,q,r,s,t,u=a(e.of),v=a.position.getWithinInfo(e.within),w=a.position.getScrollInfo(v),x=(e.collision||"flip").split(" "),y={};return t=d(u),u[0].preventDefault&&(e.at="left top"),p=t.width,q=t.height,r=t.offset,s=a.extend({},r),a.each(["my","at"],function(){var a,b,c=(e[this]||"").split(" ");1===c.length&&(c=j.test(c[0])?c.concat(["center"]):k.test(c[0])?["center"].concat(c):["center","center"]),c[0]=j.test(c[0])?c[0]:"center",c[1]=k.test(c[1])?c[1]:"center",a=l.exec(c[0]),b=l.exec(c[1]),y[this]=[a?a[0]:0,b?b[0]:0],e[this]=[m.exec(c[0])[0],m.exec(c[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?s.left+=p:"center"===e.at[0]&&(s.left+=p/2),"bottom"===e.at[1]?s.top+=q:"center"===e.at[1]&&(s.top+=q/2),n=b(y.at,p,q),s.left+=n[0],s.top+=n[1],this.each(function(){var d,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=c(this,"marginLeft"),t=c(this,"marginTop"),z=l+o+c(this,"marginRight")+w.width,A=m+t+c(this,"marginBottom")+w.height,B=a.extend({},s),C=b(y.my,k.outerWidth(),k.outerHeight());"right"===e.my[0]?B.left-=l:"center"===e.my[0]&&(B.left-=l/2),"bottom"===e.my[1]?B.top-=m:"center"===e.my[1]&&(B.top-=m/2),B.left+=C[0],B.top+=C[1],f||(B.left=i(B.left),B.top=i(B.top)),d={marginLeft:o,marginTop:t},a.each(["left","top"],function(b,c){a.ui.position[x[b]]&&a.ui.position[x[b]][c](B,{targetWidth:p,targetHeight:q,elemWidth:l,elemHeight:m,collisionPosition:d,collisionWidth:z,collisionHeight:A,offset:[n[0]+C[0],n[1]+C[1]],my:e.my,at:e.at,within:v,elem:k})}),e.using&&(j=function(a){var b=r.left-B.left,c=b+p-l,d=r.top-B.top,f=d+q-m,i={target:{element:u,left:r.left,top:r.top,width:p,height:q},element:{element:k,left:B.left,top:B.top,width:l,height:m},horizontal:0>c?"left":b>0?"right":"center",vertical:0>f?"top":d>0?"bottom":"middle"};l>p&&p>h(b+c)&&(i.horizontal="center"),m>q&&q>h(d+f)&&(i.vertical="middle"),i.important=g(h(b),h(c))>g(h(d),h(f))?"horizontal":"vertical",e.using.call(this,a,i)}),k.offset(a.extend(B,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||h(k)>c)&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||l>h(d))&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||h(k)>d)&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||l>h(c))&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,g,h=document.getElementsByTagName("body")[0],i=document.createElement("div");b=document.createElement(h?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},h&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(g in d)b.style[g]=d[g];b.appendChild(i),c=h||document.documentElement,c.insertBefore(b,c.firstChild),i.style.cssText="position: absolute; left: 10.7432222px;",e=a(i).offset().left,f=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(),a.ui.position,a.widget("ui.draggable",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(a,b){this._super(a,b),"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(b){var c=this.options;return this._blurActiveElement(b),this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(this._blockFrames(c.iframeFix===!0?"iframe":c.iframeFix),!0):!1)},_blockFrames:function(b){this.iframeBlocks=this.document.find(b).map(function(){var b=a(this);return a("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(b){var c=this.document[0];if(this.handleElement.is(b.target))try{c.activeElement&&"body"!==c.activeElement.nodeName.toLowerCase()&&a(c.activeElement).blur()}catch(d){}},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===a(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(b),this.originalPosition=this.position=this._generatePosition(b,!1),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._normalizeRightBottom(),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_refreshOffsets:function(a){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:a.pageX-this.offset.left,top:a.pageY-this.offset.top}},_mouseDrag:function(b,c){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b,!0),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1},_mouseUp:function(b){return this._unblockFrames(),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),this.handleElement.is(b.target)&&this.element.focus(),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper),e=d?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var b=this.offsetParent.offset(),c=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==c&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options,f=this.document[0];return this.relativeContainer=null,e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(f).width()-this.helperProportions.width-this.margins.left,(a(f).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*c}},_generatePosition:function(a,b){var c,d,e,f,g=this.options,h=this._isRootNode(this.scrollParent[0]),i=a.pageX,j=a.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(d=this.relativeContainer.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,a.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),a.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),a.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),a.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f),"y"===g.axis&&(i=this.originalPageX),"x"===g.axis&&(j=this.originalPageY)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d,this],!0),/^(drag|start|stop)/.test(b)&&(this.positionAbs=this._convertPositionTo("absolute"),d.offset=this.positionAbs),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c,d){var e=a.extend({},c,{item:d.element});d.sortables=[],a(d.options.connectToSortable).each(function(){var c=a(this).sortable("instance");c&&!c.options.disabled&&(d.sortables.push(c),c.refreshPositions(),c._trigger("activate",b,e))})},stop:function(b,c,d){var e=a.extend({},c,{item:d.element});d.cancelHelperRemoval=!1,a.each(d.sortables,function(){var a=this;a.isOver?(a.isOver=0,d.cancelHelperRemoval=!0,a.cancelHelperRemoval=!1,a._storedCSS={position:a.placeholder.css("position"),top:a.placeholder.css("top"),left:a.placeholder.css("left")},a._mouseStop(b),a.options.helper=a.options._helper):(a.cancelHelperRemoval=!0,a._trigger("deactivate",b,e))
})},drag:function(b,c,d){a.each(d.sortables,function(){var e=!1,f=this;f.positionAbs=d.positionAbs,f.helperProportions=d.helperProportions,f.offset.click=d.offset.click,f._intersectsWith(f.containerCache)&&(e=!0,a.each(d.sortables,function(){return this.positionAbs=d.positionAbs,this.helperProportions=d.helperProportions,this.offset.click=d.offset.click,this!==f&&this._intersectsWith(this.containerCache)&&a.contains(f.element[0],this.element[0])&&(e=!1),e})),e?(f.isOver||(f.isOver=1,f.currentItem=c.helper.appendTo(f.element).data("ui-sortable-item",!0),f.options._helper=f.options.helper,f.options.helper=function(){return c.helper[0]},b.target=f.currentItem[0],f._mouseCapture(b,!0),f._mouseStart(b,!0,!0),f.offset.click.top=d.offset.click.top,f.offset.click.left=d.offset.click.left,f.offset.parent.left-=d.offset.parent.left-f.offset.parent.left,f.offset.parent.top-=d.offset.parent.top-f.offset.parent.top,d._trigger("toSortable",b),d.dropped=f.element,a.each(d.sortables,function(){this.refreshPositions()}),d.currentItem=d.element,f.fromOutside=d),f.currentItem&&(f._mouseDrag(b),c.position=f.position)):f.isOver&&(f.isOver=0,f.cancelHelperRemoval=!0,f.options._revert=f.options.revert,f.options.revert=!1,f._trigger("out",b,f._uiHash(f)),f._mouseStop(b,!0),f.options.revert=f.options._revert,f.options.helper=f.options._helper,f.placeholder&&f.placeholder.remove(),d._refreshOffsets(b),c.position=d._generatePosition(b,!0),d._trigger("fromSortable",b),d.dropped=!1,a.each(d.sortables,function(){this.refreshPositions()}))})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c,d){var e=a("body"),f=d.options;e.css("cursor")&&(f._cursor=e.css("cursor")),e.css("cursor",f.cursor)},stop:function(b,c,d){var e=d.options;e._cursor&&a("body").css("cursor",e._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("opacity")&&(f._opacity=e.css("opacity")),e.css("opacity",f.opacity)},stop:function(b,c,d){var e=d.options;e._opacity&&a(c.helper).css("opacity",e._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1)),c.scrollParentNotHidden[0]!==c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(b,c,d){var e=d.options,f=!1,g=d.scrollParentNotHidden[0],h=d.document[0];g!==h&&"HTML"!==g.tagName?(e.axis&&"x"===e.axis||(d.overflowOffset.top+g.offsetHeight-b.pageY<e.scrollSensitivity?g.scrollTop=f=g.scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(g.scrollTop=f=g.scrollTop-e.scrollSpeed)),e.axis&&"y"===e.axis||(d.overflowOffset.left+g.offsetWidth-b.pageX<e.scrollSensitivity?g.scrollLeft=f=g.scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(g.scrollLeft=f=g.scrollLeft-e.scrollSpeed))):(e.axis&&"x"===e.axis||(b.pageY-a(h).scrollTop()<e.scrollSensitivity?f=a(h).scrollTop(a(h).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(h).scrollTop())<e.scrollSensitivity&&(f=a(h).scrollTop(a(h).scrollTop()+e.scrollSpeed))),e.axis&&"y"===e.axis||(b.pageX-a(h).scrollLeft()<e.scrollSensitivity?f=a(h).scrollLeft(a(h).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(h).scrollLeft())<e.scrollSensitivity&&(f=a(h).scrollLeft(a(h).scrollLeft()+e.scrollSpeed)))),f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c,d){var e=d.options;d.snapElements=[],a(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!==d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=d.options,p=o.snapTolerance,q=c.offset.left,r=q+d.helperProportions.width,s=c.offset.top,t=s+d.helperProportions.height;for(m=d.snapElements.length-1;m>=0;m--)i=d.snapElements[m].left-d.margins.left,j=i+d.snapElements[m].width,k=d.snapElements[m].top-d.margins.top,l=k+d.snapElements[m].height,i-p>r||q>j+p||k-p>t||s>l+p||!a.contains(d.snapElements[m].item.ownerDocument,d.snapElements[m].item)?(d.snapElements[m].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=!1):("inner"!==o.snapMode&&(e=p>=Math.abs(k-t),f=p>=Math.abs(l-s),g=p>=Math.abs(i-r),h=p>=Math.abs(j-q),e&&(c.position.top=d._convertPositionTo("relative",{top:k-d.helperProportions.height,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i-d.helperProportions.width}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j}).left)),n=e||f||g||h,"outer"!==o.snapMode&&(e=p>=Math.abs(k-s),f=p>=Math.abs(l-t),g=p>=Math.abs(i-q),h=p>=Math.abs(j-r),e&&(c.position.top=d._convertPositionTo("relative",{top:k,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l-d.helperProportions.height,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j-d.helperProportions.width}).left)),!d.snapElements[m].snapping&&(e||f||g||h||n)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=e||f||g||h||n)}}),a.ui.plugin.add("draggable","stack",{start:function(b,c,d){var e,f=d.options,g=a.makeArray(a(f.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});g.length&&(e=parseInt(a(g[0]).css("zIndex"),10)||0,a(g).each(function(b){a(this).css("zIndex",e+b)}),this.css("zIndex",e+g.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("zIndex")&&(f._zIndex=e.css("zIndex")),e.css("zIndex",f.zIndex)},stop:function(b,c,d){var e=d.options;e._zIndex&&a(c.helper).css("zIndex",e._zIndex)}}),a.ui.draggable,a.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b,c=this.options,d=c.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(d)?d:function(a){return a.is(d)},this.proportions=function(){return arguments.length?void(b=arguments[0]):b?b:b={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(c.scope),c.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(b){a.ui.ddmanager.droppables[b]=a.ui.ddmanager.droppables[b]||[],a.ui.ddmanager.droppables[b].push(this)},_splice:function(a){for(var b=0;a.length>b;b++)a[b]===this&&a.splice(b,1)},_destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];this._splice(b),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){if("accept"===b)this.accept=a.isFunction(c)?c:function(a){return a.is(c)};else if("scope"===b){var d=a.ui.ddmanager.droppables[this.options.scope];this._splice(d),this._addToManager(c)}this._super(b,c)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var c=a(this).droppable("instance");return c.options.greedy&&!c.options.disabled&&c.options.scope===d.options.scope&&c.accept.call(c.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(c,{offset:c.element.offset()}),c.options.tolerance,b)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(){function a(a,b,c){return a>=b&&b+c>a}return function(b,c,d,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left+b.margins.left,g=(b.positionAbs||b.position.absolute).top+b.margins.top,h=f+b.helperProportions.width,i=g+b.helperProportions.height,j=c.offset.left,k=c.offset.top,l=j+c.proportions().width,m=k+c.proportions().height;switch(d){case"fit":return f>=j&&l>=h&&g>=k&&m>=i;case"intersect":return f+b.helperProportions.width/2>j&&l>h-b.helperProportions.width/2&&g+b.helperProportions.height/2>k&&m>i-b.helperProportions.height/2;case"pointer":return a(e.pageY,k,c.proportions().height)&&a(e.pageX,j,c.proportions().width);case"touch":return(g>=k&&m>=g||i>=k&&m>=i||k>g&&i>m)&&(f>=j&&l>=f||h>=j&&l>=h||j>f&&h>l);default:return!1}}}(),a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;f.length>d;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;h.length>e;e++)if(h[e]===f[d].element[0]){f[d].proportions().height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions({width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight}))}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance,c)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance,c),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===e}),f.length&&(d=a(f[0]).droppable("instance"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}},a.ui.droppable,a.widget("ui.resizable",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(a){return parseInt(a,10)||0},_isNumber:function(a){return!isNaN(parseInt(a,10))},_hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;b.length>c;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=this.element.children(this.handles[c]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(b){var c,d,e,f=this.options,g=this.element;return this.resizing=!0,this._renderProxy(),c=this._num(this.helper.css("left")),d=this._num(this.helper.css("top")),f.containment&&(c+=a(f.containment).scrollLeft()||0,d+=a(f.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:c,top:d},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalPosition={left:c,top:d},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio="number"==typeof f.aspectRatio?f.aspectRatio:this.originalSize.width/this.originalSize.height||1,e=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===e?this.axis+"-resize":e),g.addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c,d,e=this.originalMousePosition,f=this.axis,g=b.pageX-e.left||0,h=b.pageY-e.top||0,i=this._change[f];return this._updatePrevProperties(),i?(c=i.apply(this,[b,g,h]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),d=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(d)||(this._updatePrevProperties(),this._trigger("resize",b,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&this._hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var a={};return this.position.top!==this.prevPosition.top&&(a.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(a.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(a.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(a.height=this.size.height+"px"),this.helper.css(a),a},_updateVirtualBoundaries:function(a){var b,c,d,e,f,g=this.options;f={minWidth:this._isNumber(g.minWidth)?g.minWidth:0,maxWidth:this._isNumber(g.maxWidth)?g.maxWidth:1/0,minHeight:this._isNumber(g.minHeight)?g.minHeight:0,maxHeight:this._isNumber(g.maxHeight)?g.maxHeight:1/0},(this._aspectRatio||a)&&(b=f.minHeight*this.aspectRatio,d=f.minWidth/this.aspectRatio,c=f.maxHeight*this.aspectRatio,e=f.maxWidth/this.aspectRatio,b>f.minWidth&&(f.minWidth=b),d>f.minHeight&&(f.minHeight=d),f.maxWidth>c&&(f.maxWidth=c),f.maxHeight>e&&(f.maxHeight=e)),this._vBoundaries=f},_updateCache:function(a){this.offset=this.helper.offset(),this._isNumber(a.left)&&(this.position.left=a.left),this._isNumber(a.top)&&(this.position.top=a.top),this._isNumber(a.height)&&(this.size.height=a.height),this._isNumber(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,c=this.size,d=this.axis;return this._isNumber(a.height)?a.width=a.height*this.aspectRatio:this._isNumber(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===d&&(a.left=b.left+(c.width-a.width),a.top=null),"nw"===d&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,c=this.axis,d=this._isNumber(a.width)&&b.maxWidth&&b.maxWidth<a.width,e=this._isNumber(a.height)&&b.maxHeight&&b.maxHeight<a.height,f=this._isNumber(a.width)&&b.minWidth&&b.minWidth>a.width,g=this._isNumber(a.height)&&b.minHeight&&b.minHeight>a.height,h=this.originalPosition.left+this.originalSize.width,i=this.position.top+this.size.height,j=/sw|nw|w/.test(c),k=/nw|ne|n/.test(c);return f&&(a.width=b.minWidth),g&&(a.height=b.minHeight),d&&(a.width=b.maxWidth),e&&(a.height=b.maxHeight),f&&j&&(a.left=h-b.minWidth),d&&j&&(a.left=h-b.maxWidth),g&&k&&(a.top=i-b.minHeight),e&&k&&(a.top=i-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_getPaddingPlusBorderDimensions:function(a){for(var b=0,c=[],d=[a.css("borderTopWidth"),a.css("borderRightWidth"),a.css("borderBottomWidth"),a.css("borderLeftWidth")],e=[a.css("paddingTop"),a.css("paddingRight"),a.css("paddingBottom"),a.css("paddingLeft")];4>b;b++)c[b]=parseInt(d[b],10)||0,c[b]+=parseInt(e[b],10)||0;return{height:c[0]+c[2],width:c[1]+c[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a,b=0,c=this.helper||this.element;this._proportionallyResizeElements.length>b;b++)a=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(a)),a.css({height:c.height()-this.outerDimensions.height||0,width:c.width()-this.outerDimensions.width||0})},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).resizable("instance"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&c._hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var b,c,d,e,f,g,h,i=a(this).resizable("instance"),j=i.options,k=i.element,l=j.containment,m=l instanceof a?l.get(0):/parent/.test(l)?k.parent().get(0):l;m&&(i.containerElement=a(m),/document/.test(l)||l===document?(i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(b=a(m),c=[],a(["Top","Right","Left","Bottom"]).each(function(a,d){c[a]=i._num(b.css("padding"+d))}),i.containerOffset=b.offset(),i.containerPosition=b.position(),i.containerSize={height:b.innerHeight()-c[3],width:b.innerWidth()-c[1]},d=i.containerOffset,e=i.containerSize.height,f=i.containerSize.width,g=i._hasScroll(m,"left")?m.scrollWidth:f,h=i._hasScroll(m)?m.scrollHeight:e,i.parentData={element:m,left:d.left,top:d.top,width:g,height:h}))},resize:function(b){var c,d,e,f,g=a(this).resizable("instance"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement,n=!0;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio,n=!1),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio,n=!1),g.position.top=g._helper?i.top:0),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f?(g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top):(g.offset.left=g.element.offset().left,g.offset.top=g.element.offset().top),c=Math.abs(g.sizeDiff.width+(g._helper?g.offset.left-l.left:g.offset.left-i.left)),d=Math.abs(g.sizeDiff.height+(g._helper?g.offset.top-l.top:g.offset.top-i.top)),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio,n=!1)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio,n=!1)),n||(g.position.left=g.prevPosition.left,g.position.top=g.prevPosition.top,g.size.width=g.prevSize.width,g.size.height=g.prevSize.height)},stop:function(){var b=a(this).resizable("instance"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).resizable("instance"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).resizable("instance"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).resizable("instance"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).resizable("instance");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).resizable("instance");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b,c=a(this).resizable("instance"),d=c.options,e=c.size,f=c.originalSize,g=c.originalPosition,h=c.axis,i="number"==typeof d.grid?[d.grid,d.grid]:d.grid,j=i[0]||1,k=i[1]||1,l=Math.round((e.width-f.width)/j)*j,m=Math.round((e.height-f.height)/k)*k,n=f.width+l,o=f.height+m,p=d.maxWidth&&n>d.maxWidth,q=d.maxHeight&&o>d.maxHeight,r=d.minWidth&&d.minWidth>n,s=d.minHeight&&d.minHeight>o;d.grid=i,r&&(n+=j),s&&(o+=k),p&&(n-=j),q&&(o-=k),/^(se|s|e)$/.test(h)?(c.size.width=n,c.size.height=o):/^(ne)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.top=g.top-m):/^(sw)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.left=g.left-l):((0>=o-k||0>=n-j)&&(b=c._getPaddingPlusBorderDimensions(this)),o-k>0?(c.size.height=o,c.position.top=g.top-m):(o=k-b.height,c.size.height=o,c.position.top=g.top+f.height-o),n-j>0?(c.size.width=n,c.position.left=g.left-l):(n=k-b.height,c.size.width=n,c.position.left=g.left+f.width-n))}}),a.ui.resizable,a.widget("ui.selectable",a.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var b,c=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){b=a(c.options.filter,c.element[0]),b.addClass("ui-selectee"),b.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=b.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(b){var c=this,d=this.options;this.opos=[b.pageX,b.pageY],this.options.disabled||(this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.pageX,top:b.pageY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||b.ctrlKey||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().addBack().each(function(){var d,e=a.data(this,"selectable-item");return e?(d=!b.metaKey&&!b.ctrlKey||!e.$element.hasClass("ui-selected"),e.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting"),e.unselecting=!d,e.selecting=d,e.selected=d,d?c._trigger("selecting",b,{selecting:e.element}):c._trigger("unselecting",b,{unselecting:e.element}),!1):void 0
}))},_mouseDrag:function(b){if(this.dragged=!0,!this.options.disabled){var c,d=this,e=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;return f>h&&(c=h,h=f,f=c),g>i&&(c=i,i=g,g=c),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var c=a.data(this,"selectable-item"),j=!1;c&&c.element!==d.element[0]&&("touch"===e.tolerance?j=!(c.left>h||f>c.right||c.top>i||g>c.bottom):"fit"===e.tolerance&&(j=c.left>f&&h>c.right&&c.top>g&&i>c.bottom),j?(c.selected&&(c.$element.removeClass("ui-selected"),c.selected=!1),c.unselecting&&(c.$element.removeClass("ui-unselecting"),c.unselecting=!1),c.selecting||(c.$element.addClass("ui-selecting"),c.selecting=!0,d._trigger("selecting",b,{selecting:c.element}))):(c.selecting&&((b.metaKey||b.ctrlKey)&&c.startselected?(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.$element.addClass("ui-selected"),c.selected=!0):(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.startselected&&(c.$element.addClass("ui-unselecting"),c.unselecting=!0),d._trigger("unselecting",b,{unselecting:c.element}))),c.selected&&(b.metaKey||b.ctrlKey||c.startselected||(c.$element.removeClass("ui-selected"),c.selected=!1,c.$element.addClass("ui-unselecting"),c.unselecting=!0,d._trigger("unselecting",b,{unselecting:c.element})))))}),!1}},_mouseStop:function(b){var c=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}}),a.widget("ui.sortable",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(a,b,c){return a>=b&&b+c>a},_isFloating:function(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(a,b){this._super(a,b),"handle"===a&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),a.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d&&(!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e))?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:b+this.helperProportions.width/2>f&&g>c-this.helperProportions.width/2&&d+this.helperProportions.height/2>h&&i>e-this.helperProportions.height/2},_intersectsWithPointer:function(a){var b="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),c="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),d=b&&c,e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return d?this.floating?f&&"right"===f||"down"===e?2:1:e&&("down"===e?2:1):!1},_intersectsWithSides:function(a){var b=this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),c=this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"===e&&c||"left"===e&&!c:d&&("down"===d&&b||"up"===d&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d]),e=f.length-1;e>=0;e--)g=a.data(f[e],this.widgetFullName),g&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;b.length>c;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){var c,d,e,f,g,h,i,j,k,l,m=null,n=null;for(c=this.containers.length-1;c>=0;c--)if(!a.contains(this.currentItem[0],this.containers[c].element[0]))if(this._intersectsWith(this.containers[c].containerCache)){if(m&&a.contains(this.containers[c].element[0],m.element[0]))continue;m=this.containers[c],n=c}else this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",b,this._uiHash(this)),this.containers[c].containerCache.over=0);if(m)if(1===this.containers.length)this.containers[n].containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1);else{for(e=1e4,f=null,k=m.floating||this._isFloating(this.currentItem),g=k?"left":"top",h=k?"width":"height",l=k?"clientX":"clientY",d=this.items.length-1;d>=0;d--)a.contains(this.containers[n].element[0],this.items[d].item[0])&&this.items[d].item[0]!==this.currentItem[0]&&(i=this.items[d].item.offset()[g],j=!1,b[l]-i>this.items[d][h]/2&&(j=!0),e>Math.abs(b[l]-i)&&(e=Math.abs(b[l]-i),f=this.items[d],this.direction=j?"up":"down"));if(!f&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[n])return void(this.currentContainer.containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash()),this.currentContainer.containerCache.over=1));f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[n].element,!0),this._trigger("change",b,this._uiHash()),this.containers[n]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[n],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!b){for(d=0;e.length>d;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var b=this.options;this.prevShow=this.prevHide=a(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),b.collapsible||b.active!==!1&&null!=b.active||(b.active=0),this._processPanels(),0>b.active&&(b.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():a()}},_createIcons:function(){var b=this.options.icons;b&&(a("<span>").addClass("ui-accordion-header-icon ui-icon "+b.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(b.header).addClass(b.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),a=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){return"active"===a?void this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b||this.options.active!==!1||this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),void("disabled"===a&&(this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!b))))},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._eventHandler(b);break;case c.HOME:f=this.headers[0];break;case c.END:f=this.headers[d-1]}f&&(a(b.target).attr("tabIndex",-1),a(f).attr("tabIndex",0),f.focus(),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().focus()},refresh:function(){var b=this.options;this._processPanels(),b.active===!1&&b.collapsible===!0||!this.headers.length?(b.active=!1,this.active=a()):b.active===!1?this._activate(0):this.active.length&&!a.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(b.active=!1,this.active=a()):this._activate(Math.max(0,b.active-1)):b.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var a=this.headers,b=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),b&&(this._off(a.not(this.headers)),this._off(b.not(this.panels)))},_refresh:function(){var b,c=this.options,d=c.heightStyle,e=this.element.parent();this.active=this._findActive(c.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var b=a(this),c=b.uniqueId().attr("id"),d=b.next(),e=d.uniqueId().attr("id");b.attr("aria-controls",e),d.attr("aria-labelledby",c)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(c.event),"fill"===d?(b=e.height(),this.element.siblings(":visible").each(function(){var c=a(this),d=c.css("position");"absolute"!==d&&"fixed"!==d&&(b-=c.outerHeight(!0))}),this.headers.each(function(){b-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,b-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===d&&(b=0,this.headers.next().each(function(){b=Math.max(b,a(this).css("height","").height())}).height(b))},_activate:function(b){var c=this._findActive(b)[0];c!==this.active[0]&&(c=c||this.active[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return"number"==typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var c={keydown:"_keydown"};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,c),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e[0]===d[0],g=f&&c.collapsible,h=g?a():e.next(),i=d.next(),j={oldHeader:d,oldPanel:i,newHeader:g?a():e,newPanel:h};
b.preventDefault(),f&&!c.collapsible||this._trigger("beforeActivate",b,j)===!1||(c.active=g?!1:this.headers.index(e),this.active=f?a():e,this._toggle(j),d.removeClass("ui-accordion-header-active ui-state-active"),c.icons&&d.children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),f||(e.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),c.icons&&e.children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),e.next().addClass("ui-accordion-content-active")))},_toggle:function(b){var c=b.newPanel,d=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=c,this.prevHide=d,this.options.animate?this._animate(c,d,b):(d.hide(),c.show(),this._toggleComplete(b)),d.attr({"aria-hidden":"true"}),d.prev().attr("aria-selected","false"),c.length&&d.length?d.prev().attr({tabIndex:-1,"aria-expanded":"false"}):c.length&&this.headers.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),c.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(a,b,c){var d,e,f,g=this,h=0,i=a.length&&(!b.length||a.index()<b.index()),j=this.options.animate||{},k=i&&j.down||j,l=function(){g._toggleComplete(c)};return"number"==typeof k&&(f=k),"string"==typeof k&&(e=k),e=e||k.easing||j.easing,f=f||k.duration||j.duration,b.length?a.length?(d=a.show().outerHeight(),b.animate(this.hideProps,{duration:f,easing:e,step:function(a,b){b.now=Math.round(a)}}),void a.hide().animate(this.showProps,{duration:f,easing:e,complete:l,step:function(a,c){c.now=Math.round(a),"height"!==c.prop?h+=c.now:"content"!==g.options.heightStyle&&(c.now=Math.round(d-b.outerHeight()-h),h=0)}})):b.animate(this.hideProps,f,e,l):a.animate(this.showProps,f,e,l)},_toggleComplete:function(a){var b=a.oldPanel;b.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,a)}}),a.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(a){a.preventDefault()},"click .ui-menu-item":function(b){var c=a(b.target);!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.select(b),b.isPropagationStopped()||(this.mouseHandled=!0),c.has(".ui-menu").length?this.expand(b):!this.element.is(":focus")&&a(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){if(!this.previousFilter){var c=a(b.currentTarget);c.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.find(this.options.items).eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&this.collapseAll(a),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){var c,d,e,f,g=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:g=!1,d=this.previousFilter||"",e=String.fromCharCode(b.keyCode),f=!1,clearTimeout(this.filterTimer),e===d?f=!0:e=d+e,c=this._filterMenuItems(e),c=f&&-1!==c.index(this.active.next())?this.active.nextAll(".ui-menu-item"):c,c.length||(e=String.fromCharCode(b.keyCode),c=this._filterMenuItems(e)),c.length?(this.focus(b,c),this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}g&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(a):this.select(a))},refresh:function(){var b,c,d=this,e=this.options.icons.submenu,f=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),f.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),c=b.parent(),d=a("<span>").addClass("ui-menu-icon ui-icon "+e).data("ui-menu-submenu-carat",!0);c.attr("aria-haspopup","true").prepend(d),b.attr("aria-labelledby",c.attr("id"))}),b=f.add(this.element),c=b.find(this.options.items),c.not(".ui-menu-item").each(function(){var b=a(this);d._isDivider(b)&&b.addClass("ui-widget-content ui-menu-divider")}),c.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),c.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),"disabled"===a&&this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.outerHeight(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(b){return!a(b.target).closest(".ui-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.find(this.options.items)[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),0>c.offset().top-d-e}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items).first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)},_filterMenuItems:function(b){var c=b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),d=RegExp("^"+c,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return d.test(a.trim(a(this).text()))})}}),a.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=f?!0:g?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,void(c=!0);b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault());if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),void this._change(a))}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(d){d.target===b.element[0]||d.target===c||a.contains(c,d.target)||b.close()})})},menufocus:function(b,c){var d,e;return this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)})):(e=c.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",b,{item:e})&&b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(e.value),d=c.item.attr("aria-label")||e.value,void(d&&a.trim(d).length&&(this.liveRegion.children().hide(),a("<div>").text(d).appendTo(this.liveRegion))))},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item"),d=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d,this.selectedItem=c})),!1!==this._trigger("select",a,{item:c})&&this._value(c.value),this.term=this._value(),this.close(a),this.selectedItem=c}}),this.liveRegion=a("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b&&b[0]||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){var b=this.term===this._value(),c=this.menu.element.is(":visible"),d=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;(!b||b&&!c&&!d)&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):this._trigger("search",b)!==!1?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var b=++this.requestIndex;return a.proxy(function(a){b===this.requestIndex&&this.__response(a),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({},b,{label:b.label||b.value,value:b.value||b.label})})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").text(c.label).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(b){var c;this._superApply(arguments),this.options.disabled||this.cancelSearch||(c=b&&b.length?this.options.messages.results(b.length):this.options.messages.noResults,this.liveRegion.children().hide(),a("<div>").text(c).appendTo(this.liveRegion))}}),a.ui.autocomplete;var m,n="ui-button ui-widget ui-state-default ui-corner-all",o="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",p=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},q=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"'][type=radio]"):a("[name='"+c+"'][type=radio]",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,p),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,c=this.options,d="checkbox"===this.type||"radio"===this.type,e=d?"":"ui-state-active";null===c.label&&(c.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(n).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){c.disabled||this===m&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){c.disabled||a(this).removeClass(e)}).bind("click"+this.eventNamespace,function(a){c.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),d&&this.element.bind("change"+this.eventNamespace,function(){b.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return c.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(c.disabled)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var d=b.element[0];q(d).not(d).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return c.disabled?!1:(a(this).addClass("ui-state-active"),m=this,void b.document.one("mouseup",function(){m=null}))}).bind("mouseup"+this.eventNamespace,function(){return c.disabled?!1:void a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){return c.disabled?!1:void((b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",c.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(n+" ui-state-active "+o).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(this.widget().toggleClass("ui-state-disabled",!!b),this.element.prop("disabled",!!b),void(b&&this.buttonElement.removeClass("checkbox"===this.type||"radio"===this.type?"ui-state-focus":"ui-state-focus ui-state-active"))):void this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?q(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var b=this.buttonElement.removeClass(o),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction"),c=this.element.find(this.options.items),d=c.filter(":ui-button");c.not(":ui-button").button(),d.button("refresh"),this.buttons=c.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),a.ui.button,a.extend(a.ui,{datepicker:{version:"1.11.2"}});var r;a.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return h(this._defaults,a||{}),this},_attachDatepicker:function(b,c){var d,e,f;d=b.nodeName.toLowerCase(),e="div"===d||"span"===d,b.id||(this.uuid+=1,b.id="dp"+this.uuid),f=this._newInst(a(b),e),f.settings=a.extend({},c||{}),"input"===d?this._connectDatepicker(b,f):e&&this._inlineDatepicker(b,f)},_newInst:function(b,c){var d=b[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:d,input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:c?f(a("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(b,c){var d=a(b);c.append=a([]),c.trigger=a([]),d.hasClass(this.markerClassName)||(this._attachments(d,c),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(c),a.data(b,"datepicker",c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var d,e,f,g=this._get(c,"appendText"),h=this._get(c,"isRTL");c.append&&c.append.remove(),g&&(c.append=a("<span class='"+this._appendClass+"'>"+g+"</span>"),b[h?"before":"after"](c.append)),b.unbind("focus",this._showDatepicker),c.trigger&&c.trigger.remove(),d=this._get(c,"showOn"),("focus"===d||"both"===d)&&b.focus(this._showDatepicker),("button"===d||"both"===d)&&(e=this._get(c,"buttonText"),f=this._get(c,"buttonImage"),c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:f,alt:e,title:e}):a("<button type='button'></button>").addClass(this._triggerClass).html(f?a("<img/>").attr({src:f,alt:e,title:e}):e)),b[h?"before":"after"](c.trigger),c.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput===b[0]?a.datepicker._hideDatepicker():a.datepicker._datepickerShowing&&a.datepicker._lastInput!==b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1}))},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=this._get(a,"dateFormat");g.match(/[DM]/)&&(b=function(a){for(c=0,d=0,e=0;a.length>e;e++)a[e].length>c&&(c=a[e].length,d=e);return d},f.setMonth(b(this._get(a,g.match(/MM/)?"monthNames":"monthNamesShort"))),f.setDate(b(this._get(a,g.match(/DD/)?"dayNames":"dayNamesShort"))+20-f.getDay())),a.input.attr("size",this._formatDate(a,f).length)}},_inlineDatepicker:function(b,c){var d=a(b);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(c.dpDiv),a.data(b,"datepicker",c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&this._disableDatepicker(b),c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,d,e,f){var g,i,j,k,l,m=this._dialogInst;return m||(this.uuid+=1,g="dp"+this.uuid,this._dialogInput=a("<input type='text' id='"+g+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),m=this._dialogInst=this._newInst(this._dialogInput,!1),m.settings={},a.data(this._dialogInput[0],"datepicker",m)),h(m.settings,e||{}),c=c&&c.constructor===Date?this._formatDate(m,c):c,this._dialogInput.val(c),this._pos=f?f.length?f:[f.pageX,f.pageY]:null,this._pos||(i=document.documentElement.clientWidth,j=document.documentElement.clientHeight,k=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[i/2-100+k,j/2-150+l]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),m.settings.onSelect=d,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],"datepicker",m),this},_destroyDatepicker:function(b){var c,d=a(b),e=a.data(b,"datepicker");d.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),a.removeData(b,"datepicker"),"input"===c?(e.append.remove(),e.trigger.remove(),d.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===c||"span"===c)&&d.removeClass(this.markerClassName).empty())},_enableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,"datepicker");e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!1,f.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().removeClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}))},_disableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,"datepicker");e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!0,f.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().addClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}),this._disabledInputs[this._disabledInputs.length]=b)},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;this._disabledInputs.length>b;b++)if(this._disabledInputs[b]===a)return!0;return!1},_getInst:function(b){try{return a.data(b,"datepicker")}catch(c){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(b,c,d){var e,f,g,i,j=this._getInst(b);
return 2===arguments.length&&"string"==typeof c?"defaults"===c?a.extend({},a.datepicker._defaults):j?"all"===c?a.extend({},j.settings):this._get(j,c):null:(e=c||{},"string"==typeof c&&(e={},e[c]=d),void(j&&(this._curInst===j&&this._hideDatepicker(),f=this._getDateDatepicker(b,!0),g=this._getMinMaxDate(j,"min"),i=this._getMinMaxDate(j,"max"),h(j.settings,e),null!==g&&void 0!==e.dateFormat&&void 0===e.minDate&&(j.settings.minDate=this._formatDate(j,g)),null!==i&&void 0!==e.dateFormat&&void 0===e.maxDate&&(j.settings.maxDate=this._formatDate(j,i)),"disabled"in e&&(e.disabled?this._disableDatepicker(b):this._enableDatepicker(b)),this._attachments(a(b),j),this._autoSize(j),this._setDate(j,f),this._updateAlternate(j),this._updateDatepicker(j))))},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(b){var c,d,e,f=a.datepicker._getInst(b.target),g=!0,h=f.dpDiv.is(".ui-datepicker-rtl");if(f._keyEvent=!0,a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker(),g=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",f.dpDiv),e[0]&&a.datepicker._selectDay(b.target,f.selectedMonth,f.selectedYear,e[0]),c=a.datepicker._get(f,"onSelect"),c?(d=a.datepicker._formatDate(f),c.apply(f.input?f.input[0]:null,[d,f])):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target),g=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target),g=b.ctrlKey||b.metaKey;break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?1:-1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D"),g=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?-1:1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D"),g=b.ctrlKey||b.metaKey;break;default:g=!1}else 36===b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):g=!1;g&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(b){var c,d,e=a.datepicker._getInst(b.target);return a.datepicker._get(e,"constrainInput")?(c=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),d=String.fromCharCode(null==b.charCode?b.keyCode:b.charCode),b.ctrlKey||b.metaKey||" ">d||!c||c.indexOf(d)>-1):void 0},_doKeyUp:function(b){var c,d=a.datepicker._getInst(b.target);if(d.input.val()!==d.lastVal)try{c=a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,a.datepicker._getFormatConfig(d)),c&&(a.datepicker._setDateFromField(d),a.datepicker._updateAlternate(d),a.datepicker._updateDatepicker(d))}catch(e){}return!0},_showDatepicker:function(b){if(b=b.target||b,"input"!==b.nodeName.toLowerCase()&&(b=a("input",b.parentNode)[0]),!a.datepicker._isDisabledDatepicker(b)&&a.datepicker._lastInput!==b){var c,e,f,g,i,j,k;c=a.datepicker._getInst(b),a.datepicker._curInst&&a.datepicker._curInst!==c&&(a.datepicker._curInst.dpDiv.stop(!0,!0),c&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0])),e=a.datepicker._get(c,"beforeShow"),f=e?e.apply(b,[b,c]):{},f!==!1&&(h(c.settings,f),c.lastVal=null,a.datepicker._lastInput=b,a.datepicker._setDateFromField(c),a.datepicker._inDialog&&(b.value=""),a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight),g=!1,a(b).parents().each(function(){return g|="fixed"===a(this).css("position"),!g}),i={left:a.datepicker._pos[0],top:a.datepicker._pos[1]},a.datepicker._pos=null,c.dpDiv.empty(),c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),a.datepicker._updateDatepicker(c),i=a.datepicker._checkOffset(c,i,g),c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":g?"fixed":"absolute",display:"none",left:i.left+"px",top:i.top+"px"}),c.inline||(j=a.datepicker._get(c,"showAnim"),k=a.datepicker._get(c,"duration"),c.dpDiv.css("z-index",d(a(b))+1),a.datepicker._datepickerShowing=!0,a.effects&&a.effects.effect[j]?c.dpDiv.show(j,a.datepicker._get(c,"showOptions"),k):c.dpDiv[j||"show"](j?k:null),a.datepicker._shouldFocusInput(c)&&c.input.focus(),a.datepicker._curInst=c))}},_updateDatepicker:function(b){this.maxRows=4,r=b,b.dpDiv.empty().append(this._generateHTML(b)),this._attachHandlers(b);var c,d=this._getNumberOfMonths(b),e=d[1],f=17,h=b.dpDiv.find("."+this._dayOverClass+" a");h.length>0&&g.apply(h.get(0)),b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),e>1&&b.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",f*e+"em"),b.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),b===a.datepicker._curInst&&a.datepicker._datepickerShowing&&a.datepicker._shouldFocusInput(b)&&b.input.focus(),b.yearshtml&&(c=b.yearshtml,setTimeout(function(){c===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml),c=b.yearshtml=null},0))},_shouldFocusInput:function(a){return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(b,c,d){var e=b.dpDiv.outerWidth(),f=b.dpDiv.outerHeight(),g=b.input?b.input.outerWidth():0,h=b.input?b.input.outerHeight():0,i=document.documentElement.clientWidth+(d?0:a(document).scrollLeft()),j=document.documentElement.clientHeight+(d?0:a(document).scrollTop());return c.left-=this._get(b,"isRTL")?e-g:0,c.left-=d&&c.left===b.input.offset().left?a(document).scrollLeft():0,c.top-=d&&c.top===b.input.offset().top+h?a(document).scrollTop():0,c.left-=Math.min(c.left,c.left+e>i&&i>e?Math.abs(c.left+e-i):0),c.top-=Math.min(c.top,c.top+f>j&&j>f?Math.abs(f+h):0),c},_findPos:function(b){for(var c,d=this._getInst(b),e=this._get(d,"isRTL");b&&("hidden"===b.type||1!==b.nodeType||a.expr.filters.hidden(b));)b=b[e?"previousSibling":"nextSibling"];return c=a(b).offset(),[c.left,c.top]},_hideDatepicker:function(b){var c,d,e,f,g=this._curInst;!g||b&&g!==a.data(b,"datepicker")||this._datepickerShowing&&(c=this._get(g,"showAnim"),d=this._get(g,"duration"),e=function(){a.datepicker._tidyDialog(g)},a.effects&&(a.effects.effect[c]||a.effects[c])?g.dpDiv.hide(c,a.datepicker._get(g,"showOptions"),d,e):g.dpDiv["slideDown"===c?"slideUp":"fadeIn"===c?"fadeOut":"hide"](c?d:null,e),c||e(),this._datepickerShowing=!1,f=this._get(g,"onClose"),f&&f.apply(g.input?g.input[0]:null,[g.input?g.input.val():"",g]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){var c=a(b.target),d=a.datepicker._getInst(c[0]);(c[0].id!==a.datepicker._mainDivId&&0===c.parents("#"+a.datepicker._mainDivId).length&&!c.hasClass(a.datepicker.markerClassName)&&!c.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||c.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!==d)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,d){var e=a(b),f=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(f,c+("M"===d?this._get(f,"showCurrentAtPos"):0),d),this._updateDatepicker(f))},_gotoToday:function(b){var c,d=a(b),e=this._getInst(d[0]);this._get(e,"gotoCurrent")&&e.currentDay?(e.selectedDay=e.currentDay,e.drawMonth=e.selectedMonth=e.currentMonth,e.drawYear=e.selectedYear=e.currentYear):(c=new Date,e.selectedDay=c.getDate(),e.drawMonth=e.selectedMonth=c.getMonth(),e.drawYear=e.selectedYear=c.getFullYear()),this._notifyChange(e),this._adjustDate(d)},_selectMonthYear:function(b,c,d){var e=a(b),f=this._getInst(e[0]);f["selected"+("M"===d?"Month":"Year")]=f["draw"+("M"===d?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10),this._notifyChange(f),this._adjustDate(e)},_selectDay:function(b,c,d,e){var f,g=a(b);a(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(g[0])||(f=this._getInst(g[0]),f.selectedDay=f.currentDay=a("a",e).html(),f.selectedMonth=f.currentMonth=c,f.selectedYear=f.currentYear=d,this._selectDate(b,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(b){var c=a(b);this._selectDate(c,"")},_selectDate:function(b,c){var d,e=a(b),f=this._getInst(e[0]);c=null!=c?c:this._formatDate(f),f.input&&f.input.val(c),this._updateAlternate(f),d=this._get(f,"onSelect"),d?d.apply(f.input?f.input[0]:null,[c,f]):f.input&&f.input.trigger("change"),f.inline?this._updateDatepicker(f):(this._hideDatepicker(),this._lastInput=f.input[0],"object"!=typeof f.input[0]&&f.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c,d,e,f=this._get(b,"altField");f&&(c=this._get(b,"altFormat")||this._get(b,"dateFormat"),d=this._getDate(b),e=this.formatDate(c,d,this._getFormatConfig(b)),a(f).each(function(){a(this).val(e)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},iso8601Week:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},parseDate:function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(c="object"==typeof c?""+c:c+"",""===c)return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=-1,q=-1,r=-1,s=-1,t=!1,u=function(a){var c=b.length>e+1&&b.charAt(e+1)===a;return c&&e++,c},v=function(a){var b=u(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e="y"===a?d:1,f=RegExp("^\\d{"+e+","+d+"}"),g=c.substring(i).match(f);if(!g)throw"Missing number at position "+i;return i+=g[0].length,parseInt(g[0],10)},w=function(b,d,e){var f=-1,g=a.map(u(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];return c.substr(i,d.length).toLowerCase()===d.toLowerCase()?(f=b[0],i+=d.length,!1):void 0}),-1!==f)return f+1;throw"Unknown name at position "+i},x=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;b.length>e;e++)if(t)"'"!==b.charAt(e)||u("'")?x():t=!1;else switch(b.charAt(e)){case"d":r=v("d");break;case"D":w("D",l,m);break;case"o":s=v("o");break;case"m":q=v("m");break;case"M":q=w("M",n,o);break;case"y":p=v("y");break;case"@":h=new Date(v("@")),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"!":h=new Date((v("!")-this._ticksTo1970)/1e4),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"'":u("'")?x():t=!0;break;default:x()}if(c.length>i&&(g=c.substr(i),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===p?p=(new Date).getFullYear():100>p&&(p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(k>=p?0:-100)),s>-1)for(q=1,r=s;f=this._getDaysInMonth(p,q-1),!(f>=r);)q++,r-=f;if(h=this._daylightSavingAdjust(new Date(p,q-1,r)),h.getFullYear()!==p||h.getMonth()+1!==q||h.getDate()!==r)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d,e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=function(b){var c=a.length>d+1&&a.charAt(d+1)===b;return c&&d++,c},j=function(a,b,c){var d=""+b;if(i(a))for(;c>d.length;)d="0"+d;return d},k=function(a,b,c,d){return i(a)?d[b]:c[b]},l="",m=!1;if(b)for(d=0;a.length>d;d++)if(m)"'"!==a.charAt(d)||i("'")?l+=a.charAt(d):m=!1;else switch(a.charAt(d)){case"d":l+=j("d",b.getDate(),2);break;case"D":l+=k("D",b.getDay(),e,f);break;case"o":l+=j("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);break;case"m":l+=j("m",b.getMonth()+1,2);break;case"M":l+=k("M",b.getMonth(),g,h);break;case"y":l+=i("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case"@":l+=b.getTime();break;case"!":l+=1e4*b.getTime()+this._ticksTo1970;break;case"'":i("'")?l+="'":m=!0;break;default:l+=a.charAt(d)}return l},_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=a.length>b+1&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;a.length>b;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":c+="0123456789";break;case"D":case"M":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_get:function(a,b){return void 0!==a.settings[b]?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!==a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e=this._getDefaultDate(a),f=e,g=this._getFormatConfig(a);try{f=this.parseDate(c,d,g)||e}catch(h){d=b?"":d}a.selectedDay=f.getDate(),a.drawMonth=a.selectedMonth=f.getMonth(),a.drawYear=a.selectedYear=f.getFullYear(),a.currentDay=d?f.getDate():0,a.currentMonth=d?f.getMonth():0,a.currentYear=d?f.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,d){var e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(c){try{return a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),c,a.datepicker._getFormatConfig(b))}catch(d){}for(var e=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,f=e.getFullYear(),g=e.getMonth(),h=e.getDate(),i=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,j=i.exec(c);j;){switch(j[2]||"d"){case"d":case"D":h+=parseInt(j[1],10);break;case"w":case"W":h+=7*parseInt(j[1],10);break;case"m":case"M":g+=parseInt(j[1],10),h=Math.min(h,a.datepicker._getDaysInMonth(f,g));break;case"y":case"Y":f+=parseInt(j[1],10),h=Math.min(h,a.datepicker._getDaysInMonth(f,g))}j=i.exec(c)}return new Date(f,g,h)},g=null==c||""===c?d:"string"==typeof c?f(c):"number"==typeof c?isNaN(c)?d:e(c):new Date(c.getTime());return g=g&&"Invalid Date"==""+g?d:g,g&&(g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),this._daylightSavingAdjust(g)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),e===a.selectedMonth&&f===a.selectedYear||c||this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&""===a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_attachHandlers:function(b){var c=this._get(b,"stepMonths"),d="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){var b={prev:function(){a.datepicker._adjustDate(d,-c,"M")},next:function(){a.datepicker._adjustDate(d,+c,"M")},hide:function(){a.datepicker._hideDatepicker()},today:function(){a.datepicker._gotoToday(d)},selectDay:function(){return a.datepicker._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return a.datepicker._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a.datepicker._selectMonthYear(d,this,"Y"),!1}};a(this).bind(this.getAttribute("data-event"),b[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=new Date,P=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth(),O.getDate())),Q=this._get(a,"isRTL"),R=this._get(a,"showButtonPanel"),S=this._get(a,"hideIfNoPrevNext"),T=this._get(a,"navigationAsDateFormat"),U=this._getNumberOfMonths(a),V=this._get(a,"showCurrentAtPos"),W=this._get(a,"stepMonths"),X=1!==U[0]||1!==U[1],Y=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(a,"min"),$=this._getMinMaxDate(a,"max"),_=a.drawMonth-V,ab=a.drawYear;if(0>_&&(_+=12,ab--),$)for(b=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-U[0]*U[1]+1,$.getDate())),b=Z&&Z>b?Z:b;this._daylightSavingAdjust(new Date(ab,_,1))>b;)_--,0>_&&(_=11,ab--);for(a.drawMonth=_,a.drawYear=ab,c=this._get(a,"prevText"),c=T?this.formatDate(c,this._daylightSavingAdjust(new Date(ab,_-W,1)),this._getFormatConfig(a)):c,d=this._canAdjustMonth(a,-1,ab,_)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>":S?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>",e=this._get(a,"nextText"),e=T?this.formatDate(e,this._daylightSavingAdjust(new Date(ab,_+W,1)),this._getFormatConfig(a)):e,f=this._canAdjustMonth(a,1,ab,_)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>":S?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>",g=this._get(a,"currentText"),h=this._get(a,"gotoCurrent")&&a.currentDay?Y:P,g=T?this.formatDate(g,h,this._getFormatConfig(a)):g,i=a.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(a,"closeText")+"</button>",j=R?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Q?i:"")+(this._isInRange(a,h)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+g+"</button>":"")+(Q?"":i)+"</div>":"",k=parseInt(this._get(a,"firstDay"),10),k=isNaN(k)?0:k,l=this._get(a,"showWeek"),m=this._get(a,"dayNames"),n=this._get(a,"dayNamesMin"),o=this._get(a,"monthNames"),p=this._get(a,"monthNamesShort"),q=this._get(a,"beforeShowDay"),r=this._get(a,"showOtherMonths"),s=this._get(a,"selectOtherMonths"),t=this._getDefaultDate(a),u="",w=0;U[0]>w;w++){for(x="",this.maxRows=4,y=0;U[1]>y;y++){if(z=this._daylightSavingAdjust(new Date(ab,_,a.selectedDay)),A=" ui-corner-all",B="",X){if(B+="<div class='ui-datepicker-group",U[1]>1)switch(y){case 0:B+=" ui-datepicker-group-first",A=" ui-corner-"+(Q?"right":"left");break;case U[1]-1:B+=" ui-datepicker-group-last",A=" ui-corner-"+(Q?"left":"right");break;default:B+=" ui-datepicker-group-middle",A=""}B+="'>"}for(B+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?Q?f:d:"")+(/all|right/.test(A)&&0===w?Q?d:f:"")+this._generateMonthYearHeader(a,_,ab,Z,$,w>0||y>0,o,p)+"</div><table class='ui-datepicker-calendar'><thead><tr>",C=l?"<th class='ui-datepicker-week-col'>"+this._get(a,"weekHeader")+"</th>":"",v=0;7>v;v++)D=(v+k)%7,C+="<th scope='col'"+((v+k+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+m[D]+"'>"+n[D]+"</span></th>";for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(ab,_),ab===a.selectedYear&&_===a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,E)),F=(this._getFirstDayOfMonth(ab,_)-k+7)%7,G=Math.ceil((F+E)/7),H=X&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=this._daylightSavingAdjust(new Date(ab,_,1-F)),J=0;H>J;J++){for(B+="<tr>",K=l?"<td class='ui-datepicker-week-col'>"+this._get(a,"calculateWeek")(I)+"</td>":"",v=0;7>v;v++)L=q?q.apply(a.input?a.input[0]:null,[I]):[!0,""],M=I.getMonth()!==_,N=M&&!s||!L[0]||Z&&Z>I||$&&I>$,K+="<td class='"+((v+k+6)%7>=5?" ui-datepicker-week-end":"")+(M?" ui-datepicker-other-month":"")+(I.getTime()===z.getTime()&&_===a.selectedMonth&&a._keyEvent||t.getTime()===I.getTime()&&t.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" ui-state-disabled":"")+(M&&!r?"":" "+L[1]+(I.getTime()===Y.getTime()?" "+this._currentClass:"")+(I.getTime()===P.getTime()?" ui-datepicker-today":""))+"'"+(M&&!r||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='click' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!r?"&#xa0;":N?"<span class='ui-state-default'>"+I.getDate()+"</span>":"<a class='ui-state-default"+(I.getTime()===P.getTime()?" ui-state-highlight":"")+(I.getTime()===Y.getTime()?" ui-state-active":"")+(M?" ui-priority-secondary":"")+"' href='#'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I);B+=K+"</tr>"}_++,_>11&&(_=0,ab++),B+="</tbody></table>"+(X?"</div>"+(U[0]>0&&y===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=B}u+=x}return u+=j,a._keyEvent=!1,u},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this._get(a,"changeMonth"),r=this._get(a,"changeYear"),s=this._get(a,"showMonthAfterYear"),t="<div class='ui-datepicker-title'>",u="";if(f||!q)u+="<span class='ui-datepicker-month'>"+g[b]+"</span>";else{for(i=d&&d.getFullYear()===c,j=e&&e.getFullYear()===c,u+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=d.getMonth())&&(!j||e.getMonth()>=k)&&(u+="<option value='"+k+"'"+(k===b?" selected='selected'":"")+">"+h[k]+"</option>");u+="</select>"}if(s||(t+=u+(!f&&q&&r?"":"&#xa0;")),!a.yearshtml)if(a.yearshtml="",f||!r)t+="<span class='ui-datepicker-year'>"+c+"</span>";else{for(l=this._get(a,"yearRange").split(":"),m=(new Date).getFullYear(),n=function(a){var b=a.match(/c[+\-].*/)?c+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(b)?m:b},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=d?Math.max(o,d.getFullYear()):o,p=e?Math.min(p,e.getFullYear()):p,a.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)a.yearshtml+="<option value='"+o+"'"+(o===c?" selected='selected'":"")+">"+o+"</option>";a.yearshtml+="</select>",t+=a.yearshtml,a.yearshtml=null}return t+=this._get(a,"yearSuffix"),s&&(t+=(!f&&q&&r?"":"&#xa0;")+u),t+="</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"===c?b:0),e=a.drawMonth+("M"===c?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+("D"===c?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),("M"===c||"Y"===c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&c>b?c:b;return d&&e>d?d:e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(0>b?b:e[0]*e[1]),1));return 0>b&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c,d,e=this._getMinMaxDate(a,"min"),f=this._getMinMaxDate(a,"max"),g=null,h=null,i=this._get(a,"yearRange");return i&&(c=i.split(":"),d=(new Date).getFullYear(),g=parseInt(c[0],10),h=parseInt(c[1],10),c[0].match(/[+\-].*/)&&(g+=d),c[1].match(/[+\-].*/)&&(h+=d)),(!e||b.getTime()>=e.getTime())&&(!f||b.getTime()<=f.getTime())&&(!g||b.getFullYear()>=g)&&(!h||h>=b.getFullYear())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick),a.datepicker.initialized=!0),0===a("#"+a.datepicker._mainDivId).length&&a("body").append(a.datepicker.dpDiv);var c=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!==b&&"getDate"!==b&&"widget"!==b?"option"===b&&2===arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c))},a.datepicker=new e,a.datepicker.initialized=!1,a.datepicker.uuid=(new Date).getTime(),a.datepicker.version="1.11.2",a.datepicker,a.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c,d=this;if(this._isOpen&&this._trigger("beforeClose",b)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{c=this.document[0].activeElement,c&&"body"!==c.nodeName.toLowerCase()&&a(c).blur()}catch(e){}this._hide(this.uiDialog,this.options.hide,function(){d._trigger("close",b)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(b,c){var d=!1,e=this.uiDialog.siblings(".ui-front:visible").map(function(){return+a(this).css("z-index")}).get(),f=Math.max.apply(null,e);return f>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",f+1),d=!0),d&&!c&&this._trigger("focus",b),d},open:function(){var b=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var a=this._focusedElement;a||(a=this.element.find("[autofocus]")),a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement,c=this.uiDialog[0]===b||a.contains(this.uiDialog[0],b);c||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),void this.close(b);if(b.keyCode===a.ui.keyCode.TAB&&!b.isDefaultPrevented()){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(this._delay(function(){e.focus()}),b.preventDefault()):(this._delay(function(){d.focus()}),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()
}}),this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){var g=f.offset.left-c.document.scrollLeft(),h=f.offset.top-c.document.scrollTop();d.position={my:"left top",at:"left"+(g>=0?"+":"")+g+" top"+(h>=0?"+":"")+h,of:c.window},a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){var g=c.uiDialog.offset(),h=g.left-c.document.scrollLeft(),i=g.top-c.document.scrollTop();d.height=c.uiDialog.height(),d.width=c.uiDialog.width(),d.position={my:"left top",at:"left"+(h>=0?"+":"")+h+" top"+(i>=0?"+":"")+i,of:c.window},a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_trackFocus:function(){this._on(this.widget(),{focusin:function(b){this._makeFocusTarget(),this._focusedElement=a(b.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var b=this._trackingInstances(),c=a.inArray(this,b);-1!==c&&b.splice(c,1)},_trackingInstances:function(){var a=this.document.data("ui-dialog-instances");return a||(a=[],this.document.data("ui-dialog-instances",a)),a},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(b){var c=this,d=!1,e={};a.each(b,function(a,b){c._setOption(a,b),a in c.sizeRelatedOptions&&(d=!0),a in c.resizableRelatedOptions&&(e[a]=b)}),d&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",e)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return a(b.target).closest(".ui-dialog").length?!0:!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=!0;this._delay(function(){b=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(a){b||this._allowInteraction(a)||(a.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var a=this.document.data("ui-dialog-overlays")-1;a?this.document.data("ui-dialog-overlays",a):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),a.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(a){return void 0===a?this.options.value:(this.options.value=this._constrainedValue(a),void this._refreshValue())},_constrainedValue:function(a){return void 0===a&&(a=this.options.value),this.indeterminate=a===!1,"number"!=typeof a&&(a=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,a))},_setOptions:function(a){var b=a.value;delete a.value,this._super(a),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(a,b){"max"===a&&(b=Math.max(this.min,b)),"disabled"===a&&this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var b=this.options.value,c=this._percentage();this.valueDiv.toggle(this.indeterminate||b>this.min).toggleClass("ui-corner-right",b===this.options.max).width(c.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=a("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":b}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==b&&(this.oldValue=b,this._trigger("change")),b===this.options.max&&this._trigger("complete")}}),a.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var a=this.element.uniqueId().attr("id");this.ids={element:a,button:a+"-button",menu:a+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var b=this,c=this.element.attr("tabindex");this.label=a("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(a){this.button.focus(),a.preventDefault()}}),this.element.hide(),this.button=a("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:c||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),a("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=a("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){b.menuItems||b._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var b=this;this.menu=a("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=a("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(a,c){a.preventDefault(),b._setSelection(),b._select(c.item.data("ui-selectmenu-item"),a)},focus:function(a,c){var d=c.item.data("ui-selectmenu-item");null!=b.focusIndex&&d.index!==b.focusIndex&&(b._trigger("focus",a,{item:d}),b.isOpen||b._select(d,a)),b.focusIndex=d.index,b.button.attr("aria-activedescendant",b.menuItems.eq(d.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var a,b=this.element.find("option");b.length&&(this._parseOptions(b),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),a=this._getSelectedItem(),this.menuInstance.focus(null,a),this._setAria(a.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(a){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",a))},_position:function(){this.menuWrap.position(a.extend({of:this.button},this.options.position))},close:function(a){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",a))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(b,c){var d=this,e="";a.each(c,function(c,f){f.optgroup!==e&&(a("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(f.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:f.optgroup}).appendTo(b),e=f.optgroup),d._renderItemData(b,f)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-selectmenu-item",b)},_renderItem:function(b,c){var d=a("<li>");return c.disabled&&d.addClass("ui-state-disabled"),this._setText(d,c.label),d.appendTo(b)},_setText:function(a,b){b?a.text(b):a.html("&#160;")},_move:function(a,b){var c,d,e=".ui-menu-item";this.isOpen?c=this.menuItems.eq(this.focusIndex):(c=this.menuItems.eq(this.element[0].selectedIndex),e+=":not(.ui-state-disabled)"),d="first"===a||"last"===a?c["first"===a?"prevAll":"nextAll"](e).eq(-1):c[a+"All"](e).eq(0),d.length&&this.menuInstance.focus(b,d)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(a){this[this.isOpen?"close":"open"](a)},_setSelection:function(){var a;this.range&&(window.getSelection?(a=window.getSelection(),a.removeAllRanges(),a.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(b){this.isOpen&&(a(b.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(b))}},_buttonEvents:{mousedown:function(){var a;window.getSelection?(a=window.getSelection(),a.rangeCount&&(this.range=a.getRangeAt(0))):this.range=document.selection.createRange()},click:function(a){this._setSelection(),this._toggle(a)},keydown:function(b){var c=!0;switch(b.keyCode){case a.ui.keyCode.TAB:case a.ui.keyCode.ESCAPE:this.close(b),c=!1;break;case a.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(b);break;case a.ui.keyCode.UP:b.altKey?this._toggle(b):this._move("prev",b);break;case a.ui.keyCode.DOWN:b.altKey?this._toggle(b):this._move("next",b);break;case a.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(b):this._toggle(b);break;case a.ui.keyCode.LEFT:this._move("prev",b);break;case a.ui.keyCode.RIGHT:this._move("next",b);break;case a.ui.keyCode.HOME:case a.ui.keyCode.PAGE_UP:this._move("first",b);break;case a.ui.keyCode.END:case a.ui.keyCode.PAGE_DOWN:this._move("last",b);break;default:this.menu.trigger(b),c=!1}c&&b.preventDefault()}},_selectFocusedItem:function(a){var b=this.menuItems.eq(this.focusIndex);b.hasClass("ui-state-disabled")||this._select(b.data("ui-selectmenu-item"),a)},_select:function(a,b){var c=this.element[0].selectedIndex;this.element[0].selectedIndex=a.index,this._setText(this.buttonText,a.label),this._setAria(a),this._trigger("select",b,{item:a}),a.index!==c&&this._trigger("change",b,{item:a}),this.close(b)},_setAria:function(a){var b=this.menuItems.eq(a.index).attr("id");this.button.attr({"aria-labelledby":b,"aria-activedescendant":b}),this.menu.attr("aria-activedescendant",b)},_setOption:function(a,b){"icons"===a&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(b.button),this._super(a,b),"appendTo"===a&&this.menuWrap.appendTo(this._appendTo()),"disabled"===a&&(this.menuInstance.option("disabled",b),this.button.toggleClass("ui-state-disabled",b).attr("aria-disabled",b),this.element.prop("disabled",b),b?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===a&&this._resizeButton()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b&&b[0]||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var a=this.options.width;a||(a=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(a)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(b){var c=[];b.each(function(b,d){var e=a(d),f=e.parent("optgroup");c.push({element:e,index:b,value:e.attr("value"),label:e.text(),optgroup:f.attr("label")||"",disabled:f.prop("disabled")||e.prop("disabled")})}),this.items=c},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),a.widget("ui.slider",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;d.length>f;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),"disabled"===b&&this.element.toggleClass("ui-state-disabled",!!c),this._super(b,c),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===c?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_calculateNewMax:function(){var a=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-a},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=100*((i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())),k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?100*((d-e)/(f-e)):0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(b){var c,d,e,f,g=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),c=this._start(b,g),c===!1))return}switch(f=this.options.step,d=e=this.options.values&&this.options.values.length?this.values(g):this.value(),b.keyCode){case a.ui.keyCode.HOME:e=this._valueMin();break;case a.ui.keyCode.END:e=this._valueMax();break;case a.ui.keyCode.PAGE_UP:e=this._trimAlignValue(d+(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(d-(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(d===this._valueMax())return;e=this._trimAlignValue(d+f);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d===this._valueMin())return;e=this._trimAlignValue(d-f)}this._slide(b,g,e)},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}}),a.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var b={},c=this.element;return a.each(["min","max","step"],function(a,d){var e=c.attr(d);void 0!==e&&e.length&&(b[d]=e)}),b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",a)))},mousewheel:function(a,b){if(b){if(!this.spinning&&!this._start(a))return!1;this._spin((b>0?1:-1)*this.options.step,a),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100),a.preventDefault()}},"mousedown .ui-spinner-button":function(b){function c(){var a=this.element[0]===this.document[0].activeElement;a||(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d}))}var d;d=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),b.preventDefault(),c.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,c.call(this)}),this._start(b)!==!1&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){return a(b.currentTarget).hasClass("ui-state-active")?this._start(b)===!1?!1:void this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*a.height())&&a.height()>0&&a.height(a.height()),this.options.disabled&&this.disable()},_keydown:function(b){var c=this.options,d=a.ui.keyCode;switch(b.keyCode){case d.UP:return this._repeat(null,1,b),!0;case d.DOWN:return this._repeat(null,-1,b),!0;case d.PAGE_UP:return this._repeat(null,c.page,b),!0;case d.PAGE_DOWN:return this._repeat(null,-c.page,b),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){return this.spinning||this._trigger("start",a)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(a,b,c){a=a||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,c)},a),this._spin(b*this.options.step,c)},_spin:function(a,b){var c=this.value()||0;this.counter||(this.counter=1),c=this._adjustValue(c+a*this._increment(this.counter)),this.spinning&&this._trigger("spin",b,{value:c})===!1||(this._value(c),this.counter++)},_increment:function(b){var c=this.options.incremental;return c?a.isFunction(c)?c(b):Math.floor(b*b*b/5e4-b*b/500+17*b/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){var b=""+a,c=b.indexOf(".");return-1===c?0:b.length-c-1},_adjustValue:function(a){var b,c,d=this.options;return b=null!==d.min?d.min:0,c=a-b,c=Math.round(c/d.step)*d.step,a=b+c,a=parseFloat(a.toFixed(this._precision())),null!==d.max&&a>d.max?d.max:null!==d.min&&d.min>a?d.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,b){if("culture"===a||"numberFormat"===a){var c=this._parse(this.element.val());return this.options[a]=b,void this.element.val(this._format(c))}("max"===a||"min"===a||"step"===a)&&"string"==typeof b&&(b=this._parse(b)),"icons"===a&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(b.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(b.down)),this._super(a,b),"disabled"===a&&(this.widget().toggleClass("ui-state-disabled",!!b),this.element.prop("disabled",!!b),this.buttons.button(b?"disable":"enable"))
},_setOptions:i(function(a){this._super(a)}),_parse:function(a){return"string"==typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a),""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var a=this.value();return null===a?!1:a===this._adjustValue(a)},_value:function(a,b){var c;""!==a&&(c=this._parse(a),null!==c&&(b||(c=this._adjustValue(c)),a=this._format(c))),this.element.val(a),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:i(function(a){this._stepUp(a)}),_stepUp:function(a){this._start()&&(this._spin((a||1)*this.options.step),this._stop())},stepDown:i(function(a){this._stepDown(a)}),_stepDown:function(a){this._start()&&(this._spin((a||1)*-this.options.step),this._stop())},pageUp:i(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:i(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){return arguments.length?void i(this._value).call(this,a):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),a.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var a=/#.*$/;return function(b){var c,d;b=b.cloneNode(!1),c=b.href.replace(a,""),d=location.href.replace(a,"");try{c=decodeURIComponent(c)}catch(e){}try{d=decodeURIComponent(d)}catch(e){}return b.hash.length>1&&c===d}}(),_create:function(){var b=this,c=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",c.collapsible),this._processTabs(),c.active=this._initialActive(),a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(c.active):a(),this._refresh(),this.active.length&&this.load(c.active)},_initialActive:function(){var b=this.options.active,c=this.options.collapsible,d=location.hash.substring(1);return null===b&&(d&&this.tabs.each(function(c,e){return a(e).attr("aria-controls")===d?(b=c,!1):void 0}),null===b&&(b=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===b||-1===b)&&(b=this.tabs.length?0:!1)),b!==!1&&(b=this.tabs.index(this.tabs.eq(b)),-1===b&&(b=c?!1:0)),!c&&b===!1&&this.anchors.length&&(b=0),b},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var c=a(this.document[0].activeElement).closest("li"),d=this.tabs.index(c),e=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:d++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:e=!1,d--;break;case a.ui.keyCode.END:d=this.anchors.length-1;break;case a.ui.keyCode.HOME:d=0;break;case a.ui.keyCode.SPACE:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d);case a.ui.keyCode.ENTER:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d===this.options.active?!1:d);default:return}b.preventDefault(),clearTimeout(this.activating),d=this._focusNextTab(d,e),b.ctrlKey||(c.attr("aria-selected","false"),this.tabs.eq(d).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",d)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},_handlePageNav:function(b){return b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(b,c){function d(){return b>e&&(b=0),0>b&&(b=e),b}for(var e=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,b){return"active"===a?void this._activate(b):"disabled"===a?void this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),b||this.options.active!==!1||this._activate(0)),"event"===a&&this._setupEvents(b),void("heightStyle"===a&&this._setupHeightStyle(b)))},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)}),this._processTabs(),b.active!==!1&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this,c=this.tabs,d=this.anchors,e=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=a(),this.anchors.each(function(c,d){var e,f,g,h=a(d).uniqueId().attr("id"),i=a(d).closest("li"),j=i.attr("aria-controls");b._isLocal(d)?(e=d.hash,g=e.substring(1),f=b.element.find(b._sanitizeSelector(e))):(g=i.attr("aria-controls")||a({}).uniqueId()[0].id,e="#"+g,f=b.element.find(e),f.length||(f=b._createPanel(g),f.insertAfter(b.panels[c-1]||b.tablist)),f.attr("aria-live","polite")),f.length&&(b.panels=b.panels.add(f)),j&&i.data("ui-tabs-aria-controls",j),i.attr({"aria-controls":g,"aria-labelledby":h}),f.attr("aria-labelledby",h)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),c&&(this._off(c.not(this.tabs)),this._off(d.not(this.anchors)),this._off(e.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c,d=0;c=this.tabs[d];d++)b===!0||-1!==a.inArray(d,b)?a(c).addClass("ui-state-disabled").attr("aria-disabled","true"):a(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var c={};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(a){a.preventDefault()}}),this._on(this.anchors,c),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,d=this.element.parent();"fill"===b?(c=d.height(),c-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e.closest("li"),g=f[0]===d[0],h=g&&c.collapsible,i=h?a():this._getPanelForTab(f),j=d.length?this._getPanelForTab(d):a(),k={oldTab:d,oldPanel:j,newTab:h?a():f,newPanel:i};b.preventDefault(),f.hasClass("ui-state-disabled")||f.hasClass("ui-tabs-loading")||this.running||g&&!c.collapsible||this._trigger("beforeActivate",b,k)===!1||(c.active=h?!1:this.tabs.index(f),this.active=g?a():f,this.xhr&&this.xhr.abort(),j.length||i.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),i.length&&this.load(this.tabs.index(f),b),this._toggle(b,k))},_toggle:function(b,c){function d(){f.running=!1,f._trigger("activate",b,c)}function e(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),g.length&&f.options.show?f._show(g,f.options.show,d):(g.show(),d())}var f=this,g=c.newPanel,h=c.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),e()),h.attr("aria-hidden","true"),c.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),g.attr("aria-hidden","false"),c.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(b){var c,d=this._findActive(b);d[0]!==this.active[0]&&(d.length||(d=this.active),c=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return b===!1?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(b){var c=this.options.disabled;c!==!1&&(void 0===b?c=!1:(b=this._getIndex(b),c=a.isArray(c)?a.map(c,function(a){return a!==b?a:null}):a.map(this.tabs,function(a,c){return c!==b?c:null})),this._setupDisabled(c))},disable:function(b){var c=this.options.disabled;if(c!==!0){if(void 0===b)c=!0;else{if(b=this._getIndex(b),-1!==a.inArray(b,c))return;c=a.isArray(c)?a.merge([b],c).sort():[b]}this._setupDisabled(c)}},load:function(b,c){b=this._getIndex(b);var d=this,e=this.tabs.eq(b),f=e.find(".ui-tabs-anchor"),g=this._getPanelForTab(e),h={tab:e,panel:g};this._isLocal(f[0])||(this.xhr=a.ajax(this._ajaxSettings(f,c,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(e.addClass("ui-tabs-loading"),g.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){g.html(a),d._trigger("load",c,h)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&d.panels.stop(!1,!0),e.removeClass("ui-tabs-loading"),g.removeAttr("aria-busy"),a===d.xhr&&delete d.xhr},1)})))},_ajaxSettings:function(b,c,d){var e=this;return{url:b.attr("href"),beforeSend:function(b,f){return e._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},d))}}},_getPanelForTab:function(b){var c=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+c))}}),a.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var b=a(this).attr("title")||"";return a("<a>").text(b).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(b,c){var d=(b.attr("aria-describedby")||"").split(/\s+/);d.push(c),b.data("ui-tooltip-id",c).attr("aria-describedby",a.trim(d.join(" ")))},_removeDescribedBy:function(b){var c=b.data("ui-tooltip-id"),d=(b.attr("aria-describedby")||"").split(/\s+/),e=a.inArray(c,d);-1!==e&&d.splice(e,1),b.removeData("ui-tooltip-id"),d=a.trim(d.join(" ")),d?b.attr("aria-describedby",d):b.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=a("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(b,c){var d=this;return"disabled"===b?(this[c?"_disable":"_enable"](),void(this.options[b]=c)):(this._super(b,c),void("content"===b&&a.each(this.tooltips,function(a,b){d._updateContent(b.element)})))},_disable:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d.element[0],b.close(e,!0)}),this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},open:function(b){var c=this,d=a(b?b.target:this.element).closest(this.options.items);d.length&&!d.data("ui-tooltip-id")&&(d.attr("title")&&d.data("ui-tooltip-title",d.attr("title")),d.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&d.parents().each(function(){var b,d=a(this);d.data("ui-tooltip-open")&&(b=a.Event("blur"),b.target=b.currentTarget=this,c.close(b,!0)),d.attr("title")&&(d.uniqueId(),c.parents[this.id]={element:this,title:d.attr("title")},d.attr("title",""))}),this._updateContent(d,b))},_updateContent:function(a,b){var c,d=this.options.content,e=this,f=b?b.type:null;return"string"==typeof d?this._open(b,a,d):(c=d.call(a[0],function(c){a.data("ui-tooltip-open")&&e._delay(function(){b&&(b.type=f),this._open(b,a,c)})}),void(c&&this._open(b,a,c)))},_open:function(b,c,d){function e(a){k.of=a,g.is(":hidden")||g.position(k)}var f,g,h,i,j,k=a.extend({},this.options.position);if(d){if(f=this._find(c))return void f.tooltip.find(".ui-tooltip-content").html(d);c.is("[title]")&&(b&&"mouseover"===b.type?c.attr("title",""):c.removeAttr("title")),f=this._tooltip(c),g=f.tooltip,this._addDescribedBy(c,g.attr("id")),g.find(".ui-tooltip-content").html(d),this.liveRegion.children().hide(),d.clone?(j=d.clone(),j.removeAttr("id").find("[id]").removeAttr("id")):j=d,a("<div>").html(j).appendTo(this.liveRegion),this.options.track&&b&&/^mouse/.test(b.type)?(this._on(this.document,{mousemove:e}),e(b)):g.position(a.extend({of:c},this.options.position)),g.hide(),this._show(g,this.options.show),this.options.show&&this.options.show.delay&&(i=this.delayedShow=setInterval(function(){g.is(":visible")&&(e(k.of),clearInterval(i))},a.fx.interval)),this._trigger("open",b,{tooltip:g}),h={keyup:function(b){if(b.keyCode===a.ui.keyCode.ESCAPE){var d=a.Event(b);d.currentTarget=c[0],this.close(d,!0)}}},c[0]!==this.element[0]&&(h.remove=function(){this._removeTooltip(g)}),b&&"mouseover"!==b.type||(h.mouseleave="close"),b&&"focusin"!==b.type||(h.focusout="close"),this._on(!0,c,h)}},close:function(b){var c,d=this,e=a(b?b.currentTarget:this.element),f=this._find(e);f&&(c=f.tooltip,f.closing||(clearInterval(this.delayedShow),e.data("ui-tooltip-title")&&!e.attr("title")&&e.attr("title",e.data("ui-tooltip-title")),this._removeDescribedBy(e),f.hiding=!0,c.stop(!0),this._hide(c,this.options.hide,function(){d._removeTooltip(a(this))}),e.removeData("ui-tooltip-open"),this._off(e,"mouseleave focusout keyup"),e[0]!==this.element[0]&&this._off(e,"remove"),this._off(this.document,"mousemove"),b&&"mouseleave"===b.type&&a.each(this.parents,function(b,c){a(c.element).attr("title",c.title),delete d.parents[b]}),f.closing=!0,this._trigger("close",b,{tooltip:c}),f.hiding||(f.closing=!1)))},_tooltip:function(b){var c=a("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),d=c.uniqueId().attr("id");return a("<div>").addClass("ui-tooltip-content").appendTo(c),c.appendTo(this.document[0].body),this.tooltips[d]={element:b,tooltip:c}},_find:function(a){var b=a.data("ui-tooltip-id");return b?this.tooltips[b]:null},_removeTooltip:function(a){a.remove(),delete this.tooltips[a.attr("id")]},_destroy:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur"),f=d.element;e.target=e.currentTarget=f[0],b.close(e,!0),a("#"+c).remove(),f.data("ui-tooltip-title")&&(f.attr("title")||f.attr("title",f.data("ui-tooltip-title")),f.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var s="ui-effects-",t=a;a.effects={effect:{}},function(a,b){function c(a,b,c){var d=l[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:a>d.max?d.max:a)}function d(c){var d=j(),e=d._rgba=[];return c=c.toLowerCase(),o(i,function(a,f){var g,h=f.re.exec(c),i=h&&f.parse(h),j=f.space||"rgba";return i?(g=d[j](i),d[k[j].cache]=g[k[j].cache],e=d._rgba=g._rgba,!1):b}),e.length?("0,0,0,0"===e.join()&&a.extend(e,f.transparent),d):f[c]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var f,g="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",h=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],j=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},k={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},m=j.support={},n=a("<p>")[0],o=a.each;n.style.cssText="background-color:rgba(1,1,1,.5)",m.rgba=n.style.backgroundColor.indexOf("rgba")>-1,o(k,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),j.fn=a.extend(j.prototype,{parse:function(e,g,h,i){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(g),g=b);var l=this,m=a.type(e),n=this._rgba=[];return g!==b&&(e=[e,g,h,i],m="array"),"string"===m?this.parse(d(e)||f._default):"array"===m?(o(k.rgba.props,function(a,b){n[b.idx]=c(e[b.idx],b)}),this):"object"===m?(e instanceof j?o(k,function(a,b){e[b.cache]&&(l[b.cache]=e[b.cache].slice())}):o(k,function(b,d){var f=d.cache;o(d.props,function(a,b){if(!l[f]&&d.to){if("alpha"===a||null==e[a])return;l[f]=d.to(l._rgba)}l[f][b.idx]=c(e[a],b,!0)}),l[f]&&0>a.inArray(null,l[f].slice(0,3))&&(l[f][3]=1,d.from&&(l._rgba=d.from(l[f])))}),this):b},is:function(a){var c=j(a),d=!0,e=this;return o(k,function(a,f){var g,h=c[f.cache];return h&&(g=e[f.cache]||f.to&&f.to(e._rgba)||[],o(f.props,function(a,c){return null!=h[c.idx]?d=h[c.idx]===g[c.idx]:b})),d}),d},_space:function(){var a=[],b=this;return o(k,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=j(a),e=d._space(),f=k[e],g=0===this.alpha()?j("transparent"):this,h=g[f.cache]||f.to(g._rgba),i=h.slice();return d=d[f.cache],o(f.props,function(a,e){var f=e.idx,g=h[f],j=d[f],k=l[e.type]||{};null!==j&&(null===g?i[f]=j:(k.mod&&(j-g>k.mod/2?g+=k.mod:g-j>k.mod/2&&(g-=k.mod)),i[f]=c((j-g)*b+g,e)))}),this[e](i)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=j(b)._rgba;return j(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),j.fn.parse.prototype=j.fn,k.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===j?0:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},k.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},o(k,function(d,e){var f=e.props,g=e.cache,i=e.to,k=e.from;j.fn[d]=function(d){if(i&&!this[g]&&(this[g]=i(this._rgba)),d===b)return this[g].slice();var e,h=a.type(d),l="array"===h||"object"===h?d:arguments,m=this[g].slice();return o(f,function(a,b){var d=l["object"===h?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=j(k(m)),e[g]=m,e):j(m)},o(f,function(b,c){j.fn[b]||(j.fn[b]=function(e){var f,g=a.type(e),i="alpha"===b?this._hsla?"hsla":"rgba":d,j=this[i](),k=j[c.idx];return"undefined"===g?k:("function"===g&&(e=e.call(this,k),g=a.type(e)),null==e&&c.empty?this:("string"===g&&(f=h.exec(e),f&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1))),j[c.idx]=e,this[i](j)))})})}),j.hook=function(b){var c=b.split(" ");o(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=j(f||e),!m.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(i){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(i){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=j(b.elem,c),b.end=j(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},j.hook(g),a.cssHooks.borderColor={expand:function(a){var b={};return o(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},f=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(t),function(){function b(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]])for(d=e.length;d--;)c=e[d],"string"==typeof e[c]&&(f[a.camelCase(c)]=e[c]);else for(c in e)"string"==typeof e[c]&&(f[c]=e[c]);return f}function c(b,c){var d,f,g={};for(d in c)f=c[d],b[d]!==f&&(e[d]||(a.fx.step[d]||!isNaN(parseFloat(f)))&&(g[d]=f));return g}var d=["add","remove","toggle"],e={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(t.style(a.elem,c,a.end),a.setAttr=!0)}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(e,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").addBack():g;j=j.map(function(){var c=a(this);return{el:c,start:b(this)}}),f=function(){a.each(d,function(a,b){e[b]&&g[b+"Class"](e[b])})},f(),j=j.map(function(){return this.end=b(this.el[0]),this.diff=c(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(b){return function(c,d,e,f,g){return"boolean"==typeof d||void 0===d?e?a.effects.animateClass.call(this,d?{add:c}:{remove:c},e,f,g):b.apply(this,arguments):a.effects.animateClass.call(this,{toggle:c},d,e,f)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function b(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function c(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"!=typeof b||a.effects.effect[b]?a.isFunction(b)?!0:"object"!=typeof b||b.effect?!1:!0:!0}a.extend(a.effects,{version:"1.11.2",save:function(a,b){for(var c=0;b.length>c;c++)null!==b[c]&&a.data(s+b[c],a[0].style[b[c]])},restore:function(a,b){var c,d;for(d=0;b.length>d;d++)null!==b[d]&&(c=a.data(s+b[d]),void 0===c&&(c=""),a.css(b[d],c))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(g){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function c(b){function c(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=d.complete,h=d.mode;(e.is(":hidden")?"hide"===h:"show"===h)?(e[h](),c()):g.call(e[0],d,c)}var d=b.apply(this,arguments),e=d.mode,f=d.queue,g=a.effects.effect[d.effect];return a.fx.off||!g?e?this[e](d.duration,d.complete):this.each(function(){d.complete&&d.complete.call(this)}):f===!1?this.each(c):this.queue(f||"fx",c)},show:function(a){return function(d){if(c(d))return a.apply(this,arguments);var e=b.apply(this,arguments);return e.mode="show",this.effect.call(this,e)}}(a.fn.show),hide:function(a){return function(d){if(c(d))return a.apply(this,arguments);var e=b.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)}}(a.fn.hide),toggle:function(a){return function(d){if(c(d)||"boolean"==typeof d)return a.apply(this,arguments);var e=b.apply(this,arguments);return e.mode="toggle",this.effect.call(this,e)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;((b=Math.pow(2,--c))-1)/11>a;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}(),a.effects,a.effects.effect.blind=function(b,c){var d,e,f,g=a(this),h=/up|down|vertical/,i=/up|left|vertical|horizontal/,j=["position","top","bottom","left","right","height","width"],k=a.effects.setMode(g,b.mode||"hide"),l=b.direction||"up",m=h.test(l),n=m?"height":"width",o=m?"top":"left",p=i.test(l),q={},r="show"===k;g.parent().is(".ui-effects-wrapper")?a.effects.save(g.parent(),j):a.effects.save(g,j),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e=d[n](),f=parseFloat(d.css(o))||0,q[n]=r?e:0,p||(g.css(m?"bottom":"right",0).css(m?"top":"left","auto").css({position:"absolute"}),q[o]=r?f:e+f),r&&(d.css(n,0),p||d.css(o,f+e)),d.animate(q,{duration:b.duration,easing:b.easing,queue:!1,complete:function(){"hide"===k&&g.hide(),a.effects.restore(g,j),a.effects.removeWrapper(g),c()
}})},a.effects.effect.bounce=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"effect"),j="hide"===i,k="show"===i,l=b.direction||"up",m=b.distance,n=b.times||5,o=2*n+(k||j?1:0),p=b.duration/o,q=b.easing,r="up"===l||"down"===l?"top":"left",s="up"===l||"left"===l,t=g.queue(),u=t.length;for((k||j)&&h.push("opacity"),a.effects.save(g,h),g.show(),a.effects.createWrapper(g),m||(m=g["top"===r?"outerHeight":"outerWidth"]()/3),k&&(f={opacity:1},f[r]=0,g.css("opacity",0).css(r,s?2*-m:2*m).animate(f,p,q)),j&&(m/=Math.pow(2,n-1)),f={},f[r]=0,d=0;n>d;d++)e={},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q).animate(f,p,q),m=j?2*m:m/2;j&&(e={opacity:0},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q)),g.queue(function(){j&&g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}),u>1&&t.splice.apply(t,[1,0].concat(t.splice(u,o+1))),g.dequeue()},a.effects.effect.clip=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"hide"),j="show"===i,k=b.direction||"vertical",l="vertical"===k,m=l?"height":"width",n=l?"top":"left",o={};a.effects.save(g,h),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e="IMG"===g[0].tagName?d:g,f=e[m](),j&&(e.css(m,0),e.css(n,f/2)),o[m]=j?f:0,o[n]=j?0:f/2,e.animate(o,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){j||g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}})},a.effects.effect.drop=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","opacity","height","width"],g=a.effects.setMode(e,b.mode||"hide"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i?"pos":"neg",l={opacity:h?1:0};a.effects.save(e,f),e.show(),a.effects.createWrapper(e),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0)/2,h&&e.css("opacity",0).css(j,"pos"===k?-d:d),l[j]=(h?"pos"===k?"+=":"-=":"pos"===k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})},a.effects.effect.explode=function(b,c){function d(){t.push(this),t.length===l*m&&e()}function e(){n.css({visibility:"visible"}),a(t).remove(),p||n.hide(),c()}var f,g,h,i,j,k,l=b.pieces?Math.round(Math.sqrt(b.pieces)):3,m=l,n=a(this),o=a.effects.setMode(n,b.mode||"hide"),p="show"===o,q=n.show().css("visibility","hidden").offset(),r=Math.ceil(n.outerWidth()/m),s=Math.ceil(n.outerHeight()/l),t=[];for(f=0;l>f;f++)for(i=q.top+f*s,k=f-(l-1)/2,g=0;m>g;g++)h=q.left+g*r,j=g-(m-1)/2,n.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*r,top:-f*s}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:r,height:s,left:h+(p?j*r:0),top:i+(p?k*s:0),opacity:p?0:1}).animate({left:h+(p?0:j*r),top:i+(p?0:k*s),opacity:p?1:0},b.duration||500,b.easing,d)},a.effects.effect.fade=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"toggle");d.animate({opacity:e},{queue:!1,duration:b.duration,easing:b.easing,complete:c})},a.effects.effect.fold=function(b,c){var d,e,f=a(this),g=["position","top","bottom","left","right","height","width"],h=a.effects.setMode(f,b.mode||"hide"),i="show"===h,j="hide"===h,k=b.size||15,l=/([0-9]+)%/.exec(k),m=!!b.horizFirst,n=i!==m,o=n?["width","height"]:["height","width"],p=b.duration/2,q={},r={};a.effects.save(f,g),f.show(),d=a.effects.createWrapper(f).css({overflow:"hidden"}),e=n?[d.width(),d.height()]:[d.height(),d.width()],l&&(k=parseInt(l[1],10)/100*e[j?0:1]),i&&d.css(m?{height:0,width:k}:{height:k,width:0}),q[o[0]]=i?e[0]:k,r[o[1]]=i?e[1]:0,d.animate(q,p,b.easing).animate(r,p,b.easing,function(){j&&f.hide(),a.effects.restore(f,g),a.effects.removeWrapper(f),c()})},a.effects.effect.highlight=function(b,c){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,b.mode||"show"),g={backgroundColor:d.css("backgroundColor")};"hide"===f&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&d.hide(),a.effects.restore(d,e),c()}})},a.effects.effect.size=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","width","height","overflow","opacity"],i=["position","top","bottom","left","right","overflow","opacity"],j=["width","height","overflow"],k=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],m=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=a.effects.setMode(g,b.mode||"effect"),o=b.restore||"effect"!==n,p=b.scale||"both",q=b.origin||["middle","center"],r=g.css("position"),s=o?h:i,t={height:0,width:0,outerHeight:0,outerWidth:0};"show"===n&&g.show(),d={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()},"toggle"===b.mode&&"show"===n?(g.from=b.to||t,g.to=b.from||d):(g.from=b.from||("show"===n?t:d),g.to=b.to||("hide"===n?t:d)),f={from:{y:g.from.height/d.height,x:g.from.width/d.width},to:{y:g.to.height/d.height,x:g.to.width/d.width}},("box"===p||"both"===p)&&(f.from.y!==f.to.y&&(s=s.concat(l),g.from=a.effects.setTransition(g,l,f.from.y,g.from),g.to=a.effects.setTransition(g,l,f.to.y,g.to)),f.from.x!==f.to.x&&(s=s.concat(m),g.from=a.effects.setTransition(g,m,f.from.x,g.from),g.to=a.effects.setTransition(g,m,f.to.x,g.to))),("content"===p||"both"===p)&&f.from.y!==f.to.y&&(s=s.concat(k).concat(j),g.from=a.effects.setTransition(g,k,f.from.y,g.from),g.to=a.effects.setTransition(g,k,f.to.y,g.to)),a.effects.save(g,s),g.show(),a.effects.createWrapper(g),g.css("overflow","hidden").css(g.from),q&&(e=a.effects.getBaseline(q,d),g.from.top=(d.outerHeight-g.outerHeight())*e.y,g.from.left=(d.outerWidth-g.outerWidth())*e.x,g.to.top=(d.outerHeight-g.to.outerHeight)*e.y,g.to.left=(d.outerWidth-g.to.outerWidth)*e.x),g.css(g.from),("content"===p||"both"===p)&&(l=l.concat(["marginTop","marginBottom"]).concat(k),m=m.concat(["marginLeft","marginRight"]),j=h.concat(l).concat(m),g.find("*[width]").each(function(){var c=a(this),d={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()};o&&a.effects.save(c,j),c.from={height:d.height*f.from.y,width:d.width*f.from.x,outerHeight:d.outerHeight*f.from.y,outerWidth:d.outerWidth*f.from.x},c.to={height:d.height*f.to.y,width:d.width*f.to.x,outerHeight:d.height*f.to.y,outerWidth:d.width*f.to.x},f.from.y!==f.to.y&&(c.from=a.effects.setTransition(c,l,f.from.y,c.from),c.to=a.effects.setTransition(c,l,f.to.y,c.to)),f.from.x!==f.to.x&&(c.from=a.effects.setTransition(c,m,f.from.x,c.from),c.to=a.effects.setTransition(c,m,f.to.x,c.to)),c.css(c.from),c.animate(c.to,b.duration,b.easing,function(){o&&a.effects.restore(c,j)})})),g.animate(g.to,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){0===g.to.opacity&&g.css("opacity",g.from.opacity),"hide"===n&&g.hide(),a.effects.restore(g,s),o||("static"===r?g.css({position:"relative",top:g.to.top,left:g.to.left}):a.each(["top","left"],function(a,b){g.css(b,function(b,c){var d=parseInt(c,10),e=a?g.to.left:g.to.top;return"auto"===c?e+"px":d+e+"px"})})),a.effects.removeWrapper(g),c()}})},a.effects.effect.scale=function(b,c){var d=a(this),e=a.extend(!0,{},b),f=a.effects.setMode(d,b.mode||"effect"),g=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===f?0:100),h=b.direction||"both",i=b.origin,j={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()},k={y:"horizontal"!==h?g/100:1,x:"vertical"!==h?g/100:1};e.effect="size",e.queue=!1,e.complete=c,"effect"!==f&&(e.origin=i||["middle","center"],e.restore=!0),e.from=b.from||("show"===f?{height:0,width:0,outerHeight:0,outerWidth:0}:j),e.to={height:j.height*k.y,width:j.width*k.x,outerHeight:j.outerHeight*k.y,outerWidth:j.outerWidth*k.x},e.fade&&("show"===f&&(e.from.opacity=0,e.to.opacity=1),"hide"===f&&(e.from.opacity=1,e.to.opacity=0)),d.effect(e)},a.effects.effect.puff=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"hide"),f="hide"===e,g=parseInt(b.percent,10)||150,h=g/100,i={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:e,complete:c,percent:f?g:100,from:f?i:{height:i.height*h,width:i.width*h,outerHeight:i.outerHeight*h,outerWidth:i.outerWidth*h}}),d.effect(b)},a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()},a.effects.effect.shake=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(e,b.mode||"effect"),h=b.direction||"left",i=b.distance||20,j=b.times||3,k=2*j+1,l=Math.round(b.duration/k),m="up"===h||"down"===h?"top":"left",n="up"===h||"left"===h,o={},p={},q={},r=e.queue(),s=r.length;for(a.effects.save(e,f),e.show(),a.effects.createWrapper(e),o[m]=(n?"-=":"+=")+i,p[m]=(n?"+=":"-=")+2*i,q[m]=(n?"-=":"+=")+2*i,e.animate(o,l,b.easing),d=1;j>d;d++)e.animate(p,l,b.easing).animate(q,l,b.easing);e.animate(p,l,b.easing).animate(o,l/2,b.easing).queue(function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}),s>1&&r.splice.apply(r,[1,0].concat(r.splice(s,k+1))),e.dequeue()},a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})},a.effects.effect.transfer=function(b,c){var d=a(this),e=a(b.to),f="fixed"===e.css("position"),g=a("body"),h=f?g.scrollTop():0,i=f?g.scrollLeft():0,j=e.offset(),k={top:j.top-h,left:j.left-i,height:e.innerHeight(),width:e.innerWidth()},l=d.offset(),m=a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(b.className).css({top:l.top-h,left:l.left-i,height:d.innerHeight(),width:d.innerWidth(),position:f?"fixed":"absolute"}).animate(k,b.duration,b.easing,function(){m.remove(),c()})}}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),jQuery.fn.fullScreen=d,jQuery.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))};var e,f,g;e=document,e.webkitCancelFullScreen?(f="webkitfullscreenchange",g="webkitfullscreenerror"):e.mozCancelFullScreen?(f="mozfullscreenchange",g="mozfullscreenerror"):(f="fullscreenchange",g="fullscreenerror"),jQuery(document).bind(f,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))}),jQuery(document).bind(g,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))});var cookieScripts=document.getElementsByTagName("script"),cookieScriptSrc=cookieScripts[cookieScripts.length-1].src,cookieQuery=null,cookieScriptPosition="bottom",cookieScriptSide="right",cookieScriptSource="cookie-script.com",cookieScriptDomain="",cookieScriptReadMore="/policies/cookie_"+App.context.languageCode+".html",cookieId="6a00eb3cf69b00d1af83ec32b891828a",cookieScriptDebug=0,cookieScriptCurrentUrl=window.location.href,cookieScriptTitle='<h4 id="cookiescript_header">'+App.translations.weUseCookies+"</h4>",cookieScriptDesc=App.translations.weUseCookiesDescription,cookieScriptAccept="×",cookieScriptMore=App.translations.readMore,cookieScriptCopyrights="",cookieScriptLoadJavaScript=function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=a,void 0!=b&&(d.onload=d.onreadystatechange=function(){d.readyState&&!/loaded|complete/.test(d.readyState)||(d.onload=d.onreadystatechange=null,c&&d.parentNode&&c.removeChild(d),d=void 0,b())}),c.insertBefore(d,c.firstChild)},InjectCookieScript=function(){function a(){cookieQuery('iframe[data-cookiescript="accepted"]').not(":has([src])").each(function(){var a=this,a=a.contentWindow?a.contentWindow:a.contentDocument.document?a.contentDocument.document:a.contentDocument;a.document.open(),a.document.write(cookieQuery(this).attr("alt")),a.document.close()})}function b(a){"show"==a?(cookieQuery("#cookiescript_overlay",cookieScriptWindow).show(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).show()):"hide"==a&&(cookieQuery("#cookiescript_overlay",cookieScriptWindow).hide(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).hide())}function c(){cookieQuery('img[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('script[type="text/plain"][data-cookiescript="accepted"]').each(function(){cookieQuery(this).after(cookieQuery(this).attr("src")?'<script type="text/javascript" src="'+cookieQuery(this).attr("src")+'"></script>':'<script type="text/javascript">'+cookieQuery(this).html()+"</script>"),cookieQuery(this).empty()}),cookieQuery('iframe[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('embed[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))[0].outerHTML)}),cookieQuery('object[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("data",cookieQuery(this).attr("data-data"))[0].outerHTML)}),cookieQuery('link[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("href",cookieQuery(this).attr("data-href"))})}cookieScriptDropfromFlag=0,cookieScriptDroptoFlag=0,cookieScriptCreateCookie=function(a,b,c){var d,e="";c&&(d=new Date,d.setTime(d.getTime()+864e5*c),e="; expires="+d.toGMTString()),c="",""!=cookieScriptDomain&&(c="; domain="+cookieScriptDomain),document.cookie=a+"="+b+e+c+"; path=/"},cookieScriptReadCookie=function(a){a+="=";for(var b,c=document.cookie.split(";"),d=0;d<c.length;d++){for(b=c[d];" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(a))return b.substring(a.length,b.length)}return null},cookieQuery(function(){if(cookieScriptWindow=window.document,cookieQuery("#cookiescript_injected",cookieScriptWindow).remove(),cookieQuery("#cookiescript_overlay",cookieScriptWindow).remove(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).remove(),cookieScriptCurrentValue=cookieScriptReadCookie("cookiescriptaccept"),"visit"==cookieScriptCurrentValue)return!1;if(cookieScriptCurrentValue){if("firstvisit"==cookieScriptCurrentValue.substring(0,10)&&cookieScriptCurrentValue!="firstvisit-"+cookieScriptCurrentUrl)return cookieScriptCreateCookie("cookiescriptaccept","visit",30),c(),!1}else cookieScriptCreateCookie("cookiescriptaccept","firstvisit-"+cookieScriptCurrentUrl,30);cookieQuery("body",cookieScriptWindow).append('<div id="cookiescript_injected">'+cookieScriptTitle+cookieScriptDesc+' <span id="cookiescript_readmore">'+cookieScriptMore+'</span><div id="cookiescript_accept">'+cookieScriptAccept+'</div><div style="clear:both"></div>'),cookieQuery("#cookiescript_injected",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,opacity:1,position:"fixed",padding:"15px",width:"300px","font-size":"13px","font-weight":"normal","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"none","line-height":"15px","letter-spacing":"normal","-moz-box-shadow":"0px 0px 8px #000000","-webkit-box-shadow":"0px 0px 8px #000000","box-shadow":"0px 0px 8px #000000"}),"top"==cookieScriptPosition?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("top",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("bottom",0),"left"==cookieScriptSide?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("left",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("right",0),cookieQuery("#cookiescript_injected h4#cookiescript_header",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,padding:"0 0 7px 0","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"block","font-size":"15px","font-weight":"bold","line-height":"normal","letter-spacing":"normal","font-style":"normal",margin:"0"}),cookieQuery("#cookiescript_injected a",cookieScriptWindow).css({"text-decoration":"underline",color:"#FFFFFF"}),cookieQuery("#cookiescript_injected a#cookiescript_link",cookieScriptWindow).css({"text-decoration":"none",color:"#FFFFFF","float":"right","font-size":"90%","text-decoration":"none","margin-top":"8px"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({border:0,padding:"0","text-decoration":"underline",cursor:"pointer",margin:"0","white-space":"nowrap"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"-webkit-border-radius":"10px","-khtml-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",border:0,padding:"0",cursor:"pointer",margin:"0","-webkit-transition":"0.25s","-moz-transition":"0.25s",transition:"0.25s",width:"20px",height:"20px",position:"absolute",top:"12px",right:"17px","border-radius":"10px","text-align":"center","font-weight":"bold","line-height":"21px","font-size":"20px"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"background-color":"#5BB75B",color:"#FFFFFF","float":"left"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({}),cookieQuery("#cookiescript_injected div#cookiescript_pixel",cookieScriptWindow).css({width:"1px",height:"1px","float":"left"}),cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeIn(1e3),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).click(function(){"undefined"==typeof cookieScriptScrollfired&&(cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeOut(200),cookieScriptCreateCookie("cookiescriptaccept","visit",30),b("hide"),c())}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).click(function(){return window.open(cookieScriptReadMore,"_blank"),!1}),cookieQuery("#cookiescript_overlay",cookieScriptWindow).click(function(){b("hide")}),cookieQuery("#cookiescript_info_close",cookieScriptWindow).click(function(){b("hide")}),document.onkeydown=function(a){a=a||window.event,27==a.keyCode&&b("hide")},a()}),"visit"!=cookieScriptReadCookie("cookiescriptaccept")&&"shown"!=cookieScriptReadCookie("cookiescriptaccept")||c()};window.jQuery&&jQuery.fn&&/^(1\.[8-9]|2\.[0-9])/.test(jQuery.fn.jquery)?(cookieScriptDebug&&window.console&&console.log("Using existing jQuery version "+jQuery.fn.jquery),cookieQuery=window.jQuery,InjectCookieScript()):(cookieScriptDebug&&window.console&&console.log("Loading jQuery 1.8.1 from ajax.googleapis.com"),cookieScriptLoadJavaScript(("https:"==document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js",function(){cookieQuery=jQuery.noConflict(!0),InjectCookieScript()})),!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.proj4=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b,d){if(!(this instanceof c))return new c(a,b,d);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if("object"==typeof a)this.x=a.x,this.y=a.y,this.z=a.z||0;else if("string"==typeof a&&"undefined"==typeof b){var e=a.split(",");this.x=parseFloat(e[0],10),this.y=parseFloat(e[1],10),this.z=parseFloat(e[2],10)||0}else this.x=a,this.y=b,this.z=d||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var d=a("mgrs");c.fromMGRS=function(a){return new c(d.toPoint(a))},c.prototype.toMGRS=function(a){return d.forward([this.x,this.y],a)},b.exports=c},{mgrs:66}],2:[function(a,b){function c(a,b){if(!(this instanceof c))return new c(a);b=b||function(a){if(a)throw a};var f=d(a);if("object"!=typeof f)return void b(a);var h=g(f),i=c.projections.get(h.projName);i?(e(this,h),e(this,i),this.init(),b(null,this)):b(a)}var d=a("./parseCode"),e=a("./extend"),f=a("./projections"),g=a("./deriveConstants");c.projections=f,c.projections.start(),b.exports=c},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(a,b){b.exports=function(a,b,c){var d,e,f,g=c.x,h=c.y,i=c.z||0;for(f=0;3>f;f++)if(!b||2!==f||void 0!==c.z)switch(0===f?(d=g,e="x"):1===f?(d=h,e="y"):(d=i,e="z"),a.axis[f]){case"e":c[e]=d;break;case"w":c[e]=-d;break;case"n":c[e]=d;break;case"s":c[e]=-d;break;case"u":void 0!==c[e]&&(c.z=d);break;case"d":void 0!==c[e]&&(c.z=-d);break;default:return null}return c}},{}],4:[function(a,b){var c=Math.PI/2,d=a("./sign");b.exports=function(a){return Math.abs(a)<c?a:a-d(a)*Math.PI}},{"./sign":21}],5:[function(a,b){var c=2*Math.PI,d=a("./sign");b.exports=function(a){return Math.abs(a)<Math.PI?a:a-d(a)*c}},{"./sign":21}],6:[function(a,b){b.exports=function(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)}},{}],7:[function(a,b){b.exports=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(a,b){b.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(a,b){b.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(a,b){b.exports=function(a){return a*a*a*(35/3072)}},{}],11:[function(a,b){b.exports=function(a,b,c){var d=b*c;return a/Math.sqrt(1-d*d)}},{}],12:[function(a,b){b.exports=function(a,b,c,d,e){var f,g;f=a/b;for(var h=0;15>h;h++)if(g=(a-(b*f-c*Math.sin(2*f)+d*Math.sin(4*f)-e*Math.sin(6*f)))/(b-2*c*Math.cos(2*f)+4*d*Math.cos(4*f)-6*e*Math.cos(6*f)),f+=g,Math.abs(g)<=1e-10)return f;return 0/0}},{}],13:[function(a,b){var c=Math.PI/2;b.exports=function(a,b){var d=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(b)-d)<1e-6)return 0>b?-1*c:c;for(var e,f,g,h,i=Math.asin(.5*b),j=0;30>j;j++)if(f=Math.sin(i),g=Math.cos(i),h=a*f,e=Math.pow(1-h*h,2)/(2*g)*(b/(1-a*a)-f/(1-h*h)+.5/a*Math.log((1-h)/(1+h))),i+=e,Math.abs(e)<=1e-10)return i;return 0/0}},{}],14:[function(a,b){b.exports=function(a,b,c,d,e){return a*e-b*Math.sin(2*e)+c*Math.sin(4*e)-d*Math.sin(6*e)}},{}],15:[function(a,b){b.exports=function(a,b,c){var d=a*b;return c/Math.sqrt(1-d*d)}},{}],16:[function(a,b){var c=Math.PI/2;b.exports=function(a,b){for(var d,e,f=.5*a,g=c-2*Math.atan(b),h=0;15>=h;h++)if(d=a*Math.sin(g),e=c-2*Math.atan(b*Math.pow((1-d)/(1+d),f))-g,g+=e,Math.abs(e)<=1e-10)return g;return-9999}},{}],17:[function(a,b){var c=1,d=.25,e=.046875,f=.01953125,g=.01068115234375,h=.75,i=.46875,j=.013020833333333334,k=.007120768229166667,l=.3645833333333333,m=.005696614583333333,n=.3076171875;b.exports=function(a){var b=[];b[0]=c-a*(d+a*(e+a*(f+a*g))),b[1]=a*(h-a*(e+a*(f+a*g)));var o=a*a;return b[2]=o*(i-a*(j+a*k)),o*=a,b[3]=o*(l-a*m),b[4]=o*a*n,b}},{}],18:[function(a,b){var c=a("./pj_mlfn"),d=1e-10,e=20;b.exports=function(a,b,f){for(var g=1/(1-b),h=a,i=e;i;--i){var j=Math.sin(h),k=1-b*j*j;if(k=(c(h,j,Math.cos(h),f)-a)*k*Math.sqrt(k)*g,h-=k,Math.abs(k)<d)return h}return h}},{"./pj_mlfn":19}],19:[function(a,b){b.exports=function(a,b,c,d){return c*=b,b*=b,d[0]*a-c*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))}},{}],20:[function(a,b){b.exports=function(a,b){var c;return a>1e-7?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b}},{}],21:[function(a,b){b.exports=function(a){return 0>a?-1:1}},{}],22:[function(a,b){b.exports=function(a,b){return Math.pow((1-a)/(1+a),b)}},{}],23:[function(a,b){b.exports=function(a){var b={x:a[0],y:a[1]};return a.length>2&&(b.z=a[2]),a.length>3&&(b.m=a[3]),b}},{}],24:[function(a,b){var c=Math.PI/2;b.exports=function(a,b,d){var e=a*d,f=.5*a;return e=Math.pow((1-e)/(1+e),f),Math.tan(.5*(c-b))/e}},{}],25:[function(a,b,c){c.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},c.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},c.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},c.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},c.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},c.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},c.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},c.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},c.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},c.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},c.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},c.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},c.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},c.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},c.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},c.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(a,b,c){c.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},c.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},c.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},c.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},c.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},c.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},c.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},c.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},c.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},c.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},c.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},c.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},c.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},c.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},c.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},c.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},c.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},c.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},c.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},c.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},c.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},c.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},c.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},c.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},c.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},c.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},c.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},c.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},c.hough={a:6378270,rf:297,ellipseName:"Hough"},c.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},c.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},c.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},c.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},c.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},c.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},c.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},c.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},c.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},c.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},c.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},c.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},c.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},c.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(a,b,c){c.greenwich=0,c.lisbon=-9.131906111111,c.paris=2.337229166667,c.bogota=-74.080916666667,c.madrid=-3.687938888889,c.rome=12.452333333333,c.bern=7.439583333333,c.jakarta=106.807719444444,c.ferro=-17.666666666667,c.brussels=4.367975,c.stockholm=18.058277777778,c.athens=23.7163375,c.oslo=10.722916666667},{}],28:[function(a,b){function c(a,b,c){var d;return Array.isArray(c)?(d=g(a,b,c),3===c.length?[d.x,d.y,d.z]:[d.x,d.y]):g(a,b,c)}function d(a){return a instanceof f?a:a.oProj?a.oProj:f(a)}function e(a,b,e){a=d(a);var f,g=!1;return"undefined"==typeof b?(b=a,a=h,g=!0):("undefined"!=typeof b.x||Array.isArray(b))&&(e=b,b=a,a=h,g=!0),b=d(b),e?c(a,b,e):(f={forward:function(d){return c(a,b,d)},inverse:function(d){return c(b,a,d)}},g&&(f.oProj=b),f)}var f=a("./Proj"),g=a("./transform"),h=f("WGS84");b.exports=e},{"./Proj":2,"./transform":64}],29:[function(a,b){var c=Math.PI/2,d=1,e=2,f=3,g=4,h=5,i=484813681109536e-20,j=1.0026,k=.3826834323650898,l=function(a){if(!(this instanceof l))return new l(a);if(this.datum_type=g,a){if(a.datumCode&&"none"===a.datumCode&&(this.datum_type=h),a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);(0!==a.datum_params[0]||0!==a.datum_params[1]||0!==a.datum_params[2])&&(this.datum_type=d),a.datum_params.length>3&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=e,a.datum_params[3]*=i,a.datum_params[4]*=i,a.datum_params[5]*=i,a.datum_params[6]=a.datum_params[6]/1e6+1)}this.datum_type=a.grids?f:this.datum_type,this.a=a.a,this.b=a.b,this.es=a.es,this.ep2=a.ep2,this.datum_params=a.datum_params,this.datum_type===f&&(this.grids=a.grids)}};l.prototype={compare_datums:function(a){return this.datum_type!==a.datum_type?!1:this.a!==a.a||Math.abs(this.es-a.es)>5e-11?!1:this.datum_type===d?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]:this.datum_type===e?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===a.datum_params[6]:this.datum_type===f||a.datum_type===f?this.nadgrids===a.nadgrids:!0
},geodetic_to_geocentric:function(a){var b,d,e,f,g,h,i,j=a.x,k=a.y,l=a.z?a.z:0,m=0;if(-c>k&&k>-1.001*c)k=-c;else if(k>c&&1.001*c>k)k=c;else if(-c>k||k>c)return null;return j>Math.PI&&(j-=2*Math.PI),g=Math.sin(k),i=Math.cos(k),h=g*g,f=this.a/Math.sqrt(1-this.es*h),b=(f+l)*i*Math.cos(j),d=(f+l)*i*Math.sin(j),e=(f*(1-this.es)+l)*g,a.x=b,a.y=d,a.z=e,m},geocentric_to_geodetic:function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=1e-12,u=t*t,v=30,w=a.x,x=a.y,y=a.z?a.z:0;if(o=!1,b=Math.sqrt(w*w+x*x),d=Math.sqrt(w*w+x*x+y*y),b/this.a<t){if(o=!0,q=0,d/this.a<t)return r=c,void(s=-this.b)}else q=Math.atan2(x,w);e=y/d,f=b/d,g=1/Math.sqrt(1-this.es*(2-this.es)*f*f),j=f*(1-this.es)*g,k=e*g,p=0;do p++,i=this.a/Math.sqrt(1-this.es*k*k),s=b*j+y*k-i*(1-this.es*k*k),h=this.es*i/(i+s),g=1/Math.sqrt(1-h*(2-h)*f*f),l=f*(1-h)*g,m=e*g,n=m*j-l*k,j=l,k=m;while(n*n>u&&v>p);return r=Math.atan(m/Math.abs(l)),a.x=q,a.y=r,a.z=s,a},geocentric_to_geodetic_noniter:function(a){var b,d,e,f,g,h,i,l,m,n,o,p,q,r,s,t,u,v=a.x,w=a.y,x=a.z?a.z:0;if(v=parseFloat(v),w=parseFloat(w),x=parseFloat(x),u=!1,0!==v)b=Math.atan2(w,v);else if(w>0)b=c;else if(0>w)b=-c;else if(u=!0,b=0,x>0)d=c;else{if(!(0>x))return d=c,void(e=-this.b);d=-c}return g=v*v+w*w,f=Math.sqrt(g),h=x*j,l=Math.sqrt(h*h+g),n=h/l,p=f/l,o=n*n*n,i=x+this.b*this.ep2*o,t=f-this.a*this.es*p*p*p,m=Math.sqrt(i*i+t*t),q=i/m,r=t/m,s=this.a/Math.sqrt(1-this.es*q*q),e=r>=k?f/r-s:-k>=r?f/-r-s:x/q+s*(this.es-1),u===!1&&(d=Math.atan(q/r)),a.x=b,a.y=d,a.z=e,a},geocentric_to_wgs84:function(a){if(this.datum_type===d)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];else if(this.datum_type===e){var b=this.datum_params[0],c=this.datum_params[1],f=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=j*(a.x-i*a.y+h*a.z)+b,l=j*(i*a.x+a.y-g*a.z)+c,m=j*(-h*a.x+g*a.y+a.z)+f;a.x=k,a.y=l,a.z=m}},geocentric_from_wgs84:function(a){if(this.datum_type===d)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(this.datum_type===e){var b=this.datum_params[0],c=this.datum_params[1],f=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=(a.x-b)/j,l=(a.y-c)/j,m=(a.z-f)/j;a.x=k+i*l-h*m,a.y=-i*k+l+g*m,a.z=h*k-g*l+m}}},b.exports=l},{}],30:[function(a,b){var c=1,d=2,e=3,f=5,g=6378137,h=.006694379990141316;b.exports=function(a,b,i){function j(a){return a===c||a===d}var k,l,m;if(a.compare_datums(b))return i;if(a.datum_type===f||b.datum_type===f)return i;var n=a.a,o=a.es,p=b.a,q=b.es,r=a.datum_type;if(r===e)if(0===this.apply_gridshift(a,0,i))a.a=g,a.es=h;else{if(!a.datum_params)return a.a=n,a.es=a.es,i;for(k=1,l=0,m=a.datum_params.length;m>l;l++)k*=a.datum_params[l];if(0===k)return a.a=n,a.es=a.es,i;r=a.datum_params.length>3?d:c}return b.datum_type===e&&(b.a=g,b.es=h),(a.es!==b.es||a.a!==b.a||j(r)||j(b.datum_type))&&(a.geodetic_to_geocentric(i),j(a.datum_type)&&a.geocentric_to_wgs84(i),j(b.datum_type)&&b.geocentric_from_wgs84(i),b.geocentric_to_geodetic(i)),b.datum_type===e&&this.apply_gridshift(b,1,i),a.a=n,a.es=o,b.a=p,b.es=q,i}},{}],31:[function(a,b){function c(a){var b=this;if(2===arguments.length){var d=arguments[1];c[a]="string"==typeof d?"+"===d[0]?e(arguments[1]):f(arguments[1]):d}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?c.apply(b,a):c(a)});if("string"==typeof a){if(a in c)return c[a]}else"EPSG"in a?c["EPSG:"+a.EPSG]=a:"ESRI"in a?c["ESRI:"+a.ESRI]=a:"IAU2000"in a?c["IAU2000:"+a.IAU2000]=a:console.log(a);return}}var d=a("./global"),e=a("./projString"),f=a("./wkt");d(c),b.exports=c},{"./global":34,"./projString":37,"./wkt":65}],32:[function(a,b){var c=a("./constants/Datum"),d=a("./constants/Ellipsoid"),e=a("./extend"),f=a("./datum"),g=1e-10,h=.16666666666666666,i=.04722222222222222,j=.022156084656084655;b.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var b=c[a.datumCode];b&&(a.datum_params=b.towgs84?b.towgs84.split(","):null,a.ellps=b.ellipse,a.datumName=b.datumName?b.datumName:a.datumCode)}if(!a.a){var k=d[a.ellps]?d[a.ellps]:d.WGS84;e(a,k)}return a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a),(0===a.rf||Math.abs(a.a-a.b)<g)&&(a.sphere=!0,a.b=a.a),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=(a.a2-a.b2)/a.a2,a.e=Math.sqrt(a.es),a.R_A&&(a.a*=1-a.es*(h+a.es*(i+a.es*j)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0),a.ep2=(a.a2-a.b2)/a.b2,a.k0||(a.k0=1),a.axis||(a.axis="enu"),a.datum=f(a),a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(a,b){b.exports=function(a,b){a=a||{};var c,d;if(!b)return a;for(d in b)c=b[d],void 0!==c&&(a[d]=c);return a}},{}],34:[function(a,b){b.exports=function(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a.WGS84=a["EPSG:4326"],a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]}},{}],35:[function(a,b){var c=a("./core");c.defaultDatum="WGS84",c.Proj=a("./Proj"),c.WGS84=new c.Proj("WGS84"),c.Point=a("./Point"),c.toPoint=a("./common/toPoint"),c.defs=a("./defs"),c.transform=a("./transform"),c.mgrs=a("mgrs"),c.version=a("../package.json").version,a("./includedProjections")(c),b.exports=c},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,"./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(a,b){function c(a){return"string"==typeof a}function d(a){return a in h}function e(a){var b=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return b.reduce(function(b,c){return b+1+a.indexOf(c)},0)}function f(a){return"+"===a[0]}function g(a){return c(a)?d(a)?h[a]:e(a)?i(a):f(a)?j(a):void 0:a}var h=a("./defs"),i=a("./wkt"),j=a("./projString");b.exports=g},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(a,b){var c=.017453292519943295,d=a("./constants/PrimeMeridian");b.exports=function(a){var b={},e={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){var b=a.split("=");b.push(!0),e[b[0].toLowerCase()]=b[1]});var f,g,h,i={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a,10)},lat_0:function(a){b.lat0=a*c},lat_1:function(a){b.lat1=a*c},lat_2:function(a){b.lat2=a*c},lat_ts:function(a){b.lat_ts=a*c},lon_0:function(a){b.long0=a*c},lon_1:function(a){b.long1=a*c},lon_2:function(a){b.long2=a*c},alpha:function(a){b.alpha=parseFloat(a)*c},lonc:function(a){b.longc=a*c},x_0:function(a){b.x0=parseFloat(a,10)},y_0:function(a){b.y0=parseFloat(a,10)},k_0:function(a){b.k0=parseFloat(a,10)},k:function(a){b.k0=parseFloat(a,10)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a,10)})},to_meter:function(a){b.to_meter=parseFloat(a,10)},from_greenwich:function(a){b.from_greenwich=a*c},pm:function(a){b.from_greenwich=(d[a]?d[a]:parseFloat(a,10))*c},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){var c="ewnsud";3===a.length&&-1!==c.indexOf(a.substr(0,1))&&-1!==c.indexOf(a.substr(1,1))&&-1!==c.indexOf(a.substr(2,1))&&(b.axis=a)}};for(f in e)g=e[f],f in i?(h=i[f],"function"==typeof h?h(g):b[h]=g):b[f]=g;return"string"==typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase()),b}},{"./constants/PrimeMeridian":27}],38:[function(a,b,c){function d(a,b){var c=g.length;return a.names?(g[c]=a,a.names.forEach(function(a){f[a.toLowerCase()]=c}),this):(console.log(b),!0)}var e=[a("./projections/merc"),a("./projections/longlat")],f={},g=[];c.add=d,c.get=function(a){if(!a)return!1;var b=a.toLowerCase();return"undefined"!=typeof f[b]&&g[f[b]]?g[f[b]]:void 0},c.start=function(){e.forEach(d)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/qsfnz"),g=a("../common/adjust_lon"),h=a("../common/asinz");c.init=function(){Math.abs(this.lat1+this.lat2)<d||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=e(this.e3,this.sin_po,this.cos_po),this.qs1=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=e(this.e3,this.sin_po,this.cos_po),this.qs2=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=f(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>d?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},c.forward=function(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c),this.cos_phi=Math.cos(c);var d=f(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,h=this.ns0*g(b-this.long0),i=e*Math.sin(h)+this.x0,j=this.rh-e*Math.cos(h)+this.y0;return a.x=i,a.y=j,a},c.inverse=function(a){var b,c,d,e,f,h;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),e=0,0!==b&&(e=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?h=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,h=this.phi1z(this.e3,c)),f=g(e/this.ns0+this.long0),a.x=f,a.y=h,a},c.phi1z=function(a,b){var c,e,f,g,i,j=h(.5*b);if(d>a)return j;for(var k=a*a,l=1;25>=l;l++)if(c=Math.sin(j),e=Math.cos(j),f=a*c,g=1-f*f,i=.5*g*g/e*(b/(1-k)-c/g+.5/a*Math.log((1-f)/(1+f))),j+=i,Math.abs(i)<=1e-7)return j;return null},c.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],40:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/mlfn"),h=a("../common/e0fn"),i=a("../common/e1fn"),j=a("../common/e2fn"),k=a("../common/e3fn"),l=a("../common/gN"),m=a("../common/asinz"),n=a("../common/imlfn");c.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},c.forward=function(a){var b,c,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=a.x,I=a.y,J=Math.sin(a.y),K=Math.cos(a.y),L=d(H-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=f?(a.x=this.x0+this.a*(e-I)*Math.sin(L),a.y=this.y0-this.a*(e-I)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(a.x=this.x0+this.a*(e+I)*Math.sin(L),a.y=this.y0+this.a*(e+I)*Math.cos(L),a):(B=this.sin_p12*J+this.cos_p12*K*Math.cos(L),z=Math.acos(B),A=z/Math.sin(z),a.x=this.x0+this.a*A*K*Math.sin(L),a.y=this.y0+this.a*A*(this.cos_p12*J-this.sin_p12*K*Math.cos(L)),a):(b=h(this.es),c=i(this.es),m=j(this.es),n=k(this.es),Math.abs(this.sin_p12-1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o-p)*Math.sin(L),a.y=this.y0-(o-p)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o+p)*Math.sin(L),a.y=this.y0+(o+p)*Math.cos(L),a):(q=J/K,r=l(this.a,this.e,this.sin_p12),s=l(this.a,this.e,J),t=Math.atan((1-this.es)*q+this.es*r*this.sin_p12/(s*K)),u=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(t)-this.sin_p12*Math.cos(L)),C=0===u?Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.abs(Math.abs(u)-Math.PI)<=f?-Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.asin(Math.sin(L)*Math.cos(t)/Math.sin(u)),v=this.e*this.sin_p12/Math.sqrt(1-this.es),w=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es),x=v*w,y=w*w,D=C*C,E=D*C,F=E*C,G=F*C,z=r*C*(1-D*y*(1-y)/6+E/8*x*(1-2*y)+F/120*(y*(4-7*y)-3*v*v*(1-7*y))-G/48*x),a.x=this.x0+z*Math.sin(u),a.y=this.y0+z*Math.cos(u),a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;if(this.sphere){if(b=Math.sqrt(a.x*a.x+a.y*a.y),b>2*e*this.a)return;return c=b/this.a,o=Math.sin(c),p=Math.cos(c),q=this.long0,Math.abs(b)<=f?r=this.lat0:(r=m(p*this.sin_p12+a.y*o*this.cos_p12/b),s=Math.abs(this.lat0)-e,q=d(Math.abs(s)<=f?this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*o,b*this.cos_p12*p-a.y*this.sin_p12*o))),a.x=q,a.y=r,a}return t=h(this.es),u=i(this.es),v=j(this.es),w=k(this.es),Math.abs(this.sin_p12-1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=x-b,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,-1*a.y)),a.x=q,a.y=r,a):Math.abs(this.sin_p12+1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=b-x,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,a.y)),a.x=q,a.y=r,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),B=Math.atan2(a.x,a.y),z=l(this.a,this.e,this.sin_p12),C=Math.cos(B),D=this.e*this.cos_p12*C,E=-D*D/(1-this.es),F=3*this.es*(1-E)*this.sin_p12*this.cos_p12*C/(1-this.es),G=b/z,H=G-E*(1+E)*Math.pow(G,3)/6-F*(1+3*E)*Math.pow(G,4)/24,I=1-E*H*H/2-G*H*H*H/6,A=Math.asin(this.sin_p12*Math.cos(H)+this.cos_p12*Math.sin(H)*C),q=d(this.long0+Math.asin(Math.sin(B)*Math.sin(H)/Math.cos(A))),r=Math.atan((1-this.es*I*this.sin_p12/Math.sin(A))*Math.tan(A)/(1-this.es)),a.x=q,a.y=r,a)},c.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(a,b,c){var d=a("../common/mlfn"),e=a("../common/e0fn"),f=a("../common/e1fn"),g=a("../common/e2fn"),h=a("../common/e3fn"),i=a("../common/gN"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=Math.PI/2,n=1e-10;c.init=function(){this.sphere||(this.e0=e(this.es),this.e1=f(this.es),this.e2=g(this.es),this.e3=h(this.es),this.ml0=this.a*d(this.e0,this.e1,this.e2,this.e3,this.lat0))},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=j(e-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(f)*Math.sin(e)),c=this.a*(Math.atan2(Math.tan(f),Math.cos(e))-this.lat0);else{var g=Math.sin(f),h=Math.cos(f),k=i(this.a,this.e,g),l=Math.tan(f)*Math.tan(f),m=e*Math.cos(f),n=m*m,o=this.es*h*h/(1-this.es),p=this.a*d(this.e0,this.e1,this.e2,this.e3,f);b=k*m*(1-n*l*(1/6-(8-l+8*o)*n/120)),c=p-this.ml0+k*g/h*n*(.5+(5-l+6*o)*n/24)}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d=a.x/this.a,e=a.y/this.a;if(this.sphere){var f=e+this.lat0;b=Math.asin(Math.sin(f)*Math.cos(d)),c=Math.atan2(Math.tan(d),Math.cos(f))}else{var g=this.ml0/this.a+e,h=l(g,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(h)-m)<=n)return a.x=this.long0,a.y=m,0>e&&(a.y*=-1),a;var o=i(this.a,this.e,Math.sin(h)),p=o*o*o/this.a/this.a*(1-this.es),q=Math.pow(Math.tan(h),2),r=d*this.a/o,s=r*r;b=h-o*Math.tan(h)/p*r*r*(.5-(1+3*q)*r*r/24),c=r*(1-s*(q/3+(1+3*q)*q*s/15))/Math.cos(h)}return a.x=j(c+this.long0),a.y=k(b),a},c.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/qsfnz"),f=a("../common/msfnz"),g=a("../common/iqsfnz");c.init=function(){this.sphere||(this.k0=f(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},c.forward=function(a){var b,c,f=a.x,g=a.y,h=d(f-this.long0);if(this.sphere)b=this.x0+this.a*h*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(g)/Math.cos(this.lat_ts);else{var i=e(this.e,Math.sin(g));b=this.x0+this.a*this.k0*h,c=this.y0+this.a*i*.5/this.k0}return a.x=b,a.y=c,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c;return this.sphere?(b=d(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=g(this.e,2*a.y*this.k0/this.a),b=d(this.long0+a.x/(this.a*this.k0))),a.x=b,a.y=c,a},c.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat");c.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},c.forward=function(a){var b=a.x,c=a.y,f=d(b-this.long0),g=e(c-this.lat0);return a.x=this.x0+this.a*f*this.rc,a.y=this.y0+this.a*g,a},c.inverse=function(a){var b=a.x,c=a.y;return a.x=d(this.long0+(b-this.x0)/(this.a*this.rc)),a.y=e(this.lat0+(c-this.y0)/this.a),a},c.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/msfnz"),i=a("../common/mlfn"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=1e-10;c.init=function(){Math.abs(this.lat1+this.lat2)<m||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=h(this.e,this.sinphi,this.cosphi),this.ml1=i(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<m?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=h(this.e,this.sinphi,this.cosphi),this.ml2=i(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=i(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},c.forward=function(a){var b,c=a.x,d=a.y;if(this.sphere)b=this.a*(this.g-d);else{var e=i(this.e0,this.e1,this.e2,this.e3,d);b=this.a*(this.g-e)}var f=this.ns*j(c-this.long0),g=this.x0+b*Math.sin(f),h=this.y0+this.rh-b*Math.cos(f);return a.x=g,a.y=h,a},c.inverse=function(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var b,c,d,e;this.ns>=0?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var f=0;if(0!==c&&(f=Math.atan2(b*a.x,b*a.y)),this.sphere)return e=j(this.long0+f/this.ns),d=k(this.g-c/this.a),a.x=e,a.y=d,a;var g=this.g-c/this.a;return d=l(g,this.e0,this.e1,this.e2,this.e3),e=j(this.long0+f/this.ns),a.x=e,a.y=d,a},c.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(a,b,c){var d=Math.PI/4,e=a("../common/srat"),f=Math.PI/2,g=20;c.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+d)/(Math.pow(Math.tan(.5*this.lat0+d),this.C)*e(this.e*a,this.ratexp))},c.forward=function(a){var b=a.x,c=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+d),this.C)*e(this.e*Math.sin(c),this.ratexp))-f,a.x=this.C*b,a},c.inverse=function(a){for(var b=1e-14,c=a.x/this.C,h=a.y,i=Math.pow(Math.tan(.5*h+d)/this.K,1/this.C),j=g;j>0&&(h=2*Math.atan(i*e(this.e*Math.sin(a.y),-.5*this.e))-f,!(Math.abs(h-a.y)<b));--j)a.y=h;return j?(a.x=c,a.y=h,a):null},c.names=["gauss"]},{"../common/srat":22}],46:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10,f=a("../common/asinz");c.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},c.forward=function(a){var b,c,f,g,h,i,j,k,l=a.x,m=a.y;return f=d(l-this.long0),b=Math.sin(m),c=Math.cos(m),g=Math.cos(f),i=this.sin_p14*b+this.cos_p14*c*g,h=1,i>0||Math.abs(i)<=e?(j=this.x0+this.a*h*c*Math.sin(f)/i,k=this.y0+this.a*h*(this.cos_p14*b-this.sin_p14*c*g)/i):(j=this.x0+this.infinity_dist*c*Math.sin(f),k=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*g)),a.x=j,a.y=k,a},c.inverse=function(a){var b,c,e,g,h,i;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(g=Math.atan2(b,this.rc),c=Math.sin(g),e=Math.cos(g),i=f(e*this.sin_p14+a.y*c*this.cos_p14/b),h=Math.atan2(a.x*c,b*this.cos_p14*e-a.y*this.sin_p14*c),h=d(this.long0+h)):(i=this.phic0,h=0),a.x=h,a.y=i,a},c.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},c.forward=function(a){var b,c,e,f,g,h,i,j=a.x,k=a.y,l=d(j-this.long0);return b=Math.pow((1+this.e*Math.sin(k))/(1-this.e*Math.sin(k)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(k/2+this.s45),this.alfa)/b)-this.s45),e=-l*this.alfa,f=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(e)),g=Math.asin(Math.cos(c)*Math.sin(e)/Math.cos(f)),h=this.n*g,i=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n),a.y=i*Math.cos(h)/1,a.x=i*Math.sin(h)/1,this.czech||(a.y*=-1,a.x*=-1),a},c.inverse=function(a){var b,c,d,e,f,g,h,i,j=a.x;a.x=a.y,a.y=j,this.czech||(a.y*=-1,a.x*=-1),g=Math.sqrt(a.x*a.x+a.y*a.y),f=Math.atan2(a.y,a.x),e=f/Math.sin(this.s0),d=2*(Math.atan(Math.pow(this.ro0/g,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(e)),c=Math.asin(Math.cos(d)*Math.sin(e)/Math.cos(b)),a.x=this.long0-c/this.alfa,h=b,i=0;var k=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.e/2))-this.s45),Math.abs(h-a.y)<1e-10&&(i=1),h=a.y,k+=1;while(0===i&&15>k);return k>=15?null:a},c.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(a,b,c){var d=Math.PI/2,e=Math.PI/4,f=1e-10,g=a("../common/qsfnz"),h=a("../common/adjust_lon");c.S_POLE=1,c.N_POLE=2,c.EQUIT=3,c.OBLIQ=4,c.init=function(){var a=Math.abs(this.lat0);if(this.mode=Math.abs(a-d)<f?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<f?this.EQUIT:this.OBLIQ,this.es>0){var b;switch(this.qp=g(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=g(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},c.forward=function(a){var b,c,i,j,k,l,m,n,o,p,q=a.x,r=a.y;if(q=h(q-this.long0),this.sphere){if(k=Math.sin(r),p=Math.cos(r),i=Math.cos(q),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=this.mode===this.EQUIT?1+p*i:1+this.sinph0*k+this.cosph0*p*i,f>=c)return null;c=Math.sqrt(2/c),b=c*p*Math.sin(q),c*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*p*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(r+this.phi0)<f)return null;c=e-.5*r,c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)),b=c*Math.sin(q),c*=i}}else{switch(m=0,n=0,o=0,i=Math.cos(q),j=Math.sin(q),k=Math.sin(r),l=g(this.e,k),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=l/this.qp,n=Math.sqrt(1-m*m)),this.mode){case this.OBLIQ:o=1+this.sinb1*m+this.cosb1*n*i;break;case this.EQUIT:o=1+n*i;break;case this.N_POLE:o=d+r,l=this.qp-l;break;case this.S_POLE:o=r-d,l=this.qp+l}if(Math.abs(o)<f)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:o=Math.sqrt(2/o),c=this.mode===this.OBLIQ?this.ymf*o*(this.cosb1*m-this.sinb1*n*i):(o=Math.sqrt(2/(1+n*i)))*m*this.ymf,b=this.xmf*o*n*j;break;case this.N_POLE:case this.S_POLE:l>=0?(b=(o=Math.sqrt(l))*j,c=i*(this.mode===this.S_POLE?o:-o)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,e,g,i,j,k,l=a.x/this.a,m=a.y/this.a;if(this.sphere){var n,o=0,p=0;if(n=Math.sqrt(l*l+m*m),c=.5*n,c>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(c),o=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(n)<=f?0:Math.asin(m*p/n),l*=p,m=o*n;break;case this.OBLIQ:c=Math.abs(n)<=f?this.phi0:Math.asin(o*this.sinph0+m*p*this.cosph0/n),l*=p*this.cosph0,m=(o-Math.sin(c)*this.sinph0)*n;break;case this.N_POLE:m=-m,c=d-c;break;case this.S_POLE:c-=d}b=0!==m||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,m):0}else{if(k=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,m*=this.dd,j=Math.sqrt(l*l+m*m),f>j)return a.x=0,a.y=this.phi0,a;g=2*Math.asin(.5*j/this.rq),e=Math.cos(g),l*=g=Math.sin(g),this.mode===this.OBLIQ?(k=e*this.sinb1+m*g*this.cosb1/j,i=this.qp*k,m=j*this.cosb1*e-m*this.sinb1*g):(k=m*g/j,i=this.qp*k,m=j*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(m=-m),i=l*l+m*m,!i)return a.x=0,a.y=this.phi0,a;k=1-i/this.qp,this.mode===this.S_POLE&&(k=-k)}b=Math.atan2(l,m),c=this.authlat(Math.asin(k),this.apa)}return a.x=h(this.long0+b),a.y=c,a},c.P00=.3333333333333333,c.P01=.17222222222222222,c.P02=.10257936507936508,c.P10=.06388888888888888,c.P11=.0664021164021164,c.P20=.016415012942191543,c.authset=function(a){var b,c=[];return c[0]=a*this.P00,b=a*a,c[0]+=b*this.P01,c[1]=b*this.P10,b*=a,c[0]+=b*this.P02,c[1]+=b*this.P11,c[2]=b*this.P20,c},c.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)},c.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/tsfnz"),g=Math.PI/2,h=a("../common/sign"),i=a("../common/adjust_lon"),j=a("../common/phi2z");c.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<d)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),g=e(this.e,b,c),h=f(this.e,this.lat1,b),i=Math.sin(this.lat2),j=Math.cos(this.lat2),k=e(this.e,i,j),l=f(this.e,this.lat2,i),m=f(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>d?Math.log(g/k)/Math.log(h/l):b,isNaN(this.ns)&&(this.ns=b),this.f0=g/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(m,this.ns),this.title||(this.title="Lambert Conformal Conic")}},c.forward=function(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=d&&(c=h(c)*(g-2*d));var e,j,k=Math.abs(Math.abs(c)-g);if(k>d)e=f(this.e,c,Math.sin(c)),j=this.a*this.f0*Math.pow(e,this.ns);else{if(k=c*this.ns,0>=k)return null;j=0}var l=this.ns*i(b-this.long0);return a.x=this.k0*j*Math.sin(l)+this.x0,a.y=this.k0*(this.rh-j*Math.cos(l))+this.y0,a},c.inverse=function(a){var b,c,d,e,f,h=(a.x-this.x0)/this.k0,k=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(h*h+k*k),c=1):(b=-Math.sqrt(h*h+k*k),c=-1);var l=0;if(0!==b&&(l=Math.atan2(c*h,c*k)),0!==b||this.ns>0){if(c=1/this.ns,d=Math.pow(b/(this.a*this.f0),c),e=j(this.e,d),-9999===e)return null}else e=-g;return f=i(l/this.ns+this.long0),a.x=f,a.y=e,a},c.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(a,b,c){function d(a){return a}c.init=function(){},c.forward=d,c.inverse=d,c.names=["longlat","identity"]},{}],51:[function(a,b,c){var d=a("../common/msfnz"),e=Math.PI/2,f=1e-10,g=57.29577951308232,h=a("../common/adjust_lon"),i=Math.PI/4,j=a("../common/tsfnz"),k=a("../common/phi2z");c.init=function(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):d(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},c.forward=function(a){var b=a.x,c=a.y;if(c*g>90&&-90>c*g&&b*g>180&&-180>b*g)return null;var d,k;if(Math.abs(Math.abs(c)-e)<=f)return null;if(this.sphere)d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0+this.a*this.k0*Math.log(Math.tan(i+.5*c));else{var l=Math.sin(c),m=j(this.e,c,l);d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0-this.a*this.k0*Math.log(m)}return a.x=d,a.y=k,a},c.inverse=function(a){var b,c,d=a.x-this.x0,f=a.y-this.y0;if(this.sphere)c=e-2*Math.atan(Math.exp(-f/(this.a*this.k0)));else{var g=Math.exp(-f/(this.a*this.k0));if(c=k(this.e,g),-9999===c)return null}return b=h(this.long0+d/(this.a*this.k0)),a.x=b,a.y=c,a},c.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){},c.forward=function(a){var b=a.x,c=a.y,e=d(b-this.long0),f=this.x0+this.a*e,g=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return a.x=f,a.y=g,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b=d(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a},c.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10;c.init=function(){},c.forward=function(a){for(var b=a.x,c=a.y,f=d(b-this.long0),g=c,h=Math.PI*Math.sin(c),i=0;!0;i++){var j=-(g+Math.sin(g)-h)/(1+Math.cos(g));if(g+=j,Math.abs(j)<e)break}g/=2,Math.PI/2-Math.abs(c)<e&&(f=0);var k=.900316316158*this.a*f*Math.cos(g)+this.x0,l=1.4142135623731*this.a*Math.sin(g)+this.y0;return a.x=k,a.y=l,a},c.inverse=function(a){var b,c;a.x-=this.x0,a.y-=this.y0,c=a.y/(1.4142135623731*this.a),Math.abs(c)>.999999999999&&(c=.999999999999),b=Math.asin(c);var e=d(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));e<-Math.PI&&(e=-Math.PI),e>Math.PI&&(e=Math.PI),c=(2*b+Math.sin(2*b))/Math.PI,Math.abs(c)>1&&(c=1);var f=Math.asin(c);return a.x=e,a.y=f,a},c.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],54:[function(a,b,c){var d=484813681109536e-20;c.iterations=1,c.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013
},c.forward=function(a){var b,c=a.x,e=a.y,f=e-this.lat0,g=c-this.long0,h=f/d*1e-5,i=g,j=1,k=0;for(b=1;10>=b;b++)j*=h,k+=this.A[b]*j;var l,m,n=k,o=i,p=1,q=0,r=0,s=0;for(b=1;6>=b;b++)l=p*n-q*o,m=q*n+p*o,p=l,q=m,r=r+this.B_re[b]*p-this.B_im[b]*q,s=s+this.B_im[b]*p+this.B_re[b]*q;return a.x=s*this.a+this.x0,a.y=r*this.a+this.y0,a},c.inverse=function(a){var b,c,e,f=a.x,g=a.y,h=f-this.x0,i=g-this.y0,j=i/this.a,k=h/this.a,l=1,m=0,n=0,o=0;for(b=1;6>=b;b++)c=l*j-m*k,e=m*j+l*k,l=c,m=e,n=n+this.C_re[b]*l-this.C_im[b]*m,o=o+this.C_im[b]*l+this.C_re[b]*m;for(var p=0;p<this.iterations;p++){var q,r,s=n,t=o,u=j,v=k;for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,u+=(b-1)*(this.B_re[b]*s-this.B_im[b]*t),v+=(b-1)*(this.B_im[b]*s+this.B_re[b]*t);s=1,t=0;var w=this.B_re[1],x=this.B_im[1];for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,w+=b*(this.B_re[b]*s-this.B_im[b]*t),x+=b*(this.B_im[b]*s+this.B_re[b]*t);var y=w*w+x*x;n=(u*w+v*x)/y,o=(v*w-u*x)/y}var z=n,A=o,B=1,C=0;for(b=1;9>=b;b++)B*=z,C+=this.D[b]*B;var D=this.lat0+C*d*1e5,E=this.long0+A;return a.x=E,a.y=D,a},c.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(a,b,c){var d=a("../common/tsfnz"),e=a("../common/adjust_lon"),f=a("../common/phi2z"),g=Math.PI/2,h=Math.PI/4,i=1e-10;c.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-c*c);var f=d(this.e,this.lat0,a),g=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));1>g*g&&(g=1);var h,i;if(isNaN(this.longc)){var j=d(this.e,this.lat1,Math.sin(this.lat1)),k=d(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0>=0?(g+Math.sqrt(g*g-1))*Math.pow(f,this.bl):(g-Math.sqrt(g*g-1))*Math.pow(f,this.bl);var l=Math.pow(j,this.bl),m=Math.pow(k,this.bl);h=this.el/l,i=.5*(h-1/h);var n=(this.el*this.el-m*l)/(this.el*this.el+m*l),o=(m-l)/(m+l),p=e(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(n*Math.tan(.5*this.bl*p)/o)/this.bl,this.long0=e(this.long0);var q=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*q)/i),this.alpha=Math.asin(g*Math.sin(this.gamma0))}else h=this.lat0>=0?g+Math.sqrt(g*g-1):g-Math.sqrt(g*g-1),this.el=h*Math.pow(f,this.bl),i=.5*(h-1/h),this.gamma0=Math.asin(Math.sin(this.alpha)/g),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0>=0?this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha))},c.forward=function(a){var b,c,f,j=a.x,k=a.y,l=e(j-this.long0);if(Math.abs(Math.abs(k)-g)<=i)f=k>0?-1:1,c=this.al/this.bl*Math.log(Math.tan(h+f*this.gamma0*.5)),b=-1*f*g*this.al/this.bl;else{var m=d(this.e,k,Math.sin(k)),n=this.el/Math.pow(m,this.bl),o=.5*(n-1/n),p=.5*(n+1/n),q=Math.sin(this.bl*l),r=(o*Math.sin(this.gamma0)-q*Math.cos(this.gamma0))/p;c=Math.abs(Math.abs(r)-1)<=i?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-r)/(1+r))/this.bl,b=Math.abs(Math.cos(this.bl*l))<=i?this.al*this.bl*l:this.al*Math.atan2(o*Math.cos(this.gamma0)+q*Math.sin(this.gamma0),Math.cos(this.bl*l))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a},c.inverse=function(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var d=Math.exp(-1*this.bl*c/this.al),h=.5*(d-1/d),j=.5*(d+1/d),k=Math.sin(this.bl*b/this.al),l=(k*Math.cos(this.gamma0)+h*Math.sin(this.gamma0))/j,m=Math.pow(this.el/Math.sqrt((1+l)/(1-l)),1/this.bl);return Math.abs(l-1)<i?(a.x=this.long0,a.y=g):Math.abs(l+1)<i?(a.x=this.long0,a.y=-1*g):(a.y=f(this.e,m),a.x=e(this.long0-Math.atan2(h*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a},c.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/adjust_lon"),i=a("../common/adjust_lat"),j=a("../common/mlfn"),k=1e-10,l=a("../common/gN"),m=20;c.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*j(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=h(e-this.long0);if(d=g*Math.sin(f),this.sphere)Math.abs(f)<=k?(b=this.a*g,c=-1*this.a*this.lat0):(b=this.a*Math.sin(d)/Math.tan(f),c=this.a*(i(f-this.lat0)+(1-Math.cos(d))/Math.tan(f)));else if(Math.abs(f)<=k)b=this.a*g,c=-1*this.ml0;else{var m=l(this.a,this.e,Math.sin(f))/Math.tan(f);b=m*Math.sin(d),c=this.a*j(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+m*(1-Math.cos(d))}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){var b,c,d,e,f,g,i,l,n;if(d=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=k)b=h(d/this.a+this.long0),c=0;else{g=this.lat0+e/this.a,i=d*d/this.a/this.a+g*g,l=g;var o;for(f=m;f;--f)if(o=Math.tan(l),n=-1*(g*(l*o+1)-l-.5*(l*l+i)*o)/((l-g)/o-1),l+=n,Math.abs(n)<=k){c=l;break}b=h(this.long0+Math.asin(d*Math.tan(l)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=k)c=0,b=h(this.long0+d/this.a);else{g=(this.ml0+e)/this.a,i=d*d/this.a/this.a+g*g,l=g;var p,q,r,s,t;for(f=m;f;--f)if(t=this.e*Math.sin(l),p=Math.sqrt(1-t*t)*Math.tan(l),q=this.a*j(this.e0,this.e1,this.e2,this.e3,l),r=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),s=q/this.a,n=(g*(p*s+1)-s-.5*p*(s*s+i))/(this.es*Math.sin(2*l)*(s*s+i-2*g*s)/(4*p)+(g-s)*(p*r-2/Math.sin(2*l))-r),l-=n,Math.abs(n)<=k){c=l;break}p=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c),b=h(this.long0+Math.asin(d*p/this.a)/Math.sin(c))}return a.x=b,a.y=c,a},c.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat"),f=a("../common/pj_enfn"),g=20,h=a("../common/pj_mlfn"),i=a("../common/pj_inv_mlfn"),j=Math.PI/2,k=1e-10,l=a("../common/asinz");c.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=f(this.es)},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=d(e-this.long0),this.sphere){if(this.m)for(var i=this.n*Math.sin(f),j=g;j;--j){var l=(this.m*f+Math.sin(f)-i)/(this.m+Math.cos(f));if(f-=l,Math.abs(l)<k)break}else f=1!==this.n?Math.asin(this.n*Math.sin(f)):f;b=this.a*this.C_x*e*(this.m+Math.cos(f)),c=this.a*this.C_y*f}else{var m=Math.sin(f),n=Math.cos(f);c=this.a*h(f,m,n,this.en),b=this.a*e*n/Math.sqrt(1-this.es*m*m)}return a.x=b,a.y=c,a},c.inverse=function(a){var b,c,f,g;return a.x-=this.x0,f=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,f/=this.C_x*(this.m+Math.cos(b)),this.m?b=l((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=l(Math.sin(b)/this.n)),f=d(f+this.long0),b=e(b)):(b=i(a.y/this.a,this.es,this.en),g=Math.abs(b),j>g?(g=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*g*g)/(this.a*Math.cos(b)),f=d(c)):j>g-k&&(f=this.long0)),a.x=f,a.y=b,a},c.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(a,b,c){c.init=function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,d=this.rf,e=1/d,f=2*e-Math.pow(e,2),g=this.e=Math.sqrt(f);this.R=this.k0*c*Math.sqrt(1-f)/(1-f*Math.pow(b,2)),this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(b/this.alpha);var h=Math.log(Math.tan(Math.PI/4+this.b0/2)),i=Math.log(Math.tan(Math.PI/4+a/2)),j=Math.log((1+g*b)/(1-g*b));this.K=h-this.alpha*i+this.alpha*g/2*j},c.forward=function(a){var b=Math.log(Math.tan(Math.PI/4-a.y/2)),c=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),d=-this.alpha*(b+c)+this.K,e=2*(Math.atan(Math.exp(d))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),g=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(f))),h=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(h))/(1-Math.sin(h)))+this.y0,a.x=this.R*g+this.x0,a},c.inverse=function(a){for(var b=a.x-this.x0,c=a.y-this.y0,d=b/this.R,e=2*(Math.atan(Math.exp(c/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(d)),g=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(e))),h=this.lambda0+g/this.alpha,i=0,j=f,k=-1e3,l=0;Math.abs(j-k)>1e-7;){if(++l>20)return;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(j))/2)),k=j,j=2*Math.atan(Math.exp(i))-Math.PI/2}return a.x=h,a.y=j,a},c.names=["somerc"]},{}],59:[function(a,b,c){var d=Math.PI/2,e=1e-10,f=a("../common/sign"),g=a("../common/msfnz"),h=a("../common/tsfnz"),i=a("../common/phi2z"),j=a("../common/adjust_lon");c.ssfn_=function(a,b,c){return b*=c,Math.tan(.5*(d+a))*Math.pow((1-b)/(1+b),.5*c)},c.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*(1+f(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=e&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*this.cons*g(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/h(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=g(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-d,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},c.forward=function(a){var b,c,f,g,i,k,l=a.x,m=a.y,n=Math.sin(m),o=Math.cos(m),p=j(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=e&&Math.abs(m+this.lat0)<=e?(a.x=0/0,a.y=0/0,a):this.sphere?(b=2*this.k0/(1+this.sinlat0*n+this.coslat0*o*Math.cos(p)),a.x=this.a*b*o*Math.sin(p)+this.x0,a.y=this.a*b*(this.coslat0*n-this.sinlat0*o*Math.cos(p))+this.y0,a):(c=2*Math.atan(this.ssfn_(m,n,this.e))-d,g=Math.cos(c),f=Math.sin(c),Math.abs(this.coslat0)<=e?(i=h(this.e,m*this.con,this.con*n),k=2*this.a*this.k0*i/this.cons,a.x=this.x0+k*Math.sin(l-this.long0),a.y=this.y0-this.con*k*Math.cos(l-this.long0),a):(Math.abs(this.sinlat0)<e?(b=2*this.a*this.k0/(1+g*Math.cos(p)),a.y=b*f):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*g*Math.cos(p))),a.y=b*(this.cosX0*f-this.sinX0*g*Math.cos(p))+this.y0),a.x=b*g*Math.sin(p)+this.x0,a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,f,g,h,k=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var l=2*Math.atan(k/(.5*this.a*this.k0));return b=this.long0,c=this.lat0,e>=k?(a.x=b,a.y=c,a):(c=Math.asin(Math.cos(l)*this.sinlat0+a.y*Math.sin(l)*this.coslat0/k),b=j(Math.abs(this.coslat0)<e?this.lat0>0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(l),k*this.coslat0*Math.cos(l)-a.y*this.sinlat0*Math.sin(l))),a.x=b,a.y=c,a)}if(Math.abs(this.coslat0)<=e){if(e>=k)return c=this.lat0,b=this.long0,a.x=b,a.y=c,a;a.x*=this.con,a.y*=this.con,f=k*this.cons/(2*this.a*this.k0),c=this.con*i(this.e,f),b=this.con*j(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else g=2*Math.atan(k*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,e>=k?h=this.X0:(h=Math.asin(Math.cos(g)*this.sinX0+a.y*Math.sin(g)*this.cosX0/k),b=j(this.long0+Math.atan2(a.x*Math.sin(g),k*this.cosX0*Math.cos(g)-a.y*this.sinX0*Math.sin(g)))),c=-1*i(this.e,Math.tan(.5*(d+h)));return a.x=b,a.y=c,a},c.names=["stere"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(a,b,c){var d=a("./gauss"),e=a("../common/adjust_lon");c.init=function(){d.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},c.forward=function(a){var b,c,f,g;return a.x=e(a.x-this.long0),d.forward.apply(this,[a]),b=Math.sin(a.y),c=Math.cos(a.y),f=Math.cos(a.x),g=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*c*f),a.x=g*c*Math.sin(a.x),a.y=g*(this.cosc0*b-this.sinc0*c*f),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},c.inverse=function(a){var b,c,f,g,h;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,h=Math.sqrt(a.x*a.x+a.y*a.y)){var i=2*Math.atan2(h,this.R2);b=Math.sin(i),c=Math.cos(i),g=Math.asin(c*this.sinc0+a.y*b*this.cosc0/h),f=Math.atan2(a.x*b,h*this.cosc0*c-a.y*this.sinc0*b)}else g=this.phic0,f=0;return a.x=f,a.y=g,d.inverse.apply(this,[a]),a.x=e(a.x+this.long0),a},c.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/mlfn"),i=a("../common/adjust_lon"),j=Math.PI/2,k=1e-10,l=a("../common/sign"),m=a("../common/asinz");c.init=function(){this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*h(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=i(e-this.long0),j=Math.sin(f),k=Math.cos(f);if(this.sphere){var l=k*Math.sin(g);if(Math.abs(Math.abs(l)-1)<1e-10)return 93;c=.5*this.a*this.k0*Math.log((1+l)/(1-l)),b=Math.acos(k*Math.cos(g)/Math.sqrt(1-l*l)),0>f&&(b=-b),d=this.a*this.k0*(b-this.lat0)}else{var m=k*g,n=Math.pow(m,2),o=this.ep2*Math.pow(k,2),p=Math.tan(f),q=Math.pow(p,2);b=1-this.es*Math.pow(j,2);var r=this.a/Math.sqrt(b),s=this.a*h(this.e0,this.e1,this.e2,this.e3,f);c=this.k0*r*m*(1+n/6*(1-q+o+n/20*(5-18*q+Math.pow(q,2)+72*o-58*this.ep2)))+this.x0,d=this.k0*(s-this.ml0+r*p*n*(.5+n/24*(5-q+9*o+4*Math.pow(o,2)+n/30*(61-58*q+Math.pow(q,2)+600*o-330*this.ep2))))+this.y0}return a.x=c,a.y=d,a},c.inverse=function(a){var b,c,d,e,f,g,h=6;if(this.sphere){var n=Math.exp(a.x/(this.a*this.k0)),o=.5*(n-1/n),p=this.lat0+a.y/(this.a*this.k0),q=Math.cos(p);b=Math.sqrt((1-q*q)/(1+o*o)),f=m(b),0>p&&(f=-f),g=0===o&&0===q?this.long0:i(Math.atan2(o,q)+this.long0)}else{var r=a.x-this.x0,s=a.y-this.y0;for(b=(this.ml0+s/this.k0)/this.a,c=b,e=0;d=(b+this.e1*Math.sin(2*c)-this.e2*Math.sin(4*c)+this.e3*Math.sin(6*c))/this.e0-c,c+=d,!(Math.abs(d)<=k);e++)if(e>=h)return 95;if(Math.abs(c)<j){var t=Math.sin(c),u=Math.cos(c),v=Math.tan(c),w=this.ep2*Math.pow(u,2),x=Math.pow(w,2),y=Math.pow(v,2),z=Math.pow(y,2);b=1-this.es*Math.pow(t,2);var A=this.a/Math.sqrt(b),B=A*(1-this.es)/b,C=r/(A*this.k0),D=Math.pow(C,2);f=c-A*v*D/B*(.5-D/24*(5+3*y+10*w-4*x-9*this.ep2-D/30*(61+90*y+298*w+45*z-252*this.ep2-3*x))),g=i(this.long0+C*(1-D/6*(1+2*y+w-D/20*(5-2*w+28*y-3*x+8*this.ep2+24*z)))/u)}else f=j*l(s),g=this.long0}return a.x=g,a.y=f,a},c.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(a,b,c){var d=.017453292519943295,e=a("./tmerc");c.dependsOn="tmerc",c.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*d,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,e.init.apply(this),this.forward=e.forward,this.inverse=e.inverse)},c.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/asinz");c.init=function(){this.R=this.a},c.forward=function(a){var b,c,h=a.x,i=a.y,j=d(h-this.long0);Math.abs(i)<=f&&(b=this.x0+this.R*j,c=this.y0);var k=g(2*Math.abs(i/Math.PI));(Math.abs(j)<=f||Math.abs(Math.abs(i)-e)<=f)&&(b=this.x0,c=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*k):this.y0+Math.PI*this.R*-Math.tan(.5*k));var l=.5*Math.abs(Math.PI/j-j/Math.PI),m=l*l,n=Math.sin(k),o=Math.cos(k),p=o/(n+o-1),q=p*p,r=p*(2/n-1),s=r*r,t=Math.PI*this.R*(l*(p-s)+Math.sqrt(m*(p-s)*(p-s)-(s+m)*(q-s)))/(s+m);0>j&&(t=-t),b=this.x0+t;var u=m+p;return t=Math.PI*this.R*(r*u-l*Math.sqrt((s+m)*(m+1)-u*u))/(s+m),c=i>=0?this.y0+t:this.y0-t,a.x=b,a.y=c,a},c.inverse=function(a){var b,c,e,g,h,i,j,k,l,m,n,o,p;return a.x-=this.x0,a.y-=this.y0,n=Math.PI*this.R,e=a.x/n,g=a.y/n,h=e*e+g*g,i=-Math.abs(g)*(1+h),j=i-2*g*g+e*e,k=-2*i+1+2*g*g+h*h,p=g*g/k+(2*j*j*j/k/k/k-9*i*j/k/k)/27,l=(i-j*j/3/k)/k,m=2*Math.sqrt(-l/3),n=3*p/l/m,Math.abs(n)>1&&(n=n>=0?1:-1),o=Math.acos(n)/3,c=a.y>=0?(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI:-(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI,b=Math.abs(e)<f?this.long0:d(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(e*e-g*g)+h*h))/2/e),a.x=b,a.y=c,a},c.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(a,b){var c=.017453292519943295,d=57.29577951308232,e=1,f=2,g=a("./datum_transform"),h=a("./adjust_axis"),i=a("./Proj"),j=a("./common/toPoint");b.exports=function k(a,b,l){function m(a,b){return(a.datum.datum_type===e||a.datum.datum_type===f)&&"WGS84"!==b.datumCode}var n;return Array.isArray(l)&&(l=j(l)),a.datum&&b.datum&&(m(a,b)||m(b,a))&&(n=new i("WGS84"),k(a,n,l),a=n),"enu"!==a.axis&&h(a,!1,l),"longlat"===a.projName?(l.x*=c,l.y*=c):(a.to_meter&&(l.x*=a.to_meter,l.y*=a.to_meter),a.inverse(l)),a.from_greenwich&&(l.x+=a.from_greenwich),l=g(a.datum,b.datum,l),b.from_greenwich&&(l.x-=b.from_greenwich),"longlat"===b.projName?(l.x*=d,l.y*=d):(b.forward(l),b.to_meter&&(l.x/=b.to_meter,l.y/=b.to_meter)),"enu"!==b.axis&&h(b,!0,l),l}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(a,b){function c(a,b,c){a[b]=c.map(function(a){var b={};return d(a,b),b}).reduce(function(a,b){return i(a,b)},{})}function d(a,b){var e;return Array.isArray(a)?(e=a.shift(),"PARAMETER"===e&&(e=a.shift()),void(1===a.length?Array.isArray(a[0])?(b[e]={},d(a[0],b[e])):b[e]=a[0]:a.length?"TOWGS84"===e?b[e]=a:(b[e]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(e)>-1?(b[e]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[e].auth=a[2])):"SPHEROID"===e?(b[e]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[e].auth=a[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(e)>-1?(a[0]=["name",a[0]],c(b,e,a)):a.every(function(a){return Array.isArray(a)})?c(b,e,a):d(a,b[e])):b[e]=!0)):void(b[a]=!0)}function e(a,b){var c=b[0],d=b[1];!(c in a)&&d in a&&(a[c]=a[d],3===b.length&&(a[c]=b[2](a[c])))}function f(a){return a*h}function g(a){function b(b){var c=a.to_meter||1;return parseFloat(b,10)*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):a.projName="object"==typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION,a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10))),a.GEOGCS&&(a.datumCode=a.GEOGCS.DATUM?a.GEOGCS.DATUM.name.toLowerCase():a.GEOGCS.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)&&(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10)),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")),a.b&&!isFinite(a.b)&&(a.b=a.a);var c=function(b){return e(a,b)},d=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",f],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",f],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",f],["lat0","latitude_of_origin",f],["lat0","standard_parallel_1",f],["lat1","standard_parallel_1",f],["lat2","standard_parallel_2",f],["alpha","azimuth",f],["srsCode","name"]];d.forEach(c),a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==a.PROJECTION||(a.long0=a.longc)}var h=.017453292519943295,i=a("./extend");b.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]')),e=c.shift(),f=c.shift();c.unshift(["name",f]),c.unshift(["type",e]),c.unshift("output");var h={};return d(c,h),g(h.output),i(b,h.output)}},{"./extend":33}],66:[function(a,b,c){function d(a){return a*(Math.PI/180)}function e(a){return 180*(a/Math.PI)}function f(a){var b,c,e,f,g,i,j,k,l,m=a.lat,n=a.lon,o=6378137,p=.00669438,q=.9996,r=d(m),s=d(n);l=Math.floor((n+180)/6)+1,180===n&&(l=60),m>=56&&64>m&&n>=3&&12>n&&(l=32),m>=72&&84>m&&(n>=0&&9>n?l=31:n>=9&&21>n?l=33:n>=21&&33>n?l=35:n>=33&&42>n&&(l=37)),b=6*(l-1)-180+3,k=d(b),c=p/(1-p),e=o/Math.sqrt(1-p*Math.sin(r)*Math.sin(r)),f=Math.tan(r)*Math.tan(r),g=c*Math.cos(r)*Math.cos(r),i=Math.cos(r)*(s-k),j=o*((1-p/4-3*p*p/64-5*p*p*p/256)*r-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*r)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*r)-35*p*p*p/3072*Math.sin(6*r));var t=q*e*(i+(1-f+g)*i*i*i/6+(5-18*f+f*f+72*g-58*c)*i*i*i*i*i/120)+5e5,u=q*(j+e*Math.tan(r)*(i*i/2+(5-f+9*g+4*g*g)*i*i*i*i/24+(61-58*f+f*f+600*g-330*c)*i*i*i*i*i*i/720));return 0>m&&(u+=1e7),{northing:Math.round(u),easting:Math.round(t),zoneNumber:l,zoneLetter:h(m)}}function g(a){var b=a.northing,c=a.easting,d=a.zoneLetter,f=a.zoneNumber;if(0>f||f>60)return null;var h,i,j,k,l,m,n,o,p,q,r=.9996,s=6378137,t=.00669438,u=(1-Math.sqrt(1-t))/(1+Math.sqrt(1-t)),v=c-5e5,w=b;"N">d&&(w-=1e7),o=6*(f-1)-180+3,h=t/(1-t),n=w/r,p=n/(s*(1-t/4-3*t*t/64-5*t*t*t/256)),q=p+(3*u/2-27*u*u*u/32)*Math.sin(2*p)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*p)+151*u*u*u/96*Math.sin(6*p),i=s/Math.sqrt(1-t*Math.sin(q)*Math.sin(q)),j=Math.tan(q)*Math.tan(q),k=h*Math.cos(q)*Math.cos(q),l=s*(1-t)/Math.pow(1-t*Math.sin(q)*Math.sin(q),1.5),m=v/(i*r);var x=q-i*Math.tan(q)/l*(m*m/2-(5+3*j+10*k-4*k*k-9*h)*m*m*m*m/24+(61+90*j+298*k+45*j*j-252*h-3*k*k)*m*m*m*m*m*m/720);x=e(x);var y=(m-(1+2*j+k)*m*m*m/6+(5-2*k+28*j-3*k*k+8*h+24*j*j)*m*m*m*m*m/120)/Math.cos(q);y=o+e(y);var z;if(a.accuracy){var A=g({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});z={top:A.lat,right:A.lon,bottom:x,left:y}}else z={lat:x,lon:y};return z}function h(a){var b="Z";return 84>=a&&a>=72?b="X":72>a&&a>=64?b="W":64>a&&a>=56?b="V":56>a&&a>=48?b="U":48>a&&a>=40?b="T":40>a&&a>=32?b="S":32>a&&a>=24?b="R":24>a&&a>=16?b="Q":16>a&&a>=8?b="P":8>a&&a>=0?b="N":0>a&&a>=-8?b="M":-8>a&&a>=-16?b="L":-16>a&&a>=-24?b="K":-24>a&&a>=-32?b="J":-32>a&&a>=-40?b="H":-40>a&&a>=-48?b="G":-48>a&&a>=-56?b="F":-56>a&&a>=-64?b="E":-64>a&&a>=-72?b="D":-72>a&&a>=-80&&(b="C"),b}function i(a,b){var c=""+a.easting,d=""+a.northing;return a.zoneNumber+a.zoneLetter+j(a.easting,a.northing,a.zoneNumber)+c.substr(c.length-5,b)+d.substr(d.length-5,b)}function j(a,b,c){var d=k(c),e=Math.floor(a/1e5),f=Math.floor(b/1e5)%20;return l(e,f,d)}function k(a){var b=a%q;return 0===b&&(b=q),b}function l(a,b,c){var d=c-1,e=r.charCodeAt(d),f=s.charCodeAt(d),g=e+a-1,h=f+b,i=!1;g>x&&(g=g-x+t-1,i=!0),(g===u||u>e&&g>u||(g>u||u>e)&&i)&&g++,(g===v||v>e&&g>v||(g>v||v>e)&&i)&&(g++,g===u&&g++),g>x&&(g=g-x+t-1),h>w?(h=h-w+t-1,i=!0):i=!1,(h===u||u>f&&h>u||(h>u||u>f)&&i)&&h++,(h===v||v>f&&h>v||(h>v||v>f)&&i)&&(h++,h===u&&h++),h>w&&(h=h-w+t-1);var j=String.fromCharCode(g)+String.fromCharCode(h);return j}function m(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b,c=a.length,d=null,e="",f=0;!/[A-Z]/.test(b=a.charAt(f));){if(f>=2)throw"MGRSPoint bad conversion from: "+a;e+=b,f++}var g=parseInt(e,10);if(0===f||f+3>c)throw"MGRSPoint bad conversion from: "+a;var h=a.charAt(f++);if("A">=h||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;d=a.substring(f,f+=2);for(var i=k(g),j=n(d.charAt(0),i),l=o(d.charAt(1),i);l<p(h);)l+=2e6;var m=c-f;if(m%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var q,r,s,t,u,v=m/2,w=0,x=0;return v>0&&(q=1e5/Math.pow(10,v),r=a.substring(f,f+v),w=parseFloat(r)*q,s=a.substring(f+v),x=parseFloat(s)*q),t=w+j,u=x+l,{easting:t,northing:u,zoneLetter:h,zoneNumber:g,accuracy:q}}function n(a,b){for(var c=r.charCodeAt(b-1),d=1e5,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>x){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function o(a,b){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var c=s.charCodeAt(b-1),d=0,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>w){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function p(a){var b;switch(a){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+a}var q=6,r="AJSAJS",s="AFAFAF",t=65,u=73,v=79,w=86,x=90;c.forward=function(a,b){return b=b||5,i(f({lat:a[1],lon:a[0]}),b)},c.inverse=function(a){var b=g(m(a.toUpperCase()));return[b.left,b.bottom,b.right,b.top]},c.toPoint=function(a){var b=c.inverse(a);return[(b[2]+b[0])/2,(b[3]+b[1])/2]}},{}],67:[function(a,b){b.exports={name:"proj4",version:"2.2.1",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(a,b){b.exports=a("gWUPNW")},{}],gWUPNW:[function(a,b){var c=[a("./lib/projections/tmerc"),a("./lib/projections/utm"),a("./lib/projections/sterea"),a("./lib/projections/stere"),a("./lib/projections/somerc"),a("./lib/projections/omerc"),a("./lib/projections/lcc"),a("./lib/projections/krovak"),a("./lib/projections/cass"),a("./lib/projections/laea"),a("./lib/projections/aea"),a("./lib/projections/gnom"),a("./lib/projections/cea"),a("./lib/projections/eqc"),a("./lib/projections/poly"),a("./lib/projections/nzmg"),a("./lib/projections/mill"),a("./lib/projections/sinu"),a("./lib/projections/moll"),a("./lib/projections/eqdc"),a("./lib/projections/vandg"),a("./lib/projections/aeqd")];b.exports=function(a){c.forEach(function(b){a.Proj.projections.add(b)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,"./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)}),function(a,b,c,d){"use strict";function e(a){return a=+a.toString().replace(/\,/gi,"."),isNaN(a)?0:a}function f(){return d.utils.newDeferred.apply(this,arguments)}function g(a){return a.charAt(0).toUpperCase()+a.substring(1)}function h(a){var b=d.utils.getWMM();return b(a[0].y,a[0].x).dec}function i(a){return a>=0?Math.floor((a+180)/6)+1:Math.floor(a/6)+31}function j(a){return a>=0?"n":"s"}function k(a){return a.keyCode?a.keyCode:a.which}function l(a){var b,c,d;return void 0!==a&&(b=Math.abs(e(a.D)),b+=Math.abs(e(a.M))/60,b+=Math.abs(e(a.S))/3600,c=e(a.D)>=0?1:-1,c*="N"==a.C||"E"==a.C?1:-1,d=c*b),d}function m(a){var b,c,d;return void 0!==a&&(b=Math.abs(e(a.D)),b+=Math.abs(e(a.M))/60,c=e(a.D)>=0?1:-1,c*="N"==a.C||"E"==a.C?1:-1,d=c*b),d}function n(b,c){var d,e,f,g,h;return"number"!==a.type(+b)||isNaN(b)?(d=0,f=0,g=0,c&&(h=c.N?"N":"E")):(c&&(h=b>=0?c.N?"N":"E":c.S?"S":"W"),b=Math.abs(b),d=Math.floor(b),e=60*(b-d),f=Math.floor(e),g=60*(e-f)),{C:h,D:d.toString(),M:f.toString(),S:g.toString()}}function o(b,c){var d,e,f;return"number"!==a.type(+b)||isNaN(b)?(d=0,e=0,c&&(f=c.N?"N":"E")):(c&&(f=b>=0?c.N?"N":"E":c.S?"S":"W"),b=Math.abs(b),d=Math.floor(b),e=60*(b-d)),{C:f,D:d.toString(),M:e.toString()}}function p(b,c){var d="";return a.each(c,function(a,c){return c.hasOwnProperty(b)?(d=c[b].def,!1):!0}),d}function q(a,b,c,e){var f=d.utils.getConvergenceConvention(),g=c||d.utils.degToRad(6*i(e.x)-183),h=d.utils.degToRad(e.y),j=d.utils.degToRad(e.x),k=(a-b)/a,l=k*Math.pow(Math.cos(h),2)/(1-k),m=j-g,n=Math.sin(h),o=(1+3*l+2*Math.pow(l,2))*Math.sin(h)*Math.pow(Math.cos(h),2)/3,p=(2-Math.pow(Math.tan(h),2))*Math.sin(h)*Math.pow(Math.cos(h),4)/15,q=m*n+Math.pow(m,3)*o+Math.pow(m,5)*p;return q*=f?-1:1,d.utils.radToDeg(q)}function r(a){var b;switch(a){case"m":b=1;break;case"km":b=1e3;break;case"us-ft":b=.304800609601219;break;default:b=1e3}return b}function s(a,b){return e(a)*r(b)}function t(a,b){return e(a)/r(b)}var u="INPUT ERROR ON LINE ";a.widget("twcc.converterSet",{options:{units:{dms:{D:"°",M:"'",S:"''"},dd:{x:{DD:"°E"},y:{DD:"°N"}},cartesian:{XY:{m:"m",km:"km","us-ft":"ft"},CONVERGENCE:"°"}},labels:{spherical:{x:"Lng = ",y:"Lat = ",convergence:"Conv. = "},cartesian:{x:"X = ",y:"Y = ",z:"Zone = ",h:"Hemisphere = ",convergence:"Conv. = "},csv:{csv:"CSV : ",l:"Format : "}},options:{x:{E:"East",W:"West"},y:{N:"North",S:"South"},o:{_DMS:"Deg. min. sec.",_DM:"Deg. min.",_DD:"Decimal deg."},h:{n:"North",s:"South"},u:{_M:"Meters",_KM:"Kilometers",_F:"Feet"}},value:{x:0,y:0},wgs84:[],defaultWgs84:[{x:0,y:0}],selections:{},definitions:{},url:"",$containers:[],masterLoadingToggleSwitch:!1,csv:!1},_create:function(){var b,e=this;if(this._bindEvents(),this._historyManager=c.getInstance(d),b=this._historyManager.getCurrentValue(),!this.options.wgs84)if(b){var f=/UD\d+/gi;if(b.wgs84.length>1)this.options.wgs84=b.wgs84,e.options.csv=!0;else{if("array"!==a.type(b.wgs84))throw"Wrong data type";this.options.wgs84=b.wgs84}this.options.selections.source=f.test(b.sc)?"WGS84":b.sc,this.options.selections.destination=f.test(b.dc)?"WGS84":b.dc
}else this.options.wgs84=this.options.defaultWgs84;this.options.$containers=this.element.find(".converter-container"),this.options.$containers.each(function(b){a(this).converter({units:e.options.units,labels:e.options.labels,options:e.options.options,csv:e.options.csv,target:b?"dest":"source",selection:e.options.selections[b?"destination":"source"],value:e.options.value,wgs84:e.options.wgs84})}),this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this._reload().progress(function(a){e._trigger(".notify",null,a)}).done(function(){e._reloadSucceeded.apply(e,arguments),e._trigger(".done",null,{wgs84:e.wgs84(),csv:e.csv(),selections:e.options.selections}),e.setConvergence()}).fail(function(){e._reloadFailed.apply(e,arguments)})},_bindEvents:function(){var b=this;this.element.on("converter.transform",function(a,c){b.transform(c)}),this.element.on("converter.source.wgs84_changed converterset.done ",function(a,c){var d={wgs84:c.wgs84,convergenceInDegrees:b._convergence(),srsCode:b._selection(),magneticDeclinationInDegrees:h(c.wgs84)};b._addToHistory(d),b._triggerWgs84Changed(a,d)}),this.element.on("converter.source.selection_changed converter.dest.selection_changed ",function(a,c){var d={wgs84:c.wgs84,srsCode:b._selection()};b._addToHistory(d),b._triggerConvergenceChange()}),this.element.on("converter.source.convergence_changed converter.dest.convergence_changed ",function(){b._triggerConvergenceChange()}),this.element.find(".history").click(function(){a(this).hasClass("next")?b._historyManager.moveToNext():b._historyManager.moveToPrevious(),b._restoreFromHistory()})},_triggerWgs84Changed:function(a,b){this._trigger(".wgs84_changed",a,b)},_triggerConvergenceChange:function(){this._trigger(".convergence_changed",null,{convergenceInDegrees:this._convergence()})},_reloadSucceeded:function(){this._loadDefinitionsObject(),this.options.masterLoadingToggleSwitch=!1,this._toggleLoading()},_reloadFailed:function(a){this._trigger(".fail",null,a)},_reload:function(){var b=this,c=f("Reload");return this._toggleLoading(!0),this._loadDefinitions().always(function(){b._toggleLoading(!1)}).done(function(){var d={};b.options.definitions.WGS84&&(b.options.definitions={"*World":b.options.definitions}),a.each(b.options.definitions,function(b,c){a.extend(d,c)}),c.resolve()}).fail(function(a,b){c.reject(b)}),c.promise()},_loadDefinitions:function(){var b=this,c=f("Load definitions");return"object"!==a.type(this.options.definitions)?c.reject("Wrong definitions type"):a.isEmptyObject(this.options.definitions)?a.ajax({url:this.options.url,data:{u:"u"},type:"POST",cache:!1,dataType:"json"}).done(function(a,d,e){void 0!==a.error?c.reject("Server Error",[e,d,a]):(b.options.definitions=a,c.resolve())}).fail(function(){c.reject("Server Error",arguments)}):c.resolve(),c.promise()},_loadDefinitionsObject:function(){this._pushPullAll("loadDefinitionsObject",this.options.definitions)},_toggleLoading:function(a){a=this.options.masterLoadingToggleSwitch||!!a,this._pushPullAll("toggleLoading",a)},_addToHistory:function(a){this._historyManager.isEnabled()&&this._historyManager.add({wgs84:a.wgs84,sc:a.srsCode.source,dc:a.srsCode.destination})},_restoreFromHistory:function(){var a=this,b=this._historyManager.getCurrentValue();this._underTheRadar(function(){var c=b.wgs84.length>1,d=a.csv();d!==c&&a.csv(c),a.transform(b),a.pushPullSource("selection",b.sc),a.pushPullDestination("selection",b.dc)})},_underTheRadar:function(b){if("function"!==a.type(b))throw"Invalid function";this._historyManager.toggle(!1),b(),this._historyManager.toggle(!0)},_pushPullWithCriterion:function(b,c,d,e){var f=null,g=this;return this.options.$containers.each(function(){a(this).converter("option",d)===e&&(f=g._pushPullOne(b,c,a(this)))}),f},_pushPullOne:function(a,b,c){var d=void 0===b?c.converter(a):c.converter(a,b);return this.options.hasOwnProperty(a)&&(this.options[a]=d),d},pushPullSource:function(a,b){return this._pushPullWithCriterion(a,b,"target","source")},pushPullDestination:function(a,b){return this._pushPullWithCriterion(a,b,"target","dest")},_pushPullAll:function(b,c){var d=this;return this.options.$containers.each(function(){d._pushPullOne(b,c,a(this))}),this.options[b]},_pullAll:function(a){return{source:this.pushPullSource(a),destination:this.pushPullDestination(a)}},wgs84:function(a){return this._pushPullAll("wgs84",a)},toggle:function(a){return this._pushPullAll("toggle",a)},_getFirstWgs84:function(){var b=null,c=this.wgs84();return a.each(c,function(){return this.error?!0:(b=this,!1)}),b||{x:0,y:0}},_convergence:function(){return this._pullAll("convergence")},_selection:function(){return this.options.selections=this._pullAll("selection"),this.options.selections},setConvergence:function(){this._pushPullAll("setConvergence")},readOnly:function(){return this.options.readOnly},csv:function(a){if(a!=this.options.csv&&void 0!==a){if(!a){var b=[this._getFirstWgs84()];JSON.stringify(b[0])===JSON.stringify(this.wgs84()[0])?this.wgs84(b):this.transform({wgs84:b})}this._trigger(".csv_changed",null,{csv:a})}return this._pushPullAll("csv",a)},unloadCRS:function(a){this._pushPullAll("unloadCRS",a)},removeEmptyOptgroups:function(){this._pushPullAll("removeEmptyOptgroups")},mergeDefinitions:function(b){var c=this,d=new a.Deferred;return this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this.options.definitions="object"!==a.type(this.options.definitions)?{}:this.options.definitions,a.extend(!0,this.options.definitions,b),this._reload().progress(function(){d.notify("Reloading")}).done(function(){c._reloadSucceeded.apply(c,arguments),d.resolve()}).fail(function(){c._reloadFailed.apply(c,arguments),d.reject.apply(null,arguments)}),d.promise()},transform:function(b){var c=b.hasOwnProperty("wgs84");if(!(c&&"array"===a.type(b.wgs84)||b.hasOwnProperty("target")))throw"Wrong data format";if(c)this._pushPullAll("transform",b);else{var d;"source"===b.target?(d=this.pushPullSource("transform",{input:null}),this.pushPullDestination("transform",{wgs84:d})):(d=this.pushPullDestination("transform",{input:null}),this.pushPullSource("transform",{wgs84:d}))}},_setOption:function(){return this._superApply(arguments)},_destroy:function(){return this._toggleLoading(!0),this._pushPullAll("destroy"),this._super()}}),a.widget("twcc.converter",{options:{readOnly:!1,wrapper:{fieldSet:["<div>"],title:["<h3>"],info:["<a>",{name:"info",href:"#"}]},projections:{},units:{},labels:{},options:{},angleUnit:"dd",lengthUnit:"m",convergence:null,hint:"",wgs84:[{x:0,y:0}],value:{x:0,y:0},selection:null,mapping:{aea:"cartesian",aeqd:"cartesian",cass:"cartesian",cea:"cartesian",csv:"csv",eqc:"cartesian",eqdc:"cartesian",equi:"cartesian",gauss:"cartesian",geocent:"cartesian",gnom:"cartesian",gstmerc:"cartesian",laea:"cartesian",lcc:"cartesian",longlat:"spherical",merc:"cartesian",mill:"cartesian",moll:"cartesian",nzmg:"cartesian",omerc:"cartesian",ortho:"cartesian",poly:"cartesian",sinu:"cartesian",somerc:"cartesian",stere:"cartesian",sterea:"cartesian",tmerc:"cartesian",utm:"utm",vandg:"spherical",connector:"connector"},$select:null,$container:null,csv:!1},_widget:void 0,_create:function(){a.extend(this.options,{$select:this.element.find("select.crs-list"),$container:this.element.find(".container")}),this._bindEvents(),this._unload()},_triggerTransform:function(a){a.preventDefault(),this._trigger(".transform",a,{target:this.options.target})},_bindEvents:function(){var a=this;this.options.$select.on("change",function(){a.selection()}),this.element.on("angleswitchgeofield.update_display",function(b,c){a.options.angleUnit=c.value,a.value(),a.updateContainer()}),this.element.find(".convert-button").click(function(b){a._triggerTransform(b)}),this.element.on("keyup","input, select",function(b){k(b)==d.constants.keyboard.RETURN&&a._triggerTransform(b)})},_getFieldSetUnit:function(a){var b=this._getWidgetPrefix(a),c=this._getFieldSetUnitName(b);if(c)return this.options.units[c];var d=b.match(/([A-Z]?[a-z]*)/g);return(c=this._getFieldSetUnitName(d[1]))?this.options.units[c]:void 0},_getFieldSetUnitName:function(a){var b;switch(a){case"utm":b="cartesian";break;case"Dm":b="dms";break;case"csv":case"connector":break;default:b=a.toLowerCase()}return b&&this.options.units.hasOwnProperty(b)?b:void 0},_getFieldSetLabel:function(a){var b=this._getWidgetPrefix(a),c=this._getFieldSetLabelName(b);if(c)return this.options.labels[c];var d=b.match(/([A-Z]?[a-z]*)/g);return(c=this._getFieldSetLabelName(d[0]))?this.options.labels[c]:void 0},_getFieldSetLabelName:function(a){var b;switch(a){case"utm":b="cartesian";break;case"connector":break;default:b=a.toLowerCase()}return b&&this.options.labels.hasOwnProperty(b)?b:void 0},_getWidgetMidfix:function(a){var b="";return"spherical"===a&&(b=this.options.angleUnit,b=b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()),b},_getWidgetPrefix:function(a){var b,c=this.options.projections[this.options.selection];return a=c.isConnector&&"csv"!==a?"connector":a,this.options.mapping.hasOwnProperty(a)?b=this.options.mapping[a]:(console.error("Projection not found: "+a),b="cartesian"),b+this._getWidgetMidfix(b)},_getWidgetName:function(a){return this._getWidgetPrefix(a)+"FieldSet"},_unload:function(){this.element.find("select.crs-list, .container").empty(),this.projections={}},toggleLoading:function(a){this.element.find(".container").toggle(!a),this.element.find(".loading").toggle(!!a)},removeEmptyOptgroups:function(){this.options.$select.find("optgroup:empty").remove()},loadDefinitionsObject:function(b){var c,e=this,f=this.options.$select;if(this.options.definitions=b,this.removeEmptyOptgroups(),c=!1,a.each(this.options.definitions,function(b,f){a.each(f,function(a,f){e.options.$select.has('optgroup[label="'+b+'"] option[value="'+a+'"]').length||(d.utils.addOptionToSelect(b,a,e.options.$select,f.def),c=!0)})}),c){f.sortGrpsNOptionsByText();try{this.selection(this.options.selection||f.find("option:first").val())}catch(g){this.selection(f.find("option:first").val())}}},unloadCRS:function(c){var d=this;if(this.selection()===c){var e=this._widget.options.srsCode;this.selection(e)}this.options.$select.find('option[value="'+c.toString()+'"]').remove(),b.defs(c,void 0),delete this.options.projections[c],a.each(this.options.definitions,function(a,b){return b.hasOwnProperty(c)?(delete d.options.definitions[a][c],!1):!0}),this.removeEmptyOptgroups()},updateContainer:function(){var b=this,c=this.selection();if(this.options.value=this.options.csv||"array"!==a.type(this.options.value)?this.options.value:this.options.value[0],this.options.value=this.options.csv&&"array"!==a.type(this.options.value)?[this.options.value]:this.options.value,c){this.options.projections.hasOwnProperty(c)||this._registerProjection(c);var d,e,f=this._getProjection(c),h=f.projName,i=this._getFieldSetUnit(h)||"",j=this._getFieldSetLabel(h)||"",k={srsCode:c,target:this.options.target,convergence:this.options.convergence,wgs84:this.options.wgs84,value:this.options.value,units:i,labels:j,lengthUnit:this.options.lengthUnit,options:this.options.options,readOnly:this.options.readOnly},l=f.title||c,m=this._getWidgetName(this.options.csv?"csv":f.projName),n=a.apply(null,this.options.wrapper.fieldSet);if(this.options.$container.empty(),d=a.apply(null,this.options.wrapper.title),d.append(l),e=a.apply(null,this.options.wrapper.info),e.click(function(a){b._trigger(".info",a,{srsCode:c,definitionString:f.defData})}),e.text(" [?]"),d.append(e),n.append(d),"csvFieldSet"==m){i=i.D?this.options.units.dd:i;var o=(("utm"===h?j.h+","+j.z+",":"")+(j.x?j.x+(i.x?"("+i.x.DD+")":"("+i.XY.m+")"):"")+(j.y?","+j.y+(i.y?"("+i.y.DD+")":"("+i.XY.m+")"):"")).replace(/[\s]*=[\s]*/gi,"");a.extend(k,{originalProjection:f.isConnector?"connector":h,hint:o,units:null,labels:this.options.labels.csv})}this._widget=n[m](k).data("twcc"+g(m)),this.options.$container.append(n)}},_registerProjection:function(c){var d;if(!b.defs(c)){var e=c.indexOf("Connector")>=0,f=p(c,this.options.definitions),g={defData:f,isConnector:e};b.defs(c,f),a.extend(b.defs(c),g)}d=a.extend({},b.defs(c)),this._setProjection(c,d)},_getProjection:function(a){if(!this.options.projections.hasOwnProperty(a))throw"Unknown srsCode";return this.options.projections[a]},_setProjection:function(a,b){this.options.projections[a]=b},selection:function(a){var b=this.options.$select,c=!1,d=this,e=this.options.selection;if(void 0!==a){this.options.selection=a;try{b.val(this.options.selection)}catch(f){}c=!0}else b.val()&&b.val()!=this.options.selection&&(this.options.selection=b.val(),c=!0);if(c){this.updateContainer();var g=d.options.selection,h=d.wgs84();d.transform({wgs84:h}),d.setConvergence(),e!==g&&d._trigger("."+d.options.target+".selection_changed",null,{wgs84:h,srsCode:g})}return this.options.selection},projection:function(){return this._getProjection(this.selection())},_pushPull:function(a,b){var c;return this._widget?(c=this._widget[a](b),this.options.hasOwnProperty(a)&&(this.options[a]=c),c):null},value:function(b){if(void 0!==b&&(!this.options.csv&&"object"!==a.type(b)||this.options.csv&&"array"!==a.type(b)))throw"Invalid type";return this._pushPull("value",b)},wgs84:function(a){return void 0!==a&&JSON.stringify(this.options.wgs84)!==JSON.stringify(a)&&(this._pushPull("wgs84",a),this._trigger("."+this.options.target+".wgs84_changed",null,{wgs84:a}),this.setConvergence()),this.options.wgs84},convergence:function(a){var b=this.options.convergence;if(this._pushPull("convergence",a),void 0!==a&&b!==this.options.convergence){var c=this.wgs84();this._trigger("."+this.options.target+".convergence_changed",null,{wgs84:c})}return this.options.convergence},setConvergence:function(){if(this._widget&&"null"!==a.type(this._widget.convergence())){var c,d=this.wgs84()[0],e=new b.Proj(this.projection().defData),f=this._widget.zone?null:e.long0||null;c=q(e.a,e.b,f,d),this.convergence(c)}},csv:function(a){return void 0!==a&&(this.value(),this.options.csv=!!a,this.updateContainer()),this.options.csv},hint:function(a){return this._pushPull("hint",a)},toggle:function(a){return this._pushPull("toggle",a)},readOnly:function(){return this.options.readOnly},_formatCoordinates:function(b){var c,d=["array","object"];if(a.inArray(a.type(b),d)<0)throw"Wrong data type";return c="array"===a.type(b)?b:[b]},_setupInputProjection:function(a,c,d,e){var f=d?{z:i(c.x),h:j(c.y)}:e,g=a.defData;return g=g.replace(/\+zone=[^\s]+/gi,"+zone="+f.z),g=g.replace("+south",""),g+="s"===f.h?" +south":"",new b.Proj(g)},_isValidPoint:function(b,c){var d=1;return d&="object"===a.type(b),d&=b.hasOwnProperty("x"),c?d&=b.x.indexOf(u)<0:(d&=b.hasOwnProperty("y"),d&="number"===a.type(b.x)&&!isNaN(b.x),d&="number"===a.type(b.y)&&!isNaN(b.y)),!!d},_getConnector:function(){var b=this.selection();return window.hasOwnProperty(b)||a.ajax({url:"/js/connectors/"+b+".js",async:!1,cache:!0,dataType:"script"}),window[b].getInstance(d.context)},transform:function(c){var d,e,f,g,h=this,i=[],j=[],k=c.hasOwnProperty("wgs84"),l=this.value(),m=b.WGS84,n=this.projection(),o=n.defData.indexOf("+proj=utm")>-1,p=function(){return a.extend({isConnector:m.isConnector},new b.Proj(m.defData))},q=function(){return o?h._setupInputProjection.apply(h,arguments):a.extend({isConnector:n.isConnector},new b.Proj(n.defData))},r={type:"pivot",getProjection:p},s={type:"input",getProjection:q};if(!k&&!c.hasOwnProperty("input"))throw"Wrong data format";this.toggleLoading(!0);var t=k?c.wgs84:c.input;return k&&t&&this.wgs84(t),k?(d=t||this.wgs84(),g={A:r,B:s}):(d=t||l,g={A:s,B:r},f=this._widget.options.originalProjection),e=this._formatCoordinates(d),a.each(e,function(c,d){var e={},m=h.wgs84()[c],o="array"===a.type(l)?l[c]:l,p=g.A.getProjection(n,m,k,o),q=g.B.getProjection(n,m,k,o),r="connector"===f||!k&&p.isConnector,s=k&&q.isConnector,t=r||s;if(!h._isValidPoint(d,r)||k&&m.error)j.push({x:0,y:0,error:!0}),i.push(u+(c+1));else{var v;t&&(v=h._getConnector()),t&&k?e[g.B.type]=v.forward(d):(t&&(d=v.inverse(d)),e[g.B.type]=b(p,q,a.extend({},d))),e[g.A.type]=a.extend({},d),j.push({x:e.pivot.x,y:e.pivot.y}),i.push({x:e.input.x,y:e.input.y})}}),this.csv()||(i=i[0]),k?this.value(i):this.wgs84(j),this.toggleLoading(!1),this.wgs84()},_setOption:function(){return this._superApply(arguments)},_destroy:function(){return this._unload(),this._super()}}),a.widget("twcc.fieldSet",{options:{srsCode:null,value:{},units:{},target:null,wrapper:{set:["<div>",{"class":"table"}],geoField:["<div>",{"class":"row"}],geoCaption:["<div>",{"class":"caption"}]},readOnly:!1,geoFields:{},geoFieldsIndex:0,wgs84:null},_create:function(){var b,c=a.apply(null,this.options.wrapper.set);b=this._getGeoFieldsOptions(),this._setDefaultsGeoFieldsOptions(b),this._buildGeoFields(c,b),this._setFieldsHandlers(),this.element.append(c)},_setFieldsHandlers:function(){},_setDefaultsGeoFieldsOptions:function(b){var c=this;a.each(b,function(d,e){var f={name:c.options.srsCode+"_"+c.options.target,readOnly:c.options.readOnly,unit:c.options.units,target:c.options.target,value:c.options.value[e.options.axis]};b[d].options=a.extend(f,b[d].options)})},_buildGeoField:function(b,c,d,e){var f,g=this.options.geoFieldsIndex++;f=d.indexOf("Switch")>=0||d.indexOf("connector")>=0?a.apply(null,this.options.wrapper.geoCaption):a.apply(null,this.options.wrapper.geoField),this.options.geoFields[g]=f[d](e),b.append(f)},_buildGeoFields:function(b,c){var d=this;a.each(c,function(a,c){d._buildGeoField(b,a,c.type,c.options)})},_getGeoFieldsOptions:function(){return{}},_getConvergenceIcon:function(){return'<img src="'+d.system.dirWsImages+"GN_"+this.options.target+'.png" alt="">'},convergence:function(){return null},hint:function(){return null},wgs84:function(a){return void 0===a?this._getWgs84():this._setWgs84(a)},_getWgs84:function(){return this.options.wgs84},_setWgs84:function(a){return this.options.wgs84=a,this.options.wgs84},value:function(a){return this.options.value=void 0===a?this._getValue():this._setValue(a),this._setToStringMethod(),this.options.value},_getValue:function(){return this.options.value},_setValue:function(a){this.options.value=a},_setToStringMethod:function(){var a=this;this.options.value.toString=function(){return a._getStringValue()}},_getStringValue:function(){return""},toggle:function(a){return a=void 0===a?this.options.readOnly:!!a,this.options.readOnly=this._toggle(a),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(a){return!a},_setOption:function(){return this._superApply(arguments)},_destroy:function(){return this.element.empty(),this._super()}}),a.widget("twcc.connectorFieldSet",a.twcc.fieldSet,{options:{options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"connectorGeoField",options:{axis:"x"}}]},_getValue:function(){return{x:this.options.geoFields[0].connectorGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[0].connectorGeoField("value",a.x)}},_toggle:function(a){return this.options.geoFields[0].connectorGeoField("toggle",a)},_getStringValue:function(){return this.options.geoFields[0].connectorGeoField("value")}}),a.widget("twcc.csvFieldSet",a.twcc.fieldSet,{options:{labels:{},units:{},options:{},geoFields:{},value:[],hint:"",wgs84:[],originalProjection:null},_getGeoFieldsOptions:function(){return[{type:"csvGeoField",options:{value:this._toString(this.options.value),label:this.options.labels.csv}},{type:"labelGeoField",options:{value:this.options.hint,label:this.options.labels.l}}]},_getValue:function(){return this._fromString(this.options.geoFields[0].csvGeoField("value"))},_setValue:function(a){return this._fromString(this.options.geoFields[0].csvGeoField("value",this._toString(a)))},_fromString:function(b){var c=b.split("\n"),d=this;return a.each(c,function(a,b){var e=b.split(",");switch(d.options.originalProjection){case"utm":c[a]={h:e[0],z:+e[1],x:+e[2],y:+e[3]};break;case"connector":c[a]={x:e[0],y:e[1]};break;default:c[a]={x:+e[0],y:+e[1]}}}),c},_toString:function(b){var c=[],d=this;if("array"!==a.type(b))throw"Invalid type";return a.each(b,function(a,b){var e=d.wgs84()[a];if(e.error)c.push(b.toString());else if("utm"==d.options.originalProjection){var f=b.h||j(e.y),g=b.z||i(e.x);c.push(f+","+g+","+b.x+","+b.y)}else c.push(b.x+","+b.y)}),c.join("\n")},originalProjection:function(a){return void 0===a?this.options.originalProjection:void(this.options.originalProjection=a)},hint:function(a){return void 0===a?(this.options.hint=this.options.geoFields[1].labelGeoField("value"),this.options.hint):(this.options.hint=a,void this.options.geoFields[1].labelGeoField("value",this.options.hint))},_toggle:function(a){return this.options.geoFields[0].csvGeoField("toggle",a),this.options.geoFields[1].labelGeoField("toggle",a)},_getStringValue:function(){return this.options.hint+"\n"+this.options.geoFields[0].csvGeoField("value")}}),a.widget("twcc.utmFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0,wgs84:[]},_getGeoFieldsOptions:function(){return[{type:"hemisphereGeoField",options:{label:this.options.labels.h,options:this.options.options.h,axis:"h"}},{type:"zoneGeoField",options:{label:this.options.labels.z,options:this.options.options.z,axis:"z"}},{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var a=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(b,c){a.options.lengthUnit=a.unit(c.value)})},_getValue:function(){return{h:this.hemisphere(),z:this.zone(),x:this.options.geoFields[2].xyGeoField("value"),y:this.options.geoFields[3].xyGeoField("value")}},_setValue:function(b){var c=this._getWgs84()[0];return b.h&&b.z||a.extend(b,{y:Math.abs(b.y),h:j(c.y),z:i(c.x)}),{h:this.hemisphere(b.h),z:this.zone(b.z),x:this.options.geoFields[2].xyGeoField("value",b.x),y:this.options.geoFields[3].xyGeoField("value",b.y)}},unit:function(a){return void 0===a?this.options.lengthUnit=this.options.geoFields[2].xyGeoField("unit"):(this.options.geoFields[2].xyGeoField("unit",a),this.options.geoFields[3].xyGeoField("unit",a),this.options.lengthUnit=this.options.geoFields[5].lengthSwitchGeoField("value",a)),this.options.lengthUnit},convergence:function(a){return this.options.convergence=void 0===a?this.options.geoFields[4].convergenceGeoField("value"):this.options.geoFields[4].convergenceGeoField("value",a),this.options.convergence},zone:function(a){return this.options.value.z=void 0===a?this.options.geoFields[1].zoneGeoField("value"):this.options.geoFields[1].zoneGeoField("value",a),this.options.value.z},hemisphere:function(a){return this.options.value.h=void 0===a?this.options.geoFields[0].hemisphereGeoField("value"):this.options.geoFields[0].hemisphereGeoField("value",a),this.options.value.h},_toggle:function(a){return this.options.geoFields[0].hemisphereGeoField("toggle",a),this.options.geoFields[1].zoneGeoField("toggle",a),this.options.geoFields[2].xyGeoField("toggle",a),this.options.geoFields[3].xyGeoField("toggle",a),this.options.geoFields[5].lengthSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[2].xyGeoField("getStringValue")+", "+a[3].xyGeoField("getStringValue")+" "+a[1].zoneGeoField("value")+a[0].hemisphereGeoField("value")}}),a.widget("twcc.cartesianFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0},_getGeoFieldsOptions:function(){return[{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var a=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(b,c){a.options.lengthUnit=a.unit(c.value)})},_getValue:function(){return{x:this.options.geoFields[0].xyGeoField("value"),y:this.options.geoFields[1].xyGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[0].xyGeoField("value",a.x),y:this.options.geoFields[1].xyGeoField("value",a.y)}},unit:function(a){return void 0===a?this.options.lengthUnit=this.options.geoFields[0].xyGeoField("unit"):(this.options.geoFields[0].xyGeoField("unit",a),this.options.geoFields[1].xyGeoField("unit",a),this.options.lengthUnit=this.options.geoFields[3].lengthSwitchGeoField("value",a)),this.options.lengthUnit},convergence:function(a){return this.options.convergence=void 0===a?this.options.geoFields[2].convergenceGeoField("value"):this.options.geoFields[2].convergenceGeoField("value",a),this.options.convergence},_toggle:function(a){return this.options.geoFields[0].xyGeoField("toggle",a),this.options.geoFields[1].xyGeoField("toggle",a),this.options.geoFields[3].lengthSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].xyGeoField("getStringValue")+", "+a[1].xyGeoField("getStringValue")}}),a.widget("twcc.sphericalDdFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"ddGeoField",options:{unit:this.options.units.y,label:this.options.labels.y,axis:"y"}},{type:"ddGeoField",options:{unit:this.options.units.x,label:this.options.labels.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dd",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].ddGeoField("value"),y:this.options.geoFields[0].ddGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[1].ddGeoField("value",a.x),y:this.options.geoFields[0].ddGeoField("value",a.y)}},_toggle:function(a){return this.options.geoFields[0].ddGeoField("toggle",a),this.options.geoFields[1].ddGeoField("toggle",a),this.options.geoFields[2].angleSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].ddGeoField("getStringValue")+", "+a[1].ddGeoField("getStringValue")}}),a.widget("twcc.sphericalDmFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dm",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmGeoField("value"),y:this.options.geoFields[0].dmGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[1].dmGeoField("value",a.x),y:this.options.geoFields[0].dmGeoField("value",a.y)}},_toggle:function(a){return this.options.geoFields[0].dmGeoField("toggle",a),this.options.geoFields[1].dmGeoField("toggle",a),this.options.geoFields[2].angleSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].dmGeoField("getStringValue")+", "+a[1].dmGeoField("getStringValue")}}),a.widget("twcc.sphericalDmsFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmsGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmsGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dms",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmsGeoField("value"),y:this.options.geoFields[0].dmsGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[1].dmsGeoField("value",a.x),y:this.options.geoFields[0].dmsGeoField("value",a.y)}},_toggle:function(a){return this.options.geoFields[0].dmsGeoField("toggle",a),this.options.geoFields[1].dmsGeoField("toggle",a),this.options.geoFields[2].angleSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].dmsGeoField("getStringValue")+", "+a[1].dmsGeoField("getStringValue")}}),a.widget("twcc.geoField",{options:{name:null,unit:null,label:null,readOnly:!1,lengthUnit:"m",glue:"_",wrapper:{field:["<span>"],fields:["<div>",{"class":"cell fields"}],label:["<div>",{"class":"cell label"}],options:["<div>",{"class":"fields"}]},attributes:{},fields:{},icon:""},_create:function(){var b,c,d=this;a.each(this.options.attributes,function(b){var c={disabled:d.options.readOnly,readonly:d.options.readOnly};d.options.attributes[b]=a.extend(c,d.options.attributes[b])}),b=this._getEmptyFieldCell(),c=this._getFieldsOptions(),this._setDefaultsFieldsOptions(c),a.each(c,function(a,c){var e=d._buildField(a,c);d._setFieldHandlers(e),e.append(d._getFieldSetUnit(a)),e.append("&nbsp;"),b.append(e)}),this._appendLabelCell(),this.element.append(b)},_getFieldSetUnit:function(a){return this.options.unit[a]},_setFieldHandlers:function(){},_clean:function(a,b){return this._superClean(a,b)},_superClean:function(a,b){return isNaN(a)||null===a?"":d.math.round(a,b||0)},_buildField:function(b,c){return this.options.fields[b]=a.apply(null,this.options.wrapper.field).field(c),this.options.fields[b]},_appendLabelCell:function(){var b,c,d=this._getForId();b=d?a("<label>",{"for":d}).html(this.options.icon+this.options.label):this.options.icon+this.options.label,c=a.apply(null,this.options.wrapper.label).append(b),this.element.append(c)},_getForId:function(){},_getEmptyFieldCell:function(){return a.apply(null,this.options.wrapper.fields)},_getFieldsOptions:function(){return{}},_setDefaultsFieldsOptions:function(b){var c=this;a.each(b,function(d){var e={name:c.options.name+c.options.glue+d,attributes:c.options.attributes[d],value:c._clean(c.options.value)};b[d]=a.extend(e,b[d])})},value:function(a){return this.options.value=void 0===a?this._constraint(this._getRawValue()):this._setValue(this._clean(a)),this.options.value},toggle:function(a){return a=void 0===a?this.options.readOnly:!!a,this.options.readOnly=this._toggle(a),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(b){var c=this;return a.each(this.options.fields,function(a,d){var e=c._getFieldsOptions()[a];c._toggleField(d,b,e)}),!b},_toggleField:function(a,b){a.field("toggle",b)},_getRawValue:function(){return this.options.value},getStringValue:function(){return this.options.value},_constraint:function(a){return a},_setValue:function(a){this.options.value=a},_setOption:function(a,b){this.options[a]=b,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),a.widget("twcc.ddGeoField",a.twcc.geoField,{options:{value:0,attributes:{DD:{size:"20","class":"width_5"}}},_getFieldsOptions:function(){return{DD:{type:"text"}}},_getForId:function(){return this.options.fields.DD.field("id")},_getRawValue:function(){return d.math.parseFloat(this.options.fields.DD.field("value"))},getStringValue:function(){return this.options.value+this._getFieldSetUnit("DD")},_setValue:function(a){return this.options.fields.DD.field("value",a)},_constraint:function(a){var b="y"===this.options.axis?180*Math.atan(Math.sinh(Math.PI))/Math.PI:180,c=-b;return a=Math.max(a,c),a=Math.min(a,b)},_clean:function(a){return this._constraint(this._super(a,15))}}),a.widget("twcc.dmGeoField",a.twcc.ddGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4","class":"width_1"},M:{size:"6","class":"width_3"}}},_buildField:function(b,c){return"option"===c.type?(this.options.fields[b]=a.apply(null,this.options.wrapper.field).optionField(c),this.options.fields[b]):this._superApply(arguments)
},_getFieldsOptions:function(){var a=this._clean(this.options.value);return{C:{type:"option",value:a.C||"",options:this.options.options},D:{type:"text",value:this._superClean(a.D)},M:{type:"text",value:this._superClean(a.M,12)}}},_getForId:function(){return this.options.fields.D.field("id")},_getFieldSetUnit:function(a){return"C"!=a?this._superApply(arguments):""},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:d.math.parseFloat(this.options.fields.D.field("value")),M:d.math.parseFloat(this.options.fields.M.field("value"))}},value:function(a){return void 0===a?this._clean(m(this._getObjectValue())):(a=this._clean(a),this.options.fields.C.optionField("value",a.C||""),this.options.fields.D.field("value",this._superClean(a.D)),this.options.fields.M.field("value",this._superClean(a.M,12))),this.options.value},getStringValue:function(){var a=this._getObjectValue();return a.D+this._getFieldSetUnit("D")+a.M+this._getFieldSetUnit("M")+a.C},_clean:function(a){return this.options.value=this._constraint(a),o(this.options.value,this.options.options)},_toggleField:function(a,b,c){return"option"===c.type?a.optionField("toggle",b):this._superApply(arguments)}}),a.widget("twcc.dmsGeoField",a.twcc.dmGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4","class":"width_1"},M:{size:"4","class":"width_1"},S:{size:"6","class":"width_3"}}},_getFieldsOptions:function(){var a=this._clean(this.options.value);return{C:{type:"option",value:a.C||"",options:this.options.options},D:{type:"text",value:this._superClean(a.D)},M:{type:"text",value:this._superClean(a.M)},S:{type:"text",value:this._superClean(a.S,12)}}},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:d.math.parseFloat(this.options.fields.D.field("value")),M:d.math.parseFloat(this.options.fields.M.field("value")),S:d.math.parseFloat(this.options.fields.S.field("value"))}},value:function(a){return void 0===a?this._clean(l(this._getObjectValue())):(a=this._clean(a),this.options.fields.C.optionField("value",a.C||""),this.options.fields.D.field("value",this._superClean(a.D)),this.options.fields.M.field("value",this._superClean(a.M)),this.options.fields.S.field("value",this._superClean(a.S,12))),this.options.value},getStringValue:function(){var a=this._getObjectValue();return a.D+this._getFieldSetUnit("D")+a.M+this._getFieldSetUnit("M")+a.S+this._getFieldSetUnit("S")+a.C},_clean:function(a){return this.options.value=this._constraint(a),n(this.options.value,this.options.options)}}),a.widget("twcc.switchGeoField",a.twcc.geoField,{_clean:function(a){return this._constraint(a)},_setFieldHandlers:function(a){var b=this;a.find(":first-child").click(function(a){b._trigger(".update_display",a,{value:b.value()})})},_appendLabelCell:function(){},_getEmptyFieldCell:function(){return a.apply(null,this.options.wrapper.options)},_setDefaultsFieldsOptions:function(){},_getRawValue:function(){return a("input:radio:checked",this.element).val()},_setValue:function(a){return this.element.find('input:radio[value="'+a+'"]').prop("checked",!0),a},_getForId:function(a){return this.options.fields[a].field("id")},_getFieldSetUnit:function(b){var c=this._superApply(arguments),d=this._getForId(b);return a("<label>",{"for":d}).append(c)}}),a.widget("twcc.angleSwitchGeoField",a.twcc.switchGeoField,{options:{value:"dd"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var a=this.options.name+"_DMS_DM_DD",b=this.options.value,c="dd"===b,d="dm"===b,e=!c&&!d;return{_DMS:{name:a,type:"radio",value:"dms",attributes:{checked:e}},_DM:{name:a,type:"radio",value:"dm",attributes:{checked:d}},_DD:{name:a,type:"radio",value:"dd",attributes:{checked:c}}}},_constraint:function(b){return a.inArray(b,["dms","dm","dd"])<0?"dms":b}}),a.widget("twcc.lengthSwitchGeoField",a.twcc.switchGeoField,{options:{value:"m"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var a=this.options.name+"_M_KM_F",b=this.options.value,c="km"===b,d="us-ft"===b,e=!c&&!d;return{_M:{name:a,type:"radio",value:"m",attributes:{checked:e}},_KM:{name:a,type:"radio",value:"km",attributes:{checked:c}},_F:{name:a,type:"radio",value:"us-ft",attributes:{checked:d}}}},_constraint:function(b){return a.inArray(b,["m","km","us-ft"])<0?"m":b}}),a.widget("twcc.xyGeoField",a.twcc.geoField,{options:{value:0,attributes:{XY:{size:"20","class":"width_4"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XY:{type:"text"}}},_getForId:function(){return this.options.fields.XY.field("id")},_getFieldSetUnit:function(){return this.options.unit.XY[this.options.lengthUnit]},_getRawValue:function(){return s(this.options.fields.XY.field("value"),this.options.lengthUnit)},getStringValue:function(){return this.options.fields.XY.field("value")+this.options.lengthUnit},_setValue:function(a){return s(this.options.fields.XY.field("value",a),this.options.lengthUnit)},_clean:function(a){return this._super(t(a,this.options.lengthUnit),"m"==this.options.lengthUnit?3:5)},unit:function(a){return void 0!==a&&(this.value(),this.options.lengthUnit=this._cleanUnit(a),this._update()),this.options.lengthUnit},_cleanUnit:function(b){return a.inArray(b,["m","km","us-ft"])<0?"m":b}}),a.widget("twcc.zoneGeoField",a.twcc.geoField,{options:{value:31,attributes:{Z:{size:"5","class":"width_2"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{Z:{type:"text"}}},_getForId:function(){return this.options.fields.Z.field("id")},_getRawValue:function(){return parseInt(this.options.fields.Z.field("value"))},_setValue:function(a){return this.options.fields.Z.field("value",a)},_constraint:function(a){var b=0;return a=Math.max(a,b)},_clean:function(a){return this._constraint(this._super(a))}}),a.widget("twcc.hemisphereGeoField",a.twcc.geoField,{options:{value:"n",attributes:{E:{size:"1"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{E:{type:"option",options:this.options.options}}},_getForId:function(){return this.options.fields.E.optionField("id")},_getFieldSetUnit:function(){},_buildField:function(b,c){return this.options.fields[b]=a.apply(null,this.options.wrapper.field).optionField(c),this.options.fields[b]},_clean:function(a){return this._constraint(a||"n")},_getRawValue:function(){return this.options.fields.E.optionField("value")},_constraint:function(b){return a.inArray(b,["n","s"])<0?"n":b},_setValue:function(a){return this.options.fields.E.optionField("value",a)},_toggleField:function(a,b){return a.optionField("toggle",b)}}),a.widget("twcc.csvGeoField",a.twcc.geoField,{options:{value:"",attributes:{CSV:{rows:"5",wrap:"off"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CSV:{type:"textarea"}}},_getFieldSetUnit:function(){return""},_getForId:function(){return this.options.fields.CSV.textareaField("id")},_buildField:function(b,c){return this.options.fields[b]=a.apply(null,this.options.wrapper.field).textareaField(c),this.options.fields[b]},_clean:function(a){return this._constraint(a||"")},_getRawValue:function(){return this.options.fields.CSV.textareaField("value")},_setValue:function(a){return this.options.fields.CSV.textareaField("value",a)},_toggleField:function(a,b){return a.textareaField("toggle",b)}}),a.widget("twcc.convergenceGeoField",a.twcc.geoField,{options:{value:0,attributes:{CONVERGENCE:{size:"10","class":"width_4",readonly:!0}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CONVERGENCE:{type:"text"}}},_getForId:function(){return this.options.fields.CONVERGENCE.field("id")},_getRawValue:function(){return this.options.fields.CONVERGENCE.field("value")},_constraint:function(a){var b=360,c=-b;return a=Math.max(a,c),a=Math.min(a,b)},_setValue:function(a){return this.options.fields.CONVERGENCE.field("value",a)},_clean:function(a){return this._constraint(this._super(a,4))}}),a.widget("twcc.connectorGeoField",a.twcc.geoField,{options:{value:""},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XX:{type:"text"}}},_appendLabelCell:function(){},_getRawValue:function(){return this.options.fields.XX.field("value")},_setValue:function(a){return this.options.fields.XX.field("value",a)},_constraint:function(a){return a},_clean:function(a){return this._constraint(a)}}),a.widget("twcc.labelGeoField",a.twcc.geoField,{options:{value:""},_create:function(){this._super(),this.options.fields.L.text(this.options.value)},_buildField:function(a,b){return this.options.fields[a]=b,this.options.fields[a]},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{L:a("<span>")}},_getFieldSetUnit:function(){return""},_getRawValue:function(){return this.options.fields.L.text()},_constraint:function(a){return a},_setValue:function(a){return this.options.fields.L.text(a),a},_clean:function(a){return this._constraint(a)},_toggleField:function(){return this.options.readonly}}),a.widget("twcc.field",{options:{type:null,value:null,name:null,glue:"_id_",attributes:{},readOnly:!1},_create:function(){this.options.attributes=a.extend({val:this.options.value,id:this.options.name+this.options.glue+Math.floor(10001*Math.random()),name:this.options.name,disabled:this.options.readOnly,readonly:this.options.readOnly},this.options.attributes),this._setTag()},_setTag:function(){a.extend(this.options.attributes,{type:this.options.type}),this.element.tag({name:"input",attributes:this.options.attributes})},value:function(a){return this.options.value=void 0===a?this.element.tag("value"):this.element.tag("value",a),this.options.value},toggle:function(a){return a=void 0===a?this.options.readOnly:!!a,this.options.readOnly=this._toggle(a),this.options.readOnly},_toggle:function(a){return this.element.tag("toggle",a)},readOnly:function(){return this.options.readOnly},id:function(){return this.options.attributes.id},_setOption:function(a,b){this.options[a]=b,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),a.widget("twcc.textareaField",a.twcc.field,{options:{type:"textarea"},_setTag:function(){this.element.tag({name:"textarea",attributes:this.options.attributes})}}),a.widget("twcc.optionField",a.twcc.field,{options:{type:"option",options:{}},_setTag:function(){this.element.selectTag({attributes:this.options.attributes,options:this.options.options})},value:function(a){return this.options.value=void 0===a?this.element.selectTag("value"):this.element.selectTag("value",a),this.options.value},_toggle:function(a){return this.element.selectTag("toggle",a)}}),a.widget("twcc.tag",{options:{name:null,attributes:{},readOnly:!1},_$elt:null,_create:function(){var b;this.options.attributes.val&&(this.options.attributes.val=this._clean(this.options.attributes.val)),this.options.attributes.hasOwnProperty("checked")&&(b=this.options.attributes.checked,delete this.options.attributes.checked),this._$elt=a("<"+this.options.name+">",this.options.attributes),void 0!==b&&this._$elt.prop("checked",b),this._appendChildren(),this.value(this.options.attributes.val),this.element.append(this._$elt)},value:function(a){return void 0===a?this.options.attributes.val=this._$elt.val():(this.options.attributes.val=this._clean(a),this._$elt.val(this.options.attributes.val)),this.options.attributes.val},toggle:function(a){var b=void 0===a?this.options.readOnly:!a;return this.options.readOnly=this._toggle(b),this.options.readOnly},_toggle:function(a){return this._$elt.prop("disabled",a).prop("readonly",a),a},readOnly:function(){return this.options.readOnly},_clean:function(a){return"number"==typeof a&&a.toString().split("e").length>1&&(a=d.math.round(a)),a},_appendChildren:function(){},_setOption:function(a,b){this.options[a]=b,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this._$elt.remove(),this._super()}}),a.widget("twcc.selectTag",a.twcc.tag,{options:{name:"select",options:{}},_$elt:null,_appendChildren:function(){var b=this;a.each(this.options.options,function(c,d){b._$elt.append(a("<option>",{value:c,text:d}))})}})}(jQuery,proj4,TWCCHistory,App),function(a){var b=function(b){this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.1",bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},void 0!==b&&this.setOption(b);var c=this,d=function(){setTimeout(function(){c._options.checkOnLoad===!0&&(c._options.debug===!0&&c._log("onload->eventCallback","A check loading is launched"),null===c._var.bait&&c._creatBait(),setTimeout(function(){c.check()},1))},1)};void 0!==a.addEventListener?a.addEventListener("load",d,!1):a.attachEvent("onload",d)};b.prototype._options=null,b.prototype._var=null,b.prototype._bait=null,b.prototype._log=function(a,b){console.log("[BlockAdBlock]["+a+"] "+b)},b.prototype.setOption=function(a,b){if(void 0!==b){var c=a;a={},a[c]=b}for(var d in a)this._options[d]=a[d],this._options.debug===!0&&this._log("setOption",'The option "'+d+'" he was assigned to "'+a[d]+'"');return this},b.prototype._creatBait=function(){var b=document.createElement("div");b.setAttribute("class",this._options.baitClass),b.setAttribute("style",this._options.baitStyle),this._var.bait=a.document.body.appendChild(b),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,this._options.debug===!0&&this._log("_creatBait","Bait has been created")},b.prototype._destroyBait=function(){a.document.body.removeChild(this._var.bait),this._var.bait=null,this._options.debug===!0&&this._log("_destroyBait","Bait has been removed")},b.prototype.check=function(a){if(void 0===a&&(a=!0),this._options.debug===!0&&this._log("check","An audit was requested "+(a===!0?"with a":"without")+" loop"),this._var.checking===!0)return this._options.debug===!0&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var b=this;return this._var.loopNumber=0,a===!0&&(this._var.loop=setInterval(function(){b._checkBait(a)},this._options.loopCheckTime)),setTimeout(function(){b._checkBait(a)},1),this._options.debug===!0&&this._log("check","A check is in progress ..."),!0},b.prototype._checkBait=function(b){var c=!1;if(null===this._var.bait&&this._creatBait(),(null!==a.document.body.getAttribute("abp")||null===this._var.bait.offsetParent||0==this._var.bait.offsetHeight||0==this._var.bait.offsetLeft||0==this._var.bait.offsetTop||0==this._var.bait.offsetWidth||0==this._var.bait.clientHeight||0==this._var.bait.clientWidth)&&(c=!0),void 0!==a.getComputedStyle){var d=a.getComputedStyle(this._var.bait,null);!d||"none"!=d.getPropertyValue("display")&&"hidden"!=d.getPropertyValue("visibility")||(c=!0)}this._options.debug===!0&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(c===!0?"positive":"negative")),b===!0&&(this._var.loopNumber++,this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop()),c===!0?(this._stopLoop(),this._destroyBait(),this.emitEvent(!0),b===!0&&(this._var.checking=!1)):(null===this._var.loop||b===!1)&&(this._destroyBait(),this.emitEvent(!1),b===!0&&(this._var.checking=!1))},b.prototype._stopLoop=function(){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,this._options.debug===!0&&this._log("_stopLoop","A loop has been stopped")},b.prototype.emitEvent=function(a){this._options.debug===!0&&this._log("emitEvent","An event with a "+(a===!0?"positive":"negative")+" detection was called");var b=this._var.event[a===!0?"detected":"notDetected"];for(var c in b)this._options.debug===!0&&this._log("emitEvent","Call function "+(parseInt(c)+1)+"/"+b.length),b.hasOwnProperty(c)&&b[c]();return this._options.resetOnEnd===!0&&this.clearEvent(),this},b.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],this._options.debug===!0&&this._log("clearEvent","The event list has been cleared")},b.prototype.on=function(a,b){return this._var.event[a===!0?"detected":"notDetected"].push(b),this._options.debug===!0&&this._log("on",'A type of event "'+(a===!0?"detected":"notDetected")+'" was added'),this},b.prototype.onDetected=function(a){return this.on(!0,a)},b.prototype.onNotDetected=function(a){return this.on(!1,a)},a.BlockAdBlock=b,void 0===a.blockAdBlock&&(a.blockAdBlock=new b({checkOnLoad:!0,resetOnEnd:!0}))}(window),function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a){"use strict";function b(a){return a&&a.__esModule?a:{"default":a}}{var c=a("ol"),d=a("ol/proj/proj4.js"),e=a("ol/layer.js"),f=a("ol/source"),g=b(a("ol/source/Vector")),h=a("ol/geom"),i=a("ol/style.js"),j=a("ol/control.js"),k=a("ol/control/ScaleLine"),l=a("ol/interaction.js"),m=a("ol/proj.js"),n=a("ol/coordinate.js"),o=b(a("ol-geocoder")),p=b(a("ol/layer/Group")),q=a("ol/sphere"),r=b(a("ol-layerswitcher"));b(a("ol-ext/control/Graticule"))}!function(a,b){if(void 0===window.TWCCMap){var s,t=function(s){function t(a){this._array=a,this._index=0;var b=this;this.get=function(){var a=b._array[b._index];return++b._index,b._index===b._array.length&&(b._index=0),a}}function u(){return nb.utils.t.apply(this,arguments)}function v(){return nb.utils.newDeferred.apply(this,arguments)}function w(b,c){nb.utils.trigger(a(nb.mapContainerElt),b,c)}function x(a){return m.fromLonLat(a,bb.getProjection())}function y(a){return m.toLonLat(a,bb.getProjection())}function z(a){return x([a.x,a.y])}function A(a,b){_.setMetrics("length",a),_.setMetrics("area",b),w("map.metrics_changed",{length:a,area:b})}function B(){var a=gb.getFeatures()[0];if(a){var b=a.getGeometry(),c=b.getCoordinates();c.push(c[0]);var d=new h.Polygon([c]);A(q.getLength(b),q.getArea(d))}}function C(){kb.setPosition(void 0)}function D(a){fb.getFeatures().forEach(function(b){b.getGeometry().setCoordinates(a||b.getGeometry().getCoordinates());var c=b.get("name"),d=_.getAngleInRadians(c)||0,e="true"===c||d?nb.mapOptions.azimuthOpacity:0,f=b.get("style").getImage();f.setRotation(d),f.setOpacity(e)})}function E(a){return"data:image/svg+xml,"+escape('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'+a)}function F(b){var d=E('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/><rect style="fill:#fff;stroke:#fff;stroke-width:1;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;" width="8.779562" height="8.2131386" x="3.610219" y="4.5313869"/></svg>'),e={"true":{src:E('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><polygon style="fill:#fff;stroke:#fff;stroke-width:37.61520004;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10" stroke-miterlimit="10" points="374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 259.216,29.942 330.27,173.919 489.16,197.007 " transform="matrix(0.03217603,0,0,0.03217603,-0.33683664,-0.35833699)"/><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/></svg>')},magneticDeclination:{src:E('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16 97" xml:space="preserve" width="16" height="97"><g transform="matrix(0.07106223,0,0,0.07106223,-0.43846047,1.8741008e-6)"><path style="fill:#fff" d="m 7.954,226.53 c -2.23,4.623 -2.295,8.072 -0.609,9.915 3.911,4.275 15.926,-3.905 23.323,-9.051 l 58.416,-40.662 c 7.397,-5.145 20.402,-11.835 29.414,-11.993 0.897,-0.016 1.8,-0.011 2.703,0.011 9.007,0.218 21.958,7.016 29.3,12.238 l 56.403,40.151 c 7.343,5.221 19.303,13.473 23.301,9.219 1.74,-1.849 1.751,-5.33 -0.381,-9.997 L 129.648,7.047 c -4.264,-9.333 -11.335,-9.404 -15.79,-0.163 L 7.954,226.53 Z"/><path style="stroke:#fff;stroke-width:28.14434624;" d="m 118.74748,174.45383 0,1190.45957"/></g></svg>'),rotation:_.getAngleInRadians("magneticDeclination")},srcConvergence:{src:d,color:"#f00",rotation:_.getAngleInRadians("srcConvergence")},dstConvergence:{src:d,rotation:_.getAngleInRadians("dstConvergence")}};for(var f in e)if(e.hasOwnProperty(f)){var g=e[f];fb.addFeature(new c.Feature({geometry:new h.Point(b),name:f,style:new i.Style({image:new i.Icon(a.extend({anchor:[.5,1],rotateWithView:!0,opacity:"true"===f||g.rotation?nb.mapOptions.azimuthOpacity:0,scale:.75,color:"#000"},g))})}))}}function G(){fb.clear()}function H(b){var c=[];return a.each(b,function(){return void 0===this.lat&&void 0===this.x||this.error?!0:void c.push(this)}),c}function I(b){var c=[new i.Style({stroke:new i.Stroke({color:"rgba(0,0,0,0.5)",width:2})})],d=0,e=b.getGeometry(),f=e.getCoordinates().length-1,g={font:"10px Arial",stroke:new i.Stroke({color:"#fff",width:2}),fill:new i.Fill({color:"#000"})};return e.forEachSegment(function(b,e){++d,c.push(new i.Style({geometry:new h.Point(b),text:new i.Text(a.extend(g,{text:d.toString()}))})),d===f&&c.push(new i.Style({geometry:new h.Point(e),text:new i.Text(a.extend(g,{text:(d+1).toString()}))}))}),c}function J(a){return a.map(z)}function K(a){hb.getFeatures().forEach(function(b){b.getGeometry().setCoordinates(a)})}function L(a){gb.getFeatures()[0].getGeometry().setCoordinates(a)}function M(a){hb.addFeature(new c.Feature({geometry:new h.Point(a),style:new i.Style({image:new i.Icon({src:nb.system.dirWsImages+"twcc_icon_with_shadow.png",anchor:[19,1],anchorXUnits:"pixels"})})}))}function N(a){gb.addFeature(new c.Feature({geometry:new h.LineString(a)}))}function O(){hb.clear(),ab.removeInteraction(db)}function P(){gb.clear(),ab.removeInteraction(eb)}function Q(){_.getBoolean("autoZoom")===!0}function R(b){var c=new a.Deferred,d=200;return bb.animate({center:b,duration:d},c.resolve),c.promise()}function S(b){var c=new a.Deferred,d=200;return bb.animate({zoom:b,duration:d},c.resolve),c.promise()}function T(){a("#zoom-btn").button("option","disabled",!0);var b=hb.getFeatures()[0].getGeometry().getCoordinates();a.when(R(b),S(10)).done(function(){a("#zoom-btn").button("option","disabled",!1)})}function U(a){if(gb){var b=J(a);gb.getFeatures().length?L(b):(N(b),ab.addInteraction(eb)),B(),Q()}}function V(b){var c,d,e,f,g="",h="",i="",j=y(b),k={key:nb.mapOptions.timezonedbKey,format:"json",by:"position",lng:j[0],lat:j[1],fields:"abbreviation,gmtOffset"},l=n.degreesToStringHDMS("NS",j[1]),m=n.degreesToStringHDMS("EW",j[0]);c=a.get("https://elevation-api.io/api/elevation",{points:j[1]+","+j[0]}).done(function(a){if(a.elevations){var b=a.elevations[0].elevation.toString();"-9999"!==b&&(g='<p><img src="'+nb.system.dirWsImages+'elevation_icon.png" alt="'+u("elevation")+'" title="'+u("elevation")+'" width="38" height="30"> '+b+u("unitMeter")+"</p>")}}),d=a.get("https://api.timezonedb.com/v2.1/get-time-zone",k).done(function(a){if("OK"===a.status){var b=a.gmtOffset/3600;i="<p>"+a.abbreviation+" (GMT",b>0&&(i+="+"),0!==b&&(i+=b),i+=")</p>"}}),e=a.get("https://nominatim.openstreetmap.org/reverse",{format:"json",lat:j[1],lon:j[0],"accept-language":nb.context.languageCode}).done(function(a){if(a&&!a.error){var b=a.address.country_code.toUpperCase();h='<img src="'+nb.system.dirWsImages+'address_icon.png" alt="'+u("address")+'" title="'+u("address")+'" width="38" height="30"><p>'+a.display_name+'   <img src="'+nb.system.dirWsImages+"flags/"+b+'.png" alt="'+b+'" width="22" height="15"></p>'}}),C(),a.when(e,c,d).always(function(){f='<div id="popup" class="ol-popup">   <a href="#" id="popup-closer" class="ol-popup-closer"></a>   <div class="popup-content">       <h3>'+u("dragMe")+"</h3>       <div>"+h+'           <a id="zoom-btn" href="#" title="'+u("zoom")+'">'+u("zoom")+'</a>       </div>       <div>           <img src="'+nb.system.dirWsImages+'gps_icon.png" alt="GPS (WGS84)" title="GPS (WGS84)" width="38" height="30">           <p>'+l+"<br>"+m+"</p>"+i+g+"       </div>   </div></div>",jb.innerHTML=f,a("#zoom-btn").button({icons:{primary:"ui-icon-zoomin"},text:!1}).click(function(){T()}),a("#popup-closer").click(function(a){return C(),this.blur(),a.stopPropagation(),a.preventDefault(),!1}),w("infowindow.dom_ready"),kb.setPosition(b)})}function W(a){if(hb){var b=z(a);hb.getFeatures().length?K(b):(M(b),ab.addInteraction(db)),fb.getFeatures().length?D(b):F(b),R(b),V(b),A()}}function X(a){1===a.length?(P(),W(a[0])):(C(),O(),G(),U(a))}function Y(){var a=new GridOverlay(ab);a.setMap(ab)}function Z(){var b=a("body");cb.once("tileloadend",function(){w("map.tiles_loaded"),mb.resolve()}),cb.on("tileloaderror",mb.reject),ab.on("singleclick",function(a){var b=ab.forEachFeatureAtPixel(ab.getEventPixel(a.originalEvent),function(a){return a});b?V(b.getGeometry().getCoordinates()):(C(),w("map.click",y(a.coordinate)))}),ib.on("addresschosen",function(a){w("place.changed",y(a.coordinate))}),db.on("modifystart",function(){C(),G(),w("marker.drag_start")}),db.on("modifyend",function(a){var b=a.features.getArray()[0];w("marker.drag_end",y(b.getGeometry().getCoordinates()))}),eb.on("modifyend",function(a){var b=a.features.getArray()[0];w("linestring.edit_end",b.getGeometry().getCoordinates().map(y)),B()}),ab.getViewport().addEventListener("contextmenu",function(a){var b=ab.forEachFeatureAtPixel(ab.getEventPixel(a),function(a){return a});b?w("linestring.remove_vertice",y(b.getGeometry().getCoordinates())):w("linestring.add_vertice",y(ab.getEventCoordinate(a))),B(),a.stopPropagation(),a.preventDefault()}),b.on("converter.source.selection_changed converterset.done",function(){}),b.on("converterset.wgs84_changed",function(a,b){var c=nb.utils.degToRad(b.convergenceInDegrees);b.wgs84=H(b.wgs84),_.setAngleInDegrees("magneticDeclination",b.magneticDeclinationInDegrees),_.setAngleInRadians("srcConvergence",c.source),_.setAngleInRadians("dstConvergence",c.destination),X(b.wgs84),w("converter.changed",b)}),b.on("converterset.convergence_changed",function(a,b){if(fb.getFeatures().length){var c=nb.utils.degToRad(b.convergenceInDegrees);_.setAngleInRadians("srcConvergence",c.source),_.setAngleInRadians("dstConvergence",c.destination),D()}}),b.on("ui.full_screen",function(){a(".ol-full-screen button").trigger("click")});var c=new t(Object.values(k.Units));a(".ol-scale-line").click(function(){lb.setUnits(c.get())})}function $(){mb=v("Map"),d.register(b);var h=new i.Style({image:new i.Circle({radius:6,fill:null,stroke:new i.Stroke({color:"rgba(0,0,0,0.6)",width:3})})});jb=a("<div>")[0],lb=new j.ScaleLine,fb=new g.default,hb=new g.default,gb=new g.default,db=new l.Modify({source:hb,style:h,pixelTolerance:30}),eb=new l.Modify({source:gb,style:h}),cb=new f.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),bb=new c.View({zoom:nb.mapOptions.zoom}),ib=new o.default("nominatim",{autoComplete:!0,autoCompleteMinLength:2,placeholder:u("searchByAddress"),targetType:"glass-button",lang:nb.context.languageCode,limit:5,keepOpen:!1,preventDefault:!0,debug:!1}),kb=new c.Overlay({element:jb,autoPan:!0,autoPanAnimation:{duration:200}});var k=x(nb.mapOptions.center);bb.setCenter(k),ab=new c.Map({controls:j.defaults().extend([new j.FullScreen({source:"map-container"}),new r.default,ib,lb]),interactions:l.defaults().extend([new l.DragRotateAndZoom]),target:nb.mapContainerElt,loadTilesWhileAnimating:!0,overlays:[kb],layers:[new p.default({title:"Maps",layers:[new e.Tile({title:"Stamen toner",type:"base",visible:!1,preload:1/0,source:new f.Stamen({layer:"toner"})}),new e.Tile({title:"Stamen terrain",type:"base",visible:!1,preload:1/0,source:new f.Stamen({layer:"terrain"})}),new e.Tile({title:"ArcGIS satellite",type:"base",visible:!1,preload:1/0,source:new f.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer">ArcGIS</a>',url:"http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg"})}),new e.Tile({title:"Open Street Map",type:"base",visible:!1,preload:1/0,source:new f.OSM}),new e.Tile({title:"ArcGIS terrain",type:"base",preload:1/0,source:cb})]}),new p.default({title:"Features",layers:[new e.Vector({title:"Azimuths",style:function(a){return a.get("style")},source:fb})]}),new e.Vector({style:function(a){return a.get("style")},source:hb}),new e.Vector({style:I,source:gb})],view:bb}),Z()}var _,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb=null,nb={mapOptions:{zoom:2,center:[0,0],azimuthOpacity:.7},mapContainerElt:a("#map")[0],context:{languageCode:"en"}};return a.extend(!0,nb,s),_={anglesInRadians:{},booleans:{autoZoom:!0},metrics:{},setAngleInRadians:function(a,b){_.anglesInRadians[a]=b},setAngleInDegrees:function(a,b){_.setAngleInRadians(a,nb.utils.degToRad(b))},getAngleInRadians:function(a){return _.anglesInRadians[a]},setBoolean:function(a,b){_.booleans[a]=!!b},getBoolean:function(a){return _.booleans[a]},setMetrics:function(a,b){_.metrics[a]=b},getMetrics:function(a){return _.metrics[a]}},$(),{promise:mb.promise(),setGraticule:Y,model:{setAngleInRadians:_.setAngleInRadians,setAngleInDegrees:_.setAngleInDegrees,getMetrics:_.getMetrics,setBoolean:_.setBoolean},getMap:function(){return ab}}};window.TWCCMap={getInstance:function(a){return s=s||t(a)}}}}(jQuery,proj4)},{ol:110,"ol-ext/control/Graticule":2,"ol-geocoder":3,"ol-layerswitcher":4,"ol/control.js":50,"ol/control/ScaleLine":56,"ol/coordinate.js":61,"ol/geom":77,"ol/interaction.js":111,"ol/layer.js":133,"ol/layer/Group":135,"ol/proj.js":158,"ol/proj/proj4.js":163,"ol/source":227,"ol/source/Vector":251,"ol/sphere":259,"ol/style.js":265}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("ol"),f=a("ol/Observable"),g=d(a("ol/control/Control")),h=d(a("ol/proj/Projection")),i=d(a("ol/style/Style")),j=d(a("ol/style/Stroke")),k=d(a("ol/style/Fill")),l=d(a("ol/style/Text")),m=a("ol/proj"),n=a("ol/proj.js"),o=function(a){a||(a={});var b=document.createElement("div");b.className="ol-graticule ol-unselectable ol-hidden",g.default.call(this,{element:b}),this.set("projection",a.projection||"EPSG:4326");var c=new h.default({code:this.get("projection")}),d=c.getMetersPerUnit();for(this.fac=1;d/this.fac>10;)this.fac*=10;this.fac=1e4/this.fac,this.set("maxResolution",a.maxResolution||1/0),this.set("step",a.step||.1),this.set("stepCoord",a.stepCoord||1),this.set("spacing",a.spacing||40),this.set("margin",a.margin||0),this.set("borderWidth",a.borderWidth||5),this.set("stroke",a.stroke!==!1),this.formatCoordX=a.formatCoordX||function(a){return a},this.formatCoordY=a.formatCoordY||function(a){return a},this.style=a.style instanceof i.default?a.style:new i.default({stroke:new j.default({color:"#000",width:1}),fill:new k.default({color:"#fff"}),text:new l.default({stroke:new j.default({color:"#fff",width:2}),fill:new k.default({color:"#000"})})})};e.inherits(o,g.default),o.prototype.setMap=function(a){var b=this.getMap();this._listener&&f.unByKey(this._listener),this._listener=null,g.default.prototype.setMap.call(this,a),b&&b.renderSync(),a&&(this._listener=a.on("postcompose",this.drawGraticule_.bind(this)))
},o.prototype.setStyle=function(a){this.style=a},o.prototype.getStyle=function(a){return a},o.prototype.drawGraticule_=function(a){if(!(this.get("maxResolution")<a.frameState.viewState.resolution)){for(var b,c=a.context,d=c.canvas,e=a.frameState.pixelRatio,f=d.width/e,g=d.height/e,h=this.get("projection"),i=this.getMap(),j=[i.getCoordinateFromPixel([0,0]),i.getCoordinateFromPixel([f,0]),i.getCoordinateFromPixel([f,g]),i.getCoordinateFromPixel([0,g])],k=-1/0,l=1/0,o=-1/0,p=1/0,q=0;b=j[q];q++)j[q]=m.transform(b,i.getView().getProjection(),h),k=Math.max(k,j[q][0]),l=Math.min(l,j[q][0]),o=Math.max(o,j[q][1]),p=Math.min(p,j[q][1]);var r=this.get("spacing"),s=this.get("step"),t=this.get("stepCoord"),u=this.get("borderWidth"),v=this.get("margin"),w=(k-l)/s*r;if(w>f){var x=Math.round((k-l)/f*r/s);s*=x,s>this.fac&&(s=Math.round(s/this.fac)*this.fac)}l=Math.floor(l/s)*s-s,p=Math.floor(p/s)*s-s,k=Math.floor(k/s)*s+2*s,o=Math.floor(o/s)*s+2*s;var y=n.get(h).getExtent();y&&(l<y[0]&&(l=y[0]),p<y[1]&&(p=y[1]),k>y[2]&&(k=y[2]+s),o>y[3]&&(o=y[3]+s));var z=this.style.getStroke()&&this.get("stroke"),A=this.style.getText(),B=this.style.getFill();c.save(),c.scale(e,e),c.beginPath(),c.rect(v,v,f-2*v,g-2*v),c.clip(),c.beginPath();for(var C={top:[],left:[],bottom:[],right:[]},D=l;k>D;D+=s){var E=m.transform([D,p],h,i.getView().getProjection());E=i.getPixelFromCoordinate(E),z&&c.moveTo(E[0],E[1]);for(var F=E,G=p+s;o>=G;G+=s){var H=m.transform([D,G],h,i.getView().getProjection());H=i.getPixelFromCoordinate(H),z&&c.lineTo(H[0],H[1]),F[1]>0&&H[1]<0&&C.top.push([D,F]),F[1]>g&&H[1]<g&&C.bottom.push([D,F]),F=H}}for(var G=p;o>G;G+=s){var E=m.transform([l,G],h,i.getView().getProjection());E=i.getPixelFromCoordinate(E),z&&c.moveTo(E[0],E[1]);for(var F=E,D=l+s;k>=D;D+=s){var H=m.transform([D,G],h,i.getView().getProjection());H=i.getPixelFromCoordinate(H),z&&c.lineTo(H[0],H[1]),F[0]<0&&H[0]>0&&C.left.push([G,F]),F[0]<f&&H[0]>f&&C.right.push([G,F]),F=H}}if(z&&(c.strokeStyle=this.style.getStroke().getColor(),c.lineWidth=this.style.getStroke().getWidth(),c.stroke()),A){c.fillStyle=this.style.getText().getFill().getColor(),c.strokeStyle=this.style.getText().getStroke().getColor(),c.lineWidth=this.style.getText().getStroke().getWidth(),c.textAlign="center",c.textBaseline="hanging";for(var I,J,K=(B?u:0)+v+2,q=0;J=C.top[q];q++)Math.round(J[0]/this.get("step"))%t||(I=this.formatCoordX(J[0]),c.strokeText(I,J[1][0],K),c.fillText(I,J[1][0],K));c.textBaseline="alphabetic";for(var J,q=0;J=C.bottom[q];q++)Math.round(J[0]/this.get("step"))%t||(I=this.formatCoordX(J[0]),c.strokeText(I,J[1][0],g-K),c.fillText(I,J[1][0],g-K));c.textBaseline="middle",c.textAlign="left";for(var J,q=0;J=C.left[q];q++)Math.round(J[0]/this.get("step"))%t||(I=this.formatCoordY(J[0]),c.strokeText(I,K,J[1][1]),c.fillText(I,K,J[1][1]));c.textAlign="right";for(var J,q=0;J=C.right[q];q++)Math.round(J[0]/this.get("step"))%t||(I=this.formatCoordY(J[0]),c.strokeText(I,f-K,J[1][1]),c.fillText(I,f-K,J[1][1]))}if(B){var L,M,N=this.style.getFill().getColor();(M=this.style.getStroke())?L=this.style.getStroke().getColor():(L=N,N="#fff"),c.strokeStyle=L,c.lineWidth=M?M.getWidth():1;for(var q=1;q<C.top.length;q++)c.beginPath(),c.rect(C.top[q-1][1][0],v,C.top[q][1][0]-C.top[q-1][1][0],u),c.fillStyle=Math.round(C.top[q][0]/s)%2?L:N,c.fill(),c.stroke();for(var q=1;q<C.bottom.length;q++)c.beginPath(),c.rect(C.bottom[q-1][1][0],g-u-v,C.bottom[q][1][0]-C.bottom[q-1][1][0],u),c.fillStyle=Math.round(C.bottom[q][0]/s)%2?L:N,c.fill(),c.stroke();for(var q=1;q<C.left.length;q++)c.beginPath(),c.rect(v,C.left[q-1][1][1],u,C.left[q][1][1]-C.left[q-1][1][1]),c.fillStyle=Math.round(C.left[q][0]/s)%2?L:N,c.fill(),c.stroke();for(var q=1;q<C.right.length;q++)c.beginPath(),c.rect(f-u-v,C.right[q-1][1][1],u,C.right[q][1][1]-C.right[q-1][1][1]),c.fillStyle=Math.round(C.right[q][0]/s)%2?L:N,c.fill(),c.stroke();c.beginPath(),c.fillStyle=L,c.rect(v,v,u,u),c.rect(v,g-u-v,u,u),c.rect(f-u-v,v,u,u),c.rect(f-u-v,g-u-v,u,u),c.fill()}c.restore()}};var p=o;c.default=p},{ol:110,"ol/Observable":30,"ol/control/Control":52,"ol/proj":158,"ol/proj.js":158,"ol/proj/Projection":159,"ol/style/Fill":269,"ol/style/Stroke":277,"ol/style/Style":278,"ol/style/Text":279}],3:[function(a,b,c){"use strict";function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(e,f){"object"==("undefined"==typeof c?"undefined":d(c))&&"undefined"!=typeof b?b.exports=f(a("ol/layer/Vector"),a("ol/source/Vector"),a("ol/geom/Point"),a("ol/Feature"),a("ol/proj"),a("ol/control/Control"),a("ol/style/Style"),a("ol/style/Icon")):"function"==typeof define&&define.amd?define(["ol/layer/Vector","ol/source/Vector","ol/geom/Point","ol/Feature","ol/proj","ol/control/Control","ol/style/Style","ol/style/Icon"],f):e.Geocoder=f(e.ol.layer.Vector,e.ol.source.Vector,e.ol.geom.Point,e.ol.Feature,e.ol.proj,e.ol.control.Control,e.ol.style.Style,e.ol.style.Icon)}(void 0,function(a,b,c,e,f,g,h,i){function j(a,b){if(void 0===b&&(b="Assertion failed"),!a){if("undefined"!=typeof Error)throw new Error(b);throw b}}function k(a){var b=function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-a}}return window.performance.now()}().toString(36);return a?a+b:b}function l(a){return/^\d+$/.test(a)}function m(a,b,c){if(Array.isArray(a))return void a.forEach(function(a){return m(a,b)});for(var d=Array.isArray(b)?b:b.split(/\s+/),e=d.length;e--;)o(a,d[e])||t(a,d[e],c)}function n(a,b,c){if(Array.isArray(a))return void a.forEach(function(a){return n(a,b,c)});for(var d=Array.isArray(b)?b:b.split(/\s+/),e=d.length;e--;)o(a,d[e])&&u(a,d[e],c)}function o(a,b){return a.classList?a.classList.contains(b):s(b).test(a.className)}function p(a,b,c){void 0===b&&(b=window.document);var d=/\./g,e=Array.prototype.slice,f=[];if(/^(#?[\w-]+|\.[\w-.]+)$/.test(a))switch(a[0]){case"#":f=[(g=a.substr(1),g="#"===g[0]?g.substr(1,g.length):g,document.getElementById(g))];break;case".":f=e.call(b.getElementsByClassName(a.substr(1).replace(d," ")));break;default:f=e.call(b.getElementsByTagName(a))}else f=e.call(b.querySelectorAll(a));var g;return c?f:f[0]}function q(a,b){return a.replace(/\{ *([\w_-]+) *\}/g,function(a,c){var d=void 0===b[c]?"":b[c];return String(d).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")})}function r(a,b){var c;if(Array.isArray(a)){if(c=document.createElement(a[0]),a[1].id&&(c.id=a[1].id),a[1].classname&&(c.className=a[1].classname),a[1].attr){var d=a[1].attr;if(Array.isArray(d))for(var e=-1;++e<d.length;)c.setAttribute(d[e].name,d[e].value);else c.setAttribute(d.name,d.value)}}else c=document.createElement(a);c.innerHTML=b;for(var f=document.createDocumentFragment();c.childNodes[0];)f.appendChild(c.childNodes[0]);return c.appendChild(f),c}function s(a){return new RegExp("(^|\\s+) "+a+" (\\s+|$)")}function t(a,b,c){a.classList?a.classList.add(b):a.className=(a.className+" "+b).trim(),c&&l(c)&&window.setTimeout(function(){return u(a,b)},c)}function u(a,b,c){a.classList?a.classList.remove(b):a.className=a.className.replace(s(b)," ").trim(),c&&l(c)&&window.setTimeout(function(){return t(a,b)},c)}function v(a){return new Promise(function(b,c){var e=function(a,b){return b&&"object"==d(b)&&(a+=(/\?/.test(a)?"&":"?")+function c(a){return Object.keys(a).reduce(function(b,e){return b.push("object"==d(a[e])?c(a[e]):encodeURIComponent(e)+"="+encodeURIComponent(a[e])),b},[]).join("&")}(b)),a}(a.url,a.data),f={method:"GET",mode:"cors",credentials:"same-origin"};a.jsonp?function(a,b,c){var d=document.head,e=document.createElement("script"),f="f"+Math.round(Math.random()*Date.now());e.setAttribute("src",a+(a.indexOf("?")>0?"&":"?")+b+"="+f),window[f]=function(a){window[f]=void 0,setTimeout(function(){return d.removeChild(e)},0),c(a)},d.appendChild(e)}(e,a.callbackName,b):fetch(e,f).then(function(a){return a.json()}).then(b).catch(c)})}a=a&&a.hasOwnProperty("default")?a.default:a,b=b&&b.hasOwnProperty("default")?b.default:b,c=c&&c.hasOwnProperty("default")?c.default:c,e=e&&e.hasOwnProperty("default")?e.default:e,f=f&&f.hasOwnProperty("default")?f.default:f,g=g&&g.hasOwnProperty("default")?g.default:g,h=h&&h.hasOwnProperty("default")?h.default:h,i=i&&i.hasOwnProperty("default")?i.default:i;var w={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},x={containerId:"gcd-container",buttonControlId:"gcd-button-control",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",cssClasses:w},y=Object.freeze({containerId:"gcd-container",buttonControlId:"gcd-button-control",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",cssClasses:w,"default":x}),z="addresschosen",A={NOMINATIM:"nominatim",REVERSE:"reverse"},B="glass-button",C="text-input",D="//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png",E="osm",F="mapquest",G="photon",H="bing",I="opencage",J="pelias",K={provider:E,placeholder:"Search for an address",featureStyle:null,targetType:B,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,debug:!1},L=y.cssClasses,M=function(a){this.options=a.options,this.els=this.createControl()};M.prototype.createControl=function(){var a,b,c;return this.options.targetType===C?(b=L.namespace+" "+L.inputText.container,c={container:a=r(["div",{id:y.containerId,classname:b}],M.input),control:p("."+L.inputText.control,a),input:p("."+L.inputText.input,a),reset:p("."+L.inputText.reset,a),result:p("."+L.inputText.result,a)}):(b=L.namespace+" "+L.glass.container,c={container:a=r(["div",{id:y.containerId,classname:b}],M.glass),control:p("."+L.glass.control,a),button:p("."+L.glass.button,a),input:p("."+L.glass.input,a),reset:p("."+L.glass.reset,a),result:p("."+L.glass.result,a)}),c.input.placeholder=this.options.placeholder,c},M.glass=['<div class="',L.glass.control," ",L.olControl,'">','<button type="button"',' id="',y.buttonControlId,'"',' class="',L.glass.button,'"></button>','<input type="text"',' id="',y.inputQueryId,'"',' class="',L.glass.input,'"',' autocomplete="off" placeholder="Search ...">',"<a",' id="',y.inputResetId,'"',' class="',L.glass.reset," ",L.hidden,'"',"></a>","</div>",'<ul class="',L.glass.result,'"></ul>'].join(""),M.input=['<div class="',L.inputText.control,'">','<input type="text"',' id="',y.inputQueryId,'"',' class="',L.inputText.input,'"',' autocomplete="off" placeholder="Search ...">','<span class="',L.inputText.icon,'"></span>','<button type="button"',' id="',y.inputResetId,'"',' class="',L.inputText.reset," ",L.hidden,'"',"></button>","</div>",'<ul class="',L.inputText.result,'"></ul>'].join("");var N=function(){this.settings={url:"https://photon.komoot.de/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}};N.prototype.getParameters=function(a){return a.lang=a.lang.toLowerCase(),{url:this.settings.url,params:{q:a.query,limit:a.limit||this.settings.params.limit,lang:this.settings.langs.indexOf(a.lang)>-1?a.lang:this.settings.params.lang}}},N.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.geometry.coordinates[0],lat:a.geometry.coordinates[1],address:{name:a.properties.name,postcode:a.properties.postcode,city:a.properties.city,state:a.properties.state,country:a.properties.country},original:{formatted:a.properties.name,details:a.properties}}})};var O=function(){this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}};O.prototype.getParameters=function(a){return{url:this.settings.url,params:{q:a.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:a.limit||this.settings.params.limit,countrycodes:a.countrycodes||this.settings.params.countrycodes,"accept-language":a.lang||this.settings.params["accept-language"]}}},O.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.lon,lat:a.lat,address:{name:a.display_name,road:a.address.road||"",houseNumber:a.address.house_number||"",postcode:a.address.postcode,city:a.address.city||a.address.town,state:a.address.state,country:a.address.country},original:{formatted:a.display_name,details:a.address}}})};var P=function(){this.settings={url:"http://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}};P.prototype.getParameters=function(a){return{url:this.settings.url,params:{q:a.query,key:a.key,format:"json",addressdetails:1,limit:a.limit||this.settings.params.limit,countrycodes:a.countrycodes||this.settings.params.countrycodes,"accept-language":a.lang||this.settings.params["accept-language"]}}},P.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.lon,lat:a.lat,address:{name:a.address.neighbourhood||"",road:a.address.road||"",postcode:a.address.postcode,city:a.address.city||a.address.town,state:a.address.state,country:a.address.country},original:{formatted:a.display_name,details:a.address}}})};var Q=function(){this.settings={url:"http://search.mapzen.com/v1/search",params:{size:10}}};Q.prototype.getParameters=function(a){return{url:this.settings.url,params:{text:a.query,api_key:a.key,size:a.limit||this.settings.params.size}}},Q.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.geometry.coordinates[0],lat:a.geometry.coordinates[1],address:{name:a.properties.name,house_number:a.properties.housenumber,postcode:a.properties.postalcode,road:a.properties.street,city:a.properties.city,state:a.properties.region,country:a.properties.country},original:{formatted:a.properties.label,details:a.properties}}})};var R=function(){this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}};R.prototype.getParameters=function(a){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:a.query,key:a.key,includeNeighborhood:a.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:a.maxResults||this.settings.params.maxResults}}},R.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.point.coordinates[1],lat:a.point.coordinates[0],address:{name:a.name},original:{formatted:a.address.formattedAddress,details:a.address}}})};var S=function(){this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}};S.prototype.getParameters=function(a){return{url:this.settings.url,params:{q:a.query,key:a.key,limit:a.limit||this.settings.params.limit,countrycode:a.countrycodes||this.settings.params.countrycodes}}},S.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.geometry.lng,lat:a.geometry.lat,address:{name:a.components.house_number||"",road:a.components.road||"",postcode:a.components.postcode,city:a.components.city||a.components.town,state:a.components.state,country:a.components.country},original:{formatted:a.formatted,details:a.components}}})};var T=y.cssClasses,U=function(c,d){this.Base=c,this.layerName=k("geocoder-layer-"),this.layer=new a({name:this.layerName,source:new b}),this.options=c.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.els=d,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners(),this.Photon=new N,this.OpenStreet=new O,this.MapQuest=new P,this.Pelias=new Q,this.Bing=new R,this.OpenCage=new S};return U.prototype.setListeners=function(){var a,b,c=this,d=function(){o(c.els.control,T.glass.expanded)?c.collapse():c.expand()};this.els.input.addEventListener("keypress",function(a){var b=a.target.value.trim();(a.key?"Enter"===a.key:a.which?13===a.which:a.keyCode&&13===a.keyCode)&&(a.preventDefault(),c.query(b))},!1),this.els.input.addEventListener("input",function(d){var e=d.target.value.trim();e.length?n(c.els.reset,T.hidden):m(c.els.reset,T.hidden),c.options.autoComplete&&e!==b&&(b=e,a&&clearTimeout(a),a=setTimeout(function(){e.length>=c.options.autoCompleteMinLength&&c.query(e)},200))},!1),this.els.reset.addEventListener("click",function(){c.els.input.focus(),c.els.input.value="",c.lastQuery="",m(c.els.reset,T.hidden),c.clearResults()},!1),this.options.targetType===B&&this.els.button.addEventListener("click",d,!1)},U.prototype.query=function(a){var b=this,c=this.getProvider({query:a,provider:this.options.provider,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});if(this.lastQuery!==a||!this.els.result.firstChild){this.lastQuery=a,this.clearResults(),m(this.els.reset,T.spin);var d={url:c.url,data:c.params};c.callbackName&&(d.jsonp=!0,d.callbackName=c.callbackName),v(d).then(function(a){var c;switch(b.options.debug&&console.info(a),n(b.els.reset,T.spin),b.options.provider){case E:c=a.length?b.OpenStreet.handleResponse(a):void 0;break;case F:c=a.length?b.MapQuest.handleResponse(a):void 0;break;case J:c=a.features.length?b.Pelias.handleResponse(a.features):void 0;break;case G:c=a.features.length?b.Photon.handleResponse(a.features):void 0;break;case H:c=a.resourceSets[0].resources.length?b.Bing.handleResponse(a.resourceSets[0].resources):void 0;break;case I:c=a.results.length?b.OpenCage.handleResponse(a.results):void 0;break;default:c=b.options.provider.handleResponse(a)}c&&(b.createList(c),b.listenMapClick())}).catch(function(){n(b.els.reset,T.spin);var a=r("li","<h5>Error! No internet connection?</h5>");b.els.result.appendChild(a)})}},U.prototype.createList=function(a){var b=this,c=this.els.result;a.forEach(function(a){var d;switch(b.options.provider){case E:d='<span class="'+T.road+'">'+a.address.name+"</span>";break;default:d=b.addressTemplate(a.address)}var e=r("li",'<a href="#">'+d+"</a>");e.addEventListener("click",function(c){c.preventDefault(),b.chosen(a,d,a.address,a.original)},!1),c.appendChild(e)})},U.prototype.chosen=function(a,b,c,d){var e=this.Base.getMap(),g=[parseFloat(a.lon),parseFloat(a.lat)],h=e.getView().getProjection(),i=f.transform(g,"EPSG:4326",h),j=a.bbox;j&&(j=f.transformExtent(j,"EPSG:4326",h));var k={formatted:b,details:c,original:d};if(!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault)this.Base.dispatchEvent({type:z,address:k,coordinate:i,bbox:j});else{j?e.getView().fit(j,{duration:500}):function(a,b,c,d){d=d||2.388657133911758,c=c||500,a.getView().animate({duration:c,resolution:d},{duration:c,center:b})}(e,i);var l=this.createFeature(i,k);this.Base.dispatchEvent({type:z,address:k,feature:l,coordinate:i,bbox:j})}},U.prototype.createFeature=function(a){var b=new e(new c(a));return this.addLayer(),b.setStyle(this.options.featureStyle),b.setId(k("geocoder-ft-")),this.getSource().addFeature(b),b},U.prototype.addressTemplate=function(a){var b=[];return a.name&&b.push(['<span class="',T.road,'">{name}</span>'].join("")),(a.road||a.building||a.house_number)&&b.push(['<span class="',T.road,'">{building} {road} {house_number}</span>'].join("")),(a.city||a.town||a.village)&&b.push(['<span class="',T.city,'">{postcode} {city} {town} {village}</span>'].join("")),(a.state||a.country)&&b.push(['<span class="',T.country,'">{state} {country}</span>'].join("")),q(b.join("<br>"),a)},U.prototype.getProvider=function(a){var b;switch(a.provider){case E:b=this.OpenStreet.getParameters(a);break;case F:b=this.MapQuest.getParameters(a);break;case G:b=this.Photon.getParameters(a);break;case J:b=this.Pelias.getParameters(a);break;case H:b=this.Bing.getParameters(a);break;case I:b=this.OpenCage.getParameters(a);break;default:b=a.provider.getParameters(a)}return b},U.prototype.expand=function(){var a=this;n(this.els.input,T.spin),m(this.els.control,T.glass.expanded),window.setTimeout(function(){return a.els.input.focus()},100),this.listenMapClick()},U.prototype.collapse=function(){this.els.input.value="",this.els.input.blur(),m(this.els.reset,T.hidden),n(this.els.control,T.glass.expanded),this.clearResults()},U.prototype.listenMapClick=function(){if(!this.registeredListeners.mapClick){var a=this,b=this.Base.getMap().getTargetElement();this.registeredListeners.mapClick=!0,b.addEventListener("click",{handleEvent:function(c){a.clearResults(!0),b.removeEventListener(c.type,this,!1),a.registeredListeners.mapClick=!1}},!1)}},U.prototype.clearResults=function(a){a&&this.options.targetType===B?this.collapse():function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}(this.els.result)},U.prototype.getSource=function(){return this.layer.getSource()},U.prototype.addLayer=function(){var a=this,b=!1,c=this.Base.getMap();c.getLayers().forEach(function(c){c===a.layer&&(b=!0)}),b||c.addLayer(this.layer)},function(a){function b(c,e){if(void 0===c&&(c=A.NOMINATIM),void 0===e&&(e={}),!(this instanceof b))return new b;var f;j("string"==typeof c,"@param `type` should be string!"),j(c===A.NOMINATIM||c===A.REVERSE,"@param 'type' should be '"+A.NOMINATIM+"'\n        or '"+A.REVERSE+"'!"),j("object"==d(e),"@param `options` should be object!"),K.featureStyle=[new h({image:new i({scale:.7,src:D})})],this.options=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}(K,e),this.container=void 0;var g=new M(this);c===A.NOMINATIM&&(this.container=g.els.container,f=new U(this,g.els),this.layer=f.layer),a.call(this,{element:this.container})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getLayer=function(){return this.layer},b.prototype.getSource=function(){return this.getLayer().getSource()},b.prototype.setProvider=function(a){this.options.provider=a},b.prototype.setProviderKey=function(a){this.options.key=a},b}(g)})},{"ol/Feature":9,"ol/control/Control":52,"ol/geom/Point":87,"ol/layer/Vector":142,"ol/proj":158,"ol/source/Vector":251,"ol/style/Icon":270,"ol/style/Style":278}],4:[function(a,b,c){"use strict";function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(e,f){"object"===("undefined"==typeof c?"undefined":d(c))&&"undefined"!=typeof b?b.exports=f(a("ol/control/Control"),a("ol/Observable")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/Observable"],f):e.LayerSwitcher=f(e.ol.control.Control,e.ol.Observable)}(void 0,function(a,b){a="default"in a?a["default"]:a,b="default"in b?b["default"]:b;var c=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function j(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:j(e,b,c)}if("value"in d)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},g=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+d(b));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},h=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==d(b)&&"function"!=typeof b?a:b},i=function(a){function d(a){c(this,d);var b=a||{},e=b.tipLabel?b.tipLabel:"Legend",f=document.createElement("div"),g=h(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,{element:f,target:b.target}));g.mapListeners=[],g.hiddenClassName="ol-unselectable ol-control layer-switcher",d.isTouchDevice_()&&(g.hiddenClassName+=" touch"),g.shownClassName="shown",f.className=g.hiddenClassName;var i=document.createElement("button");i.setAttribute("title",e),f.appendChild(i),g.panel=document.createElement("div"),g.panel.className="panel",f.appendChild(g.panel),d.enableTouchScroll_(g.panel);var j=g;return i.onmouseover=function(){j.showPanel()},i.onclick=function(a){a=a||window.event,j.showPanel(),a.preventDefault()},j.panel.onmouseout=function(a){a=a||window.event,j.panel.contains(a.toElement||a.relatedTarget)||j.hidePanel()},g}return g(d,a),e(d,[{key:"setMap",value:function(a){for(var c=0;c<this.mapListeners.length;c++)b.unByKey(this.mapListeners[c]);if(this.mapListeners.length=0,f(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"setMap",this).call(this,a),a){var e=this;this.mapListeners.push(a.on("pointerdown",function(){e.hidePanel()})),this.renderPanel()}}},{key:"showPanel",value:function(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.renderPanel())}},{key:"hidePanel",value:function(){this.element.classList.contains(this.shownClassName)&&this.element.classList.remove(this.shownClassName)}},{key:"renderPanel",value:function(){d.renderPanel(this.getMap(),this.panel)}}],[{key:"renderPanel",value:function(a,b){for(d.ensureTopVisibleBaseLayerShown_(a);b.firstChild;)b.removeChild(b.firstChild);var c=document.createElement("ul");b.appendChild(c),d.renderLayers_(a,a,c)}},{key:"ensureTopVisibleBaseLayerShown_",value:function(a){var b;d.forEachRecursive(a,function(a){"base"===a.get("type")&&a.getVisible()&&(b=a)}),b&&d.setVisible_(a,b,!0)}},{key:"setVisible_",value:function(a,b,c){b.setVisible(c),c&&"base"===b.get("type")&&d.forEachRecursive(a,function(a){a!=b&&"base"===a.get("type")&&a.setVisible(!1)})}},{key:"renderLayer_",value:function(a,b){var c=document.createElement("li"),e=b.get("title"),f=d.uuid(),g=document.createElement("label");if(b.getLayers&&!b.get("combine")){c.className="group",g.innerHTML=e,c.appendChild(g);var h=document.createElement("ul");c.appendChild(h),d.renderLayers_(a,b,h)}else{c.className="layer";var i=document.createElement("input");"base"===b.get("type")?(i.type="radio",i.name="base"):i.type="checkbox",i.id=f,i.checked=b.get("visible"),i.onchange=function(c){d.setVisible_(a,b,c.target.checked)},c.appendChild(i),g.htmlFor=f,g.innerHTML=e;var j=a.getView().getResolution();(j>b.getMaxResolution()||j<b.getMinResolution())&&(g.className+=" disabled"),c.appendChild(g)}return c}},{key:"renderLayers_",value:function(a,b,c){for(var e,f=b.getLayers().getArray().slice().reverse(),g=0;g<f.length;g++)e=f[g],e.get("title")&&c.appendChild(d.renderLayer_(a,e,g))}},{key:"forEachRecursive",value:function(a,b){a.getLayers().forEach(function(a,c,e){b(a,c,e),a.getLayers&&d.forEachRecursive(a,b)})}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}},{key:"enableTouchScroll_",value:function(a){if(d.isTouchDevice_()){var b=0;a.addEventListener("touchstart",function(a){b=this.scrollTop+a.touches[0].pageY},!1),a.addEventListener("touchmove",function(a){this.scrollTop=b-a.touches[0].pageY},!1)}}},{key:"isTouchDevice_",value:function(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}}}]),d}(a);return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=i),i})},{"ol/Observable":30,"ol/control/Control":52}],5:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("./util.js"),e=function(a){function b(b){var c=d.VERSION.split("-")[0],e="Assertion failed. See https://openlayers.org/en/"+c+"/doc/errors/#"+b+" for details.";a.call(this,e),this.code=b,this.name="AssertionError",this.message=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Error),f=e;c.default=f},{"./util.js":289}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.CollectionEvent=void 0;var e=d(a("./AssertionError.js")),f=d(a("./CollectionEventType.js")),g=d(a("./Object.js")),h=d(a("./events/Event.js")),i={LENGTH:"length"},j=function(a){function b(b,c){a.call(this,b),this.element=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default);c.CollectionEvent=j;var k=function(a){function b(b,c){var d=this;a.call(this);var e=c||{};if(this.unique_=!!e.unique,this.array_=b?b:[],this.unique_)for(var f=0,g=this.array_.length;g>f;++f)d.assertUnique_(d.array_[f],f);this.updateLength_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clear=function(){for(var a=this;this.getLength()>0;)a.pop()},b.prototype.extend=function(a){for(var b=this,c=0,d=a.length;d>c;++c)b.push(a[c]);return this},b.prototype.forEach=function(a){for(var b=this.array_,c=0,d=b.length;d>c;++c)a(b[c],c,b)},b.prototype.getArray=function(){return this.array_},b.prototype.item=function(a){return this.array_[a]},b.prototype.getLength=function(){return this.get(i.LENGTH)},b.prototype.insertAt=function(a,b){this.unique_&&this.assertUnique_(b),this.array_.splice(a,0,b),this.updateLength_(),this.dispatchEvent(new j(f.default.ADD,b))},b.prototype.pop=function(){return this.removeAt(this.getLength()-1)},b.prototype.push=function(a){this.unique_&&this.assertUnique_(a);var b=this.getLength();return this.insertAt(b,a),this.getLength()},b.prototype.remove=function(a){for(var b=this,c=this.array_,d=0,e=c.length;e>d;++d)if(c[d]===a)return b.removeAt(d);return void 0},b.prototype.removeAt=function(a){var b=this.array_[a];return this.array_.splice(a,1),this.updateLength_(),this.dispatchEvent(new j(f.default.REMOVE,b)),b},b.prototype.setAt=function(a,b){var c=this,d=this.getLength();if(d>a){this.unique_&&this.assertUnique_(b,a);var e=this.array_[a];this.array_[a]=b,this.dispatchEvent(new j(f.default.REMOVE,e)),this.dispatchEvent(new j(f.default.ADD,b))}else{for(var g=d;a>g;++g)c.insertAt(g,void 0);this.insertAt(a,b)}},b.prototype.updateLength_=function(){this.set(i.LENGTH,this.array_.length)},b.prototype.assertUnique_=function(a,b){for(var c=this,d=0,f=this.array_.length;f>d;++d)if(c.array_[d]===a&&d!==b)throw new e.default(58)},b}(g.default),l=k;c.default=l},{"./AssertionError.js":5,"./CollectionEventType.js":7,"./Object.js":28,"./events/Event.js":66}],7:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ADD:"add",REMOVE:"remove"};c.default=d},{}],8:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){this.disposed_=!1};d.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},d.prototype.disposeInternal=function(){};var e=d;c.default=e},{}],9:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){if("function"==typeof a)return a;
var b;return Array.isArray(a)?b=a:(g.assert(a instanceof l.default,41),b=[a]),function(){return b}}Object.defineProperty(c,"__esModule",{value:!0}),c.createStyleFunction=f,c.default=void 0;var g=a("./asserts.js"),h=a("./events.js"),i=e(a("./events/EventType.js")),j=d(a("./Object.js")),k=e(a("./geom/Geometry.js")),l=e(a("./style/Style.js")),m=function(a){function b(b){if(a.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,h.listen(this,j.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this),void 0!==b)if(b instanceof k.default||!b){var c=b;this.setGeometry(c)}else{var d=b;this.setProperties(d)}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function c(){var c=new b(this.getProperties());c.setGeometryName(this.getGeometryName());var a=this.getGeometry();a&&c.setGeometry(a.clone());var d=this.getStyle();return d&&c.setStyle(d),c},b.prototype.getGeometry=function(){return this.get(this.geometryName_)},b.prototype.getId=function(){return this.id_},b.prototype.getGeometryName=function(){return this.geometryName_},b.prototype.getStyle=function(){return this.style_},b.prototype.getStyleFunction=function(){return this.styleFunction_},b.prototype.handleGeometryChange_=function(){this.changed()},b.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(h.unlistenByKey(this.geometryChangeKey_),this.geometryChangeKey_=null);var a=this.getGeometry();a&&(this.geometryChangeKey_=h.listen(a,i.default.CHANGE,this.handleGeometryChange_,this)),this.changed()},b.prototype.setGeometry=function(a){this.set(this.geometryName_,a)},b.prototype.setStyle=function(a){this.style_=a,this.styleFunction_=a?f(a):void 0,this.changed()},b.prototype.setId=function(a){this.id_=a,this.changed()},b.prototype.setGeometryName=function(a){h.unlisten(this,j.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=a,h.listen(this,j.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},b}(j.default),n=m;c.default=n},{"./Object.js":28,"./asserts.js":46,"./events.js":65,"./events/EventType.js":67,"./geom/Geometry.js":79,"./style/Style.js":278}],10:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("./GeolocationProperty.js")),g=d(a("./Object.js")),h=a("./events.js"),i=e(a("./events/EventType.js")),j=a("./geom/Polygon.js"),k=a("./has.js"),l=a("./math.js"),m=a("./proj.js"),n=function(a){function b(b){a.call(this);var c=b||{};this.position_=null,this.transform_=m.identityTransform,this.watchId_=void 0,h.listen(this,g.getChangeEventType(f.default.PROJECTION),this.handleProjectionChanged_,this),h.listen(this,g.getChangeEventType(f.default.TRACKING),this.handleTrackingChanged_,this),void 0!==c.projection&&this.setProjection(c.projection),void 0!==c.trackingOptions&&this.setTrackingOptions(c.trackingOptions),this.setTracking(void 0!==c.tracking?c.tracking:!1)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.setTracking(!1),a.prototype.disposeInternal.call(this)},b.prototype.handleProjectionChanged_=function(){var a=this.getProjection();a&&(this.transform_=m.getTransformFromProjections(m.get("EPSG:4326"),a),this.position_&&this.set(f.default.POSITION,this.transform_(this.position_)))},b.prototype.handleTrackingChanged_=function(){if(k.GEOLOCATION){var a=this.getTracking();a&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):a||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},b.prototype.positionChange_=function(a){var b=a.coords;this.set(f.default.ACCURACY,b.accuracy),this.set(f.default.ALTITUDE,null===b.altitude?void 0:b.altitude),this.set(f.default.ALTITUDE_ACCURACY,null===b.altitudeAccuracy?void 0:b.altitudeAccuracy),this.set(f.default.HEADING,null===b.heading?void 0:l.toRadians(b.heading)),this.position_?(this.position_[0]=b.longitude,this.position_[1]=b.latitude):this.position_=[b.longitude,b.latitude];var c=this.transform_(this.position_);this.set(f.default.POSITION,c),this.set(f.default.SPEED,null===b.speed?void 0:b.speed);var d=j.circular(this.position_,b.accuracy);d.applyTransform(this.transform_),this.set(f.default.ACCURACY_GEOMETRY,d),this.changed()},b.prototype.positionError_=function(a){a.type=i.default.ERROR,this.setTracking(!1),this.dispatchEvent(a)},b.prototype.getAccuracy=function(){return this.get(f.default.ACCURACY)},b.prototype.getAccuracyGeometry=function(){return this.get(f.default.ACCURACY_GEOMETRY)||null},b.prototype.getAltitude=function(){return this.get(f.default.ALTITUDE)},b.prototype.getAltitudeAccuracy=function(){return this.get(f.default.ALTITUDE_ACCURACY)},b.prototype.getHeading=function(){return this.get(f.default.HEADING)},b.prototype.getPosition=function(){return this.get(f.default.POSITION)},b.prototype.getProjection=function(){return this.get(f.default.PROJECTION)},b.prototype.getSpeed=function(){return this.get(f.default.SPEED)},b.prototype.getTracking=function(){return this.get(f.default.TRACKING)},b.prototype.getTrackingOptions=function(){return this.get(f.default.TRACKING_OPTIONS)},b.prototype.setProjection=function(a){this.set(f.default.PROJECTION,m.get(a))},b.prototype.setTracking=function(a){this.set(f.default.TRACKING,a)},b.prototype.setTrackingOptions=function(a){this.set(f.default.TRACKING_OPTIONS,a)},b}(g.default),o=n;c.default=o},{"./GeolocationProperty.js":11,"./Object.js":28,"./events.js":65,"./events/EventType.js":67,"./geom/Polygon.js":88,"./has.js":109,"./math.js":147,"./proj.js":158}],11:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"};c.default=d},{}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./coordinate.js"),f=a("./events.js"),g=a("./extent.js"),h=d(a("./geom/GeometryLayout.js")),i=d(a("./geom/LineString.js")),j=d(a("./geom/Point.js")),k=a("./geom/flat/geodesic.js"),l=a("./math.js"),m=a("./proj.js"),n=d(a("./render/EventType.js")),o=d(a("./style/Fill.js")),p=d(a("./style/Stroke.js")),q=d(a("./style/Text.js")),r=new p.default({color:"rgba(0,0,0,0.2)"}),s=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],t=function(a){var b=a||{};this.map_=null,this.postcomposeListenerKey_=null,this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxLatP_=1/0,this.maxLonP_=1/0,this.minLatP_=-1/0,this.minLonP_=-1/0,this.targetSize_=void 0!==b.targetSize?b.targetSize:100,this.maxLines_=void 0!==b.maxLines?b.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=void 0!==b.strokeStyle?b.strokeStyle:r,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,1==b.showLabels&&(this.lonLabelFormatter_=void 0==b.lonLabelFormatter?e.degreesToStringHDMS.bind(this,"EW"):b.lonLabelFormatter,this.latLabelFormatter_=void 0==b.latLabelFormatter?e.degreesToStringHDMS.bind(this,"NS"):b.latLabelFormatter,this.lonLabelPosition_=void 0==b.lonLabelPosition?0:b.lonLabelPosition,this.latLabelPosition_=void 0==b.latLabelPosition?1:b.latLabelPosition,this.lonLabelStyle_=void 0!==b.lonLabelStyle?b.lonLabelStyle:new q.default({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new o.default({color:"rgba(0,0,0,1)"}),stroke:new p.default({color:"rgba(255,255,255,1)",width:3})}),this.latLabelStyle_=void 0!==b.latLabelStyle?b.latLabelStyle:new q.default({font:"12px Calibri,sans-serif",textAlign:"end",fill:new o.default({color:"rgba(0,0,0,1)"}),stroke:new p.default({color:"rgba(255,255,255,1)",width:3})}),this.meridiansLabels_=[],this.parallelsLabels_=[]),this.setMap(void 0!==b.map?b.map:null)};t.prototype.addMeridian_=function(a,b,c,d,e,f){var h=this.getMeridian_(a,b,c,d,f);if(g.intersects(h.getExtent(),e)){if(this.meridiansLabels_){var i=this.getMeridianPoint_(h,e,f);this.meridiansLabels_[f]={geom:i,text:this.lonLabelFormatter_(a)}}this.meridians_[f++]=h}return f},t.prototype.getMeridianPoint_=function(a,b,c){var d,e=a.getFlatCoordinates(),f=Math.max(b[1],e[1]),g=Math.min(b[3],e[e.length-1]),h=l.clamp(b[1]+Math.abs(b[1]-b[3])*this.lonLabelPosition_,f,g),i=[e[0],h];return c in this.meridiansLabels_?(d=this.meridiansLabels_[c].geom,d.setCoordinates(i)):d=new j.default(i),d},t.prototype.addParallel_=function(a,b,c,d,e,f){var h=this.getParallel_(a,b,c,d,f);if(g.intersects(h.getExtent(),e)){if(this.parallelsLabels_){var i=this.getParallelPoint_(h,e,f);this.parallelsLabels_[f]={geom:i,text:this.latLabelFormatter_(a)}}this.parallels_[f++]=h}return f},t.prototype.getParallelPoint_=function(a,b,c){var d,e=a.getFlatCoordinates(),f=Math.max(b[0],e[0]),g=Math.min(b[2],e[e.length-2]),h=l.clamp(b[0]+Math.abs(b[0]-b[2])*this.latLabelPosition_,f,g),i=[h,e[1]];return c in this.parallelsLabels_?(d=this.parallelsLabels_[c].geom,d.setCoordinates(i)):d=new j.default(i),d},t.prototype.createGraticule_=function(a,b,c,d){var e=this,f=this.getInterval_(c);if(-1==f)return this.meridians_.length=this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var g,h,i,j,k=this.toLonLatTransform_(b),n=k[0],o=k[1],p=this.maxLines_,q=[Math.max(a[0],this.minLonP_),Math.max(a[1],this.minLatP_),Math.min(a[2],this.maxLonP_),Math.min(a[3],this.maxLatP_)];q=m.transformExtent(q,this.projection_,"EPSG:4326");var r=q[3],s=q[2],t=q[1],u=q[0];for(n=Math.floor(n/f)*f,j=l.clamp(n,this.minLon_,this.maxLon_),h=this.addMeridian_(j,t,r,d,a,0),g=0;j!=this.minLon_&&g++<p;)j=Math.max(j-f,e.minLon_),h=e.addMeridian_(j,t,r,d,a,h);for(j=l.clamp(n,this.minLon_,this.maxLon_),g=0;j!=this.maxLon_&&g++<p;)j=Math.min(j+f,e.maxLon_),h=e.addMeridian_(j,t,r,d,a,h);for(this.meridians_.length=h,this.meridiansLabels_&&(this.meridiansLabels_.length=h),o=Math.floor(o/f)*f,i=l.clamp(o,this.minLat_,this.maxLat_),h=this.addParallel_(i,u,s,d,a,0),g=0;i!=this.minLat_&&g++<p;)i=Math.max(i-f,e.minLat_),h=e.addParallel_(i,u,s,d,a,h);for(i=l.clamp(o,this.minLat_,this.maxLat_),g=0;i!=this.maxLat_&&g++<p;)i=Math.min(i+f,e.maxLat_),h=e.addParallel_(i,u,s,d,a,h);this.parallels_.length=h,this.parallelsLabels_&&(this.parallelsLabels_.length=h)},t.prototype.getInterval_=function(a){for(var b=this,c=this.projectionCenterLonLat_[0],d=this.projectionCenterLonLat_[1],e=-1,f=Math.pow(this.targetSize_*a,2),g=[],h=[],i=0,j=s.length;j>i;++i){var k=s[i]/2;g[0]=c-k,g[1]=d-k,h[0]=c+k,h[1]=d+k,b.fromLonLatTransform_(g,g),b.fromLonLatTransform_(h,h);var l=Math.pow(h[0]-g[0],2)+Math.pow(h[1]-g[1],2);if(f>=l)break;e=s[i]}return e},t.prototype.getMap=function(){return this.map_},t.prototype.getMeridian_=function(a,b,c,d,e){var f=k.meridian(a,b,c,this.projection_,d),g=this.meridians_[e];return g?(g.setFlatCoordinates(h.default.XY,f),g.changed()):g=this.meridians_[e]=new i.default(f,h.default.XY),g},t.prototype.getMeridians=function(){return this.meridians_},t.prototype.getParallel_=function(a,b,c,d,e){var f=k.parallel(a,b,c,this.projection_,d),g=this.parallels_[e];return g?(g.setFlatCoordinates(h.default.XY,f),g.changed()):g=new i.default(f,h.default.XY),g},t.prototype.getParallels=function(){return this.parallels_},t.prototype.handlePostCompose_=function(a){var b=this,c=a.vectorContext,d=a.frameState,e=d.extent,f=d.viewState,g=f.center,h=f.projection,i=f.resolution,j=d.pixelRatio,k=i*i/(4*j*j),l=!this.projection_||!m.equivalent(this.projection_,h);l&&this.updateProjectionInfo_(h),this.createGraticule_(e,g,i,k),c.setFillStrokeStyle(null,this.strokeStyle_);var n,o,p;for(n=0,o=this.meridians_.length;o>n;++n)p=b.meridians_[n],c.drawGeometry(p);for(n=0,o=this.parallels_.length;o>n;++n)p=b.parallels_[n],c.drawGeometry(p);var q;if(this.meridiansLabels_)for(n=0,o=this.meridiansLabels_.length;o>n;++n)q=b.meridiansLabels_[n],b.lonLabelStyle_.setText(q.text),c.setTextStyle(b.lonLabelStyle_),c.drawGeometry(q.geom);if(this.parallelsLabels_)for(n=0,o=this.parallelsLabels_.length;o>n;++n)q=b.parallelsLabels_[n],b.latLabelStyle_.setText(q.text),c.setTextStyle(b.latLabelStyle_),c.drawGeometry(q.geom)},t.prototype.updateProjectionInfo_=function(a){var b=m.get("EPSG:4326"),c=a.getWorldExtent(),d=m.transformExtent(c,b,a);this.maxLat_=c[3],this.maxLon_=c[2],this.minLat_=c[1],this.minLon_=c[0],this.maxLatP_=d[3],this.maxLonP_=d[2],this.minLatP_=d[1],this.minLonP_=d[0],this.fromLonLatTransform_=m.getTransform(b,a),this.toLonLatTransform_=m.getTransform(a,b),this.projectionCenterLonLat_=this.toLonLatTransform_(g.getCenter(a.getExtent())),this.projection_=a},t.prototype.setMap=function(a){this.map_&&(f.unlistenByKey(this.postcomposeListenerKey_),this.postcomposeListenerKey_=null,this.map_.render()),a&&(this.postcomposeListenerKey_=f.listen(a,n.default.POSTCOMPOSE,this.handlePostCompose_,this),a.render()),this.map_=a};var u=t;c.default=u},{"./coordinate.js":61,"./events.js":65,"./extent.js":71,"./geom/GeometryLayout.js":80,"./geom/LineString.js":82,"./geom/Point.js":87,"./geom/flat/geodesic.js":95,"./math.js":147,"./proj.js":158,"./render/EventType.js":168,"./style/Fill.js":269,"./style/Stroke.js":277,"./style/Text.js":279}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./ImageBase.js")),f=d(a("./ImageState.js")),g=a("./events.js"),h=d(a("./events/EventType.js")),i=a("./extent.js"),j=function(a){function b(b,c,d,e,g,h){a.call(this,b,c,d,f.default.IDLE),this.src_=e,this.image_=new Image,null!==g&&(this.image_.crossOrigin=g),this.imageListenerKeys_=null,this.state=f.default.IDLE,this.imageLoadFunction_=h}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){return this.image_},b.prototype.handleImageError_=function(){this.state=f.default.ERROR,this.unlistenImage_(),this.changed()},b.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=i.getHeight(this.extent)/this.image_.height),this.state=f.default.LOADED,this.unlistenImage_(),this.changed()},b.prototype.load=function(){(this.state==f.default.IDLE||this.state==f.default.ERROR)&&(this.state=f.default.LOADING,this.changed(),this.imageListenerKeys_=[g.listenOnce(this.image_,h.default.ERROR,this.handleImageError_,this),g.listenOnce(this.image_,h.default.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},b.prototype.setImage=function(a){this.image_=a},b.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(g.unlistenByKey),this.imageListenerKeys_=null},b}(e.default),k=j;c.default=k},{"./ImageBase.js":14,"./ImageState.js":16,"./events.js":65,"./events/EventType.js":67,"./extent.js":71}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./events/Target.js")),f=d(a("./events/EventType.js")),g=function(a){function b(b,c,d,e){a.call(this),this.extent=b,this.pixelRatio_=d,this.resolution=c,this.state=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.changed=function(){this.dispatchEvent(f.default.CHANGE)},b.prototype.getExtent=function(){return this.extent},b.prototype.getImage=function(){},b.prototype.getPixelRatio=function(){return this.pixelRatio_},b.prototype.getResolution=function(){return this.resolution},b.prototype.getState=function(){return this.state},b.prototype.load=function(){},b}(e.default),h=g;c.default=h},{"./events/EventType.js":67,"./events/Target.js":69}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./ImageBase.js")),f=d(a("./ImageState.js")),g=function(a){function b(b,c,d,e,g){var h=void 0!==g?f.default.IDLE:f.default.LOADED;a.call(this,b,c,d,h),this.loader_=void 0!==g?g:null,this.canvas_=e,this.error_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getError=function(){return this.error_},b.prototype.handleLoad_=function(a){a?(this.error_=a,this.state=f.default.ERROR):this.state=f.default.LOADED,this.changed()},b.prototype.load=function(){this.state==f.default.IDLE&&(this.state=f.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},b.prototype.getImage=function(){return this.canvas_},b}(e.default),h=g;c.default=h},{"./ImageBase.js":14,"./ImageState.js":16}],16:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IDLE:0,LOADING:1,LOADED:2,ERROR:3};c.default=d},{}],17:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){var a=h.createCanvasContext2D(1,1);return a.fillStyle="rgba(0,0,0,0)",a.fillRect(0,0,1,1),a.canvas}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a("./Tile.js")),g=d(a("./TileState.js")),h=a("./dom.js"),i=a("./events.js"),j=d(a("./events/EventType.js")),k=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,g),this.crossOrigin_=e,this.src_=d,this.image_=new Image,null!==e&&(this.image_.crossOrigin=e),this.imageListenerKeys_=null,this.tileLoadFunction_=f}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.state==g.default.LOADING&&(this.unlistenImage_(),this.image_=e()),this.interimTile&&this.interimTile.dispose(),this.state=g.default.ABORT,this.changed(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.image_},b.prototype.getKey=function(){return this.src_},b.prototype.handleImageError_=function(){this.state=g.default.ERROR,this.unlistenImage_(),this.image_=e(),this.changed()},b.prototype.handleImageLoad_=function(){this.state=this.image_.naturalWidth&&this.image_.naturalHeight?g.default.LOADED:g.default.EMPTY,this.unlistenImage_(),this.changed()},b.prototype.load=function(){this.state==g.default.ERROR&&(this.state=g.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==g.default.IDLE&&(this.state=g.default.LOADING,this.changed(),this.imageListenerKeys_=[i.listenOnce(this.image_,j.default.ERROR,this.handleImageError_,this),i.listenOnce(this.image_,j.default.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},b.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(i.unlistenByKey),this.imageListenerKeys_=null},b}(f.default),l=k;c.default=l},{"./Tile.js":34,"./TileState.js":38,"./dom.js":63,"./events.js":65,"./events/EventType.js":67}],18:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a,b,c){this.decay_=a,this.minVelocity_=b,this.delay_=c,this.points_=[],this.angle_=0,this.initialVelocity_=0};d.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},d.prototype.update=function(a,b){this.points_.push(a,b,Date.now())},d.prototype.end=function(){if(this.points_.length<6)return!1;var a=Date.now()-this.delay_,b=this.points_.length-3;if(this.points_[b+2]<a)return!1;for(var c=b-3;c>0&&this.points_[c+2]>a;)c-=3;var d=this.points_[b+2]-this.points_[c+2];if(1e3/60>d)return!1;var e=this.points_[b]-this.points_[c],f=this.points_[b+1]-this.points_[c+1];return this.angle_=Math.atan2(f,e),this.initialVelocity_=Math.sqrt(e*e+f*f)/d,this.initialVelocity_>this.minVelocity_},d.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},d.prototype.getAngle=function(){return this.angle_};var e=d;c.default=e},{}],19:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};c.default=d},{}],20:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./PluggableMap.js")),f=a("./control/util.js"),g=a("./interaction.js"),h=a("./obj.js"),i=d(a("./renderer/canvas/ImageLayer.js")),j=d(a("./renderer/canvas/Map.js")),k=d(a("./renderer/canvas/TileLayer.js")),l=d(a("./renderer/canvas/VectorLayer.js")),m=d(a("./renderer/canvas/VectorTileLayer.js")),n=function(a){function b(b){b=h.assign({},b),b.controls||(b.controls=f.defaults()),b.interactions||(b.interactions=g.defaults()),a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createRenderer=function(){var a=new j.default(this);return a.registerLayerRenderers([i.default,k.default,l.default,m.default]),a},b}(e.default),o=n;c.default=o},{"./PluggableMap.js":33,"./control/util.js":60,"./interaction.js":111,"./obj.js":149,"./renderer/canvas/ImageLayer.js":202,"./renderer/canvas/Map.js":205,"./renderer/canvas/TileLayer.js":206,"./renderer/canvas/VectorLayer.js":207,"./renderer/canvas/VectorTileLayer.js":208}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./MapEvent.js")),f=function(a){function b(b,c,d,e,f){a.call(this,b,c,f),this.originalEvent=d,this.pixel=c.getEventPixel(d),this.coordinate=c.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==e?e:!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.preventDefault=function(){a.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},b.prototype.stopPropagation=function(){a.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},b}(e.default),g=f;c.default=g},{"./MapEvent.js":25}],22:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./has.js"),f=d(a("./MapBrowserEventType.js")),g=d(a("./MapBrowserPointerEvent.js")),h=a("./events.js"),i=d(a("./events/Target.js")),j=d(a("./pointer/EventType.js")),k=d(a("./pointer/PointerEventHandler.js")),l=function(a){function b(b,c){a.call(this),this.map_=b,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=c?c*e.DEVICE_PIXEL_RATIO:e.DEVICE_PIXEL_RATIO,this.down_=null;var d=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new k.default(d),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=h.listen(this.pointerEventHandler_,j.default.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=h.listen(this.pointerEventHandler_,j.default.POINTERMOVE,this.relayEvent_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.emulateClick_=function(a){var b=new g.default(f.default.CLICK,this.map_,a);this.dispatchEvent(b),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,b=new g.default(f.default.DBLCLICK,this.map_,a),this.dispatchEvent(b)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var b=new g.default(f.default.SINGLECLICK,this.map_,a);this.dispatchEvent(b)}.bind(this),250)},b.prototype.updateActivePointers_=function(a){var b=a;b.type==f.default.POINTERUP||b.type==f.default.POINTERCANCEL?delete this.trackedTouches_[b.pointerId]:b.type==f.default.POINTERDOWN&&(this.trackedTouches_[b.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},b.prototype.handlePointerUp_=function(a){this.updateActivePointers_(a);var b=new g.default(f.default.POINTERUP,this.map_,a);this.dispatchEvent(b),b.propagationStopped||this.dragging_||!this.isMouseActionButton_(a)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(h.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},b.prototype.isMouseActionButton_=function(a){return 0===a.button},b.prototype.handlePointerDown_=function(a){this.updateActivePointers_(a);var b=new g.default(f.default.POINTERDOWN,this.map_,a);this.dispatchEvent(b),this.down_=a,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new k.default(document),this.dragListenerKeys_.push(h.listen(this.documentPointerEventHandler_,f.default.POINTERMOVE,this.handlePointerMove_,this),h.listen(this.documentPointerEventHandler_,f.default.POINTERUP,this.handlePointerUp_,this),h.listen(this.pointerEventHandler_,f.default.POINTERCANCEL,this.handlePointerUp_,this)))},b.prototype.handlePointerMove_=function(a){if(this.isMoving_(a)){this.dragging_=!0;var b=new g.default(f.default.POINTERDRAG,this.map_,a,this.dragging_);this.dispatchEvent(b)}a.preventDefault()},b.prototype.relayEvent_=function(a){var b=!(!this.down_||!this.isMoving_(a));this.dispatchEvent(new g.default(a.type,this.map_,a,b))},b.prototype.isMoving_=function(a){return this.dragging_||Math.abs(a.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(a.clientY-this.down_.clientY)>this.moveTolerance_},b.prototype.disposeInternal=function(){this.relayedListenerKey_&&(h.unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(h.unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(h.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),a.prototype.disposeInternal.call(this)},b}(i.default),m=l;c.default=m},{"./MapBrowserEventType.js":23,"./MapBrowserPointerEvent.js":24,"./events.js":65,"./events/Target.js":69,"./has.js":109,"./pointer/EventType.js":151,"./pointer/PointerEventHandler.js":156}],23:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./events/EventType.js")),f={SINGLECLICK:"singleclick",CLICK:e.default.CLICK,DBLCLICK:e.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};c.default=f},{"./events/EventType.js":67}],24:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./MapBrowserEvent.js")),f=function(a){function b(b,c,d,e,f){a.call(this,b,c,d.originalEvent,e,f),this.pointerEvent=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"./MapBrowserEvent.js":21}],25:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./events/Event.js")),f=function(a){function b(b,c,d){a.call(this,b),this.map=c,this.frameState=void 0!==d?d:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"./events/Event.js":66}],26:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};c.default=d},{}],27:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};c.default=d},{}],28:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return m.hasOwnProperty(a)?m[a]:m[a]="change:"+a}Object.defineProperty(c,"__esModule",{value:!0}),c.getChangeEventType=e,c.default=void 0;var f=a("./util.js"),g=d(a("./ObjectEventType.js")),h=d(a("./Observable.js")),i=d(a("./events/Event.js")),j=a("./obj.js"),k=function(a){function b(b,c,d){a.call(this,b),this.key=c,this.oldValue=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),l=function(a){function b(b){a.call(this),f.getUid(this),this.values_={},void 0!==b&&this.setProperties(b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){var b;return this.values_.hasOwnProperty(a)&&(b=this.values_[a]),b},b.prototype.getKeys=function(){return Object.keys(this.values_)},b.prototype.getProperties=function(){return j.assign({},this.values_)},b.prototype.notify=function(a,b){var c;c=e(a),this.dispatchEvent(new k(c,a,b)),c=g.default.PROPERTYCHANGE,this.dispatchEvent(new k(c,a,b))},b.prototype.set=function(a,b,c){if(c)this.values_[a]=b;else{var d=this.values_[a];this.values_[a]=b,d!==b&&this.notify(a,d)}},b.prototype.setProperties=function(a,b){var c=this;for(var d in a)c.set(d,a[d],b)},b.prototype.unset=function(a,b){if(a in this.values_){var c=this.values_[a];delete this.values_[a],b||this.notify(a,c)}},b}(h.default),m={},n=l;c.default=n},{"./ObjectEventType.js":29,"./Observable.js":30,"./events/Event.js":66,"./obj.js":149,"./util.js":289}],29:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={PROPERTYCHANGE:"propertychange"};c.default=d},{}],30:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(Array.isArray(a))for(var b=0,c=a.length;c>b;++b)f.unlistenByKey(a[b]);else f.unlistenByKey(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.unByKey=e,c.default=void 0;var f=a("./events.js"),g=d(a("./events/Target.js")),h=d(a("./events/EventType.js")),i=function(a){function b(){a.call(this),this.revision_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.changed=function(){++this.revision_,this.dispatchEvent(h.default.CHANGE)},b.prototype.getRevision=function(){return this.revision_},b.prototype.on=function(a,b){var c=this;if(Array.isArray(a)){for(var d=a.length,e=new Array(d),g=0;d>g;++g)e[g]=f.listen(c,a[g],b);return e}return f.listen(this,a,b)},b.prototype.once=function(a,b){var c=this;if(Array.isArray(a)){for(var d=a.length,e=new Array(d),g=0;d>g;++g)e[g]=f.listenOnce(c,a[g],b);return e}return f.listenOnce(this,a,b)},b.prototype.un=function(a,b){var c=this;if(Array.isArray(a))for(var d=0,e=a.length;e>d;++d)f.unlisten(c,a[d],b);else f.unlisten(this,a,b)},b}(g.default),j=i;c.default=j},{"./events.js":65,"./events/EventType.js":67,"./events/Target.js":69}],31:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}
}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("./MapEventType.js")),g=d(a("./Object.js")),h=e(a("./OverlayPositioning.js")),i=a("./css.js"),j=a("./dom.js"),k=a("./events.js"),l=a("./extent.js"),m={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},n=function(a){function b(b){a.call(this),this.options=b,this.id=b.id,this.insertFirst=void 0!==b.insertFirst?b.insertFirst:!0,this.stopEvent=void 0!==b.stopEvent?b.stopEvent:!0,this.element=document.createElement("div"),this.element.className=void 0!==b.className?b.className:"ol-overlay-container "+i.CLASS_SELECTABLE,this.element.style.position="absolute",this.autoPan=void 0!==b.autoPan?b.autoPan:!1,this.autoPanAnimation=b.autoPanAnimation||{},this.autoPanMargin=void 0!==b.autoPanMargin?b.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,k.listen(this,g.getChangeEventType(m.ELEMENT),this.handleElementChanged,this),k.listen(this,g.getChangeEventType(m.MAP),this.handleMapChanged,this),k.listen(this,g.getChangeEventType(m.OFFSET),this.handleOffsetChanged,this),k.listen(this,g.getChangeEventType(m.POSITION),this.handlePositionChanged,this),k.listen(this,g.getChangeEventType(m.POSITIONING),this.handlePositioningChanged,this),void 0!==b.element&&this.setElement(b.element),this.setOffset(void 0!==b.offset?b.offset:[0,0]),this.setPositioning(void 0!==b.positioning?b.positioning:h.default.TOP_LEFT),void 0!==b.position&&this.setPosition(b.position)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getElement=function(){return this.get(m.ELEMENT)},b.prototype.getId=function(){return this.id},b.prototype.getMap=function(){return this.get(m.MAP)},b.prototype.getOffset=function(){return this.get(m.OFFSET)},b.prototype.getPosition=function(){return this.get(m.POSITION)},b.prototype.getPositioning=function(){return this.get(m.POSITIONING)},b.prototype.handleElementChanged=function(){j.removeChildren(this.element);var a=this.getElement();a&&this.element.appendChild(a)},b.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(j.removeNode(this.element),k.unlistenByKey(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var a=this.getMap();if(a){this.mapPostrenderListenerKey=k.listen(a,f.default.POSTRENDER,this.render,this),this.updatePixelPosition();var b=this.stopEvent?a.getOverlayContainerStopEvent():a.getOverlayContainer();this.insertFirst?b.insertBefore(this.element,b.childNodes[0]||null):b.appendChild(this.element)}},b.prototype.render=function(){this.updatePixelPosition()},b.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},b.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(m.POSITION)&&this.autoPan&&this.panIntoView()},b.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},b.prototype.setElement=function(a){this.set(m.ELEMENT,a)},b.prototype.setMap=function(a){this.set(m.MAP,a)},b.prototype.setOffset=function(a){this.set(m.OFFSET,a)},b.prototype.setPosition=function(a){this.set(m.POSITION,a)},b.prototype.panIntoView=function(){var a=this.getMap();if(a&&a.getTargetElement()){var b=this.getRect(a.getTargetElement(),a.getSize()),c=this.getElement(),d=this.getRect(c,[j.outerWidth(c),j.outerHeight(c)]),e=this.autoPanMargin;if(!l.containsExtent(b,d)){var f=d[0]-b[0],g=b[2]-d[2],h=d[1]-b[1],i=b[3]-d[3],k=[0,0];if(0>f?k[0]=f-e:0>g&&(k[0]=Math.abs(g)+e),0>h?k[1]=h-e:0>i&&(k[1]=Math.abs(i)+e),0!==k[0]||0!==k[1]){var m=a.getView().getCenter(),n=a.getPixelFromCoordinate(m),o=[n[0]+k[0],n[1]+k[1]];a.getView().animate({center:a.getCoordinateFromPixel(o),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},b.prototype.getRect=function(a,b){var c=a.getBoundingClientRect(),d=c.left+window.pageXOffset,e=c.top+window.pageYOffset;return[d,e,d+b[0],e+b[1]]},b.prototype.setPositioning=function(a){this.set(m.POSITIONING,a)},b.prototype.setVisible=function(a){this.rendered.visible!==a&&(this.element.style.display=a?"":"none",this.rendered.visible=a)},b.prototype.updatePixelPosition=function(){var a=this.getMap(),b=this.getPosition();if(!a||!a.isRendered()||!b)return void this.setVisible(!1);var c=a.getPixelFromCoordinate(b),d=a.getSize();this.updateRenderedPosition(c,d)},b.prototype.updateRenderedPosition=function(a,b){var c=this.element.style,d=this.getOffset(),e=this.getPositioning();this.setVisible(!0);var f=d[0],g=d[1];if(e==h.default.BOTTOM_RIGHT||e==h.default.CENTER_RIGHT||e==h.default.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=c.left="");var i=Math.round(b[0]-a[0]-f)+"px";this.rendered.right_!=i&&(this.rendered.right_=c.right=i)}else{""!==this.rendered.right_&&(this.rendered.right_=c.right=""),(e==h.default.BOTTOM_CENTER||e==h.default.CENTER_CENTER||e==h.default.TOP_CENTER)&&(f-=this.element.offsetWidth/2);var j=Math.round(a[0]+f)+"px";this.rendered.left_!=j&&(this.rendered.left_=c.left=j)}if(e==h.default.BOTTOM_LEFT||e==h.default.BOTTOM_CENTER||e==h.default.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=c.top="");var k=Math.round(b[1]-a[1]-g)+"px";this.rendered.bottom_!=k&&(this.rendered.bottom_=c.bottom=k)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=c.bottom=""),(e==h.default.CENTER_LEFT||e==h.default.CENTER_CENTER||e==h.default.CENTER_RIGHT)&&(g-=this.element.offsetHeight/2);var l=Math.round(a[1]+g)+"px";this.rendered.top_!=l&&(this.rendered.top_=c.top=l)}},b.prototype.getOptions=function(){return this.options},b}(g.default),o=n;c.default=o},{"./MapEventType.js":26,"./Object.js":28,"./OverlayPositioning.js":32,"./css.js":62,"./dom.js":63,"./events.js":65,"./extent.js":71}],32:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};c.default=d},{}],33:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=null;void 0!==a.keyboardEventTarget&&(b="string"==typeof a.keyboardEventTarget?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);var c={},d=a.layers instanceof E.default?a.layers:new E.default({layers:a.layers});c[p.default.LAYERGROUP]=d,c[p.default.TARGET]=a.target,c[p.default.VIEW]=void 0!==a.view?a.view:new u.default;var e;void 0!==a.controls&&(Array.isArray(a.controls)?e=new i.default(a.controls.slice()):(w.assert(a.controls instanceof i.default,47),e=a.controls));var f;void 0!==a.interactions&&(Array.isArray(a.interactions)?f=new i.default(a.interactions.slice()):(w.assert(a.interactions instanceof i.default,48),f=a.interactions));var g;return void 0!==a.overlays?Array.isArray(a.overlays)?g=new i.default(a.overlays.slice()):(w.assert(a.overlays instanceof i.default,49),g=a.overlays):g=new i.default,{controls:e,interactions:f,keyboardEventTarget:b,overlays:g,values:c}}function g(a){for(var b=0,c=a.length;c>b;++b){var d=a[b];if(d instanceof E.default)return g(d.getLayers().getArray());var e=a[b].getSource();if(e&&e.loading)return!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=a("./util.js"),i=e(a("./Collection.js")),j=e(a("./CollectionEventType.js")),k=e(a("./MapBrowserEvent.js")),l=e(a("./MapBrowserEventHandler.js")),m=e(a("./MapBrowserEventType.js")),n=e(a("./MapEvent.js")),o=e(a("./MapEventType.js")),p=e(a("./MapProperty.js")),q=e(a("./render/EventType.js")),r=d(a("./Object.js")),s=e(a("./ObjectEventType.js")),t=e(a("./TileQueue.js")),u=e(a("./View.js")),v=e(a("./ViewHint.js")),w=a("./asserts.js"),x=a("./dom.js"),y=a("./events.js"),z=a("./events/Event.js"),A=e(a("./events/EventType.js")),B=a("./extent.js"),C=a("./functions.js"),D=a("./has.js"),E=e(a("./layer/Group.js")),F=a("./size.js"),G=a("./structs/PriorityQueue.js"),H=a("./transform.js"),I=function(a){function b(b){var c=this;a.call(this);var d=f(b);this.maxTilesLoading_=void 0!==b.maxTilesLoading?b.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==b.loadTilesWhileAnimating?b.loadTilesWhileAnimating:!1,this.loadTilesWhileInteracting_=void 0!==b.loadTilesWhileInteracting?b.loadTilesWhileInteracting:!1,this.pixelRatio_=void 0!==b.pixelRatio?b.pixelRatio:D.DEVICE_PIXEL_RATIO,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=H.create(),this.pixelToCoordinateTransform_=H.create(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+(D.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var e=[A.default.CLICK,A.default.DBLCLICK,A.default.MOUSEDOWN,A.default.TOUCHSTART,A.default.MSPOINTERDOWN,m.default.POINTERDOWN,A.default.MOUSEWHEEL,A.default.WHEEL],g=0,h=e.length;h>g;++g)y.listen(c.overlayContainerStopEvent_,e[g],z.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new l.default(this,b.moveTolerance);for(var k in m.default)y.listen(c.mapBrowserEventHandler_,m.default[k],c.handleMapBrowserEvent,c);this.keyboardEventTarget_=d.keyboardEventTarget,this.keyHandlerKeys_=null,y.listen(this.viewport_,A.default.CONTEXTMENU,this.handleBrowserEvent,this),y.listen(this.viewport_,A.default.WHEEL,this.handleBrowserEvent,this),y.listen(this.viewport_,A.default.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=d.controls||new i.default,this.interactions=d.interactions||new i.default,this.overlays_=d.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new t.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},y.listen(this,r.getChangeEventType(p.default.LAYERGROUP),this.handleLayerGroupChanged_,this),y.listen(this,r.getChangeEventType(p.default.VIEW),this.handleViewChanged_,this),y.listen(this,r.getChangeEventType(p.default.SIZE),this.handleSizeChanged_,this),y.listen(this,r.getChangeEventType(p.default.TARGET),this.handleTargetChanged_,this),this.setProperties(d.values),this.controls.forEach(function(a){a.setMap(this)}.bind(this)),y.listen(this.controls,j.default.ADD,function(a){a.element.setMap(this)},this),y.listen(this.controls,j.default.REMOVE,function(a){a.element.setMap(null)},this),this.interactions.forEach(function(a){a.setMap(this)}.bind(this)),y.listen(this.interactions,j.default.ADD,function(a){a.element.setMap(this)},this),y.listen(this.interactions,j.default.REMOVE,function(a){a.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),y.listen(this.overlays_,j.default.ADD,function(a){this.addOverlayInternal_(a.element)},this),y.listen(this.overlays_,j.default.REMOVE,function(a){var b=a.element,c=b.getId();void 0!==c&&delete this.overlayIdIndex_[c.toString()],a.element.setMap(null)},this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},b.prototype.addControl=function(a){this.getControls().push(a)},b.prototype.addInteraction=function(a){this.getInteractions().push(a)},b.prototype.addLayer=function(a){var b=this.getLayerGroup().getLayers();b.push(a)},b.prototype.addOverlay=function(a){this.getOverlays().push(a)},b.prototype.addOverlayInternal_=function(a){var b=a.getId();void 0!==b&&(this.overlayIdIndex_[b.toString()]=a),a.setMap(this)},b.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),y.unlisten(this.viewport_,A.default.CONTEXTMENU,this.handleBrowserEvent,this),y.unlisten(this.viewport_,A.default.WHEEL,this.handleBrowserEvent,this),y.unlisten(this.viewport_,A.default.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(A.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),a.prototype.disposeInternal.call(this)},b.prototype.forEachFeatureAtPixel=function(a,b,c){if(this.frameState_){var d=this.getCoordinateFromPixel(a);c=void 0!==c?c:{};var e=void 0!==c.hitTolerance?c.hitTolerance*this.frameState_.pixelRatio:0,f=void 0!==c.layerFilter?c.layerFilter:C.TRUE;return this.renderer_.forEachFeatureAtCoordinate(d,this.frameState_,e,b,null,f,null)}},b.prototype.getFeaturesAtPixel=function(a,b){var c=null;return this.forEachFeatureAtPixel(a,function(a){c||(c=[]),c.push(a)},b),c},b.prototype.forEachLayerAtPixel=function(a,b,c){if(this.frameState_){var d=c||{},e=void 0!==d.hitTolerance?c.hitTolerance*this.frameState_.pixelRatio:0,f=d.layerFilter||C.TRUE;return this.renderer_.forEachLayerAtPixel(a,this.frameState_,e,b,null,f,null)}},b.prototype.hasFeatureAtPixel=function(a,b){if(!this.frameState_)return!1;var c=this.getCoordinateFromPixel(a);b=void 0!==b?b:{};var d=void 0!==b.layerFilter?b.layerFilter:C.TRUE,e=void 0!==b.hitTolerance?b.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(c,this.frameState_,e,d,null)},b.prototype.getEventCoordinate=function(a){return this.getCoordinateFromPixel(this.getEventPixel(a))},b.prototype.getEventPixel=function(a){var b=this.viewport_.getBoundingClientRect(),c=a.changedTouches?a.changedTouches[0]:a;return[c.clientX-b.left,c.clientY-b.top]},b.prototype.getTarget=function(){return this.get(p.default.TARGET)},b.prototype.getTargetElement=function(){var a=this.getTarget();return void 0!==a?"string"==typeof a?document.getElementById(a):a:null},b.prototype.getCoordinateFromPixel=function(a){var b=this.frameState_;return b?H.apply(b.pixelToCoordinateTransform,a.slice()):null},b.prototype.getControls=function(){return this.controls},b.prototype.getOverlays=function(){return this.overlays_},b.prototype.getOverlayById=function(a){var b=this.overlayIdIndex_[a.toString()];return void 0!==b?b:null},b.prototype.getInteractions=function(){return this.interactions},b.prototype.getLayerGroup=function(){return this.get(p.default.LAYERGROUP)},b.prototype.getLayers=function(){var a=this.getLayerGroup().getLayers();return a},b.prototype.getPixelFromCoordinate=function(a){var b=this.frameState_;return b?H.apply(b.coordinateToPixelTransform,a.slice(0,2)):null},b.prototype.getRenderer=function(){return this.renderer_},b.prototype.getSize=function(){return this.get(p.default.SIZE)},b.prototype.getView=function(){return this.get(p.default.VIEW)},b.prototype.getViewport=function(){return this.viewport_},b.prototype.getOverlayContainer=function(){return this.overlayContainer_},b.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},b.prototype.getTilePriority=function(a,b,c,d){var e=this.frameState_;if(!(e&&b in e.wantedTiles))return G.DROP;if(!e.wantedTiles[b][a.getKey()])return G.DROP;var f=c[0]-e.focus[0],g=c[1]-e.focus[1];return 65536*Math.log(d)+Math.sqrt(f*f+g*g)/d},b.prototype.handleBrowserEvent=function(a,b){var c=b||a.type,d=new k.default(c,this,a);this.handleMapBrowserEvent(d)},b.prototype.handleMapBrowserEvent=function(a){if(this.frameState_){this.focus_=a.coordinate,a.frameState=this.frameState_;var b=this.getInteractions().getArray();if(this.dispatchEvent(a)!==!1)for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.getActive()){var e=d.handleEvent(a);if(!e)break}}}},b.prototype.handlePostRender=function(){var a=this,b=this.frameState_,c=this.tileQueue_;if(!c.isEmpty()){var d=this.maxTilesLoading_,e=d;if(b){var f=b.viewHints;f[v.default.ANIMATING]&&(d=this.loadTilesWhileAnimating_?8:0,e=2),f[v.default.INTERACTING]&&(d=this.loadTilesWhileInteracting_?8:0,e=2)}c.getTilesLoading()<d&&(c.reprioritize(),c.loadMoreTiles(d,e))}!b||!this.hasListener(o.default.RENDERCOMPLETE)||b.animate||this.tileQueue_.getTilesLoading()||g(this.getLayers().getArray())||this.renderer_.dispatchRenderEvent(q.default.RENDERCOMPLETE,b);for(var h=this.postRenderFunctions_,i=0,j=h.length;j>i;++i)h[i](a,b);h.length=0},b.prototype.handleSizeChanged_=function(){this.render()},b.prototype.handleTargetChanged_=function(){var a,b=this;if(this.getTarget()&&(a=this.getTargetElement()),this.keyHandlerKeys_){for(var c=0,d=this.keyHandlerKeys_.length;d>c;++c)y.unlistenByKey(b.keyHandlerKeys_[c]);this.keyHandlerKeys_=null}if(a){a.appendChild(this.viewport_);var e=this.keyboardEventTarget_?this.keyboardEventTarget_:a;this.keyHandlerKeys_=[y.listen(e,A.default.KEYDOWN,this.handleBrowserEvent,this),y.listen(e,A.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(A.default.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),x.removeNode(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(A.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},b.prototype.handleTileChange_=function(){this.render()},b.prototype.handleViewPropertyChanged_=function(){this.render()},b.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(y.unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(y.unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var a=this.getView();a&&(this.viewport_.setAttribute("data-view",h.getUid(a)),this.viewPropertyListenerKey_=y.listen(a,s.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=y.listen(a,A.default.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},b.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(y.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var a=this.getLayerGroup();a&&(this.layerGroupPropertyListenerKeys_=[y.listen(a,s.default.PROPERTYCHANGE,this.render,this),y.listen(a,A.default.CHANGE,this.render,this)]),this.render()},b.prototype.isRendered=function(){return!!this.frameState_},b.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},b.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},b.prototype.removeControl=function(a){return this.getControls().remove(a)},b.prototype.removeInteraction=function(a){return this.getInteractions().remove(a)},b.prototype.removeLayer=function(a){var b=this.getLayerGroup().getLayers();return b.remove(a)},b.prototype.removeOverlay=function(a){return this.getOverlays().remove(a)},b.prototype.renderFrame_=function(a){var b,c=this.getSize(),d=this.getView(),e=B.createEmpty(),f=this.frameState_,g=null;if(void 0!==c&&F.hasArea(c)&&d&&d.isDef()){for(var i=d.getHints(this.frameState_?this.frameState_.viewHints:void 0),j=this.getLayerGroup().getLayerStatesArray(),k={},l=0,m=j.length;m>l;++l)k[h.getUid(j[l].layer)]=j[l];b=d.getState(this.pixelRatio_),g={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:e,focus:this.focus_?this.focus_:b.center,index:this.frameIndex_++,layerStates:k,layerStatesArray:j,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:c,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:a,usedTiles:{},viewState:b,viewHints:i,wantedTiles:{}}}if(g&&(g.extent=B.getForViewAndSize(b.center,b.resolution,b.rotation,g.size,e)),this.frameState_=g,this.renderer_.renderFrame(g),g){if(g.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,g.postRenderFunctions),f){var p=!this.previousExtent_||!B.isEmpty(this.previousExtent_)&&!B.equals(g.extent,this.previousExtent_);p&&(this.dispatchEvent(new n.default(o.default.MOVESTART,this,f)),this.previousExtent_=B.createOrUpdateEmpty(this.previousExtent_))}var q=this.previousExtent_&&!g.viewHints[v.default.ANIMATING]&&!g.viewHints[v.default.INTERACTING]&&!B.equals(g.extent,this.previousExtent_);q&&(this.dispatchEvent(new n.default(o.default.MOVEEND,this,g)),B.clone(g.extent,this.previousExtent_))}this.dispatchEvent(new n.default(o.default.POSTRENDER,this,g)),setTimeout(this.handlePostRender.bind(this),0)},b.prototype.setLayerGroup=function(a){this.set(p.default.LAYERGROUP,a)},b.prototype.setSize=function(a){this.set(p.default.SIZE,a)},b.prototype.setTarget=function(a){this.set(p.default.TARGET,a)},b.prototype.setView=function(a){this.set(p.default.VIEW,a)},b.prototype.skipFeature=function(a){var b=h.getUid(a).toString();this.skippedFeatureUids_[b]=!0,this.render()},b.prototype.updateSize=function(){var a=this.getTargetElement();if(a){var b=getComputedStyle(a);this.setSize([a.offsetWidth-parseFloat(b.borderLeftWidth)-parseFloat(b.paddingLeft)-parseFloat(b.paddingRight)-parseFloat(b.borderRightWidth),a.offsetHeight-parseFloat(b.borderTopWidth)-parseFloat(b.paddingTop)-parseFloat(b.paddingBottom)-parseFloat(b.borderBottomWidth)])}else this.setSize(void 0)},b.prototype.unskipFeature=function(a){var b=h.getUid(a).toString();delete this.skippedFeatureUids_[b],this.render()},b}(r.default),J=I;c.default=J},{"./Collection.js":6,"./CollectionEventType.js":7,"./MapBrowserEvent.js":21,"./MapBrowserEventHandler.js":22,"./MapBrowserEventType.js":23,"./MapEvent.js":25,"./MapEventType.js":26,"./MapProperty.js":27,"./Object.js":28,"./ObjectEventType.js":29,"./TileQueue.js":36,"./View.js":41,"./ViewHint.js":42,"./asserts.js":46,"./dom.js":63,"./events.js":65,"./events/Event.js":66,"./events/EventType.js":67,"./extent.js":71,"./functions.js":76,"./has.js":109,"./layer/Group.js":135,"./render/EventType.js":168,"./size.js":226,"./structs/PriorityQueue.js":263,"./transform.js":287,"./util.js":289}],34:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./TileState.js")),f=a("./easing.js"),g=d(a("./events/Target.js")),h=d(a("./events/EventType.js")),i=function(a){function b(b,c,d){a.call(this);var e=d?d:{};this.tileCoord=b,this.state=c,this.interimTile=null,this.key="",this.transition_=void 0===e.transition?250:e.transition,this.transitionStarts_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.changed=function(){this.dispatchEvent(h.default.CHANGE)},b.prototype.getKey=function(){return this.key+"/"+this.tileCoord},b.prototype.getInterimTile=function(){if(!this.interimTile)return this;var a=this.interimTile;do{if(a.getState()==e.default.LOADED)return a;a=a.interimTile}while(a);return this},b.prototype.refreshInterimChain=function(){if(this.interimTile){var a=this.interimTile,b=this;do{if(a.getState()==e.default.LOADED){a.interimTile=null;break}a.getState()==e.default.LOADING?b=a:a.getState()==e.default.IDLE?b.interimTile=a.interimTile:b=a,a=b.interimTile}while(a)}},b.prototype.getTileCoord=function(){return this.tileCoord},b.prototype.getState=function(){return this.state},b.prototype.setState=function(a){this.state=a,this.changed()},b.prototype.load=function(){},b.prototype.getAlpha=function(a,b){if(!this.transition_)return 1;var c=this.transitionStarts_[a];if(c){if(-1===c)return 1}else c=b,this.transitionStarts_[a]=c;var d=b-c+1e3/60;return d>=this.transition_?1:f.easeIn(d/this.transition_)},b.prototype.inTransition=function(a){return this.transition_?-1!==this.transitionStarts_[a]:!1},b.prototype.endTransition=function(a){this.transition_&&(this.transitionStarts_[a]=-1)},b}(g.default),j=i;c.default=j},{"./TileState.js":38,"./easing.js":64,"./events/EventType.js":67,"./events/Target.js":69}],35:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./structs/LRUCache.js")),f=a("./tilecoord.js"),g=function(a){function b(b){a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.expireCache=function(a){for(var b=this;this.canExpireCache();){var c=b.peekLast(),d=c.tileCoord[0].toString();if(d in a&&a[d].contains(c.tileCoord))break;b.pop().dispose()}},b.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var a=this.peekFirstKey(),b=f.fromKey(a),c=b[0];this.forEach(function(a){a.tileCoord[0]!==c&&(this.remove(f.getKey(a.tileCoord)),a.dispose())},this)}},b}(e.default),h=g;c.default=h},{"./structs/LRUCache.js":261,"./tilecoord.js":281}],36:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./TileState.js")),f=a("./events.js"),g=d(a("./events/EventType.js")),h=d(a("./structs/PriorityQueue.js")),i=function(a){function b(b,c){a.call(this,function(a){return b.apply(null,a)},function(a){return a[0].getKey()}),this.tileChangeCallback_=c,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.enqueue=function(b){var c=a.prototype.enqueue.call(this,b);if(c){var d=b[0];f.listen(d,g.default.CHANGE,this.handleTileChange,this)}return c},b.prototype.getTilesLoading=function(){return this.tilesLoading_},b.prototype.handleTileChange=function(a){var b=a.target,c=b.getState();if(c===e.default.LOADED||c===e.default.ERROR||c===e.default.EMPTY||c===e.default.ABORT){f.unlisten(b,g.default.CHANGE,this.handleTileChange,this);var d=b.getKey();d in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[d],--this.tilesLoading_),this.tileChangeCallback_()}},b.prototype.loadMoreTiles=function(a,b){for(var c,d,f,g=this,h=0,i=!1;this.tilesLoading_<a&&b>h&&this.getCount()>0;)d=g.dequeue()[0],f=d.getKey(),c=d.getState(),c===e.default.ABORT?i=!0:c!==e.default.IDLE||f in g.tilesLoadingKeys_||(g.tilesLoadingKeys_[f]=!0,++g.tilesLoading_,++h,d.load());0===h&&i&&this.tileChangeCallback_()},b}(h.default),j=i;c.default=j},{"./TileState.js":38,"./events.js":65,"./events/EventType.js":67,"./structs/PriorityQueue.js":263}],37:[function(a,b,c){"use strict";function d(a,b,c,d,f){return void 0!==f?(f.minX=a,f.maxX=b,f.minY=c,f.maxY=d,f):new e(a,b,c,d)}Object.defineProperty(c,"__esModule",{value:!0}),c.createOrUpdate=d,c.default=void 0;var e=function(a,b,c,d){this.minX=a,this.maxX=b,this.minY=c,this.maxY=d};e.prototype.contains=function(a){return this.containsXY(a[1],a[2])},e.prototype.containsTileRange=function(a){return this.minX<=a.minX&&a.maxX<=this.maxX&&this.minY<=a.minY&&a.maxY<=this.maxY},e.prototype.containsXY=function(a,b){return this.minX<=a&&a<=this.maxX&&this.minY<=b&&b<=this.maxY},e.prototype.equals=function(a){return this.minX==a.minX&&this.minY==a.minY&&this.maxX==a.maxX&&this.maxY==a.maxY},e.prototype.extend=function(a){a.minX<this.minX&&(this.minX=a.minX),a.maxX>this.maxX&&(this.maxX=a.maxX),a.minY<this.minY&&(this.minY=a.minY),a.maxY>this.maxY&&(this.maxY=a.maxY)},e.prototype.getHeight=function(){return this.maxY-this.minY+1},e.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},e.prototype.getWidth=function(){return this.maxX-this.minX+1},e.prototype.intersects=function(a){return this.minX<=a.maxX&&this.maxX>=a.minX&&this.minY<=a.maxY&&this.maxY>=a.minY};var f=e;c.default=f},{}],38:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};c.default=d},{}],39:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=m.loadFeaturesXhr(b,a.getFormat(),a.onLoad.bind(a),a.onError.bind(a));a.setLoader(c)}Object.defineProperty(c,"__esModule",{value:!0}),c.defaultLoadFunction=e,c.default=void 0;var f=a("./util.js"),g=d(a("./Tile.js")),h=d(a("./TileState.js")),i=a("./dom.js"),j=a("./events.js"),k=a("./extent.js"),l=d(a("./events/EventType.js")),m=a("./featureloader.js"),n=a("./functions.js"),o=function(a){function b(c,d,e,f,g,i,m,o,p,q,r,s,t,u,v){var w=this;if(a.call(this,c,d,{transition:0}),this.context_={},this.loader_,this.replayState_={},this.sourceTiles_=q,this.tileKeys=[],this.extent=null,this.sourceRevision_=e,this.wrappedTileCoord=i,this.loadListenerKeys_=[],this.sourceTileListenerKeys_=[],i){var x=this.extent=p.getTileCoordExtent(i),y=p.getResolution(v),z=o.getZForResolution(y),A=v!=c[0],B=0;if(o.forEachTileCoord(x,z,function(a){var b=k.getIntersection(x,o.getTileCoordExtent(a)),c=o.getExtent();if(c&&(b=k.getIntersection(b,c,b)),k.getWidth(b)/y>=.5&&k.getHeight(b)/y>=.5){++B;var d=a.toString(),e=q[d];if(!e&&!A){var i=m(a,r,s);e=q[d]=new t(a,void 0==i?h.default.EMPTY:h.default.IDLE,void 0==i?"":i,f,g),this.sourceTileListenerKeys_.push(j.listen(e,l.default.CHANGE,u))}!e||A&&e.getState()!=h.default.LOADED||(e.consumers++,this.tileKeys.push(d))}}.bind(this)),A&&B==this.tileKeys.length&&this.finishLoading_(),v<=c[0]&&this.state!=h.default.LOADED)for(;v>p.getMinZoom();){var C=new b(c,d,e,f,g,i,m,o,p,q,r,s,t,n.VOID,--v);if(C.state==h.default.LOADED){w.interimTile=C;break}}}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){var b=this;this.state=h.default.ABORT,this.changed(),this.interimTile&&this.interimTile.dispose();for(var c=0,d=this.tileKeys.length;d>c;++c){var e=b.tileKeys[c],f=b.getTile(e);f.consumers--,0==f.consumers&&(delete b.sourceTiles_[e],f.dispose())}this.tileKeys.length=0,this.sourceTiles_=null,this.loadListenerKeys_.forEach(j.unlistenByKey),this.loadListenerKeys_.length=0,this.sourceTileListenerKeys_.forEach(j.unlistenByKey),this.sourceTileListenerKeys_.length=0,a.prototype.disposeInternal.call(this)},b.prototype.getContext=function(a){var b=f.getUid(a).toString();return b in this.context_||(this.context_[b]=i.createCanvasContext2D()),this.context_[b]},b.prototype.getImage=function(a){return-1==this.getReplayState(a).renderedTileRevision?null:this.getContext(a).canvas},b.prototype.getReplayState=function(a){var b=f.getUid(a).toString();return b in this.replayState_||(this.replayState_[b]={dirty:!1,renderedRenderOrder:null,renderedRevision:-1,renderedTileRevision:-1}),this.replayState_[b]},b.prototype.getKey=function(){return this.tileKeys.join("/")+"-"+this.sourceRevision_},b.prototype.getTile=function(a){return this.sourceTiles_[a]},b.prototype.load=function(){var a=0,b={};this.state==h.default.IDLE&&this.setState(h.default.LOADING),this.state==h.default.LOADING&&this.tileKeys.forEach(function(c){var d=this.getTile(c);if(d.state==h.default.IDLE&&(d.setLoader(this.loader_),d.load()),d.state==h.default.LOADING){var e=j.listen(d,l.default.CHANGE,function(){var c=d.getState();if(c==h.default.LOADED||c==h.default.ERROR){var e=f.getUid(d);c==h.default.ERROR?b[e]=!0:(--a,delete b[e]),a-Object.keys(b).length==0&&this.finishLoading_()}}.bind(this));this.loadListenerKeys_.push(e),++a
}}.bind(this)),a-Object.keys(b).length==0&&setTimeout(this.finishLoading_.bind(this),0)},b.prototype.finishLoading_=function(){for(var a=this,b=this.tileKeys.length,c=0,d=b-1;d>=0;--d){var e=a.getTile(a.tileKeys[d]).getState();e!=h.default.LOADED&&--b,e==h.default.EMPTY&&++c}b==this.tileKeys.length?(this.loadListenerKeys_.forEach(j.unlistenByKey),this.loadListenerKeys_.length=0,this.setState(h.default.LOADED)):this.setState(c==this.tileKeys.length?h.default.EMPTY:h.default.ERROR)},b}(g.default),p=o;c.default=p},{"./Tile.js":34,"./TileState.js":38,"./dom.js":63,"./events.js":65,"./events/EventType.js":67,"./extent.js":71,"./featureloader.js":74,"./functions.js":76,"./util.js":289}],40:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./util.js"),f=d(a("./Tile.js")),g=d(a("./TileState.js")),h=[0,0,4096,4096],i=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,g),this.consumers=0,this.extent_=null,this.format_=e,this.features_=null,this.loader_,this.projection_=null,this.replayGroups_={},this.tileLoadFunction_=f,this.url_=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.features_=null,this.replayGroups_={},this.state=g.default.ABORT,this.changed(),a.prototype.disposeInternal.call(this)},b.prototype.getExtent=function(){return this.extent_||h},b.prototype.getFormat=function(){return this.format_},b.prototype.getFeatures=function(){return this.features_},b.prototype.getKey=function(){return this.url_},b.prototype.getProjection=function(){return this.projection_},b.prototype.getReplayGroup=function(a,b){return this.replayGroups_[e.getUid(a)+","+b]},b.prototype.load=function(){this.state==g.default.IDLE&&(this.setState(g.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(null,0/0,null))},b.prototype.onLoad=function(a,b,c){this.setProjection(b),this.setFeatures(a),this.setExtent(c)},b.prototype.onError=function(){this.setState(g.default.ERROR)},b.prototype.setExtent=function(a){this.extent_=a},b.prototype.setFeatures=function(a){this.features_=a,this.setState(g.default.LOADED)},b.prototype.setProjection=function(a){this.projection_=a},b.prototype.setReplayGroup=function(a,b,c){this.replayGroups_[e.getUid(a)+","+b]=c},b.prototype.setLoader=function(a){this.loader_=a},b}(f.default),j=i;c.default=j},{"./Tile.js":34,"./TileState.js":38,"./util.js":289}],41:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){setTimeout(function(){a(b)},0)}function f(a){return void 0!==a.extent?m.createExtent(a.extent):m.none}function g(a){var b,c,d,e=28,f=2,g=void 0!==a.minZoom?a.minZoom:E,h=void 0!==a.maxZoom?a.maxZoom:e,i=void 0!==a.zoomFactor?a.zoomFactor:f;if(void 0!==a.resolutions){var k=a.resolutions;c=k[g],d=void 0!==k[h]?k[h]:k[k.length-1],b=o.createSnapToResolutions(k)}else{var l=C.createProjection(a.projection,"EPSG:3857"),m=l.getExtent(),n=m?Math.max(w.getWidth(m),w.getHeight(m)):360*C.METERS_PER_UNIT[D.default.DEGREES]/l.getMetersPerUnit(),p=n/j.DEFAULT_TILE_SIZE/Math.pow(f,E),q=p/Math.pow(f,e-E);c=a.maxResolution,void 0!==c?g=0:c=p/Math.pow(i,g),d=a.minResolution,void 0===d&&(d=void 0!==a.maxZoom?void 0!==a.maxResolution?c/Math.pow(i,h):p/Math.pow(i,h):q),h=g+Math.floor(Math.log(c/d)/Math.log(i)),d=c/Math.pow(i,h-g),b=o.createSnapToPower(i,c,h-g)}return{constraint:b,maxResolution:c,minResolution:d,minZoom:g,zoomFactor:i}}function h(a){var b=void 0!==a.enableRotation?a.enableRotation:!0;if(b){var c=a.constrainRotation;return void 0===c||c===!0?p.createSnapToZero():c===!1?p.none:"number"==typeof c?p.createSnapToN(c):p.none}return p.disable}function i(a){return a.sourceCenter&&a.targetCenter&&!u.equals(a.sourceCenter,a.targetCenter)?!1:a.sourceResolution!==a.targetResolution?!1:a.sourceRotation!==a.targetRotation?!1:!0}Object.defineProperty(c,"__esModule",{value:!0}),c.createCenterConstraint=f,c.createResolutionConstraint=g,c.createRotationConstraint=h,c.isNoopAnimation=i,c.default=void 0;var j=a("./tilegrid/common.js"),k=a("./util.js"),l=a("./functions.js"),m=a("./centerconstraint.js"),n=d(a("./Object.js")),o=a("./resolutionconstraint.js"),p=a("./rotationconstraint.js"),q=d(a("./ViewHint.js")),r=d(a("./ViewProperty.js")),s=a("./array.js"),t=a("./asserts.js"),u=a("./coordinate.js"),v=a("./easing.js"),w=a("./extent.js"),x=d(a("./geom/GeometryType.js")),y=a("./geom/Polygon.js"),z=d(a("./geom/SimpleGeometry.js")),A=a("./math.js"),B=a("./obj.js"),C=a("./proj.js"),D=d(a("./proj/Units.js")),E=0,F=function(a){function b(b){a.call(this);var c=B.assign({},b);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=C.createProjection(c.projection,"EPSG:3857"),this.applyOptions_(c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.applyOptions_=function(a){var b={};b[r.default.CENTER]=void 0!==a.center?a.center:null;var c=g(a);this.maxResolution_=c.maxResolution,this.minResolution_=c.minResolution,this.zoomFactor_=c.zoomFactor,this.resolutions_=a.resolutions,this.minZoom_=c.minZoom;var d=f(a),e=c.constraint,i=h(a);this.constraints_={center:d,resolution:e,rotation:i},void 0!==a.resolution?b[r.default.RESOLUTION]=a.resolution:void 0!==a.zoom&&(b[r.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,a.zoom-this.minZoom_),this.resolutions_&&(b[r.default.RESOLUTION]=A.clamp(Number(this.getResolution()||b[r.default.RESOLUTION]),this.minResolution_,this.maxResolution_))),b[r.default.ROTATION]=void 0!==a.rotation?a.rotation:0,this.setProperties(b),this.options_=a},b.prototype.getUpdatedOptions_=function(a){var b=B.assign({},this.options_);return void 0!==b.resolution?b.resolution=this.getResolution():b.zoom=this.getZoom(),b.center=this.getCenter(),b.rotation=this.getRotation(),B.assign({},b,a)},b.prototype.animate=function(){var a,b=arguments,c=this,d=arguments.length;if(d>1&&"function"==typeof arguments[d-1]&&(a=arguments[d-1],--d),!this.isDef()){var f=arguments[d-1];return f.center&&this.setCenter(f.center),void 0!==f.zoom&&this.setZoom(f.zoom),void 0!==f.rotation&&this.setRotation(f.rotation),void(a&&e(a,!0))}for(var g=Date.now(),h=this.getCenter().slice(),j=this.getResolution(),k=this.getRotation(),l=[],m=0;d>m;++m){var n=b[m],o={start:g,complete:!1,anchor:n.anchor,duration:void 0!==n.duration?n.duration:1e3,easing:n.easing||v.inAndOut};if(n.center&&(o.sourceCenter=h,o.targetCenter=n.center,h=o.targetCenter),void 0!==n.zoom?(o.sourceResolution=j,o.targetResolution=c.constrainResolution(c.maxResolution_,n.zoom-c.minZoom_,0),j=o.targetResolution):n.resolution&&(o.sourceResolution=j,o.targetResolution=n.resolution,j=o.targetResolution),void 0!==n.rotation){o.sourceRotation=k;var p=A.modulo(n.rotation-k+Math.PI,2*Math.PI)-Math.PI;o.targetRotation=k+p,k=o.targetRotation}o.callback=a,i(o)?o.complete=!0:g+=o.duration,l.push(o)}this.animations_.push(l),this.setHint(q.default.ANIMATING,1),this.updateAnimations_()},b.prototype.getAnimating=function(){return this.hints_[q.default.ANIMATING]>0},b.prototype.getInteracting=function(){return this.hints_[q.default.INTERACTING]>0},b.prototype.cancelAnimations=function(){var a=this;this.setHint(q.default.ANIMATING,-this.hints_[q.default.ANIMATING]);for(var b=0,c=this.animations_.length;c>b;++b){var d=a.animations_[b];d[0].callback&&e(d[0].callback,!1)}this.animations_.length=0},b.prototype.updateAnimations_=function(){var a=this;if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var b=Date.now(),c=!1,d=this.animations_.length-1;d>=0;--d){for(var f=a.animations_[d],g=!0,h=0,i=f.length;i>h;++h){var j=f[h];if(!j.complete){var k=b-j.start,l=j.duration>0?k/j.duration:1;l>=1?(j.complete=!0,l=1):g=!1;var m=j.easing(l);if(j.sourceCenter){var n=j.sourceCenter[0],o=j.sourceCenter[1],p=j.targetCenter[0],s=j.targetCenter[1],t=n+m*(p-n),u=o+m*(s-o);a.set(r.default.CENTER,[t,u])}if(j.sourceResolution&&j.targetResolution){var v=1===m?j.targetResolution:j.sourceResolution+m*(j.targetResolution-j.sourceResolution);j.anchor&&a.set(r.default.CENTER,a.calculateCenterZoom(v,j.anchor)),a.set(r.default.RESOLUTION,v)}if(void 0!==j.sourceRotation&&void 0!==j.targetRotation){var w=1===m?A.modulo(j.targetRotation+Math.PI,2*Math.PI)-Math.PI:j.sourceRotation+m*(j.targetRotation-j.sourceRotation);j.anchor&&a.set(r.default.CENTER,a.calculateCenterRotate(w,j.anchor)),a.set(r.default.ROTATION,w)}if(c=!0,!j.complete)break}}if(g){a.animations_[d]=null,a.setHint(q.default.ANIMATING,-1);var x=f[0].callback;x&&e(x,!0)}}this.animations_=this.animations_.filter(Boolean),c&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},b.prototype.calculateCenterRotate=function(a,b){var c,d=this.getCenter();return void 0!==d&&(c=[d[0]-b[0],d[1]-b[1]],u.rotate(c,a-this.getRotation()),u.add(c,b)),c},b.prototype.calculateCenterZoom=function(a,b){var c,d=this.getCenter(),e=this.getResolution();if(void 0!==d&&void 0!==e){var f=b[0]-a*(b[0]-d[0])/e,g=b[1]-a*(b[1]-d[1])/e;c=[f,g]}return c},b.prototype.getSizeFromViewport_=function(){var a=[100,100],b='.ol-viewport[data-view="'+k.getUid(this)+'"]',c=document.querySelector(b);if(c){var d=getComputedStyle(c);a[0]=parseInt(d.width,10),a[1]=parseInt(d.height,10)}return a},b.prototype.constrainCenter=function(a){return this.constraints_.center(a)},b.prototype.constrainResolution=function(a,b,c){var d=b||0,e=c||0;return this.constraints_.resolution(a,d,e)},b.prototype.constrainRotation=function(a,b){var c=b||0;return this.constraints_.rotation(a,c)},b.prototype.getCenter=function(){return this.get(r.default.CENTER)},b.prototype.getConstraints=function(){return this.constraints_},b.prototype.getHints=function(a){return void 0!==a?(a[0]=this.hints_[0],a[1]=this.hints_[1],a):this.hints_.slice()},b.prototype.calculateExtent=function(a){var b=a||this.getSizeFromViewport_(),c=this.getCenter();t.assert(c,1);var d=this.getResolution();t.assert(void 0!==d,2);var e=this.getRotation();return t.assert(void 0!==e,3),w.getForViewAndSize(c,d,e,b)},b.prototype.getMaxResolution=function(){return this.maxResolution_},b.prototype.getMinResolution=function(){return this.minResolution_},b.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},b.prototype.setMaxZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({maxZoom:a}))},b.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},b.prototype.setMinZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({minZoom:a}))},b.prototype.getProjection=function(){return this.projection_},b.prototype.getResolution=function(){return this.get(r.default.RESOLUTION)},b.prototype.getResolutions=function(){return this.resolutions_},b.prototype.getResolutionForExtent=function(a,b){var c=b||this.getSizeFromViewport_(),d=w.getWidth(a)/c[0],e=w.getHeight(a)/c[1];return Math.max(d,e)},b.prototype.getResolutionForValueFunction=function(a){var b=a||2,c=this.maxResolution_,d=this.minResolution_,e=Math.log(c/d)/Math.log(b);return function(a){var d=c/Math.pow(b,a*e);return d}},b.prototype.getRotation=function(){return this.get(r.default.ROTATION)},b.prototype.getValueForResolutionFunction=function(a){var b=a||2,c=this.maxResolution_,d=this.minResolution_,e=Math.log(c/d)/Math.log(b);return function(a){var d=Math.log(c/a)/Math.log(b)/e;return d}},b.prototype.getState=function(a){var b=this.getCenter(),c=this.getProjection(),d=this.getResolution(),e=d/a,f=this.getRotation();return{center:[Math.round(b[0]/e)*e,Math.round(b[1]/e)*e],projection:void 0!==c?c:null,resolution:d,rotation:f,zoom:this.getZoom()}},b.prototype.getZoom=function(){var a,b=this.getResolution();return void 0!==b&&(a=this.getZoomForResolution(b)),a},b.prototype.getZoomForResolution=function(a){var b,c,d=this.minZoom_||0;if(this.resolutions_){var e=s.linearFindNearest(this.resolutions_,a,1);d=e,b=this.resolutions_[e],c=e==this.resolutions_.length-1?2:b/this.resolutions_[e+1]}else b=this.maxResolution_,c=this.zoomFactor_;return d+Math.log(b/a)/Math.log(c)},b.prototype.getResolutionForZoom=function(a){return this.constrainResolution(this.maxResolution_,a-this.minZoom_,0)},b.prototype.fit=function(a,b){var c=b||{},d=c.size;d||(d=this.getSizeFromViewport_());var f;a instanceof z.default?a.getType()===x.default.CIRCLE?(a=a.getExtent(),f=y.fromExtent(a),f.rotate(this.getRotation(),w.getCenter(a))):f=a:(t.assert(Array.isArray(a),24),t.assert(!w.isEmpty(a),25),f=y.fromExtent(a));var g,h=void 0!==c.padding?c.padding:[0,0,0,0],i=void 0!==c.constrainResolution?c.constrainResolution:!0,j=void 0!==c.nearest?c.nearest:!1;g=void 0!==c.minResolution?c.minResolution:void 0!==c.maxZoom?this.constrainResolution(this.maxResolution_,c.maxZoom-this.minZoom_,0):0;for(var k=f.getFlatCoordinates(),m=this.getRotation(),n=Math.cos(-m),o=Math.sin(-m),p=+1/0,q=+1/0,r=-1/0,s=-1/0,u=f.getStride(),v=0,A=k.length;A>v;v+=u){var B=k[v]*n-k[v+1]*o,C=k[v]*o+k[v+1]*n;p=Math.min(p,B),q=Math.min(q,C),r=Math.max(r,B),s=Math.max(s,C)}var D=this.getResolutionForExtent([p,q,r,s],[d[0]-h[1]-h[3],d[1]-h[0]-h[2]]);if(D=isNaN(D)?g:Math.max(D,g),i){var E=this.constrainResolution(D,0,0);!j&&D>E&&(E=this.constrainResolution(E,-1,0)),D=E}o=-o;var F=(p+r)/2,G=(q+s)/2;F+=(h[1]-h[3])/2*D,G+=(h[0]-h[2])/2*D;var H=F*n-G*o,I=G*n+F*o,J=[H,I],K=c.callback?c.callback:l.VOID;void 0!==c.duration?this.animate({resolution:D,center:J,duration:c.duration,easing:c.easing},K):(this.setResolution(D),this.setCenter(J),e(K,!0))},b.prototype.centerOn=function(a,b,c){var d=this.getRotation(),e=Math.cos(-d),f=Math.sin(-d),g=a[0]*e-a[1]*f,h=a[1]*e+a[0]*f,i=this.getResolution();g+=(b[0]/2-c[0])*i,h+=(c[1]-b[1]/2)*i,f=-f;var j=g*e-h*f,k=h*e+g*f;this.setCenter([j,k])},b.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},b.prototype.rotate=function(a,b){if(void 0!==b){var c=this.calculateCenterRotate(a,b);this.setCenter(c)}this.setRotation(a)},b.prototype.setCenter=function(a){this.set(r.default.CENTER,a),this.getAnimating()&&this.cancelAnimations()},b.prototype.setHint=function(a,b){return this.hints_[a]+=b,this.changed(),this.hints_[a]},b.prototype.setResolution=function(a){this.set(r.default.RESOLUTION,a),this.getAnimating()&&this.cancelAnimations()},b.prototype.setRotation=function(a){this.set(r.default.ROTATION,a),this.getAnimating()&&this.cancelAnimations()},b.prototype.setZoom=function(a){this.setResolution(this.getResolutionForZoom(a))},b}(n.default),G=F;c.default=G},{"./Object.js":28,"./ViewHint.js":42,"./ViewProperty.js":43,"./array.js":45,"./asserts.js":46,"./centerconstraint.js":47,"./coordinate.js":61,"./easing.js":64,"./extent.js":71,"./functions.js":76,"./geom/GeometryType.js":81,"./geom/Polygon.js":88,"./geom/SimpleGeometry.js":89,"./math.js":147,"./obj.js":149,"./proj.js":158,"./proj/Units.js":160,"./resolutionconstraint.js":224,"./rotationconstraint.js":225,"./tilegrid/common.js":285,"./util.js":289}],42:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ANIMATING:0,INTERACTING:1};c.default=d},{}],43:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};c.default=d},{}],44:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./PluggableMap.js")),f=a("./control.js"),g=a("./interaction.js"),h=a("./obj.js"),i=d(a("./renderer/webgl/ImageLayer.js")),j=d(a("./renderer/webgl/Map.js")),k=d(a("./renderer/webgl/TileLayer.js")),l=d(a("./renderer/webgl/VectorLayer.js")),m=function(a){function b(b){b=h.assign({},b),b.controls||(b.controls=f.defaults()),b.interactions||(b.interactions=g.defaults()),a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createRenderer=function(){var a=new j.default(this);return a.registerLayerRenderers([i.default,k.default,l.default]),a},b}(e.default),n=m;c.default=n},{"./PluggableMap.js":33,"./control.js":50,"./interaction.js":111,"./obj.js":149,"./renderer/webgl/ImageLayer.js":210,"./renderer/webgl/Map.js":212,"./renderer/webgl/TileLayer.js":213,"./renderer/webgl/VectorLayer.js":214}],45:[function(a,b,c){"use strict";function d(a,b,c){for(var d,f,g=c||e,h=0,i=a.length,j=!1;i>h;)d=h+(i-h>>1),f=+g(a[d],b),0>f?h=d+1:(i=d,j=!f);return j?h:~h}function e(a,b){return a>b?1:b>a?-1:0}function f(a,b){return a.indexOf(b)>=0}function g(a,b,c){var d=a.length;if(a[0]<=b)return 0;if(b<=a[d-1])return d-1;var e;if(c>0){for(e=1;d>e;++e)if(a[e]<b)return e-1}else if(0>c){for(e=1;d>e;++e)if(a[e]<=b)return e}else for(e=1;d>e;++e){if(a[e]==b)return e;if(a[e]<b)return a[e-1]-b<b-a[e]?e-1:e}return d-1}function h(a,b,c){for(;c>b;){var d=a[b];a[b]=a[c],a[c]=d,++b,--c}}function i(a,b){for(var c=Array.isArray(b)?b:[b],d=c.length,e=0;d>e;e++)a[a.length]=c[e]}function j(a,b){var c=a.indexOf(b),d=c>-1;return d&&a.splice(c,1),d}function k(a,b){for(var c,d=a.length>>>0,e=0;d>e;e++)if(c=a[e],b(c,e,a))return c;return null}function l(a,b){var c=a.length;if(c!==b.length)return!1;for(var d=0;c>d;d++)if(a[d]!==b[d])return!1;return!0}function m(a,b){var c,d=a.length,e=Array(a.length);for(c=0;d>c;c++)e[c]={index:c,value:a[c]};for(e.sort(function(a,c){return b(a.value,c.value)||a.index-c.index}),c=0;c<a.length;c++)a[c]=e[c].value}function n(a,b){var c,d=!a.every(function(d,e){return c=e,!b(d,e,a)});return d?c:-1}function o(a,b,c){var d=b||e;return a.every(function(b,e){if(0===e)return!0;var f=d(a[e-1],b);return!(f>0||c&&0===f)})}Object.defineProperty(c,"__esModule",{value:!0}),c.binarySearch=d,c.numberSafeCompareFunction=e,c.includes=f,c.linearFindNearest=g,c.reverseSubArray=h,c.extend=i,c.remove=j,c.find=k,c.equals=l,c.stableSort=m,c.findIndex=n,c.isSorted=o},{}],46:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!a)throw new f.default(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.assert=e;var f=d(a("./AssertionError.js"))},{"./AssertionError.js":5}],47:[function(a,b,c){"use strict";function d(a){return function(b){return b?[f.clamp(b[0],a[0],a[2]),f.clamp(b[1],a[1],a[3])]:void 0}}function e(a){return a}Object.defineProperty(c,"__esModule",{value:!0}),c.createExtent=d,c.none=e;var f=a("./math.js")},{"./math.js":147}],48:[function(a,b,c){"use strict";function d(a){return"string"==typeof a?a:i(a)}function e(a){var b=document.createElement("div");if(b.style.color=a,""!==b.style.color){document.body.appendChild(b);var c=getComputedStyle(b).color;return document.body.removeChild(b),c}return""}function f(a){return Array.isArray(a)?a:n(a)}function g(a){var b,c,d,f,g;if(m.exec(a)&&(a=e(a)),l.exec(a)){var i,k=a.length-1;i=4>=k?1:2;var n=4===k||8===k;b=parseInt(a.substr(1+0*i,i),16),c=parseInt(a.substr(1+1*i,i),16),d=parseInt(a.substr(1+2*i,i),16),f=n?parseInt(a.substr(1+3*i,i),16):255,1==i&&(b=(b<<4)+b,c=(c<<4)+c,d=(d<<4)+d,n&&(f=(f<<4)+f)),g=[b,c,d,f/255]}else 0==a.indexOf("rgba(")?(g=a.slice(5,-1).split(",").map(Number),h(g)):0==a.indexOf("rgb(")?(g=a.slice(4,-1).split(",").map(Number),g.push(1),h(g)):j.assert(!1,14);return g}function h(a){return a[0]=k.clamp(a[0]+.5|0,0,255),a[1]=k.clamp(a[1]+.5|0,0,255),a[2]=k.clamp(a[2]+.5|0,0,255),a[3]=k.clamp(a[3],0,1),a}function i(a){var b=a[0];b!=(0|b)&&(b=b+.5|0);var c=a[1];c!=(0|c)&&(c=c+.5|0);var d=a[2];d!=(0|d)&&(d=d+.5|0);var e=void 0===a[3]?1:a[3];return"rgba("+b+","+c+","+d+","+e+")"}Object.defineProperty(c,"__esModule",{value:!0}),c.asString=d,c.asArray=f,c.normalize=h,c.toString=i,c.fromString=void 0;var j=a("./asserts.js"),k=a("./math.js"),l=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,m=/^([a-z]*)$/i,n=function(){var a=1024,b={},c=0;return function(d){var e;if(b.hasOwnProperty(d))e=b[d];else{if(c>=a){var f=0;for(var h in b)0===(3&f++)&&(delete b[h],--c)}e=g(d),b[d]=e,++c}return e}}();c.fromString=n},{"./asserts.js":46,"./math.js":147}],49:[function(a,b,c){"use strict";function d(a){return e(a)?a:f.toString(a)}function e(a){return"string"==typeof a||a instanceof CanvasPattern||a instanceof CanvasGradient}Object.defineProperty(c,"__esModule",{value:!0}),c.asColorLike=d,c.isColorLike=e;var f=a("./color.js")},{"./color.js":48}],50:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Attribution",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Control",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"FullScreen",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"OverviewMap",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Rotate",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"ScaleLine",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Zoom",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"ZoomSlider",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"ZoomToExtent",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"defaults",{enumerable:!0,get:function(){return n.defaults}});var e=d(a("./control/Attribution.js")),f=d(a("./control/Control.js")),g=d(a("./control/FullScreen.js")),h=d(a("./control/OverviewMap.js")),i=d(a("./control/Rotate.js")),j=d(a("./control/ScaleLine.js")),k=d(a("./control/Zoom.js")),l=d(a("./control/ZoomSlider.js")),m=d(a("./control/ZoomToExtent.js")),n=a("./control/util.js")},{"./control/Attribution.js":51,"./control/Control.js":52,"./control/FullScreen.js":53,"./control/OverviewMap.js":54,"./control/Rotate.js":55,"./control/ScaleLine.js":56,"./control/Zoom.js":57,"./control/ZoomSlider.js":58,"./control/ZoomToExtent.js":59,"./control/util.js":60}],51:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){this.updateElement_(a.frameState)}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=a("../array.js"),g=d(a("../control/Control.js")),h=a("../css.js"),i=a("../dom.js"),j=a("../events.js"),k=d(a("../events/EventType.js")),l=a("../layer/Layer.js"),m=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0!==c.collapsed?c.collapsed:!0,this.collapsible_=void 0!==c.collapsible?c.collapsible:!0,this.collapsible_||(this.collapsed_=!1);var d=void 0!==c.className?c.className:"ol-attribution",f=void 0!==c.tipLabel?c.tipLabel:"Attributions",g=void 0!==c.collapseLabel?c.collapseLabel:"»";"string"==typeof g?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=g):this.collapseLabel_=g;var i=void 0!==c.label?c.label:"i";"string"==typeof i?(this.label_=document.createElement("span"),this.label_.textContent=i):this.label_=i;var l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,m=document.createElement("button");m.setAttribute("type","button"),m.title=f,m.appendChild(l),j.listen(m,k.default.CLICK,this.handleClick_,this);var n=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+h.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),o=this.element;o.className=n,o.appendChild(this.ulElement_),o.appendChild(m),this.renderedAttributions_=[],this.renderedVisible_=!0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getSourceAttributions_=function(a){for(var b={},c=[],d=a.layerStatesArray,e=a.viewState.resolution,f=0,g=d.length;g>f;++f){var h=d[f];if(l.visibleAtResolution(h,e)){var i=h.layer.getSource();if(i){var j=i.getAttributions();if(j){var k=j(a);if(k)if(Array.isArray(k))for(var m=0,n=k.length;n>m;++m)k[m]in b||(c.push(k[m]),b[k[m]]=!0);else k in b||(c.push(k),b[k]=!0)}}}}return c},b.prototype.updateElement_=function(a){var b=this;if(!a)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));var c=this.getSourceAttributions_(a),d=c.length>0;if(this.renderedVisible_!=d&&(this.element.style.display=d?"":"none",this.renderedVisible_=d),!f.equals(c,this.renderedAttributions_)){i.removeChildren(this.ulElement_);for(var e=0,g=c.length;g>e;++e){var h=document.createElement("li");h.innerHTML=c[e],b.ulElement_.appendChild(h)}this.renderedAttributions_=c}},b.prototype.handleClick_=function(a){a.preventDefault(),this.handleToggle_()},b.prototype.handleToggle_=function(){this.element.classList.toggle(h.CLASS_COLLAPSED),this.collapsed_?i.replaceNode(this.collapseLabel_,this.label_):i.replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},b.prototype.getCollapsible=function(){return this.collapsible_},b.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())},b.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()},b.prototype.getCollapsed=function(){return this.collapsed_},b}(g.default),n=m;c.default=n},{"../array.js":45,"../control/Control.js":52,"../css.js":62,"../dom.js":63,"../events.js":65,"../events/EventType.js":67,"../layer/Layer.js":138}],52:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../functions.js"),f=d(a("../MapEventType.js")),g=d(a("../Object.js")),h=a("../dom.js"),i=a("../events.js"),j=function(a){function b(b){a.call(this),this.element=b.element?b.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=b.render?b.render:e.VOID,b.target&&this.setTarget(b.target)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){h.removeNode(this.element),a.prototype.disposeInternal.call(this)},b.prototype.getMap=function(){return this.map_},b.prototype.setMap=function(a){var b=this;this.map_&&h.removeNode(this.element);for(var c=0,d=this.listenerKeys.length;d>c;++c)i.unlistenByKey(b.listenerKeys[c]);if(this.listenerKeys.length=0,this.map_=a,this.map_){var g=this.target_?this.target_:a.getOverlayContainerStopEvent();g.appendChild(this.element),this.render!==e.VOID&&this.listenerKeys.push(i.listen(a,f.default.POSTRENDER,this.render,this)),a.render()}},b.prototype.setTarget=function(a){this.target_="string"==typeof a?document.getElementById(a):a},b}(g.default),k=j;c.default=k},{"../MapEventType.js":26,"../Object.js":28,"../dom.js":63,"../events.js":65,"../functions.js":76}],53:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){var a=document.body;return!!(a.webkitRequestFullscreen||a.mozRequestFullScreen&&document.mozFullScreenEnabled||a.msRequestFullscreen&&document.msFullscreenEnabled||a.requestFullscreen&&document.fullscreenEnabled)}function f(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}function g(a){a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}function h(a){a.mozRequestFullScreenWithKeys?a.mozRequestFullScreenWithKeys():a.webkitRequestFullscreen?a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):g(a)}function i(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var j=d(a("../control/Control.js")),k=a("../css.js"),l=a("../dom.js"),m=a("../events.js"),n=d(a("../events/EventType.js")),o=function(){var a;return function(){if(!a){var b=document.body;b.webkitRequestFullscreen?a="webkitfullscreenchange":b.mozRequestFullScreen?a="mozfullscreenchange":b.msRequestFullscreen?a="MSFullscreenChange":b.requestFullscreen&&(a="fullscreenchange")}return a}}(),p=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),target:c.target}),this.cssClassName_=void 0!==c.className?c.className:"ol-full-screen";var d=void 0!==c.label?c.label:"⤢";this.labelNode_="string"==typeof d?document.createTextNode(d):d;var g=void 0!==c.labelActive?c.labelActive:"×";this.labelActiveNode_="string"==typeof g?document.createTextNode(g):g;var h=c.tipLabel?c.tipLabel:"Toggle full-screen",i=document.createElement("button");i.className=this.cssClassName_+"-"+f(),i.setAttribute("type","button"),i.title=h,i.appendChild(this.labelNode_),m.listen(i,n.default.CLICK,this.handleClick_,this);var j=this.cssClassName_+" "+k.CLASS_UNSELECTABLE+" "+k.CLASS_CONTROL+" "+(e()?"":k.CLASS_UNSUPPORTED),l=this.element;l.className=j,l.appendChild(i),this.keys_=void 0!==c.keys?c.keys:!1,this.source_=c.source}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a){a.preventDefault(),this.handleFullScreen_()},b.prototype.handleFullScreen_=function(){if(e()){var a=this.getMap();if(a)if(f())i();else{var b;b=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:a.getTargetElement(),this.keys_?h(b):g(b)}}},b.prototype.handleFullScreenChange_=function(){var a=this.element.firstElementChild,b=this.getMap();f()?(a.className=this.cssClassName_+"-true",l.replaceNode(this.labelActiveNode_,this.labelNode_)):(a.className=this.cssClassName_+"-false",l.replaceNode(this.labelNode_,this.labelActiveNode_)),b&&b.updateSize()},b.prototype.setMap=function(b){a.prototype.setMap.call(this,b),b&&this.listenerKeys.push(m.listen(document,o(),this.handleFullScreenChange_,this))},b}(j.default),q=p;c.default=q},{"../control/Control.js":52,"../css.js":62,"../dom.js":63,"../events.js":65,"../events/EventType.js":67}],54:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){this.validateExtent_(),this.updateBox_()}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=d(a("../Collection.js")),g=d(a("../Map.js")),h=d(a("../MapEventType.js")),i=d(a("../MapProperty.js")),j=a("../Object.js"),k=d(a("../ObjectEventType.js")),l=d(a("../Overlay.js")),m=d(a("../OverlayPositioning.js")),n=d(a("../ViewProperty.js")),o=d(a("../control/Control.js")),p=a("../coordinate.js"),q=a("../css.js"),r=a("../dom.js"),s=a("../events.js"),t=d(a("../events/EventType.js")),u=a("../extent.js"),v=.75,w=.1,x=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target}),this.collapsed_=void 0!==c.collapsed?c.collapsed:!0,this.collapsible_=void 0!==c.collapsible?c.collapsible:!0,this.collapsible_||(this.collapsed_=!1);var d=void 0!==c.className?c.className:"ol-overviewmap",h=void 0!==c.tipLabel?c.tipLabel:"Overview map",i=void 0!==c.collapseLabel?c.collapseLabel:"«";"string"==typeof i?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=i):this.collapseLabel_=i;var j=void 0!==c.label?c.label:"»";"string"==typeof j?(this.label_=document.createElement("span"),this.label_.textContent=j):this.label_=j;var k=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,n=document.createElement("button");n.setAttribute("type","button"),n.title=h,n.appendChild(k),s.listen(n,t.default.CLICK,this.handleClick_,this),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.ovmap_=new g.default({controls:new f.default,interactions:new f.default,view:c.view});
var o=this.ovmap_;c.layers&&c.layers.forEach(function(a){o.addLayer(a)}.bind(this));var p=document.createElement("div");p.className="ol-overviewmap-box",p.style.boxSizing="border-box",this.boxOverlay_=new l.default({position:[0,0],positioning:m.default.BOTTOM_LEFT,element:p}),this.ovmap_.addOverlay(this.boxOverlay_);var r=d+" "+q.CLASS_UNSELECTABLE+" "+q.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+q.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=r,u.appendChild(this.ovmapDiv_),u.appendChild(n);var v=this,w=this.boxOverlay_,x=this.boxOverlay_.getElement(),y=function(a){return{clientX:a.clientX-x.offsetWidth/2,clientY:a.clientY+x.offsetHeight/2}},z=function(a){var b=o.getEventCoordinate(y(a));w.setPosition(b)},A=function B(a){var b=o.getEventCoordinate(a);v.getMap().getView().setCenter(b),window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",B)};x.addEventListener("mousedown",function(){window.addEventListener("mousemove",z),window.addEventListener("mouseup",A)})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setMap=function(b){var c=this.getMap();if(b!==c){if(c){var d=c.getView();d&&this.unbindView_(d),this.ovmap_.setTarget(null)}if(a.prototype.setMap.call(this,b),b){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(s.listen(b,k.default.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(b.getLayerGroup());var e=b.getView();e&&(this.bindView_(e),e.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},b.prototype.handleMapPropertyChange_=function(a){if(a.key===i.default.VIEW){var b=a.oldValue;b&&this.unbindView_(b);var c=this.getMap().getView();this.bindView_(c)}},b.prototype.bindView_=function(a){s.listen(a,j.getChangeEventType(n.default.ROTATION),this.handleRotationChanged_,this)},b.prototype.unbindView_=function(a){s.unlisten(a,j.getChangeEventType(n.default.ROTATION),this.handleRotationChanged_,this)},b.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},b.prototype.validateExtent_=function(){var a=this.getMap(),b=this.ovmap_;if(a.isRendered()&&b.isRendered()){var c=a.getSize(),d=a.getView(),e=d.calculateExtent(c),f=b.getSize(),g=b.getView(),h=g.calculateExtent(f),i=b.getPixelFromCoordinate(u.getTopLeft(e)),j=b.getPixelFromCoordinate(u.getBottomRight(e)),k=Math.abs(i[0]-j[0]),l=Math.abs(i[1]-j[1]),m=f[0],n=f[1];m*w>k||n*w>l||k>m*v||l>n*v?this.resetExtent_():u.containsExtent(h,e)||this.recenter_()}},b.prototype.resetExtent_=function(){if(0!==v&&0!==w){var a=this.getMap(),b=this.ovmap_,c=a.getSize(),d=a.getView(),e=d.calculateExtent(c),f=b.getView(),g=Math.log(v/w)/Math.LN2,h=1/(Math.pow(2,g/2)*w);u.scaleFromCenter(e,h),f.fit(e)}},b.prototype.recenter_=function(){var a=this.getMap(),b=this.ovmap_,c=a.getView(),d=b.getView();d.setCenter(c.getCenter())},b.prototype.updateBox_=function(){var a=this.getMap(),b=this.ovmap_;if(a.isRendered()&&b.isRendered()){var c=a.getSize(),d=a.getView(),e=b.getView(),f=d.getRotation(),g=this.boxOverlay_,h=this.boxOverlay_.getElement(),i=d.calculateExtent(c),j=e.getResolution(),k=u.getBottomLeft(i),l=u.getTopRight(i),m=this.calculateCoordinateRotate_(f,k);g.setPosition(m),h&&(h.style.width=Math.abs((k[0]-l[0])/j)+"px",h.style.height=Math.abs((l[1]-k[1])/j)+"px")}},b.prototype.calculateCoordinateRotate_=function(a,b){var c,d=this.getMap(),e=d.getView(),f=e.getCenter();return f&&(c=[b[0]-f[0],b[1]-f[1]],p.rotate(c,a),p.add(c,f)),c},b.prototype.handleClick_=function(a){a.preventDefault(),this.handleToggle_()},b.prototype.handleToggle_=function(){this.element.classList.toggle(q.CLASS_COLLAPSED),this.collapsed_?r.replaceNode(this.collapseLabel_,this.label_):r.replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var a=this.ovmap_;this.collapsed_||a.isRendered()||(a.updateSize(),this.resetExtent_(),s.listenOnce(a,h.default.POSTRENDER,function(){this.updateBox_()},this))},b.prototype.getCollapsible=function(){return this.collapsible_},b.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())},b.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()},b.prototype.getCollapsed=function(){return this.collapsed_},b.prototype.getOverviewMap=function(){return this.ovmap_},b}(o.default),y=x;c.default=y},{"../Collection.js":6,"../Map.js":20,"../MapEventType.js":26,"../MapProperty.js":27,"../Object.js":28,"../ObjectEventType.js":29,"../Overlay.js":31,"../OverlayPositioning.js":32,"../ViewProperty.js":43,"../control/Control.js":52,"../coordinate.js":61,"../css.js":62,"../dom.js":63,"../events.js":65,"../events/EventType.js":67,"../extent.js":71}],55:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.frameState;if(b){var c=b.viewState.rotation;if(c!=this.rotation_){var d="rotate("+c+"rad)";if(this.autoHide_){var e=this.element.classList.contains(g.CLASS_HIDDEN);e||0!==c?e&&0!==c&&this.element.classList.remove(g.CLASS_HIDDEN):this.element.classList.add(g.CLASS_HIDDEN)}this.label_.style.msTransform=d,this.label_.style.webkitTransform=d,this.label_.style.transform=d}this.rotation_=c}}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=d(a("../control/Control.js")),g=a("../css.js"),h=a("../easing.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target});var d=void 0!==c.className?c.className:"ol-rotate",f=void 0!==c.label?c.label:"⇧";this.label_=null,"string"==typeof f?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=f):(this.label_=f,this.label_.classList.add("ol-compass"));var h=c.tipLabel?c.tipLabel:"Reset rotation",k=document.createElement("button");k.className=d+"-reset",k.setAttribute("type","button"),k.title=h,k.appendChild(this.label_),i.listen(k,j.default.CLICK,this.handleClick_,this);var l=d+" "+g.CLASS_UNSELECTABLE+" "+g.CLASS_CONTROL,m=this.element;m.className=l,m.appendChild(k),this.callResetNorth_=c.resetNorth?c.resetNorth:void 0,this.duration_=void 0!==c.duration?c.duration:250,this.autoHide_=void 0!==c.autoHide?c.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(g.CLASS_HIDDEN)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a){a.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},b.prototype.resetNorth_=function(){var a=this.getMap(),b=a.getView();b&&void 0!==b.getRotation()&&(this.duration_>0?b.animate({rotation:0,duration:this.duration_,easing:h.easeOut}):b.setRotation(0))},b}(f.default),l=k;c.default=l},{"../control/Control.js":52,"../css.js":62,"../easing.js":64,"../events.js":65,"../events/EventType.js":67}],56:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.frameState;this.viewState_=b?b.viewState:null,this.updateElement_()}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=c.Units=void 0;var f=a("../Object.js"),g=a("../asserts.js"),h=d(a("../control/Control.js")),i=a("../css.js"),j=a("../events.js"),k=a("../proj.js"),l=d(a("../proj/Units.js")),m="units",n={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};c.Units=n;var o=[1,2,5],p=function(a){function b(b){var c=b?b:{},d=void 0!==c.className?c.className:"ol-scale-line";a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target}),this.innerElement_=document.createElement("div"),this.innerElement_.className=d+"-inner",this.element.className=d+" "+i.CLASS_UNSELECTABLE,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==c.minWidth?c.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",j.listen(this,f.getChangeEventType(m),this.handleUnitsChanged_,this),this.setUnits(c.units||n.METRIC)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getUnits=function(){return this.get(m)},b.prototype.handleUnitsChanged_=function(){this.updateElement_()},b.prototype.setUnits=function(a){this.set(m,a)},b.prototype.updateElement_=function(){var a=this,b=this.viewState_;if(!b)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));var c=b.center,d=b.projection,e=this.getUnits(),f=e==n.DEGREES?l.default.DEGREES:l.default.METERS,h=k.getPointResolution(d,b.resolution,c,f);d.getUnits()!=l.default.DEGREES&&d.getMetersPerUnit()&&f==l.default.METERS&&(h*=d.getMetersPerUnit());var i=this.minWidth_*h,j="";if(e==n.DEGREES){var m=k.METERS_PER_UNIT[l.default.DEGREES];d.getUnits()==l.default.DEGREES?i*=m:h/=m,m/60>i?(j="″",h*=3600):m>i?(j="′",h*=60):j="°"}else e==n.IMPERIAL?.9144>i?(j="in",h/=.0254):1609.344>i?(j="ft",h/=.3048):(j="mi",h/=1609.344):e==n.NAUTICAL?(h/=1852,j="nm"):e==n.METRIC?.001>i?(j="μm",h*=1e6):1>i?(j="mm",h*=1e3):1e3>i?j="m":(j="km",h/=1e3):e==n.US?.9144>i?(j="in",h*=39.37):1609.344>i?(j="ft",h/=.30480061):(j="mi",h/=1609.3472):g.assert(!1,33);for(var p,q,r=3*Math.floor(Math.log(this.minWidth_*h)/Math.log(10));;){if(p=o[(r%3+3)%3]*Math.pow(10,Math.floor(r/3)),q=Math.round(p/h),isNaN(q))return a.element.style.display="none",void(a.renderedVisible_=!1);if(q>=a.minWidth_)break;++r}var s=p+" "+j;this.renderedHTML_!=s&&(this.innerElement_.innerHTML=s,this.renderedHTML_=s),this.renderedWidth_!=q&&(this.innerElement_.style.width=q+"px",this.renderedWidth_=q),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)},b}(h.default),q=p;c.default=q},{"../Object.js":28,"../asserts.js":46,"../control/Control.js":52,"../css.js":62,"../events.js":65,"../proj.js":158,"../proj/Units.js":160}],57:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../events.js"),f=d(a("../events/EventType.js")),g=d(a("../control/Control.js")),h=a("../css.js"),i=a("../easing.js"),j=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),target:c.target});var d=void 0!==c.className?c.className:"ol-zoom",g=void 0!==c.delta?c.delta:1,i=void 0!==c.zoomInLabel?c.zoomInLabel:"+",j=void 0!==c.zoomOutLabel?c.zoomOutLabel:"−",k=void 0!==c.zoomInTipLabel?c.zoomInTipLabel:"Zoom in",l=void 0!==c.zoomOutTipLabel?c.zoomOutTipLabel:"Zoom out",m=document.createElement("button");m.className=d+"-in",m.setAttribute("type","button"),m.title=k,m.appendChild("string"==typeof i?document.createTextNode(i):i),e.listen(m,f.default.CLICK,this.handleClick_.bind(this,g));var n=document.createElement("button");n.className=d+"-out",n.setAttribute("type","button"),n.title=l,n.appendChild("string"==typeof j?document.createTextNode(j):j),e.listen(n,f.default.CLICK,this.handleClick_.bind(this,-g));var o=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,p=this.element;p.className=o,p.appendChild(m),p.appendChild(n),this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a,b){b.preventDefault(),this.zoomByDelta_(a)},b.prototype.zoomByDelta_=function(a){var b=this.getMap(),c=b.getView();if(c){var d=c.getResolution();if(d){var e=c.constrainResolution(d,a);this.duration_>0?(c.getAnimating()&&c.cancelAnimations(),c.animate({resolution:e,duration:this.duration_,easing:i.easeOut})):c.setResolution(e)}}},b}(g.default),k=j;c.default=k},{"../control/Control.js":52,"../css.js":62,"../easing.js":64,"../events.js":65,"../events/EventType.js":67}],58:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a.frameState){this.sliderInitialized_||this.initSlider_();var b=a.frameState.viewState.resolution;b!==this.currentResolution_&&(this.currentResolution_=b,this.setThumbPosition_(b))}}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=d(a("../ViewHint.js")),g=d(a("../control/Control.js")),h=a("../css.js"),i=a("../easing.js"),j=a("../events.js"),k=a("../events/Event.js"),l=d(a("../events/EventType.js")),m=a("../math.js"),n=d(a("../pointer/EventType.js")),o=d(a("../pointer/PointerEventHandler.js")),p={VERTICAL:0,HORIZONTAL:1},q=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),render:c.render||e}),this.currentResolution_=void 0,this.direction_=p.VERTICAL,this.dragging_,this.heightLimit_=0,this.widthLimit_=0,this.previousX_,this.previousY_,this.thumbSize_=null,this.sliderInitialized_=!1,this.duration_=void 0!==c.duration?c.duration:200;var d=void 0!==c.className?c.className:"ol-zoomslider",f=document.createElement("button");f.setAttribute("type","button"),f.className=d+"-thumb "+h.CLASS_UNSELECTABLE;var g=this.element;g.className=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,g.appendChild(f),this.dragger_=new o.default(g),j.listen(this.dragger_,n.default.POINTERDOWN,this.handleDraggerStart_,this),j.listen(this.dragger_,n.default.POINTERMOVE,this.handleDraggerDrag_,this),j.listen(this.dragger_,n.default.POINTERUP,this.handleDraggerEnd_,this),j.listen(g,l.default.CLICK,this.handleContainerClick_,this),j.listen(f,l.default.CLICK,k.stopPropagation)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.dragger_.dispose(),a.prototype.disposeInternal.call(this)},b.prototype.setMap=function(b){a.prototype.setMap.call(this,b),b&&b.render()},b.prototype.initSlider_=function(){var a=this.element,b={width:a.offsetWidth,height:a.offsetHeight},c=a.firstElementChild,d=getComputedStyle(c),e=c.offsetWidth+parseFloat(d.marginRight)+parseFloat(d.marginLeft),f=c.offsetHeight+parseFloat(d.marginTop)+parseFloat(d.marginBottom);this.thumbSize_=[e,f],b.width>b.height?(this.direction_=p.HORIZONTAL,this.widthLimit_=b.width-e):(this.direction_=p.VERTICAL,this.heightLimit_=b.height-f),this.sliderInitialized_=!0},b.prototype.handleContainerClick_=function(a){var b=this.getMap().getView(),c=this.getRelativePosition_(a.offsetX-this.thumbSize_[0]/2,a.offsetY-this.thumbSize_[1]/2),d=this.getResolutionForPosition_(c);b.animate({resolution:b.constrainResolution(d),duration:this.duration_,easing:i.easeOut})},b.prototype.handleDraggerStart_=function(a){this.dragging_||a.originalEvent.target!==this.element.firstElementChild||(this.getMap().getView().setHint(f.default.INTERACTING,1),this.previousX_=a.clientX,this.previousY_=a.clientY,this.dragging_=!0)},b.prototype.handleDraggerDrag_=function(a){if(this.dragging_){var b=this.element.firstElementChild,c=a.clientX-this.previousX_+parseInt(b.style.left,10),d=a.clientY-this.previousY_+parseInt(b.style.top,10),e=this.getRelativePosition_(c,d);this.currentResolution_=this.getResolutionForPosition_(e),this.getMap().getView().setResolution(this.currentResolution_),this.setThumbPosition_(this.currentResolution_),this.previousX_=a.clientX,this.previousY_=a.clientY}},b.prototype.handleDraggerEnd_=function(){if(this.dragging_){var a=this.getMap().getView();a.setHint(f.default.INTERACTING,-1),a.animate({resolution:a.constrainResolution(this.currentResolution_),duration:this.duration_,easing:i.easeOut}),this.dragging_=!1,this.previousX_=void 0,this.previousY_=void 0}},b.prototype.setThumbPosition_=function(a){var b=this.getPositionForResolution_(a),c=this.element.firstElementChild;this.direction_==p.HORIZONTAL?c.style.left=this.widthLimit_*b+"px":c.style.top=this.heightLimit_*b+"px"},b.prototype.getRelativePosition_=function(a,b){var c;return c=this.direction_===p.HORIZONTAL?a/this.widthLimit_:b/this.heightLimit_,m.clamp(c,0,1)},b.prototype.getResolutionForPosition_=function(a){var b=this.getMap().getView().getResolutionForValueFunction();return b(1-a)},b.prototype.getPositionForResolution_=function(a){var b=this.getMap().getView().getValueForResolutionFunction();return 1-b(a)},b}(g.default),r=q;c.default=r},{"../ViewHint.js":42,"../control/Control.js":52,"../css.js":62,"../easing.js":64,"../events.js":65,"../events/Event.js":66,"../events/EventType.js":67,"../math.js":147,"../pointer/EventType.js":151,"../pointer/PointerEventHandler.js":156}],59:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../events.js"),f=d(a("../events/EventType.js")),g=d(a("../control/Control.js")),h=a("../css.js"),i=function(a){function b(b){var c=b?b:{};a.call(this,{element:document.createElement("div"),target:c.target}),this.extent=c.extent?c.extent:null;var d=void 0!==c.className?c.className:"ol-zoom-extent",g=void 0!==c.label?c.label:"E",i=void 0!==c.tipLabel?c.tipLabel:"Fit to extent",j=document.createElement("button");j.setAttribute("type","button"),j.title=i,j.appendChild("string"==typeof g?document.createTextNode(g):g),e.listen(j,f.default.CLICK,this.handleClick_,this);var k=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,l=this.element;l.className=k,l.appendChild(j)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a){a.preventDefault(),this.handleZoomToExtent()},b.prototype.handleZoomToExtent=function(){var a=this.getMap(),b=a.getView(),c=this.extent?this.extent:b.getProjection().getExtent();b.fit(c)},b}(g.default),j=i;c.default=j},{"../control/Control.js":52,"../css.js":62,"../events.js":65,"../events/EventType.js":67}],60:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a?a:{},c=new f.default,d=void 0!==b.zoom?b.zoom:!0;d&&c.push(new i.default(b.zoomOptions));var e=void 0!==b.rotate?b.rotate:!0;e&&c.push(new h.default(b.rotateOptions));var j=void 0!==b.attribution?b.attribution:!0;return j&&c.push(new g.default(b.attributionOptions)),c}Object.defineProperty(c,"__esModule",{value:!0}),c.defaults=e;var f=d(a("../Collection.js")),g=d(a("./Attribution.js")),h=d(a("./Rotate.js")),i=d(a("./Zoom.js"))},{"../Collection.js":6,"./Attribution.js":51,"./Rotate.js":55,"./Zoom.js":57}],61:[function(a,b,c){"use strict";function d(a,b){return a[0]+=b[0],a[1]+=b[1],a}function e(a,b){var c=b.getRadius(),d=b.getCenter(),e=d[0],f=d[1],g=a[0],h=a[1],i=g-e,j=h-f;0===i&&0===j&&(i=1);var k=Math.sqrt(i*i+j*j),l=e+c*i/k,m=f+c*j/k;return[l,m]}function f(a,b){var c,d,e=a[0],f=a[1],g=b[0],h=b[1],i=g[0],j=g[1],k=h[0],l=h[1],m=k-i,n=l-j,o=0===m&&0===n?0:(m*(e-i)+n*(f-j))/(m*m+n*n||0);return 0>=o?(c=i,d=j):o>=1?(c=k,d=l):(c=i+o*m,d=j+o*n),[c,d]}function g(a){return function(b){return q(b,a)}}function h(a,b,c){var d=r.modulo(b+180,360)-180,e=Math.abs(3600*d),f=c||0,g=Math.pow(10,f),h=Math.floor(e/3600),i=Math.floor((e-3600*h)/60),j=e-3600*h-60*i;return j=Math.ceil(j*g)/g,j>=60&&(j=0,i+=1),i>=60&&(i=0,h+=1),h+"° "+s.padNumber(i,2)+"′ "+s.padNumber(j,2,f)+"″"+(0==d?"":" "+a.charAt(0>d?1:0))}function i(a,b,c){return a?b.replace("{x}",a[0].toFixed(c)).replace("{y}",a[1].toFixed(c)):""}function j(a,b){for(var c=!0,d=a.length-1;d>=0;--d)if(a[d]!=b[d]){c=!1;break}return c}function k(a,b){var c=Math.cos(b),d=Math.sin(b),e=a[0]*c-a[1]*d,f=a[1]*c+a[0]*d;return a[0]=e,a[1]=f,a}function l(a,b){return a[0]*=b,a[1]*=b,a}function m(a,b){var c=a[0]-b[0],d=a[1]-b[1];return c*c+d*d}function n(a,b){return Math.sqrt(m(a,b))}function o(a,b){return m(a,f(a,b))}function p(a,b){return a?h("NS",a[1],b)+" "+h("EW",a[0],b):""}function q(a,b){return i(a,"{x}, {y}",b)}Object.defineProperty(c,"__esModule",{value:!0}),c.add=d,c.closestOnCircle=e,c.closestOnSegment=f,c.createStringXY=g,c.degreesToStringHDMS=h,c.format=i,c.equals=j,c.rotate=k,c.scale=l,c.squaredDistance=m,c.distance=n,c.squaredDistanceToSegment=o,c.toStringHDMS=p,c.toStringXY=q;var r=a("./math.js"),s=a("./string.js")},{"./math.js":147,"./string.js":260}],62:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getFontFamilies=c.CLASS_COLLAPSED=c.CLASS_CONTROL=c.CLASS_UNSUPPORTED=c.CLASS_UNSELECTABLE=c.CLASS_SELECTABLE=c.CLASS_HIDDEN=void 0;var d="ol-hidden";c.CLASS_HIDDEN=d;var e="ol-selectable";c.CLASS_SELECTABLE=e;var f="ol-unselectable";c.CLASS_UNSELECTABLE=f;var g="ol-unsupported";c.CLASS_UNSUPPORTED=g;var h="ol-control";c.CLASS_CONTROL=h;var i="ol-collapsed";c.CLASS_COLLAPSED=i;var j=function(){var a,b={};return function(c){if(a||(a=document.createElement("div").style),!(c in b)){a.font=c;var d=a.fontFamily;if(a.font="",!d)return null;b[c]=d.split(/,\s?/)}return b[c]}}();c.getFontFamilies=j},{}],63:[function(a,b,c){"use strict";function d(a,b){var c=document.createElement("canvas");return a&&(c.width=a),b&&(c.height=b),c.getContext("2d")}function e(a){var b=a.offsetWidth,c=getComputedStyle(a);return b+=parseInt(c.marginLeft,10)+parseInt(c.marginRight,10)}function f(a){var b=a.offsetHeight,c=getComputedStyle(a);return b+=parseInt(c.marginTop,10)+parseInt(c.marginBottom,10)}function g(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)}function h(a){return a&&a.parentNode?a.parentNode.removeChild(a):null}function i(a){for(;a.lastChild;)a.removeChild(a.lastChild)}Object.defineProperty(c,"__esModule",{value:!0}),c.createCanvasContext2D=d,c.outerWidth=e,c.outerHeight=f,c.replaceNode=g,c.removeNode=h,c.removeChildren=i},{}],64:[function(a,b,c){"use strict";function d(a){return Math.pow(a,3)}function e(a){return 1-d(1-a)}function f(a){return 3*a*a-2*a*a*a}function g(a){return a}function h(a){return.5>a?f(2*a):1-f(2*(a-.5))}Object.defineProperty(c,"__esModule",{value:!0}),c.easeIn=d,c.easeOut=e,c.inAndOut=f,c.linear=g,c.upAndDown=h},{}],65:[function(a,b,c){"use strict";function d(a){var b=function(b){var c=a.listener,d=a.bindTo||a.target;return a.callOnce&&l(a),c.call(d,b)};return a.boundListener=b,b}function e(a,b,c,d){for(var e,f=0,g=a.length;g>f;++f)if(e=a[f],e.listener===b&&e.bindTo===c)return d&&(e.deleteIndex=f),e;return void 0}function f(a,b){var c=a.ol_lm;return c?c[b]:void 0}function g(a){var b=a.ol_lm;return b||(b=a.ol_lm={}),b}function h(a,b){var c=f(a,b);if(c){for(var d=0,e=c.length;e>d;++d)a.removeEventListener(b,c[d].boundListener),n.clear(c[d]);c.length=0;var g=a.ol_lm;g&&(delete g[b],0===Object.keys(g).length&&delete a.ol_lm)}}function i(a,b,c,f,h){var i=g(a),j=i[b];j||(j=i[b]=[]);var k=e(j,c,f,!1);return k?h||(k.callOnce=!1):(k={bindTo:f,callOnce:!!h,listener:c,target:a,type:b},a.addEventListener(b,d(k)),j.push(k)),k}function j(a,b,c,d){return i(a,b,c,d,!0)}function k(a,b,c,d){var g=f(a,b);if(g){var h=e(g,c,d,!0);h&&l(h)}}function l(a){if(a&&a.target){a.target.removeEventListener(a.type,a.boundListener);var b=f(a.target,a.type);if(b){var c="deleteIndex"in a?a.deleteIndex:b.indexOf(a);-1!==c&&b.splice(c,1),0===b.length&&h(a.target,a.type)}n.clear(a)}}function m(a){var b=g(a);for(var c in b)h(a,c)}Object.defineProperty(c,"__esModule",{value:!0}),c.bindListener=d,c.findListener=e,c.getListeners=f,c.listen=i,c.listenOnce=j,c.unlisten=k,c.unlistenByKey=l,c.unlistenAll=m;var n=a("./obj.js")},{"./obj.js":149}],66:[function(a,b,c){"use strict";function d(a){a.stopPropagation()}function e(a){a.preventDefault()}Object.defineProperty(c,"__esModule",{value:!0}),c.stopPropagation=d,c.preventDefault=e,c.default=void 0;var f=function(a){this.propagationStopped,this.type=a,this.target=null};f.prototype.preventDefault=function(){this.propagationStopped=!0},f.prototype.stopPropagation=function(){this.propagationStopped=!0};var g=f;c.default=g},{}],67:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};c.default=d},{}],68:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={LEFT:37,UP:38,RIGHT:39,DOWN:40};c.default=d},{}],69:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Disposable.js")),f=a("../events.js"),g=a("../functions.js"),h=d(a("../events/Event.js")),i=function(a){function b(){a.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addEventListener=function(a,b){var c=this.listeners_[a];c||(c=this.listeners_[a]=[]),-1===c.indexOf(b)&&c.push(b)},b.prototype.dispatchEvent=function(a){var b=this,c="string"==typeof a?new h.default(a):a,d=c.type;c.target=this;var e,f=this.listeners_[d];if(f){d in this.dispatching_||(this.dispatching_[d]=0,this.pendingRemovals_[d]=0),++this.dispatching_[d];for(var i=0,j=f.length;j>i;++i)if(f[i].call(b,c)===!1||c.propagationStopped){e=!1;break}if(--this.dispatching_[d],0===this.dispatching_[d]){var k=this.pendingRemovals_[d];for(delete this.pendingRemovals_[d];k--;)b.removeEventListener(d,g.VOID);delete this.dispatching_[d]}return e}},b.prototype.disposeInternal=function(){f.unlistenAll(this)},b.prototype.getListeners=function(a){return this.listeners_[a]},b.prototype.hasListener=function(a){return a?a in this.listeners_:Object.keys(this.listeners_).length>0},b.prototype.removeEventListener=function(a,b){var c=this.listeners_[a];if(c){var d=c.indexOf(b);a in this.pendingRemovals_?(c[d]=g.VOID,++this.pendingRemovals_[a]):(c.splice(d,1),0===c.length&&delete this.listeners_[a])}},b}(e.default),j=i;c.default=j},{"../Disposable.js":8,"../events.js":65,"../events/Event.js":66,"../functions.js":76}],70:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.primaryAction=c.mouseOnly=c.targetNotEditable=c.shiftKeyOnly=c.platformModifierKeyOnly=c.noModifierKeys=c.doubleClick=c.singleClick=c.pointerMove=c.never=c.mouseActionButton=c.click=c.always=c.focus=c.altShiftKeysOnly=c.altKeyOnly=void 0;var e=d(a("../MapBrowserEventType.js")),f=a("../asserts.js"),g=a("../functions.js"),h=a("../has.js"),i=function(a){var b=a.originalEvent;return b.altKey&&!(b.metaKey||b.ctrlKey)&&!b.shiftKey};c.altKeyOnly=i;var j=function(a){var b=a.originalEvent;return b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey};c.altShiftKeysOnly=j;var k=function(a){return a.target.getTargetElement()===document.activeElement};c.focus=k;var l=g.TRUE;c.always=l;var m=function(a){return a.type==e.default.CLICK};c.click=m;var n=function(a){var b=a.originalEvent;return 0==b.button&&!(h.WEBKIT&&h.MAC&&b.ctrlKey)};c.mouseActionButton=n;var o=g.FALSE;c.never=o;var p=function(a){return"pointermove"==a.type};c.pointerMove=p;var q=function(a){return a.type==e.default.SINGLECLICK};c.singleClick=q;var r=function(a){return a.type==e.default.DBLCLICK};c.doubleClick=r;var s=function(a){var b=a.originalEvent;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&!b.shiftKey};c.noModifierKeys=s;var t=function(a){var b=a.originalEvent;return!b.altKey&&(h.MAC?b.metaKey:b.ctrlKey)&&!b.shiftKey};c.platformModifierKeyOnly=t;var u=function(a){var b=a.originalEvent;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey};c.shiftKeyOnly=u;var v=function(a){var b=a.originalEvent.target,c=b.tagName;return"INPUT"!==c&&"SELECT"!==c&&"TEXTAREA"!==c};c.targetNotEditable=v;var w=function(a){return f.assert(a.pointerEvent,56),"mouse"==a.pointerEvent.pointerType};c.mouseOnly=w;var x=function(a){var b=a.pointerEvent;return b.isPrimary&&0===b.button};c.primaryAction=x},{"../MapBrowserEventType.js":23,"../asserts.js":46,"../functions.js":76,"../has.js":109}],71:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){for(var b=n(),c=0,d=a.length;d>c;++c)w(b,a[c]);return b}function f(a,b,c){var d=Math.min.apply(null,a),e=Math.min.apply(null,b),f=Math.max.apply(null,a),g=Math.max.apply(null,b);return o(d,e,f,g,c)}function g(a,b,c){return c?(c[0]=a[0]-b,c[1]=a[1]-b,c[2]=a[2]+b,c[3]=a[3]+b,c):[a[0]-b,a[1]-b,a[2]+b,a[3]+b]}function h(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a.slice()}function i(a,b,c){var d,e;return d=b<a[0]?a[0]-b:a[2]<b?b-a[2]:0,e=c<a[1]?a[1]-c:a[3]<c?c-a[3]:0,d*d+e*e}function j(a,b){return l(a,b[0],b[1])}function k(a,b){return a[0]<=b[0]&&b[2]<=a[2]&&a[1]<=b[1]&&b[3]<=a[3]}function l(a,b,c){return a[0]<=b&&b<=a[2]&&a[1]<=c&&c<=a[3]}function m(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=b[0],h=b[1],i=Z.default.UNKNOWN;return c>g?i|=Z.default.LEFT:g>e&&(i|=Z.default.RIGHT),d>h?i|=Z.default.BELOW:h>f&&(i|=Z.default.ABOVE),i===Z.default.UNKNOWN&&(i=Z.default.INTERSECTING),i}function n(){return[1/0,1/0,-1/0,-1/0]}function o(a,b,c,d,e){return e?(e[0]=a,e[1]=b,e[2]=c,e[3]=d,e):[a,b,c,d]}function p(a){return o(1/0,1/0,-1/0,-1/0,a)}function q(a,b){var c=a[0],d=a[1];return o(c,d,c,d,b)}function r(a,b){var c=p(b);return x(c,a)}function s(a,b,c,d,e){var f=p(e);return y(f,a,b,c,d)}function t(a,b){var c=p(b);return z(c,a)}function u(a,b){return a[0]==b[0]&&a[2]==b[2]&&a[1]==b[1]&&a[3]==b[3]}function v(a,b){return b[0]<a[0]&&(a[0]=b[0]),b[2]>a[2]&&(a[2]=b[2]),b[1]<a[1]&&(a[1]=b[1]),b[3]>a[3]&&(a[3]=b[3]),a}function w(a,b){b[0]<a[0]&&(a[0]=b[0]),b[0]>a[2]&&(a[2]=b[0]),b[1]<a[1]&&(a[1]=b[1]),b[1]>a[3]&&(a[3]=b[1])}function x(a,b){for(var c=0,d=b.length;d>c;++c)w(a,b[c]);return a}function y(a,b,c,d,e){for(;d>c;c+=e)A(a,b[c],b[c+1]);return a}function z(a,b){for(var c=0,d=b.length;d>c;++c)x(a,b[c]);return a}function A(a,b,c){a[0]=Math.min(a[0],b),a[1]=Math.min(a[1],c),a[2]=Math.max(a[2],b),a[3]=Math.max(a[3],c)}function B(a,b,c){var d;return(d=b.call(c,D(a)))?d:(d=b.call(c,E(a)))?d:(d=b.call(c,P(a)))?d:(d=b.call(c,O(a)),d?d:!1)}function C(a){var b=0;return S(a)||(b=Q(a)*J(a)),b}function D(a){return[a[0],a[1]]}function E(a){return[a[2],a[1]]}function F(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]}function G(a,b){var c;return b===Y.default.BOTTOM_LEFT?c=D(a):b===Y.default.BOTTOM_RIGHT?c=E(a):b===Y.default.TOP_LEFT?c=O(a):b===Y.default.TOP_RIGHT?c=P(a):X.assert(!1,13),c}function H(a,b){var c=Math.min(a[0],b[0]),d=Math.min(a[1],b[1]),e=Math.max(a[2],b[2]),f=Math.max(a[3],b[3]);return(e-c)*(f-d)}function I(a,b,c,d,e){var f=b*d[0]/2,g=b*d[1]/2,h=Math.cos(c),i=Math.sin(c),j=f*h,k=f*i,l=g*h,m=g*i,n=a[0],p=a[1],q=n-j+m,r=n-j-m,s=n+j-m,t=n+j+m,u=p-k-l,v=p-k+l,w=p+k+l,x=p+k-l;return o(Math.min(q,r,s,t),Math.min(u,v,w,x),Math.max(q,r,s,t),Math.max(u,v,w,x),e)}function J(a){return a[3]-a[1]}function K(a,b){var c=L(a,b);return C(c)}function L(a,b,c){var d=c?c:n();return R(a,b)?(d[0]=a[0]>b[0]?a[0]:b[0],d[1]=a[1]>b[1]?a[1]:b[1],d[2]=a[2]<b[2]?a[2]:b[2],d[3]=a[3]<b[3]?a[3]:b[3]):p(d),d}function M(a){return Q(a)+J(a)}function N(a){return[a[2]-a[0],a[3]-a[1]]}function O(a){return[a[0],a[3]]}function P(a){return[a[2],a[3]]}function Q(a){return a[2]-a[0]}function R(a,b){return a[0]<=b[2]&&a[2]>=b[0]&&a[1]<=b[3]&&a[3]>=b[1]}function S(a){return a[2]<a[0]||a[3]<a[1]}function T(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a}function U(a,b){var c=(a[2]-a[0])/2*(b-1),d=(a[3]-a[1])/2*(b-1);a[0]-=c,a[2]+=c,a[1]-=d,a[3]+=d}function V(a,b,c){var d=!1,e=m(a,b),f=m(a,c);if(e===Z.default.INTERSECTING||f===Z.default.INTERSECTING)d=!0;else{var g,h,i=a[0],j=a[1],k=a[2],l=a[3],n=b[0],o=b[1],p=c[0],q=c[1],r=(q-o)/(p-n);f&Z.default.ABOVE&&!(e&Z.default.ABOVE)&&(g=p-(q-l)/r,d=g>=i&&k>=g),d||!(f&Z.default.RIGHT)||e&Z.default.RIGHT||(h=q-(p-k)*r,d=h>=j&&l>=h),d||!(f&Z.default.BELOW)||e&Z.default.BELOW||(g=p-(q-j)/r,d=g>=i&&k>=g),d||!(f&Z.default.LEFT)||e&Z.default.LEFT||(h=q-(p-i)*r,d=h>=j&&l>=h)
}return d}function W(a,b,c){var d=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]];b(d,d,2);var e=[d[0],d[2],d[4],d[6]],g=[d[1],d[3],d[5],d[7]];return f(e,g,c)}Object.defineProperty(c,"__esModule",{value:!0}),c.boundingExtent=e,c.buffer=g,c.clone=h,c.closestSquaredDistanceXY=i,c.containsCoordinate=j,c.containsExtent=k,c.containsXY=l,c.coordinateRelationship=m,c.createEmpty=n,c.createOrUpdate=o,c.createOrUpdateEmpty=p,c.createOrUpdateFromCoordinate=q,c.createOrUpdateFromCoordinates=r,c.createOrUpdateFromFlatCoordinates=s,c.createOrUpdateFromRings=t,c.equals=u,c.extend=v,c.extendCoordinate=w,c.extendCoordinates=x,c.extendFlatCoordinates=y,c.extendRings=z,c.extendXY=A,c.forEachCorner=B,c.getArea=C,c.getBottomLeft=D,c.getBottomRight=E,c.getCenter=F,c.getCorner=G,c.getEnlargedArea=H,c.getForViewAndSize=I,c.getHeight=J,c.getIntersectionArea=K,c.getIntersection=L,c.getMargin=M,c.getSize=N,c.getTopLeft=O,c.getTopRight=P,c.getWidth=Q,c.intersects=R,c.isEmpty=S,c.returnOrUpdate=T,c.scaleFromCenter=U,c.intersectsSegment=V,c.applyTransform=W;var X=a("./asserts.js"),Y=d(a("./extent/Corner.js")),Z=d(a("./extent/Relationship.js"))},{"./asserts.js":46,"./extent/Corner.js":72,"./extent/Relationship.js":73}],72:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};c.default=d},{}],73:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};c.default=d},{}],74:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d){return function(e,f,g){var i=new XMLHttpRequest;i.open("GET","function"==typeof a?a(e,f,g):a,!0),b.getType()==h.default.ARRAY_BUFFER&&(i.responseType="arraybuffer"),i.onload=function(){if(!i.status||i.status>=200&&i.status<300){var a,e=b.getType();e==h.default.JSON||e==h.default.TEXT?a=i.responseText:e==h.default.XML?(a=i.responseXML,a||(a=(new DOMParser).parseFromString(i.responseText,"application/xml"))):e==h.default.ARRAY_BUFFER&&(a=i.response),a?c.call(this,b.readFeatures(a,{featureProjection:g}),b.readProjection(a),b.getLastExtent()):d.call(this)}else d.call(this)}.bind(this),i.onerror=function(){d.call(this)}.bind(this),i.send()}}function f(a,b){return e(a,b,function(a){this.addFeatures(a)},g.VOID)}Object.defineProperty(c,"__esModule",{value:!0}),c.loadFeaturesXhr=e,c.xhr=f;var g=a("./functions.js"),h=d(a("./format/FormatType.js"))},{"./format/FormatType.js":75,"./functions.js":76}],75:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};c.default=d},{}],76:[function(a,b,c){"use strict";function d(){return!0}function e(){return!1}function f(){}Object.defineProperty(c,"__esModule",{value:!0}),c.TRUE=d,c.FALSE=e,c.VOID=f},{}],77:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Circle",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Geometry",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"LineString",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"MultiLineString",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"MultiPoint",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"MultiPolygon",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Point",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"Polygon",{enumerable:!0,get:function(){return l.default}});var e=d(a("./geom/Circle.js")),f=d(a("./geom/Geometry.js")),g=d(a("./geom/LineString.js")),h=d(a("./geom/MultiLineString.js")),i=d(a("./geom/MultiPoint.js")),j=d(a("./geom/MultiPolygon.js")),k=d(a("./geom/Point.js")),l=d(a("./geom/Polygon.js"))},{"./geom/Circle.js":78,"./geom/Geometry.js":79,"./geom/LineString.js":82,"./geom/MultiLineString.js":84,"./geom/MultiPoint.js":85,"./geom/MultiPolygon.js":86,"./geom/Point.js":87,"./geom/Polygon.js":88}],78:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=d(a("../geom/GeometryType.js")),g=d(a("../geom/SimpleGeometry.js")),h=a("../geom/flat/deflate.js"),i=function(a){function b(b,c,d){if(a.call(this),void 0!==d&&void 0===c)this.setFlatCoordinates(d,b);else{var e=c?c:0;this.setCenterAndRadius(b,e,d)}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),void 0,this.layout)},b.prototype.closestPointXY=function(a,b,c,d){var e=this.flatCoordinates,f=a-e[0],g=b-e[1],h=f*f+g*g;if(d>h){if(0===h)for(var i=0;i<this.stride;++i)c[i]=e[i];else{var j=this.getRadius()/Math.sqrt(h);c[0]=e[0]+j*f,c[1]=e[1]+j*g;for(var k=2;k<this.stride;++k)c[k]=e[k]}return c.length=this.stride,h}return d},b.prototype.containsXY=function(a,b){var c=this.flatCoordinates,d=a-c[0],e=b-c[1];return d*d+e*e<=this.getRadiusSquared_()},b.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},b.prototype.computeExtent=function(a){var b=this.flatCoordinates,c=b[this.stride]-b[0];return e.createOrUpdate(b[0]-c,b[1]-c,b[0]+c,b[1]+c,a)},b.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},b.prototype.getRadiusSquared_=function(){var a=this.flatCoordinates[this.stride]-this.flatCoordinates[0],b=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return a*a+b*b},b.prototype.getType=function(){return f.default.CIRCLE},b.prototype.intersectsExtent=function(a){var b=this.getExtent();if(e.intersects(a,b)){var c=this.getCenter();return a[0]<=c[0]&&a[2]>=c[0]?!0:a[1]<=c[1]&&a[3]>=c[1]?!0:e.forEachCorner(a,this.intersectsCoordinate,this)}return!1},b.prototype.setCenter=function(a){var b=this.stride,c=this.flatCoordinates[b]-this.flatCoordinates[0],d=a.slice();d[b]=d[0]+c;for(var e=1;b>e;++e)d[b+e]=a[e];this.setFlatCoordinates(this.layout,d),this.changed()},b.prototype.setCenterAndRadius=function(a,b,c){this.setLayout(c,a,0),this.flatCoordinates||(this.flatCoordinates=[]);var d=this.flatCoordinates,e=h.deflateCoordinate(d,0,a,this.stride);d[e++]=d[0]+b;for(var f=1,g=this.stride;g>f;++f)d[e++]=d[f];d.length=e,this.changed()},b.prototype.getCoordinates=function(){},b.prototype.setCoordinates=function(){},b.prototype.setRadius=function(a){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+a,this.changed()},b}(g.default);i.prototype.transform;var j=i;c.default=j},{"../extent.js":71,"../geom/GeometryType.js":81,"../geom/SimpleGeometry.js":89,"../geom/flat/deflate.js":94}],79:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Object.js")),f=a("../extent.js"),g=a("../functions.js"),h=a("../geom/flat/transform.js"),i=a("../proj.js"),j=d(a("../proj/Units.js")),k=a("../transform.js"),l=k.create(),m=function(a){function b(){a.call(this),this.extent_=f.createEmpty(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){},b.prototype.closestPointXY=function(){},b.prototype.getClosestPoint=function(a,b){var c=b?b:[0/0,0/0];return this.closestPointXY(a[0],a[1],c,1/0),c},b.prototype.intersectsCoordinate=function(a){return this.containsXY(a[0],a[1])},b.prototype.computeExtent=function(){},b.prototype.getExtent=function(a){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),f.returnOrUpdate(this.extent_,a)},b.prototype.rotate=function(){},b.prototype.scale=function(){},b.prototype.simplify=function(a){return this.getSimplifiedGeometry(a*a)},b.prototype.getSimplifiedGeometry=function(){},b.prototype.getType=function(){},b.prototype.applyTransform=function(){},b.prototype.intersectsExtent=function(){},b.prototype.translate=function(){},b.prototype.transform=function(a,b){a=i.get(a);var c=a.getUnits()==j.default.TILE_PIXELS?function(c,d,e){var g=a.getExtent(),j=a.getWorldExtent(),m=f.getHeight(j)/f.getHeight(g);return k.compose(l,j[0],j[3],m,-m,0,0,0),h.transform2D(c,0,c.length,e,l,d),i.getTransform(a,b)(c,d,e)}:i.getTransform(a,b);return this.applyTransform(c),this},b}(e.default);m.prototype.containsXY=g.FALSE;var n=m;c.default=n},{"../Object.js":28,"../extent.js":71,"../functions.js":76,"../geom/flat/transform.js":108,"../proj.js":158,"../proj/Units.js":160,"../transform.js":287}],80:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};c.default=d},{}],81:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};c.default=d},{}],82:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryLayout.js")),h=d(a("../geom/GeometryType.js")),i=d(a("../geom/SimpleGeometry.js")),j=a("../geom/flat/closest.js"),k=a("../geom/flat/deflate.js"),l=a("../geom/flat/inflate.js"),m=a("../geom/flat/interpolate.js"),n=a("../geom/flat/intersectsextent.js"),o=a("../geom/flat/length.js"),p=a("../geom/flat/segments.js"),q=a("../geom/flat/simplify.js"),r=function(a){function b(b,c){a.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===c||Array.isArray(b[0])?this.setCoordinates(b,c):this.setFlatCoordinates(c,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendCoordinate=function(a){this.flatCoordinates?e.extend(this.flatCoordinates,a):this.flatCoordinates=a.slice(),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout)},b.prototype.closestPointXY=function(a,b,c,d){return d<f.closestSquaredDistanceXY(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(j.maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),j.assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,a,b,c,d))},b.prototype.forEachSegment=function(a){return p.forEach(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)},b.prototype.getCoordinateAtM=function(a,b){if(this.layout!=g.default.XYM&&this.layout!=g.default.XYZM)return null;var c=void 0!==b?b:!1;return m.lineStringCoordinateAtM(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,c)},b.prototype.getCoordinates=function(){return l.inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getCoordinateAt=function(a,b){return m.interpolatePoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b)},b.prototype.getLength=function(){return o.lineStringLength(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[];return c.length=q.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,c,0),new b(c,g.default.XY)},b.prototype.getType=function(){return h.default.LINE_STRING},b.prototype.intersectsExtent=function(a){return n.intersectsLineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=k.deflateCoordinates(this.flatCoordinates,0,a,this.stride),this.changed()},b}(i.default),s=r;c.default=s},{"../array.js":45,"../extent.js":71,"../geom/GeometryLayout.js":80,"../geom/GeometryType.js":81,"../geom/SimpleGeometry.js":89,"../geom/flat/closest.js":92,"../geom/flat/deflate.js":94,"../geom/flat/inflate.js":96,"../geom/flat/interpolate.js":98,"../geom/flat/intersectsextent.js":99,"../geom/flat/length.js":100,"../geom/flat/segments.js":103,"../geom/flat/simplify.js":104}],83:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=d(a("../geom/GeometryLayout.js")),g=d(a("../geom/GeometryType.js")),h=d(a("../geom/SimpleGeometry.js")),i=a("../geom/flat/area.js"),j=a("../geom/flat/closest.js"),k=a("../geom/flat/deflate.js"),l=a("../geom/flat/inflate.js"),m=a("../geom/flat/simplify.js"),n=function(a){function b(b,c){a.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===c||Array.isArray(b[0])?this.setCoordinates(b,c):this.setFlatCoordinates(c,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout)},b.prototype.closestPointXY=function(a,b,c,d){return d<e.closestSquaredDistanceXY(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(j.maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),j.assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,a,b,c,d))},b.prototype.getArea=function(){return i.linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getCoordinates=function(){return l.inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[];return c.length=m.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,c,0),new b(c,f.default.XY)},b.prototype.getType=function(){return g.default.LINEAR_RING},b.prototype.intersectsExtent=function(){},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=k.deflateCoordinates(this.flatCoordinates,0,a,this.stride),this.changed()},b}(h.default),o=n;c.default=o},{"../extent.js":71,"../geom/GeometryLayout.js":80,"../geom/GeometryType.js":81,"../geom/SimpleGeometry.js":89,"../geom/flat/area.js":90,"../geom/flat/closest.js":92,"../geom/flat/deflate.js":94,"../geom/flat/inflate.js":96,"../geom/flat/simplify.js":104}],84:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryLayout.js")),h=d(a("../geom/GeometryType.js")),i=d(a("../geom/LineString.js")),j=d(a("../geom/SimpleGeometry.js")),k=a("../geom/flat/closest.js"),l=a("../geom/flat/deflate.js"),m=a("../geom/flat/inflate.js"),n=a("../geom/flat/interpolate.js"),o=a("../geom/flat/intersectsextent.js"),p=a("../geom/flat/simplify.js"),q=function(a){function b(b,c,d){if(a.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(b[0]))this.setCoordinates(b,c);else if(void 0!==c&&d)this.setFlatCoordinates(c,b),this.ends_=d;else{for(var f=this.getLayout(),g=[],h=[],i=0,j=b.length;j>i;++i){var k=b[i];0===i&&(f=k.getLayout()),e.extend(g,k.getFlatCoordinates()),h.push(g.length)}this.setFlatCoordinates(f,g),this.ends_=h}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendLineString=function(a){this.flatCoordinates?e.extend(this.flatCoordinates,a.getFlatCoordinates().slice()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},b.prototype.closestPointXY=function(a,b,c,d){return d<f.closestSquaredDistanceXY(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(k.arrayMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),k.assignClosestArrayPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,a,b,c,d))},b.prototype.getCoordinateAtM=function(a,b,c){if(this.layout!=g.default.XYM&&this.layout!=g.default.XYZM||0===this.flatCoordinates.length)return null;var d=void 0!==b?b:!1,e=void 0!==c?c:!1;return n.lineStringsCoordinateAtM(this.flatCoordinates,0,this.ends_,this.stride,a,d,e)},b.prototype.getCoordinates=function(){return m.inflateCoordinatesArray(this.flatCoordinates,0,this.ends_,this.stride)},b.prototype.getEnds=function(){return this.ends_},b.prototype.getLineString=function(a){return 0>a||this.ends_.length<=a?null:new i.default(this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]),this.layout)},b.prototype.getLineStrings=function(){for(var a=this.flatCoordinates,b=this.ends_,c=this.layout,d=[],e=0,f=0,g=b.length;g>f;++f){var h=b[f],j=new i.default(a.slice(e,h),c);d.push(j),e=h}return d},b.prototype.getFlatMidpoints=function(){for(var a=[],b=this.flatCoordinates,c=0,d=this.ends_,f=this.stride,g=0,h=d.length;h>g;++g){var i=d[g],j=n.interpolatePoint(b,c,i,f,.5);e.extend(a,j),c=i}return a},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[],d=[];return c.length=p.douglasPeuckerArray(this.flatCoordinates,0,this.ends_,this.stride,a,c,0,d),new b(c,g.default.XY,d)},b.prototype.getType=function(){return h.default.MULTI_LINE_STRING},b.prototype.intersectsExtent=function(a){return o.intersectsLineStringArray(this.flatCoordinates,0,this.ends_,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]);var c=l.deflateCoordinatesArray(this.flatCoordinates,0,a,this.stride,this.ends_);this.flatCoordinates.length=0===c.length?0:c[c.length-1],this.changed()},b}(j.default),r=q;c.default=r},{"../array.js":45,"../extent.js":71,"../geom/GeometryLayout.js":80,"../geom/GeometryType.js":81,"../geom/LineString.js":82,"../geom/SimpleGeometry.js":89,"../geom/flat/closest.js":92,"../geom/flat/deflate.js":94,"../geom/flat/inflate.js":96,"../geom/flat/interpolate.js":98,"../geom/flat/intersectsextent.js":99,"../geom/flat/simplify.js":104}],85:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryType.js")),h=d(a("../geom/Point.js")),i=d(a("../geom/SimpleGeometry.js")),j=a("../geom/flat/deflate.js"),k=a("../geom/flat/inflate.js"),l=a("../math.js"),m=function(a){function b(b,c){a.call(this),c&&!Array.isArray(b[0])?this.setFlatCoordinates(c,b):this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendPoint=function(a){this.flatCoordinates?e.extend(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.changed()},b.prototype.clone=function(){var a=new b(this.flatCoordinates.slice(),this.layout);return a},b.prototype.closestPointXY=function(a,b,c,d){if(d<f.closestSquaredDistanceXY(this.getExtent(),a,b))return d;for(var e=this.flatCoordinates,g=this.stride,h=0,i=e.length;i>h;h+=g){var j=l.squaredDistance(a,b,e[h],e[h+1]);if(d>j){d=j;for(var k=0;g>k;++k)c[k]=e[h+k];c.length=g}}return d},b.prototype.getCoordinates=function(){return k.inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getPoint=function(a){var b=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return 0>a||a>=b?null:new h.default(this.flatCoordinates.slice(a*this.stride,(a+1)*this.stride),this.layout)},b.prototype.getPoints=function(){for(var a=this.flatCoordinates,b=this.layout,c=this.stride,d=[],e=0,f=a.length;f>e;e+=c){var g=new h.default(a.slice(e,e+c),b);d.push(g)}return d},b.prototype.getType=function(){return g.default.MULTI_POINT},b.prototype.intersectsExtent=function(a){for(var b=this.flatCoordinates,c=this.stride,d=0,e=b.length;e>d;d+=c){var g=b[d],h=b[d+1];if(f.containsXY(a,g,h))return!0}return!1},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=j.deflateCoordinates(this.flatCoordinates,0,a,this.stride),this.changed()},b}(i.default),n=m;c.default=n},{"../array.js":45,"../extent.js":71,"../geom/GeometryType.js":81,"../geom/Point.js":87,"../geom/SimpleGeometry.js":89,"../geom/flat/deflate.js":94,"../geom/flat/inflate.js":96,"../math.js":147}],86:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryLayout.js")),h=d(a("../geom/GeometryType.js")),i=d(a("../geom/MultiPoint.js")),j=d(a("../geom/Polygon.js")),k=d(a("../geom/SimpleGeometry.js")),l=a("../geom/flat/area.js"),m=a("../geom/flat/center.js"),n=a("../geom/flat/closest.js"),o=a("../geom/flat/contains.js"),p=a("../geom/flat/deflate.js"),q=a("../geom/flat/inflate.js"),r=a("../geom/flat/interiorpoint.js"),s=a("../geom/flat/intersectsextent.js"),t=a("../geom/flat/orient.js"),u=a("../geom/flat/simplify.js"),v=function(a){function b(b,c,d){if(a.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!d&&!Array.isArray(b[0])){for(var f=this.getLayout(),g=[],h=[],i=0,j=b.length;j>i;++i){var k=b[i];0===i&&(f=k.getLayout());for(var l=g.length,m=k.getEnds(),n=0,o=m.length;o>n;++n)m[n]+=l;e.extend(g,k.getFlatCoordinates()),h.push(m)}c=f,b=g,d=h}void 0!==c&&d?(this.setFlatCoordinates(c,b),this.endss_=d):this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendPolygon=function(a){var b;if(this.flatCoordinates){var c=this.flatCoordinates.length;e.extend(this.flatCoordinates,a.getFlatCoordinates()),b=a.getEnds().slice();for(var d=0,f=b.length;f>d;++d)b[d]+=c}else this.flatCoordinates=a.getFlatCoordinates().slice(),b=a.getEnds().slice(),this.endss_.push();this.endss_.push(b),this.changed()},b.prototype.clone=function(){for(var a=this,c=this.endss_.length,d=new Array(c),e=0;c>e;++e)d[e]=a.endss_[e].slice();return new b(this.flatCoordinates.slice(),this.layout,d)},b.prototype.closestPointXY=function(a,b,c,d){return d<f.closestSquaredDistanceXY(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(n.multiArrayMaxSquaredDelta(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),n.assignClosestMultiArrayPoint(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,a,b,c,d))},b.prototype.containsXY=function(a,b){return o.linearRingssContainsXY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a,b)},b.prototype.getArea=function(){return l.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},b.prototype.getCoordinates=function(a){var b;return void 0!==a?(b=this.getOrientedFlatCoordinates().slice(),t.orientLinearRingsArray(b,0,this.endss_,this.stride,a)):b=this.flatCoordinates,q.inflateMultiCoordinatesArray(b,0,this.endss_,this.stride)},b.prototype.getEndss=function(){return this.endss_},b.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var a=m.linearRingss(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=r.getInteriorPointsOfMultiArray(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},b.prototype.getInteriorPoints=function(){return new i.default(this.getFlatInteriorPoints().slice(),g.default.XYM)},b.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;t.linearRingsAreOriented(a,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=t.orientLinearRingsArray(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[],d=[];return c.length=u.quantizeMultiArray(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(a),c,0,d),new b(c,g.default.XY,d)},b.prototype.getPolygon=function(a){if(0>a||this.endss_.length<=a)return null;var b;if(0===a)b=0;else{var c=this.endss_[a-1];b=c[c.length-1]}var d=this.endss_[a].slice(),e=d[d.length-1];if(0!==b)for(var f=0,g=d.length;g>f;++f)d[f]-=b;return new j.default(this.flatCoordinates.slice(b,e),this.layout,d)},b.prototype.getPolygons=function(){for(var a=this.layout,b=this.flatCoordinates,c=this.endss_,d=[],e=0,f=0,g=c.length;g>f;++f){var h=c[f].slice(),i=h[h.length-1];if(0!==e)for(var k=0,l=h.length;l>k;++k)h[k]-=e;var m=new j.default(b.slice(e,i),a,h);d.push(m),e=i}return d},b.prototype.getType=function(){return h.default.MULTI_POLYGON},b.prototype.intersectsExtent=function(a){return s.intersectsLinearRingMultiArray(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,3),this.flatCoordinates||(this.flatCoordinates=[]);var c=p.deflateMultiCoordinatesArray(this.flatCoordinates,0,a,this.stride,this.endss_);if(0===c.length)this.flatCoordinates.length=0;else{var d=c[c.length-1];this.flatCoordinates.length=0===d.length?0:d[d.length-1]}this.changed()},b}(k.default),w=v;c.default=w},{"../array.js":45,"../extent.js":71,"../geom/GeometryLayout.js":80,"../geom/GeometryType.js":81,"../geom/MultiPoint.js":85,"../geom/Polygon.js":88,"../geom/SimpleGeometry.js":89,"../geom/flat/area.js":90,"../geom/flat/center.js":91,"../geom/flat/closest.js":92,"../geom/flat/contains.js":93,"../geom/flat/deflate.js":94,"../geom/flat/inflate.js":96,"../geom/flat/interiorpoint.js":97,"../geom/flat/intersectsextent.js":99,"../geom/flat/orient.js":101,"../geom/flat/simplify.js":104}],87:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=d(a("../geom/GeometryType.js")),g=d(a("../geom/SimpleGeometry.js")),h=a("../geom/flat/deflate.js"),i=a("../math.js"),j=function(a){function b(b,c){a.call(this),this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){var a=new b(this.flatCoordinates.slice(),this.layout);return a},b.prototype.closestPointXY=function(a,b,c,d){var e=this.flatCoordinates,f=i.squaredDistance(a,b,e[0],e[1]);if(d>f){for(var g=this.stride,h=0;g>h;++h)c[h]=e[h];return c.length=g,f}return d},b.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},b.prototype.computeExtent=function(a){return e.createOrUpdateFromCoordinate(this.flatCoordinates,a)},b.prototype.getType=function(){return f.default.POINT},b.prototype.intersectsExtent=function(a){return e.containsXY(a,this.flatCoordinates[0],this.flatCoordinates[1])},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=h.deflateCoordinate(this.flatCoordinates,0,a,this.stride),this.changed()},b}(g.default),k=j;c.default=k},{"../extent.js":71,"../geom/GeometryType.js":81,"../geom/SimpleGeometry.js":89,"../geom/flat/deflate.js":94,"../math.js":147}],88:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d){for(var e=c?c:32,f=[],g=0;e>g;++g)i.extend(f,p.offset(a,b,2*Math.PI*g/e,d));return f.push(f[0],f[1]),new A(f,k.default.XY,[f.length])}function f(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=[b,c,b,e,d,e,d,c,b,c];return new A(f,k.default.XY,[f.length])}function g(a,b,c){for(var d=b?b:32,e=a.getStride(),f=a.getLayout(),g=a.getCenter(),i=e*(d+1),j=new Array(i),k=0;i>k;k+=e){j[k]=0,j[k+1]=0;for(var l=2;e>l;l++)j[k+l]=g[l]}var m=[j.length],n=new A(j,f,m);return h(n,g,a.getRadius(),c),n}function h(a,b,c,d){for(var e=a.getFlatCoordinates(),f=a.getStride(),g=e.length/f-1,h=d?d:0,i=0;g>=i;++i){var j=i*f,k=h+2*z.modulo(i,g)*Math.PI/g;e[j]=b[0]+c*Math.cos(k),e[j+1]=b[1]+c*Math.sin(k)}a.changed()}Object.defineProperty(c,"__esModule",{value:!0}),c.circular=e,c.fromExtent=f,c.fromCircle=g,c.makeRegular=h,c.default=void 0;var i=a("../array.js"),j=a("../extent.js"),k=d(a("../geom/GeometryLayout.js")),l=d(a("../geom/GeometryType.js")),m=d(a("../geom/LinearRing.js")),n=d(a("../geom/Point.js")),o=d(a("../geom/SimpleGeometry.js")),p=a("../sphere.js"),q=a("../geom/flat/area.js"),r=a("../geom/flat/closest.js"),s=a("../geom/flat/contains.js"),t=a("../geom/flat/deflate.js"),u=a("../geom/flat/inflate.js"),v=a("../geom/flat/interiorpoint.js"),w=a("../geom/flat/intersectsextent.js"),x=a("../geom/flat/orient.js"),y=a("../geom/flat/simplify.js"),z=a("../math.js"),A=function(a){function b(b,c,d){a.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==c&&d?(this.setFlatCoordinates(c,b),this.ends_=d):this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendLinearRing=function(a){this.flatCoordinates?i.extend(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},b.prototype.closestPointXY=function(a,b,c,d){return d<j.closestSquaredDistanceXY(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(r.arrayMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),r.assignClosestArrayPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,a,b,c,d))},b.prototype.containsXY=function(a,b){return s.linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,b)},b.prototype.getArea=function(){return q.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},b.prototype.getCoordinates=function(a){var b;return void 0!==a?(b=this.getOrientedFlatCoordinates().slice(),x.orientLinearRings(b,0,this.ends_,this.stride,a)):b=this.flatCoordinates,u.inflateCoordinatesArray(b,0,this.ends_,this.stride)},b.prototype.getEnds=function(){return this.ends_},b.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var a=j.getCenter(this.getExtent());this.flatInteriorPoint_=v.getInteriorPointOfArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},b.prototype.getInteriorPoint=function(){return new n.default(this.getFlatInteriorPoint(),k.default.XYM)
},b.prototype.getLinearRingCount=function(){return this.ends_.length},b.prototype.getLinearRing=function(a){return 0>a||this.ends_.length<=a?null:new m.default(this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]),this.layout)},b.prototype.getLinearRings=function(){for(var a=this.layout,b=this.flatCoordinates,c=this.ends_,d=[],e=0,f=0,g=c.length;g>f;++f){var h=c[f],i=new m.default(b.slice(e,h),a);d.push(i),e=h}return d},b.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;x.linearRingIsOriented(a,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=x.orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[],d=[];return c.length=y.quantizeArray(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(a),c,0,d),new b(c,k.default.XY,d)},b.prototype.getType=function(){return l.default.POLYGON},b.prototype.intersectsExtent=function(a){return w.intersectsLinearRingArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]);var c=t.deflateCoordinatesArray(this.flatCoordinates,0,a,this.stride,this.ends_);this.flatCoordinates.length=0===c.length?0:c[c.length-1],this.changed()},b}(o.default),B=A;c.default=B},{"../array.js":45,"../extent.js":71,"../geom/GeometryLayout.js":80,"../geom/GeometryType.js":81,"../geom/LinearRing.js":83,"../geom/Point.js":87,"../geom/SimpleGeometry.js":89,"../geom/flat/area.js":90,"../geom/flat/closest.js":92,"../geom/flat/contains.js":93,"../geom/flat/deflate.js":94,"../geom/flat/inflate.js":96,"../geom/flat/interiorpoint.js":97,"../geom/flat/intersectsextent.js":99,"../geom/flat/orient.js":101,"../geom/flat/simplify.js":104,"../math.js":147,"../sphere.js":259}],89:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b;return 2==a?b=k.default.XY:3==a?b=k.default.XYZ:4==a&&(b=k.default.XYZM),b}function f(a){var b;return a==k.default.XY?b=2:a==k.default.XYZ||a==k.default.XYM?b=3:a==k.default.XYZM&&(b=4),b}function g(a,b,c){var d=a.getFlatCoordinates();if(d){var e=a.getStride();return l.transform2D(d,0,d.length,e,b,c)}return null}Object.defineProperty(c,"__esModule",{value:!0}),c.getStrideForLayout=f,c.transformGeom2D=g,c.default=void 0;var h=a("../functions.js"),i=a("../extent.js"),j=d(a("../geom/Geometry.js")),k=d(a("../geom/GeometryLayout.js")),l=a("../geom/flat/transform.js"),m=a("../obj.js"),n=function(a){function b(){a.call(this),this.layout=k.default.XY,this.stride=2,this.flatCoordinates=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.computeExtent=function(a){return i.createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)},b.prototype.getCoordinates=function(){},b.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},b.prototype.getFlatCoordinates=function(){return this.flatCoordinates},b.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},b.prototype.getLayout=function(){return this.layout},b.prototype.getSimplifiedGeometry=function(a){if(this.simplifiedGeometryRevision!=this.getRevision()&&(m.clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),0>a||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var b=a.toString();if(this.simplifiedGeometryCache.hasOwnProperty(b))return this.simplifiedGeometryCache[b];var c=this.getSimplifiedGeometryInternal(a),d=c.getFlatCoordinates();return d.length<this.flatCoordinates.length?(this.simplifiedGeometryCache[b]=c,c):(this.simplifiedGeometryMaxMinSquaredTolerance=a,this)},b.prototype.getSimplifiedGeometryInternal=function(){return this},b.prototype.getStride=function(){return this.stride},b.prototype.setFlatCoordinates=function(a,b){this.stride=f(a),this.layout=a,this.flatCoordinates=b},b.prototype.setCoordinates=function(){},b.prototype.setLayout=function(a,b,c){var d,g=this;if(a)d=f(a);else{for(var h=0;c>h;++h){if(0===b.length)return g.layout=k.default.XY,void(g.stride=2);b=b[0]}d=b.length,a=e(d)}this.layout=a,this.stride=d},b.prototype.applyTransform=function(a){this.flatCoordinates&&(a(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},b.prototype.rotate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();l.rotate(c,0,c.length,d,a,b,c),this.changed()}},b.prototype.scale=function(a,b,c){var d=b;void 0===d&&(d=a);var e=c;e||(e=i.getCenter(this.getExtent()));var f=this.getFlatCoordinates();if(f){var g=this.getStride();l.scale(f,0,f.length,g,a,d,e,f),this.changed()}},b.prototype.translate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();l.translate(c,0,c.length,d,a,b,c),this.changed()}},b}(j.default);n.prototype.containsXY=h.FALSE;var o=n;c.default=o},{"../extent.js":71,"../functions.js":76,"../geom/Geometry.js":79,"../geom/GeometryLayout.js":80,"../geom/flat/transform.js":108,"../obj.js":149}],90:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];c>b;b+=d){var h=a[b],i=a[b+1];e+=g*h-f*i,f=h,g=i}return e/2}function e(a,b,c,e){for(var f=0,g=0,h=c.length;h>g;++g){var i=c[g];f+=d(a,b,i,e),b=i}return f}function f(a,b,c,d){for(var f=0,g=0,h=c.length;h>g;++g){var i=c[g];f+=e(a,b,i,d),b=i[i.length-1]}return f}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRing=d,c.linearRings=e,c.linearRingss=f},{}],91:[function(a,b,c){"use strict";function d(a,b,c,d){for(var f=[],g=e.createEmpty(),h=0,i=c.length;i>h;++h){var j=c[h];g=e.createOrUpdateFromFlatCoordinates(a,b,j[0],d),f.push((g[0]+g[2])/2,(g[1]+g[3])/2),b=j[j.length-1]}return f}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRingss=d;var e=a("../../extent.js")},{"../../extent.js":71}],92:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){var h,i=a[b],j=a[b+1],l=a[c]-i,m=a[c+1]-j;if(0===l&&0===m)h=b;else{var n=((e-i)*l+(f-j)*m)/(l*l+m*m);if(n>1)h=c;else{if(n>0){for(var o=0;d>o;++o)g[o]=k.lerp(a[b+o],a[c+o],n);return void(g.length=d)}h=b}}for(var p=0;d>p;++p)g[p]=a[h+p];g.length=d}function e(a,b,c,d,e){var f=a[b],g=a[b+1];for(b+=d;c>b;b+=d){var h=a[b],i=a[b+1],j=k.squaredDistance(f,g,h,i);j>e&&(e=j),f=h,g=i}return e}function f(a,b,c,d,f){for(var g=0,h=c.length;h>g;++g){var i=c[g];f=e(a,b,i,d,f),b=i}return f}function g(a,b,c,d,e){for(var g=0,h=c.length;h>g;++g){var i=c[g];e=f(a,b,i,d,e),b=i[i.length-1]}return e}function h(a,b,c,e,f,g,h,i,j,l,m){if(b==c)return l;var n,o;if(0===f){if(o=k.squaredDistance(h,i,a[b],a[b+1]),l>o){for(n=0;e>n;++n)j[n]=a[b+n];return j.length=e,o}return l}for(var p=m?m:[0/0,0/0],q=b+e;c>q;)if(d(a,q-e,q,e,h,i,p),o=k.squaredDistance(h,i,p[0],p[1]),l>o){for(l=o,n=0;e>n;++n)j[n]=p[n];j.length=e,q+=e}else q+=e*Math.max((Math.sqrt(o)-Math.sqrt(l))/f|0,1);if(g&&(d(a,c-e,b,e,h,i,p),o=k.squaredDistance(h,i,p[0],p[1]),l>o)){for(l=o,n=0;e>n;++n)j[n]=p[n];j.length=e}return l}function i(a,b,c,d,e,f,g,i,j,k,l){for(var m=l?l:[0/0,0/0],n=0,o=c.length;o>n;++n){var p=c[n];k=h(a,b,p,d,e,f,g,i,j,k,m),b=p}return k}function j(a,b,c,d,e,f,g,h,j,k,l){for(var m=l?l:[0/0,0/0],n=0,o=c.length;o>n;++n){var p=c[n];k=i(a,b,p,d,e,f,g,h,j,k,m),b=p[p.length-1]}return k}Object.defineProperty(c,"__esModule",{value:!0}),c.maxSquaredDelta=e,c.arrayMaxSquaredDelta=f,c.multiArrayMaxSquaredDelta=g,c.assignClosestPoint=h,c.assignClosestArrayPoint=i,c.assignClosestMultiArrayPoint=j;var k=a("../../math.js")},{"../../math.js":147}],93:[function(a,b,c){"use strict";function d(a,b,c,d,f){var g=h.forEachCorner(f,function(f){return!e(a,b,c,d,f[0],f[1])});return!g}function e(a,b,c,d,e,f){for(var g=0,h=a[c-d],i=a[c-d+1];c>b;b+=d){var j=a[b],k=a[b+1];f>=i?k>f&&(j-h)*(f-i)-(e-h)*(k-i)>0&&g++:f>=k&&0>(j-h)*(f-i)-(e-h)*(k-i)&&g--,h=j,i=k}return 0!==g}function f(a,b,c,d,f,g){if(0===c.length)return!1;if(!e(a,b,c[0],d,f,g))return!1;for(var h=1,i=c.length;i>h;++h)if(e(a,c[h-1],c[h],d,f,g))return!1;return!0}function g(a,b,c,d,e,g){if(0===c.length)return!1;for(var h=0,i=c.length;i>h;++h){var j=c[h];if(f(a,b,j,d,e,g))return!0;b=j[j.length-1]}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRingContainsExtent=d,c.linearRingContainsXY=e,c.linearRingsContainsXY=f,c.linearRingssContainsXY=g;var h=a("../../extent.js")},{"../../extent.js":71}],94:[function(a,b,c){"use strict";function d(a,b,c){for(var d=0,e=c.length;e>d;++d)a[b++]=c[d];return b}function e(a,b,c,d){for(var e=0,f=c.length;f>e;++e)for(var g=c[e],h=0;d>h;++h)a[b++]=g[h];return b}function f(a,b,c,d,f){for(var g=f?f:[],h=0,i=0,j=c.length;j>i;++i){var k=e(a,b,c[i],d);g[h++]=k,b=k}return g.length=h,g}function g(a,b,c,d,e){for(var g=e?e:[],h=0,i=0,j=c.length;j>i;++i){var k=f(a,b,c[i],d,g[h]);g[h++]=k,b=k[k.length-1]}return g.length=h,g}Object.defineProperty(c,"__esModule",{value:!0}),c.deflateCoordinate=d,c.deflateCoordinates=e,c.deflateCoordinatesArray=f,c.deflateMultiCoordinatesArray=g},{}],95:[function(a,b,c){"use strict";function d(a,b,c){for(var d,e,f,g,i,j,k=[],l=a(0),m=a(1),n=b(l),o=b(m),p=[m,l],q=[o,n],r=[1,0],s={},t=1e5;--t>0&&r.length>0;)f=r.pop(),l=p.pop(),n=q.pop(),j=f.toString(),j in s||(k.push(n[0],n[1]),s[j]=!0),g=r.pop(),m=p.pop(),o=q.pop(),i=(f+g)/2,d=a(i),e=b(d),h.squaredSegmentDistance(e[0],e[1],n[0],n[1],o[0],o[1])<c?(k.push(o[0],o[1]),j=g.toString(),s[j]=!0):(r.push(g,i,i,f),q.push(o,e,e,n),p.push(m,d,d,l));return k}function e(a,b,c,e,f,g){var j=i.get("EPSG:4326"),k=Math.cos(h.toRadians(b)),l=Math.sin(h.toRadians(b)),m=Math.cos(h.toRadians(e)),n=Math.sin(h.toRadians(e)),o=Math.cos(h.toRadians(c-a)),p=Math.sin(h.toRadians(c-a)),q=l*n+k*m*o;return d(function(b){if(q>=1)return[c,e];var d=b*Math.acos(q),f=Math.cos(d),g=Math.sin(d),i=p*m,j=k*n-l*m*o,r=Math.atan2(i,j),s=Math.asin(l*f+k*g*Math.cos(r)),t=h.toRadians(a)+Math.atan2(Math.sin(r)*g*k,f-l*Math.sin(s));return[h.toDegrees(t),h.toDegrees(s)]},i.getTransform(j,f),g)}function f(a,b,c,e,f){var g=i.get("EPSG:4326");return d(function(d){return[a,b+(c-b)*d]},i.getTransform(g,e),f)}function g(a,b,c,e,f){var g=i.get("EPSG:4326");return d(function(d){return[b+(c-b)*d,a]},i.getTransform(g,e),f)}Object.defineProperty(c,"__esModule",{value:!0}),c.greatCircleArc=e,c.meridian=f,c.parallel=g;var h=a("../../math.js"),i=a("../../proj.js")},{"../../math.js":147,"../../proj.js":158}],96:[function(a,b,c){"use strict";function d(a,b,c,d,e){for(var f=void 0!==e?e:[],g=0,h=b;c>h;h+=d)f[g++]=a.slice(h,h+d);return f.length=g,f}function e(a,b,c,e,f){for(var g=void 0!==f?f:[],h=0,i=0,j=c.length;j>i;++i){var k=c[i];g[h++]=d(a,b,k,e,g[h]),b=k}return g.length=h,g}function f(a,b,c,d,f){for(var g=void 0!==f?f:[],h=0,i=0,j=c.length;j>i;++i){var k=c[i];g[h++]=e(a,b,k,d,g[h]),b=k[k.length-1]}return g.length=h,g}Object.defineProperty(c,"__esModule",{value:!0}),c.inflateCoordinates=d,c.inflateCoordinatesArray=e,c.inflateMultiCoordinatesArray=f},{}],97:[function(a,b,c){"use strict";function d(a,b,c,d,e,h,i){for(var j,k,l,m,n,o,p,q=e[h+1],r=[],s=0,t=c.length;t>s;++s){var u=c[s];for(m=a[u-d],o=a[u-d+1],j=b;u>j;j+=d)n=a[j],p=a[j+1],(o>=q&&q>=p||q>=o&&p>=q)&&(l=(q-o)/(p-o)*(n-m)+m,r.push(l)),m=n,o=p}var v=0/0,w=-1/0;for(r.sort(f.numberSafeCompareFunction),m=r[0],j=1,k=r.length;k>j;++j){n=r[j];var x=Math.abs(n-m);x>w&&(l=(m+n)/2,g.linearRingsContainsXY(a,b,c,d,l,q)&&(v=l,w=x)),m=n}return isNaN(v)&&(v=e[h]),i?(i.push(v,q,w),i):[v,q,w]}function e(a,b,c,e,f){for(var g=[],h=0,i=c.length;i>h;++h){var j=c[h];g=d(a,b,j,e,f,2*h,g),b=j[j.length-1]}return g}Object.defineProperty(c,"__esModule",{value:!0}),c.getInteriorPointOfArray=d,c.getInteriorPointsOfMultiArray=e;var f=a("../../array.js"),g=a("../flat/contains.js")},{"../../array.js":45,"../flat/contains.js":93}],98:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){var i=0/0,j=0/0,k=(c-b)/d;if(1===k)i=a[b],j=a[b+1];else if(2==k)i=(1-e)*a[b]+e*a[b+d],j=(1-e)*a[b+1]+e*a[b+d+1];else if(0!==k){for(var l=a[b],m=a[b+1],n=0,o=[0],p=b+d;c>p;p+=d){var q=a[p],r=a[p+1];n+=Math.sqrt((q-l)*(q-l)+(r-m)*(r-m)),o.push(n),l=q,m=r}var s=e*n,t=g.binarySearch(o,s);if(0>t){var u=(s-o[-t-2])/(o[-t-1]-o[-t-2]),v=b+(-t-2)*d;i=h.lerp(a[v],a[v+d],u),j=h.lerp(a[v+1],a[v+d+1],u)}else i=a[b+t*d],j=a[b+t*d+1]}return f?(f[0]=i,f[1]=j,f):[i,j]}function e(a,b,c,d,e,f){if(c==b)return null;var g;if(e<a[b+d-1])return f?(g=a.slice(b,b+d),g[d-1]=e,g):null;if(a[c-1]<e)return f?(g=a.slice(c-d,c),g[d-1]=e,g):null;if(e==a[b+d-1])return a.slice(b,b+d);for(var i=b/d,j=c/d;j>i;){var k=i+j>>1;e<a[(k+1)*d-1]?j=k:i=k+1}var l=a[i*d-1];if(e==l)return a.slice((i-1)*d,(i-1)*d+d);var m=a[(i+1)*d-1],n=(e-l)/(m-l);g=[];for(var o=0;d-1>o;++o)g.push(h.lerp(a[(i-1)*d+o],a[i*d+o],n));return g.push(e),g}function f(a,b,c,d,f,g,h){if(h)return e(a,b,c[c.length-1],d,f,g);var i;if(f<a[d-1])return g?(i=a.slice(0,d),i[d-1]=f,i):null;if(a[a.length-1]<f)return g?(i=a.slice(a.length-d),i[d-1]=f,i):null;for(var j=0,k=c.length;k>j;++j){var l=c[j];if(b!=l){if(f<a[b+d-1])return null;if(f<=a[l-1])return e(a,b,l,d,f,!1);b=l}}return null}Object.defineProperty(c,"__esModule",{value:!0}),c.interpolatePoint=d,c.lineStringCoordinateAtM=e,c.lineStringsCoordinateAtM=f;var g=a("../../array.js"),h=a("../../math.js")},{"../../array.js":45,"../../math.js":147}],99:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=i.extendFlatCoordinates(i.createEmpty(),a,b,c,d);return i.intersects(e,f)?i.containsExtent(e,f)?!0:f[0]>=e[0]&&f[2]<=e[2]?!0:f[1]>=e[1]&&f[3]<=e[3]?!0:k.forEach(a,b,c,d,function(a,b){return i.intersectsSegment(e,a,b)}):!1}function e(a,b,c,e,f){for(var g=0,h=c.length;h>g;++g){if(d(a,b,c[g],e,f))return!0;b=c[g]}return!1}function f(a,b,c,e,f){return d(a,b,c,e,f)?!0:j.linearRingContainsXY(a,b,c,e,f[0],f[1])?!0:j.linearRingContainsXY(a,b,c,e,f[0],f[3])?!0:j.linearRingContainsXY(a,b,c,e,f[2],f[1])?!0:j.linearRingContainsXY(a,b,c,e,f[2],f[3])?!0:!1}function g(a,b,c,d,e){if(!f(a,b,c[0],d,e))return!1;if(1===c.length)return!0;for(var g=1,h=c.length;h>g;++g)if(j.linearRingContainsExtent(a,c[g-1],c[g],d,e))return!1;return!0}function h(a,b,c,d,e){for(var f=0,h=c.length;h>f;++f){var i=c[f];if(g(a,b,i,d,e))return!0;b=i[i.length-1]}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.intersectsLineString=d,c.intersectsLineStringArray=e,c.intersectsLinearRing=f,c.intersectsLinearRingArray=g,c.intersectsLinearRingMultiArray=h;var i=a("../../extent.js"),j=a("../flat/contains.js"),k=a("../flat/segments.js")},{"../../extent.js":71,"../flat/contains.js":93,"../flat/segments.js":103}],100:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=a[b],f=a[b+1],g=0,h=b+d;c>h;h+=d){var i=a[h],j=a[h+1];g+=Math.sqrt((i-e)*(i-e)+(j-f)*(j-f)),e=i,f=j}return g}function e(a,b,c,e){var f=d(a,b,c,e),g=a[c-e]-a[b],h=a[c-e+1]-a[b+1];return f+=Math.sqrt(g*g+h*h)}Object.defineProperty(c,"__esModule",{value:!0}),c.lineStringLength=d,c.linearRingLength=e},{}],101:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];c>b;b+=d){var h=a[b],i=a[b+1];e+=(h-f)*(i+g),f=h,g=i}return e>0}function e(a,b,c,e,f){for(var g=void 0!==f?f:!1,h=0,i=c.length;i>h;++h){var j=c[h],k=d(a,b,j,e);if(0===h){if(g&&k||!g&&!k)return!1}else if(g&&!k||!g&&k)return!1;b=j}return!0}function f(a,b,c,d,f){for(var g=0,h=c.length;h>g;++g)if(!e(a,b,c[g],d,f))return!1;return!0}function g(a,b,c,e,f){for(var g=void 0!==f?f:!1,h=0,j=c.length;j>h;++h){var k=c[h],l=d(a,b,k,e),m=0===h?g&&l||!g&&!l:g&&!l||!g&&l;m&&i.coordinates(a,b,k,e),b=k}return b}function h(a,b,c,d,e){for(var f=0,h=c.length;h>f;++f)b=g(a,b,c[f],d,e);return b}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRingIsClockwise=d,c.linearRingIsOriented=e,c.linearRingsAreOriented=f,c.orientLinearRings=g,c.orientLinearRingsArray=h;var i=a("../flat/reverse.js")},{"../flat/reverse.js":102}],102:[function(a,b,c){"use strict";function d(a,b,c,d){for(;c-d>b;){for(var e=0;d>e;++e){var f=a[b+e];a[b+e]=a[c-d+e],a[c-d+e]=f}b+=d,c-=d}}Object.defineProperty(c,"__esModule",{value:!0}),c.coordinates=d},{}],103:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){for(var g,h=[a[b],a[b+1]],i=[];c>b+d;b+=d){if(i[0]=a[b+d],i[1]=a[b+d+1],g=e.call(f,h,i))return g;h[0]=i[0],h[1]=i[1]}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.forEach=d},{}],104:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,i){var j=void 0!==i?i:[];return g||(c=h(a,b,c,d,f,j,0),a=j,b=0,d=2),j.length=e(a,b,c,d,f,j,0),j}function e(a,b,c,d,e,f,g){var h=(c-b)/d;if(3>h){for(;c>b;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var i=new Array(h);i[0]=1,i[h-1]=1;for(var j=[b,c-d],k=0;j.length>0;){for(var l=j.pop(),n=j.pop(),o=0,p=a[n],q=a[n+1],r=a[l],s=a[l+1],t=n+d;l>t;t+=d){var u=a[t],v=a[t+1],w=m.squaredSegmentDistance(u,v,p,q,r,s);w>o&&(k=t,o=w)}o>e&&(i[(k-b)/d]=1,k>n+d&&j.push(n,k),l>k+d&&j.push(k,l))}for(var x=0;h>x;++x)i[x]&&(f[g++]=a[b+x*d],f[g++]=a[b+x*d+1]);return g}function f(a,b,c,d,f,g,h,i){for(var j=0,k=c.length;k>j;++j){var l=c[j];h=e(a,b,l,d,f,g,h),i.push(h),b=l}return h}function g(a,b,c,d,e,g,h,i){for(var j=0,k=c.length;k>j;++j){var l=c[j],m=[];h=f(a,b,l,d,e,g,h,m),i.push(m),b=l[l.length-1]}return h}function h(a,b,c,d,e,f,g){if(b+d>=c){for(;c>b;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var h=a[b],i=a[b+1];f[g++]=h,f[g++]=i;var j=h,k=i;for(b+=d;c>b;b+=d)j=a[b],k=a[b+1],m.squaredDistance(h,i,j,k)>e&&(f[g++]=j,f[g++]=k,h=j,i=k);return(j!=h||k!=i)&&(f[g++]=j,f[g++]=k),g}function i(a,b){return b*Math.round(a/b)}function j(a,b,c,d,e,f,g){if(b==c)return g;var h=i(a[b],e),j=i(a[b+1],e);b+=d,f[g++]=h,f[g++]=j;var k,l;do if(k=i(a[b],e),l=i(a[b+1],e),b+=d,b==c)return f[g++]=k,f[g++]=l,g;while(k==h&&l==j);for(;c>b;){var m=i(a[b],e),n=i(a[b+1],e);if(b+=d,m!=k||n!=l){var o=k-h,p=l-j,q=m-h,r=n-j;o*r==p*q&&(0>o&&o>q||o==q||o>0&&q>o)&&(0>p&&p>r||p==r||p>0&&r>p)?(k=m,l=n):(f[g++]=k,f[g++]=l,h=k,j=l,k=m,l=n)}}return f[g++]=k,f[g++]=l,g}function k(a,b,c,d,e,f,g,h){for(var i=0,k=c.length;k>i;++i){var l=c[i];g=j(a,b,l,d,e,f,g),h.push(g),b=l}return g}function l(a,b,c,d,e,f,g,h){for(var i=0,j=c.length;j>i;++i){var l=c[i],m=[];g=k(a,b,l,d,e,f,g,m),h.push(m),b=l[l.length-1]}return g}Object.defineProperty(c,"__esModule",{value:!0}),c.simplifyLineString=d,c.douglasPeucker=e,c.douglasPeuckerArray=f,c.douglasPeuckerMultiArray=g,c.radialDistance=h,c.snap=i,c.quantize=j,c.quantizeArray=k,c.quantizeMultiArray=l;var m=a("../../math.js")},{"../../math.js":147}],105:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=c,q=c,r=0,s=0,t=c;for(g=c;d>g;g+=e){var u=b[g],v=b[g+1];void 0!==j&&(n=u-j,o=v-k,i=Math.sqrt(n*n+o*o),void 0!==l&&(s+=h,f=Math.acos((l*n+m*o)/(h*i)),f>a&&(s>r&&(r=s,p=t,q=g),s=0,t=g-e)),h=i,l=n,m=o),j=u,k=v}return s+=i,s>r?[t,g]:[p,q]}Object.defineProperty(c,"__esModule",{value:!0}),c.matchingChunk=d},{}],106:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i){var j=[],k=a[b]>a[c-d],l=f.length,m=a[b],n=a[b+1];b+=d;for(var o,p,q,r=a[b],s=a[b+1],t=0,u=Math.sqrt(Math.pow(r-m,2)+Math.pow(s-n,2)),v="",w=0,x=0;l>x;++x){p=k?l-x-1:x;var y=f.charAt(p);v=k?y+v:v+y;var z=g(v)-w;w+=z;for(var A=h+z/2;c-d>b&&A>t+u;)m=r,n=s,b+=d,r=a[b],s=a[b+1],t+=u,u=Math.sqrt(Math.pow(r-m,2)+Math.pow(s-n,2));var B=A-t,C=Math.atan2(s-n,r-m);if(k&&(C+=C>0?-Math.PI:Math.PI),void 0!==q){var D=C-q;if(D+=D>Math.PI?-2*Math.PI:D<-Math.PI?2*Math.PI:0,Math.abs(D)>i)return null}var E=B/u,F=e.lerp(m,r,E),G=e.lerp(n,s,E);q==C?(k&&(o[0]=F,o[1]=G,o[2]=z/2),o[4]=v):(v=y,w=z,o=[F,G,z/2,C,v],k?j.unshift(o):j.push(o),q=C),h+=z}return j}Object.defineProperty(c,"__esModule",{value:!0}),c.drawTextOnPath=d;var e=a("../../math.js")},{"../../math.js":147}],107:[function(a,b,c){"use strict";function d(a,b,c,d){var f=c-d;return a[b]===a[f]&&a[b+1]===a[f+1]&&(c-b)/d>3?!!e.linearRing(a,b,c,d):!1}Object.defineProperty(c,"__esModule",{value:!0}),c.lineStringIsClosed=d;var e=a("../flat/area.js")},{"../flat/area.js":90}],108:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){for(var g=f?f:[],h=0,i=b;c>i;i+=d){var j=a[i],k=a[i+1];g[h++]=e[0]*j+e[2]*k+e[4],g[h++]=e[1]*j+e[3]*k+e[5]}return f&&g.length!=h&&(g.length=h),g}function e(a,b,c,d,e,f,g){for(var h=g?g:[],i=Math.cos(e),j=Math.sin(e),k=f[0],l=f[1],m=0,n=b;c>n;n+=d){var o=a[n]-k,p=a[n+1]-l;h[m++]=k+o*i-p*j,h[m++]=l+o*j+p*i;for(var q=n+2;n+d>q;++q)h[m++]=a[q]}return g&&h.length!=m&&(h.length=m),h}function f(a,b,c,d,e,f,g,h){for(var i=h?h:[],j=g[0],k=g[1],l=0,m=b;c>m;m+=d){var n=a[m]-j,o=a[m+1]-k;i[l++]=j+e*n,i[l++]=k+f*o;for(var p=m+2;m+d>p;++p)i[l++]=a[p]}return h&&i.length!=l&&(i.length=l),i}function g(a,b,c,d,e,f,g){for(var h=g?g:[],i=0,j=b;c>j;j+=d){h[i++]=a[j]+e,h[i++]=a[j+1]+f;for(var k=j+2;j+d>k;++k)h[i++]=a[k]}return g&&h.length!=i&&(h.length=i),h}Object.defineProperty(c,"__esModule",{value:!0}),c.transform2D=d,c.rotate=e,c.scale=f,c.translate=g},{}],109:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"WEBGL",{enumerable:!0,get:function(){return d.HAS}}),c.MSPOINTER=c.POINTER=c.TOUCH=c.GEOLOCATION=c.CANVAS_LINE_DASH=c.DEVICE_PIXEL_RATIO=c.MAC=c.WEBKIT=c.SAFARI=c.FIREFOX=void 0;var d=a("./webgl.js"),e="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",f=-1!==e.indexOf("firefox");c.FIREFOX=f;var g=-1!==e.indexOf("safari")&&-1==e.indexOf("chrom");c.SAFARI=g;var h=-1!==e.indexOf("webkit")&&-1==e.indexOf("edge");c.WEBKIT=h;var i=-1!==e.indexOf("macintosh");c.MAC=i;var j=window.devicePixelRatio||1;c.DEVICE_PIXEL_RATIO=j;var k=function(){var a=!1;try{a=!!document.createElement("canvas").getContext("2d").setLineDash}catch(b){}return a}();c.CANVAS_LINE_DASH=k;var l="geolocation"in navigator;c.GEOLOCATION=l;var m="ontouchstart"in window;c.TOUCH=m;var n="PointerEvent"in window;c.POINTER=n;var o=!!navigator.msPointerEnabled;c.MSPOINTER=o},{"./webgl.js":291}],110:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"AssertionError",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Collection",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Disposable",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Feature",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Geolocation",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"Graticule",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"ImageBase",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"ImageCanvas",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"ImageTile",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"Kinetic",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"Map",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"MapBrowserEvent",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(c,"MapBrowserEventHandler",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"MapBrowserPointerEvent",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"MapEvent",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(c,"Object",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(c,"Observable",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(c,"Overlay",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(c,"PluggableMap",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(c,"Tile",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(c,"TileCache",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(c,"TileQueue",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(c,"TileRange",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(c,"VectorImageTile",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(c,"VectorTile",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(c,"View",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(c,"WebGLMap",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(c,"getUid",{enumerable:!0,get:function(){return G.getUid}}),Object.defineProperty(c,"inherits",{enumerable:!0,get:function(){return G.inherits}}),Object.defineProperty(c,"VERSION",{enumerable:!0,get:function(){return G.VERSION}});var e=d(a("./AssertionError.js")),f=d(a("./Collection.js")),g=d(a("./Disposable.js")),h=d(a("./Feature.js")),i=d(a("./Geolocation.js")),j=d(a("./Graticule.js")),k=d(a("./Image.js")),l=d(a("./ImageBase.js")),m=d(a("./ImageCanvas.js")),n=d(a("./ImageTile.js")),o=d(a("./Kinetic.js")),p=d(a("./Map.js")),q=d(a("./MapBrowserEvent.js")),r=d(a("./MapBrowserEventHandler.js")),s=d(a("./MapBrowserPointerEvent.js")),t=d(a("./MapEvent.js")),u=d(a("./Object.js")),v=d(a("./Observable.js")),w=d(a("./Overlay.js")),x=d(a("./PluggableMap.js")),y=d(a("./Tile.js")),z=d(a("./TileCache.js")),A=d(a("./TileQueue.js")),B=d(a("./TileRange.js")),C=d(a("./VectorImageTile.js")),D=d(a("./VectorTile.js")),E=d(a("./View.js")),F=d(a("./WebGLMap.js")),G=a("./util.js")},{"./AssertionError.js":5,"./Collection.js":6,"./Disposable.js":8,"./Feature.js":9,"./Geolocation.js":10,"./Graticule.js":12,"./Image.js":13,"./ImageBase.js":14,"./ImageCanvas.js":15,"./ImageTile.js":17,"./Kinetic.js":18,"./Map.js":20,"./MapBrowserEvent.js":21,"./MapBrowserEventHandler.js":22,"./MapBrowserPointerEvent.js":24,"./MapEvent.js":25,"./Object.js":28,"./Observable.js":30,"./Overlay.js":31,"./PluggableMap.js":33,"./Tile.js":34,"./TileCache.js":35,"./TileQueue.js":36,"./TileRange.js":37,"./VectorImageTile.js":39,"./VectorTile.js":40,"./View.js":41,"./WebGLMap.js":44,"./util.js":289}],111:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a?a:{},c=new f.default,d=new g.default(-.005,.05,100),e=void 0!==b.altShiftDragRotate?b.altShiftDragRotate:!0;e&&c.push(new j.default);var r=void 0!==b.doubleClickZoom?b.doubleClickZoom:!0;r&&c.push(new h.default({delta:b.zoomDelta,duration:b.zoomDuration}));var s=void 0!==b.dragPan?b.dragPan:!0;s&&c.push(new i.default({condition:b.onFocusOnly?q.focus:void 0,kinetic:d}));var t=void 0!==b.pinchRotate?b.pinchRotate:!0;t&&c.push(new o.default);var u=void 0!==b.pinchZoom?b.pinchZoom:!0;u&&c.push(new p.default({constrainResolution:b.constrainResolution,duration:b.zoomDuration}));var v=void 0!==b.keyboard?b.keyboard:!0;v&&(c.push(new l.default),c.push(new m.default({delta:b.zoomDelta,duration:b.zoomDuration})));var w=void 0!==b.mouseWheelZoom?b.mouseWheelZoom:!0;w&&c.push(new n.default({condition:b.onFocusOnly?q.focus:void 0,constrainResolution:b.constrainResolution,duration:b.zoomDuration}));var x=void 0!==b.shiftDragZoom?b.shiftDragZoom:!0;return x&&c.push(new k.default({duration:b.zoomDuration})),c}Object.defineProperty(c,"__esModule",{value:!0}),c.defaults=e,Object.defineProperty(c,"DoubleClickZoom",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"DragPan",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"DragRotate",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"DragZoom",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"KeyboardPan",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"KeyboardZoom",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"MouseWheelZoom",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"PinchRotate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"PinchZoom",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"DragAndDrop",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"DragBox",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"DragRotateAndZoom",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(c,"Draw",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(c,"Extent",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(c,"Interaction",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(c,"Modify",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(c,"Pointer",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(c,"Select",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(c,"Snap",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(c,"Translate",{enumerable:!0,get:function(){return B.default}});var f=d(a("./Collection.js")),g=d(a("./Kinetic.js")),h=d(a("./interaction/DoubleClickZoom.js")),i=d(a("./interaction/DragPan.js")),j=d(a("./interaction/DragRotate.js")),k=d(a("./interaction/DragZoom.js")),l=d(a("./interaction/KeyboardPan.js")),m=d(a("./interaction/KeyboardZoom.js")),n=d(a("./interaction/MouseWheelZoom.js")),o=d(a("./interaction/PinchRotate.js")),p=d(a("./interaction/PinchZoom.js")),q=a("./events/condition.js"),r=d(a("./interaction/DragAndDrop.js")),s=d(a("./interaction/DragBox.js")),t=d(a("./interaction/DragRotateAndZoom.js")),u=d(a("./interaction/Draw.js")),v=d(a("./interaction/Extent.js")),w=d(a("./interaction/Interaction.js")),x=d(a("./interaction/Modify.js")),y=d(a("./interaction/Pointer.js")),z=d(a("./interaction/Select.js")),A=d(a("./interaction/Snap.js")),B=d(a("./interaction/Translate.js"))},{"./Collection.js":6,"./Kinetic.js":18,"./events/condition.js":70,"./interaction/DoubleClickZoom.js":112,"./interaction/DragAndDrop.js":113,"./interaction/DragBox.js":114,"./interaction/DragPan.js":115,"./interaction/DragRotate.js":116,"./interaction/DragRotateAndZoom.js":117,"./interaction/DragZoom.js":118,"./interaction/Draw.js":119,"./interaction/Extent.js":120,"./interaction/Interaction.js":121,"./interaction/KeyboardPan.js":122,"./interaction/KeyboardZoom.js":123,"./interaction/Modify.js":124,"./interaction/MouseWheelZoom.js":125,"./interaction/PinchRotate.js":126,"./interaction/PinchZoom.js":127,"./interaction/Pointer.js":128,"./interaction/Select.js":130,"./interaction/Snap.js":131,"./interaction/Translate.js":132}],112:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=!1,c=a.originalEvent;if(a.type==g.default.DBLCLICK){var d=a.map,e=a.coordinate,f=c.shiftKey?-this.delta_:this.delta_,i=d.getView();h.zoomByDelta(i,f,e,this.duration_),a.preventDefault(),b=!0}return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=e(a("../MapBrowserEventType.js")),h=d(a("../interaction/Interaction.js")),i=function(a){function b(b){a.call(this,{handleEvent:f});var c=b?b:{};this.delta_=c.delta?c.delta:1,this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default),j=i;c.default=j},{"../MapBrowserEventType.js":23,"../interaction/Interaction.js":121}],113:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){for(var b=this,c=a.dataTransfer.files,d=0,e=c.length;e>d;++d){var f=c.item(d),g=new FileReader;g.addEventListener(j.default.LOAD,b.handleResult_.bind(b,f)),g.readAsText(f)
}}function f(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=a("../functions.js"),h=a("../events.js"),i=d(a("../events/Event.js")),j=d(a("../events/EventType.js")),k=d(a("../interaction/Interaction.js")),l=a("../proj.js"),m={ADD_FEATURES:"addfeatures"},n=function(a){function b(b,c,d,e){a.call(this,b),this.features=d,this.file=c,this.projection=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),o=function(a){function b(b){var c=b?b:{};a.call(this,{handleEvent:g.TRUE}),this.formatConstructors_=c.formatConstructors?c.formatConstructors:[],this.projection_=c.projection?l.get(c.projection):null,this.dropListenKeys_=null,this.source_=c.source||null,this.target=c.target?c.target:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleResult_=function(a,b){var c=this,d=b.target.result,e=this.getMap(),f=this.projection_;if(!f){var g=e.getView();f=g.getProjection()}for(var h=this.formatConstructors_,i=[],j=0,k=h.length;k>j;++j){var l=h[j],o=new l;if(i=c.tryReadFeatures_(o,d,{featureProjection:f}),i&&i.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(i)),this.dispatchEvent(new n(m.ADD_FEATURES,a,i,f))},b.prototype.registerListeners_=function(){var a=this.getMap();if(a){var b=this.target?this.target:a.getViewport();this.dropListenKeys_=[h.listen(b,j.default.DROP,e,this),h.listen(b,j.default.DRAGENTER,f,this),h.listen(b,j.default.DRAGOVER,f,this),h.listen(b,j.default.DROP,f,this)]}},b.prototype.setActive=function(b){a.prototype.setActive.call(this,b),b?this.registerListeners_():this.unregisterListeners_()},b.prototype.setMap=function(b){this.unregisterListeners_(),a.prototype.setMap.call(this,b),this.getActive()&&this.registerListeners_()},b.prototype.tryReadFeatures_=function(a,b,c){try{return a.readFeatures(b,c)}catch(d){return null}},b.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(h.unlistenByKey),this.dropListenKeys_=null)},b}(k.default),p=o;c.default=p},{"../events.js":65,"../events/Event.js":66,"../events/EventType.js":67,"../functions.js":76,"../interaction/Interaction.js":121,"../proj.js":158}],114:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=c[0]-b[0],e=c[1]-b[1];return d*d+e*e>=this.minArea_}function f(a){j.mouseOnly(a)&&(this.box_.setPixels(this.startPixel_,a.pixel),this.dispatchEvent(new o(n.BOXDRAG,a.coordinate,a)))}function g(a){return j.mouseOnly(a)?(this.box_.setMap(null),this.boxEndCondition_(a,this.startPixel_,a.pixel)&&(this.onBoxEnd_(a),this.dispatchEvent(new o(n.BOXEND,a.coordinate,a))),!1):!0}function h(a){return j.mouseOnly(a)&&j.mouseActionButton(a)&&this.condition_(a)?(this.startPixel_=a.pixel,this.box_.setMap(a.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new o(n.BOXSTART,a.coordinate,a)),!0):!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=d(a("../events/Event.js")),j=a("../events/condition.js"),k=a("../functions.js"),l=d(a("../interaction/Pointer.js")),m=d(a("../render/Box.js")),n={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},o=function(a){function b(b,c,d){a.call(this,b),this.coordinate=c,this.mapBrowserEvent=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),p=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g});var c=b?b:{};this.box_=new m.default(c.className||"ol-dragbox"),this.minArea_=void 0!==c.minArea?c.minArea:64,this.onBoxEnd_=c.onBoxEnd?c.onBoxEnd:k.VOID,this.startPixel_=null,this.condition_=c.condition?c.condition:j.always,this.boxEndCondition_=c.boxEndCondition?c.boxEndCondition:e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getGeometry=function(){return this.box_.getGeometry()},b}(l.default),q=p;c.default=q},{"../events/Event.js":66,"../events/condition.js":70,"../functions.js":76,"../interaction/Pointer.js":128,"../render/Box.js":166}],115:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){this.panning_||(this.panning_=!0,this.getMap().getView().setHint(i.default.INTERACTING,1));var b=this.targetPointers,c=n.centroid(b);if(b.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(c[0],c[1]),this.lastCentroid){var d=this.lastCentroid[0]-c[0],e=c[1]-this.lastCentroid[1],f=a.map,g=f.getView(),h=[d,e];j.scale(h,g.getResolution()),j.rotate(h,g.getRotation()),j.add(h,g.getCenter()),h=g.constrainCenter(h),g.setCenter(h)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=c,this.lastPointersCount_=b.length}function g(a){var b=a.map,c=b.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var d=this.kinetic_.getDistance(),e=this.kinetic_.getAngle(),f=c.getCenter(),g=b.getPixelFromCoordinate(f),h=b.getCoordinateFromPixel([g[0]-d*Math.cos(e),g[1]-d*Math.sin(e)]);c.animate({center:c.constrainCenter(h),duration:500,easing:k.easeOut})}return this.panning_&&(this.panning_=!1,c.setHint(i.default.INTERACTING,-1)),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function h(a){if(this.targetPointers.length>0&&this.condition_(a)){var b=a.map,c=b.getView();return this.lastCentroid=null,c.getAnimating()&&c.setCenter(a.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=e(a("../ViewHint.js")),j=a("../coordinate.js"),k=a("../easing.js"),l=a("../events/condition.js"),m=a("../functions.js"),n=d(a("../interaction/Pointer.js")),o=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g,stopDown:m.FALSE});var c=b?b:{};this.kinetic_=c.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1,this.condition_=c.condition?c.condition:l.noModifierKeys,this.noKinetic_=!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(n.default),p=o;c.default=p},{"../ViewHint.js":42,"../coordinate.js":61,"../easing.js":64,"../events/condition.js":70,"../functions.js":76,"../interaction/Pointer.js":128}],116:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(j.mouseOnly(a)){var b=a.map,c=b.getView();if(c.getConstraints().rotation!==h.disable){var d=b.getSize(),e=a.pixel,f=Math.atan2(d[1]/2-e[1],e[0]-d[0]/2);if(void 0!==this.lastAngle_){var g=f-this.lastAngle_,i=c.getRotation();l.rotateWithoutConstraints(c,i-g)}this.lastAngle_=f}}}function f(a){if(!j.mouseOnly(a))return!0;var b=a.map,c=b.getView();c.setHint(i.default.INTERACTING,-1);var d=c.getRotation();return l.rotate(c,d,void 0,this.duration_),!1}function g(a){if(!j.mouseOnly(a))return!1;if(j.mouseActionButton(a)&&this.condition_(a)){var b=a.map;return b.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=a("../rotationconstraint.js"),i=d(a("../ViewHint.js")),j=a("../events/condition.js"),k=a("../functions.js"),l=a("../interaction/Interaction.js"),m=d(a("../interaction/Pointer.js")),n=function(a){function b(b){var c=b?b:{};a.call(this,{handleDownEvent:g,handleDragEvent:e,handleUpEvent:f,stopDown:k.FALSE}),this.condition_=c.condition?c.condition:j.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m.default),o=n;c.default=o},{"../ViewHint.js":42,"../events/condition.js":70,"../functions.js":76,"../interaction/Interaction.js":121,"../interaction/Pointer.js":128,"../rotationconstraint.js":225}],117:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(j.mouseOnly(a)){var b=a.map,c=b.getSize(),d=a.pixel,e=d[0]-c[0]/2,f=c[1]/2-d[1],g=Math.atan2(f,e),i=Math.sqrt(e*e+f*f),l=b.getView();if(l.getConstraints().rotation!==h.disable&&void 0!==this.lastAngle_){var m=g-this.lastAngle_;k.rotateWithoutConstraints(l,l.getRotation()-m)}if(this.lastAngle_=g,void 0!==this.lastMagnitude_){var n=this.lastMagnitude_*(l.getResolution()/i);k.zoomWithoutConstraints(l,n)}void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/i),this.lastMagnitude_=i}}function f(a){if(!j.mouseOnly(a))return!0;var b=a.map,c=b.getView();c.setHint(i.default.INTERACTING,-1);var d=this.lastScaleDelta_-1;return k.rotate(c,c.getRotation()),k.zoom(c,c.getResolution(),void 0,this.duration_,d),this.lastScaleDelta_=0,!1}function g(a){return j.mouseOnly(a)&&this.condition_(a)?(a.map.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0):!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=a("../rotationconstraint.js"),i=d(a("../ViewHint.js")),j=a("../events/condition.js"),k=a("../interaction/Interaction.js"),l=d(a("../interaction/Pointer.js")),m=function(a){function b(b){var c=b?b:{};a.call(this,{handleDownEvent:g,handleDragEvent:e,handleUpEvent:f}),this.condition_=c.condition?c.condition:j.shiftKeyOnly,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=void 0!==c.duration?c.duration:400}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default),n=m;c.default=n},{"../ViewHint.js":42,"../events/condition.js":70,"../interaction/Interaction.js":121,"../interaction/Pointer.js":128,"../rotationconstraint.js":225}],118:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){var a=this.getMap(),b=a.getView(),c=a.getSize(),d=this.getGeometry().getExtent();if(this.out_){var e=b.calculateExtent(c),g=h.createOrUpdateFromCoordinates([a.getPixelFromCoordinate(h.getBottomLeft(d)),a.getPixelFromCoordinate(h.getTopRight(d))]),i=b.getResolutionForExtent(g,c);h.scaleFromCenter(e,1/i),d=e}var j=b.constrainResolution(b.getResolutionForExtent(d,c)),k=h.getCenter(d);k=b.constrainCenter(k),b.animate({resolution:j,center:k,duration:this.duration_,easing:f.easeOut})}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../easing.js"),g=a("../events/condition.js"),h=a("../extent.js"),i=d(a("../interaction/DragBox.js")),j=function(a){function b(b){var c=b?b:{},d=c.condition?c.condition:g.shiftKeyOnly;a.call(this,{condition:d,className:c.className||"ol-dragzoom",onBoxEnd:e}),this.duration_=void 0!==c.duration?c.duration:200,this.out_=void 0!==c.out?c.out:!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),k=j;c.default=k},{"../easing.js":64,"../events/condition.js":70,"../extent.js":71,"../interaction/DragBox.js":114}],119:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(){var a=K.createEditingStyle();return function(b){return a[b.getGeometry().getType()]}}function g(a){a.originalEvent.type===m.default.CONTEXTMENU&&a.preventDefault(),this.freehand_=this.mode_!==L.POINT&&this.freehandCondition_(a);var b=a.type===o.default.POINTERMOVE,c=!0;if(this.lastDragTime_&&a.type===o.default.POINTERDRAG){var d=Date.now();d-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=a.pixel,this.shouldHandle_=!this.freehand_,b=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&a.type===o.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(a),c=!1):this.freehand_&&a.type===o.default.POINTERDOWN?c=!1:b?(c=a.type===o.default.POINTERMOVE,c&&this.freehand_?c=this.handlePointerMove_(a):(a.pointerEvent.pointerType==D.POINTER_TYPE||a.type===o.default.POINTERDRAG&&!this.downTimeout_)&&this.handlePointerMove_(a)):a.type===o.default.DBLCLICK&&(c=!1),G.handleEvent.call(this,a)&&c}function h(a){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=a.pixel,this.finishCoordinate_||this.startDrawing_(a),!0):this.condition_(a)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new p.default(o.default.POINTERMOVE,a.map,a.pointerEvent,a.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=a.pixel,!0):!1}function i(a){var b=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(a);var c=this.mode_===L.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||c?this.finishDrawing():this.atFinish_(a)?this.finishCondition_(a)&&this.finishDrawing():this.addToDrawing_(a):(this.startDrawing_(a),this.mode_===L.POINT&&this.finishDrawing()),b=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!b&&this.stopClick_&&a.stopPropagation(),b}function j(a,b){return function(c,d){var e=c[0],f=c[1],g=Math.sqrt(r.squaredDistance(e,f)),h=d?d:F.fromCircle(new x.default(e),a),i=b;if(!b){var j=f[0]-e[0],k=f[1]-e[1];i=Math.atan(k/j)-(0>j?Math.PI:0)}return F.makeRegular(h,e,g,i),h}}function k(){return function(a,b){var c=v.boundingExtent(a),d=[[v.getBottomLeft(c),v.getBottomRight(c),v.getTopRight(c),v.getTopLeft(c),v.getBottomLeft(c)]],e=b;return e?e.setCoordinates(d):e=new F.default(d),e}}function l(a){var b;return a===y.default.POINT||a===y.default.MULTI_POINT?b=L.POINT:a===y.default.LINE_STRING||a===y.default.MULTI_LINE_STRING?b=L.LINE_STRING:a===y.default.POLYGON||a===y.default.MULTI_POLYGON?b=L.POLYGON:a===y.default.CIRCLE&&(b=L.CIRCLE),b}Object.defineProperty(c,"__esModule",{value:!0}),c.handleEvent=g,c.createRegularPolygon=j,c.createBox=k,c.default=void 0;var m=e(a("../events/EventType.js")),n=e(a("../Feature.js")),o=e(a("../MapBrowserEventType.js")),p=e(a("../MapBrowserPointerEvent.js")),q=a("../Object.js"),r=a("../coordinate.js"),s=a("../events.js"),t=e(a("../events/Event.js")),u=a("../events/condition.js"),v=a("../extent.js"),w=a("../functions.js"),x=e(a("../geom/Circle.js")),y=e(a("../geom/GeometryType.js")),z=e(a("../geom/LineString.js")),A=e(a("../geom/MultiLineString.js")),B=e(a("../geom/MultiPoint.js")),C=e(a("../geom/MultiPolygon.js")),D=a("../pointer/MouseSource.js"),E=e(a("../geom/Point.js")),F=d(a("../geom/Polygon.js")),G=d(a("../interaction/Pointer.js")),H=e(a("../interaction/Property.js")),I=e(a("../layer/Vector.js")),J=e(a("../source/Vector.js")),K=a("../style/Style.js"),L={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},M={DRAWSTART:"drawstart",DRAWEND:"drawend"},N=function(a){function b(b,c){a.call(this,b),this.feature=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(t.default),O=function(a){function b(b){a.call(this,{handleDownEvent:h,handleEvent:g,handleUpEvent:i,stopDown:w.FALSE}),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=b.source?b.source:null,this.features_=b.features?b.features:null,this.snapTolerance_=b.snapTolerance?b.snapTolerance:12,this.type_=b.type,this.mode_=l(this.type_),this.stopClick_=!!b.stopClick,this.minPoints_=b.minPoints?b.minPoints:this.mode_===L.POLYGON?3:2,this.maxPoints_=b.maxPoints?b.maxPoints:1/0,this.finishCondition_=b.finishCondition?b.finishCondition:w.TRUE;var c=b.geometryFunction;if(!c)if(this.type_===y.default.CIRCLE)c=function(a,b){var c=b?b:new x.default([0/0,0/0]),d=r.squaredDistance(a[0],a[1]);return c.setCenterAndRadius(a[0],Math.sqrt(d)),c};else{var d,e=this.mode_;e===L.POINT?d=E.default:e===L.LINE_STRING?d=z.default:e===L.POLYGON&&(d=F.default),c=function(a,b){var c=b;return c?c.setCoordinates(e===L.POLYGON?a[0].length?[a[0].concat([a[0][0]])]:[]:a):c=new d(a),c}}this.geometryFunction_=c,this.dragVertexDelay_=void 0!==b.dragVertexDelay?b.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=b.clickTolerance?b.clickTolerance*b.clickTolerance:36,this.overlay_=new I.default({source:new J.default({useSpatialIndex:!1,wrapX:b.wrapX?b.wrapX:!1}),style:b.style?b.style:f(),updateWhileInteracting:!0}),this.geometryName_=b.geometryName,this.condition_=b.condition?b.condition:u.noModifierKeys,this.freehandCondition_,this.freehandCondition_=b.freehand?u.always:b.freehandCondition?b.freehandCondition:u.shiftKeyOnly,s.listen(this,q.getChangeEventType(H.default.ACTIVE),this.updateState_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setMap=function(b){a.prototype.setMap.call(this,b),this.updateState_()},b.prototype.getOverlay=function(){return this.overlay_},b.prototype.handlePointerMove_=function(a){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var b=this.downPx_,c=a.pixel,d=b[0]-c[0],e=b[1]-c[1],f=d*d+e*e;if(this.shouldHandle_=this.freehand_?f>this.squaredClickTolerance_:f<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(a):this.createOrUpdateSketchPoint_(a),!0},b.prototype.atFinish_=function(a){var b=this,c=!1;if(this.sketchFeature_){var d=!1,e=[this.finishCoordinate_];if(this.mode_===L.LINE_STRING?d=this.sketchCoords_.length>this.minPoints_:this.mode_===L.POLYGON&&(d=this.sketchCoords_[0].length>this.minPoints_,e=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]),d)for(var f=a.map,g=0,h=e.length;h>g;g++){var i=e[g],j=f.getPixelFromCoordinate(i),k=a.pixel,l=k[0]-j[0],m=k[1]-j[1],n=b.freehand_?1:b.snapTolerance_;if(c=Math.sqrt(l*l+m*m)<=n){b.finishCoordinate_=i;break}}}return c},b.prototype.createOrUpdateSketchPoint_=function(a){var b=a.coordinate.slice();if(this.sketchPoint_){var c=this.sketchPoint_.getGeometry();c.setCoordinates(b)}else this.sketchPoint_=new n.default(new E.default(b)),this.updateSketchFeatures_()},b.prototype.startDrawing_=function(a){var b=a.coordinate;this.finishCoordinate_=b,this.mode_===L.POINT?this.sketchCoords_=b.slice():this.mode_===L.POLYGON?(this.sketchCoords_=[[b.slice(),b.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[b.slice(),b.slice()],this.sketchLineCoords_&&(this.sketchLine_=new n.default(new z.default(this.sketchLineCoords_)));var c=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new n.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(c),this.updateSketchFeatures_(),this.dispatchEvent(new N(M.DRAWSTART,this.sketchFeature_))},b.prototype.modifyDrawing_=function(a){var b,c,d=a.coordinate,e=this.sketchFeature_.getGeometry();if(this.mode_===L.POINT?c=this.sketchCoords_:this.mode_===L.POLYGON?(b=this.sketchCoords_[0],c=b[b.length-1],this.atFinish_(a)&&(d=this.finishCoordinate_.slice())):(b=this.sketchCoords_,c=b[b.length-1]),c[0]=d[0],c[1]=d[1],this.geometryFunction_(this.sketchCoords_,e),this.sketchPoint_){var f=this.sketchPoint_.getGeometry();f.setCoordinates(d)}var g;if(e instanceof F.default&&this.mode_!==L.POLYGON){this.sketchLine_||(this.sketchLine_=new n.default);var h=e.getLinearRing(0);g=this.sketchLine_.getGeometry(),g?(g.setFlatCoordinates(h.getLayout(),h.getFlatCoordinates()),g.changed()):(g=new z.default(h.getFlatCoordinates(),h.getLayout()),this.sketchLine_.setGeometry(g))}else this.sketchLineCoords_&&(g=this.sketchLine_.getGeometry(),g.setCoordinates(this.sketchLineCoords_));this.updateSketchFeatures_()},b.prototype.addToDrawing_=function(a){var b,c,d=a.coordinate,e=this.sketchFeature_.getGeometry();this.mode_===L.LINE_STRING?(this.finishCoordinate_=d.slice(),c=this.sketchCoords_,c.length>=this.maxPoints_&&(this.freehand_?c.pop():b=!0),c.push(d.slice()),this.geometryFunction_(c,e)):this.mode_===L.POLYGON&&(c=this.sketchCoords_[0],c.length>=this.maxPoints_&&(this.freehand_?c.pop():b=!0),c.push(d.slice()),b&&(this.finishCoordinate_=c[0]),this.geometryFunction_(this.sketchCoords_,e)),this.updateSketchFeatures_(),b&&this.finishDrawing()},b.prototype.removeLastPoint=function(){if(this.sketchFeature_){var a,b,c=this.sketchFeature_.getGeometry();this.mode_===L.LINE_STRING?(a=this.sketchCoords_,a.splice(-2,1),this.geometryFunction_(a,c),a.length>=2&&(this.finishCoordinate_=a[a.length-2].slice())):this.mode_===L.POLYGON&&(a=this.sketchCoords_[0],a.splice(-2,1),b=this.sketchLine_.getGeometry(),b.setCoordinates(a),this.geometryFunction_(this.sketchCoords_,c)),0===a.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},b.prototype.finishDrawing=function(){var a=this.abortDrawing_();if(a){var b=this.sketchCoords_,c=a.getGeometry();this.mode_===L.LINE_STRING?(b.pop(),this.geometryFunction_(b,c)):this.mode_===L.POLYGON&&(b[0].pop(),this.geometryFunction_(b,c),b=c.getCoordinates()),this.type_===y.default.MULTI_POINT?a.setGeometry(new B.default([b])):this.type_===y.default.MULTI_LINE_STRING?a.setGeometry(new A.default([b])):this.type_===y.default.MULTI_POLYGON&&a.setGeometry(new C.default([b])),this.dispatchEvent(new N(M.DRAWEND,a)),this.features_&&this.features_.push(a),this.source_&&this.source_.addFeature(a)}},b.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var a=this.sketchFeature_;return a&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),a},b.prototype.extend=function(a){var b=a.getGeometry(),c=b;this.sketchFeature_=a,this.sketchCoords_=c.getCoordinates();var d=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=d.slice(),this.sketchCoords_.push(d.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new N(M.DRAWSTART,this.sketchFeature_))},b.prototype.updateSketchFeatures_=function(){var a=[];this.sketchFeature_&&a.push(this.sketchFeature_),this.sketchLine_&&a.push(this.sketchLine_),this.sketchPoint_&&a.push(this.sketchPoint_);var b=this.overlay_.getSource();b.clear(!0),b.addFeatures(a)},b.prototype.updateState_=function(){var a=this.getMap(),b=this.getActive();a&&b||this.abortDrawing_(),this.overlay_.setMap(b?a:null)},b}(G.default),P=O;c.default=P},{"../Feature.js":9,"../MapBrowserEventType.js":23,"../MapBrowserPointerEvent.js":24,"../Object.js":28,"../coordinate.js":61,"../events.js":65,"../events/Event.js":66,"../events/EventType.js":67,"../events/condition.js":70,"../extent.js":71,"../functions.js":76,"../geom/Circle.js":78,"../geom/GeometryType.js":81,"../geom/LineString.js":82,"../geom/MultiLineString.js":84,"../geom/MultiPoint.js":85,"../geom/MultiPolygon.js":86,"../geom/Point.js":87,"../geom/Polygon.js":88,"../interaction/Pointer.js":128,"../interaction/Property.js":129,"../layer/Vector.js":142,"../pointer/MouseSource.js":152,"../source/Vector.js":251,"../style/Style.js":278}],120:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){return a instanceof q.default?(a.type!=p.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(a),x.handleEvent.call(this,a),!1):!0}function g(a){var b=a.pixel,c=a.map,d=this.getExtent(),e=this.snapToVertex_(b,c),f=function(a){var b=null,c=null;return a[0]==d[0]?b=d[2]:a[0]==d[2]&&(b=d[0]),a[1]==d[1]?c=d[3]:a[1]==d[3]&&(c=d[1]),null!==b&&null!==c?[b,c]:null};if(e&&d){var g=e[0]==d[0]||e[0]==d[2]?e[0]:null,h=e[1]==d[1]||e[1]==d[3]?e[1]:null;null!==g&&null!==h?this.pointerHandler_=l(f(e)):null!==g?this.pointerHandler_=m(f([g,d[1]]),f([g,d[3]])):null!==h&&(this.pointerHandler_=m(f([d[0],h]),f([d[2],h])))}else e=c.getCoordinateFromPixel(b),this.setExtent([e[0],e[1],e[0],e[1]]),this.pointerHandler_=l(e);return!0}function h(a){if(this.pointerHandler_){var b=a.coordinate;this.setExtent(this.pointerHandler_(b)),this.createOrUpdatePointerFeature_(b)}return!0}function i(){this.pointerHandler_=null;var a=this.getExtent();return a&&0!==t.getArea(a)||this.setExtent(null),!1}function j(){var a=A.createEditingStyle();return function(){return a[u.default.POLYGON]}}function k(){var a=A.createEditingStyle();return function(){return a[u.default.POINT]}}function l(a){return function(b){return t.boundingExtent([a,b])}}function m(a,b){return a[0]==b[0]?function(c){return t.boundingExtent([a,[c[0],b[1]]])}:a[1]==b[1]?function(c){return t.boundingExtent([a,[b[0],c[1]]])}:null}function n(a){return[[[a[0],a[1]],[a[0],a[3]]],[[a[0],a[3]],[a[2],a[3]]],[[a[2],a[3]],[a[2],a[1]]],[[a[2],a[1]],[a[0],a[1]]]]}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var o=e(a("../Feature.js")),p=e(a("../MapBrowserEventType.js")),q=e(a("../MapBrowserPointerEvent.js")),r=a("../coordinate.js"),s=e(a("../events/Event.js")),t=a("../extent.js"),u=e(a("../geom/GeometryType.js")),v=e(a("../geom/Point.js")),w=a("../geom/Polygon.js"),x=d(a("../interaction/Pointer.js")),y=e(a("../layer/Vector.js")),z=e(a("../source/Vector.js")),A=a("../style/Style.js"),B={EXTENTCHANGED:"extentchanged"},C=function(a){function b(b){a.call(this,B.EXTENTCHANGED),this.extent=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(s.default),D=function(a){function b(b){a.call(this,{handleDownEvent:g,handleDragEvent:h,handleEvent:f,handleUpEvent:i});var c=b||{};this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==c.pixelTolerance?c.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,b||(b={}),this.extentOverlay_=new y.default({source:new z.default({useSpatialIndex:!1,wrapX:!!b.wrapX}),style:b.boxStyle?b.boxStyle:j(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new y.default({source:new z.default({useSpatialIndex:!1,wrapX:!!b.wrapX}),style:b.pointerStyle?b.pointerStyle:k(),updateWhileAnimating:!0,updateWhileInteracting:!0}),b.extent&&this.setExtent(b.extent)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.snapToVertex_=function(a,b){var c=b.getCoordinateFromPixel(a),d=function(a,b){return r.squaredDistanceToSegment(c,a)-r.squaredDistanceToSegment(c,b)},e=this.getExtent();if(e){var f=n(e);f.sort(d);var g=f[0],h=r.closestOnSegment(c,g),i=b.getPixelFromCoordinate(h);if(r.distance(a,i)<=this.pixelTolerance_){var j=b.getPixelFromCoordinate(g[0]),k=b.getPixelFromCoordinate(g[1]),l=r.squaredDistance(i,j),m=r.squaredDistance(i,k),o=Math.sqrt(Math.min(l,m));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(h=l>m?g[1]:g[0]),h}}return null},b.prototype.handlePointerMove_=function(a){var b=a.pixel,c=a.map,d=this.snapToVertex_(b,c);d||(d=c.getCoordinateFromPixel(b)),this.createOrUpdatePointerFeature_(d)},b.prototype.createOrUpdateExtentFeature_=function(a){var b=this.extentFeature_;return b?b.setGeometry(a?w.fromExtent(a):void 0):(b=new o.default(a?w.fromExtent(a):{}),this.extentFeature_=b,this.extentOverlay_.getSource().addFeature(b)),b},b.prototype.createOrUpdatePointerFeature_=function(a){var b=this.vertexFeature_;if(b){var c=b.getGeometry();c.setCoordinates(a)}else b=new o.default(new v.default(a)),this.vertexFeature_=b,this.vertexOverlay_.getSource().addFeature(b);return b},b.prototype.setMap=function(b){this.extentOverlay_.setMap(b),this.vertexOverlay_.setMap(b),a.prototype.setMap.call(this,b)},b.prototype.getExtent=function(){return this.extent_},b.prototype.setExtent=function(a){this.extent_=a?a:null,this.createOrUpdateExtentFeature_(a),this.dispatchEvent(new C(this.extent_))},b}(x.default),E=D;c.default=E},{"../Feature.js":9,"../MapBrowserEventType.js":23,"../MapBrowserPointerEvent.js":24,"../coordinate.js":61,"../events/Event.js":66,"../extent.js":71,"../geom/GeometryType.js":81,"../geom/Point.js":87,"../geom/Polygon.js":88,"../interaction/Pointer.js":128,"../layer/Vector.js":142,"../source/Vector.js":251,"../style/Style.js":278}],121:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=a.getCenter();if(d){var e=a.constrainCenter([d[0]+b[0],d[1]+b[1]]);c?a.animate({duration:c,easing:l.linear,center:e}):a.setCenter(e)}}function f(a,b,c,d){b=a.constrainRotation(b,0),g(a,b,c,d)}function g(a,b,c,d){if(void 0!==b){var e=a.getRotation(),f=a.getCenter();void 0!==e&&f&&d>0?a.animate({rotation:b,anchor:c,duration:d,easing:l.easeOut}):a.rotate(b,c)}}function h(a,b,c,d,e){b=a.constrainResolution(b,0,e),j(a,b,c,d)}function i(a,b,c,d){var e=a.getResolution(),f=a.constrainResolution(e,b,0);if(void 0!==f){var g=a.getResolutions();f=n.clamp(f,a.getMinResolution()||g[g.length-1],a.getMaxResolution()||g[0])}if(c&&void 0!==f&&f!==e){var h=a.getCenter(),i=a.calculateCenterZoom(f,c);i=a.constrainCenter(i),c=[(f*h[0]-e*i[0])/(f-e),(f*h[1]-e*i[1])/(f-e)]}j(a,f,c,d)}function j(a,b,c,d){if(b){var e=a.getResolution(),f=a.getCenter();if(void 0!==e&&f&&b!==e&&d)a.animate({resolution:b,anchor:c,duration:d,easing:l.easeOut});else{if(c){var g=a.calculateCenterZoom(b,c);a.setCenter(g)}a.setResolution(b)}}}Object.defineProperty(c,"__esModule",{value:!0}),c.pan=e,c.rotate=f,c.rotateWithoutConstraints=g,c.zoom=h,c.zoomByDelta=i,c.zoomWithoutConstraints=j,c.default=void 0;var k=d(a("../Object.js")),l=a("../easing.js"),m=d(a("../interaction/Property.js")),n=a("../math.js"),o=function(a){function b(b){a.call(this),this.map_=null,this.setActive(!0),this.handleEvent=b.handleEvent}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getActive=function(){return this.get(m.default.ACTIVE)},b.prototype.getMap=function(){return this.map_},b.prototype.setActive=function(a){this.set(m.default.ACTIVE,a)},b.prototype.setMap=function(a){this.map_=a},b}(k.default),p=o;c.default=p},{"../Object.js":28,"../easing.js":64,"../interaction/Property.js":129,"../math.js":147}],122:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=!1;if(a.type==h.default.KEYDOWN){var c=a.originalEvent,d=c.keyCode;if(this.condition_(a)&&(d==i.default.DOWN||d==i.default.LEFT||d==i.default.RIGHT||d==i.default.UP)){var e=a.map,f=e.getView(),j=f.getResolution()*this.pixelDelta_,l=0,m=0;d==i.default.DOWN?m=-j:d==i.default.LEFT?l=-j:d==i.default.RIGHT?l=j:m=j;var n=[l,m];g.rotate(n,f.getRotation()),k.pan(f,n,this.duration_),a.preventDefault(),b=!0}}return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=a("../coordinate.js"),h=e(a("../events/EventType.js")),i=e(a("../events/KeyCode.js")),j=a("../events/condition.js"),k=d(a("../interaction/Interaction.js")),l=function(a){function b(b){a.call(this,{handleEvent:f});var c=b||{};this.defaultCondition_=function(a){return j.noModifierKeys(a)&&j.targetNotEditable(a)},this.condition_=void 0!==c.condition?c.condition:this.defaultCondition_,this.duration_=void 0!==c.duration?c.duration:100,this.pixelDelta_=void 0!==c.pixelDelta?c.pixelDelta:128
}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(k.default),m=l;c.default=m},{"../coordinate.js":61,"../events/EventType.js":67,"../events/KeyCode.js":68,"../events/condition.js":70,"../interaction/Interaction.js":121}],123:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=!1;if(a.type==g.default.KEYDOWN||a.type==g.default.KEYPRESS){var c=a.originalEvent,d=c.charCode;if(this.condition_(a)&&(d=="+".charCodeAt(0)||d=="-".charCodeAt(0))){var e=a.map,f=d=="+".charCodeAt(0)?this.delta_:-this.delta_,h=e.getView();i.zoomByDelta(h,f,void 0,this.duration_),a.preventDefault(),b=!0}}return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=e(a("../events/EventType.js")),h=a("../events/condition.js"),i=d(a("../interaction/Interaction.js")),j=function(a){function b(b){a.call(this,{handleEvent:f});var c=b?b:{};this.condition_=c.condition?c.condition:h.targetNotEditable,this.delta_=c.delta?c.delta:1,this.duration_=void 0!==c.duration?c.duration:100}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),k=j;c.default=k},{"../events/EventType.js":67,"../events/condition.js":70,"../interaction/Interaction.js":121}],124:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){return a.index-b.index}function g(a){var b=this;if(!this.condition_(a))return!1;this.handlePointerAtPixel_(a.pixel,a.map);var c=a.map.getCoordinateFromPixel(a.pixel);this.dragSegments_.length=0,this.modified_=!1;var d=this.vertexFeature_;if(d){var e=[],g=d.getGeometry(),h=g.getCoordinates(),i=z.boundingExtent([h]),j=this.rBush_.getInExtent(i),k={};j.sort(f);for(var m=0,o=j.length;o>m;++m){var p=j[m],q=p.segment,r=n.getUid(p.feature),s=p.depth;if(s&&(r+="-"+s.join("-")),k[r]||(k[r]=new Array(2)),p.geometry.getType()===A.default.CIRCLE&&p.index===J){var t=l(c,p);u.equals(t,h)&&!k[r][0]&&(b.dragSegments_.push([p,0]),k[r][0]=p)}else if(u.equals(q[0],h)&&!k[r][0])b.dragSegments_.push([p,0]),k[r][0]=p;else if(u.equals(q[1],h)&&!k[r][1]){if((p.geometry.getType()===A.default.LINE_STRING||p.geometry.getType()===A.default.MULTI_LINE_STRING)&&k[r][0]&&0===k[r][0].index)continue;b.dragSegments_.push([p,1]),k[r][1]=p}else b.insertVertexCondition_(a)&&n.getUid(q)in b.vertexSegments_&&!k[r][0]&&!k[r][1]&&e.push([p,h])}e.length&&this.willModifyFeatures_(a);for(var v=e.length-1;v>=0;--v)b.insertVertex_.apply(b,e[v])}return!!this.vertexFeature_}function h(a){var b=this;this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(a);for(var c=a.coordinate,d=0,e=this.dragSegments_.length;e>d;++d){for(var f=b.dragSegments_[d],g=f[0],h=g.depth,i=g.geometry,j=void 0,k=g.segment,l=f[1];c.length<i.getStride();)c.push(k[l][c.length]);switch(i.getType()){case A.default.POINT:j=c,k[0]=k[1]=c;break;case A.default.MULTI_POINT:j=i.getCoordinates(),j[g.index]=c,k[0]=k[1]=c;break;case A.default.LINE_STRING:j=i.getCoordinates(),j[g.index+l]=c,k[l]=c;break;case A.default.MULTI_LINE_STRING:j=i.getCoordinates(),j[h[0]][g.index+l]=c,k[l]=c;break;case A.default.POLYGON:j=i.getCoordinates(),j[h[0]][g.index+l]=c,k[l]=c;break;case A.default.MULTI_POLYGON:j=i.getCoordinates(),j[h[1]][h[0]][g.index+l]=c,k[l]=c;break;case A.default.CIRCLE:k[0]=k[1]=c,g.index===I?(b.changingFeature_=!0,i.setCenter(c),b.changingFeature_=!1):(b.changingFeature_=!0,i.setRadius(u.distance(i.getCenter(),c)),b.changingFeature_=!1)}j&&b.setGeometryCoordinates_(i,j)}this.createOrUpdateVertexFeature_(c)}function i(a){for(var b=this,c=this.dragSegments_.length-1;c>=0;--c){var d=b.dragSegments_[c][0],e=d.geometry;if(e.getType()===A.default.CIRCLE){var f=e.getCenter(),g=d.featureSegments[0],h=d.featureSegments[1];g.segment[0]=g.segment[1]=f,h.segment[0]=h.segment[1]=f,b.rBush_.update(z.createOrUpdateFromCoordinate(f),g),b.rBush_.update(e.getExtent(),h)}else b.rBush_.update(z.boundingExtent(d.segment),d)}return this.modified_&&(this.dispatchEvent(new L(K.MODIFYEND,this.features_,a)),this.modified_=!1),!1}function j(a){if(!(a instanceof s.default))return!0;this.lastPointerEvent_=a;var b;return a.map.getView().getInteracting()||a.type!=r.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(a),this.vertexFeature_&&this.deleteCondition_(a)&&(b=a.type==r.default.SINGLECLICK&&this.ignoreNextSingleClick_?!0:this.removePoint()),a.type==r.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),C.handleEvent.call(this,a)&&!b}function k(a,b){var c=b.geometry;if(c.getType()===A.default.CIRCLE){var d=c;if(b.index===J){var e=u.squaredDistance(d.getCenter(),a),f=Math.sqrt(e)-d.getRadius();return f*f}}return u.squaredDistanceToSegment(a,b.segment)}function l(a,b){var c=b.geometry;return c.getType()===A.default.CIRCLE&&b.index===J?c.getClosestPoint(a):u.closestOnSegment(a,b.segment)}function m(){var a=H.createEditingStyle();return function(){return a[A.default.POINT]}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.ModifyEvent=void 0;var n=a("../util.js"),o=e(a("../Collection.js")),p=e(a("../CollectionEventType.js")),q=e(a("../Feature.js")),r=e(a("../MapBrowserEventType.js")),s=e(a("../MapBrowserPointerEvent.js")),t=a("../array.js"),u=a("../coordinate.js"),v=a("../events.js"),w=e(a("../events/Event.js")),x=e(a("../events/EventType.js")),y=a("../events/condition.js"),z=a("../extent.js"),A=e(a("../geom/GeometryType.js")),B=e(a("../geom/Point.js")),C=d(a("../interaction/Pointer.js")),D=e(a("../layer/Vector.js")),E=e(a("../source/Vector.js")),F=e(a("../source/VectorEventType.js")),G=e(a("../structs/RBush.js")),H=a("../style/Style.js"),I=0,J=1,K={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},L=function(a){function b(b,c,d){a.call(this,b),this.features=c,this.mapBrowserEvent=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(w.default);c.ModifyEvent=L;var M=function(a){function b(b){a.call(this,{handleDownEvent:g,handleDragEvent:h,handleEvent:j,handleUpEvent:i}),this.condition_=b.condition?b.condition:y.primaryAction,this.defaultDeleteCondition_=function(a){return y.altKeyOnly(a)&&y.singleClick(a)},this.deleteCondition_=b.deleteCondition?b.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=b.insertVertexCondition?b.insertVertexCondition:y.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new G.default,this.pixelTolerance_=void 0!==b.pixelTolerance?b.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new D.default({source:new E.default({useSpatialIndex:!1,wrapX:!!b.wrapX}),style:b.style?b.style:m(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null;var c;if(b.source?(this.source_=b.source,c=new o.default(this.source_.getFeatures()),v.listen(this.source_,F.default.ADDFEATURE,this.handleSourceAdd_,this),v.listen(this.source_,F.default.REMOVEFEATURE,this.handleSourceRemove_,this)):c=b.features,!c)throw new Error("The modify interaction requires features or a source");this.features_=c,this.features_.forEach(this.addFeature_.bind(this)),v.listen(this.features_,p.default.ADD,this.handleFeatureAdd_,this),v.listen(this.features_,p.default.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature_=function(a){var b=a.getGeometry();b&&b.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[b.getType()].call(this,a,b);var c=this.getMap();c&&c.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,c),v.listen(a,x.default.CHANGE,this.handleFeatureChange_,this)},b.prototype.willModifyFeatures_=function(a){this.modified_||(this.modified_=!0,this.dispatchEvent(new L(K.MODIFYSTART,this.features_,a)))},b.prototype.removeFeature_=function(a){this.removeFeatureSegmentData_(a),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),v.unlisten(a,x.default.CHANGE,this.handleFeatureChange_,this)},b.prototype.removeFeatureSegmentData_=function(a){var b=this.rBush_,c=[];b.forEach(function(b){a===b.feature&&c.push(b)});for(var d=c.length-1;d>=0;--d)b.remove(c[d])},b.prototype.setActive=function(b){this.vertexFeature_&&!b&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),a.prototype.setActive.call(this,b)},b.prototype.setMap=function(b){this.overlay_.setMap(b),a.prototype.setMap.call(this,b)},b.prototype.getOverlay=function(){return this.overlay_},b.prototype.handleSourceAdd_=function(a){a.feature&&this.features_.push(a.feature)},b.prototype.handleSourceRemove_=function(a){a.feature&&this.features_.remove(a.feature)},b.prototype.handleFeatureAdd_=function(a){this.addFeature_(a.element)},b.prototype.handleFeatureChange_=function(a){if(!this.changingFeature_){var b=a.target;this.removeFeature_(b),this.addFeature_(b)}},b.prototype.handleFeatureRemove_=function(a){var b=a.element;this.removeFeature_(b)},b.prototype.writePointGeometry_=function(a,b){var c=b.getCoordinates(),d={feature:a,geometry:b,segment:[c,c]};this.rBush_.insert(b.getExtent(),d)},b.prototype.writeMultiPointGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e){var g=d[e],h={feature:a,geometry:b,depth:[e],index:e,segment:[g,g]};c.rBush_.insert(b.getExtent(),h)}},b.prototype.writeLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length-1;f>e;++e){var g=d.slice(e,e+2),h={feature:a,geometry:b,index:e,segment:g};c.rBush_.insert(z.boundingExtent(g),h)}},b.prototype.writeMultiLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e)for(var g=d[e],h=0,i=g.length-1;i>h;++h){var j=g.slice(h,h+2),k={feature:a,geometry:b,depth:[e],index:h,segment:j};c.rBush_.insert(z.boundingExtent(j),k)}},b.prototype.writePolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e)for(var g=d[e],h=0,i=g.length-1;i>h;++h){var j=g.slice(h,h+2),k={feature:a,geometry:b,depth:[e],index:h,segment:j};c.rBush_.insert(z.boundingExtent(j),k)}},b.prototype.writeMultiPolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e)for(var g=d[e],h=0,i=g.length;i>h;++h)for(var j=g[h],k=0,l=j.length-1;l>k;++k){var m=j.slice(k,k+2),n={feature:a,geometry:b,depth:[h,e],index:k,segment:m};c.rBush_.insert(z.boundingExtent(m),n)}},b.prototype.writeCircleGeometry_=function(a,b){var c=b.getCenter(),d={feature:a,geometry:b,index:I,segment:[c,c]},e={feature:a,geometry:b,index:J,segment:[c,c]},f=[d,e];d.featureSegments=e.featureSegments=f,this.rBush_.insert(z.createOrUpdateFromCoordinate(c),d),this.rBush_.insert(b.getExtent(),e)},b.prototype.writeGeometryCollectionGeometry_=function(a,b){for(var c=this,d=b.getGeometriesArray(),e=0;e<d.length;++e)c.SEGMENT_WRITERS_[d[e].getType()].call(c,a,d[e])},b.prototype.createOrUpdateVertexFeature_=function(a){var b=this.vertexFeature_;if(b){var c=b.getGeometry();c.setCoordinates(a)}else b=new q.default(new B.default(a)),this.vertexFeature_=b,this.overlay_.getSource().addFeature(b);return b},b.prototype.handlePointerMove_=function(a){this.lastPixel_=a.pixel,this.handlePointerAtPixel_(a.pixel,a.map)},b.prototype.handlePointerAtPixel_=function(a,b){var c=b.getCoordinateFromPixel(a),d=function(a,b){return k(c,a)-k(c,b)},e=z.buffer(z.createOrUpdateFromCoordinate(c),b.getView().getResolution()*this.pixelTolerance_),f=this.rBush_,g=f.getInExtent(e);if(g.length>0){g.sort(d);var h=g[0],i=h.segment,j=l(c,h),m=b.getPixelFromCoordinate(j),o=u.distance(a,m);if(o<=this.pixelTolerance_){var p={};if(h.geometry.getType()===A.default.CIRCLE&&h.index===J)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(j);else{var q=b.getPixelFromCoordinate(i[0]),r=b.getPixelFromCoordinate(i[1]),s=u.squaredDistance(m,q),t=u.squaredDistance(m,r);o=Math.sqrt(Math.min(s,t)),this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(j=s>t?i[1]:i[0]),this.createOrUpdateVertexFeature_(j);for(var v=1,w=g.length;w>v;++v){var x=g[v].segment;if(!(u.equals(i[0],x[0])&&u.equals(i[1],x[1])||u.equals(i[0],x[1])&&u.equals(i[1],x[0])))break;p[n.getUid(x)]=!0}}return p[n.getUid(i)]=!0,void(this.vertexSegments_=p)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},b.prototype.insertVertex_=function(a,b){for(var c,d=a.segment,e=a.feature,f=a.geometry,g=a.depth,h=a.index;b.length<f.getStride();)b.push(0);switch(f.getType()){case A.default.MULTI_LINE_STRING:c=f.getCoordinates(),c[g[0]].splice(h+1,0,b);break;case A.default.POLYGON:c=f.getCoordinates(),c[g[0]].splice(h+1,0,b);break;case A.default.MULTI_POLYGON:c=f.getCoordinates(),c[g[1]][g[0]].splice(h+1,0,b);break;case A.default.LINE_STRING:c=f.getCoordinates(),c.splice(h+1,0,b);break;default:return}this.setGeometryCoordinates_(f,c);var i=this.rBush_;i.remove(a),this.updateSegmentIndices_(f,h,g,1);var j={segment:[d[0],b],feature:e,geometry:f,depth:g,index:h};i.insert(z.boundingExtent(j.segment),j),this.dragSegments_.push([j,1]);var k={segment:[b,d[1]],feature:e,geometry:f,depth:g,index:h+1};i.insert(z.boundingExtent(k.segment),k),this.dragSegments_.push([k,0]),this.ignoreNextSingleClick_=!0},b.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=r.default.POINTERDRAG){var a=this.lastPointerEvent_;return this.willModifyFeatures_(a),this.removeVertex_(),this.dispatchEvent(new L(K.MODIFYEND,this.features_,a)),this.modified_=!1,!0}return!1},b.prototype.removeVertex_=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=this.dragSegments_,o={},p=!1;for(e=m.length-1;e>=0;--e)c=m[e],j=c[0],k=n.getUid(j.feature),j.depth&&(k+="-"+j.depth.join("-")),k in o||(o[k]={}),0===c[1]?(o[k].right=j,o[k].index=j.index):1==c[1]&&(o[k].left=j,o[k].index=j.index+1);for(k in o){switch(i=o[k].right,g=o[k].left,f=o[k].index,h=f-1,j=void 0!==g?g:i,0>h&&(h=0),d=j.geometry,b=d.getCoordinates(),a=b,p=!1,d.getType()){case A.default.MULTI_LINE_STRING:b[j.depth[0]].length>2&&(b[j.depth[0]].splice(f,1),p=!0);break;case A.default.LINE_STRING:b.length>2&&(b.splice(f,1),p=!0);break;case A.default.MULTI_POLYGON:a=a[j.depth[1]];case A.default.POLYGON:a=a[j.depth[0]],a.length>4&&(f==a.length-1&&(f=0),a.splice(f,1),p=!0,0===f&&(a.pop(),a.push(a[0]),h=a.length-1))}if(p){l.setGeometryCoordinates_(d,b);var q=[];if(void 0!==g&&(l.rBush_.remove(g),q.push(g.segment[0])),void 0!==i&&(l.rBush_.remove(i),q.push(i.segment[1])),void 0!==g&&void 0!==i){var r={depth:j.depth,feature:j.feature,geometry:j.geometry,index:h,segment:q};l.rBush_.insert(z.boundingExtent(r.segment),r)}l.updateSegmentIndices_(d,f,j.depth,-1),l.vertexFeature_&&(l.overlay_.getSource().removeFeature(l.vertexFeature_),l.vertexFeature_=null),m.length=0}}return p},b.prototype.setGeometryCoordinates_=function(a,b){this.changingFeature_=!0,a.setCoordinates(b),this.changingFeature_=!1},b.prototype.updateSegmentIndices_=function(a,b,c,d){this.rBush_.forEachInExtent(a.getExtent(),function(e){e.geometry===a&&(void 0===c||void 0===e.depth||t.equals(e.depth,c))&&e.index>b&&(e.index+=d)})},b}(C.default),N=M;c.default=N},{"../Collection.js":6,"../CollectionEventType.js":7,"../Feature.js":9,"../MapBrowserEventType.js":23,"../MapBrowserPointerEvent.js":24,"../array.js":45,"../coordinate.js":61,"../events.js":65,"../events/Event.js":66,"../events/EventType.js":67,"../events/condition.js":70,"../extent.js":71,"../geom/GeometryType.js":81,"../geom/Point.js":87,"../interaction/Pointer.js":128,"../layer/Vector.js":142,"../source/Vector.js":251,"../source/VectorEventType.js":252,"../structs/RBush.js":264,"../style/Style.js":278,"../util.js":289}],125:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){if(!this.condition_(a))return!0;var b=a.type;if(b!==j.default.WHEEL&&b!==j.default.MOUSEWHEEL)return!0;a.preventDefault();var c=a.map,d=a.originalEvent;this.useAnchor_&&(this.lastAnchor_=a.coordinate);var e;if(a.type==j.default.WHEEL?(e=d.deltaY,k.FIREFOX&&d.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=k.DEVICE_PIXEL_RATIO),d.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)):a.type==j.default.MOUSEWHEEL&&(e=-d.wheelDeltaY,k.SAFARI&&(e/=3)),0===e)return!1;var f=Date.now();if(void 0===this.startTime_&&(this.startTime_=f),(!this.mode_||f-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?o.TRACKPAD:o.WHEEL),this.mode_===o.TRACKPAD){var h=c.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):h.setHint(g.default.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var l=h.getResolution()*Math.pow(2,e/this.trackpadDeltaPerZoom_),m=h.getMinResolution(),n=h.getMaxResolution(),p=0;if(m>l?(l=Math.max(l,m/this.trackpadZoomBuffer_),p=1):l>n&&(l=Math.min(l,n*this.trackpadZoomBuffer_),p=-1),this.lastAnchor_){var q=h.calculateCenterZoom(l,this.lastAnchor_);h.setCenter(h.constrainCenter(q))}return h.setResolution(l),0===p&&this.constrainResolution_&&h.animate({resolution:h.constrainResolution(l,e>0?-1:1),easing:i.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),p>0?h.animate({resolution:m,easing:i.easeOut,anchor:this.lastAnchor_,duration:500}):0>p&&h.animate({resolution:n,easing:i.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=f,!1}this.delta_+=e;var r=Math.max(this.timeout_-(f-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,c),r),!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.Mode=void 0;var g=e(a("../ViewHint.js")),h=a("../events/condition.js"),i=a("../easing.js"),j=e(a("../events/EventType.js")),k=a("../has.js"),l=d(a("../interaction/Interaction.js")),m=a("../math.js"),n=1,o={TRACKPAD:"trackpad",WHEEL:"wheel"};c.Mode=o;var p=function(a){function b(b){a.call(this,{handleEvent:f});var c=b||{};this.delta_=0,this.duration_=void 0!==c.duration?c.duration:250,this.timeout_=void 0!==c.timeout?c.timeout:80,this.useAnchor_=void 0!==c.useAnchor?c.useAnchor:!0,this.constrainResolution_=c.constrainResolution||!1,this.condition_=c.condition?c.condition:h.always,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0;var a=this.getMap().getView();a.setHint(g.default.INTERACTING,-1)},b.prototype.handleWheelZoom_=function(a){var b=a.getView();b.getAnimating()&&b.cancelAnimations();var c=n,d=m.clamp(this.delta_,-c,c);l.zoomByDelta(b,-d,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},b.prototype.setMouseAnchor=function(a){this.useAnchor_=a,a||(this.lastAnchor_=null)},b}(l.default),q=p;c.default=q},{"../ViewHint.js":42,"../easing.js":64,"../events/EventType.js":67,"../events/condition.js":70,"../has.js":109,"../interaction/Interaction.js":121,"../math.js":147}],126:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=0,c=this.targetPointers[0],d=this.targetPointers[1],e=Math.atan2(d.clientY-c.clientY,d.clientX-c.clientX);if(void 0!==this.lastAngle_){var f=e-this.lastAngle_;this.rotationDelta_+=f,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),b=f}this.lastAngle_=e;var g=a.map,h=g.getView();if(h.getConstraints().rotation!==m.disable){var i=g.getViewport().getBoundingClientRect(),j=l.centroid(this.targetPointers);if(j[0]-=i.left,j[1]-=i.top,this.anchor_=g.getCoordinateFromPixel(j),this.rotating_){var n=h.getRotation();g.render(),k.rotateWithoutConstraints(h,n+b,this.anchor_)}}}function g(a){if(this.targetPointers.length<2){var b=a.map,c=b.getView();if(c.setHint(i.default.INTERACTING,-1),this.rotating_){var d=c.getRotation();k.rotate(c,d,this.anchor_,this.duration_)}return!1}return!0}function h(a){if(this.targetPointers.length>=2){var b=a.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||b.getView().setHint(i.default.INTERACTING,1),!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=e(a("../ViewHint.js")),j=a("../functions.js"),k=a("../interaction/Interaction.js"),l=d(a("../interaction/Pointer.js")),m=a("../rotationconstraint.js"),n=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g,stopDown:j.FALSE});var c=b||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==c.threshold?c.threshold:.3,this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default),o=n;c.default=o},{"../ViewHint.js":42,"../functions.js":76,"../interaction/Interaction.js":121,"../interaction/Pointer.js":128,"../rotationconstraint.js":225}],127:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=1,c=this.targetPointers[0],d=this.targetPointers[1],e=c.clientX-d.clientX,f=c.clientY-d.clientY,g=Math.sqrt(e*e+f*f);void 0!==this.lastDistance_&&(b=this.lastDistance_/g),this.lastDistance_=g;var h=a.map,i=h.getView(),j=i.getResolution(),m=i.getMaxResolution(),n=i.getMinResolution(),o=j*b;o>m?(b=m/j,o=m):n>o&&(b=n/j,o=n),1!=b&&(this.lastScaleDelta_=b);var p=h.getViewport().getBoundingClientRect(),q=l.centroid(this.targetPointers);q[0]-=p.left,q[1]-=p.top,this.anchor_=h.getCoordinateFromPixel(q),h.render(),k.zoomWithoutConstraints(i,o,this.anchor_)}function g(a){if(this.targetPointers.length<2){var b=a.map,c=b.getView();c.setHint(i.default.INTERACTING,-1);var d=c.getResolution();if(this.constrainResolution_||d<c.getMinResolution()||d>c.getMaxResolution()){var e=this.lastScaleDelta_-1;k.zoom(c,d,this.anchor_,this.duration_,e)}return!1}return!0}function h(a){if(this.targetPointers.length>=2){var b=a.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||b.getView().setHint(i.default.INTERACTING,1),!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=e(a("../ViewHint.js")),j=a("../functions.js"),k=a("../interaction/Interaction.js"),l=d(a("../interaction/Pointer.js")),m=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g,stopDown:j.FALSE});var c=b?b:{};this.constrainResolution_=c.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==c.duration?c.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default),n=m;c.default=n},{"../ViewHint.js":42,"../functions.js":76,"../interaction/Interaction.js":121,"../interaction/Pointer.js":128}],128:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){for(var b=a.length,c=0,d=0,e=0;b>e;e++)c+=a[e].clientX,d+=a[e].clientY;return[c/b,d/b]}function f(a){var b=a.type;return b===j.default.POINTERDOWN||b===j.default.POINTERDRAG||b===j.default.POINTERUP}function g(a){if(!(a instanceof k.default))return!0;var b=!1;if(this.updateTrackedPointers_(a),this.handlingDownUpSequence){if(a.type==j.default.POINTERDRAG)this.handleDragEvent_(a);else if(a.type==j.default.POINTERUP){var c=this.handleUpEvent_(a);this.handlingDownUpSequence=c&&this.targetPointers.length>0}}else if(a.type==j.default.POINTERDOWN){var d=this.handleDownEvent_(a);d&&a.preventDefault(),this.handlingDownUpSequence=d,b=this.stopDown(d)}else a.type==j.default.POINTERMOVE&&this.handleMoveEvent_(a);return!b}function h(a){return a}Object.defineProperty(c,"__esModule",{value:!0}),c.centroid=e,c.handleEvent=g,c.default=void 0;var i=a("../functions.js"),j=d(a("../MapBrowserEventType.js")),k=d(a("../MapBrowserPointerEvent.js")),l=d(a("../interaction/Interaction.js")),m=a("../obj.js"),n=i.VOID,o=i.FALSE,p=i.FALSE,q=i.VOID,r=function(a){function b(b){var c=b?b:{};a.call(this,{handleEvent:c.handleEvent||g}),this.handleDownEvent_=c.handleDownEvent?c.handleDownEvent:p,this.handleDragEvent_=c.handleDragEvent?c.handleDragEvent:n,this.handleMoveEvent_=c.handleMoveEvent?c.handleMoveEvent:q,this.handleUpEvent_=c.handleUpEvent?c.handleUpEvent:o,this.handlingDownUpSequence=!1,this.stopDown=c.stopDown?c.stopDown:h,this.trackedPointers_={},this.targetPointers=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.updateTrackedPointers_=function(a){if(f(a)){var b=a.pointerEvent,c=b.pointerId.toString();a.type==j.default.POINTERUP?delete this.trackedPointers_[c]:a.type==j.default.POINTERDOWN?this.trackedPointers_[c]=b:c in this.trackedPointers_&&(this.trackedPointers_[c]=b),this.targetPointers=m.getValues(this.trackedPointers_)}},b}(l.default),s=r;c.default=s},{"../MapBrowserEventType.js":23,"../MapBrowserPointerEvent.js":24,"../functions.js":76,"../interaction/Interaction.js":121,"../obj.js":149}],129:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ACTIVE:"active"};c.default=d},{}],130:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(!this.condition_(a))return!0;var b=this.addCondition_(a),c=this.removeCondition_(a),d=this.toggleCondition_(a),e=!b&&!c&&!d,f=a.map,g=this.featureOverlay_.getSource().getFeaturesCollection(),h=[],j=[];if(e){q.clear(this.featureLayerAssociation_),f.forEachFeatureAtPixel(a.pixel,function(a,b){return this.filter_(a,b)?(j.push(a),this.addFeatureLayerAssociation_(a,b),!this.multi_):void 0}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var k=g.getLength()-1;k>=0;--k){var m=g.item(k),n=j.indexOf(m);n>-1?j.splice(n,1):(g.remove(m),h.push(m))}0!==j.length&&g.extend(j)}else{f.forEachFeatureAtPixel(a.pixel,function(a,e){return this.filter_(a,e)?(!b&&!d||i.includes(g.getArray(),a)?(c||d)&&i.includes(g.getArray(),a)&&(h.push(a),this.removeFeatureLayerAssociation_(a)):(j.push(a),this.addFeatureLayerAssociation_(a,e)),!this.multi_):void 0}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var o=h.length-1;o>=0;--o)g.remove(h[o]);g.extend(j)}return(j.length>0||h.length>0)&&this.dispatchEvent(new u(t.SELECT,j,h,a)),l.pointerMove(a)}function f(){var a=s.createEditingStyle();return i.extend(a[n.default.POLYGON],a[n.default.LINE_STRING]),i.extend(a[n.default.GEOMETRY_COLLECTION],a[n.default.LINE_STRING]),function(b){return b.getGeometry()?a[b.getGeometry().getType()]:null}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=a("../util.js"),h=d(a("../CollectionEventType.js")),i=a("../array.js"),j=a("../events.js"),k=d(a("../events/Event.js")),l=a("../events/condition.js"),m=a("../functions.js"),n=d(a("../geom/GeometryType.js")),o=d(a("../interaction/Interaction.js")),p=d(a("../layer/Vector.js")),q=a("../obj.js"),r=d(a("../source/Vector.js")),s=a("../style/Style.js"),t={SELECT:"select"},u=function(a){function b(b,c,d,e){a.call(this,b),this.selected=c,this.deselected=d,this.mapBrowserEvent=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(k.default),v=function(a){function b(b){a.call(this,{handleEvent:e});var c=b?b:{};this.condition_=c.condition?c.condition:l.singleClick,this.addCondition_=c.addCondition?c.addCondition:l.never,this.removeCondition_=c.removeCondition?c.removeCondition:l.never,this.toggleCondition_=c.toggleCondition?c.toggleCondition:l.shiftKeyOnly,this.multi_=c.multi?c.multi:!1,this.filter_=c.filter?c.filter:m.TRUE,this.hitTolerance_=c.hitTolerance?c.hitTolerance:0;var d=new p.default({source:new r.default({useSpatialIndex:!1,features:c.features,wrapX:c.wrapX}),style:c.style?c.style:f(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.featureOverlay_=d;var g;if(c.layers)if("function"==typeof c.layers)g=c.layers;else{var k=c.layers;g=function(a){return i.includes(k,a)}}else g=m.TRUE;this.layerFilter_=g,this.featureLayerAssociation_={};var n=this.featureOverlay_.getSource().getFeaturesCollection();j.listen(n,h.default.ADD,this.addFeature_,this),j.listen(n,h.default.REMOVE,this.removeFeature_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeatureLayerAssociation_=function(a,b){var c=g.getUid(a);this.featureLayerAssociation_[c]=b},b.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},b.prototype.getHitTolerance=function(){return this.hitTolerance_},b.prototype.getLayer=function(a){var b=g.getUid(a);return this.featureLayerAssociation_[b]},b.prototype.getOverlay=function(){return this.featureOverlay_},b.prototype.setHitTolerance=function(a){this.hitTolerance_=a},b.prototype.setMap=function(b){var c=this.getMap(),d=this.featureOverlay_.getSource().getFeaturesCollection();c&&d.forEach(c.unskipFeature.bind(c)),a.prototype.setMap.call(this,b),this.featureOverlay_.setMap(b),b&&d.forEach(b.skipFeature.bind(b))},b.prototype.addFeature_=function(a){var b=this.getMap();b&&b.skipFeature(a.element)},b.prototype.removeFeature_=function(a){var b=this.getMap();b&&b.unskipFeature(a.element)},b.prototype.removeFeatureLayerAssociation_=function(a){var b=g.getUid(a);delete this.featureLayerAssociation_[b]},b}(o.default),w=v;c.default=w},{"../CollectionEventType.js":7,"../array.js":45,"../events.js":65,"../events/Event.js":66,"../events/condition.js":70,"../functions.js":76,"../geom/GeometryType.js":81,"../interaction/Interaction.js":121,"../layer/Vector.js":142,"../obj.js":149,"../source/Vector.js":251,"../style/Style.js":278,"../util.js":289}],131:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};
d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){var b=this.snapTo(a.pixel,a.coordinate,a.map);return b.snapped&&(a.coordinate=b.vertex.slice(0,2),a.pixel=b.vertexPixel),s.handleEvent.call(this,a)}function g(){var a=t.getValues(this.pendingFeatures_);return a.length&&(a.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}function h(a,b){var c=l.squaredDistanceToSegment(this.pixelCoordinate_,a.segment),d=l.squaredDistanceToSegment(this.pixelCoordinate_,b.segment);return c-d}Object.defineProperty(c,"__esModule",{value:!0}),c.handleEvent=f,c.default=void 0;var i=a("../util.js"),j=a("../Collection.js"),k=e(a("../CollectionEventType.js")),l=a("../coordinate.js"),m=a("../events.js"),n=e(a("../events/EventType.js")),o=a("../extent.js"),p=a("../functions.js"),q=e(a("../geom/GeometryType.js")),r=a("../geom/Polygon.js"),s=d(a("../interaction/Pointer.js")),t=a("../obj.js"),u=a("../source/Vector.js"),v=e(a("../source/VectorEventType.js")),w=e(a("../structs/RBush.js")),x=function(a){function b(b){a.call(this,{handleEvent:f,handleDownEvent:p.TRUE,handleUpEvent:g,stopDown:p.FALSE});var c=b?b:{};this.source_=c.source?c.source:null,this.vertex_=void 0!==c.vertex?c.vertex:!0,this.edge_=void 0!==c.edge?c.edge:!0,this.features_=c.features?c.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==c.pixelTolerance?c.pixelTolerance:10,this.sortByDistance_=h.bind(this),this.rBush_=new w.default,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a,b){var c=void 0!==b?b:!0,d=i.getUid(a),e=a.getGeometry();if(e){var f=this.SEGMENT_WRITERS_[e.getType()];f&&(this.indexedFeaturesExtents_[d]=e.getExtent(o.createEmpty()),f.call(this,a,e))}c&&(this.featureChangeListenerKeys_[d]=m.listen(a,n.default.CHANGE,this.handleFeatureChange_,this))},b.prototype.forEachFeatureAdd_=function(a){this.addFeature(a)},b.prototype.forEachFeatureRemove_=function(a){this.removeFeature(a)},b.prototype.getFeatures_=function(){var a;return this.features_?a=this.features_:this.source_&&(a=this.source_.getFeatures()),a},b.prototype.handleFeatureAdd_=function(a){var b;a instanceof u.VectorSourceEvent?b=a.feature:a instanceof j.CollectionEvent&&(b=a.element),this.addFeature(b)},b.prototype.handleFeatureRemove_=function(a){var b;a instanceof u.VectorSourceEvent?b=a.feature:a instanceof j.CollectionEvent&&(b=a.element),this.removeFeature(b)},b.prototype.handleFeatureChange_=function(a){var b=a.target;if(this.handlingDownUpSequence){var c=i.getUid(b);c in this.pendingFeatures_||(this.pendingFeatures_[c]=b)}else this.updateFeature_(b)},b.prototype.removeFeature=function(a,b){var c=void 0!==b?b:!0,d=i.getUid(a),e=this.indexedFeaturesExtents_[d];if(e){var f=this.rBush_,g=[];f.forEachInExtent(e,function(b){a===b.feature&&g.push(b)});for(var h=g.length-1;h>=0;--h)f.remove(g[h])}c&&(m.unlistenByKey(this.featureChangeListenerKeys_[d]),delete this.featureChangeListenerKeys_[d])},b.prototype.setMap=function(b){var c=this.getMap(),d=this.featuresListenerKeys_,e=this.getFeatures_();c&&(d.forEach(m.unlistenByKey),d.length=0,e.forEach(this.forEachFeatureRemove_.bind(this))),a.prototype.setMap.call(this,b),b&&(this.features_?d.push(m.listen(this.features_,k.default.ADD,this.handleFeatureAdd_,this),m.listen(this.features_,k.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&d.push(m.listen(this.source_,v.default.ADDFEATURE,this.handleFeatureAdd_,this),m.listen(this.source_,v.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),e.forEach(this.forEachFeatureAdd_.bind(this)))},b.prototype.snapTo=function(a,b,c){var d=c.getCoordinateFromPixel([a[0]-this.pixelTolerance_,a[1]+this.pixelTolerance_]),e=c.getCoordinateFromPixel([a[0]+this.pixelTolerance_,a[1]-this.pixelTolerance_]),f=o.boundingExtent([d,e]),g=this.rBush_.getInExtent(f);this.vertex_&&!this.edge_&&(g=g.filter(function(a){return a.feature.getGeometry().getType()!==q.default.CIRCLE}));var h,i,j,k,m,n=!1,p=!1,r=null,s=null;if(g.length>0){this.pixelCoordinate_=b,g.sort(this.sortByDistance_);var t=g[0].segment,u=g[0].feature.getGeometry().getType()===q.default.CIRCLE;this.vertex_&&!this.edge_?(i=c.getPixelFromCoordinate(t[0]),j=c.getPixelFromCoordinate(t[1]),k=l.squaredDistance(a,i),m=l.squaredDistance(a,j),h=Math.sqrt(Math.min(k,m)),n=h<=this.pixelTolerance_,n&&(p=!0,r=k>m?t[1]:t[0],s=c.getPixelFromCoordinate(r))):this.edge_&&(r=u?l.closestOnCircle(b,g[0].feature.getGeometry()):l.closestOnSegment(b,t),s=c.getPixelFromCoordinate(r),l.distance(a,s)<=this.pixelTolerance_&&(p=!0,this.vertex_&&!u&&(i=c.getPixelFromCoordinate(t[0]),j=c.getPixelFromCoordinate(t[1]),k=l.squaredDistance(s,i),m=l.squaredDistance(s,j),h=Math.sqrt(Math.min(k,m)),n=h<=this.pixelTolerance_,n&&(r=k>m?t[1]:t[0],s=c.getPixelFromCoordinate(r))))),p&&(s=[Math.round(s[0]),Math.round(s[1])])}return{snapped:p,vertex:r,vertexPixel:s}},b.prototype.updateFeature_=function(a){this.removeFeature(a,!1),this.addFeature(a,!1)},b.prototype.writeCircleGeometry_=function(a,b){for(var c=this,d=r.fromCircle(b),e=d.getCoordinates()[0],f=0,g=e.length-1;g>f;++f){var h=e.slice(f,f+2),i={feature:a,segment:h};c.rBush_.insert(o.boundingExtent(h),i)}},b.prototype.writeGeometryCollectionGeometry_=function(a,b){for(var c=this,d=b.getGeometriesArray(),e=0;e<d.length;++e){var f=c.SEGMENT_WRITERS_[d[e].getType()];f&&f.call(c,a,d[e])}},b.prototype.writeLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length-1;f>e;++e){var g=d.slice(e,e+2),h={feature:a,segment:g};c.rBush_.insert(o.boundingExtent(g),h)}},b.prototype.writeMultiLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e)for(var g=d[e],h=0,i=g.length-1;i>h;++h){var j=g.slice(h,h+2),k={feature:a,segment:j};c.rBush_.insert(o.boundingExtent(j),k)}},b.prototype.writeMultiPointGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e){var g=d[e],h={feature:a,segment:[g,g]};c.rBush_.insert(b.getExtent(),h)}},b.prototype.writeMultiPolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e)for(var g=d[e],h=0,i=g.length;i>h;++h)for(var j=g[h],k=0,l=j.length-1;l>k;++k){var m=j.slice(k,k+2),n={feature:a,segment:m};c.rBush_.insert(o.boundingExtent(m),n)}},b.prototype.writePointGeometry_=function(a,b){var c=b.getCoordinates(),d={feature:a,segment:[c,c]};this.rBush_.insert(b.getExtent(),d)},b.prototype.writePolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;f>e;++e)for(var g=d[e],h=0,i=g.length-1;i>h;++h){var j=g.slice(h,h+2),k={feature:a,segment:j};c.rBush_.insert(o.boundingExtent(j),k)}},b}(s.default),y=x;c.default=y},{"../Collection.js":6,"../CollectionEventType.js":7,"../coordinate.js":61,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../functions.js":76,"../geom/GeometryType.js":81,"../geom/Polygon.js":88,"../interaction/Pointer.js":128,"../obj.js":149,"../source/Vector.js":251,"../source/VectorEventType.js":252,"../structs/RBush.js":264,"../util.js":289}],132:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(this.lastFeature_=this.featuresAtPixel_(a.pixel,a.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=a.coordinate,h.call(this,a);var b=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new r(q.TRANSLATESTART,b,a.coordinate)),!0}return!1}function f(a){if(this.lastCoordinate_){this.lastCoordinate_=null,h.call(this,a);var b=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new r(q.TRANSLATEEND,b,a.coordinate)),!0}return!1}function g(a){if(this.lastCoordinate_){var b=a.coordinate,c=b[0]-this.lastCoordinate_[0],d=b[1]-this.lastCoordinate_[1],e=this.features_||new i.default([this.lastFeature_]);e.forEach(function(a){var b=a.getGeometry();b.translate(c,d),a.setGeometry(b)}),this.lastCoordinate_=b,this.dispatchEvent(new r(q.TRANSLATING,e,b))}}function h(a){var b=a.map.getViewport();this.featuresAtPixel_(a.pixel,a.map)?(b.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),b.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):b.classList.remove("ol-grab","ol-grabbing")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.TranslateEvent=void 0;var i=d(a("../Collection.js")),j=a("../Object.js"),k=a("../events.js"),l=d(a("../events/Event.js")),m=a("../functions.js"),n=a("../array.js"),o=d(a("../interaction/Pointer.js")),p=d(a("../interaction/Property.js")),q={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},r=function(a){function b(b,c,d){a.call(this,b),this.features=c,this.coordinate=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default);c.TranslateEvent=r;var s=function(a){function b(b){a.call(this,{handleDownEvent:e,handleDragEvent:g,handleMoveEvent:h,handleUpEvent:f});var c=b?b:{};this.lastCoordinate_=null,this.features_=void 0!==c.features?c.features:null;var d;if(c.layers)if("function"==typeof c.layers)d=c.layers;else{var i=c.layers;d=function(a){return n.includes(i,a)}}else d=m.TRUE;this.layerFilter_=d,this.hitTolerance_=c.hitTolerance?c.hitTolerance:0,this.lastFeature_=null,k.listen(this,j.getChangeEventType(p.default.ACTIVE),this.handleActiveChanged_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.featuresAtPixel_=function(a,b){return b.forEachFeatureAtPixel(a,function(a){return!this.features_||n.includes(this.features_.getArray(),a)?a:void 0}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},b.prototype.getHitTolerance=function(){return this.hitTolerance_},b.prototype.setHitTolerance=function(a){this.hitTolerance_=a},b.prototype.setMap=function(b){var c=this.getMap();a.prototype.setMap.call(this,b),this.updateState_(c)},b.prototype.handleActiveChanged_=function(){this.updateState_(null)},b.prototype.updateState_=function(a){var b=this.getMap(),c=this.getActive();if((!b||!c)&&(b=b||a)){var d=b.getViewport();d.classList.remove("ol-grab","ol-grabbing")}},b}(o.default),t=s;c.default=t},{"../Collection.js":6,"../Object.js":28,"../array.js":45,"../events.js":65,"../events/Event.js":66,"../functions.js":76,"../interaction/Pointer.js":128,"../interaction/Property.js":129}],133:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Group",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Heatmap",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Layer",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Tile",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"Vector",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"VectorTile",{enumerable:!0,get:function(){return k.default}});var e=d(a("./layer/Group.js")),f=d(a("./layer/Heatmap.js")),g=d(a("./layer/Image.js")),h=d(a("./layer/Layer.js")),i=d(a("./layer/Tile.js")),j=d(a("./layer/Vector.js")),k=d(a("./layer/VectorTile.js"))},{"./layer/Group.js":135,"./layer/Heatmap.js":136,"./layer/Image.js":137,"./layer/Layer.js":138,"./layer/Tile.js":140,"./layer/Vector.js":142,"./layer/VectorTile.js":144}],134:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Object.js")),f=d(a("../layer/Property.js")),g=a("../math.js"),h=a("../obj.js"),i=function(a){function b(b){a.call(this);var c=h.assign({},b);c[f.default.OPACITY]=void 0!==b.opacity?b.opacity:1,c[f.default.VISIBLE]=void 0!==b.visible?b.visible:!0,c[f.default.Z_INDEX]=b.zIndex,c[f.default.MAX_RESOLUTION]=void 0!==b.maxResolution?b.maxResolution:1/0,c[f.default.MIN_RESOLUTION]=void 0!==b.minResolution?b.minResolution:0,this.setProperties(c),this.state_={layer:this,managed:!0},this.type}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return this.type},b.prototype.getLayerState=function(){return this.state_.opacity=g.clamp(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex()||0,this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},b.prototype.getLayersArray=function(){},b.prototype.getLayerStatesArray=function(){},b.prototype.getExtent=function(){return this.get(f.default.EXTENT)},b.prototype.getMaxResolution=function(){return this.get(f.default.MAX_RESOLUTION)},b.prototype.getMinResolution=function(){return this.get(f.default.MIN_RESOLUTION)},b.prototype.getOpacity=function(){return this.get(f.default.OPACITY)},b.prototype.getSourceState=function(){},b.prototype.getVisible=function(){return this.get(f.default.VISIBLE)},b.prototype.getZIndex=function(){return this.get(f.default.Z_INDEX)},b.prototype.setExtent=function(a){this.set(f.default.EXTENT,a)},b.prototype.setMaxResolution=function(a){this.set(f.default.MAX_RESOLUTION,a)},b.prototype.setMinResolution=function(a){this.set(f.default.MIN_RESOLUTION,a)},b.prototype.setOpacity=function(a){this.set(f.default.OPACITY,a)},b.prototype.setVisible=function(a){this.set(f.default.VISIBLE,a)},b.prototype.setZIndex=function(a){this.set(f.default.Z_INDEX,a)},b}(e.default),j=i;c.default=j},{"../Object.js":28,"../layer/Property.js":139,"../math.js":147,"../obj.js":149}],135:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("../Collection.js")),g=d(a("../CollectionEventType.js")),h=a("../Object.js"),i=d(a("../ObjectEventType.js")),j=a("../asserts.js"),k=a("../events.js"),l=d(a("../events/EventType.js")),m=a("../extent.js"),n=d(a("../layer/Base.js")),o=a("../obj.js"),p=d(a("../source/State.js")),q={LAYERS:"layers"},r=function(a){function b(b){var c=b||{},d=o.assign({},c);delete d.layers;var e=c.layers;a.call(this,d),this.layersListenerKeys_=[],this.listenerKeys_={},k.listen(this,h.getChangeEventType(q.LAYERS),this.handleLayersChanged_,this),e?Array.isArray(e)?e=new f.default(e.slice(),{unique:!0}):(j.assert(e instanceof f.default,43),e=e):e=new f.default(void 0,{unique:!0}),this.setLayers(e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleLayerChange_=function(){this.changed()},b.prototype.handleLayersChanged_=function(){var a=this;this.layersListenerKeys_.forEach(k.unlistenByKey),this.layersListenerKeys_.length=0;var b=this.getLayers();this.layersListenerKeys_.push(k.listen(b,g.default.ADD,this.handleLayersAdd_,this),k.listen(b,g.default.REMOVE,this.handleLayersRemove_,this));for(var c in a.listenerKeys_)a.listenerKeys_[c].forEach(k.unlistenByKey);o.clear(this.listenerKeys_);for(var d=b.getArray(),f=0,h=d.length;h>f;f++){var j=d[f];a.listenerKeys_[e.getUid(j).toString()]=[k.listen(j,i.default.PROPERTYCHANGE,a.handleLayerChange_,a),k.listen(j,l.default.CHANGE,a.handleLayerChange_,a)]}this.changed()},b.prototype.handleLayersAdd_=function(a){var b=a.element,c=e.getUid(b).toString();this.listenerKeys_[c]=[k.listen(b,i.default.PROPERTYCHANGE,this.handleLayerChange_,this),k.listen(b,l.default.CHANGE,this.handleLayerChange_,this)],this.changed()},b.prototype.handleLayersRemove_=function(a){var b=a.element,c=e.getUid(b).toString();this.listenerKeys_[c].forEach(k.unlistenByKey),delete this.listenerKeys_[c],this.changed()},b.prototype.getLayers=function(){return this.get(q.LAYERS)},b.prototype.setLayers=function(a){this.set(q.LAYERS,a)},b.prototype.getLayersArray=function(a){var b=void 0!==a?a:[];return this.getLayers().forEach(function(a){a.getLayersArray(b)}),b},b.prototype.getLayerStatesArray=function(a){var b=void 0!==a?a:[],c=b.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(b)});for(var d=this.getLayerState(),e=c,f=b.length;f>e;e++){var g=b[e];g.opacity*=d.opacity,g.visible=g.visible&&d.visible,g.maxResolution=Math.min(g.maxResolution,d.maxResolution),g.minResolution=Math.max(g.minResolution,d.minResolution),void 0!==d.extent&&(g.extent=void 0!==g.extent?m.getIntersection(g.extent,d.extent):d.extent)}return b},b.prototype.getSourceState=function(){return p.default.READY},b}(n.default),s=r;c.default=s},{"../Collection.js":6,"../CollectionEventType.js":7,"../Object.js":28,"../ObjectEventType.js":29,"../asserts.js":46,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../layer/Base.js":134,"../obj.js":149,"../source/State.js":241,"../util.js":289}],136:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){for(var b=1,c=256,d=h.createCanvasContext2D(b,c),e=d.createLinearGradient(0,0,b,c),f=1/(a.length-1),g=0,i=a.length;i>g;++g)e.addColorStop(g*f,a[g]);return d.fillStyle=e,d.fillRect(0,0,b,c),d.getImageData(0,0,b,c).data}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../events.js"),g=a("../Object.js"),h=a("../dom.js"),i=d(a("../layer/Vector.js")),j=a("../math.js"),k=a("../obj.js"),l=d(a("../render/EventType.js")),m=d(a("../style/Icon.js")),n=d(a("../style/Style.js")),o={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},p=["#00f","#0ff","#0f0","#ff0","#f00"],q=function(a){function b(b){var c=b?b:{},d=k.assign({},c);delete d.gradient,delete d.radius,delete d.blur,delete d.shadow,delete d.weight,a.call(this,d),this.gradient_=null,this.shadow_=void 0!==c.shadow?c.shadow:250,this.circleImage_=void 0,this.styleCache_=null,f.listen(this,g.getChangeEventType(o.GRADIENT),this.handleGradientChanged_,this),this.setGradient(c.gradient?c.gradient:p),this.setBlur(void 0!==c.blur?c.blur:15),this.setRadius(void 0!==c.radius?c.radius:8),f.listen(this,g.getChangeEventType(o.BLUR),this.handleStyleChanged_,this),f.listen(this,g.getChangeEventType(o.RADIUS),this.handleStyleChanged_,this),this.handleStyleChanged_();var e,h=c.weight?c.weight:"weight";e="string"==typeof h?function(a){return a.get(h)}:h,this.setStyle(function(a){var b=e(a),c=void 0!==b?j.clamp(b,0,1):1,d=255*c|0,f=this.styleCache_[d];return f||(f=[new n.default({image:new m.default({opacity:c,src:this.circleImage_})})],this.styleCache_[d]=f),f}.bind(this)),this.setRenderOrder(null),f.listen(this,l.default.RENDER,this.handleRender_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createCircle_=function(){var a=this.getRadius(),b=this.getBlur(),c=a+b+1,d=2*c,e=h.createCanvasContext2D(d,d);e.shadowOffsetX=e.shadowOffsetY=this.shadow_,e.shadowBlur=b,e.shadowColor="#000",e.beginPath();var f=c-this.shadow_;return e.arc(f,f,a,0,2*Math.PI,!0),e.fill(),e.canvas.toDataURL()},b.prototype.getBlur=function(){return this.get(o.BLUR)},b.prototype.getGradient=function(){return this.get(o.GRADIENT)},b.prototype.getRadius=function(){return this.get(o.RADIUS)},b.prototype.handleGradientChanged_=function(){this.gradient_=e(this.getGradient())},b.prototype.handleStyleChanged_=function(){this.circleImage_=this.createCircle_(),this.styleCache_=new Array(256),this.changed()},b.prototype.handleRender_=function(a){for(var b=this,c=a.context,d=c.canvas,e=c.getImageData(0,0,d.width,d.height),f=e.data,g=0,h=f.length;h>g;g+=4){var i=4*f[g+3];i&&(f[g]=b.gradient_[i],f[g+1]=b.gradient_[i+1],f[g+2]=b.gradient_[i+2])}c.putImageData(e,0,0)},b.prototype.setBlur=function(a){this.set(o.BLUR,a)},b.prototype.setGradient=function(a){this.set(o.GRADIENT,a)},b.prototype.setRadius=function(a){this.set(o.RADIUS,a)},b}(i.default),r=q;c.default=r},{"../Object.js":28,"../dom.js":63,"../events.js":65,"../layer/Vector.js":142,"../math.js":147,"../obj.js":149,"../render/EventType.js":168,"../style/Icon.js":270,"../style/Style.js":278}],137:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../LayerType.js")),f=d(a("../layer/Layer.js")),g=function(a){function b(b){var c=b?b:{};a.call(this,c),this.type=e.default.IMAGE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(f.default);g.prototype.getSource;var h=g;c.default=h},{"../LayerType.js":19,"../layer/Layer.js":138}],138:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){return a.visible&&b>=a.minResolution&&b<a.maxResolution}Object.defineProperty(c,"__esModule",{value:!0}),c.visibleAtResolution=e,c.default=void 0;var f=a("../events.js"),g=d(a("../events/EventType.js")),h=a("../util.js"),i=a("../Object.js"),j=d(a("../layer/Base.js")),k=d(a("../layer/Property.js")),l=a("../obj.js"),m=d(a("../render/EventType.js")),n=d(a("../source/State.js")),o=function(a){function b(b){var c=l.assign({},b);delete c.source,a.call(this,c),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,b.map&&this.setMap(b.map),f.listen(this,i.getChangeEventType(k.default.SOURCE),this.handleSourcePropertyChange_,this);var d=b.source?b.source:null;this.setSource(d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getLayersArray=function(a){var b=a?a:[];return b.push(this),b},b.prototype.getLayerStatesArray=function(a){var b=a?a:[];return b.push(this.getLayerState()),b},b.prototype.getSource=function(){var a=this.get(k.default.SOURCE);return a||null},b.prototype.getSourceState=function(){var a=this.getSource();return a?a.getState():n.default.UNDEFINED},b.prototype.handleSourceChange_=function(){this.changed()},b.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(f.unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var a=this.getSource();a&&(this.sourceChangeKey_=f.listen(a,g.default.CHANGE,this.handleSourceChange_,this)),this.changed()},b.prototype.setMap=function(a){this.mapPrecomposeKey_&&(f.unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),a||this.changed(),this.mapRenderKey_&&(f.unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),a&&(this.mapPrecomposeKey_=f.listen(a,m.default.PRECOMPOSE,function(a){var b=this.getLayerState();b.managed=!1,void 0===this.getZIndex()&&(b.zIndex=1/0),a.frameState.layerStatesArray.push(b),a.frameState.layerStates[h.getUid(this)]=b},this),this.mapRenderKey_=f.listen(this,g.default.CHANGE,a.render,a),this.changed())},b.prototype.setSource=function(a){this.set(k.default.SOURCE,a)},b}(j.default),p=o;c.default=p},{"../Object.js":28,"../events.js":65,"../events/EventType.js":67,"../layer/Base.js":134,"../layer/Property.js":139,"../obj.js":149,"../render/EventType.js":168,"../source/State.js":241,"../util.js":289}],139:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};c.default=d},{}],140:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../LayerType.js")),f=d(a("../layer/Layer.js")),g=d(a("../layer/TileProperty.js")),h=a("../obj.js"),i=function(a){function b(b){var c=b?b:{},d=h.assign({},c);delete d.preload,delete d.useInterimTilesOnError,a.call(this,d),this.setPreload(void 0!==c.preload?c.preload:0),this.setUseInterimTilesOnError(void 0!==c.useInterimTilesOnError?c.useInterimTilesOnError:!0),this.type=e.default.TILE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPreload=function(){return this.get(g.default.PRELOAD)},b.prototype.setPreload=function(a){this.set(g.default.PRELOAD,a)},b.prototype.getUseInterimTilesOnError=function(){return this.get(g.default.USE_INTERIM_TILES_ON_ERROR)},b.prototype.setUseInterimTilesOnError=function(a){this.set(g.default.USE_INTERIM_TILES_ON_ERROR,a)},b}(f.default);i.prototype.getSource;var j=i;c.default=j},{"../LayerType.js":19,"../layer/Layer.js":138,"../layer/TileProperty.js":141,"../obj.js":149}],141:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};c.default=d},{}],142:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.RenderType=void 0;var e=d(a("../LayerType.js")),f=d(a("../layer/Layer.js")),g=d(a("../layer/VectorRenderType.js")),h=a("../obj.js"),i=a("../style/Style.js"),j={IMAGE:"image",VECTOR:"vector"};c.RenderType=j;var k={RENDER_ORDER:"renderOrder"},l=function(a){function b(b){var c=b?b:{},d=h.assign({},c);delete d.style,delete d.renderBuffer,delete d.updateWhileAnimating,delete d.updateWhileInteracting,a.call(this,d),this.declutter_=void 0!==c.declutter?c.declutter:!1,this.renderBuffer_=void 0!==c.renderBuffer?c.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(c.style),this.updateWhileAnimating_=void 0!==c.updateWhileAnimating?c.updateWhileAnimating:!1,this.updateWhileInteracting_=void 0!==c.updateWhileInteracting?c.updateWhileInteracting:!1,this.renderMode_=c.renderMode||g.default.VECTOR,this.type=e.default.VECTOR}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDeclutter=function(){return this.declutter_},b.prototype.setDeclutter=function(a){this.declutter_=a},b.prototype.getRenderBuffer=function(){return this.renderBuffer_},b.prototype.getRenderOrder=function(){return this.get(k.RENDER_ORDER)},b.prototype.getStyle=function(){return this.style_},b.prototype.getStyleFunction=function(){return this.styleFunction_},b.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},b.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},b.prototype.setRenderOrder=function(a){this.set(k.RENDER_ORDER,a)},b.prototype.setStyle=function(a){this.style_=void 0!==a?a:i.createDefaultStyle,this.styleFunction_=null===a?void 0:i.toFunction(this.style_),this.changed()},b.prototype.getRenderMode=function(){return this.renderMode_},b}(f.default);l.prototype.getSource;var m=l;c.default=m},{"../LayerType.js":19,"../layer/Layer.js":138,"../layer/VectorRenderType.js":143,"../obj.js":149,"../style/Style.js":278}],143:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IMAGE:"image",VECTOR:"vector"};c.default=d},{}],144:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.RenderType=void 0;var e=d(a("../LayerType.js")),f=a("../asserts.js"),g=d(a("../layer/TileProperty.js")),h=d(a("../layer/Vector.js")),i=d(a("../layer/VectorTileRenderType.js")),j=a("../obj.js"),k={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};c.RenderType=k;var l=function(a){function b(b){var c=b?b:{},d=c.renderMode||i.default.HYBRID;f.assert(void 0==d||d==i.default.IMAGE||d==i.default.HYBRID||d==i.default.VECTOR,28),c.declutter&&d==i.default.IMAGE&&(d=i.default.HYBRID),c.renderMode=d;var g=j.assign({},c);delete g.preload,delete g.useInterimTilesOnError,a.call(this,g),this.setPreload(c.preload?c.preload:0),this.setUseInterimTilesOnError(void 0!==c.useInterimTilesOnError?c.useInterimTilesOnError:!0),this.type=e.default.VECTOR_TILE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPreload=function(){return this.get(g.default.PRELOAD)},b.prototype.getUseInterimTilesOnError=function(){return this.get(g.default.USE_INTERIM_TILES_ON_ERROR)},b.prototype.setPreload=function(a){this.set(g.default.PRELOAD,a)},b.prototype.setUseInterimTilesOnError=function(a){this.set(g.default.USE_INTERIM_TILES_ON_ERROR,a)},b}(h.default);l.prototype.getSource;var m=l;c.default=m},{"../LayerType.js":19,"../asserts.js":46,"../layer/TileProperty.js":141,"../layer/Vector.js":142,"../layer/VectorTileRenderType.js":145,"../obj.js":149}],145:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};c.default=d},{}],146:[function(a,b,c){"use strict";function d(){return[[-1/0,-1/0,1/0,1/0]]}function e(a){return[a]}function f(a){return function(b,c){var d=a.getZForResolution(c),e=a.getTileRangeForExtentAndZ(b,d),f=[],g=[d,0,0];for(g[1]=e.minX;g[1]<=e.maxX;++g[1])for(g[2]=e.minY;g[2]<=e.maxY;++g[2])f.push(a.getTileCoordExtent(g));return f}}Object.defineProperty(c,"__esModule",{value:!0}),c.all=d,c.bbox=e,c.tile=f},{}],147:[function(a,b,c){"use strict";function d(a,b,c){return Math.min(Math.max(a,b),c)}function e(a){return m.assert(a>0,29),Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function f(a,b,c,d,e,f){var h=e-c,i=f-d;if(0!==h||0!==i){var j=((a-c)*h+(b-d)*i)/(h*h+i*i);j>1?(c=e,d=f):j>0&&(c+=h*j,d+=i*j)}return g(a,b,c,d)}function g(a,b,c,d){var e=c-a,f=d-b;return e*e+f*f}function h(a){for(var b=a.length,c=0;b>c;c++){for(var d=c,e=Math.abs(a[c][c]),f=c+1;b>f;f++){var g=Math.abs(a[f][c]);g>e&&(e=g,d=f)}if(0===e)return null;var h=a[d];a[d]=a[c],a[c]=h;for(var i=c+1;b>i;i++)for(var j=-a[i][c]/a[c][c],k=c;b+1>k;k++)c==k?a[i][k]=0:a[i][k]+=j*a[c][k]}for(var l=new Array(b),m=b-1;m>=0;m--){l[m]=a[m][b]/a[m][m];for(var n=m-1;n>=0;n--)a[n][b]-=a[n][m]*l[m]}return l}function i(a){return 180*a/Math.PI}function j(a){return a*Math.PI/180}function k(a,b){var c=a%b;return 0>c*b?c+b:c}function l(a,b,c){return a+c*(b-a)}Object.defineProperty(c,"__esModule",{value:!0}),c.clamp=d,c.roundUpToPowerOfTwo=e,c.squaredSegmentDistance=f,c.squaredDistance=g,c.solveLinearSystem=h,c.toDegrees=i,c.toRadians=j,c.modulo=k,c.lerp=l,c.cosh=void 0;var m=a("./asserts.js"),n=function(){var a;return a="cosh"in Math?Math.cosh:function(a){var b=Math.exp(a);return(b+1/b)/2}}();c.cosh=n},{"./asserts.js":46}],148:[function(a,b,c){"use strict";function d(a,b,c,d){function f(){delete window[h],g.parentNode.removeChild(g)}var g=document.createElement("script"),h="olc_"+e.getUid(b);g.async=!0,g.src=a+(-1==a.indexOf("?")?"?":"&")+(d||"callback")+"="+h;var i=setTimeout(function(){f(),c&&c()},1e4);window[h]=function(a){clearTimeout(i),f(),b(a)},document.getElementsByTagName("head")[0].appendChild(g)}Object.defineProperty(c,"__esModule",{value:!0}),c.jsonp=d;var e=a("./util.js")},{"./util.js":289}],149:[function(a,b,c){"use strict";function d(a){for(var b in a)delete a[b]}function e(a){var b=[];for(var c in a)b.push(a[c]);return b}function f(a){var b;for(b in a)return!1;return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.clear=d,c.getValues=e,c.isEmpty=f,c.assign=void 0;var g="function"==typeof Object.assign?Object.assign:function(a){var b=arguments;if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1,e=arguments.length;e>d;++d){var f=b[d];if(void 0!==f&&null!==f)for(var g in f)f.hasOwnProperty(g)&&(c[g]=f[g])}return c};c.assign=g},{}],150:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a,b){this.dispatcher=a,this.mapping_=b
};d.prototype.getEvents=function(){return Object.keys(this.mapping_)},d.prototype.getHandlerForEvent=function(a){return this.mapping_[a]};var e=d;c.default=e},{}],151:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};c.default=d},{}],152:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(!this.isEventSimulatedFromTouch_(a)){l.toString()in this.pointerMap&&this.cancel(a);var b=j(a,this.dispatcher);this.pointerMap[l.toString()]=a,this.dispatcher.down(b,a)}}function f(a){if(!this.isEventSimulatedFromTouch_(a)){var b=j(a,this.dispatcher);this.dispatcher.move(b,a)}}function g(a){if(!this.isEventSimulatedFromTouch_(a)){var b=this.pointerMap[l.toString()];if(b&&b.button===a.button){var c=j(a,this.dispatcher);this.dispatcher.up(c,a),this.cleanupMouse()}}}function h(a){if(!this.isEventSimulatedFromTouch_(a)){var b=j(a,this.dispatcher);this.dispatcher.enterOver(b,a)}}function i(a){if(!this.isEventSimulatedFromTouch_(a)){var b=j(a,this.dispatcher);this.dispatcher.leaveOut(b,a)}}function j(a,b){var c=b.cloneEvent(a,a),d=c.preventDefault;return c.preventDefault=function(){a.preventDefault(),d()},c.pointerId=l,c.isPrimary=!0,c.pointerType=m,c}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.POINTER_TYPE=c.POINTER_ID=void 0;var k=d(a("../pointer/EventSource.js")),l=1;c.POINTER_ID=l;var m="mouse";c.POINTER_TYPE=m;var n=25,o=function(a){function b(b){var c={mousedown:e,mousemove:f,mouseup:g,mouseover:h,mouseout:i};a.call(this,b,c),this.pointerMap=b.pointerMap,this.lastTouches=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.isEventSimulatedFromTouch_=function(a){for(var b=this.lastTouches,c=a.clientX,d=a.clientY,e=0,f=b.length,g=void 0;f>e&&(g=b[e]);e++){var h=Math.abs(c-g[0]),i=Math.abs(d-g[1]);if(n>=h&&n>=i)return!0}return!1},b.prototype.cancel=function(a){var b=j(a,this.dispatcher);this.dispatcher.cancel(b,a),this.cleanupMouse()},b.prototype.cleanupMouse=function(){delete this.pointerMap[l.toString()]},b}(k.default),p=o;c.default=p},{"../pointer/EventSource.js":150}],153:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){this.pointerMap[a.pointerId.toString()]=a;var b=this.prepareEvent_(a);this.dispatcher.down(b,a)}function f(a){var b=this.prepareEvent_(a);this.dispatcher.move(b,a)}function g(a){var b=this.prepareEvent_(a);this.dispatcher.up(b,a),this.cleanup(a.pointerId)}function h(a){var b=this.prepareEvent_(a);this.dispatcher.leaveOut(b,a)}function i(a){var b=this.prepareEvent_(a);this.dispatcher.enterOver(b,a)}function j(a){var b=this.prepareEvent_(a);this.dispatcher.cancel(b,a),this.cleanup(a.pointerId)}function k(a){var b=this.dispatcher.makeEvent("lostpointercapture",a,a);this.dispatcher.dispatchEvent(b)}function l(a){var b=this.dispatcher.makeEvent("gotpointercapture",a,a);this.dispatcher.dispatchEvent(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var m=d(a("../pointer/EventSource.js")),n=["","unavailable","touch","pen","mouse"],o=function(a){function b(b){var c={MSPointerDown:e,MSPointerMove:f,MSPointerUp:g,MSPointerOut:h,MSPointerOver:i,MSPointerCancel:j,MSGotPointerCapture:l,MSLostPointerCapture:k};a.call(this,b,c),this.pointerMap=b.pointerMap}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.prepareEvent_=function(a){var b=a;return"number"==typeof a.pointerType&&(b=this.dispatcher.cloneEvent(a,a),b.pointerType=n[a.pointerType]),b},b.prototype.cleanup=function(a){delete this.pointerMap[a.toString()]},b}(m.default),p=o;c.default=p},{"../pointer/EventSource.js":150}],154:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){this.dispatcher.fireNativeEvent(a)}function f(a){this.dispatcher.fireNativeEvent(a)}function g(a){this.dispatcher.fireNativeEvent(a)}function h(a){this.dispatcher.fireNativeEvent(a)}function i(a){this.dispatcher.fireNativeEvent(a)}function j(a){this.dispatcher.fireNativeEvent(a)}function k(a){this.dispatcher.fireNativeEvent(a)}function l(a){this.dispatcher.fireNativeEvent(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var m=d(a("../pointer/EventSource.js")),n=function(a){function b(b){var c={pointerdown:e,pointermove:f,pointerup:g,pointerout:h,pointerover:i,pointercancel:j,gotpointercapture:l,lostpointercapture:k};a.call(this,b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m.default),o=n;c.default=o},{"../pointer/EventSource.js":150}],155:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../events/Event.js")),f=!1,g=function(a){function b(b,c,d){a.call(this,b),this.originalEvent=c;var e=d?d:{};this.buttons=this.getButtons_(e),this.pressure=this.getPressure_(e,this.buttons),this.bubbles="bubbles"in e?e.bubbles:!1,this.cancelable="cancelable"in e?e.cancelable:!1,this.view="view"in e?e.view:null,this.detail="detail"in e?e.detail:null,this.screenX="screenX"in e?e.screenX:0,this.screenY="screenY"in e?e.screenY:0,this.clientX="clientX"in e?e.clientX:0,this.clientY="clientY"in e?e.clientY:0,this.ctrlKey="ctrlKey"in e?e.ctrlKey:!1,this.altKey="altKey"in e?e.altKey:!1,this.shiftKey="shiftKey"in e?e.shiftKey:!1,this.metaKey="metaKey"in e?e.metaKey:!1,this.button="button"in e?e.button:0,this.relatedTarget="relatedTarget"in e?e.relatedTarget:null,this.pointerId="pointerId"in e?e.pointerId:0,this.width="width"in e?e.width:0,this.height="height"in e?e.height:0,this.tiltX="tiltX"in e?e.tiltX:0,this.tiltY="tiltY"in e?e.tiltY:0,this.pointerType="pointerType"in e?e.pointerType:"",this.hwTimestamp="hwTimestamp"in e?e.hwTimestamp:0,this.isPrimary="isPrimary"in e?e.isPrimary:!1,c.preventDefault&&(this.preventDefault=function(){c.preventDefault()})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getButtons_=function(a){var b;if(a.buttons||f)b=a.buttons;else switch(a.which){case 1:b=1;break;case 2:b=4;break;case 3:b=2;break;default:b=0}return b},b.prototype.getPressure_=function(a,b){var c=0;return c=a.pressure?a.pressure:b?.5:0},b}(e.default);!function(){try{var a=new MouseEvent("click",{buttons:1});f=1===a.buttons}catch(b){}}();var h=g;c.default=h},{"../events/Event.js":66}],156:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../events.js"),f=d(a("../events/Target.js")),g=a("../has.js"),h=d(a("../pointer/EventType.js")),i=d(a("../pointer/MouseSource.js")),j=d(a("../pointer/MsSource.js")),k=d(a("../pointer/NativeSource.js")),l=d(a("../pointer/PointerEvent.js")),m=d(a("../pointer/TouchSource.js")),n=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],o=function(a){function b(b){a.call(this),this.element_=b,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.registerSources=function(){if(g.POINTER)this.registerSource("native",new k.default(this));else if(g.MSPOINTER)this.registerSource("ms",new j.default(this));else{var a=new i.default(this);this.registerSource("mouse",a),g.TOUCH&&this.registerSource("touch",new m.default(this,a))}this.register_()},b.prototype.registerSource=function(a,b){var c=b,d=c.getEvents();d&&(d.forEach(function(a){var b=c.getHandlerForEvent(a);b&&(this.eventMap_[a]=b.bind(c))}.bind(this)),this.eventSourceList_.push(c))},b.prototype.register_=function(){for(var a=this,b=this.eventSourceList_.length,c=0;b>c;c++){var d=a.eventSourceList_[c];a.addEvents_(d.getEvents())}},b.prototype.unregister_=function(){for(var a=this,b=this.eventSourceList_.length,c=0;b>c;c++){var d=a.eventSourceList_[c];a.removeEvents_(d.getEvents())}},b.prototype.eventHandler_=function(a){var b=a.type,c=this.eventMap_[b];c&&c(a)},b.prototype.addEvents_=function(a){a.forEach(function(a){e.listen(this.element_,a,this.eventHandler_,this)}.bind(this))},b.prototype.removeEvents_=function(a){a.forEach(function(a){e.unlisten(this.element_,a,this.eventHandler_,this)}.bind(this))},b.prototype.cloneEvent=function(a,b){for(var c={},d=0,e=n.length;e>d;d++){var f=n[d][0];c[f]=a[f]||b[f]||n[d][1]}return c},b.prototype.down=function(a,b){this.fireEvent(h.default.POINTERDOWN,a,b)},b.prototype.move=function(a,b){this.fireEvent(h.default.POINTERMOVE,a,b)},b.prototype.up=function(a,b){this.fireEvent(h.default.POINTERUP,a,b)},b.prototype.enter=function(a,b){a.bubbles=!1,this.fireEvent(h.default.POINTERENTER,a,b)},b.prototype.leave=function(a,b){a.bubbles=!1,this.fireEvent(h.default.POINTERLEAVE,a,b)},b.prototype.over=function(a,b){a.bubbles=!0,this.fireEvent(h.default.POINTEROVER,a,b)},b.prototype.out=function(a,b){a.bubbles=!0,this.fireEvent(h.default.POINTEROUT,a,b)},b.prototype.cancel=function(a,b){this.fireEvent(h.default.POINTERCANCEL,a,b)},b.prototype.leaveOut=function(a,b){this.out(a,b),this.contains_(a.target,a.relatedTarget)||this.leave(a,b)},b.prototype.enterOver=function(a,b){this.over(a,b),this.contains_(a.target,a.relatedTarget)||this.enter(a,b)},b.prototype.contains_=function(a,b){return a&&b?a.contains(b):!1},b.prototype.makeEvent=function(a,b,c){return new l.default(a,c,b)},b.prototype.fireEvent=function(a,b,c){var d=this.makeEvent(a,b,c);this.dispatchEvent(d)},b.prototype.fireNativeEvent=function(a){var b=this.makeEvent(a.type,a,a);this.dispatchEvent(b)},b.prototype.wrapMouseEvent=function(a,b){var c=this.makeEvent(a,i.default.prepareEvent(b,this),b);return c},b.prototype.disposeInternal=function(){this.unregister_(),a.prototype.disposeInternal.call(this)},b}(f.default),p=o;c.default=p},{"../events.js":65,"../events/Target.js":69,"../has.js":109,"../pointer/EventType.js":151,"../pointer/MouseSource.js":152,"../pointer/MsSource.js":153,"../pointer/NativeSource.js":154,"../pointer/PointerEvent.js":155,"../pointer/TouchSource.js":157}],157:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){this.vacuumTouches_(a),this.setPrimaryTouch_(a.changedTouches[0]),this.dedupSynthMouse_(a),this.clickCount_++,this.processTouches_(a,this.overDown_)}function f(a){this.processTouches_(a,this.moveOverOut_)}function g(a){this.dedupSynthMouse_(a),this.processTouches_(a,this.upOut_)}function h(a){this.processTouches_(a,this.cancelOut_)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=a("../array.js"),j=d(a("../pointer/EventSource.js")),k=a("../pointer/MouseSource.js"),l=200,m="touch",n=function(a){function b(b,c){var d={touchstart:e,touchmove:f,touchend:g,touchcancel:h};a.call(this,b,d),this.pointerMap=b.pointerMap,this.mouseSource=c,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.isPrimaryTouch_=function(a){return this.firstTouchId_===a.identifier},b.prototype.setPrimaryTouch_=function(a){var b=Object.keys(this.pointerMap).length;(0===b||1===b&&k.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=a.identifier,this.cancelResetClickCount_())},b.prototype.removePrimaryPointer_=function(a){a.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},b.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),l)},b.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},b.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},b.prototype.touchToPointer_=function(a,b){var c=this.dispatcher.cloneEvent(a,b);return c.pointerId=b.identifier+2,c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount_,c.button=0,c.buttons=1,c.width=b.webkitRadiusX||b.radiusX||0,c.height=b.webkitRadiusY||b.radiusY||0,c.pressure=b.webkitForce||b.force||.5,c.isPrimary=this.isPrimaryTouch_(b),c.pointerType=m,c.clientX=b.clientX,c.clientY=b.clientY,c.screenX=b.screenX,c.screenY=b.screenY,c},b.prototype.processTouches_=function(a,b){function c(){a.preventDefault()}for(var d=this,e=Array.prototype.slice.call(a.changedTouches),f=e.length,g=0;f>g;++g){var h=d.touchToPointer_(a,e[g]);h.preventDefault=c,b.call(d,a,h)}},b.prototype.findTouch_=function(a,b){for(var c=a.length,d=0;c>d;d++){var e=a[d];if(e.identifier===b)return!0}return!1},b.prototype.vacuumTouches_=function(a){var b=this,c=a.touches,d=Object.keys(this.pointerMap),e=d.length;if(e>=c.length){for(var f=[],g=0;e>g;++g){var h=d[g],i=b.pointerMap[h];h==k.POINTER_ID||b.findTouch_(c,h-2)||f.push(i.out)}for(var j=0;j<f.length;++j)b.cancelOut_(a,f[j])}},b.prototype.overDown_=function(a,b){this.pointerMap[b.pointerId]={target:b.target,out:b,outTarget:b.target},this.dispatcher.over(b,a),this.dispatcher.enter(b,a),this.dispatcher.down(b,a)},b.prototype.moveOverOut_=function(a,b){var c=b,d=this.pointerMap[c.pointerId];if(d){var e=d.out,f=d.outTarget;this.dispatcher.move(c,a),e&&f!==c.target&&(e.relatedTarget=c.target,c.relatedTarget=f,e.target=f,c.target?(this.dispatcher.leaveOut(e,a),this.dispatcher.enterOver(c,a)):(c.target=f,c.relatedTarget=null,this.cancelOut_(a,c))),d.out=c,d.outTarget=c.target}},b.prototype.upOut_=function(a,b){this.dispatcher.up(b,a),this.dispatcher.out(b,a),this.dispatcher.leave(b,a),this.cleanUpPointer_(b)},b.prototype.cancelOut_=function(a,b){this.dispatcher.cancel(b,a),this.dispatcher.out(b,a),this.dispatcher.leave(b,a),this.cleanUpPointer_(b)},b.prototype.cleanUpPointer_=function(a){delete this.pointerMap[a.pointerId],this.removePrimaryPointer_(a)},b.prototype.dedupSynthMouse_=function(a){var b=this.mouseSource.lastTouches,c=a.changedTouches[0];if(this.isPrimaryTouch_(c)){var d=[c.clientX,c.clientY];b.push(d),setTimeout(function(){i.remove(b,d)},this.dedupTimeout_)}},b}(j.default),o=n;c.default=o},{"../array.js":45,"../pointer/EventSource.js":150,"../pointer/MouseSource.js":152}],158:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){var c;if(void 0!==b){for(var d=0,e=a.length;e>d;++d)b[d]=a[d];c=b}else c=a.slice();return c}function g(a,b){if(void 0!==b&&a!==b){for(var c=0,d=a.length;d>c;++c)b[c]=a[c];a=b}return a}function h(a){H.add(a.getCode(),a),I.add(a,a,f)}function i(a){a.forEach(h)}function j(a){var b=null;if(a instanceof F.default)b=a;else if("string"==typeof a){var c=a;b=H.get(c)}return b}function k(a,b,c,d){a=j(a);var e,f=a.getPointResolutionFunc();if(f)e=f(b,c);else{var g=a.getUnits();if(g==G.default.DEGREES&&!d||d==G.default.DEGREES)e=b;else{var h=u(a,j("EPSG:4326")),i=[c[0]-b/2,c[1],c[0]+b/2,c[1],c[0],c[1]-b/2,c[0],c[1]+b/2];i=h(i,i,2);var k=A.getDistance(i.slice(0,2),i.slice(2,4)),l=A.getDistance(i.slice(4,6),i.slice(6,8));e=(k+l)/2;var m=d?G.METERS_PER_UNIT[d]:a.getMetersPerUnit();void 0!==m&&(e/=m)}}return e}function l(a){i(a),a.forEach(function(b){a.forEach(function(a){b!==a&&I.add(b,a,f)})})}function m(a,b,c,d){a.forEach(function(a){b.forEach(function(b){I.add(a,b,c),I.add(b,a,d)})})}function n(){H.clear(),I.clear()}function o(a,b){return a?"string"==typeof a?j(a):a:j(b)}function p(a){return function(b,c,d){for(var e=b.length,f=void 0!==d?d:2,g=void 0!==c?c:new Array(e),h=0;e>h;h+=f){var i=a([b[h],b[h+1]]);g[h]=i[0],g[h+1]=i[1];for(var j=f-1;j>=2;--j)g[h+j]=b[h+j]}return g}}function q(a,b,c,d){var e=j(a),f=j(b);I.add(e,f,p(c)),I.add(f,e,p(d))}function r(a,b){return w(a,"EPSG:4326",void 0!==b?b:"EPSG:3857")}function s(a,b){var c=w(a,void 0!==b?b:"EPSG:3857","EPSG:4326"),d=c[0];return(-180>d||d>180)&&(c[0]=C.modulo(d+180,360)-180),c}function t(a,b){if(a===b)return!0;var c=a.getUnits()===b.getUnits();if(a.getCode()===b.getCode())return c;var d=u(a,b);return d===f&&c}function u(a,b){var c=a.getCode(),d=b.getCode(),e=I.get(c,d);return e||(e=g),e}function v(a,b){var c=j(a),d=j(b);return u(c,d)}function w(a,b,c){var d=v(b,c);return d(a,void 0,a.length)}function x(a,b,c){var d=v(b,c);return B.applyTransform(a,d)}function y(a,b,c){var d=u(b,c);return d(a)}function z(){l(D.PROJECTIONS),l(E.PROJECTIONS),m(E.PROJECTIONS,D.PROJECTIONS,D.fromEPSG4326,D.toEPSG4326)}Object.defineProperty(c,"__esModule",{value:!0}),c.cloneTransform=f,c.identityTransform=g,c.addProjection=h,c.addProjections=i,c.get=j,c.getPointResolution=k,c.addEquivalentProjections=l,c.addEquivalentTransforms=m,c.clearAllProjections=n,c.createProjection=o,c.createTransformFromCoordinateTransform=p,c.addCoordinateTransforms=q,c.fromLonLat=r,c.toLonLat=s,c.equivalent=t,c.getTransformFromProjections=u,c.getTransform=v,c.transform=w,c.transformExtent=x,c.transformWithProjections=y,c.addCommon=z,Object.defineProperty(c,"Projection",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(c,"METERS_PER_UNIT",{enumerable:!0,get:function(){return G.METERS_PER_UNIT}});var A=a("./sphere.js"),B=a("./extent.js"),C=a("./math.js"),D=a("./proj/epsg3857.js"),E=a("./proj/epsg4326.js"),F=e(a("./proj/Projection.js")),G=d(a("./proj/Units.js")),H=d(a("./proj/projections.js")),I=a("./proj/transforms.js");z()},{"./extent.js":71,"./math.js":147,"./proj/Projection.js":159,"./proj/Units.js":160,"./proj/epsg3857.js":161,"./proj/epsg4326.js":162,"./proj/projections.js":164,"./proj/transforms.js":165,"./sphere.js":259}],159:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../proj/Units.js"),e=function(a){this.code_=a.code,this.units_=a.units,this.extent_=void 0!==a.extent?a.extent:null,this.worldExtent_=void 0!==a.worldExtent?a.worldExtent:null,this.axisOrientation_=void 0!==a.axisOrientation?a.axisOrientation:"enu",this.global_=void 0!==a.global?a.global:!1,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=a.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=a.metersPerUnit};e.prototype.canWrapX=function(){return this.canWrapX_},e.prototype.getCode=function(){return this.code_},e.prototype.getExtent=function(){return this.extent_},e.prototype.getUnits=function(){return this.units_},e.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||d.METERS_PER_UNIT[this.units_]},e.prototype.getWorldExtent=function(){return this.worldExtent_},e.prototype.getAxisOrientation=function(){return this.axisOrientation_},e.prototype.isGlobal=function(){return this.global_},e.prototype.setGlobal=function(a){this.global_=a,this.canWrapX_=!(!a||!this.extent_)},e.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},e.prototype.setDefaultTileGrid=function(a){this.defaultTileGrid_=a},e.prototype.setExtent=function(a){this.extent_=a,this.canWrapX_=!(!this.global_||!a)},e.prototype.setWorldExtent=function(a){this.worldExtent_=a},e.prototype.setGetPointResolution=function(a){this.getPointResolutionFunc_=a},e.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var f=e;c.default=f},{"../proj/Units.js":160}],160:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.METERS_PER_UNIT=void 0;var d={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},e={};c.METERS_PER_UNIT=e,e[d.DEGREES]=2*Math.PI*6370997/360,e[d.FEET]=.3048,e[d.METERS]=1,e[d.USFEET]=1200/3937;var f=d;c.default=f},{}],161:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=a.length,e=c>1?c:2,f=b;void 0===f&&(f=e>2?a.slice():new Array(d));for(var g=k,h=0;d>h;h+=e){f[h]=g*a[h]/180;var i=j*Math.log(Math.tan(Math.PI*(a[h+1]+90)/360));i>g?i=g:-g>i&&(i=-g),f[h+1]=i}return f}function f(a,b,c){var d=a.length,e=c>1?c:2,f=b;void 0===f&&(f=e>2?a.slice():new Array(d));for(var g=0;d>g;g+=e)f[g]=180*a[g]/k,f[g+1]=360*Math.atan(Math.exp(a[g+1]/j))/Math.PI-90;return f}Object.defineProperty(c,"__esModule",{value:!0}),c.fromEPSG4326=e,c.toEPSG4326=f,c.PROJECTIONS=c.WORLD_EXTENT=c.EXTENT=c.HALF_SIZE=c.RADIUS=void 0;var g=a("../math.js"),h=d(a("../proj/Projection.js")),i=d(a("../proj/Units.js")),j=6378137;c.RADIUS=j;var k=Math.PI*j;c.HALF_SIZE=k;var l=[-k,-k,k,k];c.EXTENT=l;var m=[-180,-85,180,85];c.WORLD_EXTENT=m;var n=function(a){function b(b){a.call(this,{code:b,units:i.default.METERS,extent:l,global:!0,worldExtent:m,getPointResolution:function(a,b){return a/g.cosh(b[1]/j)}})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default),o=[new n("EPSG:3857"),new n("EPSG:102100"),new n("EPSG:102113"),new n("EPSG:900913"),new n("urn:ogc:def:crs:EPSG:6.18:3:3857"),new n("urn:ogc:def:crs:EPSG::3857"),new n("http://www.opengis.net/gml/srs/epsg.xml#3857")];c.PROJECTIONS=o},{"../math.js":147,"../proj/Projection.js":159,"../proj/Units.js":160}],162:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.PROJECTIONS=c.METERS_PER_UNIT=c.EXTENT=c.RADIUS=void 0;var e=d(a("../proj/Projection.js")),f=d(a("../proj/Units.js")),g=6378137;c.RADIUS=g;var h=[-180,-90,180,90];c.EXTENT=h;var i=Math.PI*g/180;c.METERS_PER_UNIT=i;var j=function(a){function b(b,c){a.call(this,{code:b,units:f.default.DEGREES,extent:h,axisOrientation:c,global:!0,metersPerUnit:i,worldExtent:h})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),k=[new j("CRS:84"),new j("EPSG:4326","neu"),new j("urn:ogc:def:crs:EPSG::4326","neu"),new j("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new j("urn:ogc:def:crs:OGC:1.3:CRS84"),new j("urn:ogc:def:crs:OGC:2:84"),new j("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new j("urn:x-ogc:def:crs:EPSG:4326","neu")];c.PROJECTIONS=k},{"../proj/Projection.js":159,"../proj/Units.js":160}],163:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b,c,d=Object.keys(a.defs),e=d.length;for(b=0;e>b;++b){var i=d[b];if(!f.get(i)){var j=a.defs(i);f.addProjection(new h.default({code:i,axisOrientation:j.axis,metersPerUnit:j.to_meter,units:j.units}))}}for(b=0;e>b;++b){var k=d[b],l=f.get(k);for(c=0;e>c;++c){var m=d[c],n=f.get(m);if(!g.get(k,m))if(a.defs[k]===a.defs[m])f.addEquivalentProjections([l,n]);else{var o=a(k,m);f.addCoordinateTransforms(l,n,o.forward,o.inverse)}}}}Object.defineProperty(c,"__esModule",{value:!0}),c.register=e;var f=a("../proj.js"),g=a("./transforms.js"),h=d(a("./Projection.js"))},{"../proj.js":158,"./Projection.js":159,"./transforms.js":165}],164:[function(a,b,c){"use strict";function d(){g={}}function e(a){return g[a]||null}function f(a,b){g[a]=b}Object.defineProperty(c,"__esModule",{value:!0}),c.clear=d,c.get=e,c.add=f;var g={}},{}],165:[function(a,b,c){"use strict";function d(){i={}}function e(a,b,c){var d=a.getCode(),e=b.getCode();d in i||(i[d]={}),i[d][e]=c}function f(a,b){var c=a.getCode(),d=b.getCode(),e=i[c][d];return delete i[c][d],h.isEmpty(i[c])&&delete i[c],e}function g(a,b){var c;return a in i&&b in i[a]&&(c=i[a][b]),c}Object.defineProperty(c,"__esModule",{value:!0}),c.clear=d,c.add=e,c.remove=f,c.get=g;var h=a("../obj.js"),i={}},{"../obj.js":149}],166:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Disposable.js")),f=d(a("../geom/Polygon.js")),g=function(a){function b(b){a.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+b,this.map_=null,this.startPixel_=null,this.endPixel_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.setMap(null)},b.prototype.render_=function(){var a=this.startPixel_,b=this.endPixel_,c="px",d=this.element_.style;d.left=Math.min(a[0],b[0])+c,d.top=Math.min(a[1],b[1])+c,d.width=Math.abs(b[0]-a[0])+c,d.height=Math.abs(b[1]-a[1])+c},b.prototype.setMap=function(a){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var b=this.element_.style;b.left=b.top=b.width=b.height="inherit"}this.map_=a,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},b.prototype.setPixels=function(a,b){this.startPixel_=a,this.endPixel_=b,this.createOrUpdateGeometry(),this.render_()},b.prototype.createOrUpdateGeometry=function(){var a=this.startPixel_,b=this.endPixel_,c=[a,[a[0],b[1]],b,[b[0],a[1]]],d=c.map(this.map_.getCoordinateFromPixel,this.map_);d[4]=d[0].slice(),this.geometry_?this.geometry_.setCoordinates([d]):this.geometry_=new f.default([d])},b.prototype.getGeometry=function(){return this.geometry_},b}(e.default),h=g;c.default=h},{"../Disposable.js":8,"../geom/Polygon.js":88}],167:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../events/Event.js")),f=function(a){function b(b,c,d,e,f){a.call(this,b),this.vectorContext=c,this.frameState=d,this.context=e,this.glContext=f}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../events/Event.js":66}],168:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render",RENDERCOMPLETE:"rendercomplete"};c.default=d},{}],169:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){};d.prototype.getReplay=function(){},d.prototype.isEmpty=function(){};var e=d;c.default=e},{}],170:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};c.default=d},{}],171:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){};d.prototype.drawCustom=function(){},d.prototype.drawGeometry=function(){},d.prototype.setStyle=function(){},d.prototype.drawCircle=function(){},d.prototype.drawFeature=function(){},d.prototype.drawGeometryCollection=function(){},d.prototype.drawLineString=function(){},d.prototype.drawMultiLineString=function(){},d.prototype.drawMultiPoint=function(){},d.prototype.drawMultiPolygon=function(){},d.prototype.drawPoint=function(){},d.prototype.drawPolygon=function(){},d.prototype.drawText=function(){},d.prototype.setFillStrokeStyle=function(){},d.prototype.setImageStyle=function(){},d.prototype.setTextStyle=function(){};var e=d;c.default=e},{}],172:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){return B||(B=j.createCanvasContext2D(1,1)),B}function f(a,b){var c=e();return a!=c.font&&(c.font=a),c.measureText(b).width}function g(a,b,c,d){0!==b&&(a.translate(c,d),a.rotate(b),a.translate(-c,-d))}function h(a,b,c,d,e,f,g,h,i,j,k){var l;1!=c&&(l=a.globalAlpha,a.globalAlpha=l*c),b&&a.setTransform.apply(a,b),a.drawImage(d,e,f,g,h,i,j,g*k,h*k),l&&(a.globalAlpha=l),b&&a.setTransform.apply(a,F)}Object.defineProperty(c,"__esModule",{value:!0}),c.measureTextWidth=f,c.rotateAtOffset=g,c.drawImage=h,c.resetTransform=c.measureTextHeight=c.checkFont=c.textHeights=c.checkedFonts=c.labelCache=c.defaultLineWidth=c.defaultPadding=c.defaultTextBaseline=c.defaultTextAlign=c.defaultStrokeStyle=c.defaultMiterLimit=c.defaultLineJoin=c.defaultLineDashOffset=c.defaultLineDash=c.defaultLineCap=c.defaultFillStyle=c.defaultFont=void 0;var i=a("../css.js"),j=a("../dom.js"),k=a("../obj.js"),l=d(a("../structs/LRUCache.js")),m=a("../transform.js"),n="10px sans-serif";c.defaultFont=n;var o=[0,0,0,1];c.defaultFillStyle=o;var p="round";c.defaultLineCap=p;var q=[];c.defaultLineDash=q;var r=0;c.defaultLineDashOffset=r;var s="round";c.defaultLineJoin=s;var t=10;c.defaultMiterLimit=t;var u=[0,0,0,1];c.defaultStrokeStyle=u;var v="center";c.defaultTextAlign=v;var w="middle";c.defaultTextBaseline=w;var x=[0,0,0,0];c.defaultPadding=x;var y=1;c.defaultLineWidth=y;var z=new l.default;c.labelCache=z;var A={};c.checkedFonts=A;var B=null,C={};c.textHeights=C;var D=function(){function a(a){for(var b=e(),c=100;700>=c;c+=300){for(var f=c+" ",g=!0,i=0;l>i;++i){var k=j[i];if(b.font=f+h+k,d=b.measureText(m).width,a!=k){b.font=f+h+a+","+k;var n=b.measureText(m).width;g=g&&n!=d}}if(g)return!0}return!1}function b(){var b=!0;for(var d in g)g[d]<f&&(a(d)?(g[d]=f,k.clear(C),B=null,z.clear()):(++g[d],b=!1));b&&(clearInterval(c),c=void 0)}var c,d,f=60,g=A,h="32px ",j=["monospace","serif"],l=j.length,m="wmytzilWMYTZIL@#/&?$%10";return function(d){var e=i.getFontFamilies(d);if(e)for(var h=0,j=e.length;j>h;++h){var k=e[h];k in g||(g[k]=f,a(k)||(g[k]=0,void 0===c&&(c=setInterval(b,32))))}}}();c.checkFont=D;var E=function(){var a,b=C;return function(c){var d=b[c];return void 0==d&&(a||(a=document.createElement("span"),a.textContent="M",a.style.margin=a.style.padding="0 !important",a.style.position="absolute !important",a.style.left="-99999px !important"),a.style.font=c,document.body.appendChild(a),d=b[c]=a.offsetHeight,document.body.removeChild(a)),d}}();c.measureTextHeight=E;var F=m.create();c.resetTransform=F},{"../css.js":62,"../dom.js":63,"../obj.js":149,"../structs/LRUCache.js":261,"../transform.js":287}],173:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../canvas/Instruction.js")),f=d(a("../canvas/Replay.js")),g=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c,d){return this.appendFlatCoordinates(a,b,c,d,!1,!1)},b.prototype.drawPoint=function(a,b){if(this.image_){this.beginGeometry(a,b);var c=a.getFlatCoordinates(),d=a.getStride(),f=this.coordinates.length,g=this.drawCoordinates_(c,0,c.length,d);this.instructions.push([e.default.DRAW_IMAGE,f,g,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([e.default.DRAW_IMAGE,f,g,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(a,b)}},b.prototype.drawMultiPoint=function(a,b){if(this.image_){this.beginGeometry(a,b);var c=a.getFlatCoordinates(),d=a.getStride(),f=this.coordinates.length,g=this.drawCoordinates_(c,0,c.length,d);this.instructions.push([e.default.DRAW_IMAGE,f,g,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([e.default.DRAW_IMAGE,f,g,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(a,b)
}},b.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0},b.prototype.setImageStyle=function(a,b){var c=a.getAnchor(),d=a.getSize(),e=a.getHitDetectionImage(1),f=a.getImage(1),g=a.getOrigin();this.anchorX_=c[0],this.anchorY_=c[1],this.declutterGroup_=b,this.hitDetectionImage_=e,this.image_=f,this.height_=d[1],this.opacity_=a.getOpacity(),this.originX_=g[0],this.originY_=g[1],this.rotateWithView_=a.getRotateWithView(),this.rotation_=a.getRotation(),this.scale_=a.getScale(),this.width_=d[0]},b}(f.default),h=g;c.default=h},{"../canvas/Instruction.js":175,"../canvas/Replay.js":178}],174:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../array.js"),f=a("../../colorlike.js"),g=a("../../extent.js"),h=d(a("../../geom/GeometryType.js")),i=a("../../geom/SimpleGeometry.js"),j=a("../../geom/flat/transform.js"),k=a("../../has.js"),l=d(a("../VectorContext.js")),m=a("../canvas.js"),n=a("../../transform.js"),o=function(a){function b(b,c,d,e,f){a.call(this),this.context_=b,this.pixelRatio_=c,this.extent_=d,this.transform_=e,this.viewRotation_=f,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=n.create()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawImages_=function(a,b,c){var d=this;if(this.image_){var e=j.transform2D(a,b,c,2,this.transform_,this.pixelCoordinates_),f=this.context_,g=this.tmpLocalTransform_,h=f.globalAlpha;1!=this.imageOpacity_&&(f.globalAlpha=h*this.imageOpacity_);var i=this.imageRotation_;this.imageRotateWithView_&&(i+=this.viewRotation_);for(var k=0,l=e.length;l>k;k+=2){var m=e[k]-d.imageAnchorX_,o=e[k+1]-d.imageAnchorY_;if(0!==i||1!=d.imageScale_){var p=m+d.imageAnchorX_,q=o+d.imageAnchorY_;n.compose(g,p,q,d.imageScale_,d.imageScale_,i,-p,-q),f.setTransform.apply(f,g)}f.drawImage(d.image_,d.imageOriginX_,d.imageOriginY_,d.imageWidth_,d.imageHeight_,m,o,d.imageWidth_,d.imageHeight_)}(0!==i||1!=this.imageScale_)&&f.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(f.globalAlpha=h)}},b.prototype.drawText_=function(a,b,c,d){var e=this;if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var f=j.transform2D(a,b,c,d,this.transform_,this.pixelCoordinates_),g=this.context_,h=this.textRotation_;for(this.textRotateWithView_&&(h+=this.viewRotation_);c>b;b+=d){var i=f[b]+e.textOffsetX_,k=f[b+1]+e.textOffsetY_;if(0!==h||1!=e.textScale_){var l=n.compose(e.tmpLocalTransform_,i,k,e.textScale_,e.textScale_,h,-i,-k);g.setTransform.apply(g,l)}e.textStrokeState_&&g.strokeText(e.text_,i,k),e.textFillState_&&g.fillText(e.text_,i,k)}(0!==h||1!=this.textScale_)&&g.setTransform(1,0,0,1,0,0)}},b.prototype.moveToLineTo_=function(a,b,c,d,e){var f=this.context_,g=j.transform2D(a,b,c,d,this.transform_,this.pixelCoordinates_);f.moveTo(g[0],g[1]);var h=g.length;e&&(h-=2);for(var i=2;h>i;i+=2)f.lineTo(g[i],g[i+1]);return e&&f.closePath(),c},b.prototype.drawRings_=function(a,b,c,d){for(var e=this,f=0,g=c.length;g>f;++f)b=e.moveToLineTo_(a,b,c[f],d,!0);return b},b.prototype.drawCircle=function(a){if(g.intersects(this.extent_,a.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=i.transformGeom2D(a,this.transform_,this.pixelCoordinates_),c=b[2]-b[0],d=b[3]-b[1],e=Math.sqrt(c*c+d*d),f=this.context_;f.beginPath(),f.arc(b[0],b[1],e,0,2*Math.PI),this.fillState_&&f.fill(),this.strokeState_&&f.stroke()}""!==this.text_&&this.drawText_(a.getCenter(),0,2,2)}},b.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke()),this.setImageStyle(a.getImage()),this.setTextStyle(a.getText())},b.prototype.drawGeometry=function(a){var b=a.getType();switch(b){case h.default.POINT:this.drawPoint(a);break;case h.default.LINE_STRING:this.drawLineString(a);break;case h.default.POLYGON:this.drawPolygon(a);break;case h.default.MULTI_POINT:this.drawMultiPoint(a);break;case h.default.MULTI_LINE_STRING:this.drawMultiLineString(a);break;case h.default.MULTI_POLYGON:this.drawMultiPolygon(a);break;case h.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(a);break;case h.default.CIRCLE:this.drawCircle(a)}},b.prototype.drawFeature=function(a,b){var c=b.getGeometryFunction()(a);c&&g.intersects(this.extent_,c.getExtent())&&(this.setStyle(b),this.drawGeometry(c))},b.prototype.drawGeometryCollection=function(a){for(var b=this,c=a.getGeometriesArray(),d=0,e=c.length;e>d;++d)b.drawGeometry(c[d])},b.prototype.drawPoint=function(a){var b=a.getFlatCoordinates(),c=a.getStride();this.image_&&this.drawImages_(b,0,b.length,c),""!==this.text_&&this.drawText_(b,0,b.length,c)},b.prototype.drawMultiPoint=function(a){var b=a.getFlatCoordinates(),c=a.getStride();this.image_&&this.drawImages_(b,0,b.length,c),""!==this.text_&&this.drawText_(b,0,b.length,c)},b.prototype.drawLineString=function(a){if(g.intersects(this.extent_,a.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var b=this.context_,c=a.getFlatCoordinates();b.beginPath(),this.moveToLineTo_(c,0,c.length,a.getStride(),!1),b.stroke()}if(""!==this.text_){var d=a.getFlatMidpoint();this.drawText_(d,0,2,2)}}},b.prototype.drawMultiLineString=function(a){var b=this,c=a.getExtent();if(g.intersects(this.extent_,c)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var d=this.context_,e=a.getFlatCoordinates(),f=0,h=a.getEnds(),i=a.getStride();d.beginPath();for(var j=0,k=h.length;k>j;++j)f=b.moveToLineTo_(e,f,h[j],i,!1);d.stroke()}if(""!==this.text_){var l=a.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}},b.prototype.drawPolygon=function(a){if(g.intersects(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=this.context_;b.beginPath(),this.drawRings_(a.getOrientedFlatCoordinates(),0,a.getEnds(),a.getStride()),this.fillState_&&b.fill(),this.strokeState_&&b.stroke()}if(""!==this.text_){var c=a.getFlatInteriorPoint();this.drawText_(c,0,2,2)}}},b.prototype.drawMultiPolygon=function(a){var b=this;if(g.intersects(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var c=this.context_,d=a.getOrientedFlatCoordinates(),e=0,f=a.getEndss(),h=a.getStride();c.beginPath();for(var i=0,j=f.length;j>i;++i){var k=f[i];e=b.drawRings_(d,e,k,h)}this.fillState_&&c.fill(),this.strokeState_&&c.stroke()}if(""!==this.text_){var l=a.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}},b.prototype.setContextFillState_=function(a){var b=this.context_,c=this.contextFillState_;c?c.fillStyle!=a.fillStyle&&(c.fillStyle=b.fillStyle=a.fillStyle):(b.fillStyle=a.fillStyle,this.contextFillState_={fillStyle:a.fillStyle})},b.prototype.setContextStrokeState_=function(a){var b=this.context_,c=this.contextStrokeState_;c?(c.lineCap!=a.lineCap&&(c.lineCap=b.lineCap=a.lineCap),k.CANVAS_LINE_DASH&&(e.equals(c.lineDash,a.lineDash)||b.setLineDash(c.lineDash=a.lineDash),c.lineDashOffset!=a.lineDashOffset&&(c.lineDashOffset=b.lineDashOffset=a.lineDashOffset)),c.lineJoin!=a.lineJoin&&(c.lineJoin=b.lineJoin=a.lineJoin),c.lineWidth!=a.lineWidth&&(c.lineWidth=b.lineWidth=a.lineWidth),c.miterLimit!=a.miterLimit&&(c.miterLimit=b.miterLimit=a.miterLimit),c.strokeStyle!=a.strokeStyle&&(c.strokeStyle=b.strokeStyle=a.strokeStyle)):(b.lineCap=a.lineCap,k.CANVAS_LINE_DASH&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineJoin=a.lineJoin,b.lineWidth=a.lineWidth,b.miterLimit=a.miterLimit,b.strokeStyle=a.strokeStyle,this.contextStrokeState_={lineCap:a.lineCap,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset,lineJoin:a.lineJoin,lineWidth:a.lineWidth,miterLimit:a.miterLimit,strokeStyle:a.strokeStyle})},b.prototype.setContextTextState_=function(a){var b=this.context_,c=this.contextTextState_,d=a.textAlign?a.textAlign:m.defaultTextAlign;c?(c.font!=a.font&&(c.font=b.font=a.font),c.textAlign!=d&&(c.textAlign=b.textAlign=d),c.textBaseline!=a.textBaseline&&(c.textBaseline=b.textBaseline=a.textBaseline)):(b.font=a.font,b.textAlign=d,b.textBaseline=a.textBaseline,this.contextTextState_={font:a.font,textAlign:d,textBaseline:a.textBaseline})},b.prototype.setFillStrokeStyle=function(a,b){if(a){var c=a.getColor();this.fillState_={fillStyle:f.asColorLike(c?c:m.defaultFillStyle)}}else this.fillState_=null;if(b){var d=b.getColor(),e=b.getLineCap(),g=b.getLineDash(),h=b.getLineDashOffset(),i=b.getLineJoin(),j=b.getWidth(),k=b.getMiterLimit();this.strokeState_={lineCap:void 0!==e?e:m.defaultLineCap,lineDash:g?g:m.defaultLineDash,lineDashOffset:h?h:m.defaultLineDashOffset,lineJoin:void 0!==i?i:m.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==j?j:m.defaultLineWidth),miterLimit:void 0!==k?k:m.defaultMiterLimit,strokeStyle:f.asColorLike(d?d:m.defaultStrokeStyle)}}else this.strokeState_=null},b.prototype.setImageStyle=function(a){if(a){var b=a.getAnchor(),c=a.getImage(1),d=a.getOrigin(),e=a.getSize();this.imageAnchorX_=b[0],this.imageAnchorY_=b[1],this.imageHeight_=e[1],this.image_=c,this.imageOpacity_=a.getOpacity(),this.imageOriginX_=d[0],this.imageOriginY_=d[1],this.imageRotateWithView_=a.getRotateWithView(),this.imageRotation_=a.getRotation(),this.imageScale_=a.getScale()*this.pixelRatio_,this.imageWidth_=e[0]}else this.image_=null},b.prototype.setTextStyle=function(a){if(a){var b=a.getFill();if(b){var c=b.getColor();this.textFillState_={fillStyle:f.asColorLike(c?c:m.defaultFillStyle)}}else this.textFillState_=null;var d=a.getStroke();if(d){var e=d.getColor(),g=d.getLineCap(),h=d.getLineDash(),i=d.getLineDashOffset(),j=d.getLineJoin(),k=d.getWidth(),l=d.getMiterLimit();this.textStrokeState_={lineCap:void 0!==g?g:m.defaultLineCap,lineDash:h?h:m.defaultLineDash,lineDashOffset:i?i:m.defaultLineDashOffset,lineJoin:void 0!==j?j:m.defaultLineJoin,lineWidth:void 0!==k?k:m.defaultLineWidth,miterLimit:void 0!==l?l:m.defaultMiterLimit,strokeStyle:f.asColorLike(e?e:m.defaultStrokeStyle)}}else this.textStrokeState_=null;var n=a.getFont(),o=a.getOffsetX(),p=a.getOffsetY(),q=a.getRotateWithView(),r=a.getRotation(),s=a.getScale(),t=a.getText(),u=a.getTextAlign(),v=a.getTextBaseline();this.textState_={font:void 0!==n?n:m.defaultFont,textAlign:void 0!==u?u:m.defaultTextAlign,textBaseline:void 0!==v?v:m.defaultTextBaseline},this.text_=void 0!==t?t:"",this.textOffsetX_=void 0!==o?this.pixelRatio_*o:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==q?q:!1,this.textRotation_=void 0!==r?r:0,this.textScale_=this.pixelRatio_*(void 0!==s?s:1)}else this.text_=""},b}(l.default),p=o;c.default=p},{"../../array.js":45,"../../colorlike.js":49,"../../extent.js":71,"../../geom/GeometryType.js":81,"../../geom/SimpleGeometry.js":89,"../../geom/flat/transform.js":108,"../../has.js":109,"../../transform.js":287,"../VectorContext.js":171,"../canvas.js":172}],175:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.closePathInstruction=c.beginPathInstruction=c.strokeInstruction=c.fillInstruction=void 0;var d={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},e=[d.FILL];c.fillInstruction=e;var f=[d.STROKE];c.strokeInstruction=f;var g=[d.BEGIN_PATH];c.beginPathInstruction=g;var h=[d.CLOSE_PATH];c.closePathInstruction=h;var i=d;c.default=i},{}],176:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("../canvas/Instruction.js")),g=d(a("../canvas/Replay.js")),h=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawFlatCoordinates_=function(a,b,c,d){var e=this.coordinates.length,g=this.appendFlatCoordinates(a,b,c,d,!1,!1),h=[f.default.MOVE_TO_LINE_TO,e,g];return this.instructions.push(h),this.hitDetectionInstructions.push(h),c},b.prototype.drawLineString=function(a,b){var c=this.state,d=c.strokeStyle,e=c.lineWidth;if(void 0!==d&&void 0!==e){this.updateStrokeStyle(c,this.applyStroke),this.beginGeometry(a,b),this.hitDetectionInstructions.push([f.default.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset],f.beginPathInstruction);var g=a.getFlatCoordinates(),h=a.getStride();this.drawFlatCoordinates_(g,0,g.length,h),this.hitDetectionInstructions.push(f.strokeInstruction),this.endGeometry(a,b)}},b.prototype.drawMultiLineString=function(a,b){var c=this,d=this.state,e=d.strokeStyle,g=d.lineWidth;if(void 0!==e&&void 0!==g){this.updateStrokeStyle(d,this.applyStroke),this.beginGeometry(a,b),this.hitDetectionInstructions.push([f.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset],f.beginPathInstruction);for(var h=a.getEnds(),i=a.getFlatCoordinates(),j=a.getStride(),k=0,l=0,m=h.length;m>l;++l)k=c.drawFlatCoordinates_(i,k,h[l],j);this.hitDetectionInstructions.push(f.strokeInstruction),this.endGeometry(a,b)}},b.prototype.finish=function(){var a=this.state;void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&this.instructions.push(f.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null},b.prototype.applyStroke=function(b){void 0!=b.lastStroke&&b.lastStroke!=this.coordinates.length&&(this.instructions.push(f.strokeInstruction),b.lastStroke=this.coordinates.length),b.lastStroke=0,a.prototype.applyStroke.call(this,b),this.instructions.push(f.beginPathInstruction)},b}(g.default),i=h;c.default=i},{"../canvas/Instruction.js":175,"../canvas/Replay.js":178}],177:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../color.js"),g=a("../../geom/flat/simplify.js"),h=a("../canvas.js"),i=e(a("../canvas/Instruction.js")),j=d(a("../canvas/Replay.js")),k=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawFlatCoordinatess_=function(a,b,c,d){var e=this,f=this.state,g=void 0!==f.fillStyle,h=void 0!=f.strokeStyle,j=c.length;this.instructions.push(i.beginPathInstruction),this.hitDetectionInstructions.push(i.beginPathInstruction);for(var k=0;j>k;++k){var l=c[k],m=e.coordinates.length,n=e.appendFlatCoordinates(a,b,l,d,!0,!h),o=[i.default.MOVE_TO_LINE_TO,m,n];e.instructions.push(o),e.hitDetectionInstructions.push(o),h&&(e.instructions.push(i.closePathInstruction),e.hitDetectionInstructions.push(i.closePathInstruction)),b=l}return g&&(this.instructions.push(i.fillInstruction),this.hitDetectionInstructions.push(i.fillInstruction)),h&&(this.instructions.push(i.strokeInstruction),this.hitDetectionInstructions.push(i.strokeInstruction)),b},b.prototype.drawCircle=function(a,b){var c=this.state,d=c.fillStyle,e=c.strokeStyle;if(void 0!==d||void 0!==e){this.setFillStrokeStyles_(a),this.beginGeometry(a,b),void 0!==c.fillStyle&&this.hitDetectionInstructions.push([i.default.SET_FILL_STYLE,f.asString(h.defaultFillStyle)]),void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset]);var g=a.getFlatCoordinates(),j=a.getStride(),k=this.coordinates.length;this.appendFlatCoordinates(g,0,g.length,j,!1,!1);var l=[i.default.CIRCLE,k];this.instructions.push(i.beginPathInstruction,l),this.hitDetectionInstructions.push(i.beginPathInstruction,l),this.hitDetectionInstructions.push(i.fillInstruction),void 0!==c.fillStyle&&this.instructions.push(i.fillInstruction),void 0!==c.strokeStyle&&(this.instructions.push(i.strokeInstruction),this.hitDetectionInstructions.push(i.strokeInstruction)),this.endGeometry(a,b)}},b.prototype.drawPolygon=function(a,b){var c=this.state,d=c.fillStyle,e=c.strokeStyle;if(void 0!==d||void 0!==e){this.setFillStrokeStyles_(a),this.beginGeometry(a,b),void 0!==c.fillStyle&&this.hitDetectionInstructions.push([i.default.SET_FILL_STYLE,f.asString(h.defaultFillStyle)]),void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset]);var g=a.getEnds(),j=a.getOrientedFlatCoordinates(),k=a.getStride();this.drawFlatCoordinatess_(j,0,g,k),this.endGeometry(a,b)}},b.prototype.drawMultiPolygon=function(a,b){var c=this,d=this.state,e=d.fillStyle,g=d.strokeStyle;if(void 0!==e||void 0!==g){this.setFillStrokeStyles_(a),this.beginGeometry(a,b),void 0!==d.fillStyle&&this.hitDetectionInstructions.push([i.default.SET_FILL_STYLE,f.asString(h.defaultFillStyle)]),void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset]);for(var j=a.getEndss(),k=a.getOrientedFlatCoordinates(),l=a.getStride(),m=0,n=0,o=j.length;o>n;++n)m=c.drawFlatCoordinatess_(k,m,j[n],l);this.endGeometry(a,b)}},b.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var a=this.tolerance;if(0!==a)for(var b=this.coordinates,c=0,d=b.length;d>c;++c)b[c]=g.snap(b[c],a)},b.prototype.setFillStrokeStyles_=function(a){var b=this.state,c=b.fillStyle;void 0!==c&&this.updateFillStyle(b,this.createFill,a),void 0!==b.strokeStyle&&this.updateStrokeStyle(b,this.applyStroke)},b}(j.default),l=k;c.default=l},{"../../color.js":48,"../../geom/flat/simplify.js":104,"../canvas.js":172,"../canvas/Instruction.js":175,"../canvas/Replay.js":178}],178:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../functions.js"),g=a("../../array.js"),h=a("../../colorlike.js"),i=a("../../extent.js"),j=d(a("../../extent/Relationship.js")),k=d(a("../../geom/GeometryType.js")),l=a("../../geom/flat/inflate.js"),m=a("../../geom/flat/length.js"),n=a("../../geom/flat/textpath.js"),o=a("../../geom/flat/transform.js"),p=a("../../has.js"),q=a("../../obj.js"),r=d(a("../VectorContext.js")),s=a("../canvas.js"),t=d(a("../canvas/Instruction.js")),u=a("../replay.js"),v=a("../../transform.js"),w=i.createEmpty(),x=v.create(),y=function(a){function b(b,c,d,e,f,g){a.call(this),this.declutterTree=g,this.tolerance=b,this.maxExtent=c,this.overlaps=f,this.pixelRatio=e,this.maxLineWidth=0,this.resolution=d,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=v.create(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.replayTextBackground_=function(a,b,c,d,e,f,g){a.beginPath(),a.moveTo.apply(a,b),a.lineTo.apply(a,c),a.lineTo.apply(a,d),a.lineTo.apply(a,e),a.lineTo.apply(a,b),f&&(this.alignFill_=f[2],this.fill_(a)),g&&(this.setStrokeStyle_(a,g),a.stroke())},b.prototype.replayImage_=function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,t){var u=r||t;e*=n,f*=n,b-=e,c-=f;var y,z,A,B,C=p+k>d.width?d.width-k:p,D=h+l>d.height?d.height-l:h,E=q[3]+C*n+q[1],F=q[0]+D*n+q[2],G=b-q[3],H=c-q[0];(u||0!==m)&&(y=[G,H],z=[G+E,H],A=[G+E,H+F],B=[G,H+F]);var I=null;if(0!==m){var J=b+e,K=c+f;I=v.compose(x,J,K,1,1,m,-J,-K),i.createOrUpdateEmpty(w),i.extendCoordinate(w,v.apply(x,y)),i.extendCoordinate(w,v.apply(x,z)),i.extendCoordinate(w,v.apply(x,A)),i.extendCoordinate(w,v.apply(x,B))}else i.createOrUpdate(G,H,G+E,H+F,w);var L=a.canvas,M=t?t[2]*n/2:0,N=w[0]-M<=L.width&&w[2]+M>=0&&w[1]-M<=L.height&&w[3]+M>=0;if(o&&(b=Math.round(b),c=Math.round(c)),g){if(!N&&1==g[4])return;i.extend(g,w);var O=N?[a,I?I.slice(0):null,j,d,k,l,C,D,b,c,n]:null;O&&u&&O.push(r,t,y,z,A,B),g.push(O)}else N&&(u&&this.replayTextBackground_(a,y,z,A,B,r,t),s.drawImage(a,I,j,d,k,l,C,D,b,c,n))},b.prototype.applyPixelRatio=function(a){var b=this.pixelRatio;return 1==b?a:a.map(function(a){return a*b})},b.prototype.appendFlatCoordinates=function(a,b,c,d,e,f){var g=this,h=this.coordinates.length,k=this.getBufferedMaxExtent();f&&(b+=d);var l,m,n,o=[a[b],a[b+1]],p=[0/0,0/0],q=!0;for(l=b+d;c>l;l+=d)p[0]=a[l],p[1]=a[l+1],n=i.coordinateRelationship(k,p),n!==m?(q&&(g.coordinates[h++]=o[0],g.coordinates[h++]=o[1]),g.coordinates[h++]=p[0],g.coordinates[h++]=p[1],q=!1):n===j.default.INTERSECTING?(g.coordinates[h++]=p[0],g.coordinates[h++]=p[1],q=!1):q=!0,o[0]=p[0],o[1]=p[1],m=n;return(e&&q||l===b+d)&&(this.coordinates[h++]=o[0],this.coordinates[h++]=o[1]),h},b.prototype.drawCustomCoordinates_=function(a,b,c,d,e){for(var f=this,g=0,h=c.length;h>g;++g){var i=c[g],j=f.appendFlatCoordinates(a,b,i,d,!1,!1);e.push(j),b=i}return b},b.prototype.drawCustom=function(a,b,c){var d=this;this.beginGeometry(a,b);var e,f,g,h,i,j=a.getType(),m=a.getStride(),n=this.coordinates.length;if(j==k.default.MULTI_POLYGON){a=a,e=a.getOrientedFlatCoordinates(),h=[];var o=a.getEndss();i=0;for(var p=0,q=o.length;q>p;++p){var r=[];i=d.drawCustomCoordinates_(e,i,o[p],m,r),h.push(r)}this.instructions.push([t.default.CUSTOM,n,h,a,c,l.inflateMultiCoordinatesArray])}else j==k.default.POLYGON||j==k.default.MULTI_LINE_STRING?(g=[],e=j==k.default.POLYGON?a.getOrientedFlatCoordinates():a.getFlatCoordinates(),i=this.drawCustomCoordinates_(e,0,a.getEnds(),m,g),this.instructions.push([t.default.CUSTOM,n,g,a,c,l.inflateCoordinatesArray])):j==k.default.LINE_STRING||j==k.default.MULTI_POINT?(e=a.getFlatCoordinates(),f=this.appendFlatCoordinates(e,0,e.length,m,!1,!1),this.instructions.push([t.default.CUSTOM,n,f,a,c,l.inflateCoordinates])):j==k.default.POINT&&(e=a.getFlatCoordinates(),this.coordinates.push(e[0],e[1]),f=this.coordinates.length,this.instructions.push([t.default.CUSTOM,n,f,a,c]));this.endGeometry(a,b)},b.prototype.beginGeometry=function(a,b){this.beginGeometryInstruction1_=[t.default.BEGIN_GEOMETRY,b,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[t.default.BEGIN_GEOMETRY,b,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},b.prototype.fill_=function(a){if(this.alignFill_){var b=v.apply(this.renderedTransform_,[0,0]),c=512*this.pixelRatio;a.translate(b[0]%c,b[1]%c),a.rotate(this.viewRotation_)}a.fill(),this.alignFill_&&a.setTransform.apply(a,s.resetTransform)},b.prototype.setStrokeStyle_=function(a,b){a.strokeStyle=b[1],a.lineWidth=b[2],a.lineCap=b[3],a.lineJoin=b[4],a.miterLimit=b[5],p.CANVAS_LINE_DASH&&(a.lineDashOffset=b[7],a.setLineDash(b[6]))},b.prototype.renderDeclutter_=function(a,b){var c=this;if(a&&a.length>5){var d=a[4];if(1==d||d==a.length-5){var e={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};if(!this.declutterTree.collides(e)){this.declutterTree.insert(e);for(var f=5,g=a.length;g>f;++f){var h=a[f];h&&(h.length>11&&c.replayTextBackground_(h[0],h[13],h[14],h[15],h[16],h[11],h[12]),s.drawImage.apply(void 0,h))}}a.length=5,i.createOrUpdateEmpty(a)}}},b.prototype.replay_=function(a,b,c,d,f,h,j){var k,l=this;this.pixelCoordinates_&&g.equals(b,this.renderedTransform_)?k=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),k=o.transform2D(this.coordinates,0,this.coordinates.length,2,b,this.pixelCoordinates_),v.setFromArray(this.renderedTransform_,b));for(var p,r,w,x,y,z,A,B,C,D,E,F,G=!q.isEmpty(c),H=0,I=d.length,J=0,K=0,L=0,M=null,N=null,O=this.coordinateCache_,P=this.viewRotation_,Q={context:a,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},R=this.instructions!=d||this.overlaps?0:200;I>H;){var S=d[H],T=S[0];switch(T){case t.default.BEGIN_GEOMETRY:D=S[1],G&&c[e.getUid(D).toString()]||!D.getGeometry()?H=S[2]:void 0===j||i.intersects(j,D.getGeometry().getExtent())?++H:H=S[2]+1;break;case t.default.BEGIN_PATH:K>R&&(l.fill_(a),K=0),L>R&&(a.stroke(),L=0),K||L||(a.beginPath(),x=y=0/0),++H;break;case t.default.CIRCLE:J=S[1];var U=k[J],V=k[J+1],W=k[J+2],X=k[J+3],Y=W-U,Z=X-V,$=Math.sqrt(Y*Y+Z*Z);a.moveTo(U+$,V),a.arc(U,V,$,0,2*Math.PI,!0),++H;break;case t.default.CLOSE_PATH:a.closePath(),++H;break;case t.default.CUSTOM:J=S[1],p=S[2];var _=S[3],ab=S[4],bb=6==S.length?S[5]:void 0;Q.geometry=_,Q.feature=D,H in O||(O[H]=[]);var cb=O[H];bb?bb(k,J,p,2,cb):(cb[0]=k[J],cb[1]=k[J+1],cb.length=2),ab(cb,Q),++H;break;case t.default.DRAW_IMAGE:J=S[1],p=S[2],C=S[3],r=S[4],w=S[5],B=h?null:S[6];var db=S[7],eb=S[8],fb=S[9],gb=S[10],hb=S[11],ib=S[12],jb=S[13],kb=S[14],lb=void 0,mb=void 0,nb=void 0;for(S.length>16?(lb=S[15],mb=S[16],nb=S[17]):(lb=s.defaultPadding,mb=nb=!1),hb&&(ib+=P);p>J;J+=2)l.replayImage_(a,k[J],k[J+1],C,r,w,B,db,eb,fb,gb,ib,jb,f,kb,lb,mb?M:null,nb?N:null);l.renderDeclutter_(B,D),++H;break;case t.default.DRAW_CHARS:var ob=S[1],pb=S[2],qb=S[3];B=h?null:S[4];var rb=S[5],sb=S[6],tb=S[7],ub=S[8],vb=S[9],wb=S[10],xb=S[11],yb=S[12],zb=S[13],Ab=S[14],Bb=m.lineStringLength(k,ob,pb,2),Cb=ub(yb);if(rb||Bb>=Cb){var Db=l.textStates[zb].textAlign,Eb=(Bb-Cb)*u.TEXT_ALIGN[Db],Fb=n.drawTextOnPath(k,ob,pb,2,yb,ub,Eb,tb);if(Fb){var Gb=void 0,Hb=void 0,Ib=void 0,Jb=void 0,Kb=void 0;if(wb)for(Gb=0,Hb=Fb.length;Hb>Gb;++Gb)Kb=Fb[Gb],Ib=Kb[4],Jb=l.getImage(Ib,zb,"",wb),r=Kb[2]+xb,w=qb*Jb.height+2*(.5-qb)*xb-vb,l.replayImage_(a,Kb[0],Kb[1],Jb,r,w,B,Jb.height,1,0,0,Kb[3],Ab,!1,Jb.width,s.defaultPadding,null,null);if(sb)for(Gb=0,Hb=Fb.length;Hb>Gb;++Gb)Kb=Fb[Gb],Ib=Kb[4],Jb=l.getImage(Ib,zb,sb,""),r=Kb[2],w=qb*Jb.height-vb,l.replayImage_(a,Kb[0],Kb[1],Jb,r,w,B,Jb.height,1,0,0,Kb[3],Ab,!1,Jb.width,s.defaultPadding,null,null)}}l.renderDeclutter_(B,D),++H;break;case t.default.END_GEOMETRY:if(void 0!==h){D=S[1];var Lb=h(D);if(Lb)return Lb}++H;break;case t.default.FILL:R?K++:l.fill_(a),++H;break;case t.default.MOVE_TO_LINE_TO:for(J=S[1],p=S[2],E=k[J],F=k[J+1],z=E+.5|0,A=F+.5|0,(z!==x||A!==y)&&(a.moveTo(E,F),x=z,y=A),J+=2;p>J;J+=2)E=k[J],F=k[J+1],z=E+.5|0,A=F+.5|0,(J==p-2||z!==x||A!==y)&&(a.lineTo(E,F),x=z,y=A);++H;break;case t.default.SET_FILL_STYLE:M=S,l.alignFill_=S[2],K&&(l.fill_(a),K=0,L&&(a.stroke(),L=0)),a.fillStyle=S[1],++H;break;case t.default.SET_STROKE_STYLE:N=S,L&&(a.stroke(),L=0),l.setStrokeStyle_(a,S),++H;break;case t.default.STROKE:R?L++:a.stroke(),++H;break;default:++H}}return K&&this.fill_(a),void(L&&a.stroke())},b.prototype.replay=function(a,b,c,d,e){this.viewRotation_=c,this.replay_(a,b,d,this.instructions,e,void 0,void 0)},b.prototype.replayHitDetection=function(a,b,c,d,e,f){return this.viewRotation_=c,this.replay_(a,b,d,this.hitDetectionInstructions,!0,e,f)},b.prototype.reverseHitDetectionInstructions=function(){var a=this,b=this.hitDetectionInstructions;b.reverse();var c,d,e,f=b.length,h=-1;for(c=0;f>c;++c)d=b[c],e=d[0],e==t.default.END_GEOMETRY?h=c:e==t.default.BEGIN_GEOMETRY&&(d[2]=c,g.reverseSubArray(a.hitDetectionInstructions,h,c),h=-1)},b.prototype.setFillStrokeStyle=function(a,b){var c=this.state;if(a){var d=a.getColor();c.fillStyle=h.asColorLike(d?d:s.defaultFillStyle)}else c.fillStyle=void 0;if(b){var e=b.getColor();c.strokeStyle=h.asColorLike(e?e:s.defaultStrokeStyle);var f=b.getLineCap();c.lineCap=void 0!==f?f:s.defaultLineCap;var g=b.getLineDash();c.lineDash=g?g.slice():s.defaultLineDash;var i=b.getLineDashOffset();c.lineDashOffset=i?i:s.defaultLineDashOffset;var j=b.getLineJoin();c.lineJoin=void 0!==j?j:s.defaultLineJoin;var k=b.getWidth();c.lineWidth=void 0!==k?k:s.defaultLineWidth;var l=b.getMiterLimit();c.miterLimit=void 0!==l?l:s.defaultMiterLimit,c.lineWidth>this.maxLineWidth&&(this.maxLineWidth=c.lineWidth,this.bufferedMaxExtent_=null)}else c.strokeStyle=void 0,c.lineCap=void 0,c.lineDash=null,c.lineDashOffset=void 0,c.lineJoin=void 0,c.lineWidth=void 0,c.miterLimit=void 0},b.prototype.createFill=function(a){var b=a.fillStyle,c=[t.default.SET_FILL_STYLE,b];return"string"!=typeof b&&c.push(!0),c},b.prototype.applyStroke=function(a){this.instructions.push(this.createStroke(a))},b.prototype.createStroke=function(a){return[t.default.SET_STROKE_STYLE,a.strokeStyle,a.lineWidth*this.pixelRatio,a.lineCap,a.lineJoin,a.miterLimit,this.applyPixelRatio(a.lineDash),a.lineDashOffset*this.pixelRatio]},b.prototype.updateFillStyle=function(a,b,c){var d=a.fillStyle;("string"!=typeof d||a.currentFillStyle!=d)&&(void 0!==d&&this.instructions.push(b.call(this,a,c)),a.currentFillStyle=d)},b.prototype.updateStrokeStyle=function(a,b){var c=a.strokeStyle,d=a.lineCap,e=a.lineDash,f=a.lineDashOffset,h=a.lineJoin,i=a.lineWidth,j=a.miterLimit;(a.currentStrokeStyle!=c||a.currentLineCap!=d||e!=a.currentLineDash&&!g.equals(a.currentLineDash,e)||a.currentLineDashOffset!=f||a.currentLineJoin!=h||a.currentLineWidth!=i||a.currentMiterLimit!=j)&&(void 0!==c&&b.call(this,a),a.currentStrokeStyle=c,a.currentLineCap=d,a.currentLineDash=e,a.currentLineDashOffset=f,a.currentLineJoin=h,a.currentLineWidth=i,a.currentMiterLimit=j)},b.prototype.endGeometry=function(a,b){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var c=[t.default.END_GEOMETRY,b];this.instructions.push(c),this.hitDetectionInstructions.push(c)},b.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=i.clone(this.maxExtent),this.maxLineWidth>0)){var a=this.resolution*(this.maxLineWidth+1)/2;i.buffer(this.bufferedMaxExtent_,a,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},b}(r.default);y.prototype.finish=f.VOID;var z=y;c.default=z},{"../../array.js":45,"../../colorlike.js":49,"../../extent.js":71,"../../extent/Relationship.js":73,"../../functions.js":76,"../../geom/GeometryType.js":81,"../../geom/flat/inflate.js":96,"../../geom/flat/length.js":100,"../../geom/flat/textpath.js":106,"../../geom/flat/transform.js":108,"../../has.js":109,"../../obj.js":149,"../../transform.js":287,"../../util.js":289,"../VectorContext.js":171,"../canvas.js":172,"../canvas/Instruction.js":175,"../replay.js":181}],179:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d,e=Math.floor(a.length/2);if(b>=e)for(d=e;b>d;d++)a[d][c]=!0;
else if(e>b)for(d=b+1;e>d;d++)a[d][c]=!0}function f(a){if(void 0!==x[a])return x[a];for(var b=2*a+1,c=new Array(b),d=0;b>d;d++)c[d]=new Array(b);for(var f=a,g=0,h=0;f>=g;)e(c,a+f,a+g),e(c,a+g,a+f),e(c,a-g,a+f),e(c,a-f,a+g),e(c,a-f,a-g),e(c,a-g,a-f),e(c,a+g,a-f),e(c,a+f,a-g),g++,h+=1+2*g,2*(h-f)+1>0&&(f-=1,h+=1-2*f);return x[a]=c,c}function g(a,b,c,d){for(var e=Object.keys(a).map(Number).sort(h.numberSafeCompareFunction),f={},g=0,i=e.length;i>g;++g)for(var j=a[e[g].toString()],k=0,l=j.length;l>k;){var m=j[k++],n=j[k++];m.replay(b,n,c,f,d)}}Object.defineProperty(c,"__esModule",{value:!0}),c.getCircleArray=f,c.replayDeclutter=g,c.default=void 0;var h=a("../../array.js"),i=a("../../dom.js"),j=a("../../extent.js"),k=a("../../geom/flat/transform.js"),l=a("../../obj.js"),m=d(a("../ReplayGroup.js")),n=d(a("../ReplayType.js")),o=d(a("../canvas/Replay.js")),p=d(a("../canvas/ImageReplay.js")),q=d(a("../canvas/LineStringReplay.js")),r=d(a("../canvas/PolygonReplay.js")),s=d(a("../canvas/TextReplay.js")),t=a("../replay.js"),u=a("../../transform.js"),v={Circle:r.default,Default:o.default,Image:p.default,LineString:q.default,Polygon:r.default,Text:s.default},w=function(a){function b(b,c,d,e,f,g,h){a.call(this),this.declutterTree_=g,this.declutterGroup_=null,this.tolerance_=b,this.maxExtent_=c,this.overlaps_=f,this.pixelRatio_=e,this.resolution_=d,this.renderBuffer_=h,this.replaysByZIndex_={},this.hitDetectionContext_=i.createCanvasContext2D(1,1),this.hitDetectionTransform_=u.create()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addDeclutter=function(a){var b=null;return this.declutterTree_&&(a?(b=this.declutterGroup_,b[4]++):(b=this.declutterGroup_=j.createEmpty(),b.push(1))),b},b.prototype.clip=function(a,b){var c=this.getClipCoords(b);a.beginPath(),a.moveTo(c[0],c[1]),a.lineTo(c[2],c[3]),a.lineTo(c[4],c[5]),a.lineTo(c[6],c[7]),a.clip()},b.prototype.hasReplays=function(a){var b=this;for(var c in b.replaysByZIndex_)for(var d=b.replaysByZIndex_[c],e=0,f=a.length;f>e;++e)if(a[e]in d)return!0;return!1},b.prototype.finish=function(){var a=this;for(var b in a.replaysByZIndex_){var c=a.replaysByZIndex_[b];for(var d in c)c[d].finish()}},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,g,i){function k(a){for(var b=p.getImageData(0,0,m,m).data,c=0;m>c;c++)for(var d=0;m>d;d++)if(s[c][d]&&b[4*(d*m+c)+3]>0){var e=void 0;return(!r||v!=n.default.IMAGE&&v!=n.default.TEXT||-1!==r.indexOf(a))&&(e=g(a)),e?e:void p.clearRect(0,0,m,m)}}var l=this;d=Math.round(d);var m=2*d+1,o=u.compose(this.hitDetectionTransform_,d+.5,d+.5,1/b,-1/b,-c,-a[0],-a[1]),p=this.hitDetectionContext_;p.canvas.width!==m||p.canvas.height!==m?(p.canvas.width=m,p.canvas.height=m):p.clearRect(0,0,m,m);var q;void 0!==this.renderBuffer_&&(q=j.createEmpty(),j.extendCoordinate(q,a),j.buffer(q,b*(this.renderBuffer_+d),q));var r,s=f(d);this.declutterTree_&&(r=this.declutterTree_.all().map(function(a){return a.value}));var v,w=Object.keys(this.replaysByZIndex_).map(Number);w.sort(h.numberSafeCompareFunction);var x,y,z,A,B;for(x=w.length-1;x>=0;--x){var C=w[x].toString();for(z=l.replaysByZIndex_[C],y=t.ORDER.length-1;y>=0;--y)if(v=t.ORDER[y],A=z[v],void 0!==A)if(!i||v!=n.default.IMAGE&&v!=n.default.TEXT){if(B=A.replayHitDetection(p,o,c,e,k,q))return B}else{var D=i[C];D?D.push(A,o.slice(0)):i[C]=[A,o.slice(0)]}}return void 0},b.prototype.getClipCoords=function(a){var b=this.maxExtent_,c=b[0],d=b[1],e=b[2],f=b[3],g=[c,d,c,f,e,f,e,d];return k.transform2D(g,0,8,2,a,g),g},b.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0",d=this.replaysByZIndex_[c];void 0===d&&(d={},this.replaysByZIndex_[c]=d);var e=d[b];if(void 0===e){var f=v[b];e=new f(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),d[b]=e}return e},b.prototype.getReplays=function(){return this.replaysByZIndex_},b.prototype.isEmpty=function(){return l.isEmpty(this.replaysByZIndex_)},b.prototype.replay=function c(a,b,d,e,f,g,i){var j=this,k=Object.keys(this.replaysByZIndex_).map(Number);k.sort(h.numberSafeCompareFunction),a.save(),this.clip(a,b);var l,m,o,p,q,c,r=g?g:t.ORDER;for(l=0,m=k.length;m>l;++l){var s=k[l].toString();for(q=j.replaysByZIndex_[s],o=0,p=r.length;p>o;++o){var u=r[o];if(c=q[u],void 0!==c)if(!i||u!=n.default.IMAGE&&u!=n.default.TEXT)c.replay(a,b,d,e,f);else{var v=i[s];v?v.push(c,b.slice(0)):i[s]=[c,b.slice(0)]}}}a.restore()},b}(m.default),x={0:[[!0]]},y=w;c.default=y},{"../../array.js":45,"../../dom.js":63,"../../extent.js":71,"../../geom/flat/transform.js":108,"../../obj.js":149,"../../transform.js":287,"../ReplayGroup.js":169,"../ReplayType.js":170,"../canvas/ImageReplay.js":173,"../canvas/LineStringReplay.js":176,"../canvas/PolygonReplay.js":177,"../canvas/Replay.js":178,"../canvas/TextReplay.js":180,"../replay.js":181}],180:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){for(var d=b.length,e=0,f=0;d>f;++f){var g=m.measureTextWidth(a,b[f]);e=Math.max(e,g),c.push(g)}return e}Object.defineProperty(c,"__esModule",{value:!0}),c.measureTextWidths=e,c.default=void 0;var f=a("../../util.js"),g=a("../../colorlike.js"),h=a("../../dom.js"),i=a("../../extent.js"),j=a("../../geom/flat/straightchunk.js"),k=d(a("../../geom/GeometryType.js")),l=a("../../has.js"),m=a("../canvas.js"),n=d(a("../canvas/Instruction.js")),o=d(a("../canvas/Replay.js")),p=a("../replay.js"),q=d(a("../../style/TextPlacement.js")),r=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},m.labelCache.prune()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawText=function(a,b){var c=this,d=this.textFillState_,e=this.textStrokeState_,f=this.textState_;if(""!==this.text_&&f&&(d||e)){var g,h,l=this.coordinates.length,m=a.getType(),n=null,o=2,p=2;if(f.placement===q.default.LINE){if(!i.intersects(this.getBufferedMaxExtent(),a.getExtent()))return;var r;if(n=a.getFlatCoordinates(),p=a.getStride(),m==k.default.LINE_STRING)r=[n.length];else if(m==k.default.MULTI_LINE_STRING)r=a.getEnds();else if(m==k.default.POLYGON)r=a.getEnds().slice(0,1);else if(m==k.default.MULTI_POLYGON){var s=a.getEndss();for(r=[],g=0,h=s.length;h>g;++g)r.push(s[g][0])}this.beginGeometry(a,b);for(var t,u=f.textAlign,v=0,w=0,x=r.length;x>w;++w){if(void 0==u){var y=j.matchingChunk(f.maxAngle,n,v,r[w],p);v=y[0],t=y[1]}else t=r[w];for(g=v;t>g;g+=p)c.coordinates.push(n[g],n[g+1]);o=c.coordinates.length,v=r[w],c.drawChars_(l,o,c.declutterGroup_),l=o}this.endGeometry(a,b)}else{var z=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),A=z.width/this.pixelRatio;switch(m){case k.default.POINT:case k.default.MULTI_POINT:n=a.getFlatCoordinates(),o=n.length;break;case k.default.LINE_STRING:n=a.getFlatMidpoint();break;case k.default.CIRCLE:n=a.getCenter();break;case k.default.MULTI_LINE_STRING:n=a.getFlatMidpoints(),o=n.length;break;case k.default.POLYGON:if(n=a.getFlatInteriorPoint(),!f.overflow&&n[2]/this.resolution<A)return;p=3;break;case k.default.MULTI_POLYGON:var B=a.getFlatInteriorPoints();for(n=[],g=0,h=B.length;h>g;g+=3)(f.overflow||B[g+2]/c.resolution>=A)&&n.push(B[g],B[g+1]);if(o=n.length,0==o)return}o=this.appendFlatCoordinates(n,0,o,p,!1,!1),(f.backgroundFill||f.backgroundStroke)&&(this.setFillStrokeStyle(f.backgroundFill,f.backgroundStroke),f.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,a),this.hitDetectionInstructions.push(this.createFill(this.state,a))),f.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(a,b),this.drawTextImage_(z,l,o),this.endGeometry(a,b)}}},b.prototype.getImage=function(a,b,c,d){var f,g=d+b+a+c+this.pixelRatio;if(!m.labelCache.containsKey(g)){var i=d?this.strokeStates[d]||this.textStrokeState_:null,j=c?this.fillStates[c]||this.textFillState_:null,k=this.textStates[b]||this.textState_,n=this.pixelRatio,o=k.scale*n,q=p.TEXT_ALIGN[k.textAlign||m.defaultTextAlign],r=d&&i.lineWidth?i.lineWidth:0,s=a.split("\n"),t=s.length,u=[],v=e(k.font,s,u),w=m.measureTextHeight(k.font),x=w*t,y=v+r,z=h.createCanvasContext2D(Math.ceil(y*o),Math.ceil((x+r)*o));f=z.canvas,m.labelCache.set(g,f),1!=o&&z.scale(o,o),z.font=k.font,d&&(z.strokeStyle=i.strokeStyle,z.lineWidth=r,z.lineCap=i.lineCap,z.lineJoin=i.lineJoin,z.miterLimit=i.miterLimit,l.CANVAS_LINE_DASH&&i.lineDash.length&&(z.setLineDash(i.lineDash),z.lineDashOffset=i.lineDashOffset)),c&&(z.fillStyle=j.fillStyle),z.textBaseline="middle",z.textAlign="center";var A,B=.5-q,C=q*f.width/o+B*r;if(d)for(A=0;t>A;++A)z.strokeText(s[A],C+B*u[A],.5*(r+w)+A*w);if(c)for(A=0;t>A;++A)z.fillText(s[A],C+B*u[A],.5*(r+w)+A*w)}return m.labelCache.get(g)},b.prototype.drawTextImage_=function(a,b,c){var d=this.textState_,e=this.textStrokeState_,f=this.pixelRatio,g=p.TEXT_ALIGN[d.textAlign||m.defaultTextAlign],h=p.TEXT_ALIGN[d.textBaseline],i=e&&e.lineWidth?e.lineWidth:0,j=g*a.width/f+2*(.5-g)*i,k=h*a.height/f+2*(.5-h)*i;this.instructions.push([n.default.DRAW_IMAGE,b,c,a,(j-this.textOffsetX_)*f,(k-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,a.width,d.padding==m.defaultPadding?m.defaultPadding:d.padding.map(function(a){return a*f}),!!d.backgroundFill,!!d.backgroundStroke]),this.hitDetectionInstructions.push([n.default.DRAW_IMAGE,b,c,a,(j-this.textOffsetX_)*f,(k-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/f,a.width,d.padding,!!d.backgroundFill,!!d.backgroundStroke])},b.prototype.drawChars_=function(a,b,c){var d=this.textStrokeState_,e=this.textState_,f=this.textFillState_,g=this.strokeKey_;d&&(g in this.strokeStates||(this.strokeStates[g]={strokeStyle:d.strokeStyle,lineCap:d.lineCap,lineDashOffset:d.lineDashOffset,lineWidth:d.lineWidth,lineJoin:d.lineJoin,miterLimit:d.miterLimit,lineDash:d.lineDash}));var h=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:e.font,textAlign:e.textAlign||m.defaultTextAlign,scale:e.scale});var i=this.fillKey_;f&&(i in this.fillStates||(this.fillStates[i]={fillStyle:f.fillStyle}));var j=this.pixelRatio,k=p.TEXT_ALIGN[e.textBaseline],l=this.textOffsetY_*j,o=this.text_,q=e.font,r=e.scale,s=d?d.lineWidth*r/2:0,t=this.widths_[q];t||(this.widths_[q]=t={}),this.instructions.push([n.default.DRAW_CHARS,a,b,k,c,e.overflow,i,e.maxAngle,function(a){var b=t[a];return b||(b=t[a]=m.measureTextWidth(q,a)),b*r*j},l,g,s*j,o,h,1]),this.hitDetectionInstructions.push([n.default.DRAW_CHARS,a,b,k,c,e.overflow,i,e.maxAngle,function(a){var b=t[a];return b||(b=t[a]=m.measureTextWidth(q,a)),b*r},l,g,s,o,h,1/j])},b.prototype.setTextStyle=function(a,b){var c,d,e;if(a){this.declutterGroup_=b;var h=a.getFill();h?(d=this.textFillState_,d||(d=this.textFillState_={}),d.fillStyle=g.asColorLike(h.getColor()||m.defaultFillStyle)):d=this.textFillState_=null;var i=a.getStroke();if(i){e=this.textStrokeState_,e||(e=this.textStrokeState_={});var j=i.getLineDash(),k=i.getLineDashOffset(),l=i.getWidth(),n=i.getMiterLimit();e.lineCap=i.getLineCap()||m.defaultLineCap,e.lineDash=j?j.slice():m.defaultLineDash,e.lineDashOffset=void 0===k?m.defaultLineDashOffset:k,e.lineJoin=i.getLineJoin()||m.defaultLineJoin,e.lineWidth=void 0===l?m.defaultLineWidth:l,e.miterLimit=void 0===n?m.defaultMiterLimit:n,e.strokeStyle=g.asColorLike(i.getColor()||m.defaultStrokeStyle)}else e=this.textStrokeState_=null;c=this.textState_;var o=a.getFont()||m.defaultFont;m.checkFont(o);var p=a.getScale();c.overflow=a.getOverflow(),c.font=o,c.maxAngle=a.getMaxAngle(),c.placement=a.getPlacement(),c.textAlign=a.getTextAlign(),c.textBaseline=a.getTextBaseline()||m.defaultTextBaseline,c.backgroundFill=a.getBackgroundFill(),c.backgroundStroke=a.getBackgroundStroke(),c.padding=a.getPadding()||m.defaultPadding,c.scale=void 0===p?1:p;var q=a.getOffsetX(),r=a.getOffsetY(),s=a.getRotateWithView(),t=a.getRotation();this.text_=a.getText()||"",this.textOffsetX_=void 0===q?0:q,this.textOffsetY_=void 0===r?0:r,this.textRotateWithView_=void 0===s?!1:s,this.textRotation_=void 0===t?0:t,this.strokeKey_=e?("string"==typeof e.strokeStyle?e.strokeStyle:f.getUid(e.strokeStyle))+e.lineCap+e.lineDashOffset+"|"+e.lineWidth+e.lineJoin+e.miterLimit+"["+e.lineDash.join()+"]":"",this.textKey_=c.font+c.scale+(c.textAlign||"?"),this.fillKey_=d?"string"==typeof d.fillStyle?d.fillStyle:"|"+f.getUid(d.fillStyle):""}else this.text_=""},b}(o.default),s=r;c.default=s},{"../../colorlike.js":49,"../../dom.js":63,"../../extent.js":71,"../../geom/GeometryType.js":81,"../../geom/flat/straightchunk.js":105,"../../has.js":109,"../../style/TextPlacement.js":280,"../../util.js":289,"../canvas.js":172,"../canvas/Instruction.js":175,"../canvas/Replay.js":178,"../replay.js":181}],181:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_ALIGN=c.ORDER=void 0;var e=d(a("../render/ReplayType.js")),f=[e.default.POLYGON,e.default.CIRCLE,e.default.LINE_STRING,e.default.IMAGE,e.default.TEXT,e.default.DEFAULT];c.ORDER=f;var g={};c.TEXT_ALIGN=g,g.left=0,g.end=0,g.center=.5,g.right=1,g.start=1,g.top=0,g.middle=.5,g.hanging=.2,g.alphabetic=.8,g.ideographic=.8,g.bottom=1},{"../render/ReplayType.js":170}],182:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.triangleIsCounterClockwise=c.EPSILON=c.DEFAULT_LINEWIDTH=c.DEFAULT_TEXTBASELINE=c.DEFAULT_TEXTALIGN=c.DEFAULT_STROKESTYLE=c.DEFAULT_MITERLIMIT=c.DEFAULT_LINEJOIN=c.DEFAULT_LINEDASHOFFSET=c.DEFAULT_LINEDASH=c.DEFAULT_LINECAP=c.DEFAULT_FILLSTYLE=c.DEFAULT_FONT=void 0;var d="10px sans-serif";c.DEFAULT_FONT=d;var e=[0,0,0,1];c.DEFAULT_FILLSTYLE=e;var f="round";c.DEFAULT_LINECAP=f;var g=[];c.DEFAULT_LINEDASH=g;var h=0;c.DEFAULT_LINEDASHOFFSET=h;var i="round";c.DEFAULT_LINEJOIN=i;var j=10;c.DEFAULT_MITERLIMIT=j;var k=[0,0,0,1];c.DEFAULT_STROKESTYLE=k;var l=.5;c.DEFAULT_TEXTALIGN=l;var m=.5;c.DEFAULT_TEXTBASELINE=m;var n=1;c.DEFAULT_LINEWIDTH=n;var o=Number.EPSILON||2.220446049250313e-16;c.EPSILON=o;var p=function(a,b,c,d,e,f){var g=(c-a)*(f-b)-(e-a)*(d-b);return o>=g&&g>=-o?void 0:g>0};c.triangleIsCounterClockwise=p},{}],183:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../array.js"),g=a("../../color.js"),h=a("../../extent.js"),i=a("../../obj.js"),j=a("../../geom/flat/transform.js"),k=a("../webgl/circlereplay/defaultshader.js"),l=d(a("../webgl/circlereplay/defaultshader/Locations.js")),m=d(a("../webgl/Replay.js")),n=a("../webgl.js"),o=a("../../webgl.js"),p=d(a("../../webgl/Buffer.js")),q=function(a){function b(b,c){a.call(this,b,c),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c,d){var e,f,g=this,h=this.vertices.length,i=this.indices.length,j=h/4;for(e=b,f=c;f>e;e+=d)g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=0,g.vertices[h++]=g.radius_,g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=1,g.vertices[h++]=g.radius_,g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=2,g.vertices[h++]=g.radius_,g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=3,g.vertices[h++]=g.radius_,g.indices[i++]=j,g.indices[i++]=j+1,g.indices[i++]=j+2,g.indices[i++]=j+2,g.indices[i++]=j+3,g.indices[i++]=j,j+=4},b.prototype.drawCircle=function(a,b){var c=a.getRadius(),d=a.getStride();if(c){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=c;var e=a.getFlatCoordinates();e=j.translate(e,0,2,d,-this.origin[0],-this.origin[1]),this.drawCoordinates_(e,0,2,d)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var f=this.styles_[this.styles_.length-1];this.state_.fillColor=f[0],this.state_.strokeColor=f[1],this.state_.lineWidth=f[2],this.state_.changed=!1}},b.prototype.finish=function(){this.verticesBuffer=new p.default(this.vertices),this.indicesBuffer=new p.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b),a.deleteBuffer(c)}},b.prototype.setUpProgram=function(a,b,c,d){var e,f=b.getProgram(k.fragment,k.vertex);return this.defaultLocations_?e=this.defaultLocations_:(e=new l.default(a,f),this.defaultLocations_=e),b.useProgram(f),a.enableVertexAttribArray(e.a_position),a.vertexAttribPointer(e.a_position,2,o.FLOAT,!1,16,0),a.enableVertexAttribArray(e.a_instruction),a.vertexAttribPointer(e.a_instruction,1,o.FLOAT,!1,16,8),a.enableVertexAttribArray(e.a_radius),a.vertexAttribPointer(e.a_radius,1,o.FLOAT,!1,16,12),a.uniform2fv(e.u_size,c),a.uniform1f(e.u_pixelRatio,d),e},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position),a.disableVertexAttribArray(b.a_instruction),a.disableVertexAttribArray(b.a_radius)},b.prototype.drawReplay=function(a,b,c){var d=this;if(i.isEmpty(c)){var e,f,g,h;for(g=this.startIndices[this.startIndices.length-1],e=this.styleIndices_.length-1;e>=0;--e)f=d.styleIndices_[e],h=d.styles_[e],d.setFillStyle_(a,h[0]),d.setStrokeStyle_(a,h[1],h[2]),d.drawElements(a,b,f,g),g=f}else this.drawReplaySkipping_(a,b,c)},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,f){var g,i,j,k,l,m,n,o,p=this;for(o=this.startIndices.length-2,j=this.startIndices[o+1],g=this.styleIndices_.length-1;g>=0;--g)for(k=p.styles_[g],p.setFillStyle_(a,k[0]),p.setStrokeStyle_(a,k[1],k[2]),l=p.styleIndices_[g];o>=0&&this.startIndices[o]>=l;){if(i=p.startIndices[o],m=p.startIndicesFeature[o],n=e.getUid(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===f||h.intersects(f,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),p.drawElements(a,b,i,j);var q=d(m);if(q)return q}o--,j=i}return void 0},b.prototype.drawReplaySkipping_=function(a,b,c){var d,f,g,h,i,j,k,l,m,n=this;for(l=this.startIndices.length-2,g=f=this.startIndices[l+1],d=this.styleIndices_.length-1;d>=0;--d){for(h=n.styles_[d],n.setFillStyle_(a,h[0]),n.setStrokeStyle_(a,h[1],h[2]),i=n.styleIndices_[d];l>=0&&this.startIndices[l]>=i;)m=n.startIndices[l],j=n.startIndicesFeature[l],k=e.getUid(j).toString(),c[k]&&(f!==g&&n.drawElements(a,b,f,g),g=m),l--,f=m;f!==g&&n.drawElements(a,b,f,g),f=g=i}},b.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_fillColor,b)},b.prototype.setStrokeStyle_=function(a,b,c){a.uniform4fv(this.defaultLocations_.u_strokeColor,b),a.uniform1f(this.defaultLocations_.u_lineWidth,c)},b.prototype.setFillStrokeStyle=function(a,b){var c,d;if(b){var e=b.getLineDash();this.state_.lineDash=e?e:n.DEFAULT_LINEDASH;var h=b.getLineDashOffset();this.state_.lineDashOffset=h?h:n.DEFAULT_LINEDASHOFFSET,c=b.getColor(),c=c instanceof CanvasGradient||c instanceof CanvasPattern?n.DEFAULT_STROKESTYLE:g.asArray(c).map(function(a,b){return 3!=b?a/255:a})||n.DEFAULT_STROKESTYLE,d=b.getWidth(),d=void 0!==d?d:n.DEFAULT_LINEWIDTH}else c=[0,0,0,0],d=0;var i=a?a.getColor():[0,0,0,0];i=i instanceof CanvasGradient||i instanceof CanvasPattern?n.DEFAULT_FILLSTYLE:g.asArray(i).map(function(a,b){return 3!=b?a/255:a})||n.DEFAULT_FILLSTYLE,this.state_.strokeColor&&f.equals(this.state_.strokeColor,c)&&this.state_.fillColor&&f.equals(this.state_.fillColor,i)&&this.state_.lineWidth===d||(this.state_.changed=!0,this.state_.fillColor=i,this.state_.strokeColor=c,this.state_.lineWidth=d,this.styles_.push([i,c,d]))},b}(m.default),r=q;c.default=r},{"../../array.js":45,"../../color.js":48,"../../extent.js":71,"../../geom/flat/transform.js":108,"../../obj.js":149,"../../util.js":289,"../../webgl.js":291,"../../webgl/Buffer.js":292,"../webgl.js":182,"../webgl/Replay.js":188,"../webgl/circlereplay/defaultshader.js":192,"../webgl/circlereplay/defaultshader/Locations.js":193}],184:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../webgl/TextureReplay.js")),g=d(a("../../webgl/Buffer.js")),h=function(a){function b(b,c){a.call(this,b,c),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawMultiPoint=function(a,b){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b);var c=a.getFlatCoordinates(),d=a.getStride();this.drawCoordinates(c,0,c.length,d)},b.prototype.drawPoint=function(a,b){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b);var c=a.getFlatCoordinates(),d=a.getStride();this.drawCoordinates(c,0,c.length,d)},b.prototype.finish=function(b){var c=b.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new g.default(this.vertices);var d=this.indices;this.indicesBuffer=new g.default(d);var e={};this.createTextures(this.textures_,this.images_,e,c),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,e,c),this.images_=null,this.hitDetectionImages_=null,a.prototype.finish.call(this,b)},b.prototype.setImageStyle=function(a){var b,c=a.getAnchor(),d=a.getImage(1),f=a.getImageSize(),g=a.getHitDetectionImage(1),h=a.getOpacity(),i=a.getOrigin(),j=a.getRotateWithView(),k=a.getRotation(),l=a.getSize(),m=a.getScale();0===this.images_.length?this.images_.push(d):(b=this.images_[this.images_.length-1],e.getUid(b)!=e.getUid(d)&&(this.groupIndices.push(this.indices.length),this.images_.push(d))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(g):(b=this.hitDetectionImages_[this.hitDetectionImages_.length-1],e.getUid(b)!=e.getUid(g)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(g))),this.anchorX=c[0],this.anchorY=c[1],this.height=l[1],this.imageHeight=f[1],this.imageWidth=f[0],this.opacity=h,this.originX=i[0],this.originY=i[1],this.rotation=k,this.rotateWithView=j,this.scale=m,this.width=l[0]},b.prototype.getTextures=function(a){return a?this.textures_.concat(this.hitDetectionTextures_):this.textures_},b.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},b}(f.default),i=h;c.default=i},{"../../util.js":289,"../../webgl/Buffer.js":292,"../webgl/TextureReplay.js":191}],185:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../extent.js"),f=d(a("../../geom/GeometryType.js")),g=d(a("../ReplayType.js")),h=d(a("../VectorContext.js")),i=d(a("../webgl/ReplayGroup.js")),j=function(a){function b(b,c,d,e,f,g,h){a.call(this),this.context_=b,this.center_=c,this.extent_=g,this.pixelRatio_=h,this.size_=f,this.rotation_=e,this.resolution_=d,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawText_=function(a,b){var c=this.context_,d=a.getReplay(0,g.default.TEXT);d.setTextStyle(this.textStyle_),d.drawText(b,null),d.finish(c);var e,f=1,h={},i=!1;d.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,f,h,e,i),d.getDeleteResourcesFunction(c)()},b.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke()),this.setImageStyle(a.getImage()),this.setTextStyle(a.getText())},b.prototype.drawGeometry=function(a){var b=a.getType();switch(b){case f.default.POINT:this.drawPoint(a,null);break;case f.default.LINE_STRING:this.drawLineString(a,null);break;case f.default.POLYGON:this.drawPolygon(a,null);break;case f.default.MULTI_POINT:this.drawMultiPoint(a,null);break;case f.default.MULTI_LINE_STRING:this.drawMultiLineString(a,null);break;case f.default.MULTI_POLYGON:this.drawMultiPolygon(a,null);break;case f.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(a,null);break;case f.default.CIRCLE:this.drawCircle(a,null)}},b.prototype.drawFeature=function(a,b){var c=b.getGeometryFunction()(a);c&&e.intersects(this.extent_,c.getExtent())&&(this.setStyle(b),this.drawGeometry(c))},b.prototype.drawGeometryCollection=function(a){var b,c,d=this,e=a.getGeometriesArray();for(b=0,c=e.length;c>b;++b)d.drawGeometry(e[b])},b.prototype.drawPoint=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.IMAGE);e.setImageStyle(this.imageStyle_),e.drawPoint(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawMultiPoint=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.IMAGE);e.setImageStyle(this.imageStyle_),e.drawMultiPoint(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawLineString=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_),e.drawLineString(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawMultiLineString=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_),e.drawMultiLineString(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawPolygon=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),e.drawPolygon(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawMultiPolygon=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),e.drawMultiPolygon(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawCircle=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.CIRCLE);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),e.drawCircle(a,b),e.finish(c);var f,h=1,j={},k=!1;e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,k),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.setImageStyle=function(a){this.imageStyle_=a},b.prototype.setFillStrokeStyle=function(a,b){this.fillStyle_=a,this.strokeStyle_=b},b.prototype.setTextStyle=function(a){this.textStyle_=a},b}(h.default),k=j;c.default=k},{"../../extent.js":71,"../../geom/GeometryType.js":81,"../ReplayType.js":170,"../VectorContext.js":171,"../webgl/ReplayGroup.js":189}],186:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../array.js"),g=a("../../color.js"),h=a("../../extent.js"),i=a("../../geom/flat/orient.js"),j=a("../../geom/flat/transform.js"),k=a("../../geom/flat/topology.js"),l=a("../../obj.js"),m=a("../webgl.js"),n=d(a("../webgl/Replay.js")),o=a("../webgl/linestringreplay/defaultshader.js"),p=d(a("../webgl/linestringreplay/defaultshader/Locations.js")),q=a("../../webgl.js"),r=d(a("../../webgl/Buffer.js")),s={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23},t=function(a){function b(b,c){a.call(this,b,c),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c,d){var e,g,h,j,l,n,o,p,q=this,r=this.vertices.length,t=this.indices.length,u="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,v="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,w=k.lineStringIsClosed(a,b,c,d),x=t,y=1;for(e=b,g=c;g>e;e+=d){if(l=r/7,n=o,o=p||[a[e],a[e+1]],e===b){if(p=[a[e+d],a[e+d+1]],c-b===2*d&&f.equals(o,p))break;if(!w){v&&(r=q.addVertices_([0,0],o,p,y*s.BEGIN_LINE_CAP*v,r),r=q.addVertices_([0,0],o,p,-y*s.BEGIN_LINE_CAP*v,r),q.indices[t++]=l+2,q.indices[t++]=l,q.indices[t++]=l+1,q.indices[t++]=l+1,q.indices[t++]=l+3,q.indices[t++]=l+2),r=q.addVertices_([0,0],o,p,y*s.BEGIN_LINE*(v||1),r),r=q.addVertices_([0,0],o,p,-y*s.BEGIN_LINE*(v||1),r),x=r/7-1;continue}n=[a[c-2*d],a[c-2*d+1]],h=p}else{if(e===c-d){if(w){p=h;break}n=n||[0,0],r=q.addVertices_(n,o,[0,0],y*s.END_LINE*(v||1),r),r=q.addVertices_(n,o,[0,0],-y*s.END_LINE*(v||1),r),q.indices[t++]=l,q.indices[t++]=x-1,q.indices[t++]=x,q.indices[t++]=x,q.indices[t++]=l+1,q.indices[t++]=l,v&&(r=q.addVertices_(n,o,[0,0],y*s.END_LINE_CAP*v,r),r=q.addVertices_(n,o,[0,0],-y*s.END_LINE_CAP*v,r),q.indices[t++]=l+2,q.indices[t++]=l,q.indices[t++]=l+1,q.indices[t++]=l+1,q.indices[t++]=l+3,q.indices[t++]=l+2);break}p=[a[e+d],a[e+d+1]]}j=m.triangleIsCounterClockwise(n[0],n[1],o[0],o[1],p[0],p[1])?-1:1,r=q.addVertices_(n,o,p,j*s.BEVEL_FIRST*(u||1),r),r=q.addVertices_(n,o,p,j*s.BEVEL_SECOND*(u||1),r),r=q.addVertices_(n,o,p,-j*s.MITER_BOTTOM*(u||1),r),e>b&&(q.indices[t++]=l,q.indices[t++]=x-1,q.indices[t++]=x,q.indices[t++]=l+2,q.indices[t++]=l,q.indices[t++]=y*j>0?x:x-1),q.indices[t++]=l,q.indices[t++]=l+2,q.indices[t++]=l+1,x=l+2,y=j,u&&(r=q.addVertices_(n,o,p,j*s.MITER_TOP*u,r),q.indices[t++]=l+1,q.indices[t++]=l+3,q.indices[t++]=l)}w&&(l=l||r/7,j=i.linearRingIsClockwise([n[0],n[1],o[0],o[1],p[0],p[1]],0,6,2)?1:-1,r=this.addVertices_(n,o,p,j*s.BEVEL_FIRST*(u||1),r),r=this.addVertices_(n,o,p,-j*s.MITER_BOTTOM*(u||1),r),this.indices[t++]=l,this.indices[t++]=x-1,this.indices[t++]=x,this.indices[t++]=l+1,this.indices[t++]=l,this.indices[t++]=y*j>0?x:x-1)},b.prototype.addVertices_=function(a,b,c,d,e){return this.vertices[e++]=a[0],this.vertices[e++]=a[1],this.vertices[e++]=b[0],this.vertices[e++]=b[1],this.vertices[e++]=c[0],this.vertices[e++]=c[1],this.vertices[e++]=d,e},b.prototype.isValid_=function(a,b,c,d){var e=c-b;if(2*d>e)return!1;if(e===2*d){var g=[a[b],a[b+1]],h=[a[b+d],a[b+d+1]];return!f.equals(g,h)}return!0},b.prototype.drawLineString=function(a,b){var c=a.getFlatCoordinates(),d=a.getStride();this.isValid_(c,0,c.length,d)&&(c=j.translate(c,0,c.length,d,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.drawCoordinates_(c,0,c.length,d))
},b.prototype.drawMultiLineString=function(a,b){var c=this,d=this.indices.length,e=a.getEnds();e.unshift(0);var f,g,h=a.getFlatCoordinates(),i=a.getStride();if(e.length>1)for(f=1,g=e.length;g>f;++f)if(c.isValid_(h,e[f-1],e[f],i)){var k=j.translate(h,e[f-1],e[f],i,-c.origin[0],-c.origin[1]);c.drawCoordinates_(k,0,k.length,i)}this.indices.length>d&&(this.startIndices.push(d),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(d),this.state_.changed=!1))},b.prototype.drawPolygonCoordinates=function(a,b,c){var d=this;if(k.lineStringIsClosed(a,0,a.length,c)||(a.push(a[0]),a.push(a[1])),this.drawCoordinates_(a,0,a.length,c),b.length){var e,f;for(e=0,f=b.length;f>e;++e)k.lineStringIsClosed(b[e],0,b[e].length,c)||(b[e].push(b[e][0]),b[e].push(b[e][1])),d.drawCoordinates_(b[e],0,b[e].length,c)}},b.prototype.setPolygonStyle=function(a,b){var c=void 0===b?this.indices.length:b;this.startIndices.push(c),this.startIndicesFeature.push(a),this.state_.changed&&(this.styleIndices_.push(c),this.state_.changed=!1)},b.prototype.getCurrentIndex=function(){return this.indices.length},b.prototype.finish=function(){this.verticesBuffer=new r.default(this.vertices),this.indicesBuffer=new r.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b),a.deleteBuffer(c)}},b.prototype.setUpProgram=function(a,b,c,d){var e,f=b.getProgram(o.fragment,o.vertex);return this.defaultLocations_?e=this.defaultLocations_:(e=new p.default(a,f),this.defaultLocations_=e),b.useProgram(f),a.enableVertexAttribArray(e.a_lastPos),a.vertexAttribPointer(e.a_lastPos,2,q.FLOAT,!1,28,0),a.enableVertexAttribArray(e.a_position),a.vertexAttribPointer(e.a_position,2,q.FLOAT,!1,28,8),a.enableVertexAttribArray(e.a_nextPos),a.vertexAttribPointer(e.a_nextPos,2,q.FLOAT,!1,28,16),a.enableVertexAttribArray(e.a_direction),a.vertexAttribPointer(e.a_direction,1,q.FLOAT,!1,28,24),a.uniform2fv(e.u_size,c),a.uniform1f(e.u_pixelRatio,d),e},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_lastPos),a.disableVertexAttribArray(b.a_position),a.disableVertexAttribArray(b.a_nextPos),a.disableVertexAttribArray(b.a_direction)},b.prototype.drawReplay=function(a,b,c,d){var e=this,f=a.getParameter(a.DEPTH_FUNC),g=a.getParameter(a.DEPTH_WRITEMASK);if(d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL)),l.isEmpty(c)){var h,i,j,k;for(j=this.startIndices[this.startIndices.length-1],h=this.styleIndices_.length-1;h>=0;--h)i=e.styleIndices_[h],k=e.styles_[h],e.setStrokeStyle_(a,k[0],k[1],k[2]),e.drawElements(a,b,i,j),a.clear(a.DEPTH_BUFFER_BIT),j=i}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(g),a.depthFunc(f))},b.prototype.drawReplaySkipping_=function(a,b,c){var d,f,g,h,i,j,k,l,m,n=this;for(l=this.startIndices.length-2,g=f=this.startIndices[l+1],d=this.styleIndices_.length-1;d>=0;--d){for(h=n.styles_[d],n.setStrokeStyle_(a,h[0],h[1],h[2]),i=n.styleIndices_[d];l>=0&&this.startIndices[l]>=i;)m=n.startIndices[l],j=n.startIndicesFeature[l],k=e.getUid(j).toString(),c[k]&&(f!==g&&(n.drawElements(a,b,f,g),a.clear(a.DEPTH_BUFFER_BIT)),g=m),l--,f=m;f!==g&&(n.drawElements(a,b,f,g),a.clear(a.DEPTH_BUFFER_BIT)),f=g=i}},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,f){var g,i,j,k,l,m,n,o,p=this;for(o=this.startIndices.length-2,j=this.startIndices[o+1],g=this.styleIndices_.length-1;g>=0;--g)for(k=p.styles_[g],p.setStrokeStyle_(a,k[0],k[1],k[2]),l=p.styleIndices_[g];o>=0&&this.startIndices[o]>=l;){if(i=p.startIndices[o],m=p.startIndicesFeature[o],n=e.getUid(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===f||h.intersects(f,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),p.drawElements(a,b,i,j);var q=d(m);if(q)return q}o--,j=i}return void 0},b.prototype.setStrokeStyle_=function(a,b,c,d){a.uniform4fv(this.defaultLocations_.u_color,b),a.uniform1f(this.defaultLocations_.u_lineWidth,c),a.uniform1f(this.defaultLocations_.u_miterLimit,d)},b.prototype.setFillStrokeStyle=function(a,b){var c=b.getLineCap();this.state_.lineCap=void 0!==c?c:m.DEFAULT_LINECAP;var d=b.getLineDash();this.state_.lineDash=d?d:m.DEFAULT_LINEDASH;var e=b.getLineDashOffset();this.state_.lineDashOffset=e?e:m.DEFAULT_LINEDASHOFFSET;var h=b.getLineJoin();this.state_.lineJoin=void 0!==h?h:m.DEFAULT_LINEJOIN;var i=b.getColor();i=i instanceof CanvasGradient||i instanceof CanvasPattern?m.DEFAULT_STROKESTYLE:g.asArray(i).map(function(a,b){return 3!=b?a/255:a})||m.DEFAULT_STROKESTYLE;var j=b.getWidth();j=void 0!==j?j:m.DEFAULT_LINEWIDTH;var k=b.getMiterLimit();k=void 0!==k?k:m.DEFAULT_MITERLIMIT,this.state_.strokeColor&&f.equals(this.state_.strokeColor,i)&&this.state_.lineWidth===j&&this.state_.miterLimit===k||(this.state_.changed=!0,this.state_.strokeColor=i,this.state_.lineWidth=j,this.state_.miterLimit=k,this.styles_.push([i,j,k]))},b}(n.default),u=t;c.default=u},{"../../array.js":45,"../../color.js":48,"../../extent.js":71,"../../geom/flat/orient.js":101,"../../geom/flat/topology.js":107,"../../geom/flat/transform.js":108,"../../obj.js":149,"../../util.js":289,"../../webgl.js":291,"../../webgl/Buffer.js":292,"../webgl.js":182,"../webgl/Replay.js":188,"../webgl/linestringreplay/defaultshader.js":194,"../webgl/linestringreplay/defaultshader/Locations.js":195}],187:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../util.js"),g=a("../../array.js"),h=a("../../color.js"),i=a("../../extent.js"),j=a("../../obj.js"),k=a("../../geom/flat/contains.js"),l=a("../../geom/flat/orient.js"),m=a("../../geom/flat/transform.js"),n=a("../webgl/polygonreplay/defaultshader.js"),o=d(a("../webgl/polygonreplay/defaultshader/Locations.js")),p=d(a("../webgl/LineStringReplay.js")),q=d(a("../webgl/Replay.js")),r=a("../webgl.js"),s=d(a("../../style/Stroke.js")),t=d(a("../../structs/LinkedList.js")),u=d(a("../../structs/RBush.js")),v=a("../../webgl.js"),w=d(a("../../webgl/Buffer.js")),x=function(a){function b(b,c){a.call(this,b,c),this.lineStringReplay=new p.default(b,c),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c){var d=this,e=new t.default,f=new u.default;this.processFlatCoordinates_(a,c,e,f,!0);var g=this.getMaxCoords_(e);if(b.length){var h,i,j=[];for(h=0,i=b.length;i>h;++h){var k={list:new t.default,maxCoords:void 0,rtree:new u.default};j.push(k),d.processFlatCoordinates_(b[h],c,k.list,k.rtree,!1),d.classifyPoints_(k.list,k.rtree,!0),k.maxCoords=d.getMaxCoords_(k.list)}for(j.sort(function(a,b){return b.maxCoords[0]===a.maxCoords[0]?a.maxCoords[1]-b.maxCoords[1]:b.maxCoords[0]-a.maxCoords[0]}),h=0;h<j.length;++h){var l=j[h].list,m=l.firstItem(),n=m,o=void 0;do{if(d.getIntersections_(n,f).length){o=!0;break}n=l.nextItem()}while(m!==n);o||d.bridgeHole_(l,j[h].maxCoords[0],e,g[0],f)&&(f.concat(j[h].rtree),d.classifyPoints_(e,f,!1))}}else this.classifyPoints_(e,f,!1);this.triangulate_(e,f)},b.prototype.processFlatCoordinates_=function(a,b,c,d,e){var f,g,h,i,j,k=this,m=l.linearRingIsClockwise(a,0,a.length,b),n=this.vertices.length/2,o=[],p=[];if(e===m){for(h=this.createPoint_(a[0],a[1],n++),i=h,f=b,g=a.length;g>f;f+=b)j=k.createPoint_(a[f],a[f+1],n++),p.push(k.insertItem_(i,j,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)]),i=j;p.push(this.insertItem_(j,h,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)])}else{var q=a.length-b;for(h=this.createPoint_(a[q],a[q+1],n++),i=h,f=q-b,g=0;f>=g;f-=b)j=k.createPoint_(a[f],a[f+1],n++),p.push(k.insertItem_(i,j,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)]),i=j;p.push(this.insertItem_(j,h,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)])}d.load(o,p)},b.prototype.getMaxCoords_=function(a){var b=a.firstItem(),c=b,d=[c.p0.x,c.p0.y];do c=a.nextItem(),c.p0.x>d[0]&&(d=[c.p0.x,c.p0.y]);while(c!==b);return d},b.prototype.classifyPoints_=function(a,b,c){var d=this,e=a.firstItem(),f=e,g=a.nextItem(),h=!1;do{var i=c?r.triangleIsCounterClockwise(g.p1.x,g.p1.y,f.p1.x,f.p1.y,f.p0.x,f.p0.y):r.triangleIsCounterClockwise(f.p0.x,f.p0.y,f.p1.x,f.p1.y,g.p1.x,g.p1.y);void 0===i?(d.removeItem_(f,g,a,b),h=!0,g===e&&(e=a.getNextItem()),g=f,a.prevItem()):f.p1.reflex!==i&&(f.p1.reflex=i,h=!0),f=g,g=a.nextItem()}while(f!==e);return h},b.prototype.bridgeHole_=function(a,b,c,d,e){for(var f=this,g=a.firstItem();g.p1.x!==b;)g=a.nextItem();var h,i,j,k,l=g.p1,m={x:d,y:l.y,i:-1},n=1/0,o=this.getIntersections_({p0:l,p1:m},e,!0);for(h=0,i=o.length;i>h;++h){var p=o[h],q=f.calculateIntersection_(l,m,p.p0,p.p1,!0),s=Math.abs(l.x-q[0]);n>s&&void 0!==r.triangleIsCounterClockwise(l.x,l.y,p.p0.x,p.p0.y,p.p1.x,p.p1.y)&&(n=s,k={x:q[0],y:q[1],i:-1},g=p)}if(1/0===n)return!1;if(j=g.p1,n>0){var t=this.getPointsInTriangle_(l,k,g.p1,e);if(t.length){var u=1/0;for(h=0,i=t.length;i>h;++h){var v=t[h],w=Math.atan2(l.y-v.y,m.x-v.x);(u>w||w===u&&v.x<j.x)&&(u=w,j=v)}}}for(g=c.firstItem();g.p1.x!==j.x||g.p1.y!==j.y;)g=c.nextItem();var x={x:l.x,y:l.y,i:l.i,reflex:void 0},y={x:g.p1.x,y:g.p1.y,i:g.p1.i,reflex:void 0};return a.getNextItem().p0=x,this.insertItem_(l,g.p1,a,e),this.insertItem_(y,x,a,e),g.p1=y,a.setFirstItem(),c.concat(a),!0},b.prototype.triangulate_=function(a,b){for(var c=this,d=!1,e=this.isSimple_(a,b);a.getLength()>3;)if(e){if(!c.clipEars_(a,b,e,d)&&!c.classifyPoints_(a,b,d)&&!c.resolveSelfIntersections_(a,b,!0))break}else if(!c.clipEars_(a,b,e,d)&&!c.classifyPoints_(a,b,d)&&!c.resolveSelfIntersections_(a,b)){if(e=c.isSimple_(a,b),!e){c.splitPolygon_(a,b);break}d=!c.isClockwise_(a),c.classifyPoints_(a,b,d)}if(3===a.getLength()){var f=this.indices.length;this.indices[f++]=a.getPrevItem().p0.i,this.indices[f++]=a.getCurrItem().p0.i,this.indices[f++]=a.getNextItem().p0.i}},b.prototype.clipEars_=function(a,b,c,d){var e,f,g,h=this,i=this.indices.length,j=a.firstItem(),k=a.getPrevItem(),m=j,n=a.nextItem(),o=a.getNextItem(),p=!1;do{if(e=m.p0,f=m.p1,g=n.p1,f.reflex===!1){var q=void 0;q=c?0===h.getPointsInTriangle_(e,f,g,b,!0).length:d?h.diagonalIsInside_(o.p1,g,f,e,k.p0):h.diagonalIsInside_(k.p0,e,f,g,o.p1),(c||0===h.getIntersections_({p0:e,p1:g},b).length)&&q&&(c||e.reflex===!1||g.reflex===!1||l.linearRingIsClockwise([k.p0.x,k.p0.y,e.x,e.y,f.x,f.y,g.x,g.y,o.p1.x,o.p1.y],0,10,2)===!d)&&(h.indices[i++]=e.i,h.indices[i++]=f.i,h.indices[i++]=g.i,h.removeItem_(m,n,a,b),n===j&&(j=o),p=!0)}k=a.getPrevItem(),m=a.getCurrItem(),n=a.nextItem(),o=a.getNextItem()}while(m!==j&&a.getLength()>3);return p},b.prototype.resolveSelfIntersections_=function(a,b,c){var d=this,e=a.firstItem();a.nextItem();var f=e,g=a.nextItem(),h=!1;do{var i=d.calculateIntersection_(f.p0,f.p1,g.p0,g.p1,c);if(i){var j=!1,k=d.vertices.length,l=d.indices.length,m=k/2,n=a.prevItem();a.removeItem(),b.remove(n),j=n===e;var o=void 0;if(c?(i[0]===f.p0.x&&i[1]===f.p0.y?(a.prevItem(),o=f.p0,g.p0=o,b.remove(f),j=j||f===e):(o=g.p1,f.p1=o,b.remove(g),j=j||g===e),a.removeItem()):(o=d.createPoint_(i[0],i[1],m),f.p1=o,g.p0=o,b.update([Math.min(f.p0.x,f.p1.x),Math.min(f.p0.y,f.p1.y),Math.max(f.p0.x,f.p1.x),Math.max(f.p0.y,f.p1.y)],f),b.update([Math.min(g.p0.x,g.p1.x),Math.min(g.p0.y,g.p1.y),Math.max(g.p0.x,g.p1.x),Math.max(g.p0.y,g.p1.y)],g)),d.indices[l++]=n.p0.i,d.indices[l++]=n.p1.i,d.indices[l++]=o.i,h=!0,j)break}f=a.getPrevItem(),g=a.nextItem()}while(f!==e);return h},b.prototype.isSimple_=function(a,b){var c=this,d=a.firstItem(),e=d;do{if(c.getIntersections_(e,b).length)return!1;e=a.nextItem()}while(e!==d);return!0},b.prototype.isClockwise_=function(a){var b=2*a.getLength(),c=new Array(b),d=a.firstItem(),e=d,f=0;do c[f++]=e.p0.x,c[f++]=e.p0.y,e=a.nextItem();while(e!==d);return l.linearRingIsClockwise(c,0,b,2)},b.prototype.splitPolygon_=function(a,b){var c=this,d=a.firstItem(),e=d;do{var f=c.getIntersections_(e,b);if(f.length){var g=f[0],h=c.vertices.length/2,i=c.calculateIntersection_(e.p0,e.p1,g.p0,g.p1),j=c.createPoint_(i[0],i[1],h),k=new t.default,l=new u.default;c.insertItem_(j,e.p1,k,l),e.p1=j,b.update([Math.min(e.p0.x,j.x),Math.min(e.p0.y,j.y),Math.max(e.p0.x,j.x),Math.max(e.p0.y,j.y)],e);for(var m=a.nextItem();m!==g;)c.insertItem_(m.p0,m.p1,k,l),b.remove(m),a.removeItem(),m=a.getCurrItem();c.insertItem_(g.p0,j,k,l),g.p0=j,b.update([Math.min(g.p1.x,j.x),Math.min(g.p1.y,j.y),Math.max(g.p1.x,j.x),Math.max(g.p1.y,j.y)],g),c.classifyPoints_(a,b,!1),c.triangulate_(a,b),c.classifyPoints_(k,l,!1),c.triangulate_(k,l);break}e=a.nextItem()}while(e!==d)},b.prototype.createPoint_=function(a,b,c){var d=this.vertices.length;this.vertices[d++]=a,this.vertices[d++]=b;var e={x:a,y:b,i:c,reflex:void 0};return e},b.prototype.insertItem_=function(a,b,c,d){var e={p0:a,p1:b};return c.insertItem(e),d&&d.insert([Math.min(a.x,b.x),Math.min(a.y,b.y),Math.max(a.x,b.x),Math.max(a.y,b.y)],e),e},b.prototype.removeItem_=function(a,b,c,d){c.getCurrItem()===b&&(c.removeItem(),a.p1=b.p1,d.remove(b),d.update([Math.min(a.p0.x,a.p1.x),Math.min(a.p0.y,a.p1.y),Math.max(a.p0.x,a.p1.x),Math.max(a.p0.y,a.p1.y)],a))},b.prototype.getPointsInTriangle_=function(a,b,c,d,f){for(var g=[],h=d.getInExtent([Math.min(a.x,b.x,c.x),Math.min(a.y,b.y,c.y),Math.max(a.x,b.x,c.x),Math.max(a.y,b.y,c.y)]),i=0,j=h.length;j>i;++i)for(var l in h[i]){var m=h[i][l];"object"!==e(m)||f&&!m.reflex||m.x===a.x&&m.y===a.y||m.x===b.x&&m.y===b.y||m.x===c.x&&m.y===c.y||-1!==g.indexOf(m)||!k.linearRingContainsXY([a.x,a.y,b.x,b.y,c.x,c.y],0,6,2,m.x,m.y)||g.push(m)}return g},b.prototype.getIntersections_=function(a,b,c){for(var d=this,e=a.p0,f=a.p1,g=b.getInExtent([Math.min(e.x,f.x),Math.min(e.y,f.y),Math.max(e.x,f.x),Math.max(e.y,f.y)]),h=[],i=0,j=g.length;j>i;++i){var k=g[i];a!==k&&(c||k.p0!==f||k.p1!==e)&&d.calculateIntersection_(e,f,k.p0,k.p1,c)&&h.push(k)}return h},b.prototype.calculateIntersection_=function(a,b,c,d,e){var f=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!==f){var g=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/f,h=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/f;if(!e&&g>r.EPSILON&&g<1-r.EPSILON&&h>r.EPSILON&&h<1-r.EPSILON||e&&g>=0&&1>=g&&h>=0&&1>=h)return[a.x+g*(b.x-a.x),a.y+g*(b.y-a.y)]}return void 0},b.prototype.diagonalIsInside_=function(a,b,c,d,e){if(void 0===b.reflex||void 0===d.reflex)return!1;var f=(c.x-d.x)*(b.y-d.y)>(c.y-d.y)*(b.x-d.x),g=(e.x-d.x)*(b.y-d.y)<(e.y-d.y)*(b.x-d.x),h=(a.x-b.x)*(d.y-b.y)>(a.y-b.y)*(d.x-b.x),i=(c.x-b.x)*(d.y-b.y)<(c.y-b.y)*(d.x-b.x),j=d.reflex?g||f:g&&f,k=b.reflex?i||h:i&&h;return j&&k},b.prototype.drawMultiPolygon=function(a,b){var c,d,e,f,g=this,h=a.getEndss(),i=a.getStride(),j=this.indices.length,k=this.lineStringReplay.getCurrentIndex(),l=a.getFlatCoordinates(),n=0;for(c=0,d=h.length;d>c;++c){var o=h[c];if(o.length>0){var p=m.translate(l,n,o[0],i,-g.origin[0],-g.origin[1]);if(p.length){var q=[],r=void 0;for(e=1,f=o.length;f>e;++e)o[e]!==o[e-1]&&(r=m.translate(l,o[e-1],o[e],i,-g.origin[0],-g.origin[1]),q.push(r));g.lineStringReplay.drawPolygonCoordinates(p,q,i),g.drawCoordinates_(p,q,i)}}n=o[o.length-1]}this.indices.length>j&&(this.startIndices.push(j),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(j),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>k&&this.lineStringReplay.setPolygonStyle(b,k)},b.prototype.drawPolygon=function(a,b){var c=this,d=a.getEnds(),e=a.getStride();if(d.length>0){var f=a.getFlatCoordinates().map(Number),g=m.translate(f,0,d[0],e,-this.origin[0],-this.origin[1]);if(g.length){var h,i,j,k=[];for(h=1,i=d.length;i>h;++h)d[h]!==d[h-1]&&(j=m.translate(f,d[h-1],d[h],e,-c.origin[0],-c.origin[1]),k.push(j));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(b),this.lineStringReplay.drawPolygonCoordinates(g,k,e),this.drawCoordinates_(g,k,e)}}},b.prototype.finish=function(a){this.verticesBuffer=new w.default(this.vertices),this.indicesBuffer=new w.default(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(a),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.lineStringReplay.getDeleteResourcesFunction(a);return function(){a.deleteBuffer(b),a.deleteBuffer(c),d()}},b.prototype.setUpProgram=function(a,b){var c,d=b.getProgram(n.fragment,n.vertex);return this.defaultLocations_?c=this.defaultLocations_:(c=new o.default(a,d),this.defaultLocations_=c),b.useProgram(d),a.enableVertexAttribArray(c.a_position),a.vertexAttribPointer(c.a_position,2,v.FLOAT,!1,8,0),c},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position)},b.prototype.drawReplay=function(a,b,c,d){var e=this,f=a.getParameter(a.DEPTH_FUNC),g=a.getParameter(a.DEPTH_WRITEMASK);if(d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL)),j.isEmpty(c)){var h,i,k,l;for(k=this.startIndices[this.startIndices.length-1],h=this.styleIndices_.length-1;h>=0;--h)i=e.styleIndices_[h],l=e.styles_[h],e.setFillStyle_(a,l),e.drawElements(a,b,i,k),k=i}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(g),a.depthFunc(f))},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){var g,h,j,k,l,m,n,o,p=this;for(o=this.startIndices.length-2,j=this.startIndices[o+1],g=this.styleIndices_.length-1;g>=0;--g)for(k=p.styles_[g],p.setFillStyle_(a,k),l=p.styleIndices_[g];o>=0&&this.startIndices[o]>=l;){if(h=p.startIndices[o],m=p.startIndicesFeature[o],n=f.getUid(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===e||i.intersects(e,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),p.drawElements(a,b,h,j);var q=d(m);if(q)return q}o--,j=h}return void 0},b.prototype.drawReplaySkipping_=function(a,b,c){var d,e,g,h,i,j,k,l,m,n=this;for(l=this.startIndices.length-2,g=e=this.startIndices[l+1],d=this.styleIndices_.length-1;d>=0;--d){for(h=n.styles_[d],n.setFillStyle_(a,h),i=n.styleIndices_[d];l>=0&&this.startIndices[l]>=i;)m=n.startIndices[l],j=n.startIndicesFeature[l],k=f.getUid(j).toString(),c[k]&&(e!==g&&(n.drawElements(a,b,e,g),a.clear(a.DEPTH_BUFFER_BIT)),g=m),l--,e=m;e!==g&&(n.drawElements(a,b,e,g),a.clear(a.DEPTH_BUFFER_BIT)),e=g=i}},b.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_color,b)},b.prototype.setFillStrokeStyle=function(a,b){var c=a?a.getColor():[0,0,0,0];if(c=c instanceof CanvasGradient||c instanceof CanvasPattern?r.DEFAULT_FILLSTYLE:h.asArray(c).map(function(a,b){return 3!=b?a/255:a})||r.DEFAULT_FILLSTYLE,this.state_.fillColor&&g.equals(c,this.state_.fillColor)||(this.state_.fillColor=c,this.state_.changed=!0,this.styles_.push(c)),b)this.lineStringReplay.setFillStrokeStyle(null,b);else{var d=new s.default({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,d)}},b}(q.default),y=x;c.default=y},{"../../array.js":45,"../../color.js":48,"../../extent.js":71,"../../geom/flat/contains.js":93,"../../geom/flat/orient.js":101,"../../geom/flat/transform.js":108,"../../obj.js":149,"../../structs/LinkedList.js":262,"../../structs/RBush.js":264,"../../style/Stroke.js":277,"../../util.js":289,"../../webgl.js":291,"../../webgl/Buffer.js":292,"../webgl.js":182,"../webgl/LineStringReplay.js":186,"../webgl/Replay.js":188,"../webgl/polygonreplay/defaultshader.js":196,"../webgl/polygonreplay/defaultshader/Locations.js":197}],188:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../extent.js"),f=d(a("../VectorContext.js")),g=a("../../transform.js"),h=a("../../vec/mat4.js"),i=a("../../webgl.js"),j=function(a){function b(b,c){a.call(this),this.tolerance=b,this.maxExtent=c,this.origin=e.getCenter(c),this.projectionMatrix_=g.create(),this.offsetRotateMatrix_=g.create(),this.offsetScaleMatrix_=g.create(),this.tmpMat4_=h.create(),this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDeleteResourcesFunction=function(){},b.prototype.finish=function(){},b.prototype.setUpProgram=function(){},b.prototype.shutDownProgram=function(){},b.prototype.drawReplay=function(){},b.prototype.drawHitDetectionReplayOneByOne=function(){},b.prototype.drawHitDetectionReplay=function(a,b,c,d,e,f){return e?this.drawHitDetectionReplayOneByOne(a,b,c,d,f):this.drawHitDetectionReplayAll(a,b,c,d)},b.prototype.drawHitDetectionReplayAll=function(a,b,c,d){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawReplay(a,b,c,!0);var e=d(null);return e?e:void 0},b.prototype.replay=function(a,b,c,d,e,f,j,k,l,m,n){var o,p,q,r,s,t,u,v,w=a.getGL();this.lineStringReplay&&(o=w.isEnabled(w.STENCIL_TEST),p=w.getParameter(w.STENCIL_FUNC),q=w.getParameter(w.STENCIL_VALUE_MASK),r=w.getParameter(w.STENCIL_REF),s=w.getParameter(w.STENCIL_WRITEMASK),t=w.getParameter(w.STENCIL_FAIL),u=w.getParameter(w.STENCIL_PASS_DEPTH_PASS),v=w.getParameter(w.STENCIL_PASS_DEPTH_FAIL),w.enable(w.STENCIL_TEST),w.clear(w.STENCIL_BUFFER_BIT),w.stencilMask(255),w.stencilFunc(w.ALWAYS,1,255),w.stencilOp(w.KEEP,w.KEEP,w.REPLACE),this.lineStringReplay.replay(a,b,c,d,e,f,j,k,l,m,n),w.stencilMask(0),w.stencilFunc(w.NOTEQUAL,1,255)),a.bindBuffer(i.ARRAY_BUFFER,this.verticesBuffer),a.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);var x=this.setUpProgram(w,a,e,f),y=g.reset(this.projectionMatrix_);g.scale(y,2/(c*e[0]),2/(c*e[1])),g.rotate(y,-d),g.translate(y,-(b[0]-this.origin[0]),-(b[1]-this.origin[1]));var z=g.reset(this.offsetScaleMatrix_);g.scale(z,2/e[0],2/e[1]);var A=g.reset(this.offsetRotateMatrix_);0!==d&&g.rotate(A,-d),w.uniformMatrix4fv(x.u_projectionMatrix,!1,h.fromTransform(this.tmpMat4_,y)),w.uniformMatrix4fv(x.u_offsetScaleMatrix,!1,h.fromTransform(this.tmpMat4_,z)),w.uniformMatrix4fv(x.u_offsetRotateMatrix,!1,h.fromTransform(this.tmpMat4_,A)),w.uniform1f(x.u_opacity,j);var B;return void 0===l?this.drawReplay(w,a,k,!1):B=this.drawHitDetectionReplay(w,a,k,l,m,n),this.shutDownProgram(w,x),this.lineStringReplay&&(o||w.disable(w.STENCIL_TEST),w.clear(w.STENCIL_BUFFER_BIT),w.stencilFunc(p,r,q),w.stencilMask(s),w.stencilOp(t,v,u)),B},b.prototype.drawElements=function(a,b,c,d){var e=b.hasOESElementIndexUint?i.UNSIGNED_INT:i.UNSIGNED_SHORT,f=b.hasOESElementIndexUint?4:2,g=d-c,h=c*f;a.drawElements(i.TRIANGLES,g,e,h)},b}(f.default),k=j;c.default=k},{"../../extent.js":71,"../../transform.js":287,"../../vec/mat4.js":290,"../../webgl.js":291,"../VectorContext.js":171}],189:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../array.js"),f=a("../../extent.js"),g=a("../../obj.js"),h=a("../replay.js"),i=d(a("../ReplayGroup.js")),j=d(a("../webgl/CircleReplay.js")),k=d(a("../webgl/ImageReplay.js")),l=d(a("../webgl/LineStringReplay.js")),m=d(a("../webgl/PolygonReplay.js")),n=d(a("../webgl/TextReplay.js")),o=[1,1],p={Circle:j.default,Image:k.default,LineString:l.default,Polygon:m.default,Text:n.default},q=function(a){function b(b,c,d){a.call(this),this.maxExtent_=c,this.tolerance_=b,this.renderBuffer_=d,this.replaysByZIndex_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addDeclutter=function(){},b.prototype.getDeleteResourcesFunction=function(a){var b,c=this,d=[];for(b in c.replaysByZIndex_){var e=c.replaysByZIndex_[b];for(var f in e)d.push(e[f].getDeleteResourcesFunction(a))}return function(){for(var a,b=arguments,c=this,e=d.length,f=0;e>f;f++)a=d[f].apply(c,b);return a}},b.prototype.finish=function(a){var b,c=this;for(b in c.replaysByZIndex_){var d=c.replaysByZIndex_[b];for(var e in d)d[e].finish(a)}},b.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0",d=this.replaysByZIndex_[c];void 0===d&&(d={},this.replaysByZIndex_[c]=d);var e=d[b];if(void 0===e){var f=p[b];e=new f(this.tolerance_,this.maxExtent_),d[b]=e}return e},b.prototype.isEmpty=function(){return g.isEmpty(this.replaysByZIndex_)},b.prototype.replay=function c(a,b,d,f,g,i,j,k){var l=this,m=Object.keys(this.replaysByZIndex_).map(Number);m.sort(e.numberSafeCompareFunction);var n,o,p,q,r,c;for(n=0,o=m.length;o>n;++n)for(r=l.replaysByZIndex_[m[n].toString()],p=0,q=h.ORDER.length;q>p;++p)c=r[h.ORDER[p]],void 0!==c&&c.replay(a,b,d,f,g,i,j,k,void 0,!1)},b.prototype.replayHitDetection_=function(a,b,c,d,e,f,g,i,j,k,l){var m=this,n=Object.keys(this.replaysByZIndex_).map(Number);n.sort(function(a,b){return b-a});var o,p,q,r,s,t;for(o=0,p=n.length;p>o;++o)for(r=m.replaysByZIndex_[n[o].toString()],q=h.ORDER.length-1;q>=0;--q)if(s=r[h.ORDER[q]],void 0!==s&&(t=s.replay(a,b,c,d,e,f,g,i,j,k,l)))return t;return void 0},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,g,h,i,j,k){var l=b.getGL();l.bindFramebuffer(l.FRAMEBUFFER,b.getHitDetectionFramebuffer());var m;return void 0!==this.renderBuffer_&&(m=f.buffer(f.createOrUpdateFromCoordinate(a),d*this.renderBuffer_)),this.replayHitDetection_(b,a,d,e,o,h,i,j,function(a){var b=new Uint8Array(4);if(l.readPixels(0,0,1,1,l.RGBA,l.UNSIGNED_BYTE,b),b[3]>0){var c=k(a);if(c)return c}},!0,m)},b.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e,f,g,h,i){var j=b.getGL();j.bindFramebuffer(j.FRAMEBUFFER,b.getHitDetectionFramebuffer());var k=this.replayHitDetection_(b,a,d,e,o,g,h,i,function(){var a=new Uint8Array(4);return j.readPixels(0,0,1,1,j.RGBA,j.UNSIGNED_BYTE,a),a[3]>0},!1);return void 0!==k},b}(i.default),r=q;c.default=r},{"../../array.js":45,"../../extent.js":71,"../../obj.js":149,"../ReplayGroup.js":169,"../replay.js":181,"../webgl/CircleReplay.js":183,"../webgl/ImageReplay.js":184,"../webgl/LineStringReplay.js":186,"../webgl/PolygonReplay.js":187,"../webgl/TextReplay.js":190}],190:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../colorlike.js"),g=a("../../dom.js"),h=d(a("../../geom/GeometryType.js")),i=a("../../has.js"),j=a("../replay.js"),k=a("../webgl.js"),l=d(a("../webgl/TextureReplay.js")),m=d(a("../../style/AtlasManager.js")),n=d(a("../../webgl/Buffer.js")),o=function(a){function b(b,c){a.call(this,b,c),this.images_=[],this.textures_=[],this.measureCanvas_=g.createCanvasContext2D(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawText=function(a,b){var c=this;if(this.text_){var d=null,f=0,g=2,i=2;switch(a.getType()){case h.default.POINT:case h.default.MULTI_POINT:d=a.getFlatCoordinates(),g=d.length,i=a.getStride();break;case h.default.CIRCLE:d=a.getCenter();break;case h.default.LINE_STRING:d=a.getFlatMidpoint();break;case h.default.MULTI_LINE_STRING:d=a.getFlatMidpoints(),g=d.length;break;case h.default.POLYGON:d=a.getFlatInteriorPoint();break;case h.default.MULTI_POLYGON:d=a.getFlatInteriorPoints(),g=d.length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b);var j,k,l,m,n,o,p,q,r=this.currAtlas_,s=this.text_.split("\n"),t=this.getTextSize_(s),u=Math.round(t[0]*this.textAlign_-this.offsetX_),v=Math.round(t[1]*this.textBaseline_-this.offsetY_),w=this.state_.lineWidth/2*this.state_.scale;for(j=0,k=s.length;k>j;++j)for(n=0,o=r.height*j,p=s[j].split(""),l=0,m=p.length;m>l;++l){if(q=r.atlas.getInfo(p[l])){var x=q.image;if(c.anchorX=u-n,c.anchorY=v-o,c.originX=0===l?q.offsetX-w:q.offsetX,c.originY=q.offsetY,c.height=r.height,c.width=0===l||l===p.length-1?r.width[p[l]]+w:r.width[p[l]],c.imageHeight=x.height,c.imageWidth=x.width,0===c.images_.length)c.images_.push(x);else{var y=c.images_[c.images_.length-1];e.getUid(y)!=e.getUid(x)&&(c.groupIndices.push(c.indices.length),c.images_.push(x))}c.drawText_(d,f,g,i)}n+=c.width}}},b.prototype.getTextSize_=function(a){var b=this,c=this.currAtlas_,d=a.length*c.height,e=a.map(function(a){for(var d=0,e=0,f=a.length;f>e;++e){var g=a[e];c.width[g]||b.addCharToAtlas_(g),d+=c.width[g]?c.width[g]:0}return d}).reduce(function(a,b){return Math.max(a,b)});return[e,d]},b.prototype.drawText_=function(a,b,c,d){for(var e=this,f=b,g=c;g>f;f+=d)e.drawCoordinates(a,b,c,d)},b.prototype.addCharToAtlas_=function(a){if(1===a.length){var b=this.currAtlas_,c=this.state_,d=this.measureCanvas_.getContext("2d");d.font=c.font;var e=Math.ceil(d.measureText(a).width*c.scale),f=b.atlas.add(a,e,b.height,function(b,d,e){b.font=c.font,b.fillStyle=c.fillColor,b.strokeStyle=c.strokeColor,b.lineWidth=c.lineWidth,b.lineCap=c.lineCap,b.lineJoin=c.lineJoin,b.miterLimit=c.miterLimit,b.textAlign="left",b.textBaseline="top",i.CANVAS_LINE_DASH&&c.lineDash&&(b.setLineDash(c.lineDash),b.lineDashOffset=c.lineDashOffset),1!==c.scale&&b.setTransform(c.scale,0,0,c.scale,0,0),c.strokeColor&&b.strokeText(a,d,e),c.fillColor&&b.fillText(a,d,e)});f&&(b.width[a]=e)}},b.prototype.finish=function(b){var c=b.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new n.default(this.vertices),this.indicesBuffer=new n.default(this.indices);var d={};this.createTextures(this.textures_,this.images_,d,c),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,a.prototype.finish.call(this,b)},b.prototype.setTextStyle=function(a){var b=this.state_,c=a.getFill(),d=a.getStroke();if(a&&a.getText()&&(c||d)){if(c){var e=c.getColor();b.fillColor=f.asColorLike(e?e:k.DEFAULT_FILLSTYLE)}else b.fillColor=null;if(d){var g=d.getColor();b.strokeColor=f.asColorLike(g?g:k.DEFAULT_STROKESTYLE),b.lineWidth=d.getWidth()||k.DEFAULT_LINEWIDTH,b.lineCap=d.getLineCap()||k.DEFAULT_LINECAP,b.lineDashOffset=d.getLineDashOffset()||k.DEFAULT_LINEDASHOFFSET,b.lineJoin=d.getLineJoin()||k.DEFAULT_LINEJOIN,b.miterLimit=d.getMiterLimit()||k.DEFAULT_MITERLIMIT;var h=d.getLineDash();b.lineDash=h?h.slice():k.DEFAULT_LINEDASH}else b.strokeColor=null,b.lineWidth=0;b.font=a.getFont()||k.DEFAULT_FONT,b.scale=a.getScale()||1,this.text_=a.getText();var i=j.TEXT_ALIGN[a.getTextAlign()],l=j.TEXT_ALIGN[a.getTextBaseline()];this.textAlign_=void 0===i?k.DEFAULT_TEXTALIGN:i,this.textBaseline_=void 0===l?k.DEFAULT_TEXTBASELINE:l,this.offsetX_=a.getOffsetX()||0,this.offsetY_=a.getOffsetY()||0,this.rotateWithView=!!a.getRotateWithView(),this.rotation=a.getRotation()||0,this.currAtlas_=this.getAtlas_(b)}else this.text_=""},b.prototype.getAtlas_=function(a){var b=[];for(var c in a)(a[c]||0===a[c])&&(Array.isArray(a[c])?b=b.concat(a[c]):b.push(a[c]));var d=this.calculateHash_(b);if(!this.atlases_[d]){var e=this.measureCanvas_.getContext("2d");
e.font=a.font;var f=Math.ceil((1.5*e.measureText("M").width+a.lineWidth/2)*a.scale);this.atlases_[d]={atlas:new m.default({space:a.lineWidth+1}),width:{},height:f}}return this.atlases_[d]},b.prototype.calculateHash_=function(a){for(var b="",c=0,d=a.length;d>c;++c)b+=a[c];return b},b.prototype.getTextures=function(){return this.textures_},b.prototype.getHitDetectionTextures=function(){return this.textures_},b}(l.default),p=o;c.default=p},{"../../colorlike.js":49,"../../dom.js":63,"../../geom/GeometryType.js":81,"../../has.js":109,"../../style/AtlasManager.js":267,"../../util.js":289,"../../webgl/Buffer.js":292,"../replay.js":181,"../webgl.js":182,"../webgl/TextureReplay.js":191}],191:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../extent.js"),g=a("../../obj.js"),h=a("../webgl/texturereplay/defaultshader.js"),i=d(a("../webgl/texturereplay/defaultshader/Locations.js")),j=d(a("../webgl/Replay.js")),k=a("../../webgl.js"),l=a("../../webgl/Context.js"),m=function(a){function b(b,c){a.call(this,b,c),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.getTextures(!0),e=a.getGL();return function(){if(!e.isContextLost()){var f,g;for(f=0,g=d.length;g>f;++f)e.deleteTexture(d[f])}a.deleteBuffer(b),a.deleteBuffer(c)}},b.prototype.drawCoordinates=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=this.anchorX,m=this.anchorY,n=this.height,o=this.imageHeight,p=this.imageWidth,q=this.opacity,r=this.originX,s=this.originY,t=this.rotateWithView?1:0,u=-this.rotation,v=this.scale,w=this.width,x=Math.cos(u),y=Math.sin(u),z=this.indices.length,A=this.vertices.length;for(e=b;c>e;e+=d)i=a[e]-k.origin[0],j=a[e+1]-k.origin[1],f=A/8,g=-v*l,h=-v*(n-m),k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=r/p,k.vertices[A++]=(s+n)/o,k.vertices[A++]=q,k.vertices[A++]=t,g=v*(w-l),h=-v*(n-m),k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=(r+w)/p,k.vertices[A++]=(s+n)/o,k.vertices[A++]=q,k.vertices[A++]=t,g=v*(w-l),h=v*m,k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=(r+w)/p,k.vertices[A++]=s/o,k.vertices[A++]=q,k.vertices[A++]=t,g=-v*l,h=v*m,k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=r/p,k.vertices[A++]=s/o,k.vertices[A++]=q,k.vertices[A++]=t,k.indices[z++]=f,k.indices[z++]=f+1,k.indices[z++]=f+2,k.indices[z++]=f,k.indices[z++]=f+2,k.indices[z++]=f+3;return A},b.prototype.createTextures=function(a,b,c,d){var f,g,h,i,j=b.length;for(i=0;j>i;++i)g=b[i],h=e.getUid(g).toString(),h in c?f=c[h]:(f=l.createTexture(d,g,k.CLAMP_TO_EDGE,k.CLAMP_TO_EDGE),c[h]=f),a[i]=f},b.prototype.setUpProgram=function(a,b){var c,d=b.getProgram(h.fragment,h.vertex);return this.defaultLocations?c=this.defaultLocations:(c=new i.default(a,d),this.defaultLocations=c),b.useProgram(d),a.enableVertexAttribArray(c.a_position),a.vertexAttribPointer(c.a_position,2,k.FLOAT,!1,32,0),a.enableVertexAttribArray(c.a_offsets),a.vertexAttribPointer(c.a_offsets,2,k.FLOAT,!1,32,8),a.enableVertexAttribArray(c.a_texCoord),a.vertexAttribPointer(c.a_texCoord,2,k.FLOAT,!1,32,16),a.enableVertexAttribArray(c.a_opacity),a.vertexAttribPointer(c.a_opacity,1,k.FLOAT,!1,32,24),a.enableVertexAttribArray(c.a_rotateWithView),a.vertexAttribPointer(c.a_rotateWithView,1,k.FLOAT,!1,32,28),c},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position),a.disableVertexAttribArray(b.a_offsets),a.disableVertexAttribArray(b.a_texCoord),a.disableVertexAttribArray(b.a_opacity),a.disableVertexAttribArray(b.a_rotateWithView)},b.prototype.drawReplay=function(a,b,c,d){var e=this,f=d?this.getHitDetectionTextures():this.getTextures(),h=d?this.hitDetectionGroupIndices:this.groupIndices;if(g.isEmpty(c)){var i,j,l;for(i=0,j=f.length,l=0;j>i;++i){a.bindTexture(k.TEXTURE_2D,f[i]);var m=h[i];e.drawElements(a,b,l,m),l=m}}else this.drawReplaySkipping(a,b,c,f,h)},b.prototype.drawReplaySkipping=function(a,b,c,d,f){var g,h,i=this,j=0;for(g=0,h=d.length;h>g;++g){a.bindTexture(k.TEXTURE_2D,d[g]);for(var l=g>0?f[g-1]:0,m=f[g],n=l,o=l;j<this.startIndices.length&&this.startIndices[j]<=m;){var p=i.startIndicesFeature[j],q=e.getUid(p).toString();void 0!==c[q]?(n!==o&&i.drawElements(a,b,n,o),n=j===i.startIndices.length-1?m:i.startIndices[j+1],o=n):o=j===i.startIndices.length-1?m:i.startIndices[j+1],j++}n!==o&&i.drawElements(a,b,n,o)}},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,g){var h,i,j,l,m,n,o=this,p=this.startIndices.length-1,q=this.getHitDetectionTextures();for(h=q.length-1;h>=0;--h)for(a.bindTexture(k.TEXTURE_2D,q[h]),i=h>0?o.hitDetectionGroupIndices[h-1]:0,l=o.hitDetectionGroupIndices[h];p>=0&&this.startIndices[p]>=i;){if(j=o.startIndices[p],m=o.startIndicesFeature[p],n=e.getUid(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===g||f.intersects(g,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),o.drawElements(a,b,j,l);var r=d(m);if(r)return r}l=j,p--}return void 0},b.prototype.finish=function(){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},b.prototype.getTextures=function(){},b.prototype.getHitDetectionTextures=function(){},b}(j.default),n=m;c.default=n},{"../../extent.js":71,"../../obj.js":149,"../../util.js":289,"../../webgl.js":291,"../../webgl/Context.js":293,"../webgl/Replay.js":188,"../webgl/texturereplay/defaultshader.js":198,"../webgl/texturereplay/defaultshader/Locations.js":199}],192:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");c.vertex=i},{"../../../webgl.js":291,"../../../webgl/Fragment.js":295,"../../../webgl/Vertex.js":297}],193:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"j"),this.u_lineWidth=a.getUniformLocation(b,d.DEBUG?"u_lineWidth":"k"),this.u_pixelRatio=a.getUniformLocation(b,d.DEBUG?"u_pixelRatio":"l"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"m"),this.u_fillColor=a.getUniformLocation(b,d.DEBUG?"u_fillColor":"n"),this.u_strokeColor=a.getUniformLocation(b,d.DEBUG?"u_strokeColor":"o"),this.u_size=a.getUniformLocation(b,d.DEBUG?"u_size":"p"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"e"),this.a_instruction=a.getAttribLocation(b,d.DEBUG?"a_instruction":"f"),this.a_radius=a.getAttribLocation(b,d.DEBUG?"a_radius":"g")},f=e;c.default=f},{"../../../../webgl.js":291}],194:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");c.fragment=h;var i=new g.default(e.DEBUG?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}");c.vertex=i},{"../../../webgl.js":291,"../../../webgl/Fragment.js":295,"../../../webgl/Vertex.js":297}],195:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"j"),this.u_lineWidth=a.getUniformLocation(b,d.DEBUG?"u_lineWidth":"k"),this.u_miterLimit=a.getUniformLocation(b,d.DEBUG?"u_miterLimit":"l"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"m"),this.u_color=a.getUniformLocation(b,d.DEBUG?"u_color":"n"),this.u_size=a.getUniformLocation(b,d.DEBUG?"u_size":"o"),this.u_pixelRatio=a.getUniformLocation(b,d.DEBUG?"u_pixelRatio":"p"),this.a_lastPos=a.getAttribLocation(b,d.DEBUG?"a_lastPos":"d"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"e"),this.a_nextPos=a.getAttribLocation(b,d.DEBUG?"a_nextPos":"f"),this.a_direction=a.getAttribLocation(b,d.DEBUG?"a_direction":"g")},f=e;c.default=f},{"../../../../webgl.js":291}],196:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");c.fragment=h;var i=new g.default(e.DEBUG?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}");c.vertex=i},{"../../../webgl.js":291,"../../../webgl/Fragment.js":295,"../../../webgl/Vertex.js":297}],197:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"d"),this.u_color=a.getUniformLocation(b,d.DEBUG?"u_color":"e"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"f"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"a")},f=e;c.default=f},{"../../../../webgl.js":291}],198:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}");c.vertex=i},{"../../../webgl.js":291,"../../../webgl/Fragment.js":295,"../../../webgl/Vertex.js":297}],199:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"j"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"k"),this.u_image=a.getUniformLocation(b,d.DEBUG?"u_image":"l"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"c"),this.a_texCoord=a.getAttribLocation(b,d.DEBUG?"a_texCoord":"d"),this.a_offsets=a.getAttribLocation(b,d.DEBUG?"a_offsets":"e"),this.a_opacity=a.getAttribLocation(b,d.DEBUG?"a_opacity":"f"),this.a_rotateWithView=a.getAttribLocation(b,d.DEBUG?"a_rotateWithView":"g")},f=e;c.default=f},{"../../../../webgl.js":291}],200:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("../ImageState.js")),g=d(a("../Observable.js")),h=d(a("../TileState.js")),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../functions.js"),l=d(a("../source/State.js")),m=function(a){function b(b){a.call(this),this.layer_=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createLoadedTileFinder=function(a,b,c){return function(d,e){function f(a){c[d]||(c[d]={}),c[d][a.tileCoord.toString()]=a}return a.forEachLoadedTile(b,d,e,f)}},b.prototype.getLayer=function(){return this.layer_},b.prototype.handleImageChange_=function(a){var b=a.target;b.getState()===f.default.LOADED&&this.renderIfReadyAndVisible()},b.prototype.loadImage=function(a){var b=a.getState();return b!=f.default.LOADED&&b!=f.default.ERROR&&i.listen(a,j.default.CHANGE,this.handleImageChange_,this),b==f.default.IDLE&&(a.load(),b=a.getState()),b==f.default.LOADED},b.prototype.renderIfReadyAndVisible=function(){var a=this.getLayer();a.getVisible()&&a.getSourceState()==l.default.READY&&this.changed()},b.prototype.scheduleExpireCache=function(a,b){if(b.canExpireCache()){var c=function(a,b,c){var d=e.getUid(a).toString();d in c.usedTiles&&a.expireCache(c.viewState.projection,c.usedTiles[d])}.bind(null,b);a.postRenderFunctions.push(c)}},b.prototype.updateUsedTiles=function(a,b,c,d){var f=e.getUid(b).toString(),g=c.toString();f in a?g in a[f]?a[f][g].extend(d):a[f][g]=d:(a[f]={},a[f][g]=d)},b.prototype.manageTilePyramid=function(a,b,c,d,f,g,i,j,k,l){var m=e.getUid(b).toString();m in a.wantedTiles||(a.wantedTiles[m]={});var n,o,p,q,r,s,t=a.wantedTiles[m],u=a.tileQueue,v=c.getMinZoom();for(s=v;i>=s;++s)for(o=c.getTileRangeForExtentAndZ(g,s,o),p=c.getResolution(s),q=o.minX;q<=o.maxX;++q)for(r=o.minY;r<=o.maxY;++r)j>=i-s?(n=b.getTile(s,q,r,d,f),n.getState()==h.default.IDLE&&(t[n.getKey()]=!0,u.isKeyQueued(n.getKey())||u.enqueue([n,m,c.getTileCoordCenter(n.tileCoord),p])),void 0!==k&&k.call(l,n)):b.useTile(s,q,r,f)},b}(g.default);m.prototype.forEachFeatureAtCoordinate=k.VOID,m.prototype.hasFeatureAtCoordinate=k.FALSE;var n=m;c.default=n},{"../ImageState.js":16,"../Observable.js":30,"../TileState.js":38,"../events.js":65,"../events/EventType.js":67,"../functions.js":76,"../source/State.js":241,"../util.js":289}],201:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){n.shared.expire()
}function f(a,b){return a.zIndex-b.zIndex}Object.defineProperty(c,"__esModule",{value:!0}),c.sortByZIndex=f,c.default=void 0;var g=a("../util.js"),h=d(a("../Disposable.js")),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../extent.js"),l=a("../functions.js"),m=a("../layer/Layer.js"),n=a("../style/IconImageCache.js"),o=a("../transform.js"),p=function(a){function b(b){a.call(this),this.map_=b,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.registerLayerRenderers=function(a){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,a)},b.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},b.prototype.calculateMatrices2D=function(a){var b=a.viewState,c=a.coordinateToPixelTransform,d=a.pixelToCoordinateTransform;o.compose(c,a.size[0]/2,a.size[1]/2,1/b.resolution,-1/b.resolution,-b.rotation,-b.center[0],-b.center[1]),o.invert(o.setFromArray(d,c))},b.prototype.removeLayerRenderers=function(){var a=this;for(var b in a.layerRenderers_)a.removeLayerRendererByKey_(b).dispose()},b.prototype.forEachFeatureAtCoordinate=function c(a,b,d,e,f,h,i){function c(a,c){var d=g.getUid(a).toString(),h=b.layerStates[g.getUid(c)].managed;return d in b.skippedFeatureUids&&!h?void 0:e.call(f,a,h?c:null)}var j,l=this,n=b.viewState,o=n.resolution,p=n.projection,q=a;if(p.canWrapX()){var r=p.getExtent(),s=k.getWidth(r),t=a[0];if(t<r[0]||t>r[2]){var u=Math.ceil((r[0]-t)/s);q=[t+s*u,a[1]]}}var v,w=b.layerStatesArray,x=w.length;for(v=x-1;v>=0;--v){var y=w[v],z=y.layer;if(m.visibleAtResolution(y,o)&&h.call(i,z)){var A=l.getLayerRenderer(z);if(z.getSource()&&(j=A.forEachFeatureAtCoordinate(z.getSource().getWrapX()?q:a,b,d,c,f)),j)return j}}return void 0},b.prototype.forEachLayerAtPixel=function(){},b.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){var f=this.forEachFeatureAtCoordinate(a,b,c,l.TRUE,this,d,e);return void 0!==f},b.prototype.getLayerRenderer=function(a){var b=this,c=g.getUid(a).toString();if(c in this.layerRenderers_)return this.layerRenderers_[c];for(var d,e=0,f=this.layerRendererConstructors_.length;f>e;++e){var h=b.layerRendererConstructors_[e];if(h.handles(a)){d=h.create(b,a);break}}if(!d)throw new Error("Unable to create renderer for layer: "+a.getType());return this.layerRenderers_[c]=d,this.layerRendererListeners_[c]=i.listen(d,j.default.CHANGE,this.handleLayerRendererChange_,this),d},b.prototype.getLayerRendererByKey=function(a){return this.layerRenderers_[a]},b.prototype.getLayerRenderers=function(){return this.layerRenderers_},b.prototype.getMap=function(){return this.map_},b.prototype.handleLayerRendererChange_=function(){this.map_.render()},b.prototype.removeLayerRendererByKey_=function(a){var b=this.layerRenderers_[a];return delete this.layerRenderers_[a],i.unlistenByKey(this.layerRendererListeners_[a]),delete this.layerRendererListeners_[a],b},b.prototype.removeUnusedLayerRenderers_=function(a,b){var c=this;for(var d in c.layerRenderers_)b&&d in b.layerStates||c.removeLayerRendererByKey_(d).dispose()},b.prototype.scheduleExpireIconCache=function(a){a.postRenderFunctions.push(e)},b.prototype.scheduleRemoveUnusedLayerRenderers=function(a){var b=this;for(var c in b.layerRenderers_)if(!(c in a.layerStates))return void a.postRenderFunctions.push(b.removeUnusedLayerRenderers_.bind(b))},b}(h.default);p.prototype.renderFrame=l.VOID,p.prototype.dispatchRenderEvent=l.VOID;var q=p;c.default=q},{"../Disposable.js":8,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../functions.js":76,"../layer/Layer.js":138,"../style/IconImageCache.js":273,"../transform.js":287,"../util.js":289}],202:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../reproj/common.js"),f=d(a("../../ImageCanvas.js")),g=d(a("../../LayerType.js")),h=d(a("../../ViewHint.js")),i=a("../../array.js"),j=a("../../extent.js"),k=d(a("../../layer/VectorRenderType.js")),l=a("../../obj.js"),m=a("./Map.js"),n=d(a("./IntermediateCanvas.js")),o=a("../../transform.js"),p=function(a){function b(c){var d=this;if(a.call(this,c),this.image_=null,this.imageTransform_=o.create(),this.skippedFeatures_=[],this.vectorRenderer_=null,c.getType()===g.default.VECTOR)for(var e=0,f=m.layerRendererConstructors.length;f>e;++e){var h=m.layerRendererConstructors[e];if(h!==b&&h.handles(c)){d.vectorRenderer_=new h(c);break}}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.image_?this.image_.getImage():null},b.prototype.getImageTransform=function(){return this.imageTransform_},b.prototype.prepareFrame=function(a,b){var c,d=a.pixelRatio,g=a.size,k=a.viewState,m=k.center,n=k.resolution,p=this.getLayer(),q=p.getSource(),r=a.viewHints,s=this.vectorRenderer_,t=a.extent;if(s||void 0===b.extent||(t=j.getIntersection(t,b.extent)),!r[h.default.ANIMATING]&&!r[h.default.INTERACTING]&&!j.isEmpty(t)){var u=k.projection;if(!e.ENABLE_RASTER_REPROJECTION){var v=q.getProjection();v&&(u=v)}var w=this.skippedFeatures_;if(s){var x=s.context,y=l.assign({},a,{size:[j.getWidth(t)/n,j.getHeight(t)/n],viewState:l.assign({},a.viewState,{rotation:0})}),z=Object.keys(y.skippedFeatureUids).sort();c=new f.default(t,n,d,x.canvas,function(a){!s.prepareFrame(y,b)||!s.replayGroupChanged&&i.equals(w,z)||(x.canvas.width=y.size[0]*d,x.canvas.height=y.size[1]*d,s.compose(x,y,b),w=z,a())})}else c=q.getImage(t,n,d,u);c&&this.loadImage(c)&&(this.image_=c,this.skippedFeatures_=w)}if(this.image_){c=this.image_;var A=c.getExtent(),B=c.getResolution(),C=c.getPixelRatio(),D=d*B/(n*C),E=o.compose(this.imageTransform_,d*g[0]/2,d*g[1]/2,D,D,0,C*(A[0]-m[0])/B,C*(m[1]-A[3])/B);o.compose(this.coordinateToCanvasPixelTransform,d*g[0]/2-E[4],d*g[1]/2-E[5],d/n,-d/n,0,-m[0],-m[1]),this.renderedResolution=B*d/C}return!!this.image_},b.prototype.forEachFeatureAtCoordinate=function(b,c,d,e,f){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(b,c,d,e,f):a.prototype.forEachFeatureAtCoordinate.call(this,b,c,d,e,f)},b}(n.default);p.handles=function(a){return a.getType()===g.default.IMAGE||a.getType()===g.default.VECTOR&&a.getRenderMode()===k.default.IMAGE},p.create=function(a,b){return new p(b)};var q=p;c.default=q},{"../../ImageCanvas.js":15,"../../LayerType.js":19,"../../ViewHint.js":42,"../../array.js":45,"../../extent.js":71,"../../layer/VectorRenderType.js":143,"../../obj.js":149,"../../reproj/common.js":223,"../../transform.js":287,"./IntermediateCanvas.js":203,"./Map.js":205}],203:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../coordinate.js"),f=a("../../dom.js"),g=a("../../extent.js"),h=a("../../functions.js"),i=d(a("../canvas/Layer.js")),j=a("../../transform.js"),k=function(a){function b(b){a.call(this,b),this.coordinateToCanvasPixelTransform=j.create(),this.hitCanvasContext_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.composeFrame=function(a,b,c){this.preCompose(c,a);var d=this.getImage();if(d){var e=b.extent,f=void 0!==e&&!g.containsExtent(e,a.extent)&&g.intersects(e,a.extent);f&&this.clip(c,a,e);var h=this.getImageTransform(),i=c.globalAlpha;c.globalAlpha=b.opacity;var j=h[4],k=h[5],l=d.width*h[0],m=d.height*h[3];c.drawImage(d,0,0,+d.width,+d.height,Math.round(j),Math.round(k),Math.round(l),Math.round(m)),c.globalAlpha=i,f&&c.restore()}this.postCompose(c,a,b)},b.prototype.getImage=function(){},b.prototype.getImageTransform=function(){},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer(),g=f.getSource(),h=b.viewState.resolution,i=b.viewState.rotation,j=b.skippedFeatureUids;return g.forEachFeatureAtCoordinate(a,h,i,c,j,function(a){return d.call(e,a,f)})},b.prototype.forEachLayerAtCoordinate=function(b,c,d,g,i){if(!this.getImage())return void 0;if(this.getLayer().getSource().forEachFeatureAtCoordinate!==h.VOID)return a.prototype.forEachLayerAtCoordinate.call(this,arguments);var k=j.apply(this.coordinateToCanvasPixelTransform,b.slice());e.scale(k,c.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=f.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),k[0],k[1],1,1,0,0,1,1);var l=this.hitCanvasContext_.getImageData(0,0,1,1).data;return l[3]>0?g.call(i,this.getLayer(),l):void 0},b}(i.default),l=k;c.default=l},{"../../coordinate.js":61,"../../dom.js":63,"../../extent.js":71,"../../functions.js":76,"../../transform.js":287,"../canvas/Layer.js":204}],204:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../extent.js"),f=a("../../functions.js"),g=d(a("../../render/Event.js")),h=d(a("../../render/EventType.js")),i=a("../../render/canvas.js"),j=d(a("../../render/canvas/Immediate.js")),k=d(a("../Layer.js")),l=a("../../transform.js"),m=function(a){function b(b){a.call(this,b),this.renderedResolution,this.transform_=l.create()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clip=function(a,b,c){var d=b.pixelRatio,f=b.size[0]*d,g=b.size[1]*d,h=b.viewState.rotation,j=e.getTopLeft(c),k=e.getTopRight(c),m=e.getBottomRight(c),n=e.getBottomLeft(c);l.apply(b.coordinateToPixelTransform,j),l.apply(b.coordinateToPixelTransform,k),l.apply(b.coordinateToPixelTransform,m),l.apply(b.coordinateToPixelTransform,n),a.save(),i.rotateAtOffset(a,-h,f/2,g/2),a.beginPath(),a.moveTo(j[0]*d,j[1]*d),a.lineTo(k[0]*d,k[1]*d),a.lineTo(m[0]*d,m[1]*d),a.lineTo(n[0]*d,n[1]*d),a.clip(),i.rotateAtOffset(a,h,f/2,g/2)},b.prototype.dispatchComposeEvent_=function(a,b,c,d){var e=this.getLayer();if(e.hasListener(a)){var f=c.size[0]*c.pixelRatio,h=c.size[1]*c.pixelRatio,k=c.viewState.rotation;i.rotateAtOffset(b,-k,f/2,h/2);var l=void 0!==d?d:this.getTransform(c,0),m=new j.default(b,c.pixelRatio,c.extent,l,c.viewState.rotation),n=new g.default(a,m,c,b,null);e.dispatchEvent(n),i.rotateAtOffset(b,k,f/2,h/2)}},b.prototype.forEachLayerAtCoordinate=function(a,b,c,d,e){var g=this.forEachFeatureAtCoordinate(a,b,c,f.TRUE,this);return g?d.call(e,this.getLayer(),null):void 0},b.prototype.postCompose=function(a,b,c,d){this.dispatchComposeEvent_(h.default.POSTCOMPOSE,a,b,d)},b.prototype.preCompose=function(a,b,c){this.dispatchComposeEvent_(h.default.PRECOMPOSE,a,b,c)},b.prototype.dispatchRenderEvent=function(a,b,c){this.dispatchComposeEvent_(h.default.RENDER,a,b,c)},b.prototype.getTransform=function(a,b){var c=a.viewState,d=a.pixelRatio,e=d*a.size[0]/2,f=d*a.size[1]/2,g=d/c.resolution,h=-g,i=-c.rotation,j=-c.center[0]+b,k=-c.center[1];return l.compose(this.transform_,e,f,g,h,i,j,k)},b.prototype.composeFrame=function(){},b.prototype.prepareFrame=function(){},b}(k.default),n=m;c.default=n},{"../../extent.js":71,"../../functions.js":76,"../../render/Event.js":167,"../../render/EventType.js":168,"../../render/canvas.js":172,"../../render/canvas/Immediate.js":174,"../../transform.js":287,"../Layer.js":200}],205:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.layerRendererConstructors=void 0;var f=a("../../transform.js"),g=a("../../array.js"),h=a("../../css.js"),i=a("../../dom.js"),j=a("../../layer/Layer.js"),k=e(a("../../render/Event.js")),l=e(a("../../render/EventType.js")),m=a("../../render/canvas.js"),n=e(a("../../render/canvas/Immediate.js")),o=d(a("../Map.js")),p=e(a("../../source/State.js")),q=[];c.layerRendererConstructors=q;var r=function(a){function b(b){a.call(this,b);var c=b.getViewport();this.context_=i.createCanvasContext2D(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=h.CLASS_UNSELECTABLE,c.insertBefore(this.canvas_,c.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=f.create()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.dispatchRenderEvent=function(a,b){var c=this.getMap(),d=this.context_;if(c.hasListener(a)){var e=b.extent,f=b.pixelRatio,g=b.viewState,h=g.rotation,i=this.getTransform(b),j=new n.default(d,f,e,i,h),l=new k.default(a,j,b,d,null);c.dispatchEvent(l)}},b.prototype.getTransform=function(a){var b=a.viewState,c=this.canvas_.width/2,d=this.canvas_.height/2,e=a.pixelRatio/b.resolution,g=-e,h=-b.rotation,i=-b.center[0],j=-b.center[1];return f.compose(this.transform_,c,d,e,g,h,i,j)},b.prototype.renderFrame=function(a){var b=this;if(!a)return void(this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1));var c=this.context_,d=a.pixelRatio,e=Math.round(a.size[0]*d),f=Math.round(a.size[1]*d);this.canvas_.width!=e||this.canvas_.height!=f?(this.canvas_.width=e,this.canvas_.height=f):c.clearRect(0,0,e,f);var h=a.viewState.rotation;this.calculateMatrices2D(a),this.dispatchRenderEvent(l.default.PRECOMPOSE,a);var i=a.layerStatesArray;g.stableSort(i,o.sortByZIndex),h&&(c.save(),m.rotateAtOffset(c,h,e/2,f/2));var k,n,q,r,s,t=a.viewState.resolution;for(k=0,n=i.length;n>k;++k)s=i[k],q=s.layer,r=b.getLayerRenderer(q),j.visibleAtResolution(s,t)&&s.sourceState==p.default.READY&&r.prepareFrame(a,s)&&r.composeFrame(a,s,c);h&&c.restore(),this.dispatchRenderEvent(l.default.POSTCOMPOSE,a),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(a),this.scheduleExpireIconCache(a)},b.prototype.forEachLayerAtPixel=function(a,b,c,d,e,g,h){var i,k,l=this,m=b.viewState,n=m.resolution,o=b.layerStatesArray,p=o.length,q=f.apply(b.pixelToCoordinateTransform,a.slice());for(k=p-1;k>=0;--k){var r=o[k],s=r.layer;if(j.visibleAtResolution(r,n)&&g.call(h,s)){var t=l.getLayerRenderer(s);if(i=t.forEachLayerAtCoordinate(q,b,c,d,e))return i}}return void 0},b.prototype.registerLayerRenderers=function(b){a.prototype.registerLayerRenderers.call(this,b);for(var c=0,d=b.length;d>c;++c){var e=b[c];g.includes(q,e)||q.push(e)}},b}(o.default),s=r;c.default=s},{"../../array.js":45,"../../css.js":62,"../../dom.js":63,"../../layer/Layer.js":138,"../../render/Event.js":167,"../../render/EventType.js":168,"../../render/canvas.js":172,"../../render/canvas/Immediate.js":174,"../../source/State.js":241,"../../transform.js":287,"../Map.js":201}],206:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../../LayerType.js")),g=d(a("../../TileRange.js")),h=d(a("../../TileState.js")),i=d(a("../../ViewHint.js")),j=a("../../dom.js"),k=a("../../extent.js"),l=d(a("../canvas/IntermediateCanvas.js")),m=a("../../transform.js"),n=function(a){function b(b,c){a.call(this,b),this.context=c?null:j.createCanvasContext2D(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=k.createEmpty(),this.tmpTileRange_=new g.default(0,0,0,0),this.imageTransform_=m.create(),this.zDirection=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.isDrawableTile_=function(a){var b=a.getState(),c=this.getLayer().getUseInterimTilesOnError();return b==h.default.LOADED||b==h.default.EMPTY||b==h.default.ERROR&&!c},b.prototype.getTile=function(a,b,c,d,e){var f=this.getLayer(),g=f.getSource(),i=g.getTile(a,b,c,d,e);return i.getState()==h.default.ERROR&&(f.getUseInterimTilesOnError()?f.getPreload()>0&&(this.newTiles_=!0):i.setState(h.default.LOADED)),this.isDrawableTile_(i)||(i=i.getInterimTile()),i},b.prototype.prepareFrame=function(a,b){var c=this,d=a.pixelRatio,f=a.size,g=a.viewState,j=g.projection,l=g.resolution,n=g.center,o=this.getLayer(),p=o.getSource(),q=p.getRevision(),r=p.getTileGridForProjection(j),s=r.getZForResolution(l,this.zDirection),t=r.getResolution(s),u=Math.round(l/t)||1,v=a.extent;if(void 0!==b.extent&&(v=k.getIntersection(v,b.extent)),k.isEmpty(v))return!1;var w=r.getTileRangeForExtentAndZ(v,s),x=r.getTileRangeExtent(s,w),y=p.getTilePixelRatio(d),z={};z[s]={};var A=this.createLoadedTileFinder(p,j,z),B=a.viewHints,C=B[i.default.ANIMATING]||B[i.default.INTERACTING],D=this.tmpExtent,E=this.tmpTileRange_;this.newTiles_=!1;var F,G,H;for(G=w.minX;G<=w.maxX;++G)for(H=w.minY;H<=w.maxY;++H)if(!(Date.now()-a.time>16&&C)){if(F=c.getTile(s,G,H,d,j),c.isDrawableTile_(F)){var I=e.getUid(c);if(F.getState()==h.default.LOADED){z[s][F.tileCoord.toString()]=F;var J=F.inTransition(I);c.newTiles_||!J&&-1!==c.renderedTiles.indexOf(F)||(c.newTiles_=!0)}if(1===F.getAlpha(I,a.time))continue}var K=r.getTileCoordChildTileRange(F.tileCoord,E,D),L=!1;K&&(L=A(s+1,K)),L||r.forEachTileCoordParentTileRange(F.tileCoord,A,null,E,D)}var M=t*d/y*u;if(!(this.renderedResolution&&Date.now()-a.time>16&&C||!this.newTiles_&&this.renderedExtent_&&k.containsExtent(this.renderedExtent_,v)&&this.renderedRevision==q&&u==this.oversampling_&&(C||M==this.renderedResolution))){var N=this.context;if(N){var O=p.getTilePixelSize(s,d,j),P=Math.round(w.getWidth()*O[0]/u),Q=Math.round(w.getHeight()*O[1]/u),R=N.canvas;R.width!=P||R.height!=Q?(this.oversampling_=u,R.width=P,R.height=Q):(this.renderedExtent_&&!k.equals(x,this.renderedExtent_)&&N.clearRect(0,0,P,Q),u=this.oversampling_)}this.renderedTiles.length=0;var S=Object.keys(z).map(Number);S.sort(function(a,b){return a===s?1:b===s?-1:a>b?1:b>a?-1:0});var T,U,V,W,X,Y,Z,$,_,ab,bb;for(X=0,Y=S.length;Y>X;++X){W=S[X],V=p.getTilePixelSize(W,d,j),T=r.getResolution(W),U=T/t,$=y*p.getGutterForProjection(j),_=z[W];for(var cb in _)F=_[cb],Z=r.getTileCoordExtent(F.getTileCoord(),D),G=(Z[0]-x[0])/t*y/u,H=(x[3]-Z[3])/t*y/u,ab=V[0]*U/u,bb=V[1]*U/u,c.drawTileImage(F,a,b,G,H,ab,bb,$,s===W),c.renderedTiles.push(F)}this.renderedRevision=q,this.renderedResolution=t*d/y*u,this.renderedExtent_=x}var db=this.renderedResolution/l,eb=m.compose(this.imageTransform_,d*f[0]/2,d*f[1]/2,db,db,0,(this.renderedExtent_[0]-n[0])/this.renderedResolution*d,(n[1]-this.renderedExtent_[3])/this.renderedResolution*d);return m.compose(this.coordinateToCanvasPixelTransform,d*f[0]/2-eb[4],d*f[1]/2-eb[5],d/l,-d/l,0,-n[0],-n[1]),this.updateUsedTiles(a.usedTiles,p,s,w),this.manageTilePyramid(a,p,r,d,j,v,s,o.getPreload()),this.scheduleExpireCache(a,p),this.renderedTiles.length>0},b.prototype.drawTileImage=function(a,b,c,d,f,g,h,i,j){var k=a.getImage(this.getLayer());if(k){var l=e.getUid(this),m=j?a.getAlpha(l,b.time):1;1!==m||this.getLayer().getSource().getOpaque(b.viewState.projection)||this.context.clearRect(d,f,g,h);var n=m!==this.context.globalAlpha;n&&(this.context.save(),this.context.globalAlpha=m),this.context.drawImage(k,i,i,k.width-2*i,k.height-2*i,d,f,g,h),n&&this.context.restore(),1!==m?b.animate=!0:j&&a.endTransition(l)}},b.prototype.getImage=function(){var a=this.context;return a?a.canvas:null},b.prototype.getImageTransform=function(){return this.imageTransform_},b}(l.default);n.handles=function(a){return a.getType()===f.default.TILE},n.create=function(a,b){return new n(b)},n.prototype.getLayer;var o=n;c.default=o},{"../../LayerType.js":19,"../../TileRange.js":37,"../../TileState.js":38,"../../ViewHint.js":42,"../../dom.js":63,"../../extent.js":71,"../../transform.js":287,"../../util.js":289,"../canvas/IntermediateCanvas.js":203}],207:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../../LayerType.js")),g=d(a("../../ViewHint.js")),h=a("../../dom.js"),i=a("../../events.js"),j=d(a("../../events/EventType.js")),k=d(a("rbush")),l=a("../../extent.js"),m=d(a("../../render/EventType.js")),n=a("../../render/canvas.js"),o=d(a("../../render/canvas/ReplayGroup.js")),p=d(a("../canvas/Layer.js")),q=a("../vector.js"),r=function(a){function b(b){a.call(this,b),this.declutterTree_=b.getDeclutter()?k.default(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=0/0,this.renderedExtent_=l.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=h.createCanvasContext2D(),i.listen(n.labelCache,j.default.CLEAR,this.handleFontsChanged_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){i.unlisten(n.labelCache,j.default.CLEAR,this.handleFontsChanged_,this),a.prototype.disposeInternal.call(this)},b.prototype.compose=function(a,b,c){var d=this,e=b.extent,f=b.pixelRatio,h=c.managed?b.skippedFeatureUids:{},i=b.viewState,j=i.projection,k=i.rotation,o=j.getExtent(),p=this.getLayer().getSource(),q=this.getTransform(b,0),r=c.extent,s=void 0!==r;s&&this.clip(a,b,r);var t=this.replayGroup_;if(t&&!t.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var u,v=this.getLayer(),w=0,x=0,y=1!==c.opacity,z=v.hasListener(m.default.RENDER);if(y||z){var A=a.canvas.width,B=a.canvas.height;if(k){var C=Math.round(Math.sqrt(A*A+B*B));w=(C-A)/2,x=(C-B)/2,A=B=C}this.context.canvas.width=A,this.context.canvas.height=B,u=this.context}else u=a;var D=u.globalAlpha;y||(u.globalAlpha=c.opacity),u!=a&&u.translate(w,x);var E=b.viewHints,F=!(E[g.default.ANIMATING]||E[g.default.INTERACTING]),G=b.size[0]*f,H=b.size[1]*f;if(n.rotateAtOffset(u,-k,G/2,H/2),t.replay(u,q,k,h,F),p.getWrapX()&&j.canWrapX()&&!l.containsExtent(o,e)){for(var I,J=e[0],K=l.getWidth(o),L=0;J<o[0];)--L,I=K*L,q=d.getTransform(b,I),t.replay(u,q,k,h,F),J+=K;for(L=0,J=e[2];J>o[2];)++L,I=K*L,q=d.getTransform(b,I),t.replay(u,q,k,h,F),J-=K}if(n.rotateAtOffset(u,k,G/2,H/2),z&&this.dispatchRenderEvent(u,b,q),u!=a){if(y){var M=a.globalAlpha;a.globalAlpha=c.opacity,a.drawImage(u.canvas,-w,-x),a.globalAlpha=M}else a.drawImage(u.canvas,-w,-x);u.translate(-w,-x)}y||(u.globalAlpha=D)}s&&a.restore()},b.prototype.composeFrame=function(a,b,c){var d=this.getTransform(a,0);this.preCompose(c,a,d),this.compose(c,a,b),this.postCompose(c,a,b,d)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,f){if(this.replayGroup_){var g=b.viewState.resolution,h=b.viewState.rotation,i=this.getLayer(),j={},k=this.replayGroup_.forEachFeatureAtCoordinate(a,g,h,c,{},function(a){var b=e.getUid(a).toString();return b in j?void 0:(j[b]=!0,d.call(f,a,i))},null);return k}return void 0},b.prototype.handleFontsChanged_=function(){var a=this.getLayer();a.getVisible()&&this.replayGroup_&&a.changed()},b.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},b.prototype.prepareFrame=function(a){var b=this.getLayer(),c=b.getSource(),d=a.viewHints[g.default.ANIMATING],e=a.viewHints[g.default.INTERACTING],f=b.getUpdateWhileAnimating(),h=b.getUpdateWhileInteracting();if(!this.dirty_&&!f&&d||!h&&e)return!0;var i=a.extent,j=a.viewState,k=j.projection,m=j.resolution,n=a.pixelRatio,p=b.getRevision(),r=b.getRenderBuffer(),s=b.getRenderOrder();void 0===s&&(s=q.defaultOrder);var t=l.buffer(i,r*m),u=j.projection.getExtent();if(c.getWrapX()&&j.projection.canWrapX()&&!l.containsExtent(u,a.extent)){var v=l.getWidth(u),w=Math.max(l.getWidth(t)/2,v);t[0]=u[0]-w,t[2]=u[2]+w}if(!this.dirty_&&this.renderedResolution_==m&&this.renderedRevision_==p&&this.renderedRenderOrder_==s&&l.containsExtent(this.renderedExtent_,t))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var x=new o.default(q.getTolerance(m,n),t,m,n,c.getOverlaps(),this.declutterTree_,b.getRenderBuffer());c.loadFeatures(t,m,k);var y=function(a){var c,d=a.getStyleFunction()||b.getStyleFunction();if(d&&(c=d(a,m)),c){var e=this.renderFeature(a,m,n,c,x);this.dirty_=this.dirty_||e}}.bind(this);if(s){var z=[];c.forEachFeatureInExtent(t,function(a){z.push(a)},this),z.sort(s);for(var A=0,B=z.length;B>A;++A)y(z[A])}else c.forEachFeatureInExtent(t,y,this);return x.finish(),this.renderedResolution_=m,this.renderedRevision_=p,this.renderedRenderOrder_=s,this.renderedExtent_=t,this.replayGroup_=x,this.replayGroupChanged=!0,!0},b.prototype.renderFeature=function(a,b,c,d,e){var f=this;if(!d)return!1;var g=!1;if(Array.isArray(d))for(var h=0,i=d.length;i>h;++h)g=q.renderFeature(e,a,d[h],q.getSquaredTolerance(b,c),f.handleStyleImageChange_,f)||g;else g=q.renderFeature(e,a,d,q.getSquaredTolerance(b,c),this.handleStyleImageChange_,this);return g},b}(p.default);r.handles=function(a){return a.getType()===f.default.VECTOR},r.create=function(a,b){return new r(b)};var s=r;c.default=s},{"../../LayerType.js":19,"../../ViewHint.js":42,"../../dom.js":63,"../../events.js":65,"../../events/EventType.js":67,"../../extent.js":71,"../../render/EventType.js":168,"../../render/canvas.js":172,"../../render/canvas/ReplayGroup.js":179,"../../util.js":289,"../canvas/Layer.js":204,"../vector.js":209,rbush:302}],208:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../util.js"),g=e(a("../../LayerType.js")),h=e(a("../../TileState.js")),i=e(a("../../ViewHint.js")),j=a("../../dom.js"),k=a("../../events.js"),l=e(a("../../events/EventType.js")),m=e(a("rbush")),n=a("../../extent.js"),o=e(a("../../layer/VectorTileRenderType.js")),p=a("../../proj.js"),q=e(a("../../proj/Units.js")),r=e(a("../../render/ReplayType.js")),s=a("../../render/canvas.js"),t=d(a("../../render/canvas/ReplayGroup.js")),u=a("../../render/replay.js"),v=e(a("../canvas/TileLayer.js")),w=a("../vector.js"),x=a("../../transform.js"),y={image:[r.default.POLYGON,r.default.CIRCLE,r.default.LINE_STRING,r.default.IMAGE,r.default.TEXT],hybrid:[r.default.POLYGON,r.default.LINE_STRING]},z={image:[r.default.DEFAULT],hybrid:[r.default.IMAGE,r.default.TEXT,r.default.DEFAULT],vector:u.ORDER},A=function(a){function b(b){a.call(this,b,!0),this.declutterTree_=b.getDeclutter()?m.default(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=x.create(),this.zDirection=b.getRenderMode()==o.default.VECTOR?1:0,k.listen(s.labelCache,l.default.CLEAR,this.handleFontsChanged_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){k.unlisten(s.labelCache,l.default.CLEAR,this.handleFontsChanged_,this),a.prototype.disposeInternal.call(this)},b.prototype.getTile=function(b,c,d,e,f){var g=a.prototype.getTile.call(this,b,c,d,e,f);return g.getState()===h.default.LOADED&&(this.createReplayGroup_(g,e,f),this.context&&this.renderTileImage_(g,e,f)),g},b.prototype.prepareFrame=function(b,c){var d=this.getLayer(),e=d.getRevision();if(this.renderedLayerRevision_!=e){this.renderedTiles.length=0;var f=d.getRenderMode();this.context||f==o.default.VECTOR||(this.context=j.createCanvasContext2D()),this.context&&f==o.default.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=e,a.prototype.prepareFrame.call(this,b,c)},b.prototype.createReplayGroup_=function(a,b,c){var d=this,e=this.getLayer(),f=e.getRevision(),g=e.getRenderOrder()||null,i=a.getReplayState(e);if(i.dirty||i.renderedRevision!=f||i.renderedRenderOrder!=g){for(var j=e.getSource(),k=j.getTileGrid(),l=j.getTileGridForProjection(c),m=l.getResolution(a.tileCoord[0]),o=a.extent,r={},s=function(f){var l=a.getTile(a.tileKeys[f]);if(l.getState()==h.default.LOADED){var s=l.tileCoord,u=k.getTileCoordExtent(s),v=n.getIntersection(o,u),x=n.equals(u,v)?null:n.buffer(v,e.getRenderBuffer()*m,d.tmpExtent),y=l.getProjection(),z=!1;p.equivalent(c,y)||(z=!0,l.setProjection(c)),i.dirty=!1;var A=new t.default(0,v,m,b,j.getOverlaps(),d.declutterTree_,e.getRenderBuffer()),B=w.getSquaredTolerance(m,b),C=function(a){var b,c=a.getStyleFunction()||e.getStyleFunction();if(c&&(b=c(a,m)),b){var d=this.renderFeature(a,B,b,A);this.dirty_=this.dirty_||d,i.dirty=i.dirty||d}},D=l.getFeatures();g&&g!==i.renderedRenderOrder&&D.sort(g);for(var E=0,F=D.length;F>E;++E){var G=D[E];z&&(y.getUnits()==q.default.TILE_PIXELS&&(y.setWorldExtent(u),y.setExtent(l.getExtent())),G.getGeometry().transform(y,c)),(!x||n.intersects(x,G.getGeometry().getExtent()))&&C.call(d,G)}A.finish();for(var H in A.getReplays())r[H]=!0;l.setReplayGroup(e,a.tileCoord.toString(),A)}},u=0,v=a.tileKeys.length;v>u;++u)s(u,v);i.renderedRevision=f,i.renderedRenderOrder=g}},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var g=b.viewState.resolution,i=b.viewState.rotation;c=void 0==c?0:c;var j,k,l,m,o,p=this.getLayer(),q={},r=this.renderedTiles;for(l=0,m=r.length;m>l;++l){var s=r[l];if(j=n.buffer(s.extent,c*g,j),n.containsCoordinate(j,a))for(var t=0,u=s.tileKeys.length;u>t;++t){var v=s.getTile(s.tileKeys[t]);v.getState()==h.default.LOADED&&(o=v.getReplayGroup(p,s.tileCoord.toString()),k=k||o.forEachFeatureAtCoordinate(a,g,i,c,{},function(a){var b=f.getUid(a).toString();return b in q?void 0:(q[b]=!0,d.call(e,a,p))},null))}}return k},b.prototype.getReplayTransform_=function(a,b){var c=this.getLayer(),d=c.getSource(),e=d.getTileGrid(),f=a.tileCoord,g=e.getResolution(f[0]),h=b.viewState,i=b.pixelRatio,j=h.resolution/i,k=e.getTileCoordExtent(f,this.tmpExtent),l=h.center,m=n.getTopLeft(k),o=b.size,p=Math.round(i*o[0]/2),q=Math.round(i*o[1]/2);return x.compose(this.tmpTransform_,p,q,g/j,g/j,h.rotation,(m[0]-l[0])/g,(l[1]-m[1])/g)},b.prototype.handleFontsChanged_=function(){var a=this.getLayer();a.getVisible()&&void 0!==this.renderedLayerRevision_&&a.changed()},b.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},b.prototype.postCompose=function(b,c,d){var e=this,f=this.getLayer(),g=f.getRenderMode();if(g!=o.default.IMAGE){var j,k,l=f.getDeclutter()?{}:null,m=f.getSource(),n=z[g],p=c.pixelRatio,q=c.viewState.rotation,r=c.size;q&&(j=Math.round(p*r[0]/2),k=Math.round(p*r[1]/2),s.rotateAtOffset(b,-q,j,k)),l&&this.declutterTree_.clear();for(var u=c.viewHints,v=!(u[i.default.ANIMATING]||u[i.default.INTERACTING]),w=this.renderedTiles,x=m.getTileGridForProjection(c.viewState.projection),y=[],A=[],B=w.length-1;B>=0;--B){var C=w[B];if(C.getState()!=h.default.ABORT)for(var D=C.tileCoord,E=x.getTileCoordExtent(D,e.tmpExtent)[0]-C.extent[0],F=void 0,G=0,H=C.tileKeys.length;H>G;++G){var I=C.getTile(C.tileKeys[G]);if(I.getState()==h.default.LOADED){var J=I.getReplayGroup(f,D.toString());if(J&&J.hasReplays(n)){F||(F=e.getTransform(c,E));var K=I.tileCoord[0],L=J.getClipCoords(F);b.save(),b.globalAlpha=d.opacity;for(var M=0,N=y.length;N>M;++M){var O=y[M];K<A[M]&&(b.beginPath(),b.moveTo(L[0],L[1]),b.lineTo(L[2],L[3]),b.lineTo(L[4],L[5]),b.lineTo(L[6],L[7]),b.moveTo(O[6],O[7]),b.lineTo(O[4],O[5]),b.lineTo(O[2],O[3]),b.lineTo(O[0],O[1]),b.clip())}J.replay(b,F,q,{},v,n,l),b.restore(),y.push(L),A.push(K)}}}}l&&t.replayDeclutter(l,b,q,v),q&&s.rotateAtOffset(b,q,j,k)}a.prototype.postCompose.call(this,b,c,d)},b.prototype.renderFeature=function(a,b,c,d){var e=this;if(!c)return!1;var f=!1;if(Array.isArray(c))for(var g=0,h=c.length;h>g;++g)f=w.renderFeature(d,a,c[g],b,e.handleStyleImageChange_,e)||f;else f=w.renderFeature(d,a,c,b,this.handleStyleImageChange_,this);return f},b.prototype.renderTileImage_=function(a,b,c){var d=this,e=this.getLayer(),f=a.getReplayState(e),g=e.getRevision(),i=y[e.getRenderMode()];
if(i&&f.renderedTileRevision!==g){f.renderedTileRevision=g;var j=a.wrappedTileCoord,k=j[0],l=e.getSource(),m=l.getTileGridForProjection(c),n=m.getResolution(k),o=a.getContext(e),p=l.getTilePixelSize(k,b,c);o.canvas.width=p[0],o.canvas.height=p[1];for(var q=m.getTileCoordExtent(j,this.tmpExtent),r=0,s=a.tileKeys.length;s>r;++r){var t=a.getTile(a.tileKeys[r]);if(t.getState()==h.default.LOADED){var u=b/n,v=x.reset(d.tmpTransform_);x.scale(v,u,-u),x.translate(v,-q[0],-q[3]);var w=t.getReplayGroup(e,a.tileCoord.toString());w.replay(o,v,0,{},!0,i)}}}},b}(v.default);A.handles=function(a){return a.getType()===g.default.VECTOR_TILE},A.create=function(a,b){return new A(b)};var B=A;c.default=B},{"../../LayerType.js":19,"../../TileState.js":38,"../../ViewHint.js":42,"../../dom.js":63,"../../events.js":65,"../../events/EventType.js":67,"../../extent.js":71,"../../layer/VectorTileRenderType.js":145,"../../proj.js":158,"../../proj/Units.js":160,"../../render/ReplayType.js":170,"../../render/canvas.js":172,"../../render/canvas/ReplayGroup.js":179,"../../render/replay.js":181,"../../transform.js":287,"../../util.js":289,"../canvas/TileLayer.js":206,"../vector.js":209,rbush:302}],209:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){return s.getUid(a)-s.getUid(b)}function f(a,b){var c=g(a,b);return c*c}function g(a,b){return w*a/b}function h(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),v.default.CIRCLE);g.setFillStrokeStyle(e,f),g.drawCircle(b,d)}var h=c.getText();if(h){var i=a.getReplay(c.getZIndex(),v.default.TEXT);i.setTextStyle(h,a.addDeclutter(!1)),i.drawText(b,d)}}function i(a,b,c,d,e,f){var g=!1,h=c.getImage();if(h){var i=h.getImageState();i==t.default.LOADED||i==t.default.ERROR?h.unlistenImageChange(e,f):(i==t.default.IDLE&&h.load(),i=h.getImageState(),h.listenImageChange(e,f),g=!0)}return j(a,b,c,d),g}function j(a,b,c,d){var e=c.getGeometryFunction()(b);if(e){var f=e.getSimplifiedGeometry(d),g=c.getRenderer();if(g)k(a,f,c,b);else{var h=x[f.getType()];h(a,f,c,b)}}}function k(a,b,c,d){if(b.getType()!=u.default.GEOMETRY_COLLECTION){var e=a.getReplay(c.getZIndex(),v.default.DEFAULT);e.drawCustom(b,d,c.getRenderer())}else for(var f=b.getGeometries(),g=0,h=f.length;h>g;++g)k(a,f[g],c,d)}function l(a,b,c,d){var e,f,g=b.getGeometriesArray();for(e=0,f=g.length;f>e;++e){var h=x[g[e].getType()];h(a,g[e],c,d)}}function m(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),v.default.LINE_STRING);f.setFillStrokeStyle(null,e),f.drawLineString(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!1)),h.drawText(b,d)}}function n(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),v.default.LINE_STRING);f.setFillStrokeStyle(null,e),f.drawMultiLineString(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!1)),h.drawText(b,d)}}function o(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(f||e){var g=a.getReplay(c.getZIndex(),v.default.POLYGON);g.setFillStrokeStyle(e,f),g.drawMultiPolygon(b,d)}var h=c.getText();if(h){var i=a.getReplay(c.getZIndex(),v.default.TEXT);i.setTextStyle(h,a.addDeclutter(!1)),i.drawText(b,d)}}function p(a,b,c,d){var e=c.getImage();if(e){if(e.getImageState()!=t.default.LOADED)return;var f=a.getReplay(c.getZIndex(),v.default.IMAGE);f.setImageStyle(e,a.addDeclutter(!1)),f.drawPoint(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!!e)),h.drawText(b,d)}}function q(a,b,c,d){var e=c.getImage();if(e){if(e.getImageState()!=t.default.LOADED)return;var f=a.getReplay(c.getZIndex(),v.default.IMAGE);f.setImageStyle(e,a.addDeclutter(!1)),f.drawMultiPoint(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!!e)),h.drawText(b,d)}}function r(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),v.default.POLYGON);g.setFillStrokeStyle(e,f),g.drawPolygon(b,d)}var h=c.getText();if(h){var i=a.getReplay(c.getZIndex(),v.default.TEXT);i.setTextStyle(h,a.addDeclutter(!1)),i.drawText(b,d)}}Object.defineProperty(c,"__esModule",{value:!0}),c.defaultOrder=e,c.getSquaredTolerance=f,c.getTolerance=g,c.renderFeature=i;var s=a("../util.js"),t=d(a("../ImageState.js")),u=d(a("../geom/GeometryType.js")),v=d(a("../render/ReplayType.js")),w=.5,x={Point:p,LineString:m,Polygon:r,MultiPoint:q,MultiLineString:n,MultiPolygon:o,GeometryCollection:l,Circle:h}},{"../ImageState.js":16,"../geom/GeometryType.js":81,"../render/ReplayType.js":170,"../util.js":289}],210:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../reproj/common.js"),f=a("../../functions.js"),g=d(a("../../LayerType.js")),h=d(a("../../ViewHint.js")),i=a("../../dom.js"),j=a("../../extent.js"),k=d(a("../webgl/Layer.js")),l=a("../../transform.js"),m=a("../../webgl.js"),n=a("../../webgl/Context.js"),o=function(a){function b(b,c){a.call(this,b,c),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createTexture_=function(a){var b=a.getImage(),c=this.mapRenderer.getGL();return n.createTexture(c,b,m.CLAMP_TO_EDGE,m.CLAMP_TO_EDGE)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer(),g=f.getSource(),h=b.viewState.resolution,i=b.viewState.rotation,j=b.skippedFeatureUids;return g.forEachFeatureAtCoordinate(a,h,i,c,j,function(a){return d.call(e,a,f)})},b.prototype.prepareFrame=function(a,b){var c=this.mapRenderer.getGL(),d=a.pixelRatio,f=a.viewState,g=f.center,i=f.resolution,k=f.rotation,m=this.image_,n=this.texture,o=this.getLayer(),p=o.getSource(),q=a.viewHints,r=a.extent;if(void 0!==b.extent&&(r=j.getIntersection(r,b.extent)),!q[h.default.ANIMATING]&&!q[h.default.INTERACTING]&&!j.isEmpty(r)){var s=f.projection;if(!e.ENABLE_RASTER_REPROJECTION){var t=p.getProjection();t&&(s=t)}var u=p.getImage(r,i,d,s);if(u){var v=this.loadImage(u);if(v&&(m=u,n=this.createTexture_(u),this.texture)){var w=function(a,b){a.isContextLost()||a.deleteTexture(b)}.bind(null,c,this.texture);a.postRenderFunctions.push(w)}}}if(m){var x=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(x.width,x.height,d,g,i,k,m.getExtent()),this.hitTransformationMatrix_=null;var y=this.texCoordMatrix;l.reset(y),l.scale(y,1,-1),l.translate(y,0,-1),this.image_=m,this.texture=n}return!!m},b.prototype.updateProjectionMatrix_=function(a,b,c,d,e,f,g){var h=a*e,i=b*e,j=this.projectionMatrix;l.reset(j),l.scale(j,2*c/h,2*c/i),l.rotate(j,-f),l.translate(j,g[0]-d[0],g[1]-d[1]),l.scale(j,(g[2]-g[0])/2,(g[3]-g[1])/2),l.translate(j,1,1)},b.prototype.hasFeatureAtCoordinate=function(a,b){var c=this.forEachFeatureAtCoordinate(a,b,0,f.TRUE,this);return void 0!==c},b.prototype.forEachLayerAtPixel=function(a,b,c,d){if(!this.image_||!this.image_.getImage())return void 0;if(this.getLayer().getSource().forEachFeatureAtCoordinate!==f.VOID){var e=l.apply(b.pixelToCoordinateTransform,a.slice()),g=this.forEachFeatureAtCoordinate(e,b,0,f.TRUE,this);return g?c.call(d,this.getLayer(),null):void 0}var h=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(b.size,h));var j=l.apply(this.hitTransformationMatrix_,a.slice());if(j[0]<0||j[0]>h[0]||j[1]<0||j[1]>h[1])return void 0;this.hitCanvasContext_||(this.hitCanvasContext_=i.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),j[0],j[1],1,1,0,0,1,1);var k=this.hitCanvasContext_.getImageData(0,0,1,1).data;return k[3]>0?c.call(d,this.getLayer(),k):void 0},b.prototype.getHitTransformationMatrix_=function(a,b){var c=l.create();l.translate(c,-1,-1),l.scale(c,2/a[0],2/a[1]),l.translate(c,0,a[1]),l.scale(c,1,-1);var d=l.invert(this.projectionMatrix.slice()),e=l.create();return l.translate(e,0,b[1]),l.scale(e,1,-1),l.scale(e,b[0]/2,b[1]/2),l.translate(e,1,1),l.multiply(e,d),l.multiply(e,c),e},b}(k.default);o.handles=function(a){return a.getType()===g.default.IMAGE},o.create=function(a,b){return new o(a,b)};var p=o;c.default=p},{"../../LayerType.js":19,"../../ViewHint.js":42,"../../dom.js":63,"../../extent.js":71,"../../functions.js":76,"../../reproj/common.js":223,"../../transform.js":287,"../../webgl.js":291,"../../webgl/Context.js":293,"../webgl/Layer.js":211}],211:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../../render/Event.js")),f=d(a("../../render/EventType.js")),g=d(a("../../render/webgl/Immediate.js")),h=d(a("../Layer.js")),i=a("../webgl/defaultmapshader.js"),j=d(a("../webgl/defaultmapshader/Locations.js")),k=a("../../transform.js"),l=a("../../vec/mat4.js"),m=a("../../webgl.js"),n=d(a("../../webgl/Buffer.js")),o=a("../../webgl/Context.js"),p=function(a){function b(b,c){a.call(this,c),this.mapRenderer=b,this.arrayBuffer_=new n.default([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=k.create(),this.projectionMatrix=k.create(),this.tmpMat4_=l.create(),this.defaultLocations_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.bindFramebuffer=function(a,b){var c=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=b){var d=function(a,b,c){a.isContextLost()||(a.deleteFramebuffer(b),a.deleteTexture(c))}.bind(null,c,this.framebuffer,this.texture);a.postRenderFunctions.push(d);var e=o.createEmptyTexture(c,b,b),f=c.createFramebuffer();c.bindFramebuffer(m.FRAMEBUFFER,f),c.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,e,0),this.texture=e,this.framebuffer=f,this.framebufferDimension=b}else c.bindFramebuffer(m.FRAMEBUFFER,this.framebuffer)},b.prototype.composeFrame=function(a,b,c){this.dispatchComposeEvent_(f.default.PRECOMPOSE,c,a),c.bindBuffer(m.ARRAY_BUFFER,this.arrayBuffer_);var d,e=c.getGL(),g=c.getProgram(i.fragment,i.vertex);this.defaultLocations_?d=this.defaultLocations_:(d=new j.default(e,g),this.defaultLocations_=d),c.useProgram(g)&&(e.enableVertexAttribArray(d.a_position),e.vertexAttribPointer(d.a_position,2,m.FLOAT,!1,16,0),e.enableVertexAttribArray(d.a_texCoord),e.vertexAttribPointer(d.a_texCoord,2,m.FLOAT,!1,16,8),e.uniform1i(d.u_texture,0)),e.uniformMatrix4fv(d.u_texCoordMatrix,!1,l.fromTransform(this.tmpMat4_,this.getTexCoordMatrix())),e.uniformMatrix4fv(d.u_projectionMatrix,!1,l.fromTransform(this.tmpMat4_,this.getProjectionMatrix())),e.uniform1f(d.u_opacity,b.opacity),e.bindTexture(m.TEXTURE_2D,this.getTexture()),e.drawArrays(m.TRIANGLE_STRIP,0,4),this.dispatchComposeEvent_(f.default.POSTCOMPOSE,c,a)},b.prototype.dispatchComposeEvent_=function(a,b,c){var d=this.getLayer();if(d.hasListener(a)){var f=c.viewState,h=f.resolution,i=c.pixelRatio,j=c.extent,k=f.center,l=f.rotation,m=c.size,n=new g.default(b,k,h,l,m,j,i),o=new e.default(a,n,c,null,b);d.dispatchEvent(o)}},b.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},b.prototype.getTexture=function(){return this.texture},b.prototype.getProjectionMatrix=function(){return this.projectionMatrix},b.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},b.prototype.prepareFrame=function(){},b.prototype.forEachLayerAtPixel=function(){},b}(h.default),q=p;c.default=q},{"../../render/Event.js":167,"../../render/EventType.js":168,"../../render/webgl/Immediate.js":185,"../../transform.js":287,"../../vec/mat4.js":290,"../../webgl.js":291,"../../webgl/Buffer.js":292,"../../webgl/Context.js":293,"../Layer.js":200,"../webgl/defaultmapshader.js":215,"../webgl/defaultmapshader/Locations.js":216}],212:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../array.js"),g=a("../../css.js"),h=a("../../dom.js"),i=a("../../events.js"),j=a("../../layer/Layer.js"),k=e(a("../../render/Event.js")),l=e(a("../../render/EventType.js")),m=e(a("../../render/webgl/Immediate.js")),n=d(a("../Map.js")),o=e(a("../../source/State.js")),p=e(a("../../structs/LRUCache.js")),q=e(a("../../structs/PriorityQueue.js")),r=a("../../webgl.js"),s=e(a("../../webgl/Context.js")),t=e(a("../../webgl/ContextEventType.js")),u=1024,v=function(a){function b(b){a.call(this,b);var c=b.getViewport();this.canvas_=document.createElement("canvas"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=g.CLASS_UNSELECTABLE,c.insertBefore(this.canvas_,c.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=h.createCanvasContext2D(),this.renderedVisible_=!0,this.gl_=r.getContext(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new s.default(this.canvas_,this.gl_),i.listen(this.canvas_,t.default.LOST,this.handleWebGLContextLost,this),i.listen(this.canvas_,t.default.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new p.default,this.focus_=null,this.tileTextureQueue_=new q.default(function(a){var b=a[1],c=a[2],d=b[0]-this.focus_[0],e=b[1]-this.focus_[1];return 65536*Math.log(c)+Math.sqrt(d*d+e*e)/c}.bind(this),function(a){return a[0].getKey()}),this.loadNextTileTexture_=function(){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var a=this.tileTextureQueue_.dequeue(),b=a[0],c=a[3],d=a[4];this.bindTileTexture(b,c,d,r.LINEAR,r.LINEAR)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.bindTileTexture=function(a,b,c,d,e){var f=this.getGL(),g=a.getKey();if(this.textureCache_.containsKey(g)){var h=this.textureCache_.get(g);f.bindTexture(r.TEXTURE_2D,h.texture),h.magFilter!=d&&(f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,d),h.magFilter=d),h.minFilter!=e&&(f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e),h.minFilter=e)}else{var i=f.createTexture();if(f.bindTexture(r.TEXTURE_2D,i),c>0){var j=this.clipTileContext_.canvas,k=this.clipTileContext_;this.clipTileCanvasWidth_!==b[0]||this.clipTileCanvasHeight_!==b[1]?(j.width=b[0],j.height=b[1],this.clipTileCanvasWidth_=b[0],this.clipTileCanvasHeight_=b[1]):k.clearRect(0,0,b[0],b[1]),k.drawImage(a.getImage(),c,c,b[0],b[1],0,0,b[0],b[1]),f.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,j)}else f.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,a.getImage());f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,d),f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e),f.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),f.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),this.textureCache_.set(g,{texture:i,magFilter:d,minFilter:e})}},b.prototype.dispatchRenderEvent=function(a,b){var c=this.getMap();if(c.hasListener(a)){var d=this.context_,e=b.extent,f=b.size,g=b.viewState,h=b.pixelRatio,i=g.resolution,j=g.center,l=g.rotation,n=new m.default(d,j,i,l,f,e,h),o=new k.default(a,n,b,null,d);c.dispatchEvent(o)}},b.prototype.disposeInternal=function(){var b=this.getGL();b.isContextLost()||this.textureCache_.forEach(function(a){a&&b.deleteTexture(a.texture)}),this.context_.dispose(),a.prototype.disposeInternal.call(this)},b.prototype.expireCache_=function(a,b){for(var c,d=this,e=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>u;){if(c=d.textureCache_.peekLast())e.deleteTexture(c.texture);else{if(+d.textureCache_.peekLastKey()==b.index)break;--d.textureCacheFrameMarkerCount_}d.textureCache_.pop()}},b.prototype.getContext=function(){return this.context_},b.prototype.getGL=function(){return this.gl_},b.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},b.prototype.handleWebGLContextLost=function(a){a.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var b=this.getLayerRenderers();for(var c in b){var d=b[c];d.handleWebGLContextLost()}},b.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},b.prototype.initializeGL_=function(){var a=this.gl_;a.activeTexture(r.TEXTURE0),a.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),a.disable(r.CULL_FACE),a.disable(r.DEPTH_TEST),a.disable(r.SCISSOR_TEST),a.disable(r.STENCIL_TEST)},b.prototype.isTileTextureLoaded=function(a){return this.textureCache_.containsKey(a.getKey())},b.prototype.renderFrame=function(a){var b=this,c=this.getContext(),d=this.getGL();if(d.isContextLost())return!1;if(!a)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=a.focus,this.textureCache_.set((-a.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchRenderEvent(l.default.PRECOMPOSE,a);var e=[],g=a.layerStatesArray;f.stableSort(g,n.sortByZIndex);var h,i,k,m,p=a.viewState.resolution;for(h=0,i=g.length;i>h;++h)m=g[h],j.visibleAtResolution(m,p)&&m.sourceState==o.default.READY&&(k=b.getLayerRenderer(m.layer),k.prepareFrame(a,m,c)&&e.push(m));var q=a.size[0]*a.pixelRatio,s=a.size[1]*a.pixelRatio;for((this.canvas_.width!=q||this.canvas_.height!=s)&&(this.canvas_.width=q,this.canvas_.height=s),d.bindFramebuffer(r.FRAMEBUFFER,null),d.clearColor(0,0,0,0),d.clear(r.COLOR_BUFFER_BIT),d.enable(r.BLEND),d.viewport(0,0,this.canvas_.width,this.canvas_.height),h=0,i=e.length;i>h;++h)m=e[h],k=b.getLayerRenderer(m.layer),k.composeFrame(a,m,c);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(a),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>u&&a.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(a.postRenderFunctions.push(this.loadNextTileTexture_),a.animate=!0),this.dispatchRenderEvent(l.default.POSTCOMPOSE,a),this.scheduleRemoveUnusedLayerRenderers(a),this.scheduleExpireIconCache(a)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g){var h,i=this;if(this.getGL().isContextLost())return!1;var k,l=b.viewState,m=b.layerStatesArray,n=m.length;for(k=n-1;k>=0;--k){var o=m[k],p=o.layer;if(j.visibleAtResolution(o,l.resolution)&&f.call(g,p)){var q=i.getLayerRenderer(p);if(h=q.forEachFeatureAtCoordinate(a,b,c,d,e))return h}}return void 0},b.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){var f=this,g=!1;if(this.getGL().isContextLost())return!1;var h,i=b.viewState,k=b.layerStatesArray,l=k.length;for(h=l-1;h>=0;--h){var m=k[h],n=m.layer;if(j.visibleAtResolution(m,i.resolution)&&d.call(e,n)){var o=f.getLayerRenderer(n);if(g=o.hasFeatureAtCoordinate(a,b))return!0}}return g},b.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f){var g=this;if(this.getGL().isContextLost())return!1;var h,i,k=b.viewState,l=b.layerStatesArray,m=l.length;for(i=m-1;i>=0;--i){var n=l[i],o=n.layer;if(j.visibleAtResolution(n,k.resolution)&&f.call(e,o)){var p=g.getLayerRenderer(o);if(h=p.forEachLayerAtPixel(a,b,d,e))return h}}return void 0},b}(n.default),w=v;c.default=w},{"../../array.js":45,"../../css.js":62,"../../dom.js":63,"../../events.js":65,"../../layer/Layer.js":138,"../../render/Event.js":167,"../../render/EventType.js":168,"../../render/webgl/Immediate.js":185,"../../source/State.js":241,"../../structs/LRUCache.js":261,"../../structs/PriorityQueue.js":263,"../../webgl.js":291,"../../webgl/Context.js":293,"../../webgl/ContextEventType.js":294,"../Map.js":201}],213:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../../LayerType.js")),f=d(a("../../TileRange.js")),g=d(a("../../TileState.js")),h=a("../../array.js"),i=a("../../extent.js"),j=a("../../math.js"),k=d(a("../webgl/Layer.js")),l=a("../webgl/tilelayershader.js"),m=d(a("../webgl/tilelayershader/Locations.js")),n=a("../../size.js"),o=a("../../transform.js"),p=a("../../webgl.js"),q=d(a("../../webgl/Buffer.js")),r=function(a){function b(b,c){a.call(this,b,c),this.fragmentShader_=l.fragment,this.vertexShader_=l.vertex,this.locations_=null,this.renderArrayBuffer_=new q.default([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){var b=this.mapRenderer.getContext();b.deleteBuffer(this.renderArrayBuffer_),a.prototype.disposeInternal.call(this)},b.prototype.createLoadedTileFinder=function(a,b,c){var d=this.mapRenderer;return function(e,f){function g(a){var b=d.isTileTextureLoaded(a);return b&&(c[e]||(c[e]={}),c[e][a.tileCoord.toString()]=a),b}return a.forEachLoadedTile(b,e,f,g)}},b.prototype.handleWebGLContextLost=function(){a.prototype.handleWebGLContextLost.call(this),this.locations_=null},b.prototype.prepareFrame=function(a,b,c){var d,e=this,k=this.mapRenderer,l=c.getGL(),q=a.viewState,r=q.projection,s=this.getLayer(),t=s.getSource(),u=t.getTileGridForProjection(r),v=u.getZForResolution(q.resolution),w=u.getResolution(v),x=t.getTilePixelSize(v,a.pixelRatio,r),y=x[0]/n.toSize(u.getTileSize(v),this.tmpSize_)[0],z=w/y,A=t.getTilePixelRatio(y)*t.getGutterForProjection(r),B=q.center,C=a.extent,D=u.getTileRangeForExtentAndZ(C,v);if(this.renderedTileRange_&&this.renderedTileRange_.equals(D)&&this.renderedRevision_==t.getRevision())d=this.renderedFramebufferExtent_;else{var E=D.getSize(),F=Math.max(E[0]*x[0],E[1]*x[1]),G=j.roundUpToPowerOfTwo(F),H=z*G,I=u.getOrigin(v),J=I[0]+D.minX*x[0]*z,K=I[1]+D.minY*x[1]*z;d=[J,K,J+H,K+H],this.bindFramebuffer(a,G),l.viewport(0,0,G,G),l.clearColor(0,0,0,0),l.clear(p.COLOR_BUFFER_BIT),l.disable(p.BLEND);var L=c.getProgram(this.fragmentShader_,this.vertexShader_);c.useProgram(L),this.locations_||(this.locations_=new m.default(l,L)),c.bindBuffer(p.ARRAY_BUFFER,this.renderArrayBuffer_),l.enableVertexAttribArray(this.locations_.a_position),l.vertexAttribPointer(this.locations_.a_position,2,p.FLOAT,!1,16,0),l.enableVertexAttribArray(this.locations_.a_texCoord),l.vertexAttribPointer(this.locations_.a_texCoord,2,p.FLOAT,!1,16,8),l.uniform1i(this.locations_.u_texture,0);var M={};M[v]={};var N,O,P,Q,R,S,T,U,V=this.createLoadedTileFinder(t,r,M),W=s.getUseInterimTilesOnError(),X=!0,Y=i.createEmpty(),Z=new f.default(0,0,0,0);for(S=D.minX;S<=D.maxX;++S)for(T=D.minY;T<=D.maxY;++T)if(Q=t.getTile(v,S,T,y,r),void 0===b.extent||(U=u.getTileCoordExtent(Q.tileCoord,Y),i.intersects(U,b.extent))){if(R=Q.getState(),O=R==g.default.LOADED||R==g.default.EMPTY||R==g.default.ERROR&&!W,O||(Q=Q.getInterimTile()),R=Q.getState(),R==g.default.LOADED){if(k.isTileTextureLoaded(Q)){M[v][Q.tileCoord.toString()]=Q;continue}}else if(R==g.default.EMPTY||R==g.default.ERROR&&!W)continue;X=!1,P=u.forEachTileCoordParentTileRange(Q.tileCoord,V,null,Z,Y),P||(N=u.getTileCoordChildTileRange(Q.tileCoord,Z,Y),N&&V(v+1,N))}var $=Object.keys(M).map(Number);$.sort(h.numberSafeCompareFunction);for(var _=new Float32Array(4),ab=0,bb=$.length;bb>ab;++ab){var cb=M[$[ab]];for(var db in cb)Q=cb[db],U=u.getTileCoordExtent(Q.tileCoord,Y),_[0]=2*(U[2]-U[0])/H,_[1]=2*(U[3]-U[1])/H,_[2]=2*(U[0]-d[0])/H-1,_[3]=2*(U[1]-d[1])/H-1,l.uniform4fv(e.locations_.u_tileOffset,_),k.bindTileTexture(Q,x,A*y,p.LINEAR,p.LINEAR),l.drawArrays(p.TRIANGLE_STRIP,0,4)}X?(this.renderedTileRange_=D,this.renderedFramebufferExtent_=d,this.renderedRevision_=t.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,a.animate=!0)}this.updateUsedTiles(a.usedTiles,t,v,D);var eb=k.getTileTextureQueue();this.manageTilePyramid(a,t,u,y,r,C,v,s.getPreload(),function(a){a.getState()!=g.default.LOADED||k.isTileTextureLoaded(a)||eb.isKeyQueued(a.getKey())||eb.enqueue([a,u.getTileCoordCenter(a.tileCoord),u.getResolution(a.tileCoord[0]),x,A*y])},this),this.scheduleExpireCache(a,t);var fb=this.texCoordMatrix;return o.reset(fb),o.translate(fb,(Math.round(B[0]/w)*w-d[0])/(d[2]-d[0]),(Math.round(B[1]/w)*w-d[1])/(d[3]-d[1])),0!==q.rotation&&o.rotate(fb,q.rotation),o.scale(fb,a.size[0]*q.resolution/(d[2]-d[0]),a.size[1]*q.resolution/(d[3]-d[1])),o.translate(fb,-.5,-.5),!0},b.prototype.forEachLayerAtPixel=function(a,b,c,d){if(!this.framebuffer)return void 0;var e=[a[0]/b.size[0],(b.size[1]-a[1])/b.size[1]],f=o.apply(this.texCoordMatrix,e.slice()),g=[f[0]*this.framebufferDimension,f[1]*this.framebufferDimension],h=this.mapRenderer.getContext().getGL();h.bindFramebuffer(h.FRAMEBUFFER,this.framebuffer);var i=new Uint8Array(4);return h.readPixels(g[0],g[1],1,1,h.RGBA,h.UNSIGNED_BYTE,i),i[3]>0?c.call(d,this.getLayer(),i):void 0},b}(k.default);r.handles=function(a){return a.getType()===e.default.TILE},r.create=function(a,b){return new r(a,b)};var s=r;c.default=s},{"../../LayerType.js":19,"../../TileRange.js":37,"../../TileState.js":38,"../../array.js":45,"../../extent.js":71,"../../math.js":147,"../../size.js":226,"../../transform.js":287,"../../webgl.js":291,"../../webgl/Buffer.js":292,"../webgl/Layer.js":211,"../webgl/tilelayershader.js":217,"../webgl/tilelayershader/Locations.js":218}],214:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../../LayerType.js")),g=d(a("../../ViewHint.js")),h=a("../../extent.js"),i=d(a("../../render/webgl/ReplayGroup.js")),j=a("../vector.js"),k=d(a("../webgl/Layer.js")),l=a("../../transform.js"),m=function(a){function b(b,c){a.call(this,b,c),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=0/0,this.renderedExtent_=h.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.composeFrame=function(a,b,c){this.layerState_=b;var d=a.viewState,e=this.replayGroup_,f=a.size,g=a.pixelRatio,h=this.mapRenderer.getGL();e&&!e.isEmpty()&&(h.enable(h.SCISSOR_TEST),h.scissor(0,0,f[0]*g,f[1]*g),e.replay(c,d.center,d.resolution,d.rotation,f,g,b.opacity,b.managed?a.skippedFeatureUids:{}),h.disable(h.SCISSOR_TEST))},b.prototype.disposeInternal=function(){var b=this.replayGroup_;if(b){var c=this.mapRenderer.getContext();b.getDeleteResourcesFunction(c)(),this.replayGroup_=null}a.prototype.disposeInternal.call(this)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,f){if(this.replayGroup_&&this.layerState_){var g=this.mapRenderer.getContext(),h=b.viewState,i=this.getLayer(),j=this.layerState_,k={};return this.replayGroup_.forEachFeatureAtCoordinate(a,g,h.center,h.resolution,h.rotation,b.size,b.pixelRatio,j.opacity,{},function(a){var b=e.getUid(a).toString();return b in k?void 0:(k[b]=!0,d.call(f,a,i))})}return void 0},b.prototype.hasFeatureAtCoordinate=function(a,b){if(this.replayGroup_&&this.layerState_){var c=this.mapRenderer.getContext(),d=b.viewState,e=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(a,c,d.center,d.resolution,d.rotation,b.size,b.pixelRatio,e.opacity,b.skippedFeatureUids)}return!1},b.prototype.forEachLayerAtPixel=function(a,b,c,d){var e=l.apply(b.pixelToCoordinateTransform,a.slice()),f=this.hasFeatureAtCoordinate(e,b);return f?c.call(d,this.getLayer(),null):void 0},b.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},b.prototype.prepareFrame=function(a,b,c){var d=this.getLayer(),e=d.getSource(),f=a.viewHints[g.default.ANIMATING],k=a.viewHints[g.default.INTERACTING],l=d.getUpdateWhileAnimating(),m=d.getUpdateWhileInteracting();if(!this.dirty_&&!l&&f||!m&&k)return!0;var n=a.extent,o=a.viewState,p=o.projection,q=o.resolution,r=a.pixelRatio,s=d.getRevision(),t=d.getRenderBuffer(),u=d.getRenderOrder();void 0===u&&(u=j.defaultOrder);var v=h.buffer(n,t*q);if(!this.dirty_&&this.renderedResolution_==q&&this.renderedRevision_==s&&this.renderedRenderOrder_==u&&h.containsExtent(this.renderedExtent_,v))return!0;this.replayGroup_&&a.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(c)),this.dirty_=!1;var w=new i.default(j.getTolerance(q,r),v,d.getRenderBuffer());e.loadFeatures(v,q,p);var x=function(a){var b,c=a.getStyleFunction()||d.getStyleFunction();if(c&&(b=c(a,q)),b){var e=this.renderFeature(a,q,r,b,w);this.dirty_=this.dirty_||e}};if(u){var y=[];e.forEachFeatureInExtent(v,function(a){y.push(a)},this),y.sort(u),y.forEach(x.bind(this))}else e.forEachFeatureInExtent(v,x,this);return w.finish(c),this.renderedResolution_=q,this.renderedRevision_=s,this.renderedRenderOrder_=u,this.renderedExtent_=v,this.replayGroup_=w,!0},b.prototype.renderFeature=function(a,b,c,d,e){var f=this;if(!d)return!1;var g=!1;if(Array.isArray(d))for(var h=d.length-1,i=0;h>=i;--h)g=j.renderFeature(e,a,d[h],j.getSquaredTolerance(b,c),f.handleStyleImageChange_,f)||g;else g=j.renderFeature(e,a,d,j.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||g;return g},b}(k.default);m.handles=function(a){return a.getType()===f.default.VECTOR},m.create=function(a,b){return new m(a,b)};var n=m;c.default=n},{"../../LayerType.js":19,"../../ViewHint.js":42,"../../extent.js":71,"../../render/webgl/ReplayGroup.js":189,"../../transform.js":287,"../../util.js":289,"../vector.js":209,"../webgl/Layer.js":211}],215:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../webgl.js"),f=d(a("../../webgl/Fragment.js")),g=d(a("../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}");c.vertex=i},{"../../webgl.js":291,"../../webgl/Fragment.js":295,"../../webgl/Vertex.js":297}],216:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../webgl.js"),e=function(a,b){this.u_texCoordMatrix=a.getUniformLocation(b,d.DEBUG?"u_texCoordMatrix":"d"),this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"e"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"f"),this.u_texture=a.getUniformLocation(b,d.DEBUG?"u_texture":"g"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"b"),this.a_texCoord=a.getAttribLocation(b,d.DEBUG?"a_texCoord":"c")},f=e;c.default=f},{"../../../webgl.js":291}],217:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;
var e=a("../../webgl.js"),f=d(a("../../webgl/Fragment.js")),g=d(a("../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}");c.vertex=i},{"../../webgl.js":291,"../../webgl/Fragment.js":295,"../../webgl/Vertex.js":297}],218:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../webgl.js"),e=function(a,b){this.u_tileOffset=a.getUniformLocation(b,d.DEBUG?"u_tileOffset":"d"),this.u_texture=a.getUniformLocation(b,d.DEBUG?"u_texture":"e"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"b"),this.a_texCoord=a.getAttribLocation(b,d.DEBUG?"a_texCoord":"c")},f=e;c.default=f},{"../../../webgl.js":291}],219:[function(a,b,c){"use strict";function d(a,b,c,d){var e=j.transform(c,b,a),f=j.getPointResolution(b,d,c),g=b.getMetersPerUnit();void 0!==g&&(f*=g);var i=a.getMetersPerUnit();void 0!==i&&(f/=i);var k=a.getExtent();if(!k||h.containsCoordinate(k,e)){var l=j.getPointResolution(a,f,e)/f;isFinite(l)&&l>0&&(f/=l)}return f}function e(a,b,c,d){var e=c-a,f=d-b,g=Math.sqrt(e*e+f*f);return[Math.round(c+e/g),Math.round(d+f/g)]}function f(a,b,c,d,f,j,k,l,m,n,o){var p=g.createCanvasContext2D(Math.round(c*a),Math.round(c*b));if(0===m.length)return p.canvas;p.scale(c,c);var q=h.createEmpty();m.forEach(function(a){h.extend(q,a.extent)});var r=h.getWidth(q),s=h.getHeight(q),t=g.createCanvasContext2D(Math.round(c*r/d),Math.round(c*s/d)),u=c/d;m.forEach(function(a){var b=a.extent[0]-q[0],c=-(a.extent[3]-q[3]),d=h.getWidth(a.extent),e=h.getHeight(a.extent);t.drawImage(a.image,n,n,a.image.width-2*n,a.image.height-2*n,b*u,c*u,d*u,e*u)});var v=h.getTopLeft(k);return l.getTriangles().forEach(function(a){var b=a.source,f=a.target,g=b[0][0],h=b[0][1],k=b[1][0],l=b[1][1],m=b[2][0],n=b[2][1],o=(f[0][0]-v[0])/j,r=-(f[0][1]-v[1])/j,s=(f[1][0]-v[0])/j,u=-(f[1][1]-v[1])/j,w=(f[2][0]-v[0])/j,x=-(f[2][1]-v[1])/j,y=g,z=h;g=0,h=0,k-=y,l-=z,m-=y,n-=z;var A=[[k,l,0,0,s-o],[m,n,0,0,w-o],[0,0,k,l,u-r],[0,0,m,n,x-r]],B=i.solveLinearSystem(A);if(B){p.save(),p.beginPath();var C=(o+s+w)/3,D=(r+u+x)/3,E=e(C,D,o,r),F=e(C,D,s,u),G=e(C,D,w,x);p.moveTo(F[0],F[1]),p.lineTo(E[0],E[1]),p.lineTo(G[0],G[1]),p.clip(),p.transform(B[0],B[2],B[1],B[3],o,r),p.translate(q[0]-y,q[3]-z),p.scale(d/c,-d/c),p.drawImage(t.canvas,0,0),p.restore()}}),o&&(p.save(),p.strokeStyle="black",p.lineWidth=1,l.getTriangles().forEach(function(a){var b=a.target,c=(b[0][0]-v[0])/j,d=-(b[0][1]-v[1])/j,e=(b[1][0]-v[0])/j,f=-(b[1][1]-v[1])/j,g=(b[2][0]-v[0])/j,h=-(b[2][1]-v[1])/j;p.beginPath(),p.moveTo(e,f),p.lineTo(c,d),p.lineTo(g,h),p.closePath(),p.stroke()}),p.restore()),p.canvas}Object.defineProperty(c,"__esModule",{value:!0}),c.calculateSourceResolution=d,c.render=f;var g=a("./dom.js"),h=a("./extent.js"),i=a("./math.js"),j=a("./proj.js")},{"./dom.js":63,"./extent.js":71,"./math.js":147,"./proj.js":158}],220:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=d(a("../ImageBase.js")),g=d(a("../ImageState.js")),h=a("../events.js"),i=d(a("../events/EventType.js")),j=a("../extent.js"),k=a("../reproj.js"),l=d(a("../reproj/Triangulation.js")),m=function(a){function b(b,c,d,f,h,i){var m=b.getExtent(),n=c.getExtent(),o=n?j.getIntersection(d,n):d,p=j.getCenter(o),q=k.calculateSourceResolution(b,c,p,f),r=e.ERROR_THRESHOLD,s=new l.default(b,c,o,m,q*r),t=s.calculateSourceExtent(),u=i(t,q,h),v=g.default.LOADED;u&&(v=g.default.IDLE);var w=u?u.getPixelRatio():1;a.call(this,d,f,w,v),this.targetProj_=c,this.maxSourceExtent_=m,this.triangulation_=s,this.targetResolution_=f,this.targetExtent_=d,this.sourceImage_=u,this.sourcePixelRatio_=w,this.canvas_=null,this.sourceListenerKey_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.state==g.default.LOADING&&this.unlistenSource_(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.canvas_},b.prototype.getProjection=function(){return this.targetProj_},b.prototype.reproject_=function(){var a=this.sourceImage_.getState();if(a==g.default.LOADED){var b=j.getWidth(this.targetExtent_)/this.targetResolution_,c=j.getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=k.render(b,c,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=a,this.changed()},b.prototype.load=function(){if(this.state==g.default.IDLE){this.state=g.default.LOADING,this.changed();var a=this.sourceImage_.getState();a==g.default.LOADED||a==g.default.ERROR?this.reproject_():(this.sourceListenerKey_=h.listen(this.sourceImage_,i.default.CHANGE,function(){var a=this.sourceImage_.getState();(a==g.default.LOADED||a==g.default.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},b.prototype.unlistenSource_=function(){h.unlistenByKey(this.sourceListenerKey_),this.sourceListenerKey_=null},b}(f.default),n=m;c.default=n},{"../ImageBase.js":14,"../ImageState.js":16,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../reproj.js":219,"../reproj/Triangulation.js":222,"./common.js":223}],221:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=d(a("../Tile.js")),g=d(a("../TileState.js")),h=a("../events.js"),i=d(a("../events/EventType.js")),j=a("../extent.js"),k=a("../math.js"),l=a("../reproj.js"),m=d(a("../reproj/Triangulation.js")),n=function(a){function b(b,c,d,f,h,i,n,o,p,q,r){var s=this;a.call(this,h,g.default.IDLE),this.renderEdges_=void 0!==r?r:!1,this.pixelRatio_=n,this.gutter_=o,this.canvas_=null,this.sourceTileGrid_=c,this.targetTileGrid_=f,this.wrappedTileCoord_=i?i:h,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var t=f.getTileCoordExtent(this.wrappedTileCoord_),u=this.targetTileGrid_.getExtent(),v=this.sourceTileGrid_.getExtent(),w=u?j.getIntersection(t,u):t;if(0===j.getArea(w))return void(this.state=g.default.EMPTY);var x=b.getExtent();x&&(v=v?j.getIntersection(v,x):x);var y=f.getResolution(this.wrappedTileCoord_[0]),z=j.getCenter(w),A=l.calculateSourceResolution(b,d,z,y);if(!isFinite(A)||0>=A)return void(this.state=g.default.EMPTY);var B=void 0!==q?q:e.ERROR_THRESHOLD;if(this.triangulation_=new m.default(b,d,w,v,A*B),0===this.triangulation_.getTriangles().length)return void(this.state=g.default.EMPTY);this.sourceZ_=c.getZForResolution(A);var C=this.triangulation_.calculateSourceExtent();if(v&&(b.canWrapX()?(C[1]=k.clamp(C[1],v[1],v[3]),C[3]=k.clamp(C[3],v[1],v[3])):C=j.getIntersection(C,v)),j.getArea(C)){for(var D=c.getTileRangeForExtentAndZ(C,this.sourceZ_),E=D.minX;E<=D.maxX;E++)for(var F=D.minY;F<=D.maxY;F++){var G=p(s.sourceZ_,E,F,n);G&&s.sourceTiles_.push(G)}0===this.sourceTiles_.length&&(this.state=g.default.EMPTY)}else this.state=g.default.EMPTY}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.state==g.default.LOADING&&this.unlistenSources_(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.canvas_},b.prototype.reproject_=function(){var a=[];if(this.sourceTiles_.forEach(function(b){b&&b.getState()==g.default.LOADED&&a.push({extent:this.sourceTileGrid_.getTileCoordExtent(b.tileCoord),image:b.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===a.length)this.state=g.default.ERROR;else{var b=this.wrappedTileCoord_[0],c=this.targetTileGrid_.getTileSize(b),d="number"==typeof c?c:c[0],e="number"==typeof c?c:c[1],f=this.targetTileGrid_.getResolution(b),h=this.sourceTileGrid_.getResolution(this.sourceZ_),i=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=l.render(d,e,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),f,i,this.triangulation_,a,this.gutter_,this.renderEdges_),this.state=g.default.LOADED}this.changed()},b.prototype.load=function(){if(this.state==g.default.IDLE){this.state=g.default.LOADING,this.changed();var a=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(b){var c=b.getState();if(c==g.default.IDLE||c==g.default.LOADING){a++;var d=h.listen(b,i.default.CHANGE,function(){var c=b.getState();(c==g.default.LOADED||c==g.default.ERROR||c==g.default.EMPTY)&&(h.unlistenByKey(d),a--,0===a&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(d)}}.bind(this)),this.sourceTiles_.forEach(function(a){var b=a.getState();b==g.default.IDLE&&a.load()}),0===a&&setTimeout(this.reproject_.bind(this),0)}},b.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(h.unlistenByKey),this.sourcesListenerKeys_=null},b}(f.default),o=n;c.default=o},{"../Tile.js":34,"../TileState.js":38,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../math.js":147,"../reproj.js":219,"../reproj/Triangulation.js":222,"./common.js":223}],222:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../extent.js"),e=a("../math.js"),f=a("../proj.js"),g=10,h=.25,i=function(a,b,c,e,h){this.sourceProj_=a,this.targetProj_=b;var i={},j=f.getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(a){var b=a[0]+"/"+a[1];return i[b]||(i[b]=j(a)),i[b]},this.maxSourceExtent_=e,this.errorThresholdSquared_=h*h,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!e&&!!this.sourceProj_.getExtent()&&d.getWidth(e)==d.getWidth(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?d.getWidth(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?d.getWidth(this.targetProj_.getExtent()):null;var k=d.getTopLeft(c),l=d.getTopRight(c),m=d.getBottomRight(c),n=d.getBottomLeft(c),o=this.transformInv_(k),p=this.transformInv_(l),q=this.transformInv_(m),r=this.transformInv_(n);if(this.addQuad_(k,l,m,n,o,p,q,r,g),this.wrapsXInSource_){var s=1/0;this.triangles_.forEach(function(a){s=Math.min(s,a.source[0][0],a.source[1][0],a.source[2][0])}),this.triangles_.forEach(function(a){if(Math.max(a.source[0][0],a.source[1][0],a.source[2][0])-s>this.sourceWorldWidth_/2){var b=[[a.source[0][0],a.source[0][1]],[a.source[1][0],a.source[1][1]],[a.source[2][0],a.source[2][1]]];b[0][0]-s>this.sourceWorldWidth_/2&&(b[0][0]-=this.sourceWorldWidth_),b[1][0]-s>this.sourceWorldWidth_/2&&(b[1][0]-=this.sourceWorldWidth_),b[2][0]-s>this.sourceWorldWidth_/2&&(b[2][0]-=this.sourceWorldWidth_);var c=Math.min(b[0][0],b[1][0],b[2][0]),d=Math.max(b[0][0],b[1][0],b[2][0]);d-c<this.sourceWorldWidth_/2&&(a.source=b)}}.bind(this))}i={}};i.prototype.addTriangle_=function(a,b,c,d,e,f){this.triangles_.push({source:[d,e,f],target:[a,b,c]})},i.prototype.addQuad_=function(a,b,c,f,g,i,j,k,l){var m=d.boundingExtent([g,i,j,k]),n=this.sourceWorldWidth_?d.getWidth(m)/this.sourceWorldWidth_:null,o=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&n>.5&&1>n,q=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var r=d.boundingExtent([a,b,c,f]),s=d.getWidth(r)/this.targetWorldWidth_;q|=s>h}!p&&this.sourceProj_.isGlobal()&&n&&(q|=n>h)}if(q||!this.maxSourceExtent_||d.intersects(m,this.maxSourceExtent_)){if(!(q||isFinite(g[0])&&isFinite(g[1])&&isFinite(i[0])&&isFinite(i[1])&&isFinite(j[0])&&isFinite(j[1])&&isFinite(k[0])&&isFinite(k[1]))){if(!(l>0))return;q=!0}if(l>0){if(!q){var t,u=[(a[0]+c[0])/2,(a[1]+c[1])/2],v=this.transformInv_(u);if(p){var w=(e.modulo(g[0],o)+e.modulo(j[0],o))/2;t=w-e.modulo(v[0],o)}else t=(g[0]+j[0])/2-v[0];var x=(g[1]+j[1])/2-v[1],y=t*t+x*x;q=y>this.errorThresholdSquared_}if(q){if(Math.abs(a[0]-c[0])<=Math.abs(a[1]-c[1])){var z=[(b[0]+c[0])/2,(b[1]+c[1])/2],A=this.transformInv_(z),B=[(f[0]+a[0])/2,(f[1]+a[1])/2],C=this.transformInv_(B);this.addQuad_(a,b,z,B,g,i,A,C,l-1),this.addQuad_(B,z,c,f,C,A,j,k,l-1)}else{var D=[(a[0]+b[0])/2,(a[1]+b[1])/2],E=this.transformInv_(D),F=[(c[0]+f[0])/2,(c[1]+f[1])/2],G=this.transformInv_(F);this.addQuad_(a,D,F,f,g,E,G,k,l-1),this.addQuad_(D,b,c,F,E,i,j,G,l-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(a,c,f,g,j,k),this.addTriangle_(a,b,c,g,i,j)}},i.prototype.calculateSourceExtent=function(){var a=d.createEmpty();return this.triangles_.forEach(function(b){var c=b.source;d.extendCoordinate(a,c[0]),d.extendCoordinate(a,c[1]),d.extendCoordinate(a,c[2])}),a},i.prototype.getTriangles=function(){return this.triangles_};var j=i;c.default=j},{"../extent.js":71,"../math.js":147,"../proj.js":158}],223:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ENABLE_RASTER_REPROJECTION=c.ERROR_THRESHOLD=void 0;var d=.5;c.ERROR_THRESHOLD=d;var e=!0;c.ENABLE_RASTER_REPROJECTION=e},{}],224:[function(a,b,c){"use strict";function d(a){return function(b,c,d){if(void 0!==b){var e=f.linearFindNearest(a,b,d);e=g.clamp(e+c,0,a.length-1);var h=Math.floor(e);if(e!=h&&h<a.length-1){var i=a[h]/a[h+1];return a[h]/Math.pow(i,e-h)}return a[h]}return void 0}}function e(a,b,c){return function(d,e,f){if(void 0!==d){var g=-f/2+.5,h=Math.floor(Math.log(b/d)/Math.log(a)+g),i=Math.max(h+e,0);return void 0!==c&&(i=Math.min(i,c)),b/Math.pow(a,i)}return void 0}}Object.defineProperty(c,"__esModule",{value:!0}),c.createSnapToResolutions=d,c.createSnapToPower=e;var f=a("./array.js"),g=a("./math.js")},{"./array.js":45,"./math.js":147}],225:[function(a,b,c){"use strict";function d(a){return void 0!==a?0:void 0}function e(a,b){return void 0!==a?a+b:void 0}function f(a){var b=2*Math.PI/a;return function(a,c){return void 0!==a?a=Math.floor((a+c)/b+.5)*b:void 0}}function g(a){var b=a||h.toRadians(5);return function(a,c){return void 0!==a?Math.abs(a+c)<=b?0:a+c:void 0}}Object.defineProperty(c,"__esModule",{value:!0}),c.disable=d,c.none=e,c.createSnapToN=f,c.createSnapToZero=g;var h=a("./math.js")},{"./math.js":147}],226:[function(a,b,c){"use strict";function d(a,b,c){return void 0===c&&(c=[0,0]),c[0]=a[0]+2*b,c[1]=a[1]+2*b,c}function e(a){return a[0]>0&&a[1]>0}function f(a,b,c){return void 0===c&&(c=[0,0]),c[0]=a[0]*b+.5|0,c[1]=a[1]*b+.5|0,c}function g(a,b){return Array.isArray(a)?a:(void 0===b?b=[a,a]:b[0]=b[1]=a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.buffer=d,c.hasArea=e,c.scale=f,c.toSize=g},{}],227:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BingMaps",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"CartoDB",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Cluster",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"ImageArcGISRest",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"ImageCanvas",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"ImageMapGuide",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"ImageStatic",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"ImageWMS",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"OSM",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"Raster",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"Source",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"Stamen",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(c,"Tile",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"TileArcGISRest",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"TileDebug",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(c,"TileImage",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(c,"TileJSON",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(c,"TileWMS",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(c,"UrlTile",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(c,"UTFGrid",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(c,"Vector",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(c,"WMTS",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(c,"XYZ",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(c,"Zoomify",{enumerable:!0,get:function(){return C.default}});var e=d(a("./source/BingMaps.js")),f=d(a("./source/CartoDB.js")),g=d(a("./source/Cluster.js")),h=d(a("./source/Image.js")),i=d(a("./source/ImageArcGISRest.js")),j=d(a("./source/ImageCanvas.js")),k=d(a("./source/ImageMapGuide.js")),l=d(a("./source/ImageStatic.js")),m=d(a("./source/ImageWMS.js")),n=d(a("./source/OSM.js")),o=d(a("./source/Raster.js")),p=d(a("./source/Source.js")),q=d(a("./source/Stamen.js")),r=d(a("./source/Tile.js")),s=d(a("./source/TileArcGISRest.js")),t=d(a("./source/TileDebug.js")),u=d(a("./source/TileImage.js")),v=d(a("./source/TileJSON.js")),w=d(a("./source/TileWMS.js")),x=d(a("./source/UrlTile.js")),y=d(a("./source/UTFGrid.js")),z=d(a("./source/Vector.js")),A=d(a("./source/WMTS.js")),B=d(a("./source/XYZ.js")),C=d(a("./source/Zoomify.js"))},{"./source/BingMaps.js":228,"./source/CartoDB.js":229,"./source/Cluster.js":230,"./source/Image.js":231,"./source/ImageArcGISRest.js":232,"./source/ImageCanvas.js":233,"./source/ImageMapGuide.js":234,"./source/ImageStatic.js":235,"./source/ImageWMS.js":236,"./source/OSM.js":237,"./source/Raster.js":238,"./source/Source.js":239,"./source/Stamen.js":240,"./source/Tile.js":242,"./source/TileArcGISRest.js":243,"./source/TileDebug.js":244,"./source/TileImage.js":246,"./source/TileJSON.js":247,"./source/TileWMS.js":248,"./source/UTFGrid.js":249,"./source/UrlTile.js":250,"./source/Vector.js":251,"./source/WMTS.js":254,"./source/XYZ.js":256,"./source/Zoomify.js":257}],228:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../tileurlfunction.js"),f=a("../extent.js"),g=a("../net.js"),h=a("../proj.js"),i=d(a("../source/State.js")),j=d(a("../source/TileImage.js")),k=a("../tilecoord.js"),l=a("../tilegrid.js"),m='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>',n=function(a){function b(b){var c=void 0!==b.hidpi?b.hidpi:!1;a.call(this,{cacheSize:b.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:h.get("EPSG:3857"),reprojectionErrorThreshold:b.reprojectionErrorThreshold,state:i.default.LOADING,tileLoadFunction:b.tileLoadFunction,tilePixelRatio:c?2:1,wrapX:void 0!==b.wrapX?b.wrapX:!0,transition:b.transition}),this.hidpi_=c,this.culture_=void 0!==b.culture?b.culture:"en-us",this.maxZoom_=void 0!==b.maxZoom?b.maxZoom:-1,this.apiKey_=b.key,this.imagerySet_=b.imagerySet;var d="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;g.jsonp(d,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getApiKey=function(){return this.apiKey_},b.prototype.getImagerySet=function(){return this.imagerySet_},b.prototype.handleImageryMetadataResponse=function(a){if(200!=a.statusCode||"OK"!=a.statusDescription||"ValidCredentials"!=a.authenticationResultCode||1!=a.resourceSets.length||1!=a.resourceSets[0].resources.length)return void this.setState(i.default.ERROR);var b=a.resourceSets[0].resources[0],c=-1==this.maxZoom_?b.zoomMax:this.maxZoom_,d=this.getProjection(),g=l.extentFromProjection(d),j=b.imageWidth==b.imageHeight?b.imageWidth:[b.imageWidth,b.imageHeight],n=l.createXYZ({extent:g,minZoom:b.zoomMin,maxZoom:c,tileSize:j/(this.hidpi_?2:1)});this.tileGrid=n;var o=this.culture_,p=this.hidpi_;if(this.tileUrlFunction=e.createFromTileUrlFunctions(b.imageUrlSubdomains.map(function(a){var c=[0,0,0],d=b.imageUrl.replace("{subdomain}",a).replace("{culture}",o);return function(a){if(a){k.createOrUpdate(a[0],a[1],-a[2]-1,c);var b=d;return p&&(b+="&dpi=d1&device=mobile"),b.replace("{quadkey}",k.quadKey(c))}return void 0}})),b.imageryProviders){var q=h.getTransformFromProjections(h.get("EPSG:4326"),this.getProjection());this.setAttributions(function(a){var c=[],d=a.viewState.zoom;return b.imageryProviders.map(function(b){for(var e=!1,g=b.coverageAreas,h=0,i=g.length;i>h;++h){var j=g[h];if(d>=j.zoomMin&&d<=j.zoomMax){var k=j.bbox,l=[k[1],k[0],k[3],k[2]],m=f.applyTransform(l,q);if(f.intersects(m,a.extent)){e=!0;break}}}e&&c.push(b.attribution)}),c.push(m),c})}this.setState(i.default.READY)},b}(j.default),o=n;c.default=o},{"../extent.js":71,"../net.js":148,"../proj.js":158,"../source/State.js":241,"../source/TileImage.js":246,"../tilecoord.js":281,"../tilegrid.js":282,"../tileurlfunction.js":286}],229:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../obj.js"),f=d(a("../source/State.js")),g=d(a("../source/XYZ.js")),h=function(a){function b(b){a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,crossOrigin:b.crossOrigin,maxZoom:void 0!==b.maxZoom?b.maxZoom:18,minZoom:b.minZoom,projection:b.projection,state:f.default.LOADING,wrapX:b.wrapX}),this.account_=b.account,this.mapId_=b.map||"",this.config_=b.config||{},this.templateCache_={},this.initializeMap_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getConfig=function(){return this.config_},b.prototype.updateConfig=function(a){e.assign(this.config_,a),this.initializeMap_()},b.prototype.setConfig=function(a){this.config_=a||{},this.initializeMap_()},b.prototype.initializeMap_=function(){var a=JSON.stringify(this.config_);if(this.templateCache_[a])return void this.applyTemplate_(this.templateCache_[a]);var b="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(b+="/named/"+this.mapId_);var c=new XMLHttpRequest;c.addEventListener("load",this.handleInitResponse_.bind(this,a)),c.addEventListener("error",this.handleInitError_.bind(this)),c.open("POST",b),c.setRequestHeader("Content-type","application/json"),c.send(JSON.stringify(this.config_))},b.prototype.handleInitResponse_=function(a,b){var c=b.target;if(!c.status||c.status>=200&&c.status<300){var d;try{d=JSON.parse(c.responseText)}catch(e){return void this.setState(f.default.ERROR)}this.applyTemplate_(d),this.templateCache_[a]=d,this.setState(f.default.READY)}else this.setState(f.default.ERROR)},b.prototype.handleInitError_=function(){this.setState(f.default.ERROR)},b.prototype.applyTemplate_=function(a){var b="https://"+a.cdn_url.https+"/"+this.account_+"/api/v1/map/"+a.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(b)},b}(g.default),i=h;c.default=i},{"../obj.js":149,"../source/State.js":241,"../source/XYZ.js":256}],230:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=a("../asserts.js"),g=d(a("../Feature.js")),h=a("../coordinate.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../extent.js"),l=d(a("../geom/Point.js")),m=d(a("../source/Vector.js")),n=function(a){function b(b){a.call(this,{attributions:b.attributions,extent:b.extent,projection:b.projection,wrapX:b.wrapX}),this.resolution=void 0,this.distance=void 0!==b.distance?b.distance:20,this.features=[],this.geometryFunction=b.geometryFunction||function(a){var b=a.getGeometry();return f.assert(b instanceof l.default,10),b},this.source=b.source,i.listen(this.source,j.default.CHANGE,this.refresh,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDistance=function(){return this.distance},b.prototype.getSource=function(){return this.source},b.prototype.loadFeatures=function(a,b,c){this.source.loadFeatures(a,b,c),b!==this.resolution&&(this.clear(),this.resolution=b,this.cluster(),this.addFeatures(this.features))},b.prototype.setDistance=function(a){this.distance=a,this.refresh()},b.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features),a.prototype.refresh.call(this)},b.prototype.cluster=function(){var a=this;if(void 0!==this.resolution){this.features.length=0;for(var b=k.createEmpty(),c=this.distance*this.resolution,d=this.source.getFeatures(),f={},g=0,h=d.length;h>g;g++){var i=d[g];if(!(e.getUid(i).toString()in f)){var j=a.geometryFunction(i);if(j){var l=j.getCoordinates();k.createOrUpdateFromCoordinate(l,b),k.buffer(b,c,b);var m=a.source.getFeaturesInExtent(b);m=m.filter(function(a){var b=e.getUid(a).toString();return b in f?!1:(f[b]=!0,!0)}),a.features.push(a.createCluster(m))}}}}},b.prototype.createCluster=function(a){for(var b=this,c=[0,0],d=a.length-1;d>=0;--d){var e=b.geometryFunction(a[d]);e?h.add(c,e.getCoordinates()):a.splice(d,1)}h.scale(c,1/a.length);var f=new g.default(new l.default(c));return f.set("features",a),f},b}(m.default),o=n;c.default=o},{"../Feature.js":9,"../asserts.js":46,"../coordinate.js":61,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../geom/Point.js":87,"../source/Vector.js":251,"../util.js":289}],231:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){a.getImage().src=b}Object.defineProperty(c,"__esModule",{value:!0}),c.defaultImageLoadFunction=e,c.default=void 0;var f=a("../reproj/common.js"),g=d(a("../ImageState.js")),h=a("../array.js"),i=d(a("../events/Event.js")),j=a("../extent.js"),k=a("../proj.js"),l=d(a("../reproj/Image.js")),m=d(a("../source/Source.js")),n={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},o=function(a){function b(b,c){a.call(this,b),this.image=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),p=function(a){function b(b){a.call(this,{attributions:b.attributions,extent:b.extent,projection:b.projection,state:b.state}),this.resolutions_=void 0!==b.resolutions?b.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getResolutions=function(){return this.resolutions_},b.prototype.findNearestResolution=function(a){if(this.resolutions_){var b=h.linearFindNearest(this.resolutions_,a,0);a=this.resolutions_[b]}return a},b.prototype.getImage=function(a,b,c,d){var e=this.getProjection();if(f.ENABLE_RASTER_REPROJECTION&&e&&d&&!k.equivalent(e,d)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&k.equivalent(this.reprojectedImage_.getProjection(),d)&&this.reprojectedImage_.getResolution()==b&&j.equals(this.reprojectedImage_.getExtent(),a))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new l.default(e,d,a,b,c,function(a,b,c){return this.getImageInternal(a,b,c,e)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return e&&(d=e),this.getImageInternal(a,b,c,d)},b.prototype.getImageInternal=function(){},b.prototype.handleImageChange=function(a){var b=a.target;switch(b.getState()){case g.default.LOADING:this.loading=!0,this.dispatchEvent(new o(n.IMAGELOADSTART,b));break;case g.default.LOADED:this.loading=!1,this.dispatchEvent(new o(n.IMAGELOADEND,b));break;case g.default.ERROR:this.loading=!1,this.dispatchEvent(new o(n.IMAGELOADERROR,b))}},b}(m.default),q=p;c.default=q},{"../ImageState.js":16,"../array.js":45,"../events/Event.js":66,"../extent.js":71,"../proj.js":158,"../reproj/Image.js":220,"../reproj/common.js":223,"../source/Source.js":239}],232:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("../Image.js")),g=a("../asserts.js"),h=a("../events.js"),i=e(a("../events/EventType.js")),j=a("../extent.js"),k=a("../obj.js"),l=d(a("../source/Image.js")),m=a("../uri.js"),n=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,projection:c.projection,resolutions:c.resolutions}),this.crossOrigin_=void 0!==c.crossOrigin?c.crossOrigin:null,this.hidpi_=void 0!==c.hidpi?c.hidpi:!0,this.url_=c.url,this.imageLoadFunction_=void 0!==c.imageLoadFunction?c.imageLoadFunction:l.defaultImageLoadFunction,this.params_=c.params||{},this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==c.ratio?c.ratio:1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getParams=function(){return this.params_},b.prototype.getImageInternal=function(a,b,c,d){if(void 0===this.url_)return null;b=this.findNearestResolution(b),c=this.hidpi_?c:1;var e=this.image_;if(e&&this.renderedRevision_==this.getRevision()&&e.getResolution()==b&&e.getPixelRatio()==c&&j.containsExtent(e.getExtent(),a))return e;var g={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};k.assign(g,this.params_),a=a.slice();var l=(a[0]+a[2])/2,m=(a[1]+a[3])/2;if(1!=this.ratio_){var n=this.ratio_*j.getWidth(a)/2,o=this.ratio_*j.getHeight(a)/2;a[0]=l-n,a[1]=m-o,a[2]=l+n,a[3]=m+o}var p=b/c,q=Math.ceil(j.getWidth(a)/p),r=Math.ceil(j.getHeight(a)/p);a[0]=l-p*q/2,a[2]=l+p*q/2,a[1]=m-p*r/2,a[3]=m+p*r/2,this.imageSize_[0]=q,this.imageSize_[1]=r;var s=this.getRequestUrl_(a,this.imageSize_,c,d,g);return this.image_=new f.default(a,b,c,s,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),h.listen(this.image_,i.default.CHANGE,this.handleImageChange,this),this.image_},b.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},b.prototype.getRequestUrl_=function(a,b,c,d,e){var f=d.getCode().split(":").pop();e.SIZE=b[0]+","+b[1],e.BBOX=a.join(","),e.BBOXSR=f,e.IMAGESR=f,e.DPI=Math.round(90*c);var h=this.url_,i=h.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return i==h&&g.assert(!1,50),m.appendParams(i,e)},b.prototype.getUrl=function(){return this.url_},b.prototype.setImageLoadFunction=function(a){this.image_=null,this.imageLoadFunction_=a,this.changed()},b.prototype.setUrl=function(a){a!=this.url_&&(this.url_=a,this.image_=null,this.changed())},b.prototype.updateParams=function(a){k.assign(this.params_,a),this.image_=null,this.changed()},b}(l.default),o=n;c.default=o},{"../Image.js":13,"../asserts.js":46,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../obj.js":149,"../source/Image.js":231,"../uri.js":288}],233:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;
var e=d(a("../ImageCanvas.js")),f=a("../extent.js"),g=d(a("../source/Image.js")),h=function(a){function b(b){a.call(this,{attributions:b.attributions,projection:b.projection,resolutions:b.resolutions,state:b.state}),this.canvasFunction_=b.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==b.ratio?b.ratio:1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImageInternal=function(a,b,c,d){b=this.findNearestResolution(b);var g=this.canvas_;if(g&&this.renderedRevision_==this.getRevision()&&g.getResolution()==b&&g.getPixelRatio()==c&&f.containsExtent(g.getExtent(),a))return g;a=a.slice(),f.scaleFromCenter(a,this.ratio_);var h=f.getWidth(a)/b,i=f.getHeight(a)/b,j=[h*c,i*c],k=this.canvasFunction_(a,b,c,j,d);return k&&(g=new e.default(a,b,c,k)),this.canvas_=g,this.renderedRevision_=this.getRevision(),g},b}(g.default),i=h;c.default=i},{"../ImageCanvas.js":15,"../extent.js":71,"../source/Image.js":231}],234:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b,c,d){var e=j.getWidth(a),f=j.getHeight(a),g=b[0],h=b[1],i=.0254/d;return h*e>g*f?e*c/(g*i):f*c/(h*i)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=e(a("../Image.js")),h=a("../events.js"),i=e(a("../events/EventType.js")),j=a("../extent.js"),k=a("../obj.js"),l=d(a("../source/Image.js")),m=a("../uri.js"),n=function(a){function b(b){a.call(this,{projection:b.projection,resolutions:b.resolutions}),this.crossOrigin_=void 0!==b.crossOrigin?b.crossOrigin:null,this.displayDpi_=void 0!==b.displayDpi?b.displayDpi:96,this.params_=b.params||{},this.url_=b.url,this.imageLoadFunction_=void 0!==b.imageLoadFunction?b.imageLoadFunction:l.defaultImageLoadFunction,this.hidpi_=void 0!==b.hidpi?b.hidpi:!0,this.metersPerUnit_=void 0!==b.metersPerUnit?b.metersPerUnit:1,this.ratio_=void 0!==b.ratio?b.ratio:1,this.useOverlay_=void 0!==b.useOverlay?b.useOverlay:!1,this.image_=null,this.renderedRevision_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getParams=function(){return this.params_},b.prototype.getImageInternal=function(a,b,c,d){b=this.findNearestResolution(b),c=this.hidpi_?c:1;var e=this.image_;if(e&&this.renderedRevision_==this.getRevision()&&e.getResolution()==b&&e.getPixelRatio()==c&&j.containsExtent(e.getExtent(),a))return e;1!=this.ratio_&&(a=a.slice(),j.scaleFromCenter(a,this.ratio_));var f=j.getWidth(a)/b,k=j.getHeight(a)/b,l=[f*c,k*c];if(void 0!==this.url_){var m=this.getUrl(this.url_,this.params_,a,l,d);e=new g.default(a,b,c,m,this.crossOrigin_,this.imageLoadFunction_),h.listen(e,i.default.CHANGE,this.handleImageChange,this)}else e=null;return this.image_=e,this.renderedRevision_=this.getRevision(),e},b.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},b.prototype.updateParams=function(a){k.assign(this.params_,a),this.changed()},b.prototype.getUrl=function(a,b,c,d){var e=f(c,d,this.metersPerUnit_,this.displayDpi_),g=j.getCenter(c),h={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(d[0]),SETDISPLAYHEIGHT:Math.round(d[1]),SETVIEWSCALE:e,SETVIEWCENTERX:g[0],SETVIEWCENTERY:g[1]};return k.assign(h,b),m.appendParams(a,h)},b.prototype.setImageLoadFunction=function(a){this.image_=null,this.imageLoadFunction_=a,this.changed()},b}(l.default),o=n;c.default=o},{"../Image.js":13,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../obj.js":149,"../source/Image.js":231,"../uri.js":288}],235:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("../Image.js")),g=e(a("../ImageState.js")),h=a("../dom.js"),i=a("../events.js"),j=e(a("../events/EventType.js")),k=a("../extent.js"),l=a("../proj.js"),m=d(a("../source/Image.js")),n=function(a){function b(b){var c=void 0!==b.crossOrigin?b.crossOrigin:null,d=void 0!==b.imageLoadFunction?b.imageLoadFunction:m.defaultImageLoadFunction;a.call(this,{attributions:b.attributions,projection:l.get(b.projection)}),this.url_=b.url,this.imageExtent_=b.imageExtent,this.image_=new f.default(this.imageExtent_,void 0,1,this.url_,c,d),this.imageSize_=b.imageSize?b.imageSize:null,i.listen(this.image_,j.default.CHANGE,this.handleImageChange,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImageExtent=function(){return this.imageExtent_},b.prototype.getImageInternal=function(a){return k.intersects(a,this.image_.getExtent())?this.image_:null},b.prototype.getUrl=function(){return this.url_},b.prototype.handleImageChange=function(b){if(this.image_.getState()==g.default.LOADED){var c,d,e=this.image_.getExtent(),f=this.image_.getImage();this.imageSize_?(c=this.imageSize_[0],d=this.imageSize_[1]):(c=f.width,d=f.height);var i=k.getHeight(e)/d,j=Math.ceil(k.getWidth(e)/i);if(j!=c){var l=h.createCanvasContext2D(j,d),m=l.canvas;l.drawImage(f,0,0,c,d,0,0,m.width,m.height),this.image_.setImage(m)}}a.prototype.handleImageChange.call(this,b)},b}(m.default),o=n;c.default=o},{"../Image.js":13,"../ImageState.js":16,"../dom.js":63,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../proj.js":158,"../source/Image.js":231}],236:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("./common.js"),g=e(a("../Image.js")),h=a("../asserts.js"),i=a("../events.js"),j=e(a("../events/EventType.js")),k=a("../extent.js"),l=a("../obj.js"),m=a("../proj.js"),n=a("../reproj.js"),o=d(a("../source/Image.js")),p=e(a("../source/WMSServerType.js")),q=a("../string.js"),r=a("../uri.js"),s=[101,101],t=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,projection:c.projection,resolutions:c.resolutions}),this.crossOrigin_=void 0!==c.crossOrigin?c.crossOrigin:null,this.url_=c.url,this.imageLoadFunction_=void 0!==c.imageLoadFunction?c.imageLoadFunction:o.defaultImageLoadFunction,this.params_=c.params||{},this.v13_=!0,this.updateV13_(),this.serverType_=c.serverType,this.hidpi_=void 0!==c.hidpi?c.hidpi:!0,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==c.ratio?c.ratio:1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getGetFeatureInfoUrl=function(a,b,c,d){if(void 0===this.url_)return void 0;var e=m.get(c),g=this.getProjection();g&&g!==e&&(b=n.calculateSourceResolution(g,e,a,b),a=m.transform(a,e,g));var h=k.getForViewAndSize(a,b,0,s),i={SERVICE:"WMS",VERSION:f.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};l.assign(i,this.params_,d);var j=Math.floor((a[0]-h[0])/b),o=Math.floor((h[3]-a[1])/b);return i[this.v13_?"I":"X"]=j,i[this.v13_?"J":"Y"]=o,this.getRequestUrl_(h,s,1,g||e,i)},b.prototype.getParams=function(){return this.params_},b.prototype.getImageInternal=function(a,b,c,d){if(void 0===this.url_)return null;b=this.findNearestResolution(b),1==c||this.hidpi_&&void 0!==this.serverType_||(c=1);var e=b/c,h=k.getCenter(a),m=Math.ceil(k.getWidth(a)/e),n=Math.ceil(k.getHeight(a)/e),o=k.getForViewAndSize(h,e,0,[m,n]),p=Math.ceil(this.ratio_*k.getWidth(a)/e),q=Math.ceil(this.ratio_*k.getHeight(a)/e),r=k.getForViewAndSize(h,e,0,[p,q]),s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==b&&s.getPixelRatio()==c&&k.containsExtent(s.getExtent(),o))return s;var t={SERVICE:"WMS",VERSION:f.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};l.assign(t,this.params_),this.imageSize_[0]=Math.round(k.getWidth(r)/e),this.imageSize_[1]=Math.round(k.getHeight(r)/e);var u=this.getRequestUrl_(r,this.imageSize_,c,d,t);return this.image_=new g.default(r,b,c,u,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),i.listen(this.image_,j.default.CHANGE,this.handleImageChange,this),this.image_},b.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},b.prototype.getRequestUrl_=function(a,b,c,d,e){if(h.assert(void 0!==this.url_,9),e[this.v13_?"CRS":"SRS"]=d.getCode(),"STYLES"in this.params_||(e.STYLES=""),1!=c)switch(this.serverType_){case p.default.GEOSERVER:var f=90*c+.5|0;"FORMAT_OPTIONS"in e?e.FORMAT_OPTIONS+=";dpi:"+f:e.FORMAT_OPTIONS="dpi:"+f;break;case p.default.MAPSERVER:e.MAP_RESOLUTION=90*c;break;case p.default.CARMENTA_SERVER:case p.default.QGIS:e.DPI=90*c;break;default:h.assert(!1,8)}e.WIDTH=b[0],e.HEIGHT=b[1];var g,i=d.getAxisOrientation();return g=this.v13_&&"ne"==i.substr(0,2)?[a[1],a[0],a[3],a[2]]:a,e.BBOX=g.join(","),r.appendParams(this.url_,e)},b.prototype.getUrl=function(){return this.url_},b.prototype.setImageLoadFunction=function(a){this.image_=null,this.imageLoadFunction_=a,this.changed()},b.prototype.setUrl=function(a){a!=this.url_&&(this.url_=a,this.image_=null,this.changed())},b.prototype.updateParams=function(a){l.assign(this.params_,a),this.updateV13_(),this.image_=null,this.changed()},b.prototype.updateV13_=function(){var a=this.params_.VERSION||f.DEFAULT_WMS_VERSION;this.v13_=q.compareVersions(a,"1.3")>=0},b}(o.default),u=t;c.default=u},{"../Image.js":13,"../asserts.js":46,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../obj.js":149,"../proj.js":158,"../reproj.js":219,"../source/Image.js":231,"../source/WMSServerType.js":253,"../string.js":260,"../uri.js":288,"./common.js":258}],237:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.ATTRIBUTION=void 0;var e=d(a("../source/XYZ.js")),f='&#169; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';c.ATTRIBUTION=f;var g=function(a){function b(b){var c,d=b||{};c=void 0!==d.attributions?d.attributions:[f];var e=void 0!==d.crossOrigin?d.crossOrigin:"anonymous",g=void 0!==d.url?d.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";a.call(this,{attributions:c,cacheSize:d.cacheSize,crossOrigin:e,opaque:void 0!==d.opaque?d.opaque:!0,maxZoom:void 0!==d.maxZoom?d.maxZoom:19,reprojectionErrorThreshold:d.reprojectionErrorThreshold,tileLoadFunction:d.tileLoadFunction,url:g,wrapX:d.wrapX})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),h=g;c.default=h},{"../source/XYZ.js":256}],238:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){if(!a.prepareFrame(b,c))return null;var d=b.size[0],e=b.size[1];if(I){var f=I.canvas;f.width!==d||f.height!==e?I=n.createCanvasContext2D(d,e):I.clearRect(0,0,d,e)}else I=n.createCanvasContext2D(d,e);return a.composeFrame(b,c,I),I.getImageData(0,0,d,e)}function f(a){return a.map(function(a){return a.getLayer().getLayerState()})}function g(a){for(var b=a.length,c=new Array(b),d=0;b>d;++d)c[d]=h(a[d]);return c}function h(a){var b=null;return a instanceof C.default?b=j(a):a instanceof A.default?b=i(a):a instanceof w.default?b=new z.default(a):a instanceof u.default&&(a.getType()==t.default.IMAGE||a.getType()==t.default.VECTOR)&&(b=new y.default(a)),b}function i(a){var b=new v.default({source:a});return new y.default(b)}function j(a){var b=new w.default({source:a});return new z.default(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var k=a("../util.js"),l=d(a("../ImageCanvas.js")),m=d(a("../TileQueue.js")),n=a("../dom.js"),o=a("../events.js"),p=d(a("../events/Event.js")),q=d(a("../events/EventType.js")),r=a("pixelworks/lib/index"),s=a("../extent.js"),t=d(a("../LayerType.js")),u=d(a("../layer/Layer.js")),v=d(a("../layer/Image.js")),w=d(a("../layer/Tile.js")),x=a("../obj.js"),y=d(a("../renderer/canvas/ImageLayer.js")),z=d(a("../renderer/canvas/TileLayer.js")),A=d(a("../source/Image.js")),B=d(a("../source/State.js")),C=d(a("../source/Tile.js")),D=a("../transform.js"),E={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"},F={PIXEL:"pixel",IMAGE:"image"},G=function(a){function b(b,c,d){a.call(this,b),this.extent=c.extent,this.resolution=c.viewState.resolution/c.pixelRatio,this.data=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(p.default),H=function(a){function b(b){var c=this;a.call(this,{}),this.worker_=null,this.operationType_=void 0!==b.operationType?b.operationType:F.PIXEL,this.threads_=void 0!==b.threads?b.threads:1,this.renderers_=g(b.sources);for(var d=0,e=this.renderers_.length;e>d;++d)o.listen(c.renderers_[d],q.default.CHANGE,c.changed,c);this.tileQueue_=new m.default(function(){return 1},this.changed.bind(this));for(var h=f(this.renderers_),i={},j=0,l=h.length;l>j;++j)i[k.getUid(h[j].layer)]=h[j];this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:D.create(),extent:null,focus:null,index:0,layerStates:i,layerStatesArray:h,pixelRatio:1,pixelToCoordinateTransform:D.create(),postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}},void 0!==b.operation&&this.setOperation(b.operation,b.lib)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setOperation=function(a,b){this.worker_=new r.Processor({operation:a,imageOps:this.operationType_===F.IMAGE,queue:1,lib:b,threads:this.threads_}),this.changed()},b.prototype.updateFrameState_=function(a,b,c){var d=x.assign({},this.frameState_);d.viewState=x.assign({},d.viewState);var e=s.getCenter(a);d.extent=a.slice(),d.focus=e,d.size[0]=Math.round(s.getWidth(a)/b),d.size[1]=Math.round(s.getHeight(a)/b),d.time=Date.now(),d.animate=!1;var f=d.viewState;return f.center=e,f.projection=c,f.resolution=b,d},b.prototype.allSourcesReady_=function(){for(var a,b=this,c=!0,d=0,e=this.renderers_.length;e>d;++d)if(a=b.renderers_[d].getLayer().getSource(),a.getState()!==B.default.READY){c=!1;break}return c},b.prototype.getImage=function(a,b,c,d){if(!this.allSourcesReady_())return null;var e=this.updateFrameState_(a,b,d);if(this.requestedFrameState_=e,this.renderedImageCanvas_){var f=this.renderedImageCanvas_.getResolution(),g=this.renderedImageCanvas_.getExtent();b===f&&s.equals(a,g)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),e.tileQueue.loadMoreTiles(16,16),e.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},b.prototype.processSources_=function(){for(var a=this,b=this.requestedFrameState_,c=this.renderers_.length,d=new Array(c),f=0;c>f;++f){var g=e(a.renderers_[f],b,b.layerStatesArray[f]);if(!g)return;d[f]=g}var h={};this.dispatchEvent(new G(E.BEFOREOPERATIONS,b,h)),this.worker_.process(d,h,this.onWorkerComplete_.bind(this,b))},b.prototype.onWorkerComplete_=function(a,b,c,d){if(!b&&c){var e=a.extent,f=a.viewState.resolution;if(f===this.requestedFrameState_.viewState.resolution&&s.equals(e,this.requestedFrameState_.extent)){var g;if(this.renderedImageCanvas_)g=this.renderedImageCanvas_.getImage().getContext("2d");else{var h=Math.round(s.getWidth(e)/f),i=Math.round(s.getHeight(e)/f);g=n.createCanvasContext2D(h,i),this.renderedImageCanvas_=new l.default(e,f,1,g.canvas)}g.putImageData(c,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new G(E.AFTEROPERATIONS,a,d))}}},b.prototype.getImageInternal=function(){return null},b}(A.default),I=null,J=H;c.default=J},{"../ImageCanvas.js":15,"../LayerType.js":19,"../TileQueue.js":36,"../dom.js":63,"../events.js":65,"../events/Event.js":66,"../events/EventType.js":67,"../extent.js":71,"../layer/Image.js":137,"../layer/Layer.js":138,"../layer/Tile.js":140,"../obj.js":149,"../renderer/canvas/ImageLayer.js":202,"../renderer/canvas/TileLayer.js":206,"../source/Image.js":231,"../source/State.js":241,"../source/Tile.js":242,"../transform.js":287,"../util.js":289,"pixelworks/lib/index":298}],239:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../functions.js"),f=d(a("../Object.js")),g=a("../proj.js"),h=d(a("../source/State.js")),i=function(a){function b(b){a.call(this),this.projection_=g.get(b.projection),this.attributions_=this.adaptAttributions_(b.attributions),this.loading=!1,this.state_=void 0!==b.state?b.state:h.default.READY,this.wrapX_=void 0!==b.wrapX?b.wrapX:!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.adaptAttributions_=function(a){return a?Array.isArray(a)?function(){return a}:"function"==typeof a?a:function(){return[a]}:null},b.prototype.getAttributions=function(){return this.attributions_},b.prototype.getProjection=function(){return this.projection_},b.prototype.getResolutions=function(){},b.prototype.getState=function(){return this.state_},b.prototype.getWrapX=function(){return this.wrapX_},b.prototype.refresh=function(){this.changed()},b.prototype.setAttributions=function(a){this.attributions_=this.adaptAttributions_(a),this.changed()},b.prototype.setState=function(a){this.state_=a,this.changed()},b}(f.default);i.prototype.forEachFeatureAtCoordinate=e.VOID;var j=i;c.default=j},{"../Object.js":28,"../functions.js":76,"../proj.js":158,"../source/State.js":241}],240:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../source/OSM.js"),f=d(a("../source/XYZ.js")),g=['Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',e.ATTRIBUTION],h={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},i={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}},j=function(a){function b(b){var c=b.layer.indexOf("-"),d=-1==c?b.layer:b.layer.slice(0,c),e=i[d],f=h[b.layer],j=void 0!==b.url?b.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+b.layer+"/{z}/{x}/{y}."+f.extension;a.call(this,{attributions:g,cacheSize:b.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=b.maxZoom?b.maxZoom:e.maxZoom,minZoom:void 0!=b.minZoom?b.minZoom:e.minZoom,opaque:f.opaque,reprojectionErrorThreshold:b.reprojectionErrorThreshold,tileLoadFunction:b.tileLoadFunction,url:j,wrapX:b.wrapX})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(f.default),k=j;c.default=k},{"../source/OSM.js":237,"../source/XYZ.js":256}],241:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};c.default=d},{}],242:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.TileSourceEvent=void 0;var e=a("../functions.js"),f=d(a("../TileCache.js")),g=d(a("../TileState.js")),h=d(a("../events/Event.js")),i=a("../proj.js"),j=a("../size.js"),k=d(a("../source/Source.js")),l=a("../tilecoord.js"),m=a("../tilegrid.js"),n=function(a){function b(b){a.call(this,{attributions:b.attributions,extent:b.extent,projection:b.projection,state:b.state,wrapX:b.wrapX}),this.opaque_=void 0!==b.opaque?b.opaque:!1,this.tilePixelRatio_=void 0!==b.tilePixelRatio?b.tilePixelRatio:1,this.tileGrid=void 0!==b.tileGrid?b.tileGrid:null,this.tileCache=new f.default(b.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:b.transition}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},b.prototype.expireCache=function(a,b){var c=this.getTileCacheForProjection(a);c&&c.expireCache(b)},b.prototype.forEachLoadedTile=function(a,b,c,d){var e=this.getTileCacheForProjection(a);if(!e)return!1;for(var f,h,i,j=!0,k=c.minX;k<=c.maxX;++k)for(var m=c.minY;m<=c.maxY;++m)h=l.getKeyZXY(b,k,m),i=!1,e.containsKey(h)&&(f=e.get(h),i=f.getState()===g.default.LOADED,i&&(i=d(f)!==!1)),i||(j=!1);return j},b.prototype.getGutterForProjection=function(){return 0},b.prototype.getKey=function(){return this.key_},b.prototype.setKey=function(a){this.key_!==a&&(this.key_=a,this.changed())},b.prototype.getOpaque=function(){return this.opaque_},b.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},b.prototype.getTile=function(){},b.prototype.getTileGrid=function(){return this.tileGrid},b.prototype.getTileGridForProjection=function(a){return this.tileGrid?this.tileGrid:m.getForProjection(a)},b.prototype.getTileCacheForProjection=function(a){var b=this.getProjection();return b&&!i.equivalent(b,a)?null:this.tileCache},b.prototype.getTilePixelRatio=function(){return this.tilePixelRatio_},b.prototype.getTilePixelSize=function(a,b,c){var d=this.getTileGridForProjection(c),e=this.getTilePixelRatio(b),f=j.toSize(d.getTileSize(a),this.tmpSize);return 1==e?f:j.scale(f,e,this.tmpSize)},b.prototype.getTileCoordForTileUrlFunction=function(a,b){var c=void 0!==b?b:this.getProjection(),d=this.getTileGridForProjection(c);return this.getWrapX()&&c.isGlobal()&&(a=m.wrapX(d,a,c)),l.withinExtentAndZ(a,d)?a:null},b.prototype.refresh=function(){this.tileCache.clear(),this.changed()},b}(k.default);n.prototype.useTile=e.VOID;var o=function(a){function b(b,c){a.call(this,b),this.tile=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default);c.TileSourceEvent=o;var p=n;c.default=p},{"../TileCache.js":35,"../TileState.js":38,"../events/Event.js":66,"../functions.js":76,"../proj.js":158,"../size.js":226,"../source/Source.js":239,"../tilecoord.js":281,"../tilegrid.js":282}],243:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=a("../math.js"),g=a("../obj.js"),h=a("../size.js"),i=d(a("../source/TileImage.js")),j=a("../tilecoord.js"),k=a("../uri.js"),l=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,cacheSize:c.cacheSize,crossOrigin:c.crossOrigin,projection:c.projection,reprojectionErrorThreshold:c.reprojectionErrorThreshold,tileGrid:c.tileGrid,tileLoadFunction:c.tileLoadFunction,url:c.url,urls:c.urls,wrapX:void 0!==c.wrapX?c.wrapX:!0,transition:c.transition}),this.params_=c.params||{},this.tmpExtent_=e.createEmpty(),this.setKey(this.getKeyForParams_())}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getKeyForParams_=function(){var a=this,b=0,c=[];for(var d in a.params_)c[b++]=d+"-"+a.params_[d];return c.join("/")},b.prototype.getParams=function(){return this.params_},b.prototype.getRequestUrl_=function(a,b,c,d,e,g){var h=this.urls;if(!h)return void 0;var i=e.getCode().split(":").pop();g.SIZE=b[0]+","+b[1],g.BBOX=c.join(","),g.BBOXSR=i,g.IMAGESR=i,g.DPI=Math.round(g.DPI?g.DPI*d:90*d);var l;if(1==h.length)l=h[0];else{var m=f.modulo(j.hash(a),h.length);l=h[m]}var n=l.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return k.appendParams(n,g)},b.prototype.getTilePixelRatio=function(a){return a},b.prototype.fixedTileUrlFunction=function(a,b,c){var d=this.getTileGrid();if(d||(d=this.getTileGridForProjection(c)),d.getResolutions().length<=a[0])return void 0;var e=d.getTileCoordExtent(a,this.tmpExtent_),f=h.toSize(d.getTileSize(a[0]),this.tmpSize);1!=b&&(f=h.scale(f,b,this.tmpSize));var i={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return g.assign(i,this.params_),this.getRequestUrl_(a,f,e,b,c,i)},b.prototype.updateParams=function(a){g.assign(this.params_,a),this.setKey(this.getKeyForParams_())},b}(i.default),m=l;c.default=m},{"../extent.js":71,"../math.js":147,"../obj.js":149,"../size.js":226,"../source/TileImage.js":246,"../tilecoord.js":281,"../uri.js":288}],244:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Tile.js")),f=d(a("../TileState.js")),g=a("../dom.js"),h=a("../size.js"),i=d(a("../source/Tile.js")),j=a("../tilecoord.js"),k=function(a){function b(b,c,d){a.call(this,b,f.default.LOADED),this.tileSize_=c,this.text_=d,this.canvas_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var a=this.tileSize_,b=g.createCanvasContext2D(a[0],a[1]);return b.strokeStyle="black",b.strokeRect(.5,.5,a[0]+.5,a[1]+.5),b.fillStyle="black",b.textAlign="center",b.textBaseline="middle",b.font="24px sans-serif",b.fillText(this.text_,a[0]/2,a[1]/2),this.canvas_=b.canvas,b.canvas},b.prototype.load=function(){},b}(e.default),l=function(a){function b(b){a.call(this,{opaque:!1,projection:b.projection,tileGrid:b.tileGrid,wrapX:void 0!==b.wrapX?b.wrapX:!0})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getTile=function(a,b,c){var d=j.getKeyZXY(a,b,c);if(this.tileCache.containsKey(d))return this.tileCache.get(d);var e=h.toSize(this.tileGrid.getTileSize(a)),f=[a,b,c],g=this.getTileCoordForTileUrlFunction(f),i=g?this.getTileCoordForTileUrlFunction(g).toString():"",l=new k(f,e,i);return this.tileCache.set(d,l),l},b}(i.default),m=l;c.default=m},{"../Tile.js":34,"../TileState.js":38,"../dom.js":63,"../size.js":226,"../source/Tile.js":242,"../tilecoord.js":281}],245:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};c.default=d},{}],246:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){a.getImage().src=b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../reproj/common.js"),g=a("../util.js"),h=d(a("../ImageTile.js")),i=d(a("../TileCache.js")),j=d(a("../TileState.js")),k=a("../events.js"),l=d(a("../events/EventType.js")),m=a("../proj.js"),n=d(a("../reproj/Tile.js")),o=d(a("../source/UrlTile.js")),p=a("../tilecoord.js"),q=a("../tilegrid.js"),r=function(a){function b(b){a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,extent:b.extent,opaque:b.opaque,projection:b.projection,state:b.state,tileGrid:b.tileGrid,tileLoadFunction:b.tileLoadFunction?b.tileLoadFunction:e,tilePixelRatio:b.tilePixelRatio,tileUrlFunction:b.tileUrlFunction,url:b.url,urls:b.urls,wrapX:b.wrapX,transition:b.transition}),this.crossOrigin=void 0!==b.crossOrigin?b.crossOrigin:null,this.tileClass=void 0!==b.tileClass?b.tileClass:h.default,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=b.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.canExpireCache=function(){var b=this;if(!f.ENABLE_RASTER_REPROJECTION)return a.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var c in b.tileCacheForProjection)if(b.tileCacheForProjection[c].canExpireCache())return!0;return!1},b.prototype.expireCache=function(b,c){var d=this;if(!f.ENABLE_RASTER_REPROJECTION)return void a.prototype.expireCache.call(this,b,c);var e=this.getTileCacheForProjection(b);this.tileCache.expireCache(this.tileCache==e?c:{});for(var g in d.tileCacheForProjection){var h=d.tileCacheForProjection[g];h.expireCache(h==e?c:{})}},b.prototype.getGutterForProjection=function(a){return f.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&a&&!m.equivalent(this.getProjection(),a)?0:this.getGutter()},b.prototype.getGutter=function(){return 0},b.prototype.getOpaque=function(b){return f.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&b&&!m.equivalent(this.getProjection(),b)?!1:a.prototype.getOpaque.call(this,b)},b.prototype.getTileGridForProjection=function(b){if(!f.ENABLE_RASTER_REPROJECTION)return a.prototype.getTileGridForProjection.call(this,b);var c=this.getProjection();if(!this.tileGrid||c&&!m.equivalent(c,b)){var d=g.getUid(b).toString();return d in this.tileGridForProjection||(this.tileGridForProjection[d]=q.getForProjection(b)),this.tileGridForProjection[d]}return this.tileGrid},b.prototype.getTileCacheForProjection=function(b){if(!f.ENABLE_RASTER_REPROJECTION)return a.prototype.getTileCacheForProjection.call(this,b);var c=this.getProjection();if(!c||m.equivalent(c,b))return this.tileCache;var d=g.getUid(b).toString();return d in this.tileCacheForProjection||(this.tileCacheForProjection[d]=new i.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[d]},b.prototype.createTile_=function(a,b,c,d,e,f){var g=[a,b,c],h=this.getTileCoordForTileUrlFunction(g,e),i=h?this.tileUrlFunction(h,d,e):void 0,m=new this.tileClass(g,void 0!==i?j.default.IDLE:j.default.EMPTY,void 0!==i?i:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return m.key=f,k.listen(m,l.default.CHANGE,this.handleTileChange,this),m},b.prototype.getTile=function(a,b,c,d,e){var g=this.getProjection();if(f.ENABLE_RASTER_REPROJECTION&&g&&e&&!m.equivalent(g,e)){var h,i=this.getTileCacheForProjection(e),j=[a,b,c],k=p.getKey(j);i.containsKey(k)&&(h=i.get(k));var l=this.getKey();if(h&&h.key==l)return h;var o=this.getTileGridForProjection(g),q=this.getTileGridForProjection(e),r=this.getTileCoordForTileUrlFunction(j,e),s=new n.default(g,o,e,q,j,r,this.getTilePixelRatio(d),this.getGutter(),function(a,b,c,d){return this.getTileInternal(a,b,c,d,g)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return s.key=l,h?(s.interimTile=h,s.refreshInterimChain(),i.replace(k,s)):i.set(k,s),s}return this.getTileInternal(a,b,c,d,g||e)},b.prototype.getTileInternal=function(a,b,c,d,e){var f=null,g=p.getKeyZXY(a,b,c),h=this.getKey();if(this.tileCache.containsKey(g)){if(f=this.tileCache.get(g),f.key!=h){var i=f;f=this.createTile_(a,b,c,d,e,h),f.interimTile=i.getState()==j.default.IDLE?i.interimTile:i,f.refreshInterimChain(),this.tileCache.replace(g,f)}}else f=this.createTile_(a,b,c,d,e,h),this.tileCache.set(g,f);return f},b.prototype.setRenderReprojectionEdges=function(a){var b=this;if(f.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=a){this.renderReprojectionEdges_=a;for(var c in b.tileCacheForProjection)b.tileCacheForProjection[c].clear();this.changed()}},b.prototype.setTileGridForProjection=function(a,b){if(f.ENABLE_RASTER_REPROJECTION){var c=m.get(a);
if(c){var d=g.getUid(c).toString();d in this.tileGridForProjection||(this.tileGridForProjection[d]=b)}}},b}(o.default),s=r;c.default=s},{"../ImageTile.js":17,"../TileCache.js":35,"../TileState.js":38,"../events.js":65,"../events/EventType.js":67,"../proj.js":158,"../reproj/Tile.js":221,"../reproj/common.js":223,"../source/UrlTile.js":250,"../tilecoord.js":281,"../tilegrid.js":282,"../util.js":289}],247:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../tileurlfunction.js"),f=a("../asserts.js"),g=a("../extent.js"),h=a("../net.js"),i=a("../proj.js"),j=d(a("../source/State.js")),k=d(a("../source/TileImage.js")),l=a("../tilegrid.js"),m=function(a){function b(b){if(a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,crossOrigin:b.crossOrigin,projection:i.get("EPSG:3857"),reprojectionErrorThreshold:b.reprojectionErrorThreshold,state:j.default.LOADING,tileLoadFunction:b.tileLoadFunction,wrapX:void 0!==b.wrapX?b.wrapX:!0,transition:b.transition}),this.tileJSON_=null,b.url)if(b.jsonp)h.jsonp(b.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var c=new XMLHttpRequest;c.addEventListener("load",this.onXHRLoad_.bind(this)),c.addEventListener("error",this.onXHRError_.bind(this)),c.open("GET",b.url),c.send()}else b.tileJSON?this.handleTileJSONResponse(b.tileJSON):f.assert(!1,51)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onXHRLoad_=function(a){var b=a.target;if(!b.status||b.status>=200&&b.status<300){var c;try{c=JSON.parse(b.responseText)}catch(d){return void this.handleTileJSONError()}this.handleTileJSONResponse(c)}else this.handleTileJSONError()},b.prototype.onXHRError_=function(){this.handleTileJSONError()},b.prototype.getTileJSON=function(){return this.tileJSON_},b.prototype.handleTileJSONResponse=function(a){var b,c=i.get("EPSG:4326"),d=this.getProjection();if(void 0!==a.bounds){var f=i.getTransformFromProjections(c,d);b=g.applyTransform(a.bounds,f)}var h=a.minzoom||0,k=a.maxzoom||22,m=l.createXYZ({extent:l.extentFromProjection(d),maxZoom:k,minZoom:h});if(this.tileGrid=m,this.tileUrlFunction=e.createFromTemplates(a.tiles,m),void 0!==a.attribution&&!this.getAttributions()){var n=void 0!==b?b:c.getExtent();this.setAttributions(function(b){return g.intersects(n,b.extent)?[a.attribution]:null})}this.tileJSON_=a,this.setState(j.default.READY)},b.prototype.handleTileJSONError=function(){this.setState(j.default.ERROR)},b}(k.default),n=m;c.default=n},{"../asserts.js":46,"../extent.js":71,"../net.js":148,"../proj.js":158,"../source/State.js":241,"../source/TileImage.js":246,"../tilegrid.js":282,"../tileurlfunction.js":286}],248:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=a("../asserts.js"),g=a("../extent.js"),h=a("../obj.js"),i=a("../math.js"),j=a("../proj.js"),k=a("../reproj.js"),l=a("../size.js"),m=d(a("../source/TileImage.js")),n=d(a("../source/WMSServerType.js")),o=a("../tilecoord.js"),p=a("../string.js"),q=a("../uri.js"),r=function(a){function b(b){var c=b||{},d=c.params||{},e="TRANSPARENT"in d?d.TRANSPARENT:!0;a.call(this,{attributions:c.attributions,cacheSize:c.cacheSize,crossOrigin:c.crossOrigin,opaque:!e,projection:c.projection,reprojectionErrorThreshold:c.reprojectionErrorThreshold,tileClass:c.tileClass,tileGrid:c.tileGrid,tileLoadFunction:c.tileLoadFunction,url:c.url,urls:c.urls,wrapX:void 0!==c.wrapX?c.wrapX:!0,transition:c.transition}),this.gutter_=void 0!==c.gutter?c.gutter:0,this.params_=d,this.v13_=!0,this.serverType_=c.serverType,this.hidpi_=void 0!==c.hidpi?c.hidpi:!0,this.tmpExtent_=g.createEmpty(),this.updateV13_(),this.setKey(this.getKeyForParams_())}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getGetFeatureInfoUrl=function(a,b,c,d){var f=j.get(c),i=this.getProjection(),m=this.getTileGrid();m||(m=this.getTileGridForProjection(f));var n=m.getTileCoordForCoordAndResolution(a,b);if(m.getResolutions().length<=n[0])return void 0;var o=m.getResolution(n[0]),p=m.getTileCoordExtent(n,this.tmpExtent_),q=l.toSize(m.getTileSize(n[0]),this.tmpSize),r=this.gutter_;0!==r&&(q=l.buffer(q,r,this.tmpSize),p=g.buffer(p,o*r,p)),i&&i!==f&&(o=k.calculateSourceResolution(i,f,a,o),p=j.transformExtent(p,f,i),a=j.transform(a,f,i));var s={SERVICE:"WMS",VERSION:e.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};h.assign(s,this.params_,d);var t=Math.floor((a[0]-p[0])/o),u=Math.floor((p[3]-a[1])/o);return s[this.v13_?"I":"X"]=t,s[this.v13_?"J":"Y"]=u,this.getRequestUrl_(n,q,p,1,i||f,s)},b.prototype.getGutter=function(){return this.gutter_},b.prototype.getParams=function(){return this.params_},b.prototype.getRequestUrl_=function(a,b,c,d,e,g){var h=this.urls;if(!h)return void 0;if(g.WIDTH=b[0],g.HEIGHT=b[1],g[this.v13_?"CRS":"SRS"]=e.getCode(),"STYLES"in this.params_||(g.STYLES=""),1!=d)switch(this.serverType_){case n.default.GEOSERVER:var j=90*d+.5|0;"FORMAT_OPTIONS"in g?g.FORMAT_OPTIONS+=";dpi:"+j:g.FORMAT_OPTIONS="dpi:"+j;break;case n.default.MAPSERVER:g.MAP_RESOLUTION=90*d;break;case n.default.CARMENTA_SERVER:case n.default.QGIS:g.DPI=90*d;break;default:f.assert(!1,52)}var k=e.getAxisOrientation(),l=c;if(this.v13_&&"ne"==k.substr(0,2)){var m;m=c[0],l[0]=c[1],l[1]=m,m=c[2],l[2]=c[3],l[3]=m}g.BBOX=l.join(",");var p;if(1==h.length)p=h[0];else{var r=i.modulo(o.hash(a),h.length);p=h[r]}return q.appendParams(p,g)},b.prototype.getTilePixelRatio=function(a){return this.hidpi_&&void 0!==this.serverType_?a:1},b.prototype.getKeyForParams_=function(){var a=this,b=0,c=[];for(var d in a.params_)c[b++]=d+"-"+a.params_[d];return c.join("/")},b.prototype.fixedTileUrlFunction=function(a,b,c){var d=this.getTileGrid();if(d||(d=this.getTileGridForProjection(c)),d.getResolutions().length<=a[0])return void 0;1==b||this.hidpi_&&void 0!==this.serverType_||(b=1);var f=d.getResolution(a[0]),i=d.getTileCoordExtent(a,this.tmpExtent_),j=l.toSize(d.getTileSize(a[0]),this.tmpSize),k=this.gutter_;0!==k&&(j=l.buffer(j,k,this.tmpSize),i=g.buffer(i,f*k,i)),1!=b&&(j=l.scale(j,b,this.tmpSize));var m={SERVICE:"WMS",VERSION:e.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return h.assign(m,this.params_),this.getRequestUrl_(a,j,i,b,c,m)},b.prototype.updateParams=function(a){h.assign(this.params_,a),this.updateV13_(),this.setKey(this.getKeyForParams_())},b.prototype.updateV13_=function(){var a=this.params_.VERSION||e.DEFAULT_WMS_VERSION;this.v13_=p.compareVersions(a,"1.3")>=0},b}(m.default),s=r;c.default=s},{"../asserts.js":46,"../extent.js":71,"../math.js":147,"../obj.js":149,"../proj.js":158,"../reproj.js":219,"../size.js":226,"../source/TileImage.js":246,"../source/WMSServerType.js":253,"../string.js":260,"../tilecoord.js":281,"../uri.js":288,"./common.js":258}],249:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.CustomTile=void 0;var e=d(a("../Tile.js")),f=d(a("../TileState.js")),g=a("../tileurlfunction.js"),h=a("../asserts.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../extent.js"),l=a("../net.js"),m=a("../proj.js"),n=d(a("../source/State.js")),o=d(a("../source/Tile.js")),p=a("../tilecoord.js"),q=a("../tilegrid.js"),r=function(a){function b(b,c,d,e,f,g){a.call(this,b,c),this.src_=d,this.extent_=e,this.preemptive_=f,this.grid_=null,this.keys_=null,this.data_=null,this.jsonp_=g}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){return null},b.prototype.getData=function(a){if(!this.grid_||!this.keys_)return null;var b=(a[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),c=(a[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),d=this.grid_[Math.floor((1-c)*this.grid_.length)];if("string"!=typeof d)return null;var e=d.charCodeAt(Math.floor(b*d.length));e>=93&&e--,e>=35&&e--,e-=32;var f=null;if(e in this.keys_){var g=this.keys_[e];f=this.data_&&g in this.data_?this.data_[g]:g}return f},b.prototype.forDataAtCoordinate=function(a,b,c,d){this.state==f.default.IDLE&&d===!0?(i.listenOnce(this,j.default.CHANGE,function(){b.call(c,this.getData(a))},this),this.loadInternal_()):d===!0?setTimeout(function(){b.call(c,this.getData(a))}.bind(this),0):b.call(c,this.getData(a))},b.prototype.getKey=function(){return this.src_},b.prototype.handleError_=function(){this.state=f.default.ERROR,this.changed()},b.prototype.handleLoad_=function(a){this.grid_=a.grid,this.keys_=a.keys,this.data_=a.data,this.state=f.default.EMPTY,this.changed()},b.prototype.loadInternal_=function(){if(this.state==f.default.IDLE)if(this.state=f.default.LOADING,this.jsonp_)l.jsonp(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var a=new XMLHttpRequest;a.addEventListener("load",this.onXHRLoad_.bind(this)),a.addEventListener("error",this.onXHRError_.bind(this)),a.open("GET",this.src_),a.send()}},b.prototype.onXHRLoad_=function(a){var b=a.target;if(!b.status||b.status>=200&&b.status<300){var c;try{c=JSON.parse(b.responseText)}catch(d){return void this.handleError_()}this.handleLoad_(c)}else this.handleError_()},b.prototype.onXHRError_=function(){this.handleError_()},b.prototype.load=function(){this.preemptive_&&this.loadInternal_()},b}(e.default);c.CustomTile=r;var s=function(a){function b(b){if(a.call(this,{projection:m.get("EPSG:3857"),state:n.default.LOADING}),this.preemptive_=void 0!==b.preemptive?b.preemptive:!0,this.tileUrlFunction_=g.nullTileUrlFunction,this.template_=void 0,this.jsonp_=b.jsonp||!1,b.url)if(this.jsonp_)l.jsonp(b.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var c=new XMLHttpRequest;c.addEventListener("load",this.onXHRLoad_.bind(this)),c.addEventListener("error",this.onXHRError_.bind(this)),c.open("GET",b.url),c.send()}else b.tileJSON?this.handleTileJSONResponse(b.tileJSON):h.assert(!1,51)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onXHRLoad_=function(a){var b=a.target;if(!b.status||b.status>=200&&b.status<300){var c;try{c=JSON.parse(b.responseText)}catch(d){return void this.handleTileJSONError()}this.handleTileJSONResponse(c)}else this.handleTileJSONError()},b.prototype.onXHRError_=function(){this.handleTileJSONError()},b.prototype.getTemplate=function(){return this.template_},b.prototype.forDataAtCoordinateAndResolution=function(a,b,c,d){if(this.tileGrid){var e=this.tileGrid.getTileCoordForCoordAndResolution(a,b),f=this.getTile(e[0],e[1],e[2],1,this.getProjection());f.forDataAtCoordinate(a,c,null,d)}else d===!0?setTimeout(function(){c(null)},0):c(null)},b.prototype.handleTileJSONError=function(){this.setState(n.default.ERROR)},b.prototype.handleTileJSONResponse=function(a){var b,c=m.get("EPSG:4326"),d=this.getProjection();if(void 0!==a.bounds){var e=m.getTransformFromProjections(c,d);b=k.applyTransform(a.bounds,e)}var f=a.minzoom||0,h=a.maxzoom||22,i=q.createXYZ({extent:q.extentFromProjection(d),maxZoom:h,minZoom:f});this.tileGrid=i,this.template_=a.template;var j=a.grids;if(!j)return void this.setState(n.default.ERROR);if(this.tileUrlFunction_=g.createFromTemplates(j,i),void 0!==a.attribution){var l=void 0!==b?b:c.getExtent();this.setAttributions(function(b){return k.intersects(l,b.extent)?[a.attribution]:null})}this.setState(n.default.READY)},b.prototype.getTile=function(a,b,c,d,e){var g=p.getKeyZXY(a,b,c);if(this.tileCache.containsKey(g))return this.tileCache.get(g);var h=[a,b,c],i=this.getTileCoordForTileUrlFunction(h,e),j=this.tileUrlFunction_(i,d,e),k=new r(h,void 0!==j?f.default.IDLE:f.default.EMPTY,void 0!==j?j:"",this.tileGrid.getTileCoordExtent(h),this.preemptive_,this.jsonp_);return this.tileCache.set(g,k),k},b.prototype.useTile=function(a,b,c){var d=p.getKeyZXY(a,b,c);this.tileCache.containsKey(d)&&this.tileCache.get(d)},b}(o.default),t=s;c.default=t},{"../Tile.js":34,"../TileState.js":38,"../asserts.js":46,"../events.js":65,"../events/EventType.js":67,"../extent.js":71,"../net.js":148,"../proj.js":158,"../source/State.js":241,"../source/Tile.js":242,"../tilecoord.js":281,"../tilegrid.js":282,"../tileurlfunction.js":286}],250:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../util.js"),g=e(a("../TileState.js")),h=a("../tileurlfunction.js"),i=d(a("../source/Tile.js")),j=e(a("../source/TileEventType.js")),k=a("../tilecoord.js"),l=function(a){function b(b){a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,extent:b.extent,opaque:b.opaque,projection:b.projection,state:b.state,tileGrid:b.tileGrid,tilePixelRatio:b.tilePixelRatio,wrapX:b.wrapX,transition:b.transition}),this.tileLoadFunction=b.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):h.nullTileUrlFunction,this.urls=null,b.urls?this.setUrls(b.urls):b.url&&this.setUrl(b.url),b.tileUrlFunction&&this.setTileUrlFunction(b.tileUrlFunction),this.tileLoadingKeys_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},b.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},b.prototype.getUrls=function(){return this.urls},b.prototype.handleTileChange=function(a){var b,c=a.target,d=f.getUid(c),e=c.getState();e==g.default.LOADING?(this.tileLoadingKeys_[d]=!0,b=j.default.TILELOADSTART):d in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[d],b=e==g.default.ERROR?j.default.TILELOADERROR:e==g.default.LOADED||e==g.default.ABORT?j.default.TILELOADEND:void 0),void 0!=b&&this.dispatchEvent(new i.TileSourceEvent(b,c))},b.prototype.setTileLoadFunction=function(a){this.tileCache.clear(),this.tileLoadFunction=a,this.changed()},b.prototype.setTileUrlFunction=function(a,b){this.tileUrlFunction=a,this.tileCache.pruneExceptNewestZ(),"undefined"!=typeof b?this.setKey(b):this.changed()},b.prototype.setUrl=function(a){var b=this.urls=h.expandUrl(a);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):h.createFromTemplates(b,this.tileGrid),a)},b.prototype.setUrls=function(a){this.urls=a;var b=a.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):h.createFromTemplates(a,this.tileGrid),b)},b.prototype.useTile=function(a,b,c){var d=k.getKeyZXY(a,b,c);this.tileCache.containsKey(d)&&this.tileCache.get(d)},b}(i.default);l.prototype.fixedTileUrlFunction;var m=l;c.default=m},{"../TileState.js":38,"../source/Tile.js":242,"../source/TileEventType.js":245,"../tilecoord.js":281,"../tileurlfunction.js":286,"../util.js":289}],251:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.VectorSourceEvent=void 0;var e=a("../util.js"),f=d(a("../Collection.js")),g=d(a("../CollectionEventType.js")),h=d(a("../ObjectEventType.js")),i=a("../array.js"),j=a("../asserts.js"),k=a("../events.js"),l=d(a("../events/Event.js")),m=d(a("../events/EventType.js")),n=a("../extent.js"),o=a("../featureloader.js"),p=a("../functions.js"),q=a("../loadingstrategy.js"),r=a("../obj.js"),s=d(a("../source/Source.js")),t=d(a("../source/State.js")),u=d(a("../source/VectorEventType.js")),v=d(a("../structs/RBush.js")),w=function(a){function b(b,c){a.call(this,b),this.feature=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default);c.VectorSourceEvent=w;var x=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,projection:void 0,state:t.default.READY,wrapX:void 0!==c.wrapX?c.wrapX:!0}),this.loader_=p.VOID,this.format_=c.format,this.overlaps_=void 0==c.overlaps?!0:c.overlaps,this.url_=c.url,void 0!==c.loader?this.loader_=c.loader:void 0!==this.url_&&(j.assert(this.format_,7),this.loader_=o.xhr(this.url_,this.format_)),this.strategy_=void 0!==c.strategy?c.strategy:q.all;var d=void 0!==c.useSpatialIndex?c.useSpatialIndex:!0;this.featuresRtree_=d?new v.default:null,this.loadedExtentsRtree_=new v.default,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;var e,g;c.features instanceof f.default?(e=c.features,g=e.getArray()):Array.isArray(c.features)&&(g=c.features),d||void 0!==e||(e=new f.default(g)),void 0!==g&&this.addFeaturesInternal(g),void 0!==e&&this.bindFeaturesCollection_(e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a){this.addFeatureInternal(a),this.changed()},b.prototype.addFeatureInternal=function(a){var b=e.getUid(a).toString();if(this.addToIndex_(b,a)){this.setupChangeEvents_(b,a);var c=a.getGeometry();if(c){var d=c.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(d,a)}else this.nullGeometryFeatures_[b]=a;this.dispatchEvent(new w(u.default.ADDFEATURE,a))}},b.prototype.setupChangeEvents_=function(a,b){this.featureChangeKeys_[a]=[k.listen(b,m.default.CHANGE,this.handleFeatureChange_,this),k.listen(b,h.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]},b.prototype.addToIndex_=function(a,b){var c=!0,d=b.getId();return void 0!==d?d.toString()in this.idIndex_?c=!1:this.idIndex_[d.toString()]=b:(j.assert(!(a in this.undefIdIndex_),30),this.undefIdIndex_[a]=b),c},b.prototype.addFeatures=function(a){this.addFeaturesInternal(a),this.changed()},b.prototype.addFeaturesInternal=function(a){for(var b=this,c=[],d=[],f=[],g=0,h=a.length;h>g;g++){var i=a[g],j=e.getUid(i).toString();b.addToIndex_(j,i)&&d.push(i)}for(var k=0,l=d.length;l>k;k++){var m=d[k],n=e.getUid(m).toString();b.setupChangeEvents_(n,m);var o=m.getGeometry();if(o){var p=o.getExtent();c.push(p),f.push(m)}else b.nullGeometryFeatures_[n]=m}this.featuresRtree_&&this.featuresRtree_.load(c,f);for(var q=0,r=d.length;r>q;q++)b.dispatchEvent(new w(u.default.ADDFEATURE,d[q]))},b.prototype.bindFeaturesCollection_=function(a){var b=!1;k.listen(this,u.default.ADDFEATURE,function(c){b||(b=!0,a.push(c.feature),b=!1)}),k.listen(this,u.default.REMOVEFEATURE,function(c){b||(b=!0,a.remove(c.feature),b=!1)}),k.listen(a,g.default.ADD,function(a){b||(b=!0,this.addFeature(a.element),b=!1)},this),k.listen(a,g.default.REMOVE,function(a){b||(b=!0,this.removeFeature(a.element),b=!1)},this),this.featuresCollection_=a},b.prototype.clear=function(a){var b=this;if(a){for(var c in b.featureChangeKeys_){var d=b.featureChangeKeys_[c];d.forEach(k.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(var e in b.nullGeometryFeatures_)b.removeFeatureInternal(b.nullGeometryFeatures_[e])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var f=new w(u.default.CLEAR);this.dispatchEvent(f),this.changed()},b.prototype.forEachFeature=function(a){return this.featuresRtree_?this.featuresRtree_.forEach(a):this.featuresCollection_?this.featuresCollection_.forEach(a):void 0},b.prototype.forEachFeatureAtCoordinateDirect=function(a,b){var c=[a[0],a[1],a[0],a[1]];return this.forEachFeatureInExtent(c,function(c){var d=c.getGeometry();return d.intersectsCoordinate(a)?b(c):void 0})},b.prototype.forEachFeatureInExtent=function(a,b){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(a,b):this.featuresCollection_?this.featuresCollection_.forEach(b):void 0},b.prototype.forEachFeatureIntersectingExtent=function(a,b){return this.forEachFeatureInExtent(a,function(c){var d=c.getGeometry();if(d.intersectsExtent(a)){var e=b(c);if(e)return e}})},b.prototype.getFeaturesCollection=function(){return this.featuresCollection_},b.prototype.getFeatures=function(){var a;return this.featuresCollection_?a=this.featuresCollection_.getArray():this.featuresRtree_&&(a=this.featuresRtree_.getAll(),r.isEmpty(this.nullGeometryFeatures_)||i.extend(a,r.getValues(this.nullGeometryFeatures_))),a},b.prototype.getFeaturesAtCoordinate=function(a){var b=[];return this.forEachFeatureAtCoordinateDirect(a,function(a){b.push(a)}),b},b.prototype.getFeaturesInExtent=function(a){return this.featuresRtree_.getInExtent(a)},b.prototype.getClosestFeatureToCoordinate=function(a,b){var c=a[0],d=a[1],e=null,f=[0/0,0/0],g=1/0,h=[-1/0,-1/0,1/0,1/0],i=b?b:p.TRUE;return this.featuresRtree_.forEachInExtent(h,function(a){if(i(a)){var b=a.getGeometry(),j=g;if(g=b.closestPointXY(c,d,f,g),j>g){e=a;var k=Math.sqrt(g);h[0]=c-k,h[1]=d-k,h[2]=c+k,h[3]=d+k}}}),e},b.prototype.getExtent=function(a){return this.featuresRtree_.getExtent(a)},b.prototype.getFeatureById=function(a){var b=this.idIndex_[a.toString()];return void 0!==b?b:null},b.prototype.getFormat=function(){return this.format_},b.prototype.getOverlaps=function(){return this.overlaps_},b.prototype.getResolutions=function(){},b.prototype.getUrl=function(){return this.url_},b.prototype.handleFeatureChange_=function(a){var b=a.target,c=e.getUid(b).toString(),d=b.getGeometry();if(d){var f=d.getExtent();c in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[c],this.featuresRtree_&&this.featuresRtree_.insert(f,b)):this.featuresRtree_&&this.featuresRtree_.update(f,b)}else c in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(b),this.nullGeometryFeatures_[c]=b);var g=b.getId();if(void 0!==g){var h=g.toString();c in this.undefIdIndex_?(delete this.undefIdIndex_[c],this.idIndex_[h]=b):this.idIndex_[h]!==b&&(this.removeFromIdIndex_(b),this.idIndex_[h]=b)}else c in this.undefIdIndex_||(this.removeFromIdIndex_(b),this.undefIdIndex_[c]=b);this.changed(),this.dispatchEvent(new w(u.default.CHANGEFEATURE,b))},b.prototype.hasFeature=function(a){var b=a.getId();if(void 0!==b)return b in this.idIndex_;var c=e.getUid(a).toString();return c in this.undefIdIndex_},b.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&r.isEmpty(this.nullGeometryFeatures_)},b.prototype.loadFeatures=function(a,b,c){var d=this,e=this.loadedExtentsRtree_,f=this.strategy_(a,b);this.loading=!1;for(var g=function(a){var g=f[a],h=e.forEachInExtent(g,function(a){return n.containsExtent(a.extent,g)});h||(d.loader_.call(d,g,b,c),e.insert(g,{extent:g.slice()}),d.loading=!0)},h=0,i=f.length;i>h;++h)g(h,i)},b.prototype.removeLoadedExtent=function(a){var b,c=this.loadedExtentsRtree_;c.forEachInExtent(a,function(c){return n.equals(c.extent,a)?(b=c,!0):void 0}),b&&c.remove(b)},b.prototype.removeFeature=function(a){var b=e.getUid(a).toString();b in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[b]:this.featuresRtree_&&this.featuresRtree_.remove(a),this.removeFeatureInternal(a),this.changed()},b.prototype.removeFeatureInternal=function(a){var b=e.getUid(a).toString();this.featureChangeKeys_[b].forEach(k.unlistenByKey),delete this.featureChangeKeys_[b];var c=a.getId();void 0!==c?delete this.idIndex_[c.toString()]:delete this.undefIdIndex_[b],this.dispatchEvent(new w(u.default.REMOVEFEATURE,a))},b.prototype.removeFromIdIndex_=function(a){var b=this,c=!1;for(var d in b.idIndex_)if(b.idIndex_[d]===a){delete b.idIndex_[d],c=!0;break}return c},b.prototype.setLoader=function(a){this.loader_=a},b}(s.default),y=x;c.default=y},{"../Collection.js":6,"../CollectionEventType.js":7,"../ObjectEventType.js":29,"../array.js":45,"../asserts.js":46,"../events.js":65,"../events/Event.js":66,"../events/EventType.js":67,"../extent.js":71,"../featureloader.js":74,"../functions.js":76,"../loadingstrategy.js":146,"../obj.js":149,"../source/Source.js":239,"../source/State.js":241,"../source/VectorEventType.js":252,"../structs/RBush.js":264,"../util.js":289}],252:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};c.default=d},{}],253:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};c.default=d},{}],254:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=a.Contents.Layer,d=h.find(c,function(a){return a.Identifier==b.layer});if(null===d)return null;var e,f=a.Contents.TileMatrixSet;e=d.TileMatrixSetLink.length>1?"projection"in b?h.findIndex(d.TileMatrixSetLink,function(a){var c=h.find(f,function(b){return b.Identifier==a.TileMatrixSet}),d=c.SupportedCRS,e=k.get(d.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||k.get(d),g=k.get(b.projection);return e&&g?k.equivalent(e,g):d==b.projection}):h.findIndex(d.TileMatrixSetLink,function(a){return a.TileMatrixSet==b.matrixSet}):0,0>e&&(e=0);var g=d.TileMatrixSetLink[e].TileMatrixSet,j=d.TileMatrixSetLink[e].TileMatrixSetLimits,l=d.Format[0];"format"in b&&(l=b.format),e=h.findIndex(d.Style,function(a){return"style"in b?a.Title==b.style:a.isDefault}),0>e&&(e=0);var o=d.Style[e].Identifier,p={};"Dimension"in d&&d.Dimension.forEach(function(a){var b=a.Identifier,c=a.Default;void 0===c&&(c=a.Value[0]),p[b]=c});var q,r=a.Contents.TileMatrixSet,s=h.find(r,function(a){return a.Identifier==g}),t=s.SupportedCRS;if(t&&(q=k.get(t.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||k.get(t)),"projection"in b){var u=k.get(b.projection);u&&(!q||k.equivalent(u,q))&&(q=u)}var v,w,x=d.WGS84BoundingBox;if(void 0!==x){var y=k.get("EPSG:4326").getExtent();w=x[0]==y[0]&&x[2]==y[2],v=k.transformExtent(x,"EPSG:4326",q);var z=q.getExtent();z&&(i.containsExtent(z,v)||(v=void 0))}var A=n.createFromCapabilitiesMatrixSet(s,v,j),B=[],C=b.requestEncoding;if(C=void 0!==C?C:"","OperationsMetadata"in a&&"GetTile"in a.OperationsMetadata)for(var D=a.OperationsMetadata.GetTile.DCP.HTTP.Get,E=0,F=D.length;F>E;++E)if(D[E].Constraint){var G=h.find(D[E].Constraint,function(a){return"GetEncoding"==a.name}),H=G.AllowedValues.Value;if(""===C&&(C=H[0]),C!==m.default.KVP)break;h.includes(H,m.default.KVP)&&B.push(D[E].href)}else D[E].href&&(C=m.default.KVP,B.push(D[E].href));return 0===B.length&&(C=m.default.REST,d.ResourceURL.forEach(function(a){"tile"===a.resourceType&&(l=a.format,B.push(a.template))})),{urls:B,layer:b.layer,matrixSet:g,format:l,projection:q,requestEncoding:C,tileGrid:A,style:o,dimensions:p,wrapX:w,crossOrigin:b.crossOrigin}}function f(a){var b=this.requestEncoding_,c={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};b==m.default.KVP&&j.assign(c,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),a=b==m.default.KVP?o.appendParams(a,c):a.replace(/\{(\w+?)\}/g,function(a,b){return b.toLowerCase()in c?c[b.toLowerCase()]:a});var d=this.tileGrid,e=this.dimensions_;return function(c){if(c){var f={TileMatrix:d.getMatrixId(c[0]),TileCol:c[1],TileRow:-c[2]-1};j.assign(f,e);var g=a;return g=b==m.default.KVP?o.appendParams(g,f):g.replace(/\{(\w+?)\}/g,function(a,b){return f[b]})}return void 0}}Object.defineProperty(c,"__esModule",{value:!0}),c.optionsFromCapabilities=e,c.default=void 0;var g=a("../tileurlfunction.js"),h=a("../array.js"),i=a("../extent.js"),j=a("../obj.js"),k=a("../proj.js"),l=d(a("../source/TileImage.js")),m=d(a("../source/WMTSRequestEncoding.js")),n=a("../tilegrid/WMTS.js"),o=a("../uri.js"),p=function(a){function b(b){var c=void 0!==b.requestEncoding?b.requestEncoding:m.default.KVP,d=b.tileGrid,e=b.urls;void 0===e&&void 0!==b.url&&(e=g.expandUrl(b.url)),a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,crossOrigin:b.crossOrigin,projection:b.projection,reprojectionErrorThreshold:b.reprojectionErrorThreshold,tileClass:b.tileClass,tileGrid:d,tileLoadFunction:b.tileLoadFunction,tilePixelRatio:b.tilePixelRatio,tileUrlFunction:g.nullTileUrlFunction,urls:e,wrapX:void 0!==b.wrapX?b.wrapX:!1,transition:b.transition}),this.version_=void 0!==b.version?b.version:"1.0.0",this.format_=void 0!==b.format?b.format:"image/jpeg",this.dimensions_=void 0!==b.dimensions?b.dimensions:{},this.layer_=b.layer,this.matrixSet_=b.matrixSet,this.style_=b.style,this.requestEncoding_=c,this.setKey(this.getKeyForDimensions_()),e&&e.length>0&&(this.tileUrlFunction=g.createFromTileUrlFunctions(e.map(f.bind(this))))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setUrls=function(a){this.urls=a;var b=a.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):g.createFromTileUrlFunctions(a.map(f.bind(this))),b)},b.prototype.getDimensions=function(){return this.dimensions_},b.prototype.getFormat=function(){return this.format_},b.prototype.getLayer=function(){return this.layer_},b.prototype.getMatrixSet=function(){return this.matrixSet_},b.prototype.getRequestEncoding=function(){return this.requestEncoding_},b.prototype.getStyle=function(){return this.style_},b.prototype.getVersion=function(){return this.version_},b.prototype.getKeyForDimensions_=function(){var a=this,b=0,c=[];for(var d in a.dimensions_)c[b++]=d+"-"+a.dimensions_[d];return c.join("/")},b.prototype.updateDimensions=function(a){j.assign(this.dimensions_,a),this.setKey(this.getKeyForDimensions_())},b}(l.default),q=p;c.default=q},{"../array.js":45,"../extent.js":71,"../obj.js":149,"../proj.js":158,"../source/TileImage.js":246,"../source/WMTSRequestEncoding.js":255,"../tilegrid/WMTS.js":284,"../tileurlfunction.js":286,"../uri.js":288}],255:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={KVP:"KVP",REST:"REST"};c.default=d},{}],256:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../source/TileImage.js")),f=a("../tilegrid.js"),g=function(a){function b(b){var c=b||{},d=void 0!==c.projection?c.projection:"EPSG:3857",e=void 0!==c.tileGrid?c.tileGrid:f.createXYZ({extent:f.extentFromProjection(d),maxZoom:c.maxZoom,minZoom:c.minZoom,tileSize:c.tileSize});a.call(this,{attributions:c.attributions,cacheSize:c.cacheSize,crossOrigin:c.crossOrigin,opaque:c.opaque,projection:d,reprojectionErrorThreshold:c.reprojectionErrorThreshold,tileGrid:e,tileLoadFunction:c.tileLoadFunction,tilePixelRatio:c.tilePixelRatio,tileUrlFunction:c.tileUrlFunction,url:c.url,urls:c.urls,wrapX:void 0!==c.wrapX?c.wrapX:!0,transition:c.transition})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),h=g;c.default=h},{"../source/TileImage.js":246,"../tilegrid.js":282}],257:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.CustomTile=void 0;var e=a("../tilegrid/common.js"),f=d(a("../ImageTile.js")),g=d(a("../TileState.js")),h=a("../tileurlfunction.js"),i=a("../asserts.js"),j=a("../dom.js"),k=a("../extent.js"),l=a("../size.js"),m=d(a("../source/TileImage.js")),n=d(a("../tilegrid/TileGrid.js")),o={DEFAULT:"default",TRUNCATED:"truncated"},p=function(a){function b(b,c,d,e,f,g,h){a.call(this,c,d,e,f,g,h),this.zoomifyImage_=null,this.tileSize_=l.toSize(b.getTileSize(c[0]))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var b=a.prototype.getImage.call(this);if(this.state==g.default.LOADED){var c=this.tileSize_;
if(b.width==c[0]&&b.height==c[1])return this.zoomifyImage_=b,b;var d=j.createCanvasContext2D(c[0],c[1]);return d.drawImage(b,0,0),this.zoomifyImage_=d.canvas,d.canvas}return b},b}(f.default);c.CustomTile=p;var q=function(a){function b(b){function c(a){return function(b){if(b){var c=b[0],d=b[1],e=-b[2]-1,f=d+e*q[c][0],g=z.getTileSize(c),h=(f+w[c])/g|0,i={z:c,x:d,y:e,tileIndex:f,TileGroup:"TileGroup"+h};return a.replace(/\{(\w+?)\}/g,function(a,b){return i[b]})}return void 0}}var d=b||{},f=d.size,g=void 0!==d.tierSizeCalculation?d.tierSizeCalculation:o.DEFAULT,j=f[0],l=f[1],m=d.extent||[0,-f[1],f[0],0],q=[],r=d.tileSize||e.DEFAULT_TILE_SIZE,s=r;switch(g){case o.DEFAULT:for(;j>s||l>s;)q.push([Math.ceil(j/s),Math.ceil(l/s)]),s+=s;break;case o.TRUNCATED:for(var t=j,u=l;t>s||u>s;)q.push([Math.ceil(t/s),Math.ceil(u/s)]),t>>=1,u>>=1;break;default:i.assert(!1,53)}q.push([1,1]),q.reverse();for(var v=[1],w=[0],x=1,y=q.length;y>x;x++)v.push(1<<x),w.push(q[x-1][0]*q[x-1][1]+w[x-1]);v.reverse();var z=new n.default({tileSize:r,extent:m,origin:k.getTopLeft(m),resolutions:v}),A=d.url;A&&-1==A.indexOf("{TileGroup}")&&-1==A.indexOf("{tileIndex}")&&(A+="{TileGroup}/{z}-{x}-{y}.jpg");var B=h.expandUrl(A),C=h.createFromTileUrlFunctions(B.map(c)),D=p.bind(null,z);a.call(this,{attributions:d.attributions,cacheSize:d.cacheSize,crossOrigin:d.crossOrigin,projection:d.projection,reprojectionErrorThreshold:d.reprojectionErrorThreshold,tileClass:D,tileGrid:z,tileUrlFunction:C,transition:d.transition})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m.default),r=q;c.default=r},{"../ImageTile.js":17,"../TileState.js":38,"../asserts.js":46,"../dom.js":63,"../extent.js":71,"../size.js":226,"../source/TileImage.js":246,"../tilegrid/TileGrid.js":283,"../tilegrid/common.js":285,"../tileurlfunction.js":286}],258:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_WMS_VERSION=void 0;var d="1.3.0";c.DEFAULT_WMS_VERSION=d},{}],259:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=c||m,e=k.toRadians(a[1]),f=k.toRadians(b[1]),g=(f-e)/2,h=k.toRadians(b[0]-a[0])/2,i=Math.sin(g)*Math.sin(g)+Math.sin(h)*Math.sin(h)*Math.cos(e)*Math.cos(f);return 2*d*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function f(a,b){for(var c=0,d=0,f=a.length;f-1>d;++d)c+=e(a[d],a[d+1],b);return c}function g(a,b){var c=b||{},d=c.radius||m,e=c.projection||"EPSG:3857",h=a.getType();h!==l.default.GEOMETRY_COLLECTION&&(a=a.clone().transform(e,"EPSG:4326"));var i,j,k,n,o,p,q=0;switch(h){case l.default.POINT:case l.default.MULTI_POINT:break;case l.default.LINE_STRING:case l.default.LINEAR_RING:i=a.getCoordinates(),q=f(i,d);break;case l.default.MULTI_LINE_STRING:case l.default.POLYGON:for(i=a.getCoordinates(),k=0,n=i.length;n>k;++k)q+=f(i[k],d);break;case l.default.MULTI_POLYGON:for(i=a.getCoordinates(),k=0,n=i.length;n>k;++k)for(j=i[k],o=0,p=j.length;p>o;++o)q+=f(j[o],d);break;case l.default.GEOMETRY_COLLECTION:var r=a.getGeometries();for(k=0,n=r.length;n>k;++k)q+=g(r[k],b);break;default:throw new Error("Unsupported geometry type: "+h)}return q}function h(a,b){for(var c=0,d=a.length,e=a[d-1][0],f=a[d-1][1],g=0;d>g;g++){var h=a[g][0],i=a[g][1];c+=k.toRadians(h-e)*(2+Math.sin(k.toRadians(f))+Math.sin(k.toRadians(i))),e=h,f=i}return c*b*b/2}function i(a,b){var c=b||{},d=c.radius||m,e=c.projection||"EPSG:3857",f=a.getType();f!==l.default.GEOMETRY_COLLECTION&&(a=a.clone().transform(e,"EPSG:4326"));var g,j,k,n,o,p,q=0;switch(f){case l.default.POINT:case l.default.MULTI_POINT:case l.default.LINE_STRING:case l.default.MULTI_LINE_STRING:case l.default.LINEAR_RING:break;case l.default.POLYGON:for(g=a.getCoordinates(),q=Math.abs(h(g[0],d)),k=1,n=g.length;n>k;++k)q-=Math.abs(h(g[k],d));break;case l.default.MULTI_POLYGON:for(g=a.getCoordinates(),k=0,n=g.length;n>k;++k)for(j=g[k],q+=Math.abs(h(j[0],d)),o=1,p=j.length;p>o;++o)q-=Math.abs(h(j[o],d));break;case l.default.GEOMETRY_COLLECTION:var r=a.getGeometries();for(k=0,n=r.length;n>k;++k)q+=i(r[k],b);break;default:throw new Error("Unsupported geometry type: "+f)}return q}function j(a,b,c,d){var e=d||m,f=k.toRadians(a[1]),g=k.toRadians(a[0]),h=b/e,i=Math.asin(Math.sin(f)*Math.cos(h)+Math.cos(f)*Math.sin(h)*Math.cos(c)),j=g+Math.atan2(Math.sin(c)*Math.sin(h)*Math.cos(f),Math.cos(h)-Math.sin(f)*Math.sin(i));return[k.toDegrees(j),k.toDegrees(i)]}Object.defineProperty(c,"__esModule",{value:!0}),c.getDistance=e,c.getLength=g,c.getArea=i,c.offset=j,c.DEFAULT_RADIUS=void 0;var k=a("./math.js"),l=d(a("./geom/GeometryType.js")),m=6371008.8;c.DEFAULT_RADIUS=m},{"./geom/GeometryType.js":81,"./math.js":147}],260:[function(a,b,c){"use strict";function d(a,b,c){var d=void 0!==c?a.toFixed(c):""+a,e=d.indexOf(".");return e=-1===e?d.length:e,e>b?d:new Array(1+b-e).join("0")+d}function e(a,b){for(var c=(""+a).split("."),d=(""+b).split("."),e=0;e<Math.max(c.length,d.length);e++){var f=parseInt(c[e]||"0",10),g=parseInt(d[e]||"0",10);if(f>g)return 1;if(g>f)return-1}return 0}Object.defineProperty(c,"__esModule",{value:!0}),c.padNumber=d,c.compareVersions=e},{}],261:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../asserts.js"),f=d(a("../events/Target.js")),g=d(a("../events/EventType.js")),h=function(a){function b(b){a.call(this),this.highWaterMark=void 0!==b?b:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},b.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(g.default.CLEAR)},b.prototype.containsKey=function(a){return this.entries_.hasOwnProperty(a)},b.prototype.forEach=function(a,b){for(var c=this,d=this.oldest_;d;)a.call(b,d.value_,d.key_,c),d=d.newer},b.prototype.get=function(a){var b=this.entries_[a];return e.assert(void 0!==b,15),b===this.newest_?b.value_:(b===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(b.newer.older=b.older,b.older.newer=b.newer),b.newer=null,b.older=this.newest_,this.newest_.newer=b,this.newest_=b,b.value_)},b.prototype.remove=function(a){var b=this.entries_[a];return e.assert(void 0!==b,15),b===this.newest_?(this.newest_=b.older,this.newest_&&(this.newest_.newer=null)):b===this.oldest_?(this.oldest_=b.newer,this.oldest_&&(this.oldest_.older=null)):(b.newer.older=b.older,b.older.newer=b.newer),delete this.entries_[a],--this.count_,b.value_},b.prototype.getCount=function(){return this.count_},b.prototype.getKeys=function(){var a,b=new Array(this.count_),c=0;for(a=this.newest_;a;a=a.older)b[c++]=a.key_;return b},b.prototype.getValues=function(){var a,b=new Array(this.count_),c=0;for(a=this.newest_;a;a=a.older)b[c++]=a.value_;return b},b.prototype.peekLast=function(){return this.oldest_.value_},b.prototype.peekLastKey=function(){return this.oldest_.key_},b.prototype.peekFirstKey=function(){return this.newest_.key_},b.prototype.pop=function(){var a=this.oldest_;return delete this.entries_[a.key_],a.newer&&(a.newer.older=null),this.oldest_=a.newer,this.oldest_||(this.newest_=null),--this.count_,a.value_},b.prototype.replace=function(a,b){this.get(a),this.entries_[a].value_=b},b.prototype.set=function(a,b){e.assert(!(a in this.entries_),16);var c={key_:a,newer:null,older:this.newest_,value_:b};this.newest_?this.newest_.newer=c:this.oldest_=c,this.newest_=c,this.entries_[a]=c,++this.count_},b.prototype.setSize=function(a){this.highWaterMark=a},b.prototype.prune=function(){for(var a=this;this.canExpireCache();)a.pop()},b}(f.default),i=h;c.default=i},{"../asserts.js":46,"../events/EventType.js":67,"../events/Target.js":69}],262:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a){this.first_,this.last_,this.head_,this.circular_=void 0===a?!0:a,this.length_=0};d.prototype.insertItem=function(a){var b={prev:void 0,next:void 0,data:a},c=this.head_;if(c){var d=c.next;b.prev=c,b.next=d,c.next=b,d&&(d.prev=b),c===this.last_&&(this.last_=b)}else this.first_=b,this.last_=b,this.circular_&&(b.next=b,b.prev=b);this.head_=b,this.length_++},d.prototype.removeItem=function(){var a=this.head_;if(a){var b=a.next,c=a.prev;b&&(b.prev=c),c&&(c.next=b),this.head_=b||c,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===a?this.first_=this.head_:this.last_===a&&(this.last_=c?this.head_.prev:this.head_),this.length_--}},d.prototype.firstItem=function(){return this.head_=this.first_,this.head_?this.head_.data:void 0},d.prototype.lastItem=function(){return this.head_=this.last_,this.head_?this.head_.data:void 0},d.prototype.nextItem=function(){return this.head_&&this.head_.next?(this.head_=this.head_.next,this.head_.data):void 0},d.prototype.getNextItem=function(){return this.head_&&this.head_.next?this.head_.next.data:void 0},d.prototype.prevItem=function(){return this.head_&&this.head_.prev?(this.head_=this.head_.prev,this.head_.data):void 0},d.prototype.getPrevItem=function(){return this.head_&&this.head_.prev?this.head_.prev.data:void 0},d.prototype.getCurrItem=function(){return this.head_?this.head_.data:void 0},d.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},d.prototype.concat=function(a){if(a.head_){if(this.head_){var b=this.head_.next;this.head_.next=a.first_,a.first_.prev=this.head_,b.prev=a.last_,a.last_.next=b,this.length_+=a.length_}else this.head_=a.head_,this.first_=a.first_,this.last_=a.last_,this.length_=a.length_;a.head_=void 0,a.first_=void 0,a.last_=void 0,a.length_=0}},d.prototype.getLength=function(){return this.length_};var e=d;c.default=e},{}],263:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.DROP=void 0;var d=a("../asserts.js"),e=a("../obj.js"),f=1/0;c.DROP=f;var g=function(a,b){this.priorityFunction_=a,this.keyFunction_=b,this.elements_=[],this.priorities_=[],this.queuedElements_={}};g.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,e.clear(this.queuedElements_)},g.prototype.dequeue=function(){var a=this.elements_,b=this.priorities_,c=a[0];1==a.length?(a.length=0,b.length=0):(a[0]=a.pop(),b[0]=b.pop(),this.siftUp_(0));var d=this.keyFunction_(c);return delete this.queuedElements_[d],c},g.prototype.enqueue=function(a){d.assert(!(this.keyFunction_(a)in this.queuedElements_),31);var b=this.priorityFunction_(a);return b!=f?(this.elements_.push(a),this.priorities_.push(b),this.queuedElements_[this.keyFunction_(a)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},g.prototype.getCount=function(){return this.elements_.length},g.prototype.getLeftChildIndex_=function(a){return 2*a+1},g.prototype.getRightChildIndex_=function(a){return 2*a+2},g.prototype.getParentIndex_=function(a){return a-1>>1},g.prototype.heapify_=function(){var a,b=this;for(a=(this.elements_.length>>1)-1;a>=0;a--)b.siftUp_(a)},g.prototype.isEmpty=function(){return 0===this.elements_.length},g.prototype.isKeyQueued=function(a){return a in this.queuedElements_},g.prototype.isQueued=function(a){return this.isKeyQueued(this.keyFunction_(a))},g.prototype.siftUp_=function(a){for(var b=this,c=this.elements_,d=this.priorities_,e=c.length,f=c[a],g=d[a],h=a;e>>1>a;){var i=b.getLeftChildIndex_(a),j=b.getRightChildIndex_(a),k=e>j&&d[j]<d[i]?j:i;c[a]=c[k],d[a]=d[k],a=k}c[a]=f,d[a]=g,this.siftDown_(h,a)},g.prototype.siftDown_=function(a,b){for(var c=this,d=this.elements_,e=this.priorities_,f=d[b],g=e[b];b>a;){var h=c.getParentIndex_(b);if(!(e[h]>g))break;d[b]=d[h],e[b]=e[h],b=h}d[b]=f,e[b]=g},g.prototype.reprioritize=function(){var a,b,c,d=this,e=this.priorityFunction_,g=this.elements_,h=this.priorities_,i=0,j=g.length;for(b=0;j>b;++b)a=g[b],c=e(a),c==f?delete d.queuedElements_[d.keyFunction_(a)]:(h[i]=c,g[i++]=a);g.length=i,h.length=i,this.heapify_()};var h=g;c.default=h},{"../asserts.js":46,"../obj.js":149}],264:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("rbush")),g=a("../extent.js"),h=a("../obj.js"),i=function(a){this.rbush_=f.default(a,void 0),this.items_={}};i.prototype.insert=function(a,b){var c={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};this.rbush_.insert(c),this.items_[e.getUid(b)]=c},i.prototype.load=function(a,b){for(var c=this,d=new Array(b.length),f=0,g=b.length;g>f;f++){var h=a[f],i=b[f],j={minX:h[0],minY:h[1],maxX:h[2],maxY:h[3],value:i};d[f]=j,c.items_[e.getUid(i)]=j}this.rbush_.load(d)},i.prototype.remove=function(a){var b=e.getUid(a),c=this.items_[b];return delete this.items_[b],null!==this.rbush_.remove(c)},i.prototype.update=function(a,b){var c=this.items_[e.getUid(b)],d=[c.minX,c.minY,c.maxX,c.maxY];g.equals(d,a)||(this.remove(b),this.insert(a,b))},i.prototype.getAll=function(){var a=this.rbush_.all();return a.map(function(a){return a.value})},i.prototype.getInExtent=function(a){var b={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]},c=this.rbush_.search(b);return c.map(function(a){return a.value})},i.prototype.forEach=function(a,b){return this.forEach_(this.getAll(),a,b)},i.prototype.forEachInExtent=function(a,b,c){return this.forEach_(this.getInExtent(a),b,c)},i.prototype.forEach_=function(a,b,c){for(var d,e=0,f=a.length;f>e;e++)if(d=b.call(c,a[e]))return d;return d},i.prototype.isEmpty=function(){return h.isEmpty(this.items_)},i.prototype.clear=function(){this.rbush_.clear(),this.items_={}},i.prototype.getExtent=function(a){var b=this.rbush_.data;return g.createOrUpdate(b.minX,b.minY,b.maxX,b.maxY,a)},i.prototype.concat=function(a){var b=this;this.rbush_.load(a.rbush_.all());for(var c in a.items_)b.items_[0|c]=a.items_[0|c]};var j=i;c.default=j},{"../extent.js":71,"../obj.js":149,"../util.js":289,rbush:302}],265:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Atlas",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"AtlasManager",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Circle",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Fill",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Icon",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"IconImage",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"RegularShape",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"Stroke",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"Style",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"Text",{enumerable:!0,get:function(){return o.default}});var e=d(a("./style/Atlas.js")),f=d(a("./style/AtlasManager.js")),g=d(a("./style/Circle.js")),h=d(a("./style/Fill.js")),i=d(a("./style/Icon.js")),j=d(a("./style/IconImage.js")),k=d(a("./style/Image.js")),l=d(a("./style/RegularShape.js")),m=d(a("./style/Stroke.js")),n=d(a("./style/Style.js")),o=d(a("./style/Text.js"))},{"./style/Atlas.js":266,"./style/AtlasManager.js":267,"./style/Circle.js":268,"./style/Fill.js":269,"./style/Icon.js":270,"./style/IconImage.js":272,"./style/Image.js":275,"./style/RegularShape.js":276,"./style/Stroke.js":277,"./style/Style.js":278,"./style/Text.js":279}],266:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../dom.js"),e=function(a,b){this.space_=b,this.emptyBlocks_=[{x:0,y:0,width:a,height:a}],this.entries_={},this.context_=d.createCanvasContext2D(a,a),this.canvas_=this.context_.canvas};e.prototype.get=function(a){return this.entries_[a]||null},e.prototype.add=function(a,b,c,d,e){for(var f=this,g=0,h=this.emptyBlocks_.length;h>g;++g){var i=f.emptyBlocks_[g];if(i.width>=b+f.space_&&i.height>=c+f.space_){var j={offsetX:i.x+f.space_,offsetY:i.y+f.space_,image:f.canvas_};return f.entries_[a]=j,d.call(e,f.context_,i.x+f.space_,i.y+f.space_),f.split_(g,i,b+f.space_,c+f.space_),j}}return null},e.prototype.split_=function(a,b,c,d){var e,f,g=b.width-c,h=b.height-d;g>h?(e={x:b.x+c,y:b.y,width:b.width-c,height:b.height},f={x:b.x,y:b.y+d,width:c,height:b.height-d},this.updateBlocks_(a,e,f)):(e={x:b.x+c,y:b.y,width:b.width-c,height:d},f={x:b.x,y:b.y+d,width:b.width,height:b.height-d},this.updateBlocks_(a,e,f))},e.prototype.updateBlocks_=function(a,b,c){var d=[a,1];b.width>0&&b.height>0&&d.push(b),c.width>0&&c.height>0&&d.push(c),this.emptyBlocks_.splice.apply(this.emptyBlocks_,d)};var f=e;c.default=f},{"../dom.js":63}],267:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../webgl.js"),f=a("../functions.js"),g=d(a("../style/Atlas.js")),h=256,i=-1,j=function(a){var b=a||{};this.currentSize_=void 0!==b.initialSize?b.initialSize:h,this.maxSize_=void 0!==b.maxSize?b.maxSize:-1!=i?i:void 0!==e.MAX_TEXTURE_SIZE?e.MAX_TEXTURE_SIZE:2048,this.space_=void 0!==b.space?b.space:1,this.atlases_=[new g.default(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new g.default(this.currentHitSize_,this.space_)]};j.prototype.getInfo=function(a){var b=this.getInfo_(this.atlases_,a);if(!b)return null;var c=this.getInfo_(this.hitAtlases_,a);return this.mergeInfos_(b,c)},j.prototype.getInfo_=function(a,b){for(var c=0,d=a.length;d>c;++c){var e=a[c],f=e.get(b);if(f)return f}return null},j.prototype.mergeInfos_=function(a,b){return{offsetX:a.offsetX,offsetY:a.offsetY,image:a.image,hitImage:b.image}},j.prototype.add=function(a,b,c,d,e,g){if(b+this.space_>this.maxSize_||c+this.space_>this.maxSize_)return null;var h=this.add_(!1,a,b,c,d,g);if(!h)return null;var i=void 0!==e?e:f.VOID,j=this.add_(!0,a,b,c,i,g);return this.mergeInfos_(h,j)},j.prototype.add_=function(a,b,c,d,e,f){var h,i,j,k,l=this,m=a?this.hitAtlases_:this.atlases_;for(j=0,k=m.length;k>j;++j){if(h=m[j],i=h.add(b,c,d,e,f))return i;if(!i&&j===k-1){var n=void 0;a?(n=Math.min(2*l.currentHitSize_,l.maxSize_),l.currentHitSize_=n):(n=Math.min(2*l.currentSize_,l.maxSize_),l.currentSize_=n),h=new g.default(n,l.space_),m.push(h),++k}}return null};var k=j;c.default=k},{"../functions.js":76,"../style/Atlas.js":266,"../webgl.js":291}],268:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../style/RegularShape.js")),f=function(a){function b(b){var c=b||{};a.call(this,{points:1/0,fill:c.fill,radius:c.radius,stroke:c.stroke,atlasManager:c.atlasManager})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){var a=new b({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return a.setOpacity(this.getOpacity()),a.setScale(this.getScale()),a},b.prototype.setRadius=function(a){this.radius_=a,this.render_(this.atlasManager_)},b}(e.default),g=f;c.default=g},{"../style/RegularShape.js":276}],269:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../util.js"),e=a("../color.js"),f=function(a){var b=a||{};this.color_=void 0!==b.color?b.color:null,this.checksum_=void 0};f.prototype.clone=function(){var a=this.getColor();return new f({color:a&&a.slice?a.slice():a||void 0})},f.prototype.getColor=function(){return this.color_},f.prototype.setColor=function(a){this.color_=a,this.checksum_=void 0},f.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_=this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?d.getUid(this.color_).toString():"f"+(this.color_?e.asString(this.color_):"-")),this.checksum_};var g=f;c.default=g},{"../color.js":48,"../util.js":289}],270:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("../ImageState.js")),g=a("../asserts.js"),h=a("../color.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=d(a("../style/IconAnchorUnits.js")),l=a("../style/IconImage.js"),m=d(a("../style/IconOrigin.js")),n=d(a("../style/Image.js")),o=function(a){function b(b){var c=b||{},d=void 0!==c.opacity?c.opacity:1,i=void 0!==c.rotation?c.rotation:0,j=void 0!==c.scale?c.scale:1,n=void 0!==c.rotateWithView?c.rotateWithView:!1;a.call(this,{opacity:d,rotation:i,scale:j,rotateWithView:n}),this.anchor_=void 0!==c.anchor?c.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==c.anchorOrigin?c.anchorOrigin:m.default.TOP_LEFT,this.anchorXUnits_=void 0!==c.anchorXUnits?c.anchorXUnits:k.default.FRACTION,this.anchorYUnits_=void 0!==c.anchorYUnits?c.anchorYUnits:k.default.FRACTION,this.crossOrigin_=void 0!==c.crossOrigin?c.crossOrigin:null;var o=void 0!==c.img?c.img:null,p=void 0!==c.imgSize?c.imgSize:null,q=c.src;g.assert(!(void 0!==q&&o),4),g.assert(!o||o&&p,5),void 0!==q&&0!==q.length||!o||(q=o.src||e.getUid(o).toString()),g.assert(void 0!==q&&q.length>0,6);var r=void 0!==c.src?f.default.IDLE:f.default.LOADED;this.color_=void 0!==c.color?h.asArray(c.color):null,this.iconImage_=l.get(o,q,p,this.crossOrigin_,r,this.color_),this.offset_=void 0!==c.offset?c.offset:[0,0],this.offsetOrigin_=void 0!==c.offsetOrigin?c.offsetOrigin:m.default.TOP_LEFT,this.origin_=null,this.size_=void 0!==c.size?c.size:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},b.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var a=this.anchor_,b=this.getSize();if(this.anchorXUnits_==k.default.FRACTION||this.anchorYUnits_==k.default.FRACTION){if(!b)return null;a=this.anchor_.slice(),this.anchorXUnits_==k.default.FRACTION&&(a[0]*=b[0]),this.anchorYUnits_==k.default.FRACTION&&(a[1]*=b[1])}if(this.anchorOrigin_!=m.default.TOP_LEFT){if(!b)return null;a===this.anchor_&&(a=this.anchor_.slice()),(this.anchorOrigin_==m.default.TOP_RIGHT||this.anchorOrigin_==m.default.BOTTOM_RIGHT)&&(a[0]=-a[0]+b[0]),(this.anchorOrigin_==m.default.BOTTOM_LEFT||this.anchorOrigin_==m.default.BOTTOM_RIGHT)&&(a[1]=-a[1]+b[1])}return this.normalizedAnchor_=a,this.normalizedAnchor_},b.prototype.setAnchor=function(a){this.anchor_=a,this.normalizedAnchor_=null},b.prototype.getColor=function(){return this.color_},b.prototype.getImage=function(a){return this.iconImage_.getImage(a)},b.prototype.getImageSize=function(){return this.iconImage_.getSize()},b.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},b.prototype.getImageState=function(){return this.iconImage_.getImageState()},b.prototype.getHitDetectionImage=function(a){return this.iconImage_.getHitDetectionImage(a)},b.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var a=this.offset_;if(this.offsetOrigin_!=m.default.TOP_LEFT){var b=this.getSize(),c=this.iconImage_.getSize();if(!b||!c)return null;a=a.slice(),(this.offsetOrigin_==m.default.TOP_RIGHT||this.offsetOrigin_==m.default.BOTTOM_RIGHT)&&(a[0]=c[0]-b[0]-a[0]),(this.offsetOrigin_==m.default.BOTTOM_LEFT||this.offsetOrigin_==m.default.BOTTOM_RIGHT)&&(a[1]=c[1]-b[1]-a[1])}return this.origin_=a,this.origin_},b.prototype.getSrc=function(){return this.iconImage_.getSrc()},b.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},b.prototype.listenImageChange=function(a,b){return i.listen(this.iconImage_,j.default.CHANGE,a,b)},b.prototype.load=function(){this.iconImage_.load()},b.prototype.unlistenImageChange=function(a,b){i.unlisten(this.iconImage_,j.default.CHANGE,a,b)},b}(n.default),p=o;c.default=p},{"../ImageState.js":16,"../asserts.js":46,"../color.js":48,"../events.js":65,"../events/EventType.js":67,"../style/IconAnchorUnits.js":271,"../style/IconImage.js":272,"../style/IconOrigin.js":274,"../style/Image.js":275,"../util.js":289}],271:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={FRACTION:"fraction",PIXELS:"pixels"};c.default=d},{}],272:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d,e,f){var g=k.shared.get(b,d,f);return g||(g=new l(a,b,c,d,e,f),k.shared.set(b,d,f,g)),g}Object.defineProperty(c,"__esModule",{value:!0}),c.get=e,c.default=void 0;var f=a("../dom.js"),g=a("../events.js"),h=d(a("../events/Target.js")),i=d(a("../events/EventType.js")),j=d(a("../ImageState.js")),k=a("../style/IconImageCache.js"),l=function(a){function b(b,c,d,e,f,g){a.call(this),this.hitDetectionImage_=null,this.image_=b?b:new Image,null!==e&&(this.image_.crossOrigin=e),this.canvas_=g?document.createElement("canvas"):null,this.color_=g,this.imageListenerKeys_=null,this.imageState_=f,this.size_=d,this.src_=c,this.tainting_=!1,this.imageState_==j.default.LOADED&&this.determineTainting_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.determineTainting_=function(){var a=f.createCanvasContext2D(1,1);try{a.drawImage(this.image_,0,0),a.getImageData(0,0,1,1)}catch(b){this.tainting_=!0}},b.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(i.default.CHANGE)},b.prototype.handleImageError_=function(){this.imageState_=j.default.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},b.prototype.handleImageLoad_=function(){this.imageState_=j.default.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.determineTainting_(),this.replaceColor_(),this.dispatchChangeEvent_()},b.prototype.getImage=function(){return this.canvas_?this.canvas_:this.image_},b.prototype.getImageState=function(){return this.imageState_},b.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.tainting_){var a=this.size_[0],b=this.size_[1],c=f.createCanvasContext2D(a,b);c.fillRect(0,0,a,b),this.hitDetectionImage_=c.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},b.prototype.getSize=function(){return this.size_},b.prototype.getSrc=function(){return this.src_},b.prototype.load=function(){if(this.imageState_==j.default.IDLE){this.imageState_=j.default.LOADING,this.imageListenerKeys_=[g.listenOnce(this.image_,i.default.ERROR,this.handleImageError_,this),g.listenOnce(this.image_,i.default.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(a){this.handleImageError_()}}},b.prototype.replaceColor_=function(){if(!this.tainting_&&null!==this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var a=this.canvas_.getContext("2d");a.drawImage(this.image_,0,0);for(var b=a.getImageData(0,0,this.image_.width,this.image_.height),c=b.data,d=this.color_[0]/255,e=this.color_[1]/255,f=this.color_[2]/255,g=0,h=c.length;h>g;g+=4)c[g]*=d,c[g+1]*=e,c[g+2]*=f;a.putImageData(b,0,0)}},b.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(g.unlistenByKey),this.imageListenerKeys_=null},b}(h.default),m=l;c.default=m},{"../ImageState.js":16,"../dom.js":63,"../events.js":65,"../events/EventType.js":67,"../events/Target.js":69,"../style/IconImageCache.js":273}],273:[function(a,b,c){"use strict";function d(a,b,c){var d=c?e.asString(c):"null";return b+":"+a+":"+d}Object.defineProperty(c,"__esModule",{value:!0}),c.shared=c.default=void 0;var e=a("../color.js"),f=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};f.prototype.clear=function(){this.cache_={},this.cacheSize_=0},f.prototype.expire=function(){var a=this;if(this.cacheSize_>this.maxCacheSize_){var b=0;for(var c in a.cache_){var d=a.cache_[c];0!==(3&b++)||d.hasListener()||(delete a.cache_[c],--a.cacheSize_)}}},f.prototype.get=function(a,b,c){var e=d(a,b,c);return e in this.cache_?this.cache_[e]:null},f.prototype.set=function(a,b,c,e){var f=d(a,b,c);this.cache_[f]=e,++this.cacheSize_},f.prototype.setSize=function(a){this.maxCacheSize_=a,this.expire()};var g=f;c.default=g;var h=new f;c.shared=h},{"../color.js":48}],274:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};c.default=d},{}],275:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a){this.opacity_=a.opacity,this.rotateWithView_=a.rotateWithView,this.rotation_=a.rotation,this.scale_=a.scale};d.prototype.getOpacity=function(){return this.opacity_},d.prototype.getRotateWithView=function(){return this.rotateWithView_},d.prototype.getRotation=function(){return this.rotation_},d.prototype.getScale=function(){return this.scale_},d.prototype.getSnapToPixel=function(){return!1},d.prototype.getAnchor=function(){},d.prototype.getImage=function(){},d.prototype.getHitDetectionImage=function(){},d.prototype.getImageState=function(){},d.prototype.getImageSize=function(){},d.prototype.getHitDetectionImageSize=function(){},d.prototype.getOrigin=function(){},d.prototype.getSize=function(){},d.prototype.setOpacity=function(a){this.opacity_=a},d.prototype.setRotateWithView=function(a){this.rotateWithView_=a},d.prototype.setRotation=function(a){this.rotation_=a},d.prototype.setScale=function(a){this.scale_=a},d.prototype.setSnapToPixel=function(){},d.prototype.listenImageChange=function(){},d.prototype.load=function(){},d.prototype.unlistenImageChange=function(){};var e=d;c.default=e},{}],276:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../colorlike.js"),f=a("../dom.js"),g=a("../has.js"),h=d(a("../ImageState.js")),i=a("../render/canvas.js"),j=d(a("../style/Image.js")),k=function(a){function b(b){var c=void 0!==b.rotateWithView?b.rotateWithView:!1;a.call(this,{opacity:1,rotateWithView:c,rotation:void 0!==b.rotation?b.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==b.fill?b.fill:null,this.origin_=[0,0],this.points_=b.points,this.radius_=void 0!==b.radius?b.radius:b.radius1,this.radius2_=b.radius2,this.angle_=void 0!==b.angle?b.angle:0,this.stroke_=void 0!==b.stroke?b.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=b.atlasManager,this.render_(this.atlasManager_)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){var a=new b({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return a.setOpacity(this.getOpacity()),a.setScale(this.getScale()),a},b.prototype.getAnchor=function(){return this.anchor_},b.prototype.getAngle=function(){return this.angle_},b.prototype.getFill=function(){return this.fill_},b.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_
},b.prototype.getImage=function(){return this.canvas_},b.prototype.getImageSize=function(){return this.imageSize_},b.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},b.prototype.getImageState=function(){return h.default.LOADED},b.prototype.getOrigin=function(){return this.origin_},b.prototype.getPoints=function(){return this.points_},b.prototype.getRadius=function(){return this.radius_},b.prototype.getRadius2=function(){return this.radius2_},b.prototype.getSize=function(){return this.size_},b.prototype.getStroke=function(){return this.stroke_},b.prototype.listenImageChange=function(){},b.prototype.load=function(){},b.prototype.unlistenImageChange=function(){},b.prototype.render_=function(a){var b,c,d="",h="",j=0,k=null,l=0,m=0;this.stroke_&&(c=this.stroke_.getColor(),null===c&&(c=i.defaultStrokeStyle),c=e.asColorLike(c),m=this.stroke_.getWidth(),void 0===m&&(m=i.defaultLineWidth),k=this.stroke_.getLineDash(),l=this.stroke_.getLineDashOffset(),g.CANVAS_LINE_DASH||(k=null,l=0),h=this.stroke_.getLineJoin(),void 0===h&&(h=i.defaultLineJoin),d=this.stroke_.getLineCap(),void 0===d&&(d=i.defaultLineCap),j=this.stroke_.getMiterLimit(),void 0===j&&(j=i.defaultMiterLimit));var n=2*(this.radius_+m)+1,o={strokeStyle:c,strokeWidth:m,size:n,lineCap:d,lineDash:k,lineDashOffset:l,lineJoin:h,miterLimit:j};if(void 0===a){var p=f.createCanvasContext2D(n,n);this.canvas_=p.canvas,n=this.canvas_.width,b=n,this.draw_(o,p,0,0),this.createHitDetectionCanvas_(o)}else{n=Math.round(n);var q,r=!this.fill_;r&&(q=this.drawHitDetectionCanvas_.bind(this,o));var s=this.getChecksum(),t=a.add(s,n,n,this.draw_.bind(this,o),q);this.canvas_=t.image,this.origin_=[t.offsetX,t.offsetY],b=t.image.width,r?(this.hitDetectionCanvas_=t.hitImage,this.hitDetectionImageSize_=[t.hitImage.width,t.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[b,b])}this.anchor_=[n/2,n/2],this.size_=[n,n],this.imageSize_=[b,b]},b.prototype.draw_=function(a,b,c,d){var f,g,h,j=this;b.setTransform(1,0,0,1,0,0),b.translate(c,d),b.beginPath();var k=this.points_;if(1/0===k)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(k=2*k),f=0;k>=f;f++)g=2*f*Math.PI/k-Math.PI/2+j.angle_,h=f%2===0?j.radius_:l,b.lineTo(a.size/2+h*Math.cos(g),a.size/2+h*Math.sin(g))}if(this.fill_){var m=this.fill_.getColor();null===m&&(m=i.defaultFillStyle),b.fillStyle=e.asColorLike(m),b.fill()}this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineCap=a.lineCap,b.lineJoin=a.lineJoin,b.miterLimit=a.miterLimit,b.stroke()),b.closePath()},b.prototype.createHitDetectionCanvas_=function(a){if(this.hitDetectionImageSize_=[a.size,a.size],this.fill_)return void(this.hitDetectionCanvas_=this.canvas_);var b=f.createCanvasContext2D(a.size,a.size);this.hitDetectionCanvas_=b.canvas,this.drawHitDetectionCanvas_(a,b,0,0)},b.prototype.drawHitDetectionCanvas_=function(a,b,c,d){var e=this;b.setTransform(1,0,0,1,0,0),b.translate(c,d),b.beginPath();var f=this.points_;if(1/0===f)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{var g=void 0!==this.radius2_?this.radius2_:this.radius_;g!==this.radius_&&(f=2*f);var h,j,k;for(h=0;f>=h;h++)k=2*h*Math.PI/f-Math.PI/2+e.angle_,j=h%2===0?e.radius_:g,b.lineTo(a.size/2+j*Math.cos(k),a.size/2+j*Math.sin(k))}b.fillStyle=i.defaultFillStyle,b.fill(),this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.stroke()),b.closePath()},b.prototype.getChecksum=function(){var a=this.stroke_?this.stroke_.getChecksum():"-",b=this.fill_?this.fill_.getChecksum():"-",c=!this.checksums_||a!=this.checksums_[1]||b!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6];if(c){var d="r"+a+b+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[d,a,b,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},b}(j.default),l=k;c.default=l},{"../ImageState.js":16,"../colorlike.js":49,"../dom.js":63,"../has.js":109,"../render/canvas.js":172,"../style/Image.js":275}],277:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../util.js"),e=function(a){var b=a||{};this.color_=void 0!==b.color?b.color:null,this.lineCap_=b.lineCap,this.lineDash_=void 0!==b.lineDash?b.lineDash:null,this.lineDashOffset_=b.lineDashOffset,this.lineJoin_=b.lineJoin,this.miterLimit_=b.miterLimit,this.width_=b.width,this.checksum_=void 0};e.prototype.clone=function(){var a=this.getColor();return new e({color:a&&a.slice?a.slice():a||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},e.prototype.getColor=function(){return this.color_},e.prototype.getLineCap=function(){return this.lineCap_},e.prototype.getLineDash=function(){return this.lineDash_},e.prototype.getLineDashOffset=function(){return this.lineDashOffset_},e.prototype.getLineJoin=function(){return this.lineJoin_},e.prototype.getMiterLimit=function(){return this.miterLimit_},e.prototype.getWidth=function(){return this.width_},e.prototype.setColor=function(a){this.color_=a,this.checksum_=void 0},e.prototype.setLineCap=function(a){this.lineCap_=a,this.checksum_=void 0},e.prototype.setLineDash=function(a){this.lineDash_=a,this.checksum_=void 0},e.prototype.setLineDashOffset=function(a){this.lineDashOffset_=a,this.checksum_=void 0},e.prototype.setLineJoin=function(a){this.lineJoin_=a,this.checksum_=void 0},e.prototype.setMiterLimit=function(a){this.miterLimit_=a,this.checksum_=void 0},e.prototype.setWidth=function(a){this.width_=a,this.checksum_=void 0},e.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.checksum_+=this.color_?"string"==typeof this.color_?this.color_:d.getUid(this.color_).toString():"-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var f=e;c.default=f},{"../util.js":289}],278:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b;if("function"==typeof a)b=a;else{var c;Array.isArray(a)?c=a:(i.assert(a instanceof n,41),c=[a]),b=function(){return c}}return b}function f(){if(!o){var a=new l.default({color:"rgba(255,255,255,0.4)"}),b=new m.default({color:"#3399CC",width:1.25});o=[new n({image:new k.default({fill:a,stroke:b,radius:5}),fill:a,stroke:b})]}return o}function g(){var a={},b=[255,255,255,1],c=[0,153,255,1],d=3;return a[j.default.POLYGON]=[new n({fill:new l.default({color:[255,255,255,.5]})})],a[j.default.MULTI_POLYGON]=a[j.default.POLYGON],a[j.default.LINE_STRING]=[new n({stroke:new m.default({color:b,width:d+2})}),new n({stroke:new m.default({color:c,width:d})})],a[j.default.MULTI_LINE_STRING]=a[j.default.LINE_STRING],a[j.default.CIRCLE]=a[j.default.POLYGON].concat(a[j.default.LINE_STRING]),a[j.default.POINT]=[new n({image:new k.default({radius:2*d,fill:new l.default({color:c}),stroke:new m.default({color:b,width:d/2})}),zIndex:1/0})],a[j.default.MULTI_POINT]=a[j.default.POINT],a[j.default.GEOMETRY_COLLECTION]=a[j.default.POLYGON].concat(a[j.default.LINE_STRING],a[j.default.POINT]),a}function h(a){return a.getGeometry()}Object.defineProperty(c,"__esModule",{value:!0}),c.toFunction=e,c.createDefaultStyle=f,c.createEditingStyle=g,c.default=void 0;var i=a("../asserts.js"),j=d(a("../geom/GeometryType.js")),k=d(a("../style/Circle.js")),l=d(a("../style/Fill.js")),m=d(a("../style/Stroke.js")),n=function(a){var b=a||{};this.geometry_=null,this.geometryFunction_=h,void 0!==b.geometry&&this.setGeometry(b.geometry),this.fill_=void 0!==b.fill?b.fill:null,this.image_=void 0!==b.image?b.image:null,this.renderer_=void 0!==b.renderer?b.renderer:null,this.stroke_=void 0!==b.stroke?b.stroke:null,this.text_=void 0!==b.text?b.text:null,this.zIndex_=b.zIndex};n.prototype.clone=function(){var a=this.getGeometry();return a&&a.clone&&(a=a.clone()),new n({geometry:a,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},n.prototype.getRenderer=function(){return this.renderer_},n.prototype.setRenderer=function(a){this.renderer_=a},n.prototype.getGeometry=function(){return this.geometry_},n.prototype.getGeometryFunction=function(){return this.geometryFunction_},n.prototype.getFill=function(){return this.fill_},n.prototype.setFill=function(a){this.fill_=a},n.prototype.getImage=function(){return this.image_},n.prototype.setImage=function(a){this.image_=a},n.prototype.getStroke=function(){return this.stroke_},n.prototype.setStroke=function(a){this.stroke_=a},n.prototype.getText=function(){return this.text_},n.prototype.setText=function(a){this.text_=a},n.prototype.getZIndex=function(){return this.zIndex_},n.prototype.setGeometry=function(a){"function"==typeof a?this.geometryFunction_=a:"string"==typeof a?this.geometryFunction_=function(b){return b.get(a)}:a?void 0!==a&&(this.geometryFunction_=function(){return a}):this.geometryFunction_=h,this.geometry_=a},n.prototype.setZIndex=function(a){this.zIndex_=a};var o=null,p=n;c.default=p},{"../asserts.js":46,"../geom/GeometryType.js":81,"../style/Circle.js":268,"../style/Fill.js":269,"../style/Stroke.js":277}],279:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../style/Fill.js")),f=d(a("../style/TextPlacement.js")),g="#333",h=function(a){var b=a||{};this.font_=b.font,this.rotation_=b.rotation,this.rotateWithView_=b.rotateWithView,this.scale_=b.scale,this.text_=b.text,this.textAlign_=b.textAlign,this.textBaseline_=b.textBaseline,this.fill_=void 0!==b.fill?b.fill:new e.default({color:g}),this.maxAngle_=void 0!==b.maxAngle?b.maxAngle:Math.PI/4,this.placement_=void 0!==b.placement?b.placement:f.default.POINT,this.overflow_=!!b.overflow,this.stroke_=void 0!==b.stroke?b.stroke:null,this.offsetX_=void 0!==b.offsetX?b.offsetX:0,this.offsetY_=void 0!==b.offsetY?b.offsetY:0,this.backgroundFill_=b.backgroundFill?b.backgroundFill:null,this.backgroundStroke_=b.backgroundStroke?b.backgroundStroke:null,this.padding_=void 0===b.padding?null:b.padding};h.prototype.clone=function(){return new h({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},h.prototype.getOverflow=function(){return this.overflow_},h.prototype.getFont=function(){return this.font_},h.prototype.getMaxAngle=function(){return this.maxAngle_},h.prototype.getPlacement=function(){return this.placement_},h.prototype.getOffsetX=function(){return this.offsetX_},h.prototype.getOffsetY=function(){return this.offsetY_},h.prototype.getFill=function(){return this.fill_},h.prototype.getRotateWithView=function(){return this.rotateWithView_},h.prototype.getRotation=function(){return this.rotation_},h.prototype.getScale=function(){return this.scale_},h.prototype.getStroke=function(){return this.stroke_},h.prototype.getText=function(){return this.text_},h.prototype.getTextAlign=function(){return this.textAlign_},h.prototype.getTextBaseline=function(){return this.textBaseline_},h.prototype.getBackgroundFill=function(){return this.backgroundFill_},h.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},h.prototype.getPadding=function(){return this.padding_},h.prototype.setOverflow=function(a){this.overflow_=a},h.prototype.setFont=function(a){this.font_=a},h.prototype.setMaxAngle=function(a){this.maxAngle_=a},h.prototype.setOffsetX=function(a){this.offsetX_=a},h.prototype.setOffsetY=function(a){this.offsetY_=a},h.prototype.setPlacement=function(a){this.placement_=a},h.prototype.setFill=function(a){this.fill_=a},h.prototype.setRotation=function(a){this.rotation_=a},h.prototype.setScale=function(a){this.scale_=a},h.prototype.setStroke=function(a){this.stroke_=a},h.prototype.setText=function(a){this.text_=a},h.prototype.setTextAlign=function(a){this.textAlign_=a},h.prototype.setTextBaseline=function(a){this.textBaseline_=a},h.prototype.setBackgroundFill=function(a){this.backgroundFill_=a},h.prototype.setBackgroundStroke=function(a){this.backgroundStroke_=a},h.prototype.setPadding=function(a){this.padding_=a};var i=h;c.default=i},{"../style/Fill.js":269,"../style/TextPlacement.js":280}],280:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POINT:"point",LINE:"line"};c.default=d},{}],281:[function(a,b,c){"use strict";function d(a,b,c,d){return void 0!==d?(d[0]=a,d[1]=b,d[2]=c,d):[a,b,c]}function e(a,b,c){return a+"/"+b+"/"+c}function f(a){return e(a[0],a[1],a[2])}function g(a){return a.split("/").map(Number)}function h(a){return(a[1]<<a[0])+a[2]}function i(a){var b,c,d=a[0],e=new Array(d),f=1<<d-1;for(b=0;d>b;++b)c=48,a[1]&f&&(c+=1),a[2]&f&&(c+=2),e[b]=String.fromCharCode(c),f>>=1;return e.join("")}function j(a,b){var c=a[0],d=a[1],e=a[2];if(b.getMinZoom()>c||c>b.getMaxZoom())return!1;var f,g=b.getExtent();return f=g?b.getTileRangeForExtentAndZ(g,c):b.getFullTileRange(c),f?f.containsXY(d,e):!0}Object.defineProperty(c,"__esModule",{value:!0}),c.createOrUpdate=d,c.getKeyZXY=e,c.getKey=f,c.fromKey=g,c.hash=h,c.quadKey=i,c.withinExtentAndZ=j},{}],282:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.getDefaultTileGrid();return b||(b=j(a),a.setDefaultTileGrid(b)),b}function f(a,b,c){var d=b[0],e=a.getTileCoordCenter(b),f=k(c);if(n.containsCoordinate(f,e))return b;var g=n.getWidth(f),h=Math.ceil((f[0]-e[0])/g);return e[0]+=g*h,a.getTileCoordForCoordAndZ(e,d)}function g(a,b,c,d){var e=void 0!==d?d:o.default.TOP_LEFT,f=i(a,b,c);return new s.default({extent:a,origin:n.getCorner(a,e),resolutions:f,tileSize:c})}function h(a){var b={};return p.assign(b,void 0!==a?a:{}),void 0===b.extent&&(b.extent=q.get("EPSG:3857").getExtent()),b.resolutions=i(b.extent,b.maxZoom,b.tileSize),delete b.maxZoom,new s.default(b)}function i(a,b,c){for(var d=void 0!==b?b:l.DEFAULT_MAX_ZOOM,e=n.getHeight(a),f=n.getWidth(a),g=m.toSize(void 0!==c?c:l.DEFAULT_TILE_SIZE),h=Math.max(f/g[0],e/g[1]),i=d+1,j=new Array(i),k=0;i>k;++k)j[k]=h/Math.pow(2,k);return j}function j(a,b,c,d){var e=k(a);return g(e,b,c,d)}function k(a){a=q.get(a);var b=a.getExtent();if(!b){var c=180*q.METERS_PER_UNIT[r.default.DEGREES]/a.getMetersPerUnit();b=n.createOrUpdate(-c,-c,c,c)}return b}Object.defineProperty(c,"__esModule",{value:!0}),c.getForProjection=e,c.wrapX=f,c.createForExtent=g,c.createXYZ=h,c.createForProjection=j,c.extentFromProjection=k;var l=a("./tilegrid/common.js"),m=a("./size.js"),n=a("./extent.js"),o=d(a("./extent/Corner.js")),p=a("./obj.js"),q=a("./proj.js"),r=d(a("./proj/Units.js")),s=d(a("./tilegrid/TileGrid.js"))},{"./extent.js":71,"./extent/Corner.js":72,"./obj.js":149,"./proj.js":158,"./proj/Units.js":160,"./size.js":226,"./tilegrid/TileGrid.js":283,"./tilegrid/common.js":285}],283:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=a("../asserts.js"),g=d(a("../TileRange.js")),h=a("../array.js"),i=a("../extent.js"),j=a("../math.js"),k=a("../size.js"),l=a("../tilecoord.js"),m=[0,0,0],n=function(a){var b=this;this.minZoom=void 0!==a.minZoom?a.minZoom:0,this.resolutions_=a.resolutions,f.assert(h.isSorted(this.resolutions_,function(a,b){return b-a},!0),17);var c;if(!a.origins)for(var d=0,j=this.resolutions_.length-1;j>d;++d)if(c){if(b.resolutions_[d]/b.resolutions_[d+1]!==c){c=void 0;break}}else c=b.resolutions_[d]/b.resolutions_[d+1];this.zoomFactor_=c,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==a.origin?a.origin:null,this.origins_=null,void 0!==a.origins&&(this.origins_=a.origins,f.assert(this.origins_.length==this.resolutions_.length,20));var k=a.extent;void 0===k||this.origin_||this.origins_||(this.origin_=i.getTopLeft(k)),f.assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==a.tileSizes&&(this.tileSizes_=a.tileSizes,f.assert(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==a.tileSize?a.tileSize:this.tileSizes_?null:e.DEFAULT_TILE_SIZE,f.assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==k?k:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==a.sizes?this.fullTileRanges_=a.sizes.map(function(a){var b=new g.default(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1));return b},this):k&&this.calculateTileRanges_(k)};n.prototype.forEachTileCoord=function(a,b,c){for(var d=this.getTileRangeForExtentAndZ(a,b),e=d.minX,f=d.maxX;f>=e;++e)for(var g=d.minY,h=d.maxY;h>=g;++g)c([b,e,g])},n.prototype.forEachTileCoordParentTileRange=function(a,b,c,d,e){var f,h,i,j=this,k=null,l=a[0]-1;for(2===this.zoomFactor_?(h=a[1],i=a[2]):k=this.getTileCoordExtent(a,e);l>=this.minZoom;){if(2===j.zoomFactor_?(h=Math.floor(h/2),i=Math.floor(i/2),f=g.createOrUpdate(h,h,i,i,d)):f=j.getTileRangeForExtentAndZ(k,l,d),b.call(c,l,f))return!0;--l}return!1},n.prototype.getExtent=function(){return this.extent_},n.prototype.getMaxZoom=function(){return this.maxZoom},n.prototype.getMinZoom=function(){return this.minZoom},n.prototype.getOrigin=function(a){return this.origin_?this.origin_:this.origins_[a]},n.prototype.getResolution=function(a){return this.resolutions_[a]},n.prototype.getResolutions=function(){return this.resolutions_},n.prototype.getTileCoordChildTileRange=function(a,b,c){if(a[0]<this.maxZoom){if(2===this.zoomFactor_){var d=2*a[1],e=2*a[2];return g.createOrUpdate(d,d+1,e,e+1,b)}var f=this.getTileCoordExtent(a,c);return this.getTileRangeForExtentAndZ(f,a[0]+1,b)}return null},n.prototype.getTileRangeExtent=function(a,b,c){var d=this.getOrigin(a),e=this.getResolution(a),f=k.toSize(this.getTileSize(a),this.tmpSize_),g=d[0]+b.minX*f[0]*e,h=d[0]+(b.maxX+1)*f[0]*e,j=d[1]+b.minY*f[1]*e,l=d[1]+(b.maxY+1)*f[1]*e;return i.createOrUpdate(g,j,h,l,c)},n.prototype.getTileRangeForExtentAndZ=function(a,b,c){var d=m;this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,d);var e=d[1],f=d[2];return this.getTileCoordForXYAndZ_(a[2],a[3],b,!0,d),g.createOrUpdate(e,d[1],f,d[2],c)},n.prototype.getTileCoordCenter=function(a){var b=this.getOrigin(a[0]),c=this.getResolution(a[0]),d=k.toSize(this.getTileSize(a[0]),this.tmpSize_);return[b[0]+(a[1]+.5)*d[0]*c,b[1]+(a[2]+.5)*d[1]*c]},n.prototype.getTileCoordExtent=function(a,b){var c=this.getOrigin(a[0]),d=this.getResolution(a[0]),e=k.toSize(this.getTileSize(a[0]),this.tmpSize_),f=c[0]+a[1]*e[0]*d,g=c[1]+a[2]*e[1]*d,h=f+e[0]*d,j=g+e[1]*d;return i.createOrUpdate(f,g,h,j,b)},n.prototype.getTileCoordForCoordAndResolution=function(a,b,c){return this.getTileCoordForXYAndResolution_(a[0],a[1],b,!1,c)},n.prototype.getTileCoordForXYAndResolution_=function(a,b,c,d,e){var f=this.getZForResolution(c),g=c/this.getResolution(f),h=this.getOrigin(f),i=k.toSize(this.getTileSize(f),this.tmpSize_),j=d?.5:0,m=d?0:.5,n=Math.floor((a-h[0])/c+j),o=Math.floor((b-h[1])/c+m),p=g*n/i[0],q=g*o/i[1];return d?(p=Math.ceil(p)-1,q=Math.ceil(q)-1):(p=Math.floor(p),q=Math.floor(q)),l.createOrUpdate(f,p,q,e)},n.prototype.getTileCoordForXYAndZ_=function(a,b,c,d,e){var f=this.getOrigin(c),g=this.getResolution(c),h=k.toSize(this.getTileSize(c),this.tmpSize_),i=d?.5:0,j=d?0:.5,m=Math.floor((a-f[0])/g+i),n=Math.floor((b-f[1])/g+j),o=m/h[0],p=n/h[1];return d?(o=Math.ceil(o)-1,p=Math.ceil(p)-1):(o=Math.floor(o),p=Math.floor(p)),l.createOrUpdate(c,o,p,e)},n.prototype.getTileCoordForCoordAndZ=function(a,b,c){return this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,c)},n.prototype.getTileCoordResolution=function(a){return this.resolutions_[a[0]]},n.prototype.getTileSize=function(a){return this.tileSize_?this.tileSize_:this.tileSizes_[a]},n.prototype.getFullTileRange=function(a){return this.fullTileRanges_?this.fullTileRanges_[a]:null},n.prototype.getZForResolution=function(a,b){var c=h.linearFindNearest(this.resolutions_,a,b||0);return j.clamp(c,this.minZoom,this.maxZoom)},n.prototype.calculateTileRanges_=function(a){for(var b=this,c=this.resolutions_.length,d=new Array(c),e=this.minZoom;c>e;++e)d[e]=b.getTileRangeForExtentAndZ(a,e);this.fullTileRanges_=d};var o=n;c.default=o},{"../TileRange.js":37,"../array.js":45,"../asserts.js":46,"../extent.js":71,"../math.js":147,"../size.js":226,"../tilecoord.js":281,"./common.js":285}],284:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=[],e=[],h=[],j=[],k=[],l=void 0!==c?c:[],m="SupportedCRS",n="TileMatrix",o="Identifier",p="ScaleDenominator",q="TopLeftCorner",r="TileWidth",s="TileHeight",t=a[m],u=g.get(t.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||g.get(t),v=u.getMetersPerUnit(),w="ne"==u.getAxisOrientation().substr(0,2);return a[n].sort(function(a,b){return b[p]-a[p]}),a[n].forEach(function(b){var c;if(c=l.length>0?f.find(l,function(c){return b[o]==c[n]?!0:-1===b[o].indexOf(":")?a[o]+":"+b[o]===c[n]:!1}):!0){e.push(b[o]);var g=28e-5*b[p]/v,i=b[r],m=b[s];h.push(w?[b[q][1],b[q][0]]:b[q]),d.push(g),j.push(i==m?i:[i,m]),k.push([b.MatrixWidth,-b.MatrixHeight])}}),new i({extent:b,origins:h,resolutions:d,matrixIds:e,tileSizes:j,sizes:k})}Object.defineProperty(c,"__esModule",{value:!0}),c.createFromCapabilitiesMatrixSet=e,c.default=void 0;var f=a("../array.js"),g=a("../proj.js"),h=d(a("../tilegrid/TileGrid.js")),i=function(a){function b(b){a.call(this,{extent:b.extent,origin:b.origin,origins:b.origins,resolutions:b.resolutions,tileSize:b.tileSize,tileSizes:b.tileSizes,sizes:b.sizes}),this.matrixIds_=b.matrixIds}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getMatrixId=function(a){return this.matrixIds_[a]},b.prototype.getMatrixIds=function(){return this.matrixIds_},b}(h.default),j=i;c.default=j},{"../array.js":45,"../proj.js":158,"../tilegrid/TileGrid.js":283}],285:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_TILE_SIZE=c.DEFAULT_MAX_ZOOM=void 0;var d=42;c.DEFAULT_MAX_ZOOM=d;var e=256;c.DEFAULT_TILE_SIZE=e},{}],286:[function(a,b,c){"use strict";function d(a,b){var c=/\{z\}/g,d=/\{x\}/g,e=/\{y\}/g,f=/\{-y\}/g;return function(g){return g?a.replace(c,g[0].toString()).replace(d,g[1].toString()).replace(e,function(){var a=-g[2]-1;return a.toString()}).replace(f,function(){var a=g[0],c=b.getFullTileRange(a);i.assert(c,55);var d=c.getHeight()+g[2];return d.toString()}):void 0}}function e(a,b){for(var c=a.length,e=new Array(c),g=0;c>g;++g)e[g]=d(a[g],b);return f(e)}function f(a){return 1===a.length?a[0]:function(b,c,d){if(b){var e=k.hash(b),f=j.modulo(e,a.length);return a[f](b,c,d)}return void 0}}function g(){return void 0}function h(a){var b=[],c=/\{([a-z])-([a-z])\}/.exec(a);if(c){var d,e=c[1].charCodeAt(0),f=c[2].charCodeAt(0);for(d=e;f>=d;++d)b.push(a.replace(c[0],String.fromCharCode(d)));return b}if(c=c=/\{(\d+)-(\d+)\}/.exec(a)){for(var g=parseInt(c[2],10),h=parseInt(c[1],10);g>=h;h++)b.push(a.replace(c[0],h.toString()));return b}return b.push(a),b}Object.defineProperty(c,"__esModule",{value:!0}),c.createFromTemplate=d,c.createFromTemplates=e,c.createFromTileUrlFunctions=f,c.nullTileUrlFunction=g,c.expandUrl=h;var i=a("./asserts.js"),j=a("./math.js"),k=a("./tilecoord.js")},{"./asserts.js":46,"./math.js":147,"./tilecoord.js":281}],287:[function(a,b,c){"use strict";function d(){return[1,0,0,1,0,0]}function e(a){return g(a,1,0,0,1,0,0)}function f(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=b[0],j=b[1],k=b[2],l=b[3],m=b[4],n=b[5];return a[0]=c*i+e*j,a[1]=d*i+f*j,a[2]=c*k+e*l,a[3]=d*k+f*l,a[4]=c*m+e*n+g,a[5]=d*m+f*n+h,a}function g(a,b,c,d,e,f,g){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a[4]=f,a[5]=g,a}function h(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a}function i(a,b){var c=b[0],d=b[1];return b[0]=a[0]*c+a[2]*d+a[4],b[1]=a[1]*c+a[3]*d+a[5],b}function j(a,b){var c=Math.cos(b),d=Math.sin(b);return f(a,g(q,c,d,-d,c,0,0))}function k(a,b,c){return f(a,g(q,b,0,0,c,0,0))}function l(a,b,c){return f(a,g(q,1,0,0,1,b,c))}function m(a,b,c,d,e,f,g,h){var i=Math.sin(f),j=Math.cos(f);return a[0]=d*j,a[1]=e*i,a[2]=-d*i,a[3]=e*j,a[4]=g*d*j-h*d*i+b,a[5]=g*e*i+h*e*j+c,a}function n(a){var b=o(a);p.assert(0!==b,32);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5];return a[0]=f/b,a[1]=-d/b,a[2]=-e/b,a[3]=c/b,a[4]=(e*h-f*g)/b,a[5]=-(c*h-d*g)/b,a}function o(a){return a[0]*a[3]-a[1]*a[2]}Object.defineProperty(c,"__esModule",{value:!0}),c.create=d,c.reset=e,c.multiply=f,c.set=g,c.setFromArray=h,c.apply=i,c.rotate=j,c.scale=k,c.translate=l,c.compose=m,c.invert=n,c.determinant=o;var p=a("./asserts.js"),q=new Array(6)},{"./asserts.js":46}],288:[function(a,b,c){"use strict";function d(a,b){var c=[];Object.keys(b).forEach(function(a){null!==b[a]&&void 0!==b[a]&&c.push(a+"="+encodeURIComponent(b[a]))});var d=c.join("&");return a=a.replace(/[?&]$/,""),a=-1===a.indexOf("?")?a+"?":a+"&",a+d}Object.defineProperty(c,"__esModule",{value:!0}),c.appendParams=d},{}],289:[function(a,b,c){"use strict";function d(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a}function e(a){return a.ol_uid||(a.ol_uid=++f)}Object.defineProperty(c,"__esModule",{value:!0}),c.inherits=d,c.getUid=e,c.VERSION=void 0;var f=0,g="5.2.0";c.VERSION=g},{}],290:[function(a,b,c){"use strict";function d(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function e(a,b){return a[0]=b[0],a[1]=b[1],a[4]=b[2],a[5]=b[3],a[12]=b[4],a[13]=b[5],a}Object.defineProperty(c,"__esModule",{value:!0}),c.create=d,c.fromTransform=e},{}],291:[function(a,b,c){"use strict";function d(a,b){for(var c=N.length,d=0;c>d;++d)try{var e=a.getContext(N[d],b);if(e)return e}catch(f){}return null}Object.defineProperty(c,"__esModule",{value:!0}),c.getContext=d,c.EXTENSIONS=c.MAX_TEXTURE_SIZE=c.HAS=c.DEBUG=c.FRAMEBUFFER=c.COMPILE_STATUS=c.CLAMP_TO_EDGE=c.TEXTURE0=c.TEXTURE_2D=c.TEXTURE_WRAP_T=c.TEXTURE_WRAP_S=c.TEXTURE_MIN_FILTER=c.TEXTURE_MAG_FILTER=c.LINEAR=c.LINK_STATUS=c.VERTEX_SHADER=c.FRAGMENT_SHADER=c.RGBA=c.FLOAT=c.UNSIGNED_INT=c.UNSIGNED_SHORT=c.UNSIGNED_BYTE=c.SCISSOR_TEST=c.DEPTH_TEST=c.STENCIL_TEST=c.BLEND=c.CULL_FACE=c.DYNAMIC_DRAW=c.STATIC_DRAW=c.STREAM_DRAW=c.ELEMENT_ARRAY_BUFFER=c.ARRAY_BUFFER=c.ONE_MINUS_SRC_ALPHA=c.TRIANGLE_STRIP=c.TRIANGLES=c.COLOR_BUFFER_BIT=c.COLOR_ATTACHMENT0=c.SRC_ALPHA=c.ONE=void 0;var e=1;c.ONE=e;var f=770;c.SRC_ALPHA=f;var g=36064;c.COLOR_ATTACHMENT0=g;var h=16384;c.COLOR_BUFFER_BIT=h;var i=4;c.TRIANGLES=i;var j=5;c.TRIANGLE_STRIP=j;var k=771;c.ONE_MINUS_SRC_ALPHA=k;var l=34962;c.ARRAY_BUFFER=l;var m=34963;c.ELEMENT_ARRAY_BUFFER=m;var n=35040;c.STREAM_DRAW=n;var o=35044;c.STATIC_DRAW=o;var p=35048;c.DYNAMIC_DRAW=p;var q=2884;c.CULL_FACE=q;var r=3042;c.BLEND=r;var s=2960;c.STENCIL_TEST=s;var t=2929;c.DEPTH_TEST=t;var u=3089;c.SCISSOR_TEST=u;var v=5121;c.UNSIGNED_BYTE=v;var w=5123;c.UNSIGNED_SHORT=w;var x=5125;c.UNSIGNED_INT=x;var y=5126;c.FLOAT=y;var z=6408;c.RGBA=z;var A=35632;c.FRAGMENT_SHADER=A;var B=35633;c.VERTEX_SHADER=B;var C=35714;c.LINK_STATUS=C;var D=9729;c.LINEAR=D;var E=10240;c.TEXTURE_MAG_FILTER=E;var F=10241;c.TEXTURE_MIN_FILTER=F;var G=10242;c.TEXTURE_WRAP_S=G;var H=10243;c.TEXTURE_WRAP_T=H;var I=3553;c.TEXTURE_2D=I;var J=33984;c.TEXTURE0=J;var K=33071;c.CLAMP_TO_EDGE=K;var L=35713;c.COMPILE_STATUS=L;var M=36160;c.FRAMEBUFFER=M;var N=["experimental-webgl","webgl","webkit-3d","moz-webgl"],O=!0;c.DEBUG=O;var P;c.MAX_TEXTURE_SIZE=P;var Q;c.EXTENSIONS=Q;var R=!1;if(c.HAS=R,"undefined"!=typeof window&&"WebGLRenderingContext"in window)try{var S=document.createElement("canvas"),T=d(S,{failIfMajorPerformanceCaveat:!0});T&&(c.HAS=R=!0,c.MAX_TEXTURE_SIZE=P=T.getParameter(T.MAX_TEXTURE_SIZE),c.EXTENSIONS=Q=T.getSupportedExtensions())}catch(U){}},{}],292:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../webgl.js"),e={STATIC_DRAW:d.STATIC_DRAW,STREAM_DRAW:d.STREAM_DRAW,DYNAMIC_DRAW:d.DYNAMIC_DRAW},f=function(a,b){this.arr_=void 0!==a?a:[],this.usage_=void 0!==b?b:e.STATIC_DRAW};f.prototype.getArray=function(){return this.arr_},f.prototype.getUsage=function(){return this.usage_};var g=f;c.default=g},{"../webgl.js":291}],293:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=a.createTexture();return a.bindTexture(a.TEXTURE_2D,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),void 0!==b&&a.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,b),void 0!==c&&a.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,c),d}function f(a,b,c,d,f){var g=e(a,d,f);return a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null),g}function g(a,b,c,d){var f=e(a,c,d);return a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b),f}Object.defineProperty(c,"__esModule",{value:!0}),c.createEmptyTexture=f,c.createTexture=g,c.default=void 0;var h=a("../util.js"),i=a("../webgl.js"),j=d(a("../Disposable.js")),k=a("../array.js"),l=a("../events.js"),m=a("../obj.js"),n=d(a("../webgl/ContextEventType.js")),o=function(a){function b(b,c){a.call(this),this.canvas_=b,this.gl_=c,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=k.includes(i.EXTENSIONS,"OES_element_index_uint"),this.hasOESElementIndexUint&&c.getExtension("OES_element_index_uint"),l.listen(this.canvas_,n.default.LOST,this.handleWebGLContextLost,this),l.listen(this.canvas_,n.default.RESTORED,this.handleWebGLContextRestored,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.bindBuffer=function(a,b){var c=this.getGL(),d=b.getArray(),e=String(h.getUid(b));if(e in this.bufferCache_){var f=this.bufferCache_[e];c.bindBuffer(a,f.buffer)}else{var g=c.createBuffer();c.bindBuffer(a,g);var j;a==i.ARRAY_BUFFER?j=new Float32Array(d):a==i.ELEMENT_ARRAY_BUFFER&&(j=this.hasOESElementIndexUint?new Uint32Array(d):new Uint16Array(d)),c.bufferData(a,j,b.getUsage()),this.bufferCache_[e]={buf:b,buffer:g}}},b.prototype.deleteBuffer=function(a){var b=this.getGL(),c=String(h.getUid(a)),d=this.bufferCache_[c];b.isContextLost()||b.deleteBuffer(d.buffer),delete this.bufferCache_[c]},b.prototype.disposeInternal=function(){var a=this;l.unlistenAll(this.canvas_);var b=this.getGL();if(!b.isContextLost()){for(var c in a.bufferCache_)b.deleteBuffer(a.bufferCache_[c].buffer);
for(var d in a.programCache_)b.deleteProgram(a.programCache_[d]);for(var e in a.shaderCache_)b.deleteShader(a.shaderCache_[e]);b.deleteFramebuffer(this.hitDetectionFramebuffer_),b.deleteRenderbuffer(this.hitDetectionRenderbuffer_),b.deleteTexture(this.hitDetectionTexture_)}},b.prototype.getCanvas=function(){return this.canvas_},b.prototype.getGL=function(){return this.gl_},b.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},b.prototype.getShader=function(a){var b=String(h.getUid(a));if(b in this.shaderCache_)return this.shaderCache_[b];var c=this.getGL(),d=c.createShader(a.getType());return c.shaderSource(d,a.getSource()),c.compileShader(d),this.shaderCache_[b]=d,d},b.prototype.getProgram=function(a,b){var c=h.getUid(a)+"/"+h.getUid(b);if(c in this.programCache_)return this.programCache_[c];var d=this.getGL(),e=d.createProgram();return d.attachShader(e,this.getShader(a)),d.attachShader(e,this.getShader(b)),d.linkProgram(e),this.programCache_[c]=e,e},b.prototype.handleWebGLContextLost=function(){m.clear(this.bufferCache_),m.clear(this.shaderCache_),m.clear(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},b.prototype.handleWebGLContextRestored=function(){},b.prototype.initHitDetectionFramebuffer_=function(){var a=this.gl_,b=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,b);var c=f(a,1,1),d=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,1,1),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,d),a.bindTexture(a.TEXTURE_2D,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=b,this.hitDetectionTexture_=c,this.hitDetectionRenderbuffer_=d},b.prototype.useProgram=function(a){if(a==this.currentProgram_)return!1;var b=this.getGL();return b.useProgram(a),this.currentProgram_=a,!0},b}(j.default),p=o;c.default=p},{"../Disposable.js":8,"../array.js":45,"../events.js":65,"../obj.js":149,"../util.js":289,"../webgl.js":291,"../webgl/ContextEventType.js":294}],294:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};c.default=d},{}],295:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../webgl.js"),f=d(a("../webgl/Shader.js")),g=function(a){function b(b){a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return e.FRAGMENT_SHADER},b}(f.default),h=g;c.default=h},{"../webgl.js":291,"../webgl/Shader.js":296}],296:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../functions.js"),e=function(a){this.source_=a};e.prototype.getType=function(){},e.prototype.getSource=function(){return this.source_},e.prototype.isAnimated=d.FALSE;var f=e;c.default=f},{"../functions.js":76}],297:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../webgl.js"),f=d(a("../webgl/Shader.js")),g=function(a){function b(b){a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return e.VERTEX_SHADER},b}(f.default),h=g;c.default=h},{"../webgl.js":291,"../webgl/Shader.js":296}],298:[function(a,b,c){"use strict";var d=a("./processor");c.Processor=d},{"./processor":299}],299:[function(a,b){"use strict";function c(a){function b(a,b,d){return c?new ImageData(a,b,d):{data:a,width:b,height:d}}var c=!0;try{new ImageData(10,10)}catch(d){c=!1}return function(c){var d,e,f=c.buffers,g=c.meta,h=c.imageOps,i=c.width,j=c.height,k=f.length,l=f[0].byteLength;if(h){var m=new Array(k);for(e=0;k>e;++e)m[e]=b(new Uint8ClampedArray(f[e]),i,j);d=a(m,g).data}else{d=new Uint8ClampedArray(l);var n=new Array(k),o=new Array(k);for(e=0;k>e;++e)n[e]=new Uint8ClampedArray(f[e]),o[e]=[0,0,0,0];for(var p=0;l>p;p+=4){for(var q=0;k>q;++q){var r=n[q];o[q][0]=r[p],o[q][1]=r[p+1],o[q][2]=r[p+2],o[q][3]=r[p+3]}var s=a(o,g);d[p]=s[0],d[p+1]=s[1],d[p+2]=s[2],d[p+3]=s[3]}}return d.buffer}}function d(a,b){var d=Object.keys(a.lib||{}).map(function(b){return"var "+b+" = "+a.lib[b].toString()+";"}),e=d.concat(["var __minion__ = ("+c.toString()+")(",a.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),f=new Blob(e,{type:"text/javascript"}),g=URL.createObjectURL(f),h=new Worker(g);return h.addEventListener("message",b),h}function e(a,b){var d=c(a.operation);return{postMessage:function(a){setTimeout(function(){b({data:{buffer:d(a),meta:a.meta}})},0)}}}function f(a){this._imageOps=!!a.imageOps;var b;b=0===a.threads?0:this._imageOps?1:a.threads||1;var c=[];if(b)for(var f=0;b>f;++f)c[f]=d(a,this._onWorkerMessage.bind(this,f));else c[0]=e(a,this._onWorkerMessage.bind(this,0));this._workers=c,this._queue=[],this._maxQueueLength=a.queue||1/0,this._running=0,this._dataLookup={},this._job=null}var g=a("./util").newImageData;f.prototype.process=function(a,b,c){this._enqueue({inputs:a,meta:b,callback:c}),this._dispatch()},f.prototype.destroy=function(){for(var a in this)this[a]=null;this._destroyed=!0},f.prototype._enqueue=function(a){for(this._queue.push(a);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},f.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var a=this._job=this._queue.shift(),b=a.inputs[0].width,c=a.inputs[0].height,d=a.inputs.map(function(a){return a.data.buffer}),e=this._workers.length;if(this._running=e,1===e)this._workers[0].postMessage({buffers:d,meta:a.meta,imageOps:this._imageOps,width:b,height:c},d);else for(var f=a.inputs[0].data.length,g=4*Math.ceil(f/4/e),h=0;e>h;++h){for(var i=h*g,j=[],k=0,l=d.length;l>k;++k)j.push(d[h].slice(i,i+g));this._workers[h].postMessage({buffers:j,meta:a.meta,imageOps:this._imageOps,width:b,height:c},j)}}},f.prototype._onWorkerMessage=function(a,b){this._destroyed||(this._dataLookup[a]=b.data,--this._running,0===this._running&&this._resolveJob())},f.prototype._resolveJob=function(){var a,b,c=this._job,d=this._workers.length;if(1===d)a=new Uint8ClampedArray(this._dataLookup[0].buffer),b=this._dataLookup[0].meta;else{var e=c.inputs[0].data.length;a=new Uint8ClampedArray(e),b=new Array(e);for(var f=4*Math.ceil(e/4/d),h=0;d>h;++h){var i=this._dataLookup[h].buffer,j=h*f;a.set(new Uint8ClampedArray(i),j),b[h]=this._dataLookup[h].meta}}this._job=null,this._dataLookup={},c.callback(null,g(a,c.inputs[0].width,c.inputs[0].height),b),this._dispatch()},b.exports=f},{"./util":300}],300:[function(a,b,c){"use strict";function d(a,b,c){if(e)return new ImageData(a,b,c);var d=g.createImageData(b,c);return d.data.set(a),d}var e=!0;try{new ImageData(10,10)}catch(f){e=!1}var g=document.createElement("canvas").getContext("2d");c.newImageData=d},{}],301:[function(a,b,c){"use strict";function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(a,e){"object"===("undefined"==typeof c?"undefined":d(c))&&"undefined"!=typeof b?b.exports=e():"function"==typeof define&&define.amd?define(e):a.quickselect=e()}(void 0,function(){function a(a,c,e,f,g){b(a,c,e||0,f||a.length-1,g||d)}function b(a,d,e,f,g){for(;f>e;){if(f-e>600){var h=f-e+1,i=d-e+1,j=Math.log(h),k=.5*Math.exp(2*j/3),l=.5*Math.sqrt(j*k*(h-k)/h)*(0>i-h/2?-1:1),m=Math.max(e,Math.floor(d-i*k/h+l)),n=Math.min(f,Math.floor(d+(h-i)*k/h+l));b(a,d,m,n,g)}var o=a[d],p=e,q=f;for(c(a,e,d),g(a[f],o)>0&&c(a,e,f);q>p;){for(c(a,p,q),p++,q--;g(a[p],o)<0;)p++;for(;g(a[q],o)>0;)q--}0===g(a[e],o)?c(a,e,q):(q++,c(a,q,f)),d>=q&&(e=q+1),q>=d&&(f=q-1)}}function c(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function d(a,b){return b>a?-1:a>b?1:0}return a})},{}],302:[function(a,b){"use strict";function c(a,b){return this instanceof c?(this._maxEntries=Math.max(4,a||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),b&&this._initFormat(b),void this.clear()):new c(a,b)}function d(a,b,c){if(!c)return b.indexOf(a);for(var d=0;d<b.length;d++)if(c(a,b[d]))return d;return-1}function e(a,b){f(a,0,a.children.length,b,a)}function f(a,b,c,d,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var f,h=b;c>h;h++)f=a.children[h],g(e,a.leaf?d(f):f);return e}function g(a,b){return a.minX=Math.min(a.minX,b.minX),a.minY=Math.min(a.minY,b.minY),a.maxX=Math.max(a.maxX,b.maxX),a.maxY=Math.max(a.maxY,b.maxY),a}function h(a,b){return a.minX-b.minX}function i(a,b){return a.minY-b.minY}function j(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function k(a){return a.maxX-a.minX+(a.maxY-a.minY)}function l(a,b){return(Math.max(b.maxX,a.maxX)-Math.min(b.minX,a.minX))*(Math.max(b.maxY,a.maxY)-Math.min(b.minY,a.minY))}function m(a,b){var c=Math.max(a.minX,b.minX),d=Math.max(a.minY,b.minY),e=Math.min(a.maxX,b.maxX),f=Math.min(a.maxY,b.maxY);return Math.max(0,e-c)*Math.max(0,f-d)}function n(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function o(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function p(a){return{children:a,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function q(a,b,c,d,e){for(var f,g=[b,c];g.length;)c=g.pop(),b=g.pop(),d>=c-b||(f=b+Math.ceil((c-b)/d/2)*d,r(a,f,b,c,e),g.push(b,f,f,c))}b.exports=c,b.exports.default=c;var r=a("quickselect");c.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!o(a,b))return c;for(var e,f,g,h,i=[];b;){for(e=0,f=b.children.length;f>e;e++)g=b.children[e],h=b.leaf?d(g):g,o(a,h)&&(b.leaf?c.push(g):n(a,h)?this._all(g,c):i.push(g));b=i.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!o(a,b))return!1;for(var d,e,f,g,h=[];b;){for(d=0,e=b.children.length;e>d;d++)if(f=b.children[d],g=b.leaf?c(f):f,o(a,g)){if(b.leaf||n(a,g))return!0;h.push(f)}b=h.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;c>b;b++)this.insert(a[b]);return this}var d=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var e=this.data;this.data=d,d=e}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},insert:function(a){return a&&this._insert(a,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(a,b){if(!a)return this;for(var c,e,f,g,h=this.data,i=this.toBBox(a),j=[],k=[];h||j.length;){if(h||(h=j.pop(),e=j[j.length-1],c=k.pop(),g=!0),h.leaf&&(f=d(a,h.children,b),-1!==f))return h.children.splice(f,1),j.push(h),this._condense(j),this;g||h.leaf||!n(h,i)?e?(c++,h=e.children[c],g=!1):h=null:(j.push(h),k.push(c),c=0,e=h,h=h.children[0])}return this},toBBox:function(a){return a},compareMinX:h,compareMinY:i,toJSON:function(){return this.data},fromJSON:function(a){return this.data=a,this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,d){var f,g=c-b+1,h=this._maxEntries;if(h>=g)return f=p(a.slice(b,c+1)),e(f,this.toBBox),f;d||(d=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,d-1))),f=p([]),f.leaf=!1,f.height=d;var i,j,k,l,m=Math.ceil(g/h),n=m*Math.ceil(Math.sqrt(h));for(q(a,b,c,n,this.compareMinX),i=b;c>=i;i+=n)for(k=Math.min(i+n-1,c),q(a,i,k,m,this.compareMinY),j=i;k>=j;j+=m)l=Math.min(j+m-1,k),f.children.push(this._build(a,j,l,d-1));return e(f,this.toBBox),f},_chooseSubtree:function(a,b,c,d){for(var e,f,g,h,i,k,m,n;;){if(d.push(b),b.leaf||d.length-1===c)break;for(m=n=1/0,e=0,f=b.children.length;f>e;e++)g=b.children[e],i=j(g),k=l(a,g)-i,n>k?(n=k,m=m>i?i:m,h=g):k===n&&m>i&&(m=i,h=g);b=h||b.children[0]}return b},_insert:function(a,b,c){var d=this.toBBox,e=c?a:d(a),f=[],h=this._chooseSubtree(e,this.data,b,f);for(h.children.push(a),g(h,e);b>=0&&f[b].children.length>this._maxEntries;)this._split(f,b),b--;this._adjustParentBBoxes(e,f,b)},_split:function(a,b){var c=a[b],d=c.children.length,f=this._minEntries;this._chooseSplitAxis(c,f,d);var g=this._chooseSplitIndex(c,f,d),h=p(c.children.splice(g,c.children.length-g));h.height=c.height,h.leaf=c.leaf,e(c,this.toBBox),e(h,this.toBBox),b?a[b-1].children.push(h):this._splitRoot(c,h)},_splitRoot:function(a,b){this.data=p([a,b]),this.data.height=a.height+1,this.data.leaf=!1,e(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var d,e,g,h,i,k,l,n;for(k=l=1/0,d=b;c-b>=d;d++)e=f(a,0,d,this.toBBox),g=f(a,d,c,this.toBBox),h=m(e,g),i=j(e)+j(g),k>h?(k=h,n=d,l=l>i?i:l):h===k&&l>i&&(l=i,n=d);return n},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:h,e=a.leaf?this.compareMinY:i,f=this._allDistMargin(a,b,c,d),g=this._allDistMargin(a,b,c,e);g>f&&a.children.sort(d)},_allDistMargin:function(a,b,c,d){a.children.sort(d);var e,h,i=this.toBBox,j=f(a,0,b,i),l=f(a,c-b,c,i),m=k(j)+k(l);for(e=b;c-b>e;e++)h=a.children[e],g(j,a.leaf?i(h):h),m+=k(j);for(e=c-b-1;e>=b;e--)h=a.children[e],g(l,a.leaf?i(h):h),m+=k(l);return m},_adjustParentBBoxes:function(a,b,c){for(var d=c;d>=0;d--)g(b[d],a)},_condense:function(a){for(var b,c=a.length-1;c>=0;c--)0===a[c].children.length?c>0?(b=a[c-1].children,b.splice(b.indexOf(a[c]),1)):this.clear():e(a[c],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0])),this.compareMinY=new Function("a","b",b.join(a[1])),this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}}},{quickselect:301}]},{},[1]),function(a){"use strict";if(void 0===window.TWCCUi){var b,c=function(b){function c(b,c){var d=a("body");eb.utils.trigger(d,b,c)}function d(){return eb.utils.t.apply(this,arguments)}function e(){return eb.utils.newDeferred.apply(this,arguments)}function f(){var b={trigger:"none",showTip:function(b){a(b).fadeIn(fb)},hideTip:function(b,c){a(b).animate({opacity:0},fb,c)},shrinkToFit:!0,padding:"0px",windowMargin:"0px",fill:"rgba(0, 0, 0, .9)",cornerRadius:10,strokeWidth:1,shadow:!0,shadowOffsetX:3,shadowOffsetY:3,shadowBlur:3,shadowColor:"rgba(6,6,6,.5)",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#666",strokeWidth:1},positions:["left","top"],cssStyles:{color:"#FFF"},closeWhenOthersOpen:!0,clickAnywhereToClose:!1},c=a(".crs-list");a.extend(a.bt.defaults,b),c.first().bt({contentSelector:"$('.help-1')"}),c.last().bt({contentSelector:"$('.help-2')"}),a(".source .container").bt({contentSelector:"$('.help-3')"}),a(".source .convert-button").bt({contentSelector:"$('.help-4')"}),a(".next_button").button({icons:{secondary:"ui-icon-seek-next"}})}function g(){a(".previous.history").button({icons:{primary:"ui-icon-seek-first"},text:!1}),a("#help").button({icons:{primary:"ui-icon-help"},text:!1}),a(".next.history").button({icons:{primary:"ui-icon-seek-end"},text:!1}),a(".source .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-s"}}),a(".destination .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-n"}}),a("#converter").draggable({handle:".drag-handle"}),a('input[type="text"]',"#p-research").addClass("ui-corner-all"),a("#p-new").dialog({closeText:d("close"),modal:!0,title:d("customSystem"),width:400,autoOpen:!1}),a("#p-crs").dialog({closeText:d("close"),modal:!0,title:d("systemDefinition"),width:500,autoOpen:!1}),a("#p-research").dialog({closeText:d("close"),modal:!0,title:d("research"),width:400,autoOpen:!1}),W(0,0)}function h(){a(".button-set").buttonset(),a("#auto-zoom-toggle").button({icons:{primary:"ui-icon-zoomin"},text:!1,disabled:!0}),a("#print-map").button({icons:{primary:"ui-icon-print"},text:!1}),a("#full-screen").button({icons:{primary:"ui-icon-arrow-4-diag"},text:!1}).closest("p").toggle(null!==a(document).fullScreen()),a("#o-container").accordion({collapsible:!0,active:!1,heightStyle:"content",icons:{header:"ui-icon-gear"}}),a("#p-convention_help").dialog({closeText:d("close"),modal:!0,title:d("conventionTitle"),width:"840px",autoOpen:!1})}function i(){var b=eb.system.adsense.parameters;window.adsbygoogle=window.adsbygoogle||[],a("ins.adsbygoogle").each(function(){window.adsbygoogle.push({params:a.extend({},b)})})}function j(){var b=K(),c=a("#p-donate"),e=a("#p-loading"),f=e.find(".progressbar"),g=a(".progress-label");a(".section, .searchbtn").addClass("ui-corner-all"),a(".view").addClass("ui-corner-br ui-corner-tr"),a(".search-field").addClass("ui-corner-bl ui-corner-tl"),a("#p-poll").dialog({closeText:d("close"),modal:!0,title:d("poll"),width:500,open:function(){J("poll")},close:function(){I("poll")},autoOpen:"poll"==b}),eb.system.raterMasterSw&&!eb.context.session.userHasRatedOne&&E(!1),a("#p-contact").dialog({closeText:d("close"),modal:!0,title:d("contactUs"),width:500,open:function(){J("contact")},close:function(){I("contact")},autoOpen:"contact"==b}),a(".contact-button").button({icons:{secondary:"ui-icon-mail-closed"}}),c.find("input.dont-show-again").prop("checked",Q("p-donate")),a(".help-1").find("input.dont-show-again").prop("checked",Q("help-1")),c.dialog({closeText:d("close"),modal:!0,title:d("donate"),width:750,open:function(){J("donate")},close:function(){I("donate")},autoOpen:"donate"==b}),c.find(".progressbar").progressbar({value:eb.donations.total,max:eb.donations.max}),f.progressbar({value:!1,change:function(){g.text(Math.round(f.progressbar("value"))+"%")},complete:function(){g.text("Complete!")}}),a("#p-about").dialog({closeText:d("close"),modal:!0,title:d("about"),width:"70%",open:function(){J("about")},close:function(){I("about")},autoOpen:"about"==b}),a("body").on("history.indexchanged",function(a,b){var c=b.data;W(c.currentIndex,c.maxIndex)}),a("#p-info").dialog({closeText:d("close"),modal:!0,title:"Information",width:750,autoOpen:!0}),a("#csvFeatures").hide(),a("#language").find(">dt>a").button({icons:{secondary:"ui-icon-triangle-1-s"}}),eb.system.facebookEnabled&&(window.fbAsyncInit=function(){FB.init({appId:eb.system.facebookAppId,xfbml:!0,version:"v2.2"})},a.fn.getXDomain({url:"http://connect.facebook.net/"+eb.context.locale+"/sdk.js"})),eb.context.isDevEnv||(window.___gcfg={lang:eb.context.googlePlusLocale,parsetags:"onload"},a.fn.getXDomain({url:"https://apis.google.com/js/plusone.js"})),e.dialog({dialogClass:"no-close",modal:!0,title:d("loading"),autoOpen:!0}),a(".ui-widget-overlay").css({backgroundImage:"none",opacity:.7})}function k(a){return a.closest(".converter-container").hasClass("source")?"source":"destination"}function l(){var b=a("a.snippet"),c=16,d=a("#converter"),e=a("body");b.on("mouseenter",function(){a("body").append('<div id="Tip" style="z-index:9999;" class="ui-corner-all"><img src="'+this.href+'" alt="'+this.href+'"></div>')}),b.on("mousemove",function(b){a("#Tip").css({left:b.pageX+c,top:b.pageY+c}).show()}),b.on("mouseout",function(){a("#Tip").remove()}),b.click(function(a){a.preventDefault()}),a(".search-crs").click(function(b){var c=k(a(this));b.preventDefault(),a("#select").val(c),a("#p-research").dialog("open")}),d.on("converter.info",H),d.on("click",".show-p-new",function(b){var c=k(a(this));b.preventDefault(),a('#new-form input[name="target"]').val(c),a("#p-new").dialog("open")}),e.on("click","#view-reference",function(b){var c="http://spatialreference.org/ref/?search="+encodeURIComponent(a("#find-reference").val());b.preventDefault(),window.open(c)}),e.on("submit","#reference-form",function(b){b.preventDefault(),a("#view-reference").click()}),a("#crsResult").on("change",function(b){C(a(b.target).val())}),a("#research").click(function(a){a.preventDefault(),B()}),bb.clip(d.find(".octicon-clippy")),bb.on("copy",function(b){var c=a(b.target),d=c.closest(".converter-container");d.length&&bb.setData("text/plain",d.converter("value").toString())})}function m(){a("#help").animate({opacity:"hide"},fb),a(".crs-list").first().btOn()}function n(){Q("help-1")||m()}function o(){a(".close_button, .help-4 .next_button").click(function(b){b.preventDefault(),a("#help").animate({opacity:"show"},fb)}),a(".next_button").click(function(a){a.preventDefault()}),a(".close_button",".help-1").click(function(){a(".crs-list").first().btOff()}),a(".close_button",".help-2").click(function(){a(".crs-list").last().btOff()}),a(".close_button",".help-3").click(function(){a(".source .container").btOff()}),a(".close_button, .next_button",".help-4").click(function(){a(".source .convert-button").btOff()}),a(".next_button",".help-1").click(function(){a(".crs-list").last().btOn()}),a(".next_button",".help-2").click(function(){a(".source .container").btOn()}),a(".next_button",".help-3").click(function(){a(".source .convert-button").btOn()}),a(".help-1").find("input.dont-show-again").on("change",function(){P("help-1",a(this)[0].checked)}),a("#help").click(function(){event.preventDefault(),m()})}function p(){var b=a(".dropdown dd ul"),c=a(".dropdown dt a");c.click(function(a){a.preventDefault(),b.slideToggle(200)}),b.find("li a").click(function(d){var e,f;d.preventDefault(),e=a(this).html(),f=a(this).parent().find("span.value").text(),c.find("span").html(e),b.hide(),document.location.href=a(this).prop("href")}),a(document).click(function(c){var d=a(c.target);d.parents().hasClass("dropdown")||b.hide()})}function q(){a(".convention").click(function(b){b.preventDefault(),a("#p-convention_help").dialog("open")}),a("#print-map").click(function(a){a.preventDefault(),eb.utils.openStaticMap()}),a("#full-screen").click(function(a){a.preventDefault(),c("ui.full_screen")}),a("#auto-zoom-toggle").click(function(){eb.utils.enableAutoZoom(a(this).is(":checked"))}),a('input[name="csv"]').click(function(){var b=!!+a(this).val();S(b),c("ui.csv_changed",b)}),a('input[name="convention"]').click(function(){V(!!+a(this).val())}),a("body").on("converterset.csv_changed main.ready",function(a,b){var c=void 0===b.data?b.csv:b.data.csv;R(c),S(c)})}function r(){var b=a("body");a(".toggle-next").click(function(b){b.preventDefault(),a(this).parent().find(".toogle-me").toggle()}),a(document).on("fullscreenchange",function(){O(),X()}),a(document).on("mousemove",function(a){Y(a.target,".trsp-panel, #converter")}),b.on("click",".show-p-poll",function(a){a.preventDefault(),E()}),b.on("mousedown","#view-map, .donate_btn, .about, converter.info, .convert-button, .contact, .search-crs, .show-p-new",function(){O()}),b.on("map.metrics_changed",function(a,b){y(b.data)}),b.on("map.tiles_loaded",function(){i()}),b.on("converter.changed",function(a,b){U(b.data.magneticDeclinationInDegrees)}),a("#p-donate").find("input.dont-show-again").on("change",function(){P("p-donate",a(this)[0].checked)}),a(".donate_btn").click(function(b){b.preventDefault(),a("#p-donate").dialog("open")}),a(".about").click(function(b){b.preventDefault(),a("#p-about").dialog("open")}),b.one("main.ready",function(){setTimeout(w,800)}),b.on("main.start",x),b.on("main.failed",{message:": failure! "+d("contactUs"),className:"failure"},function(){x.apply(this,arguments),w()}),b.on("main.succeeded",{message:": success.",className:"success"},function(){var b=a("#p-loading").find(".progressbar"),c=b.progressbar("value")||0;x.apply(this,arguments),b.progressbar("value",c+20)}),b.on("click",".ui-widget-overlay",function(){O()})}function s(b){a(".contact").click(function(b){b.preventDefault(),a("#p-contact").dialog("open")}),b||(a("#contact-form").on("submit",function(b){b.preventDefault(),a("#send-message").click()}),a("#send-message").click(function(b){b.preventDefault(),a("#p-contact").dialog("close"),L()&&M()}))}function t(){var b=27,d=122;a(document).keyup(function(a){switch(a.keyCode){case b:a.preventDefault(),O();break;case d:a.preventDefault(),c("ui.full_screen")}})}function u(){ZeroClipboard.config({swfPath:"/js/vendor/ZeroClipboard.swf"}),bb=new ZeroClipboard,bb.on("ready",function(){bb.on("aftercopy",function(b){a(b.target).animate({opacity:.3},500,function(){a(this).animate({opacity:1},500)}),c("clipboard.aftercopy")})})}function v(){g(),h(),f(),j(),u(),l(),q(),o(),r(),s(),p(),t()}function w(){var b=a("#p-loading");b.find(".failure").length?b.closest(".no-close").find(".ui-dialog-titlebar-close").show():(b.dialog("close"),Q("p-donate")||eb.context.GET.isSetNoDonate||a("#p-donate").dialog("open")),a(".ui-widget-overlay").removeAttr("style")}function x(b,c){var d,e=c.data,f=e.name,g=a("#p-loading .logs"),h="loading-"+f.toLowerCase().replace(/\s/gi,"-"),i=b.data,j=e.message?": "+e.message:i?i.message:void 0;if(!g.find("."+h).length){var k=a("<div>",{"class":h}).text("Loading "+f);g.append(k)}d=g.find("."+h),i&&j&&i.className&&d.length&&!d.hasClass(i.className)&&d.addClass(i.className).append(j)}function y(a){void 0!==a&&(z(a.length),A(a.area))}function z(b){var c=d("unitMeter"),e=0;b&&void 0!==b?(b>999&&(c=d("unitKilometer"),b/=1e3,e=1),a("#lengthContainer").text(eb.math.round(b,e).toString()+c)):a("#lengthContainer").text("-"+c)}function A(b){var c=d("unitMeter")+"<sup>2</sup>",e=0;b&&void 0!==b?(b>999999&&(c=d("unitKilometer")+"<sup>2</sup>",b/=1e6,e=1),a("#areaContainer").html(eb.math.round(b,e).toString()+c)):a("#areaContainer").html("-"+c)}function B(){var b=a("#crsResult");b.html('<option value="#" class="disabledoption">'+d("loading")+"</option>").prop("disabled",!0),a.post(eb.system.httpServer+"/"+eb.system.dirWsIncludes+"c.php",{l:eb.context.languageCode,i:a("#crsCountry").val(),c:a("#crsCode").val(),n:a("#crsName").val(),f:""}).done(function(c){b.html(""),a(c).length?(b.prop("disabled",!1),a.each(c,function(b,c){a.each(c,function(c,d){eb.utils.addOptionToSelect(b,c,a("#crsResult"),d.def)})})):b.append(a("<option>",{val:"",text:d("resultEmpty"),classname:"disabledoption"}))}).fail(function(){b.html(""),b.append(a("<option>",{val:"",text:d("resultEmpty"),classname:"disabledoption"}))})}function C(b){var c=a("#select").val();a("#closeSearch").prop("checked")&&a("#p-research").dialog("close"),App.TWCCConverter.setSelection(c,b)}function D(){return'<div class="loading"><img src="'+eb.system.dirWsImages+'loading.gif" alt="" width="35" height="35">'+d("loading")+"</div>"}function E(b){b=void 0===b?!0:b,a("#poll-info").html(D()),b&&O(),a("#p-poll").dialog("open"),F()}function F(b){b=b||"",a("#poll-info").html(D()),a.post(eb.system.dirWsModules+"rater/forms.php","rater=true&"+b,G)}function G(b){var c=a("#poll-info");c.html(b),c.find("form").each(function(){a(this).on("submit",function(b){b.preventDefault(),F(a(this).serialize())}),s(!0)})}function H(b,c){var d=a("#crs-info");d.html(D()),a.post(eb.system.dirWsIncludes+"crs_info.php",{c:c.srsCode,d:c.definitionString,l:eb.context.languageCode},function(a){d.html(a)}),a("#p-crs").dialog("open")}function I(){window.location.hash=""}function J(a){window.location.hash="#"+a}function K(){return window.location.hash.replace("#","")}function L(){return a("#message").val().length<1?(alert(d("messageNotSent")+"empty msg."),a("#p-contact").dialog("open"),!1):a("#email").val().length<1?(alert(d("messageWrongEmail")),a("#p-contact").dialog("open"),!1):!0}function M(){eb.utils.sendMsg(a("#message").val(),a("#email").val(),N)}function N(b){switch(b){case"1":alert(d("messageSent"));break;case"-3":alert(d("messageWrongEmail"));break;default:alert(d("messageNotSent")+b)}"1"==b?(a("#email").val(""),a("#message").val("")):a("#p-contact").dialog("open")}function O(){a(".crs-list, .source .container, .source .convert-button").each(function(){a(this).btOff()}),a("#help").animate({opacity:"show"},fb),a("#p-new").dialog("close"),a("#p-contact").dialog("close"),a("#p-about").dialog("close"),a("#p-crs").dialog("close"),a("#p-poll").dialog("close"),a("#p-info").dialog("close"),a("#p-donate").dialog("close"),a("#p-research").dialog("close"),a("#p-convention_help").dialog("close")}function P(a,b){eb.utils.setCookieParam(eb.system.preferencesCookie,a,b,7)}function Q(a){return eb.utils.getCookieParam(eb.system.preferencesCookie,a)}function R(b){b!==T()&&(a('input[name="csv"][value="'+ +b+'"]').prop("checked",!0),a(".csv-radio").buttonset("refresh"))}function S(b){b=!!b,a("#manualFeatures").toggle(!b),a("#csvFeatures").toggle(b),b?(a("#auto-zoom-toggle").button("enable"),a(".convention-radio").buttonset("disable"),y()):(a("#auto-zoom-toggle").button("disable"),a(".convention-radio").buttonset("enable"))}function T(){return!!+a('input[name="csv"]:checked').val()}function U(b){var c=void 0===b?"":eb.math.round(b,4).toString();a("#magneticDeclinationContainer").text(c)}function V(a){db=a,c("ui.convergence_changed")}function W(b,c){var d=0,e=c>b,f=b>d;a(".previous.history").button("option","disabled",!f),a(".next.history").button("option","disabled",!e)}function X(){a(document).fullScreen()?a(".trsp-panel, .spare, #converter, #h-container").fadeOut():a(".trsp-panel, .spare, #converter, #h-container").fadeIn()}function Y(b,c){a(document).fullScreen()&&(a(c).is(":hidden")?a(c).fadeIn():a(b).closest(c).length?clearInterval(gb[c]):(clearInterval(gb[c]),gb[c]=setTimeout(function(){a(document).fullScreen()&&a(c).fadeOut()},1e3)))}function Z(){"undefined"==typeof blockAdBlock?$():blockAdBlock.onDetected($).onNotDetected(_)}function $(){cb.reject(d("pleaseDisableYourAdblock"))}function _(){cb.resolve()}function ab(){cb=e("UI"),v(),Z()}var bb,cb=null,db=!0,eb=a.extend(!0,{},b),fb=250,gb={};return ab(),{promise:cb.promise(),getConvergenceConvention:function(){return db},startHelp:n}};window.TWCCUi={getInstance:function(a){return b=b||c(a)}}}}(jQuery),function(a){"use strict";if(void 0===window.TWCCConverter){var b,c=function(b){function c(){return t.utils.t.apply(this,arguments)}function d(){return t.utils.newDeferred.apply(this,arguments)}function e(a){return c("errorContactUs").replace("%s",a.status.toString())}function f(b,d){var e="",f=new RegExp("\\+title=[^\\+]+","i");return""===b?"":(b=b.toString().replace(f,""),a.each(r.options.definitions,function(g,h){return a.each(h,function(a,h){var i=h.def||"";return a.toUpperCase()==b.toUpperCase()||i.toUpperCase().replace(f,"")==b.toUpperCase()?(e=c("crsAlreadyExists")+g+" > "+(i?t.utils.getTitleFromDefinitionString(i,a):a),o(d,a),!1):void 0}),""!==e?!1:void 0}),e)}function g(a,b){var c,d={"*[UD]":{}};return d["*[UD]"][b]={def:a,isConnector:!1},c=r.mergeDefinitions(d)}function h(b,c){alert(b),a("#loadingxtra").hide(),a("#new-form").show(),c?s--:(a("#p-new").dialog("close"),a("#find-reference").val(""),a("#add-reference").val(""))}function i(a,b,c){var d=a.split(":");return c=c||!1,b.replace(/\$\{\d\}/gi,function(a){a=a.match(/\d+/)[0];var b=d[a]||a;return c?b.toUpperCase():b.toLowerCase()})}function j(a,b,c){window.Proj4js={defs:{}},b(c).done(function(){m(Proj4js.defs[a])}).fail(function(a){h(e(a),!0)}).always(function(){delete window.Proj4js})}function k(b){var c=i(b,"http://spatialreference.org/ref/${0}/${1}/proj4js/");window.Proj4js={defs:{}},j(b,a.fn.getXDomain,{url:c})}function l(b){var c=i(b,"/js/data/defs/${0}${1}.js",!0);j(b,a.ajax,{url:c,cache:!0,dataType:"script"})}function m(b){var d,e,i,j,m,p=a("#new-form input[name='target']").val(),q=b.toUpperCase(),r=0===q.indexOf("EPSG:"),u=0===q.indexOf("ESRI:"),v=0===q.indexOf("IAU2000:"),w=0===q.indexOf("SR-ORG:"),x=0===q.indexOf("IGNF:");if(a("#new-form").hide(),a("#loadingxtra").show(),j=f(b,p))return void h(j);if(r||u||v||w)e=q,k(e);else if(x)e=q,l(e);else{if(i=b.match(new RegExp('^[^\\[]+\\["([^\\]]+)"\\][\\s=]+"([^"]+)";$',"i")),null!==i&&(b=i[2]),d=t.utils.getTitleFromDefinitionString(b,""),s++,e="UD"+s,void 0===d&&(d=c("undefinedTitle"),b="+title="+d+" "+b),m=e+" "+d,b=b.replace("+title="+d,"+title="+m),j=f(e,p),j||(j=f(b,p)),j)return void h(j);
g(b,e).done(function(){a("#loadingxtra").hide(),a("#new-form").show();var d=o(p);try{o(p,e),alert(c("newSystemAdded")+'"'+m+'".'),a("#p-new").dialog("close"),a("#find-reference").val(""),a("#add-reference").val(""),t.utils.sendMsg("New user-defined system:\n\r"+e+' = "'+b+'"')}catch(f){s--,o(p,d),n(e),alert(""===b?c("errorContactUs").replace("%s","-2 (NotFound)"):c("errorContactUs").replace("%s","-1 (WrongFormat:"+b+")"))}})}}function n(a){r.unloadCRS(a)}function o(a,b){a=a.toLowerCase();var c="pushPull"+a.charAt(0).toUpperCase()+a.slice(1);return r[c]("selection",b)}function p(){var b=t.context.converter,f=b.defaultSourceSrs,g=b.defaultDestSrs,h=b.defaultWgs84,i=!(""===h||""===h.x||""===h.y),j=a("#converter"),k=a("body"),l={units:{dms:{D:c("unitDegree"),M:c("unitMinute"),S:c("unitSecond")},dd:{x:{DD:c("unitDegreeEast")},y:{DD:c("unitDegreeNorth")}},cartesian:{XY:{m:c("unitMeter"),km:c("unitKilometer"),"us-ft":c("unitFeet")},CONVERGENCE:c("unitDegree")}},labels:{spherical:{x:c("labelLng"),y:c("labelLat"),convergence:c("labelConvergence")},cartesian:{x:c("labelX"),y:c("labelY"),z:c("labelZone"),h:c("labelHemi"),convergence:c("labelConvergence")},csv:{csv:c("labelCsv"),l:c("labelFormat")}},options:{x:{E:c("optionE"),W:c("optionW")},y:{N:c("optionN"),S:c("optionS")},o:{_DMS:c("optionDMS"),_DM:c("optionDM"),_DD:c("optionDD")},h:{n:c("optionNorth"),s:c("optionSouth")},u:{_M:c("optionM"),_KM:c("optionKM"),_F:c("optionF")}}};b.fromUrl&&!i&&alert("Invalid URL"),h=b.fromUrl&&i?[h]:b.fromRss?[{x:10,y:10}]:null,t.context.converter.fromUrl=!1,t.context.converter.fromRss=!1,q=d("Converter"),r=j.converterSet({units:l.units,labels:l.labels,options:l.options,wgs84:h,defaultWgs84:[t.utils.getRandomCityLocation()],value:{x:0,y:0},selections:{source:f,destination:g},url:t.system.httpServer+"/"+t.system.dirWsIncludes+"c.php"}).data("twccConverterSet"),j.one("converterset.done",function(a,b){q.resolve(b)}),j.on("converterset.fail",function(a,b){var c=e.call(null,b);alert(c)}),k.on("click","#new-reference",function(b){b.preventDefault();var c=a("#add-reference").val();m(c)}),k.on("submit","#new-form",function(b){b.preventDefault(),a("#new-reference").click()}),k.on("ui.convergence_changed",function(){r.setConvergence()}),k.on("ui.csv_changed",function(a,b){r.csv(b.data)}),a(".to-remove").remove()}var q=null,r=null,s=0,t=a.extend(!0,{},b);return p(),{promise:q.promise(),converterWidget:r,setSelection:o}};window.TWCCConverter={getInstance:function(a){return b=b||c(a)}}}}(jQuery),function(a,b,c,d){"use strict";!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(a,b,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-17790812-2","auto"),ga("send","pageview"),c(b).ready(function(){function a(a){var b=c(a.target),d=b.find("option:selected").text();j("select","change",d)}function b(a){var b=c(a.target),d=(b.closest("div.section").find('select[name^="crs"] option:selected').text(),b.val());j("radio","click",d)}function e(a){var b=c(a.target),d=b.prop("name");j("radio","click",d)}function f(){j("clipboard","click")}function g(){j("clipboard","success")}function h(){j("converter","changed")}function i(){var a=(new Date).getTime(),b=a-d.context.startTime;k("TWCC","Render infowindow",b),j("infowindow","opened")}function j(a,b,c,d){try{ga("send","event",a,b,c,d)}catch(e){}}function k(a,b,c,d){try{ga("send","timing",a,b,c,d)}catch(e){}}var l=c("body");l.on("change",".crs-list",a),l.on("click",'#converter input[type="radio"]',b),l.on("click",'#o-container input[type="radio"]',e),l.on("click",".octicon-clippy",f),l.on("clipboard.aftercopy",g),l.on("converter.changed",h),l.one("infowindow.dom_ready",i),l.one("main.ready",function(a,b){var c=void 0===b.data?b.csv:b.data.csv;c&&l.off("infowindow.dom_ready",i)})})}(window,document,jQuery,App);