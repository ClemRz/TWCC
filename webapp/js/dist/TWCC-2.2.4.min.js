/*!  * TWCC - Version 2.2.4
 * The World Coordinate Converter
 * Author: Clément Ronzon - clem.rz@gmail.com
 * Build date: 2020-07-27 07:47:44
 * Copyright (c) 2020 
 * Released under the AGPL-3.0 license
 *
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 Clément Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */

function d(t){var e,i;return this.length?((e=this[0]).ownerDocument?i=e.ownerDocument:e=(i=e).documentElement,null==t?i.cancelFullScreen||i.webkitCancelFullScreen||i.mozCancelFullScreen?(t=!!i.fullScreen||!!i.webkitIsFullScreen||!!i.mozFullScreen)&&(i.fullScreenElement||i.webkitCurrentFullScreenElement||i.mozFullScreenElement)||t:null:(t?(t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen)&&t.call(e,Element.ALLOW_KEYBOARD_INPUT):(t=i.cancelFullScreen||i.webkitCancelFullScreen||i.mozCancelFullScreen)&&t.call(i),this)):this}var e,f,g;!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ClipboardJS=e():t.ClipboardJS=e()}(this,function(){return r={},n.m=i=[function(t,e,i){var n,r,o;r=[t,i(7)],void 0!==(o="function"==typeof(n=function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(t){return t&&t.__esModule?t:{default:t}}(e),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=function(){function e(t){i(this,e),this.resolveOptions(t),this.initSelection()}return o(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,n.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,n.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":r(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),e}();t.exports=s})?n.apply(e,r):n)&&(t.exports=o)},function(t,e,i){var d=i(6),p=i(5);t.exports=function(t,e,i){if(!t&&!e&&!i)throw new Error("Missing required arguments");if(!d.string(e))throw new TypeError("Second argument must be a String");if(!d.fn(i))throw new TypeError("Third argument must be a Function");if(d.node(t))return r=e,o=i,(n=t).addEventListener(r,o),{destroy:function(){n.removeEventListener(r,o)}};var n,r,o,s,a,l,u,h,c;if(d.nodeList(t))return s=t,a=e,l=i,Array.prototype.forEach.call(s,function(t){t.addEventListener(a,l)}),{destroy:function(){Array.prototype.forEach.call(s,function(t){t.removeEventListener(a,l)})}};if(d.string(t))return u=t,h=e,c=i,p(document.body,u,h,c);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(t,e){function i(){}i.prototype={on:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){function n(){r.off(t,n),e.apply(i,arguments)}var r=this;return n._=e,this.on(t,n,i)},emit:function(t){for(var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),n=0,r=i.length;n<r;n++)i[n].fn.apply(i[n].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),n=i[t],r=[];if(n&&e)for(var o=0,s=n.length;o<s;o++)n[o].fn!==e&&n[o].fn._!==e&&r.push(n[o]);return r.length?i[t]=r:delete i[t],this}},t.exports=i},function(t,e,i){var n,r,o;r=[t,i(0),i(2),i(1)],void 0!==(o="function"==typeof(n=function(t,e,i,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){var i="data-clipboard-"+t;if(e.hasAttribute(i))return e.getAttribute(i)}var u=r(e),h=r(i),c=r(n),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),f=function(t){function n(t,e){o(this,n);var i=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return i.resolveOptions(e),i.listenClick(t),i}return a(n,t),p(n,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===d(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,c.default)(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new u.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return l("action",t)}},{key:"defaultTarget",value:function(t){var e=l("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return l("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,i=!!document.queryCommandSupported;return e.forEach(function(t){i=i&&!!document.queryCommandSupported(t)}),i}}]),n}(h.default);t.exports=f})?n.apply(e,r):n)&&(t.exports=o)},function(t,e){var i;"undefined"==typeof Element||Element.prototype.matches||((i=Element.prototype).matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector),t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},function(t,e,i){function o(t,e,i,n,r){var o=function(e,i,t,n){return function(t){t.delegateTarget=s(t.target,i),t.delegateTarget&&n.call(e,t)}}.apply(this,arguments);return t.addEventListener(i,o,r),{destroy:function(){t.removeEventListener(i,o,r)}}}var s=i(4);t.exports=function(t,e,i,n,r){return"function"==typeof t.addEventListener?o.apply(null,arguments):"function"==typeof i?o.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,function(t){return o(t,e,i,n,r)}))}},function(t,i){i.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},i.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||i.node(t[0]))},i.string=function(t){return"string"==typeof t||t instanceof String},i.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e){t.exports=function(t){var e,i,n,r="SELECT"===t.nodeName?(t.focus(),t.value):"INPUT"===t.nodeName||"TEXTAREA"===t.nodeName?((e=t.hasAttribute("readonly"))||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),e||t.removeAttribute("readonly"),t.value):(t.hasAttribute("contenteditable")&&t.focus(),i=window.getSelection(),(n=document.createRange()).selectNodeContents(t),i.removeAllRanges(),i.addRange(n),i.toString());return r}}],n.c=r,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3);function n(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var i,r}),function(p){"use strict";var e,i;void 0===window.TWCCHistory&&(i=function(t){var i,n,r=p.extend(!0,{},t),o=!0,s=r.system.historyCookie,a=0,l=r.system.historyLimit;function u(t){i=t}function h(){return i.length-1}function c(t){n=Math.min(Math.abs(t),l),r.utils.trigger(p("body"),"history.indexchanged",{currentIndex:t,maxIndex:h(),currentValue:d()})}function d(){return i[n]}function e(t){return c(t),d()}return i=r.utils.getCookieContent(s),p.isEmptyObject(i)&&(i=[]),c(h()),{toggle:function(t){o=t},isEnabled:function(){return o},add:function(t){var e;o&&t&&(t.wgs84=function t(e){var i,n;if(null===e||"object"!=typeof e)return e;for(n in i=e.constructor(),e)e.hasOwnProperty(n)&&(i[n]=t(e[n]));return i}(t.wgs84),JSON.stringify(t)!==JSON.stringify(d())&&(u(i.slice(a,n+1)),e=t,i.push(e),u(i.slice(-l)),c(h()),r.utils.setCookieContent(s,i)))},moveToPrevious:function(){return a<n?e(n-1):d()},moveToNext:function(){return n<h()?e(n+1):d()},getCurrentValue:d}},window.TWCCHistory={getInstance:function(t){return e=e||i(t)}})}(jQuery),function(a,l){"use strict";var e,i,n=l.locations.capitals;function o(t){return l.translations.hasOwnProperty(t)?l.translations[t]:t}function s(t,e,i){t.trigger(e,{data:i})}function r(t){return a.cookie(t)}function u(t,e,i){i=i||30,a.cookie(t,e,{expires:i})}function h(t,e,i){u(t,JSON.stringify(e),i)}function c(t){return r(t)?a.parseJSON(r(t)):{}}function d(t,e){var i,n,r,o,s;i=l.system.preferencesCookie,n=t,r=e,o=7,(s=c(i))[n]=r,h(i,s,o)}function p(t){return e=l.system.preferencesCookie,i=t,c(e)[i];var e,i}function f(){var t=a("#map");t.on("linestring.edit_end",function(t,e){!function(t){b()||l.TWCCUi.setCsvMode(!0);_(t.map(v))}(e.data)}),t.on("map.click",function(t,e){y(e.data)}),t.on("marker.drag_end",function(t,e){y(e.data)}),t.on("linestring.add_vertice",function(t,e){var i;b()&&((i=m()).push(v(e.data)),_(i))}),t.on("linestring.remove_vertice",function(t,e){var i;b()&&(i=v(e.data),_(m().filter(function(t){return!(t.x===i.x&&t.y===i.y)})))}),t.on("place.changed",function(t,e){y(e.data)}),t.on("map.layer.change",function(t,e){var i=e.data.split(" "),n=p("layers")||{};-1<i.indexOf("on")||-1<i.indexOf("off")?(n.hasOwnProperty("opt")||(n.opt={}),n.opt[i[1]]="on"===i[2]):(n.base={},n.base[i[0]]=i[1]),d("layers",n)})}function g(t,e){return/\+title=/gi.test(t)?t.replace(/.*\+title=([^\+]+).*/gi,"$1"):e}function m(){return e.wgs84().slice()}function y(t){_([v(t)])}function _(t){e.transform({wgs84:t})}function v(t){return{x:t[0],y:t[1]}}function b(){return e.csv()}function j(){l.initialisers.initializeMap().done(t)}function t(){l.initialisers.initializeConverter().done(function(t){l.context.GET.isSetGraticule&&l.TWCCMap.setGraticule(),l.TWCCUi.startHelp(),s(a("body"),"main.ready",t)})}a.fn.extend({sort:function(){return this.pushStack([].sort.apply(this,arguments),[])},sortOptions:function(t){return jQuery("option",this).sort(t).appendTo(this),this},sortGroups:function(t){return jQuery("optgroup",this).sort(t).appendTo(this),this},sortOptionsByText:function(){return this.sortOptions(function(t,e){var i=jQuery(t).text().toUpperCase(),n=jQuery(e).text().toUpperCase();return i<n?-1:n<i?1:0})},sortOptgroupsByLabel:function(){return this.sortGroups(function(t,e){var i=jQuery(t).prop("label").toUpperCase(),n=jQuery(e).prop("label").toUpperCase();return i<n?-1:n<i?1:0})},sortGrpsNOptionsByText:function(){var e=this;return a("optgroup",this).each(function(t){a("optgroup:eq("+t+")",e).sortOptionsByText()}),this.sortOptgroupsByLabel()},getXDomain:function(t){var e=l.system.httpServer+"/"+l.system.dirWsIncludes+"proxy.php",i=t.data?"?"+a.param(t.data,!0):"";return a.ajax(a.extend({dataType:"script"},t,{url:e,cache:!0,data:{u:t.url+i}}))}}),a.extend(l,{utils:{addOptionToSelect:function(t,e,i,n){var r=proj4.defs(e),o=r?r.title||e:g(n,e),s='optgroup[label="'+t+'"]';i.find(s).length||i.append(a("<optgroup>",{label:t})),i.find(s).append(a("<option>",{val:e,text:o}))},degToRad:function i(t){var n;switch(a.type(t)){case"object":n={},a.each(t,function(t,e){if(e&&"number"!==a.type(e))throw"Wrong data type";n[t]=i(e)});break;case"number":n="number"===a.type(t)?t*Math.PI/180:void 0}return n},enableAutoZoom:function(t){l.TWCCMap.model.setBoolean("autoZoom",t)},getConvergenceConvention:function(){return l.TWCCUi.getConvergenceConvention()},getCookieContent:c,getPreferenceCookie:p,getRandomCityLocation:function(){var t=l.math.getRandomInteger(0,n.length-1);return{x:n[t].lng,y:n[t].lat}},getTitleFromDefinitionString:g,getWMM:function(){return i},newDeferred:function(e,i,n){var t,r,o=new a.Deferred(function(){s(a("body"),"main.start",{name:e})});return i=i||l.system.timeout,n=n||0,setTimeout(function t(){0<n?(n--,o.notify("retry"),setTimeout(t,i)):o.reject(e+" timed out")},i),setTimeout(function t(){"pending"===o.state()&&(o.notify(e+" pending"),setTimeout(t,500))},1),t=o,r=e,a.when(t).then(function(){s(a("body"),"main.succeeded",{name:r})},function(t){s(a("body"),"main.failed",{name:r,message:t})},function(t){s(a("body"),"main.progress",{name:r,message:t})}),o},radToDeg:function(t){return"number"===a.type(t)?180*t/Math.PI:void 0},sendMsg:function(t,e,i){var n,r;return e=e||l.system.applicationNoreply,r=l.system.httpServer+"/"+l.system.dirWsIncludes+"s.php",(n=a.ajax({type:"POST",url:r,async:!1,cache:!1,data:"ff=g"}).responseText).length<10?(alert(o("messageNotSent")+n),!1):(u(l.system.tokenName,n),a.post(r,{ff:"d",f:e,b:t,l:l.context.languageCode},function(t){"function"==typeof i&&i(t)}),!0)},setCookie:u,setCookieContent:h,setPreferenceCookie:d,t:o,trigger:s}}),a.extend(l,{constants:{keyboard:{RETURN:13}}}),a.extend(l,{Class:function(t){function e(){this.initialize.apply(this,arguments)}for(var i in t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i]);return e.prototype.initialize=e.prototype.initialize||function(){},e}}),a.extend(l,{initialisers:{initializeMap:function(){var t=a.extend(!0,{},l,l.TWCCMapOptions);return delete t.TWCCMapOptions,l.TWCCMap=window.TWCCMap.getInstance(t),l.map=l.TWCCMap.getMap(),f(),l.TWCCMap.promise},initializeUi:function(){var t=a.extend(!0,{},l);return l.TWCCUi=window.TWCCUi.getInstance(t),l.TWCCUi.promise},initializeConverter:function(){var t=a.extend(!0,{},l,l.TWCCConverterOptions);return delete t.TWCCConverterOptions,l.TWCCConverter=window.TWCCConverter.getInstance(t),e=l.TWCCConverter.converterWidget,l.TWCCConverter.promise}}}),a(document).ready(function(){var t="*GPS (WGS84) (deg)",e={title:t,defData:"+title="+t+" +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees",isConnector:!1};"function"!==a.type(Math.sinh)&&(Math.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2}),a.ajax({url:"/js/data/WMM.COF",cache:!0,dataType:"text"}).done(function(t){i=geoMagFactory(cof2Obj(t))}).fail(function(){i=function(){return{}}}),a.extend(proj4.WGS84,e),a.extend(proj4.defs("WGS84"),e),l.initialisers.initializeUi().done(j)})}(jQuery,App),function(t,e){"use strict";function n(t){return t=t.toString().replace(/,/gi,"."),isNaN(t)&&(t=0),parseFloat(t)}t.extend(e,{math:{getRandomInteger:function(t,e){var i=e-t,n=t,r=Math.random()*i+n;return Math.round(r)},round:function(t,e){var i;return e=void 0===e?0:e,""===(i=t.toString())||"NaN"==i?"":Math.round(n(t)*Math.pow(10,n(e)))/Math.pow(10,n(e))},parseFloat:n}})}(jQuery,App),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(o){function s(t){return t&&t.constructor===Number?t+"px":t}o.fn.bgiframe=function(n){var t;n=o.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;",conditional:/MSIE 6\.0/.test(navigator.userAgent)},n),o.isFunction(n.conditional)||(t=n.conditional,n.conditional=function(){return t});var r=o('<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+n.src+'"style="display:block;position:absolute;z-index:-1;"/>');return this.each(function(){var t,e,i=o(this);!1!==n.conditional(this)&&((e=0===(t=i.children("iframe.bgiframe")).length?r.clone():t).css({top:"auto"==n.top?-1*(parseInt(i.css("borderTopWidth"),10)||0)+"px":s(n.top),left:"auto"==n.left?-1*(parseInt(i.css("borderLeftWidth"),10)||0)+"px":s(n.left),width:"auto"==n.width?this.offsetWidth+"px":s(n.width),height:"auto"==n.height?this.offsetHeight+"px":s(n.height),opacity:!0===n.opacity?0:void 0}),0===t.length&&i.prepend(e))})},o.fn.bgIframe=o.fn.bgiframe}),jQuery.bt={version:"0.9.5-rc1"},function($){jQuery.fn.bt=function(content,options){var contentSelect,contentSelect;return"string"!=typeof content?(contentSelect=!0,options=content,content=!1):contentSelect=!1,jQuery.fn.hoverIntent&&"hover"==jQuery.bt.defaults.trigger&&(jQuery.bt.defaults.trigger="hoverIntent"),this.each(function(index){var opts=jQuery.extend(!1,jQuery.bt.defaults,jQuery.bt.options,options);opts.spikeLength=numb(opts.spikeLength),opts.spikeGirth=numb(opts.spikeGirth),opts.overlap=numb(opts.overlap);var ajaxTimeout=!1,hoverOpts;opts.killTitle&&$(this).find("[title]").addBack().each(function(){$(this).prop("bt-xTitle")||$(this).prop("bt-xTitle",$(this).prop("title")).prop("title","")}),"string"==typeof opts.tpropigger&&(opts.trigger=[opts.trigger]),"hoverIntent"==opts.trigger[0]?(hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn()},out:function(){this.btOff()}}),$(this).hoverIntent(hoverOpts)):"hover"==opts.trigger[0]?$(this).hover(function(){this.btOn()},function(){this.btOff()}):"now"==opts.trigger[0]?$(this).hasClass("bt-active")?this.btOff():this.btOn():"none"==opts.trigger[0]||(1<opts.trigger.length&&opts.trigger[0]!=opts.trigger[1]?$(this).bind(opts.trigger[0],function(){this.btOn()}).bind(opts.trigger[1],function(){this.btOff()}):$(this).bind(opts.trigger[0],function(){$(this).hasClass("bt-active")?this.btOff():this.btOn()})),this.btOn=function(){var url,url,off,selector,cacheData,target,ajaxOpts;"object"==typeof $(this).data("bt-box")&&this.btOff(),opts.preBuild.apply(this),$(jQuery.bt.vars.closeWhenOpenStack).btOff(),$(this).addClass("bt-active "+opts.activeClass),contentSelect&&null==opts.ajaxPath&&(opts.killTitle&&$(this).prop("title",$(this).prop("bt-xTitle")),content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector),opts.killTitle&&$(this).prop("title","")),null!=opts.ajaxPath&&0==content&&("object"==typeof opts.ajaxPath?(url=eval(opts.ajaxPath[0]),url+=opts.ajaxPath[1]?" "+opts.ajaxPath[1]:""):url=opts.ajaxPath,off=url.indexOf(" "),0<=off&&(selector=url.slice(off,url.length),url=url.slice(0,off)),cacheData=opts.ajaxCache?$(document.body).data("btCache-"+url.replace(/\./g,"")):null,content="string"==typeof cacheData?selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData:(target=this,ajaxOpts=jQuery.extend(!1,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(t,e){content="success"==e||"notmodified"==e?(opts.ajaxCache&&$(document.body).data("btCache-"+url.replace(/\./g,""),t.responseText),ajaxTimeout=!1,selector?$("<div/>").append(t.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):t.responseText):("timeout"==e&&(ajaxTimeout=!0),opts.ajaxError.replace(/%error/g,t.statusText)),$(target).hasClass("bt-active")&&target.btOn()}},opts.ajaxOpts),jQuery.ajax(ajaxOpts),opts.ajaxLoading));var shadowMarginX=0,shadowMarginY=0,shadowShiftX=0,shadowShiftY=0,offsetParent,offsetParentPos,pos,top,left,offsetParent,pos,top,left;opts.shadow&&!shadowSupport()&&(opts.shadow=!1,jQuery.extend(opts,opts.noShadowOpts)),opts.shadow&&(shadowMarginX=opts.shadowBlur>Math.abs(opts.shadowOffsetX)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetX),shadowShiftX=0<opts.shadowBlur-opts.shadowOffsetX?opts.shadowBlur-opts.shadowOffsetX:0,shadowMarginY=opts.shadowBlur>Math.abs(opts.shadowOffsetY)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetY),shadowShiftY=0<opts.shadowBlur-opts.shadowOffsetY?opts.shadowBlur-opts.shadowOffsetY:0),left=opts.offsetParent?(offsetParent=$(opts.offsetParent),offsetParentPos=offsetParent.offset(),pos=$(this).offset(),top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css("margin-top"))-shadowShiftY,numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css("margin-left"))-shadowShiftX):(offsetParent="absolute"==$(this).css("position")?$(this).parents().eq(0).offsetParent():$(this).offsetParent(),pos=$(this).btPosition(),top=numb(pos.top)+numb($(this).css("margin-top"))-shadowShiftY,numb(pos.left)+numb($(this).css("margin-left"))-shadowShiftX);var width=$(this).btOuterWidth(),height=$(this).outerHeight();if("object"==typeof content){if(null==content)return;var original=content,clone=$(original).clone(!0).show(),origClones=$(original).data("bt-clones")||[];origClones.push(clone),$(original).data("bt-clones",origClones),$(clone).data("bt-orig",original),$(this).data("bt-content-orig",{original:original,clone:clone}),content=clone}if("null"!=typeof content&&""!=content){var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:"absolute",width:opts.shrinkToFit?"auto":opts.width,zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles),$box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:"absolute",width:opts.width,zIndex:opts.wrapperzIndex,visibility:"hidden"}).appendTo(offsetParent);jQuery.fn.bgiframe&&($text.bgiframe(),$box.bgiframe()),$(this).data("bt-box",$box);var scrollTop=numb($(document).scrollTop()),scrollLeft=numb($(document).scrollLeft()),docWidth=numb($(window).width()),docHeight=numb($(window).height()),winRight=scrollLeft+docWidth,winBottom=scrollTop+docHeight,space=new Object,thisOffset=$(this).offset();space.top=thisOffset.top-scrollTop,space.bottom=docHeight-(thisOffset+height-scrollTop),space.left=thisOffset.left-scrollLeft,space.right=docWidth-(thisOffset.left+width-scrollLeft);var textOutHeight=numb($text.outerHeight()),textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String&&(opts.positions=opts.positions.replace(/ /,"").split(",")),"most"==opts.positions[0]){var position="top";for(var pig in space)position=space[pig]>space[position]?pig:position}else for(var x in opts.positions){var position=opts.positions[x];if(("left"==position||"right"==position)&&space[position]>textOutWidth+opts.spikeLength)break;if(("top"==position||"bottom"==position)&&space[position]>textOutHeight+opts.spikeLength)break}var horiz=left+.5*(width-textOutWidth),vert=top+.5*(height-textOutHeight),points=new Array,textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(position){case"top":$text.css("margin-bottom",opts.spikeLength+"px"),$box.css({top:top-$text.outerHeight(!0)+opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;textRightSpace<0&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),textLeftSpace<0&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:.5*(textRight-textLeft)+xShift,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.CornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]=spikePoint;break;case"left":$text.css("margin-right",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left-$text.btOuterWidth(!0)+opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;textBottomSpace<0&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),textTopSpace<0&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint;break;case"bottom":$text.css("margin-top",opts.spikeLength+"px"),$box.css({top:top+height-opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;textRightSpace<0&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),textLeftSpace<0&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:.5*(textRight-textLeft)+xShift,y:shadowShiftY,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.cornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]=spikePoint;break;case"right":$text.css("margin-left",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left+width-opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;textBottomSpace<0&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),textTopSpace<0&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:shadowShiftX,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint}var canvas=document.createElement("canvas");if($(canvas).prop("width",numb($text.btOuterWidth(!0))+2*opts.strokeWidth+shadowMarginX).prop("height",numb($text.outerHeight(!0))+2*opts.strokeWidth+shadowMarginY).appendTo($box).css({position:"absolute",zIndex:opts.boxzIndex}),"undefined"!=typeof G_vmlCanvasManager&&(canvas=G_vmlCanvasManager.initElement(canvas)),0<opts.cornerRadius){for(var newPoints=new Array,newPoint,i=0;i<points.length;i++)"corner"==points[i].type?(newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius),newPoint.type="arcStart",newPoints[newPoints.length]=newPoint,newPoints[newPoints.length]=points[i],newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius),newPoint.type="arcEnd",newPoints[newPoints.length]=newPoint):newPoints[newPoints.length]=points[i];points=newPoints}var ctx=canvas.getContext("2d"),overlay;if(opts.shadow&&!0!==opts.shadowOverlap){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case"top":0<opts.shadowOffsetX+opts.shadowBlur-shadowOverlap&&$box.css("top",numb($box.css("top"))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap));break;case"right":0<shadowShiftX-shadowOverlap&&$box.css("left",numb($box.css("left"))+shadowShiftX-shadowOverlap);break;case"bottom":0<shadowShiftY-shadowOverlap&&$box.css("top",numb($box.css("top"))+shadowShiftY-shadowOverlap);break;case"left":0<opts.shadowOffsetY+opts.shadowBlur-shadowOverlap&&$box.css("left",numb($box.css("left"))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap))}}drawIt.apply(ctx,[points],opts.strokeWidth),ctx.fillStyle=opts.fill,opts.shadow&&(ctx.shadowOffsetX=opts.shadowOffsetX,ctx.shadowOffsetY=opts.shadowOffsetY,ctx.shadowBlur=opts.shadowBlur,ctx.shadowColor=opts.shadowColor),ctx.closePath(),ctx.fill(),0<opts.strokeWidth&&(ctx.shadowColor="rgba(0, 0, 0, 0)",ctx.lineWidth=opts.strokeWidth,ctx.strokeStyle=opts.strokeStyle,ctx.beginPath(),drawIt.apply(ctx,[points],opts.strokeWidth),ctx.closePath(),ctx.stroke()),opts.preShow.apply(this,[$box[0]]),$box.css({display:"none",visibility:"visible"}),opts.showTip.apply(this,[$box[0]]),opts.overlay&&(overlay=$('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:top,left:left,width:width,height:height,opacity:".2"}).appendTo(offsetParent),$(this).data("overlay",overlay)),(null!=opts.ajaxPath&&0==opts.ajaxCache||ajaxTimeout)&&(content=!1),opts.clickAnywhereToClose&&(jQuery.bt.vars.clickAnywhereStack.push(this),$(document).click(jQuery.bt.docClick)),opts.closeWhenOthersOpen&&jQuery.bt.vars.closeWhenOpenStack.push(this),opts.postShow.apply(this,[$box[0]])}},this.btOff=function(){var r,t=$(this).data("bt-box");void 0!==t&&(opts.preHide.apply(this,[t]),(r=this).btCleanup=function(){var t,e=$(r).data("bt-box"),i=$(r).data("bt-content-orig"),n=$(r).data("bt-overlay");"object"==typeof e&&($(e).remove(),$(r).removeData("bt-box")),"object"==typeof i&&(t=$(i.original).data("bt-clones"),$(i).data("bt-clones",arrayRemove(t,i.clone))),"object"==typeof n&&($(n).remove(),$(r).removeData("bt-overlay")),jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,r),jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,r),$(r).removeClass("bt-active "+opts.activeClass),opts.postHide.apply(r)},opts.hideTip.apply(this,[t,r.btCleanup]))};var refresh=this.btRefresh=function(){this.btOff(),this.btOn()}});function drawIt(t,e){for(this.moveTo(t[0].x,t[0].y),i=1;i<t.length;i++)"arcStart"==t[i-1].type?(this.quadraticCurveTo(round5(t[i].x,e),round5(t[i].y,e),round5(t[(i+1)%t.length].x,e),round5(t[(i+1)%t.length].y,e)),i++):this.lineTo(round5(t[i].x,e),round5(t[i].y,e))}function round5(t,e){return(e=numb(e))%2?t:Math.round(t-.5)+.5}function numb(t){return parseInt(t)||0}function arrayRemove(t,e){var i,n=new Array;for(i in t)t[i]!=e&&n.push(t[i]);return n}function canvasSupport(){var e=!1;try{e=!!document.createElement("canvas").getContext("2d")}catch(t){e=!!document.createElement("canvas").getContext}return e}function shadowSupport(){try{var t=navigator.userAgent.toLowerCase();if(/webkit/.test(t))return 1;if(/gecko|mozilla/.test(t)&&3.1<=parseFloat(t.match(/firefox\/(\d+(?:\.\d+)+)/)[1]))return 1}catch(t){}}function betweenPoint(t,e,i){var n;return t.x==e.x?(n=t.y<e.y?t.y+i:t.y-i,{x:t.x,y:n}):t.y==e.y?{x:t.x<e.x?t.x+i:t.x-i,y:t.y}:void 0}function centerPoint(t,e,i){e.x==t.x?i.x:t.x,e.y==t.y?i.y:t.y,t.x,i.x,t.y>i.y&&Math.PI,Math.PI;return 1}function findIntersect(t,e,i,n,r,o,s,a){if(r==s)return findIntersectY(t,e,i,n,r);if(o==a)return findIntersectX(t,e,i,n,o);return 1}function findIntersectY(t,e,i,n,r){if(e==n)return{x:r,y:e};var o=(e-n)/(t-i);return{x:r,y:o*r+(e-o*t)}}function findIntersectX(t,e,i,n,r){if(t==i)return{x:t,y:r};var o=(e-n)/(t-i);return{x:(r-(e-o*t))/o,y:r}}},jQuery.fn.btPosition=function(){function t(t,e){return t[0]&&parseInt(jQuery.css(t[0],e,!0),10)||0}var e,i,n,r;return this[0]&&(i=this.offsetParent(),n=this.offset(),r=/^body|html$/i.test(i[0].tagName)?{top:0,left:0}:i.offset(),n.top-=t(this,"marginTop"),n.left-=t(this,"marginLeft"),r.top+=t(i,"borderTopWidth"),r.left+=t(i,"borderLeftWidth"),e={top:n.top-r.top,left:n.left-r.left}),e},jQuery.fn.btOuterWidth=function(t){function e(t,e){return t[0]&&parseInt(jQuery.css(t[0],e,!0),10)||0}return this.innerWidth()+e(this,"borderLeftWidth")+e(this,"borderRightWidth")+(t?e(this,"marginLeft")+e(this,"marginRight"):0)},jQuery.fn.btOn=function(){return this.each(function(t){jQuery.isFunction(this.btOn)&&this.btOn()})},jQuery.fn.btOff=function(){return this.each(function(t){jQuery.isFunction(this.btOff)&&this.btOff()})},jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]},jQuery.bt.docClick=function(t){t=t||window.event,!$(t.target).parents().addBack().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length&&($(jQuery.bt.vars.clickAnywhereStack).btOff(),$(document).unbind("click",jQuery.bt.docClick))},jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:!0,closeWhenOthersOpen:!1,shrinkToFit:!1,width:"200px",padding:"10px",spikeGirth:10,spikeLength:15,overlap:0,overlay:!1,killTitle:!0,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:.5,centerPointY:.5,shadow:!1,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",contentSelector:"$(this).prop('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:!0,ajaxOpts:{},preBuild:function(){},preShow:function(t){},showTip:function(t){$(t).show()},postShow:function(t){},preHide:function(t){},hideTip:function(t,e){$(t).hide(),e()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}},jQuery.bt.options={}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(O){function n(t,e){var i,n,r,o=t.nodeName.toLowerCase();return"area"===o?(n=(i=t.parentNode).name,!(!t.href||!n||"map"!==i.nodeName.toLowerCase())&&(!!(r=O("img[usemap='#"+n+"']")[0])&&s(r))):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o&&t.href||e)&&s(t)}function s(t){return O.expr.filters.visible(t)&&!O(t).parents().addBack().filter(function(){return"hidden"===O.css(this,"visibility")}).length}function t(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},O.extend(this._defaults,this.regional[""]),this.regional.en=O.extend(!0,{},this.regional[""]),this.regional["en-US"]=O.extend(!0,{},this.regional.en),this.dpDiv=i(O("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(t){var e="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(e,"mouseout",function(){O(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&O(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&O(this).removeClass("ui-datepicker-next-hover")}).delegate(e,"mouseover",o)}function o(){O.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(O(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),O(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&O(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&O(this).addClass("ui-datepicker-next-hover"))}function c(t,e){for(var i in O.extend(t,e),e)null==e[i]&&(t[i]=e[i]);return t}function e(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}var r,a,l,u;O.ui=O.ui||{},O.extend(O.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),O.fn.extend({scrollParent:function(t){var e=this.css("position"),i="absolute"===e,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var t=O(this);return(!i||"static"!==t.css("position"))&&n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&r.length?r:O(this[0].ownerDocument||document)},uniqueId:(u=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++u)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&O(this).removeAttr("id")})}}),O.extend(O.expr[":"],{data:O.expr.createPseudo?O.expr.createPseudo(function(e){return function(t){return!!O.data(t,e)}}):function(t,e,i){return!!O.data(t,i[3])},focusable:function(t){return n(t,!isNaN(O.attr(t,"tabindex")))},tabbable:function(t){var e=O.attr(t,"tabindex"),i=isNaN(e);return(i||0<=e)&&n(t,!i)}}),O("<a>").outerWidth(1).jquery||O.each(["Width","Height"],function(t,i){function n(t,e,i,n){return O.each(r,function(){e-=parseFloat(O.css(t,"padding"+this))||0,i&&(e-=parseFloat(O.css(t,"border"+this+"Width"))||0),n&&(e-=parseFloat(O.css(t,"margin"+this))||0)}),e}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),s={innerWidth:O.fn.innerWidth,innerHeight:O.fn.innerHeight,outerWidth:O.fn.outerWidth,outerHeight:O.fn.outerHeight};O.fn["inner"+i]=function(t){return void 0===t?s["inner"+i].call(this):this.each(function(){O(this).css(o,n(this,t)+"px")})},O.fn["outer"+i]=function(t,e){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){O(this).css(o,n(this,t,!0,e)+"px")})}}),O.fn.addBack||(O.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),O("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(O.fn.removeData=(l=O.fn.removeData,function(t){return arguments.length?l.call(this,O.camelCase(t)):l.call(this)})),O.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),O.fn.extend({focus:(a=O.fn.focus,function(e,i){return"number"==typeof e?this.each(function(){var t=this;setTimeout(function(){O(t).focus(),i&&i.call(t)},e)}):a.apply(this,arguments)}),disableSelection:(r="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(r+".ui-disableSelection",function(t){t.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var e,i,n=O(this[0]);n.length&&n[0]!==document;){if(("absolute"===(e=n.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(n.css("zIndex"),10),!isNaN(i)&&0!==i))return i;n=n.parent()}return 0}}),O.ui.plugin={add:function(t,e,i){var n,r=O.ui[t].prototype;for(n in i)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([e,i[n]])},call:function(t,e,i,n){var r,o=t.plugins[e];if(o&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(r=0;o.length>r;r++)t.options[o[r][0]]&&o[r][1].apply(t.element,i)}};var h,d=0,p=Array.prototype.slice;O.cleanData=(h=O.cleanData,function(t){for(var e,i,n=0;null!=(i=t[n]);n++)try{(e=O._data(i,"events"))&&e.remove&&O(i).triggerHandler("remove")}catch(t){}h(t)}),O.widget=function(t,i,e){var n,r,o,s,a={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,e||(e=i,i=O.Widget),O.expr[":"][n.toLowerCase()]=function(t){return!!O.data(t,n)},O[l]=O[l]||{},r=O[l][t],o=O[l][t]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},O.extend(o,r,{version:e.version,_proto:O.extend({},e),_childConstructors:[]}),(s=new i).options=O.widget.extend({},s.options),O.each(e,function(e,n){return O.isFunction(n)?void(a[e]=function(){var t,e=this._super,i=this._superApply;return this._super=r,this._superApply=o,t=n.apply(this,arguments),this._super=e,this._superApply=i,t}):void(a[e]=n);function r(){return i.prototype[e].apply(this,arguments)}function o(t){return i.prototype[e].apply(this,t)}}),o.prototype=O.widget.extend(s,{widgetEventPrefix:r&&s.widgetEventPrefix||t},a,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),r?(O.each(r._childConstructors,function(t,e){var i=e.prototype;O.widget(i.namespace+"."+i.widgetName,o,e._proto)}),delete r._childConstructors):i._childConstructors.push(o),O.widget.bridge(t,o),o},O.widget.extend=function(t){for(var e,i,n=p.call(arguments,1),r=0,o=n.length;r<o;r++)for(e in n[r])i=n[r][e],n[r].hasOwnProperty(e)&&void 0!==i&&(t[e]=O.isPlainObject(i)?O.isPlainObject(t[e])?O.widget.extend({},t[e],i):O.widget.extend({},i):i);return t},O.widget.bridge=function(o,e){var s=e.prototype.widgetFullName||o;O.fn[o]=function(i){var t="string"==typeof i,n=p.call(arguments,1),r=this;return i=!t&&n.length?O.widget.extend.apply(null,[i].concat(n)):i,t?this.each(function(){var t,e=O.data(this,s);return"instance"===i?(r=e,!1):e?O.isFunction(e[i])&&"_"!==i.charAt(0)?(t=e[i].apply(e,n))!==e&&void 0!==t?(r=t&&t.jquery?r.pushStack(t.get()):t,!1):void 0:O.error("no such method '"+i+"' for "+o+" widget instance"):O.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+i+"'")}):this.each(function(){var t=O.data(this,s);t?(t.option(i||{}),t._init&&t._init()):O.data(this,s,new e(i,this))}),r}},O.Widget=function(){},O.Widget._childConstructors=[],O.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,e){e=O(e||this.defaultElement||this)[0],this.element=O(e),this.uuid=d++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=O(),this.hoverable=O(),this.focusable=O(),e!==this&&(O.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=O(e.style?e.ownerDocument:e.document||e),this.window=O(this.document[0].defaultView||this.document[0].parentWindow)),this.options=O.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:O.noop,_getCreateEventData:O.noop,_create:O.noop,_init:O.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(O.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:O.noop,widget:function(){return this.element},option:function(t,e){var i,n,r,o=t;if(0===arguments.length)return O.widget.extend({},this.options);if("string"==typeof t)if(o={},t=(i=t.split(".")).shift(),i.length){for(n=o[t]=O.widget.extend({},this.options[t]),r=0;i.length-1>r;r++)n[i[r]]=n[i[r]]||{},n=n[i[r]];if(t=i.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=e}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(s,a,t){var l,u=this;"boolean"!=typeof s&&(t=a,a=s,s=!1),t?(a=l=O(a),this.bindings=this.bindings.add(a)):(t=a,a=this.element,l=this.widget()),O.each(t,function(t,e){function i(){return s||!0!==u.options.disabled&&!O(this).hasClass("ui-state-disabled")?("string"==typeof e?u[e]:e).apply(u,arguments):void 0}"string"!=typeof e&&(i.guid=e.guid=e.guid||i.guid||O.guid++);var n=t.match(/^([\w:-]*)\s*(.*)$/),r=n[1]+u.eventNamespace,o=n[2];o?l.delegate(o,r,i):a.bind(r,i)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e),this.bindings=O(this.bindings.not(t).get()),this.focusable=O(this.focusable.not(t).get()),this.hoverable=O(this.hoverable.not(t).get())},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){O(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){O(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){O(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){O(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,e,i){var n,r,o=this.options[t];if(i=i||{},(e=O.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],r=e.originalEvent)for(n in r)n in e||(e[n]=r[n]);return this.element.trigger(e,i),!(O.isFunction(o)&&!1===o.apply(this.element[0],[e].concat(i))||e.isDefaultPrevented())}},O.each({show:"fadeIn",hide:"fadeOut"},function(o,s){O.Widget.prototype["_"+o]=function(e,t,i){"string"==typeof t&&(t={effect:t});var n,r=t?!0!==t&&"number"!=typeof t&&t.effect||s:o;"number"==typeof(t=t||{})&&(t={duration:t}),n=!O.isEmptyObject(t),t.complete=i,t.delay&&e.delay(t.delay),n&&O.effects&&O.effects.effect[r]?e[o](t):r!==o&&e[r]?e[r](t.duration,t.easing,i):e.queue(function(t){O(this)[o](),i&&i.call(e[0]),t()})}}),O.widget;var f=!1;function g(t,e,i){return e<=t&&t<e+i}O(document).mouseup(function(){f=!1}),O.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(t){return!0===O.data(t.target,e.widgetName+".preventClickEvent")?(O.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!f){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,i=1===t.which,n=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&O(t.target).closest(this.options.cancel).length;return i&&!n&&this._mouseCapture(t)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?t.preventDefault():(!0===O.data(t.target,this.widgetName+".preventClickEvent")&&O.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),f=!0)),!0}},_mouseMove:function(t){if(this._mouseMoved){if(O.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&O.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),f=!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function x(t,e,i){return[parseFloat(t[0])*(l.test(t[0])?e/100:1),parseFloat(t[1])*(l.test(t[1])?i/100:1)]}function S(t,e){return parseInt(O.css(t,e),10)||0}O.ui=O.ui||{};var r,w,P=Math.max,E=Math.abs,T=Math.round,n=/left|center|right/,o=/top|center|bottom/,s=/[\+\-]\d+(\.[\d]+)?%?/,a=/^\w+/,l=/%$/,u=O.fn.position;O.position={scrollbarWidth:function(){if(void 0!==r)return r;var t,e,i=O("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=i.children()[0];return O("body").append(i),t=n.offsetWidth,i.css("overflow","scroll"),t===(e=n.offsetWidth)&&(e=i[0].clientWidth),i.remove(),r=t-e},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight?O.position.scrollbarWidth():0,height:n?O.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=O(t||window),i=O.isWindow(e[0]),n=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:i,isDocument:n,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:i||n?e.width():e.outerWidth(),height:i||n?e.height():e.outerHeight()}}},O.fn.position=function(c){if(!c||!c.of)return u.apply(this,arguments);c=O.extend({},c);var d,p,f,g,m,t,e,y=O(c.of),_=O.position.getWithinInfo(c.within),v=O.position.getScrollInfo(_),b=(c.collision||"flip").split(" "),j={},i=9===(e=(t=y)[0]).nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:O.isWindow(e)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()};return y[0].preventDefault&&(c.at="left top"),p=i.width,f=i.height,g=i.offset,m=O.extend({},g),O.each(["my","at"],function(){var t,e,i=(c[this]||"").split(" ");1===i.length&&(i=n.test(i[0])?i.concat(["center"]):o.test(i[0])?["center"].concat(i):["center","center"]),i[0]=n.test(i[0])?i[0]:"center",i[1]=o.test(i[1])?i[1]:"center",t=s.exec(i[0]),e=s.exec(i[1]),j[this]=[t?t[0]:0,e?e[0]:0],c[this]=[a.exec(i[0])[0],a.exec(i[1])[0]]}),1===b.length&&(b[1]=b[0]),"right"===c.at[0]?m.left+=p:"center"===c.at[0]&&(m.left+=p/2),"bottom"===c.at[1]?m.top+=f:"center"===c.at[1]&&(m.top+=f/2),d=x(j.at,p,f),m.left+=d[0],m.top+=d[1],this.each(function(){var i,t,s=O(this),a=s.outerWidth(),l=s.outerHeight(),e=S(this,"marginLeft"),n=S(this,"marginTop"),r=a+e+S(this,"marginRight")+v.width,o=l+n+S(this,"marginBottom")+v.height,u=O.extend({},m),h=x(j.my,s.outerWidth(),s.outerHeight());"right"===c.my[0]?u.left-=a:"center"===c.my[0]&&(u.left-=a/2),"bottom"===c.my[1]?u.top-=l:"center"===c.my[1]&&(u.top-=l/2),u.left+=h[0],u.top+=h[1],w||(u.left=T(u.left),u.top=T(u.top)),i={marginLeft:e,marginTop:n},O.each(["left","top"],function(t,e){O.ui.position[b[t]]&&O.ui.position[b[t]][e](u,{targetWidth:p,targetHeight:f,elemWidth:a,elemHeight:l,collisionPosition:i,collisionWidth:r,collisionHeight:o,offset:[d[0]+h[0],d[1]+h[1]],my:c.my,at:c.at,within:_,elem:s})}),c.using&&(t=function(t){var e=g.left-u.left,i=e+p-a,n=g.top-u.top,r=n+f-l,o={target:{element:y,left:g.left,top:g.top,width:p,height:f},element:{element:s,left:u.left,top:u.top,width:a,height:l},horizontal:i<0?"left":0<e?"right":"center",vertical:r<0?"top":0<n?"bottom":"middle"};p<a&&p>E(e+i)&&(o.horizontal="center"),f<l&&f>E(n+r)&&(o.vertical="middle"),o.important=P(E(e),E(i))>P(E(n),E(r))?"horizontal":"vertical",c.using.call(this,t,o)}),s.offset(O.extend(u,{using:t}))})},O.ui.position={fit:{left:function(t,e){var i,n=e.within,r=n.isWindow?n.scrollLeft:n.offset.left,o=n.width,s=t.left-e.collisionPosition.marginLeft,a=r-s,l=s+e.collisionWidth-o-r;e.collisionWidth>o?0<a&&l<=0?(i=t.left+a+e.collisionWidth-o-r,t.left+=a-i):t.left=!(0<l&&a<=0)&&l<a?r+o-e.collisionWidth:r:0<a?t.left+=a:0<l?t.left-=l:t.left=P(t.left-s,t.left)},top:function(t,e){var i,n=e.within,r=n.isWindow?n.scrollTop:n.offset.top,o=e.within.height,s=t.top-e.collisionPosition.marginTop,a=r-s,l=s+e.collisionHeight-o-r;e.collisionHeight>o?0<a&&l<=0?(i=t.top+a+e.collisionHeight-o-r,t.top+=a-i):t.top=!(0<l&&a<=0)&&l<a?r+o-e.collisionHeight:r:0<a?t.top+=a:0<l?t.top-=l:t.top=P(t.top-s,t.top)}},flip:{left:function(t,e){var i,n,r=e.within,o=r.offset.left+r.scrollLeft,s=r.width,a=r.isWindow?r.scrollLeft:r.offset.left,l=t.left-e.collisionPosition.marginLeft,u=l-a,h=l+e.collisionWidth-s-a,c="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,d="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,p=-2*e.offset[0];u<0?((i=t.left+c+d+p+e.collisionWidth-s-o)<0||E(u)>i)&&(t.left+=c+d+p):0<h&&((0<(n=t.left-e.collisionPosition.marginLeft+c+d+p-a)||h>E(n))&&(t.left+=c+d+p))},top:function(t,e){var i,n,r=e.within,o=r.offset.top+r.scrollTop,s=r.height,a=r.isWindow?r.scrollTop:r.offset.top,l=t.top-e.collisionPosition.marginTop,u=l-a,h=l+e.collisionHeight-s-a,c="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,d="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,p=-2*e.offset[1];u<0?(n=t.top+c+d+p+e.collisionHeight-s-o,t.top+c+d+p>u&&(n<0||E(u)>n)&&(t.top+=c+d+p)):0<h&&(i=t.top-e.collisionPosition.marginTop+c+d+p-a,t.top+c+d+p>h&&(0<i||h>E(i))&&(t.top+=c+d+p))}},flipfit:{left:function(){O.ui.position.flip.left.apply(this,arguments),O.ui.position.fit.left.apply(this,arguments)},top:function(){O.ui.position.flip.top.apply(this,arguments),O.ui.position.fit.top.apply(this,arguments)}}},function(){var t,e,i,n=document.getElementsByTagName("body")[0],r=document.createElement("div"),o=document.createElement(n?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(i in n&&O.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"}),s)o.style[i]=s[i];o.appendChild(r),(t=n||document.documentElement).insertBefore(o,t.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",e=O(r).offset().left,w=10<e&&e<11,o.innerHTML="",t.removeChild(o)}()}(),O.ui.position,O.widget("ui.draggable",O.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var e=this.options;return this._blurActiveElement(t),!(this.helper||e.disabled||0<O(t.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blockFrames(!0===e.iframeFix?"iframe":e.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=O(this);return O("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var e=this.document[0];if(this.handleElement.is(t.target))try{e.activeElement&&"body"!==e.activeElement.nodeName.toLowerCase()&&O(e.activeElement).blur()}catch(t){}},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),O.ui.ddmanager&&(O.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===O(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),O.ui.ddmanager&&!e.dropBehaviour&&O.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),O.ui.ddmanager&&O.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",O.ui.ddmanager&&O.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e=this,i=!1;return O.ui.ddmanager&&!this.options.dropBehaviour&&(i=O.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||O.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?O(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",t)&&e._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),O.ui.ddmanager&&O.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),O.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!O(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var e=this.options,i=O.isFunction(e.helper),n=i?O(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),O.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==e&&O.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,n=this.options,r=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[O(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,O(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,O(window).scrollLeft()+O(window).width()-this.helperProportions.width-this.margins.left,O(window).scrollTop()+(O(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,O(r).width()-this.helperProportions.width-this.margins.left,(O(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),void((i=(e=O(n.containment))[0])&&(t=/(scroll|auto)/.test(e.css("overflow")),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=e))):void(this.containment=null)},_convertPositionTo:function(t,e){e=e||this.position;var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,r,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,u=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(i=this.relativeContainer?(n=this.relativeContainer.offset(),[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(u=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(u=i[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,u=!i||r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-s.grid[1]:r+s.grid[1],o=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=!i||o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-s.grid[0]:o+s.grid[0]),"y"===s.axis&&(l=this.originalPageX),"x"===s.axis&&(u=this.originalPageY)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,e,i){return i=i||this._uiHash(),O.ui.plugin.call(this,t,[e,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),O.Widget.prototype._trigger.call(this,t,e,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),O.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,i){var n=O.extend({},t,{item:i.element});i.sortables=[],O(i.options.connectToSortable).each(function(){var t=O(this).sortable("instance");t&&!t.options.disabled&&(i.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,n))})},stop:function(e,t,i){var n=O.extend({},t,{item:i.element});i.cancelHelperRemoval=!1,O.each(i.sortables,function(){var t=this;t.isOver?(t.isOver=0,i.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(i,n,r){O.each(r.sortables,function(){var t=!1,e=this;e.positionAbs=r.positionAbs,e.helperProportions=r.helperProportions,e.offset.click=r.offset.click,e._intersectsWith(e.containerCache)&&(t=!0,O.each(r.sortables,function(){return this.positionAbs=r.positionAbs,this.helperProportions=r.helperProportions,this.offset.click=r.offset.click,this!==e&&this._intersectsWith(this.containerCache)&&O.contains(e.element[0],this.element[0])&&(t=!1),t})),t?(e.isOver||(e.isOver=1,e.currentItem=n.helper.appendTo(e.element).data("ui-sortable-item",!0),e.options._helper=e.options.helper,e.options.helper=function(){return n.helper[0]},i.target=e.currentItem[0],e._mouseCapture(i,!0),e._mouseStart(i,!0,!0),e.offset.click.top=r.offset.click.top,e.offset.click.left=r.offset.click.left,e.offset.parent.left-=r.offset.parent.left-e.offset.parent.left,e.offset.parent.top-=r.offset.parent.top-e.offset.parent.top,r._trigger("toSortable",i),r.dropped=e.element,O.each(r.sortables,function(){this.refreshPositions()}),r.currentItem=r.element,e.fromOutside=r),e.currentItem&&(e._mouseDrag(i),n.position=e.position)):e.isOver&&(e.isOver=0,e.cancelHelperRemoval=!0,e.options._revert=e.options.revert,e.options.revert=!1,e._trigger("out",i,e._uiHash(e)),e._mouseStop(i,!0),e.options.revert=e.options._revert,e.options.helper=e.options._helper,e.placeholder&&e.placeholder.remove(),r._refreshOffsets(i),n.position=r._generatePosition(i,!0),r._trigger("fromSortable",i),r.dropped=!1,O.each(r.sortables,function(){this.refreshPositions()}))})}}),O.ui.plugin.add("draggable","cursor",{start:function(t,e,i){var n=O("body"),r=i.options;n.css("cursor")&&(r._cursor=n.css("cursor")),n.css("cursor",r.cursor)},stop:function(t,e,i){var n=i.options;n._cursor&&O("body").css("cursor",n._cursor)}}),O.ui.plugin.add("draggable","opacity",{start:function(t,e,i){var n=O(e.helper),r=i.options;n.css("opacity")&&(r._opacity=n.css("opacity")),n.css("opacity",r.opacity)},stop:function(t,e,i){var n=i.options;n._opacity&&O(e.helper).css("opacity",n._opacity)}}),O.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,e,i){var n=i.options,r=!1,o=i.scrollParentNotHidden[0],s=i.document[0];o!==s&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=r=o.scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=r=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=r=o.scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=r=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-O(s).scrollTop()<n.scrollSensitivity?r=O(s).scrollTop(O(s).scrollTop()-n.scrollSpeed):O(window).height()-(t.pageY-O(s).scrollTop())<n.scrollSensitivity&&(r=O(s).scrollTop(O(s).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-O(s).scrollLeft()<n.scrollSensitivity?r=O(s).scrollLeft(O(s).scrollLeft()-n.scrollSpeed):O(window).width()-(t.pageX-O(s).scrollLeft())<n.scrollSensitivity&&(r=O(s).scrollLeft(O(s).scrollLeft()+n.scrollSpeed)))),!1!==r&&O.ui.ddmanager&&!n.dropBehaviour&&O.ui.ddmanager.prepareOffsets(i,t)}}),O.ui.plugin.add("draggable","snap",{start:function(t,e,i){var n=i.options;i.snapElements=[],O(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=O(this),e=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e.top,left:e.left})})},drag:function(t,e,i){for(var n,r,o,s,a,l,u,h,c,d=i.options,p=d.snapTolerance,f=e.offset.left,g=f+i.helperProportions.width,m=e.offset.top,y=m+i.helperProportions.height,_=i.snapElements.length-1;0<=_;_--)l=(a=i.snapElements[_].left-i.margins.left)+i.snapElements[_].width,h=(u=i.snapElements[_].top-i.margins.top)+i.snapElements[_].height,g<a-p||l+p<f||y<u-p||h+p<m||!O.contains(i.snapElements[_].item.ownerDocument,i.snapElements[_].item)?(i.snapElements[_].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,O.extend(i._uiHash(),{snapItem:i.snapElements[_].item})),i.snapElements[_].snapping=!1):("inner"!==d.snapMode&&(n=p>=Math.abs(u-y),r=p>=Math.abs(h-m),o=p>=Math.abs(a-g),s=p>=Math.abs(l-f),n&&(e.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),r&&(e.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),o&&(e.position.left=i._convertPositionTo("relative",{top:0,left:a-i.helperProportions.width}).left),s&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l}).left)),c=n||r||o||s,"outer"!==d.snapMode&&(n=p>=Math.abs(u-m),r=p>=Math.abs(h-y),o=p>=Math.abs(a-f),s=p>=Math.abs(l-g),n&&(e.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),r&&(e.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),o&&(e.position.left=i._convertPositionTo("relative",{top:0,left:a}).left),s&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left)),!i.snapElements[_].snapping&&(n||r||o||s||c)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,O.extend(i._uiHash(),{snapItem:i.snapElements[_].item})),i.snapElements[_].snapping=n||r||o||s||c)}}),O.ui.plugin.add("draggable","stack",{start:function(t,e,i){var n,r=i.options,o=O.makeArray(O(r.stack)).sort(function(t,e){return(parseInt(O(t).css("zIndex"),10)||0)-(parseInt(O(e).css("zIndex"),10)||0)});o.length&&(n=parseInt(O(o[0]).css("zIndex"),10)||0,O(o).each(function(t){O(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),O.ui.plugin.add("draggable","zIndex",{start:function(t,e,i){var n=O(e.helper),r=i.options;n.css("zIndex")&&(r._zIndex=n.css("zIndex")),n.css("zIndex",r.zIndex)},stop:function(t,e,i){var n=i.options;n._zIndex&&O(e.helper).css("zIndex",n._zIndex)}}),O.ui.draggable,O.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept=O.isFunction(i)?i:function(t){return t.is(i)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(e.scope),e.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){O.ui.ddmanager.droppables[t]=O.ui.ddmanager.droppables[t]||[],O.ui.ddmanager.droppables[t].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var t=O.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,e){var i;"accept"===t?this.accept=O.isFunction(e)?e:function(t){return t.is(e)}:"scope"===t&&(i=O.ui.ddmanager.droppables[this.options.scope],this._splice(i),this._addToManager(e)),this._super(t,e)},_activate:function(t){var e=O.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),e&&this._trigger("activate",t,this.ui(e))},_deactivate:function(t){var e=O.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),e&&this._trigger("deactivate",t,this.ui(e))},_over:function(t){var e=O.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(e)))},_out:function(t){var e=O.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(e)))},_drop:function(e,t){var i=t||O.ui.ddmanager.current,n=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=O(this).droppable("instance");return t.options.greedy&&!t.options.disabled&&t.options.scope===i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&O.ui.intersect(i,O.extend(t,{offset:t.element.offset()}),t.options.tolerance,e)?!(n=!0):void 0}),!n&&(!!this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(i)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),O.ui.intersect=function(t,e,i,n){if(!e.offset)return!1;var r=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,s=r+t.helperProportions.width,a=o+t.helperProportions.height,l=e.offset.left,u=e.offset.top,h=l+e.proportions().width,c=u+e.proportions().height;switch(i){case"fit":return l<=r&&s<=h&&u<=o&&a<=c;case"intersect":return r+t.helperProportions.width/2>l&&h>s-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>a-t.helperProportions.height/2;case"pointer":return g(n.pageY,u,e.proportions().height)&&g(n.pageX,l,e.proportions().width);case"touch":return(u<=o&&o<=c||u<=a&&a<=c||o<u&&c<a)&&(l<=r&&r<=h||l<=s&&s<=h||r<l&&h<s);default:return!1}},O.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,e){var i,n,r=O.ui.ddmanager.droppables[t.options.scope]||[],o=e?e.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();t:for(i=0;r.length>i;i++)if(!(r[i].options.disabled||t&&!r[i].accept.call(r[i].element[0],t.currentItem||t.element))){for(n=0;s.length>n;n++)if(s[n]===r[i].element[0]){r[i].proportions().height=0;continue t}r[i].visible="none"!==r[i].element.css("display"),r[i].visible&&("mousedown"===o&&r[i]._activate.call(r[i],e),r[i].offset=r[i].element.offset(),r[i].proportions({width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight}))}},drop:function(t,e){var i=!1;return O.each((O.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&O.ui.intersect(t,this,this.options.tolerance,e)&&(i=this._drop.call(this,e)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,e)))}),i},dragStart:function(t,e){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||O.ui.ddmanager.prepareOffsets(t,e)})},drag:function(o,s){o.options.refreshPositions&&O.ui.ddmanager.prepareOffsets(o,s),O.each(O.ui.ddmanager.droppables[o.options.scope]||[],function(){var t,e,i,n,r;this.options.disabled||this.greedyChild||!this.visible||(r=!(n=O.ui.intersect(o,this,this.options.tolerance,s))&&this.isover?"isout":n&&!this.isover?"isover":null)&&(this.options.greedy&&(e=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter(function(){return O(this).droppable("instance").options.scope===e})).length&&((t=O(i[0]).droppable("instance")).greedyChild="isover"===r)),t&&"isover"===r&&(t.isover=!1,t.isout=!0,t._out.call(t,s)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,s),t&&"isout"===r&&(t.isout=!1,t.isover=!0,t._over.call(t,s)))})},dragStop:function(t,e){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||O.ui.ddmanager.prepareOffsets(t,e)}},O.ui.droppable,O.widget("ui.resizable",O.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(t,e){if("hidden"===O(t).css("overflow"))return!1;var i=e&&"left"===e?"scrollLeft":"scrollTop",n=!1;return 0<t[i]||(t[i]=1,n=0<t[i],t[i]=0,n)},_create:function(){var t,e,i,n,r=this,o=this.options;if(this.element.addClass("ui-resizable"),O.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(O("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||(O(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},e=0;t.length>e;e++)i=O.trim(t[e]),(n=O("<div class='ui-resizable-handle "+("ui-resizable-"+i)+"'></div>")).css({zIndex:o.zIndex}),"se"===i&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(t){var e,i,n,r;for(e in t=t||this.element,this.handles)this.handles[e].constructor===String&&(this.handles[e]=this.element.children(this.handles[e]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=O(this.handles[e],this.element),r=/sw|ne|nw|se|n|s/.test(e)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),t.css(n,r),this._proportionallyResize()),O(this.handles[e]).length},this._renderAxis(this.element),this._handles=O(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){r.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=n&&n[1]?n[1]:"se")}),o.autoHide&&(this._handles.hide(),O(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||(O(this).removeClass("ui-resizable-autohide"),r._handles.show())}).mouseleave(function(){o.disabled||r.resizing||(O(this).addClass("ui-resizable-autohide"),r._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();function t(t){O(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()}var e;return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var e,i,n=!1;for(e in this.handles)(i=O(this.handles[e])[0])!==t.target&&!O.contains(i,t.target)||(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var e,i,n,r=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),r.containment&&(e+=O(r.containment).scrollLeft()||0,i+=O(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:e,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof r.aspectRatio?r.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=O(".ui-resizable-"+this.axis).css("cursor"),O("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var e,i,n=this.originalMousePosition,r=this.axis,o=t.pageX-n.left||0,s=t.pageY-n.top||0,a=this._change[r];return this._updatePrevProperties(),a&&(e=a.apply(this,[t,o,s]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(e=this._updateRatio(e,t)),e=this._respectSize(e,t),this._updateCache(e),this._propagate("resize",t),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),O.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges())),!1},_mouseStop:function(t){this.resizing=!1;var e,i,n,r,o,s,a,l=this.options,u=this;return this._helper&&(n=(i=(e=this._proportionallyResizeElements).length&&/textarea/i.test(e[0].nodeName))&&this._hasScroll(e[0],"left")?0:u.sizeDiff.height,r=i?0:u.sizeDiff.width,o={width:u.helper.width()-r,height:u.helper.height()-n},s=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,a=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(O.extend(o,{top:a,left:s})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),O("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,n,r,o=this.options,s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0};(this._aspectRatio||t)&&(e=s.minHeight*this.aspectRatio,n=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,r=s.maxWidth/this.aspectRatio,e>s.minWidth&&(s.minWidth=e),n>s.minHeight&&(s.minHeight=n),s.maxWidth>i&&(s.maxWidth=i),s.maxHeight>r&&(s.maxHeight=r)),this._vBoundaries=s},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,r=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,s=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,u=/sw|nw|w/.test(i),h=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),s&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),r&&(t.height=e.maxHeight),o&&u&&(t.left=a-e.minWidth),n&&u&&(t.left=a-e.maxWidth),s&&h&&(t.top=l-e.minHeight),r&&h&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],r=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)i[e]=parseInt(n[e],10)||0,i[e]+=parseInt(r[e],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,e=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||O("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize;return{top:this.originalPosition.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return O.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return O.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return O.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return O.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},_propagate:function(t,e){O.ui.plugin.call(this,t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),O.ui.plugin.add("resizable","animate",{stop:function(e){var i=O(this).resizable("instance"),t=i.options,n=i._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),o=r&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,s=r?0:i.sizeDiff.width,a={width:i.size.width-s,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(O.extend(a,u&&l?{top:u,left:l}:{}),{duration:t.animateDuration,easing:t.animateEasing,step:function(){var t={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&O(n[0]).css({width:t.width,height:t.height}),i._updateCache(t),i._propagate("resize",e)}})}}),O.ui.plugin.add("resizable","containment",{start:function(){var i,n,t,e,r,o,s,a=O(this).resizable("instance"),l=a.options,u=a.element,h=l.containment,c=h instanceof O?h.get(0):/parent/.test(h)?u.parent().get(0):h;c&&(a.containerElement=O(c),/document/.test(h)||h===document?(a.containerOffset={left:0,top:0},a.containerPosition={left:0,top:0},a.parentData={element:O(document),left:0,top:0,width:O(document).width(),height:O(document).height()||document.body.parentNode.scrollHeight}):(i=O(c),n=[],O(["Top","Right","Left","Bottom"]).each(function(t,e){n[t]=a._num(i.css("padding"+e))}),a.containerOffset=i.offset(),a.containerPosition=i.position(),a.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]},t=a.containerOffset,e=a.containerSize.height,r=a.containerSize.width,o=a._hasScroll(c,"left")?c.scrollWidth:r,s=a._hasScroll(c)?c.scrollHeight:e,a.parentData={element:c,left:t.left,top:t.top,width:o,height:s}))},resize:function(t){var e,i,n,r,o=O(this).resizable("instance"),s=o.options,a=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,h={top:0,left:0},c=o.containerElement,d=!0;c[0]!==document&&/static/.test(c.css("position"))&&(h=a),l.left<(o._helper?a.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-a.left:o.position.left-h.left),u&&(o.size.height=o.size.width/o.aspectRatio,d=!1),o.position.left=s.helper?a.left:0),l.top<(o._helper?a.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-a.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,d=!1),o.position.top=o._helper?a.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),r=/relative|absolute/.test(o.containerElement.css("position")),n&&r?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),e=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-h.left:o.offset.left-a.left)),i=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-h.top:o.offset.top-a.top)),e+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-e,u&&(o.size.height=o.size.width/o.aspectRatio,d=!1)),i+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-i,u&&(o.size.width=o.size.height*o.aspectRatio,d=!1)),d||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=O(this).resizable("instance"),e=t.options,i=t.containerOffset,n=t.containerPosition,r=t.containerElement,o=O(t.helper),s=o.offset(),a=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!e.animate&&/relative/.test(r.css("position"))&&O(this).css({left:s.left-n.left-i.left,width:a,height:l}),t._helper&&!e.animate&&/static/.test(r.css("position"))&&O(this).css({left:s.left-n.left-i.left,width:a,height:l})}}),O.ui.plugin.add("resizable","alsoResize",{start:function(){function e(t){O(t).each(function(){var t=O(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})}var t=O(this).resizable("instance").options;"object"!=typeof t.alsoResize||t.alsoResize.parentNode?e(t.alsoResize):t.alsoResize.length?(t.alsoResize=t.alsoResize[0],e(t.alsoResize)):O.each(t.alsoResize,function(t){e(t)})},resize:function(t,o){function i(t,i){O(t).each(function(){var t=O(this),n=O(this).data("ui-resizable-alsoresize"),r={},e=i&&i.length?i:t.parents(o.originalElement[0]).length?["width","height"]:["width","height","top","left"];O.each(e,function(t,e){var i=(n[e]||0)+(a[e]||0);i&&0<=i&&(r[e]=i||null)}),t.css(r)})}var e=O(this).resizable("instance"),n=e.options,r=e.originalSize,s=e.originalPosition,a={height:e.size.height-r.height||0,width:e.size.width-r.width||0,top:e.position.top-s.top||0,left:e.position.left-s.left||0};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?i(n.alsoResize):O.each(n.alsoResize,function(t,e){i(t,e)})},stop:function(){O(this).removeData("resizable-alsoresize")}}),O.ui.plugin.add("resizable","ghost",{start:function(){var t=O(this).resizable("instance"),e=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof e.ghost?e.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=O(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=O(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),O.ui.plugin.add("resizable","grid",{resize:function(){var t,e=O(this).resizable("instance"),i=e.options,n=e.size,r=e.originalSize,o=e.originalPosition,s=e.axis,a="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=a[0]||1,u=a[1]||1,h=Math.round((n.width-r.width)/l)*l,c=Math.round((n.height-r.height)/u)*u,d=r.width+h,p=r.height+c,f=i.maxWidth&&d>i.maxWidth,g=i.maxHeight&&p>i.maxHeight,m=i.minWidth&&i.minWidth>d,y=i.minHeight&&i.minHeight>p;i.grid=a,m&&(d+=l),y&&(p+=u),f&&(d-=l),g&&(p-=u),/^(se|s|e)$/.test(s)?(e.size.width=d,e.size.height=p):/^(ne)$/.test(s)?(e.size.width=d,e.size.height=p,e.position.top=o.top-c):/^(sw)$/.test(s)?(e.size.width=d,e.size.height=p,e.position.left=o.left-h):((p-u<=0||d-l<=0)&&(t=e._getPaddingPlusBorderDimensions(this)),0<p-u?(e.size.height=p,e.position.top=o.top-c):(p=u-t.height,e.size.height=p,e.position.top=o.top+r.height-p),0<d-l?(e.size.width=d,e.position.left=o.left-h):(d=u-t.height,e.size.width=d,e.position.left=o.left+r.width-d))}}),O.ui.resizable,O.widget("ui.selectable",O.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,e=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){(t=O(e.options.filter,e.element[0])).addClass("ui-selectee"),t.each(function(){var t=O(this),e=t.offset();O.data(this,"selectable-item",{element:this,$element:t,left:e.left,top:e.top,right:e.left+t.outerWidth(),bottom:e.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=O("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(i){var n=this,t=this.options;this.opos=[i.pageX,i.pageY],this.options.disabled||(this.selectees=O(t.filter,this.element[0]),this._trigger("start",i),O(t.appendTo).append(this.helper),this.helper.css({left:i.pageX,top:i.pageY,width:0,height:0}),t.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var t=O.data(this,"selectable-item");t.startselected=!0,i.metaKey||i.ctrlKey||(t.$element.removeClass("ui-selected"),t.selected=!1,t.$element.addClass("ui-unselecting"),t.unselecting=!0,n._trigger("unselecting",i,{unselecting:t.element}))}),O(i.target).parents().addBack().each(function(){var t,e=O.data(this,"selectable-item");return e?(t=!i.metaKey&&!i.ctrlKey||!e.$element.hasClass("ui-selected"),e.$element.removeClass(t?"ui-unselecting":"ui-selected").addClass(t?"ui-selecting":"ui-unselecting"),e.unselecting=!t,e.selecting=t,(e.selected=t)?n._trigger("selecting",i,{selecting:e.element}):n._trigger("unselecting",i,{unselecting:e.element}),!1):void 0}))},_mouseDrag:function(i){if(this.dragged=!0,!this.options.disabled){var t,n=this,r=this.options,o=this.opos[0],s=this.opos[1],a=i.pageX,l=i.pageY;return a<o&&(t=a,a=o,o=t),l<s&&(t=l,l=s,s=t),this.helper.css({left:o,top:s,width:a-o,height:l-s}),this.selectees.each(function(){var t=O.data(this,"selectable-item"),e=!1;t&&t.element!==n.element[0]&&("touch"===r.tolerance?e=!(t.left>a||o>t.right||t.top>l||s>t.bottom):"fit"===r.tolerance&&(e=t.left>o&&a>t.right&&t.top>s&&l>t.bottom),e?(t.selected&&(t.$element.removeClass("ui-selected"),t.selected=!1),t.unselecting&&(t.$element.removeClass("ui-unselecting"),t.unselecting=!1),t.selecting||(t.$element.addClass("ui-selecting"),t.selecting=!0,n._trigger("selecting",i,{selecting:t.element}))):(t.selecting&&((i.metaKey||i.ctrlKey)&&t.startselected?(t.$element.removeClass("ui-selecting"),t.selecting=!1,t.$element.addClass("ui-selected"),t.selected=!0):(t.$element.removeClass("ui-selecting"),t.selecting=!1,t.startselected&&(t.$element.addClass("ui-unselecting"),t.unselecting=!0),n._trigger("unselecting",i,{unselecting:t.element}))),t.selected&&(i.metaKey||i.ctrlKey||t.startselected||(t.$element.removeClass("ui-selected"),t.selected=!1,t.$element.addClass("ui-unselecting"),t.unselecting=!0,n._trigger("unselecting",i,{unselecting:t.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,O(".ui-unselecting",this.element[0]).each(function(){var t=O.data(this,"selectable-item");t.$element.removeClass("ui-unselecting"),t.unselecting=!1,t.startselected=!1,i._trigger("unselected",e,{unselected:t.element})}),O(".ui-selecting",this.element[0]).each(function(){var t=O.data(this,"selectable-item");t.$element.removeClass("ui-selecting").addClass("ui-selected"),t.selecting=!1,t.selected=!0,t.startselected=!0,i._trigger("selected",e,{selected:t.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),O.widget("ui.sortable",O.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return e<=t&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===t.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),O.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;0<=t;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,e){var i=null,n=!1,r=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),O(t.target).parents().each(function(){return O.data(this,r.widgetName+"-item")===r?(i=O(this),!1):void 0}),O.data(t.target,r.widgetName+"-item")===r&&(i=O(t.target)),!!i&&(!(this.options.handle&&!e&&(O(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(n=!0)}),!n))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,e,i){var n,r,o=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},O.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",o.cursor),this.storedStylesheet=O("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;0<=n;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return O.ui.ddmanager&&(O.ui.ddmanager.current=this),O.ui.ddmanager&&!o.dropBehaviour&&O.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,i,n,r,o=this.options,s=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-O(document).scrollTop()<o.scrollSensitivity?s=O(document).scrollTop(O(document).scrollTop()-o.scrollSpeed):O(window).height()-(t.pageY-O(document).scrollTop())<o.scrollSensitivity&&(s=O(document).scrollTop(O(document).scrollTop()+o.scrollSpeed)),t.pageX-O(document).scrollLeft()<o.scrollSensitivity?s=O(document).scrollLeft(O(document).scrollLeft()-o.scrollSpeed):O(window).width()-(t.pageX-O(document).scrollLeft())<o.scrollSensitivity&&(s=O(document).scrollLeft(O(document).scrollLeft()+o.scrollSpeed))),!1!==s&&O.ui.ddmanager&&!o.dropBehaviour&&O.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e=this.items.length-1;0<=e;e--)if(n=(i=this.items[e]).item[0],(r=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==n&&!O.contains(this.placeholder[0],n)&&("semi-dynamic"!==this.options.type||!O.contains(this.element[0],n))){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),O.ui.ddmanager&&O.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){var i,n,r,o;if(t)return O.ui.ddmanager&&!this.options.dropBehaviour&&O.ui.ddmanager.drop(this,t),this.options.revert?(n=(i=this).placeholder.offset(),o={},(r=this.options.axis)&&"x"!==r||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,O(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(t)})):this._clear(t,e),!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;0<=t;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),O.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?O(this.domPosition.prev).after(this.currentItem):O(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},O(t).each(function(){var t=(O(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);t&&i.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!i.length&&e.key&&i.push(e.key+"="),i.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e.each(function(){i.push(O(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,o=t.left,s=o+t.width,a=t.top,l=a+t.height,u=this.offset.click.top,h=this.offset.click.left,c="x"===this.options.axis||a<n+u&&n+u<l,d="y"===this.options.axis||o<e+h&&e+h<s,p=c&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&s>i-this.helperProportions.width/2&&n+this.helperProportions.height/2>a&&l>r-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=e&&i,r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return!!n&&(this.floating?o&&"right"===o||"down"===r?2:1:r&&("down"===r?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&i||"left"===r&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!=t&&(0<t?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!=t&&(0<t?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){function e(){s.push(this)}var i,n,r,o,s=[],a=[],l=this._connectWith();if(l&&t)for(i=l.length-1;0<=i;i--)for(n=(r=O(l[i])).length-1;0<=n;n--)(o=O.data(r[n],this.widgetFullName))&&o!==this&&!o.options.disabled&&a.push([O.isFunction(o.options.items)?o.options.items.call(o.element):O(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(a.push([O.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):O(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=a.length-1;0<=i;i--)a[i][0].each(e);return O(s)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=O.grep(this.items,function(t){for(var e=0;i.length>e;e++)if(i[e]===t.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var e,i,n,r,o,s,a,l,u=this.items,h=[[O.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):O(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(e=c.length-1;0<=e;e--)for(i=(n=O(c[e])).length-1;0<=i;i--)(r=O.data(n[i],this.widgetFullName))&&r!==this&&!r.options.disabled&&(h.push([O.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):O(r.options.items,r.element),r]),this.containers.push(r));for(e=h.length-1;0<=e;e--)for(o=h[e][1],i=0,l=(s=h[e][0]).length;i<l;i++)(a=O(s[i])).data(this.widgetName+"-item",o),u.push({item:a,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){var e,i,n,r;for(this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),e=this.items.length-1;0<=e;e--)(i=this.items[e]).instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?O(this.options.toleranceElement,i.item):i.item,t||(i.width=n.outerWidth(),i.height=n.outerHeight()),r=n.offset(),i.left=r.left,i.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;0<=e;e--)r=this.containers[e].element.offset(),this.containers[e].containerCache.left=r.left,this.containers[e].containerCache.top=r.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(i){var n,r=(i=i||this).options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var t=i.currentItem[0].nodeName.toLowerCase(),e=O("<"+t+">",i.document[0]).addClass(n||i.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===t?i.currentItem.children().each(function(){O("<td>&#160;</td>",i.document[0]).attr("colspan",O(this).attr("colspan")||1).appendTo(e)}):"img"===t&&e.attr("src",i.currentItem.attr("src")),n||e.css("visibility","hidden"),e},update:function(t,e){n&&!r.forcePlaceholderSize||(e.height()||e.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10)))}}),i.placeholder=O(r.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),r.placeholder.update(i,i.placeholder)},_contactContainers:function(t){for(var e,i,n,r,o,s,a,l,u,h=null,c=null,d=this.containers.length-1;0<=d;d--)if(!O.contains(this.currentItem[0],this.containers[d].element[0]))if(this._intersectsWith(this.containers[d].containerCache)){if(h&&O.contains(this.containers[d].element[0],h.element[0]))continue;h=this.containers[d],c=d}else this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",t,this._uiHash(this)),this.containers[d].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[c].containerCache.over||(this.containers[c]._trigger("over",t,this._uiHash(this)),this.containers[c].containerCache.over=1);else{for(i=1e4,n=null,r=(l=h.floating||this._isFloating(this.currentItem))?"left":"top",o=l?"width":"height",u=l?"clientX":"clientY",e=this.items.length-1;0<=e;e--)O.contains(this.containers[c].element[0],this.items[e].item[0])&&this.items[e].item[0]!==this.currentItem[0]&&(s=this.items[e].item.offset()[r],a=!1,t[u]-s>this.items[e][o]/2&&(a=!0),i>Math.abs(t[u]-s)&&(i=Math.abs(t[u]-s),n=this.items[e],this.direction=a?"up":"down"));if(!n&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[c])return void(this.currentContainer.containerCache.over||(this.containers[c]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));n?this._rearrange(t,n,null,!0):this._rearrange(t,null,this.containers[c].element,!0),this._trigger("change",t,this._uiHash()),this.containers[c]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[c],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[c]._trigger("over",t,this._uiHash(this)),this.containers[c].containerCache.over=1}},_createHelper:function(t){var e=this.options,i=O.isFunction(e.helper)?O(e.helper.apply(this.element[0],[t,this.currentItem])):"clone"===e.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||O("parent"!==e.appendTo?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!e.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!e.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),O.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&O.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&O.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),"document"!==n.containment&&"window"!==n.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,O("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(O("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=O(n.containment)[0],e=O(n.containment).offset(),i="hidden"!==O(t).css("overflow"),this.containment=[e.left+(parseInt(O(t).css("borderLeftWidth"),10)||0)+(parseInt(O(t).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(O(t).css("borderTopWidth"),10)||0)+(parseInt(O(t).css("paddingTop"),10)||0)-this.margins.top,e.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(O(t).css("borderLeftWidth"),10)||0)-(parseInt(O(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(O(t).css("borderTopWidth"),10)||0)-(parseInt(O(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e=e||this.position;var i="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&O.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:n.scrollTop())*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*i}},_generatePosition:function(t){var e,i,n=this.options,r=t.pageX,o=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&O.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(e=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=!this.containment||e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-n.grid[1]:e+n.grid[1],i=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0],r=!this.containment||i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0])),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:s.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:s.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){function i(e,i,n){return function(t){n._trigger(e,t,i._uiHash(i))}}this.reverting=!1;var n,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&r.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||r.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(r.push(function(t){this._trigger("remove",t,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;0<=n;n--)e||r.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;r.length>n;n++)r[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===O.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||O([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}}),O.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=O(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():O()}},_createIcons:function(){var t=this.options.icons;t&&(O("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&(this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e))))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var e=O.ui.keyCode,i=this.headers.length,n=this.headers.index(t.target),r=!1;switch(t.keyCode){case e.RIGHT:case e.DOWN:r=this.headers[(n+1)%i];break;case e.LEFT:case e.UP:r=this.headers[(n-1+i)%i];break;case e.SPACE:case e.ENTER:this._eventHandler(t);break;case e.HOME:r=this.headers[0];break;case e.END:r=this.headers[i-1]}r&&(O(t.target).attr("tabIndex",-1),O(r).attr("tabIndex",0),r.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===O.ui.keyCode.UP&&t.ctrlKey&&O(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=O()):!1===t.active?this._activate(0):this.active.length&&!O.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=O()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var i,t=this.options,e=t.heightStyle,n=this.element.parent();this.active=this._findActive(t.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=O(this),e=t.uniqueId().attr("id"),i=t.next(),n=i.uniqueId().attr("id");t.attr("aria-controls",n),i.attr("aria-labelledby",e)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(t.event),"fill"===e?(i=n.height(),this.element.siblings(":visible").each(function(){var t=O(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(i-=t.outerHeight(!0))}),this.headers.each(function(){i-=O(this).outerHeight(!0)}),this.headers.next().each(function(){O(this).height(Math.max(0,i-O(this).innerHeight()+O(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.headers.next().each(function(){i=Math.max(i,O(this).css("height","").height())}).height(i))},_activate:function(t){var e=this._findActive(t)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,currentTarget:e,preventDefault:O.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):O()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&O.each(t.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var e=this.options,i=this.active,n=O(t.currentTarget),r=n[0]===i[0],o=r&&e.collapsible,s=o?O():n.next(),a=i.next(),l={oldHeader:i,oldPanel:a,newHeader:o?O():n,newPanel:s};t.preventDefault(),r&&!e.collapsible||!1===this._trigger("beforeActivate",t,l)||(e.active=!o&&this.headers.index(n),this.active=r?O():n,this._toggle(l),i.removeClass("ui-accordion-header-active ui-state-active"),e.icons&&i.children(".ui-accordion-header-icon").removeClass(e.icons.activeHeader).addClass(e.icons.header),r||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),e.icons&&n.children(".ui-accordion-header-icon").removeClass(e.icons.header).addClass(e.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var e=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=e,this.prevHide=i,this.options.animate?this._animate(e,i,t):(i.hide(),e.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr("aria-selected","false"),e.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):e.length&&this.headers.filter(function(){return 0===O(this).attr("tabIndex")}).attr("tabIndex",-1),e.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(t,i,e){function n(){a._toggleComplete(e)}var r,o,s,a=this,l=0,u=t.length&&(!i.length||t.index()<i.index()),h=this.options.animate||{},c=u&&h.down||h;return"number"==typeof c&&(s=c),"string"==typeof c&&(o=c),o=o||c.easing||h.easing,s=s||c.duration||h.duration,i.length?t.length?(r=t.show().outerHeight(),i.animate(this.hideProps,{duration:s,easing:o,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:s,easing:o,complete:n,step:function(t,e){e.now=Math.round(t),"height"!==e.prop?l+=e.now:"content"!==a.options.heightStyle&&(e.now=Math.round(r-i.outerHeight()-l),l=0)}})):i.animate(this.hideProps,s,o,n):t.animate(this.showProps,s,o,n)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&e.parent()[0].className,this._trigger("activate",null,t)}}),O.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(t){var e=O(t.target);!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),e.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&O(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var e;this.previousFilter||((e=O(t.currentTarget)).siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,e))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(t){this._delay(function(){O.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=O(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var e,i,n,r,o=!0;switch(t.keyCode){case O.ui.keyCode.PAGE_UP:this.previousPage(t);break;case O.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case O.ui.keyCode.HOME:this._move("first","first",t);break;case O.ui.keyCode.END:this._move("last","last",t);break;case O.ui.keyCode.UP:this.previous(t);break;case O.ui.keyCode.DOWN:this.next(t);break;case O.ui.keyCode.LEFT:this.collapse(t);break;case O.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case O.ui.keyCode.ENTER:case O.ui.keyCode.SPACE:this._activate(t);break;case O.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,i=this.previousFilter||"",n=String.fromCharCode(t.keyCode),r=!1,clearTimeout(this.filterTimer),n===i?r=!0:n=i+n,e=this._filterMenuItems(n),(e=r&&-1!==e.index(this.active.next())?this.active.nextAll(".ui-menu-item"):e).length||(n=String.fromCharCode(t.keyCode),e=this._filterMenuItems(n)),e.length?(this.focus(t,e),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var t,e=this,n=this.options.icons.submenu,i=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=O(this),e=t.parent(),i=O("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);e.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",e.attr("id"))}),(t=i.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var t=O(this);e._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),t.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),t.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!O.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(t){var e,i,n,r,o,s;this._hasScroll()&&(e=parseFloat(O.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(O.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-e-i,r=this.activeMenu.scrollTop(),o=this.activeMenu.height(),s=t.outerHeight(),n<0?this.activeMenu.scrollTop(r+n):o<n+s&&this.activeMenu.scrollTop(r+n-o+s))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(t){var e=O.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var t=i?this.element:O(e&&e.target).closest(this.element.find(".ui-menu"));t.length||(t=this.element),this._close(t),this.blur(e),this.activeMenu=t},this.delay)},_close:function(t){(t=t||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!O(t.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(i,n)},nextPage:function(t){var e,i,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(e=O(this)).offset().top-i-n<0}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var e,i,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(e=O(this)).offset().top-i+n}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items).first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||O(t.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,e)},_filterMenuItems:function(t){var e=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=RegExp("^"+e,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return i.test(O.trim(O(this).text()))})}}),O.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var i,n,r,t=this.element[0].nodeName.toLowerCase(),e="textarea"===t,o="input"===t;this.isMultiLine=e||!o&&this.element.prop("isContentEditable"),this.valueMethod=this.element[e||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(t){if(this.element.prop("readOnly"))n=r=i=!0;else{n=r=i=!1;var e=O.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:i=!0,this._move("previousPage",t);break;case e.PAGE_DOWN:i=!0,this._move("nextPage",t);break;case e.UP:i=!0,this._keyEvent("previous",t);break;case e.DOWN:i=!0,this._keyEvent("next",t);break;case e.ENTER:this.menu.active&&(i=!0,t.preventDefault(),this.menu.select(t));break;case e.TAB:this.menu.active&&this.menu.select(t);break;case e.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(t),t.preventDefault());break;default:n=!0,this._searchTimeout(t)}}},keypress:function(t){if(i)return i=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||t.preventDefault());if(!n){var e=O.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:this._move("previousPage",t);break;case e.PAGE_DOWN:this._move("nextPage",t);break;case e.UP:this._keyEvent("previous",t);break;case e.DOWN:this._keyEvent("next",t)}}},input:function(t){return r?(r=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=O("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];O(t.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(t){t.target===e.element[0]||t.target===i||O.contains(i,t.target)||e.close()})})},menufocus:function(t,e){var i,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){O(t.target).trigger(t.originalEvent)})):(n=e.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),void((i=e.item.attr("aria-label")||n.value)&&O.trim(i).length&&(this.liveRegion.children().hide(),O("<div>").text(i).appendTo(this.liveRegion))))},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=O("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return(t=t&&(t.jquery||t.nodeType?O(t):this.document.find(t).eq(0)))&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var i,n,r=this;O.isArray(this.options.source)?(i=this.options.source,this.source=function(t,e){e(O.ui.autocomplete.filter(i,t.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,e){r.xhr&&r.xhr.abort(),r.xhr=O.ajax({url:n,data:t,dataType:"json",success:function(t){e(t)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(n){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),e=this.menu.element.is(":visible"),i=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;t&&(!t||e||i)||(this.selectedItem=null,this.search(null,n))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return O.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t=t&&this._normalize(t),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:O.map(t,function(t){return"string"==typeof t?{label:t,value:t}:O.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var e=this.menu.element.empty();this._renderMenu(e,t),this.isNewMenu=!0,this.menu.refresh(),e.show(),this._resizeMenu(),e.position(O.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(i,t){var n=this;O.each(t,function(t,e){n._renderItemData(i,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(t,e){return O("<li>").text(e.label).appendTo(t)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(t,e),e.preventDefault())}}),O.extend(O.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,e){var i=RegExp(O.ui.autocomplete.escapeRegex(e),"i");return O.grep(t,function(t){return i.test(t.label||t.value||t)})}}),O.widget("ui.autocomplete",O.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(1<t?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),O("<div>").text(e).appendTo(this.liveRegion))}}),O.ui.autocomplete;function m(){var t=O(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)}function y(t){var e=t.name,i=t.form,n=O([]);return e&&(e=e.replace(/'/g,"\\'"),n=i?O(i).find("[name='"+e+"'][type=radio]"):O("[name='"+e+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n}var _,v,b,j="ui-button ui-widget ui-state-default ui-corner-all",x="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only";O.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,i=this.options,t="checkbox"===this.type||"radio"===this.type,n=t?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(j).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===_&&O(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||O(this).removeClass(n)}).bind("click"+this.eventNamespace,function(t){i.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),t&&this.element.bind("change"+this.eventNamespace,function(){e.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!i.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;O(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var t=e.element[0];y(t).not(t).map(function(){return O(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!i.disabled&&(O(this).addClass("ui-state-active"),_=this,void e.document.one("mouseup",function(){_=null}))}).bind("mouseup"+this.eventNamespace,function(){return!i.disabled&&void O(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return!i.disabled&&void(t.keyCode!==O.ui.keyCode.SPACE&&t.keyCode!==O.ui.keyCode.ENTER||O(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){O(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===O.ui.keyCode.SPACE&&O(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),(i=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(j+" ui-state-active "+x).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),void(e&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?y(this.element[0]).each(function(){O(this).is(":checked")?O(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):O(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){var t,e,i,n,r;"input"!==this.type?(t=this.buttonElement.removeClass(x),e=O("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),n=(i=this.options.icons).primary&&i.secondary,r=[],i.primary||i.secondary?(this.options.text&&r.push("ui-button-text-icon"+(n?"s":i.primary?"-primary":"-secondary")),i.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(r.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",O.trim(e)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))):this.options.label&&this.element.val(this.options.label)}}),O.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var t="rtl"===this.element.css("direction"),e=this.element.find(this.options.items),i=e.filter(":ui-button");e.not(":ui-button").button(),i.button("refresh"),this.buttons=e.map(function(){return O(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return O(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),O.ui.button,O.extend(O.ui,{datepicker:{version:"1.11.2"}}),O.extend(t.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return c(this._defaults,t||{}),this},_attachDatepicker:function(t,e){var i,n=t.nodeName.toLowerCase(),r="div"===n||"span"===n;t.id||(this.uuid+=1,t.id="dp"+this.uuid),(i=this._newInst(O(t),r)).settings=O.extend({},e||{}),"input"===n?this._connectDatepicker(t,i):r&&this._inlineDatepicker(t,i)},_newInst:function(t,e){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?i(O("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,e){var i=O(t);e.append=O([]),e.trigger=O([]),i.hasClass(this.markerClassName)||(this._attachments(i,e),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(e),O.data(t,"datepicker",e),e.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,e){var i,n,r,o=this._get(e,"appendText"),s=this._get(e,"isRTL");e.append&&e.append.remove(),o&&(e.append=O("<span class='"+this._appendClass+"'>"+o+"</span>"),t[s?"before":"after"](e.append)),t.unbind("focus",this._showDatepicker),e.trigger&&e.trigger.remove(),"focus"!==(i=this._get(e,"showOn"))&&"both"!==i||t.focus(this._showDatepicker),"button"!==i&&"both"!==i||(n=this._get(e,"buttonText"),r=this._get(e,"buttonImage"),e.trigger=O(this._get(e,"buttonImageOnly")?O("<img/>").addClass(this._triggerClass).attr({src:r,alt:n,title:n}):O("<button type='button'></button>").addClass(this._triggerClass).html(r?O("<img/>").attr({src:r,alt:n,title:n}):n)),t[s?"before":"after"](e.trigger),e.trigger.click(function(){return O.datepicker._datepickerShowing&&O.datepicker._lastInput===t[0]?O.datepicker._hideDatepicker():(O.datepicker._datepickerShowing&&O.datepicker._lastInput!==t[0]&&O.datepicker._hideDatepicker(),O.datepicker._showDatepicker(t[0])),!1}))},_autoSize:function(t){var e,i,n,r,o,s;this._get(t,"autoSize")&&!t.inline&&(o=new Date(2009,11,20),(s=this._get(t,"dateFormat")).match(/[DM]/)&&(e=function(t){for(r=n=i=0;t.length>r;r++)t[r].length>i&&(i=t[r].length,n=r);return n},o.setMonth(e(this._get(t,s.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length))},_inlineDatepicker:function(t,e){var i=O(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv),O.data(t,"datepicker",e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),e.settings.disabled&&this._disableDatepicker(t),e.dpDiv.css("display","block"))},_dialogDatepicker:function(t,e,i,n,r){var o,s,a,l,u,h=this._dialogInst;return h||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=O("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),O("body").append(this._dialogInput),(h=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},O.data(this._dialogInput[0],"datepicker",h)),c(h.settings,n||{}),e=e&&e.constructor===Date?this._formatDate(h,e):e,this._dialogInput.val(e),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(s=document.documentElement.clientWidth,a=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[s/2-100+l,a/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),O.blockUI&&O.blockUI(this.dpDiv),O.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(t){var e,i=O(t),n=O.data(t,"datepicker");i.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),O.removeData(t,"datepicker"),"input"===e?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==e&&"span"!==e||i.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var t,i,n=O(e),r=O.data(e,"datepicker");n.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!1,r.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==t&&"span"!==t||((i=n.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=O.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var t,i,n=O(e),r=O.data(e,"datepicker");n.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!0,r.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==t&&"span"!==t||((i=n.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=O.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(t){try{return O.data(t,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,e,i){var n,r,o,s,a=this._getInst(t);return 2===arguments.length&&"string"==typeof e?"defaults"===e?O.extend({},O.datepicker._defaults):a?"all"===e?O.extend({},a.settings):this._get(a,e):null:(n=e||{},"string"==typeof e&&((n={})[e]=i),void(a&&(this._curInst===a&&this._hideDatepicker(),r=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(a,"min"),s=this._getMinMaxDate(a,"max"),c(a.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(a.settings.minDate=this._formatDate(a,o)),null!==s&&void 0!==n.dateFormat&&void 0===n.maxDate&&(a.settings.maxDate=this._formatDate(a,s)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(O(t),a),this._autoSize(a),this._setDate(a,r),this._updateAlternate(a),this._updateDatepicker(a))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(t){var e,i,n,r=O.datepicker._getInst(t.target),o=!0,s=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,O.datepicker._datepickerShowing)switch(t.keyCode){case 9:O.datepicker._hideDatepicker(),o=!1;break;case 13:return(n=O("td."+O.datepicker._dayOverClass+":not(."+O.datepicker._currentClass+")",r.dpDiv))[0]&&O.datepicker._selectDay(t.target,r.selectedMonth,r.selectedYear,n[0]),(e=O.datepicker._get(r,"onSelect"))?(i=O.datepicker._formatDate(r),e.apply(r.input?r.input[0]:null,[i,r])):O.datepicker._hideDatepicker(),!1;case 27:O.datepicker._hideDatepicker();break;case 33:O.datepicker._adjustDate(t.target,t.ctrlKey?-O.datepicker._get(r,"stepBigMonths"):-O.datepicker._get(r,"stepMonths"),"M");break;case 34:O.datepicker._adjustDate(t.target,t.ctrlKey?+O.datepicker._get(r,"stepBigMonths"):+O.datepicker._get(r,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&O.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&O.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&O.datepicker._adjustDate(t.target,s?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&O.datepicker._adjustDate(t.target,t.ctrlKey?-O.datepicker._get(r,"stepBigMonths"):-O.datepicker._get(r,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&O.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&O.datepicker._adjustDate(t.target,s?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&O.datepicker._adjustDate(t.target,t.ctrlKey?+O.datepicker._get(r,"stepBigMonths"):+O.datepicker._get(r,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&O.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?O.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e,i,n=O.datepicker._getInst(t.target);return O.datepicker._get(n,"constrainInput")?(e=O.datepicker._possibleChars(O.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||i<" "||!e||-1<e.indexOf(i)):void 0},_doKeyUp:function(t){var e=O.datepicker._getInst(t.target);if(e.input.val()!==e.lastVal)try{O.datepicker.parseDate(O.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,O.datepicker._getFormatConfig(e))&&(O.datepicker._setDateFromField(e),O.datepicker._updateAlternate(e),O.datepicker._updateDatepicker(e))}catch(t){}return!0},_showDatepicker:function(t){var e,i,n,r,o,s,a;"input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=O("input",t.parentNode)[0]),O.datepicker._isDisabledDatepicker(t)||O.datepicker._lastInput===t||(a=O.datepicker._getInst(t),O.datepicker._curInst&&O.datepicker._curInst!==a&&(O.datepicker._curInst.dpDiv.stop(!0,!0),a&&O.datepicker._datepickerShowing&&O.datepicker._hideDatepicker(O.datepicker._curInst.input[0])),!1!==(i=(e=O.datepicker._get(a,"beforeShow"))?e.apply(t,[t,a]):{})&&(c(a.settings,i),a.lastVal=null,O.datepicker._lastInput=t,O.datepicker._setDateFromField(a),O.datepicker._inDialog&&(t.value=""),O.datepicker._pos||(O.datepicker._pos=O.datepicker._findPos(t),O.datepicker._pos[1]+=t.offsetHeight),n=!1,O(t).parents().each(function(){return!(n|="fixed"===O(this).css("position"))}),r={left:O.datepicker._pos[0],top:O.datepicker._pos[1]},O.datepicker._pos=null,a.dpDiv.empty(),a.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),O.datepicker._updateDatepicker(a),r=O.datepicker._checkOffset(a,r,n),a.dpDiv.css({position:O.datepicker._inDialog&&O.blockUI?"static":n?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),a.inline||(o=O.datepicker._get(a,"showAnim"),s=O.datepicker._get(a,"duration"),a.dpDiv.css("z-index",function(t){for(var e,i;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}(O(t))+1),O.datepicker._datepickerShowing=!0,O.effects&&O.effects.effect[o]?a.dpDiv.show(o,O.datepicker._get(a,"showOptions"),s):a.dpDiv[o||"show"](o?s:null),O.datepicker._shouldFocusInput(a)&&a.input.focus(),O.datepicker._curInst=a)))},_updateDatepicker:function(t){this.maxRows=4,(v=t).dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var e,i=this._getNumberOfMonths(t),n=i[1],r=t.dpDiv.find("."+this._dayOverClass+" a");0<r.length&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<n&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===O.datepicker._curInst&&O.datepicker._datepickerShowing&&O.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(e=t.yearshtml,setTimeout(function(){e===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),e=t.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(t,e,i){var n=t.dpDiv.outerWidth(),r=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(i?0:O(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:O(document).scrollTop());return e.left-=this._get(t,"isRTL")?n-o:0,e.left-=i&&e.left===t.input.offset().left?O(document).scrollLeft():0,e.top-=i&&e.top===t.input.offset().top+s?O(document).scrollTop():0,e.left-=Math.min(e.left,e.left+n>a&&n<a?Math.abs(e.left+n-a):0),e.top-=Math.min(e.top,e.top+r>l&&r<l?Math.abs(r+s):0),e},_findPos:function(t){for(var e,i=this._getInst(t),n=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||O.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return[(e=O(t).offset()).left,e.top]},_hideDatepicker:function(t){var e,i,n,r,o=this._curInst;!o||t&&o!==O.data(t,"datepicker")||this._datepickerShowing&&(e=this._get(o,"showAnim"),i=this._get(o,"duration"),n=function(){O.datepicker._tidyDialog(o)},O.effects&&(O.effects.effect[e]||O.effects[e])?o.dpDiv.hide(e,O.datepicker._get(o,"showOptions"),i,n):o.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?i:null,n),e||n(),this._datepickerShowing=!1,(r=this._get(o,"onClose"))&&r.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),O.blockUI&&(O.unblockUI(),O("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){var e,i;O.datepicker._curInst&&(e=O(t.target),i=O.datepicker._getInst(e[0]),(e[0].id===O.datepicker._mainDivId||0!==e.parents("#"+O.datepicker._mainDivId).length||e.hasClass(O.datepicker.markerClassName)||e.closest("."+O.datepicker._triggerClass).length||!O.datepicker._datepickerShowing||O.datepicker._inDialog&&O.blockUI)&&(!e.hasClass(O.datepicker.markerClassName)||O.datepicker._curInst===i)||O.datepicker._hideDatepicker())},_adjustDate:function(t,e,i){var n=O(t),r=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(r,e+("M"===i?this._get(r,"showCurrentAtPos"):0),i),this._updateDatepicker(r))},_gotoToday:function(t){var e,i=O(t),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(e=new Date,n.selectedDay=e.getDate(),n.drawMonth=n.selectedMonth=e.getMonth(),n.drawYear=n.selectedYear=e.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(t,e,i){var n=O(t),r=this._getInst(n[0]);r["selected"+("M"===i?"Month":"Year")]=r["draw"+("M"===i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(n)},_selectDay:function(t,e,i,n){var r,o=O(t);O(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||((r=this._getInst(o[0])).selectedDay=r.currentDay=O("a",n).html(),r.selectedMonth=r.currentMonth=e,r.selectedYear=r.currentYear=i,this._selectDate(t,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(t){var e=O(t);this._selectDate(e,"")},_selectDate:function(t,e){var i,n=O(t),r=this._getInst(n[0]);e=null!=e?e:this._formatDate(r),r.input&&r.input.val(e),this._updateAlternate(r),(i=this._get(r,"onSelect"))?i.apply(r.input?r.input[0]:null,[e,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var e,i,n,r=this._get(t,"altField");r&&(e=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),n=this.formatDate(e,i,this._getFormatConfig(t)),O(r).each(function(){O(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[0<e&&e<6,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(i,o,t){if(null==i||null==o)throw"Invalid arguments";if(""===(o="object"==typeof o?""+o:o+""))return null;function s(t){var e=i.length>x+1&&i.charAt(x+1)===t;return e&&x++,e}function e(t){var e=s(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n=RegExp("^\\d{"+("y"===t?i:1)+","+i+"}"),r=o.substring(h).match(n);if(!r)throw"Missing number at position "+h;return h+=r[0].length,parseInt(r[0],10)}function n(t,e,i){var n=-1,r=O.map(s(t)?i:e,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(O.each(r,function(t,e){var i=e[1];return o.substr(h,i.length).toLowerCase()===i.toLowerCase()?(n=e[0],h+=i.length,!1):void 0}),-1!==n)return n+1;throw"Unknown name at position "+h}function r(){if(o.charAt(h)!==i.charAt(x))throw"Unexpected literal at position "+h;h++}for(var a,l,u,h=0,c=(t?t.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),p=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,f=(t?t.dayNames:null)||this._defaults.dayNames,g=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,m=(t?t.monthNames:null)||this._defaults.monthNames,y=-1,_=-1,v=-1,b=-1,j=!1,x=0;i.length>x;x++)if(j)"'"!==i.charAt(x)||s("'")?r():j=!1;else switch(i.charAt(x)){case"d":v=e("d");break;case"D":n("D",p,f);break;case"o":b=e("o");break;case"m":_=e("m");break;case"M":_=n("M",g,m);break;case"y":y=e("y");break;case"@":y=(u=new Date(e("@"))).getFullYear(),_=u.getMonth()+1,v=u.getDate();break;case"!":y=(u=new Date((e("!")-this._ticksTo1970)/1e4)).getFullYear(),_=u.getMonth()+1,v=u.getDate();break;case"'":s("'")?r():j=!0;break;default:r()}if(o.length>h&&(l=o.substr(h),!/^\s+/.test(l)))throw"Extra/unparsed characters found in date: "+l;if(-1===y?y=(new Date).getFullYear():y<100&&(y+=(new Date).getFullYear()-(new Date).getFullYear()%100+(y<=d?0:-100)),-1<b)for(_=1,v=b;!(v<=(a=this._getDaysInMonth(y,_-1)));)_++,v-=a;if((u=this._daylightSavingAdjust(new Date(y,_-1,v))).getFullYear()!==y||u.getMonth()+1!==_||u.getDate()!==v)throw"Invalid date";return u},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(i,t,e){if(!t)return"";function r(t){var e=i.length>s+1&&i.charAt(s+1)===t;return e&&s++,e}function n(t,e,i){var n=""+e;if(r(t))for(;i>n.length;)n="0"+n;return n}function o(t,e,i,n){return r(t)?n[e]:i[e]}var s,a=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,l=(e?e.dayNames:null)||this._defaults.dayNames,u=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,h=(e?e.monthNames:null)||this._defaults.monthNames,c="",d=!1;if(t)for(s=0;i.length>s;s++)if(d)"'"!==i.charAt(s)||r("'")?c+=i.charAt(s):d=!1;else switch(i.charAt(s)){case"d":c+=n("d",t.getDate(),2);break;case"D":c+=o("D",t.getDay(),a,l);break;case"o":c+=n("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=n("m",t.getMonth()+1,2);break;case"M":c+=o("M",t.getMonth(),u,h);break;case"y":c+=r("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":r("'")?c+="'":d=!0;break;default:c+=i.charAt(s)}return c},_possibleChars:function(i){function t(t){var e=i.length>r+1&&i.charAt(r+1)===t;return e&&r++,e}for(var e="",n=!1,r=0;i.length>r;r++)if(n)"'"!==i.charAt(r)||t("'")?e+=i.charAt(r):n=!1;else switch(i.charAt(r)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":t("'")?e+="'":n=!0;break;default:e+=i.charAt(r)}return e},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,r=this._getDefaultDate(t),o=r,s=this._getFormatConfig(t);try{o=this.parseDate(i,n,s)||r}catch(t){n=e?"":n}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=n?o.getDate():0,t.currentMonth=n?o.getMonth():0,t.currentYear=n?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(a,t,e){var i,n,r=null==t||""===t?e:"string"==typeof t?function(t){try{return O.datepicker.parseDate(O.datepicker._get(a,"dateFormat"),t,O.datepicker._getFormatConfig(a))}catch(t){}for(var e=(t.toLowerCase().match(/^c/)?O.datepicker._getDate(a):null)||new Date,i=e.getFullYear(),n=e.getMonth(),r=e.getDate(),o=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,s=o.exec(t);s;){switch(s[2]||"d"){case"d":case"D":r+=parseInt(s[1],10);break;case"w":case"W":r+=7*parseInt(s[1],10);break;case"m":case"M":n+=parseInt(s[1],10),r=Math.min(r,O.datepicker._getDaysInMonth(i,n));break;case"y":case"Y":i+=parseInt(s[1],10),r=Math.min(r,O.datepicker._getDaysInMonth(i,n))}s=o.exec(t)}return new Date(i,n,r)}(t):"number"==typeof t?isNaN(t)?e:(i=t,(n=new Date).setDate(n.getDate()+i),n):new Date(t.getTime());return(r=r&&"Invalid Date"==""+r?e:r)&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(t){return t?(t.setHours(12<t.getHours()?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,r=t.selectedMonth,o=t.selectedYear,s=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=s.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=s.getMonth(),t.drawYear=t.selectedYear=t.currentYear=s.getFullYear(),r===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(t){var e=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){O.datepicker._adjustDate(i,-e,"M")},next:function(){O.datepicker._adjustDate(i,+e,"M")},hide:function(){O.datepicker._hideDatepicker()},today:function(){O.datepicker._gotoToday(i)},selectDay:function(){return O.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return O.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return O.datepicker._selectMonthYear(i,this,"Y"),!1}};O(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v,b,j,x,S,w,P,E,T,O,C,M,I,R,k,A,L,F,N,D,G,U=new Date,z=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),B=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),V=this._get(t,"hideIfNoPrevNext"),Y=this._get(t,"navigationAsDateFormat"),H=this._getNumberOfMonths(t),X=this._get(t,"showCurrentAtPos"),q=this._get(t,"stepMonths"),K=1!==H[0]||1!==H[1],Z=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),$=this._getMinMaxDate(t,"min"),Q=this._getMinMaxDate(t,"max"),J=t.drawMonth-X,tt=t.drawYear;if(J<0&&(J+=12,tt--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-H[0]*H[1]+1,Q.getDate())),e=$&&e<$?$:e;this._daylightSavingAdjust(new Date(tt,J,1))>e;)--J<0&&(J=11,tt--);for(t.drawMonth=J,t.drawYear=tt,i=this._get(t,"prevText"),i=Y?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,J-q,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":V?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",r=this._get(t,"nextText"),r=Y?this.formatDate(r,this._daylightSavingAdjust(new Date(tt,J+q,1)),this._getFormatConfig(t)):r,o=this._canAdjustMonth(t,1,tt,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+r+"</span></a>":V?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+r+"</span></a>",s=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?Z:z,s=Y?this.formatDate(s,a,this._getFormatConfig(t)):s,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",u=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+s+"</button>":"")+(B?"":l)+"</div>":"",h=parseInt(this._get(t,"firstDay"),10),h=isNaN(h)?0:h,c=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),y=this._get(t,"showOtherMonths"),_=this._get(t,"selectOtherMonths"),v=this._getDefaultDate(t),b="",x=0;H[0]>x;x++){for(S="",this.maxRows=4,w=0;H[1]>w;w++){if(P=this._daylightSavingAdjust(new Date(tt,J,t.selectedDay)),E=" ui-corner-all",T="",K){if(T+="<div class='ui-datepicker-group",1<H[1])switch(w){case 0:T+=" ui-datepicker-group-first",E=" ui-corner-"+(B?"right":"left");break;case H[1]-1:T+=" ui-datepicker-group-last",E=" ui-corner-"+(B?"left":"right");break;default:T+=" ui-datepicker-group-middle",E=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+E+"'>"+(/all|left/.test(E)&&0===x?B?o:n:"")+(/all|right/.test(E)&&0===x?B?n:o:"")+this._generateMonthYearHeader(t,J,tt,$,Q,0<x||0<w,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",O=c?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",j=0;j<7;j++)O+="<th scope='col'"+(5<=(j+h+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+d[C=(j+h)%7]+"'>"+p[C]+"</span></th>";for(T+=O+"</tr></thead><tbody>",M=this._getDaysInMonth(tt,J),tt===t.selectedYear&&J===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,M)),I=(this._getFirstDayOfMonth(tt,J)-h+7)%7,R=Math.ceil((I+M)/7),k=K&&this.maxRows>R?this.maxRows:R,this.maxRows=k,A=this._daylightSavingAdjust(new Date(tt,J,1-I)),L=0;L<k;L++){for(T+="<tr>",F=c?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(A)+"</td>":"",j=0;j<7;j++)N=m?m.apply(t.input?t.input[0]:null,[A]):[!0,""],G=(D=A.getMonth()!==J)&&!_||!N[0]||$&&A<$||Q&&Q<A,F+="<td class='"+(5<=(j+h+6)%7?" ui-datepicker-week-end":"")+(D?" ui-datepicker-other-month":"")+(A.getTime()===P.getTime()&&J===t.selectedMonth&&t._keyEvent||v.getTime()===A.getTime()&&v.getTime()===P.getTime()?" "+this._dayOverClass:"")+(G?" "+this._unselectableClass+" ui-state-disabled":"")+(D&&!y?"":" "+N[1]+(A.getTime()===Z.getTime()?" "+this._currentClass:"")+(A.getTime()===z.getTime()?" ui-datepicker-today":""))+"'"+(D&&!y||!N[2]?"":" title='"+N[2].replace(/'/g,"&#39;")+"'")+(G?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(D&&!y?"&#xa0;":G?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===z.getTime()?" ui-state-highlight":"")+(A.getTime()===Z.getTime()?" ui-state-active":"")+(D?" ui-priority-secondary":"")+"' href='#'>"+A.getDate()+"</a>")+"</td>",A.setDate(A.getDate()+1),A=this._daylightSavingAdjust(A);T+=F+"</tr>"}11<++J&&(J=0,tt++),S+=T+="</tbody></table>"+(K?"</div>"+(0<H[0]&&w===H[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}b+=S}return b+=u,t._keyEvent=!1,b},_generateMonthYearHeader:function(t,e,i,n,r,o,s,a){var l,u,h,c,d,p,f,g,m=this._get(t,"changeMonth"),y=this._get(t,"changeYear"),_=this._get(t,"showMonthAfterYear"),v="<div class='ui-datepicker-title'>",b="";if(o||!m)b+="<span class='ui-datepicker-month'>"+s[e]+"</span>";else{for(l=n&&n.getFullYear()===i,u=r&&r.getFullYear()===i,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",h=0;h<12;h++)(!l||h>=n.getMonth())&&(!u||r.getMonth()>=h)&&(b+="<option value='"+h+"'"+(h===e?" selected='selected'":"")+">"+a[h]+"</option>");b+="</select>"}if(_||(v+=b+(!o&&m&&y?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!y)v+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(c=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),f=(p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e})(c[0]),g=Math.max(f,p(c[1]||"")),f=n?Math.max(f,n.getFullYear()):f,g=r?Math.min(g,r.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f<=g;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",v+=t.yearshtml,t.yearshtml=null}return v+=this._get(t,"yearSuffix"),_&&(v+=(!o&&m&&y?"":"&#xa0;")+b),v+"</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),r=t.drawMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(n,r))+("D"===i?e:0),s=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,r,o)));t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),r=i&&e<i?i:e;return n&&n<r?n:r},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var r=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,n+(e<0?e:r[0]*r[1]),1));return e<0&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,n,r=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),s=null,a=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),s=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(s+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!r||e.getTime()>=r.getTime())&&(!o||e.getTime()<=o.getTime())&&(!s||e.getFullYear()>=s)&&(!a||a>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var r=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),r,this._getFormatConfig(t))}}),O.fn.datepicker=function(t){if(!this.length)return this;O.datepicker.initialized||(O(document).mousedown(O.datepicker._checkExternalClick),O.datepicker.initialized=!0),0===O("#"+O.datepicker._mainDivId).length&&O("body").append(O.datepicker.dpDiv);var e=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&("isDisabled"===t||"getDate"===t||"widget"===t)||"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?O.datepicker["_"+t+"Datepicker"].apply(O.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof t?O.datepicker["_"+t+"Datepicker"].apply(O.datepicker,[this].concat(e)):O.datepicker._attachDatepicker(this,t)})},O.datepicker=new t,O.datepicker.initialized=!1,O.datepicker.uuid=(new Date).getTime(),O.datepicker.version="1.11.2",O.datepicker,O.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var e=O(this).css(t).offset().top;e<0&&O(this).css("top",t.top-e)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&O.fn.draggable&&this._makeDraggable(),this.options.resizable&&O.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?O(t):this.document.find(t||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:O.noop,enable:O.noop,close:function(t){var e,i=this;if(this._isOpen&&!1!==this._trigger("beforeClose",t)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(e=this.document[0].activeElement)&&"body"!==e.nodeName.toLowerCase()&&O(e).blur()}catch(t){}this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+O(this).css("z-index")}).get(),r=Math.max.apply(null,n);return r>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",r+1),i=!0),i&&!e&&this._trigger("focus",t),i},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=O(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;(t=t||this.element.find("[autofocus]")).length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(t){function e(){var t=this.document[0].activeElement;this.uiDialog[0]===t||O.contains(this.uiDialog[0],t)||this._focusTabbable()}t.preventDefault(),e.call(this),this._delay(e)},_createWrapper:function(){this.uiDialog=O("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===O.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);var e,i,n;t.keyCode!==O.ui.keyCode.TAB||t.isDefaultPrevented()||(e=this.uiDialog.find(":tabbable"),i=e.filter(":first"),n=e.filter(":last"),t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){i.focus()}),t.preventDefault()))},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=O("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){O(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=O("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),t=O("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=O("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=O("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var r=this,t=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),O.isEmptyObject(t)||O.isArray(t)&&!t.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(O.each(t,function(t,e){var i,n;e=O.isFunction(e)?{click:e,text:t}:e,e=O.extend({type:"button"},e),i=e.click,e.click=function(){i.apply(r.element[0],arguments)},n={icons:e.icons,text:e.showText},delete e.icons,delete e.showText,O("<button></button>",e).button(n).appendTo(r.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function r(t){return{position:t.position,offset:t.offset}}var o=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(t,e){O(this).addClass("ui-dialog-dragging"),o._blockFrames(),o._trigger("dragStart",t,r(e))},drag:function(t,e){o._trigger("drag",t,r(e))},stop:function(t,e){var i=e.offset.left-o.document.scrollLeft(),n=e.offset.top-o.document.scrollTop();s.position={my:"left top",at:"left"+(0<=i?"+":"")+i+" top"+(0<=n?"+":"")+n,of:o.window},O(this).removeClass("ui-dialog-dragging"),o._unblockFrames(),o._trigger("dragStop",t,r(e))}})},_makeResizable:function(){function o(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var s=this,a=this.options,t=a.resizable,e=this.uiDialog.css("position"),i="string"==typeof t?t:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:this._minHeight(),handles:i,start:function(t,e){O(this).addClass("ui-dialog-resizing"),s._blockFrames(),s._trigger("resizeStart",t,o(e))},resize:function(t,e){s._trigger("resize",t,o(e))},stop:function(t,e){var i=s.uiDialog.offset(),n=i.left-s.document.scrollLeft(),r=i.top-s.document.scrollTop();a.height=s.uiDialog.height(),a.width=s.uiDialog.width(),a.position={my:"left top",at:"left"+(0<=n?"+":"")+n+" top"+(0<=r?"+":"")+r,of:s.window},O(this).removeClass("ui-dialog-resizing"),s._unblockFrames(),s._trigger("resizeStop",t,o(e))}}).css("position",e)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=O(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),e=O.inArray(this,t);-1!==e&&t.splice(e,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(t){var i=this,n=!1,r={};O.each(t,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(n=!0),t in i.resizableRelatedOptions&&(r[t]=e)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,e){var i,n,r=this.uiDialog;"dialogClass"===t&&r.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&((i=r.is(":data(ui-draggable)"))&&!e&&r.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((n=r.is(":data(ui-resizable)"))&&!e&&r.resizable("destroy"),n&&"string"==typeof e&&r.resizable("option","handles",e),n||!1===e||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=O(this);return O("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!O(t.target).closest(".ui-dialog").length||!!O(t.target).closest(".ui-datepicker").length},_createOverlay:function(){var e;this.options.modal&&(e=!0,this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=O("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1))},_destroyOverlay:function(){var t;this.options.modal&&this.overlay&&((t=this.document.data("ui-dialog-overlays")-1)?this.document.data("ui-dialog-overlays",t):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null)}}),O.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=O("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,e=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(e.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=O("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),O.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,e=this.element.attr("tabindex");this.label=O("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=O("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:e||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),O("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=O("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var n=this;this.menu=O("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=O("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(t,e){t.preventDefault(),n._setSelection(),n._select(e.item.data("ui-selectmenu-item"),t)},focus:function(t,e){var i=e.item.data("ui-selectmenu-item");null!=n.focusIndex&&i.index!==n.focusIndex&&(n._trigger("focus",t,{item:i}),n.isOpen||n._select(i,t)),n.focusIndex=i.index,n.button.attr("aria-activedescendant",n.menuItems.eq(i.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var t,e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t))},_position:function(){this.menuWrap.position(O.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(i,t){var n=this,r="";O.each(t,function(t,e){e.optgroup!==r&&(O("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(e.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:e.optgroup}).appendTo(i),r=e.optgroup),n._renderItemData(i,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(t,e){var i=O("<li>");return e.disabled&&i.addClass("ui-state-disabled"),this._setText(i,e.label),i.appendTo(t)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,n,r=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),r+=":not(.ui-state-disabled)"),(n="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](r).eq(-1):i[t+"All"](r).eq(0)).length&&this.menuInstance.focus(e,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(O(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(t){var e=!0;switch(t.keyCode){case O.ui.keyCode.TAB:case O.ui.keyCode.ESCAPE:this.close(t),e=!1;break;case O.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case O.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case O.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case O.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case O.ui.keyCode.LEFT:this._move("prev",t);break;case O.ui.keyCode.RIGHT:this._move("next",t);break;case O.ui.keyCode.HOME:case O.ui.keyCode.PAGE_UP:this._move("first",t);break;case O.ui.keyCode.END:case O.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),e=!1}e&&t.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex);e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this._setText(this.buttonText,t.label),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){"icons"===t&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(e.button),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"disabled"===t&&(this.menuInstance.option("disabled",e),this.button.toggleClass("ui-state-disabled",e).attr("aria-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===t&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return(t=t&&(t.jquery||t.nodeType?O(t):this.document.find(t).eq(0)))&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;t||(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var r=[];t.each(function(t,e){var i=O(e),n=i.parent("optgroup");r.push({element:i,index:t,value:i.attr("value"),label:i.text(),optgroup:n.attr("label")||"",disabled:n.prop("disabled")||i.prop("disabled")})}),this.items=r},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),O.widget("ui.slider",O.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,e=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),n=[],r=e.values&&e.values.length||1;for(i.length>r&&(i.slice(r).remove(),i=i.slice(0,r)),t=i.length;t<r;t++)n.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=i.add(O(n.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){O(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,e="";t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:O.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=O("<div></div>").appendTo(this.element),e="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(e+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var e,i,n,r,o,s,a,l=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var e=Math.abs(i-l.values(t));(e<n||n===e&&(t===l._lastChangedValue||l.values(t)===u.min))&&(n=e,r=O(this),o=t)}),!1!==this._start(t,o)&&(this._mouseSliding=!0,this._handleIndex=o,r.addClass("ui-state-active").focus(),s=r.offset(),a=!O(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=a?{left:0,top:0}:{left:t.pageX-s.left-r.width()/2,top:t.pageY-s.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,i),this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,r="horizontal"===this.orientation?(e=this.elementSize.width,t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),o=r/e;return 1<o&&(o=1),o<0&&(o=0),"vertical"===this.orientation&&(o=1-o),i=this._valueMax()-this._valueMin(),n=this._valueMin()+o*i,this._trimAlignValue(n)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,r,o;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&!0===this.options.range&&(0===e&&n<i||1===e&&i<n)&&(i=n),i!==this.values(e)&&((r=this.values())[e]=i,o=this._trigger("slide",t,{handle:this.handles[e],value:i,values:r}),n=this.values(e?0:1),!1!==o&&this.values(e,i))):i===this.value()||!1!==(o=this._trigger("slide",t,{handle:this.handles[e],value:i}))&&this.value(i)},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){var i;this._keySliding||this._mouseSliding||(i={handle:this.handles[e],value:this.value()},this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,e){var i,n,r;if(1<arguments.length)return this.options.values[t]=this._trimAlignValue(e),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!O.isArray(t))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,n=t,r=0;i.length>r;r+=1)i[r]=this._trimAlignValue(n[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,e){var i,n=0;switch("range"===t&&!0===this.options.range&&("min"===e?(this.options.value=this._values(0),this.options.values=null):"max"===e&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),O.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e),this._super(t,e),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===e?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<n;i+=1)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;i.length>n;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=0<this.options.step?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=0<i?e:-e),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var t=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-t},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var e,i,t,n,r,o=this.options.range,s=this.options,a=this,l=!this._animateOff&&s.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(t){i=(a.values(t)-a._valueMin())/(a._valueMax()-a._valueMin())*100,u["horizontal"===a.orientation?"left":"bottom"]=i+"%",O(this).stop(1,1)[l?"animate":"css"](u,s.animate),!0===a.options.range&&("horizontal"===a.orientation?(0===t&&a.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},s.animate),1===t&&a.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:s.animate})):(0===t&&a.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},s.animate),1===t&&a.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:s.animate}))),e=i}):(t=this.value(),n=this._valueMin(),r=this._valueMax(),i=r!==n?(t-n)/(r-n)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,s.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},s.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:s.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},s.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:s.animate}))},_handleEvents:{keydown:function(t){var e,i,n,r=O(t.target).data("ui-slider-handle-index");switch(t.keyCode){case O.ui.keyCode.HOME:case O.ui.keyCode.END:case O.ui.keyCode.PAGE_UP:case O.ui.keyCode.PAGE_DOWN:case O.ui.keyCode.UP:case O.ui.keyCode.RIGHT:case O.ui.keyCode.DOWN:case O.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,O(t.target).addClass("ui-state-active"),!1===this._start(t,r)))return}switch(n=this.options.step,e=i=this.options.values&&this.options.values.length?this.values(r):this.value(),t.keyCode){case O.ui.keyCode.HOME:i=this._valueMin();break;case O.ui.keyCode.END:i=this._valueMax();break;case O.ui.keyCode.PAGE_UP:i=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/this.numPages);break;case O.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/this.numPages);break;case O.ui.keyCode.UP:case O.ui.keyCode.RIGHT:if(e===this._valueMax())return;i=this._trimAlignValue(e+n);break;case O.ui.keyCode.DOWN:case O.ui.keyCode.LEFT:if(e===this._valueMin())return;i=this._trimAlignValue(e-n)}this._slide(t,r,i)},keyup:function(t){var e=O(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,e),this._change(t,e),O(t.target).removeClass("ui-state-active"))}}}),O.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var n={},r=this.element;return O.each(["min","max","step"],function(t,e){var i=r.attr(e);void 0!==i&&i.length&&(n[e]=i)}),n},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((0<e?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){function e(){this.element[0]===this.document[0].activeElement||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();t.preventDefault(),e.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,e.call(this)}),!1!==this._start(t)&&this._repeat(null,O(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return O(t.currentTarget).hasClass("ui-state-active")?!1!==this._start(t)&&void this._repeat(null,O(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&0<t.height()&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(t){var e=this.options,i=O.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,e.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-e.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(t){var e=this.options.incremental;return e?O.isFunction(e)?e(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e=this.options,i=null!==e.min?e.min:0,n=t-i;return t=i+(n=Math.round(n/e.step)*e.step),t=parseFloat(t.toFixed(this._precision())),null!==e.max&&t>e.max?e.max:null!==e.min&&e.min>t?e.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}"max"!==t&&"min"!==t&&"step"!==t||"string"!=typeof e||(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable"))},_setOptions:e(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""===t||null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i)),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void e(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),O.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(b=/#.*$/,function(t){var e=(t=t.cloneNode(!1)).href.replace(b,""),i=location.href.replace(b,"");try{e=decodeURIComponent(e)}catch(t){}try{i=decodeURIComponent(i)}catch(t){}return 1<t.hash.length&&e===i}),_create:function(){var e=this,t=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",t.collapsible),this._processTabs(),t.active=this._initialActive(),O.isArray(t.disabled)&&(t.disabled=O.unique(t.disabled.concat(O.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(t.active):O(),this._refresh(),this.active.length&&this.load(t.active)},_initialActive:function(){var i=this.options.active,t=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(t,e){return O(e).attr("aria-controls")===n?(i=t,!1):void 0}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==i&&-1!==i||(i=!!this.tabs.length&&0)),!1!==i&&(-1===(i=this.tabs.index(this.tabs.eq(i)))&&(i=!t&&0)),!t&&!1===i&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):O()}},_tabKeydown:function(t){var e=O(this.document[0].activeElement).closest("li"),i=this.tabs.index(e),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case O.ui.keyCode.RIGHT:case O.ui.keyCode.DOWN:i++;break;case O.ui.keyCode.UP:case O.ui.keyCode.LEFT:n=!1,i--;break;case O.ui.keyCode.END:i=this.anchors.length-1;break;case O.ui.keyCode.HOME:i=0;break;case O.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case O.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),t.ctrlKey||(e.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===O.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===O.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===O.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,e){for(var i=this.tabs.length-1;-1!==O.inArray((i<t&&(t=0),t<0&&(t=i),t),this.options.disabled);)t=e?t+1:t-1;return t},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,e=this.tablist.children(":has(a[href])");t.disabled=O.map(e.filter(".ui-state-disabled"),function(t){return e.index(t)}),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!O.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=O()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=O()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var l=this,t=this.tabs,e=this.anchors,i=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){O(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){O(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return O("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=O(),this.anchors.each(function(t,e){var i,n,r,o=O(e).uniqueId().attr("id"),s=O(e).closest("li"),a=s.attr("aria-controls");l._isLocal(e)?(r=(i=e.hash).substring(1),n=l.element.find(l._sanitizeSelector(i))):(i="#"+(r=s.attr("aria-controls")||O({}).uniqueId()[0].id),(n=l.element.find(i)).length||(n=l._createPanel(r)).insertAfter(l.panels[t-1]||l.tablist),n.attr("aria-live","polite")),n.length&&(l.panels=l.panels.add(n)),a&&s.data("ui-tabs-aria-controls",a),s.attr({"aria-controls":r,"aria-labelledby":o}),n.attr("aria-labelledby",o)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),t&&(this._off(t.not(this.tabs)),this._off(e.not(this.anchors)),this._off(i.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return O("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){O.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var e,i=0;e=this.tabs[i];i++)!0===t||-1!==O.inArray(i,t)?O(e).addClass("ui-state-disabled").attr("aria-disabled","true"):O(e).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&O.each(t.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,e=this.element.parent();"fill"===t?(i=e.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=O(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=O(this).outerHeight(!0)}),this.panels.each(function(){O(this).height(Math.max(0,i-O(this).innerHeight()+O(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,O(this).height("").height())}).height(i))},_eventHandler:function(t){var e=this.options,i=this.active,n=O(t.currentTarget).closest("li"),r=n[0]===i[0],o=r&&e.collapsible,s=o?O():this._getPanelForTab(n),a=i.length?this._getPanelForTab(i):O(),l={oldTab:i,oldPanel:a,newTab:o?O():n,newPanel:s};t.preventDefault(),n.hasClass("ui-state-disabled")||n.hasClass("ui-tabs-loading")||this.running||r&&!e.collapsible||!1===this._trigger("beforeActivate",t,l)||(e.active=!o&&this.tabs.index(n),this.active=r?O():n,this.xhr&&this.xhr.abort(),a.length||s.length||O.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(n),t),this._toggle(t,l))},_toggle:function(t,e){function i(){r.running=!1,r._trigger("activate",t,e)}function n(){e.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&r.options.show?r._show(o,r.options.show,i):(o.show(),i())}var r=this,o=e.newPanel,s=e.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),n()),s.attr("aria-hidden","true"),e.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&s.length?e.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===O(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),e.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var e,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),e=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:e,currentTarget:e,preventDefault:O.noop}))},_findActive:function(t){return!1===t?O():this.tabs.eq(t)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){O.data(this,"ui-tabs-destroy")?O(this).remove():O(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=O(this),e=t.data("ui-tabs-aria-controls");e?t.attr("aria-controls",e).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var t=this.options.disabled;!1!==t&&(t=void 0!==i&&(i=this._getIndex(i),O.isArray(t)?O.map(t,function(t){return t!==i?t:null}):O.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(t))},disable:function(t){var e=this.options.disabled;if(!0!==e){if(void 0===t)e=!0;else{if(t=this._getIndex(t),-1!==O.inArray(t,e))return;e=O.isArray(e)?O.merge([t],e).sort():[t]}this._setupDisabled(e)}},load:function(t,e){t=this._getIndex(t);var i=this,n=this.tabs.eq(t),r=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),s={tab:n,panel:o};this._isLocal(r[0])||(this.xhr=O.ajax(this._ajaxSettings(r,e,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){o.html(t),i._trigger("load",e,s)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&i.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),t===i.xhr&&delete i.xhr},1)})))},_ajaxSettings:function(t,i,n){var r=this;return{url:t.attr("href"),beforeSend:function(t,e){return r._trigger("beforeLoad",i,O.extend({jqXHR:t,ajaxSettings:e},n))}}},_getPanelForTab:function(t){var e=O(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}}),O.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var t=O(this).attr("title")||"";return O("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,e){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(e),t.data("ui-tooltip-id",e).attr("aria-describedby",O.trim(i.join(" ")))},_removeDescribedBy:function(t){var e=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),n=O.inArray(e,i);-1!==n&&i.splice(n,1),t.removeData("ui-tooltip-id"),(i=O.trim(i.join(" ")))?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=O("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,e){var i=this;return"disabled"===t?(this[e?"_disable":"_enable"](),void(this.options[t]=e)):(this._super(t,e),void("content"===t&&O.each(this.tooltips,function(t,e){i._updateContent(e.element)})))},_disable:function(){var n=this;O.each(this.tooltips,function(t,e){var i=O.Event("blur");i.target=i.currentTarget=e.element[0],n.close(i,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=O(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=O(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,e=O(t?t.target:this.element).closest(this.options.items);e.length&&!e.data("ui-tooltip-id")&&(e.attr("title")&&e.data("ui-tooltip-title",e.attr("title")),e.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&e.parents().each(function(){var t,e=O(this);e.data("ui-tooltip-open")&&((t=O.Event("blur")).target=t.currentTarget=this,i.close(t,!0)),e.attr("title")&&(e.uniqueId(),i.parents[this.id]={element:this,title:e.attr("title")},e.attr("title",""))}),this._updateContent(e,t))},_updateContent:function(e,i){var t,n=this.options.content,r=this,o=i?i.type:null;return"string"==typeof n?this._open(i,e,n):void((t=n.call(e[0],function(t){e.data("ui-tooltip-open")&&r._delay(function(){i&&(i.type=o),this._open(i,e,t)})}))&&this._open(i,e,t))},_open:function(t,i,e){function n(t){u.of=t,o.is(":hidden")||o.position(u)}var r,o,s,a,l,u=O.extend({},this.options.position);if(e){if(r=this._find(i))return void r.tooltip.find(".ui-tooltip-content").html(e);i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),r=this._tooltip(i),o=r.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(e),this.liveRegion.children().hide(),e.clone?(l=e.clone()).removeAttr("id").find("[id]").removeAttr("id"):l=e,O("<div>").html(l).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(O.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(u.of),clearInterval(a))},O.fx.interval)),this._trigger("open",t,{tooltip:o}),s={keyup:function(t){var e;t.keyCode===O.ui.keyCode.ESCAPE&&((e=O.Event(t)).currentTarget=i[0],this.close(e,!0))}},i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(o)}),t&&"mouseover"!==t.type||(s.mouseleave="close"),t&&"focusin"!==t.type||(s.focusout="close"),this._on(!0,i,s)}},close:function(t){var e,i=this,n=O(t?t.currentTarget:this.element),r=this._find(n);r&&(e=r.tooltip,r.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),r.hiding=!0,e.stop(!0),this._hide(e,this.options.hide,function(){i._removeTooltip(O(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&O.each(this.parents,function(t,e){O(e.element).attr("title",e.title),delete i.parents[t]}),r.closing=!0,this._trigger("close",t,{tooltip:e}),r.hiding||(r.closing=!1)))},_tooltip:function(t){var e=O("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),i=e.uniqueId().attr("id");return O("<div>").addClass("ui-tooltip-content").appendTo(e),e.appendTo(this.document[0].body),this.tooltips[i]={element:t,tooltip:e}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var r=this;O.each(this.tooltips,function(t,e){var i=O.Event("blur"),n=e.element;i.target=i.currentTarget=n[0],r.close(i,!0),O("#"+t).remove(),n.data("ui-tooltip-title")&&(n.attr("title")||n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var S,w,P,E,T,C,M,I,R,k,A,L,F,N,D,G,U,z,B,W,V="ui-effects-",Y=O;function H(t,e,i,n){return O.isPlainObject(t)&&(t=(e=t).effect),t={effect:t},null==e&&(e={}),O.isFunction(e)&&(n=e,i=null,e={}),"number"!=typeof e&&!O.fx.speeds[e]||(n=i,i=e,e={}),O.isFunction(i)&&(n=i,i=null),e&&O.extend(t,e),i=i||e.duration,t.duration=O.fx.off?0:"number"==typeof i?i:i in O.fx.speeds?O.fx.speeds[i]:O.fx.speeds._default,t.complete=n||e.complete,t}function X(t){return!t||"number"==typeof t||O.fx.speeds[t]||("string"==typeof t&&!O.effects.effect[t]||(O.isFunction(t)||"object"==typeof t&&!t.effect))}function q(t){var e,i,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,r={};if(n&&n.length&&n[0]&&n[n[0]])for(i=n.length;i--;)"string"==typeof n[e=n[i]]&&(r[O.camelCase(e)]=n[e]);else for(e in n)"string"==typeof n[e]&&(r[e]=n[e]);return r}function K(t,e,i){var n=U[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:t<0?0:n.max<t?n.max:t)}function Z(s){var a=D(),l=a._rgba=[];return s=s.toLowerCase(),W(N,function(t,e){var i,n=e.re.exec(s),r=n&&e.parse(n),o=e.space||"rgba";return r?(i=a[o](r),a[G[o].cache]=i[G[o].cache],l=a._rgba=i._rgba,!1):A}),l.length?("0,0,0,0"===l.join()&&k.extend(l,L.transparent),a):L[s]}function $(t,e,i){return 6*(i=(i+1)%1)<1?t+6*(e-t)*i:2*i<1?e:3*i<2?t+6*(e-t)*(2/3-i):t}O.effects={effect:{}},F=/^([\-+])=\s*(\d+\.?\d*)/,N=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],D=(k=Y).Color=function(t,e,i,n){return new k.Color.fn.parse(t,e,i,n)},G={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},U={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},z=D.support={},B=k("<p>")[0],W=k.each,B.style.cssText="background-color:rgba(1,1,1,.5)",z.rgba=-1<B.style.backgroundColor.indexOf("rgba"),W(G,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),D.fn=k.extend(D.prototype,{parse:function(r,t,e,i){if(r===A)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=k(r).css(t),t=A);var o=this,n=k.type(r),s=this._rgba=[];return t!==A&&(r=[r,t,e,i],n="array"),"string"===n?this.parse(Z(r)||L._default):"array"===n?(W(G.rgba.props,function(t,e){s[e.idx]=K(r[e.idx],e)}),this):"object"===n?(W(G,r instanceof D?function(t,e){r[e.cache]&&(o[e.cache]=r[e.cache].slice())}:function(t,i){var n=i.cache;W(i.props,function(t,e){if(!o[n]&&i.to){if("alpha"===t||null==r[t])return;o[n]=i.to(o._rgba)}o[n][e.idx]=K(r[t],e,!0)}),o[n]&&k.inArray(null,o[n].slice(0,3))<0&&(o[n][3]=1,i.from&&(o._rgba=i.from(o[n])))}),this):A},is:function(t){var r=D(t),o=!0,s=this;return W(G,function(t,e){var i,n=r[e.cache];return n&&(i=s[e.cache]||e.to&&e.to(s._rgba)||[],W(e.props,function(t,e){return null!=n[e.idx]?o=n[e.idx]===i[e.idx]:A})),o}),o},_space:function(){var i=[],n=this;return W(G,function(t,e){n[e.cache]&&i.push(t)}),i.pop()},transition:function(t,s){var e=(u=D(t))._space(),i=G[e],n=0===this.alpha()?D("transparent"):this,a=n[i.cache]||i.to(n._rgba),l=a.slice(),u=u[i.cache];return W(i.props,function(t,e){var i=e.idx,n=a[i],r=u[i],o=U[e.type]||{};null!==r&&(null===n?l[i]=r:(o.mod&&(o.mod/2<r-n?n+=o.mod:o.mod/2<n-r&&(n-=o.mod)),l[i]=K((r-n)*s+n,e)))}),this[e](l)},blend:function(t){if(1===this._rgba[3])return this;var e=this._rgba.slice(),i=e.pop(),n=D(t)._rgba;return D(k.map(e,function(t,e){return(1-i)*n[e]+i*t}))},toRgbaString:function(){var t="rgba(",e=k.map(this._rgba,function(t,e){return null==t?2<e?1:0:t});return 1===e[3]&&(e.pop(),t="rgb("),t+e.join()+")"},toHslaString:function(){var t="hsla(",e=k.map(this.hsla(),function(t,e){return null==t&&(t=2<e?1:0),e&&e<3&&(t=Math.round(100*t)+"%"),t});return 1===e[3]&&(e.pop(),t="hsl("),t+e.join()+")"},toHexString:function(t){var e=this._rgba.slice(),i=e.pop();return t&&e.push(~~(255*i)),"#"+k.map(e,function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),D.fn.parse.prototype=D.fn,G.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/255,i=t[1]/255,n=t[2]/255,r=t[3],o=Math.max(e,i,n),s=Math.min(e,i,n),a=o-s,l=o+s,u=.5*l,h=s===o?0:e===o?60*(i-n)/a+360:i===o?60*(n-e)/a+120:60*(e-i)/a+240,c=0==a?0:u<=.5?a/l:a/(2-l);return[Math.round(h)%360,c,u,null==r?1:r]},G.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],r=t[3],o=n<=.5?n*(1+i):n+i-n*i,s=2*n-o;return[Math.round(255*$(s,o,e+1/3)),Math.round(255*$(s,o,e)),Math.round(255*$(s,o,e-1/3)),r]},W(G,function(l,t){var i=t.props,s=t.cache,a=t.to,u=t.from;D.fn[l]=function(t){if(a&&!this[s]&&(this[s]=a(this._rgba)),t===A)return this[s].slice();var e,n=k.type(t),r="array"===n||"object"===n?t:arguments,o=this[s].slice();return W(i,function(t,e){var i=r["object"===n?t:e.idx];null==i&&(i=o[e.idx]),o[e.idx]=K(i,e)}),u?((e=D(u(o)))[s]=o,e):D(o)},W(i,function(s,a){D.fn[s]||(D.fn[s]=function(t){var e,i=k.type(t),n="alpha"===s?this._hsla?"hsla":"rgba":l,r=this[n](),o=r[a.idx];return"undefined"===i?o:("function"===i&&(t=t.call(this,o),i=k.type(t)),null==t&&a.empty?this:("string"===i&&((e=F.exec(t))&&(t=o+parseFloat(e[2])*("+"===e[1]?1:-1))),r[a.idx]=t,this[n](r)))})})}),D.hook=function(t){var e=t.split(" ");W(e,function(t,o){k.cssHooks[o]={set:function(t,e){var i,n,r="";if("transparent"!==e&&("string"!==k.type(e)||(i=Z(e)))){if(e=D(i||e),!z.rgba&&1!==e._rgba[3]){for(n="backgroundColor"===o?t.parentNode:t;(""===r||"transparent"===r)&&n&&n.style;)try{r=k.css(n,"backgroundColor"),n=n.parentNode}catch(t){}e=e.blend(r&&"transparent"!==r?r:"_default")}e=e.toRgbaString()}try{t.style[o]=e}catch(t){}}},k.fx.step[o]=function(t){t.colorInit||(t.start=D(t.elem,o),t.end=D(t.end),t.colorInit=!0),k.cssHooks[o].set(t.elem,t.start.transition(t.end,t.pos))}})},D.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),k.cssHooks.borderColor={expand:function(i){var n={};return W(["Top","Right","Bottom","Left"],function(t,e){n["border"+e+"Color"]=i}),n}},L=k.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"},I=["add","remove","toggle"],R={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},O.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,e){O.fx.step[e]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(Y.style(t.elem,e,t.end),t.setAttr=!0)}}),O.fn.addBack||(O.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),O.effects.animateClass=function(r,t,e,i){var o=O.speed(t,e,i);return this.queue(function(){var i=O(this),t=i.attr("class")||"",e=(e=o.children?i.find("*").addBack():i).map(function(){return{el:O(this),start:q(this)}}),n=function(){O.each(I,function(t,e){r[e]&&i[e+"Class"](r[e])})};n(),e=e.map(function(){return this.end=q(this.el[0]),this.diff=function(t,e){var i,n,r={};for(i in e)n=e[i],t[i]!==n&&(R[i]||!O.fx.step[i]&&isNaN(parseFloat(n))||(r[i]=n));return r}(this.start,this.end),this}),i.attr("class",t),e=e.map(function(){var t=this,e=O.Deferred(),i=O.extend({},o,{queue:!1,complete:function(){e.resolve(t)}});return this.el.animate(this.diff,i),e.promise()}),O.when.apply(O,e.get()).done(function(){n(),O.each(arguments,function(){var e=this.el;O.each(this.diff,function(t){e.css(t,"")})}),o.complete.call(i[0])})})},O.fn.extend({addClass:(M=O.fn.addClass,function(t,e,i,n){return e?O.effects.animateClass.call(this,{add:t},e,i,n):M.apply(this,arguments)}),removeClass:(C=O.fn.removeClass,function(t,e,i,n){return 1<arguments.length?O.effects.animateClass.call(this,{remove:t},e,i,n):C.apply(this,arguments)}),toggleClass:(T=O.fn.toggleClass,function(t,e,i,n,r){return"boolean"==typeof e||void 0===e?i?O.effects.animateClass.call(this,e?{add:t}:{remove:t},i,n,r):T.apply(this,arguments):O.effects.animateClass.call(this,{toggle:t},e,i,n)}),switchClass:function(t,e,i,n,r){return O.effects.animateClass.call(this,{add:e,remove:t},i,n,r)}}),O.extend(O.effects,{version:"1.11.2",save:function(t,e){for(var i=0;e.length>i;i++)null!==e[i]&&t.data(V+e[i],t[0].style[e[i]])},restore:function(t,e){for(var i,n=0;e.length>n;n++)null!==e[n]&&(void 0===(i=t.data(V+e[n]))&&(i=""),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(i){if(i.parent().is(".ui-effects-wrapper"))return i.parent();var n={width:i.outerWidth(!0),height:i.outerHeight(!0),float:i.css("float")},t=O("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:i.width(),height:i.height()},r=document.activeElement;try{r.id}catch(t){r=document.body}return i.wrap(t),i[0]!==r&&!O.contains(i[0],r)||O(r).focus(),t=i.parent(),"static"===i.css("position")?(t.css({position:"relative"}),i.css({position:"relative"})):(O.extend(n,{position:i.css("position"),zIndex:i.css("z-index")}),O.each(["top","left","bottom","right"],function(t,e){n[e]=i.css(e),isNaN(parseInt(n[e],10))&&(n[e]="auto")}),i.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),i.css(e),t.css(n).show()},removeWrapper:function(t){var e=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),t[0]!==e&&!O.contains(t[0],e)||O(e).focus()),t},setTransition:function(n,t,r,o){return o=o||{},O.each(t,function(t,e){var i=n.cssUnit(e);0<i[0]&&(o[e]=i[0]*r+i[1])}),o}}),O.fn.extend({effect:function(){function t(t){function e(){O.isFunction(n)&&n.call(i[0]),O.isFunction(t)&&t()}var i=O(this),n=o.complete,r=o.mode;(i.is(":hidden")?"hide"===r:"show"===r)?(i[r](),e()):s.call(i[0],o,e)}var o=H.apply(this,arguments),e=o.mode,i=o.queue,s=O.effects.effect[o.effect];return O.fx.off||!s?e?this[e](o.duration,o.complete):this.each(function(){o.complete&&o.complete.call(this)}):!1===i?this.each(t):this.queue(i||"fx",t)},show:(E=O.fn.show,function(t){if(X(t))return E.apply(this,arguments);var e=H.apply(this,arguments);return e.mode="show",this.effect.call(this,e)}),hide:(P=O.fn.hide,function(t){if(X(t))return P.apply(this,arguments);var e=H.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)}),toggle:(w=O.fn.toggle,function(t){if(X(t)||"boolean"==typeof t)return w.apply(this,arguments);var e=H.apply(this,arguments);return e.mode="toggle",this.effect.call(this,e)}),cssUnit:function(t){var i=this.css(t),n=[];return O.each(["em","px","%","pt"],function(t,e){0<i.indexOf(e)&&(n=[parseFloat(i),e])}),n}}),S={},O.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,t){S[t]=function(t){return Math.pow(t,e+2)}}),O.extend(S,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),O.each(S,function(t,e){O.easing["easeIn"+t]=e,O.easing["easeOut"+t]=function(t){return 1-e(1-t)},O.easing["easeInOut"+t]=function(t){return t<.5?e(2*t)/2:1-e(-2*t+2)/2}}),O.effects,O.effects.effect.blind=function(t,e){var i,n,r,o=O(this),s=["position","top","bottom","left","right","height","width"],a=O.effects.setMode(o,t.mode||"hide"),l=t.direction||"up",u=/up|down|vertical/.test(l),h=u?"height":"width",c=u?"top":"left",d=/up|left|vertical|horizontal/.test(l),p={},f="show"===a;o.parent().is(".ui-effects-wrapper")?O.effects.save(o.parent(),s):O.effects.save(o,s),o.show(),n=(i=O.effects.createWrapper(o).css({overflow:"hidden"}))[h](),r=parseFloat(i.css(c))||0,p[h]=f?n:0,d||(o.css(u?"bottom":"right",0).css(u?"top":"left","auto").css({position:"absolute"}),p[c]=f?r:n+r),f&&(i.css(h,0),d||i.css(c,r+n)),i.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===a&&o.hide(),O.effects.restore(o,s),O.effects.removeWrapper(o),e()}})},O.effects.effect.bounce=function(t,e){var i,n,r,o=O(this),s=["position","top","bottom","left","right","height","width"],a=O.effects.setMode(o,t.mode||"effect"),l="hide"===a,u="show"===a,h=t.direction||"up",c=t.distance,d=t.times||5,p=2*d+(u||l?1:0),f=t.duration/p,g=t.easing,m="up"===h||"down"===h?"top":"left",y="up"===h||"left"===h,_=o.queue(),v=_.length;for((u||l)&&s.push("opacity"),O.effects.save(o,s),o.show(),O.effects.createWrapper(o),c=c||o["top"==m?"outerHeight":"outerWidth"]()/3,u&&((r={opacity:1})[m]=0,o.css("opacity",0).css(m,y?2*-c:2*c).animate(r,f,g)),l&&(c/=Math.pow(2,d-1)),i=(r={})[m]=0;i<d;i++)(n={})[m]=(y?"-=":"+=")+c,o.animate(n,f,g).animate(r,f,g),c=l?2*c:c/2;l&&((n={opacity:0})[m]=(y?"-=":"+=")+c,o.animate(n,f,g)),o.queue(function(){l&&o.hide(),O.effects.restore(o,s),O.effects.removeWrapper(o),e()}),1<v&&_.splice.apply(_,[1,0].concat(_.splice(v,1+p))),o.dequeue()},O.effects.effect.clip=function(t,e){var i,n,r,o=O(this),s=["position","top","bottom","left","right","height","width"],a="show"===O.effects.setMode(o,t.mode||"hide"),l="vertical"===(t.direction||"vertical"),u=l?"height":"width",h=l?"top":"left",c={};O.effects.save(o,s),o.show(),i=O.effects.createWrapper(o).css({overflow:"hidden"}),r=(n="IMG"===o[0].tagName?i:o)[u](),a&&(n.css(u,0),n.css(h,r/2)),c[u]=a?r:0,c[h]=a?0:r/2,n.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){a||o.hide(),O.effects.restore(o,s),O.effects.removeWrapper(o),e()}})},O.effects.effect.drop=function(t,e){var i,n=O(this),r=["position","top","bottom","left","right","opacity","height","width"],o=O.effects.setMode(n,t.mode||"hide"),s="show"===o,a=t.direction||"left",l="up"===a||"down"===a?"top":"left",u="up"===a||"left"===a?"pos":"neg",h={opacity:s?1:0};O.effects.save(n,r),n.show(),O.effects.createWrapper(n),i=t.distance||n["top"==l?"outerHeight":"outerWidth"](!0)/2,s&&n.css("opacity",0).css(l,"pos"==u?-i:i),h[l]=(s?"pos"==u?"+=":"-=":"pos"==u?"-=":"+=")+i,n.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),O.effects.restore(n,r),O.effects.removeWrapper(n),e()}})},O.effects.effect.explode=function(t,e){function i(){g.push(this),g.length===l*u&&(h.css({visibility:"visible"}),O(g).remove(),c||h.hide(),e())}for(var n,r,o,s,a,l=t.pieces?Math.round(Math.sqrt(t.pieces)):3,u=l,h=O(this),c="show"===O.effects.setMode(h,t.mode||"hide"),d=h.show().css("visibility","hidden").offset(),p=Math.ceil(h.outerWidth()/u),f=Math.ceil(h.outerHeight()/l),g=[],m=0;m<l;m++)for(o=d.top+m*f,a=m-(l-1)/2,n=0;n<u;n++)r=d.left+n*p,s=n-(u-1)/2,h.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*p,top:-m*f}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p,height:f,left:r+(c?s*p:0),top:o+(c?a*f:0),opacity:c?0:1}).animate({left:r+(c?0:s*p),top:o+(c?0:a*f),opacity:c?1:0},t.duration||500,t.easing,i)},O.effects.effect.fade=function(t,e){var i=O(this),n=O.effects.setMode(i,t.mode||"toggle");i.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:e})},O.effects.effect.fold=function(t,e){var i,n,r=O(this),o=["position","top","bottom","left","right","height","width"],s=O.effects.setMode(r,t.mode||"hide"),a="show"===s,l="hide"===s,u=t.size||15,h=/([0-9]+)%/.exec(u),c=!!t.horizFirst,d=a!=c,p=d?["width","height"]:["height","width"],f=t.duration/2,g={},m={};O.effects.save(r,o),r.show(),i=O.effects.createWrapper(r).css({overflow:"hidden"}),n=d?[i.width(),i.height()]:[i.height(),i.width()],h&&(u=parseInt(h[1],10)/100*n[l?0:1]),a&&i.css(c?{height:0,width:u}:{height:u,width:0}),g[p[0]]=a?n[0]:u,m[p[1]]=a?n[1]:0,i.animate(g,f,t.easing).animate(m,f,t.easing,function(){l&&r.hide(),O.effects.restore(r,o),O.effects.removeWrapper(r),e()})},O.effects.effect.highlight=function(t,e){var i=O(this),n=["backgroundImage","backgroundColor","opacity"],r=O.effects.setMode(i,t.mode||"show"),o={backgroundColor:i.css("backgroundColor")};"hide"===r&&(o.opacity=0),O.effects.save(i,n),i.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&i.hide(),O.effects.restore(i,n),e()}})},O.effects.effect.size=function(o,t){var e,i,s,a=O(this),n=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["width","height","overflow"],r=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=O.effects.setMode(a,o.mode||"effect"),d=o.restore||"effect"!==c,p=o.scale||"both",f=o.origin||["middle","center"],g=a.css("position"),m=d?n:["position","top","bottom","left","right","overflow","opacity"],y={height:0,width:0,outerHeight:0,outerWidth:0};"show"===c&&a.show(),e={height:a.height(),width:a.width(),outerHeight:a.outerHeight(),outerWidth:a.outerWidth()},"toggle"===o.mode&&"show"===c?(a.from=o.to||y,a.to=o.from||e):(a.from=o.from||("show"===c?y:e),a.to=o.to||("hide"===c?y:e)),s={from:{y:a.from.height/e.height,x:a.from.width/e.width},to:{y:a.to.height/e.height,x:a.to.width/e.width}},"box"!==p&&"both"!==p||(s.from.y!==s.to.y&&(m=m.concat(u),a.from=O.effects.setTransition(a,u,s.from.y,a.from),a.to=O.effects.setTransition(a,u,s.to.y,a.to)),s.from.x!==s.to.x&&(m=m.concat(h),a.from=O.effects.setTransition(a,h,s.from.x,a.from),a.to=O.effects.setTransition(a,h,s.to.x,a.to))),"content"!==p&&"both"!==p||s.from.y===s.to.y||(m=m.concat(r).concat(l),a.from=O.effects.setTransition(a,r,s.from.y,a.from),a.to=O.effects.setTransition(a,r,s.to.y,a.to)),O.effects.save(a,m),a.show(),O.effects.createWrapper(a),a.css("overflow","hidden").css(a.from),f&&(i=O.effects.getBaseline(f,e),a.from.top=(e.outerHeight-a.outerHeight())*i.y,a.from.left=(e.outerWidth-a.outerWidth())*i.x,a.to.top=(e.outerHeight-a.to.outerHeight)*i.y,a.to.left=(e.outerWidth-a.to.outerWidth)*i.x),a.css(a.from),"content"!==p&&"both"!==p||(u=u.concat(["marginTop","marginBottom"]).concat(r),h=h.concat(["marginLeft","marginRight"]),l=n.concat(u).concat(h),a.find("*[width]").each(function(){var t=O(this),e=t.height(),i=t.width(),n=t.outerHeight(),r=t.outerWidth();d&&O.effects.save(t,l),t.from={height:e*s.from.y,width:i*s.from.x,outerHeight:n*s.from.y,outerWidth:r*s.from.x},t.to={height:e*s.to.y,width:i*s.to.x,outerHeight:e*s.to.y,outerWidth:i*s.to.x},s.from.y!==s.to.y&&(t.from=O.effects.setTransition(t,u,s.from.y,t.from),t.to=O.effects.setTransition(t,u,s.to.y,t.to)),s.from.x!==s.to.x&&(t.from=O.effects.setTransition(t,h,s.from.x,t.from),t.to=O.effects.setTransition(t,h,s.to.x,t.to)),t.css(t.from),t.animate(t.to,o.duration,o.easing,function(){d&&O.effects.restore(t,l)})})),a.animate(a.to,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){0===a.to.opacity&&a.css("opacity",a.from.opacity),"hide"===c&&a.hide(),O.effects.restore(a,m),d||("static"===g?a.css({position:"relative",top:a.to.top,left:a.to.left}):O.each(["top","left"],function(r,t){a.css(t,function(t,e){var i=parseInt(e,10),n=r?a.to.left:a.to.top;return"auto"===e?n+"px":i+n+"px"})})),O.effects.removeWrapper(a),t()}})},O.effects.effect.scale=function(t,e){var i=O(this),n=O.extend(!0,{},t),r=O.effects.setMode(i,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)||"hide"===r?0:100),s=t.direction||"both",a=t.origin,l={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},u="horizontal"!==s?o/100:1,h="vertical"!==s?o/100:1;n.effect="size",n.queue=!1,n.complete=e,"effect"!==r&&(n.origin=a||["middle","center"],n.restore=!0),n.from=t.from||("show"===r?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u,width:l.width*h,outerHeight:l.outerHeight*u,outerWidth:l.outerWidth*h},n.fade&&("show"===r&&(n.from.opacity=0,n.to.opacity=1),"hide"===r&&(n.from.opacity=1,n.to.opacity=0)),i.effect(n)},O.effects.effect.puff=function(t,e){var i=O(this),n=O.effects.setMode(i,t.mode||"hide"),r="hide"===n,o=parseInt(t.percent,10)||150,s=o/100,a={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};O.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:e,percent:r?o:100,from:r?a:{height:a.height*s,width:a.width*s,outerHeight:a.outerHeight*s,outerWidth:a.outerWidth*s}}),i.effect(t)},O.effects.effect.pulsate=function(t,e){var i,n=O(this),r=O.effects.setMode(n,t.mode||"show"),o="show"===r,s="hide"===r,a=o||"hide"===r,l=2*(t.times||5)+(a?1:0),u=t.duration/l,h=0,c=n.queue(),d=c.length;for(!o&&n.is(":visible")||(n.css("opacity",0).show(),h=1),i=1;i<l;i++)n.animate({opacity:h},u,t.easing),h=1-h;n.animate({opacity:h},u,t.easing),n.queue(function(){s&&n.hide(),e()}),1<d&&c.splice.apply(c,[1,0].concat(c.splice(d,1+l))),n.dequeue()},O.effects.effect.shake=function(t,e){var i,n=O(this),r=["position","top","bottom","left","right","height","width"],o=O.effects.setMode(n,t.mode||"effect"),s=t.direction||"left",a=t.distance||20,l=t.times||3,u=2*l+1,h=Math.round(t.duration/u),c="up"===s||"down"===s?"top":"left",d="up"===s||"left"===s,p={},f={},g={},m=n.queue(),y=m.length;for(O.effects.save(n,r),n.show(),O.effects.createWrapper(n),p[c]=(d?"-=":"+=")+a,f[c]=(d?"+=":"-=")+2*a,g[c]=(d?"-=":"+=")+2*a,n.animate(p,h,t.easing),i=1;i<l;i++)n.animate(f,h,t.easing).animate(g,h,t.easing);n.animate(f,h,t.easing).animate(p,h/2,t.easing).queue(function(){"hide"===o&&n.hide(),O.effects.restore(n,r),O.effects.removeWrapper(n),e()}),1<y&&m.splice.apply(m,[1,0].concat(m.splice(y,1+u))),n.dequeue()},O.effects.effect.slide=function(t,e){var i,n=O(this),r=["position","top","bottom","left","right","width","height"],o=O.effects.setMode(n,t.mode||"show"),s="show"===o,a=t.direction||"left",l="up"===a||"down"===a?"top":"left",u="up"===a||"left"===a,h={};O.effects.save(n,r),n.show(),i=t.distance||n["top"==l?"outerHeight":"outerWidth"](!0),O.effects.createWrapper(n).css({overflow:"hidden"}),s&&n.css(l,u?isNaN(i)?"-"+i:-i:i),h[l]=(s?u?"+=":"-=":u?"-=":"+=")+i,n.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),O.effects.restore(n,r),O.effects.removeWrapper(n),e()}})},O.effects.effect.transfer=function(t,e){var i=O(this),n=O(t.to),r="fixed"===n.css("position"),o=O("body"),s=r?o.scrollTop():0,a=r?o.scrollLeft():0,l=n.offset(),u={top:l.top-s,left:l.left-a,height:n.innerHeight(),width:n.innerWidth()},h=i.offset(),c=O("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:h.top-s,left:h.left-a,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),e()})}}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(f){var n=/\+/g;function g(t){return y.raw?t:encodeURIComponent(t)}function m(t,e){var i=y.raw?t:function(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return t=decodeURIComponent(t.replace(n," ")),y.json?JSON.parse(t):t}catch(t){}}(t);return f.isFunction(e)?e(i):i}var y=f.cookie=function(t,e,i){var n,r,o;if(void 0!==e&&!f.isFunction(e))return"number"==typeof(i=f.extend({},y.defaults,i)).expires&&(n=i.expires,(r=i.expires=new Date).setTime(+r+864e5*n)),document.cookie=[g(t),"=",(o=e,g(y.json?JSON.stringify(o):String(o))),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("");for(var s,a=t?void 0:{},l=document.cookie?document.cookie.split("; "):[],u=0,h=l.length;u<h;u++){var c=l[u].split("="),d=(s=c.shift(),y.raw?s:decodeURIComponent(s)),p=c.join("=");if(t&&t===d){a=m(p,e);break}t||void 0===(p=m(p))||(a[d]=p)}return a};y.defaults={},f.removeCookie=function(t,e){return void 0!==f.cookie(t)&&(f.cookie(t,"",f.extend({},e,{expires:-1})),!f.cookie(t))}}),jQuery.fn.fullScreen=d,jQuery.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))},e=document,g=e.webkitCancelFullScreen?(f="webkitfullscreenchange","webkitfullscreenerror"):e.mozCancelFullScreen?(f="mozfullscreenchange","mozfullscreenerror"):(f="fullscreenchange","fullscreenerror"),jQuery(document).bind(f,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))}),jQuery(document).bind(g,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))});var cookieScripts=document.getElementsByTagName("script"),cookieScriptSrc=cookieScripts[cookieScripts.length-1].src,cookieQuery=null,cookieScriptPosition="bottom",cookieScriptSide="right",cookieScriptSource="cookie-script.com",cookieScriptDomain="",cookieScriptReadMore="/policies/cookie_"+App.context.languageCode+".html",cookieId="6a00eb3cf69b00d1af83ec32b891828a",cookieScriptDebug=0,cookieScriptCurrentUrl=window.location.href,cookieScriptTitle='<h4 id="cookiescript_header">'+App.translations.weUseCookies+"</h4>",cookieScriptDesc=App.translations.weUseCookiesDescription,cookieScriptAccept="×",cookieScriptMore=App.translations.readMore,cookieScriptCopyrights="",cookieScriptLoadJavaScript=function(t,e){var i=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=t,null!=e&&(n.onload=n.onreadystatechange=function(){n.readyState&&!/loaded|complete/.test(n.readyState)||(n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=void 0,e())}),i.insertBefore(n,i.firstChild)},InjectCookieScript=function(){function e(t){"show"==t?(cookieQuery("#cookiescript_overlay",cookieScriptWindow).show(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).show()):"hide"==t&&(cookieQuery("#cookiescript_overlay",cookieScriptWindow).hide(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).hide())}function t(){cookieQuery('img[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('script[type="text/plain"][data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src")?cookieQuery(this).after('<script type="text/javascript" src="'+cookieQuery(this).attr("src")+'"><\/script>'):cookieQuery(this).after('<script type="text/javascript">'+cookieQuery(this).html()+"<\/script>"),cookieQuery(this).empty()}),cookieQuery('iframe[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('embed[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))[0].outerHTML)}),cookieQuery('object[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("data",cookieQuery(this).attr("data-data"))[0].outerHTML)}),cookieQuery('link[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("href",cookieQuery(this).attr("data-href"))})}cookieScriptDropfromFlag=0,cookieScriptDroptoFlag=0,cookieScriptCreateCookie=function(t,e,i){var n,r="";i&&((n=new Date).setTime(n.getTime()+864e5*i),r="; expires="+n.toGMTString()),(i="")!=cookieScriptDomain&&(i="; domain="+cookieScriptDomain),document.cookie=t+"="+e+r+i+"; path=/"},cookieScriptReadCookie=function(t){t+="=";for(var e,i=document.cookie.split(";"),n=0;n<i.length;n++){for(e=i[n];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(t))return e.substring(t.length,e.length)}return null},cookieQuery(function(){if(cookieScriptWindow=window.document,cookieQuery("#cookiescript_injected",cookieScriptWindow).remove(),cookieQuery("#cookiescript_overlay",cookieScriptWindow).remove(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).remove(),cookieScriptCurrentValue=cookieScriptReadCookie("cookiescriptaccept"),"visit"==cookieScriptCurrentValue)return!1;if(cookieScriptCurrentValue){if("firstvisit"==cookieScriptCurrentValue.substring(0,10)&&cookieScriptCurrentValue!="firstvisit-"+cookieScriptCurrentUrl)return cookieScriptCreateCookie("cookiescriptaccept","visit",30),t(),!1}else cookieScriptCreateCookie("cookiescriptaccept","firstvisit-"+cookieScriptCurrentUrl,30);cookieQuery("body",cookieScriptWindow).append('<div id="cookiescript_injected">'+cookieScriptTitle+cookieScriptDesc+' <span id="cookiescript_readmore">'+cookieScriptMore+'</span><div id="cookiescript_accept">'+cookieScriptAccept+'</div><div style="clear:both"></div>'),cookieQuery("#cookiescript_injected",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,opacity:1,position:"fixed",padding:"15px",width:"300px","font-size":"13px","font-weight":"normal","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"none","line-height":"15px","letter-spacing":"normal","-moz-box-shadow":"0px 0px 8px #000000","-webkit-box-shadow":"0px 0px 8px #000000","box-shadow":"0px 0px 8px #000000"}),"top"==cookieScriptPosition?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("top",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("bottom",0),"left"==cookieScriptSide?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("left",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("right",0),cookieQuery("#cookiescript_injected h4#cookiescript_header",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,padding:"0 0 7px 0","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"block","font-size":"15px","font-weight":"bold","line-height":"normal","letter-spacing":"normal","font-style":"normal",margin:"0"}),cookieQuery("#cookiescript_injected a",cookieScriptWindow).css({"text-decoration":"underline",color:"#FFFFFF"}),cookieQuery("#cookiescript_injected a#cookiescript_link",cookieScriptWindow).css({"text-decoration":"none",color:"#FFFFFF",float:"right","font-size":"90%","margin-top":"8px"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({border:0,padding:"0","text-decoration":"underline",cursor:"pointer",margin:"0","white-space":"nowrap"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"-webkit-border-radius":"10px","-khtml-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",border:0,padding:"0",cursor:"pointer",margin:"0","-webkit-transition":"0.25s","-moz-transition":"0.25s",transition:"0.25s",width:"20px",height:"20px",position:"absolute",top:"12px",right:"17px","text-align":"center","font-weight":"bold","line-height":"21px","font-size":"20px"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"background-color":"#5BB75B",color:"#FFFFFF",float:"left"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({}),cookieQuery("#cookiescript_injected div#cookiescript_pixel",cookieScriptWindow).css({width:"1px",height:"1px",float:"left"}),cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeIn(1e3),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).click(function(){"undefined"==typeof cookieScriptScrollfired&&(cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeOut(200),cookieScriptCreateCookie("cookiescriptaccept","visit",30),e("hide"),t())}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).click(function(){return window.open(cookieScriptReadMore,"_blank"),!1}),cookieQuery("#cookiescript_overlay",cookieScriptWindow).click(function(){e("hide")}),cookieQuery("#cookiescript_info_close",cookieScriptWindow).click(function(){e("hide")}),document.onkeydown=function(t){27==(t=t||window.event).keyCode&&e("hide")},cookieQuery('iframe[data-cookiescript="accepted"]').not(":has([src])").each(function(){var t=this;(t=t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument).document.open(),t.document.write(cookieQuery(this).attr("alt")),t.document.close()})}),"visit"!=cookieScriptReadCookie("cookiescriptaccept")&&"shown"!=cookieScriptReadCookie("cookiescriptaccept")||t()};function cof2Obj(t){"use strict";var e,i,n,r,o,s=t.split("\n"),a=[];for(e in s)s.hasOwnProperty(e)&&(3===(i=s[e].replace(/^\s+|\s+$/g,"").split(/\s+/)).length?(n=parseFloat(i[0]),r=i[1],o=i[2]):6===i.length&&a.push({n:parseInt(i[0],10),m:parseInt(i[1],10),gnm:parseFloat(i[2]),hnm:parseFloat(i[3]),dgnm:parseFloat(i[4]),dhnm:parseFloat(i[5])}));return{epoch:n,model:r,modelDate:o,wmm:a}}function geoMagFactory(t){"use strict";function H(t){return t*(180/Math.PI)}function X(t){return t*(Math.PI/180)}var e,i,q,K,n,r,o,Z=t.epoch,s=[0,0,0,0,0,0,0,0,0,0,0,0,0],$=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],Q=s.slice(),J=s.slice(),tt=s.slice(),et=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],it=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],a=6356.7523142,nt=40680631.59076899,rt=a*a,ot=nt-rt,st=nt*nt,at=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],lt=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],l=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],ut=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice(),s.slice()],ht=[0,2,3,4,5,6,7,8,9,10,11,12,13],ct=[0,1,2,3,4,5,6,7,8,9,10,11,12];for(e in $[0][0]=0,Q[0]=0,J[0]=1,tt[0]=1,et[0][0]=1,i=t.wmm)i.hasOwnProperty(e)&&i[e].m<=i[e].n&&(at[i[e].m][i[e].n]=i[e].gnm,lt[i[e].m][i[e].n]=i[e].dgnm,0!==i[e].m&&(at[i[e].n][i[e].m-1]=i[e].hnm,lt[i[e].n][i[e].m-1]=i[e].dhnm));for(i=t=null,l[0][0]=1,q=1;q<=12;q++)for(l[0][q]=l[0][q-1]*(2*q-1)/q,n=2,o=q-(K=0)+1;0<o;o--,K++)ut[K][q]=((q-1)*(q-1)-K*K)/((2*q-1)*(2*q-3)),0<K&&(r=(q-K+1)*n/(q+K),l[K][q]=l[K-1][q]*Math.sqrt(r),n=1,at[q][K-1]=l[K][q]*at[q][K-1],lt[q][K-1]=l[K][q]*lt[q][K-1]),at[K][q]=l[K][q]*at[K][q],lt[K][q]=l[K][q]*lt[K][q];return ut[1][1]=0,function(t,e,i,n){var r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v,b,j,x,S,w,P,E,T,O,C,M,I,R=i/3280.8399||0,k=(M=(C=(C=n)||new Date).getFullYear(),I=24*(365+(M%400==0||M%4==0&&0<M%100?1:0))*60*60*1e3,C.getFullYear()+(C.valueOf()-new Date(M,0).valueOf())/I)-Z,A=X(t),L=X(e),F=Math.sin(L),N=Math.sin(A),D=Math.cos(L),G=Math.cos(A),U=N*N,z=G*G,B=0,W=0,V=0,Y=0;for(Q[1]=F,J[1]=D,s=((o=R*(r=Math.sqrt(nt-ot*U)))+nt)/(o+rt)*((o+nt)/(o+rt)),a=N/Math.sqrt(s*z+U),l=Math.sqrt(1-a*a),u=R*R+2*o+(st-22083079019902.25*U)/(r*r),h=Math.sqrt(u),d=(R+(c=Math.sqrt(nt*z+rt*U)))/h,p=ot*G*N/(h*c),K=2;K<=12;K++)Q[K]=Q[1]*J[K-1]+J[1]*Q[K-1],J[K]=J[1]*J[K-1]-Q[1]*Q[K-1];for(g=(f=6371.2/h)*f,q=1;q<=12;q++)for(g*=f,b=q+(K=0)+1;0<b;b--,K++)q===K?(et[K][q]=l*et[K-1][q-1],it[K][q]=l*it[K-1][q-1]+a*et[K-1][q-1]):1===q&&0===K?(et[K][q]=a*et[K][q-1],it[K][q]=a*it[K][q-1]-l*et[K][q-1]):1<q&&q!==K&&(q-2<K&&(et[K][q-2]=0),q-2<K&&(it[K][q-2]=0),et[K][q]=a*et[K][q-1]-ut[K][q]*et[K][q-2],it[K][q]=a*it[K][q-1]-l*et[K][q-1]-ut[K][q]*it[K][q-2]),$[K][q]=at[K][q]+k*lt[K][q],0!==K&&($[q][K-1]=at[q][K-1]+k*lt[q][K-1]),m=g*et[K][q],_=0===K?(y=$[K][q]*J[K],$[K][q]*Q[K]):(y=$[K][q]*J[K]+$[q][K-1]*Q[K],$[K][q]*Q[K]-$[q][K-1]*J[K]),W-=g*y*it[K][q],V+=ct[K]*_*m,B+=ht[q]*y*m,0===l&&1===K&&(tt[q]=1===q?tt[q-1]:a*tt[q-1]-ut[K][q]*tt[q-2],v=g*tt[q],Y+=ct[K]*_*v);return j=-W*d-B*p,x=V=0===l?Y:V/l,S=W*p-B*d,w=Math.sqrt(j*j+x*x),P=Math.sqrt(w*w+S*S),E=H(Math.atan2(x,j)),T=H(Math.atan2(S,w)),55<=Math.abs(t)&&(0<t&&0<=e?O=E-e:0<t&&e<0?O=E+Math.abs(e):t<0&&0<=e?O=E+e:t<0&&e<0&&(O=E-Math.abs(e)),180<O?O-=360:O<-180&&(O+=360)),{dec:E,dip:T,ti:P,bh:w,bx:j,by:x,bz:S,lat:t,lon:e,gv:O,epoch:Z}}}window.jQuery&&jQuery.fn&&/^(1\.[8-9]|2\.[0-9])/.test(jQuery.fn.jquery)?(cookieScriptDebug&&window.console&&console.log("Using existing jQuery version "+jQuery.fn.jquery),cookieQuery=window.jQuery,InjectCookieScript()):(cookieScriptDebug&&window.console&&console.log("Loading jQuery 1.8.1 from ajax.googleapis.com"),cookieScriptLoadJavaScript(("https:"==document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js",function(){cookieQuery=jQuery.noConflict(!0),InjectCookieScript()})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("wkt-parser")):"function"==typeof define&&define.amd?define(["wkt-parser"],e):t.proj4=e(t.wkt)}(this,function(r){"use strict";function O(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),r=e.toLowerCase().replace(W,""),o=-1;++o<n.length;)if((i=n[o]).toLowerCase().replace(W,"")===r)return t[i]}function o(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?o[t]=V(arguments[1]):o[t]=r(arguments[1]):o[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?o.apply(e,t):o(t)});if("string"==typeof t){if(t in o)return o[t]}else"EPSG"in t?o["EPSG:"+t.EPSG]=t:"ESRI"in t?o["ESRI:"+t.ESRI]=t:"IAU2000"in t?o["IAU2000:"+t.IAU2000]=t:console.log(t);return}}function C(t){if("string"!=typeof t)return t;if(t in o)return o[t];if(n=t,Z.some(function(t){return-1<n.indexOf(t)})){var e=r(t);if(function(t){var e=O(t,"authority");if(e){var i=O(e,"epsg");return i&&-1<$.indexOf(i)}}(e))return o["EPSG:3857"];var i=function(t){var e=O(t,"extension");if(e)return O(e,"proj4")}(e);return i?V(i):e}var n;return"+"===t[0]?V(t):void 0}function t(t){return t}function e(t,e){var i=et.length;return t.names?((et[i]=t).names.forEach(function(t){tt[t.toLowerCase()]=i}),this):(console.log(e),!0)}function M(t,e){if(!(this instanceof M))return new M(t);e=e||function(t){if(t)throw t};var i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v,b,j,x,S,w,P,E,T=C(t);"object"==typeof T&&(i=M.projections.get(T.projName))?(!T.datumCode||"none"===T.datumCode||(n=O(ot,T.datumCode))&&(T.datum_params=n.towgs84?n.towgs84.split(","):null,T.ellps=n.ellipse,T.datumName=n.datumName?n.datumName:T.datumCode),T.k0=T.k0||1,T.axis=T.axis||"enu",T.ellps=T.ellps||"wgs84",j=T.a,x=T.b,S=T.rf,w=T.ellps,P=T.sphere,j||(j=(E=(E=O(nt,w))||rt).a,x=E.b,S=E.rf),S&&!x&&(x=(1-1/S)*j),(0===S||Math.abs(j-x)<U)&&(P=!0,x=j),f=(r={a:j,b:x,rf:S,sphere:P}).a,g=r.b,m=T.R_A,v=((y=f*f)-(_=g*g))/y,b=0,m?(y=(f*=1-v*(N+v*(D+v*G)))*f,v=0):b=Math.sqrt(v),o={es:v,e:b,ep2:(y-_)/_},s=T.datum||(a=T.datumCode,l=T.datum_params,u=r.a,h=r.b,c=o.es,d=o.ep2,(p={}).datum_type=void 0===a||"none"===a?A:k,l&&(p.datum_params=l.map(parseFloat),0===p.datum_params[0]&&0===p.datum_params[1]&&0===p.datum_params[2]||(p.datum_type=I),3<p.datum_params.length&&(0===p.datum_params[3]&&0===p.datum_params[4]&&0===p.datum_params[5]&&0===p.datum_params[6]||(p.datum_type=R,p.datum_params[3]*=L,p.datum_params[4]*=L,p.datum_params[5]*=L,p.datum_params[6]=p.datum_params[6]/1e6+1))),p.a=u,p.b=h,p.es=c,p.ep2=d,p),Q(this,T),Q(this,i),this.a=r.a,this.b=r.b,this.rf=r.rf,this.sphere=r.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=s,this.init(),e(null,this)):e(t)}function s(t,e,i){var n,r,o,s,a=t.x,l=t.y,u=t.z?t.z:0;if(l<-F&&-1.001*F<l)l=-F;else if(F<l&&l<1.001*F)l=F;else{if(l<-F)return{x:-1/0,y:-1/0,z:t.z};if(F<l)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),r=Math.sin(l),s=Math.cos(l),o=r*r,{x:((n=i/Math.sqrt(1-e*o))+u)*s*Math.cos(a),y:(n+u)*s*Math.sin(a),z:(n*(1-e)+u)*r}}function a(t,e,i,n){var r,o,s,a,l,u,h,c,d,p,f,g,m,y=t.x,_=t.y,v=t.z?t.z:0,b=Math.sqrt(y*y+_*_),j=Math.sqrt(y*y+_*_+v*v);if(b/i<1e-12){if(g=0,j/i<1e-12)return m=-n,{x:t.x,y:t.y,z:t.z}}else g=Math.atan2(_,y);for(r=v/j,u=(o=b/j)*(1-e)*(s=1/Math.sqrt(1-e*(2-e)*o*o)),h=r*s,f=0;f++,a=e*(l=i/Math.sqrt(1-e*h*h))/(l+(m=b*u+v*h-l*(1-e*h*h))),p=(d=r*(s=1/Math.sqrt(1-a*(2-a)*o*o)))*u-(c=o*(1-a)*s)*h,u=c,h=d,1e-24<p*p&&f<30;);return{x:g,y:Math.atan(d/Math.abs(c)),z:m}}function l(t){return t===I||t===R}function i(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function u(t,e,i){var n,r,o;if(Array.isArray(i)&&(i=lt(i)),ut(i),t.datum&&e.datum&&(o=e,((r=t).datum.datum_type===I||r.datum.datum_type===R)&&"WGS84"!==o.datumCode||(o.datum.datum_type===I||o.datum.datum_type===R)&&"WGS84"!==r.datumCode)&&(i=u(t,n=new M("WGS84"),i),t=n),"enu"!==t.axis&&(i=at(t,!1,i)),"longlat"===t.projName)i={x:i.x*S,y:i.y*S,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;return t.from_greenwich&&(i.x+=t.from_greenwich),i=st(t.datum,e.datum,i),e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*w,y:i.y*w,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),"enu"!==e.axis?at(e,!0,i):i}function h(e,i,n){var t,r,o;return Array.isArray(n)?(t=u(e,i,n)||{x:NaN,y:NaN},2<n.length?void 0!==e.name&&"geocent"===e.name||void 0!==i.name&&"geocent"===i.name?"number"==typeof t.z?[t.x,t.y,t.z].concat(n.splice(3)):[t.x,t.y,n[2]].concat(n.splice(3)):[t.x,t.y].concat(n.splice(2)):[t.x,t.y]):(r=u(e,i,n),2===(o=Object.keys(n)).length||o.forEach(function(t){if(void 0!==e.name&&"geocent"===e.name||void 0!==i.name&&"geocent"===i.name){if("x"===t||"y"===t||"z"===t)return}else if("x"===t||"y"===t)return;r[t]=n[t]}),r)}function c(t){return t instanceof M?t:t.oProj?t.oProj:M(t)}function n(e,i,t){e=c(e);var n,r=!1;return void 0===i?(i=e,e=ht,r=!0):void 0===i.x&&!Array.isArray(i)||(t=i,i=e,e=ht,r=!0),i=c(i),t?h(e,i,t):(n={forward:function(t){return h(e,i,t)},inverse:function(t){return h(i,e,t)}},r&&(n.oProj=i),n)}function d(t,e){return e=e||5,i=function(t){var e,i,n,r,o,s,a=t.lat,l=t.lon,u=f(a),h=f(l);s=Math.floor((l+180)/6)+1,180===l&&(s=60),56<=a&&a<64&&3<=l&&l<12&&(s=32),72<=a&&a<84&&(0<=l&&l<9?s=31:9<=l&&l<21?s=33:21<=l&&l<33?s=35:33<=l&&l<42&&(s=37)),o=f(6*(s-1)-180+3),e=6378137/Math.sqrt(1-.00669438*Math.sin(u)*Math.sin(u)),i=Math.tan(u)*Math.tan(u),n=.006739496752268451*Math.cos(u)*Math.cos(u);var c=.9996*e*((r=Math.cos(u)*(h-o))+(1-i+n)*r*r*r/6+(5-18*i+i*i+72*n-.39089081163157013)*r*r*r*r*r/120)+5e5,d=.9996*(6378137*(.9983242984503243*u-.002514607064228144*Math.sin(2*u)+2639046602129982e-21*Math.sin(4*u)-3.418046101696858e-9*Math.sin(6*u))+e*Math.tan(u)*(r*r/2+(5-i+9*n+4*n*n)*r*r*r*r/24+(61-58*i+i*i+600*n-2.2240339282485886)*r*r*r*r*r*r/720));return a<0&&(d+=1e7),{northing:Math.round(d),easting:Math.round(c),zoneNumber:s,zoneLetter:function(t){var e="Z";return t<=84&&72<=t?e="X":t<72&&64<=t?e="W":t<64&&56<=t?e="V":t<56&&48<=t?e="U":t<48&&40<=t?e="T":t<40&&32<=t?e="S":t<32&&24<=t?e="R":t<24&&16<=t?e="Q":t<16&&8<=t?e="P":t<8&&0<=t?e="N":t<0&&-8<=t?e="M":t<-8&&-16<=t?e="L":t<-16&&-24<=t?e="K":t<-24&&-32<=t?e="J":t<-32&&-40<=t?e="H":t<-40&&-48<=t?e="G":t<-48&&-56<=t?e="F":t<-56&&-64<=t?e="E":t<-64&&-72<=t?e="D":t<-72&&-80<=t&&(e="C"),e}(a)}}({lat:t[1],lon:t[0]}),n=e,r="00000"+i.easting,o="00000"+i.northing,i.zoneNumber+i.zoneLetter+function(t,e,i){var n=_(i);return function(t,e,i){var n=i-1,r=dt.charCodeAt(n),o=pt.charCodeAt(n),s=r+t-1,a=o+e,l=!1;return _t<s&&(s=s-_t+ft-1,l=!0),(s===gt||r<gt&&gt<s||(gt<s||r<gt)&&l)&&s++,(s===mt||r<mt&&mt<s||(mt<s||r<mt)&&l)&&++s===gt&&s++,_t<s&&(s=s-_t+ft-1),l=yt<a&&(a=a-yt+ft-1,!0),(a===gt||o<gt&&gt<a||(gt<a||o<gt)&&l)&&a++,(a===mt||o<mt&&mt<a||(mt<a||o<mt)&&l)&&++a===gt&&a++,yt<a&&(a=a-yt+ft-1),String.fromCharCode(s)+String.fromCharCode(a)}(Math.floor(t/1e5),Math.floor(e/1e5)%20,n)}(i.easting,i.northing,i.zoneNumber)+r.substr(r.length-5,n)+o.substr(o.length-5,n);var i,n,r,o}function p(t){var e=b(g(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function f(t){return t*(Math.PI/180)}function v(t){return t/Math.PI*180}function b(t){var e=t.northing,i=t.easting,n=t.zoneLetter,r=t.zoneNumber;if(r<0||60<r)return null;var o,s,a,l,u,h,c,d,p=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),f=i-5e5,g=e;n<"N"&&(g-=1e7),h=6*(r-1)-180+3,d=(c=g/.9996/6367449.145945056)+(3*p/2-27*p*p*p/32)*Math.sin(2*c)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*c)+151*p*p*p/96*Math.sin(6*c),o=6378137/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d)),s=Math.tan(d)*Math.tan(d),a=.006739496752268451*Math.cos(d)*Math.cos(d),l=6335439.32722994/Math.pow(1-.00669438*Math.sin(d)*Math.sin(d),1.5),u=f/(.9996*o);var m,y=v(y=d-o*Math.tan(d)/l*(u*u/2-(5+3*s+10*a-4*a*a-.06065547077041606)*u*u*u*u/24+(61+90*s+298*a+45*s*s-1.6983531815716497-3*a*a)*u*u*u*u*u*u/720)),_=h+v(_=(u-(1+2*s+a)*u*u*u/6+(5-2*a+28*s-3*a*a+.05391597401814761+24*s*s)*u*u*u*u*u/120)/Math.cos(d));return t.accuracy?{top:(m=b({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber})).lat,right:m.lon,bottom:y,left:_}:{lat:y,lon:_}}function _(t){var e=t%ct;return 0===e&&(e=ct),e}function g(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,r="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(2<=o)throw"MGRSPoint bad conversion from: "+t;r+=e,o++}var s=parseInt(r,10);if(0===o||i<o+3)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||"B"===a||"Y"===a||"Z"<=a||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(o,o+=2);for(var l=_(s),u=function(t,e){for(var i=dt.charCodeAt(e-1),n=1e5,r=!1;i!==t.charCodeAt(0);){if(++i===gt&&i++,i===mt&&i++,_t<i){if(r)throw"Bad character: "+t;i=ft,r=!0}n+=1e5}return n}(n.charAt(0),l),h=function(t,e){if("V"<t)throw"MGRSPoint given invalid Northing "+t;for(var i=pt.charCodeAt(e-1),n=0,r=!1;i!==t.charCodeAt(0);){if(++i===gt&&i++,i===mt&&i++,yt<i){if(r)throw"Bad character: "+t;i=ft,r=!0}n+=1e5}return n}(n.charAt(1),l);h<function(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(0<=e)return e;throw"Invalid zone letter: "+t}(a);)h+=2e6;var c=i-o;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,p,f,g=c/2,m=0,y=0;return 0<g&&(d=1e5/Math.pow(10,g),p=t.substring(o,o+g),m=parseFloat(p)*d,f=t.substring(o+g),y=parseFloat(f)*d),{easting:m+u,northing:y+h,zoneLetter:a,zoneNumber:s,accuracy:d}}function m(t,e,i){if(!(this instanceof m))return new m(t,e,i);var n;Array.isArray(t)?(this.x=t[0],this.y=t[1],this.z=t[2]||0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z||0):"string"==typeof t&&void 0===e?(n=t.split(","),this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0):(this.x=t,this.y=e,this.z=i||0),console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function y(t,e,i,n){var r;return t<U?(n.value=ve,r=0):(r=Math.atan2(e,i),Math.abs(r)<=P?n.value=ve:P<r&&r<=F+P?(n.value=be,r-=F):F+P<r||r<=-(F+P)?(n.value=je,r=0<=r?r-T:r+T):(n.value=xe,r+=F)),r}function j(t,e){var i=t+e;return i<-T?i+=E:+T<i&&(i-=E),i}r=r&&r.hasOwnProperty("default")?r.default:r;var x,I=1,R=2,k=4,A=5,L=484813681109536e-20,F=Math.PI/2,N=.16666666666666666,D=.04722222222222222,G=.022156084656084655,U=1e-10,S=.017453292519943295,w=57.29577951308232,P=Math.PI/4,E=2*Math.PI,T=3.14159265359,z={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},B={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},W=/[\s_\-\/\(\)]/g,V=function(t){var e,i,n,r={},o=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t},{}),s={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*S},lat_1:function(t){r.lat1=t*S},lat_2:function(t){r.lat2=t*S},lat_ts:function(t){r.lat_ts=t*S},lon_0:function(t){r.long0=t*S},lon_1:function(t){r.long1=t*S},lon_2:function(t){r.long2=t*S},alpha:function(t){r.alpha=parseFloat(t)*S},lonc:function(t){r.longc=t*S},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=O(B,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*S},pm:function(t){var e=O(z,t);r.from_greenwich=(e||parseFloat(t))*S},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(r.axis=t)}};for(e in o)i=o[e],e in s?"function"==typeof(n=s[e])?n(i):r[n]=i:r[e]=i;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r};(x=o)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),x("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),x("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),x.WGS84=x["EPSG:4326"],x["EPSG:3785"]=x["EPSG:3857"],x.GOOGLE=x["EPSG:3857"],x["EPSG:900913"]=x["EPSG:3857"],x["EPSG:102113"]=x["EPSG:3857"];function Y(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function H(t){return t<0?-1:1}function X(t){return Math.abs(t)<=T?t:t-H(t)*E}function q(t,e,i){var n=t*i,r=.5*t,n=Math.pow((1-n)/(1+n),r);return Math.tan(.5*(F-e))/n}function K(t,e){for(var i,n,r=.5*t,o=F-2*Math.atan(e),s=0;s<=15;s++)if(i=t*Math.sin(o),o+=n=F-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-o,Math.abs(n)<=1e-10)return o;return-9999}var Z=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],$=["3857","900913","3785","102113"],Q=function(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t},J=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Y(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n,r,o=t.x,s=t.y;return 90<s*w&&s*w<-90&&180<o*w&&o*w<-180||Math.abs(Math.abs(s)-F)<=U?null:(r=this.sphere?(n=this.x0+this.a*this.k0*X(o-this.long0),this.y0+this.a*this.k0*Math.log(Math.tan(P+.5*s))):(e=Math.sin(s),i=q(this.e,s,e),n=this.x0+this.a*this.k0*X(o-this.long0),this.y0-this.a*this.k0*Math.log(i)),t.x=n,t.y=r,t)},inverse:function(t){var e,i,n=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=F-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(-9999===(i=K(this.e,o)))return null}return e=X(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:t,inverse:t,names:["longlat","identity"]}],tt={},et=[],it={start:function(){J.forEach(e)},add:e,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==tt[e]&&et[tt[e]]?et[tt[e]]:void 0}},nt={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},rt=nt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};nt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var ot={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};M.projections=it,M.projections.start();var st=function(t,e,i){return r=e,((n=t).datum_type!==r.datum_type||n.a!==r.a||5e-11<Math.abs(n.es-r.es)||(n.datum_type===I?n.datum_params[0]!==r.datum_params[0]||n.datum_params[1]!==r.datum_params[1]||n.datum_params[2]!==r.datum_params[2]:n.datum_type===R&&(n.datum_params[0]!==r.datum_params[0]||n.datum_params[1]!==r.datum_params[1]||n.datum_params[2]!==r.datum_params[2]||n.datum_params[3]!==r.datum_params[3]||n.datum_params[4]!==r.datum_params[4]||n.datum_params[5]!==r.datum_params[5]||n.datum_params[6]!==r.datum_params[6])))&&t.datum_type!==A&&e.datum_type!==A&&(t.es!==e.es||t.a!==e.a||l(t.datum_type)||l(e.datum_type))?(i=s(i,t.es,t.a),l(t.datum_type)&&(i=function(t,e,i){if(e===I)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(e===R){var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],u=i[6];return{x:u*(t.x-l*t.y+a*t.z)+n,y:u*(l*t.x+t.y-s*t.z)+r,z:u*(-a*t.x+s*t.y+t.z)+o}}}(i,t.datum_type,t.datum_params)),l(e.datum_type)&&(i=function(t,e,i){if(e===I)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(e===R){var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],u=i[6],h=(t.x-n)/u,c=(t.y-r)/u,d=(t.z-o)/u;return{x:h+l*c-a*d,y:-l*h+c+s*d,z:a*h-s*c+d}}}(i,e.datum_type,e.datum_params)),a(i,e.es,e.a,e.b)):i;var n,r},at=function(t,e,i){for(var n,r,o=i.x,s=i.y,a=i.z||0,l={},u=0;u<3;u++)if(!e||2!==u||void 0!==i.z)switch(r=0===u?(n=o,-1!=="ew".indexOf(t.axis[u])?"x":"y"):1===u?(n=s,-1!=="ns".indexOf(t.axis[u])?"y":"x"):(n=a,"z"),t.axis[u]){case"e":case"w":case"n":case"s":l[r]=n;break;case"u":void 0!==i[r]&&(l.z=n);break;case"d":void 0!==i[r]&&(l.z=-n);break;default:return null}return l},lt=function(t){var e={x:t[0],y:t[1]};return 2<t.length&&(e.z=t[2]),3<t.length&&(e.m=t[3]),e},ut=function(t){i(t.x),i(t.y)},ht=M("WGS84"),ct=6,dt="AJSAJS",pt="AFAFAF",ft=65,gt=73,mt=79,yt=86,_t=90,vt={forward:d,inverse:function(t){var e=b(g(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:p};m.fromMGRS=function(t){return new m(p(t))},m.prototype.toMGRS=function(t){return d([this.x,this.y],t)};function bt(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*zt))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*zt)));var i=t*t;return e[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,e[3]=i*(.3645833333333333-.005696614583333333*t),e[4]=i*t*.3076171875,e}function jt(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}function xt(t,e,i){for(var n=1/(1-e),r=t,o=20;o;--o){var s=Math.sin(r),a=1-e*s*s;if(r-=a=(jt(r,s,Math.cos(r),i)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<U)return r}return r}function St(t){var e=Math.exp(t);return(e-1/e)/2}function wt(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function Pt(t){var e,i,n,r=Math.abs(t);return e=r*(1+r/(wt(1,r)+1)),r=0==(n=(i=1+e)-1)?e:e*Math.log(i)/n,t<0?-r:r}function Et(t,e){for(var i,n=2*Math.cos(2*e),r=t.length-1,o=t[r],s=0;0<=--r;)i=n*o-s+t[r],s=o,o=i;return e+i*Math.sin(2*e)}function Tt(t,e,i){for(var n,r,o,s,a=Math.sin(e),l=Math.cos(e),u=St(i),h=(o=i,((s=Math.exp(o))+1/s)/2),c=2*l*h,d=-2*a*u,p=t.length-1,f=t[p],g=0,m=0,y=0;0<=--p;)n=m,r=g,f=c*(m=f)-n-d*(g=y)+t[p],y=d*m-r+c*g;return[(c=a*h)*f-(d=l*u)*y,c*y+d*f]}function Ot(t,e){return Math.pow((1-t)/(1+t),e)}function Ct(t,e,i,n,r){return t*r-e*Math.sin(2*r)+i*Math.sin(4*r)-n*Math.sin(6*r)}function Mt(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function It(t){return.375*t*(1+.25*t*(1+.46875*t))}function Rt(t){return.05859375*t*t*(1+.75*t)}function kt(t){return t*t*t*(35/3072)}function At(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function Lt(t){return Math.abs(t)<F?t:t-H(t)*Math.PI}function Ft(t,e,i,n,r){for(var o,s=t/e,a=0;a<15;a++)if(s+=o=(t-(e*s-i*Math.sin(2*s)+n*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*i*Math.cos(2*s)+4*n*Math.cos(4*s)-6*r*Math.cos(6*s)),Math.abs(o)<=1e-10)return s;return NaN}function Nt(t,e){var i;return 1e-7<t?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}function Dt(t){return 1<Math.abs(t)&&(t=1<t?1:-1),Math.asin(t)}function Gt(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))}var Ut,zt=.01068115234375,Bt={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=bt(this.es),this.ml0=jt(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e=t.x,i=t.y,n=X(e-this.long0),r=Math.sin(i),o=Math.cos(i);if(this.es){var s=o*n,a=Math.pow(s,2),l=this.ep2*Math.pow(o,2),u=Math.pow(l,2),h=Math.abs(o)>U?Math.tan(i):0,c=Math.pow(h,2),d=Math.pow(c,2),p=1-this.es*Math.pow(r,2);s/=Math.sqrt(p);var f=jt(i,r,o,this.en),g=this.a*(this.k0*s*(1+a/6*(1-c+l+a/20*(5-18*c+d+14*l-58*c*l+a/42*(61+179*d-d*c-479*c)))))+this.x0,m=this.a*(this.k0*(f-this.ml0+r*n*s/2*(1+a/12*(5-c+9*l+4*u+a/30*(61+d-58*c+270*l-330*c*l+a/56*(1385+543*d-d*c-3111*c))))))+this.y0}else{var y=o*Math.sin(n);if(Math.abs(Math.abs(y)-1)<U)return 93;if(g=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,m=o*Math.cos(n)/Math.sqrt(1-Math.pow(y,2)),1<=(y=Math.abs(m))){if(U<y-1)return 93;m=0}else m=Math.acos(m);i<0&&(m=-m),m=this.a*this.k0*(m-this.lat0)+this.y0}return t.x=g,t.y=m,t},inverse:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_=(t.x-this.x0)*(1/this.a),v=(t.y-this.y0)*(1/this.a);return p=this.es?(u=this.ml0+v/this.k0,e=xt(u,this.es,this.en),Math.abs(e)<F?(i=Math.sin(e),n=Math.cos(e),r=Math.abs(n)>U?Math.tan(e):0,o=this.ep2*Math.pow(n,2),s=Math.pow(o,2),a=Math.pow(r,2),l=Math.pow(a,2),u=1-this.es*Math.pow(i,2),h=_*Math.sqrt(u)/this.k0,d=e-(u*=r)*(c=Math.pow(h,2))/(1-this.es)*.5*(1-c/12*(5+3*a-9*o*a+o-4*s-c/30*(61+90*a-252*o*a+45*l+46*o-c/56*(1385+3633*a+4095*l+1574*l*a)))),X(this.long0+h*(1-c/6*(1+2*a+o-c/20*(5+28*a+24*l+8*o*a+6*o-c/42*(61+662*a+1320*l+720*l*a))))/n)):(d=F*H(v),0)):(g=.5*((f=Math.exp(_/this.k0))-1/f),m=this.lat0+v/this.k0,y=Math.cos(m),u=Math.sqrt((1-Math.pow(y,2))/(1+Math.pow(g,2))),d=Math.asin(u),v<0&&(d=-d),0==g&&0===y?0:X(Math.atan2(g,y)+this.long0)),t.x=p,t.y=d,t},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Wt={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+-2854/675*e))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+4642/4725*e))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+2323/945*e))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+-1522/945*e)))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+73814/2835*e))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+-12686/2835*e))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+-399572/14175*e)),this.cbg[3]=i*(1237/630+e*(-24832/14175*e-2.4)),i*=e,this.cgb[4]=i*(4174/315+-144838/6237*e),this.cbg[4]=i*(-734/315+109598/31185*e),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(.25+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+-96199/604800*e))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+7891/37800*e))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+1118711/3870720*e)))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+-1983433/1935360*e))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+-5569/90720*e))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+167603/181440*e))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+830251/7257600*e)),this.gtu[3]=i*(49561/161280+e*(-179/168+6601661/7257600*e)),i*=e,this.utg[4]=i*(-4583/161280+108847/3991680*e),this.gtu[4]=i*(34729/80640+-3418889/1995840*e),i*=e,this.utg[5]=-.03233083094085698*i,this.gtu[5]=.6650675310896665*i;var n=Et(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),r=t.length-1,o=t[r],s=0;0<=--r;)i=n*o-s+t[r],s=o,o=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=X(t.x-this.long0),i=t.y,i=Et(this.cbg,i),n=Math.sin(i),r=Math.cos(i),o=Math.sin(e),s=Math.cos(e);i=Math.atan2(n,s*r),e=Math.atan2(o*r,wt(n,r*s)),e=Pt(Math.tan(e));var a,l,u=Tt(this.gtu,2*i,2*e);return i+=u[0],e+=u[1],l=Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,this.a*(this.Qn*i+this.Zb)+this.y0):a=1/0,t.x=a,t.y=l,t},inverse:function(t){var e,i,n,r,o,s,a,l=(t.x-this.x0)*(1/this.a),u=(t.y-this.y0)*(1/this.a);return u=(u-this.Zb)/this.Qn,l/=this.Qn,a=Math.abs(l)<=2.623395162778?(u+=(e=Tt(this.utg,2*u,2*l))[0],l+=e[1],l=Math.atan(St(l)),i=Math.sin(u),n=Math.cos(u),r=Math.sin(l),o=Math.cos(l),u=Math.atan2(i*o,wt(r,o*n)),l=Math.atan2(r,o*n),s=X(l+this.long0),Et(this.cgb,u)):s=1/0,t.x=s,t.y=a,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},Vt={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(X(e)+Math.PI)/Math.PI)+1)<0)return 0;if(60<t)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*S,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Wt.init.apply(this),this.forward=Wt.forward,this.inverse=Wt.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Yt={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+P)/(Math.pow(Math.tan(.5*this.lat0+P),this.C)*Ot(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+P),this.C)*Ot(this.e*Math.sin(i),this.ratexp))-F,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+P)/this.K,1/this.C),r=20;0<r&&(i=2*Math.atan(n*Ot(this.e*Math.sin(t.y),-.5*this.e))-F,!(Math.abs(i-t.y)<1e-14));--r)t.y=i;return r?(t.x=e,t.y=i,t):null},names:["gauss"]},Ht={init:function(){Yt.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,r;return t.x=X(t.x-this.long0),Yt.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=r*i*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,r,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=2*Math.atan2(e,this.R2),n=Math.sin(i),r=Math.cos(i),o=Math.asin(r*this.sinc0+t.y*n*this.cosc0/e),Math.atan2(t.x*n,e*this.cosc0*r-t.y*this.sinc0*n)):(o=this.phic0,0),t.x=s,t.y=o,Yt.inverse.apply(this,[t]),t.x=X(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Xt={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=U&&(this.k0=.5*(1+H(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=U&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=U&&(this.k0=.5*this.cons*Y(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/q(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Y(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-F,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,r,o,s,a=t.x,l=t.y,u=Math.sin(l),h=Math.cos(l),c=X(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=U&&Math.abs(l+this.lat0)<=U?(t.x=NaN,t.y=NaN):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*h*Math.cos(c)),t.x=this.a*e*h*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*h*Math.cos(c))+this.y0):(i=2*Math.atan(this.ssfn_(l,u,this.e))-F,r=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=U?(o=q(this.e,l*this.con,this.con*u),s=2*this.a*this.k0*o/this.cons,t.x=this.x0+s*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0)):(Math.abs(this.sinlat0)<U?(e=2*this.a*this.k0/(1+r*Math.cos(c)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*r*Math.cos(c))),t.y=e*(this.cosX0*n-this.sinX0*r*Math.cos(c))+this.y0),t.x=e*r*Math.sin(c)+this.x0)),t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,r=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(r/(2*this.a*this.k0)),s=this.long0,a=this.lat0;return r<=U||(a=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/r),s=X(Math.abs(this.coslat0)<U?0<this.lat0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(o),r*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o)))),t.x=s,t.y=a,t}if(Math.abs(this.coslat0)<=U){if(r<=U)return a=this.lat0,s=this.long0,t.x=s,t.y=a,t;t.x*=this.con,t.y*=this.con,e=r*this.cons/(2*this.a*this.k0),a=this.con*K(this.e,e),s=this.con*X(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else i=2*Math.atan(r*this.cosX0/(2*this.a*this.k0*this.ms1)),s=this.long0,r<=U?n=this.X0:(n=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/r),s=X(this.long0+Math.atan2(t.x*Math.sin(i),r*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))),a=-1*K(this.e,Math.tan(.5*(F+n)));return t.x=s,t.y=a,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(F+t))*Math.pow((1-e)/(1+e),.5*i)}},qt={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,r=2*n-Math.pow(n,2),o=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+o*e)/(1-o*e));this.K=s-this.alpha*a+this.alpha*o/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,r=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,r=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(n)),s=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+s/this.alpha,l=0,u=o,h=-1e3,c=0;1e-7<Math.abs(u-h);){if(20<++c)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=u,t},names:["somerc"]},Kt={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),i=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-i*i);var n,r,o,s,a,l,u,h,c,d,p=q(this.e,this.lat0,t),f=this.bl/e*Math.sqrt((1-this.es)/(1-i*i));f*f<1&&(f=1),isNaN(this.longc)?(r=q(this.e,this.lat1,Math.sin(this.lat1)),o=q(this.e,this.lat2,Math.sin(this.lat2)),0<=this.lat0?this.el=(f+Math.sqrt(f*f-1))*Math.pow(p,this.bl):this.el=(f-Math.sqrt(f*f-1))*Math.pow(p,this.bl),s=Math.pow(r,this.bl),a=Math.pow(o,this.bl),l=.5*((n=this.el/s)-1/n),u=(this.el*this.el-a*s)/(this.el*this.el+a*s),h=(a-s)/(a+s),c=X(this.long1-this.long2),this.long0=.5*(this.long1+this.long2)-Math.atan(u*Math.tan(.5*this.bl*c)/h)/this.bl,this.long0=X(this.long0),d=X(this.long1-this.long0),this.gamma0=Math.atan(Math.sin(this.bl*d)/l),this.alpha=Math.asin(f*Math.sin(this.gamma0))):(n=0<=this.lat0?f+Math.sqrt(f*f-1):f-Math.sqrt(f*f-1),this.el=n*Math.pow(p,this.bl),l=.5*(n-1/n),this.gamma0=Math.asin(Math.sin(this.alpha)/f),this.long0=this.longc-Math.asin(l*Math.tan(this.gamma0))/this.bl),this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(f*f-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(f*f-1),Math.cos(this.alpha))},forward:function(t){var e,i,n,r,o,s,a,l,u,h=t.x,c=t.y,d=X(h-this.long0);return u=Math.abs(Math.abs(c)-F)<=U?(e=0<c?-1:1,l=this.al/this.bl*Math.log(Math.tan(P+e*this.gamma0*.5)),-1*e*F*this.al/this.bl):(i=q(this.e,c,Math.sin(c)),r=.5*((n=this.el/Math.pow(i,this.bl))-1/n),o=.5*(n+1/n),s=Math.sin(this.bl*d),a=(r*Math.sin(this.gamma0)-s*Math.cos(this.gamma0))/o,l=Math.abs(Math.abs(a)-1)<=U?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-a)/(1+a))/this.bl,Math.abs(Math.cos(this.bl*d))<=U?this.al*this.bl*d:this.al*Math.atan2(r*Math.cos(this.gamma0)+s*Math.sin(this.gamma0),Math.cos(this.bl*d))/this.bl),this.no_rot?(t.x=this.x0+u,t.y=this.y0+l):(u-=this.uc,t.x=this.x0+l*Math.cos(this.alpha)+u*Math.sin(this.alpha),t.y=this.y0+u*Math.cos(this.alpha)-l*Math.sin(this.alpha)),t},inverse:function(t){var e,i;this.no_rot?(i=t.y-this.y0,e=t.x-this.x0):(i=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var n=Math.exp(-1*this.bl*i/this.al),r=.5*(n-1/n),o=.5*(n+1/n),s=Math.sin(this.bl*e/this.al),a=(s*Math.cos(this.gamma0)+r*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<U?(t.x=this.long0,t.y=F):Math.abs(1+a)<U?(t.x=this.long0,t.y=-1*F):(t.y=K(this.e,l),t.x=X(this.long0-Math.atan2(r*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},Zt={init:function(){var t,e,i,n,r,o,s,a,l,u;this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,Math.abs(this.lat1+this.lat2)<U||(t=this.b/this.a,this.e=Math.sqrt(1-t*t),e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=Y(this.e,e,i),r=q(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Y(this.e,o,s),l=q(this.e,this.lat2,o),u=q(this.e,this.lat0,Math.sin(this.lat0)),Math.abs(this.lat1-this.lat2)>U?this.ns=Math.log(n/a)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic"))},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=U&&(i=H(i)*(F-2*U));var n,r,o=Math.abs(Math.abs(i)-F);if(U<o)n=q(this.e,i,Math.sin(i)),r=this.a*this.f0*Math.pow(n,this.ns);else{if((o=i*this.ns)<=0)return null;r=0}var s=this.ns*X(e-this.long0);return t.x=this.k0*(r*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(s))+this.y0,t},inverse:function(t){var e,i,n,r,o=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0,a=0<this.ns?(e=Math.sqrt(o*o+s*s),1):(e=-Math.sqrt(o*o+s*s),-1),l=0;if(0!==e&&(l=Math.atan2(a*o,a*s)),0!==e||0<this.ns){if(a=1/this.ns,i=Math.pow(e/(this.a*this.f0),a),-9999===(n=K(this.e,i)))return null}else n=-F;return r=X(l/this.ns+this.long0),t.x=r,t.y=n,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},$t={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e=t.x,i=t.y,n=X(e-this.long0),r=Math.pow((1+this.e*Math.sin(i))/(1-this.e*Math.sin(i)),this.alfa*this.e/2),o=2*(Math.atan(this.k*Math.pow(Math.tan(i/2+this.s45),this.alfa)/r)-this.s45),s=-n*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(o)+Math.sin(this.ad)*Math.cos(o)*Math.cos(s)),l=Math.asin(Math.cos(o)*Math.sin(s)/Math.cos(a)),u=this.n*l,h=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n);return t.y=h*Math.cos(u),t.x=h*Math.sin(u),this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,r,o,s,a,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),i=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(e)),t.x=this.long0-i/this.alfa,s=e;for(var u=a=0;t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(a=1),s=t.y,u+=1,0===a&&u<15;);return 15<=u?null:t},names:["Krovak","krovak"]},Qt={init:function(){this.sphere||(this.e0=Mt(this.es),this.e1=It(this.es),this.e2=Rt(this.es),this.e3=kt(this.es),this.ml0=this.a*Ct(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n,r,o,s,a,l,u,h=t.x,c=t.y,h=X(h-this.long0);return u=this.sphere?(l=this.a*Math.asin(Math.cos(c)*Math.sin(h)),this.a*(Math.atan2(Math.tan(c),Math.cos(h))-this.lat0)):(e=Math.sin(c),i=Math.cos(c),n=At(this.a,this.e,e),r=Math.tan(c)*Math.tan(c),l=n*(o=h*Math.cos(c))*(1-(s=o*o)*r*(1/6-(8-r+8*(a=this.es*i*i/(1-this.es)))*s/120)),this.a*Ct(this.e0,this.e1,this.e2,this.e3,c)-this.ml0+n*e/i*s*(.5+(5-r+6*a)*s/24)),t.x=l+this.x0,t.y=u+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,i=t.y/this.a;if(this.sphere)var n=i+this.lat0,r=Math.asin(Math.sin(n)*Math.cos(e)),o=Math.atan2(Math.tan(e),Math.cos(n));else{var s=this.ml0/this.a+i,a=Ft(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-F)<=U)return t.x=this.long0,t.y=F,i<0&&(t.y*=-1),t;var l=At(this.a,this.e,Math.sin(a)),u=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(a),2),c=e*this.a/l,d=c*c;r=a-l*Math.tan(a)/u*c*c*(.5-(1+3*h)*c*c/24),o=c*(1-d*(h/3+(1+3*h)*h*d/15))/Math.cos(a)}return t.x=X(o+this.long0),t.y=Lt(r),t},names:["Cassini","Cassini_Soldner","cass"]},Jt={init:function(){var t,e,i,n,r=Math.abs(this.lat0);if(Math.abs(r-F)<U?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(r)<U?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es)switch(this.qp=Nt(this.e,1),this.mmf=.5/(1-this.es),this.apa=(e=this.es,(n=[])[0]=.3333333333333333*e,i=e*e,n[0]+=.17222222222222222*i,n[1]=.06388888888888888*i,i*=e,n[0]+=.10257936507936508*i,n[1]+=.0664021164021164*i,n[2]=.016415012942191543*i,n),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Nt(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,r,o,s,a,l,u,h,c=t.x,d=t.y,c=X(c-this.long0);if(this.sphere){if(o=Math.sin(d),h=Math.cos(d),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+h*n:1+this.sinph0*o+this.cosph0*h*n)<=U)return null;e=(i=Math.sqrt(2/i))*h*Math.sin(c),i*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*h*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(d+this.lat0)<U)return null;i=P-.5*d,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(c),i*=n}}else{switch(u=l=a=0,n=Math.cos(c),r=Math.sin(c),o=Math.sin(d),s=Nt(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:u=1+this.sinb1*a+this.cosb1*l*n;break;case this.EQUIT:u=1+l*n;break;case this.N_POLE:u=F+d,s=this.qp-s;break;case this.S_POLE:u=d-F,s=this.qp+s}if(Math.abs(u)<U)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),i=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*a-this.sinb1*l*n):(u=Math.sqrt(2/(1+l*n)))*a*this.ymf,e=this.xmf*u*l*r;break;case this.N_POLE:case this.S_POLE:0<=s?(e=(u=Math.sqrt(s))*r,i=n*(this.mode===this.S_POLE?u:-u)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,r,o,s,a,l,u,h,c=t.x/this.a,d=t.y/this.a;if(this.sphere){var p=0,f=0,g=Math.sqrt(c*c+d*d);if(1<(i=.5*g))return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(f=Math.sin(i),p=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(g)<=U?0:Math.asin(d*f/g),c*=f,d=p*g;break;case this.OBLIQ:i=Math.abs(g)<=U?this.lat0:Math.asin(p*this.sinph0+d*f*this.cosph0/g),c*=f*this.cosph0,d=(p-Math.sin(i)*this.sinph0)*g;break;case this.N_POLE:d=-d,i=F-i;break;case this.S_POLE:i-=F}e=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,d):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,d*=this.dd,(s=Math.sqrt(c*c+d*d))<U)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*s/this.rq),n=Math.cos(r),c*=r=Math.sin(r),d=this.mode===this.OBLIQ?(a=n*this.sinb1+d*r*this.cosb1/s,o=this.qp*a,s*this.cosb1*n-d*this.sinb1*r):(a=d*r/s,o=this.qp*a,s*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(o=c*c+d*d))return t.x=this.long0,t.y=this.lat0,t;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(c,d),l=Math.asin(a),u=this.apa,h=l+l,i=l+u[0]*Math.sin(h)+u[1]*Math.sin(h+h)+u[2]*Math.sin(h+h+h)}return t.x=X(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},te={init:function(){Math.abs(this.lat1+this.lat2)<U||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Y(this.e3,this.sin_po,this.cos_po),this.qs1=Nt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Y(this.e3,this.sin_po,this.cos_po),this.qs2=Nt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Nt(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>U?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=Nt(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,o=this.ns0*X(e-this.long0),s=r*Math.sin(o)+this.x0,a=this.rh-r*Math.cos(o)+this.y0;return t.x=s,t.y=a,t},inverse:function(t){var e,i,n,r,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,n=0<=this.ns0?(e=Math.sqrt(t.x*t.x+t.y*t.y),1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),-1),(r=0)!==e&&(r=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,s=this.sphere?Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,this.phi1z(this.e3,i)),o=X(r/this.ns0+this.long0),t.x=o,t.y=s,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,r,o,s=Dt(.5*e);if(t<U)return s;for(var a=t*t,l=1;l<=25;l++)if(s+=o=.5*(r=1-(n=t*(i=Math.sin(s)))*n)*r/Math.cos(s)*(e/(1-a)-i/r+.5/t*Math.log((1-n)/(1+n))),Math.abs(o)<=1e-7)return s;return null}},ee={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n=t.x,r=t.y,o=X(n-this.long0),s=Math.sin(r),a=Math.cos(r),l=Math.cos(o),u=0<(e=this.sin_p14*s+this.cos_p14*a*l)||Math.abs(e)<=U?(i=this.x0+this.a*a*Math.sin(o)/e,this.y0+this.a*(this.cos_p14*s-this.sin_p14*a*l)/e):(i=this.x0+this.infinity_dist*a*Math.sin(o),this.y0+this.infinity_dist*(this.cos_p14*s-this.sin_p14*a*l));return t.x=i,t.y=u,t},inverse:function(t){var e,i,n,r,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),i=Math.sin(r),n=Math.cos(r),s=Dt(n*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),X(this.long0+o)):(s=this.phic0,0),t.x=o,t.y=s,t},names:["gnom"]},ie={init:function(){this.sphere||(this.k0=Y(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n,r=t.x,o=t.y,s=X(r-this.long0);return n=this.sphere?(i=this.x0+this.a*s*Math.cos(this.lat_ts),this.y0+this.a*Math.sin(o)/Math.cos(this.lat_ts)):(e=Nt(this.e,Math.sin(o)),i=this.x0+this.a*this.k0*s,this.y0+this.a*e*.5/this.k0),t.x=i,t.y=n,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=X(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*F:F;for(var n,r,o,s,a=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(a),o=Math.cos(a),s=t*r,a+=n=Math.pow(1-s*s,2)/(2*o)*(e/(1-t*t)-r/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=X(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},ne={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=X(e-this.long0),r=Lt(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,i=t.y;return t.x=X(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Lt(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},re={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Mt(this.es),this.e1=It(this.es),this.e2=Rt(this.es),this.e3=kt(this.es),this.ml0=this.a*Ct(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,r=t.x,o=t.y,s=X(r-this.long0),a=s*Math.sin(o);return n=this.sphere?Math.abs(o)<=U?(i=this.a*s,-1*this.a*this.lat0):(i=this.a*Math.sin(a)/Math.tan(o),this.a*(Lt(o-this.lat0)+(1-Math.cos(a))/Math.tan(o))):Math.abs(o)<=U?(i=this.a*s,-1*this.ml0):(i=(e=At(this.a,this.e,Math.sin(o))/Math.tan(o))*Math.sin(a),this.a*Ct(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+e*(1-Math.cos(a))),t.x=i+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,i,n,r,o,s,a,l,u=t.x-this.x0,h=t.y-this.y0;if(this.sphere)if(Math.abs(h+this.a*this.lat0)<=U)e=X(u/this.a+this.long0),i=0;else{for(var c,d=this.lat0+h/this.a,p=u*u/this.a/this.a+d*d,f=d,g=20;g;--g)if(f+=n=-1*(d*(f*(c=Math.tan(f))+1)-f-.5*(f*f+p)*c)/((f-d)/c-1),Math.abs(n)<=U){i=f;break}e=X(this.long0+Math.asin(u*Math.tan(f)/this.a)/Math.sin(i))}else if(Math.abs(h+this.ml0)<=U)i=0,e=X(this.long0+u/this.a);else{for(d=(this.ml0+h)/this.a,p=u*u/this.a/this.a+d*d,f=d,g=20;g;--g)if(l=this.e*Math.sin(f),r=Math.sqrt(1-l*l)*Math.tan(f),o=this.a*Ct(this.e0,this.e1,this.e2,this.e3,f),s=this.e0-2*this.e1*Math.cos(2*f)+4*this.e2*Math.cos(4*f)-6*this.e3*Math.cos(6*f),f-=n=(d*(r*(a=o/this.a)+1)-a-.5*r*(a*a+p))/(this.es*Math.sin(2*f)*(a*a+p-2*d*a)/(4*r)+(d-a)*(r*s-2/Math.sin(2*f))-s),Math.abs(n)<=U){i=f;break}r=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=X(this.long0+Math.asin(u*r/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},oe={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){for(var e=t.x,i=t.y-this.lat0,n=e-this.long0,r=i/L*1e-5,o=n,s=1,a=0,l=1;l<=10;l++)s*=r,a+=this.A[l]*s;var u,h=a,c=o,d=1,p=0,f=0,g=0;for(l=1;l<=6;l++)u=p*h+d*c,d=d*h-p*c,p=u,f=f+this.B_re[l]*d-this.B_im[l]*p,g=g+this.B_im[l]*d+this.B_re[l]*p;return t.x=g*this.a+this.x0,t.y=f*this.a+this.y0,t},inverse:function(t){var e,i=t.x,n=t.y,r=i-this.x0,o=(n-this.y0)/this.a,s=r/this.a,a=1,l=0,u=0,h=0;for(y=1;y<=6;y++)e=l*o+a*s,a=a*o-l*s,l=e,u=u+this.C_re[y]*a-this.C_im[y]*l,h=h+this.C_im[y]*a+this.C_re[y]*l;for(var c=0;c<this.iterations;c++){for(var d,p=u,f=h,g=o,m=s,y=2;y<=6;y++)d=f*u+p*h,p=p*u-f*h,f=d,g+=(y-1)*(this.B_re[y]*p-this.B_im[y]*f),m+=(y-1)*(this.B_im[y]*p+this.B_re[y]*f);p=1,f=0;var _=this.B_re[1],v=this.B_im[1];for(y=2;y<=6;y++)d=f*u+p*h,p=p*u-f*h,f=d,_+=y*(this.B_re[y]*p-this.B_im[y]*f),v+=y*(this.B_im[y]*p+this.B_re[y]*f);var b=_*_+v*v,u=(g*_+m*v)/b,h=(m*_-g*v)/b}var j=u,x=h,S=1,w=0;for(y=1;y<=9;y++)S*=j,w+=this.D[y]*S;var P=this.lat0+w*L*1e5,E=this.long0+x;return t.x=E,t.y=P,t},names:["New_Zealand_Map_Grid","nzmg"]},se={init:function(){},forward:function(t){var e=t.x,i=t.y,n=X(e-this.long0),r=this.x0+this.a*n,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=r,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=X(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},ae={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=bt(this.es)},forward:function(t){var e=t.x,i=t.y,e=X(e-this.long0);if(this.sphere){if(this.m)for(var n=this.n*Math.sin(i),r=20;r;--r){var o=(this.m*i+Math.sin(i)-n)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<U)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;u=this.a*this.C_x*e*(this.m+Math.cos(i)),l=this.a*this.C_y*i}else var s=Math.sin(i),a=Math.cos(i),l=this.a*jt(i,s,a,this.en),u=this.a*e*a/Math.sqrt(1-this.es*s*s);return t.x=u,t.y=l,t},inverse:function(t){var e,i,n,r;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,n/=this.C_x*(this.m+Math.cos(e)),this.m?e=Dt((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Dt(Math.sin(e)/this.n)),n=X(n+this.long0),e=Lt(e)):(e=xt(t.y/this.a,this.es,this.en),(r=Math.abs(e))<F?(r=Math.sin(e),i=this.long0+t.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),n=X(i)):r-U<F&&(n=this.long0)),t.x=n,t.y=e,t},names:["Sinusoidal","sinu"]},le={init:function(){},forward:function(t){for(var e=t.x,i=t.y,n=X(e-this.long0),r=i,o=Math.PI*Math.sin(i);;){var s=-(r+Math.sin(r)-o)/(1+Math.cos(r));if(r+=s,Math.abs(s)<U)break}r/=2,Math.PI/2-Math.abs(i)<U&&(n=0);var a=.900316316158*this.a*n*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),.999999999999<Math.abs(i)&&(i=.999999999999),e=Math.asin(i);var n=X(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,1<Math.abs(i)&&(i=1);var r=Math.asin(i);return t.x=n,t.y=r,t},names:["Mollweide","moll"]},ue={init:function(){Math.abs(this.lat1+this.lat2)<U||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Mt(this.es),this.e1=It(this.es),this.e2=Rt(this.es),this.e3=kt(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Y(this.e,this.sinphi,this.cosphi),this.ml1=Ct(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<U?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Y(this.e,this.sinphi,this.cosphi),this.ml2=Ct(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ct(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i,n=t.x,r=t.y;i=this.sphere?this.a*(this.g-r):(e=Ct(this.e0,this.e1,this.e2,this.e3,r),this.a*(this.g-e));var o=this.ns*X(n-this.long0),s=this.x0+i*Math.sin(o),a=this.y0+this.rh-i*Math.cos(o);return t.x=s,t.y=a,t},inverse:function(t){var e,i;t.x-=this.x0,t.y=this.rh-t.y+this.y0,e=0<=this.ns?(i=Math.sqrt(t.x*t.x+t.y*t.y),1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),-1);var n=0;if(0!==i&&(n=Math.atan2(e*t.x,e*t.y)),this.sphere)return s=X(this.long0+n/this.ns),o=Lt(this.g-i/this.a),t.x=s,t.y=o,t;var r=this.g-i/this.a,o=Ft(r,this.e0,this.e1,this.e2,this.e3),s=X(this.long0+n/this.ns);return t.x=s,t.y=o,t},names:["Equidistant_Conic","eqdc"]},he={init:function(){this.R=this.a},forward:function(t){var e,i=t.x,n=t.y,r=X(i-this.long0);Math.abs(n)<=U&&(e=this.x0+this.R*r,m=this.y0);var o=Dt(2*Math.abs(n/Math.PI));(Math.abs(r)<=U||Math.abs(Math.abs(n)-F)<=U)&&(e=this.x0,m=0<=n?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var s=.5*Math.abs(Math.PI/r-r/Math.PI),a=s*s,l=Math.sin(o),u=Math.cos(o),h=u/(l+u-1),c=h*h,d=h*(2/l-1),p=d*d,f=Math.PI*this.R*(s*(h-p)+Math.sqrt(a*(h-p)*(h-p)-(p+a)*(c-p)))/(p+a);r<0&&(f=-f),e=this.x0+f;var g=a+h,f=Math.PI*this.R*(d*g-s*Math.sqrt((p+a)*(1+a)-g*g))/(p+a),m=0<=n?this.y0+f:this.y0-f;return t.x=e,t.y=m,t},inverse:function(t){var e,i,n,r,o,s,a,l,u,h,c,d;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,o=(n=t.x/c)*n+(r=t.y/c)*r,c=3*(r*r/(l=-2*(s=-Math.abs(r)*(1+o))+1+2*r*r+o*o)+(2*(a=s-2*r*r+n*n)*a*a/l/l/l-9*s*a/l/l)/27)/(u=(s-a*a/3/l)/l)/(h=2*Math.sqrt(-u/3)),1<Math.abs(c)&&(c=0<=c?1:-1),d=Math.acos(c)/3,i=0<=t.y?(-h*Math.cos(d+Math.PI/3)-a/3/l)*Math.PI:-(-h*Math.cos(d+Math.PI/3)-a/3/l)*Math.PI,e=Math.abs(n)<U?this.long0:X(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-r*r)+o*o))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},ce={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v,b,j,x,S=t.x,w=t.y,P=Math.sin(t.y),E=Math.cos(t.y),T=X(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=U?(t.x=this.x0+this.a*(F-w)*Math.sin(T),t.y=this.y0-this.a*(F-w)*Math.cos(T)):Math.abs(this.sin_p12+1)<=U?(t.x=this.x0+this.a*(F+w)*Math.sin(T),t.y=this.y0+this.a*(F+w)*Math.cos(T)):(_=this.sin_p12*P+this.cos_p12*E*Math.cos(T),y=(m=Math.acos(_))?m/Math.sin(m):1,t.x=this.x0+this.a*y*E*Math.sin(T),t.y=this.y0+this.a*y*(this.cos_p12*P-this.sin_p12*E*Math.cos(T))):(e=Mt(this.es),i=It(this.es),n=Rt(this.es),r=kt(this.es),Math.abs(this.sin_p12-1)<=U?(o=this.a*Ct(e,i,n,r,F),s=this.a*Ct(e,i,n,r,w),t.x=this.x0+(o-s)*Math.sin(T),t.y=this.y0-(o-s)*Math.cos(T)):Math.abs(this.sin_p12+1)<=U?(o=this.a*Ct(e,i,n,r,F),s=this.a*Ct(e,i,n,r,w),t.x=this.x0+(o+s)*Math.sin(T),t.y=this.y0+(o+s)*Math.cos(T)):(a=P/E,l=At(this.a,this.e,this.sin_p12),u=At(this.a,this.e,P),h=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(u*E)),v=0===(c=Math.atan2(Math.sin(T),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(T)))?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(c)-Math.PI)<=U?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(T)*Math.cos(h)/Math.sin(c)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),m=l*v*(1-(b=v*v)*(g=(p=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es))*p)*(1-g)/6+(j=b*v)/8*(f=d*p)*(1-2*g)+(x=j*v)/120*(g*(4-7*g)-3*d*d*(1-7*g))-x*v/48*f),t.x=this.x0+m*Math.sin(c),t.y=this.y0+m*Math.cos(c))),t},inverse:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v,b,j,x,S;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*F*this.a)return;return i=e/this.a,n=Math.sin(i),r=Math.cos(i),o=this.long0,Math.abs(e)<=U?s=this.lat0:(s=Dt(r*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-F,o=X(Math.abs(a)<=U?0<=this.lat0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*n,e*this.cos_p12*r-t.y*this.sin_p12*n))),t.x=o,t.y=s,t}return l=Mt(this.es),u=It(this.es),h=Rt(this.es),c=kt(this.es),Math.abs(this.sin_p12-1)<=U?(d=this.a*Ct(l,u,h,c,F),e=Math.sqrt(t.x*t.x+t.y*t.y),s=Ft((d-e)/this.a,l,u,h,c),o=X(this.long0+Math.atan2(t.x,-1*t.y))):Math.abs(this.sin_p12+1)<=U?(d=this.a*Ct(l,u,h,c,F),e=Math.sqrt(t.x*t.x+t.y*t.y),s=Ft((e-d)/this.a,l,u,h,c),o=X(this.long0+Math.atan2(t.x,t.y))):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),p=At(this.a,this.e,this.sin_p12),m=Math.cos(g),_=-(y=this.e*this.cos_p12*m)*y/(1-this.es),v=3*this.es*(1-_)*this.sin_p12*this.cos_p12*m/(1-this.es),x=1-_*(j=(b=e/p)-_*(1+_)*Math.pow(b,3)/6-v*(1+3*_)*Math.pow(b,4)/24)*j/2-b*j*j*j/6,f=Math.asin(this.sin_p12*Math.cos(j)+this.cos_p12*Math.sin(j)*m),o=X(this.long0+Math.asin(Math.sin(g)*Math.sin(j)/Math.cos(f))),S=Math.sin(f),s=Math.atan2((S-this.es*x*this.sin_p12)*Math.tan(f),S*(1-this.es))),t.x=o,t.y=s,t},names:["Azimuthal_Equidistant","aeqd"]},de={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,r=t.x,o=t.y,s=X(r-this.long0),a=Math.sin(o),l=Math.cos(o),u=Math.cos(s);return(0<(e=this.sin_p14*a+this.cos_p14*l*u)||Math.abs(e)<=U)&&(i=this.a*l*Math.sin(s),n=this.y0+this.a*(this.cos_p14*a-this.sin_p14*l*u)),t.x=i,t.y=n,t},inverse:function(t){var e,i,n,r,o,s,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),i=Dt(e/this.a),n=Math.sin(i),r=Math.cos(i),s=this.long0,Math.abs(e)<=U?a=this.lat0:(a=Dt(r*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.abs(this.lat0)-F,s=Math.abs(o)<=U?X(0<=this.lat0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)):X(this.long0+Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n))),t.x=s,t.y=a,t},names:["ortho"]},pe=1,fe=2,ge=3,me=4,ye=5,_e=6,ve=1,be=2,je=3,xe=4,Se={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=F-P/2?this.face=ye:this.lat0<=-(F-P/2)?this.face=_e:Math.abs(this.long0)<=P?this.face=pe:Math.abs(this.long0)<=F+P?this.face=0<this.long0?fe:me:this.face=ge,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p={x:0,y:0},f={value:0};return t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,this.face===ye?(r=F-e,n=P<=i&&i<=F+P?(f.value=ve,i-F):F+P<i||i<=-(F+P)?(f.value=be,0<i?i-T:i+T):-(F+P)<i&&i<=-P?(f.value=je,i+F):(f.value=xe,i)):this.face===_e?(r=F+e,n=P<=i&&i<=F+P?(f.value=ve,F-i):i<P&&-P<=i?(f.value=be,-i):i<-P&&-(F+P)<=i?(f.value=je,-i-F):(f.value=xe,0<i?T-i:-i-T)):(this.face===fe?i=j(i,+F):this.face===ge?i=j(i,+T):this.face===me&&(i=j(i,-F)),h=Math.sin(e),c=Math.cos(e),d=Math.sin(i),a=c*Math.cos(i),l=c*d,u=h,this.face===pe?n=y(r=Math.acos(a),u,l,f):this.face===fe?n=y(r=Math.acos(l),u,-a,f):this.face===ge?n=y(r=Math.acos(-a),u,-l,f):this.face===me?n=y(r=Math.acos(-l),u,a,f):(r=n=0,f.value=ve)),s=Math.atan(12/T*(n+Math.acos(Math.sin(n)*Math.cos(P))-F)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(n))))),f.value===be?s+=F:f.value===je?s+=T:f.value===xe&&(s+=1.5*T),p.x=o*Math.cos(s),p.y=o*Math.sin(s),p.x=p.x*this.a+this.x0,p.y=p.y*this.a+this.y0,t.x=p.x,t.y=p.y,t},inverse:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m={lam:0,phi:0},y={value:0};return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),0<=t.x&&t.x>=Math.abs(t.y)?y.value=ve:0<=t.y&&t.y>=Math.abs(t.x)?(y.value=be,e-=F):t.x<0&&-t.x>=Math.abs(t.y)?(y.value=je,e=e<0?e+T:e-T):(y.value=xe,e+=F),c=T/12*Math.tan(e),o=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),s=Math.atan(o),(a=1-(n=Math.cos(e))*n*(r=Math.tan(i))*r*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:1<a&&(a=1),this.face===ye?(l=Math.acos(a),m.phi=F-l,y.value===ve?m.lam=s+F:y.value===be?m.lam=s<0?s+T:s-T:y.value===je?m.lam=s-F:m.lam=s):this.face===_e?(l=Math.acos(a),m.phi=l-F,y.value===ve?m.lam=F-s:y.value===be?m.lam=-s:y.value===je?m.lam=-s-F:m.lam=s<0?-s-T:T-s):(c=(u=a)*u,d=1<=(c+=(h=1<=c?0:Math.sqrt(1-c)*Math.sin(s))*h)?0:Math.sqrt(1-c),y.value===be?(c=d,d=-h,h=c):y.value===je?(d=-d,h=-h):y.value===xe&&(c=d,d=h,h=-c),this.face===fe?(c=u,u=-d,d=c):this.face===ge?(u=-u,d=-d):this.face===me&&(c=u,u=d,d=-c),m.phi=Math.acos(-h)-F,m.lam=Math.atan2(d,u),this.face===fe?m.lam=j(m.lam,-F):this.face===ge?m.lam=j(m.lam,-T):this.face===me&&(m.lam=j(m.lam,+F))),0!==this.es&&(p=m.phi<0?1:0,f=Math.tan(m.phi),g=this.b/Math.sqrt(f*f+this.one_minus_f_squared),m.phi=Math.atan(Math.sqrt(this.a*this.a-g*g)/(this.one_minus_f*g)),p&&(m.phi=-m.phi)),m.lam+=this.long0,t.x=m.lam,t.y=m.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},we=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Pe=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ee=w/5,Te=1/Ee,Oe={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=X(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(i*Ee);n<0?n=0:18<=n&&(n=17);var r={x:Gt(we[n],i=w*(i-Te*n))*e,y:Gt(Pe[n],i)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*.8487+this.x0,r.y=r.y*this.a*1.3523+this.y0,r},inverse:function(t){var n={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(1<=n.y)n.x/=we[18][0],n.y=t.y<0?-F:F;else{var e=Math.floor(18*n.y);for(e<0?e=0:18<=e&&(e=17);;)if(Pe[e][0]>n.y)--e;else{if(!(Pe[e+1][0]<=n.y))break;++e}var r=Pe[e],i=function(t,e,i,n){for(var r=e;n;--n){var o=t(r);if(r-=o,Math.abs(o)<i)break}return r}(function(t){return(Gt(r,t)-n.y)/(i=t,(e=r)[1]+i*(2*e[2]+3*i*e[3]));var e,i},i=5*(n.y-r[0])/(Pe[e+1][0]-r[0]),U,100);n.x/=Gt(we[e],i),n.y=(5*e+i)*S,t.y<0&&(n.y=-n.y)}return n.x=X(n.x+this.long0),n},names:["Robinson","robin"]},Ce={init:function(){this.name="geocent"},forward:function(t){return s(t,this.es,this.a)},inverse:function(t){return a(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};return n.defaultDatum="WGS84",n.Proj=M,n.WGS84=new n.Proj("WGS84"),n.Point=m,n.toPoint=lt,n.defs=o,n.transform=u,n.mgrs=vt,n.version="2.6.2",(Ut=n).Proj.projections.add(Bt),Ut.Proj.projections.add(Wt),Ut.Proj.projections.add(Vt),Ut.Proj.projections.add(Ht),Ut.Proj.projections.add(Xt),Ut.Proj.projections.add(qt),Ut.Proj.projections.add(Kt),Ut.Proj.projections.add(Zt),Ut.Proj.projections.add($t),Ut.Proj.projections.add(Qt),Ut.Proj.projections.add(Jt),Ut.Proj.projections.add(te),Ut.Proj.projections.add(ee),Ut.Proj.projections.add(ie),Ut.Proj.projections.add(ne),Ut.Proj.projections.add(re),Ut.Proj.projections.add(oe),Ut.Proj.projections.add(se),Ut.Proj.projections.add(ae),Ut.Proj.projections.add(le),Ut.Proj.projections.add(ue),Ut.Proj.projections.add(he),Ut.Proj.projections.add(ce),Ut.Proj.projections.add(de),Ut.Proj.projections.add(Se),Ut.Proj.projections.add(Oe),Ut.Proj.projections.add(Ce),n}),function(v,b,n,y){"use strict";var j="INPUT ERROR ON LINE ";function o(t){return t=+t.toString().replace(/\,/gi,"."),isNaN(t)?0:t}function e(){return y.utils.newDeferred.apply(this,arguments)}function _(t){return 0<=t?Math.floor((t+180)/6)+1:Math.floor(t/6)+31}function a(t){return 0<=t?"n":"s"}function r(t){var e;switch(t){case"m":e=1;break;case"km":e=1e3;break;case"us-ft":e=.304800609601219;break;default:e=1e3}return e}function i(t,e){return o(t)*r(e)}v.widget("twcc.converterSet",{options:{units:{dms:{D:"°",M:"'",S:"''"},dd:{x:{DD:"°E"},y:{DD:"°N"}},cartesian:{XY:{m:"m",km:"km","us-ft":"ft"},CONVERGENCE:"°"}},labels:{spherical:{x:"Lng = ",y:"Lat = ",convergence:"Conv. = "},cartesian:{x:"X = ",y:"Y = ",z:"Zone = ",h:"Hemisphere = ",convergence:"Conv. = "},csv:{csv:"CSV : ",l:"Format : "}},options:{x:{E:"East",W:"West"},y:{N:"North",S:"South"},o:{_DMS:"Deg. min. sec.",_DM:"Deg. min.",_DD:"Decimal deg."},h:{n:"North",s:"South"},u:{_M:"Meters",_KM:"Kilometers",_F:"Feet"}},value:{x:0,y:0},wgs84:[],defaultWgs84:[{x:0,y:0}],selections:{},definitions:{},url:"",$containers:[],masterLoadingToggleSwitch:!1,csv:!1},_create:function(){var t,e=this;if(this._bindEvents(),this._historyManager=n.getInstance(y),t=this._historyManager.getCurrentValue(),!this.options.wgs84)if(t){var i=/UD\d+/gi;if(1<t.wgs84.length)this.options.wgs84=t.wgs84,e.options.csv=!0;else{if("array"!==v.type(t.wgs84))throw"Wrong data type";this.options.wgs84=t.wgs84}this.options.selections.source=i.test(t.sc)?"WGS84":t.sc,this.options.selections.destination=i.test(t.dc)?"WGS84":t.dc}else this.options.wgs84=this.options.defaultWgs84;this.options.$containers=this.element.find(".converter-container"),this.options.$containers.each(function(t){v(this).converter({units:e.options.units,labels:e.options.labels,options:e.options.options,csv:e.options.csv,target:t?"dest":"source",selection:e.options.selections[t?"destination":"source"],value:e.options.value,wgs84:e.options.wgs84})}),this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this._reload().progress(function(t){e._trigger(".notify",null,t)}).done(function(){e._reloadSucceeded.apply(e,arguments),e._trigger(".done",null,{wgs84:e.wgs84(),csv:e.csv(),selections:e.options.selections}),e.setConvergence()}).fail(function(){e._reloadFailed.apply(e,arguments)})},_bindEvents:function(){var r=this;this.element.on("converter.transform",function(t,e){r.transform(e)}),this.element.on("converter.source.wgs84_changed converterset.done ",function(t,e){var i,n={wgs84:e.wgs84,convergenceInDegrees:r._convergence(),srsCode:r._selection(),magneticDeclinationInDegrees:(i=e.wgs84,y.utils.getWMM()(i[0].y,i[0].x).dec)};r._addToHistory(n),r._triggerWgs84Changed(t,n)}),this.element.on("converter.source.selection_changed converter.dest.selection_changed ",function(t,e){var i={wgs84:e.wgs84,srsCode:r._selection()};r._addToHistory(i),r._triggerConvergenceChange()}),this.element.on("converter.source.convergence_changed converter.dest.convergence_changed ",function(){r._triggerConvergenceChange()}),this.element.find(".history").click(function(){v(this).hasClass("next")?r._historyManager.moveToNext():r._historyManager.moveToPrevious(),r._restoreFromHistory()})},_triggerWgs84Changed:function(t,e){this._trigger(".wgs84_changed",t,e)},_triggerConvergenceChange:function(){this._trigger(".convergence_changed",null,{convergenceInDegrees:this._convergence()})},_reloadSucceeded:function(){this._loadDefinitionsObject(),this.options.masterLoadingToggleSwitch=!1,this._toggleLoading()},_reloadFailed:function(t){this._trigger(".fail",null,t)},_reload:function(){var t=this,n=e("Reload");return this._toggleLoading(!0),this._loadDefinitions().always(function(){t._toggleLoading(!1)}).done(function(){var i={};t.options.definitions.WGS84&&(t.options.definitions={"*World":t.options.definitions}),v.each(t.options.definitions,function(t,e){v.extend(i,e)}),n.resolve()}).fail(function(t,e){n.reject(e)}),n.promise()},_loadDefinitions:function(){var n=this,r=e("Load definitions");return"object"!==v.type(this.options.definitions)?r.reject("Wrong definitions type"):v.isEmptyObject(this.options.definitions)?v.ajax({url:this.options.url,data:{u:"u"},type:"POST",cache:!1,dataType:"json"}).done(function(t,e,i){void 0!==t.error?r.reject("Server Error",[i,e,t]):(n.options.definitions=t,r.resolve())}).fail(function(t,e,i){r.reject("Server Error",arguments)}):r.resolve(),r.promise()},_loadDefinitionsObject:function(){this._pushPullAll("loadDefinitionsObject",this.options.definitions)},_toggleLoading:function(t){t=this.options.masterLoadingToggleSwitch||!!t,this._pushPullAll("toggleLoading",t)},_addToHistory:function(t){this._historyManager.isEnabled()&&this._historyManager.add({wgs84:t.wgs84,sc:t.srsCode.source,dc:t.srsCode.destination})},_restoreFromHistory:function(){var e=this,i=this._historyManager.getCurrentValue();this._underTheRadar(function(){var t=1<i.wgs84.length;e.csv()!==t&&e.csv(t),e.transform(i),e.pushPullSource("selection",i.sc),e.pushPullDestination("selection",i.dc)})},_underTheRadar:function(t){if("function"!==v.type(t))throw"Invalid function";this._historyManager.toggle(!1),t(),this._historyManager.toggle(!0)},_pushPullWithCriterion:function(t,e,i,n){var r=null,o=this;return this.options.$containers.each(function(){v(this).converter("option",i)===n&&(r=o._pushPullOne(t,e,v(this)))}),r},_pushPullOne:function(t,e,i){var n=void 0===e?i.converter(t):i.converter(t,e);return this.options.hasOwnProperty(t)&&(this.options[t]=n),n},pushPullSource:function(t,e){return this._pushPullWithCriterion(t,e,"target","source")},pushPullDestination:function(t,e){return this._pushPullWithCriterion(t,e,"target","dest")},_pushPullAll:function(t,e){var i=this;return this.options.$containers.each(function(){i._pushPullOne(t,e,v(this))}),this.options[t]},_pullAll:function(t){return{source:this.pushPullSource(t),destination:this.pushPullDestination(t)}},wgs84:function(t){return this._pushPullAll("wgs84",t)},toggle:function(t){return this._pushPullAll("toggle",t)},_getFirstWgs84:function(){var t=null,e=this.wgs84();return v.each(e,function(){return!!this.error||(t=this,!1)}),t||{x:0,y:0}},_convergence:function(){return this._pullAll("convergence")},_selection:function(){return this.options.selections=this._pullAll("selection"),this.options.selections},setConvergence:function(){this._pushPullAll("setConvergence")},readOnly:function(){return this.options.readOnly},csv:function(t){var e;return t!=this.options.csv&&void 0!==t&&(t||(e=[this._getFirstWgs84()],JSON.stringify(e[0])===JSON.stringify(this.wgs84()[0])?this.wgs84(e):this.transform({wgs84:e})),this._trigger(".csv_changed",null,{csv:t})),this._pushPullAll("csv",t)},unloadCRS:function(t){this._pushPullAll("unloadCRS",t)},removeEmptyOptgroups:function(){this._pushPullAll("removeEmptyOptgroups")},mergeDefinitions:function(t){var e=this,i=new v.Deferred;return this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this.options.definitions="object"!==v.type(this.options.definitions)?{}:this.options.definitions,v.extend(!0,this.options.definitions,t),this._reload().progress(function(){i.notify("Reloading")}).done(function(){e._reloadSucceeded.apply(e,arguments),i.resolve()}).fail(function(){e._reloadFailed.apply(e,arguments),i.reject.apply(null,arguments)}),i.promise()},transform:function(t){var e,i=t.hasOwnProperty("wgs84");if(!(i&&"array"===v.type(t.wgs84)||t.hasOwnProperty("target")))throw"Wrong data format";i?this._pushPullAll("transform",t):"source"===t.target?(e=this.pushPullSource("transform",{input:null}),this.pushPullDestination("transform",{wgs84:e})):(e=this.pushPullDestination("transform",{input:null}),this.pushPullSource("transform",{wgs84:e}))},_setOption:function(t,e){return this._superApply(arguments)},_destroy:function(){return this._toggleLoading(!0),this._pushPullAll("destroy"),this._super()}}),v.widget("twcc.converter",{options:{readOnly:!1,wrapper:{fieldSet:["<div>"],title:["<h3>"],info:["<a>",{name:"info",href:"#"}]},projections:{},units:{},labels:{},options:{},angleUnit:"dd",lengthUnit:"m",convergence:null,hint:"",wgs84:[{x:0,y:0}],value:{x:0,y:0},selection:null,mapping:{aea:"cartesian",aeqd:"cartesian",cass:"cartesian",cea:"cartesian",csv:"csv",eqc:"cartesian",eqdc:"cartesian",equi:"cartesian",gauss:"cartesian",geocent:"cartesian",gnom:"cartesian",gstmerc:"cartesian",laea:"cartesian",lcc:"cartesian",longlat:"spherical",merc:"cartesian",mill:"cartesian",moll:"cartesian",nzmg:"cartesian",omerc:"cartesian",ortho:"cartesian",poly:"cartesian",sinu:"cartesian",somerc:"cartesian",stere:"cartesian",sterea:"cartesian",tmerc:"cartesian",utm:"utm",vandg:"spherical",connector:"connector"},$select:null,$container:null,csv:!1},_widget:void 0,_create:function(){v.extend(this.options,{$select:this.element.find("select.crs-list"),$container:this.element.find(".container")}),this._bindEvents(),this._unload()},_triggerTransform:function(t){t.preventDefault(),this._trigger(".transform",t,{target:this.options.target})},_bindEvents:function(){var i=this;this.options.$select.on("change",function(){i.selection()}),this.element.on("angleswitchgeofield.update_display",function(t,e){i.options.angleUnit=e.value,i.value(),i.updateContainer()}),this.element.find(".convert-button").click(function(t){i._triggerTransform(t)}),this.element.on("keyup","input, select",function(t){var e;((e=t).keyCode?e.keyCode:e.which)==y.constants.keyboard.RETURN&&i._triggerTransform(t)})},_getFieldSetUnit:function(t){var e=this._getWidgetPrefix(t),i=this._getFieldSetUnitName(e);if(i)return this.options.units[i];var n=e.match(/([A-Z]?[a-z]*)/g);return(i=this._getFieldSetUnitName(n[1]))?this.options.units[i]:void 0},_getFieldSetUnitName:function(t){var e;switch(t){case"utm":e="cartesian";break;case"Dm":e="dms";break;case"csv":case"connector":break;default:e=t.toLowerCase()}if(e&&this.options.units.hasOwnProperty(e))return e},_getFieldSetLabel:function(t){var e=this._getWidgetPrefix(t),i=this._getFieldSetLabelName(e);if(i)return this.options.labels[i];var n=e.match(/([A-Z]?[a-z]*)/g);return(i=this._getFieldSetLabelName(n[0]))?this.options.labels[i]:void 0},_getFieldSetLabelName:function(t){var e;switch(t){case"utm":e="cartesian";break;case"connector":break;default:e=t.toLowerCase()}if(e&&this.options.labels.hasOwnProperty(e))return e},_getWidgetMidfix:function(t){var e="";return"spherical"===t&&(e=(e=this.options.angleUnit).charAt(0).toUpperCase()+e.substr(1).toLowerCase()),e},_getWidgetPrefix:function(t){var e;return t=this.options.projections[this.options.selection].isConnector&&"csv"!==t?"connector":t,(e=this.options.mapping.hasOwnProperty(t)?this.options.mapping[t]:(console.error("Projection not found: "+t),"cartesian"))+this._getWidgetMidfix(e)},_getWidgetName:function(t){return this._getWidgetPrefix(t)+"FieldSet"},_unload:function(){this.element.find("select.crs-list, .container").empty(),this.projections={}},toggleLoading:function(t){this.element.find(".container").toggle(!t),this.element.find(".loading").toggle(!!t)},removeEmptyOptgroups:function(){this.options.$select.find("optgroup:empty").remove()},loadDefinitionsObject:function(t){var n,r=this,e=this.options.$select;if(this.options.definitions=t,this.removeEmptyOptgroups(),n=!1,v.each(this.options.definitions,function(i,t){v.each(t,function(t,e){r.options.$select.has('optgroup[label="'+i+'"] option[value="'+t+'"]').length||(y.utils.addOptionToSelect(i,t,r.options.$select,e.def),n=!0)})}),n){e.sortGrpsNOptionsByText();try{this.selection(this.options.selection||e.find("option:first").val())}catch(t){this.selection(e.find("option:first").val())}}},unloadCRS:function(i){var t,n=this;this.selection()===i&&(t=this._widget.options.srsCode,this.selection(t)),this.options.$select.find('option[value="'+i.toString()+'"]').remove(),b.defs(i,void 0),delete this.options.projections[i],v.each(this.options.definitions,function(t,e){return!e.hasOwnProperty(i)||(delete n.options.definitions[t][i],!1)}),this.removeEmptyOptgroups()},updateContainer:function(){var t,e,i,n,r,o,s,a,l,u,h,c,d=this,p=this.selection();this.options.value=this.options.csv||"array"!==v.type(this.options.value)?this.options.value:this.options.value[0],this.options.value=this.options.csv&&"array"!==v.type(this.options.value)?[this.options.value]:this.options.value,p&&(this.options.projections.hasOwnProperty(p)||this._registerProjection(p),n=(i=this._getProjection(p)).projName,r=this._getFieldSetUnit(n)||"",o=this._getFieldSetLabel(n)||"",s={srsCode:p,target:this.options.target,convergence:this.options.convergence,wgs84:this.options.wgs84,value:this.options.value,units:r,labels:o,lengthUnit:this.options.lengthUnit,options:this.options.options,readOnly:this.options.readOnly},a=i.title||p,l=this._getWidgetName(this.options.csv?"csv":i.projName),u=v.apply(null,this.options.wrapper.fieldSet),this.options.$container.empty(),(t=v.apply(null,this.options.wrapper.title)).append(a),(e=v.apply(null,this.options.wrapper.info)).click(function(t){d._trigger(".info",t,{srsCode:p,definitionString:i.defData})}),e.text(" [?]"),t.append(e),u.append(t),"csvFieldSet"==l&&(r=r.D?this.options.units.dd:r,h=(("utm"===n?o.h+","+o.z+",":"")+(o.x?o.x+(r.x?"("+r.x.DD+")":"("+r.XY.m+")"):"")+(o.y?","+o.y+(r.y?"("+r.y.DD+")":"("+r.XY.m+")"):"")).replace(/[\s]*=[\s]*/gi,""),v.extend(s,{originalProjection:i.isConnector?"connector":n,hint:h,units:null,labels:this.options.labels.csv})),this._widget=u[l](s).data("twcc"+((c=l).charAt(0).toUpperCase()+c.substring(1))),this.options.$container.append(u))},_registerProjection:function(t){var e,i,n,r,o,s,a;b.defs(t)||(i=0<=t.indexOf("Connector"),o=t,s=this.options.definitions,a="",v.each(s,function(t,e){return!e.hasOwnProperty(o)||(a=e[o].def,!1)}),r={defData:n=a,isConnector:i},b.defs(t,n),v.extend(b.defs(t),r)),e=v.extend({},b.defs(t)),this._setProjection(t,e)},_getProjection:function(t){if(!this.options.projections.hasOwnProperty(t))throw"Unknown srsCode";return this.options.projections[t]},_setProjection:function(t,e){this.options.projections[t]=e},selection:function(t){var e,i,n=this.options.$select,r=!1,o=this.options.selection;if(void 0!==t){this.options.selection=t;try{n.val(this.options.selection)}catch(t){}r=!0}else n.val()&&n.val()!=this.options.selection&&(this.options.selection=n.val(),r=!0);return r&&(this.updateContainer(),e=this.options.selection,i=this.wgs84(),this.transform({wgs84:i}),this.setConvergence(),o!==e&&this._trigger("."+this.options.target+".selection_changed",null,{wgs84:i,srsCode:e})),this.options.selection},projection:function(){return this._getProjection(this.selection())},_pushPull:function(t,e){var i;return this._widget?(i=this._widget[t](e),this.options.hasOwnProperty(t)&&(this.options[t]=i),i):null},value:function(t){if(void 0!==t&&(!this.options.csv&&"object"!==v.type(t)||this.options.csv&&"array"!==v.type(t)))throw"Invalid type";return this._pushPull("value",t)},wgs84:function(t){return void 0!==t&&JSON.stringify(this.options.wgs84)!==JSON.stringify(t)&&(this._pushPull("wgs84",t),this._trigger("."+this.options.target+".wgs84_changed",null,{wgs84:t}),this.setConvergence()),this.options.wgs84},convergence:function(t){var e;return this._pushPull("convergence",t),void 0!==t&&(e=this.wgs84(),this._trigger("."+this.options.target+".convergence_changed",null,{wgs84:e})),this.options.convergence},setConvergence:function(){var t,e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m;this._widget&&"null"!==v.type(this._widget.convergence())&&(e=this.wgs84()[0],i=new b.Proj(this.projection().defData),n=!this._widget.zone&&i.long0||null,r=i.a,o=i.b,s=e,a=n||y.utils.degToRad(6*_(s.x)-183),l=y.utils.degToRad(s.y),u=y.utils.degToRad(s.x),c=(h=(r-o)/r)*Math.pow(Math.cos(l),2)/(1-h),d=u-a,p=Math.sin(l),f=(1+3*c+2*Math.pow(c,2))*Math.sin(l)*Math.pow(Math.cos(l),2)/3,g=(2-Math.pow(Math.tan(l),2))*Math.sin(l)*Math.pow(Math.cos(l),4)/15,m=d*p+Math.pow(d,3)*f+Math.pow(d,5)*g,m*=-1,t=y.utils.radToDeg(m),this.convergence(t))},csv:function(t){return void 0!==t&&(this.value(),this.options.csv=!!t,this.updateContainer()),this.options.csv},hint:function(t){return this._pushPull("hint",t)},toggle:function(t){return this._pushPull("toggle",t)},readOnly:function(){return this.options.readOnly},_formatCoordinates:function(t){if(v.inArray(v.type(t),["array","object"])<0)throw"Wrong data type";return"array"===v.type(t)?t:[t]},_setupInputProjection:function(t,e,i,n){var r=i?{z:_(e.x),h:a(e.y)}:n,o=t.defData;return o=(o=o.replace(/\+zone=[^\s]+/gi,"+zone="+r.z)).replace("+south",""),o+="s"===r.h?" +south":"",new b.Proj(o)},_isValidPoint:function(t,e){var i=1;return i&="object"===v.type(t),i&=t.hasOwnProperty("x"),e?i&=t.x.indexOf(j)<0:(i&=t.hasOwnProperty("y"),i&="number"===v.type(t.x)&&!isNaN(t.x),i&="number"===v.type(t.y)&&!isNaN(t.y)),!!i},_getConnector:function(){var t=this.selection();return window.hasOwnProperty(t)||v.ajax({url:"/js/connectors/"+t+".js",async:!1,cache:!0,dataType:"script"}),window[t].getInstance(y.context)},transform:function(t){var e,i,c,d,p=this,f=[],g=[],m=t.hasOwnProperty("wgs84"),y=this.value(),n=b.WGS84,_=this.projection(),r=-1<_.defData.indexOf("+proj=utm"),o={type:"pivot",getProjection:function(){return v.extend({isConnector:n.isConnector},new b.Proj(n.defData))}},s={type:"input",getProjection:function(){return r?p._setupInputProjection.apply(p,arguments):v.extend({isConnector:_.isConnector},new b.Proj(_.defData))}};if(!m&&!t.hasOwnProperty("input"))throw"Wrong data format";this.toggleLoading(!0);var a=m?t.wgs84:t.input;return m&&a&&this.wgs84(a),m?(e=a||this.wgs84(),d={A:o,B:s}):(e=a||y,d={A:s,B:o},c=this._widget.options.originalProjection),i=this._formatCoordinates(e),v.each(i,function(t,e){var i,n={},r=p.wgs84()[t],o="array"===v.type(y)?y[t]:y,s=d.A.getProjection(_,r,m,o),a=d.B.getProjection(_,r,m,o),l="connector"===c||!m&&s.isConnector,u=m&&a.isConnector,h=l||u;!p._isValidPoint(e,l)||m&&r.error?(g.push({x:0,y:0,error:!0}),f.push(j+(t+1))):(h&&(i=p._getConnector()),h&&m?n[d.B.type]=i.forward(e):(h&&(e=i.inverse(e)),n[d.B.type]=b(s,a,v.extend({},e))),n[d.A.type]=v.extend({},e),g.push({x:n.pivot.x,y:n.pivot.y}),f.push({x:n.input.x,y:n.input.y}))}),this.csv()||(f=f[0]),m?this.value(f):this.wgs84(g),this.toggleLoading(!1),this.wgs84()},_setOption:function(t,e){return this._superApply(arguments)},_destroy:function(){return this._unload(),this._super()}}),v.widget("twcc.fieldSet",{options:{srsCode:null,value:{},units:{},target:null,wrapper:{set:["<div>",{class:"table"}],geoField:["<div>",{class:"row"}],geoCaption:["<div>",{class:"caption"}]},readOnly:!1,geoFields:{},geoFieldsIndex:0,wgs84:null},_create:function(){var t=v.apply(null,this.options.wrapper.set),e=this._getGeoFieldsOptions();this._setDefaultsGeoFieldsOptions(e),this._buildGeoFields(t,e),this._setFieldsHandlers(),this.element.append(t)},_setFieldsHandlers:function(){},_setDefaultsGeoFieldsOptions:function(n){var r=this;v.each(n,function(t,e){var i={name:r.options.srsCode+"_"+r.options.target,readOnly:r.options.readOnly,unit:r.options.units,target:r.options.target,value:r.options.value[e.options.axis]};n[t].options=v.extend(i,n[t].options)})},_buildGeoField:function(t,e,i,n){var r=this.options.geoFieldsIndex++,o=0<=i.indexOf("Switch")||0<=i.indexOf("connector")?v.apply(null,this.options.wrapper.geoCaption):v.apply(null,this.options.wrapper.geoField);this.options.geoFields[r]=o[i](n),t.append(o)},_buildGeoFields:function(i,t){var n=this;v.each(t,function(t,e){n._buildGeoField(i,t,e.type,e.options)})},_getGeoFieldsOptions:function(){return{}},_getConvergenceIcon:function(){return'<img src="'+y.system.dirWsImages+"GN_"+this.options.target+'.png" alt="">'},convergence:function(){return null},hint:function(){return null},wgs84:function(t){return void 0===t?this._getWgs84():this._setWgs84(t)},_getWgs84:function(){return this.options.wgs84},_setWgs84:function(t){return this.options.wgs84=t,this.options.wgs84},value:function(t){return this.options.value=void 0===t?this._getValue():this._setValue(t),this._setToStringMethod(),this.options.value},_getValue:function(){return this.options.value},_setValue:function(t){this.options.value=t},_setToStringMethod:function(){var t=this;this.options.value.toString=function(){return t._getStringValue()}},_getStringValue:function(){return""},toggle:function(t){return t=void 0===t?this.options.readOnly:!!t,this.options.readOnly=this._toggle(t),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(t){return!t},_setOption:function(t,e){return this._superApply(arguments)},_destroy:function(){return this.element.empty(),this._super()}}),v.widget("twcc.connectorFieldSet",v.twcc.fieldSet,{options:{options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"connectorGeoField",options:{axis:"x"}}]},_getValue:function(){return{x:this.options.geoFields[0].connectorGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[0].connectorGeoField("value",t.x)}},_toggle:function(t){return this.options.geoFields[0].connectorGeoField("toggle",t)},_getStringValue:function(){return this.options.geoFields[0].connectorGeoField("value")}}),v.widget("twcc.csvFieldSet",v.twcc.fieldSet,{options:{labels:{},units:{},options:{},geoFields:{},value:[],hint:"",wgs84:[],originalProjection:null},_getGeoFieldsOptions:function(){return[{type:"csvGeoField",options:{value:this._toString(this.options.value),label:this.options.labels.csv}},{type:"labelGeoField",options:{value:this.options.hint,label:this.options.labels.l}}]},_getValue:function(){return this._fromString(this.options.geoFields[0].csvGeoField("value"))},_setValue:function(t){return this._fromString(this.options.geoFields[0].csvGeoField("value",this._toString(t)))},_fromString:function(t){var n=t.split("\n"),r=this;return v.each(n,function(t,e){var i=e.split(",");switch(r.options.originalProjection){case"utm":n[t]={h:i[0],z:+i[1],x:+i[2],y:+i[3]};break;case"connector":n[t]={x:i[0],y:i[1]};break;default:n[t]={x:+i[0],y:+i[1]}}}),n},_toString:function(t){var o=[],s=this;if("array"!==v.type(t))throw"Invalid type";return v.each(t,function(t,e){var i,n,r=s.wgs84()[t];r.error?o.push(e.toString()):"utm"==s.options.originalProjection?(i=e.h||a(r.y),n=e.z||_(r.x),o.push(i+","+n+","+e.x+","+e.y)):o.push(e.x+","+e.y)}),o.join("\n")},originalProjection:function(t){if(void 0===t)return this.options.originalProjection;this.options.originalProjection=t},hint:function(t){if(void 0===t)return this.options.hint=this.options.geoFields[1].labelGeoField("value"),this.options.hint;this.options.hint=t,this.options.geoFields[1].labelGeoField("value",this.options.hint)},_toggle:function(t){return this.options.geoFields[0].csvGeoField("toggle",t),this.options.geoFields[1].labelGeoField("toggle",t)},_getStringValue:function(){return this.options.hint+"\n"+this.options.geoFields[0].csvGeoField("value")}}),v.widget("twcc.utmFieldSet",v.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0,wgs84:[]},_getGeoFieldsOptions:function(){return[{type:"hemisphereGeoField",options:{label:this.options.labels.h,options:this.options.options.h,axis:"h"}},{type:"zoneGeoField",options:{label:this.options.labels.z,options:this.options.options.z,axis:"z"}},{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var i=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(t,e){i.options.lengthUnit=i.unit(e.value)})},_getValue:function(){return{h:this.hemisphere(),z:this.zone(),x:this.options.geoFields[2].xyGeoField("value"),y:this.options.geoFields[3].xyGeoField("value")}},_setValue:function(t){var e=this._getWgs84()[0];return t.h&&t.z||v.extend(t,{y:Math.abs(t.y),h:a(e.y),z:_(e.x)}),{h:this.hemisphere(t.h),z:this.zone(t.z),x:this.options.geoFields[2].xyGeoField("value",t.x),y:this.options.geoFields[3].xyGeoField("value",t.y)}},unit:function(t){return void 0===t?this.options.lengthUnit=this.options.geoFields[2].xyGeoField("unit"):(this.options.geoFields[2].xyGeoField("unit",t),this.options.geoFields[3].xyGeoField("unit",t),this.options.lengthUnit=this.options.geoFields[5].lengthSwitchGeoField("value",t)),this.options.lengthUnit},convergence:function(t){return this.options.convergence=void 0===t?this.options.geoFields[4].convergenceGeoField("value"):this.options.geoFields[4].convergenceGeoField("value",t),this.options.convergence},zone:function(t){return this.options.value.z=void 0===t?this.options.geoFields[1].zoneGeoField("value"):this.options.geoFields[1].zoneGeoField("value",t),this.options.value.z},hemisphere:function(t){return this.options.value.h=void 0===t?this.options.geoFields[0].hemisphereGeoField("value"):this.options.geoFields[0].hemisphereGeoField("value",t),this.options.value.h},_toggle:function(t){return this.options.geoFields[0].hemisphereGeoField("toggle",t),this.options.geoFields[1].zoneGeoField("toggle",t),this.options.geoFields[2].xyGeoField("toggle",t),this.options.geoFields[3].xyGeoField("toggle",t),this.options.geoFields[5].lengthSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[2].xyGeoField("getStringValue")+", "+t[3].xyGeoField("getStringValue")+" "+t[1].zoneGeoField("value")+t[0].hemisphereGeoField("value")}}),v.widget("twcc.cartesianFieldSet",v.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0},_getGeoFieldsOptions:function(){return[{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var i=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(t,e){i.options.lengthUnit=i.unit(e.value)})},_getValue:function(){return{x:this.options.geoFields[0].xyGeoField("value"),y:this.options.geoFields[1].xyGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[0].xyGeoField("value",t.x),y:this.options.geoFields[1].xyGeoField("value",t.y)}},unit:function(t){return void 0===t?this.options.lengthUnit=this.options.geoFields[0].xyGeoField("unit"):(this.options.geoFields[0].xyGeoField("unit",t),this.options.geoFields[1].xyGeoField("unit",t),this.options.lengthUnit=this.options.geoFields[3].lengthSwitchGeoField("value",t)),this.options.lengthUnit},convergence:function(t){return this.options.convergence=void 0===t?this.options.geoFields[2].convergenceGeoField("value"):this.options.geoFields[2].convergenceGeoField("value",t),this.options.convergence},_toggle:function(t){return this.options.geoFields[0].xyGeoField("toggle",t),this.options.geoFields[1].xyGeoField("toggle",t),this.options.geoFields[3].lengthSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].xyGeoField("getStringValue")+", "+t[1].xyGeoField("getStringValue")}}),v.widget("twcc.sphericalDdFieldSet",v.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"ddGeoField",options:{unit:this.options.units.y,label:this.options.labels.y,axis:"y"}},{type:"ddGeoField",options:{unit:this.options.units.x,label:this.options.labels.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dd",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].ddGeoField("value"),y:this.options.geoFields[0].ddGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[1].ddGeoField("value",t.x),y:this.options.geoFields[0].ddGeoField("value",t.y)}},_toggle:function(t){return this.options.geoFields[0].ddGeoField("toggle",t),this.options.geoFields[1].ddGeoField("toggle",t),this.options.geoFields[2].angleSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].ddGeoField("getStringValue")+", "+t[1].ddGeoField("getStringValue")}}),v.widget("twcc.sphericalDmFieldSet",v.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dm",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmGeoField("value"),y:this.options.geoFields[0].dmGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[1].dmGeoField("value",t.x),y:this.options.geoFields[0].dmGeoField("value",t.y)}},_toggle:function(t){return this.options.geoFields[0].dmGeoField("toggle",t),this.options.geoFields[1].dmGeoField("toggle",t),this.options.geoFields[2].angleSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].dmGeoField("getStringValue")+", "+t[1].dmGeoField("getStringValue")}}),v.widget("twcc.sphericalDmsFieldSet",v.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmsGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmsGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dms",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmsGeoField("value"),y:this.options.geoFields[0].dmsGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[1].dmsGeoField("value",t.x),y:this.options.geoFields[0].dmsGeoField("value",t.y)}},_toggle:function(t){return this.options.geoFields[0].dmsGeoField("toggle",t),this.options.geoFields[1].dmsGeoField("toggle",t),this.options.geoFields[2].angleSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].dmsGeoField("getStringValue")+", "+t[1].dmsGeoField("getStringValue")}}),v.widget("twcc.geoField",{options:{name:null,unit:null,label:null,readOnly:!1,lengthUnit:"m",glue:"_",wrapper:{field:["<span>"],fields:["<div>",{class:"cell fields"}],label:["<div>",{class:"cell label"}],options:["<div>",{class:"fields"}]},attributes:{},fields:{},icon:""},_create:function(){var n,t,r=this;v.each(this.options.attributes,function(t){var e={disabled:r.options.readOnly,readonly:r.options.readOnly};r.options.attributes[t]=v.extend(e,r.options.attributes[t])}),n=this._getEmptyFieldCell(),t=this._getFieldsOptions(),this._setDefaultsFieldsOptions(t),v.each(t,function(t,e){var i=r._buildField(t,e);r._setFieldHandlers(i),i.append(r._getFieldSetUnit(t)),i.append("&nbsp;"),n.append(i)}),this._appendLabelCell(),this.element.append(n)},_getFieldSetUnit:function(t){return this.options.unit[t]},_setFieldHandlers:function(){},_clean:function(t,e){return this._superClean(t,e)},_superClean:function(t,e){return isNaN(t)||null===t?"":y.math.round(t,e||0)},_buildField:function(t,e){return this.options.fields[t]=v.apply(null,this.options.wrapper.field).field(e),this.options.fields[t]},_appendLabelCell:function(){var t=this._getForId(),e=t?v("<label>",{for:t}).html(this.options.icon+this.options.label):this.options.icon+this.options.label,i=v.apply(null,this.options.wrapper.label).append(e);this.element.append(i)},_getForId:function(){},_getEmptyFieldCell:function(){return v.apply(null,this.options.wrapper.fields)},_getFieldsOptions:function(){return{}},_setDefaultsFieldsOptions:function(i){var n=this;v.each(i,function(t){var e={name:n.options.name+n.options.glue+t,attributes:n.options.attributes[t],value:n._clean(n.options.value)};i[t]=v.extend(e,i[t])})},value:function(t){return this.options.value=void 0===t?this._constraint(this._getRawValue()):this._setValue(this._clean(t)),this.options.value},toggle:function(t){return t=void 0===t?this.options.readOnly:!!t,this.options.readOnly=this._toggle(t),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(n){var r=this;return v.each(this.options.fields,function(t,e){var i=r._getFieldsOptions()[t];r._toggleField(e,n,i)}),!n},_toggleField:function(t,e){t.field("toggle",e)},_getRawValue:function(){return this.options.value},getStringValue:function(){return this.options.value},_constraint:function(t){return t},_setValue:function(t){this.options.value=t},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),v.widget("twcc.ddGeoField",v.twcc.geoField,{options:{value:0,attributes:{DD:{size:"20",class:"width_5"}}},_getFieldsOptions:function(){return{DD:{type:"text"}}},_getForId:function(){return this.options.fields.DD.field("id")},_getRawValue:function(){return y.math.parseFloat(this.options.fields.DD.field("value"))},getStringValue:function(){return this.options.value+this._getFieldSetUnit("DD")},_setValue:function(t){return this.options.fields.DD.field("value",t)},_constraint:function(t){var e="y"===this.options.axis?180*Math.atan(Math.sinh(Math.PI))/Math.PI:180,i=-e;return t=Math.max(t,i),t=Math.min(t,e)},_clean:function(t){return this._constraint(this._super(t,15))}}),v.widget("twcc.dmGeoField",v.twcc.ddGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"6",class:"width_3"}}},_buildField:function(t,e){return"option"===e.type?(this.options.fields[t]=v.apply(null,this.options.wrapper.field).optionField(e),this.options.fields[t]):this._superApply(arguments)},_getFieldsOptions:function(){var t=this._clean(this.options.value);return{C:{type:"option",value:t.C||"",options:this.options.options},D:{type:"text",value:this._superClean(t.D)},M:{type:"text",value:this._superClean(t.M,12)}}},_getForId:function(){return this.options.fields.D.field("id")},_getFieldSetUnit:function(t){return"C"!=t?this._superApply(arguments):""},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:y.math.parseFloat(this.options.fields.D.field("value")),M:y.math.parseFloat(this.options.fields.M.field("value"))}},value:function(t){var e,i,n,r;return void 0===t?this._clean((void 0!==(e=this._getObjectValue())&&(i=Math.abs(o(e.D)),i+=Math.abs(o(e.M))/60,n=0<=o(e.D)?1:-1,r=(n*="N"==e.C||"E"==e.C?1:-1)*i),r)):(t=this._clean(t),this.options.fields.C.optionField("value",t.C||""),this.options.fields.D.field("value",this._superClean(t.D)),this.options.fields.M.field("value",this._superClean(t.M,12))),this.options.value},getStringValue:function(){var t=this._getObjectValue();return t.D+this._getFieldSetUnit("D")+t.M+this._getFieldSetUnit("M")+t.C},_clean:function(t){return this.options.value=this._constraint(t),e=this.options.value,i=this.options.options,"number"!==v.type(+e)||isNaN(e)?(r=n=0,i&&(o=i.N?"N":"E")):(i&&(o=0<=e?i.N?"N":"E":i.S?"S":"W"),r=60*((e=Math.abs(e))-(n=Math.floor(e)))),{C:o,D:n.toString(),M:r.toString()};var e,i,n,r,o},_toggleField:function(t,e,i){return"option"===i.type?t.optionField("toggle",e):this._superApply(arguments)}}),v.widget("twcc.dmsGeoField",v.twcc.dmGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"4",class:"width_1"},S:{size:"6",class:"width_3"}}},_getFieldsOptions:function(){var t=this._clean(this.options.value);return{C:{type:"option",value:t.C||"",options:this.options.options},D:{type:"text",value:this._superClean(t.D)},M:{type:"text",value:this._superClean(t.M)},S:{type:"text",value:this._superClean(t.S,12)}}},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:y.math.parseFloat(this.options.fields.D.field("value")),M:y.math.parseFloat(this.options.fields.M.field("value")),S:y.math.parseFloat(this.options.fields.S.field("value"))}},value:function(t){var e,i,n,r;return void 0===t?this._clean((void 0!==(e=this._getObjectValue())&&(i=Math.abs(o(e.D)),i+=Math.abs(o(e.M))/60,i+=Math.abs(o(e.S))/3600,n=0<=o(e.D)?1:-1,r=(n*="N"==e.C||"E"==e.C?1:-1)*i),r)):(t=this._clean(t),this.options.fields.C.optionField("value",t.C||""),this.options.fields.D.field("value",this._superClean(t.D)),this.options.fields.M.field("value",this._superClean(t.M)),this.options.fields.S.field("value",this._superClean(t.S,12))),this.options.value},getStringValue:function(){var t=this._getObjectValue();return t.D+this._getFieldSetUnit("D")+t.M+this._getFieldSetUnit("M")+t.S+this._getFieldSetUnit("S")+t.C},_clean:function(t){return this.options.value=this._constraint(t),e=this.options.value,i=this.options.options,"number"!==v.type(+e)||isNaN(e)?(s=o=n=0,i&&(a=i.N?"N":"E")):(i&&(a=0<=e?i.N?"N":"E":i.S?"S":"W"),s=60*((r=60*((e=Math.abs(e))-(n=Math.floor(e))))-(o=Math.floor(r)))),{C:a,D:n.toString(),M:o.toString(),S:s.toString()};var e,i,n,r,o,s,a}}),v.widget("twcc.switchGeoField",v.twcc.geoField,{_clean:function(t){return this._constraint(t)},_setFieldHandlers:function(t){var e=this;t.find(":first-child").click(function(t){e._trigger(".update_display",t,{value:e.value()})})},_appendLabelCell:function(){},_getEmptyFieldCell:function(){return v.apply(null,this.options.wrapper.options)},_setDefaultsFieldsOptions:function(){},_getRawValue:function(){return v("input:radio:checked",this.element).val()},_setValue:function(t){return this.element.find('input:radio[value="'+t+'"]').prop("checked",!0),t},_getForId:function(t){return this.options.fields[t].field("id")},_getFieldSetUnit:function(t){var e=this._superApply(arguments),i=this._getForId(t);return v("<label>",{for:i}).append(e)}}),v.widget("twcc.angleSwitchGeoField",v.twcc.switchGeoField,{options:{value:"dd"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var t=this.options.name+"_DMS_DM_DD",e=this.options.value,i="dd"===e,n="dm"===e;return{_DMS:{name:t,type:"radio",value:"dms",attributes:{checked:!i&&!n}},_DM:{name:t,type:"radio",value:"dm",attributes:{checked:n}},_DD:{name:t,type:"radio",value:"dd",attributes:{checked:i}}}},_constraint:function(t){return v.inArray(t,["dms","dm","dd"])<0?"dms":t}}),v.widget("twcc.lengthSwitchGeoField",v.twcc.switchGeoField,{options:{value:"m"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var t=this.options.name+"_M_KM_F",e=this.options.value,i="km"===e,n="us-ft"===e;return{_M:{name:t,type:"radio",value:"m",attributes:{checked:!i&&!n}},_KM:{name:t,type:"radio",value:"km",attributes:{checked:i}},_F:{name:t,type:"radio",value:"us-ft",attributes:{checked:n}}}},_constraint:function(t){return v.inArray(t,["m","km","us-ft"])<0?"m":t}}),v.widget("twcc.xyGeoField",v.twcc.geoField,{options:{value:0,attributes:{XY:{size:"20",class:"width_4"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XY:{type:"text"}}},_getForId:function(){return this.options.fields.XY.field("id")},_getFieldSetUnit:function(){return this.options.unit.XY[this.options.lengthUnit]},_getRawValue:function(){return i(this.options.fields.XY.field("value"),this.options.lengthUnit)},getStringValue:function(){return this.options.fields.XY.field("value")+this.options.lengthUnit},_setValue:function(t){return i(this.options.fields.XY.field("value",t),this.options.lengthUnit)},_clean:function(t){return this._super((e=t,i=this.options.lengthUnit,o(e)/r(i)),"m"==this.options.lengthUnit?3:5);var e,i},unit:function(t){return void 0!==t&&(this.value(),this.options.lengthUnit=this._cleanUnit(t),this._update()),this.options.lengthUnit},_cleanUnit:function(t){return v.inArray(t,["m","km","us-ft"])<0?"m":t}}),v.widget("twcc.zoneGeoField",v.twcc.geoField,{options:{value:31,attributes:{Z:{size:"5",class:"width_2"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{Z:{type:"text"}}},_getForId:function(){return this.options.fields.Z.field("id")},_getRawValue:function(){return parseInt(this.options.fields.Z.field("value"))},_setValue:function(t){return this.options.fields.Z.field("value",t)},_constraint:function(t){return t=Math.max(t,0)},_clean:function(t){return this._constraint(this._super(t))}}),v.widget("twcc.hemisphereGeoField",v.twcc.geoField,{options:{value:"n",attributes:{E:{size:"1"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{E:{type:"option",options:this.options.options}}},_getForId:function(){return this.options.fields.E.optionField("id")},_getFieldSetUnit:function(){},_buildField:function(t,e){return this.options.fields[t]=v.apply(null,this.options.wrapper.field).optionField(e),this.options.fields[t]},_clean:function(t){return this._constraint(t||"n")},_getRawValue:function(){return this.options.fields.E.optionField("value")},_constraint:function(t){return v.inArray(t,["n","s"])<0?"n":t},_setValue:function(t){return this.options.fields.E.optionField("value",t)},_toggleField:function(t,e){return t.optionField("toggle",e)}}),v.widget("twcc.csvGeoField",v.twcc.geoField,{options:{value:"",attributes:{CSV:{rows:"5",wrap:"off"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CSV:{type:"textarea"}}},_getFieldSetUnit:function(){return""},_getForId:function(){return this.options.fields.CSV.textareaField("id")},_buildField:function(t,e){return this.options.fields[t]=v.apply(null,this.options.wrapper.field).textareaField(e),this.options.fields[t]},_clean:function(t){return this._constraint(t||"")},_getRawValue:function(){return this.options.fields.CSV.textareaField("value")},_setValue:function(t){return this.options.fields.CSV.textareaField("value",t)},_toggleField:function(t,e){return t.textareaField("toggle",e)}}),v.widget("twcc.convergenceGeoField",v.twcc.geoField,{options:{value:0,attributes:{CONVERGENCE:{size:"10",class:"width_4",readonly:!0}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CONVERGENCE:{type:"text"}}},_getForId:function(){return this.options.fields.CONVERGENCE.field("id")},_getRawValue:function(){return this.options.fields.CONVERGENCE.field("value")},_constraint:function(t){return t=Math.max(t,-360),t=Math.min(t,360)},_setValue:function(t){return this.options.fields.CONVERGENCE.field("value",t)},_clean:function(t){return this._constraint(this._super(t,4))}}),v.widget("twcc.connectorGeoField",v.twcc.geoField,{options:{value:""},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XX:{type:"text"}}},_appendLabelCell:function(){},_getRawValue:function(){return this.options.fields.XX.field("value")},_setValue:function(t){return this.options.fields.XX.field("value",t)},_constraint:function(t){return t},_clean:function(t){return this._constraint(t)}}),v.widget("twcc.labelGeoField",v.twcc.geoField,{options:{value:""},_create:function(){this._super(),this.options.fields.L.text(this.options.value)},_buildField:function(t,e){return this.options.fields[t]=e,this.options.fields[t]},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{L:v("<span>")}},_getFieldSetUnit:function(){return""},_getRawValue:function(){return this.options.fields.L.text()},_constraint:function(t){return t},_setValue:function(t){return this.options.fields.L.text(t),t},_clean:function(t){return this._constraint(t)},_toggleField:function(){return this.options.readonly}}),v.widget("twcc.field",{options:{type:null,value:null,name:null,glue:"_id_",attributes:{},readOnly:!1},_create:function(){this.options.attributes=v.extend({val:this.options.value,id:this.options.name+this.options.glue+Math.floor(10001*Math.random()),name:this.options.name,disabled:this.options.readOnly,readonly:this.options.readOnly},this.options.attributes),this._setTag()},_setTag:function(){v.extend(this.options.attributes,{type:this.options.type}),this.element.tag({name:"input",attributes:this.options.attributes})},value:function(t){return this.options.value=void 0===t?this.element.tag("value"):this.element.tag("value",t),this.options.value},toggle:function(t){return t=void 0===t?this.options.readOnly:!!t,this.options.readOnly=this._toggle(t),this.options.readOnly},_toggle:function(t){return this.element.tag("toggle",t)},readOnly:function(){return this.options.readOnly},id:function(){return this.options.attributes.id},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),v.widget("twcc.textareaField",v.twcc.field,{options:{type:"textarea"},_setTag:function(){this.element.tag({name:"textarea",attributes:this.options.attributes})}}),v.widget("twcc.optionField",v.twcc.field,{options:{type:"option",options:{}},_setTag:function(){this.element.selectTag({attributes:this.options.attributes,options:this.options.options})},value:function(t){return this.options.value=void 0===t?this.element.selectTag("value"):this.element.selectTag("value",t),this.options.value},_toggle:function(t){return this.element.selectTag("toggle",t)}}),v.widget("twcc.tag",{options:{name:null,attributes:{},readOnly:!1},_$elt:null,_create:function(){var t;this.options.attributes.val&&(this.options.attributes.val=this._clean(this.options.attributes.val)),this.options.attributes.hasOwnProperty("checked")&&(t=this.options.attributes.checked,delete this.options.attributes.checked),this._$elt=v("<"+this.options.name+">",this.options.attributes),void 0!==t&&this._$elt.prop("checked",t),this._appendChildren(),this.value(this.options.attributes.val),this.element.append(this._$elt)},value:function(t){return void 0===t?this.options.attributes.val=this._$elt.val():(this.options.attributes.val=this._clean(t),this._$elt.val(this.options.attributes.val)),this.options.attributes.val},toggle:function(t){var e=void 0===t?this.options.readOnly:!t;return this.options.readOnly=this._toggle(e),this.options.readOnly},_toggle:function(t){return this._$elt.prop("disabled",t).prop("readonly",t),t},readOnly:function(){return this.options.readOnly},_clean:function(t){return"number"==typeof t&&1<t.toString().split("e").length&&(t=y.math.round(t)),t},_appendChildren:function(){},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this._$elt.remove(),this._super()}}),v.widget("twcc.selectTag",v.twcc.tag,{options:{name:"select",options:{}},_$elt:null,_appendChildren:function(){var i=this;v.each(this.options.options,function(t,e){i._$elt.append(v("<option>",{value:t,text:e}))})}})}(jQuery,proj4,TWCCHistory,App),function(n){function t(t){function e(){setTimeout(function(){!0===i._options.checkOnLoad&&(!0===i._options.debug&&i._log("onload->eventCallback","A check loading is launched"),null===i._var.bait&&i._creatBait(),setTimeout(function(){i.check()},1))},1)}this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.1",bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},void 0!==t&&this.setOption(t);var i=this;void 0!==n.addEventListener?n.addEventListener("load",e,!1):n.attachEvent("onload",e)}t.prototype._options=null,t.prototype._var=null,t.prototype._bait=null,t.prototype._log=function(t,e){console.log("[BlockAdBlock]["+t+"] "+e)},t.prototype.setOption=function(t,e){var i;for(var n in void 0!==e&&(i=t,(t={})[i]=e),t)this._options[n]=t[n],!0===this._options.debug&&this._log("setOption",'The option "'+n+'" he was assigned to "'+t[n]+'"');return this},t.prototype._creatBait=function(){var t=document.createElement("div");t.setAttribute("class",this._options.baitClass),t.setAttribute("style",this._options.baitStyle),this._var.bait=n.document.body.appendChild(t),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,!0===this._options.debug&&this._log("_creatBait","Bait has been created")},t.prototype._destroyBait=function(){n.document.body.removeChild(this._var.bait),!(this._var.bait=null)===this._options.debug&&this._log("_destroyBait","Bait has been removed")},t.prototype.check=function(t){if(void 0===t&&(t=!0),!0===this._options.debug&&this._log("check","An audit was requested "+(!0===t?"with a":"without")+" loop"),!0===this._var.checking)return!0===this._options.debug&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var e=this;return!(this._var.loopNumber=0)===t&&(this._var.loop=setInterval(function(){e._checkBait(t)},this._options.loopCheckTime)),setTimeout(function(){e._checkBait(t)},1),!0===this._options.debug&&this._log("check","A check is in progress ..."),!0},t.prototype._checkBait=function(t){var e,i=!1;null===this._var.bait&&this._creatBait(),null===n.document.body.getAttribute("abp")&&null!==this._var.bait.offsetParent&&0!=this._var.bait.offsetHeight&&0!=this._var.bait.offsetLeft&&0!=this._var.bait.offsetTop&&0!=this._var.bait.offsetWidth&&0!=this._var.bait.clientHeight&&0!=this._var.bait.clientWidth||(i=!0),void 0!==n.getComputedStyle&&(!(e=n.getComputedStyle(this._var.bait,null))||"none"!=e.getPropertyValue("display")&&"hidden"!=e.getPropertyValue("visibility")||(i=!0)),!0===this._options.debug&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(!0===i?"positive":"negative")),!0===t&&(this._var.loopNumber++,this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop()),!0===i?(this._stopLoop(),this._destroyBait(),this.emitEvent(!0),!0===t&&(this._var.checking=!1)):null!==this._var.loop&&!1!==t||(this._destroyBait(),this.emitEvent(!1),!0===t&&(this._var.checking=!1))},t.prototype._stopLoop=function(t){clearInterval(this._var.loop),this._var.loop=null,!(this._var.loopNumber=0)===this._options.debug&&this._log("_stopLoop","A loop has been stopped")},t.prototype.emitEvent=function(t){!0===this._options.debug&&this._log("emitEvent","An event with a "+(!0===t?"positive":"negative")+" detection was called");var e=this._var.event[!0===t?"detected":"notDetected"];for(var i in e)!0===this._options.debug&&this._log("emitEvent","Call function "+(parseInt(i)+1)+"/"+e.length),e.hasOwnProperty(i)&&e[i]();return!0===this._options.resetOnEnd&&this.clearEvent(),this},t.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],!0===this._options.debug&&this._log("clearEvent","The event list has been cleared")},t.prototype.on=function(t,e){return this._var.event[!0===t?"detected":"notDetected"].push(e),!0===this._options.debug&&this._log("on",'A type of event "'+(!0===t?"detected":"notDetected")+'" was added'),this},t.prototype.onDetected=function(t){return this.on(!0,t)},t.prototype.onNotDetected=function(t){return this.on(!1,t)},n.BlockAdBlock=t,void 0===n.blockAdBlock&&(n.blockAdBlock=new t({checkOnLoad:!0,resetOnEnd:!0}))}(window),function o(s,a,l){function u(e,t){if(!a[e]){if(!s[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var r=a[e]={exports:{}};s[e][0].call(r.exports,function(t){return u(s[e][1][t]||t)},r,r.exports,o,s,a,l)}return a[e].exports}for(var h="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(t,e,i){"use strict";var Y,H,n,r,X=t("ol"),q=t("ol/proj/proj4.js"),K=t("ol/layer.js"),Z=t("ol/source"),$=o(t("ol/source/Vector")),Q=t("ol/geom"),J=o(t("ol/geom/GeometryType.js")),tt=t("ol/style.js"),et=t("ol/control.js"),it=t("ol/control/ScaleLine"),nt=t("ol/format.js"),rt=t("ol/interaction.js"),ot=t("ol/proj.js"),st=t("ol/coordinate.js"),at=o(t("ol-geocoder")),lt=o(t("ol/layer/Group")),ut=t("ol/sphere"),ht=o(t("ol-layerswitcher"));o(t("ol-ext/control/Graticule"));function o(t){return t&&t.__esModule?t:{default:t}}Y=jQuery,H=proj4,void 0===window.TWCCMap&&(r=function(t){var a,l,d,i,u,h,n,c,p,f,r,g,m,o,s=null,y={mapOptions:{zoom:2,center:[0,0],azimuthOpacity:.7},mapContainerElt:Y("#map")[0],context:{languageCode:"en"}},_={title:"Hybrid",lyrs:"y"},v={title:"Satellite",lyrs:"s"},b={title:"Terrain",lyrs:"p"},j={title:"Road",lyrs:"m"};function x(t){this._array=t,this._index=0;var e=this;this.get=function(){var t=e._array[e._index];return++e._index,e._index===e._array.length&&(e._index=0),t}}function S(){return y.utils.t.apply(this,arguments)}function w(t,e){y.utils.trigger(Y(y.mapContainerElt),t,e)}function P(t){return(0,ot.fromLonLat)(t,d.getProjection())}function E(t){return(0,ot.toLonLat)(t,d.getProjection())}function T(t){return P([t.x,t.y])}function O(t,e){a.setMetrics("length",t),a.setMetrics("area",e),w("map.metrics_changed",{length:t,area:e})}function C(){var t,e,i,n=p.getFeatures()[0];n&&((e=(t=n.getGeometry()).getCoordinates()).push(e[0]),i=new Q.Polygon([e]),O((0,ut.getLength)(t),(0,ut.getArea)(i)))}function M(){m.setPosition(void 0)}function I(o){c.getFeatures().forEach(function(t){t.getGeometry().setCoordinates(o||t.getGeometry().getCoordinates());var e=t.get("name"),i=a.getAngleInRadians(e)||0,n="true"===e||i?y.mapOptions.azimuthOpacity:0,r=t.get("style").getImage();r.setRotation(i),r.setOpacity(n)})}function R(t){return"data:image/svg+xml,"+escape('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'+t)}function k(){c.clear()}function A(t){var i=[new tt.Style({stroke:new tt.Stroke({color:"rgba(0,0,0,0.5)",width:2})})],n=0,e=t.getGeometry(),r=e.getCoordinates().length-1,o={font:"10px Arial",stroke:new tt.Stroke({color:"#fff",width:2}),fill:new tt.Fill({color:"#000"})};return e.forEachSegment(function(t,e){++n,i.push(new tt.Style({geometry:new Q.Point(t),text:new tt.Text(Y.extend(o,{text:n.toString()}))})),n===r&&i.push(new tt.Style({geometry:new Q.Point(e),text:new tt.Text(Y.extend(o,{text:(n+1).toString()}))}))}),i}function L(t){var e=new Y.Deferred;return d.animate({center:t,duration:200},e.resolve),e.promise()}function F(t){var e,i="",n="",r="",o=E(t),s={key:y.mapOptions.timezonedbKey,format:"json",by:"position",lng:o[0],lat:o[1],fields:"abbreviation,gmtOffset"},a=(0,st.degreesToStringHDMS)("NS",o[1]),l=(0,st.degreesToStringHDMS)("EW",o[0]),u=Y.get("https://elevation-api.io/api/elevation",{points:o[1]+","+o[0]}).done(function(t){var e;!t.elevations||"-9999"!==(e=t.elevations[0].elevation.toString())&&(i='<p><img src="'+y.system.dirWsImages+'elevation_icon.png" alt="'+S("elevation")+'" title="'+S("elevation")+'" width="38" height="30"> '+e+S("unitMeter")+"</p>")}).fail(function(){w("xhr.failed","Elevation API")}),h=Y.get("https://api.timezonedb.com/v2.1/get-time-zone",s).done(function(t){var e;"OK"===t.status&&(e=t.gmtOffset/3600,r="<p>"+t.abbreviation+" (GMT",0<e&&(r+="+"),0!=e&&(r+=e),r+=")</p>")}).fail(function(){w("xhr.failed","Timezonedb API")}),c=Y.get("https://nominatim.openstreetmap.org/reverse",{format:"json",lat:o[1],lon:o[0],"accept-language":y.context.languageCode}).done(function(t){var e;t&&!t.error&&(e=t.address.country_code.toUpperCase(),n='<img src="'+y.system.dirWsImages+'address_icon.png" alt="'+S("address")+'" title="'+S("address")+'" width="38" height="30"><p>'+t.display_name+'   <img src="'+y.system.dirWsImages+"flags/"+e+'.png" alt="'+e+'" width="22" height="15"></p>')}).fail(function(){w("xhr.failed","Nominatim API")});M(),Y.when(c,u,h).always(function(){e='<div id="popup" class="ol-popup">   <a href="#" id="popup-closer" class="ol-popup-closer"></a>   <div class="popup-content">       <h3>'+S("dragMe")+"</h3>       <div>"+n+'           <a id="zoom-btn" href="#" title="'+S("zoom")+'">'+S("zoom")+'</a>       </div>       <div>           <img src="'+y.system.dirWsImages+'gps_icon.png" alt="GPS (WGS84)" title="GPS (WGS84)" width="38" height="30">           <p>'+a+"<br>"+l+"</p>"+r+i+"       </div>   </div></div>",g.innerHTML=e,Y("#zoom-btn").button({icons:{primary:"ui-icon-zoomin"},text:!1}).click(function(){!function(){Y("#zoom-btn").button("option","disabled",!0);var t,e=f.getFeatures()[0].getGeometry().getCoordinates();Y.when(L(e),(t=new Y.Deferred,d.animate({zoom:10,duration:200},t.resolve),t.promise())).done(function(){Y("#zoom-btn").button("option","disabled",!1)})}()}),Y("#popup-closer").click(function(t){return M(),this.blur(),t.stopPropagation(),t.preventDefault(),!1}),w("infowindow.dom_ready"),m.setPosition(t)})}function N(t){var e,i,n,r,o,s;1===t.length?(p.clear(),l.removeInteraction(h),r=t[0],f&&(o=T(r),f.getFeatures().length?(s=o,f.getFeatures().forEach(function(t){t.getGeometry().setCoordinates(s)})):(f.addFeature(new X.Feature({geometry:new Q.Point(o),style:new tt.Style({image:new tt.Icon({src:y.system.dirWsImages+"twcc_icon_with_shadow.png",anchor:[19,1],anchorXUnits:"pixels"})})})),l.addInteraction(u)),(c.getFeatures().length?I:function(t){var e,i=R('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/><rect style="fill:#fff;stroke:#fff;stroke-width:1;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;" width="8.779562" height="8.2131386" x="3.610219" y="4.5313869"/></svg>'),n={true:{src:R('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><polygon style="fill:#fff;stroke:#fff;stroke-width:37.61520004;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10" stroke-miterlimit="10" points="374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 259.216,29.942 330.27,173.919 489.16,197.007 " transform="matrix(0.03217603,0,0,0.03217603,-0.33683664,-0.35833699)"/><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/></svg>')},magneticDeclination:{src:R('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16 97" xml:space="preserve" width="16" height="97"><g transform="matrix(0.07106223,0,0,0.07106223,-0.43846047,1.8741008e-6)"><path style="fill:#fff" d="m 7.954,226.53 c -2.23,4.623 -2.295,8.072 -0.609,9.915 3.911,4.275 15.926,-3.905 23.323,-9.051 l 58.416,-40.662 c 7.397,-5.145 20.402,-11.835 29.414,-11.993 0.897,-0.016 1.8,-0.011 2.703,0.011 9.007,0.218 21.958,7.016 29.3,12.238 l 56.403,40.151 c 7.343,5.221 19.303,13.473 23.301,9.219 1.74,-1.849 1.751,-5.33 -0.381,-9.997 L 129.648,7.047 c -4.264,-9.333 -11.335,-9.404 -15.79,-0.163 L 7.954,226.53 Z"/><path style="stroke:#fff;stroke-width:28.14434624;" d="m 118.74748,174.45383 0,1190.45957"/></g></svg>'),rotation:a.getAngleInRadians("magneticDeclination")},srcConvergence:{src:i,color:"#f00",rotation:a.getAngleInRadians("srcConvergence")},dstConvergence:{src:i,rotation:a.getAngleInRadians("dstConvergence")}};for(var r in n){n.hasOwnProperty(r)&&(e=n[r],c.addFeature(new X.Feature({geometry:new Q.Point(t),name:r,style:new tt.Style({image:new tt.Icon(Y.extend({anchor:[.5,1],rotateWithView:!0,opacity:"true"===r||e.rotation?y.mapOptions.azimuthOpacity:0,scale:.75,color:"#000"},e))})})))}})(o),L(o),F(o),O())):(M(),f.clear(),l.removeInteraction(u),k(),e=t,p&&(i=e.map(T),p.getFeatures().length?(n=i,p.getFeatures()[0].getGeometry().setCoordinates(n)):(p.addFeature(new X.Feature({geometry:new Q.LineString(i)})),l.addInteraction(h)),C(),!0===a.getBoolean("autoZoom")&&l.getView().fit(p.getExtent(),{duration:200,padding:[0,270,36,204]})))}function D(t,i){return t.reduce(function(t,e){return t.concat(i(e))},[])}function G(t){return D(t,function(t){return t})}function U(t){return new K.Tile({title:t.title,type:"base",visible:!1,preload:1/0,source:new Z.XYZ({attributions:'© Google <a href="https://developers.google.com/maps/terms" target="_blank">Terms of Use.</a>',url:"http://mt0.google.com/vt/lyrs="+t.lyrs+"&hl=en&x={x}&y={y}&z={z}&s=Ga"})})}function z(t){if(t.features){var e;if(Y.isFunction(t.features.getArray))e=t.features.getArray();else{if(!Y.isArray(t.features))return;e=t.features}w("linestring.edit_end",D(e,function(t){return function t(e){switch(e.getType()){case J.default.POINT:return[e.getCoordinates()];case J.default.LINE_STRING:case J.default.LINEAR_RING:case J.default.MULTI_POINT:return e.getCoordinates();case J.default.POLYGON:case J.default.MULTI_LINE_STRING:return G(e.getCoordinates());case J.default.MULTI_POLYGON:return G(G(e.getCoordinates()));case J.default.GEOMETRY_COLLECTION:return D(e.getGeometries(),t);case J.default.CIRCLE:return[e.getCenter()];default:return[]}}(t.getGeometry())}).map(E)),C()}}function B(){var t=Y("body");i.once("tileloadend",function(){(function(){var t=y.utils.getPreferenceCookie("layers");if(t){var e,i=t.opt;if(i)for(var n in i){!i.hasOwnProperty(n)||(e=Y(".ol-control.layer-switcher label:contains('"+n+"')").closest("li").children("input[type=checkbox]")).length&&e[0].checked!==i[n]&&e.click()}var r,o=t.base;if(o)for(var s in o){!o.hasOwnProperty(s)||(r=Y(".ol-control.layer-switcher label:contains('"+s+"')").closest("li").find("label:contains('"+o[s]+"')").closest("li").children("input[type=radio]")).length&&r.click()}}})(),w("map.tiles_loaded"),Y(".ol-control.layer-switcher").on("change","input",function(t){var e=Y(t.target),i=e.closest("li.group").children("label").text();i+=" "+e.closest("li.layer").children("label").text(),"checkbox"===e.attr("type")&&(i+=" ",i+=this.checked?"on":"off"),w("map.layer.change",i)}),s.resolve()}),i.on("tileloaderror",s.reject),l.on("singleclick",function(t){var e=l.forEachFeatureAtPixel(l.getEventPixel(t.originalEvent),function(t){return t});e?F(e.getGeometry().getCoordinates()):(M(),w("map.click",E(t.coordinate)))}),r.on("addresschosen",function(t){w("place.changed",E(t.coordinate))}),u.on("modifystart",function(){M(),k(),w("marker.drag_start")}),u.on("modifyend",function(t){w("marker.drag_end",E(t.features.getArray()[0].getGeometry().getCoordinates()))}),h.on("modifyend",z),n.on("addfeatures",z),l.getViewport().addEventListener("contextmenu",function(t){var e=l.forEachFeatureAtPixel(l.getEventPixel(t),function(t){return t});e?w("linestring.remove_vertice",E(e.getGeometry().getCoordinates())):w("linestring.add_vertice",E(l.getEventCoordinate(t))),C(),t.stopPropagation(),t.preventDefault()}),t.on("converter.source.selection_changed converterset.done",function(t,e){}),t.on("converterset.wgs84_changed",function(t,e){var i,n,r=y.utils.degToRad(e.convergenceInDegrees),o=y.utils.getConvergenceConvention()?-1:1;e.wgs84=(i=e.wgs84,n=[],Y.each(i,function(){return!!(void 0===this.lat&&void 0===this.x||this.error)||void n.push(this)}),n),a.setAngleInDegrees("magneticDeclination",e.magneticDeclinationInDegrees),a.setAngleInRadians("srcConvergence",o*r.source),a.setAngleInRadians("dstConvergence",o*r.destination),N(e.wgs84),w("converter.changed",e)}),t.on("converterset.convergence_changed",function(t,e){var i,n;c.getFeatures().length&&(i=y.utils.degToRad(e.convergenceInDegrees),n=y.utils.getConvergenceConvention()?-1:1,a.setAngleInRadians("srcConvergence",n*i.source),a.setAngleInRadians("dstConvergence",n*i.destination),I())}),t.on("ui.full_screen",function(){Y(".ol-full-screen button").trigger("click")});var e=new x(Object.values(it.Units));Y(".ol-scale-line").click(function(){o.setUnits(e.get())})}Y.extend(!0,y,t),a={anglesInRadians:{},booleans:{autoZoom:!0},metrics:{},setAngleInRadians:function(t,e){a.anglesInRadians[t]=e},setAngleInDegrees:function(t,e){a.setAngleInRadians(t,y.utils.degToRad(e))},getAngleInRadians:function(t){return a.anglesInRadians[t]},setBoolean:function(t,e){a.booleans[t]=!!e},getBoolean:function(t){return a.booleans[t]},setMetrics:function(t,e){a.metrics[t]=e},getMetrics:function(t){return a.metrics[t]}};var W,V=((W=et.Control)&&(e.__proto__=W),(e.prototype=Object.create(W&&W.prototype)).constructor=e);function e(t){var e=t||{},i=Y("#c-ads-1")[0];W.call(this,{element:i,target:e.target})}return function(){s=function(){return y.utils.newDeferred.apply(this,arguments)}("Map"),(0,q.register)(H);var t=new tt.Style({image:new tt.Circle({radius:6,fill:null,stroke:new tt.Stroke({color:"rgba(0,0,0,0.6)",width:3})})});g=Y("<div>")[0],o=new et.ScaleLine,c=new $.default,f=new $.default,p=new $.default,u=new rt.Modify({source:f,style:t,pixelTolerance:30}),h=new rt.Modify({source:p,style:t}),n=new rt.DragAndDrop({formatConstructors:[nt.GPX,nt.GeoJSON,nt.IGC,nt.KML,nt.TopoJSON]}),i=new Z.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),d=new X.View({zoom:y.mapOptions.zoom}),r=new at.default("nominatim",{autoComplete:!0,autoCompleteMinLength:2,placeholder:S("searchByAddress"),targetType:"glass-button",lang:y.context.languageCode,limit:5,keepOpen:!1,preventDefault:!0,debug:!1}),m=new X.Overlay({element:g,autoPan:!0,autoPanAnimation:{duration:200}});var e=P(y.mapOptions.center);d.setCenter(e),l=new X.Map({controls:(0,et.defaults)().extend([new et.FullScreen({source:"map-container"}),new ht.default,r,o,new V]),interactions:(0,rt.defaults)().extend([new rt.DragRotateAndZoom,n]),target:y.mapContainerElt,loadTilesWhileAnimating:!0,overlays:[m],layers:[new lt.default({title:"Maps",layers:[new lt.default({title:"ArcGIS",layers:[new K.Tile({title:"Satellite",type:"base",visible:!1,preload:1/0,source:new Z.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer">ArcGIS</a>',url:"http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg"})}),new K.Tile({title:"Terrain",type:"base",preload:1/0,source:i})]}),new lt.default({title:"OSM",layers:[new K.Tile({title:"Stamen toner",type:"base",visible:!1,preload:1/0,source:new Z.Stamen({layer:"toner"})}),new K.Tile({title:"Stamen terrain",type:"base",visible:!1,preload:1/0,source:new Z.Stamen({layer:"terrain"})}),new K.Tile({title:"Open Street Map",type:"base",visible:!1,preload:1/0,source:new Z.OSM})]}),new lt.default({title:"Google",layers:[U(_),U(v),U(b),U(j)]})]}),new lt.default({title:"Features",layers:[new K.Vector({title:"Azimuths",style:function(t){return t.get("style")},source:c})]}),new K.Vector({style:function(t){return t.get("style")},source:f}),new K.Vector({style:A,source:p})],view:d}),B()}(),{promise:s.promise(),setGraticule:function(){new GridOverlay(l).setMap(l)},model:{setAngleInRadians:a.setAngleInRadians,setAngleInDegrees:a.setAngleInDegrees,getMetrics:a.getMetrics,setBoolean:a.setBoolean},getMap:function(){return l},olVersion:X.VERSION}},window.TWCCMap={getInstance:function(t){return n=n||r(t)}})},{ol:160,"ol-ext/control/Graticule":4,"ol-geocoder":7,"ol-layerswitcher":8,"ol/control.js":49,"ol/control/ScaleLine":56,"ol/coordinate.js":60,"ol/format.js":74,"ol/geom":126,"ol/geom/GeometryType.js":131,"ol/interaction.js":161,"ol/layer.js":183,"ol/layer/Group":189,"ol/proj.js":205,"ol/proj/proj4.js":210,"ol/source":252,"ol/source/Vector":277,"ol/sphere":286,"ol/style.js":291}],2:[function(t,e,i){"use strict";i.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,l=(1<<a)-1,u=l>>1,h=-7,c=i?r-1:0,d=i?-1:1,p=t[e+c];for(c+=d,o=p&(1<<-h)-1,p>>=-h,h+=a;0<h;o=256*o+t[e+c],c+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;0<h;s=256*s+t[e+c],c+=d,h-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=u}return(p?-1:1)*s*Math.pow(2,o-n)},i.write=function(t,e,i,n,r,o){var s,a,l,u=8*o-r-1,h=(1<<u)-1,c=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),2<=(e+=1<=s+c?d/l:d*Math.pow(2,1-c))*l&&(s++,l/=2),h<=s+c?(a=0,s=h):1<=s+c?(a=(e*l-1)*Math.pow(2,r),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,r),s=0));8<=r;t[i+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,u+=r;0<u;t[i+p]=255&s,p+=f,s/=256,u-=8);t[i+p-f]|=128*g}},{}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=c(t("../util/ext")),r=c(t("ol/control/Control")),o=t("ol/Observable"),s=c(t("ol/style/Style")),a=c(t("ol/style/Fill")),l=c(t("ol/style/Stroke")),u=c(t("ol/style/Text")),h=c(t("../util/getMapCanvas"));function c(t){return t&&t.__esModule?t:{default:t}}function d(t){t=t||{},this.setStyle(t.style),r.default.call(this,t)}(0,n.default)(d,r.default),d.prototype.setMap=function(t){this.getCanvas(t);var e=this.getMap();this._listener&&((0,o.unByKey)(this._listener),this._listener=null),r.default.prototype.setMap.call(this,t),e&&e.renderSync(),t&&(this._listener=t.on("postcompose",this._draw.bind(this)))},d.prototype.getCanvas=function(t){return(0,h.default)(t)},d.prototype.getContext=function(t){var e,i=t.context;return!i&&this.getMap()&&(i=(e=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0])?e.getContext("2d"):null),i},d.prototype.setStyle=function(t){this._style=t||new s.default({})},d.prototype.getStyle=function(){return this._style},d.prototype.getStroke=function(){return this._style.getStroke()||this._style.setStroke(new l.default({color:"#000",width:1.25})),this._style.getStroke()},d.prototype.getFill=function(){return this._style.getFill()||this._style.setFill(new a.default({color:"#fff"})),this._style.getFill()},d.prototype.getTextStroke=function(){var t=this._style.getText();return(t=t||new u.default({})).getStroke()||t.setStroke(new l.default({color:"#fff",width:3})),t.getStroke()},d.prototype.getTextFill=function(){var t=this._style.getText();return(t=t||new u.default({})).getFill()||t.setFill(new a.default({color:"#fff",width:3})),t.getFill()},d.prototype.getTextFont=function(){var t=this._style.getText();return(t=t||new u.default({})).getFont()||t.setFont("12px sans-serif"),t.getFont()},d.prototype._draw=function(){console.warn("[CanvasBase] draw function not implemented.")};i.default=d},{"../util/ext":5,"../util/getMapCanvas":6,"ol/Observable":30,"ol/control/Control":51,"ol/style/Fill":293,"ol/style/Stroke":301,"ol/style/Style":302,"ol/style/Text":303}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=h(t("../util/ext")),r=h(t("ol/proj/Projection")),o=h(t("ol/style/Style")),s=h(t("ol/style/Stroke")),a=h(t("ol/style/Fill")),l=h(t("ol/style/Text")),F=t("ol/proj"),u=h(t("./CanvasBase"));function h(t){return t&&t.__esModule?t:{default:t}}function c(t){t=t||{};var e=document.createElement("div");e.className="ol-graticule ol-unselectable ol-hidden",u.default.call(this,{element:e}),this.set("projection",t.projection||"EPSG:4326");var i=new r.default({code:this.get("projection")}).getMetersPerUnit();for(this.fac=1;10<i/this.fac;)this.fac*=10;this.fac=1e4/this.fac,this.set("maxResolution",t.maxResolution||1/0),this.set("step",t.step||.1),this.set("stepCoord",t.stepCoord||1),this.set("spacing",t.spacing||40),this.set("margin",t.margin||0),this.set("borderWidth",t.borderWidth||5),this.set("stroke",!1!==t.stroke),this.formatCoord=t.formatCoord||function(t){return t},t.style instanceof o.default?this.setStyle(t.style):this.setStyle(new o.default({stroke:new s.default({color:"#000",width:1}),fill:new a.default({color:"#fff"}),text:new l.default({stroke:new s.default({color:"#fff",width:2}),fill:new a.default({color:"#000"})})}))}(0,n.default)(c,u.default),c.prototype.setStyle=function(t){this._style=t},c.prototype._draw=function(t){if(!(this.get("maxResolution")<t.frameState.viewState.resolution)){for(var e,i=this.getContext(t),n=i.canvas,r=t.frameState.pixelRatio,o=n.width/r,s=n.height/r,a=this.get("projection"),l=this.getMap(),u=[l.getCoordinateFromPixel([0,0]),l.getCoordinateFromPixel([o,0]),l.getCoordinateFromPixel([o,s]),l.getCoordinateFromPixel([0,s])],h=-1/0,c=1/0,d=-1/0,p=1/0,f=0;e=u[f];f++)u[f]=(0,F.transform)(e,l.getView().getProjection(),a),h=Math.max(h,u[f][0]),c=Math.min(c,u[f][0]),d=Math.max(d,u[f][1]),p=Math.min(p,u[f][1]);var g=this.get("spacing"),m=this.get("step"),y=this.get("stepCoord"),_=this.get("borderWidth"),v=this.get("margin");o<(h-c)/m*g&&(m*=Math.round((h-c)/o*g/m))>this.fac&&(m=Math.round(m/this.fac)*this.fac),c=Math.floor(c/m)*m-m,p=Math.floor(p/m)*m-m,h=Math.floor(h/m)*m+2*m,d=Math.floor(d/m)*m+2*m;var b=(0,F.get)(a).getExtent();b&&(c<b[0]&&(c=b[0]),p<b[1]&&(p=b[1]),h>b[2]&&(h=b[2]+m),d>b[3]&&(d=b[3]+m));var j=this.getStyle().getStroke()&&this.get("stroke"),x=this.getStyle().getText(),S=this.getStyle().getFill();i.save(),i.scale(r,r),i.beginPath(),i.rect(v,v,o-2*v,s-2*v),i.clip(),i.beginPath();for(var w,P,E,T,O,C,M={top:[],left:[],bottom:[],right:[]},I=c;I<h;I+=m)for(E=(0,F.transform)([I,p],a,l.getView().getProjection()),E=l.getPixelFromCoordinate(E),j&&i.moveTo(E[0],E[1]),P=E,w=p+m;w<=d;w+=m)T=(0,F.transform)([I,w],a,l.getView().getProjection()),T=l.getPixelFromCoordinate(T),j&&i.lineTo(T[0],T[1]),0<P[1]&&T[1]<0&&M.top.push([I,P]),P[1]>s&&T[1]<s&&M.bottom.push([I,P]),P=T;for(w=p;w<d;w+=m)for(E=(0,F.transform)([c,w],a,l.getView().getProjection()),E=l.getPixelFromCoordinate(E),j&&i.moveTo(E[0],E[1]),P=E,I=c+m;I<=h;I+=m)T=(0,F.transform)([I,w],a,l.getView().getProjection()),T=l.getPixelFromCoordinate(T),j&&i.lineTo(T[0],T[1]),P[0]<0&&0<T[0]&&M.left.push([w,P]),P[0]<o&&T[0]>o&&M.right.push([w,P]),P=T;if(j&&(i.strokeStyle=this.getStyle().getStroke().getColor(),i.lineWidth=this.getStyle().getStroke().getWidth(),i.stroke()),x){i.fillStyle=this.getStyle().getText().getFill().getColor(),i.strokeStyle=this.getStyle().getText().getStroke().getColor(),i.lineWidth=this.getStyle().getText().getStroke().getWidth(),i.textAlign="center",i.textBaseline="hanging";for(var R=(S?_:0)+v+2,f=0;O=M.top[f];f++)Math.round(O[0]/this.get("step"))%y||(C=this.formatCoord(O[0],"top"),i.strokeText(C,O[1][0],R),i.fillText(C,O[1][0],R));for(i.textBaseline="alphabetic",f=0;O=M.bottom[f];f++)Math.round(O[0]/this.get("step"))%y||(C=this.formatCoord(O[0],"bottom"),i.strokeText(C,O[1][0],s-R),i.fillText(C,O[1][0],s-R));for(i.textBaseline="middle",i.textAlign="left",f=0;O=M.left[f];f++)Math.round(O[0]/this.get("step"))%y||(C=this.formatCoord(O[0],"left"),i.strokeText(C,R,O[1][1]),i.fillText(C,R,O[1][1]));for(i.textAlign="right",f=0;O=M.right[f];f++)Math.round(O[0]/this.get("step"))%y||(C=this.formatCoord(O[0],"right"),i.strokeText(C,o-R,O[1][1]),i.fillText(C,o-R,O[1][1]))}if(S){var k,A,L=this.getStyle().getFill().getColor();for((A=this.getStyle().getStroke())?k=this.getStyle().getStroke().getColor():(k=L,L="#fff"),i.strokeStyle=k,i.lineWidth=A?A.getWidth():1,f=1;f<M.top.length;f++)i.beginPath(),i.rect(M.top[f-1][1][0],v,M.top[f][1][0]-M.top[f-1][1][0],_),i.fillStyle=Math.round(M.top[f][0]/m)%2?k:L,i.fill(),i.stroke();for(f=1;f<M.bottom.length;f++)i.beginPath(),i.rect(M.bottom[f-1][1][0],s-_-v,M.bottom[f][1][0]-M.bottom[f-1][1][0],_),i.fillStyle=Math.round(M.bottom[f][0]/m)%2?k:L,i.fill(),i.stroke();for(f=1;f<M.left.length;f++)i.beginPath(),i.rect(v,M.left[f-1][1][1],_,M.left[f][1][1]-M.left[f-1][1][1]),i.fillStyle=Math.round(M.left[f][0]/m)%2?k:L,i.fill(),i.stroke();for(f=1;f<M.right.length;f++)i.beginPath(),i.rect(o-_-v,M.right[f-1][1][1],_,M.right[f][1][1]-M.right[f-1][1][1]),i.fillStyle=Math.round(M.right[f][0]/m)%2?k:L,i.fill(),i.stroke();i.beginPath(),i.fillStyle=k,i.rect(v,v,_,_),i.rect(v,s-_-v,_,_),i.rect(o-_-v,v,_,_),i.rect(o-_-v,s-_-v,_,_),i.fill()}i.restore()}};i.default=c},{"../util/ext":5,"./CanvasBase":3,"ol/proj":205,"ol/proj/Projection":206,"ol/style/Fill":293,"ol/style/Stroke":301,"ol/style/Style":302,"ol/style/Text":303}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.ol_ext_inherits=void 0,window.ol&&!ol.ext&&(ol.ext={});function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}i.ol_ext_inherits=n,window.ol&&(ol.inherits||(ol.inherits=n)),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.Element&&!Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});i.default=n},{}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;function n(e){if(!e)return null;var i=e.getViewport().getElementsByClassName("ol-fixedoverlay")[0];return i||(e.getViewport().querySelector(".ol-layers")?((i=document.createElement("canvas")).className="ol-fixedoverlay",e.getViewport().querySelector(".ol-layers").after(i),e.on("precompose",function(t){i.width=e.getSize()[0]*t.frameState.pixelRatio,i.height=e.getSize()[1]*t.frameState.pixelRatio})):i=e.getViewport().querySelector("canvas")),i}i.default=n},{}],7:[function(t,e,i){"use strict";function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n,r;r=function(t,r,o,i,n,s,a,f){t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,n=n&&n.hasOwnProperty("default")?n.default:n,s=s&&s.hasOwnProperty("default")?s.default:s,a=a&&a.hasOwnProperty("default")?a.default:a,f=f&&f.hasOwnProperty("default")?f.default:f;var e="gcd-container",l="gcd-button-control",u="gcd-input-query",h="gcd-input-reset",c={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},d={containerId:e,buttonControlId:l,inputQueryId:u,inputResetId:h,cssClasses:c},p=Object.freeze({__proto__:null,containerId:e,buttonControlId:l,inputQueryId:u,inputResetId:h,cssClasses:c,default:d}),g="addresschosen",m="nominatim",y="reverse",_="glass-button",v={provider:"osm",placeholder:"Search for an address",featureStyle:null,targetType:_,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,debug:!1};function b(t,e){if(void 0===e&&(e="Assertion failed"),!t){if("undefined"!=typeof Error)throw new Error(e);throw e}}function j(t){var e,i=("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0&&(e=Date.now(),performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}),window.performance.now().toString(36));return t?t+i:i}function x(t){return/^\d+$/.test(t)}function S(t,e,i){if(Array.isArray(t))t.forEach(function(t){return S(t,e)});else for(var n=Array.isArray(e)?e:e.split(/\s+/),r=n.length;r--;)P(t,n[r])||C(t,n[r],i)}function w(t,e,i){if(Array.isArray(t))t.forEach(function(t){return w(t,e,i)});else for(var n=Array.isArray(e)?e:e.split(/\s+/),r=n.length;r--;)P(t,n[r])&&M(t,n[r],i)}function P(t,e){return t.classList?t.classList.contains(e):O(e).test(t.className)}function E(t,e,i){void 0===e&&(e=window.document);var n,r=Array.prototype.slice,o=[];if(/^(#?[\w-]+|\.[\w-.]+)$/.test(t))switch(t[0]){case"#":o=[(n="#"===(n=t.substr(1))[0]?n.substr(1,n.length):n,document.getElementById(n))];break;case".":o=r.call(e.getElementsByClassName(t.substr(1).replace(/\./g," ")));break;default:o=r.call(e.getElementsByTagName(t))}else o=r.call(e.querySelectorAll(t));return i?o:o[0]}function T(t,e){var i;if(Array.isArray(t)){if(i=document.createElement(t[0]),t[1].id&&(i.id=t[1].id),t[1].classname&&(i.className=t[1].classname),t[1].attr){var n=t[1].attr;if(Array.isArray(n))for(var r=-1;++r<n.length;)i.setAttribute(n[r].name,n[r].value);else i.setAttribute(n.name,n.value)}}else i=document.createElement(t);i.innerHTML=e;for(var o=document.createDocumentFragment();i.childNodes[0];)o.appendChild(i.childNodes[0]);return i.appendChild(o),i}function O(t){return new RegExp("(^|\\s+) "+t+" (\\s+|$)")}function C(t,e,i){t.classList?t.classList.add(e):t.className=(t.className+" "+e).trim(),i&&x(i)&&window.setTimeout(function(){return M(t,e)},i)}function M(t,e,i){t.classList?t.classList.remove(e):t.className=t.className.replace(O(e)," ").trim(),i&&x(i)&&window.setTimeout(function(){return C(t,e)},i)}function I(t){this.options=t.options,this.els=this.createControl()}var R=p.cssClasses;function k(){this.settings={url:"https://photon.komoot.de/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}}function A(){this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}function L(){this.settings={url:"http://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}function F(){this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}}function N(){this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}}function D(t,e){this.Base=t,this.layerName=j("geocoder-layer-"),this.layer=new i({name:this.layerName,source:new n}),this.options=t.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.provider=this.newProvider(),this.els=e,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners()}I.prototype.createControl=function(){var t,e,i;return(i="text-input"===this.options.targetType?(e=R.namespace+" "+R.inputText.container,{container:t=T(["div",{id:p.containerId,classname:e}],I.input),control:E("."+R.inputText.control,t),input:E("."+R.inputText.input,t),reset:E("."+R.inputText.reset,t),result:E("."+R.inputText.result,t)}):(e=R.namespace+" "+R.glass.container,{container:t=T(["div",{id:p.containerId,classname:e}],I.glass),control:E("."+R.glass.control,t),button:E("."+R.glass.button,t),input:E("."+R.glass.input,t),reset:E("."+R.glass.reset,t),result:E("."+R.glass.result,t)})).input.placeholder=this.options.placeholder,i},I.glass=['<div class="',R.glass.control," ",R.olControl,'">','<button type="button"',' id="',p.buttonControlId,'"',' class="',R.glass.button,'"></button>','<input type="text"',' id="',p.inputQueryId,'"',' class="',R.glass.input,'"',' autocomplete="off" placeholder="Search ...">',"<a",' id="',p.inputResetId,'"',' class="',R.glass.reset," ",R.hidden,'"',"></a>","</div>",'<ul class="',R.glass.result,'"></ul>'].join(""),I.input=['<div class="',R.inputText.control,'">','<input type="text"',' id="',p.inputQueryId,'"',' class="',R.inputText.input,'"',' autocomplete="off" placeholder="Search ...">','<span class="',R.inputText.icon,'"></span>','<button type="button"',' id="',p.inputResetId,'"',' class="',R.inputText.reset," ",R.hidden,'"',"></button>","</div>",'<ul class="',R.inputText.result,'"></ul>'].join(""),k.prototype.getParameters=function(t){return t.lang=t.lang.toLowerCase(),{url:this.settings.url,params:{q:t.query,limit:t.limit||this.settings.params.limit,lang:-1<this.settings.langs.indexOf(t.lang)?t.lang:this.settings.params.lang}}},k.prototype.handleResponse=function(t){if(t.features.length)return t.features.map(function(t){return{lon:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],address:{name:t.properties.name,postcode:t.properties.postcode,city:t.properties.city,state:t.properties.state,country:t.properties.country},original:{formatted:t.properties.name,details:t.properties}}})},A.prototype.getParameters=function(t){return{url:this.settings.url,params:{q:t.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:t.limit||this.settings.params.limit,countrycodes:t.countrycodes||this.settings.params.countrycodes,"accept-language":t.lang||this.settings.params["accept-language"]}}},A.prototype.handleResponse=function(t){if(t.length)return t.map(function(t){return{lon:t.lon,lat:t.lat,address:{name:t.display_name,road:t.address.road||"",houseNumber:t.address.house_number||"",postcode:t.address.postcode,city:t.address.city||t.address.town,state:t.address.state,country:t.address.country},original:{formatted:t.display_name,details:t.address}}})},L.prototype.getParameters=function(t){return{url:this.settings.url,params:{q:t.query,key:t.key,format:"json",addressdetails:1,limit:t.limit||this.settings.params.limit,countrycodes:t.countrycodes||this.settings.params.countrycodes,"accept-language":t.lang||this.settings.params["accept-language"]}}},L.prototype.handleResponse=function(t){if(t.length)return t.map(function(t){return{lon:t.lon,lat:t.lat,address:{name:t.address.neighbourhood||"",road:t.address.road||"",postcode:t.address.postcode,city:t.address.city||t.address.town,state:t.address.state,country:t.address.country},original:{formatted:t.display_name,details:t.address}}})},F.prototype.getParameters=function(t){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:t.query,key:t.key,includeNeighborhood:t.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:t.maxResults||this.settings.params.maxResults}}},F.prototype.handleResponse=function(t){var e=t.resourceSets[0].resources;if(e.length)return e.map(function(t){return{lon:t.point.coordinates[1],lat:t.point.coordinates[0],address:{name:t.name},original:{formatted:t.address.formattedAddress,details:t.address}}})},N.prototype.getParameters=function(t){return{url:this.settings.url,params:{q:t.query,key:t.key,limit:t.limit||this.settings.params.limit,countrycode:t.countrycodes||this.settings.params.countrycodes}}},N.prototype.handleResponse=function(t){if(t.results.length)return t.results.map(function(t){return{lon:t.geometry.lng,lat:t.geometry.lat,address:{name:t.components.house_number||"",road:t.components.road||"",postcode:t.components.postcode,city:t.components.city||t.components.town,state:t.components.state,country:t.components.country},original:{formatted:t.formatted,details:t.components}}})};var G,U=p.cssClasses;return D.prototype.setListeners=function(){var i,n,r=this;this.els.input.addEventListener("keypress",function(t){var e=t.target.value.trim();(t.key?"Enter"===t.key:t.which?13===t.which:t.keyCode&&13===t.keyCode)&&(t.preventDefault(),r.query(e))},!1),this.els.input.addEventListener("click",function(t){t.stopPropagation()},!1),this.els.input.addEventListener("input",function(t){var e=t.target.value.trim();(e.length?w:S)(r.els.reset,U.hidden),r.options.autoComplete&&e!==n&&(n=e,i&&clearTimeout(i),i=setTimeout(function(){e.length>=r.options.autoCompleteMinLength&&r.query(e)},200))},!1),this.els.reset.addEventListener("click",function(t){r.els.input.focus(),r.els.input.value="",r.lastQuery="",S(r.els.reset,U.hidden),r.clearResults()},!1),this.options.targetType===_&&this.els.button.addEventListener("click",function(t){t.stopPropagation(),P(r.els.control,U.glass.expanded)?r.collapse():r.expand()},!1)},D.prototype.query=function(t){var i=this;this.provider||(this.provider=this.newProvider());var e,c,n=this.provider.getParameters({query:t,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});this.lastQuery===t&&this.els.result.firstChild||(this.lastQuery=t,this.clearResults(),S(this.els.reset,U.spin),e={url:n.url,data:n.params},n.callbackName&&(e.jsonp=!0,e.callbackName=n.callbackName),c=e,new Promise(function(t,e){var i,n,r,o,s,a,l,u,h=(i=c.url,(n=c.data)&&"object"==B(n)&&(i+=(/\?/.test(i)?"&":"?")+function i(n){return Object.keys(n).reduce(function(t,e){return t.push("object"==B(n[e])?i(n[e]):encodeURIComponent(e)+"="+encodeURIComponent(n[e])),t},[]).join("&")}(n)),i);c.jsonp?(r=h,o=c.callbackName,s=t,a=document.head,l=document.createElement("script"),u="f"+Math.round(Math.random()*Date.now()),l.setAttribute("src",r+(0<r.indexOf("?")?"&":"?")+o+"="+u),window[u]=function(t){window[u]=void 0,setTimeout(function(){return a.removeChild(l)},0),s(t)},a.appendChild(l)):fetch(h,{method:"GET",mode:"cors",credentials:"same-origin"}).then(function(t){return t.json()}).then(t).catch(e)}).then(function(t){i.options.debug&&console.info(t),w(i.els.reset,U.spin);var e=i.provider.handleResponse(t);e&&(i.createList(e),i.listenMapClick())}).catch(function(t){w(i.els.reset,U.spin);var e=T("li","<h5>Error! No internet connection?</h5>");i.els.result.appendChild(e)}))},D.prototype.createList=function(t){var n=this,r=this.els.result;t.forEach(function(e){var i;switch(n.options.provider){case"osm":i='<span class="'+U.road+'">'+e.address.name+"</span>";break;default:i=n.addressTemplate(e.address)}var t=T("li",'<a href="#">'+i+"</a>");t.addEventListener("click",function(t){t.preventDefault(),n.chosen(e,i,e.address,e.original)},!1),r.appendChild(t)})},D.prototype.chosen=function(t,e,i,n){var r,o,s,a,l=this.Base.getMap(),u=[parseFloat(t.lon),parseFloat(t.lat)],h=l.getView().getProjection(),c=f.transform(u,"EPSG:4326",h),d=(d=t.bbox)&&f.transformExtent(d,"EPSG:4326",h),p={formatted:e,details:i,original:n};!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault?this.Base.dispatchEvent({type:g,address:p,coordinate:c,bbox:d}):(d?l.getView().fit(d,{duration:500}):(o=c,a=a||2.388657133911758,s=s||500,l.getView().animate({duration:s,resolution:a},{duration:s,center:o})),r=this.createFeature(c,p),this.Base.dispatchEvent({type:g,address:p,feature:r,coordinate:c,bbox:d}))},D.prototype.createFeature=function(t){var e=new a(new s(t));return this.addLayer(),e.setStyle(this.options.featureStyle),e.setId(j("geocoder-ft-")),this.getSource().addFeature(e),e},D.prototype.addressTemplate=function(t){var e,n,i=[];return t.name&&i.push(['<span class="',U.road,'">{name}</span>'].join("")),(t.road||t.building||t.house_number)&&i.push(['<span class="',U.road,'">{building} {road} {house_number}</span>'].join("")),(t.city||t.town||t.village)&&i.push(['<span class="',U.city,'">{postcode} {city} {town} {village}</span>'].join("")),(t.state||t.country)&&i.push(['<span class="',U.country,'">{state} {country}</span>'].join("")),e=i.join("<br>"),n=t,e.replace(/\{ *([\w_-]+) *\}/g,function(t,e){return i=void 0===n[e]?"":n[e],String(i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var i})},D.prototype.newProvider=function(){switch(this.options.provider){case"osm":return new A;case"mapquest":return new L;case"photon":return new k;case"bing":return new F;case"opencage":return new N;default:return this.options.provider}},D.prototype.expand=function(){var t=this;w(this.els.input,U.spin),S(this.els.control,U.glass.expanded),window.setTimeout(function(){return t.els.input.focus()},100),this.listenMapClick()},D.prototype.collapse=function(){this.els.input.value="",this.els.input.blur(),S(this.els.reset,U.hidden),w(this.els.control,U.glass.expanded),this.clearResults()},D.prototype.listenMapClick=function(){var e,i;this.registeredListeners.mapClick||(i=(e=this).Base.getMap().getTargetElement(),this.registeredListeners.mapClick=!0,i.addEventListener("click",{handleEvent:function(t){e.clearResults(!0),i.removeEventListener(t.type,this,!1),e.registeredListeners.mapClick=!1}},!1))},D.prototype.clearResults=function(t){t&&this.options.targetType===_?this.collapse():function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this.els.result)},D.prototype.getSource=function(){return this.layer.getSource()},D.prototype.addLayer=function(){var e=this,i=!1,t=this.Base.getMap();t.getLayers().forEach(function(t){t===e.layer&&(i=!0)}),i||t.addLayer(this.layer)},(G=t)&&(z.__proto__=G),((z.prototype=Object.create(G&&G.prototype)).constructor=z).prototype.getLayer=function(){return this.layer},z.prototype.getSource=function(){return this.getLayer().getSource()},z.prototype.setProvider=function(t){this.options.provider=t},z.prototype.setProviderKey=function(t){this.options.key=t},z;function z(t,e){if(void 0===t&&(t=m),void 0===e&&(e={}),!(this instanceof z))return new z;var i;b("string"==typeof t,"@param `type` should be string!"),b(t===m||t===y,"@param 'type' should be '"+m+"'\n        or '"+y+"'!"),b("object"==B(e),"@param `options` should be object!"),v.featureStyle=[new r({image:new o({scale:.7,src:"//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png"})})],this.options=function(t,e){var i={};for(var n in t)i[n]=t[n];for(var r in e)i[r]=e[r];return i}(v,e),this.container=void 0;var n=new I(this);t===m&&(this.container=n.els.container,i=new D(this,n.els),this.layer=i.layer),G.call(this,{element:this.container})}},"object"==((n=void 0)===i?"undefined":B(i))&&void 0!==e?e.exports=r(t("ol/control/Control"),t("ol/style/Style"),t("ol/style/Icon"),t("ol/layer/Vector"),t("ol/source/Vector"),t("ol/geom/Point"),t("ol/Feature"),t("ol/proj")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/style/Style","ol/style/Icon","ol/layer/Vector","ol/source/Vector","ol/geom/Point","ol/Feature","ol/proj"],r):(n=n||self).Geocoder=r(n.ol.control.Control,n.ol.style.Style,n.ol.style.Icon,n.ol.layer.Vector,n.ol.source.Vector,n.ol.geom.Point,n.ol.Feature,n.ol.proj)},{"ol/Feature":13,"ol/control/Control":51,"ol/geom/Point":137,"ol/layer/Vector":196,"ol/proj":205,"ol/source/Vector":277,"ol/style/Icon":294,"ol/style/Style":302}],8:[function(t,e,i){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n;n=function(t,n){t="default"in t?t.default:t;var u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t},h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==o(e)&&"function"!=typeof e?t:e},g="layer-switcher-",i=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+o(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(m,t),e(m,[{key:"setMap",value:function(t){for(var e=0;e<this.mapListeners.length;e++)n.unByKey(this.mapListeners[e]);if(this.mapListeners.length=0,function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(n):void 0}(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"setMap",this).call(this,t),t){if(this.renderPanel(),"click"==this.activationMode)return;var i=this;this.mapListeners.push(t.on("pointerdown",function(){i.hidePanel()}))}}},{key:"showPanel",value:function(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.renderPanel())}},{key:"hidePanel",value:function(){this.element.classList.contains(this.shownClassName)&&this.element.classList.remove(this.shownClassName)}},{key:"renderPanel",value:function(){this.dispatchEvent({type:"render"}),m.renderPanel(this.getMap(),this.panel,{groupSelectStyle:this.groupSelectStyle,reverse:this.reverse}),this.dispatchEvent({type:"rendercomplete"})}}],[{key:"renderPanel",value:function(e,i,n){var t=new Event("render");for(i.dispatchEvent(t),(n=n||{}).groupSelectStyle=m.getGroupSelectStyle(n.groupSelectStyle),m.ensureTopVisibleBaseLayerShown_(e);i.firstChild;)i.removeChild(i.firstChild);m.forEachRecursive(e,function(t,e,i){t.set("indeterminate",!1)}),"children"===n.groupSelectStyle||"none"===n.groupSelectStyle?m.setGroupVisibility(e):"group"===n.groupSelectStyle&&m.setChildVisibility(e);var r=document.createElement("ul");i.appendChild(r),m.renderLayers_(e,e,r,n,function(t){m.renderPanel(e,i,n)});var o=new Event("rendercomplete");i.dispatchEvent(o)}},{key:"isBaseGroup",value:function(t){var e=t.getLayers?t.getLayers().getArray():[];return e.length&&"base"===e[0].get("type")}},{key:"setGroupVisibility",value:function(t){m.getGroupsAndLayers(t,function(t){return t.getLayers&&!t.get("combine")&&!m.isBaseGroup(t)}).reverse().forEach(function(t){var e=t.getLayersArray().map(function(t){return t.getVisible()});e.every(function(t){return!0===t})?(t.setVisible(!0),t.set("indeterminate",!1)):e.every(function(t){return!1===t})?(t.setVisible(!1),t.set("indeterminate",!1)):(t.setVisible(!0),t.set("indeterminate",!0))})}},{key:"setChildVisibility",value:function(t){m.getGroupsAndLayers(t,function(t){return t.getLayers&&!t.get("combine")&&!m.isBaseGroup(t)}).forEach(function(t){var e=t.getVisible(),i=t.get("indeterminate");t.getLayers().getArray().forEach(function(t){t.set("indeterminate",!1),e&&!i||!t.getVisible()||t.set("indeterminate",!0)})})}},{key:"ensureTopVisibleBaseLayerShown_",value:function(t){var n;m.forEachRecursive(t,function(t,e,i){"base"===t.get("type")&&t.getVisible()&&(n=t)}),n&&m.setVisible_(t,n,!0)}},{key:"getGroupsAndLayers",value:function(t,n){var r=[];return n=n||function(t,e,i){return!0},m.forEachRecursive(t,function(t,e,i){t.get("title")&&n(t,e,i)&&r.push(t)}),r}},{key:"setVisible_",value:function(e,n,t,i){n.setVisible(t),t&&"base"===n.get("type")&&m.forEachRecursive(e,function(t,e,i){t!=n&&"base"===t.get("type")&&t.setVisible(!1)}),n.getLayers&&!n.get("combine")&&"children"===i&&n.getLayers().forEach(function(t){m.setVisible_(e,t,n.getVisible(),i)})}},{key:"renderLayer_",value:function(e,i,t,n,r){var o,s,a,l,u,h,c=document.createElement("li"),d=i.get("title"),p=m.uuid(),f=document.createElement("label");return i.getLayers&&!i.get("combine")?(o=m.isBaseGroup(i),c.classList.add("group"),o&&c.classList.add(g+"base-group"),i.get("fold")&&(c.classList.add(g+"fold"),c.classList.add(g+i.get("fold")),(s=document.createElement("button")).onclick=function(t){t=t||window.event,m.toggleFold_(i,c),t.preventDefault()},c.appendChild(s)),o||"none"==n.groupSelectStyle||((a=document.createElement("input")).type="checkbox",a.id=p,a.checked=i.getVisible(),a.indeterminate=i.get("indeterminate"),a.onchange=function(t){m.setVisible_(e,i,t.target.checked,n.groupSelectStyle),r(i)},c.appendChild(a),f.htmlFor=p),f.innerHTML=d,c.appendChild(f),l=document.createElement("ul"),c.appendChild(l),m.renderLayers_(e,i,l,n,r)):(c.className="layer",u=document.createElement("input"),"base"===i.get("type")?(u.type="radio",u.name="base"):u.type="checkbox",u.id=p,u.checked=i.get("visible"),u.indeterminate=i.get("indeterminate"),u.onchange=function(t){m.setVisible_(e,i,t.target.checked,n.groupSelectStyle),r(i)},c.appendChild(u),f.htmlFor=p,f.innerHTML=d,((h=e.getView().getResolution())>i.getMaxResolution()||h<i.getMinResolution())&&(f.className+=" disabled"),c.appendChild(f)),c}},{key:"renderLayers_",value:function(t,e,i,n,r){var o=e.getLayers().getArray().slice();n.reverse&&(o=o.reverse());for(var s,a=0;a<o.length;a++)(s=o[a]).get("title")&&i.appendChild(m.renderLayer_(t,s,a,n,r))}},{key:"forEachRecursive",value:function(t,n){t.getLayers().forEach(function(t,e,i){n(t,e,i),t.getLayers&&m.forEachRecursive(t,n)})}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}},{key:"enableTouchScroll_",value:function(t){var e;m.isTouchDevice_()&&(e=0,t.addEventListener("touchstart",function(t){e=this.scrollTop+t.touches[0].pageY},!1),t.addEventListener("touchmove",function(t){this.scrollTop=e-t.touches[0].pageY},!1))}},{key:"isTouchDevice_",value:function(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}},{key:"toggleFold_",value:function(t,e){e.classList.remove(g+t.get("fold")),t.set("fold","open"===t.get("fold")?"close":"open"),e.classList.add(g+t.get("fold"))}},{key:"getGroupSelectStyle",value:function(t){return 0<=["none","children","group"].indexOf(t)?t:"children"}}]),m);function m(t){u(this,m);var e=t||{},i=e.tipLabel?e.tipLabel:"Legend",n=document.createElement("div"),r=h(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,{element:n,target:e.target}));r.activationMode=e.activationMode||"mouseover";var o=void 0!==e.collapseLabel?e.collapseLabel:"»",s=void 0!==e.label?e.label:"";r.groupSelectStyle=m.getGroupSelectStyle(e.groupSelectStyle),r.reverse=!1!==e.reverse,r.mapListeners=[],r.hiddenClassName="ol-unselectable ol-control layer-switcher",m.isTouchDevice_()&&(r.hiddenClassName+=" touch"),r.shownClassName="shown",n.className=r.hiddenClassName;var a=document.createElement("button");a.setAttribute("title",i),n.appendChild(a),r.panel=document.createElement("div"),r.panel.className="panel",n.appendChild(r.panel),m.enableTouchScroll_(r.panel);var l=r;return a.textContent=s,"click"==r.activationMode?(n.classList.add("activationModeClick"),a.onclick=function(t){t=t||window.event,l.element.classList.contains(l.shownClassName)?(l.hidePanel(),a.textContent=s):(l.showPanel(),a.textContent=o),t.preventDefault()},h(r)):(a.onmouseover=function(t){l.showPanel()},a.onclick=function(t){t=t||window.event,l.showPanel(),t.preventDefault()},l.panel.onmouseout=function(t){t=t||window.event,l.panel.contains(t.toElement||t.relatedTarget)||l.hidePanel()},r)}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=i),i},"object"===(void 0===i?"undefined":o(i))&&void 0!==e?e.exports=n(t("ol/control/Control"),t("ol/Observable")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/Observable"],n):(void 0).LayerSwitcher=n((void 0).ol.control.Control,(void 0).ol.Observable)},{"ol/Observable":30,"ol/control/Control":51}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r,o=t("./util.js"),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=(n=Error,s(l,n),l);function l(t){var e=this,i="Assertion failed. See https://openlayers.org/en/"+("latest"===o.VERSION?o.VERSION:"v"+o.VERSION.split("-")[0])+"/doc/errors/#"+t+" for details.";return(e=n.call(this,i)||this).code=t,e.name="AssertionError",e.message=i,e}i.default=a},{"./util.js":313}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.CollectionEvent=void 0;var r=a(t("./AssertionError.js")),n=a(t("./Object.js")),o=a(t("./CollectionEventType.js")),s=a(t("./events/Event.js"));function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c="length",d=(l=s.default,h(p,l),p);function p(t,e,i){var n=l.call(this,t)||this;return n.element=e,n.index=i,n}i.CollectionEvent=d;var f,g=(f=n.default,h(m,f),m.prototype.clear=function(){for(;0<this.getLength();)this.pop()},m.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},m.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},m.prototype.getArray=function(){return this.array_},m.prototype.item=function(t){return this.array_[t]},m.prototype.getLength=function(){return this.get(c)},m.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new d(o.default.ADD,e,t))},m.prototype.pop=function(){return this.removeAt(this.getLength()-1)},m.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},m.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},m.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new d(o.default.REMOVE,e,t)),e},m.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new d(o.default.REMOVE,n,t)),this.dispatchEvent(new d(o.default.ADD,e,t))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},m.prototype.updateLength_=function(){this.set(c,this.array_.length)},m.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new r.default(58)},m);function m(t,e){var i=f.call(this)||this,n=e||{};if(i.unique_=!!n.unique,i.array_=t||[],i.unique_)for(var r=0,o=i.array_.length;r<o;++r)i.assertUnique_(i.array_[r],r);return i.updateLength_(),i}i.default=g},{"./AssertionError.js":9,"./CollectionEventType.js":11,"./Object.js":28,"./events/Event.js":65}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={ADD:"add",REMOVE:"remove"}},{}],12:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},r.prototype.disposeInternal=function(){},r);function r(){this.disposed=!1}i.default=n},{}],13:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.createStyleFunction=g,i.default=void 0;var n,r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Object.js")),o=(n=t("./events/EventType.js"))&&n.__esModule?n:{default:n},a=t("./asserts.js"),l=t("./events.js");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(h=r.default,d(f,h),f.prototype.clone=function(){var t=new f(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var i=this.getStyle();return i&&t.setStyle(i),t},f.prototype.getGeometry=function(){return this.get(this.geometryName_)},f.prototype.getId=function(){return this.id_},f.prototype.getGeometryName=function(){return this.geometryName_},f.prototype.getStyle=function(){return this.style_},f.prototype.getStyleFunction=function(){return this.styleFunction_},f.prototype.handleGeometryChange_=function(){this.changed()},f.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&((0,l.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=(0,l.listen)(t,o.default.CHANGE,this.handleGeometryChange_,this)),this.changed()},f.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},f.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?g(t):void 0,this.changed()},f.prototype.setId=function(t){this.id_=t,this.changed()},f.prototype.setGeometryName=function(t){this.removeEventListener((0,r.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener((0,r.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},f);function f(t){var e=h.call(this)||this;return e.id_=void 0,e.geometryName_="geometry",e.style_=null,e.styleFunction_=void 0,e.geometryChangeKey_=null,e.addEventListener((0,r.getChangeEventType)(e.geometryName_),e.handleGeometryChanged_),t&&("function"==typeof t.getSimplifiedGeometry?e.setGeometry(t):e.setProperties(t)),e}function g(t){return"function"==typeof t?t:(e=Array.isArray(t)?t:((0,a.assert)("function"==typeof t.getZIndex,41),[t]),function(){return e});var e}i.default=p},{"./Object.js":28,"./asserts.js":45,"./events.js":64,"./events/EventType.js":66}],14:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=c(t("./events/Event.js")),r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Object.js")),o=c(t("./events/EventType.js")),a=t("./geom/Polygon.js"),l=t("./proj.js"),u=t("./math.js");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function c(t){return t&&t.__esModule?t:{default:t}}var d,p,f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m="accuracy",y="accuracyGeometry",_="altitude",v="altitudeAccuracy",b="heading",j="position",x="projection",S="speed",w="tracking",P="trackingOptions",E=(p=n.default,g(C,p),C),T=(d=r.default,g(O,d),O.prototype.disposeInternal=function(){this.setTracking(!1),d.prototype.disposeInternal.call(this)},O.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=(0,l.getTransformFromProjections)((0,l.get)("EPSG:4326"),t),this.position_&&this.set(j,this.transform_(this.position_)))},O.prototype.handleTrackingChanged_=function(){var t;"geolocation"in navigator&&((t=this.getTracking())&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0))},O.prototype.positionChange_=function(t){var e=t.coords;this.set(m,e.accuracy),this.set(_,null===e.altitude?void 0:e.altitude),this.set(v,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(b,null===e.heading?void 0:(0,u.toRadians)(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];var i=this.transform_(this.position_);this.set(j,i),this.set(S,null===e.speed?void 0:e.speed);var n=(0,a.circular)(this.position_,e.accuracy);n.applyTransform(this.transform_),this.set(y,n),this.changed()},O.prototype.positionError_=function(t){this.dispatchEvent(new E(t))},O.prototype.getAccuracy=function(){return this.get(m)},O.prototype.getAccuracyGeometry=function(){return this.get(y)||null},O.prototype.getAltitude=function(){return this.get(_)},O.prototype.getAltitudeAccuracy=function(){return this.get(v)},O.prototype.getHeading=function(){return this.get(b)},O.prototype.getPosition=function(){return this.get(j)},O.prototype.getProjection=function(){return this.get(x)},O.prototype.getSpeed=function(){return this.get(S)},O.prototype.getTracking=function(){return this.get(w)},O.prototype.getTrackingOptions=function(){return this.get(P)},O.prototype.setProjection=function(t){this.set(x,(0,l.get)(t))},O.prototype.setTracking=function(t){this.set(w,t)},O.prototype.setTrackingOptions=function(t){this.set(P,t)},O);function O(t){var e=d.call(this)||this,i=t||{};return e.position_=null,e.transform_=l.identityTransform,e.watchId_=void 0,e.addEventListener((0,r.getChangeEventType)(x),e.handleProjectionChanged_),e.addEventListener((0,r.getChangeEventType)(w),e.handleTrackingChanged_),void 0!==i.projection&&e.setProjection(i.projection),void 0!==i.trackingOptions&&e.setTrackingOptions(i.trackingOptions),e.setTracking(void 0!==i.tracking&&i.tracking),e}function C(t){var e=p.call(this,o.default.ERROR)||this;return e.code=t.code,e.message=t.message,e}i.default=T},{"./Object.js":28,"./events/Event.js":65,"./events/EventType.js":66,"./geom/Polygon.js":138,"./math.js":201,"./proj.js":205}],15:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.listenImage=g,i.default=void 0;var a=o(t("./events/EventType.js")),n=o(t("./ImageBase.js")),l=o(t("./ImageState.js")),u=t("./has.js"),r=t("./extent.js"),h=t("./events.js");function o(t){return t&&t.__esModule?t:{default:t}}var c,s,d=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(c=n.default,d(f,c),f.prototype.getImage=function(){return this.image_},f.prototype.handleImageError_=function(){this.state=l.default.ERROR,this.unlistenImage_(),this.changed()},f.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=(0,r.getHeight)(this.extent)/this.image_.height),this.state=l.default.LOADED,this.unlistenImage_(),this.changed()},f.prototype.load=function(){this.state!=l.default.IDLE&&this.state!=l.default.ERROR||(this.state=l.default.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=g(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},f.prototype.setImage=function(t){this.image_=t},f.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},f);function f(t,e,i,n,r,o){var s=c.call(this,t,e,i,l.default.IDLE)||this;return s.src_=n,s.image_=new Image,null!==r&&(s.image_.crossOrigin=r),s.unlisten_=null,s.state=l.default.IDLE,s.imageLoadFunction_=o,s}function g(t,e,i){var n=t;if(n.src&&u.IMAGE_DECODE){var r=n.decode(),o=!0;return r.then(function(){o&&e()}).catch(function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e:i)()}),function(){o=!1}}var s=[(0,h.listenOnce)(n,a.default.LOAD,e),(0,h.listenOnce)(n,a.default.ERROR,i)];return function(){s.forEach(h.unlistenByKey)}}i.default=p},{"./ImageBase.js":16,"./ImageState.js":18,"./events.js":64,"./events/EventType.js":66,"./extent.js":70,"./has.js":159}],16:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./events/Target.js")),r=s(t("./events/EventType.js")),o=t("./util.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.changed=function(){this.dispatchEvent(r.default.CHANGE)},c.prototype.getExtent=function(){return this.extent},c.prototype.getImage=function(){return(0,o.abstract)()},c.prototype.getPixelRatio=function(){return this.pixelRatio_},c.prototype.getResolution=function(){return this.resolution},c.prototype.getState=function(){return this.state},c.prototype.load=function(){(0,o.abstract)()},c);function c(t,e,i,n){var r=a.call(this)||this;return r.extent=t,r.pixelRatio_=i,r.resolution=e,r.state=n,r}i.default=h},{"./events/EventType.js":66,"./events/Target.js":68,"./util.js":313}],17:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(t("./ImageBase.js")),a=r(t("./ImageState.js"));function r(t){return t&&t.__esModule?t:{default:t}}var l,o,s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(l=n.default,s(h,l),h.prototype.getError=function(){return this.error_},h.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=a.default.ERROR):this.state=a.default.LOADED,this.changed()},h.prototype.load=function(){this.state==a.default.IDLE&&(this.state=a.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},h.prototype.getImage=function(){return this.canvas_},h);function h(t,e,i,n,r){var o=this,s=void 0!==r?a.default.IDLE:a.default.LOADED;return(o=l.call(this,t,e,i,s)||this).loader_=void 0!==r?r:null,o.canvas_=n,o.error_=null,o}i.default=u},{"./ImageBase.js":16,"./ImageState.js":18}],18:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},{}],19:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("./Tile.js")),r=a(t("./TileState.js")),o=t("./dom.js"),s=t("./Image.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=(l=n.default,h(d,l),d.prototype.getImage=function(){return this.image_},d.prototype.getKey=function(){return this.src_},d.prototype.handleImageError_=function(){var t;this.state=r.default.ERROR,this.unlistenImage_(),this.image_=((t=(0,o.createCanvasContext2D)(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},d.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=r.default.LOADED:this.state=r.default.EMPTY,this.unlistenImage_(),this.changed()},d.prototype.load=function(){this.state==r.default.ERROR&&(this.state=r.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==r.default.IDLE&&(this.state=r.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,s.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},d.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},d);function d(t,e,i,n,r,o){var s=l.call(this,t,e,o)||this;return s.crossOrigin_=n,s.src_=i,s.image_=new Image,null!==n&&(s.image_.crossOrigin=n),s.unlisten_=null,s.tileLoadFunction_=r,s}i.default=c},{"./Image.js":15,"./Tile.js":34,"./TileState.js":38,"./dom.js":62}],20:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},r.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},r.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[2+e]<t)return!1;for(var i=e-3;0<i&&this.points_[i+2]>t;)i-=3;var n=this.points_[2+e]-this.points_[i+2];if(n<1e3/60)return!1;var r=this.points_[e]-this.points_[i],o=this.points_[1+e]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_},r.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},r.prototype.getAngle=function(){return this.angle_},r);function r(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}i.default=n},{}],21:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("./renderer/Composite.js")),r=l(t("./PluggableMap.js")),o=t("./obj.js"),s=t("./control.js"),a=t("./interaction.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=r.default,c(p,u),p.prototype.createRenderer=function(){return new n.default(this)},p);function p(t){return(t=(0,o.assign)({},t)).controls||(t.controls=(0,s.defaults)()),t.interactions||(t.interactions=(0,a.defaults)({onFocusOnly:!0})),u.call(this,t)||this}i.default=d},{"./PluggableMap.js":33,"./control.js":49,"./interaction.js":161,"./obj.js":203,"./renderer/Composite.js":232}],22:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./MapEvent.js"))&&n.__esModule?n:{default:n};var s,o,a=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(s=r.default,a(u,s),Object.defineProperty(u.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),u.prototype.preventDefault=function(){s.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},u.prototype.stopPropagation=function(){s.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},u);function u(t,e,i,n,r){var o=s.call(this,t,e,r)||this;return o.originalEvent=i,o.pixel_=null,o.coordinate_=null,o.dragging=void 0!==n&&n,o}i.default=l},{"./MapEvent.js":25}],23:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=h(t("./events/Target.js")),r=h(t("./events/EventType.js")),o=h(t("./MapBrowserEvent.js")),s=h(t("./MapBrowserEventType.js")),a=h(t("./pointer/EventType.js")),l=t("./has.js"),u=t("./events.js");function h(t){return t&&t.__esModule?t:{default:t}}var c,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f=(c=n.default,p(g,c),g.prototype.emulateClick_=function(e){var t=new o.default(s.default.CLICK,this.map_,e);this.dispatchEvent(t),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new o.default(s.default.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var t=new o.default(s.default.SINGLECLICK,this.map_,e);this.dispatchEvent(t)}.bind(this),250)},g.prototype.updateActivePointers_=function(t){var e=t;e.type==s.default.POINTERUP||e.type==s.default.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==s.default.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},g.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new o.default(s.default.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(u.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},g.prototype.isMouseActionButton_=function(t){return 0===t.button},g.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new o.default(s.default.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.dragListenerKeys_.push((0,u.listen)(document,s.default.POINTERMOVE,this.handlePointerMove_,this),(0,u.listen)(document,s.default.POINTERUP,this.handlePointerUp_,this),(0,u.listen)(this.element_,s.default.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==document&&this.dragListenerKeys_.push((0,u.listen)(this.element_.getRootNode(),s.default.POINTERUP,this.handlePointerUp_,this)))},g.prototype.handlePointerMove_=function(t){var e;this.isMoving_(t)&&(this.dragging_=!0,e=new o.default(s.default.POINTERDRAG,this.map_,t,this.dragging_),this.dispatchEvent(e))},g.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new o.default(t.type,this.map_,t,e))},g.prototype.handleTouchMove_=function(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()},g.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},g.prototype.disposeInternal=function(){this.relayedListenerKey_&&((0,u.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(r.default.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,u.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(u.unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,c.prototype.disposeInternal.call(this)},g);function g(t,e){var i=c.call(this,t)||this;i.map_=t,i.clickTimeoutId_,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=e?e*l.DEVICE_PIXEL_RATIO:l.DEVICE_PIXEL_RATIO,i.down_=null;var n=i.map_.getViewport();return i.activePointers_=0,i.trackedTouches_={},i.element_=n,i.pointerdownListenerKey_=(0,u.listen)(n,a.default.POINTERDOWN,i.handlePointerDown_,i),i.originalPointerMoveEvent_,i.relayedListenerKey_=(0,u.listen)(n,a.default.POINTERMOVE,i.relayEvent_,i),i.boundHandleTouchMove_=i.handleTouchMove_.bind(i),i.element_.addEventListener(r.default.TOUCHMOVE,i.boundHandleTouchMove_,!!l.PASSIVE_EVENT_LISTENERS&&{passive:!1}),i}i.default=f},{"./MapBrowserEvent.js":22,"./MapBrowserEventType.js":24,"./events.js":64,"./events/EventType.js":66,"./events/Target.js":68,"./has.js":159,"./pointer/EventType.js":204}],24:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./events/EventType.js"))&&n.__esModule?n:{default:n};var o={SINGLECLICK:"singleclick",CLICK:r.default.CLICK,DBLCLICK:r.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};i.default=o},{"./events/EventType.js":66}],25:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./events/Event.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){var n=o.call(this,t)||this;return n.map=e,n.frameState=void 0!==i?i:null,n}i.default=l},{"./events/Event.js":65}],26:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"}},{}],27:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"}},{}],28:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getChangeEventType=_,i.default=i.ObjectEvent=void 0;var n=l(t("./events/Event.js")),r=l(t("./ObjectEventType.js")),o=l(t("./Observable.js")),s=t("./obj.js"),a=t("./util.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=n.default,c(p,u),p);function p(t,e,i){var n=u.call(this,t)||this;return n.key=e,n.oldValue=i,n}i.ObjectEvent=d;var f,g=(f=o.default,c(y,f),y.prototype.get=function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},y.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},y.prototype.getProperties=function(){return this.values_&&(0,s.assign)({},this.values_)||{}},y.prototype.hasProperties=function(){return!!this.values_},y.prototype.notify=function(t,e){var i=_(t);this.dispatchEvent(new d(i,t,e)),i=r.default.PROPERTYCHANGE,this.dispatchEvent(new d(i,t,e))},y.prototype.set=function(t,e,i){var n,r=this.values_||(this.values_={});i?r[t]=e:(n=r[t])!==(r[t]=e)&&this.notify(t,n)},y.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},y.prototype.unset=function(t,e){var i;this.values_&&t in this.values_&&(i=this.values_[t],delete this.values_[t],(0,s.isEmpty)(this.values_)&&(this.values_=null),e||this.notify(t,i))},y),m={};function y(t){var e=f.call(this)||this;return(0,a.getUid)(e),e.values_=null,void 0!==t&&e.setProperties(t),e}function _(t){return m.hasOwnProperty(t)?m[t]:m[t]="change:"+t}i.default=g},{"./ObjectEventType.js":29,"./Observable.js":30,"./events/Event.js":65,"./obj.js":203,"./util.js":313}],29:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={PROPERTYCHANGE:"propertychange"}},{}],30:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.unByKey=d,i.default=void 0;var n=s(t("./events/Target.js")),r=s(t("./events/EventType.js")),o=t("./events.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.changed=function(){++this.revision_,this.dispatchEvent(r.default.CHANGE)},c.prototype.getRevision=function(){return this.revision_},c.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=(0,o.listen)(this,t[r],e);return n}return(0,o.listen)(this,t,e)},c.prototype.once=function(t,e){if(Array.isArray(t))for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=(0,o.listenOnce)(this,t[r],e);else n=(0,o.listenOnce)(this,t,e);return e.ol_key=n},c.prototype.un=function(t,e){var i=e.ol_key;if(i)d(i);else if(Array.isArray(t))for(var n=0,r=t.length;n<r;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)},c);function c(){var t=a.call(this)||this;return t.revision_=0,t}function d(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;++e)(0,o.unlistenByKey)(t[e]);else(0,o.unlistenByKey)(t)}i.default=h},{"./events.js":64,"./events/EventType.js":66,"./events/Target.js":68}],31:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==u(t)&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Object.js")),r=a(t("./MapEventType.js")),h=a(t("./OverlayPositioning.js")),o=t("./css.js"),m=t("./extent.js"),s=t("./events.js"),y=t("./dom.js");function a(t){return t&&t.__esModule?t:{default:t}}function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f="element",g="map",_="offset",v="position",b="positioning",j=(c=n.default,p(x,c),x.prototype.getElement=function(){return this.get(f)},x.prototype.getId=function(){return this.id},x.prototype.getMap=function(){return this.get(g)},x.prototype.getOffset=function(){return this.get(_)},x.prototype.getPosition=function(){return this.get(v)},x.prototype.getPositioning=function(){return this.get(b)},x.prototype.handleElementChanged=function(){(0,y.removeChildren)(this.element);var t=this.getElement();t&&this.element.appendChild(t)},x.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&((0,y.removeNode)(this.element),(0,s.unlistenByKey)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t,e=this.getMap();e&&(this.mapPostrenderListenerKey=(0,s.listen)(e,r.default.POSTRENDER,this.render,this),this.updatePixelPosition(),t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer(),this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan())},x.prototype.render=function(){this.updatePixelPosition()},x.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},x.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},x.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},x.prototype.setElement=function(t){this.set(f,t)},x.prototype.setMap=function(t){this.set(g,t)},x.prototype.setOffset=function(t){this.set(_,t)},x.prototype.setPosition=function(t){this.set(v,t)},x.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},x.prototype.panIntoView=function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g=this.getMap();g&&g.getTargetElement()&&this.get(v)&&(e=this.getRect(g.getTargetElement(),g.getSize()),i=this.getElement(),n=this.getRect(i,[(0,y.outerWidth)(i),(0,y.outerHeight)(i)]),o=void 0===(r=t||{}).margin?20:r.margin,(0,m.containsExtent)(e,n)||(s=n[0]-e[0],a=e[2]-n[2],l=n[1]-e[1],u=e[3]-n[3],h=[0,0],s<0?h[0]=s-o:a<0&&(h[0]=Math.abs(a)+o),l<0?h[1]=l-o:u<0&&(h[1]=Math.abs(u)+o),0===h[0]&&0===h[1]||(c=g.getView().getCenterInternal(),p=[(d=g.getPixelFromCoordinateInternal(c))[0]+h[0],d[1]+h[1]],f=r.animation||{},g.getView().animateInternal({center:g.getCoordinateFromPixelInternal(p),duration:f.duration,easing:f.easing}))))},x.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]},x.prototype.setPositioning=function(t){this.set(b,t)},x.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},x.prototype.updatePixelPosition=function(){var t,e,i=this.getMap(),n=this.getPosition();i&&i.isRendered()&&n?(t=i.getPixelFromCoordinate(n),e=i.getSize(),this.updateRenderedPosition(t,e)):this.setVisible(!1)},x.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var o=Math.round(t[0]+n[0])+"px",s=Math.round(t[1]+n[1])+"px",a="0%",l="0%";r==h.default.BOTTOM_RIGHT||r==h.default.CENTER_RIGHT||r==h.default.TOP_RIGHT?a="-100%":r!=h.default.BOTTOM_CENTER&&r!=h.default.CENTER_CENTER&&r!=h.default.TOP_CENTER||(a="-50%"),r==h.default.BOTTOM_LEFT||r==h.default.BOTTOM_CENTER||r==h.default.BOTTOM_RIGHT?l="-100%":r!=h.default.CENTER_LEFT&&r!=h.default.CENTER_CENTER&&r!=h.default.CENTER_RIGHT||(l="-50%");var u="translate("+a+", "+l+") translate("+o+", "+s+")";this.rendered.transform_!=u&&(this.rendered.transform_=u,i.transform=u,i.msTransform=u)},x.prototype.getOptions=function(){return this.options},x);function x(t){var e=c.call(this)||this;e.options=t,e.id=t.id,e.insertFirst=void 0===t.insertFirst||t.insertFirst,e.stopEvent=void 0===t.stopEvent||t.stopEvent,e.element=document.createElement("div"),e.element.className=void 0!==t.className?t.className:"ol-overlay-container "+o.CLASS_SELECTABLE,e.element.style.position="absolute",e.element.style.pointerEvents="auto";var i=t.autoPan;return i&&"object"!==u(i)&&(i={animation:t.autoPanAnimation,margin:t.autoPanMargin}),e.autoPan=i||!1,e.rendered={transform_:"",visible:!0},e.mapPostrenderListenerKey=null,e.addEventListener((0,n.getChangeEventType)(f),e.handleElementChanged),e.addEventListener((0,n.getChangeEventType)(g),e.handleMapChanged),e.addEventListener((0,n.getChangeEventType)(_),e.handleOffsetChanged),e.addEventListener((0,n.getChangeEventType)(v),e.handlePositionChanged),e.addEventListener((0,n.getChangeEventType)(b),e.handlePositioningChanged),void 0!==t.element&&e.setElement(t.element),e.setOffset(void 0!==t.offset?t.offset:[0,0]),e.setPositioning(void 0!==t.positioning?t.positioning:h.default.TOP_LEFT),void 0!==t.position&&e.setPosition(t.position),e}i.default=j},{"./MapEventType.js":26,"./Object.js":28,"./OverlayPositioning.js":32,"./css.js":61,"./dom.js":62,"./events.js":64,"./extent.js":70}],32:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"}},{}],33:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=R(t("./Object.js")),a=M(t("./Collection.js")),r=M(t("./CollectionEventType.js")),l=M(t("./events/EventType.js")),u=M(t("./layer/Group.js")),o=M(t("./MapBrowserEvent.js")),h=M(t("./MapBrowserEventHandler.js")),c=M(t("./MapBrowserEventType.js")),d=M(t("./MapEvent.js")),p=M(t("./MapEventType.js")),f=M(t("./MapProperty.js")),g=M(t("./ObjectEventType.js")),m=M(t("./pointer/EventType.js")),y=M(t("./render/EventType.js")),_=R(t("./TileQueue.js")),v=M(t("./View.js")),b=M(t("./ViewHint.js")),j=t("./has.js"),x=t("./functions.js"),S=t("./transform.js"),w=t("./asserts.js"),P=t("./extent.js"),E=t("./proj.js"),T=t("./size.js"),O=t("./events.js"),C=t("./dom.js");function M(t){return t&&t.__esModule?t:{default:t}}function I(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return I=function(){return t},t}function R(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=I();if(e&&e.has(t))return e.get(t);var i,n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t){Object.prototype.hasOwnProperty.call(t,o)&&((i=r?Object.getOwnPropertyDescriptor(t,o):null)&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=t[o])}return n.default=t,e&&e.set(t,n),n}var k,A,L=(A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),F=(k=n.default,L(N,k),N.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},N.prototype.addControl=function(t){this.getControls().push(t)},N.prototype.addInteraction=function(t){this.getInteractions().push(t)},N.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},N.prototype.addOverlay=function(t){this.getOverlays().push(t)},N.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},N.prototype.disposeInternal=function(){this.setTarget(null),k.prototype.disposeInternal.call(this)},N.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixelInternal(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:x.TRUE,s=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,s,e,null,o,null)}},N.prototype.getFeaturesAtPixel=function(t,e){var i=[];return this.forEachFeatureAtPixel(t,function(t){i.push(t)},e),i},N.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},r=void 0!==n.hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,o=n.layerFilter||x.TRUE;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,o)}},N.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:x.TRUE,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,n,null)},N.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},N.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},N.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},N.prototype.getTarget=function(){return this.get(f.default.TARGET)},N.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},N.prototype.getCoordinateFromPixel=function(t){return(0,E.toUserCoordinate)(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},N.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?(0,S.apply)(e.pixelToCoordinateTransform,t.slice()):null},N.prototype.getControls=function(){return this.controls},N.prototype.getOverlays=function(){return this.overlays_},N.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},N.prototype.getInteractions=function(){return this.interactions},N.prototype.getLayerGroup=function(){return this.get(f.default.LAYERGROUP)},N.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},N.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer.getSource();if(n&&n.loading)return!0}return!1},N.prototype.getPixelFromCoordinate=function(t){var e=(0,E.fromUserCoordinate)(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},N.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?(0,S.apply)(e.coordinateToPixelTransform,t.slice(0,2)):null},N.prototype.getRenderer=function(){return this.renderer_},N.prototype.getSize=function(){return this.get(f.default.SIZE)},N.prototype.getView=function(){return this.get(f.default.VIEW)},N.prototype.getViewport=function(){return this.viewport_},N.prototype.getOverlayContainer=function(){return this.overlayContainer_},N.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},N.prototype.getTilePriority=function(t,e,i,n){return(0,_.getTilePriority)(this.frameState_,t,e,i,n)},N.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new o.default(i,this,t);this.handleMapBrowserEvent(n)},N.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var e=t.originalEvent,i=e.type;if(i===m.default.POINTERDOWN||i===l.default.WHEEL||i===l.default.KEYDOWN){var n=this.viewport_.getRootNode?this.viewport_.getRootNode():document,r=n===document?e.target:n.elementFromPoint(e.clientX,e.clientY);if(!n.contains(r)||this.overlayContainerStopEvent_.contains(r))return}t.frameState=this.frameState_;var o=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var s=o.length-1;0<=s;s--){var a=o[s];if(a.getActive()&&!a.handleEvent(t))break}}},N.prototype.handlePostRender=function(){var t,e,i,n,r=this.frameState_,o=this.tileQueue_;o.isEmpty()||(n=i=this.maxTilesLoading_,!r||((t=r.viewHints)[b.default.ANIMATING]||t[b.default.INTERACTING])&&(i=(e=!j.IMAGE_DECODE&&8<Date.now()-r.time)?0:8,n=e?0:2),o.getTilesLoading()<i&&(o.reprioritize(),o.loadMoreTiles(i,n))),!r||!this.hasListener(y.default.RENDERCOMPLETE)||r.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(y.default.RENDERCOMPLETE,r);for(var s=this.postRenderFunctions_,a=0,l=s.length;a<l;++a)s[a](this,r);s.length=0},N.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},N.prototype.handleTargetChanged_=function(t){var e;if(this.getTarget()&&(e=this.getTargetElement()),t.oldValue){for(var i=0,n=this.keyHandlerKeys_.length;i<n;++i)(0,O.unlistenByKey)(this.keyHandlerKeys_[i]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener(l.default.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(l.default.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(l.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),(0,C.removeNode)(this.viewport_)}if(e){for(var r in e.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new h.default(this,this.moveTolerance_),c.default)this.mapBrowserEventHandler_.addEventListener(c.default[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(l.default.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(l.default.WHEEL,this.boundHandleBrowserEvent_,!!j.PASSIVE_EVENT_LISTENERS&&{passive:!1});var o=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[(0,O.listen)(o,l.default.KEYDOWN,this.handleBrowserEvent,this),(0,O.listen)(o,l.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(l.default.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()},N.prototype.handleTileChange_=function(){this.render()},N.prototype.handleViewPropertyChanged_=function(){this.render()},N.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&((0,O.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,O.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=(0,O.listen)(t,g.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,O.listen)(t,l.default.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},N.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(O.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[(0,O.listen)(t,g.default.PROPERTYCHANGE,this.render,this),(0,O.listen)(t,l.default.CHANGE,this.render,this)]),this.render()},N.prototype.isRendered=function(){return!!this.frameState_},N.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},N.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}},N.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},N.prototype.removeControl=function(t){return this.getControls().remove(t)},N.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},N.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},N.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},N.prototype.renderFrame_=function(t){var e,i,n=this.getSize(),r=this.getView(),o=this.frameState_,s=null;void 0!==n&&(0,T.hasArea)(n)&&r&&r.isDef()&&(e=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),i=r.getState(),s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:o?o.declutterItems:[],extent:(0,P.getForViewAndSize)(i.center,i.resolution,i.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:i,viewHints:e,wantedTiles:{}}),this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),o&&(this.previousExtent_&&((0,P.isEmpty)(this.previousExtent_)||(0,P.equals)(s.extent,this.previousExtent_))||(this.dispatchEvent(new d.default(p.default.MOVESTART,this,o)),this.previousExtent_=(0,P.createOrUpdateEmpty)(this.previousExtent_))),!this.previousExtent_||s.viewHints[b.default.ANIMATING]||s.viewHints[b.default.INTERACTING]||(0,P.equals)(s.extent,this.previousExtent_)||(this.dispatchEvent(new d.default(p.default.MOVEEND,this,s)),(0,P.clone)(s.extent,this.previousExtent_))),this.dispatchEvent(new d.default(p.default.POSTRENDER,this,s)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},N.prototype.setLayerGroup=function(t){this.set(f.default.LAYERGROUP,t)},N.prototype.setSize=function(t){this.set(f.default.SIZE,t)},N.prototype.setTarget=function(t){this.set(f.default.TARGET,t)},N.prototype.setView=function(t){this.set(f.default.VIEW,t)},N.prototype.updateSize=function(){var t,e=this.getTargetElement();e?(t=getComputedStyle(e),this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])):this.setSize(void 0),this.updateViewportSize_()},N.prototype.updateViewportSize_=function(){var t,e,i=this.getView();i&&(t=void 0,(e=getComputedStyle(this.viewport_)).width&&e.height&&(t=[parseInt(e.width,10),parseInt(e.height,10)]),i.setViewportSize(t))},N);function N(t){var e=k.call(this)||this,i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,r,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new u.default({layers:t.layers});return o[f.default.LAYERGROUP]=s,o[f.default.TARGET]=t.target,o[f.default.VIEW]=void 0!==t.view?t.view:new v.default,void 0!==t.controls&&(i=Array.isArray(t.controls)?new a.default(t.controls.slice()):((0,w.assert)("function"==typeof t.controls.getArray,47),t.controls)),void 0!==t.interactions&&(n=Array.isArray(t.interactions)?new a.default(t.interactions.slice()):((0,w.assert)("function"==typeof t.interactions.getArray,48),t.interactions)),r=void 0!==t.overlays?Array.isArray(t.overlays)?new a.default(t.overlays.slice()):((0,w.assert)("function"==typeof t.overlays.getArray,49),t.overlays):new a.default,{controls:i,interactions:n,keyboardEventTarget:e,overlays:r,values:o}}(t);return e.boundHandleBrowserEvent_=e.handleBrowserEvent.bind(e),e.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,e.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:j.DEVICE_PIXEL_RATIO,e.postRenderTimeoutHandle_,e.animationDelayKey_,e.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(e),e.coordinateToPixelTransform_=(0,S.create)(),e.pixelToCoordinateTransform_=(0,S.create)(),e.frameIndex_=0,e.frameState_=null,e.previousExtent_=null,e.viewPropertyListenerKey_=null,e.viewChangeListenerKey_=null,e.layerGroupPropertyListenerKeys_=null,e.viewport_=document.createElement("div"),e.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),e.viewport_.style.position="relative",e.viewport_.style.overflow="hidden",e.viewport_.style.width="100%",e.viewport_.style.height="100%",e.overlayContainer_=document.createElement("div"),e.overlayContainer_.style.position="absolute",e.overlayContainer_.style.zIndex="0",e.overlayContainer_.style.width="100%",e.overlayContainer_.style.height="100%",e.overlayContainer_.style.pointerEvents="none",e.overlayContainer_.className="ol-overlaycontainer",e.viewport_.appendChild(e.overlayContainer_),e.overlayContainerStopEvent_=document.createElement("div"),e.overlayContainerStopEvent_.style.position="absolute",e.overlayContainerStopEvent_.style.zIndex="0",e.overlayContainerStopEvent_.style.width="100%",e.overlayContainerStopEvent_.style.height="100%",e.overlayContainerStopEvent_.style.pointerEvents="none",e.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",e.viewport_.appendChild(e.overlayContainerStopEvent_),e.mapBrowserEventHandler_=null,e.moveTolerance_=t.moveTolerance,e.keyboardEventTarget_=i.keyboardEventTarget,e.keyHandlerKeys_=null,e.controls=i.controls||new a.default,e.interactions=i.interactions||new a.default,e.overlays_=i.overlays,e.overlayIdIndex_={},e.renderer_=null,e.handleResize_,e.postRenderFunctions_=[],e.tileQueue_=new _.default(e.getTilePriority.bind(e),e.handleTileChange_.bind(e)),e.addEventListener((0,n.getChangeEventType)(f.default.LAYERGROUP),e.handleLayerGroupChanged_),e.addEventListener((0,n.getChangeEventType)(f.default.VIEW),e.handleViewChanged_),e.addEventListener((0,n.getChangeEventType)(f.default.SIZE),e.handleSizeChanged_),e.addEventListener((0,n.getChangeEventType)(f.default.TARGET),e.handleTargetChanged_),e.setProperties(i.values),e.controls.forEach(function(t){t.setMap(this)}.bind(e)),e.controls.addEventListener(r.default.ADD,function(t){t.element.setMap(this)}.bind(e)),e.controls.addEventListener(r.default.REMOVE,function(t){t.element.setMap(null)}.bind(e)),e.interactions.forEach(function(t){t.setMap(this)}.bind(e)),e.interactions.addEventListener(r.default.ADD,function(t){t.element.setMap(this)}.bind(e)),e.interactions.addEventListener(r.default.REMOVE,function(t){t.element.setMap(null)}.bind(e)),e.overlays_.forEach(e.addOverlayInternal_.bind(e)),e.overlays_.addEventListener(r.default.ADD,function(t){this.addOverlayInternal_(t.element)}.bind(e)),e.overlays_.addEventListener(r.default.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(e)),e}i.default=F},{"./Collection.js":10,"./CollectionEventType.js":11,"./MapBrowserEvent.js":22,"./MapBrowserEventHandler.js":23,"./MapBrowserEventType.js":24,"./MapEvent.js":25,"./MapEventType.js":26,"./MapProperty.js":27,"./Object.js":28,"./ObjectEventType.js":29,"./TileQueue.js":36,"./View.js":41,"./ViewHint.js":42,"./asserts.js":45,"./dom.js":62,"./events.js":64,"./events/EventType.js":66,"./extent.js":70,"./functions.js":125,"./has.js":159,"./layer/Group.js":189,"./pointer/EventType.js":204,"./proj.js":205,"./render/EventType.js":216,"./size.js":251,"./transform.js":311}],34:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("./events/Target.js")),r=l(t("./events/EventType.js")),o=l(t("./TileState.js")),s=t("./util.js"),a=t("./easing.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=n.default,c(p,u),p.prototype.changed=function(){this.dispatchEvent(r.default.CHANGE)},p.prototype.release=function(){},p.prototype.getKey=function(){return this.key+"/"+this.tileCoord},p.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==o.default.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},p.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==o.default.LOADED){t.interimTile=null;break}t.getState()!=o.default.LOADING&&t.getState()==o.default.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},p.prototype.getTileCoord=function(){return this.tileCoord},p.prototype.getState=function(){return this.state},p.prototype.setState=function(t){if(this.state!==o.default.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},p.prototype.load=function(){(0,s.abstract)()},p.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:(0,a.easeIn)(n/this.transition_)},p.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},p.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},p);function p(t,e,i){var n=u.call(this)||this,r=i||{};return n.tileCoord=t,n.state=e,n.interimTile=null,n.hifi=!0,n.key="",n.transition_=void 0===r.transition?250:r.transition,n.transitionStarts_={},n}i.default=d},{"./TileState.js":38,"./easing.js":63,"./events/EventType.js":66,"./events/Target.js":68,"./util.js":313}],35:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./structs/LRUCache.js"))&&n.__esModule?n:{default:n},o=t("./tilecoord.js");var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=r.default,l(h,s),h.prototype.expireCache=function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()},h.prototype.pruneExceptNewestZ=function(){var t,e;0!==this.getCount()&&(t=this.peekFirstKey(),e=(0,o.fromKey)(t)[0],this.forEach(function(t){t.tileCoord[0]!==e&&(this.remove((0,o.getKey)(t.tileCoord)),t.release())}.bind(this)))},h);function h(){return null!==s&&s.apply(this,arguments)||this}i.default=u},{"./structs/LRUCache.js":288,"./tilecoord.js":305}],36:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.getTilePriority=function(t,e,i,n,r){if(!(t&&i in t.wantedTiles))return l.DROP;if(!t.wantedTiles[i][e.getKey()])return l.DROP;var o=t.viewState.center,s=n[0]-o[0],a=n[1]-o[1];return 65536*Math.log(r)+Math.sqrt(s*s+a*a)/r},i.default=void 0;var r=n(t("./events/EventType.js")),l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./structs/PriorityQueue.js")),o=n(t("./TileState.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function n(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=l.default,c(p,u),p.prototype.enqueue=function(t){var e=u.prototype.enqueue.call(this,t);return e&&t[0].addEventListener(r.default.CHANGE,this.boundHandleTileChange_),e},p.prototype.getTilesLoading=function(){return this.tilesLoading_},p.prototype.handleTileChange=function(t){var e,i=t.target,n=i.getState();(i.hifi&&n===o.default.LOADED||n===o.default.ERROR||n===o.default.EMPTY)&&(i.removeEventListener(r.default.CHANGE,this.boundHandleTileChange_),(e=i.getKey())in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_())},p.prototype.loadMoreTiles=function(t,e){for(var i,n,r=0;this.tilesLoading_<t&&r<e&&0<this.getCount();)n=(i=this.dequeue()[0]).getKey(),i.getState()!==o.default.IDLE||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++r,i.load())},p);function p(e,t){var i=u.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()})||this;return i.boundHandleTileChange_=i.handleTileChange.bind(i),i.tileChangeCallback_=t,i.tilesLoading_=0,i.tilesLoadingKeys_={},i}i.default=d},{"./TileState.js":38,"./events/EventType.js":66,"./structs/PriorityQueue.js":289}],37:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createOrUpdate=function(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new o(t,e,i,n)},i.default=void 0;var o=(n.prototype.contains=function(t){return this.containsXY(t[1],t[2])},n.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},n.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},n.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},n.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},n.prototype.getHeight=function(){return this.maxY-this.minY+1},n.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},n.prototype.getWidth=function(){return this.maxX-this.minX+1},n.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},n);function n(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}i.default=o},{}],38:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},{}],39:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Tile.js"))&&n.__esModule?n:{default:n},o=t("./dom.js"),s=t("./util.js");var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=[],c=(a=r.default,u(d,a),d.prototype.getContext=function(t){var e=(0,s.getUid)(t);return e in this.context_||(this.context_[e]=(0,o.createCanvasContext2D)(1,1,h)),this.context_[e]},d.prototype.hasContext=function(t){return(0,s.getUid)(t)in this.context_},d.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},d.prototype.getReplayState=function(t){var e=(0,s.getUid)(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[e]},d.prototype.load=function(){this.getSourceTiles()},d.prototype.release=function(){for(var t in this.context_)h.push(this.context_[t].canvas);a.prototype.release.call(this)},d);function d(t,e,i,n){var r=a.call(this,t,e,{transition:0})||this;return r.context_={},r.executorGroups={},r.loadingSourceTiles=0,r.errorSourceTileKeys={},r.hitDetectionImageData={},r.replayState_={},r.sourceTiles=null,r.wantedResolution,r.getSourceTiles=n.bind(void 0,r),r.sourceZ=-1,r.hifi=!1,r.wrappedTileCoord=i,r}i.default=c},{"./Tile.js":34,"./dom.js":62,"./util.js":313}],40:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./Tile.js")),r=o(t("./TileState.js"));function o(t){return t&&t.__esModule?t:{default:t}}var a,s,l=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(a=n.default,l(h,a),h.prototype.getFormat=function(){return this.format_},h.prototype.getFeatures=function(){return this.features_},h.prototype.getKey=function(){return this.url_},h.prototype.load=function(){this.state==r.default.IDLE&&(this.setState(r.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))},h.prototype.onLoad=function(t,e){this.setFeatures(t)},h.prototype.onError=function(){this.setState(r.default.ERROR)},h.prototype.setFeatures=function(t){this.features_=t,this.setState(r.default.LOADED)},h.prototype.setLoader=function(t){this.loader_=t},h);function h(t,e,i,n,r,o){var s=a.call(this,t,e,o)||this;return s.extent=null,s.format_=n,s.features_=null,s.loader_,s.projection=null,s.resolution,s.tileLoadFunction_=r,s.url_=i,s}i.default=u},{"./Tile.js":34,"./TileState.js":38}],41:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createCenterConstraint=M,i.createResolutionConstraint=I,i.createRotationConstraint=R,i.isNoopAnimation=k,i.default=void 0;var n=f(t("./Object.js")),s=f(t("./geom/GeometryType.js")),m=f(t("./proj/Units.js")),j=f(t("./ViewHint.js")),a=f(t("./ViewProperty.js")),y=t("./tilegrid/common.js"),_=t("./proj.js"),P=t("./functions.js"),h=t("./coordinate.js"),l=t("./asserts.js"),u=t("./obj.js"),r=t("./centerconstraint.js"),x=t("./math.js"),v=t("./resolutionconstraint.js"),o=t("./rotationconstraint.js"),p=t("./easing.js"),b=t("./extent.js"),c=t("./array.js"),d=t("./geom/Polygon.js");function f(t){return t&&t.__esModule?t:{default:t}}var g,S,w=(S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),E=0,T=(g=n.default,w(O,g),O.prototype.applyOptions_=function(t){var e=I(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var i=M(t),n=e.constraint,r=R(t);this.constraints_={center:i,resolution:n,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},O.prototype.getUpdatedOptions_=function(t){var e=(0,u.assign)({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),(0,u.assign)({},e,t)},O.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),i=0;i<e.length;++i){var n=arguments[i];n.center&&((n=(0,u.assign)({},n)).center=(0,_.fromUserCoordinate)(n.center,this.getProjection())),n.anchor&&((n=(0,u.assign)({},n)).anchor=(0,_.fromUserCoordinate)(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)},O.prototype.animateInternal=function(t){var e,i=arguments.length;if(1<i&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i),!this.isDef()){var n=arguments[i-1];return n.center&&this.setCenterInternal(n.center),void 0!==n.zoom&&this.setZoom(n.zoom),void 0!==n.rotation&&this.setRotation(n.rotation),void(e&&C(e,!0))}for(var r=Date.now(),o=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,l=[],u=0;u<i;++u){var h,c=arguments[u],d={start:r,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||p.inAndOut,callback:e};c.center&&(d.sourceCenter=o,d.targetCenter=c.center.slice(),o=d.targetCenter),void 0!==c.zoom?(d.sourceResolution=s,d.targetResolution=this.getResolutionForZoom(c.zoom),s=d.targetResolution):c.resolution&&(d.sourceResolution=s,d.targetResolution=c.resolution,s=d.targetResolution),void 0!==c.rotation&&(d.sourceRotation=a,h=(0,x.modulo)(c.rotation-a+Math.PI,2*Math.PI)-Math.PI,d.targetRotation=a+h,a=d.targetRotation),k(d)?d.complete=!0:r+=d.duration,l.push(d)}this.animations_.push(l),this.setHint(j.default.ANIMATING,1),this.updateAnimations_()},O.prototype.getAnimating=function(){return 0<this.hints_[j.default.ANIMATING]},O.prototype.getInteracting=function(){return 0<this.hints_[j.default.INTERACTING]},O.prototype.cancelAnimations=function(){var t;this.setHint(j.default.ANIMATING,-this.hints_[j.default.ANIMATING]);for(var e=0,i=this.animations_.length;e<i;++e){var n=this.animations_[e];if(n[0].callback&&C(n[0].callback,!1),!t)for(var r=0,o=n.length;r<o;++r){var s=n[r];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},O.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;0<=i;--i){for(var n,r=this.animations_[i],o=!0,s=0,a=r.length;s<a;++s){var l=r[s];if(!l.complete){var u=t-l.start,h=0<l.duration?u/l.duration:1;1<=h?(l.complete=!0,h=1):o=!1;var c,d,p,f,g,m,y,_,v,b=l.easing(h);if(l.sourceCenter&&(c=l.sourceCenter[0],d=l.sourceCenter[1],p=c+b*(l.targetCenter[0]-c),f=d+b*(l.targetCenter[1]-d),this.targetCenter_=[p,f]),l.sourceResolution&&l.targetResolution&&(g=1===b?l.targetResolution:l.sourceResolution+b*(l.targetResolution-l.sourceResolution),l.anchor&&(m=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(g,0,m,!0),this.targetCenter_=this.calculateCenterZoom(y,l.anchor)),this.targetResolution_=g,this.applyTargetState_(!0)),void 0!==l.sourceRotation&&void 0!==l.targetRotation&&(_=1===b?(0,x.modulo)(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+b*(l.targetRotation-l.sourceRotation),l.anchor&&(v=this.constraints_.rotation(_,!0),this.targetCenter_=this.calculateCenterRotate(v,l.anchor)),this.targetRotation_=_),this.applyTargetState_(!0),e=!0,!l.complete)break}}o&&(this.animations_[i]=null,this.setHint(j.default.ANIMATING,-1),(n=r[0].callback)&&C(n,!0))}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},O.prototype.calculateCenterRotate=function(t,e){var i,n=this.getCenterInternal();return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],(0,h.rotate)(i,t-this.getRotation()),(0,h.add)(i,e)),i},O.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenterInternal(),r=this.getResolution();return void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]),i},O.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e},O.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},O.prototype.getCenter=function(){var t=this.getCenterInternal();return t?(0,_.toUserCoordinate)(t,this.getProjection()):t},O.prototype.getCenterInternal=function(){return this.get(a.default.CENTER)},O.prototype.getConstraints=function(){return this.constraints_},O.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},O.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},O.prototype.calculateExtent=function(t){var e=this.calculateExtentInternal(t);return(0,_.toUserExtent)(e,this.getProjection())},O.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSize_(),i=this.getCenterInternal();(0,l.assert)(i,1);var n=this.getResolution();(0,l.assert)(void 0!==n,2);var r=this.getRotation();return(0,l.assert)(void 0!==r,3),(0,b.getForViewAndSize)(i,n,r,e)},O.prototype.getMaxResolution=function(){return this.maxResolution_},O.prototype.getMinResolution=function(){return this.minResolution_},O.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},O.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},O.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},O.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},O.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},O.prototype.getProjection=function(){return this.projection_},O.prototype.getResolution=function(){return this.get(a.default.RESOLUTION)},O.prototype.getResolutions=function(){return this.resolutions_},O.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal((0,_.fromUserExtent)(t,this.getProjection()),e)},O.prototype.getResolutionForExtentInternal=function(t,e){var i=e||this.getViewportSize_(),n=(0,b.getWidth)(t)/i[0],r=(0,b.getHeight)(t)/i[1];return Math.max(n,r)},O.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*r)}},O.prototype.getRotation=function(){return this.get(a.default.ROTATION)},O.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/r}},O.prototype.getState=function(){var t=this.getCenterInternal(),e=this.getProjection(),i=this.getResolution(),n=this.getRotation();return{center:t.slice(0),projection:void 0!==e?e:null,resolution:i,rotation:n,zoom:this.getZoom()}},O.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},O.prototype.getZoomForResolution=function(t){var e,i,n,r=this.minZoom_||0;return n=this.resolutions_?(r=e=(0,c.linearFindNearest)(this.resolutions_,t,1),i=this.resolutions_[e],e==this.resolutions_.length-1?2:i/this.resolutions_[e+1]):(i=this.maxResolution_,this.zoomFactor_),r+Math.log(i/t)/Math.log(n)},O.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=(0,x.clamp)(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,(0,x.clamp)(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},O.prototype.fit=function(t,e){var i,n,r,o=(0,u.assign)({size:this.getViewportSize_()},e||{});(0,l.assert)(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?((0,l.assert)(!(0,b.isEmpty)(t),25),i=(0,_.fromUserExtent)(t,this.getProjection()),n=(0,d.fromExtent)(i)):t.getType()===s.default.CIRCLE?(i=(0,_.fromUserExtent)(t.getExtent(),this.getProjection()),(n=(0,d.fromExtent)(i)).rotate(this.getRotation(),(0,b.getCenter)(i))):n=(r=(0,_.getUserProjection)())?t.clone().transform(r,this.getProjection()):t,this.fitInternal(n,o)},O.prototype.fitInternal=function(t,e){for(var i=e||{},n=(n=i.size)||this.getViewportSize_(),r=void 0!==i.padding?i.padding:[0,0,0,0],o=void 0!==i.nearest&&i.nearest,s=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0,a=t.getFlatCoordinates(),l=this.getRotation(),u=Math.cos(-l),h=Math.sin(-l),c=1/0,d=1/0,p=-1/0,f=-1/0,g=t.getStride(),m=0,y=a.length;m<y;m+=g)var _=a[m]*u-a[m+1]*h,v=a[m]*h+a[m+1]*u,c=Math.min(c,_),d=Math.min(d,v),p=Math.max(p,_),f=Math.max(f,v);var b=this.getResolutionForExtentInternal([c,d,p,f],[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),b=isNaN(b)?s:Math.max(b,s);b=this.getConstrainedResolution(b,o?0:1),h=-h;var j=(c+p)/2,x=(d+f)/2,S=[(j+=(r[1]-r[3])/2*b)*u-(x+=(r[0]-r[2])/2*b)*h,x*u+j*h],w=i.callback?i.callback:P.VOID;void 0!==i.duration?this.animateInternal({resolution:b,center:this.getConstrainedCenter(S,b),duration:i.duration,easing:i.easing},w):(this.targetResolution_=b,this.targetCenter_=S,this.applyTargetState_(!1,!0),C(w,!0))},O.prototype.centerOn=function(t,e,i){this.centerOnInternal((0,_.fromUserCoordinate)(t,this.getProjection()),e,i)},O.prototype.centerOnInternal=function(t,e,i){var n=this.getRotation(),r=Math.cos(-n),o=Math.sin(-n),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,l=this.getResolution(),u=(s+=(e[0]/2-i[0])*l)*r-(a+=(i[1]-e[1]/2)*l)*(o=-o),h=a*r+s*o;this.setCenterInternal([u,h])},O.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},O.prototype.adjustCenter=function(t){var e=(0,_.toUserCoordinate)(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},O.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},O.prototype.adjustResolution=function(t,e){var i=e&&(0,_.fromUserCoordinate)(e,this.getProjection());this.adjustResolutionInternal(t,i)},O.prototype.adjustResolutionInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()},O.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},O.prototype.adjustRotation=function(t,e){e=e&&(0,_.fromUserCoordinate)(e,this.getProjection()),this.adjustRotationInternal(t,e)},O.prototype.adjustRotationInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()},O.prototype.setCenter=function(t){this.setCenterInternal((0,_.fromUserCoordinate)(t,this.getProjection()))},O.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},O.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},O.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},O.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},O.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},O.prototype.applyTargetState_=function(t,e){var i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,r,i),s=this.constraints_.center(this.targetCenter_,o,r,i);this.get(a.default.ROTATION)!==n&&this.set(a.default.ROTATION,n),this.get(a.default.RESOLUTION)!==o&&this.set(a.default.RESOLUTION,o),this.get(a.default.CENTER)&&(0,h.equals)(this.get(a.default.CENTER),s)||this.set(a.default.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},O.prototype.resolveConstraints=function(t,e,i){var n=void 0!==t?t:200,r=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,r,s),l=this.constraints_.center(this.targetCenter_,a,s);if(0===n&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=l,void this.applyTargetState_();var u=i||(0===n?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===o&&this.getCenterInternal()&&(0,h.equals)(this.getCenterInternal(),l)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:a,duration:n,easing:p.easeOut,anchor:u}))},O.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(j.default.INTERACTING,1)},O.prototype.endInteraction=function(t,e,i){var n=i&&(0,_.fromUserCoordinate)(i,this.getProjection());this.endInteractionInternal(t,e,n)},O.prototype.endInteractionInternal=function(t,e,i){this.setHint(j.default.INTERACTING,-1),this.resolveConstraints(t,e,i)},O.prototype.getConstrainedCenter=function(t,e){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)},O.prototype.getConstrainedZoom=function(t,e){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))},O.prototype.getConstrainedResolution=function(t,e){var i=e||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,n)},O);function O(t){var e=g.call(this)||this,i=(0,u.assign)({},t);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=(0,_.createProjection)(i.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.cancelAnchor_=void 0,i.center&&(i.center=(0,_.fromUserCoordinate)(i.center,e.projection_)),i.extent&&(i.extent=(0,_.fromUserExtent)(i.extent,e.projection_)),e.applyOptions_(i),e}function C(t,e){setTimeout(function(){t(e)},0)}function M(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return(0,r.createExtent)(t.extent,t.constrainOnlyCenter,e)}var i=(0,_.createProjection)(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&i.isGlobal()){var n=i.getExtent().slice();return n[0]=-1/0,n[2]=1/0,(0,r.createExtent)(n,!1,!1)}return r.none}function I(t){var e,i,n,r,o,s=void 0!==t.minZoom?t.minZoom:E,a=void 0!==t.maxZoom?t.maxZoom:28,l=void 0!==t.zoomFactor?t.zoomFactor:2,u=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,d=(0,_.createProjection)(t.projection,"EPSG:3857"),p=d.getExtent(),f=t.constrainOnlyCenter,g=t.extent;return u||g||!d.isGlobal()||(f=!1,g=p),{constraint:void 0!==t.resolutions?(i=(e=t.resolutions)[s],n=void 0!==e[a]?e[a]:e[e.length-1],t.constrainResolution?(0,v.createSnapToResolutions)(e,h,!f&&g,c):(0,v.createMinMaxResolution)(i,n,h,!f&&g,c)):(o=(r=(p?Math.max((0,b.getWidth)(p),(0,b.getHeight)(p)):360*_.METERS_PER_UNIT[m.default.DEGREES]/d.getMetersPerUnit())/y.DEFAULT_TILE_SIZE/Math.pow(2,E))/Math.pow(2,28-E),void 0!==(i=t.maxResolution)?s=0:i=r/Math.pow(l,s),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(l,a):r/Math.pow(l,a):o),a=s+Math.floor(Math.log(i/n)/Math.log(l)),n=i/Math.pow(l,a-s),t.constrainResolution?(0,v.createSnapToPower)(l,i,n,h,!f&&g,c):(0,v.createMinMaxResolution)(i,n,h,!f&&g,c)),maxResolution:i,minResolution:n,minZoom:s,zoomFactor:l}}function R(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(0,o.createSnapToZero)():!1!==e&&"number"==typeof e?(0,o.createSnapToN)(e):o.none}return o.disable}function k(t){return!(t.sourceCenter&&t.targetCenter&&!(0,h.equals)(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}i.default=T},{"./Object.js":28,"./ViewHint.js":42,"./ViewProperty.js":43,"./array.js":44,"./asserts.js":45,"./centerconstraint.js":46,"./coordinate.js":60,"./easing.js":63,"./extent.js":70,"./functions.js":125,"./geom/GeometryType.js":131,"./geom/Polygon.js":138,"./math.js":201,"./obj.js":203,"./proj.js":205,"./proj/Units.js":207,"./resolutionconstraint.js":249,"./rotationconstraint.js":250,"./tilegrid/common.js":309}],42:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={ANIMATING:0,INTERACTING:1}},{}],43:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"}},{}],44:[function(t,e,i){"use strict";function u(t,e){return e<t?1:t<e?-1:0}Object.defineProperty(i,"__esModule",{value:!0}),i.binarySearch=function(t,e,i){for(var n,r,o=i||u,s=0,a=t.length,l=!1;s<a;)(r=+o(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,l=!r);return l?s:~s},i.numberSafeCompareFunction=u,i.includes=function(t,e){return 0<=t.indexOf(e)},i.linearFindNearest=function(t,e,i){var n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;var r=void 0;if(0<i){for(r=1;r<n;++r)if(t[r]<e)return r-1}else if(i<0){for(r=1;r<n;++r)if(t[r]<=e)return r}else for(r=1;r<n;++r){if(t[r]==e)return r;if(t[r]<e)return t[r-1]-e<e-t[r]?r-1:r}return n-1},i.reverseSubArray=function(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}},i.extend=function(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]},i.remove=function(t,e){var i=t.indexOf(e),n=-1<i;return n&&t.splice(i,1),n},i.find=function(t,e){for(var i,n=t.length>>>0,r=0;r<n;r++)if(e(i=t[r],r,t))return i;return null},i.equals=function(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0},i.stableSort=function(t,i){for(var e=t.length,n=Array(t.length),r=0;r<e;r++)n[r]={index:r,value:t[r]};for(n.sort(function(t,e){return i(t.value,e.value)||t.index-e.index}),r=0;r<t.length;r++)t[r]=n[r].value},i.findIndex=function(i,n){var r;return i.every(function(t,e){return!n(t,r=e,i)})?-1:r},i.isSorted=function(n,t,r){var o=t||u;return n.every(function(t,e){if(0===e)return!0;var i=o(n[e-1],t);return!(0<i||r&&0===i)})}},{}],45:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.assert=function(t,e){if(!t)throw new r.default(e)};var n,r=(n=t("./AssertionError.js"))&&n.__esModule?n:{default:n}},{"./AssertionError.js":9}],46:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createExtent=function(p,f,g){return function(t,e,i,n){if(t){var r=f?0:i[0]*e,o=f?0:i[1]*e,s=p[0]+r/2,a=p[2]-r/2,l=p[1]+o/2,u=p[3]-o/2;a<s&&(a=s=(a+s)/2),u<l&&(u=l=(u+l)/2);var h=(0,m.clamp)(t[0],s,a),c=(0,m.clamp)(t[1],l,u),d=30*e;return n&&g&&(h+=-d*Math.log(1+Math.max(0,s-t[0])/d)+d*Math.log(1+Math.max(0,t[0]-a)/d),c+=-d*Math.log(1+Math.max(0,l-t[1])/d)+d*Math.log(1+Math.max(0,t[1]-u)/d)),[h,c]}}},i.none=function(t){return t};var m=t("./math.js")},{"./math.js":201}],47:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.asString=function(t){return"string"==typeof t?t:a(t)},i.asArray=function(t){return Array.isArray(t)?t:s(t)},i.normalize=p,i.toString=a,i.isStringColor=function(t){return c.test(t)&&(t=d(t)),h.test(t)||0===t.indexOf("rgba(")||0===t.indexOf("rgb(")},i.fromString=void 0;var u=t("./asserts.js"),n=t("./math.js"),h=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,c=/^([a-z]*)$|^hsla?\(.*\)$/i;function d(t){var e=document.createElement("div");if(e.style.color=t,""===e.style.color)return"";document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}var r,o,s=(r={},o=0,function(t){var e;if(r.hasOwnProperty(t))e=r[t];else{if(1024<=o){var i=0;for(var n in r)0==(3&i++)&&(delete r[n],--o)}e=function(t){var e,i,n,r,o,s,a,l;return c.exec(t)&&(t=d(t)),h.exec(t)?(s=t.length-1,a=s<=4?1:2,l=4==s||8==s,e=parseInt(t.substr(1+0*a,a),16),i=parseInt(t.substr(1+a,a),16),n=parseInt(t.substr(1+2*a,a),16),r=l?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,l&&(r=(r<<4)+r)),o=[e,i,n,r/255]):0==t.indexOf("rgba(")?p(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),p(o)):(0,u.assert)(!1,14),o}(t),r[t]=e,++o}return e});function p(t){return t[0]=(0,n.clamp)(t[0]+.5|0,0,255),t[1]=(0,n.clamp)(t[1]+.5|0,0,255),t[2]=(0,n.clamp)(t[2]+.5|0,0,255),t[3]=(0,n.clamp)(t[3],0,1),t}function a(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}i.fromString=s},{"./asserts.js":45,"./math.js":201}],48:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.asColorLike=function(t){return Array.isArray(t)?(0,n.toString)(t):t};var n=t("./color.js")},{"./color.js":47}],49:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.defaults=function(t){var e=t||{},i=new r.default;return void 0!==e.zoom&&!e.zoom||i.push(new s.default(e.zoomOptions)),void 0!==e.rotate&&!e.rotate||i.push(new o.default(e.rotateOptions)),void 0!==e.attribution&&!e.attribution||i.push(new n.default(e.attributionOptions)),i},Object.defineProperty(i,"Attribution",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"Rotate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"Zoom",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"Control",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"FullScreen",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"MousePosition",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"OverviewMap",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"ScaleLine",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"ZoomSlider",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"ZoomToExtent",{enumerable:!0,get:function(){return p.default}});var n=f(t("./control/Attribution.js")),r=f(t("./Collection.js")),o=f(t("./control/Rotate.js")),s=f(t("./control/Zoom.js")),a=f(t("./control/Control.js")),l=f(t("./control/FullScreen.js")),u=f(t("./control/MousePosition.js")),h=f(t("./control/OverviewMap.js")),c=f(t("./control/ScaleLine.js")),d=f(t("./control/ZoomSlider.js")),p=f(t("./control/ZoomToExtent.js"));function f(t){return t&&t.__esModule?t:{default:t}}},{"./Collection.js":10,"./control/Attribution.js":50,"./control/Control.js":51,"./control/FullScreen.js":52,"./control/MousePosition.js":53,"./control/OverviewMap.js":54,"./control/Rotate.js":55,"./control/ScaleLine.js":56,"./control/Zoom.js":57,"./control/ZoomSlider.js":58,"./control/ZoomToExtent.js":59}],50:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(t("./Control.js")),c=r(t("../events/EventType.js")),d=t("../css.js"),s=t("../array.js"),p=t("../layer/Layer.js"),a=t("../dom.js");function r(t){return t&&t.__esModule?t:{default:t}}var f,o,l=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(f=n.default,l(h,f),h.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,r=0,o=n.length;r<o;++r){var s=n[r];if((0,p.inView)(s,t.viewState)){var a=s.layer.getSource();if(a){var l=a.getAttributions();if(l){var u=l(t);if(u)if(this.overrideCollapsible_||!1!==a.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(u))for(var h=0,c=u.length;h<c;++h)u[h]in e||(i.push(u[h]),e[u[h]]=!0);else u in e||(i.push(u),e[u]=!0)}}}}return i},h.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=0<e.length;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!(0,s.equals)(e,this.renderedAttributions_)){(0,a.removeChildren)(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},h.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},h.prototype.handleToggle_=function(){this.element.classList.toggle(d.CLASS_COLLAPSED),this.collapsed_?(0,a.replaceNode)(this.collapseLabel_,this.label_):(0,a.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},h.prototype.getCollapsible=function(){return this.collapsible_},h.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},h.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},h.prototype.getCollapsed=function(){return this.collapsed_},h.prototype.render=function(t){this.updateElement_(t.frameState)},h);function h(t){var e=this,i=t||{};(e=f.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this).ulElement_=document.createElement("ul"),e.collapsed_=void 0===i.collapsed||i.collapsed,e.overrideCollapsible_=void 0!==i.collapsible,e.collapsible_=void 0===i.collapsible||i.collapsible,e.collapsible_||(e.collapsed_=!1);var n=void 0!==i.className?i.className:"ol-attribution",r=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"»";"string"==typeof o?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=o):e.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(e.label_=document.createElement("span"),e.label_.textContent=s):e.label_=s;var a=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=r,l.appendChild(a),l.addEventListener(c.default.CLICK,e.handleClick_.bind(e),!1);var u=n+" "+d.CLASS_UNSELECTABLE+" "+d.CLASS_CONTROL+(e.collapsed_&&e.collapsible_?" "+d.CLASS_COLLAPSED:"")+(e.collapsible_?"":" ol-uncollapsible"),h=e.element;return h.className=u,h.appendChild(e.ulElement_),h.appendChild(l),e.renderedAttributions_=[],e.renderedVisible_=!0,e}i.default=u},{"../array.js":44,"../css.js":61,"../dom.js":62,"../events/EventType.js":66,"../layer/Layer.js":192,"./Control.js":51}],51:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("../Object.js")),r=l(t("../MapEventType.js")),o=t("../functions.js"),s=t("../events.js"),a=t("../dom.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=n.default,c(p,u),p.prototype.disposeInternal=function(){(0,a.removeNode)(this.element),u.prototype.disposeInternal.call(this)},p.prototype.getMap=function(){return this.map_},p.prototype.setMap=function(t){this.map_&&(0,a.removeNode)(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)(0,s.unlistenByKey)(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,this.map_&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==o.VOID&&this.listenerKeys.push((0,s.listen)(t,r.default.POSTRENDER,this.render,this)),t.render())},p.prototype.render=function(t){},p.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},p);function p(t){var e=u.call(this)||this,i=t.element;return!i||t.target||i.style.pointerEvents||(i.style.pointerEvents="auto"),e.element=i||null,e.target_=null,e.map_=null,e.listenerKeys=[],t.render&&(e.render=t.render),t.target&&e.setTarget(t.target),e}i.default=d},{"../MapEventType.js":26,"../Object.js":28,"../dom.js":62,"../events.js":64,"../functions.js":125}],52:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./Control.js")),l=s(t("../events/EventType.js")),u=t("../css.js"),r=t("../events.js"),o=t("../dom.js");function s(t){return t&&t.__esModule?t:{default:t}}var h,a,c=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],p="enterfullscreen",f="leavefullscreen",g=(h=n.default,c(m,h),m.prototype.handleClick_=function(t){t.preventDefault(),this.handleFullScreen_()},m.prototype.handleFullScreen_=function(){var t,e,i;!y()||(t=this.getMap())&&(_()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():(e=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:t.getTargetElement(),this.keys_?(i=e).webkitRequestFullscreen?i.webkitRequestFullscreen():v(i):v(e)))},m.prototype.handleFullScreenChange_=function(){var t=this.getMap();_()?(this.setClassName_(this.button_,!0),(0,o.replaceNode)(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(p)):(this.setClassName_(this.button_,!1),(0,o.replaceNode)(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(f)),t&&t.updateSize()},m.prototype.setClassName_=function(t,e){var i=this.cssClassName_+"-true",n=this.cssClassName_+"-false",r=e?i:n;t.classList.remove(i),t.classList.remove(n),t.classList.add(r)},m.prototype.setMap=function(t){if(h.prototype.setMap.call(this,t),t)for(var e=0,i=d.length;e<i;++e)this.listenerKeys.push((0,r.listen)(document,d[e],this.handleFullScreenChange_,this))},m);function m(t){var e=this,i=t||{};(e=h.call(this,{element:document.createElement("div"),target:i.target})||this).cssClassName_=void 0!==i.className?i.className:"ol-full-screen";var n=void 0!==i.label?i.label:"⤢";e.labelNode_="string"==typeof n?document.createTextNode(n):n;var r=void 0!==i.labelActive?i.labelActive:"×";e.labelActiveNode_="string"==typeof r?document.createTextNode(r):r,e.button_=document.createElement("button");var o=i.tipLabel?i.tipLabel:"Toggle full-screen";e.setClassName_(e.button_,_()),e.button_.setAttribute("type","button"),e.button_.title=o,e.button_.appendChild(e.labelNode_),e.button_.addEventListener(l.default.CLICK,e.handleClick_.bind(e),!1);var s=e.cssClassName_+" "+u.CLASS_UNSELECTABLE+" "+u.CLASS_CONTROL+" "+(y()?"":u.CLASS_UNSUPPORTED),a=e.element;return a.className=s,a.appendChild(e.button_),e.keys_=void 0!==i.keys&&i.keys,e.source_=i.source,e}function y(){var t=document.body;return t.webkitRequestFullscreen||t.msRequestFullscreen&&document.msFullscreenEnabled||t.requestFullscreen&&document.fullscreenEnabled}function _(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function v(t){t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}i.default=g},{"../css.js":61,"../dom.js":62,"../events.js":64,"../events/EventType.js":66,"./Control.js":51}],53:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("./Control.js")),r=l(t("../pointer/EventType.js")),o=t("../Object.js"),s=t("../proj.js"),a=t("../events.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d="projection",p="coordinateFormat",f=(u=n.default,c(g,u),g.prototype.handleProjectionChanged_=function(){this.transform_=null},g.prototype.getCoordinateFormat=function(){return this.get(p)},g.prototype.getProjection=function(){return this.get(d)},g.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))},g.prototype.handleMouseOut=function(t){this.updateHTML_(null)},g.prototype.setMap=function(t){var e;u.prototype.setMap.call(this,t),t&&(e=t.getViewport(),this.listenerKeys.push((0,a.listen)(e,r.default.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,a.listen)(e,r.default.POINTEROUT,this.handleMouseOut,this)))},g.prototype.setCoordinateFormat=function(t){this.set(p,t)},g.prototype.setProjection=function(t){this.set(d,(0,s.get)(t))},g.prototype.updateHTML_=function(t){var e,i,n,r,o=this.undefinedHTML_;t&&this.mapProjection_&&(this.transform_||(e=this.getProjection(),this.transform_=e?(0,s.getTransformFromProjections)(this.mapProjection_,e):s.identityTransform),(i=this.getMap().getCoordinateFromPixelInternal(t))&&((n=(0,s.getUserProjection)())&&(this.transform_=(0,s.getTransformFromProjections)(this.mapProjection_,n)),this.transform_(i,i),o=(r=this.getCoordinateFormat())?r(i):i.toString())),this.renderedHTML_&&o===this.renderedHTML_||(this.element.innerHTML=o,this.renderedHTML_=o)},g.prototype.render=function(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null},g);function g(t){var e=this,i=t||{},n=document.createElement("div");return n.className=void 0!==i.className?i.className:"ol-mouse-position",(e=u.call(this,{element:n,render:i.render,target:i.target})||this).addEventListener((0,o.getChangeEventType)(d),e.handleProjectionChanged_),i.coordinateFormat&&e.setCoordinateFormat(i.coordinateFormat),i.projection&&e.setProjection(i.projection),e.undefinedHTML_=void 0!==i.undefinedHTML?i.undefinedHTML:"&#160;",e.renderOnMouseOut_=!!e.undefinedHTML_,e.renderedHTML_=n.innerHTML,e.mapProjection_=null,e.transform_=null,e}i.default=f},{"../Object.js":28,"../events.js":64,"../pointer/EventType.js":204,"../proj.js":205,"./Control.js":51}],54:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=m(t("../renderer/Composite.js")),r=m(t("./Control.js")),_=m(t("../events/EventType.js")),o=m(t("../MapEventType.js")),s=m(t("../MapProperty.js")),a=m(t("../ObjectEventType.js")),v=m(t("../Overlay.js")),b=m(t("../OverlayPositioning.js")),l=m(t("../PluggableMap.js")),u=m(t("../View.js")),h=m(t("../ViewProperty.js")),j=t("../css.js"),d=t("../extent.js"),c=t("../Object.js"),p=t("../events.js"),f=t("../geom/Polygon.js"),g=t("../dom.js");function m(t){return t&&t.__esModule?t:{default:t}}var x,y,S,w=(S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),P=(y=l.default,w(O,y),O.prototype.createRenderer=function(){return new n.default(this)},O),E=(x=r.default,w(T,x),T.prototype.setMap=function(t){var e,i,n=this.getMap();t!==n&&(n&&((e=n.getView())&&this.unbindView_(e),this.ovmap_.setTarget(null)),x.prototype.setMap.call(this,t),t&&(this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,p.listen)(t,a.default.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),(i=t.getView())&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))))},T.prototype.handleMapPropertyChange_=function(t){var e,i;t.key===s.default.VIEW&&((e=t.oldValue)&&this.unbindView_(e),i=this.getMap().getView(),this.bindView_(i))},T.prototype.bindView_=function(t){var e;this.view_||(e=new u.default({projection:t.getProjection()}),this.ovmap_.setView(e)),t.addEventListener((0,c.getChangeEventType)(h.default.ROTATION),this.boundHandleRotationChanged_),this.handleRotationChanged_()},T.prototype.unbindView_=function(t){t.removeEventListener((0,c.getChangeEventType)(h.default.ROTATION),this.boundHandleRotationChanged_)},T.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},T.prototype.validateExtent_=function(){var t,e,i,n,r,o,s,a,l,u,h=this.getMap(),c=this.ovmap_;h.isRendered()&&c.isRendered()&&(t=h.getSize(),e=h.getView().calculateExtentInternal(t),this.viewExtent_&&(0,d.equals)(e,this.viewExtent_)||(this.viewExtent_=e,i=c.getSize(),n=c.getView().calculateExtentInternal(i),r=c.getPixelFromCoordinateInternal((0,d.getTopLeft)(e)),o=c.getPixelFromCoordinateInternal((0,d.getBottomRight)(e)),s=Math.abs(r[0]-o[0]),a=Math.abs(r[1]-o[1]),l=i[0],u=i[1],s<.1*l||a<.1*u||.75*l<s||.75*u<a?this.resetExtent_():(0,d.containsExtent)(n,e)||this.recenter_()))},T.prototype.resetExtent_=function(){var t=this.getMap(),e=this.ovmap_,i=t.getSize(),n=t.getView().calculateExtentInternal(i),r=e.getView(),o=Math.log(7.5)/Math.LN2,s=1/(.1*Math.pow(2,o/2));(0,d.scaleFromCenter)(n,s),r.fitInternal((0,f.fromExtent)(n))},T.prototype.recenter_=function(){var t=this.getMap(),e=this.ovmap_,i=t.getView();e.getView().setCenterInternal(i.getCenterInternal())},T.prototype.updateBox_=function(){var t,e,i,n,r,o,s,a,l,u,h,c,d=this.getMap(),p=this.ovmap_;d.isRendered()&&p.isRendered()&&(t=d.getSize(),e=d.getView(),i=p.getView(),n=this.rotateWithView_?0:-e.getRotation(),r=this.boxOverlay_,o=this.boxOverlay_.getElement(),s=e.getCenterInternal(),a=e.getResolution(),l=i.getResolution(),u=t[0]*a/l,h=t[1]*a/l,r.setPosition(s),o&&(o.style.width=u+"px",o.style.height=h+"px",c="rotate("+n+"rad)",o.style.transform=c))},T.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},T.prototype.handleToggle_=function(){this.element.classList.toggle(j.CLASS_COLLAPSED),this.collapsed_?(0,g.replaceNode)(this.collapseLabel_,this.label_):(0,g.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var t=this.ovmap_;if(!this.collapsed_){if(t.isRendered())return this.viewExtent_=void 0,void t.render();t.updateSize(),this.resetExtent_(),(0,p.listenOnce)(t,o.default.POSTRENDER,function(t){this.updateBox_()},this)}},T.prototype.getCollapsible=function(){return this.collapsible_},T.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},T.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},T.prototype.getCollapsed=function(){return this.collapsed_},T.prototype.getRotateWithView=function(){return this.rotateWithView_},T.prototype.setRotateWithView=function(t){this.rotateWithView_!==t&&(this.rotateWithView_=t,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},T.prototype.getOverviewMap=function(){return this.ovmap_},T.prototype.render=function(t){this.validateExtent_(),this.updateBox_()},T);function T(t){var e=this,i=t||{};(e=x.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this).boundHandleRotationChanged_=e.handleRotationChanged_.bind(e),e.collapsed_=void 0===i.collapsed||i.collapsed,e.collapsible_=void 0===i.collapsible||i.collapsible,e.collapsible_||(e.collapsed_=!1),e.rotateWithView_=void 0!==i.rotateWithView&&i.rotateWithView;var n=(e.viewExtent_=void 0)!==i.className?i.className:"ol-overviewmap",r=void 0!==i.tipLabel?i.tipLabel:"Overview map",o=void 0!==i.collapseLabel?i.collapseLabel:"«";"string"==typeof o?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=o):e.collapseLabel_=o;var s=void 0!==i.label?i.label:"»";"string"==typeof s?(e.label_=document.createElement("span"),e.label_.textContent=s):e.label_=s;var a=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=r,l.appendChild(a),l.addEventListener(_.default.CLICK,e.handleClick_.bind(e),!1),e.ovmapDiv_=document.createElement("div"),e.ovmapDiv_.className="ol-overviewmap-map",e.view_=i.view,e.ovmap_=new P({view:i.view});var u=e.ovmap_;i.layers&&i.layers.forEach(function(t){u.addLayer(t)});var h=document.createElement("div");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",e.boxOverlay_=new v.default({position:[0,0],positioning:b.default.CENTER_CENTER,element:h}),e.ovmap_.addOverlay(e.boxOverlay_);var c=n+" "+j.CLASS_UNSELECTABLE+" "+j.CLASS_CONTROL+(e.collapsed_&&e.collapsible_?" "+j.CLASS_COLLAPSED:"")+(e.collapsible_?"":" ol-uncollapsible"),d=e.element;d.className=c,d.appendChild(e.ovmapDiv_),d.appendChild(l);function p(t){var e={clientX:t.clientX,clientY:t.clientY},i=u.getEventCoordinateInternal(e);m.setPosition(i)}function f(t){var e=u.getEventCoordinateInternal(t);g.getMap().getView().setCenterInternal(e),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f)}var g=e,m=e.boxOverlay_,y=e.boxOverlay_.getElement();return y.addEventListener("mousedown",function(){window.addEventListener("mousemove",p),window.addEventListener("mouseup",f)}),e}function O(){return null!==y&&y.apply(this,arguments)||this}i.default=E},{"../MapEventType.js":26,"../MapProperty.js":27,"../Object.js":28,"../ObjectEventType.js":29,"../Overlay.js":31,"../OverlayPositioning.js":32,"../PluggableMap.js":33,"../View.js":41,"../ViewProperty.js":43,"../css.js":61,"../dom.js":62,"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"../geom/Polygon.js":138,"../renderer/Composite.js":232,"./Control.js":51}],55:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./Control.js")),u=o(t("../events/EventType.js")),h=t("../css.js"),r=t("../easing.js");function o(t){return t&&t.__esModule?t:{default:t}}var c,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(c=n.default,a(d,c),d.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},d.prototype.resetNorth_=function(){var t,e=this.getMap().getView();!e||void 0!==(t=e.getRotation())&&(0<this.duration_&&t%(2*Math.PI)!=0?e.animate({rotation:0,duration:this.duration_,easing:r.easeOut}):e.setRotation(0))},d.prototype.render=function(t){var e,i,n,r=t.frameState;r&&((e=r.viewState.rotation)!=this.rotation_&&(i="rotate("+e+"rad)",this.autoHide_&&((n=this.element.classList.contains(h.CLASS_HIDDEN))||0!==e?n&&0!==e&&this.element.classList.remove(h.CLASS_HIDDEN):this.element.classList.add(h.CLASS_HIDDEN)),this.label_.style.transform=i),this.rotation_=e)},d);function d(t){var e=this,i=t||{},e=c.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this,n=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"⇧";e.label_=null,"string"==typeof r?(e.label_=document.createElement("span"),e.label_.className="ol-compass",e.label_.textContent=r):(e.label_=r,e.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(e.label_),s.addEventListener(u.default.CLICK,e.handleClick_.bind(e),!1);var a=n+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,l=e.element;return l.className=a,l.appendChild(s),e.callResetNorth_=i.resetNorth?i.resetNorth:void 0,e.duration_=void 0!==i.duration?i.duration:250,e.autoHide_=void 0===i.autoHide||i.autoHide,e.rotation_=void 0,e.autoHide_&&e.element.classList.add(h.CLASS_HIDDEN),e}i.default=l},{"../css.js":61,"../easing.js":63,"../events/EventType.js":66,"./Control.js":51}],56:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.Units=void 0;var n=s(t("./Control.js")),m=s(t("../proj/Units.js")),r=t("../css.js"),y=t("../proj.js"),_=t("../asserts.js"),o=t("../Object.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};i.Units=v;var u,b=[1,2,5],j=25.4/.28,h=(u=n.default,l(c,u),c.prototype.getUnits=function(){return this.get("units")},c.prototype.handleUnitsChanged_=function(){this.updateElement_()},c.prototype.setUnits=function(t){this.set("units",t)},c.prototype.setDpi=function(t){this.dpi_=t},c.prototype.updateElement_=function(){var t=this.viewState_;if(t){var e,i=t.center,n=t.projection,r=this.getUnits(),o=r==v.DEGREES?m.default.DEGREES:m.default.METERS,s=(0,y.getPointResolution)(n,t.resolution,i,o),a=this.minWidth_*(this.dpi_||j)/j,l=a*s,u="";r==v.DEGREES?(l*=e=y.METERS_PER_UNIT[m.default.DEGREES])<e/60?(u="″",s*=3600):l<e?(u="′",s*=60):u="°":r==v.IMPERIAL?l<.9144?(u="in",s/=.0254):l<1609.344?(u="ft",s/=.3048):(u="mi",s/=1609.344):r==v.NAUTICAL?(s/=1852,u="nm"):r==v.METRIC?l<.001?(u="μm",s*=1e6):l<1?(u="mm",s*=1e3):l<1e3?u="m":(u="km",s/=1e3):r==v.US?l<.9144?(u="in",s*=39.37):l<1609.344?(u="ft",s/=.30480061):(u="mi",s/=1609.3472):(0,_.assert)(!1,33);for(var h,c,d=3*Math.floor(Math.log(a*s)/Math.log(10));;){h=Math.floor(d/3);var p=Math.pow(10,h),f=b[(d%3+3)%3]*p,g=Math.round(f/s);if(isNaN(g))return this.element.style.display="none",void(this.renderedVisible_=!1);if(a<=g)break;++d}c=this.scaleBar_?this.createScaleBar(g,f,u):f.toFixed(h<0?-h:0)+" "+u,this.renderedHTML_!=c&&(this.innerElement_.innerHTML=c,this.renderedHTML_=c),this.renderedWidth_!=g&&(this.innerElement_.style.width=g+"px",this.renderedWidth_=g),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},c.prototype.createScaleBar=function(t,e,i){for(var n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),r=[],o=t/this.scaleBarSteps_,s="#ffffff",a=0;a<this.scaleBarSteps_;a++)0===a&&r.push(this.createMarker("absolute",a)),r.push('<div><div class="ol-scale-singlebar" style="width: '+o+"px;background-color: "+s+';"></div>'+this.createMarker("relative",a)+(a%2==0||2===this.scaleBarSteps_?this.createStepText(a,t,!1,e,i):"")+"</div>"),a===this.scaleBarSteps_-1&&r.push(this.createStepText(a+1,t,!0,e,i)),s="#ffffff"===s?"#000000":"#ffffff";return'<div style="display: flex;">'+(this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+n+"</div>":"")+r.join("")+"</div>"},c.prototype.createMarker=function(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'},c.prototype.createStepText=function(t,e,i,n,r){var o=(0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+r);return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:e/this.scaleBarSteps_*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:e/this.scaleBarSteps_*2)+"px;left: "+(i?e+"px":"unset")+';">'+o+"</div>"},c.prototype.getScaleForResolution=function(){var t=(0,y.getPointResolution)(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center),e=this.dpi_||j,i=this.viewState_.projection.getMetersPerUnit();return parseFloat(t.toString())*i*39.37*e},c.prototype.render=function(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()},c);function c(t){var e=this,i=t||{},n=void 0!==i.className?i.className:i.bar?"ol-scale-bar":"ol-scale-line";return(e=u.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this).innerElement_=document.createElement("div"),e.innerElement_.className=n+"-inner",e.element.className=n+" "+r.CLASS_UNSELECTABLE,e.element.appendChild(e.innerElement_),e.viewState_=null,e.minWidth_=void 0!==i.minWidth?i.minWidth:64,e.renderedVisible_=!1,e.renderedWidth_=void 0,e.renderedHTML_="",e.addEventListener((0,o.getChangeEventType)("units"),e.handleUnitsChanged_),e.setUnits(i.units||v.METRIC),e.scaleBar_=i.bar||!1,e.scaleBarSteps_=i.steps||4,e.scaleBarText_=i.text||!1,e.dpi_=i.dpi||void 0,e}i.default=h},{"../Object.js":28,"../asserts.js":45,"../css.js":61,"../proj.js":205,"../proj/Units.js":207,"./Control.js":51}],57:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./Control.js")),p=o(t("../events/EventType.js")),f=t("../css.js"),r=t("../easing.js");function o(t){return t&&t.__esModule?t:{default:t}}var g,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(g=n.default,a(u,g),u.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},u.prototype.zoomByDelta_=function(t){var e,i,n=this.getMap().getView();!n||void 0!==(e=n.getZoom())&&(i=n.getConstrainedZoom(e+t),0<this.duration_?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:i,duration:this.duration_,easing:r.easeOut})):n.setZoom(i))},u);function u(t){var e=this,i=t||{},e=g.call(this,{element:document.createElement("div"),target:i.target})||this,n=void 0!==i.className?i.className:"ol-zoom",r=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"−",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",l=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=n+"-in",u.setAttribute("type","button"),u.title=a,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener(p.default.CLICK,e.handleClick_.bind(e,r),!1);var h=document.createElement("button");h.className=n+"-out",h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(p.default.CLICK,e.handleClick_.bind(e,-r),!1);var c=n+" "+f.CLASS_UNSELECTABLE+" "+f.CLASS_CONTROL,d=e.element;return d.className=c,d.appendChild(u),d.appendChild(h),e.duration_=void 0!==i.duration?i.duration:250,e}i.default=l},{"../css.js":61,"../easing.js":63,"../events/EventType.js":66,"./Control.js":51}],58:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=c(t("./Control.js")),s=c(t("../events/EventType.js")),a=c(t("../pointer/EventType.js")),l=t("../css.js"),r=t("../math.js"),o=t("../easing.js"),u=t("../events.js"),h=t("../events/Event.js");function c(t){return t&&t.__esModule?t:{default:t}}var d,p,f=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),g=0,m=1,y=(d=n.default,f(_,d),_.prototype.setMap=function(t){d.prototype.setMap.call(this,t),t&&t.render()},_.prototype.initSlider_=function(){var t=this.element,e=t.offsetWidth,i=t.offsetHeight;if(0===e&&0===i)return this.sliderInitialized_=!1;var n=t.firstElementChild,r=getComputedStyle(n),o=n.offsetWidth+parseFloat(r.marginRight)+parseFloat(r.marginLeft),s=n.offsetHeight+parseFloat(r.marginTop)+parseFloat(r.marginBottom);return this.thumbSize_=[o,s],i<e?(this.direction_=m,this.widthLimit_=e-o):(this.direction_=g,this.heightLimit_=i-s),this.sliderInitialized_=!0},_.prototype.handleContainerClick_=function(t){var e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),n=this.getResolutionForPosition_(i),r=e.getConstrainedZoom(e.getZoomForResolution(n));e.animateInternal({zoom:r,duration:this.duration_,easing:o.easeOut})},_.prototype.handleDraggerStart_=function(t){var e,i,n;this.dragging_||t.target!==this.element.firstElementChild||(e=this.element.firstElementChild,this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length&&(i=this.handleDraggerDrag_,n=this.handleDraggerEnd_,this.dragListenerKeys_.push((0,u.listen)(document,a.default.POINTERMOVE,i,this),(0,u.listen)(document,a.default.POINTERUP,n,this))))},_.prototype.handleDraggerDrag_=function(t){var e,i,n;this.dragging_&&(e=t.clientX-this.startX_,i=t.clientY-this.startY_,n=this.getRelativePosition_(e,i),this.currentResolution_=this.getResolutionForPosition_(n),this.getMap().getView().setResolution(this.currentResolution_))},_.prototype.handleDraggerEnd_=function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(u.unlistenByKey),this.dragListenerKeys_.length=0)},_.prototype.setThumbPosition_=function(t){var e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==m?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"},_.prototype.getRelativePosition_=function(t,e){var i=this.direction_===m?t/this.widthLimit_:e/this.heightLimit_;return(0,r.clamp)(i,0,1)},_.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},_.prototype.getPositionForResolution_=function(t){var e=this.getMap().getView().getValueForResolutionFunction();return(0,r.clamp)(1-e(t),0,1)},_.prototype.render=function(t){var e;t.frameState&&(this.sliderInitialized_||this.initSlider_())&&(e=t.frameState.viewState.resolution,this.currentResolution_=e,this.setThumbPosition_(e))},_);function _(t){var e=this,i=t||{};(e=d.call(this,{element:document.createElement("div"),render:i.render})||this).dragListenerKeys_=[],e.currentResolution_=void 0,e.direction_=g,e.dragging_,e.heightLimit_=0,e.widthLimit_=0,e.startX_,e.startY_,e.thumbSize_=null,e.sliderInitialized_=!1,e.duration_=void 0!==i.duration?i.duration:200;var n=void 0!==i.className?i.className:"ol-zoomslider",r=document.createElement("button");r.setAttribute("type","button"),r.className=n+"-thumb "+l.CLASS_UNSELECTABLE;var o=e.element;return o.className=n+" "+l.CLASS_UNSELECTABLE+" "+l.CLASS_CONTROL,o.appendChild(r),o.addEventListener(a.default.POINTERDOWN,e.handleDraggerStart_.bind(e),!1),o.addEventListener(a.default.POINTERMOVE,e.handleDraggerDrag_.bind(e),!1),o.addEventListener(a.default.POINTERUP,e.handleDraggerEnd_.bind(e),!1),o.addEventListener(s.default.CLICK,e.handleContainerClick_.bind(e),!1),r.addEventListener(s.default.CLICK,h.stopPropagation,!1),e}i.default=y},{"../css.js":61,"../easing.js":63,"../events.js":64,"../events/Event.js":65,"../events/EventType.js":66,"../math.js":201,"../pointer/EventType.js":204,"./Control.js":51}],59:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./Control.js")),u=o(t("../events/EventType.js")),h=t("../css.js"),r=t("../geom/Polygon.js");function o(t){return t&&t.__esModule?t:{default:t}}var c,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(c=n.default,a(d,c),d.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},d.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal((0,r.fromExtent)(e))},d);function d(t){var e=this,i=t||{};(e=c.call(this,{element:document.createElement("div"),target:i.target})||this).extent=i.extent?i.extent:null;var n=void 0!==i.className?i.className:"ol-zoom-extent",r=void 0!==i.label?i.label:"E",o=void 0!==i.tipLabel?i.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=o,s.appendChild("string"==typeof r?document.createTextNode(r):r),s.addEventListener(u.default.CLICK,e.handleClick_.bind(e),!1);var a=n+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,l=e.element;return l.className=a,l.appendChild(s),e}i.default=l},{"../css.js":61,"../events/EventType.js":66,"../geom/Polygon.js":138,"./Control.js":51}],60:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.add=function(t,e){return t[0]+=+e[0],t[1]+=+e[1],t},i.closestOnCircle=function(t,e){var i=e.getRadius(),n=e.getCenter(),r=n[0],o=n[1],s=t[0]-r,a=t[1]-o;0===s&&0==a&&(s=1);var l=Math.sqrt(s*s+a*a);return[r+i*s/l,o+i*a/l]},i.closestOnSegment=n,i.createStringXY=function(e){return function(t){return l(t,e)}},i.degreesToStringHDMS=r,i.format=o,i.equals=function(t,e){for(var i=!0,n=t.length-1;0<=n;--n)if(t[n]!=e[n]){i=!1;break}return i},i.rotate=function(t,e){var i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t},i.scale=function(t,e){return t[0]*=e,t[1]*=e,t},i.squaredDistance=a,i.distance=function(t,e){return Math.sqrt(a(t,e))},i.squaredDistanceToSegment=function(t,e){return a(t,n(t,e))},i.toStringHDMS=function(t,e){return t?r("NS",t[1],e)+" "+r("EW",t[0],e):""},i.toStringXY=l,i.wrapX=function(t,e){var i=(0,s.getWidth)(e.getExtent()),n=u(t,e,i);return n&&(t[0]-=n*i),t},i.getWorldsAway=u;var s=t("./extent.js"),h=t("./math.js"),c=t("./string.js");function n(t,e){var i,n=t[0],r=t[1],o=e[0],s=e[1],a=o[0],l=o[1],u=s[0],h=s[1],c=u-a,d=h-l,p=0==c&&0==d?0:(c*(n-a)+d*(r-l))/(c*c+d*d||0),f=p<=0?(i=a,l):1<=p?(i=u,h):(i=a+p*c,l+p*d);return[i,f]}function r(t,e,i){var n=(0,h.modulo)(e+180,360)-180,r=Math.abs(3600*n),o=i||0,s=Math.pow(10,o),a=Math.floor(r/3600),l=Math.floor((r-3600*a)/60),u=r-3600*a-60*l;return 60<=(u=Math.ceil(u*s)/s)&&(u=0,l+=1),60<=l&&(l=0,a+=1),a+"° "+(0,c.padNumber)(l,2)+"′ "+(0,c.padNumber)(u,2,o)+"″"+(0==n?"":" "+t.charAt(n<0?1:0))}function o(t,e,i){return t?e.replace("{x}",t[0].toFixed(i)).replace("{y}",t[1].toFixed(i)):""}function a(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function l(t,e){return o(t,"{x}, {y}",e)}function u(t,e,i){var n,r=e.getExtent(),o=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=i||(0,s.getWidth)(r),o=Math.floor((t[0]-r[0])/n)),o}},{"./extent.js":70,"./math.js":201,"./string.js":287}],61:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getFontParameters=i.CLASS_COLLAPSED=i.CLASS_CONTROL=i.CLASS_UNSUPPORTED=i.CLASS_UNSELECTABLE=i.CLASS_SELECTABLE=i.CLASS_HIDDEN=void 0;i.CLASS_HIDDEN="ol-hidden";i.CLASS_SELECTABLE="ol-selectable";i.CLASS_UNSELECTABLE="ol-unselectable";i.CLASS_UNSUPPORTED="ol-unsupported";i.CLASS_CONTROL="ol-control";i.CLASS_COLLAPSED="ol-collapsed";var s=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),a=["style","variant","weight","size","lineHeight","family"];i.getFontParameters=function(t){var e=t.match(s);if(!e)return null;for(var i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,r=a.length;n<r;++n){var o=e[n+1];void 0!==o&&(i[a[n]]=o)}return i.families=i.family.split(/,\s?/),i}},{}],62:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createCanvasContext2D=function(t,e,i){var n=i&&i.length?i.shift():r.WORKER_OFFSCREEN_CANVAS?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")},i.outerWidth=function(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)},i.outerHeight=function(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)},i.replaceNode=function(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)},i.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},i.removeChildren=function(t){for(;t.lastChild;)t.removeChild(t.lastChild)},i.replaceChildren=function(t,e){for(var i=t.childNodes,n=0;;++n){var r=i[n],o=e[n];if(!r&&!o)break;r!==o&&(r?o?t.insertBefore(o,r):(t.removeChild(r),--n):t.appendChild(o))}};var r=t("./has.js")},{"./has.js":159}],63:[function(t,e,i){"use strict";function n(t){return Math.pow(t,3)}function r(t){return 3*t*t-2*t*t*t}Object.defineProperty(i,"__esModule",{value:!0}),i.easeIn=n,i.easeOut=function(t){return 1-n(1-t)},i.inAndOut=r,i.linear=function(t){return t},i.upAndDown=function(t){return t<.5?r(2*t):1-r(2*(t-.5))}},{}],64:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.listen=r,i.listenOnce=function(t,e,i,n){return r(t,e,i,n,!0)},i.unlistenByKey=function(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),(0,n.clear)(t))};var n=t("./obj.js");function r(t,e,i,n,r){var o;n&&n!==t&&(i=i.bind(n)),r&&(o=i,i=function(){t.removeEventListener(e,i),o.apply(this,arguments)});var s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}},{"./obj.js":203}],65:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.stopPropagation=function(t){t.stopPropagation()},i.preventDefault=function(t){t.preventDefault()},i.default=void 0;var n=(r.prototype.preventDefault=function(){this.propagationStopped=!0},r.prototype.stopPropagation=function(){this.propagationStopped=!0},r);function r(t){this.propagationStopped,this.type=t,this.target=null}i.default=n},{}],66:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"}},{}],67:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={LEFT:37,UP:38,RIGHT:39,DOWN:40}},{}],68:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("../Disposable.js")),h=o(t("./Event.js")),c=t("../functions.js"),r=t("../obj.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(d,s),d.prototype.addEventListener=function(t,e){var i,n;t&&e&&-1===(n=(i=this.listeners_||(this.listeners_={}))[t]||(i[t]=[])).indexOf(e)&&n.push(e)},d.prototype.dispatchEvent=function(t){var e="string"==typeof t?new h.default(t):t,i=e.type;e.target||(e.target=this.eventTarget_||this);var n,r=this.listeners_&&this.listeners_[i];if(r){var o=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,s[i]=0),++o[i];for(var a=0,l=r.length;a<l;++a)if(!1===(n="handleEvent"in r[a]?r[a].handleEvent(e):r[a].call(this,e))||e.propagationStopped){n=!1;break}if(--o[i],0===o[i]){var u=s[i];for(delete s[i];u--;)this.removeEventListener(i,c.VOID);delete o[i]}return n}},d.prototype.disposeInternal=function(){this.listeners_&&(0,r.clear)(this.listeners_)},d.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},d.prototype.hasListener=function(t){return!!this.listeners_&&(t?t in this.listeners_:0<Object.keys(this.listeners_).length)},d.prototype.removeEventListener=function(t,e){var i,n=this.listeners_&&this.listeners_[t];!n||-1!==(i=n.indexOf(e))&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=c.VOID,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))},d);function d(t){var e=s.call(this)||this;return e.eventTarget_=t,e.pendingRemovals_=null,e.dispatching_=null,e.listeners_=null,e}i.default=u},{"../Disposable.js":12,"../functions.js":125,"../obj.js":203,"./Event.js":65}],69:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.all=function(t){var r=arguments;return function(t){for(var e=!0,i=0,n=r.length;i<n&&(e=e&&r[i](t));++i);return e}},i.primaryAction=i.penOnly=i.touchOnly=i.mouseOnly=i.targetNotEditable=i.shiftKeyOnly=i.platformModifierKeyOnly=i.noModifierKeys=i.doubleClick=i.singleClick=i.pointerMove=i.never=i.mouseActionButton=i.click=i.always=i.focusWithTabindex=i.focus=i.altShiftKeysOnly=i.altKeyOnly=void 0;var n,r=(n=t("../MapBrowserEventType.js"))&&n.__esModule?n:{default:n},o=t("../functions.js"),s=t("../has.js"),a=t("../asserts.js");i.altKeyOnly=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey};i.altShiftKeysOnly=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey};function l(t){return t.target.getTargetElement().contains(document.activeElement)}i.focus=l;i.focusWithTabindex=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||l(t)};var u=o.TRUE;i.always=u;i.click=function(t){return t.type==r.default.CLICK};i.mouseActionButton=function(t){var e=t.originalEvent;return 0==e.button&&!(s.WEBKIT&&s.MAC&&e.ctrlKey)};var h=o.FALSE;i.never=h;i.pointerMove=function(t){return"pointermove"==t.type};i.singleClick=function(t){return t.type==r.default.SINGLECLICK};i.doubleClick=function(t){return t.type==r.default.DBLCLICK};i.noModifierKeys=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey};i.platformModifierKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&(s.MAC?e.metaKey:e.ctrlKey)&&!e.shiftKey};i.shiftKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey};i.targetNotEditable=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e};i.mouseOnly=function(t){var e=t.originalEvent;return(0,a.assert)(void 0!==e,56),"mouse"==e.pointerType};i.touchOnly=function(t){var e=t.originalEvent;return(0,a.assert)(void 0!==e,56),"touch"===e.pointerType};i.penOnly=function(t){var e=t.originalEvent;return(0,a.assert)(void 0!==e,56),"pen"===e.pointerType};i.primaryAction=function(t){var e=t.originalEvent;return(0,a.assert)(void 0!==e,56),e.isPrimary&&0===e.button}},{"../MapBrowserEventType.js":24,"../asserts.js":45,"../functions.js":125,"../has.js":159}],70:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.boundingExtent=function(t){for(var e=a(),i=0,n=t.length;i<n;++i)u(e,t[i]);return e},i.buffer=function(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]},i.clone=function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()},i.closestSquaredDistanceXY=function(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r},i.containsCoordinate=function(t,e){return s(t,e[0],e[1])},i.containsExtent=function(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]},i.containsXY=s,i.coordinateRelationship=_,i.createEmpty=a,i.createOrUpdate=S,i.createOrUpdateEmpty=l,i.createOrUpdateFromCoordinate=function(t,e){var i=t[0],n=t[1];return S(i,n,i,n,e)},i.createOrUpdateFromCoordinates=function(t,e){return h(l(e),t)},i.createOrUpdateFromFlatCoordinates=function(t,e,i,n,r){return c(l(r),t,e,i,n)},i.createOrUpdateFromRings=function(t,e){return d(l(e),t)},i.equals=function(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]},i.approximatelyEquals=function(t,e,i){return Math.abs(t[0]-e[0])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[3]-e[3])<i},i.extend=function(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t},i.extendCoordinate=u,i.extendCoordinates=h,i.extendFlatCoordinates=c,i.extendRings=d,i.extendXY=p,i.forEachCorner=function(t,e){var i;return(i=e(g(t)))||(i=e(m(t)))||(i=e(w(t)))?i:(i=e(x(t)))||!1},i.getArea=f,i.getBottomLeft=g,i.getBottomRight=m,i.getCenter=v,i.getCorner=function(t,e){var i;return e===n.default.BOTTOM_LEFT?i=g(t):e===n.default.BOTTOM_RIGHT?i=m(t):e===n.default.TOP_LEFT?i=x(t):e===n.default.TOP_RIGHT?i=w(t):(0,r.assert)(!1,13),i},i.getEnlargedArea=function(t,e){var i=Math.min(t[0],e[0]),n=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-i)*(Math.max(t[3],e[3])-n)},i.getForViewAndSize=function(t,e,i,n,r){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),l=Math.sin(i),u=o*a,h=o*l,c=s*a,d=s*l,p=t[0],f=t[1],g=p-u+d,m=p-u-d,y=p+u-d,_=p+u+d,v=f-h-c,b=f-h+c,j=f+h+c,x=f+h-c;return S(Math.min(g,m,y,_),Math.min(v,b,j,x),Math.max(g,m,y,_),Math.max(v,b,j,x),r)},i.getHeight=b,i.getIntersectionArea=function(t,e){return f(j(t,e))},i.getIntersection=j,i.getMargin=function(t){return P(t)+b(t)},i.getSize=function(t){return[t[2]-t[0],t[3]-t[1]]},i.getTopLeft=x,i.getTopRight=w,i.getWidth=P,i.intersects=E,i.isEmpty=T,i.returnOrUpdate=function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t},i.scaleFromCenter=function(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n},i.intersectsSegment=function(t,e,i){var n=!1,r=_(t,e),o=_(t,i);{var s,a,l,u,h,c,d,p,f,g,m;r===y.default.INTERSECTING||o===y.default.INTERSECTING?n=!0:(s=t[0],a=t[1],l=t[2],u=t[3],h=e[0],c=e[1],d=i[0],p=i[1],f=(p-c)/(d-h),m=g=void 0,o&y.default.ABOVE&&!(r&y.default.ABOVE)&&(n=(g=d-(p-u)/f)>=s&&g<=l),n||!(o&y.default.RIGHT)||r&y.default.RIGHT||(n=(m=p-(d-l)*f)>=a&&m<=u),n||!(o&y.default.BELOW)||r&y.default.BELOW||(n=(g=d-(p-a)/f)>=s&&g<=l),n||!(o&y.default.LEFT)||r&y.default.LEFT||(n=(m=p-(d-s)*f)>=a&&m<=u))}return n},i.applyTransform=function(t,e,i,n){var r=[];if(1<n)for(var o=t[2]-t[0],s=t[3]-t[1],a=0;a<n;++a)r.push(t[0]+o*a/n,t[1],t[2],t[1]+s*a/n,t[2]-o*a/n,t[3],t[0],t[3]-s*a/n);else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);for(var l=[],u=[],h=(a=0,r.length);a<h;a+=2)l.push(r[a]),u.push(r[a+1]);return function(t,e,i){return S(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(l,u,i)},i.wrapX=function(t,e){var i=e.getExtent(),n=v(t);{var r,o;e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])&&(r=P(i),o=Math.floor((n[0]-i[0])/r)*r,t[0]-=o,t[2]-=o)}return t};var n=o(t("./extent/Corner.js")),y=o(t("./extent/Relationship.js")),r=t("./asserts.js");function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function _(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=y.default.UNKNOWN;return s<i?l|=y.default.LEFT:r<s&&(l|=y.default.RIGHT),a<n?l|=y.default.BELOW:o<a&&(l|=y.default.ABOVE),l===y.default.UNKNOWN&&(l=y.default.INTERSECTING),l}function a(){return[1/0,1/0,-1/0,-1/0]}function S(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function l(t){return S(1/0,1/0,-1/0,-1/0,t)}function u(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function h(t,e){for(var i=0,n=e.length;i<n;++i)u(t,e[i]);return t}function c(t,e,i,n,r){for(;i<n;i+=r)p(t,e[i],e[i+1]);return t}function d(t,e){for(var i=0,n=e.length;i<n;++i)h(t,e[i]);return t}function p(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function f(t){var e=0;return T(t)||(e=P(t)*b(t)),e}function g(t){return[t[0],t[1]]}function m(t){return[t[2],t[1]]}function v(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function b(t){return t[3]-t[1]}function j(t,e,i){var n=i||a();return E(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):l(n),n}function x(t){return[t[0],t[3]]}function w(t){return[t[2],t[3]]}function P(t){return t[2]-t[0]}function E(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function T(t){return t[2]<t[0]||t[3]<t[1]}},{"./asserts.js":45,"./extent/Corner.js":71,"./extent/Relationship.js":72}],71:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},{}],72:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}},{}],73:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.loadFeaturesXhr=o,i.xhr=function(t,e){return o(t,e,function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)},r.VOID)},i.setWithCredentials=function(t){h=t};var n,u=(n=t("./format/FormatType.js"))&&n.__esModule?n:{default:n},r=t("./functions.js");var h=!1;function o(e,s,a,l){return function(n,t,r){var o=new XMLHttpRequest;o.open("GET","function"==typeof e?e(n,t,r):e,!0),s.getType()==u.default.ARRAY_BUFFER&&(o.responseType="arraybuffer"),o.withCredentials=h,o.onload=function(t){var e,i;!o.status||200<=o.status&&o.status<300?(i=void 0,(e=s.getType())==u.default.JSON||e==u.default.TEXT?i=o.responseText:e==u.default.XML?(i=o.responseXML)||(i=(new DOMParser).parseFromString(o.responseText,"application/xml")):e==u.default.ARRAY_BUFFER&&(i=o.response),i?a.call(this,s.readFeatures(i,{extent:n,featureProjection:r}),s.readProjection(i)):l.call(this)):l.call(this)}.bind(this),o.onerror=function(){l.call(this)}.bind(this),o.send()}}},{"./format/FormatType.js":77,"./functions.js":125}],74:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"EsriJSON",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"GeoJSON",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"GML",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"GPX",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"IGC",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"IIIFInfo",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"KML",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"MVT",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"OWS",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"Polyline",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"TopoJSON",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(i,"WFS",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(i,"WKT",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(i,"WMSCapabilities",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(i,"WMSGetFeatureInfo",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(i,"WMTSCapabilities",{enumerable:!0,get:function(){return _.default}});var n=v(t("./format/EsriJSON.js")),r=v(t("./format/GeoJSON.js")),o=v(t("./format/GML.js")),s=v(t("./format/GPX.js")),a=v(t("./format/IGC.js")),l=v(t("./format/IIIFInfo.js")),u=v(t("./format/KML.js")),h=v(t("./format/MVT.js")),c=v(t("./format/OWS.js")),d=v(t("./format/Polyline.js")),p=v(t("./format/TopoJSON.js")),f=v(t("./format/WFS.js")),g=v(t("./format/WKT.js")),m=v(t("./format/WMSCapabilities.js")),y=v(t("./format/WMSGetFeatureInfo.js")),_=v(t("./format/WMTSCapabilities.js"));function v(t){return t&&t.__esModule?t:{default:t}}},{"./format/EsriJSON.js":75,"./format/GML.js":78,"./format/GPX.js":82,"./format/GeoJSON.js":83,"./format/IGC.js":84,"./format/IIIFInfo.js":85,"./format/KML.js":87,"./format/MVT.js":88,"./format/OWS.js":89,"./format/Polyline.js":90,"./format/TopoJSON.js":92,"./format/WFS.js":93,"./format/WKT.js":94,"./format/WMSCapabilities.js":95,"./format/WMSGetFeatureInfo.js":96,"./format/WMTSCapabilities.js":97}],75:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=j(t("../Feature.js")),o=j(t("../geom/GeometryLayout.js")),l=j(t("../geom/GeometryType.js")),n=j(t("./JSONFeature.js")),r=j(t("../geom/LineString.js")),h=j(t("../geom/LinearRing.js")),s=j(t("../geom/MultiLineString.js")),u=j(t("../geom/MultiPoint.js")),c=j(t("../geom/MultiPolygon.js")),d=j(t("../geom/Point.js")),p=j(t("../geom/Polygon.js")),f=t("../asserts.js"),g=t("../obj.js"),m=t("../extent.js"),y=t("../geom/flat/deflate.js"),_=t("../proj.js"),v=t("../geom/flat/orient.js"),b=t("./Feature.js");function j(t){return t&&t.__esModule?t:{default:t}}var x,S=(x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),w={};w[l.default.POINT]=function(t){return void 0!==t.m&&void 0!==t.z?new d.default([t.x,t.y,t.z,t.m],o.default.XYZM):void 0!==t.z?new d.default([t.x,t.y,t.z],o.default.XYZ):void 0!==t.m?new d.default([t.x,t.y,t.m],o.default.XYM):new d.default([t.x,t.y])},w[l.default.LINE_STRING]=function(t){var e=M(t);return new r.default(t.paths[0],e)},w[l.default.POLYGON]=function(t){var e=M(t);return new p.default(t.rings,e)},w[l.default.MULTI_POINT]=function(t){var e=M(t);return new u.default(t.points,e)},w[l.default.MULTI_LINE_STRING]=function(t){var e=M(t);return new s.default(t.paths,e)},w[l.default.MULTI_POLYGON]=function(t){var e=M(t);return new c.default(t.rings,e)};var P={};P[l.default.POINT]=function(t,e){var i,n=t.getCoordinates(),r=t.getLayout();return r===o.default.XYZ?i={x:n[0],y:n[1],z:n[2]}:r===o.default.XYM?i={x:n[0],y:n[1],m:n[2]}:r===o.default.XYZM?i={x:n[0],y:n[1],z:n[2],m:n[3]}:r===o.default.XY?i={x:n[0],y:n[1]}:(0,f.assert)(!1,34),i},P[l.default.LINE_STRING]=function(t,e){var i=I(t);return{hasZ:i.hasZ,hasM:i.hasM,paths:[t.getCoordinates()]}},P[l.default.POLYGON]=function(t,e){var i=I(t);return{hasZ:i.hasZ,hasM:i.hasM,rings:t.getCoordinates(!1)}},P[l.default.MULTI_POINT]=function(t,e){var i=I(t);return{hasZ:i.hasZ,hasM:i.hasM,points:t.getCoordinates()}},P[l.default.MULTI_LINE_STRING]=function(t,e){var i=I(t);return{hasZ:i.hasZ,hasM:i.hasM,paths:t.getCoordinates()}},P[l.default.MULTI_POLYGON]=function(t,e){for(var i=I(t),n=t.getCoordinates(!1),r=[],o=0;o<n.length;o++)for(var s=n[o].length-1;0<=s;s--)r.push(n[o][s]);return{hasZ:i.hasZ,hasM:i.hasM,rings:r}};var E,T=(E=n.default,S(O,E),O.prototype.readFeatureFromObject=function(t,e,i){var n,r=t,o=C(r.geometry,e),s=new a.default;return this.geometryName_&&s.setGeometryName(this.geometryName_),s.setGeometry(o),r.attributes&&(s.setProperties(r.attributes,!0),void 0!==(n=r.attributes[i])&&s.setId(n)),s},O.prototype.readFeaturesFromObject=function(t,e){var i=e||{};if(t.features){for(var n=[],r=t.features,o=0,s=r.length;o<s;++o)n.push(this.readFeatureFromObject(r[o],i,t.objectIdFieldName));return n}return[this.readFeatureFromObject(t,i)]},O.prototype.readGeometryFromObject=C,O.prototype.readProjectionFromObject=function(t){if(t.spatialReference&&void 0!==t.spatialReference.wkid){var e=t.spatialReference.wkid;return(0,_.get)("EPSG:"+e)}return null},O.prototype.writeGeometryObject=function(t,e){return R(t,this.adaptOptions(e))},O.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={};if(!t.hasProperties())return i.attributes={},i;var n=t.getProperties(),r=t.getGeometry();return r&&(i.geometry=R(r,e),e&&e.featureProjection&&(i.geometry.spatialReference={wkid:Number((0,_.get)(e.featureProjection).getCode().split(":").pop())}),delete n[t.getGeometryName()]),(0,g.isEmpty)(n)?i.attributes={}:i.attributes=n,i},O.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{features:i}},O);function O(t){var e=this,i=t||{};return(e=E.call(this)||this).geometryName_=i.geometryName,e}function C(t,e){var i,n,r,o,s;if(!t)return null;"number"==typeof t.x&&"number"==typeof t.y?r=l.default.POINT:t.points?r=l.default.MULTI_POINT:t.paths?r=1===t.paths.length?l.default.LINE_STRING:l.default.MULTI_LINE_STRING:t.rings&&(o=M(t),t=1===(s=function(t,e){var i,n,r=[],o=[],s=[];for(i=0,n=t.length;i<n;++i)(r.length=0,y.deflateCoordinates)(r,0,t[i],e.length),(0,v.linearRingIsClockwise)(r,0,r.length,e.length)?o.push([t[i]]):s.push(t[i]);for(;s.length;){var a=s.shift(),l=!1;for(i=o.length-1;0<=i;i--){var u=o[i][0];if((0,m.containsExtent)(new h.default(u).getExtent(),new h.default(a).getExtent())){o[i].push(a),l=!0;break}}l||o.push([a.reverse()])}return o}(t.rings,o)).length?(r=l.default.POLYGON,(0,g.assign)({},t,((i={}).rings=s[0],i))):(r=l.default.MULTI_POLYGON,(0,g.assign)({},t,((n={}).rings=s,n))));var a=w[r];return(0,b.transformGeometryWithOptions)(a(t),!1,e)}function M(t){var e=o.default.XY;return!0===t.hasZ&&!0===t.hasM?e=o.default.XYZM:!0===t.hasZ?e=o.default.XYZ:!0===t.hasM&&(e=o.default.XYM),e}function I(t){var e=t.getLayout();return{hasZ:e===o.default.XYZ||e===o.default.XYZM,hasM:e===o.default.XYM||e===o.default.XYZM}}function R(t,e){return(0,P[t.getType()])((0,b.transformGeometryWithOptions)(t,!0,e),e)}i.default=T},{"../Feature.js":13,"../asserts.js":45,"../extent.js":70,"../geom/GeometryLayout.js":130,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/LinearRing.js":133,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../geom/flat/deflate.js":144,"../geom/flat/orient.js":152,"../obj.js":203,"../proj.js":205,"./Feature.js":76,"./JSONFeature.js":86}],76:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.transformGeometryWithOptions=function(t,e,i){var n,r=i?(0,a.get)(i.featureProjection):null,o=i?(0,a.get)(i.dataProjection):null;{var s;n=r&&o&&!(0,a.equivalent)(r,o)?(e?t.clone():t).transform(e?r:o,e?o:r):t,e&&i&&void 0!==i.decimals&&(s=Math.pow(10,i.decimals),n===t&&(n=t.clone()),n.applyTransform(function(t){for(var e=0,i=t.length;e<i;++e)t[e]=Math.round(t[e]*s)/s;return t}))}return n},i.transformExtentWithOptions=function(t,e){var i=e?(0,a.get)(e.featureProjection):null,n=e?(0,a.get)(e.dataProjection):null;return i&&n&&!(0,a.equivalent)(i,n)?(0,a.transformExtent)(t,n,i):t},i.default=void 0;var n,r=(n=t("../proj/Units.js"))&&n.__esModule?n:{default:n},o=t("../util.js"),s=t("../obj.js"),a=t("../proj.js");var l=(u.prototype.getReadOptions=function(t,e){var i,n;return e&&(n=e.dataProjection?(0,a.get)(e.dataProjection):this.readProjection(t),e.extent&&n&&n.getUnits()===r.default.TILE_PIXELS&&(n=(0,a.get)(n)).setWorldExtent(e.extent),i={dataProjection:n,featureProjection:e.featureProjection}),this.adaptOptions(i)},u.prototype.adaptOptions=function(t){return(0,s.assign)({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},u.prototype.getType=function(){return(0,o.abstract)()},u.prototype.readFeature=function(t,e){return(0,o.abstract)()},u.prototype.readFeatures=function(t,e){return(0,o.abstract)()},u.prototype.readGeometry=function(t,e){return(0,o.abstract)()},u.prototype.readProjection=function(t){return(0,o.abstract)()},u.prototype.writeFeature=function(t,e){return(0,o.abstract)()},u.prototype.writeFeatures=function(t,e){return(0,o.abstract)()},u.prototype.writeGeometry=function(t,e){return(0,o.abstract)()},u);function u(){this.dataProjection=null,this.defaultFeatureProjection=null}i.default=l},{"../obj.js":203,"../proj.js":205,"../proj/Units.js":207,"../util.js":313}],77:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"}},{}],78:[function(t,e,i){"use strict";var n;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=((n=t("./GML3.js"))&&n.__esModule?n:{default:n}).default;r.prototype.writeFeatures,r.prototype.writeFeaturesNode,i.default=r},{"./GML3.js":80}],79:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./GMLBase.js")),f=t("../xml.js"),p=t("../obj.js"),r=t("../extent.js"),g=t("../proj.js"),a=t("./Feature.js"),m=t("./xsd.js");function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}var o,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=n.GMLNS+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",d={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},y=(o=n.default,h(_,o),_.prototype.readFlatCoordinates=function(t,e){var i,n=(0,f.getAllTextContent)(t,!1).replace(/^\s*|\s*$/g,""),r=e[0].srsName,o="enu";!r||(i=(0,g.get)(r))&&(o=i.getAxisOrientation());for(var s=n.trim().split(/\s+/),a=[],l=0,u=s.length;l<u;l++){var h=s[l].split(/,+/),c=parseFloat(h[0]),d=parseFloat(h[1]),p=3===h.length?parseFloat(h[2]):0;"en"===o.substr(0,2)?a.push(c,d,p):a.push(d,c,p)}return a},_.prototype.readBox=function(t,e){var i=(0,f.pushParseAndPop)([null],this.BOX_PARSERS_,t,e,this);return(0,r.createOrUpdate)(i[1][0],i[1][1],i[1][3],i[1][4])},_.prototype.innerBoundaryIsParser=function(t,e){var i=(0,f.pushParseAndPop)(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)},_.prototype.outerBoundaryIsParser=function(t,e){var i=(0,f.pushParseAndPop)(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)},_.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,i){var n,r=e[e.length-1],o=r.multiSurface,s=r.surface,a=r.multiCurve;return Array.isArray(t)?n="Envelope":"MultiPolygon"===(n=t.getType())&&!0===o?n="MultiSurface":"Polygon"===n&&!0===s?n="Surface":"MultiLineString"===n&&!0===a&&(n="MultiCurve"),(0,f.createElementNS)("http://www.opengis.net/gml",n)},_.prototype.writeFeatureElement=function(t,e,i){var n=e.getId();n&&t.setAttribute("fid",n);var r=i[i.length-1],o=r.featureNS,s=e.getGeometryName();r.serializers||(r.serializers={},r.serializers[o]={});var a=[],l=[];if(e.hasProperties()){var u=e.getProperties();for(var h in u){var c=u[h];null!==c&&(a.push(h),l.push(c),h==s||"function"==typeof c.getSimplifiedGeometry?h in r.serializers[o]||(r.serializers[o][h]=(0,f.makeChildAppender)(this.writeGeometryElement,this)):h in r.serializers[o]||(r.serializers[o][h]=(0,f.makeChildAppender)(m.writeStringTextNode)))}}var d=(0,p.assign)({},r);d.node=t,(0,f.pushSerializeAndPop)(d,r.serializers,(0,f.makeSimpleNodeFactory)(void 0,o),l,i,a)},_.prototype.writeCurveOrLineString=function(t,e,i){var n,r,o=i[i.length-1].srsName;"LineStringSegment"!==t.nodeName&&o&&t.setAttribute("srsName",o),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName?(n=this.createCoordinatesNode_(t.namespaceURI),t.appendChild(n),this.writeCoordinates_(n,e,i)):"Curve"===t.nodeName&&(r=(0,f.createElementNS)(t.namespaceURI,"segments"),t.appendChild(r),this.writeCurveSegments_(r,e,i))},_.prototype.writeLineStringOrCurveMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))},_.prototype.writeMultiCurveOrLineString=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=n.srsName,s=n.curve;o&&t.setAttribute("srsName",o);var a=e.getLineStrings();(0,f.pushSerializeAndPop)({node:t,hasZ:r,srsName:o,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},_.prototype.writeGeometryElement=function(t,e,i){var n,r=i[i.length-1],o=(0,p.assign)({},r);o.node=t,n=Array.isArray(e)?(0,a.transformExtentWithOptions)(e,r):(0,a.transformGeometryWithOptions)(e,!0,r),(0,f.pushSerializeAndPop)(o,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],i,void 0,this)},_.prototype.createCoordinatesNode_=function(t){var e=(0,f.createElementNS)(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e},_.prototype.writeCoordinates_=function(t,e,i){for(var n=i[i.length-1],r=n.hasZ,o=n.srsName,s=e.getCoordinates(),a=s.length,l=new Array(a),u=0;u<a;++u){var h=s[u];l[u]=this.getCoords_(h,o,r)}(0,m.writeStringTextNode)(t,l.join(" "))},_.prototype.writeCurveSegments_=function(t,e,i){var n=(0,f.createElementNS)(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)},_.prototype.writeSurfaceOrPolygon=function(t,e,i){var n,r,o=i[i.length-1],s=o.hasZ,a=o.srsName;"PolygonPatch"!==t.nodeName&&a&&t.setAttribute("srsName",a),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName?(n=e.getLinearRings(),(0,f.pushSerializeAndPop)({node:t,hasZ:s,srsName:a},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,n,i,void 0,this)):"Surface"===t.nodeName&&(r=(0,f.createElementNS)(t.namespaceURI,"patches"),t.appendChild(r),this.writeSurfacePatches_(r,e,i))},_.prototype.RING_NODE_FACTORY_=function(t,e,i){var n=e[e.length-1],r=n.node,o=n.exteriorWritten;return void 0===o&&(n.exteriorWritten=!0),(0,f.createElementNS)(r.namespaceURI,void 0!==o?"innerBoundaryIs":"outerBoundaryIs")},_.prototype.writeSurfacePatches_=function(t,e,i){var n=(0,f.createElementNS)(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)},_.prototype.writeRing=function(t,e,i){var n=(0,f.createElementNS)(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)},_.prototype.getCoords_=function(t,e,i){var n="enu";e&&(n=(0,g.get)(e).getAxisOrientation());var r="en"===n.substr(0,2)?t[0]+","+t[1]:t[1]+","+t[0];return i&&(r+=","+(t[2]||0)),r},_.prototype.writePoint=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);var s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s);var a=e.getCoordinates(),l=this.getCoords_(a,o,r);(0,m.writeStringTextNode)(s,l)},_.prototype.writeMultiPoint=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);var s=e.getPoints();(0,f.pushSerializeAndPop)({node:t,hasZ:r,srsName:o},this.POINTMEMBER_SERIALIZERS,(0,f.makeSimpleNodeFactory)("pointMember"),s,i,void 0,this)},_.prototype.writePointMember=function(t,e,i){var n=(0,f.createElementNS)(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)},_.prototype.writeLinearRing=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var r=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(r),this.writeCoordinates_(r,e,i)},_.prototype.writeMultiSurfaceOrPolygon=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=n.srsName,s=n.surface;o&&t.setAttribute("srsName",o);var a=e.getPolygons();(0,f.pushSerializeAndPop)({node:t,hasZ:r,srsName:o,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},_.prototype.writeSurfaceOrPolygonMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))},_.prototype.writeEnvelope=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var r=[e[0]+" "+e[1],e[2]+" "+e[3]];(0,f.pushSerializeAndPop)({node:t},this.ENVELOPE_SERIALIZERS,f.OBJECT_PROPERTY_NODE_FACTORY,r,i,["lowerCorner","upperCorner"],this)},_.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,i){var n=e[e.length-1].node;return(0,f.createElementNS)("http://www.opengis.net/gml",d[n.nodeName])},_);function _(t){var e=this,i=t||{};return(e=o.call(this,i)||this).FEATURE_COLLECTION_PARSERS[n.GMLNS].featureMember=(0,f.makeArrayPusher)(e.readFeaturesInternal),e.schemaLocation=i.schemaLocation?i.schemaLocation:c,e}y.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:(0,f.makeReplacer)(y.prototype.readFlatCoordinates)}},y.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:y.prototype.innerBoundaryIsParser,outerBoundaryIs:y.prototype.outerBoundaryIsParser}},y.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:(0,f.makeArrayPusher)(y.prototype.readFlatCoordinates)}},y.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:(0,f.makeReplacer)(n.default.prototype.readPoint),MultiPoint:(0,f.makeReplacer)(n.default.prototype.readMultiPoint),LineString:(0,f.makeReplacer)(n.default.prototype.readLineString),MultiLineString:(0,f.makeReplacer)(n.default.prototype.readMultiLineString),LinearRing:(0,f.makeReplacer)(n.default.prototype.readLinearRing),Polygon:(0,f.makeReplacer)(n.default.prototype.readPolygon),MultiPolygon:(0,f.makeReplacer)(n.default.prototype.readMultiPolygon),Box:(0,f.makeReplacer)(y.prototype.readBox)}},y.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:(0,f.makeChildAppender)(y.prototype.writeCurveOrLineString),MultiCurve:(0,f.makeChildAppender)(y.prototype.writeMultiCurveOrLineString),Point:(0,f.makeChildAppender)(y.prototype.writePoint),MultiPoint:(0,f.makeChildAppender)(y.prototype.writeMultiPoint),LineString:(0,f.makeChildAppender)(y.prototype.writeCurveOrLineString),MultiLineString:(0,f.makeChildAppender)(y.prototype.writeMultiCurveOrLineString),LinearRing:(0,f.makeChildAppender)(y.prototype.writeLinearRing),Polygon:(0,f.makeChildAppender)(y.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,f.makeChildAppender)(y.prototype.writeMultiSurfaceOrPolygon),Surface:(0,f.makeChildAppender)(y.prototype.writeSurfaceOrPolygon),MultiSurface:(0,f.makeChildAppender)(y.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,f.makeChildAppender)(y.prototype.writeEnvelope)}},y.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:(0,f.makeChildAppender)(y.prototype.writeLineStringOrCurveMember),curveMember:(0,f.makeChildAppender)(y.prototype.writeLineStringOrCurveMember)}},y.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:(0,f.makeChildAppender)(y.prototype.writeRing),innerBoundaryIs:(0,f.makeChildAppender)(y.prototype.writeRing)}},y.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:(0,f.makeChildAppender)(y.prototype.writePointMember)}},y.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:(0,f.makeChildAppender)(y.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,f.makeChildAppender)(y.prototype.writeSurfaceOrPolygonMember)}},y.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:(0,f.makeChildAppender)(m.writeStringTextNode),upperCorner:(0,f.makeChildAppender)(m.writeStringTextNode)}},i.default=y},{"../extent.js":70,"../obj.js":203,"../proj.js":205,"../xml.js":322,"./Feature.js":76,"./GMLBase.js":81,"./xsd.js":124}],80:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=_();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./GMLBase.js")),a=f(t("../geom/GeometryLayout.js")),r=f(t("../geom/LineString.js")),o=f(t("../geom/MultiLineString.js")),l=f(t("../geom/MultiPolygon.js")),u=f(t("../geom/Polygon.js")),g=t("../xml.js"),p=t("../obj.js"),h=t("../extent.js"),c=t("../array.js"),m=t("../proj.js"),y=t("./xsd.js"),d=t("./Feature.js");function f(t){return t&&t.__esModule?t:{default:t}}function _(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return _=function(){return t},t}var v,b,j=(b=function(t,e){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),x=n.GMLNS+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",S={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},w=(v=n.default,j(P,v),P.prototype.readMultiCurve=function(t,e){var i=(0,g.pushParseAndPop)([],this.MULTICURVE_PARSERS,t,e,this);return i?new o.default(i):void 0},P.prototype.readMultiSurface=function(t,e){var i=(0,g.pushParseAndPop)([],this.MULTISURFACE_PARSERS,t,e,this);if(i)return new l.default(i)},P.prototype.curveMemberParser=function(t,e){(0,g.parseNode)(this.CURVEMEMBER_PARSERS,t,e,this)},P.prototype.surfaceMemberParser=function(t,e){(0,g.parseNode)(this.SURFACEMEMBER_PARSERS,t,e,this)},P.prototype.readPatch=function(t,e){return(0,g.pushParseAndPop)([null],this.PATCHES_PARSERS,t,e,this)},P.prototype.readSegment=function(t,e){return(0,g.pushParseAndPop)([null],this.SEGMENTS_PARSERS,t,e,this)},P.prototype.readPolygonPatch=function(t,e){return(0,g.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)},P.prototype.readLineStringSegment=function(t,e){return(0,g.pushParseAndPop)([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},P.prototype.interiorParser=function(t,e){var i=(0,g.pushParseAndPop)(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)},P.prototype.exteriorParser=function(t,e){var i=(0,g.pushParseAndPop)(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)},P.prototype.readSurface=function(t,e){var i=(0,g.pushParseAndPop)([null],this.SURFACE_PARSERS,t,e,this);if(i&&i[0]){for(var n=i[0],r=[n.length],o=void 0,o=1,s=i.length;o<s;++o)(0,c.extend)(n,i[o]),r.push(n.length);return new u.default(n,a.default.XYZ,r)}},P.prototype.readCurve=function(t,e){var i=(0,g.pushParseAndPop)([null],this.CURVE_PARSERS,t,e,this);return i?new r.default(i,a.default.XYZ):void 0},P.prototype.readEnvelope=function(t,e){var i=(0,g.pushParseAndPop)([null],this.ENVELOPE_PARSERS,t,e,this);return(0,h.createOrUpdate)(i[1][0],i[1][1],i[2][0],i[2][1])},P.prototype.readFlatPos=function(t,e){for(var i,n=(0,g.getAllTextContent)(t,!1),r=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,o=[];i=r.exec(n);)o.push(parseFloat(i[1])),n=n.substr(i[0].length);if(""===n){var s=e[0].srsName,a="enu";if(s&&(a=(0,m.get)(s).getAxisOrientation()),"neu"===a)for(var l=void 0,l=0,u=o.length;l<u;l+=3){var h=o[l],c=o[l+1];o[l]=c,o[l+1]=h}var d=o.length;if(2==d&&o.push(0),0!==d)return o}},P.prototype.readFlatPosList=function(t,e){var i=(0,g.getAllTextContent)(t,!1).replace(/^\s*|\s*$/g,""),n=e[0],r=n.srsName,o=n.srsDimension,s="enu";r&&(s=(0,m.get)(r).getAxisOrientation());var a,l,u,h=i.split(/\s+/),c=2;t.getAttribute("srsDimension")?c=(0,y.readNonNegativeIntegerString)(t.getAttribute("srsDimension")):t.getAttribute("dimension")?c=(0,y.readNonNegativeIntegerString)(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?c=(0,y.readNonNegativeIntegerString)(t.parentNode.getAttribute("srsDimension")):o&&(c=(0,y.readNonNegativeIntegerString)(o));for(var d=[],p=0,f=h.length;p<f;p+=c)a=parseFloat(h[p]),l=parseFloat(h[p+1]),u=3===c?parseFloat(h[p+2]):0,"en"===s.substr(0,2)?d.push(a,l,u):d.push(l,a,u);return d},P.prototype.writePos_=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=r?"3":"2";t.setAttribute("srsDimension",o);var s=n.srsName,a="enu";s&&(a=(0,m.get)(s).getAxisOrientation());var l=e.getCoordinates(),u="en"===a.substr(0,2)?l[0]+" "+l[1]:l[1]+" "+l[0];r&&(u+=" "+(l[2]||0)),(0,y.writeStringTextNode)(t,u)},P.prototype.getCoords_=function(t,e,i){var n="enu";e&&(n=(0,m.get)(e).getAxisOrientation());var r="en"===n.substr(0,2)?t[0]+" "+t[1]:t[1]+" "+t[0];return i&&(r+=" "+(t[2]||0)),r},P.prototype.writePosList_=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=r?"3":"2";t.setAttribute("srsDimension",o);for(var s,a=n.srsName,l=e.getCoordinates(),u=l.length,h=new Array(u),c=0;c<u;++c)s=l[c],h[c]=this.getCoords_(s,a,r);(0,y.writeStringTextNode)(t,h.join(" "))},P.prototype.writePoint=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var r=(0,g.createElementNS)(t.namespaceURI,"pos");t.appendChild(r),this.writePos_(r,e,i)},P.prototype.writeEnvelope=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var r=[e[0]+" "+e[1],e[2]+" "+e[3]];(0,g.pushSerializeAndPop)({node:t},this.ENVELOPE_SERIALIZERS,g.OBJECT_PROPERTY_NODE_FACTORY,r,i,["lowerCorner","upperCorner"],this)},P.prototype.writeLinearRing=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var r=(0,g.createElementNS)(t.namespaceURI,"posList");t.appendChild(r),this.writePosList_(r,e,i)},P.prototype.RING_NODE_FACTORY_=function(t,e,i){var n=e[e.length-1],r=n.node,o=n.exteriorWritten;return void 0===o&&(n.exteriorWritten=!0),(0,g.createElementNS)(r.namespaceURI,void 0!==o?"interior":"exterior")},P.prototype.writeSurfaceOrPolygon=function(t,e,i){var n,r,o=i[i.length-1],s=o.hasZ,a=o.srsName;"PolygonPatch"!==t.nodeName&&a&&t.setAttribute("srsName",a),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName?(n=e.getLinearRings(),(0,g.pushSerializeAndPop)({node:t,hasZ:s,srsName:a},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,n,i,void 0,this)):"Surface"===t.nodeName&&(r=(0,g.createElementNS)(t.namespaceURI,"patches"),t.appendChild(r),this.writeSurfacePatches_(r,e,i))},P.prototype.writeCurveOrLineString=function(t,e,i){var n,r,o=i[i.length-1].srsName;"LineStringSegment"!==t.nodeName&&o&&t.setAttribute("srsName",o),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName?(n=(0,g.createElementNS)(t.namespaceURI,"posList"),t.appendChild(n),this.writePosList_(n,e,i)):"Curve"===t.nodeName&&(r=(0,g.createElementNS)(t.namespaceURI,"segments"),t.appendChild(r),this.writeCurveSegments_(r,e,i))},P.prototype.writeMultiSurfaceOrPolygon=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=n.srsName,s=n.surface;o&&t.setAttribute("srsName",o);var a=e.getPolygons();(0,g.pushSerializeAndPop)({node:t,hasZ:r,srsName:o,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},P.prototype.writeMultiPoint=function(t,e,i){var n=i[i.length-1],r=n.srsName,o=n.hasZ;r&&t.setAttribute("srsName",r);var s=e.getPoints();(0,g.pushSerializeAndPop)({node:t,hasZ:o,srsName:r},this.POINTMEMBER_SERIALIZERS,(0,g.makeSimpleNodeFactory)("pointMember"),s,i,void 0,this)},P.prototype.writeMultiCurveOrLineString=function(t,e,i){var n=i[i.length-1],r=n.hasZ,o=n.srsName,s=n.curve;o&&t.setAttribute("srsName",o);var a=e.getLineStrings();(0,g.pushSerializeAndPop)({node:t,hasZ:r,srsName:o,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},P.prototype.writeRing=function(t,e,i){var n=(0,g.createElementNS)(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)},P.prototype.writeSurfaceOrPolygonMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))},P.prototype.writePointMember=function(t,e,i){var n=(0,g.createElementNS)(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)},P.prototype.writeLineStringOrCurveMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))},P.prototype.writeSurfacePatches_=function(t,e,i){var n=(0,g.createElementNS)(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)},P.prototype.writeCurveSegments_=function(t,e,i){var n=(0,g.createElementNS)(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)},P.prototype.writeGeometryElement=function(t,e,i){var n,r=i[i.length-1],o=(0,p.assign)({},r);o.node=t,n=Array.isArray(e)?(0,d.transformExtentWithOptions)(e,r):(0,d.transformGeometryWithOptions)(e,!0,r),(0,g.pushSerializeAndPop)(o,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],i,void 0,this)},P.prototype.writeFeatureElement=function(t,e,i){var n=e.getId();n&&t.setAttribute("fid",n);var r=i[i.length-1],o=r.featureNS,s=e.getGeometryName();r.serializers||(r.serializers={},r.serializers[o]={});var a=[],l=[];if(e.hasProperties()){var u=e.getProperties();for(var h in u){var c=u[h];null!==c&&(a.push(h),l.push(c),h==s||"function"==typeof c.getSimplifiedGeometry?h in r.serializers[o]||(r.serializers[o][h]=(0,g.makeChildAppender)(this.writeGeometryElement,this)):h in r.serializers[o]||(r.serializers[o][h]=(0,g.makeChildAppender)(y.writeStringTextNode)))}}var d=(0,p.assign)({},r);d.node=t,(0,g.pushSerializeAndPop)(d,r.serializers,(0,g.makeSimpleNodeFactory)(void 0,o),l,i,a)},P.prototype.writeFeatureMembers_=function(t,e,i){var n=i[i.length-1],r=n.featureType,o=n.featureNS,s={};s[o]={},s[o][r]=(0,g.makeChildAppender)(this.writeFeatureElement,this);var a=(0,p.assign)({},n);a.node=t,(0,g.pushSerializeAndPop)(a,s,(0,g.makeSimpleNodeFactory)(r,o),e,i)},P.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,i){var n=e[e.length-1].node;return(0,g.createElementNS)(this.namespace,S[n.nodeName])},P.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,i){var n,r=e[e.length-1],o=r.multiSurface,s=r.surface,a=r.curve,l=r.multiCurve;return Array.isArray(t)?n="Envelope":"MultiPolygon"===(n=t.getType())&&!0===o?n="MultiSurface":"Polygon"===n&&!0===s?n="Surface":"LineString"===n&&!0===a?n="Curve":"MultiLineString"===n&&!0===l&&(n="MultiCurve"),(0,g.createElementNS)(this.namespace,n)},P.prototype.writeGeometryNode=function(t,e){e=this.adaptOptions(e);var i=(0,g.createElementNS)(this.namespace,"geom"),n={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&(0,p.assign)(n,e),this.writeGeometryElement(i,t,[n]),i},P.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=(0,g.createElementNS)(this.namespace,"featureMembers");i.setAttributeNS(g.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation);var n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&(0,p.assign)(n,e),this.writeFeatureMembers_(i,t,[n]),i},P);function P(t){var e=this,i=t||{};return(e=v.call(this,i)||this).surface_=void 0!==i.surface&&i.surface,e.curve_=void 0!==i.curve&&i.curve,e.multiCurve_=void 0===i.multiCurve||i.multiCurve,e.multiSurface_=void 0===i.multiSurface||i.multiSurface,e.schemaLocation=i.schemaLocation?i.schemaLocation:x,e.hasZ=void 0!==i.hasZ&&i.hasZ,e}w.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:(0,g.makeReplacer)(w.prototype.readFlatPos),posList:(0,g.makeReplacer)(w.prototype.readFlatPosList)}},w.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:w.prototype.interiorParser,exterior:w.prototype.exteriorParser}},w.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:(0,g.makeReplacer)(n.default.prototype.readPoint),MultiPoint:(0,g.makeReplacer)(n.default.prototype.readMultiPoint),LineString:(0,g.makeReplacer)(n.default.prototype.readLineString),MultiLineString:(0,g.makeReplacer)(n.default.prototype.readMultiLineString),LinearRing:(0,g.makeReplacer)(n.default.prototype.readLinearRing),Polygon:(0,g.makeReplacer)(n.default.prototype.readPolygon),MultiPolygon:(0,g.makeReplacer)(n.default.prototype.readMultiPolygon),Surface:(0,g.makeReplacer)(w.prototype.readSurface),MultiSurface:(0,g.makeReplacer)(w.prototype.readMultiSurface),Curve:(0,g.makeReplacer)(w.prototype.readCurve),MultiCurve:(0,g.makeReplacer)(w.prototype.readMultiCurve),Envelope:(0,g.makeReplacer)(w.prototype.readEnvelope)}},w.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:(0,g.makeArrayPusher)(w.prototype.curveMemberParser),curveMembers:(0,g.makeArrayPusher)(w.prototype.curveMemberParser)}},w.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:(0,g.makeArrayPusher)(w.prototype.surfaceMemberParser),surfaceMembers:(0,g.makeArrayPusher)(w.prototype.surfaceMemberParser)}},w.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:(0,g.makeArrayPusher)(n.default.prototype.readLineString),Curve:(0,g.makeArrayPusher)(w.prototype.readCurve)}},w.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:(0,g.makeArrayPusher)(n.default.prototype.readPolygon),Surface:(0,g.makeArrayPusher)(w.prototype.readSurface)}},w.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:(0,g.makeReplacer)(w.prototype.readPatch)}},w.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:(0,g.makeReplacer)(w.prototype.readSegment)}},w.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:(0,g.makeArrayPusher)(w.prototype.readFlatPosList),upperCorner:(0,g.makeArrayPusher)(w.prototype.readFlatPosList)}},w.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:(0,g.makeReplacer)(w.prototype.readPolygonPatch)}},w.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:(0,g.makeReplacer)(w.prototype.readLineStringSegment)}},w.prototype.writeFeatures,w.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:(0,g.makeChildAppender)(w.prototype.writeRing),interior:(0,g.makeChildAppender)(w.prototype.writeRing)}},w.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:(0,g.makeChildAppender)(y.writeStringTextNode),upperCorner:(0,g.makeChildAppender)(y.writeStringTextNode)}},w.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:(0,g.makeChildAppender)(w.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,g.makeChildAppender)(w.prototype.writeSurfaceOrPolygonMember)}},w.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:(0,g.makeChildAppender)(w.prototype.writePointMember)}},w.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:(0,g.makeChildAppender)(w.prototype.writeLineStringOrCurveMember),curveMember:(0,g.makeChildAppender)(w.prototype.writeLineStringOrCurveMember)}},w.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:(0,g.makeChildAppender)(w.prototype.writeCurveOrLineString),MultiCurve:(0,g.makeChildAppender)(w.prototype.writeMultiCurveOrLineString),Point:(0,g.makeChildAppender)(w.prototype.writePoint),MultiPoint:(0,g.makeChildAppender)(w.prototype.writeMultiPoint),LineString:(0,g.makeChildAppender)(w.prototype.writeCurveOrLineString),MultiLineString:(0,g.makeChildAppender)(w.prototype.writeMultiCurveOrLineString),LinearRing:(0,g.makeChildAppender)(w.prototype.writeLinearRing),Polygon:(0,g.makeChildAppender)(w.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,g.makeChildAppender)(w.prototype.writeMultiSurfaceOrPolygon),Surface:(0,g.makeChildAppender)(w.prototype.writeSurfaceOrPolygon),MultiSurface:(0,g.makeChildAppender)(w.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,g.makeChildAppender)(w.prototype.writeEnvelope)}},i.default=w},{"../array.js":44,"../extent.js":70,"../geom/GeometryLayout.js":130,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPolygon.js":136,"../geom/Polygon.js":138,"../obj.js":203,"../proj.js":205,"../xml.js":322,"./Feature.js":76,"./GMLBase.js":81,"./xsd.js":124}],81:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.GMLNS=void 0;var p=y(t("../Feature.js")),a=y(t("../geom/GeometryLayout.js")),n=y(t("../geom/LineString.js")),r=y(t("../geom/LinearRing.js")),o=y(t("../geom/MultiLineString.js")),s=y(t("../geom/MultiPoint.js")),l=y(t("../geom/MultiPolygon.js")),u=y(t("../geom/Point.js")),h=y(t("../geom/Polygon.js")),c=y(t("./XMLFeature.js")),d=t("../obj.js"),f=t("../array.js"),b=t("../xml.js"),g=t("../proj.js"),m=t("./Feature.js");function y(t){return t&&t.__esModule?t:{default:t}}var _,v=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),j="http://www.opengis.net/gml";i.GMLNS=j;var x,S=/^[\s\xa0]*$/,w=(x=c.default,v(P,x),P.prototype.readFeaturesInternal=function(t,e){var i=t.localName,n=null;if("FeatureCollection"==i)n=(0,b.pushParseAndPop)([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if("featureMembers"==i||"featureMember"==i){var r,o=e[0],s=o.featureType,a=o.featureNS;if(!s&&t.childNodes){s=[],a={};for(var l=0,u=t.childNodes.length;l<u;++l){var h=t.childNodes[l];if(1===h.nodeType){var c=h.nodeName.split(":").pop();if(-1===s.indexOf(c)){var d="",p=0,f=h.namespaceURI;for(var g in a){if(a[g]===f){d=g;break}++p}d||(a[d="p"+p]=f),s.push(d+":"+c)}}}"featureMember"!=i&&(o.featureType=s,o.featureNS=a)}"string"==typeof a&&(r=a,(a={}).p0=r);var m={},y=Array.isArray(s)?s:[s];for(var _ in a){for(var v={},l=0,u=y.length;l<u;++l)(-1===y[l].indexOf(":")?"p0":y[l].split(":")[0])===_&&(v[y[l].split(":").pop()]=("featureMembers"==i?b.makeArrayPusher:b.makeReplacer)(this.readFeatureElement,this));m[a[_]]=v}n="featureMember"==i?(0,b.pushParseAndPop)(void 0,m,t,e):(0,b.pushParseAndPop)([],m,t,e)}return null===n&&(n=[]),n},P.prototype.readGeometryElement=function(t,e){var i=e[0];i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension");var n=(0,b.pushParseAndPop)(null,this.GEOMETRY_PARSERS,t,e,this);return n?Array.isArray(n)?(0,m.transformExtentWithOptions)(n,i):(0,m.transformGeometryWithOptions)(n,!1,i):void 0},P.prototype.readFeatureElementInternal=function(t,e,i){for(var n,r={},o=t.firstElementChild;o;o=o.nextElementSibling){var s=void 0,a=o.localName;0===o.childNodes.length||1===o.childNodes.length&&(3===o.firstChild.nodeType||4===o.firstChild.nodeType)?(s=(0,b.getAllTextContent)(o,!1),S.test(s)&&(s=void 0)):(i&&(s=this.readGeometryElement(o,e)),s?"boundedBy"!==a&&(n=a):s=this.readFeatureElementInternal(o,e,!1)),r[a]?(r[a]instanceof Array||(r[a]=[r[a]]),r[a].push(s)):r[a]=s;var l=o.attributes.length;if(0<l){r[a]={_content_:r[a]};for(var u=0;u<l;u++){var h=o.attributes[u].name;r[a][h]=o.attributes[u].value}}}if(i){var c=new p.default(r);n&&c.setGeometryName(n);var d=t.getAttribute("fid")||(0,b.getAttributeNS)(t,this.namespace,"id");return d&&c.setId(d),c}return r},P.prototype.readFeatureElement=function(t,e){return this.readFeatureElementInternal(t,e,!0)},P.prototype.readPoint=function(t,e){var i=this.readFlatCoordinatesFromNode(t,e);if(i)return new u.default(i,a.default.XYZ)},P.prototype.readMultiPoint=function(t,e){var i=(0,b.pushParseAndPop)([],this.MULTIPOINT_PARSERS,t,e,this);return i?new s.default(i):void 0},P.prototype.readMultiLineString=function(t,e){var i=(0,b.pushParseAndPop)([],this.MULTILINESTRING_PARSERS,t,e,this);if(i)return new o.default(i)},P.prototype.readMultiPolygon=function(t,e){var i=(0,b.pushParseAndPop)([],this.MULTIPOLYGON_PARSERS,t,e,this);if(i)return new l.default(i)},P.prototype.pointMemberParser=function(t,e){(0,b.parseNode)(this.POINTMEMBER_PARSERS,t,e,this)},P.prototype.lineStringMemberParser=function(t,e){(0,b.parseNode)(this.LINESTRINGMEMBER_PARSERS,t,e,this)},P.prototype.polygonMemberParser=function(t,e){(0,b.parseNode)(this.POLYGONMEMBER_PARSERS,t,e,this)},P.prototype.readLineString=function(t,e){var i=this.readFlatCoordinatesFromNode(t,e);return i?new n.default(i,a.default.XYZ):void 0},P.prototype.readFlatLinearRing=function(t,e){return(0,b.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)||void 0},P.prototype.readLinearRing=function(t,e){var i=this.readFlatCoordinatesFromNode(t,e);if(i)return new r.default(i,a.default.XYZ)},P.prototype.readPolygon=function(t,e){var i=(0,b.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(i&&i[0]){for(var n=i[0],r=[n.length],o=void 0,o=1,s=i.length;o<s;++o)(0,f.extend)(n,i[o]),r.push(n.length);return new h.default(n,a.default.XYZ,r)}},P.prototype.readFlatCoordinatesFromNode=function(t,e){return(0,b.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},P.prototype.readGeometryFromNode=function(t,e){return this.readGeometryElement(t,[this.getReadOptions(t,e||{})])||null},P.prototype.readFeaturesFromNode=function(t,e){var i={featureType:this.featureType,featureNS:this.featureNS};return e&&(0,d.assign)(i,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[i])||[]},P.prototype.readProjectionFromNode=function(t){return(0,g.get)(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))},P);function P(t){var e=x.call(this)||this,i=t||{};return e.featureType=i.featureType,e.featureNS=i.featureNS,e.srsName=i.srsName,e.schemaLocation="",e.FEATURE_COLLECTION_PARSERS={},e.FEATURE_COLLECTION_PARSERS[e.namespace]={featureMember:(0,b.makeArrayPusher)(e.readFeaturesInternal),featureMembers:(0,b.makeReplacer)(e.readFeaturesInternal)},e}w.prototype.namespace=j,w.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},w.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},w.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},w.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:(0,b.makeArrayPusher)(w.prototype.pointMemberParser),pointMembers:(0,b.makeArrayPusher)(w.prototype.pointMemberParser)}},w.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:(0,b.makeArrayPusher)(w.prototype.lineStringMemberParser),lineStringMembers:(0,b.makeArrayPusher)(w.prototype.lineStringMemberParser)}},w.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:(0,b.makeArrayPusher)(w.prototype.polygonMemberParser),polygonMembers:(0,b.makeArrayPusher)(w.prototype.polygonMemberParser)}},w.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:(0,b.makeArrayPusher)(w.prototype.readFlatCoordinatesFromNode)}},w.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:(0,b.makeArrayPusher)(w.prototype.readLineString)}},w.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:(0,b.makeArrayPusher)(w.prototype.readPolygon)}},w.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:(0,b.makeReplacer)(w.prototype.readFlatLinearRing)}},i.default=w},{"../Feature.js":13,"../array.js":44,"../geom/GeometryLayout.js":130,"../geom/LineString.js":132,"../geom/LinearRing.js":133,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../obj.js":203,"../proj.js":205,"../xml.js":322,"./Feature.js":76,"./XMLFeature.js":100}],82:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var h=a(t("../Feature.js")),l=a(t("../geom/GeometryLayout.js")),c=a(t("../geom/GeometryType.js")),u=a(t("../geom/LineString.js")),d=a(t("../geom/MultiLineString.js")),p=a(t("../geom/Point.js")),n=a(t("./XMLFeature.js")),f=t("../xml.js"),r=t("../proj.js"),o=t("../array.js"),s=t("./xsd.js"),g=t("./Feature.js");function a(t){return t&&t.__esModule?t:{default:t}}var m,y,_=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],b={rte:K,trk:Z,wpt:$},j=(0,f.makeStructureNS)(v,{rte:(0,f.makeArrayPusher)(K),trk:(0,f.makeArrayPusher)(Z),wpt:(0,f.makeArrayPusher)($)}),x=(0,f.makeStructureNS)(v,{text:(0,f.makeObjectPropertySetter)(s.readString,"linkText"),type:(0,f.makeObjectPropertySetter)(s.readString,"linkType")}),S=(0,f.makeStructureNS)(v,{rte:(0,f.makeChildAppender)(function(t,e,i){var n=i[0],r=e.getProperties(),o={node:t};o.properties=r;var s=e.getGeometry();{var a;s.getType()==c.default.LINE_STRING&&(a=(0,g.transformGeometryWithOptions)(s,!0,n),o.geometryLayout=a.getLayout(),r.rtept=a.getCoordinates())}var l=i[i.length-1].node,u=k[l.namespaceURI],h=(0,f.makeSequence)(r,u);(0,f.pushSerializeAndPop)(o,A,f.OBJECT_PROPERTY_NODE_FACTORY,h,i,u)}),trk:(0,f.makeChildAppender)(function(t,e,i){var n=i[0],r=e.getProperties(),o={node:t};o.properties=r;var s=e.getGeometry();{var a;s.getType()==c.default.MULTI_LINE_STRING&&(a=(0,g.transformGeometryWithOptions)(s,!0,n),r.trkseg=a.getLineStrings())}var l=i[i.length-1].node,u=F[l.namespaceURI],h=(0,f.makeSequence)(r,u);(0,f.pushSerializeAndPop)(o,N,f.OBJECT_PROPERTY_NODE_FACTORY,h,i,u)}),wpt:(0,f.makeChildAppender)(function(t,e,i){var n=i[0],r=i[i.length-1];r.properties=e.getProperties();var o=e.getGeometry();{var s;o.getType()==c.default.POINT&&(s=(0,g.transformGeometryWithOptions)(o,!0,n),r.geometryLayout=s.getLayout(),J(t,s.getCoordinates(),i))}})}),w=(m=n.default,_(W,m),W.prototype.handleReadExtensions_=function(t){for(var e=0,i=(t=t||[]).length;e<i;++e){var n,r=t[e];this.readExtensions_&&(n=r.get("extensionsNode_")||null,this.readExtensions_(r,n)),r.set("extensionsNode_",void 0)}},W.prototype.readFeatureFromNode=function(t,e){if(!(0,o.includes)(v,t.namespaceURI))return null;var i=b[t.localName];if(!i)return null;var n=i(t,[this.getReadOptions(t,e)]);return n?(this.handleReadExtensions_([n]),n):null},W.prototype.readFeaturesFromNode=function(t,e){if(!(0,o.includes)(v,t.namespaceURI))return[];if("gpx"!=t.localName)return[];var i=(0,f.pushParseAndPop)([],j,t,[this.getReadOptions(t,e)]);return i?(this.handleReadExtensions_(i),i):[]},W.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=(0,f.createElementNS)("http://www.topografix.com/GPX/1/1","gpx");return i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",f.XML_SCHEMA_INSTANCE_URI),i.setAttributeNS(f.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),i.setAttribute("version","1.1"),i.setAttribute("creator","OpenLayers"),(0,f.pushSerializeAndPop)({node:i},S,V,t,[e]),i},W),P=(0,f.makeStructureNS)(v,{name:(0,f.makeObjectPropertySetter)(s.readString),cmt:(0,f.makeObjectPropertySetter)(s.readString),desc:(0,f.makeObjectPropertySetter)(s.readString),src:(0,f.makeObjectPropertySetter)(s.readString),link:X,number:(0,f.makeObjectPropertySetter)(s.readNonNegativeInteger),extensions:q,type:(0,f.makeObjectPropertySetter)(s.readString),rtept:function(t,e){var i=(0,f.pushParseAndPop)({},E,t,e);{var n;i&&Y((n=e[e.length-1]).flatCoordinates,n.layoutOptions,t,i)}}}),E=(0,f.makeStructureNS)(v,{ele:(0,f.makeObjectPropertySetter)(s.readDecimal),time:(0,f.makeObjectPropertySetter)(s.readDateTime)}),T=(0,f.makeStructureNS)(v,{name:(0,f.makeObjectPropertySetter)(s.readString),cmt:(0,f.makeObjectPropertySetter)(s.readString),desc:(0,f.makeObjectPropertySetter)(s.readString),src:(0,f.makeObjectPropertySetter)(s.readString),link:X,number:(0,f.makeObjectPropertySetter)(s.readNonNegativeInteger),type:(0,f.makeObjectPropertySetter)(s.readString),extensions:q,trkseg:function(t,e){var i=e[e.length-1];(0,f.parseNode)(O,t,e);var n=i.flatCoordinates;i.ends.push(n.length)}}),O=(0,f.makeStructureNS)(v,{trkpt:function(t,e){var i=(0,f.pushParseAndPop)({},C,t,e);{var n;i&&Y((n=e[e.length-1]).flatCoordinates,n.layoutOptions,t,i)}}}),C=(0,f.makeStructureNS)(v,{ele:(0,f.makeObjectPropertySetter)(s.readDecimal),time:(0,f.makeObjectPropertySetter)(s.readDateTime)}),M=(0,f.makeStructureNS)(v,{ele:(0,f.makeObjectPropertySetter)(s.readDecimal),time:(0,f.makeObjectPropertySetter)(s.readDateTime),magvar:(0,f.makeObjectPropertySetter)(s.readDecimal),geoidheight:(0,f.makeObjectPropertySetter)(s.readDecimal),name:(0,f.makeObjectPropertySetter)(s.readString),cmt:(0,f.makeObjectPropertySetter)(s.readString),desc:(0,f.makeObjectPropertySetter)(s.readString),src:(0,f.makeObjectPropertySetter)(s.readString),link:X,sym:(0,f.makeObjectPropertySetter)(s.readString),type:(0,f.makeObjectPropertySetter)(s.readString),fix:(0,f.makeObjectPropertySetter)(s.readString),sat:(0,f.makeObjectPropertySetter)(s.readNonNegativeInteger),hdop:(0,f.makeObjectPropertySetter)(s.readDecimal),vdop:(0,f.makeObjectPropertySetter)(s.readDecimal),pdop:(0,f.makeObjectPropertySetter)(s.readDecimal),ageofdgpsdata:(0,f.makeObjectPropertySetter)(s.readDecimal),dgpsid:(0,f.makeObjectPropertySetter)(s.readNonNegativeInteger),extensions:q}),I=["text","type"],R=(0,f.makeStructureNS)(v,{text:(0,f.makeChildAppender)(s.writeStringTextNode),type:(0,f.makeChildAppender)(s.writeStringTextNode)}),k=(0,f.makeStructureNS)(v,["name","cmt","desc","src","link","number","type","rtept"]),A=(0,f.makeStructureNS)(v,{name:(0,f.makeChildAppender)(s.writeStringTextNode),cmt:(0,f.makeChildAppender)(s.writeStringTextNode),desc:(0,f.makeChildAppender)(s.writeStringTextNode),src:(0,f.makeChildAppender)(s.writeStringTextNode),link:(0,f.makeChildAppender)(Q),number:(0,f.makeChildAppender)(s.writeNonNegativeIntegerTextNode),type:(0,f.makeChildAppender)(s.writeStringTextNode),rtept:(0,f.makeArraySerializer)((0,f.makeChildAppender)(J))}),L=(0,f.makeStructureNS)(v,["ele","time"]),F=(0,f.makeStructureNS)(v,["name","cmt","desc","src","link","number","type","trkseg"]),N=(0,f.makeStructureNS)(v,{name:(0,f.makeChildAppender)(s.writeStringTextNode),cmt:(0,f.makeChildAppender)(s.writeStringTextNode),desc:(0,f.makeChildAppender)(s.writeStringTextNode),src:(0,f.makeChildAppender)(s.writeStringTextNode),link:(0,f.makeChildAppender)(Q),number:(0,f.makeChildAppender)(s.writeNonNegativeIntegerTextNode),type:(0,f.makeChildAppender)(s.writeStringTextNode),trkseg:(0,f.makeArraySerializer)((0,f.makeChildAppender)(function(t,e,i){var n={node:t};n.geometryLayout=e.getLayout(),n.properties={},(0,f.pushSerializeAndPop)(n,G,D,e.getCoordinates(),i)}))}),D=(0,f.makeSimpleNodeFactory)("trkpt"),G=(0,f.makeStructureNS)(v,{trkpt:(0,f.makeChildAppender)(J)}),U=(0,f.makeStructureNS)(v,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),z=(0,f.makeStructureNS)(v,{ele:(0,f.makeChildAppender)(s.writeDecimalTextNode),time:(0,f.makeChildAppender)(s.writeDateTimeTextNode),magvar:(0,f.makeChildAppender)(s.writeDecimalTextNode),geoidheight:(0,f.makeChildAppender)(s.writeDecimalTextNode),name:(0,f.makeChildAppender)(s.writeStringTextNode),cmt:(0,f.makeChildAppender)(s.writeStringTextNode),desc:(0,f.makeChildAppender)(s.writeStringTextNode),src:(0,f.makeChildAppender)(s.writeStringTextNode),link:(0,f.makeChildAppender)(Q),sym:(0,f.makeChildAppender)(s.writeStringTextNode),type:(0,f.makeChildAppender)(s.writeStringTextNode),fix:(0,f.makeChildAppender)(s.writeStringTextNode),sat:(0,f.makeChildAppender)(s.writeNonNegativeIntegerTextNode),hdop:(0,f.makeChildAppender)(s.writeDecimalTextNode),vdop:(0,f.makeChildAppender)(s.writeDecimalTextNode),pdop:(0,f.makeChildAppender)(s.writeDecimalTextNode),ageofdgpsdata:(0,f.makeChildAppender)(s.writeDecimalTextNode),dgpsid:(0,f.makeChildAppender)(s.writeNonNegativeIntegerTextNode)}),B={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function W(t){var e=m.call(this)||this,i=t||{};return e.dataProjection=(0,r.get)("EPSG:4326"),e.readExtensions_=i.readExtensions,e}function V(t,e,i){var n=t.getGeometry();if(n){var r=B[n.getType()];if(r){var o=e[e.length-1].node;return(0,f.createElementNS)(o.namespaceURI,r)}}}function Y(t,e,i,n){return t.push(parseFloat(i.getAttribute("lon")),parseFloat(i.getAttribute("lat"))),"ele"in n?(t.push(n.ele),delete n.ele,e.hasZ=!0):t.push(0),"time"in n?(t.push(n.time),delete n.time,e.hasM=!0):t.push(0),t}function H(t,e,i){var n=l.default.XY,r=2;if(t.hasZ&&t.hasM?(n=l.default.XYZM,r=4):t.hasZ?(n=l.default.XYZ,r=3):t.hasM&&(n=l.default.XYM,r=3),4!==r){for(var o=0,s=e.length/4;o<s;o++)e[o*r]=e[4*o],e[o*r+1]=e[4*o+1],t.hasZ&&(e[o*r+2]=e[4*o+2]),t.hasM&&(e[o*r+2]=e[4*o+3]);if(e.length=e.length/4*r,i)for(o=0,s=i.length;o<s;o++)i[o]=i[o]/4*r}return n}function X(t,e){var i=e[e.length-1],n=t.getAttribute("href");null!==n&&(i.link=n),(0,f.parseNode)(x,t,e)}function q(t,e){e[e.length-1].extensionsNode_=t}function K(t,e){var i=e[0],n=(0,f.pushParseAndPop)({flatCoordinates:[],layoutOptions:{}},P,t,e);if(n){var r=n.flatCoordinates;delete n.flatCoordinates;var o=n.layoutOptions;delete n.layoutOptions;var s=H(o,r),a=new u.default(r,s);(0,g.transformGeometryWithOptions)(a,!1,i);var l=new h.default(a);return l.setProperties(n,!0),l}}function Z(t,e){var i=e[0],n=(0,f.pushParseAndPop)({flatCoordinates:[],ends:[],layoutOptions:{}},T,t,e);if(n){var r=n.flatCoordinates;delete n.flatCoordinates;var o=n.ends;delete n.ends;var s=n.layoutOptions;delete n.layoutOptions;var a=H(s,r,o),l=new d.default(r,a,o);(0,g.transformGeometryWithOptions)(l,!1,i);var u=new h.default(l);return u.setProperties(n,!0),u}}function $(t,e){var i=e[0],n=(0,f.pushParseAndPop)({},M,t,e);if(n){var r={},o=Y([],r,t,n),s=H(r,o),a=new p.default(o,s);(0,g.transformGeometryWithOptions)(a,!1,i);var l=new h.default(a);return l.setProperties(n,!0),l}}function Q(t,e,i){t.setAttribute("href",e);var n=i[i.length-1].properties,r=[n.linkText,n.linkType];(0,f.pushSerializeAndPop)({node:t},R,f.OBJECT_PROPERTY_NODE_FACTORY,r,i,I)}function J(t,e,i){var n=i[i.length-1],r=n.node.namespaceURI,o=n.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),n.geometryLayout){case l.default.XYZM:0!==e[3]&&(o.time=e[3]);case l.default.XYZ:0!==e[2]&&(o.ele=e[2]);break;case l.default.XYM:0!==e[2]&&(o.time=e[2])}var s="rtept"==t.nodeName?L[r]:U[r],a=(0,f.makeSequence)(o,s);(0,f.pushSerializeAndPop)({node:t,properties:o},z,f.OBJECT_PROPERTY_NODE_FACTORY,a,i,s)}i.default=w},{"../Feature.js":13,"../array.js":44,"../geom/GeometryLayout.js":130,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/Point.js":137,"../proj.js":205,"../xml.js":322,"./Feature.js":76,"./XMLFeature.js":100,"./xsd.js":124}],83:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=a(t("../Feature.js")),c=a(t("../geom/GeometryCollection.js")),d=a(t("../geom/GeometryType.js")),n=a(t("./JSONFeature.js")),p=a(t("../geom/LineString.js")),f=a(t("../geom/MultiLineString.js")),g=a(t("../geom/MultiPoint.js")),m=a(t("../geom/MultiPolygon.js")),y=a(t("../geom/Point.js")),_=a(t("../geom/Polygon.js")),r=t("../asserts.js"),v=t("../obj.js"),s=t("../proj.js"),b=t("./Feature.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),j=(l=n.default,h(x,l),x.prototype.readFeatureFromObject=function(t,e){var i,n=S((i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),r=new o.default;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&r.setGeometryName(i.geometry_name),r.setGeometry(n),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r},x.prototype.readFeaturesFromObject=function(t,e){var i=null;if("FeatureCollection"===t.type){i=[];for(var n=t.features,r=0,o=n.length;r<o;++r)i.push(this.readFeatureFromObject(n[r],e))}else i=[this.readFeatureFromObject(t,e)];return i},x.prototype.readGeometryFromObject=S,x.prototype.readProjectionFromObject=function(t){var e,i=t.crs;return i?"name"==i.type?e=(0,s.get)(i.properties.name):"EPSG"===i.type?e=(0,s.get)("EPSG:"+i.properties.code):(0,r.assert)(!1,36):e=this.dataProjection,e},x.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;var r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=w(o,e),delete r[t.getGeometryName()]),(0,v.isEmpty)(r)||(i.properties=r),i},x.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}},x.prototype.writeGeometryObject=function(t,e){return w(t,this.adaptOptions(e))},x);function x(t){var e=this,i=t||{};return(e=l.call(this)||this).dataProjection=(0,s.get)(i.dataProjection?i.dataProjection:"EPSG:4326"),i.featureProjection&&(e.defaultFeatureProjection=(0,s.get)(i.featureProjection)),e.geometryName_=i.geometryName,e.extractGeometryName_=i.extractGeometryName,e}function S(t,e){if(!t)return null;var i,n,r,o,s,a,l,u,h;switch(t.type){case d.default.POINT:h=t,i=new y.default(h.coordinates);break;case d.default.LINE_STRING:u=t,i=new p.default(u.coordinates);break;case d.default.POLYGON:l=t,i=new _.default(l.coordinates);break;case d.default.MULTI_POINT:a=t,i=new g.default(a.coordinates);break;case d.default.MULTI_LINE_STRING:s=t,i=new f.default(s.coordinates);break;case d.default.MULTI_POLYGON:o=t,i=new m.default(o.coordinates);break;case d.default.GEOMETRY_COLLECTION:r=t.geometries.map(function(t){return S(t,n)}),i=new c.default(r);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return(0,b.transformGeometryWithOptions)(i,!1,e)}function w(t,e){var i,n,r,o,s,a,l,u,h=(t=(0,b.transformGeometryWithOptions)(t,!0,e)).getType();switch(h){case d.default.POINT:i={type:"Point",coordinates:t.getCoordinates()};break;case d.default.LINE_STRING:i={type:"LineString",coordinates:t.getCoordinates()};break;case d.default.POLYGON:a=t,(l=e)&&(u=l.rightHanded),i={type:"Polygon",coordinates:a.getCoordinates(u)};break;case d.default.MULTI_POINT:i={type:"MultiPoint",coordinates:t.getCoordinates()};break;case d.default.MULTI_LINE_STRING:i={type:"MultiLineString",coordinates:t.getCoordinates()};break;case d.default.MULTI_POLYGON:r=t,(o=e)&&(s=o.rightHanded),i={type:"MultiPolygon",coordinates:r.getCoordinates(s)};break;case d.default.GEOMETRY_COLLECTION:n=e,i={type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(t){var e=(0,v.assign)({},n);return delete e.featureProjection,w(t,e)})};break;case d.default.CIRCLE:i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+h)}return i}i.default=j},{"../Feature.js":13,"../asserts.js":45,"../geom/GeometryCollection.js":129,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../obj.js":203,"../proj.js":205,"./Feature.js":76,"./JSONFeature.js":86}],84:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var w=o(t("../Feature.js")),P=o(t("../geom/GeometryLayout.js")),E=o(t("../geom/LineString.js")),n=o(t("./TextFeature.js")),r=t("../proj.js"),T=t("./Feature.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),O="barometric",C="gps",M="none",I=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,R=/^H.([A-Z]{3}).*?:(.*)/,k=/^HFDTE(\d{2})(\d{2})(\d{2})/,A=/\r\n|\r|\n/,u=(s=n.default,l(h,s),h.prototype.readFeatureFromText=function(t,e){for(var i=this.altitudeMode_,n=t.split(A),r={},o=[],s=2e3,a=0,l=1,u=-1,h=0,c=n.length;h<c;++h){var d,p,f,g,m,y,_,v=n[h],b=void 0;"B"==v.charAt(0)?(b=I.exec(v))&&(d=parseInt(b[1],10),p=parseInt(b[2],10),f=parseInt(b[3],10),g=parseInt(b[4],10)+parseInt(b[5],10)/6e4,"S"==b[6]&&(g=-g),m=parseInt(b[7],10)+parseInt(b[8],10)/6e4,"W"==b[9]&&(m=-m),o.push(m,g),i!=M&&(y=i==C?parseInt(b[11],10):i==O?parseInt(b[12],10):0,o.push(y)),(_=Date.UTC(s,a,l,d,p,f))<u&&(_=Date.UTC(s,a,l+1,d,p,f)),o.push(_/1e3),u=_):"H"==v.charAt(0)&&((b=k.exec(v))?(l=parseInt(b[1],10),a=parseInt(b[2],10)-1,s=2e3+parseInt(b[3],10)):(b=R.exec(v))&&(r[b[1]]=b[2].trim()))}if(0===o.length)return null;var j=i==M?P.default.XYM:P.default.XYZM,x=new E.default(o,j),S=new w.default((0,T.transformGeometryWithOptions)(x,!1,e));return S.setProperties(r,!0),S},h.prototype.readFeaturesFromText=function(t,e){var i=this.readFeatureFromText(t,e);return i?[i]:[]},h);function h(t){var e=s.call(this)||this,i=t||{};return e.dataProjection=(0,r.get)("EPSG:4326"),e.altitudeMode_=i.altitudeMode?i.altitudeMode:M,e}i.default=u},{"../Feature.js":13,"../geom/GeometryLayout.js":130,"../geom/LineString.js":132,"../proj.js":205,"./Feature.js":76,"./TextFeature.js":91}],85:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.Versions=void 0;function s(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),r=0,e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)n[r]=o[s];return n}var n=t("../asserts.js"),r={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"};i.Versions=r;var o={};o[r.VERSION1]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},o[r.VERSION2]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},o[r.VERSION3]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},o.none={none:{supports:[],formats:[],qualities:[]}};var a=/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/,l=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,u=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/;var h={};h[r.VERSION1]=function(t){var e=t.getComplianceLevelSupportedFeatures();return void 0===e&&(e=o[r.VERSION1].level0),{url:void 0===t.imageInfo["@id"]?void 0:t.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:e.supports,formats:s(e.formats,[void 0===t.imageInfo.formats?[]:t.imageInfo.formats]),qualities:s(e.qualities,[void 0===t.imageInfo.qualities?[]:t.imageInfo.qualities]),resolutions:t.imageInfo.scale_factors,tileSize:void 0!==t.imageInfo.tile_width?void 0!==t.imageInfo.tile_height?[t.imageInfo.tile_width,t.imageInfo.tile_height]:[t.imageInfo.tile_width,t.imageInfo.tile_width]:null!=t.imageInfo.tile_height?[t.imageInfo.tile_height,t.imageInfo.tile_height]:void 0}},h[r.VERSION2]=function(t){var e=t.getComplianceLevelSupportedFeatures(),i=Array.isArray(t.imageInfo.profile)&&1<t.imageInfo.profile.length,n=i&&t.imageInfo.profile[1].supports?t.imageInfo.profile[1].supports:[],r=i&&t.imageInfo.profile[1].formats?t.imageInfo.profile[1].formats:[],o=i&&t.imageInfo.profile[1].qualities?t.imageInfo.profile[1].qualities:[];return{url:t.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:void 0===t.imageInfo.sizes?void 0:t.imageInfo.sizes.map(function(t){return[t.width,t.height]}),tileSize:void 0===t.imageInfo.tiles?void 0:[t.imageInfo.tiles.map(function(t){return t.width})[0],t.imageInfo.tiles.map(function(t){return void 0===t.height?t.width:t.height})[0]],resolutions:void 0===t.imageInfo.tiles?void 0:t.imageInfo.tiles.map(function(t){return t.scaleFactors})[0],supports:s(e.supports,n),formats:s(e.formats,r),qualities:s(e.qualities,o)}},h[r.VERSION3]=function(t){var e=t.getComplianceLevelSupportedFeatures(),i=void 0===t.imageInfo.extraFormats?e.formats:s(e.formats,t.imageInfo.extraFormats),n=void 0!==t.imageInfo.preferredFormats&&Array.isArray(t.imageInfo.preferredFormats)&&0<t.imageInfo.preferredFormats.length?t.imageInfo.preferredFormats.filter(function(t){return["jpg","png","gif"].includes(t)}).reduce(function(t,e){return void 0===t&&i.includes(e)?e:t},void 0):void 0;return{url:t.imageInfo.id,sizes:void 0===t.imageInfo.sizes?void 0:t.imageInfo.sizes.map(function(t){return[t.width,t.height]}),tileSize:void 0===t.imageInfo.tiles?void 0:[t.imageInfo.tiles.map(function(t){return t.width})[0],t.imageInfo.tiles.map(function(t){return t.height})[0]],resolutions:void 0===t.imageInfo.tiles?void 0:t.imageInfo.tiles.map(function(t){return t.scaleFactors})[0],supports:void 0===t.imageInfo.extraFeatures?e.supports:s(e.supports,t.imageInfo.extraFeatures),formats:i,qualities:void 0===t.imageInfo.extraQualities?e.qualities:s(e.qualities,t.imageInfo.extraQualities),preferredFormat:n}};var c=(d.prototype.setImageInfo=function(t){this.imageInfo="string"==typeof t?JSON.parse(t):t},d.prototype.getImageApiVersion=function(){if(void 0!==this.imageInfo){var t=this.imageInfo["@context"]||"ol-no-context";"string"==typeof t&&(t=[t]);for(var e=0;e<t.length;e++)switch(t[e]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return r.VERSION1;case"http://iiif.io/api/image/2/context.json":return r.VERSION2;case"http://iiif.io/api/image/3/context.json":return r.VERSION3;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(r.VERSION1)&&this.imageInfo.identifier)return r.VERSION1}(0,n.assert)(!1,61)}},d.prototype.getComplianceLevelEntryFromProfile=function(t){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===t&&(t=this.getImageApiVersion()),t){case r.VERSION1:if(a.test(this.imageInfo.profile))return this.imageInfo.profile;break;case r.VERSION3:if(u.test(this.imageInfo.profile))return this.imageInfo.profile;break;case r.VERSION2:if("string"==typeof this.imageInfo.profile&&l.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&0<this.imageInfo.profile.length&&"string"==typeof this.imageInfo.profile[0]&&l.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}},d.prototype.getComplianceLevelFromProfile=function(t){var e=this.getComplianceLevelEntryFromProfile(t);if(void 0!==e){var i=e.match(/level[0-2](?:\.json)?$/g);return Array.isArray(i)?i[0].replace(".json",""):void 0}},d.prototype.getComplianceLevelSupportedFeatures=function(){if(void 0!==this.imageInfo){var t=this.getImageApiVersion(),e=this.getComplianceLevelFromProfile(t);return void 0===e?o.none.none:o[t][e]}},d.prototype.getTileSourceOptions=function(t){var e=t||{},i=this.getImageApiVersion();if(void 0!==i){var n=void 0===i?void 0:h[i](this);if(void 0!==n)return{url:n.url,version:i,size:[this.imageInfo.width,this.imageInfo.height],sizes:n.sizes,format:void 0!==e.format&&n.formats.includes(e.format)?e.format:void 0!==n.preferredFormat?n.preferredFormat:"jpg",supports:n.supports,quality:e.quality&&n.qualities.includes(e.quality)?e.quality:n.qualities.includes("native")?"native":"default",resolutions:Array.isArray(n.resolutions)?n.resolutions.sort(function(t,e){return e-t}):void 0,tileSize:n.tileSize}}},d);function d(t){this.setImageInfo(t)}i.default=c},{"../asserts.js":45}],86:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./Feature.js")),r=s(t("./FormatType.js")),o=t("../util.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.getType=function(){return r.default.JSON},c.prototype.readFeature=function(t,e){return this.readFeatureFromObject(d(t),this.getReadOptions(t,e))},c.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(d(t),this.getReadOptions(t,e))},c.prototype.readFeatureFromObject=function(t,e){return(0,o.abstract)()},c.prototype.readFeaturesFromObject=function(t,e){return(0,o.abstract)()},c.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(d(t),this.getReadOptions(t,e))},c.prototype.readGeometryFromObject=function(t,e){return(0,o.abstract)()},c.prototype.readProjection=function(t){return this.readProjectionFromObject(d(t))},c.prototype.readProjectionFromObject=function(t){return(0,o.abstract)()},c.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},c.prototype.writeFeatureObject=function(t,e){return(0,o.abstract)()},c.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},c.prototype.writeFeaturesObject=function(t,e){return(0,o.abstract)()},c.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},c.prototype.writeGeometryObject=function(t,e){return(0,o.abstract)()},c);function c(){return a.call(this)||this}function d(t){return"string"!=typeof t?null!==t?t:null:JSON.parse(t)||null}i.default=h},{"../util.js":313,"./Feature.js":76,"./FormatType.js":77}],87:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaultFillStyle=function(){return K},i.getDefaultImageStyle=function(){return $},i.getDefaultStrokeStyle=function(){return J},i.getDefaultTextStyle=function(){return tt},i.getDefaultStyle=function(){return et},i.getDefaultStyleArray=function(){return nt},i.readFlatCoordinates=lt,i.default=void 0;var l=C(t("../Feature.js")),a=C(t("../style/Fill.js")),f=C(t("../geom/GeometryCollection.js")),c=C(t("../geom/GeometryLayout.js")),b=C(t("../geom/GeometryType.js")),w=C(t("../style/Icon.js")),P=C(t("../style/IconAnchorUnits.js")),E=C(t("../style/IconOrigin.js")),u=C(t("../geom/LineString.js")),d=C(t("../geom/MultiLineString.js")),p=C(t("../geom/MultiPoint.js")),g=C(t("../geom/MultiPolygon.js")),o=C(t("../geom/Point.js")),h=C(t("../geom/Polygon.js")),s=C(t("../style/Stroke.js")),m=C(t("../style/Style.js")),y=C(t("../style/Text.js")),n=C(t("./XMLFeature.js")),T=t("../xml.js"),_=t("../color.js"),v=t("../asserts.js"),j=t("../array.js"),r=t("../proj.js"),x=t("./xsd.js"),O=t("../math.js"),S=t("./Feature.js");function C(t){return t&&t.__esModule?t:{default:t}}function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var I,R,k,A,L,F,N,D,G=(D=function(t,e){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}D(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),U=["http://www.google.com/kml/ext/2.2"],z=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],B={fraction:P.default.FRACTION,pixels:P.default.PIXELS,insetPixels:P.default.PIXELS},W=(0,T.makeStructureNS)(z,{ExtendedData:Dt,Region:Gt,MultiGeometry:(0,T.makeObjectPropertySetter)(Ct,"geometry"),LineString:(0,T.makeObjectPropertySetter)(Et,"geometry"),LinearRing:(0,T.makeObjectPropertySetter)(Tt,"geometry"),Point:(0,T.makeObjectPropertySetter)(Mt,"geometry"),Polygon:(0,T.makeObjectPropertySetter)(Rt,"geometry"),Style:(0,T.makeObjectPropertySetter)(At),StyleMap:function(t,e){var i=dt.call(this,t,e);{var n;i&&(n=e[e.length-1],Array.isArray(i)?n.Style=i:"string"==typeof i?n.styleUrl=i:(0,v.assert)(!1,38))}},address:(0,T.makeObjectPropertySetter)(x.readString),description:(0,T.makeObjectPropertySetter)(x.readString),name:(0,T.makeObjectPropertySetter)(x.readString),open:(0,T.makeObjectPropertySetter)(x.readBoolean),phoneNumber:(0,T.makeObjectPropertySetter)(x.readString),styleUrl:(0,T.makeObjectPropertySetter)(ut),visibility:(0,T.makeObjectPropertySetter)(x.readBoolean)},(0,T.makeStructureNS)(U,{MultiTrack:(0,T.makeObjectPropertySetter)(function(t,e){var i=(0,T.pushParseAndPop)([],vt,t,e);if(i)return new d.default(i)},"geometry"),Track:(0,T.makeObjectPropertySetter)(jt,"geometry")})),V=(0,T.makeStructureNS)(z,{ExtendedData:Dt,Region:Gt,Link:function(t,e){(0,T.parseNode)(Y,t,e)},address:(0,T.makeObjectPropertySetter)(x.readString),description:(0,T.makeObjectPropertySetter)(x.readString),name:(0,T.makeObjectPropertySetter)(x.readString),open:(0,T.makeObjectPropertySetter)(x.readBoolean),phoneNumber:(0,T.makeObjectPropertySetter)(x.readString),visibility:(0,T.makeObjectPropertySetter)(x.readBoolean)}),Y=(0,T.makeStructureNS)(z,{href:(0,T.makeObjectPropertySetter)(ut)}),H=(0,T.makeStructureNS)(z,{LatLonAltBox:function(t,e){var i=(0,T.pushParseAndPop)({},Bt,t,e);{var n,r;i&&(n=e[e.length-1],r=[parseFloat(i.west),parseFloat(i.south),parseFloat(i.east),parseFloat(i.north)],n.extent=r,n.altitudeMode=i.altitudeMode,n.minAltitude=parseFloat(i.minAltitude),n.maxAltitude=parseFloat(i.maxAltitude))}},Lod:function(t,e){var i=(0,T.pushParseAndPop)({},Wt,t,e);{var n;i&&((n=e[e.length-1]).minLodPixels=parseFloat(i.minLodPixels),n.maxLodPixels=parseFloat(i.maxLodPixels),n.minFadeExtent=parseFloat(i.minFadeExtent),n.maxFadeExtent=parseFloat(i.maxFadeExtent))}}}),X=(0,T.makeStructureNS)(z,["Document","Placemark"]),q=(0,T.makeStructureNS)(z,{Document:(0,T.makeChildAppender)(function(t,e,i){var n={node:t};(0,T.pushSerializeAndPop)(n,qt,Kt,e,i,void 0,this)}),Placemark:(0,T.makeChildAppender)(ve)}),K=null;var Z,$=null;var Q,J=null;var tt=null;var et=null;var it,nt=null;var rt,ot=(rt=n.default,G(st,rt),st.prototype.readDocumentOrFolder_=function(t,e){var i=(0,T.makeStructureNS)(z,{Document:(0,T.makeArrayExtender)(this.readDocumentOrFolder_,this),Folder:(0,T.makeArrayExtender)(this.readDocumentOrFolder_,this),Placemark:(0,T.makeArrayPusher)(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)});return(0,T.pushParseAndPop)([],i,t,e,this)||void 0},st.prototype.readPlacemark_=function(t,e){var u,h,c,d,p,i=(0,T.pushParseAndPop)({geometry:null},W,t,e,this);if(i){var n=new l.default,r=t.getAttribute("id");null!==r&&n.setId(r);var o,s=e[0],a=i.geometry;return a&&(0,S.transformGeometryWithOptions)(a,!1,s),n.setGeometry(a),delete i.geometry,this.extractStyles_&&(u=i.Style,h=i.styleUrl,c=this.defaultStyle_,d=this.sharedStyles_,p=this.showPointNames_,o=function(t,e){var i,n,r=p,o="",s=[];!r||(i=t.getGeometry())&&(r=(n=i.getType())===b.default.GEOMETRY_COLLECTION?0<(s=i.getGeometriesArrayRecursive().filter(function(t){var e=t.getType();return e===b.default.POINT||e===b.default.MULTI_POINT})).length:n===b.default.POINT||n===b.default.MULTI_POINT),r&&(o=t.get("name"),(r=r&&!!o)&&-1<o.search(/&[^&]+;/)&&((it=it||document.createElement("textarea")).innerHTML=o,o=it.value));var a=c;if(u?a=u:h&&(a=function t(e,i,n){return Array.isArray(e)?e:"string"==typeof e?(!(e in n)&&"#"+e in n&&(e="#"+e),t(n[e],i,n)):i}(h,c,d)),r){var l=function(t,e){var i,n,r=[0,0],o="start",s=t.getImage();s&&(null===(i=s.getImageSize())&&(i=L),2==i.length&&(n=s.getScaleArray(),r[0]=n[0]*i[0]/2,r[1]=-n[1]*i[1]/2,o="left"));var a=t.getText();return a?((a=a.clone()).setFont(a.getFont()||tt.getFont()),a.setScale(a.getScale()||tt.getScale()),a.setFill(a.getFill()||tt.getFill()),a.setStroke(a.getStroke()||Q)):a=tt.clone(),a.setText(e),a.setOffsetX(r[0]),a.setOffsetY(r[1]),a.setTextAlign(o),new m.default({image:s,text:a})}(a[0],o);return 0<s.length?(l.setGeometry(new f.default(s)),[l,new m.default({geometry:a[0].getGeometry(),image:null,fill:a[0].getFill(),stroke:a[0].getStroke(),text:null})].concat(a.slice(1))):l}return a},n.setStyle(o)),delete i.Style,n.setProperties(i,!0),n}},st.prototype.readSharedStyle_=function(t,e){var i,n,r,o=t.getAttribute("id");null===o||(i=At.call(this,t,e))&&(n=void 0,(r=t.baseURI)&&"about:blank"!=r||(r=window.location.href),n=r?new URL("#"+o,r).href:"#"+o,this.sharedStyles_[n]=i)},st.prototype.readSharedStyleMap_=function(t,e){var i,n,r,o=t.getAttribute("id");null===o||(i=dt.call(this,t,e))&&((r=t.baseURI)&&"about:blank"!=r||(r=window.location.href),n=r?new URL("#"+o,r).href:"#"+o,this.sharedStyles_[n]=i)},st.prototype.readFeatureFromNode=function(t,e){return(0,j.includes)(z,t.namespaceURI)&&this.readPlacemark_(t,[this.getReadOptions(t,e)])||null},st.prototype.readFeaturesFromNode=function(t,e){if(!(0,j.includes)(z,t.namespaceURI))return[];var i,n=t.localName;if("Document"==n||"Folder"==n)return(i=this.readDocumentOrFolder_(t,[this.getReadOptions(t,e)]))||[];if("Placemark"==n){var r=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return r?[r]:[]}if("kml"!=n)return[];i=[];for(var o=t.firstElementChild;o;o=o.nextElementSibling){var s=this.readFeaturesFromNode(o,e);s&&(0,j.extend)(i,s)}return i},st.prototype.readName=function(t){if(t){if("string"!=typeof t)return(0,T.isDocument)(t)?this.readNameFromDocument(t):this.readNameFromNode(t);var e=(0,T.parse)(t);return this.readNameFromDocument(e)}},st.prototype.readNameFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE){var i=this.readNameFromNode(e);if(i)return i}},st.prototype.readNameFromNode=function(t){for(var e=t.firstElementChild;e;e=e.nextElementSibling)if((0,j.includes)(z,e.namespaceURI)&&"name"==e.localName)return(0,x.readString)(e);for(e=t.firstElementChild;e;e=e.nextElementSibling){var i=e.localName;if((0,j.includes)(z,e.namespaceURI)&&("Document"==i||"Folder"==i||"Placemark"==i||"kml"==i)){var n=this.readNameFromNode(e);if(n)return n}}},st.prototype.readNetworkLinks=function(t){var e,i=[];return"string"==typeof t?(e=(0,T.parse)(t),(0,j.extend)(i,this.readNetworkLinksFromDocument(e))):(0,T.isDocument)(t)?(0,j.extend)(i,this.readNetworkLinksFromDocument(t)):(0,j.extend)(i,this.readNetworkLinksFromNode(t)),i},st.prototype.readNetworkLinksFromDocument=function(t){for(var e=[],i=t.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&(0,j.extend)(e,this.readNetworkLinksFromNode(i));return e},st.prototype.readNetworkLinksFromNode=function(t){for(var e,i=[],n=t.firstElementChild;n;n=n.nextElementSibling)(0,j.includes)(z,n.namespaceURI)&&"NetworkLink"==n.localName&&(e=(0,T.pushParseAndPop)({},V,n,[]),i.push(e));for(n=t.firstElementChild;n;n=n.nextElementSibling){var r=n.localName;!(0,j.includes)(z,n.namespaceURI)||"Document"!=r&&"Folder"!=r&&"kml"!=r||(0,j.extend)(i,this.readNetworkLinksFromNode(n))}return i},st.prototype.readRegion=function(t){var e,i=[];return"string"==typeof t?(e=(0,T.parse)(t),(0,j.extend)(i,this.readRegionFromDocument(e))):(0,T.isDocument)(t)?(0,j.extend)(i,this.readRegionFromDocument(t)):(0,j.extend)(i,this.readRegionFromNode(t)),i},st.prototype.readRegionFromDocument=function(t){for(var e=[],i=t.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&(0,j.extend)(e,this.readRegionFromNode(i));return e},st.prototype.readRegionFromNode=function(t){for(var e,i=[],n=t.firstElementChild;n;n=n.nextElementSibling)(0,j.includes)(z,n.namespaceURI)&&"Region"==n.localName&&(e=(0,T.pushParseAndPop)({},H,n,[]),i.push(e));for(n=t.firstElementChild;n;n=n.nextElementSibling){var r=n.localName;!(0,j.includes)(z,n.namespaceURI)||"Document"!=r&&"Folder"!=r&&"kml"!=r||(0,j.extend)(i,this.readRegionFromNode(n))}return i},st.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=(0,T.createElementNS)(z[4],"kml"),n="http://www.w3.org/2000/xmlns/";i.setAttributeNS(n,"xmlns:gx",U[0]),i.setAttributeNS(n,"xmlns:xsi",T.XML_SCHEMA_INSTANCE_URI),i.setAttributeNS(T.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var r={node:i},o={};1<t.length?o.Document=t:1==t.length&&(o.Placemark=t[0]);var s=X[i.namespaceURI],a=(0,T.makeSequence)(o,s);return(0,T.pushSerializeAndPop)(r,q,T.OBJECT_PROPERTY_NODE_FACTORY,a,[e],s,this),i},st);function st(t){var e=rt.call(this)||this,i=t||{};return nt||(I=[255,255,255,1],K=new a.default({color:I}),R=[20,2],k=P.default.PIXELS,A=P.default.PIXELS,L=[64,64],F="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",N=.5,$=new w.default({anchor:R,anchorOrigin:E.default.BOTTOM_LEFT,anchorXUnits:k,anchorYUnits:A,crossOrigin:"anonymous",rotation:0,scale:N,size:L,src:F}),Z="NO_IMAGE",J=new s.default({color:I,width:1}),Q=new s.default({color:[51,51,51,1],width:2}),tt=new y.default({font:"bold 16px Helvetica",fill:K,stroke:Q,scale:.8}),et=new m.default({fill:K,image:$,text:tt,stroke:J,zIndex:0}),nt=[et]),e.dataProjection=(0,r.get)("EPSG:4326"),e.defaultStyle_=i.defaultStyle?i.defaultStyle:nt,e.extractStyles_=void 0===i.extractStyles||i.extractStyles,e.writeStyles_=void 0===i.writeStyles||i.writeStyles,e.sharedStyles_={},e.showPointNames_=void 0===i.showPointNames||i.showPointNames,e.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:"anonymous",e}function at(t){var e=(0,T.getAllTextContent)(t,!1),i=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(i){var n=i[1];return[parseInt(n.substr(6,2),16),parseInt(n.substr(4,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(0,2),16)/255]}}function lt(t){for(var e,i=(0,T.getAllTextContent)(t,!1),n=[],r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;e=r.exec(i);){var o=parseFloat(e[1]),s=parseFloat(e[2]),a=e[3]?parseFloat(e[3]):0;n.push(o,s,a),i=i.substr(e[0].length)}if(""===i)return n}function ut(t){var e=(0,T.getAllTextContent)(t,!1).trim(),i=t.baseURI;return i&&"about:blank"!=i||(i=window.location.href),i?new URL(e,i).href:e}function ht(t){return(0,x.readDecimal)(t)}var ct=(0,T.makeStructureNS)(z,{Pair:function(t,e){var i=(0,T.pushParseAndPop)({},Ut,t,e,this);{var n,r,o;!i||(n=i.key)&&"normal"==n&&((r=i.styleUrl)&&(e[e.length-1]=r),(o=i.Style)&&(e[e.length-1]=o))}}});function dt(t,e){return(0,T.pushParseAndPop)(void 0,ct,t,e,this)}var pt=(0,T.makeStructureNS)(z,{Icon:(0,T.makeObjectPropertySetter)(function(t,e){return(0,T.pushParseAndPop)({},xt,t,e)||null}),color:(0,T.makeObjectPropertySetter)(at),heading:(0,T.makeObjectPropertySetter)(x.readDecimal),hotSpot:(0,T.makeObjectPropertySetter)(function(t){var e=t.getAttribute("xunits"),i=t.getAttribute("yunits"),n="insetPixels"!==e?"insetPixels"!==i?E.default.BOTTOM_LEFT:E.default.TOP_LEFT:"insetPixels"!==i?E.default.BOTTOM_RIGHT:E.default.TOP_RIGHT;return{x:parseFloat(t.getAttribute("x")),xunits:B[e],y:parseFloat(t.getAttribute("y")),yunits:B[i],origin:n}}),scale:(0,T.makeObjectPropertySetter)(ht)});var ft=(0,T.makeStructureNS)(z,{color:(0,T.makeObjectPropertySetter)(at),scale:(0,T.makeObjectPropertySetter)(ht)});var gt=(0,T.makeStructureNS)(z,{color:(0,T.makeObjectPropertySetter)(at),width:(0,T.makeObjectPropertySetter)(x.readDecimal)});var mt=(0,T.makeStructureNS)(z,{color:(0,T.makeObjectPropertySetter)(at),fill:(0,T.makeObjectPropertySetter)(x.readBoolean),outline:(0,T.makeObjectPropertySetter)(x.readBoolean)});var yt=(0,T.makeStructureNS)(z,{coordinates:(0,T.makeReplacer)(lt)});function _t(t,e){return(0,T.pushParseAndPop)(null,yt,t,e)}var vt=(0,T.makeStructureNS)(U,{Track:(0,T.makeArrayPusher)(jt)});var bt=(0,T.makeStructureNS)(z,{when:function(t,e){var i=e[e.length-1].whens,n=(0,T.getAllTextContent)(t,!1),r=Date.parse(n);i.push(isNaN(r)?0:r)}},(0,T.makeStructureNS)(U,{coord:function(t,e){var i,n,r,o=e[e.length-1].flatCoordinates,s=(0,T.getAllTextContent)(t,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(s);a?(i=parseFloat(a[1]),n=parseFloat(a[2]),r=parseFloat(a[3]),o.push(i,n,r,0)):o.push(0,0,0,0)}}));function jt(t,e){var i=(0,T.pushParseAndPop)({flatCoordinates:[],whens:[]},bt,t,e);if(i){for(var n=i.flatCoordinates,r=i.whens,o=0,s=Math.min(n.length,r.length);o<s;++o)n[4*o+3]=r[o];return new u.default(n,c.default.XYZM)}}var xt=(0,T.makeStructureNS)(z,{href:(0,T.makeObjectPropertySetter)(ut)},(0,T.makeStructureNS)(U,{x:(0,T.makeObjectPropertySetter)(x.readDecimal),y:(0,T.makeObjectPropertySetter)(x.readDecimal),w:(0,T.makeObjectPropertySetter)(x.readDecimal),h:(0,T.makeObjectPropertySetter)(x.readDecimal)}));var St=(0,T.makeStructureNS)(z,{coordinates:(0,T.makeReplacer)(lt)});function wt(t,e){return(0,T.pushParseAndPop)(null,St,t,e)}var Pt=(0,T.makeStructureNS)(z,{extrude:(0,T.makeObjectPropertySetter)(x.readBoolean),tessellate:(0,T.makeObjectPropertySetter)(x.readBoolean),altitudeMode:(0,T.makeObjectPropertySetter)(x.readString)});function Et(t,e){var i=(0,T.pushParseAndPop)({},Pt,t,e),n=wt(t,e);if(n){var r=new u.default(n,c.default.XYZ);return r.setProperties(i,!0),r}}function Tt(t,e){var i=(0,T.pushParseAndPop)({},Pt,t,e),n=wt(t,e);if(n){var r=new h.default(n,c.default.XYZ,[n.length]);return r.setProperties(i,!0),r}}var Ot=(0,T.makeStructureNS)(z,{LineString:(0,T.makeArrayPusher)(Et),LinearRing:(0,T.makeArrayPusher)(Tt),MultiGeometry:(0,T.makeArrayPusher)(Ct),Point:(0,T.makeArrayPusher)(Mt),Polygon:(0,T.makeArrayPusher)(Rt)});function Ct(t,e){var i,n=(0,T.pushParseAndPop)([],Ot,t,e);if(!n)return null;if(0===n.length)return new f.default(n);for(var r,o=!0,s=n[0].getType(),a=1,l=n.length;a<l;++a)if((r=n[a]).getType()!=s){o=!1;break}if(o){var u=void 0,h=void 0;if(s==b.default.POINT){for(var c=n[0],u=c.getLayout(),h=c.getFlatCoordinates(),a=1,l=n.length;a<l;++a)r=n[a],(0,j.extend)(h,r.getFlatCoordinates());Lt(i=new p.default(h,u),n)}else s==b.default.LINE_STRING?Lt(i=new d.default(n),n):s==b.default.POLYGON?Lt(i=new g.default(n),n):s==b.default.GEOMETRY_COLLECTION?i=new f.default(n):(0,v.assert)(!1,37)}else i=new f.default(n);return i}function Mt(t,e){var i=(0,T.pushParseAndPop)({},Pt,t,e),n=wt(t,e);if(n){var r=new o.default(n,c.default.XYZ);return r.setProperties(i,!0),r}}var It=(0,T.makeStructureNS)(z,{innerBoundaryIs:function(t,e){var i=(0,T.pushParseAndPop)(void 0,Vt,t,e);i&&e[e.length-1].push(i)},outerBoundaryIs:function(t,e){var i=(0,T.pushParseAndPop)(void 0,Yt,t,e);i&&(e[e.length-1][0]=i)}});function Rt(t,e){var i=(0,T.pushParseAndPop)({},Pt,t,e),n=(0,T.pushParseAndPop)([null],It,t,e);if(n&&n[0]){for(var r=n[0],o=[r.length],s=1,a=n.length;s<a;++s)(0,j.extend)(r,n[s]),o.push(r.length);var l=new h.default(r,c.default.XYZ,o);return l.setProperties(i,!0),l}}var kt=(0,T.makeStructureNS)(z,{IconStyle:function(t,e){var i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v,b,j,x,S=(0,T.pushParseAndPop)({},pt,t,e);S&&(s=e[e.length-1],a="Icon"in S?S.Icon:{},l=!("Icon"in S)||0<Object.keys(a).length,(u=a.href)?i=u:l&&(i=F),c=E.default.BOTTOM_LEFT,(d=S.hotSpot)?(n=[d.x,d.y],r=d.xunits,o=d.yunits,c=d.origin):i===F?(n=R,r=k,o=A):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(i)&&(n=[.5,0],r=P.default.FRACTION,o=P.default.FRACTION),f=a.x,g=a.y,void 0!==f&&void 0!==g&&(h=[f,g]),y=a.w,_=a.h,void 0!==y&&void 0!==_&&(p=[y,_]),void 0!==(v=S.heading)&&(m=(0,O.toRadians)(v)),b=S.scale,j=S.color,l?(i==F&&(p=L,void 0===b&&(b=N)),x=new w.default({anchor:n,anchorOrigin:c,anchorXUnits:r,anchorYUnits:o,crossOrigin:this.crossOrigin_,offset:h,offsetOrigin:E.default.BOTTOM_LEFT,rotation:m,scale:b,size:p,src:i,color:j}),s.imageStyle=x):s.imageStyle=Z)},LabelStyle:function(t,e){var i,n,r=(0,T.pushParseAndPop)({},ft,t,e);r&&(i=e[e.length-1],n=new y.default({fill:new a.default({color:"color"in r?r.color:I}),scale:r.scale}),i.textStyle=n)},LineStyle:function(t,e){var i,n,r=(0,T.pushParseAndPop)({},gt,t,e);r&&(i=e[e.length-1],n=new s.default({color:"color"in r?r.color:I,width:"width"in r?r.width:1}),i.strokeStyle=n)},PolyStyle:function(t,e){var i,n,r,o,s=(0,T.pushParseAndPop)({},mt,t,e);s&&(i=e[e.length-1],n=new a.default({color:"color"in s?s.color:I}),i.fillStyle=n,void 0!==(r=s.fill)&&(i.fill=r),void 0!==(o=s.outline)&&(i.outline=o))}});function At(t,e){var i=(0,T.pushParseAndPop)({},kt,t,e,this);if(!i)return null;var n,r="fillStyle"in i?i.fillStyle:K,o=i.fill;void 0===o||o||(r=null),"imageStyle"in i?i.imageStyle!=Z&&(n=i.imageStyle):n=$;var s="textStyle"in i?i.textStyle:tt,a="strokeStyle"in i?i.strokeStyle:J,l=i.outline;return void 0===l||l?[new m.default({fill:r,image:n,stroke:a,text:s,zIndex:void 0})]:[new m.default({geometry:function(t){var e=t.getGeometry(),i=e.getType();return i===b.default.GEOMETRY_COLLECTION?new f.default(e.getGeometriesArrayRecursive().filter(function(t){var e=t.getType();return e!==b.default.POLYGON&&e!==b.default.MULTI_POLYGON})):i!==b.default.POLYGON&&i!==b.default.MULTI_POLYGON?e:void 0},fill:r,image:n,stroke:a,text:s,zIndex:void 0}),new m.default({geometry:function(t){var e=t.getGeometry(),i=e.getType();return i===b.default.GEOMETRY_COLLECTION?new f.default(e.getGeometriesArrayRecursive().filter(function(t){var e=t.getType();return e===b.default.POLYGON||e===b.default.MULTI_POLYGON})):i===b.default.POLYGON||i===b.default.MULTI_POLYGON?e:void 0},fill:r,stroke:null,zIndex:void 0})]}function Lt(t,e){for(var i=e.length,n=new Array(e.length),r=new Array(e.length),o=new Array(e.length),s=!1,a=!1,l=!1,u=0;u<i;++u){var h=e[u];n[u]=h.get("extrude"),r[u]=h.get("tessellate"),o[u]=h.get("altitudeMode"),s=s||void 0!==n[u],a=a||void 0!==r[u],l=l||o[u]}s&&t.set("extrude",n),a&&t.set("tessellate",r),l&&t.set("altitudeMode",o)}var Ft=(0,T.makeStructureNS)(z,{displayName:(0,T.makeObjectPropertySetter)(x.readString),value:(0,T.makeObjectPropertySetter)(x.readString)});var Nt=(0,T.makeStructureNS)(z,{Data:function(t,e){var i=t.getAttribute("name");(0,T.parseNode)(Ft,t,e);var n=e[e.length-1];i&&n.displayName?n[i]={value:n.value,displayName:n.displayName,toString:function(){return n.value}}:null!==i?n[i]=n.value:null!==n.displayName&&(n[n.displayName]=n.value),delete n.value},SchemaData:function(t,e){(0,T.parseNode)(zt,t,e)}});function Dt(t,e){(0,T.parseNode)(Nt,t,e)}function Gt(t,e){(0,T.parseNode)(H,t,e)}var Ut=(0,T.makeStructureNS)(z,{Style:(0,T.makeObjectPropertySetter)(At),key:(0,T.makeObjectPropertySetter)(x.readString),styleUrl:(0,T.makeObjectPropertySetter)(ut)});var zt=(0,T.makeStructureNS)(z,{SimpleData:function(t,e){var i=t.getAttribute("name");{var n;null!==i&&(n=(0,x.readString)(t),e[e.length-1][i]=n)}}});var Bt=(0,T.makeStructureNS)(z,{altitudeMode:(0,T.makeObjectPropertySetter)(x.readString),minAltitude:(0,T.makeObjectPropertySetter)(x.readDecimal),maxAltitude:(0,T.makeObjectPropertySetter)(x.readDecimal),north:(0,T.makeObjectPropertySetter)(x.readDecimal),south:(0,T.makeObjectPropertySetter)(x.readDecimal),east:(0,T.makeObjectPropertySetter)(x.readDecimal),west:(0,T.makeObjectPropertySetter)(x.readDecimal)});var Wt=(0,T.makeStructureNS)(z,{minLodPixels:(0,T.makeObjectPropertySetter)(x.readDecimal),maxLodPixels:(0,T.makeObjectPropertySetter)(x.readDecimal),minFadeExtent:(0,T.makeObjectPropertySetter)(x.readDecimal),maxFadeExtent:(0,T.makeObjectPropertySetter)(x.readDecimal)});var Vt=(0,T.makeStructureNS)(z,{LinearRing:(0,T.makeReplacer)(_t)});var Yt=(0,T.makeStructureNS)(z,{LinearRing:(0,T.makeReplacer)(_t)});function Ht(t,e){for(var i=(0,_.asArray)(e),n=[255*(4==i.length?i[3]:1),i[2],i[1],i[0]],r=0;r<4;++r){var o=Math.floor(n[r]).toString(16);n[r]=1==o.length?"0"+o:o}(0,x.writeStringTextNode)(t,n.join(""))}var Xt=(0,T.makeStructureNS)(z,{Data:(0,T.makeChildAppender)(function(t,e,i){t.setAttribute("name",e.name);var n={node:t},r=e.value;"object"==M(r)?(null!==r&&r.displayName&&(0,T.pushSerializeAndPop)(n,Xt,T.OBJECT_PROPERTY_NODE_FACTORY,[r.displayName],i,["displayName"]),null!==r&&r.value&&(0,T.pushSerializeAndPop)(n,Xt,T.OBJECT_PROPERTY_NODE_FACTORY,[r.value],i,["value"])):(0,T.pushSerializeAndPop)(n,Xt,T.OBJECT_PROPERTY_NODE_FACTORY,[r],i,["value"])}),value:(0,T.makeChildAppender)(function(t,e){(0,x.writeStringTextNode)(t,e)}),displayName:(0,T.makeChildAppender)(function(t,e){(0,x.writeCDATASection)(t,e)})});var qt=(0,T.makeStructureNS)(z,{Placemark:(0,T.makeChildAppender)(ve)}),Kt=function(t,e,i){var n=e[e.length-1].node;return(0,T.createElementNS)(n.namespaceURI,"Placemark")};var Zt=(0,T.makeSimpleNodeFactory)("Data");function $t(t,e,i){return(0,T.createElementNS)(U[0],"gx:"+i)}var Qt=(0,T.makeStructureNS)(z,["href"],(0,T.makeStructureNS)(U,["x","y","w","h"])),Jt=(0,T.makeStructureNS)(z,{href:(0,T.makeChildAppender)(x.writeStringTextNode)},(0,T.makeStructureNS)(U,{x:(0,T.makeChildAppender)(x.writeDecimalTextNode),y:(0,T.makeChildAppender)(x.writeDecimalTextNode),w:(0,T.makeChildAppender)(x.writeDecimalTextNode),h:(0,T.makeChildAppender)(x.writeDecimalTextNode)}));var te=(0,T.makeStructureNS)(z,["scale","heading","Icon","color","hotSpot"]),ee=(0,T.makeStructureNS)(z,{Icon:(0,T.makeChildAppender)(function(t,e,i){var n={node:t},r=i[i.length-1].node,o=Qt[r.namespaceURI],s=(0,T.makeSequence)(e,o);(0,T.pushSerializeAndPop)(n,Jt,T.OBJECT_PROPERTY_NODE_FACTORY,s,i,o),o=Qt[U[0]],s=(0,T.makeSequence)(e,o),(0,T.pushSerializeAndPop)(n,Jt,$t,s,i,o)}),color:(0,T.makeChildAppender)(Ht),heading:(0,T.makeChildAppender)(x.writeDecimalTextNode),hotSpot:(0,T.makeChildAppender)(function(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)}),scale:(0,T.makeChildAppender)(Ce)});var ie=(0,T.makeStructureNS)(z,["color","scale"]),ne=(0,T.makeStructureNS)(z,{color:(0,T.makeChildAppender)(Ht),scale:(0,T.makeChildAppender)(Ce)});var re=(0,T.makeStructureNS)(z,["color","width"]),oe=(0,T.makeStructureNS)(z,{color:(0,T.makeChildAppender)(Ht),width:(0,T.makeChildAppender)(x.writeDecimalTextNode)});var se={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},ae=function(t,e,i){if(t){var n=e[e.length-1].node;return(0,T.createElementNS)(n.namespaceURI,se[t.getType()])}},le=(0,T.makeSimpleNodeFactory)("Point"),ue=(0,T.makeSimpleNodeFactory)("LineString"),he=(0,T.makeSimpleNodeFactory)("LinearRing"),ce=(0,T.makeSimpleNodeFactory)("Polygon"),de=(0,T.makeStructureNS)(z,{LineString:(0,T.makeChildAppender)(xe),Point:(0,T.makeChildAppender)(xe),Polygon:(0,T.makeChildAppender)(Te),GeometryCollection:(0,T.makeChildAppender)(pe)});function pe(t,e,i){var n,r={node:t},o=e.getType(),s=[];o===b.default.GEOMETRY_COLLECTION?(e.getGeometriesArrayRecursive().forEach(function(t){var e=t.getType();e===b.default.MULTI_POINT?s=s.concat(t.getPoints()):e===b.default.MULTI_LINE_STRING?s=s.concat(t.getLineStrings()):e===b.default.MULTI_POLYGON?s=s.concat(t.getPolygons()):e===b.default.POINT||e===b.default.LINE_STRING||e===b.default.POLYGON?s.push(t):(0,v.assert)(!1,39)}),n=ae):o===b.default.MULTI_POINT?(s=e.getPoints(),n=le):o===b.default.MULTI_LINE_STRING?(s=e.getLineStrings(),n=ue):o===b.default.MULTI_POLYGON?(s=e.getPolygons(),n=ce):(0,v.assert)(!1,39),(0,T.pushSerializeAndPop)(r,de,n,s,i)}var fe=(0,T.makeStructureNS)(z,{LinearRing:(0,T.makeChildAppender)(xe)});function ge(t,e,i){var n={node:t};(0,T.pushSerializeAndPop)(n,fe,he,[e],i)}var me=(0,T.makeStructureNS)(z,{ExtendedData:(0,T.makeChildAppender)(function(t,e,i){for(var n={node:t},r=e.names,o=e.values,s=r.length,a=0;a<s;a++)(0,T.pushSerializeAndPop)(n,Xt,Zt,[{name:r[a],value:o[a]}],i)}),MultiGeometry:(0,T.makeChildAppender)(pe),LineString:(0,T.makeChildAppender)(xe),LinearRing:(0,T.makeChildAppender)(xe),Point:(0,T.makeChildAppender)(xe),Polygon:(0,T.makeChildAppender)(Te),Style:(0,T.makeChildAppender)(function(t,e,i){var n,r={node:t},o={};{var s,a;e.pointStyles.length&&((s=e.pointStyles[0].getText())&&(o.LabelStyle=s),(a=e.pointStyles[0].getImage())&&"function"==typeof a.getSrc&&(o.IconStyle=a))}e.lineStyles.length&&(n=e.lineStyles[0].getStroke())&&(o.LineStyle=n),e.polyStyles.length&&((n=e.polyStyles[0].getStroke())&&!o.LineStyle&&(o.LineStyle=n),o.PolyStyle=e.polyStyles[0]);var l=i[i.length-1].node,u=Me[l.namespaceURI],h=(0,T.makeSequence)(o,u);(0,T.pushSerializeAndPop)(r,Ie,T.OBJECT_PROPERTY_NODE_FACTORY,h,i,u)}),address:(0,T.makeChildAppender)(x.writeStringTextNode),description:(0,T.makeChildAppender)(x.writeStringTextNode),name:(0,T.makeChildAppender)(x.writeStringTextNode),open:(0,T.makeChildAppender)(x.writeBooleanTextNode),phoneNumber:(0,T.makeChildAppender)(x.writeStringTextNode),styleUrl:(0,T.makeChildAppender)(x.writeStringTextNode),visibility:(0,T.makeChildAppender)(x.writeBooleanTextNode)}),ye=(0,T.makeStructureNS)(z,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),_e=(0,T.makeSimpleNodeFactory)("ExtendedData");function ve(t,n,e){var i={node:t};n.getId()&&t.setAttribute("id",n.getId());var r=n.getProperties(),o={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};o[n.getGeometryName()]=1;var s,a,l,u,h,c,d=Object.keys(r||{}).sort().filter(function(t){return!o[t]}),p=n.getStyleFunction();!p||(s=p(n,0))&&(l=a=Array.isArray(s)?s:[s],n.getGeometry()&&(l=a.filter(function(t){var e=t.getGeometryFunction()(n);if(e){var i=e.getType();return i===b.default.GEOMETRY_COLLECTION?e.getGeometriesArrayRecursive().filter(function(t){var e=t.getType();return e===b.default.POINT||e===b.default.MULTI_POINT}).length:i===b.default.POINT||i===b.default.MULTI_POINT}})),this.writeStyles_&&(h=u=a,n.getGeometry()&&(u=a.filter(function(t){var e=t.getGeometryFunction()(n);if(e){var i=e.getType();return i===b.default.GEOMETRY_COLLECTION?e.getGeometriesArrayRecursive().filter(function(t){var e=t.getType();return e===b.default.LINE_STRING||e===b.default.MULTI_LINE_STRING}).length:i===b.default.LINE_STRING||i===b.default.MULTI_LINE_STRING}}),h=a.filter(function(t){var e=t.getGeometryFunction()(n);if(e){var i=e.getType();return i===b.default.GEOMETRY_COLLECTION?e.getGeometriesArrayRecursive().filter(function(t){var e=t.getType();return e===b.default.POLYGON||e===b.default.MULTI_POLYGON}).length:i===b.default.POLYGON||i===b.default.MULTI_POLYGON}})),r.Style={pointStyles:l,lineStyles:u,polyStyles:h}),!l.length||void 0!==r.name||(c=l[0].getText())&&(r.name=c.getText()));var f,g=e[e.length-1].node,m=ye[g.namespaceURI],y=(0,T.makeSequence)(r,m);(0,T.pushSerializeAndPop)(i,me,T.OBJECT_PROPERTY_NODE_FACTORY,y,e,m),0<d.length&&(f={names:d,values:(0,T.makeSequence)(r,d)},(0,T.pushSerializeAndPop)(i,me,_e,[f],e));var _=e[0],v=(v=n.getGeometry())&&(0,S.transformGeometryWithOptions)(v,!0,_);(0,T.pushSerializeAndPop)(i,me,ae,[v],e)}var be=(0,T.makeStructureNS)(z,["extrude","tessellate","altitudeMode","coordinates"]),je=(0,T.makeStructureNS)(z,{extrude:(0,T.makeChildAppender)(x.writeBooleanTextNode),tessellate:(0,T.makeChildAppender)(x.writeBooleanTextNode),altitudeMode:(0,T.makeChildAppender)(x.writeStringTextNode),coordinates:(0,T.makeChildAppender)(function(t,e,i){var n,r=i[i.length-1],o=r.layout,s=r.stride;o==c.default.XY||o==c.default.XYM?n=2:o==c.default.XYZ||o==c.default.XYZM?n=3:(0,v.assert)(!1,34);var a=e.length,l="";if(0<a){l+=e[0];for(var u=1;u<n;++u)l+=","+e[u];for(var h=s;h<a;h+=s)for(l+=" "+e[h],u=1;u<n;++u)l+=","+e[h+u]}(0,x.writeStringTextNode)(t,l)})});function xe(t,e,i){var n=e.getFlatCoordinates(),r={node:t};r.layout=e.getLayout(),r.stride=e.getStride();var o=e.getProperties();o.coordinates=n;var s=i[i.length-1].node,a=be[s.namespaceURI],l=(0,T.makeSequence)(o,a);(0,T.pushSerializeAndPop)(r,je,T.OBJECT_PROPERTY_NODE_FACTORY,l,i,a)}var Se=(0,T.makeStructureNS)(z,["color","fill","outline"]),we=(0,T.makeStructureNS)(z,{outerBoundaryIs:(0,T.makeChildAppender)(ge),innerBoundaryIs:(0,T.makeChildAppender)(ge)}),Pe=(0,T.makeSimpleNodeFactory)("innerBoundaryIs"),Ee=(0,T.makeSimpleNodeFactory)("outerBoundaryIs");function Te(t,e,i){var n=e.getLinearRings(),r=n.shift(),o={node:t};(0,T.pushSerializeAndPop)(o,we,Pe,n,i),(0,T.pushSerializeAndPop)(o,we,Ee,[r],i)}var Oe=(0,T.makeStructureNS)(z,{color:(0,T.makeChildAppender)(Ht),fill:(0,T.makeChildAppender)(x.writeBooleanTextNode),outline:(0,T.makeChildAppender)(x.writeBooleanTextNode)});function Ce(t,e){(0,x.writeDecimalTextNode)(t,Math.round(1e6*e)/1e6)}var Me=(0,T.makeStructureNS)(z,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Ie=(0,T.makeStructureNS)(z,{IconStyle:(0,T.makeChildAppender)(function(t,e,i){var n,r,o,s={node:t},a={},l=e.getSrc(),u=e.getSize(),h=e.getImageSize(),c={href:l};u&&(c.w=u[0],c.h=u[1],n=e.getAnchor(),(r=e.getOrigin())&&h&&0!==r[0]&&r[1]!==u[1]&&(c.x=r[0],c.y=h[1]-(r[1]+u[1])),!n||n[0]===u[0]/2&&n[1]===u[1]/2||(o={x:n[0],xunits:P.default.PIXELS,y:u[1]-n[1],yunits:P.default.PIXELS},a.hotSpot=o)),a.Icon=c;var d=e.getScale();1!==d&&(a.scale=d);var p=e.getRotation();0!==p&&(a.heading=p);var f=e.getColor();f&&(a.color=f);var g=i[i.length-1].node,m=te[g.namespaceURI],y=(0,T.makeSequence)(a,m);(0,T.pushSerializeAndPop)(s,ee,T.OBJECT_PROPERTY_NODE_FACTORY,y,i,m)}),LabelStyle:(0,T.makeChildAppender)(function(t,e,i){var n={node:t},r={},o=e.getFill();o&&(r.color=o.getColor());var s=e.getScale();s&&1!==s&&(r.scale=s);var a=i[i.length-1].node,l=ie[a.namespaceURI],u=(0,T.makeSequence)(r,l);(0,T.pushSerializeAndPop)(n,ne,T.OBJECT_PROPERTY_NODE_FACTORY,u,i,l)}),LineStyle:(0,T.makeChildAppender)(function(t,e,i){var n={node:t},r={color:e.getColor(),width:Number(e.getWidth())||1},o=i[i.length-1].node,s=re[o.namespaceURI],a=(0,T.makeSequence)(r,s);(0,T.pushSerializeAndPop)(n,oe,T.OBJECT_PROPERTY_NODE_FACTORY,a,i,s)}),PolyStyle:(0,T.makeChildAppender)(function(t,e,i){var n={node:t},r=e.getFill(),o=e.getStroke(),s={color:r?r.getColor():void 0,fill:!!r&&void 0,outline:!!o&&void 0},a=i[i.length-1].node,l=Se[a.namespaceURI],u=(0,T.makeSequence)(s,l);(0,T.pushSerializeAndPop)(n,Oe,T.OBJECT_PROPERTY_NODE_FACTORY,u,i,l)})});i.default=ot},{"../Feature.js":13,"../array.js":44,"../asserts.js":45,"../color.js":47,"../geom/GeometryCollection.js":129,"../geom/GeometryLayout.js":130,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../math.js":201,"../proj.js":205,"../style/Fill.js":293,"../style/Icon.js":294,"../style/IconAnchorUnits.js":295,"../style/IconOrigin.js":298,"../style/Stroke.js":301,"../style/Style.js":302,"../style/Text.js":303,"../xml.js":322,"./Feature.js":76,"./XMLFeature.js":100,"./xsd.js":124}],88:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var j=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Feature.js")),n=a(t("./FormatType.js")),x=a(t("../geom/GeometryLayout.js")),S=a(t("../geom/GeometryType.js")),w=a(t("../geom/LineString.js")),P=a(t("../geom/MultiLineString.js")),E=a(t("../geom/MultiPoint.js")),T=a(t("../geom/MultiPolygon.js")),f=a(t("pbf")),O=a(t("../geom/Point.js")),C=a(t("../geom/Polygon.js")),r=a(t("../proj/Projection.js")),M=a(t("../render/Feature.js")),o=a(t("../proj/Units.js")),d=t("../asserts.js"),g=t("../proj.js"),I=t("../geom/flat/orient.js");function a(t){return t&&t.__esModule?t:{default:t}}function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(u=j.default,c(m,u),m.prototype.readRawGeometry_=function(t,e,i,n){t.pos=e.geometry;for(var r,o=t.readVarint()+t.pos,s=1,a=0,l=0,u=0,h=0,c=0;t.pos<o;)a||(s=7&(r=t.readVarint()),a=r>>3),a--,1===s||2===s?(l+=t.readSVarint(),u+=t.readSVarint(),1===s&&c<h&&(n.push(h),c=h),i.push(l,u),h+=2):7===s?c<h&&(i.push(i[c],i[c+1]),h+=2):(0,d.assert)(!1,59);c<h&&(n.push(h),c=h)},m.prototype.createFeature_=function(t,e,i){var n,r=e.type;if(0===r)return null;var o,s=e.properties;this.idProperty_?(o=s[this.idProperty_],delete s[this.idProperty_]):o=e.id,s[this.layerName_]=e.layer.name;var a=[],l=[];this.readRawGeometry_(t,e,a,l);var u,h,c,d=(u=r,h=l.length,1===u?c=1===h?S.default.POINT:S.default.MULTI_POINT:2===u?c=1===h?S.default.LINE_STRING:S.default.MULTI_LINE_STRING:3===u&&(c=S.default.POLYGON),c);if(this.featureClass_===M.default)(n=new this.featureClass_(d,a,l,s,o)).transform(i.dataProjection,i.featureProjection);else{var p=void 0;if(d==S.default.POLYGON){for(var f=[],g=0,m=0,y=0,_=l.length;y<_;++y){var v=l[y];if((0,I.linearRingIsClockwise)(a,g,v,2)){if(0===f.length)continue;f[f.length-1].push(l[m])}else f.push(l.slice(m,y+1));m=y+1,g=v}p=1<f.length?new T.default(a,x.default.XY,f):new C.default(a,x.default.XY,l)}else p=d===S.default.POINT?new O.default(a,x.default.XY):d===S.default.LINE_STRING?new w.default(a,x.default.XY):d===S.default.POLYGON?new C.default(a,x.default.XY,l):d===S.default.MULTI_POINT?new E.default(a,x.default.XY):d===S.default.MULTI_LINE_STRING?new P.default(a,x.default.XY,l):null;n=new this.featureClass_,this.geometryName_&&n.setGeometryName(this.geometryName_);var b=(0,j.transformGeometryWithOptions)(p,!1,i);n.setGeometry(b),n.setId(o),n.setProperties(s,!0)}return n},m.prototype.getType=function(){return n.default.ARRAY_BUFFER},m.prototype.readFeatures=function(t,e){var i=this.layers_,n=this.adaptOptions(e),r=(0,g.get)(n.dataProjection);r.setWorldExtent(n.extent),n.dataProjection=r;var o=new f.default(t),s=o.readFields(y,{}),a=[];for(var l in s)if(!i||-1!=i.indexOf(l)){var u=s[l],h=u?[0,0,u.extent,u.extent]:null;r.setExtent(h);for(var c=0,d=u.length;c<d;++c){var p=function(t,e,i){t.pos=e.features[i];var n=t.readVarint()+t.pos,r={layer:e,type:0,properties:{}};return t.readFields(v,r,n),r}(o,u,c);a.push(this.createFeature_(o,p,n))}}return a},m.prototype.readProjection=function(t){return this.dataProjection},m.prototype.setLayers=function(t){this.layers_=t},m);function m(t){var e=u.call(this)||this,i=t||{};return e.dataProjection=new r.default({code:"",units:o.default.TILE_PIXELS}),e.featureClass_=i.featureClass?i.featureClass:M.default,e.geometryName_=i.geometryName,e.layerName_=i.layerName?i.layerName:"layer",e.layers_=i.layers?i.layers:null,e.idProperty_=i.idProperty,e}function y(t,e,i){var n,r;3===t&&(n={keys:[],values:[],features:[]},r=i.readVarint()+i.pos,i.readFields(_,n,r),n.length=n.features.length,n.length&&(e[n.name]=n))}function _(t,e,i){if(15===t)e.version=i.readVarint();else if(1===t)e.name=i.readString();else if(5===t)e.extent=i.readVarint();else if(2===t)e.features.push(i.pos);else if(3===t)e.keys.push(i.readString());else if(4===t){for(var n=null,r=i.readVarint()+i.pos;i.pos<r;)n=1==(t=i.readVarint()>>3)?i.readString():2===t?i.readFloat():3===t?i.readDouble():4===t?i.readVarint64():5===t?i.readVarint():6===t?i.readSVarint():7===t?i.readBoolean():null;e.values.push(n)}}function v(t,e,i){if(1==t)e.id=i.readVarint();else if(2==t)for(var n=i.readVarint()+i.pos;i.pos<n;){var r=e.layer.keys[i.readVarint()],o=e.layer.values[i.readVarint()];e.properties[r]=o}else 3==t?e.type=i.readVarint():4==t&&(e.geometry=i.pos)}i.default=p},{"../asserts.js":45,"../geom/GeometryLayout.js":130,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../geom/flat/orient.js":152,"../proj.js":205,"../proj/Projection.js":206,"../proj/Units.js":207,"../render/Feature.js":217,"./Feature.js":76,"./FormatType.js":77,pbf:323}],89:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./XML.js"))&&n.__esModule?n:{default:n},o=t("../xml.js"),s=t("./XLink.js"),a=t("./xsd.js");var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=[null,"http://www.opengis.net/ows/1.1"],d=(0,o.makeStructureNS)(c,{ServiceIdentification:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},P,t,e)}),ServiceProvider:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},E,t,e)}),OperationsMetadata:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},j,t,e)})}),p=(l=r.default,h(T,l),T.prototype.readFromNode=function(t){return(0,o.pushParseAndPop)({},d,t,[])||null},T),f=(0,o.makeStructureNS)(c,{DeliveryPoint:(0,o.makeObjectPropertySetter)(a.readString),City:(0,o.makeObjectPropertySetter)(a.readString),AdministrativeArea:(0,o.makeObjectPropertySetter)(a.readString),PostalCode:(0,o.makeObjectPropertySetter)(a.readString),Country:(0,o.makeObjectPropertySetter)(a.readString),ElectronicMailAddress:(0,o.makeObjectPropertySetter)(a.readString)}),g=(0,o.makeStructureNS)(c,{Value:(0,o.makeObjectPropertyPusher)(function(t,e){return(0,a.readString)(t)})}),m=(0,o.makeStructureNS)(c,{AllowedValues:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},g,t,e)})}),y=(0,o.makeStructureNS)(c,{Phone:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},x,t,e)}),Address:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},f,t,e)})}),_=(0,o.makeStructureNS)(c,{HTTP:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},v,t,e)})}),v=(0,o.makeStructureNS)(c,{Get:(0,o.makeObjectPropertyPusher)(function(t,e){var i=(0,s.readHref)(t);if(i)return(0,o.pushParseAndPop)({href:i},S,t,e)}),Post:void 0}),b=(0,o.makeStructureNS)(c,{DCP:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},_,t,e)})}),j=(0,o.makeStructureNS)(c,{Operation:function(t,e){var i=t.getAttribute("name"),n=(0,o.pushParseAndPop)({},b,t,e);n&&(e[e.length-1][i]=n)}}),x=(0,o.makeStructureNS)(c,{Voice:(0,o.makeObjectPropertySetter)(a.readString),Facsimile:(0,o.makeObjectPropertySetter)(a.readString)}),S=(0,o.makeStructureNS)(c,{Constraint:(0,o.makeObjectPropertyPusher)(function(t,e){var i=t.getAttribute("name");if(i)return(0,o.pushParseAndPop)({name:i},m,t,e)})}),w=(0,o.makeStructureNS)(c,{IndividualName:(0,o.makeObjectPropertySetter)(a.readString),PositionName:(0,o.makeObjectPropertySetter)(a.readString),ContactInfo:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},y,t,e)})}),P=(0,o.makeStructureNS)(c,{Abstract:(0,o.makeObjectPropertySetter)(a.readString),AccessConstraints:(0,o.makeObjectPropertySetter)(a.readString),Fees:(0,o.makeObjectPropertySetter)(a.readString),Title:(0,o.makeObjectPropertySetter)(a.readString),ServiceTypeVersion:(0,o.makeObjectPropertySetter)(a.readString),ServiceType:(0,o.makeObjectPropertySetter)(a.readString)}),E=(0,o.makeStructureNS)(c,{ProviderName:(0,o.makeObjectPropertySetter)(a.readString),ProviderSite:(0,o.makeObjectPropertySetter)(s.readHref),ServiceContact:(0,o.makeObjectPropertySetter)(function(t,e){return(0,o.pushParseAndPop)({},w,t,e)})});function T(){return l.call(this)||this}i.default=p},{"../xml.js":322,"./XLink.js":98,"./XML.js":99,"./xsd.js":124}],90:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.encodeDeltas=v,i.decodeDeltas=b,i.encodeFloats=j,i.decodeFloats=x,i.encodeSignedIntegers=S,i.decodeSignedIntegers=w,i.encodeUnsignedIntegers=P,i.decodeUnsignedIntegers=E,i.encodeUnsignedInteger=T,i.default=void 0;var n=p(t("../Feature.js")),r=p(t("../geom/GeometryLayout.js")),s=p(t("../geom/LineString.js")),o=p(t("./TextFeature.js")),a=t("../asserts.js"),l=t("../geom/flat/flip.js"),u=t("../proj.js"),h=t("../geom/SimpleGeometry.js"),c=t("../geom/flat/inflate.js"),d=t("./Feature.js");function p(t){return t&&t.__esModule?t:{default:t}}var f,g,m=(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),y=(f=o.default,m(_,f),_.prototype.readFeatureFromText=function(t,e){var i=this.readGeometryFromText(t,e);return new n.default(i)},_.prototype.readFeaturesFromText=function(t,e){return[this.readFeatureFromText(t,e)]},_.prototype.readGeometryFromText=function(t,e){var i=(0,h.getStrideForLayout)(this.geometryLayout_),n=b(t,i,this.factor_);(0,l.flipXY)(n,0,n.length,i,n);var r=(0,c.inflateCoordinates)(n,0,n.length,i),o=new s.default(r,this.geometryLayout_);return(0,d.transformGeometryWithOptions)(o,!1,this.adaptOptions(e))},_.prototype.writeFeatureText=function(t,e){var i=t.getGeometry();return i?this.writeGeometryText(i,e):((0,a.assert)(!1,40),"")},_.prototype.writeFeaturesText=function(t,e){return this.writeFeatureText(t[0],e)},_.prototype.writeGeometryText=function(t,e){var i=(t=(0,d.transformGeometryWithOptions)(t,!0,this.adaptOptions(e))).getFlatCoordinates(),n=t.getStride();return(0,l.flipXY)(i,0,i.length,n,i),v(i,n,this.factor_)},_);function _(t){var e=f.call(this)||this,i=t||{};return e.dataProjection=(0,u.get)("EPSG:4326"),e.factor_=i.factor?i.factor:1e5,e.geometryLayout_=i.geometryLayout?i.geometryLayout:r.default.XY,e}function v(t,e,i){for(var n=i||1e5,r=new Array(e),o=0;o<e;++o)r[o]=0;for(var s=0,a=t.length;s<a;)for(o=0;o<e;++o,++s){var l=t[s],u=l-r[o];r[o]=l,t[s]=u}return j(t,n)}function b(t,e,i){for(var n=i||1e5,r=new Array(e),o=0;o<e;++o)r[o]=0;for(var s=x(t,n),a=0,l=s.length;a<l;)for(o=0;o<e;++o,++a)r[o]+=s[a],s[a]=r[o];return s}function j(t,e){for(var i=e||1e5,n=0,r=t.length;n<r;++n)t[n]=Math.round(t[n]*i);return S(t)}function x(t,e){for(var i=e||1e5,n=w(t),r=0,o=n.length;r<o;++r)n[r]/=i;return n}function S(t){for(var e=0,i=t.length;e<i;++e){var n=t[e];t[e]=n<0?~(n<<1):n<<1}return P(t)}function w(t){for(var e=E(t),i=0,n=e.length;i<n;++i){var r=e[i];e[i]=1&r?~(r>>1):r>>1}return e}function P(t){for(var e="",i=0,n=t.length;i<n;++i)e+=T(t[i]);return e}function E(t){for(var e=[],i=0,n=0,r=0,o=t.length;r<o;++r){var s=t.charCodeAt(r)-63;i|=(31&s)<<n,s<32?(e.push(i),n=i=0):n+=5}return e}function T(t){for(var e,i="";32<=t;)e=63+(32|31&t),i+=String.fromCharCode(e),t>>=5;return e=t+63,i+String.fromCharCode(e)}i.default=y},{"../Feature.js":13,"../asserts.js":45,"../geom/GeometryLayout.js":130,"../geom/LineString.js":132,"../geom/SimpleGeometry.js":139,"../geom/flat/flip.js":145,"../geom/flat/inflate.js":147,"../proj.js":205,"./Feature.js":76,"./TextFeature.js":91}],91:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("../format/Feature.js")),r=s(t("../format/FormatType.js")),o=t("../util.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.getType=function(){return r.default.TEXT},c.prototype.readFeature=function(t,e){return this.readFeatureFromText(d(t),this.adaptOptions(e))},c.prototype.readFeatureFromText=function(t,e){return(0,o.abstract)()},c.prototype.readFeatures=function(t,e){return this.readFeaturesFromText(d(t),this.adaptOptions(e))},c.prototype.readFeaturesFromText=function(t,e){return(0,o.abstract)()},c.prototype.readGeometry=function(t,e){return this.readGeometryFromText(d(t),this.adaptOptions(e))},c.prototype.readGeometryFromText=function(t,e){return(0,o.abstract)()},c.prototype.readProjection=function(t){return this.readProjectionFromText(d(t))},c.prototype.readProjectionFromText=function(t){return this.dataProjection},c.prototype.writeFeature=function(t,e){return this.writeFeatureText(t,this.adaptOptions(e))},c.prototype.writeFeatureText=function(t,e){return(0,o.abstract)()},c.prototype.writeFeatures=function(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))},c.prototype.writeFeaturesText=function(t,e){return(0,o.abstract)()},c.prototype.writeGeometry=function(t,e){return this.writeGeometryText(t,this.adaptOptions(e))},c.prototype.writeGeometryText=function(t,e){return(0,o.abstract)()},c);function c(){return a.call(this)||this}function d(t){return"string"==typeof t?t:""}i.default=h},{"../format/Feature.js":76,"../format/FormatType.js":77,"../util.js":313}],92:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var d=c(t("../Feature.js")),n=c(t("./JSONFeature.js")),r=c(t("../geom/LineString.js")),o=c(t("../geom/MultiLineString.js")),s=c(t("../geom/MultiPoint.js")),u=c(t("../geom/MultiPolygon.js")),a=c(t("../geom/Point.js")),l=c(t("../geom/Polygon.js")),h=t("../proj.js"),p=t("./Feature.js");function c(t){return t&&t.__esModule?t:{default:t}}var f,g,m=(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),y=(f=n.default,m(v,f),v.prototype.readFeaturesFromObject=function(t,e){if("Topology"!=t.type)return[];var i=t,n=void 0,r=null,o=null;i.transform&&(r=(n=i.transform).scale,o=n.translate);var s=i.arcs;n&&function(t,e,i){for(var n=0,r=t.length;n<r;++n)!function(t,e,i){for(var n=0,r=0,o=0,s=t.length;o<s;++o){var a=t[o];n+=a[0],r+=a[1],a[0]=n,a[1]=r,x(a,e,i)}}(t[n],e,i)}(s,r,o);var a=[],l=i.objects,u=this.layerName_,h=void 0;for(var c in l)this.layers_&&-1==this.layers_.indexOf(c)||("GeometryCollection"===l[c].type?(h=l[c],a.push.apply(a,function(t,e,i,n,r,o,s){for(var a=t.geometries,l=[],u=0,h=a.length;u<h;++u)l[u]=j(a[u],e,i,n,r,o,s);return l}(h,s,r,o,u,c,e))):(h=l[c],a.push(j(h,s,r,o,u,c,e))));return a},v.prototype.readProjectionFromObject=function(t){return this.dataProjection},v),_={Point:function(t,e,i){var n=t.coordinates;return e&&i&&x(n,e,i),new a.default(n)},LineString:function(t,e){var i=b(t.arcs,e);return new r.default(i)},Polygon:function(t,e){for(var i=[],n=0,r=t.arcs.length;n<r;++n)i[n]=b(t.arcs[n],e);return new l.default(i)},MultiPoint:function(t,e,i){var n=t.coordinates;if(e&&i)for(var r=0,o=n.length;r<o;++r)x(n[r],e,i);return new s.default(n)},MultiLineString:function(t,e){for(var i=[],n=0,r=t.arcs.length;n<r;++n)i[n]=b(t.arcs[n],e);return new o.default(i)},MultiPolygon:function(t,e){for(var i=[],n=0,r=t.arcs.length;n<r;++n){for(var o=t.arcs[n],s=[],a=0,l=o.length;a<l;++a)s[a]=b(o[a],e);i[n]=s}return new u.default(i)}};function v(t){var e=f.call(this)||this,i=t||{};return e.layerName_=i.layerName,e.layers_=i.layers?i.layers:null,e.dataProjection=(0,h.get)(i.dataProjection?i.dataProjection:"EPSG:4326"),e}function b(t,e){for(var i,n,r=[],o=0,s=t.length;o<s;++o)i=t[o],0<o&&r.pop(),n=0<=i?e[i]:e[~i].slice().reverse(),r.push.apply(r,n);for(var a=0,l=r.length;a<l;++a)r[a]=r[a].slice();return r}function j(t,e,i,n,r,o,s){var a=t.type,l=_[a],u="Point"===a||"MultiPoint"===a?l(t,i,n):l(t,e),h=new d.default;h.setGeometry((0,p.transformGeometryWithOptions)(u,!1,s)),void 0!==t.id&&h.setId(t.id);var c=t.properties;return r&&((c=c||{})[r]=o),c&&h.setProperties(c,!0),h}function x(t,e,i){t[0]=t[0]*e[0]+i[0],t[1]=t[1]*e[1]+i[1]}i.default=y},{"../Feature.js":13,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../proj.js":205,"./Feature.js":76,"./JSONFeature.js":86}],93:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.writeFilter=function(t){var e=(0,m.createElementNS)(E,"Filter");return F(e,t,[]),e},i.default=void 0;var l=o(t("./GML2.js")),u=o(t("./GML3.js")),a=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=p();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./GMLBase.js")),n=o(t("./XMLFeature.js")),m=t("../xml.js"),h=t("./filter.js"),y=t("../asserts.js"),d=t("../obj.js"),r=t("../proj.js"),c=t("./xsd.js");function p(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return p=function(){return t},t}function o(t){return t&&t.__esModule?t:{default:t}}var f,g,_=(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v={"http://www.opengis.net/gml":{boundedBy:(0,m.makeObjectPropertySetter)(a.default.prototype.readGeometryElement,"bounds")}},b={"http://www.opengis.net/wfs":{totalInserted:(0,m.makeObjectPropertySetter)(c.readNonNegativeInteger),totalUpdated:(0,m.makeObjectPropertySetter)(c.readNonNegativeInteger),totalDeleted:(0,m.makeObjectPropertySetter)(c.readNonNegativeInteger)}},j={"http://www.opengis.net/wfs":{TransactionSummary:(0,m.makeObjectPropertySetter)(function(t,e){return(0,m.pushParseAndPop)({},b,t,e)},"transactionSummary"),InsertResults:(0,m.makeObjectPropertySetter)(function(t,e){return(0,m.pushParseAndPop)([],R,t,e)},"insertIds")}},x={"http://www.opengis.net/wfs":{PropertyName:(0,m.makeChildAppender)(c.writeStringTextNode)}},S={"http://www.opengis.net/wfs":{Insert:(0,m.makeChildAppender)(function(t,e,i){var n=i[i.length-1],r=n.featureType,o=n.featureNS,s=n.gmlVersion,a=(0,m.createElementNS)(o,r);t.appendChild(a),2===s?l.default.prototype.writeFeatureElement(a,e,i):u.default.prototype.writeFeatureElement(a,e,i)}),Update:(0,m.makeChildAppender)(function(t,e,i){var n=i[i.length-1];(0,y.assert)(void 0!==e.getId(),27);var r=n.featureType,o=n.featurePrefix,s=n.featureNS,a=A(o,r),l=e.getGeometryName();t.setAttribute("typeName",a),t.setAttributeNS(P,"xmlns:"+o,s);var u=e.getId();if(void 0!==u){for(var h=e.getKeys(),c=[],d=0,p=h.length;d<p;d++){var f,g=e.get(h[d]);void 0!==g&&(f=h[d],g&&"function"==typeof g.getSimplifiedGeometry&&(f=l),c.push({name:f,value:g}))}(0,m.pushSerializeAndPop)({gmlVersion:n.gmlVersion,node:t,hasZ:n.hasZ,srsName:n.srsName},S,(0,m.makeSimpleNodeFactory)("Property"),c,i),k(t,u)}}),Delete:(0,m.makeChildAppender)(function(t,e,i){var n=i[i.length-1];(0,y.assert)(void 0!==e.getId(),26);var r=n.featureType,o=n.featurePrefix,s=n.featureNS,a=A(o,r);t.setAttribute("typeName",a),t.setAttributeNS(P,"xmlns:"+o,s);var l=e.getId();void 0!==l&&k(t,l)}),Property:(0,m.makeChildAppender)(function(t,e,i){var n=(0,m.createElementNS)(T,"Name"),r=i[i.length-1].gmlVersion;{var o;t.appendChild(n),(0,c.writeStringTextNode)(n,e.name),void 0!==e.value&&null!==e.value&&(o=(0,m.createElementNS)(T,"Value"),t.appendChild(o),e.value&&"function"==typeof e.value.getSimplifiedGeometry?2===r?l.default.prototype.writeGeometryElement(o,e.value,i):u.default.prototype.writeGeometryElement(o,e.value,i):(0,c.writeStringTextNode)(o,e.value))}}),Native:(0,m.makeChildAppender)(function(t,e,i){e.vendorId&&t.setAttribute("vendorId",e.vendorId),void 0!==e.safeToIgnore&&t.setAttribute("safeToIgnore",String(e.safeToIgnore)),void 0!==e.value&&(0,c.writeStringTextNode)(t,e.value)})}},w="feature",P="http://www.w3.org/2000/xmlns/",E="http://www.opengis.net/ogc",T="http://www.opengis.net/wfs",O={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},C=(f=n.default,_(M,f),M.prototype.getFeatureType=function(){return this.featureType_},M.prototype.setFeatureType=function(t){this.featureType_=t},M.prototype.readFeaturesFromNode=function(t,e){var i={node:t};(0,d.assign)(i,{featureType:this.featureType_,featureNS:this.featureNS_}),(0,d.assign)(i,this.getReadOptions(t,e||{}));var n=[i];return this.gmlFormat_.FEATURE_COLLECTION_PARSERS[a.GMLNS].featureMember=(0,m.makeArrayPusher)(a.default.prototype.readFeaturesInternal),(0,m.pushParseAndPop)([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,t,n,this.gmlFormat_)||[]},M.prototype.readTransactionResponse=function(t){if(t){if("string"!=typeof t)return(0,m.isDocument)(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t);var e=(0,m.parse)(t);return this.readTransactionResponseFromDocument(e)}},M.prototype.readFeatureCollectionMetadata=function(t){if(t){if("string"!=typeof t)return(0,m.isDocument)(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t);var e=(0,m.parse)(t);return this.readFeatureCollectionMetadataFromDocument(e)}},M.prototype.readFeatureCollectionMetadataFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(e)},M.prototype.readFeatureCollectionMetadataFromNode=function(t){var e={},i=(0,c.readNonNegativeIntegerString)(t.getAttribute("numberOfFeatures"));return e.numberOfFeatures=i,(0,m.pushParseAndPop)(e,v,t,[],this.gmlFormat_)},M.prototype.readTransactionResponseFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(e)},M.prototype.readTransactionResponseFromNode=function(t){return(0,m.pushParseAndPop)({},j,t,[])},M.prototype.writeGetFeature=function(t){var e,i,n=(0,m.createElementNS)(T,"GetFeature");n.setAttribute("service","WFS"),n.setAttribute("version","1.1.0"),t&&(t.handle&&n.setAttribute("handle",t.handle),t.outputFormat&&n.setAttribute("outputFormat",t.outputFormat),void 0!==t.maxFeatures&&n.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&n.setAttribute("resultType",t.resultType),void 0!==t.startIndex&&n.setAttribute("startIndex",String(t.startIndex)),void 0!==t.count&&n.setAttribute("count",String(t.count)),void 0!==t.viewParams&&n.setAttribute("viewParams",t.viewParams),i=t.filter,t.bbox)&&((0,y.assert)(t.geometryName,12),e=(0,h.bbox)(t.geometryName,t.bbox,t.srsName),i=i?(0,h.and)(i,e):e),n.setAttributeNS(m.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation_);var r,o,s,a,l,u={node:n};return(0,d.assign)(u,{srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.featureNS_,featurePrefix:t.featurePrefix,geometryName:t.geometryName,filter:i,propertyNames:t.propertyNames?t.propertyNames:[]}),(0,y.assert)(Array.isArray(t.featureTypes),11),r=n,o=t.featureTypes,a=(s=[u])[s.length-1],(l=(0,d.assign)({},a)).node=r,(0,m.pushSerializeAndPop)(l,L,(0,m.makeSimpleNodeFactory)("Query"),o,s),n},M.prototype.writeTransaction=function(t,e,i,n){var r,o,s=[],a=(0,m.createElementNS)(T,"Transaction"),l=n.version?n.version:"1.1.0",u="1.0.0"===l?2:3;a.setAttribute("service","WFS"),a.setAttribute("version",l),n&&(r=n.gmlOptions?n.gmlOptions:{},n.handle&&a.setAttribute("handle",n.handle));var h=O[l];a.setAttributeNS(m.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",h);var c=n.featurePrefix?n.featurePrefix:w;return t&&(o=(0,d.assign)({node:a},{featureNS:n.featureNS,featureType:n.featureType,featurePrefix:c,gmlVersion:u,hasZ:n.hasZ,srsName:n.srsName}),(0,d.assign)(o,r),(0,m.pushSerializeAndPop)(o,S,(0,m.makeSimpleNodeFactory)("Insert"),t,s)),e&&(o=(0,d.assign)({node:a},{featureNS:n.featureNS,featureType:n.featureType,featurePrefix:c,gmlVersion:u,hasZ:n.hasZ,srsName:n.srsName}),(0,d.assign)(o,r),(0,m.pushSerializeAndPop)(o,S,(0,m.makeSimpleNodeFactory)("Update"),e,s)),i&&(0,m.pushSerializeAndPop)({node:a,featureNS:n.featureNS,featureType:n.featureType,featurePrefix:c,gmlVersion:u,srsName:n.srsName},S,(0,m.makeSimpleNodeFactory)("Delete"),i,s),n.nativeElements&&(0,m.pushSerializeAndPop)({node:a,featureNS:n.featureNS,featureType:n.featureType,featurePrefix:c,gmlVersion:u,srsName:n.srsName},S,(0,m.makeSimpleNodeFactory)("Native"),n.nativeElements,s),a},M.prototype.readProjectionFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(e);return null},M.prototype.readProjectionFromNode=function(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild)for(var e=(t=t.firstElementChild.firstElementChild).firstElementChild;e;e=e.nextElementSibling)if(0!==e.childNodes.length&&(1!==e.childNodes.length||3!==e.firstChild.nodeType)){var i=[{}];return this.gmlFormat_.readGeometryElement(e,i),(0,r.get)(i.pop().srsName)}return null},M);function M(t){var e=f.call(this)||this,i=t||{};return e.featureType_=i.featureType,e.featureNS_=i.featureNS,e.gmlFormat_=i.gmlFormat?i.gmlFormat:new u.default,e.schemaLocation_=i.schemaLocation?i.schemaLocation:O["1.1.0"],e}var I={"http://www.opengis.net/ogc":{FeatureId:(0,m.makeArrayPusher)(function(t,e){return t.getAttribute("fid")})}};var R={"http://www.opengis.net/wfs":{Feature:function(t,e){(0,m.parseNode)(I,t,e)}}};function k(t,e){var i=(0,m.createElementNS)(E,"Filter"),n=(0,m.createElementNS)(E,"FeatureId");i.appendChild(n),n.setAttribute("fid",e),t.appendChild(i)}function A(t,e){var i=(t=t||w)+":";return 0===e.indexOf(i)?e:i+e}var L={"http://www.opengis.net/wfs":{Query:(0,m.makeChildAppender)(function(t,e,i){var n,r=i[i.length-1],o=r.featurePrefix,s=r.featureNS,a=r.propertyNames,l=r.srsName;n=o?A(o,e):e,t.setAttribute("typeName",n),l&&t.setAttribute("srsName",l),s&&t.setAttributeNS(P,"xmlns:"+o,s);var u=(0,d.assign)({},r);u.node=t,(0,m.pushSerializeAndPop)(u,x,(0,m.makeSimpleNodeFactory)("PropertyName"),a,i);var h=r.filter;{var c;h&&(c=(0,m.createElementNS)(E,"Filter"),t.appendChild(c),F(c,h,i))}})},"http://www.opengis.net/ogc":{During:(0,m.makeChildAppender)(function(t,e,i){var n=(0,m.createElementNS)("http://www.opengis.net/fes","ValueReference");(0,c.writeStringTextNode)(n,e.propertyName),t.appendChild(n);var r=(0,m.createElementNS)(a.GMLNS,"TimePeriod");t.appendChild(r);var o=(0,m.createElementNS)(a.GMLNS,"begin");r.appendChild(o),B(o,e.begin);var s=(0,m.createElementNS)(a.GMLNS,"end");r.appendChild(s),B(s,e.end)}),And:(0,m.makeChildAppender)(N),Or:(0,m.makeChildAppender)(N),Not:(0,m.makeChildAppender)(function(t,e,i){var n={node:t},r=e.condition;(0,m.pushSerializeAndPop)(n,L,(0,m.makeSimpleNodeFactory)(r.getTagName()),[r],i)}),BBOX:(0,m.makeChildAppender)(function(t,e,i){i[i.length-1].srsName=e.srsName,U(t,e.geometryName),u.default.prototype.writeGeometryElement(t,e.extent,i)}),Contains:(0,m.makeChildAppender)(function(t,e,i){i[i.length-1].srsName=e.srsName,U(t,e.geometryName),u.default.prototype.writeGeometryElement(t,e.geometry,i)}),Intersects:(0,m.makeChildAppender)(function(t,e,i){i[i.length-1].srsName=e.srsName,U(t,e.geometryName),u.default.prototype.writeGeometryElement(t,e.geometry,i)}),Within:(0,m.makeChildAppender)(function(t,e,i){i[i.length-1].srsName=e.srsName,U(t,e.geometryName),u.default.prototype.writeGeometryElement(t,e.geometry,i)}),PropertyIsEqualTo:(0,m.makeChildAppender)(D),PropertyIsNotEqualTo:(0,m.makeChildAppender)(D),PropertyIsLessThan:(0,m.makeChildAppender)(D),PropertyIsLessThanOrEqualTo:(0,m.makeChildAppender)(D),PropertyIsGreaterThan:(0,m.makeChildAppender)(D),PropertyIsGreaterThanOrEqualTo:(0,m.makeChildAppender)(D),PropertyIsNull:(0,m.makeChildAppender)(function(t,e,i){U(t,e.propertyName)}),PropertyIsBetween:(0,m.makeChildAppender)(function(t,e,i){U(t,e.propertyName);var n=(0,m.createElementNS)(E,"LowerBoundary");t.appendChild(n),z(n,""+e.lowerBoundary);var r=(0,m.createElementNS)(E,"UpperBoundary");t.appendChild(r),z(r,""+e.upperBoundary)}),PropertyIsLike:(0,m.makeChildAppender)(function(t,e,i){t.setAttribute("wildCard",e.wildCard),t.setAttribute("singleChar",e.singleChar),t.setAttribute("escapeChar",e.escapeChar),void 0!==e.matchCase&&t.setAttribute("matchCase",e.matchCase.toString()),U(t,e.propertyName),z(t,""+e.pattern)})}};function F(t,e,i){var n={node:t};(0,m.pushSerializeAndPop)(n,L,(0,m.makeSimpleNodeFactory)(e.getTagName()),[e],i)}function N(t,e,i){for(var n={node:t},r=e.conditions,o=0,s=r.length;o<s;++o){var a=r[o];(0,m.pushSerializeAndPop)(n,L,(0,m.makeSimpleNodeFactory)(a.getTagName()),[a],i)}}function D(t,e,i){void 0!==e.matchCase&&t.setAttribute("matchCase",e.matchCase.toString()),U(t,e.propertyName),z(t,""+e.expression)}function G(t,e,i){var n=(0,m.createElementNS)(E,t);(0,c.writeStringTextNode)(n,i),e.appendChild(n)}function U(t,e){G("PropertyName",t,e)}function z(t,e){G("Literal",t,e)}function B(t,e){var i=(0,m.createElementNS)(a.GMLNS,"TimeInstant");t.appendChild(i);var n=(0,m.createElementNS)(a.GMLNS,"timePosition");i.appendChild(n),(0,c.writeStringTextNode)(n,e)}i.default=C},{"../asserts.js":45,"../obj.js":203,"../proj.js":205,"../xml.js":322,"./GML2.js":79,"./GML3.js":80,"./GMLBase.js":81,"./XMLFeature.js":100,"./filter.js":101,"./xsd.js":124}],94:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=g(t("../Feature.js")),s=g(t("../geom/GeometryCollection.js")),a=g(t("../geom/GeometryLayout.js")),u=g(t("../geom/GeometryType.js")),n=g(t("../geom/LineString.js")),r=g(t("../geom/MultiLineString.js")),o=g(t("../geom/MultiPoint.js")),h=g(t("../geom/MultiPolygon.js")),c=g(t("../geom/Point.js")),d=g(t("../geom/Polygon.js")),p=g(t("./TextFeature.js")),f=t("./Feature.js");function g(t){return t&&t.__esModule?t:{default:t}}var m,y=(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),_={POINT:c.default,LINESTRING:n.default,POLYGON:d.default,MULTIPOINT:o.default,MULTILINESTRING:r.default,MULTIPOLYGON:h.default},v="EMPTY",b="Z",j="M",x=1,S=2,w=3,P=4,E=5,T=6,O={};for(var C in u.default)O[C]=u.default[C].toUpperCase();var M,I=(F.prototype.isAlpha_=function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"},F.prototype.isNumeric_=function(t,e){return"0"<=t&&t<="9"||"."==t&&!(void 0!==e&&e)},F.prototype.isWhiteSpace_=function(t){return" "==t||"\t"==t||"\r"==t||"\n"==t},F.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},F.prototype.nextToken=function(){var t,e=this.nextChar_(),i=this.index_,n=e;if("("==e)t=S;else if(","==e)t=E;else if(")"==e)t=w;else if(this.isNumeric_(e)||"-"==e)t=P,n=this.readNumber_();else if(this.isAlpha_(e))t=x,n=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(""!==e)throw new Error("Unexpected character: "+e);t=T}return{position:i,value:n,type:t}},F.prototype.readNumber_=function(){for(var t,e=this.index_,i=!1,n=!1;"."==t?i=!0:"e"!=t&&"E"!=t||(n=!0),t=this.nextChar_(),this.isNumeric_(t,i)||!n&&("e"==t||"E"==t)||n&&("-"==t||"+"==t););return parseFloat(this.wkt.substring(e,this.index_--))},F.prototype.readText_=function(){for(var t,e=this.index_;t=this.nextChar_(),this.isAlpha_(t););return this.wkt.substring(e,this.index_--).toUpperCase()},F),R=(L.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},L.prototype.isTokenType=function(t){return this.token_.type==t},L.prototype.match=function(t){var e=this.isTokenType(t);return e&&this.consume_(),e},L.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},L.prototype.parseGeometryLayout_=function(){var t,e=a.default.XY,i=this.token_;return this.isTokenType(x)&&((t=i.value)===b?e=a.default.XYZ:t===j?e=a.default.XYM:"ZM"===t&&(e=a.default.XYZM),e!==a.default.XY&&this.consume_()),e},L.prototype.parseGeometryCollectionText_=function(){if(this.match(S)){for(var t=[];t.push(this.parseGeometry_()),this.match(E););if(this.match(w))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},L.prototype.parsePointText_=function(){if(this.match(S)){var t=this.parsePoint_();if(this.match(w))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())},L.prototype.parseLineStringText_=function(){if(this.match(S)){var t=this.parsePointList_();if(this.match(w))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},L.prototype.parsePolygonText_=function(){if(this.match(S)){var t=this.parseLineStringTextList_();if(this.match(w))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},L.prototype.parseMultiPointText_=function(){if(this.match(S)){var t=this.token_.type==S?this.parsePointTextList_():this.parsePointList_();if(this.match(w))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},L.prototype.parseMultiLineStringText_=function(){if(this.match(S)){var t=this.parseLineStringTextList_();if(this.match(w))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},L.prototype.parseMultiPolygonText_=function(){if(this.match(S)){var t=this.parsePolygonTextList_();if(this.match(w))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},L.prototype.parsePoint_=function(){for(var t=[],e=this.layout_.length,i=0;i<e;++i){var n=this.token_;if(!this.match(P))break;t.push(n.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())},L.prototype.parsePointList_=function(){for(var t=[this.parsePoint_()];this.match(E);)t.push(this.parsePoint_());return t},L.prototype.parsePointTextList_=function(){for(var t=[this.parsePointText_()];this.match(E);)t.push(this.parsePointText_());return t},L.prototype.parseLineStringTextList_=function(){for(var t=[this.parseLineStringText_()];this.match(E);)t.push(this.parseLineStringText_());return t},L.prototype.parsePolygonTextList_=function(){for(var t=[this.parsePolygonText_()];this.match(E);)t.push(this.parsePolygonText_());return t},L.prototype.isEmptyGeometry_=function(){var t=this.isTokenType(x)&&this.token_.value==v;return t&&this.consume_(),t},L.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},L.prototype.parseGeometry_=function(){var t=this.token_;if(this.match(x)){var e=t.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==e){var i=this.parseGeometryCollectionText_();return new s.default(i)}var n=_[e];if(!n)throw new Error("Invalid geometry type: "+e);var r=void 0;switch(e){case"POINT":r=this.parsePointText_();break;case"LINESTRING":r=this.parseLineStringText_();break;case"POLYGON":r=this.parsePolygonText_();break;case"MULTIPOINT":r=this.parseMultiPointText_();break;case"MULTILINESTRING":r=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":r=this.parseMultiPolygonText_();break;default:throw new Error("Invalid geometry type: "+e)}return new n(r=r||(n===_.POINT?[NaN,NaN]:[]),this.layout_)}throw new Error(this.formatErrorMessage_())},L),k=(M=p.default,y(A,M),A.prototype.parse_=function(t){var e=new I(t);return new R(e).parse()},A.prototype.readFeatureFromText=function(t,e){var i=this.readGeometryFromText(t,e);if(i){var n=new l.default;return n.setGeometry(i),n}return null},A.prototype.readFeaturesFromText=function(t,e){for(var i,n=this.readGeometryFromText(t,e),r=[],o=0,s=(i=this.splitCollection_&&n.getType()==u.default.GEOMETRY_COLLECTION?n.getGeometriesArray():[n]).length;o<s;++o){var a=new l.default;a.setGeometry(i[o]),r.push(a)}return r},A.prototype.readGeometryFromText=function(t,e){var i=this.parse_(t);return i?(0,f.transformGeometryWithOptions)(i,!1,e):null},A.prototype.writeFeatureText=function(t,e){var i=t.getGeometry();return i?this.writeGeometryText(i,e):""},A.prototype.writeFeaturesText=function(t,e){if(1==t.length)return this.writeFeatureText(t[0],e);for(var i=[],n=0,r=t.length;n<r;++n)i.push(t[n].getGeometry());var o=new s.default(i);return this.writeGeometryText(o,e)},A.prototype.writeGeometryText=function(t,e){return z((0,f.transformGeometryWithOptions)(t,!0,e))},A);function A(t){var e=M.call(this)||this,i=t||{};return e.splitCollection_=void 0!==i.splitCollection&&i.splitCollection,e}function L(t){this.lexer_=t,this.token_,this.layout_=a.default.XY}function F(t){this.wkt=t,this.index_=-1}function N(t){var e=t.getCoordinates();return 0===e.length?"":e.join(" ")}function D(t){for(var e=t.getCoordinates(),i=[],n=0,r=e.length;n<r;++n)i.push(e[n].join(" "));return i.join(",")}function G(t){for(var e=[],i=t.getLinearRings(),n=0,r=i.length;n<r;++n)e.push("("+D(i[n])+")");return e.join(",")}var U={Point:N,LineString:D,Polygon:G,MultiPoint:function(t){for(var e=[],i=t.getPoints(),n=0,r=i.length;n<r;++n)e.push("("+N(i[n])+")");return e.join(",")},MultiLineString:function(t){for(var e=[],i=t.getLineStrings(),n=0,r=i.length;n<r;++n)e.push("("+D(i[n])+")");return e.join(",")},MultiPolygon:function(t){for(var e=[],i=t.getPolygons(),n=0,r=i.length;n<r;++n)e.push("("+G(i[n])+")");return e.join(",")},GeometryCollection:function(t){for(var e=[],i=t.getGeometries(),n=0,r=i.length;n<r;++n)e.push(z(i[n]));return e.join(",")}};function z(t){var e,i,n,r=t.getType(),o=(0,U[r])(t),r=r.toUpperCase();return"function"==typeof t.getFlatCoordinates&&(i=t.getLayout(),n="",i!==a.default.XYZ&&i!==a.default.XYZM||(n+=b),i!==a.default.XYM&&i!==a.default.XYZM||(n+=j),0<(e=n).length&&(r+=" "+e)),0===o.length?r+" "+v:r+"("+o+")"}i.default=k},{"../Feature.js":13,"../geom/GeometryCollection.js":129,"../geom/GeometryLayout.js":130,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"./Feature.js":76,"./TextFeature.js":91}],95:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./XML.js"))&&n.__esModule?n:{default:n},h=t("../xml.js"),c=t("./xsd.js"),o=t("./XLink.js");var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=[null,"http://www.opengis.net/wms"],d=(0,h.makeStructureNS)(u,{Service:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},g,t,e)}),Capability:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},p,t,e)})}),p=(0,h.makeStructureNS)(u,{Request:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},S,t,e)}),Exception:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)([],v,t,e)}),Layer:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},b,t,e)})}),f=(s=r.default,l(M,s),M.prototype.readFromNode=function(t){return this.version=t.getAttribute("version").trim(),(0,h.pushParseAndPop)({version:this.version},d,t,[])||null},M),g=(0,h.makeStructureNS)(u,{Name:(0,h.makeObjectPropertySetter)(c.readString),Title:(0,h.makeObjectPropertySetter)(c.readString),Abstract:(0,h.makeObjectPropertySetter)(c.readString),KeywordList:(0,h.makeObjectPropertySetter)(A),OnlineResource:(0,h.makeObjectPropertySetter)(o.readHref),ContactInformation:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},m,t,e)}),Fees:(0,h.makeObjectPropertySetter)(c.readString),AccessConstraints:(0,h.makeObjectPropertySetter)(c.readString),LayerLimit:(0,h.makeObjectPropertySetter)(c.readNonNegativeInteger),MaxWidth:(0,h.makeObjectPropertySetter)(c.readNonNegativeInteger),MaxHeight:(0,h.makeObjectPropertySetter)(c.readNonNegativeInteger)}),m=(0,h.makeStructureNS)(u,{ContactPersonPrimary:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},y,t,e)}),ContactPosition:(0,h.makeObjectPropertySetter)(c.readString),ContactAddress:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},_,t,e)}),ContactVoiceTelephone:(0,h.makeObjectPropertySetter)(c.readString),ContactFacsimileTelephone:(0,h.makeObjectPropertySetter)(c.readString),ContactElectronicMailAddress:(0,h.makeObjectPropertySetter)(c.readString)}),y=(0,h.makeStructureNS)(u,{ContactPerson:(0,h.makeObjectPropertySetter)(c.readString),ContactOrganization:(0,h.makeObjectPropertySetter)(c.readString)}),_=(0,h.makeStructureNS)(u,{AddressType:(0,h.makeObjectPropertySetter)(c.readString),Address:(0,h.makeObjectPropertySetter)(c.readString),City:(0,h.makeObjectPropertySetter)(c.readString),StateOrProvince:(0,h.makeObjectPropertySetter)(c.readString),PostCode:(0,h.makeObjectPropertySetter)(c.readString),Country:(0,h.makeObjectPropertySetter)(c.readString)}),v=(0,h.makeStructureNS)(u,{Format:(0,h.makeArrayPusher)(c.readString)}),b=(0,h.makeStructureNS)(u,{Name:(0,h.makeObjectPropertySetter)(c.readString),Title:(0,h.makeObjectPropertySetter)(c.readString),Abstract:(0,h.makeObjectPropertySetter)(c.readString),KeywordList:(0,h.makeObjectPropertySetter)(A),CRS:(0,h.makeObjectPropertyPusher)(c.readString),EX_GeographicBoundingBox:(0,h.makeObjectPropertySetter)(function(t,e){var i=(0,h.pushParseAndPop)({},x,t,e);if(i){var n=i.westBoundLongitude,r=i.southBoundLatitude,o=i.eastBoundLongitude,s=i.northBoundLatitude;if(void 0!==n&&void 0!==r&&void 0!==o&&void 0!==s)return[n,r,o,s]}}),BoundingBox:(0,h.makeObjectPropertyPusher)(function(t,e){var i=[(0,c.readDecimalString)(t.getAttribute("minx")),(0,c.readDecimalString)(t.getAttribute("miny")),(0,c.readDecimalString)(t.getAttribute("maxx")),(0,c.readDecimalString)(t.getAttribute("maxy"))],n=[(0,c.readDecimalString)(t.getAttribute("resx")),(0,c.readDecimalString)(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS"),extent:i,res:n}}),Dimension:(0,h.makeObjectPropertyPusher)(function(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:(0,c.readBooleanString)(t.getAttribute("multipleValues")),nearestValue:(0,c.readBooleanString)(t.getAttribute("nearestValue")),current:(0,c.readBooleanString)(t.getAttribute("current")),values:(0,c.readString)(t)}}),Attribution:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},j,t,e)}),AuthorityURL:(0,h.makeObjectPropertyPusher)(function(t,e){var i=I(t,e);if(i)return i.name=t.getAttribute("name"),i}),Identifier:(0,h.makeObjectPropertyPusher)(c.readString),MetadataURL:(0,h.makeObjectPropertyPusher)(function(t,e){var i=I(t,e);if(i)return i.type=t.getAttribute("type"),i}),DataURL:(0,h.makeObjectPropertyPusher)(I),FeatureListURL:(0,h.makeObjectPropertyPusher)(I),Style:(0,h.makeObjectPropertyPusher)(function(t,e){return(0,h.pushParseAndPop)({},T,t,e)}),MinScaleDenominator:(0,h.makeObjectPropertySetter)(c.readDecimal),MaxScaleDenominator:(0,h.makeObjectPropertySetter)(c.readDecimal),Layer:(0,h.makeObjectPropertyPusher)(function(t,e){var i=e[e.length-1],n=(0,h.pushParseAndPop)({},b,t,e);if(n){var r=(0,c.readBooleanString)(t.getAttribute("queryable"));void 0===r&&(r=i.queryable),n.queryable=void 0!==r&&r;var o=(0,c.readNonNegativeIntegerString)(t.getAttribute("cascaded"));void 0===o&&(o=i.cascaded),n.cascaded=o;var s=(0,c.readBooleanString)(t.getAttribute("opaque"));void 0===s&&(s=i.opaque),n.opaque=void 0!==s&&s;var a=(0,c.readBooleanString)(t.getAttribute("noSubsets"));void 0===a&&(a=i.noSubsets),n.noSubsets=void 0!==a&&a;var l=(0,c.readDecimalString)(t.getAttribute("fixedWidth"));l=l||i.fixedWidth,n.fixedWidth=l;var u=(0,c.readDecimalString)(t.getAttribute("fixedHeight"));return u=u||i.fixedHeight,n.fixedHeight=u,["Style","CRS","AuthorityURL"].forEach(function(t){var e;t in i&&(e=n[t]||[],n[t]=e.concat(i[t]))}),["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(t){var e;t in n||(e=i[t],n[t]=e)}),n}})}),j=(0,h.makeStructureNS)(u,{Title:(0,h.makeObjectPropertySetter)(c.readString),OnlineResource:(0,h.makeObjectPropertySetter)(o.readHref),LogoURL:(0,h.makeObjectPropertySetter)(k)}),x=(0,h.makeStructureNS)(u,{westBoundLongitude:(0,h.makeObjectPropertySetter)(c.readDecimal),eastBoundLongitude:(0,h.makeObjectPropertySetter)(c.readDecimal),southBoundLatitude:(0,h.makeObjectPropertySetter)(c.readDecimal),northBoundLatitude:(0,h.makeObjectPropertySetter)(c.readDecimal)}),S=(0,h.makeStructureNS)(u,{GetCapabilities:(0,h.makeObjectPropertySetter)(R),GetMap:(0,h.makeObjectPropertySetter)(R),GetFeatureInfo:(0,h.makeObjectPropertySetter)(R)}),w=(0,h.makeStructureNS)(u,{Format:(0,h.makeObjectPropertyPusher)(c.readString),DCPType:(0,h.makeObjectPropertyPusher)(function(t,e){return(0,h.pushParseAndPop)({},P,t,e)})}),P=(0,h.makeStructureNS)(u,{HTTP:(0,h.makeObjectPropertySetter)(function(t,e){return(0,h.pushParseAndPop)({},E,t,e)})}),E=(0,h.makeStructureNS)(u,{Get:(0,h.makeObjectPropertySetter)(I),Post:(0,h.makeObjectPropertySetter)(I)}),T=(0,h.makeStructureNS)(u,{Name:(0,h.makeObjectPropertySetter)(c.readString),Title:(0,h.makeObjectPropertySetter)(c.readString),Abstract:(0,h.makeObjectPropertySetter)(c.readString),LegendURL:(0,h.makeObjectPropertyPusher)(k),StyleSheetURL:(0,h.makeObjectPropertySetter)(I),StyleURL:(0,h.makeObjectPropertySetter)(I)}),O=(0,h.makeStructureNS)(u,{Format:(0,h.makeObjectPropertySetter)(c.readString),OnlineResource:(0,h.makeObjectPropertySetter)(o.readHref)}),C=(0,h.makeStructureNS)(u,{Keyword:(0,h.makeArrayPusher)(c.readString)});function M(){var t=s.call(this)||this;return t.version=void 0,t}function I(t,e){return(0,h.pushParseAndPop)({},O,t,e)}function R(t,e){return(0,h.pushParseAndPop)({},w,t,e)}function k(t,e){var i=I(t,e);if(i){var n=[(0,c.readNonNegativeIntegerString)(t.getAttribute("width")),(0,c.readNonNegativeIntegerString)(t.getAttribute("height"))];return i.size=n,i}}function A(t,e){return(0,h.pushParseAndPop)([],C,t,e)}i.default=f},{"../xml.js":322,"./XLink.js":98,"./XML.js":99,"./xsd.js":124}],96:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./GML2.js")),r=s(t("./XMLFeature.js")),o=t("../obj.js"),g=t("../array.js"),m=t("../xml.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=r.default,u(c,a),c.prototype.getLayers=function(){return this.layers_},c.prototype.setLayers=function(t){this.layers_=t},c.prototype.readFeatures_=function(t,e){t.setAttribute("namespaceURI",this.featureNS_);var i,n=t.localName,r=[];if(0===t.childNodes.length)return r;if("msGMLOutput"==n)for(var o=0,s=t.childNodes.length;o<s;o++){var a,l,u,h,c,d,p,f=t.childNodes[o];f.nodeType===Node.ELEMENT_NODE&&(a=f,l=e[0],u=a.localName.replace("_layer",""),this.layers_&&!(0,g.includes)(this.layers_,u)||(h=u+"_feature",l.featureType=h,l.featureNS=this.featureNS_,(c={})[h]=(0,m.makeArrayPusher)(this.gmlFormat_.readFeatureElement,this.gmlFormat_),d=(0,m.makeStructureNS)([l.featureNS,null],c),a.setAttribute("namespaceURI",this.featureNS_),(p=(0,m.pushParseAndPop)([],d,a,e,this.gmlFormat_))&&(0,g.extend)(r,p)))}return"FeatureCollection"!=n||(i=(0,m.pushParseAndPop)([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,t,[{}],this.gmlFormat_))&&(r=i),r},c.prototype.readFeaturesFromNode=function(t,e){var i={};return e&&(0,o.assign)(i,this.getReadOptions(t,e)),this.readFeatures_(t,[i])},c);function c(t){var e=a.call(this)||this,i=t||{};return e.featureNS_="http://mapserver.gis.umn.edu/mapserver",e.gmlFormat_=new n.default,e.layers_=i.layers?i.layers:null,e}i.default=h},{"../array.js":44,"../obj.js":203,"../xml.js":322,"./GML2.js":79,"./XMLFeature.js":100}],97:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=u(t("./OWS.js")),r=u(t("./XML.js")),o=t("../extent.js"),s=t("../xml.js"),a=t("./xsd.js"),l=t("./XLink.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=[null,"http://www.opengis.net/wmts/1.0"],f=[null,"http://www.opengis.net/ows/1.1"],g=(0,s.makeStructureNS)(p,{Contents:(0,s.makeObjectPropertySetter)(function(t,e){return(0,s.pushParseAndPop)({},y,t,e)})}),m=(h=r.default,d(T,h),T.prototype.readFromNode=function(t){var e=(e=t.getAttribute("version"))&&e.trim(),i=this.owsParser_.readFromNode(t);return i?(i.version=e,(i=(0,s.pushParseAndPop)(i,g,t,[]))||null):null},T),y=(0,s.makeStructureNS)(p,{Layer:(0,s.makeObjectPropertyPusher)(function(t,e){return(0,s.pushParseAndPop)({},_,t,e)}),TileMatrixSet:(0,s.makeObjectPropertyPusher)(function(t,e){return(0,s.pushParseAndPop)({},P,t,e)})}),_=(0,s.makeStructureNS)(p,{Style:(0,s.makeObjectPropertyPusher)(function(t,e){var i=(0,s.pushParseAndPop)({},v,t,e);if(i){var n="true"===t.getAttribute("isDefault");return i.isDefault=n,i}}),Format:(0,s.makeObjectPropertyPusher)(a.readString),TileMatrixSetLink:(0,s.makeObjectPropertyPusher)(function(t,e){return(0,s.pushParseAndPop)({},b,t,e)}),Dimension:(0,s.makeObjectPropertyPusher)(function(t,e){return(0,s.pushParseAndPop)({},S,t,e)}),ResourceURL:(0,s.makeObjectPropertyPusher)(function(t,e){var i=t.getAttribute("format"),n=t.getAttribute("template"),r=t.getAttribute("resourceType"),o={};return i&&(o.format=i),n&&(o.template=n),r&&(o.resourceType=r),o})},(0,s.makeStructureNS)(f,{Title:(0,s.makeObjectPropertySetter)(a.readString),Abstract:(0,s.makeObjectPropertySetter)(a.readString),WGS84BoundingBox:(0,s.makeObjectPropertySetter)(function(t,e){var i=(0,s.pushParseAndPop)([],w,t,e);if(2==i.length)return(0,o.boundingExtent)(i)}),Identifier:(0,s.makeObjectPropertySetter)(a.readString)})),v=(0,s.makeStructureNS)(p,{LegendURL:(0,s.makeObjectPropertyPusher)(function(t,e){var i={};return i.format=t.getAttribute("format"),i.href=(0,l.readHref)(t),i})},(0,s.makeStructureNS)(f,{Title:(0,s.makeObjectPropertySetter)(a.readString),Identifier:(0,s.makeObjectPropertySetter)(a.readString)})),b=(0,s.makeStructureNS)(p,{TileMatrixSet:(0,s.makeObjectPropertySetter)(a.readString),TileMatrixSetLimits:(0,s.makeObjectPropertySetter)(function(t,e){return(0,s.pushParseAndPop)([],j,t,e)})}),j=(0,s.makeStructureNS)(p,{TileMatrixLimits:(0,s.makeArrayPusher)(function(t,e){return(0,s.pushParseAndPop)({},x,t,e)})}),x=(0,s.makeStructureNS)(p,{TileMatrix:(0,s.makeObjectPropertySetter)(a.readString),MinTileRow:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger),MaxTileRow:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger),MinTileCol:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger),MaxTileCol:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger)}),S=(0,s.makeStructureNS)(p,{Default:(0,s.makeObjectPropertySetter)(a.readString),Value:(0,s.makeObjectPropertyPusher)(a.readString)},(0,s.makeStructureNS)(f,{Identifier:(0,s.makeObjectPropertySetter)(a.readString)})),w=(0,s.makeStructureNS)(f,{LowerCorner:(0,s.makeArrayPusher)(O),UpperCorner:(0,s.makeArrayPusher)(O)}),P=(0,s.makeStructureNS)(p,{WellKnownScaleSet:(0,s.makeObjectPropertySetter)(a.readString),TileMatrix:(0,s.makeObjectPropertyPusher)(function(t,e){return(0,s.pushParseAndPop)({},E,t,e)})},(0,s.makeStructureNS)(f,{SupportedCRS:(0,s.makeObjectPropertySetter)(a.readString),Identifier:(0,s.makeObjectPropertySetter)(a.readString)})),E=(0,s.makeStructureNS)(p,{TopLeftCorner:(0,s.makeObjectPropertySetter)(O),ScaleDenominator:(0,s.makeObjectPropertySetter)(a.readDecimal),TileWidth:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger),TileHeight:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger),MatrixWidth:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger),MatrixHeight:(0,s.makeObjectPropertySetter)(a.readNonNegativeInteger)},(0,s.makeStructureNS)(f,{Identifier:(0,s.makeObjectPropertySetter)(a.readString)}));function T(){var t=h.call(this)||this;return t.owsParser_=new n.default,t}function O(t,e){var i=(0,a.readString)(t).split(/\s+/);if(i&&2==i.length){var n=+i[0],r=+i[1];if(!isNaN(n)&&!isNaN(r))return[n,r]}}i.default=m},{"../extent.js":70,"../xml.js":322,"./OWS.js":89,"./XLink.js":98,"./XML.js":99,"./xsd.js":124}],98:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.readHref=function(t){return t.getAttributeNS(n,"href")};var n="http://www.w3.org/1999/xlink"},{}],99:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=t("../xml.js"),r=(o.prototype.read=function(t){if(t){if("string"!=typeof t)return(0,n.isDocument)(t)?this.readFromDocument(t):this.readFromNode(t);var e=(0,n.parse)(t);return this.readFromDocument(e)}return null},o.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},o.prototype.readFromNode=function(t){},o);function o(){}i.default=r},{"../xml.js":322}],100:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("../format/Feature.js")),r=l(t("../format/FormatType.js")),o=t("../util.js"),s=t("../array.js"),a=t("../xml.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=n.default,c(p,u),p.prototype.getType=function(){return r.default.XML},p.prototype.readFeature=function(t,e){if(t){if("string"!=typeof t)return(0,a.isDocument)(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e);var i=(0,a.parse)(t);return this.readFeatureFromDocument(i,e)}return null},p.prototype.readFeatureFromDocument=function(t,e){var i=this.readFeaturesFromDocument(t,e);return 0<i.length?i[0]:null},p.prototype.readFeatureFromNode=function(t,e){return null},p.prototype.readFeatures=function(t,e){if(t){if("string"!=typeof t)return(0,a.isDocument)(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e);var i=(0,a.parse)(t);return this.readFeaturesFromDocument(i,e)}return[]},p.prototype.readFeaturesFromDocument=function(t,e){for(var i=[],n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&(0,s.extend)(i,this.readFeaturesFromNode(n,e));return i},p.prototype.readFeaturesFromNode=function(t,e){return(0,o.abstract)()},p.prototype.readGeometry=function(t,e){if(t){if("string"!=typeof t)return(0,a.isDocument)(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e);var i=(0,a.parse)(t);return this.readGeometryFromDocument(i,e)}return null},p.prototype.readGeometryFromDocument=function(t,e){return null},p.prototype.readGeometryFromNode=function(t,e){return null},p.prototype.readProjection=function(t){if(t){if("string"!=typeof t)return(0,a.isDocument)(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t);var e=(0,a.parse)(t);return this.readProjectionFromDocument(e)}return null},p.prototype.readProjectionFromDocument=function(t){return this.dataProjection},p.prototype.readProjectionFromNode=function(t){return this.dataProjection},p.prototype.writeFeature=function(t,e){var i=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(i)},p.prototype.writeFeatureNode=function(t,e){return null},p.prototype.writeFeatures=function(t,e){var i=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(i)},p.prototype.writeFeaturesNode=function(t,e){return null},p.prototype.writeGeometry=function(t,e){var i=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(i)},p.prototype.writeGeometryNode=function(t,e){return null},p);function p(){var t=u.call(this)||this;return t.xmlSerializer_=(0,a.getXMLSerializer)(),t}i.default=d},{"../array.js":44,"../format/Feature.js":76,"../format/FormatType.js":77,"../util.js":313,"../xml.js":322}],101:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.and=function(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(n.default,e))},i.or=function(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(_.default,e))},i.not=function(t){return new m.default(t)},i.bbox=function(t,e,i){return new r.default(t,e,i)},i.contains=function(t,e,i){return new o.default(t,e,i)},i.intersects=function(t,e,i){return new h.default(t,e,i)},i.within=function(t,e,i){return new v.default(t,e,i)},i.equalTo=function(t,e,i){return new a.default(t,e,i)},i.notEqualTo=function(t,e,i){return new y.default(t,e,i)},i.lessThan=function(t,e){return new f.default(t,e)},i.lessThanOrEqualTo=function(t,e){return new g.default(t,e)},i.greaterThan=function(t,e){return new l.default(t,e)},i.greaterThanOrEqualTo=function(t,e){return new u.default(t,e)},i.isNull=function(t){return new p.default(t)},i.between=function(t,e,i){return new c.default(t,e,i)},i.like=function(t,e,i,n,r,o){return new d.default(t,e,i,n,r,o)},i.during=function(t,e,i){return new s.default(t,e,i)};var n=b(t("./filter/And.js")),r=b(t("./filter/Bbox.js")),o=b(t("./filter/Contains.js")),s=b(t("./filter/During.js")),a=b(t("./filter/EqualTo.js")),l=b(t("./filter/GreaterThan.js")),u=b(t("./filter/GreaterThanOrEqualTo.js")),h=b(t("./filter/Intersects.js")),c=b(t("./filter/IsBetween.js")),d=b(t("./filter/IsLike.js")),p=b(t("./filter/IsNull.js")),f=b(t("./filter/LessThan.js")),g=b(t("./filter/LessThanOrEqualTo.js")),m=b(t("./filter/Not.js")),y=b(t("./filter/NotEqualTo.js")),_=b(t("./filter/Or.js")),v=b(t("./filter/Within.js"));function b(t){return t&&t.__esModule?t:{default:t}}},{"./filter/And.js":102,"./filter/Bbox.js":103,"./filter/Contains.js":106,"./filter/During.js":107,"./filter/EqualTo.js":108,"./filter/GreaterThan.js":110,"./filter/GreaterThanOrEqualTo.js":111,"./filter/Intersects.js":112,"./filter/IsBetween.js":113,"./filter/IsLike.js":114,"./filter/IsNull.js":115,"./filter/LessThan.js":116,"./filter/LessThanOrEqualTo.js":117,"./filter/Not.js":119,"./filter/NotEqualTo.js":120,"./filter/Or.js":121,"./filter/Within.js":123}],102:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./LogicalNary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t){return o.call(this,"And",Array.prototype.slice.call(arguments))||this}i.default=l},{"./LogicalNary.js":118}],103:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Filter.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){var n=o.call(this,"BBOX")||this;if(n.geometryName=t,4!==(n.extent=e).length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return n.srsName=i,n}i.default=l},{"./Filter.js":109}],104:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Filter.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e){var i=o.call(this,t)||this;return i.propertyName=e,i}i.default=l},{"./Filter.js":109}],105:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Comparison.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i,n){var r=o.call(this,t,e)||this;return r.expression=i,r.matchCase=n,r}i.default=l},{"./Comparison.js":104}],106:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Spatial.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){return o.call(this,"Contains",t,e,i)||this}i.default=l},{"./Spatial.js":122}],107:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Comparison.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){var n=o.call(this,"During",t)||this;return n.begin=e,n.end=i,n}i.default=l},{"./Comparison.js":104}],108:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./ComparisonBinary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){return o.call(this,"PropertyIsEqualTo",t,e,i)||this}i.default=l},{"./ComparisonBinary.js":105}],109:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.getTagName=function(){return this.tagName_},r);function r(t){this.tagName_=t}i.default=n},{}],110:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./ComparisonBinary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e){return o.call(this,"PropertyIsGreaterThan",t,e)||this}i.default=l},{"./ComparisonBinary.js":105}],111:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./ComparisonBinary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e){return o.call(this,"PropertyIsGreaterThanOrEqualTo",t,e)||this}i.default=l},{"./ComparisonBinary.js":105}],112:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Spatial.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){return o.call(this,"Intersects",t,e,i)||this}i.default=l},{"./Spatial.js":122}],113:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Comparison.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){var n=o.call(this,"PropertyIsBetween",t)||this;return n.lowerBoundary=e,n.upperBoundary=i,n}i.default=l},{"./Comparison.js":104}],114:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Comparison.js"))&&n.__esModule?n:{default:n};var a,o,s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(a=r.default,s(u,a),u);function u(t,e,i,n,r,o){var s=a.call(this,"PropertyIsLike",t)||this;return s.pattern=e,s.wildCard=void 0!==i?i:"*",s.singleChar=void 0!==n?n:".",s.escapeChar=void 0!==r?r:"!",s.matchCase=o,s}i.default=l},{"./Comparison.js":104}],115:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Comparison.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t){return o.call(this,"PropertyIsNull",t)||this}i.default=l},{"./Comparison.js":104}],116:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./ComparisonBinary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e){return o.call(this,"PropertyIsLessThan",t,e)||this}i.default=l},{"./ComparisonBinary.js":105}],117:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./ComparisonBinary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e){return o.call(this,"PropertyIsLessThanOrEqualTo",t,e)||this}i.default=l},{"./ComparisonBinary.js":105}],118:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Filter.js"))&&n.__esModule?n:{default:n},o=t("../../asserts.js");var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=r.default,l(h,s),h);function h(t,e){var i=s.call(this,t)||this;return i.conditions=e,(0,o.assert)(2<=i.conditions.length,57),i}i.default=u},{"../../asserts.js":45,"./Filter.js":109}],119:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Filter.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t){var e=o.call(this,"Not")||this;return e.condition=t,e}i.default=l},{"./Filter.js":109}],120:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./ComparisonBinary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){return o.call(this,"PropertyIsNotEqualTo",t,e,i)||this}i.default=l},{"./ComparisonBinary.js":105}],121:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./LogicalNary.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t){return o.call(this,"Or",Array.prototype.slice.call(arguments))||this}i.default=l},{"./LogicalNary.js":118}],122:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Filter.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i,n){var r=o.call(this,t)||this;return r.geometryName=e||"the_geom",r.geometry=i,r.srsName=n,r}i.default=l},{"./Filter.js":109}],123:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Spatial.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i){return o.call(this,"Within",t,e,i)||this}i.default=l},{"./Spatial.js":122}],124:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.readBoolean=function(t){return n((0,r.getAllTextContent)(t,!1))},i.readBooleanString=n,i.readDateTime=function(t){var e=(0,r.getAllTextContent)(t,!1),i=Date.parse(e);return isNaN(i)?void 0:i/1e3},i.readDecimal=function(t){return s((0,r.getAllTextContent)(t,!1))},i.readDecimalString=s,i.readNonNegativeInteger=function(t){return a((0,r.getAllTextContent)(t,!1))},i.readNonNegativeIntegerString=a,i.readString=function(t){return(0,r.getAllTextContent)(t,!1).trim()},i.writeBooleanTextNode=function(t,e){l(t,e?"1":"0")},i.writeCDATASection=function(t,e){t.appendChild((0,r.getDocument)().createCDATASection(e))},i.writeDateTimeTextNode=function(t,e){var i=new Date(1e3*e),n=i.getUTCFullYear()+"-"+(0,o.padNumber)(i.getUTCMonth()+1,2)+"-"+(0,o.padNumber)(i.getUTCDate(),2)+"T"+(0,o.padNumber)(i.getUTCHours(),2)+":"+(0,o.padNumber)(i.getUTCMinutes(),2)+":"+(0,o.padNumber)(i.getUTCSeconds(),2)+"Z";t.appendChild((0,r.getDocument)().createTextNode(n))},i.writeDecimalTextNode=function(t,e){var i=e.toPrecision();t.appendChild((0,r.getDocument)().createTextNode(i))},i.writeNonNegativeIntegerTextNode=function(t,e){var i=e.toString();t.appendChild((0,r.getDocument)().createTextNode(i))},i.writeStringTextNode=l;var r=t("../xml.js"),o=t("../string.js");function n(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);return e?void 0!==e[1]||!1:void 0}function s(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return e?parseFloat(e[1]):void 0}function a(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function l(t,e){t.appendChild((0,r.getDocument)().createTextNode(e))}},{"../string.js":287,"../xml.js":322}],125:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.TRUE=function(){return!0},i.FALSE=function(){return!1},i.VOID=function(){},i.memoizeOne=function(e){var i,n,r,o=!1;return function(){var t=Array.prototype.slice.call(arguments);return o&&this===r&&(0,s.equals)(t,n)||(o=!0,r=this,n=t,i=e.apply(this,arguments)),i}};var s=t("./array.js")},{"./array.js":44}],126:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"Circle",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"Geometry",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"GeometryCollection",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"LinearRing",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"LineString",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"MultiLineString",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"MultiPoint",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"MultiPolygon",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"Polygon",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"SimpleGeometry",{enumerable:!0,get:function(){return p.default}});var n=f(t("./geom/Circle.js")),r=f(t("./geom/Geometry.js")),o=f(t("./geom/GeometryCollection.js")),s=f(t("./geom/LinearRing.js")),a=f(t("./geom/LineString.js")),l=f(t("./geom/MultiLineString.js")),u=f(t("./geom/MultiPoint.js")),h=f(t("./geom/MultiPolygon.js")),c=f(t("./geom/Point.js")),d=f(t("./geom/Polygon.js")),p=f(t("./geom/SimpleGeometry.js"));function f(t){return t&&t.__esModule?t:{default:t}}},{"./geom/Circle.js":127,"./geom/Geometry.js":128,"./geom/GeometryCollection.js":129,"./geom/LineString.js":132,"./geom/LinearRing.js":133,"./geom/MultiLineString.js":134,"./geom/MultiPoint.js":135,"./geom/MultiPolygon.js":136,"./geom/Point.js":137,"./geom/Polygon.js":138,"./geom/SimpleGeometry.js":139}],127:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("./GeometryType.js")),r=l(t("./SimpleGeometry.js")),o=t("../extent.js"),a=t("./flat/deflate.js"),s=t("./flat/transform.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=r.default,c(p,u),p.prototype.clone=function(){return new p(this.flatCoordinates.slice(),void 0,this.layout)},p.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=t-r[0],s=e-r[1],a=o*o+s*s;if(a<n){if(0==a)for(var l=0;l<this.stride;++l)i[l]=r[l];else{var u=this.getRadius()/Math.sqrt(a);for(i[0]=r[0]+u*o,i[1]=r[1]+u*s,l=2;l<this.stride;++l)i[l]=r[l]}return i.length=this.stride,a}return n},p.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()},p.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},p.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return(0,o.createOrUpdate)(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},p.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},p.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},p.prototype.getType=function(){return n.default.CIRCLE},p.prototype.intersectsExtent=function(t){var e=this.getExtent();if((0,o.intersects)(t,e)){var i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||t[1]<=i[1]&&t[3]>=i[1]||(0,o.forEachCorner)(t,this.intersectsCoordinate.bind(this))}return!1},p.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var r=1;r<e;++r)n[e+r]=t[r];this.setFlatCoordinates(this.layout,n),this.changed()},p.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,r=(0,a.deflateCoordinate)(n,0,t,this.stride);n[r++]=n[0]+e;for(var o=1,s=this.stride;o<s;++o)n[r++]=n[o];n.length=r,this.changed()},p.prototype.getCoordinates=function(){return null},p.prototype.setCoordinates=function(t,e){},p.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},p.prototype.rotate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter((0,s.rotate)(i,0,i.length,n,t,e,i)),this.changed()},p.prototype.translate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter((0,s.translate)(i,0,i.length,n,t,e,i)),this.changed()},p);function p(t,e,i){var n,r=u.call(this)||this;return void 0!==i&&void 0===e?r.setFlatCoordinates(i,t):(n=e||0,r.setCenterAndRadius(t,n,i)),r}d.prototype.transform,i.default=d},{"../extent.js":70,"./GeometryType.js":131,"./SimpleGeometry.js":139,"./flat/deflate.js":144,"./flat/transform.js":158}],128:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("../Object.js")),r=a(t("../proj/Units.js")),o=t("../util.js"),l=t("../transform.js"),u=t("../extent.js"),h=t("../proj.js"),s=t("../functions.js"),c=t("./flat/transform.js");function a(t){return t&&t.__esModule?t:{default:t}}var d,p,f=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),g=(0,l.create)(),m=(d=n.default,f(y,d),y.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},y.prototype.clone=function(){return(0,o.abstract)()},y.prototype.closestPointXY=function(t,e,i,n){return(0,o.abstract)()},y.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e},y.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},y.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},y.prototype.computeExtent=function(t){return(0,o.abstract)()},y.prototype.getExtent=function(t){var e;return this.extentRevision_!=this.getRevision()&&(e=this.computeExtent(this.extent_),(isNaN(e[0])||isNaN(e[1]))&&(0,u.createOrUpdateEmpty)(e),this.extentRevision_=this.getRevision()),(0,u.returnOrUpdate)(this.extent_,t)},y.prototype.rotate=function(t,e){(0,o.abstract)()},y.prototype.scale=function(t,e,i){(0,o.abstract)()},y.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},y.prototype.getSimplifiedGeometry=function(t){return(0,o.abstract)()},y.prototype.getType=function(){return(0,o.abstract)()},y.prototype.applyTransform=function(t){(0,o.abstract)()},y.prototype.intersectsExtent=function(t){return(0,o.abstract)()},y.prototype.translate=function(t,e){(0,o.abstract)()},y.prototype.transform=function(t,s){var a=(0,h.get)(t),e=a.getUnits()==r.default.TILE_PIXELS?function(t,e,i){var n=a.getExtent(),r=a.getWorldExtent(),o=(0,u.getHeight)(r)/(0,u.getHeight)(n);return(0,l.compose)(g,r[0],r[3],o,-o,0,0,0),(0,c.transform2D)(t,0,t.length,i,g,e),(0,h.getTransform)(a,s)(t,e,i)}:(0,h.getTransform)(a,s);return this.applyTransform(e),this},y);function y(){var t=d.call(this)||this;return t.extent_=(0,u.createEmpty)(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(0,s.memoizeOne)(function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}),t}i.default=m},{"../Object.js":28,"../extent.js":70,"../functions.js":125,"../proj.js":205,"../proj/Units.js":207,"../transform.js":311,"../util.js":313,"./flat/transform.js":158}],129:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("../events/EventType.js")),r=l(t("./Geometry.js")),o=l(t("./GeometryType.js")),a=t("../extent.js"),s=t("../events.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=r.default,c(p,u),p.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(s.unlistenByKey),this.changeEventsKeys_.length=0},p.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push((0,s.listen)(this.geometries_[t],n.default.CHANGE,this.changed,this))},p.prototype.clone=function(){var t=new p(null);return t.setGeometries(this.geometries_),t},p.prototype.closestPointXY=function(t,e,i,n){if(n<(0,a.closestSquaredDistanceXY)(this.getExtent(),t,e))return n;for(var r=this.geometries_,o=0,s=r.length;o<s;++o)n=r[o].closestPointXY(t,e,i,n);return n},p.prototype.containsXY=function(t,e){for(var i=this.geometries_,n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1},p.prototype.computeExtent=function(t){(0,a.createOrUpdateEmpty)(t);for(var e=this.geometries_,i=0,n=e.length;i<n;++i)(0,a.extend)(t,e[i].getExtent());return t},p.prototype.getGeometries=function(){return f(this.geometries_)},p.prototype.getGeometriesArray=function(){return this.geometries_},p.prototype.getGeometriesArrayRecursive=function(){for(var t=[],e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t},p.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],i=this.geometries_,n=!1,r=0,o=i.length;r<o;++r){var s=i[r],a=s.getSimplifiedGeometry(t);e.push(a),a!==s&&(n=!0)}if(n){var l=new p(null);return l.setGeometriesArray(e),l}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},p.prototype.getType=function(){return o.default.GEOMETRY_COLLECTION},p.prototype.intersectsExtent=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1},p.prototype.isEmpty=function(){return 0===this.geometries_.length},p.prototype.rotate=function(t,e){for(var i=this.geometries_,n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()},p.prototype.scale=function(t,e,i){for(var n=(n=i)||(0,a.getCenter)(this.getExtent()),r=this.geometries_,o=0,s=r.length;o<s;++o)r[o].scale(t,e,n);this.changed()},p.prototype.setGeometries=function(t){this.setGeometriesArray(f(t))},p.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},p.prototype.applyTransform=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()},p.prototype.translate=function(t,e){for(var i=this.geometries_,n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()},p.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),u.prototype.disposeInternal.call(this)},p);function p(t){var e=u.call(this)||this;return e.geometries_=t||null,e.changeEventsKeys_=[],e.listenGeometriesChange_(),e}function f(t){for(var e=[],i=0,n=t.length;i<n;++i)e.push(t[i].clone());return e}i.default=d},{"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"./Geometry.js":128,"./GeometryType.js":131}],130:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"}},{}],131:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"}},{}],132:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=m(t("./GeometryLayout.js")),r=m(t("./GeometryType.js")),o=m(t("./SimpleGeometry.js")),s=t("./flat/closest.js"),a=t("../extent.js"),l=t("./flat/deflate.js"),u=t("./flat/simplify.js"),h=t("../array.js"),c=t("./flat/segments.js"),d=t("./flat/inflate.js"),p=t("./flat/interpolate.js"),f=t("./flat/intersectsextent.js"),g=t("./flat/length.js");function m(t){return t&&t.__esModule?t:{default:t}}var y,_,v=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),b=(y=o.default,v(j,y),j.prototype.appendCoordinate=function(t){this.flatCoordinates?(0,h.extend)(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},j.prototype.clone=function(){return new j(this.flatCoordinates.slice(),this.layout)},j.prototype.closestPointXY=function(t,e,i,n){return n<(0,a.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,s.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,s.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},j.prototype.forEachSegment=function(t){return(0,c.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},j.prototype.getCoordinateAtM=function(t,e){if(this.layout!=n.default.XYM&&this.layout!=n.default.XYZM)return null;var i=void 0!==e&&e;return(0,p.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},j.prototype.getCoordinates=function(){return(0,d.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},j.prototype.getCoordinateAt=function(t,e){return(0,p.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)},j.prototype.getLength=function(){return(0,g.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},j.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},j.prototype.getSimplifiedGeometryInternal=function(t){var e=[];return e.length=(0,u.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new j(e,n.default.XY)},j.prototype.getType=function(){return r.default.LINE_STRING},j.prototype.intersectsExtent=function(t){return(0,f.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},j.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,l.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()},j);function j(t,e){var i=y.call(this)||this;return i.flatMidpoint_=null,i.flatMidpointRevision_=-1,i.maxDelta_=-1,i.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?i.setCoordinates(t,e):i.setFlatCoordinates(e,t),i}i.default=b},{"../array.js":44,"../extent.js":70,"./GeometryLayout.js":130,"./GeometryType.js":131,"./SimpleGeometry.js":139,"./flat/closest.js":142,"./flat/deflate.js":144,"./flat/inflate.js":147,"./flat/interpolate.js":149,"./flat/intersectsextent.js":150,"./flat/length.js":151,"./flat/segments.js":154,"./flat/simplify.js":155}],133:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=d(t("./GeometryLayout.js")),r=d(t("./GeometryType.js")),o=d(t("./SimpleGeometry.js")),s=t("./flat/closest.js"),a=t("../extent.js"),l=t("./flat/deflate.js"),u=t("./flat/simplify.js"),h=t("./flat/inflate.js"),c=t("./flat/area.js");function d(t){return t&&t.__esModule?t:{default:t}}var p,f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m=(p=o.default,g(y,p),y.prototype.clone=function(){return new y(this.flatCoordinates.slice(),this.layout)},y.prototype.closestPointXY=function(t,e,i,n){return n<(0,a.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,s.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,s.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},y.prototype.getArea=function(){return(0,c.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},y.prototype.getCoordinates=function(){return(0,h.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},y.prototype.getSimplifiedGeometryInternal=function(t){var e=[];return e.length=(0,u.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new y(e,n.default.XY)},y.prototype.getType=function(){return r.default.LINEAR_RING},y.prototype.intersectsExtent=function(t){return!1},y.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,l.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()},y);function y(t,e){var i=p.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?i.setCoordinates(t,e):i.setFlatCoordinates(e,t),i}i.default=m},{"../extent.js":70,"./GeometryLayout.js":130,"./GeometryType.js":131,"./SimpleGeometry.js":139,"./flat/area.js":140,"./flat/closest.js":142,"./flat/deflate.js":144,"./flat/inflate.js":147,"./flat/simplify.js":155}],134:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=g(t("./GeometryLayout.js")),n=g(t("./GeometryType.js")),u=g(t("./LineString.js")),r=g(t("./SimpleGeometry.js")),s=t("./flat/closest.js"),a=t("../extent.js"),l=t("./flat/deflate.js"),h=t("./flat/simplify.js"),c=t("../array.js"),d=t("./flat/inflate.js"),p=t("./flat/interpolate.js"),f=t("./flat/intersectsextent.js");function g(t){return t&&t.__esModule?t:{default:t}}var m,y,_=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v=(m=r.default,_(b,m),b.prototype.appendLineString=function(t){this.flatCoordinates?(0,c.extend)(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},b.prototype.closestPointXY=function(t,e,i,n){return n<(0,a.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,s.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,s.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},b.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=o.default.XYM&&this.layout!=o.default.XYZM||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,r=void 0!==i&&i;return(0,p.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,t,n,r)},b.prototype.getCoordinates=function(){return(0,d.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)},b.prototype.getEnds=function(){return this.ends_},b.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new u.default(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},b.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],r=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new u.default(t.slice(r,a),i);n.push(l),r=a}return n},b.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,r=this.stride,o=0,s=n.length;o<s;++o){var a=n[o],l=(0,p.interpolatePoint)(e,i,a,r,.5);(0,c.extend)(t,l),i=a}return t},b.prototype.getSimplifiedGeometryInternal=function(t){var e=[],i=[];return e.length=(0,h.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new b(e,o.default.XY,i)},b.prototype.getType=function(){return n.default.MULTI_LINE_STRING},b.prototype.intersectsExtent=function(t){return(0,f.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,t)},b.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,l.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},b);function b(t,e,i){var n=m.call(this)||this;if(n.ends_=[],n.maxDelta_=-1,n.maxDeltaRevision_=-1,Array.isArray(t[0]))n.setCoordinates(t,e);else if(void 0!==e&&i)n.setFlatCoordinates(e,t),n.ends_=i;else{for(var r=n.getLayout(),o=t,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout()),(0,c.extend)(s,h.getFlatCoordinates()),a.push(s.length)}n.setFlatCoordinates(r,s),n.ends_=a}return n}i.default=v},{"../array.js":44,"../extent.js":70,"./GeometryLayout.js":130,"./GeometryType.js":131,"./LineString.js":132,"./SimpleGeometry.js":139,"./flat/closest.js":142,"./flat/deflate.js":144,"./flat/inflate.js":147,"./flat/interpolate.js":149,"./flat/intersectsextent.js":150,"./flat/simplify.js":155}],135:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=u(t("./GeometryType.js")),a=u(t("./Point.js")),r=u(t("./SimpleGeometry.js")),h=t("../extent.js"),o=t("./flat/deflate.js"),s=t("../array.js"),l=t("./flat/inflate.js"),c=t("../math.js");function u(t){return t&&t.__esModule?t:{default:t}}var d,p,f=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),g=(d=r.default,f(m,d),m.prototype.appendPoint=function(t){this.flatCoordinates?(0,s.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},m.prototype.clone=function(){return new m(this.flatCoordinates.slice(),this.layout)},m.prototype.closestPointXY=function(t,e,i,n){if(n<(0,h.closestSquaredDistanceXY)(this.getExtent(),t,e))return n;for(var r=this.flatCoordinates,o=this.stride,s=0,a=r.length;s<a;s+=o){var l=(0,c.squaredDistance)(t,e,r[s],r[s+1]);if(l<n){n=l;for(var u=0;u<o;++u)i[u]=r[s+u];i.length=o}}return n},m.prototype.getCoordinates=function(){return(0,l.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new a.default(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},m.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],r=0,o=t.length;r<o;r+=i){var s=new a.default(t.slice(r,r+i),e);n.push(s)}return n},m.prototype.getType=function(){return n.default.MULTI_POINT},m.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,r=e.length;n<r;n+=i){var o=e[n],s=e[n+1];if((0,h.containsXY)(t,o,s))return!0}return!1},m.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,o.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()},m);function m(t,e){var i=d.call(this)||this;return e&&!Array.isArray(t[0])?i.setFlatCoordinates(e,t):i.setCoordinates(t,e),i}i.default=g},{"../array.js":44,"../extent.js":70,"../math.js":201,"./GeometryType.js":131,"./Point.js":137,"./SimpleGeometry.js":139,"./flat/deflate.js":144,"./flat/inflate.js":147}],136:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=b(t("./GeometryLayout.js")),r=b(t("./GeometryType.js")),o=b(t("./MultiPoint.js")),d=b(t("./Polygon.js")),s=b(t("./SimpleGeometry.js")),a=t("./flat/closest.js"),l=t("../extent.js"),u=t("./flat/deflate.js"),g=t("../array.js"),h=t("./flat/interiorpoint.js"),c=t("./flat/inflate.js"),p=t("./flat/intersectsextent.js"),f=t("./flat/orient.js"),m=t("./flat/area.js"),y=t("./flat/center.js"),_=t("./flat/contains.js"),v=t("./flat/simplify.js");function b(t){return t&&t.__esModule?t:{default:t}}var j,x,S=(x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),w=(j=s.default,S(P,j),P.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;(0,g.extend)(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,r=(e=t.getEnds().slice()).length;n<r;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},P.prototype.clone=function(){for(var t=this.endss_.length,e=new Array(t),i=0;i<t;++i)e[i]=this.endss_[i].slice();return new P(this.flatCoordinates.slice(),this.layout,e)},P.prototype.closestPointXY=function(t,e,i,n){return n<(0,l.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,a.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,a.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},P.prototype.containsXY=function(t,e){return(0,_.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},P.prototype.getArea=function(){return(0,m.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},P.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,f.orientLinearRingsArray)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,c.inflateMultiCoordinatesArray)(e,0,this.endss_,this.stride)},P.prototype.getEndss=function(){return this.endss_},P.prototype.getFlatInteriorPoints=function(){var t;return this.flatInteriorPointsRevision_!=this.getRevision()&&(t=(0,y.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride),this.flatInteriorPoints_=(0,h.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()),this.flatInteriorPoints_},P.prototype.getInteriorPoints=function(){return new o.default(this.getFlatInteriorPoints().slice(),n.default.XYM)},P.prototype.getOrientedFlatCoordinates=function(){var t;return this.orientedRevision_!=this.getRevision()&&(t=this.flatCoordinates,(0,f.linearRingssAreOriented)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,f.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_},P.prototype.getSimplifiedGeometryInternal=function(t){var e=[],i=[];return e.length=(0,v.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new P(e,n.default.XY,i)},P.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e,i;i=0===t?0:(e=this.endss_[t-1])[e.length-1];var n=this.endss_[t].slice(),r=n[n.length-1];if(0!==i)for(var o=0,s=n.length;o<s;++o)n[o]-=i;return new d.default(this.flatCoordinates.slice(i,r),this.layout,n)},P.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o].slice(),l=a[a.length-1];if(0!==r)for(var u=0,h=a.length;u<h;++u)a[u]-=r;var c=new d.default(e.slice(r,l),t,a);n.push(c),r=l}return n},P.prototype.getType=function(){return r.default.MULTI_POLYGON},P.prototype.intersectsExtent=function(t){return(0,p.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},P.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i,n=(0,u.deflateMultiCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.endss_);0===n.length?this.flatCoordinates.length=0:(i=n[n.length-1],this.flatCoordinates.length=0===i.length?0:i[i.length-1]),this.changed()},P);function P(t,e,i){var n=j.call(this)||this;if(n.endss_=[],n.flatInteriorPointsRevision_=-1,n.flatInteriorPoints_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){for(var r=n.getLayout(),o=t,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout());for(var c=s.length,d=h.getEnds(),p=0,f=d.length;p<f;++p)d[p]+=c;(0,g.extend)(s,h.getFlatCoordinates()),a.push(d)}e=r,t=s,i=a}return void 0!==e&&i?(n.setFlatCoordinates(e,t),n.endss_=i):n.setCoordinates(t,e),n}i.default=w},{"../array.js":44,"../extent.js":70,"./GeometryLayout.js":130,"./GeometryType.js":131,"./MultiPoint.js":135,"./Polygon.js":138,"./SimpleGeometry.js":139,"./flat/area.js":140,"./flat/center.js":141,"./flat/closest.js":142,"./flat/contains.js":143,"./flat/deflate.js":144,"./flat/inflate.js":147,"./flat/interiorpoint.js":148,"./flat/intersectsextent.js":150,"./flat/orient.js":152,"./flat/simplify.js":155}],137:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("./GeometryType.js")),r=a(t("./SimpleGeometry.js")),o=t("../extent.js"),s=t("./flat/deflate.js"),l=t("../math.js");function a(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=r.default,c(p,u),p.prototype.clone=function(){return new p(this.flatCoordinates.slice(),this.layout)},p.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=(0,l.squaredDistance)(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)i[a]=r[a];return i.length=s,o}return n},p.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},p.prototype.computeExtent=function(t){return(0,o.createOrUpdateFromCoordinate)(this.flatCoordinates,t)},p.prototype.getType=function(){return n.default.POINT},p.prototype.intersectsExtent=function(t){return(0,o.containsXY)(t,this.flatCoordinates[0],this.flatCoordinates[1])},p.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,s.deflateCoordinate)(this.flatCoordinates,0,t,this.stride),this.changed()},p);function p(t,e){var i=u.call(this)||this;return i.setCoordinates(t,e),i}i.default=d},{"../extent.js":70,"../math.js":201,"./GeometryType.js":131,"./SimpleGeometry.js":139,"./flat/deflate.js":144}],138:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.circular=function(t,e,i,n){for(var r=i||32,o=[],s=0;s<r;++s)(0,c.extend)(o,(0,b.offset)(t,e,2*Math.PI*s/r,n));return o.push(o[0],o[1]),new P(o,a.default.XY,[o.length])},i.fromExtent=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=[e,i,e,r,n,r,n,i,e,i];return new P(o,a.default.XY,[o.length])},i.fromCircle=function(t,e,i){for(var n=e||32,r=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=r*(n+1),l=new Array(a),u=0;u<a;u+=r){l[u]=0,l[u+1]=0;for(var h=2;h<r;h++)l[u+h]=s[h]}var c=[l.length],d=new P(l,o,c);return T(d,s,t.getRadius(),i),d},i.makeRegular=T,i.default=void 0;var a=j(t("./GeometryLayout.js")),n=j(t("./GeometryType.js")),u=j(t("./LinearRing.js")),r=j(t("./Point.js")),o=j(t("./SimpleGeometry.js")),s=t("./flat/closest.js"),l=t("../extent.js"),h=t("./flat/deflate.js"),c=t("../array.js"),d=t("./flat/interiorpoint.js"),p=t("./flat/inflate.js"),f=t("./flat/intersectsextent.js"),g=t("./flat/orient.js"),m=t("./flat/area.js"),y=t("./flat/contains.js"),_=t("../math.js"),v=t("./flat/simplify.js"),b=t("../sphere.js");function j(t){return t&&t.__esModule?t:{default:t}}var x,S,w=(S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),P=(x=o.default,w(E,x),E.prototype.appendLinearRing=function(t){this.flatCoordinates?(0,c.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},E.prototype.clone=function(){return new E(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},E.prototype.closestPointXY=function(t,e,i,n){return n<(0,l.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,s.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,s.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},E.prototype.containsXY=function(t,e){return(0,y.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},E.prototype.getArea=function(){return(0,m.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},E.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,g.orientLinearRings)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,(0,p.inflateCoordinatesArray)(e,0,this.ends_,this.stride)},E.prototype.getEnds=function(){return this.ends_},E.prototype.getFlatInteriorPoint=function(){var t;return this.flatInteriorPointRevision_!=this.getRevision()&&(t=(0,l.getCenter)(this.getExtent()),this.flatInteriorPoint_=(0,d.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()),this.flatInteriorPoint_},E.prototype.getInteriorPoint=function(){return new r.default(this.getFlatInteriorPoint(),a.default.XYM)},E.prototype.getLinearRingCount=function(){return this.ends_.length},E.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new u.default(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},E.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],l=new u.default(e.slice(r,a),t);n.push(l),r=a}return n},E.prototype.getOrientedFlatCoordinates=function(){var t;return this.orientedRevision_!=this.getRevision()&&(t=this.flatCoordinates,(0,g.linearRingsAreOriented)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,g.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_},E.prototype.getSimplifiedGeometryInternal=function(t){var e=[],i=[];return e.length=(0,v.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new E(e,a.default.XY,i)},E.prototype.getType=function(){return n.default.POLYGON},E.prototype.intersectsExtent=function(t){return(0,f.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},E.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,h.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},E);function E(t,e,i){var n=x.call(this)||this;return n.ends_=[],n.flatInteriorPointRevision_=-1,n.flatInteriorPoint_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,void 0!==e&&i?(n.setFlatCoordinates(e,t),n.ends_=i):n.setCoordinates(t,e),n}function T(t,e,i,n){for(var r=t.getFlatCoordinates(),o=t.getStride(),s=r.length/o-1,a=n||0,l=0;l<=s;++l){var u=l*o,h=a+2*(0,_.modulo)(l,s)*Math.PI/s;r[u]=e[0]+i*Math.cos(h),r[1+u]=e[1]+i*Math.sin(h)}t.changed()}i.default=P},{"../array.js":44,"../extent.js":70,"../math.js":201,"../sphere.js":286,"./GeometryLayout.js":130,"./GeometryType.js":131,"./LinearRing.js":133,"./Point.js":137,"./SimpleGeometry.js":139,"./flat/area.js":140,"./flat/closest.js":142,"./flat/contains.js":143,"./flat/deflate.js":144,"./flat/inflate.js":147,"./flat/interiorpoint.js":148,"./flat/intersectsextent.js":150,"./flat/orient.js":152,"./flat/simplify.js":155}],139:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getStrideForLayout=f,i.transformGeom2D=function(t,e,i){var n=t.getFlatCoordinates();if(n){var r=t.getStride();return(0,u.transform2D)(n,0,n.length,r,e,i)}return null},i.default=void 0;var n=o(t("./Geometry.js")),a=o(t("./GeometryLayout.js")),r=t("../util.js"),l=t("../extent.js"),u=t("./flat/transform.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(s=n.default,c(p,s),p.prototype.computeExtent=function(t){return(0,l.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},p.prototype.getCoordinates=function(){return(0,r.abstract)()},p.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},p.prototype.getFlatCoordinates=function(){return this.flatCoordinates},p.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},p.prototype.getLayout=function(){return this.layout},p.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},p.prototype.getSimplifiedGeometryInternal=function(t){return this},p.prototype.getStride=function(){return this.stride},p.prototype.setFlatCoordinates=function(t,e){this.stride=f(t),this.layout=t,this.flatCoordinates=e},p.prototype.setCoordinates=function(t,e){(0,r.abstract)()},p.prototype.setLayout=function(t,e,i){var n,r,o;if(t)n=f(t);else{for(var s=0;s<i;++s){if(0===e.length)return this.layout=a.default.XY,void(this.stride=2);e=e[0]}2==(r=n=e.length)?o=a.default.XY:3==r?o=a.default.XYZ:4==r&&(o=a.default.XYZM),t=o}this.layout=t,this.stride=n},p.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},p.prototype.rotate=function(t,e){var i,n=this.getFlatCoordinates();n&&(i=this.getStride(),(0,u.rotate)(n,0,n.length,i,t,e,n),this.changed())},p.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r,o=(o=i)||(0,l.getCenter)(this.getExtent()),s=this.getFlatCoordinates();s&&(r=this.getStride(),(0,u.scale)(s,0,s.length,r,t,n,o,s),this.changed())},p.prototype.translate=function(t,e){var i,n=this.getFlatCoordinates();n&&(i=this.getStride(),(0,u.translate)(n,0,n.length,i,t,e,n),this.changed())},p);function p(){var t=s.call(this)||this;return t.layout=a.default.XY,t.stride=2,t.flatCoordinates=null,t}function f(t){var e;return t==a.default.XY?e=2:t==a.default.XYZ||t==a.default.XYM?e=3:t==a.default.XYZM&&(e=4),e}i.default=d},{"../extent.js":70,"../util.js":313,"./Geometry.js":128,"./GeometryLayout.js":130,"./flat/transform.js":158}],140:[function(t,e,i){"use strict";function l(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=s*a-o*l,o=a,s=l}return r/2}function u(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=l(t,e,a,n),e=a}return r}Object.defineProperty(i,"__esModule",{value:!0}),i.linearRing=l,i.linearRings=u,i.linearRingss=function(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=u(t,e,a,n),e=a[a.length-1]}return r}},{}],141:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.linearRingss=function(t,e,i,n){for(var r=[],o=(0,u.createEmpty)(),s=0,a=i.length;s<a;++s){var l=i[s];o=(0,u.createOrUpdateFromFlatCoordinates)(t,e,l[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return r};var u=t("../../extent.js")},{"../../extent.js":70}],142:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.maxSquaredDelta=l,i.arrayMaxSquaredDelta=u,i.multiArrayMaxSquaredDelta=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=u(t,e,a,n,r),e=a[a.length-1]}return r},i.assignClosestPoint=y,i.assignClosestArrayPoint=_,i.assignClosestMultiArrayPoint=function(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];u=_(t,e,f,n,r,o,s,a,l,u,c),e=f[f.length-1]}return u};var g=t("../../math.js");function m(t,e,i,n,r,o,s){var a,l=t[e],u=t[e+1],h=t[i]-l,c=t[i+1]-u;if(0==h&&0==c)a=e;else{var d=((r-l)*h+(o-u)*c)/(h*h+c*c);if(1<d)a=i;else{if(0<d){for(var p=0;p<n;++p)s[p]=(0,g.lerp)(t[e+p],t[i+p],d);return s.length=n,0}a=e}}for(p=0;p<n;++p)s[p]=t[a+p];s.length=n}function l(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],l=t[e+1],u=(0,g.squaredDistance)(o,s,a,l);r<u&&(r=u),o=a,s=l}return r}function u(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=l(t,e,a,n,r),e=a}return r}function y(t,e,i,n,r,o,s,a,l,u,h){if(e==i)return u;var c,d;if(0===r){if((d=(0,g.squaredDistance)(s,a,t[e],t[e+1]))<u){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,d}return u}for(var p=h||[NaN,NaN],f=e+n;f<i;)if(m(t,f-n,f,n,s,a,p),(d=(0,g.squaredDistance)(s,a,p[0],p[1]))<u){for(u=d,c=0;c<n;++c)l[c]=p[c];f+=l.length=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(m(t,i-n,e,n,s,a,p),(d=(0,g.squaredDistance)(s,a,p[0],p[1]))<u)){for(u=d,c=0;c<n;++c)l[c]=p[c];l.length=n}return u}function _(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];u=y(t,e,f,n,r,o,s,a,l,u,c),e=f}return u}},{"../../math.js":201}],143:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.linearRingContainsExtent=function(e,i,n,r,t){return!(0,o.forEachCorner)(t,function(t){return!l(e,i,n,r,t[0],t[1])})},i.linearRingContainsXY=l,i.linearRingsContainsXY=u,i.linearRingssContainsXY=function(t,e,i,n,r,o){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var l=i[s];if(u(t,e,l,n,r,o))return!0;e=l[l.length-1]}return!1};var o=t("../../extent.js");function l(t,e,i,n,r,o){for(var s=0,a=t[i-n],l=t[i-n+1];e<i;e+=n){var u=t[e],h=t[e+1];l<=o?o<h&&0<(u-a)*(o-l)-(r-a)*(h-l)&&s++:h<=o&&(u-a)*(o-l)-(r-a)*(h-l)<0&&s--,a=u,l=h}return 0!==s}function u(t,e,i,n,r,o){if(0===i.length)return!1;if(!l(t,e,i[0],n,r,o))return!1;for(var s=1,a=i.length;s<a;++s)if(l(t,i[s-1],i[s],n,r,o))return!1;return!0}},{"../../extent.js":70}],144:[function(t,e,i){"use strict";function h(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function c(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=h(t,e,i[a],n);e=o[s++]=u}return o.length=s,o}Object.defineProperty(i,"__esModule",{value:!0}),i.deflateCoordinate=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e},i.deflateCoordinates=h,i.deflateCoordinatesArray=c,i.deflateMultiCoordinatesArray=function(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=c(t,e,i[a],n,o[s]);e=(o[s++]=u)[u.length-1]}return o.length=s,o}},{}],145:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.flipXY=function(t,e,i,n,r,o){for(var s,a=void 0!==r?(s=r,void 0!==o?o:0):(s=[],0),l=e;l<i;){var u=t[l++];s[a++]=t[l++],s[a++]=u;for(var h=2;h<n;++h)s[a++]=t[l++]}return s.length=a,s}},{}],146:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.greatCircleArc=function(u,t,h,c,e,i){var n=(0,s.get)("EPSG:4326"),d=Math.cos((0,v.toRadians)(t)),p=Math.sin((0,v.toRadians)(t)),f=Math.cos((0,v.toRadians)(c)),g=Math.sin((0,v.toRadians)(c)),m=Math.cos((0,v.toRadians)(h-u)),y=Math.sin((0,v.toRadians)(h-u)),_=p*g+d*f*m;return a(function(t){if(1<=_)return[h,c];var e=t*Math.acos(_),i=Math.cos(e),n=Math.sin(e),r=y*f,o=d*g-p*f*m,s=Math.atan2(r,o),a=Math.asin(p*i+d*n*Math.cos(s)),l=(0,v.toRadians)(u)+Math.atan2(Math.sin(s)*n*d,i-p*Math.sin(a));return[(0,v.toDegrees)(l),(0,v.toDegrees)(a)]},(0,s.getTransform)(n,e),i)},i.meridian=function(e,i,n,t,r){var o=(0,s.get)("EPSG:4326");return a(function(t){return[e,i+(n-i)*t]},(0,s.getTransform)(o,t),r)},i.parallel=function(e,i,n,t,r){var o=(0,s.get)("EPSG:4326");return a(function(t){return[i+(n-i)*t,e]},(0,s.getTransform)(o,t),r)};var s=t("../../proj.js"),v=t("../../math.js");function a(t,e,i){for(var n,r,o,s,a,l,u=[],h=t(0),c=t(1),d=e(h),p=e(c),f=[c,h],g=[p,d],m=[1,0],y={},_=1e5;0<--_&&0<m.length;)o=m.pop(),h=f.pop(),d=g.pop(),(l=o.toString())in y||(u.push(d[0],d[1]),y[l]=!0),s=m.pop(),c=f.pop(),p=g.pop(),r=e(n=t(a=(o+s)/2)),(0,v.squaredSegmentDistance)(r[0],r[1],d[0],d[1],p[0],p[1])<i?(u.push(p[0],p[1]),y[l=s.toString()]=!0):(m.push(s,a,a,o),g.push(p,r,r,d),f.push(c,n,n,h));return u}},{"../../math.js":201,"../../proj.js":205}],147:[function(t,e,i){"use strict";function h(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function c(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=h(t,e,u,n,o[s]),e=u}return o.length=s,o}Object.defineProperty(i,"__esModule",{value:!0}),i.inflateCoordinates=h,i.inflateCoordinatesArray=c,i.inflateMultiCoordinatesArray=function(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=c(t,e,u,n,o[s]),e=u[u.length-1]}return o.length=s,o}},{}],148:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getInteriorPointOfArray=u,i.getInteriorPointsOfMultiArray=function(t,e,i,n,r){for(var o=[],s=0,a=i.length;s<a;++s){var l=i[s];o=u(t,e,l,n,r,2*s,o),e=l[l.length-1]}return o};var x=t("./contains.js"),S=t("../../array.js");function u(t,e,i,n,r,o,s){for(var a,l,u,h,c=r[o+1],d=[],p=0,f=i.length;p<f;++p)for(var g=i[p],m=t[g-n],y=t[g-n+1],_=e;_<g;_+=n)u=t[_],h=t[_+1],(c<=y&&h<=c||y<=c&&c<=h)&&(l=(c-y)/(h-y)*(u-m)+m,d.push(l)),m=u,y=h;var v=NaN,b=-1/0;for(d.sort(S.numberSafeCompareFunction),m=d[0],_=1,a=d.length;_<a;++_){u=d[_];var j=Math.abs(u-m);b<j&&(l=(m+u)/2,(0,x.linearRingsContainsXY)(t,e,i,n,l,c)&&(v=l,b=j)),m=u}return isNaN(v)&&(v=r[o]),s?(s.push(v,c,b),s):[v,c,b]}},{"../../array.js":44,"./contains.js":143}],149:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.interpolatePoint=function(t,e,i,n,r,o,s){var a,l,u=(i-e)/n;if(1==u)a=e;else if(2==u)a=e,l=r;else if(0!=u){for(var h=t[e],c=t[e+1],d=0,p=[0],f=e+n;f<i;f+=n){var g=t[f],m=t[f+1];d+=Math.sqrt((g-h)*(g-h)+(m-c)*(m-c)),p.push(d),h=g,c=m}var y=r*d,_=(0,j.binarySearch)(p,y);a=_<0?(l=(y-p[-_-2])/(p[-_-1]-p[-_-2]),e+(-_-2)*n):e+_*n}var v=1<s?s:2,b=o||new Array(v);for(f=0;f<v;++f)b[f]=void 0===a?NaN:void 0===l?t[a+f]:(0,x.lerp)(t[a+f],t[a+n+f],l);return b},i.lineStringCoordinateAtM=c,i.lineStringsCoordinateAtM=function(t,e,i,n,r,o,s){if(s)return c(t,e,i[i.length-1],n,r,o);var a;if(r<t[n-1])return o?((a=t.slice(0,n))[n-1]=r,a):null;if(t[t.length-1]<r)return o?((a=t.slice(t.length-n))[n-1]=r,a):null;for(var l=0,u=i.length;l<u;++l){var h=i[l];if(e!=h){if(r<t[e+n-1])return null;if(r<=t[h-1])return c(t,e,h,n,r,!1);e=h}}return null};var j=t("../../array.js"),x=t("../../math.js");function c(t,e,i,n,r,o){if(i==e)return null;if(r<t[e+n-1])return o?((c=t.slice(e,e+n))[n-1]=r,c):null;if(t[i-1]<r)return o?((c=t.slice(i-n,i))[n-1]=r,c):null;if(r==t[e+n-1])return t.slice(e,e+n);for(var s=e/n,a=i/n;s<a;){var l=s+a>>1;r<t[(1+l)*n-1]?a=l:s=1+l}var u=t[s*n-1];if(r==u)return t.slice((s-1)*n,(s-1)*n+n);for(var h=(r-u)/(t[(s+1)*n-1]-u),c=[],d=0;d<n-1;++d)c.push((0,x.lerp)(t[(s-1)*n+d],t[s*n+d],h));return c.push(r),c}},{"../../array.js":44,"../../math.js":201}],150:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.intersectsLineString=u,i.intersectsLineStringArray=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){if(u(t,e,i[o],n,r))return!0;e=i[o]}return!1},i.intersectsLinearRing=h,i.intersectsLinearRingArray=c,i.intersectsLinearRingMultiArray=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(c(t,e,a,n,r))return!0;e=a[a.length-1]}return!1};var s=t("../../extent.js"),a=t("./segments.js"),l=t("./contains.js");function u(t,e,i,n,r){var o=(0,s.extendFlatCoordinates)((0,s.createEmpty)(),t,e,i,n);return!!(0,s.intersects)(r,o)&&(!!(0,s.containsExtent)(r,o)||o[0]>=r[0]&&o[2]<=r[2]||o[1]>=r[1]&&o[3]<=r[3]||(0,a.forEach)(t,e,i,n,function(t,e){return(0,s.intersectsSegment)(r,t,e)}))}function h(t,e,i,n,r){return!!(u(t,e,i,n,r)||(0,l.linearRingContainsXY)(t,e,i,n,r[0],r[1])||(0,l.linearRingContainsXY)(t,e,i,n,r[0],r[3])||(0,l.linearRingContainsXY)(t,e,i,n,r[2],r[1])||(0,l.linearRingContainsXY)(t,e,i,n,r[2],r[3]))}function c(t,e,i,n,r){if(!h(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if((0,l.linearRingContainsExtent)(t,i[o-1],i[o],n,r)&&!u(t,i[o-1],i[o],n,r))return!1;return!0}},{"../../extent.js":70,"./contains.js":143,"./segments.js":154}],151:[function(t,e,i){"use strict";function a(t,e,i,n){for(var r=t[e],o=t[e+1],s=0,a=e+n;a<i;a+=n){var l=t[a],u=t[a+1];s+=Math.sqrt((l-r)*(l-r)+(u-o)*(u-o)),r=l,o=u}return s}Object.defineProperty(i,"__esModule",{value:!0}),i.lineStringLength=a,i.linearRingLength=function(t,e,i,n){var r=a(t,e,i,n),o=t[i-n]-t[e],s=t[i-n+1]-t[e+1];return r+Math.sqrt(o*o+s*s)}},{}],152:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.linearRingIsClockwise=c,i.linearRingsAreOriented=l,i.linearRingssAreOriented=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(!l(t,e,a,n,r))return!1;a.length&&(e=a[a.length-1])}return!0},i.orientLinearRings=a,i.orientLinearRingsArray=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)e=a(t,e,i[o],n,r);return e};var h=t("./reverse.js");function c(t,e,i,n){for(var r=!0,o=0;o<n;++o)if(t[e+o]!==t[i-n+o]){r=!1;break}r&&(i-=n);var s=function(t,e,i,n){for(var r=-1,o=1/0,s=1/0,a=e;a<i;a+=n){var l=t[a],u=t[a+1];o<u||u==o&&s<=l||(r=a,o=u,s=l)}return r}(t,e,i,n),a=s-n;a<e&&(a=i-n);var l=s+n;i<=l&&(l=e);var u=t[a],h=t[a+1],c=t[s],d=t[s+1],p=t[l],f=t[l+1];return c*f+u*d+h*p-(h*c+d*p+u*f)<0}function l(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=c(t,e,l,n);if(0===s){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}function a(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=c(t,e,l,n);(0===s?o&&u||!o&&!u:o&&!u||!o&&u)&&(0,h.coordinates)(t,e,l,n),e=l}return e}},{"./reverse.js":153}],153:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.coordinates=function(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}},{}],154:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.forEach=function(t,e,i,n,r){for(var o,s=[t[e],t[e+1]],a=[];e+n<i;e+=n){if(a[0]=t[e+n],a[1]=t[e+n+1],o=r(s,a))return o;s[0]=a[0],s[1]=a[1]}return!1}},{}],155:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.simplifyLineString=function(t,e,i,n,r,o,s){var a=void 0!==s?s:[];return o||(i=l(t,e,i,n,r,a,0),t=a,e=0,n=2),a.length=c(t,e,i,n,r,a,0),a},i.douglasPeucker=c,i.douglasPeuckerArray=d,i.douglasPeuckerMultiArray=function(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l],c=[];s=d(t,e,h,n,r,o,s,c),a.push(c),e=h[h.length-1]}return s},i.radialDistance=l,i.snap=y,i.quantize=p,i.quantizeArray=f,i.quantizeMultiArray=function(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l],c=[];s=f(t,e,h,n,r,o,s,c),a.push(c),e=h[h.length-1]}return s};var x=t("../../math.js");function c(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var l=new Array(a);l[0]=1,l[a-1]=1;for(var u=[e,i-n],h=0;0<u.length;){for(var c=u.pop(),d=u.pop(),p=0,f=t[d],g=t[d+1],m=t[c],y=t[c+1],_=d+n;_<c;_+=n){var v=t[_],b=t[_+1],j=(0,x.squaredSegmentDistance)(v,b,f,g,m,y);p<j&&(h=_,p=j)}r<p&&(l[(h-e)/n]=1,d+n<h&&u.push(d,h),h+n<c&&u.push(h,c))}for(_=0;_<a;++_)l[_]&&(o[s++]=t[e+_*n],o[s++]=t[e+_*n+1]);return s}function d(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=c(t,e,h,n,r,o,s),a.push(s),e=h}return s}function l(t,e,i,n,r,o,s){if(i<=e+n){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var a=t[e],l=t[e+1],u=o[s++]=a,h=o[s++]=l;for(e+=n;e<i;e+=n)u=t[e],h=t[e+1],(0,x.squaredDistance)(a,l,u,h)>r&&(a=o[s++]=u,l=o[s++]=h);return u==a&&h==l||(o[s++]=u,o[s++]=h),s}function y(t,e){return e*Math.round(t/e)}function p(t,e,i,n,r,o,s){if(e==i)return s;var a,l=y(t[e],r),u=y(t[e+1],r);e+=n,o[s++]=l,o[s++]=u;do{if(a=y(t[e],r),f=y(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=f,s}while(a==l&&f==u);for(;e<i;){var h,c,d,p,f,g=y(t[e],r),m=y(t[e+1],r);e+=n,g==a&&m==f||(a=((h=a-l)*(p=m-u)==(c=f-u)*(d=g-l)&&(h<0&&d<h||h==d||0<h&&h<d)&&(c<0&&p<c||c==p||0<c&&c<p)||(l=o[s++]=a,u=o[s++]=f),g),f=m)}return o[s++]=a,o[s++]=f,s}function f(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=p(t,e,h,n,r,o,s),a.push(s),e=h}return s}},{"../../math.js":201}],156:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.matchingChunk=function(t,e,i,n,r){for(var o,s,a,l,u,h,c,d,p=i,f=i,g=0,m=0,y=i,_=i;_<n;_+=r){var v=e[_],b=e[_+1];void 0!==a&&(c=v-a,d=b-l,s=Math.sqrt(c*c+d*d),void 0!==u&&(m+=o,Math.acos((u*c+h*d)/(o*s))>t&&(g<m&&(g=m,p=y,f=_),m=0,y=_-r)),o=s,u=c,h=d),a=v,l=b}return(m+=s)>g?[y,_]:[p,f]}},{}],157:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.drawTextOnPath=function(t,e,i,n,r,o,s,a,l,u,h,c){var d,p=[];{var f;d=c?(f=(0,F.rotate)(t,e,i,n,c,[t[e],t[e+1]]),f[0]>f[f.length-n]):t[e]>t[i-n]}for(var g,m,y=r.length,_=t[e],v=t[e+1],b=t[e+=n],j=t[e+1],x=0,S=Math.sqrt(Math.pow(b-_,2)+Math.pow(j-v,2)),w=!1,P=0;P<y;++P){for(var E=r[g=d?y-P-1:P],T=a*l(u,E,h),O=o+T/2;e<i-n&&x+S<O;)_=b,v=j,b=t[e+=n],j=t[e+1],x+=S,S=Math.sqrt(Math.pow(b-_,2)+Math.pow(j-v,2));var C=O-x,M=Math.atan2(j-v,b-_);if(d&&(M+=0<M?-Math.PI:Math.PI),void 0!==m){var I=M-m;if(w=w||0!==I,I+=I>Math.PI?-2*Math.PI:I<-Math.PI?2*Math.PI:0,Math.abs(I)>s)return null}m=M;var R=C/S,k=(0,L.lerp)(_,b,R),A=(0,L.lerp)(v,j,R);p[g]=[k,A,T/2,M,E],o+=T}return w?p:[[p[0][0],p[0][1],p[0][2],p[0][3],r]]};var L=t("../../math.js"),F=t("./transform.js")},{"../../math.js":201,"./transform.js":158}],158:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.transform2D=function(t,e,i,n,r,o){for(var s=o||[],a=0,l=e;l<i;l+=n){var u=t[l],h=t[l+1];s[a++]=r[0]*u+r[2]*h+r[4],s[a++]=r[1]*u+r[3]*h+r[5]}return o&&s.length!=a&&(s.length=a),s},i.rotate=function(t,e,i,n,r,o,s){for(var a=s||[],l=Math.cos(r),u=Math.sin(r),h=o[0],c=o[1],d=0,p=e;p<i;p+=n){var f=t[p]-h,g=t[p+1]-c;a[d++]=h+f*l-g*u,a[d++]=c+f*u+g*l;for(var m=p+2;m<p+n;++m)a[d++]=t[m]}return s&&a.length!=d&&(a.length=d),a},i.scale=function(t,e,i,n,r,o,s,a){for(var l=a||[],u=s[0],h=s[1],c=0,d=e;d<i;d+=n){var p=t[d]-u,f=t[d+1]-h;l[c++]=u+r*p,l[c++]=h+o*f;for(var g=d+2;g<d+n;++g)l[c++]=t[g]}return a&&l.length!=c&&(l.length=c),l},i.translate=function(t,e,i,n,r,o,s){for(var a=s||[],l=0,u=e;u<i;u+=n){a[l++]=t[u]+r,a[l++]=t[u+1]+o;for(var h=u+2;h<u+n;++h)a[l++]=t[h]}return s&&a.length!=l&&(a.length=l),a}},{}],159:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PASSIVE_EVENT_LISTENERS=i.IMAGE_DECODE=i.WORKER_OFFSCREEN_CANVAS=i.DEVICE_PIXEL_RATIO=i.MAC=i.WEBKIT=i.SAFARI=i.FIREFOX=void 0;var n="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("firefox");i.FIREFOX=r;var o=-1!==n.indexOf("safari")&&-1==n.indexOf("chrom");i.SAFARI=o;var s=-1!==n.indexOf("webkit")&&-1==n.indexOf("edge");i.WEBKIT=s;var a=-1!==n.indexOf("macintosh");i.MAC=a;var l="undefined"!=typeof devicePixelRatio?devicePixelRatio:1;i.DEVICE_PIXEL_RATIO=l;var u="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope;i.WORKER_OFFSCREEN_CANVAS=u;var h="undefined"!=typeof Image&&Image.prototype.decode;i.IMAGE_DECODE=h;var c=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();i.PASSIVE_EVENT_LISTENERS=c},{}],160:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AssertionError",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"Collection",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"Disposable",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"Feature",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"Geolocation",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"Graticule",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"Image",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"ImageBase",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"ImageCanvas",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"ImageTile",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"Kinetic",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(i,"Map",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(i,"MapBrowserEvent",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(i,"MapBrowserEventHandler",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(i,"MapEvent",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(i,"Object",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(i,"Observable",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(i,"Overlay",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(i,"PluggableMap",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(i,"Tile",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(i,"TileCache",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(i,"TileQueue",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(i,"TileRange",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(i,"VectorRenderTile",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(i,"VectorTile",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(i,"View",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(i,"getUid",{enumerable:!0,get:function(){return C.getUid}}),Object.defineProperty(i,"VERSION",{enumerable:!0,get:function(){return C.VERSION}});var n=M(t("./AssertionError.js")),r=M(t("./Collection.js")),o=M(t("./Disposable.js")),s=M(t("./Feature.js")),a=M(t("./Geolocation.js")),l=M(t("./layer/Graticule.js")),u=M(t("./Image.js")),h=M(t("./ImageBase.js")),c=M(t("./ImageCanvas.js")),d=M(t("./ImageTile.js")),p=M(t("./Kinetic.js")),f=M(t("./Map.js")),g=M(t("./MapBrowserEvent.js")),m=M(t("./MapBrowserEventHandler.js")),y=M(t("./MapEvent.js")),_=M(t("./Object.js")),v=M(t("./Observable.js")),b=M(t("./Overlay.js")),j=M(t("./PluggableMap.js")),x=M(t("./Tile.js")),S=M(t("./TileCache.js")),w=M(t("./TileQueue.js")),P=M(t("./TileRange.js")),E=M(t("./VectorRenderTile.js")),T=M(t("./VectorTile.js")),O=M(t("./View.js")),C=t("./util.js");function M(t){return t&&t.__esModule?t:{default:t}}},{"./AssertionError.js":9,"./Collection.js":10,"./Disposable.js":12,"./Feature.js":13,"./Geolocation.js":14,"./Image.js":15,"./ImageBase.js":16,"./ImageCanvas.js":17,"./ImageTile.js":19,"./Kinetic.js":20,"./Map.js":21,"./MapBrowserEvent.js":22,"./MapBrowserEventHandler.js":23,"./MapEvent.js":25,"./Object.js":28,"./Observable.js":30,"./Overlay.js":31,"./PluggableMap.js":33,"./Tile.js":34,"./TileCache.js":35,"./TileQueue.js":36,"./TileRange.js":37,"./VectorRenderTile.js":39,"./VectorTile.js":40,"./View.js":41,"./layer/Graticule.js":188,"./util.js":313}],161:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.defaults=function(t){var e=t||{},i=new r.default,n=new c.default(-.005,.05,100);return void 0!==e.altShiftDragRotate&&!e.altShiftDragRotate||i.push(new a.default),void 0!==e.doubleClickZoom&&!e.doubleClickZoom||i.push(new o.default({delta:e.zoomDelta,duration:e.zoomDuration})),void 0!==e.dragPan&&!e.dragPan||i.push(new s.default({onFocusOnly:e.onFocusOnly,kinetic:n})),void 0!==e.pinchRotate&&!e.pinchRotate||i.push(new p.default),void 0!==e.pinchZoom&&!e.pinchZoom||i.push(new f.default({duration:e.zoomDuration})),void 0!==e.keyboard&&!e.keyboard||(i.push(new u.default),i.push(new h.default({delta:e.zoomDelta,duration:e.zoomDuration}))),void 0!==e.mouseWheelZoom&&!e.mouseWheelZoom||i.push(new d.default({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),void 0!==e.shiftDragZoom&&!e.shiftDragZoom||i.push(new l.default({duration:e.zoomDuration})),i},Object.defineProperty(i,"DoubleClickZoom",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"DragPan",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"DragRotate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"DragZoom",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"KeyboardPan",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"KeyboardZoom",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"MouseWheelZoom",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"PinchRotate",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(i,"PinchZoom",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(i,"DragAndDrop",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"DragBox",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(i,"DragRotateAndZoom",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(i,"Draw",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(i,"Extent",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(i,"Interaction",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(i,"Modify",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(i,"Pointer",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(i,"Select",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(i,"Snap",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(i,"Translate",{enumerable:!0,get:function(){return w.default}});var r=P(t("./Collection.js")),o=P(t("./interaction/DoubleClickZoom.js")),s=P(t("./interaction/DragPan.js")),a=P(t("./interaction/DragRotate.js")),l=P(t("./interaction/DragZoom.js")),u=P(t("./interaction/KeyboardPan.js")),h=P(t("./interaction/KeyboardZoom.js")),c=P(t("./Kinetic.js")),d=P(t("./interaction/MouseWheelZoom.js")),p=P(t("./interaction/PinchRotate.js")),f=P(t("./interaction/PinchZoom.js")),n=P(t("./interaction/DragAndDrop.js")),g=P(t("./interaction/DragBox.js")),m=P(t("./interaction/DragRotateAndZoom.js")),y=P(t("./interaction/Draw.js")),_=P(t("./interaction/Extent.js")),v=P(t("./interaction/Interaction.js")),b=P(t("./interaction/Modify.js")),j=P(t("./interaction/Pointer.js")),x=P(t("./interaction/Select.js")),S=P(t("./interaction/Snap.js")),w=P(t("./interaction/Translate.js"));function P(t){return t&&t.__esModule?t:{default:t}}},{"./Collection.js":10,"./Kinetic.js":20,"./interaction/DoubleClickZoom.js":162,"./interaction/DragAndDrop.js":163,"./interaction/DragBox.js":164,"./interaction/DragPan.js":165,"./interaction/DragRotate.js":166,"./interaction/DragRotateAndZoom.js":167,"./interaction/DragZoom.js":168,"./interaction/Draw.js":169,"./interaction/Extent.js":170,"./interaction/Interaction.js":171,"./interaction/KeyboardPan.js":172,"./interaction/KeyboardZoom.js":173,"./interaction/Modify.js":174,"./interaction/MouseWheelZoom.js":175,"./interaction/PinchRotate.js":176,"./interaction/PinchZoom.js":177,"./interaction/Pointer.js":178,"./interaction/Select.js":180,"./interaction/Snap.js":181,"./interaction/Translate.js":182}],162:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,a=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Interaction.js")),l=(n=t("../MapBrowserEventType.js"))&&n.__esModule?n:{default:n};function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var r,o,h=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=(r=a.default,h(d,r),d.prototype.handleEvent=function(t){var e,i,n,r,o,s=!1;return t.type==l.default.DBLCLICK&&(e=t.originalEvent,i=t.map,n=t.coordinate,r=e.shiftKey?-this.delta_:this.delta_,o=i.getView(),(0,a.zoomByDelta)(o,r,n,this.duration_),t.preventDefault(),s=!0),!s},d);function d(t){var e=r.call(this)||this,i=t||{};return e.delta_=i.delta?i.delta:1,e.duration_=void 0!==i.duration?i.duration:250,e}i.default=c},{"../MapBrowserEventType.js":24,"./Interaction.js":171}],163:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=u(t("../events/Event.js")),s=u(t("../events/EventType.js")),r=u(t("./Interaction.js")),o=t("../functions.js"),a=t("../proj.js"),l=t("../events.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f="addfeatures",g=(c=n.default,p(_,c),_),m=(h=r.default,p(y,h),y.prototype.handleResult_=function(t,e){for(var i=e.target.result,n=this.getMap(),r=(r=this.projection_)||n.getView().getProjection(),o=this.formatConstructors_,s=0,a=o.length;s<a;++s){var l=new o[s],u=this.tryReadFeatures_(l,i,{featureProjection:r});if(u&&0<u.length){this.source_&&(this.source_.clear(),this.source_.addFeatures(u)),this.dispatchEvent(new g(f,t,u,r));break}}},y.prototype.registerListeners_=function(){var t,e=this.getMap();e&&(t=this.target?this.target:e.getViewport(),this.dropListenKeys_=[(0,l.listen)(t,s.default.DROP,this.handleDrop,this),(0,l.listen)(t,s.default.DRAGENTER,this.handleStop,this),(0,l.listen)(t,s.default.DRAGOVER,this.handleStop,this),(0,l.listen)(t,s.default.DROP,this.handleStop,this)])},y.prototype.setActive=function(t){!this.getActive()&&t&&this.registerListeners_(),this.getActive()&&!t&&this.unregisterListeners_(),h.prototype.setActive.call(this,t)},y.prototype.setMap=function(t){this.unregisterListeners_(),h.prototype.setMap.call(this,t),this.getActive()&&this.registerListeners_()},y.prototype.tryReadFeatures_=function(t,e,i){try{return t.readFeatures(e,i)}catch(t){return null}},y.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(l.unlistenByKey),this.dropListenKeys_=null)},y.prototype.handleDrop=function(t){for(var e=t.dataTransfer.files,i=0,n=e.length;i<n;++i){var r=e.item(i),o=new FileReader;o.addEventListener(s.default.LOAD,this.handleResult_.bind(this,r)),o.readAsText(r)}},y.prototype.handleStop=function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},y);function y(t){var e=this,i=t||{};return(e=h.call(this,{handleEvent:o.TRUE})||this).formatConstructors_=i.formatConstructors?i.formatConstructors:[],e.projection_=i.projection?(0,a.get)(i.projection):null,e.dropListenKeys_=null,e.source_=i.source||null,e.target=i.target?i.target:null,e}function _(t,e,i,n){var r=c.call(this,t)||this;return r.features=i,r.file=e,r.projection=n,r}i.default=m},{"../events.js":64,"../events/Event.js":65,"../events/EventType.js":66,"../functions.js":125,"../proj.js":205,"./Interaction.js":171}],164:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("../events/Event.js")),r=a(t("./Pointer.js")),o=a(t("../render/Box.js")),s=t("../events/condition.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d="boxstart",p="boxdrag",f="boxend",g=(u=n.default,c(_,u),_),m=(l=r.default,c(y,l),y.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_},y.prototype.getGeometry=function(){return this.box_.getGeometry()},y.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new g(p,t.coordinate,t))},y.prototype.handleUpEvent=function(t){return this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new g(f,t.coordinate,t))),!1},y.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new g(d,t.coordinate,t)),!0)},y.prototype.onBoxEnd=function(t){},y);function y(t){var e=l.call(this)||this,i=t||{};return e.box_=new o.default(i.className||"ol-dragbox"),e.minArea_=void 0!==i.minArea?i.minArea:64,i.onBoxEnd&&(e.onBoxEnd=i.onBoxEnd),e.startPixel_=null,e.condition_=i.condition?i.condition:s.mouseActionButton,e.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:e.defaultBoxEndCondition,e}function _(t,e,i){var n=u.call(this,t)||this;return n.coordinate=e,n.mapBrowserEvent=i,n}i.default=m},{"../events/Event.js":65,"../events/condition.js":69,"../render/Box.js":214,"./Pointer.js":178}],165:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Pointer.js")),r=t("../functions.js"),a=t("../events/condition.js"),l=t("../easing.js"),u=t("../coordinate.js");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}var c,n,d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(c=o.default,d(f,c),f.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e,i,n=this.targetPointers,r=(0,o.centroid)(n);n.length==this.lastPointersCount_?(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid&&(e=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],i=t.map.getView(),(0,u.scale)(e,i.getResolution()),(0,u.rotate)(e,i.getRotation()),i.adjustCenterInternal(e))):this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},f.prototype.handleUpEvent=function(t){var e,i,n,r,o,s=t.map,a=s.getView();return 0!==this.targetPointers.length?(this.kinetic_&&this.kinetic_.begin(),!(this.lastCentroid=null)):(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()&&(e=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),n=a.getCenterInternal(),r=s.getPixelFromCoordinateInternal(n),o=s.getCoordinateFromPixelInternal([r[0]-e*Math.cos(i),r[1]-e*Math.sin(i)]),a.animateInternal({center:a.getConstrainedCenter(o),duration:500,easing:l.easeOut})),this.panning_&&(this.panning_=!1,a.endInteraction()),!1)},f.prototype.handleDownEvent=function(t){if(0<this.targetPointers.length&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=1<this.targetPointers.length,!0}return!1},f);function f(t){var e=c.call(this,{stopDown:r.FALSE})||this,i=t||{};e.kinetic_=i.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1;var n=i.condition?i.condition:(0,a.all)(a.noModifierKeys,a.primaryAction);return e.condition_=i.onFocusOnly?(0,a.all)(a.focusWithTabindex,n):n,e.noKinetic_=!1,e}i.default=p},{"../coordinate.js":60,"../easing.js":63,"../events/condition.js":69,"../functions.js":125,"./Pointer.js":178}],166:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Pointer.js"))&&n.__esModule?n:{default:n},o=t("../functions.js"),a=t("../events/condition.js"),l=t("../rotationconstraint.js");var s,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=(s=r.default,h(d,s),d.prototype.handleDragEvent=function(t){var e,i,n,r,o,s;!(0,a.mouseOnly)(t)||(i=(e=t.map).getView()).getConstraints().rotation!==l.disable&&(n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2),void 0!==this.lastAngle_&&(s=o-this.lastAngle_,i.adjustRotationInternal(-s)),this.lastAngle_=o)},d.prototype.handleUpEvent=function(t){return!(0,a.mouseOnly)(t)||(t.map.getView().endInteraction(this.duration_),!1)},d.prototype.handleDownEvent=function(t){return!(!(0,a.mouseOnly)(t)||!(0,a.mouseActionButton)(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0))},d);function d(t){var e=this,i=t||{};return(e=s.call(this,{stopDown:o.FALSE})||this).condition_=i.condition?i.condition:a.altShiftKeysOnly,e.lastAngle_=void 0,e.duration_=void 0!==i.duration?i.duration:250,e}i.default=c},{"../events/condition.js":69,"../functions.js":125,"../rotationconstraint.js":250,"./Pointer.js":178}],167:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Pointer.js"))&&n.__esModule?n:{default:n},h=t("../events/condition.js");var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u.prototype.handleDragEvent=function(t){var e,i,n,r,o,s,a,l,u;(0,h.mouseOnly)(t)&&(i=(e=t.map).getSize(),r=(n=t.pixel)[0]-i[0]/2,o=i[1]/2-n[1],s=Math.atan2(o,r),a=Math.sqrt(r*r+o*o),l=e.getView(),void 0!==this.lastAngle_&&(u=this.lastAngle_-s,l.adjustRotationInternal(u)),this.lastAngle_=s,void 0!==this.lastMagnitude_&&l.adjustResolutionInternal(this.lastMagnitude_/a),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/a),this.lastMagnitude_=a)},u.prototype.handleUpEvent=function(t){if(!(0,h.mouseOnly)(t))return!0;var e=t.map.getView(),i=1<this.lastScaleDelta_?1:-1;return e.endInteraction(this.duration_,i),this.lastScaleDelta_=0,!1},u.prototype.handleDownEvent=function(t){return!(!(0,h.mouseOnly)(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0))},u);function u(t){var e=this,i=t||{};return(e=o.call(this,i)||this).condition_=i.condition?i.condition:h.shiftKeyOnly,e.lastAngle_=void 0,e.lastMagnitude_=void 0,e.lastScaleDelta_=0,e.duration_=void 0!==i.duration?i.duration:400,e}i.default=l},{"../events/condition.js":69,"./Pointer.js":178}],168:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./DragBox.js"))&&n.__esModule?n:{default:n},h=t("../extent.js"),c=t("../easing.js"),o=t("../events/condition.js");var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=r.default,l(d,s),d.prototype.onBoxEnd=function(t){var e,i,n,r=this.getMap(),o=r.getView(),s=r.getSize(),a=this.getGeometry().getExtent();this.out_&&(e=o.calculateExtentInternal(s),i=(0,h.createOrUpdateFromCoordinates)([r.getPixelFromCoordinateInternal((0,h.getBottomLeft)(a)),r.getPixelFromCoordinateInternal((0,h.getTopRight)(a))]),n=o.getResolutionForExtentInternal(i,s),(0,h.scaleFromCenter)(e,1/n),a=e);var l=o.getConstrainedResolution(o.getResolutionForExtentInternal(a,s)),u=o.getConstrainedCenter((0,h.getCenter)(a),l);o.animateInternal({resolution:l,center:u,duration:this.duration_,easing:c.easeOut})},d);function d(t){var e=this,i=t||{},n=i.condition?i.condition:o.shiftKeyOnly;return(e=s.call(this,{condition:n,className:i.className||"ol-dragzoom",minArea:i.minArea})||this).duration_=void 0!==i.duration?i.duration:200,e.out_=void 0!==i.out&&i.out,e}i.default=u},{"../easing.js":63,"../events/condition.js":69,"../extent.js":70,"./DragBox.js":164}],169:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.createRegularPolygon=function(c,d){return function(t,e,i){var n,r,o=(0,P.fromUserCoordinate)(t[0],i),s=(0,P.fromUserCoordinate)(t[1],i),a=Math.sqrt((0,T.squaredDistance)(o,s)),l=e||(0,_.fromCircle)(new p.default(o),c),u=d;d||(n=s[0]-o[0],r=s[1]-o[1],u=Math.atan(r/n)-(n<0?Math.PI:0)),(0,_.makeRegular)(l,o,a,u);var h=(0,P.getUserProjection)();return h&&l.transform(i,h),l}},i.createBox=function(){return function(t,e,i){var n=(0,S.boundingExtent)(t.map(function(t){return(0,P.fromUserCoordinate)(t,i)})),r=[[(0,S.getBottomLeft)(n),(0,S.getBottomRight)(n),(0,S.getTopRight)(n),(0,S.getTopLeft)(n),(0,S.getBottomLeft)(n)]],o=e;o?o.setCoordinates(r):o=new _.default(r);var s=(0,P.getUserProjection)();return s&&o.transform(i,s),o}},i.default=void 0;var p=C(t("../geom/Circle.js")),n=C(t("../events/Event.js")),r=C(t("../events/EventType.js")),l=C(t("../Feature.js")),u=C(t("../geom/GeometryType.js")),h=C(t("./Property.js")),c=C(t("../geom/LineString.js")),o=C(t("../MapBrowserEvent.js")),a=C(t("../MapBrowserEventType.js")),d=C(t("../geom/MultiLineString.js")),f=C(t("../geom/MultiPoint.js")),g=C(t("../geom/MultiPolygon.js")),m=C(t("../geom/Point.js")),y=C(t("./Pointer.js")),_=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=O();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("../geom/Polygon.js")),v=C(t("../layer/Vector.js")),b=C(t("../source/Vector.js")),j=t("../functions.js"),x=t("../events/condition.js"),S=t("../extent.js"),w=t("../style/Style.js"),P=t("../proj.js"),E=t("../Object.js"),T=t("../coordinate.js");function O(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return O=function(){return t},t}function C(t){return t&&t.__esModule?t:{default:t}}var M,I,R,k=(R=function(t,e){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}R(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),A={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},L="drawstart",F="drawend",N="drawabort",D=(I=n.default,k(z,I),z),G=(M=y.default,k(U,M),U.prototype.setMap=function(t){M.prototype.setMap.call(this,t),this.updateState_()},U.prototype.getOverlay=function(){return this.overlay_},U.prototype.handleEvent=function(t){t.originalEvent.type===r.default.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==A.POINT&&this.freehandCondition_(t);var e=t.type===a.default.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===a.default.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===a.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===a.default.POINTERDOWN?i=!1:e?(i=t.type===a.default.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.preventDefault()):("mouse"==t.originalEvent.pointerType||t.type===a.default.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===a.default.DBLCLICK&&(i=!1),M.prototype.handleEvent.call(this,t)&&i},U.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new o.default(a.default.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)},U.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===A.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate):(this.startDrawing_(t),this.mode_===A.POINT&&this.finishDrawing()),e=!1):this.freehand_&&this.abortDrawing(),!e&&this.stopClick_&&t.stopPropagation(),e},U.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],o=n*n+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t)},U.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i,n=!1,r=[this.finishCoordinate_];if(this.mode_===A.LINE_STRING?n=this.sketchCoords_.length>this.minPoints_:this.mode_===A.POLYGON&&(n=(i=this.sketchCoords_)[0].length>this.minPoints_,r=[i[0][0],i[0][i[0].length-2]]),n)for(var o=t.map,s=0,a=r.length;s<a;s++){var l=r[s],u=o.getPixelFromCoordinate(l),h=t.pixel,c=h[0]-u[0],d=h[1]-u[1],p=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(c*c+d*d)<=p){this.finishCoordinate_=l;break}}}return e},U.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new l.default(new m.default(e)),this.updateSketchFeatures_())},U.prototype.startDrawing_=function(t){var e=t.coordinate,i=t.map.getView().getProjection();this.finishCoordinate_=e,this.mode_===A.POINT?this.sketchCoords_=e.slice():this.mode_===A.POLYGON?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new l.default(new c.default(this.sketchLineCoords_)));var n=this.geometryFunction_(this.sketchCoords_,void 0,i);this.sketchFeature_=new l.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new D(L,this.sketchFeature_))},U.prototype.modifyDrawing_=function(t){var e,i,n,r,o=t.coordinate,s=this.sketchFeature_.getGeometry(),a=t.map.getView().getProjection();this.mode_===A.POINT?i=this.sketchCoords_:this.mode_===A.POLYGON?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(o=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=o[0],i[1]=o[1],this.geometryFunction_(this.sketchCoords_,s,a),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(o),s.getType()==u.default.POLYGON&&this.mode_!==A.POLYGON?(this.sketchLine_||(this.sketchLine_=new l.default),r=s.getLinearRing(0),(n=this.sketchLine_.getGeometry())?(n.setFlatCoordinates(r.getLayout(),r.getFlatCoordinates()),n.changed()):(n=new c.default(r.getFlatCoordinates(),r.getLayout()),this.sketchLine_.setGeometry(n))):this.sketchLineCoords_&&(n=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()},U.prototype.addToDrawing_=function(t){var e,i,n=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();this.mode_===A.LINE_STRING?(this.finishCoordinate_=t.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),this.geometryFunction_(i,n,r)):this.mode_===A.POLYGON&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,n,r)),this.updateSketchFeatures_(),e&&this.finishDrawing()},U.prototype.removeLastPoint=function(){var t,e,i;this.sketchFeature_&&(e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),this.mode_===A.LINE_STRING?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e,i),2<=t.length&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===A.POLYGON&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,i)),0===t.length&&this.abortDrawing(),this.updateSketchFeatures_())},U.prototype.finishDrawing=function(){var t,e,i,n=this.abortDrawing_();n&&(t=this.sketchCoords_,e=n.getGeometry(),i=this.getMap().getView().getProjection(),this.mode_===A.LINE_STRING?(t.pop(),this.geometryFunction_(t,e,i)):this.mode_===A.POLYGON&&(t[0].pop(),this.geometryFunction_(t,e,i),t=e.getCoordinates()),this.type_===u.default.MULTI_POINT?n.setGeometry(new f.default([t])):this.type_===u.default.MULTI_LINE_STRING?n.setGeometry(new d.default([t])):this.type_===u.default.MULTI_POLYGON&&n.setGeometry(new g.default([t])),this.dispatchEvent(new D(F,n)),this.features_&&this.features_.push(n),this.source_&&this.source_.addFeature(n))},U.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),t},U.prototype.abortDrawing=function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new D(N,t))},U.prototype.appendCoordinates=function(t){var e=this.mode_,i=[];e===A.LINE_STRING?i=this.sketchCoords_:e===A.POLYGON&&(i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]);for(var n=i.pop(),r=0;r<t.length;r++)this.addToDrawing_(t[r]);this.addToDrawing_(n)},U.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new D(L,this.sketchFeature_))},U.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},U.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)},U);function U(t){var e,i,n=this,r=t;r.stopDown||(r.stopDown=j.FALSE),(n=M.call(this,r)||this).shouldHandle_=!1,n.downPx_=null,n.downTimeout_,n.lastDragTime_,n.freehand_=!1,n.source_=t.source?t.source:null,n.features_=t.features?t.features:null,n.snapTolerance_=t.snapTolerance?t.snapTolerance:12,n.type_=t.type,n.mode_=((e=n.type_)===u.default.POINT||e===u.default.MULTI_POINT?i=A.POINT:e===u.default.LINE_STRING||e===u.default.MULTI_LINE_STRING?i=A.LINE_STRING:e===u.default.POLYGON||e===u.default.MULTI_POLYGON?i=A.POLYGON:e===u.default.CIRCLE&&(i=A.CIRCLE),i),n.stopClick_=!!t.stopClick,n.minPoints_=t.minPoints?t.minPoints:n.mode_===A.POLYGON?3:2,n.maxPoints_=t.maxPoints?t.maxPoints:1/0,n.finishCondition_=t.finishCondition?t.finishCondition:j.TRUE;var o,s,a,l=(l=t.geometryFunction)||(n.type_===u.default.CIRCLE?function(t,e,i){var n=e||new p.default([NaN,NaN]),r=(0,P.fromUserCoordinate)(t[0],i),o=(0,T.squaredDistance)(r,(0,P.fromUserCoordinate)(t[1],i));n.setCenterAndRadius(r,Math.sqrt(o));var s=(0,P.getUserProjection)();return s&&n.transform(i,s),n}:((s=n.mode_)===A.POINT?o=m.default:s===A.LINE_STRING?o=c.default:s===A.POLYGON&&(o=_.default),function(t,e,i){var n=e;return n?s===A.POLYGON?t[0].length?n.setCoordinates([t[0].concat([t[0][0]])]):n.setCoordinates([]):n.setCoordinates(t):n=new o(t),n}));return n.geometryFunction_=l,n.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,n.finishCoordinate_=null,n.sketchFeature_=null,n.sketchPoint_=null,n.sketchCoords_=null,n.sketchLine_=null,n.sketchLineCoords_=null,n.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,n.overlay_=new v.default({source:new b.default({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(a=(0,w.createEditingStyle)(),function(t,e){return a[t.getGeometry().getType()]}),updateWhileInteracting:!0}),n.geometryName_=t.geometryName,n.condition_=t.condition?t.condition:x.noModifierKeys,n.freehandCondition_,t.freehand?n.freehandCondition_=x.always:n.freehandCondition_=t.freehandCondition?t.freehandCondition:x.shiftKeyOnly,n.addEventListener((0,E.getChangeEventType)(h.default.ACTIVE),n.updateState_),n}function z(t,e){var i=I.call(this,t)||this;return i.feature=e,i}i.default=G},{"../Feature.js":13,"../MapBrowserEvent.js":22,"../MapBrowserEventType.js":24,"../Object.js":28,"../coordinate.js":60,"../events/Event.js":65,"../events/EventType.js":66,"../events/condition.js":69,"../extent.js":70,"../functions.js":125,"../geom/Circle.js":127,"../geom/GeometryType.js":131,"../geom/LineString.js":132,"../geom/MultiLineString.js":134,"../geom/MultiPoint.js":135,"../geom/MultiPolygon.js":136,"../geom/Point.js":137,"../geom/Polygon.js":138,"../layer/Vector.js":196,"../proj.js":205,"../source/Vector.js":277,"../style/Style.js":302,"./Pointer.js":178,"./Property.js":179}],170:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=y(t("../events/Event.js")),r=y(t("../Feature.js")),o=y(t("../geom/GeometryType.js")),s=y(t("../MapBrowserEventType.js")),a=y(t("../geom/Point.js")),l=y(t("./Pointer.js")),u=y(t("../layer/Vector.js")),h=y(t("../source/Vector.js")),c=t("../events/condition.js"),d=t("../extent.js"),f=t("../coordinate.js"),p=t("../style/Style.js"),g=t("../geom/Polygon.js"),m=t("../proj.js");function y(t){return t&&t.__esModule?t:{default:t}}var _,v,b,j=(b=function(t,e){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),x="extentchanged",S=(v=n.default,j(E,v),E),w=(_=l.default,j(P,_),P.prototype.snapToVertex_=function(t,e){var i,n=e.getCoordinateFromPixelInternal(t),r=this.getExtentInternal();if(r){var o=[[[(i=r)[0],i[1]],[i[0],i[3]]],[[i[0],i[3]],[i[2],i[3]]],[[i[2],i[3]],[i[2],i[1]]],[[i[2],i[1]],[i[0],i[1]]]];o.sort(function(t,e){return(0,f.squaredDistanceToSegment)(n,t)-(0,f.squaredDistanceToSegment)(n,e)});var s=o[0],a=(0,f.closestOnSegment)(n,s),l=e.getPixelFromCoordinateInternal(a);if((0,f.distance)(t,l)<=this.pixelTolerance_){var u=e.getPixelFromCoordinateInternal(s[0]),h=e.getPixelFromCoordinateInternal(s[1]),c=(0,f.squaredDistance)(l,u),d=(0,f.squaredDistance)(l,h),p=Math.sqrt(Math.min(c,d));return this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(a=d<c?s[1]:s[0]),a}}return null},P.prototype.handlePointerMove_=function(t){var e=t.pixel,i=t.map,n=(n=this.snapToVertex_(e,i))||i.getCoordinateFromPixelInternal(e);this.createOrUpdatePointerFeature_(n)},P.prototype.createOrUpdateExtentFeature_=function(t){var e=this.extentFeature_;return e?t?e.setGeometry((0,g.fromExtent)(t)):e.setGeometry(void 0):(e=t?new r.default((0,g.fromExtent)(t)):new r.default({}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e},P.prototype.createOrUpdatePointerFeature_=function(t){var e=this.vertexFeature_;return e?e.getGeometry().setCoordinates(t):(e=new r.default(new a.default(t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e)),e},P.prototype.handleEvent=function(t){return!t.originalEvent||!this.condition_(t)||(t.type!=s.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),_.prototype.handleEvent.call(this,t),!1)},P.prototype.handleDownEvent=function(t){function e(t){var e=null,i=null;return t[0]==s[0]?e=s[2]:t[0]==s[2]&&(e=s[0]),t[1]==s[1]?i=s[3]:t[1]==s[3]&&(i=s[1]),null!==e&&null!==i?[e,i]:null}var i,n,r=t.pixel,o=t.map,s=this.getExtentInternal(),a=this.snapToVertex_(r,o);return a&&s?(i=a[0]==s[0]||a[0]==s[2]?a[0]:null,n=a[1]==s[1]||a[1]==s[3]?a[1]:null,null!==i&&null!==n?this.pointerHandler_=T(e(a)):null!==i?this.pointerHandler_=O(e([i,s[1]]),e([i,s[3]])):null!==n&&(this.pointerHandler_=O(e([s[0],n]),e([s[2],n])))):(a=o.getCoordinateFromPixelInternal(r),this.setExtent([a[0],a[1],a[0],a[1]]),this.pointerHandler_=T(a)),!0},P.prototype.handleDragEvent=function(t){var e;this.pointerHandler_&&(e=t.coordinate,this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e))},P.prototype.handleUpEvent=function(t){this.pointerHandler_=null;var e=this.getExtentInternal();return e&&0!==(0,d.getArea)(e)||this.setExtent(null),!1},P.prototype.setMap=function(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),_.prototype.setMap.call(this,t)},P.prototype.getExtent=function(){return(0,m.toUserExtent)(this.getExtentInternal(),this.getMap().getView().getProjection())},P.prototype.getExtentInternal=function(){return this.extent_},P.prototype.setExtent=function(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new S(this.extent_))},P);function P(t){var i,n,e=this,r=t||{};return(e=_.call(this,r)||this).condition_=r.condition?r.condition:c.always,e.extent_=null,e.pointerHandler_=null,e.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,e.snappedToVertex_=!1,e.extentFeature_=null,e.vertexFeature_=null,t=t||{},e.extentOverlay_=new u.default({source:new h.default({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:(n=(0,p.createEditingStyle)(),function(t,e){return n[o.default.POLYGON]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.vertexOverlay_=new u.default({source:new h.default({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:(i=(0,p.createEditingStyle)(),function(t,e){return i[o.default.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&e.setExtent(t.extent),e}function E(t){var e=v.call(this,x)||this;return e.extent=t,e}function T(e){return function(t){return(0,d.boundingExtent)([e,t])}}function O(e,i){return e[0]==i[0]?function(t){return(0,d.boundingExtent)([e,[t[0],i[1]]])}:e[1]==i[1]?function(t){return(0,d.boundingExtent)([e,[i[0],t[1]]])}:null}i.default=w},{"../Feature.js":13,"../MapBrowserEventType.js":24,"../coordinate.js":60,"../events/Event.js":65,"../events/condition.js":69,"../extent.js":70,"../geom/GeometryType.js":131,"../geom/Point.js":137,"../geom/Polygon.js":138,"../layer/Vector.js":196,"../proj.js":205,"../source/Vector.js":277,"../style/Style.js":302,"./Pointer.js":178}],171:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.pan=function(t,e,i){var n=t.getCenterInternal();{var r;n&&(r=[n[0]+e[0],n[1]+e[1]],t.animateInternal({duration:void 0!==i?i:250,easing:a.linear,center:t.getConstrainedCenter(r)}))}},i.zoomByDelta=function(t,e,i,n){var r=t.getZoom();{var o,s;void 0!==r&&(o=t.getConstrainedZoom(r+e),s=t.getResolutionForZoom(o),t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:i,duration:void 0!==n?n:250,easing:a.easeOut}))}},i.default=void 0;var n=o(t("../Object.js")),r=o(t("./Property.js")),a=t("../easing.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(s=n.default,u(c,s),c.prototype.getActive=function(){return this.get(r.default.ACTIVE)},c.prototype.getMap=function(){return this.map_},c.prototype.handleEvent=function(t){return!0},c.prototype.setActive=function(t){this.set(r.default.ACTIVE,t)},c.prototype.setMap=function(t){this.map_=t},c);function c(t){var e=s.call(this)||this;return t&&t.handleEvent&&(e.handleEvent=t.handleEvent),e.map_=null,e.setActive(!0),e}i.default=h},{"../Object.js":28,"../easing.js":63,"./Property.js":179}],172:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=r(t("../events/EventType.js")),u=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Interaction.js")),h=r(t("../events/KeyCode.js")),n=t("../events/condition.js"),c=t("../coordinate.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function r(t){return t&&t.__esModule?t:{default:t}}var o,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f=(o=u.default,p(g,o),g.prototype.handleEvent=function(t){var e,i,n,r,o,s,a=!1;return t.type==l.default.KEYDOWN&&(e=t.originalEvent.keyCode,!this.condition_(t)||e!=h.default.DOWN&&e!=h.default.LEFT&&e!=h.default.RIGHT&&e!=h.default.UP||(n=(i=t.map.getView()).getResolution()*this.pixelDelta_,o=r=0,e==h.default.DOWN?o=-n:e==h.default.LEFT?r=-n:e==h.default.RIGHT?r=n:o=n,s=[r,o],(0,c.rotate)(s,i.getRotation()),(0,u.pan)(i,s,this.duration_),t.preventDefault(),a=!0)),!a},g);function g(t){var e=o.call(this)||this,i=t||{};return e.defaultCondition_=function(t){return(0,n.noModifierKeys)(t)&&(0,n.targetNotEditable)(t)},e.condition_=void 0!==i.condition?i.condition:e.defaultCondition_,e.duration_=void 0!==i.duration?i.duration:100,e.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128,e}i.default=f},{"../coordinate.js":60,"../events/EventType.js":66,"../events/KeyCode.js":67,"../events/condition.js":69,"./Interaction.js":171}],173:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,a=(n=t("../events/EventType.js"))&&n.__esModule?n:{default:n},l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Interaction.js")),r=t("../events/condition.js");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var o,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(o=l.default,c(p,o),p.prototype.handleEvent=function(t){var e,i,n,r,o=!1;return t.type!=a.default.KEYDOWN&&t.type!=a.default.KEYPRESS||(e=t.originalEvent.charCode,!this.condition_(t)||e!="+".charCodeAt(0)&&e!="-".charCodeAt(0)||(i=t.map,n=e=="+".charCodeAt(0)?this.delta_:-this.delta_,r=i.getView(),(0,l.zoomByDelta)(r,n,void 0,this.duration_),t.preventDefault(),o=!0)),!o},p);function p(t){var e=o.call(this)||this,i=t||{};return e.condition_=i.condition?i.condition:r.targetNotEditable,e.delta_=i.delta?i.delta:1,e.duration_=void 0!==i.duration?i.duration:100,e}i.default=d},{"../events/EventType.js":66,"../events/condition.js":69,"./Interaction.js":171}],174:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.ModifyEvent=void 0;var r=v(t("../Collection.js")),o=v(t("../CollectionEventType.js")),n=v(t("../events/Event.js")),s=v(t("../events/EventType.js")),a=v(t("../Feature.js")),x=v(t("../geom/GeometryType.js")),l=v(t("../MapBrowserEventType.js")),u=v(t("../geom/Point.js")),h=v(t("./Pointer.js")),c=v(t("../structs/RBush.js")),d=v(t("../source/VectorEventType.js")),p=v(t("../layer/Vector.js")),f=v(t("../source/Vector.js")),g=t("../events/condition.js"),S=t("../extent.js"),w=t("../coordinate.js"),m=t("../style/Style.js"),y=t("../array.js"),_=t("../geom/Polygon.js"),P=t("../proj.js"),E=t("../util.js");function v(t){return t&&t.__esModule?t:{default:t}}var b,j,T=(j=function(t,e){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),O=1,C=[0,0,0,0],M=[],I="modifystart",R="modifyend",k=(b=n.default,T(A,b),A);function A(t,e,i){var n=b.call(this,t)||this;return n.features=e,n.mapBrowserEvent=i,n}i.ModifyEvent=k;var L,F=(L=h.default,T(N,L),N.prototype.addFeature_=function(t){var e,i=t.getGeometry();!i||(e=this.SEGMENT_WRITERS_[i.getType()])&&e(t,i);var n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),t.addEventListener(s.default.CHANGE,this.boundHandleFeatureChange_)},N.prototype.willModifyFeatures_=function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new k(I,this.features_,t)))},N.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(s.default.CHANGE,this.boundHandleFeatureChange_)},N.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(var n=i.length-1;0<=n;--n){for(var r=i[n],o=this.dragSegments_.length-1;0<=o;--o)this.dragSegments_[o][0]===r&&this.dragSegments_.splice(o,1);t.remove(r)}},N.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),L.prototype.setActive.call(this,t)},N.prototype.setMap=function(t){this.overlay_.setMap(t),L.prototype.setMap.call(this,t)},N.prototype.getOverlay=function(){return this.overlay_},N.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},N.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},N.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},N.prototype.handleFeatureChange_=function(t){var e;this.changingFeature_||(e=t.target,this.removeFeature_(e),this.addFeature_(e))},N.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},N.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},N.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n){var o=i[n],s={feature:t,geometry:e,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},N.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length-1;n<r;++n){var o=i.slice(n,n+2),s={feature:t,geometry:e,index:n,segment:o};this.rBush_.insert((0,S.boundingExtent)(o),s)}},N.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert((0,S.boundingExtent)(l),u)}},N.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert((0,S.boundingExtent)(l),u)}},N.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,h=l.length-1;u<h;++u){var c=l.slice(u,u+2),d={feature:t,geometry:e,depth:[s,n],index:u,segment:c};this.rBush_.insert((0,S.boundingExtent)(c),d)}},N.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},r={feature:t,geometry:e,index:O,segment:[i,i]},o=[n,r];n.featureSegments=o,r.featureSegments=o,this.rBush_.insert((0,S.createOrUpdateFromCoordinate)(i),n);var s,a=e,l=(0,P.getUserProjection)();l&&this.getMap()&&(s=this.getMap().getView().getProjection(),a=a.clone().transform(l,s),a=(0,_.fromCircle)(a).transform(s,l)),this.rBush_.insert(a.getExtent(),r)},N.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n){var r=i[n];(0,this.SEGMENT_WRITERS_[r.getType()])(t,r)}},N.prototype.createOrUpdateVertexFeature_=function(t){var e=this.vertexFeature_;return e?e.getGeometry().setCoordinates(t):(e=new a.default(new u.default(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e)),e},N.prototype.handleEvent=function(t){return!t.originalEvent||((this.lastPointerEvent_=t).map.getView().getInteracting()||t.type!=l.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=!(t.type!=l.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==l.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),L.prototype.handleEvent.call(this,t)&&!e);var e},N.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,i=0,n=this.dragSegments_.length;i<n;++i){for(var r,o,s,a,l=this.dragSegments_[i],u=l[0],h=u.depth,c=u.geometry,d=void 0,p=u.segment,f=l[1];e.length<c.getStride();)e.push(p[f][e.length]);switch(c.getType()){case x.default.POINT:d=e,p[0]=e,p[1]=e;break;case x.default.MULTI_POINT:(d=c.getCoordinates())[u.index]=e,p[0]=e,p[1]=e;break;case x.default.LINE_STRING:(d=c.getCoordinates())[u.index+f]=e,p[f]=e;break;case x.default.MULTI_LINE_STRING:case x.default.POLYGON:(d=c.getCoordinates())[h[0]][u.index+f]=e,p[f]=e;break;case x.default.MULTI_POLYGON:(d=c.getCoordinates())[h[1]][h[0]][u.index+f]=e,p[f]=e;break;case x.default.CIRCLE:p[0]=e,p[1]=e,0===u.index?(this.changingFeature_=!0,c.setCenter(e)):(this.changingFeature_=!0,r=t.map.getView().getProjection(),o=(0,w.distance)((0,P.fromUserCoordinate)(c.getCenter(),r),(0,P.fromUserCoordinate)(e,r)),(s=(0,P.getUserProjection)())&&((a=c.clone().transform(s,r)).setRadius(o),o=a.transform(r,s).getRadius()),c.setRadius(o)),this.changingFeature_=!1}d&&this.setGeometryCoordinates_(c,d)}this.createOrUpdateVertexFeature_(e)},N.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;var e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.modified_=!1;var i=this.vertexFeature_;if(i){var n=t.map.getView().getProjection(),r=[],o=i.getGeometry().getCoordinates(),s=(0,S.boundingExtent)([o]),a=this.rBush_.getInExtent(s),l={};a.sort(D);for(var u=0,h=a.length;u<h;++u){var c=a[u],d=c.segment,p=(0,E.getUid)(c.geometry),f=c.depth;if(f&&(p+="-"+f.join("-")),l[p]||(l[p]=new Array(2)),c.geometry.getType()!==x.default.CIRCLE||c.index!==O)if(!(0,w.equals)(d[0],o)||l[p][0])if(!(0,w.equals)(d[1],o)||l[p][1])(0,E.getUid)(d)in this.vertexSegments_&&!l[p][0]&&!l[p][1]&&this.insertVertexCondition_(t)&&r.push([c,o]);else{if((c.geometry.getType()===x.default.LINE_STRING||c.geometry.getType()===x.default.MULTI_LINE_STRING)&&l[p][0]&&0===l[p][0].index)continue;this.dragSegments_.push([c,1]),l[p][1]=c}else this.dragSegments_.push([c,0]),l[p][0]=c;else{var g=U(e,c,n);(0,w.equals)(g,o)&&!l[p][0]&&(this.dragSegments_.push([c,0]),l[p][0]=c)}}r.length&&this.willModifyFeatures_(t);for(var m=r.length-1;0<=m;--m)this.insertVertex_.apply(this,r[m])}return!!this.vertexFeature_},N.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;0<=e;--e){var i,n,r,o,s,a,l=this.dragSegments_[e][0],u=l.geometry;u.getType()===x.default.CIRCLE?(i=u.getCenter(),n=l.featureSegments[0],r=l.featureSegments[1],n.segment[0]=i,n.segment[1]=i,r.segment[0]=i,r.segment[1]=i,this.rBush_.update((0,S.createOrUpdateFromCoordinate)(i),n),a=u,(o=(0,P.getUserProjection)())&&(s=t.map.getView().getProjection(),a=a.clone().transform(o,s),a=(0,_.fromCircle)(a).transform(s,o)),this.rBush_.update(a.getExtent(),r)):this.rBush_.update((0,S.boundingExtent)(l.segment),l)}return this.modified_&&(this.dispatchEvent(new k(R,this.features_,t)),this.modified_=!1),!1},N.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)},N.prototype.handlePointerAtPixel_=function(t,e,i){var n=i||e.getCoordinateFromPixel(t),r=e.getView().getProjection(),o=(0,P.fromUserExtent)((0,S.createOrUpdateFromCoordinate)(n,C),r),s=e.getView().getResolution()*this.pixelTolerance_,a=(0,P.toUserExtent)((0,S.buffer)(o,s,C),r),l=this.rBush_.getInExtent(a);if(0<l.length){l.sort(function(t,e){return G(n,t,r)-G(n,e,r)});var u=l[0],h=u.segment,c=U(n,u,r),d=e.getPixelFromCoordinate(c);if((_=(0,w.distance)(t,d))<=this.pixelTolerance_){var p={};if(u.geometry.getType()===x.default.CIRCLE&&u.index===O)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(c);else{var f=e.getPixelFromCoordinate(h[0]),g=e.getPixelFromCoordinate(h[1]),m=(0,w.squaredDistance)(d,f),y=(0,w.squaredDistance)(d,g),_=Math.sqrt(Math.min(m,y));this.snappedToVertex_=_<=this.pixelTolerance_,this.snappedToVertex_&&(c=y<m?h[1]:h[0]),this.createOrUpdateVertexFeature_(c);for(var v=1,b=l.length;v<b;++v){var j=l[v].segment;if(!((0,w.equals)(h[0],j[0])&&(0,w.equals)(h[1],j[1])||(0,w.equals)(h[0],j[1])&&(0,w.equals)(h[1],j[0])))break;p[(0,E.getUid)(j)]=!0}}return p[(0,E.getUid)(h)]=!0,void(this.vertexSegments_=p)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},N.prototype.insertVertex_=function(t,e){for(var i,n=t.segment,r=t.feature,o=t.geometry,s=t.depth,a=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case x.default.MULTI_LINE_STRING:case x.default.POLYGON:(i=o.getCoordinates())[s[0]].splice(a+1,0,e);break;case x.default.MULTI_POLYGON:(i=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case x.default.LINE_STRING:(i=o.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(o,i);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(o,a,s,1);var u={segment:[n[0],e],feature:r,geometry:o,depth:s,index:a};l.insert((0,S.boundingExtent)(u.segment),u),this.dragSegments_.push([u,1]);var h={segment:[e,n[1]],feature:r,geometry:o,depth:s,index:a+1};l.insert((0,S.boundingExtent)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},N.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=l.default.POINTERDRAG){var t=this.lastPointerEvent_;this.willModifyFeatures_(t);var e=this.removeVertex_();return this.dispatchEvent(new k(R,this.features_,t)),this.modified_=!1,e}return!1},N.prototype.removeVertex_=function(){for(var t,e,i,n,r,o,s,a,l,u,h,c,d=this.dragSegments_,p={},f=!1,g=d.length-1;0<=g;--g)l=(i=d[g])[0],u=(0,E.getUid)(l.feature),l.depth&&(u+="-"+l.depth.join("-")),u in p||(p[u]={}),0===i[1]?(p[u].right=l,p[u].index=l.index):1==i[1]&&(p[u].left=l,p[u].index=l.index+1);for(u in p){switch(a=p[u].right,o=p[u].left,(s=(r=p[u].index)-1)<0&&(s=0),t=e=(n=(l=void 0!==o?o:a).geometry).getCoordinates(),f=!1,n.getType()){case x.default.MULTI_LINE_STRING:2<e[l.depth[0]].length&&(e[l.depth[0]].splice(r,1),f=!0);break;case x.default.LINE_STRING:2<e.length&&(e.splice(r,1),f=!0);break;case x.default.MULTI_POLYGON:t=t[l.depth[1]];case x.default.POLYGON:4<(t=t[l.depth[0]]).length&&(r==t.length-1&&(r=0),t.splice(r,1),f=!0,0===r&&(t.pop(),t.push(t[0]),s=t.length-1))}f&&(this.setGeometryCoordinates_(n,e),h=[],void 0!==o&&(this.rBush_.remove(o),h.push(o.segment[0])),void 0!==a&&(this.rBush_.remove(a),h.push(a.segment[1])),void 0!==o&&void 0!==a&&(c={depth:l.depth,feature:l.feature,geometry:l.geometry,index:s,segment:h},this.rBush_.insert((0,S.boundingExtent)(c.segment),c)),this.updateSegmentIndices_(n,r,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),d.length=0)}return f},N.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},N.prototype.updateSegmentIndices_=function(e,i,n,r){this.rBush_.forEachInExtent(e.getExtent(),function(t){t.geometry===e&&(void 0===n||void 0===t.depth||(0,y.equals)(t.depth,n))&&t.index>i&&(t.index+=r)})},N);function N(t){var e,i,n=L.call(this,t)||this;if(n.boundHandleFeatureChange_=n.handleFeatureChange_.bind(n),n.condition_=t.condition?t.condition:g.primaryAction,n.defaultDeleteCondition_=function(t){return(0,g.altKeyOnly)(t)&&(0,g.singleClick)(t)},n.deleteCondition_=t.deleteCondition?t.deleteCondition:n.defaultDeleteCondition_,n.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:g.always,n.vertexFeature_=null,n.vertexSegments_=null,n.lastPixel_=[0,0],n.ignoreNextSingleClick_=!1,n.modified_=!1,n.rBush_=new c.default,n.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,n.snappedToVertex_=!1,n.changingFeature_=!1,n.dragSegments_=[],n.overlay_=new p.default({source:new f.default({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(i=(0,m.createEditingStyle)(),function(t,e){return i[x.default.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),n.SEGMENT_WRITERS_={Point:n.writePointGeometry_.bind(n),LineString:n.writeLineStringGeometry_.bind(n),LinearRing:n.writeLineStringGeometry_.bind(n),Polygon:n.writePolygonGeometry_.bind(n),MultiPoint:n.writeMultiPointGeometry_.bind(n),MultiLineString:n.writeMultiLineStringGeometry_.bind(n),MultiPolygon:n.writeMultiPolygonGeometry_.bind(n),Circle:n.writeCircleGeometry_.bind(n),GeometryCollection:n.writeGeometryCollectionGeometry_.bind(n)},n.source_=null,t.source?(n.source_=t.source,e=new r.default(n.source_.getFeatures()),n.source_.addEventListener(d.default.ADDFEATURE,n.handleSourceAdd_.bind(n)),n.source_.addEventListener(d.default.REMOVEFEATURE,n.handleSourceRemove_.bind(n))):e=t.features,!e)throw new Error("The modify interaction requires features or a source");return n.features_=e,n.features_.forEach(n.addFeature_.bind(n)),n.features_.addEventListener(o.default.ADD,n.handleFeatureAdd_.bind(n)),n.features_.addEventListener(o.default.REMOVE,n.handleFeatureRemove_.bind(n)),n.lastPointerEvent_=null,n}function D(t,e){return t.index-e.index}function G(t,e,i){var n=e.geometry;if(n.getType()===x.default.CIRCLE){var r=n;if(e.index===O){var o=(0,P.getUserProjection)();o&&(r=r.clone().transform(o,i));var s=(0,w.squaredDistance)(r.getCenter(),(0,P.fromUserCoordinate)(t,i)),a=Math.sqrt(s)-r.getRadius();return a*a}}var l=(0,P.fromUserCoordinate)(t,i);return M[0]=(0,P.fromUserCoordinate)(e.segment[0],i),M[1]=(0,P.fromUserCoordinate)(e.segment[1],i),(0,w.squaredDistanceToSegment)(l,M)}function U(t,e,i){var n=e.geometry;if(n.getType()===x.default.CIRCLE&&e.index===O){var r=n,o=(0,P.getUserProjection)();return o&&(r=r.clone().transform(o,i)),(0,P.toUserCoordinate)(r.getClosestPoint((0,P.fromUserCoordinate)(t,i)),i)}var s=(0,P.fromUserCoordinate)(t,i);return M[0]=(0,P.fromUserCoordinate)(e.segment[0],i),M[1]=(0,P.fromUserCoordinate)(e.segment[1],i),(0,P.toUserCoordinate)((0,w.closestOnSegment)(s,M),i)}i.default=F},{"../Collection.js":10,"../CollectionEventType.js":11,"../Feature.js":13,"../MapBrowserEventType.js":24,"../array.js":44,"../coordinate.js":60,"../events/Event.js":65,"../events/EventType.js":66,"../events/condition.js":69,"../extent.js":70,"../geom/GeometryType.js":131,"../geom/Point.js":137,"../geom/Polygon.js":138,"../layer/Vector.js":196,"../proj.js":205,"../source/Vector.js":277,"../source/VectorEventType.js":278,"../structs/RBush.js":290,"../style/Style.js":302,"../util.js":313,"./Pointer.js":178}],175:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.Mode=void 0;var n,a=(n=t("../events/EventType.js"))&&n.__esModule?n:{default:n},r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Interaction.js")),l=t("../has.js"),o=t("../events/condition.js"),u=t("../math.js");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}var c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p={TRACKPAD:"trackpad",WHEEL:"wheel"};i.Mode=p;var f,g=(f=r.default,d(m,f),m.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?0<this.lastDelta_?1:-1:0,this.lastAnchor_)},m.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==a.default.WHEEL)return!0;t.preventDefault();var e,i=t.map,n=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==a.default.WHEEL&&(e=n.deltaY,l.FIREFOX&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=l.DEVICE_PIXEL_RATIO),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?p.TRACKPAD:p.WHEEL);var o=i.getView();if(this.mode_===p.TRACKPAD&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=e;var s=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),s),!1},m.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var i=-(0,u.clamp)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?0<i?1:-1:0),(0,r.zoomByDelta)(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},m.prototype.setMouseAnchor=function(t){(this.useAnchor_=t)||(this.lastAnchor_=null)},m);function m(t){var e=this,i=t||{};(e=f.call(this,i)||this).totalDelta_=0,e.lastDelta_=0,e.maxDelta_=void 0!==i.maxDelta?i.maxDelta:1,e.duration_=void 0!==i.duration?i.duration:250,e.timeout_=void 0!==i.timeout?i.timeout:80,e.useAnchor_=void 0===i.useAnchor||i.useAnchor,e.constrainResolution_=void 0!==i.constrainResolution&&i.constrainResolution;var n=i.condition?i.condition:o.always;return e.condition_=i.onFocusOnly?(0,o.all)(o.focusWithTabindex,n):n,e.lastAnchor_=null,e.startTime_=void 0,e.timeoutId_,e.mode_=void 0,e.trackpadEventGap_=400,e.trackpadTimeoutId_,e.deltaPerZoom_=300,e}i.default=g},{"../events/EventType.js":66,"../events/condition.js":69,"../has.js":159,"../math.js":201,"./Interaction.js":171}],176:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var h=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Pointer.js")),r=t("../functions.js"),c=t("../rotationconstraint.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var o,n,l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(o=h.default,l(d,o),d.prototype.handleDragEvent=function(t){var e,i=0,n=this.targetPointers[0],r=this.targetPointers[1],o=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);void 0!==this.lastAngle_&&(e=o-this.lastAngle_,this.rotationDelta_+=e,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=e),this.lastAngle_=o;var s,a,l=t.map,u=l.getView();u.getConstraints().rotation!==c.disable&&(s=l.getViewport().getBoundingClientRect(),(a=(0,h.centroid)(this.targetPointers))[0]-=s.left,a[1]-=s.top,this.anchor_=l.getCoordinateFromPixelInternal(a),this.rotating_&&(l.render(),u.adjustRotationInternal(i,this.anchor_)))},d.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))},d.prototype.handleDownEvent=function(t){if(2<=this.targetPointers.length){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},d);function d(t){var e=this,i=t||{},n=i;return n.stopDown||(n.stopDown=r.FALSE),(e=o.call(this,n)||this).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==i.threshold?i.threshold:.3,e.duration_=void 0!==i.duration?i.duration:250,e}i.default=u},{"../functions.js":125,"../rotationconstraint.js":250,"./Pointer.js":178}],177:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Pointer.js")),r=t("../functions.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var o,n,l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(o=c.default,l(h,o),h.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e);var u=a.getViewport().getBoundingClientRect(),h=(0,c.centroid)(this.targetPointers);h[0]-=u.left,h[1]-=u.top,this.anchor_=a.getCoordinateFromPixelInternal(h),a.render(),l.adjustResolutionInternal(e,this.anchor_)},h.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),i=1<this.lastScaleDelta_?1:-1;return e.endInteraction(this.duration_,i),!1}return!0},h.prototype.handleDownEvent=function(t){if(2<=this.targetPointers.length){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},h);function h(t){var e=this,i=t||{},n=i;return n.stopDown||(n.stopDown=r.FALSE),(e=o.call(this,n)||this).anchor_=null,e.duration_=void 0!==i.duration?i.duration:400,e.lastDistance_=void 0,e.lastScaleDelta_=1,e}i.default=u},{"../functions.js":125,"./Pointer.js":178}],178:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.centroid=function(t){for(var e=t.length,i=0,n=0,r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return[i/e,n/e]},i.default=void 0;var n=s(t("./Interaction.js")),r=s(t("../MapBrowserEventType.js")),o=t("../obj.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.getPointerCount=function(){return this.targetPointers.length},c.prototype.handleDownEvent=function(t){return!1},c.prototype.handleDragEvent=function(t){},c.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var e,i,n=!1;return this.updateTrackedPointers_(t),this.handlingDownUpSequence?t.type==r.default.POINTERDRAG?(this.handleDragEvent(t),t.preventDefault()):t.type==r.default.POINTERUP&&(e=this.handleUpEvent(t),this.handlingDownUpSequence=e&&0<this.targetPointers.length):t.type==r.default.POINTERDOWN?(i=this.handleDownEvent(t),this.handlingDownUpSequence=i,n=this.stopDown(i)):t.type==r.default.POINTERMOVE&&this.handleMoveEvent(t),!n},c.prototype.handleMoveEvent=function(t){},c.prototype.handleUpEvent=function(t){return!1},c.prototype.stopDown=function(t){return t},c.prototype.updateTrackedPointers_=function(t){var e,i,n;(n=t.type)!==r.default.POINTERDOWN&&n!==r.default.POINTERDRAG&&n!==r.default.POINTERUP||(i=(e=t.originalEvent).pointerId.toString(),t.type==r.default.POINTERUP?delete this.trackedPointers_[i]:(t.type==r.default.POINTERDOWN||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=(0,o.getValues)(this.trackedPointers_))},c);function c(t){var e=this,i=t||{},e=a.call(this,i)||this;return i.handleDownEvent&&(e.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(e.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(e.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(e.handleUpEvent=i.handleUpEvent),i.stopDown&&(e.stopDown=i.stopDown),e.handlingDownUpSequence=!1,e.trackedPointers_={},e.targetPointers=[],e}i.default=h},{"../MapBrowserEventType.js":24,"../obj.js":203,"./Interaction.js":171}],179:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={ACTIVE:"active"}},{}],180:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=d(t("../Collection.js")),n=d(t("../CollectionEventType.js")),r=d(t("../events/Event.js")),a=d(t("../geom/GeometryType.js")),o=d(t("./Interaction.js")),l=t("../functions.js"),p=t("../obj.js"),u=t("../style/Style.js"),f=t("../array.js"),h=t("../util.js"),c=t("../events/condition.js");function d(t){return t&&t.__esModule?t:{default:t}}var g,m,y,_=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v="select",b=(m=r.default,_(w,m),w),j={},x=(g=o.default,_(S,g),S.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[(0,h.getUid)(t)]=e},S.prototype.getFeatures=function(){return this.features_},S.prototype.getHitTolerance=function(){return this.hitTolerance_},S.prototype.getLayer=function(t){return this.featureLayerAssociation_[(0,h.getUid)(t)]},S.prototype.setHitTolerance=function(t){this.hitTolerance_=t},S.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),g.prototype.setMap.call(this,t),t?(this.features_.addEventListener(n.default.ADD,this.boundAddFeature_),this.features_.addEventListener(n.default.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(n.default.ADD,this.boundAddFeature_),this.features_.removeEventListener(n.default.REMOVE,this.boundRemoveFeature_))},S.prototype.addFeature_=function(t){var e=t.element;this.style_&&this.applySelectedStyle_(e)},S.prototype.removeFeature_=function(t){var e=t.element;this.style_&&this.restorePreviousStyle_(e)},S.prototype.getStyle=function(){return this.style_},S.prototype.applySelectedStyle_=function(t){var e=(0,h.getUid)(t);e in j||(j[e]=t.getStyle()),t.setStyle(this.style_)},S.prototype.restorePreviousStyle_=function(e){var t=(0,h.getUid)(e),i=this.getMap().getInteractions().getArray().filter(function(t){return t instanceof S&&t.getStyle()&&-1!==t.getFeatures().getArray().indexOf(e)});0<i.length?e.setStyle(i[i.length-1].getStyle()):(e.setStyle(j[t]),delete j[t])},S.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[(0,h.getUid)(t)]},S.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var i=this.addCondition_(t),n=this.removeCondition_(t),r=this.toggleCondition_(t),e=!i&&!n&&!r,o=t.map,s=this.getFeatures(),a=[],l=[];if(e){(0,p.clear)(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return l.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=s.getLength()-1;0<=u;--u){var h=s.item(u),c=l.indexOf(h);-1<c?l.splice(c,1):(s.remove(h),a.push(h))}0!==l.length&&s.extend(l)}else{o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return!i&&!r||(0,f.includes)(s.getArray(),t)?(n||r)&&(0,f.includes)(s.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(l.push(t),this.addFeatureLayerAssociation_(t,e)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var d=a.length-1;0<=d;--d)s.remove(a[d]);s.extend(l)}return(0<l.length||0<a.length)&&this.dispatchEvent(new b(v,l,a,t)),!0},S);function S(t){var e,i,n,r=g.call(this)||this,o=t||{};return r.boundAddFeature_=r.addFeature_.bind(r),r.boundRemoveFeature_=r.removeFeature_.bind(r),r.condition_=o.condition?o.condition:c.singleClick,r.addCondition_=o.addCondition?o.addCondition:c.never,r.removeCondition_=o.removeCondition?o.removeCondition:c.never,r.toggleCondition_=o.toggleCondition?o.toggleCondition:c.shiftKeyOnly,r.multi_=!!o.multi&&o.multi,r.filter_=o.filter?o.filter:l.TRUE,r.hitTolerance_=o.hitTolerance?o.hitTolerance:0,r.style_=void 0!==o.style?o.style:(n=(0,u.createEditingStyle)(),(0,f.extend)(n[a.default.POLYGON],n[a.default.LINE_STRING]),(0,f.extend)(n[a.default.GEOMETRY_COLLECTION],n[a.default.LINE_STRING]),function(t){return t.getGeometry()?n[t.getGeometry().getType()]:null}),r.features_=o.features||new s.default,i=o.layers?"function"==typeof o.layers?o.layers:(e=o.layers,function(t){return(0,f.includes)(e,t)}):l.TRUE,r.layerFilter_=i,r.featureLayerAssociation_={},r}function w(t,e,i,n){var r=m.call(this,t)||this;return r.selected=e,r.deselected=i,r.mapBrowserEvent=n,r}i.default=x},{"../Collection.js":10,"../CollectionEventType.js":11,"../array.js":44,"../events/Event.js":65,"../events/condition.js":69,"../functions.js":125,"../geom/GeometryType.js":131,"../obj.js":203,"../style/Style.js":302,"../util.js":313,"./Interaction.js":171}],181:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=p(t("../CollectionEventType.js")),s=p(t("../events/EventType.js")),P=p(t("../geom/GeometryType.js")),n=p(t("./Pointer.js")),o=p(t("../structs/RBush.js")),a=p(t("../source/VectorEventType.js")),l=t("../functions.js"),E=t("../extent.js"),T=t("../coordinate.js"),c=t("../geom/Polygon.js"),O=t("../proj.js"),u=t("../util.js"),h=t("../obj.js"),d=t("../events.js");function p(t){return t&&t.__esModule?t:{default:t}}var f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});function m(t){return t.feature?t.feature:t.element?t.element:void 0}var y,C=[],_=(y=n.default,g(v,y),v.prototype.addFeature=function(t,e){var i,n=void 0===e||e,r=(0,u.getUid)(t),o=t.getGeometry();!o||(i=this.SEGMENT_WRITERS_[o.getType()])&&(this.indexedFeaturesExtents_[r]=o.getExtent((0,E.createEmpty)()),i(t,o)),n&&(this.featureChangeListenerKeys_[r]=(0,d.listen)(t,s.default.CHANGE,this.handleFeatureChange_,this))},v.prototype.forEachFeatureAdd_=function(t){this.addFeature(t)},v.prototype.forEachFeatureRemove_=function(t){this.removeFeature(t)},v.prototype.getFeatures_=function(){var t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t},v.prototype.handleEvent=function(t){var e=this.snapTo(t.pixel,t.coordinate,t.map);return e.snapped&&(t.coordinate=e.vertex.slice(0,2),t.pixel=e.vertexPixel),y.prototype.handleEvent.call(this,t)},v.prototype.handleFeatureAdd_=function(t){var e=m(t);this.addFeature(e)},v.prototype.handleFeatureRemove_=function(t){var e=m(t);this.removeFeature(e)},v.prototype.handleFeatureChange_=function(t){var e,i=t.target;this.handlingDownUpSequence?(e=(0,u.getUid)(i))in this.pendingFeatures_||(this.pendingFeatures_[e]=i):this.updateFeature_(i)},v.prototype.handleUpEvent=function(t){var e=(0,h.getValues)(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},v.prototype.removeFeature=function(e,t){var i=void 0===t||t,n=(0,u.getUid)(e),r=this.indexedFeaturesExtents_[n];if(r){var o=this.rBush_,s=[];o.forEachInExtent(r,function(t){e===t.feature&&s.push(t)});for(var a=s.length-1;0<=a;--a)o.remove(s[a])}i&&((0,d.unlistenByKey)(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])},v.prototype.setMap=function(t){var e=this.getMap(),i=this.featuresListenerKeys_,n=this.getFeatures_();e&&(i.forEach(d.unlistenByKey),i.length=0,n.forEach(this.forEachFeatureRemove_.bind(this))),y.prototype.setMap.call(this,t),t&&(this.features_?i.push((0,d.listen)(this.features_,r.default.ADD,this.handleFeatureAdd_,this),(0,d.listen)(this.features_,r.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,d.listen)(this.source_,a.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,d.listen)(this.source_,a.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),n.forEach(this.forEachFeatureAdd_.bind(this)))},v.prototype.snapTo=function(t,e,i){var n=i.getCoordinateFromPixel([t[0]-this.pixelTolerance_,t[1]+this.pixelTolerance_]),r=i.getCoordinateFromPixel([t[0]+this.pixelTolerance_,t[1]-this.pixelTolerance_]),o=(0,E.boundingExtent)([n,r]),s=this.rBush_.getInExtent(o);this.vertex_&&!this.edge_&&(s=s.filter(function(t){return t.feature.getGeometry().getType()!==P.default.CIRCLE}));var a=!1,l=null,u=null;if(0===s.length)return{snapped:a,vertex:l,vertexPixel:u};for(var h,c=i.getView().getProjection(),d=(0,O.fromUserCoordinate)(e,c),p=1/0,f=0;f<s.length;++f){var g=s[f];C[0]=(0,O.fromUserCoordinate)(g.segment[0],c),C[1]=(0,O.fromUserCoordinate)(g.segment[1],c);var m=(0,T.squaredDistanceToSegment)(d,C);m<p&&(h=g,p=m)}var y,_,v,b,j,x,S,w=h.segment;return this.vertex_&&!this.edge_?(y=i.getPixelFromCoordinate(w[0]),_=i.getPixelFromCoordinate(w[1]),v=(0,T.squaredDistance)(t,y),b=(0,T.squaredDistance)(t,_),Math.sqrt(Math.min(v,b))<=this.pixelTolerance_&&(a=!0,l=b<v?w[1]:w[0],u=i.getPixelFromCoordinate(l))):this.edge_&&(l=(j=h.feature.getGeometry().getType()===P.default.CIRCLE)?(x=h.feature.getGeometry(),(S=(0,O.getUserProjection)())&&(x=x.clone().transform(S,c)),(0,O.toUserCoordinate)((0,T.closestOnCircle)(d,x),c)):(C[0]=(0,O.fromUserCoordinate)(w[0],c),C[1]=(0,O.fromUserCoordinate)(w[1],c),(0,O.toUserCoordinate)((0,T.closestOnSegment)(d,C),c)),u=i.getPixelFromCoordinate(l),(0,T.distance)(t,u)<=this.pixelTolerance_&&(a=!0,this.vertex_&&!j)&&(y=i.getPixelFromCoordinate(w[0]),_=i.getPixelFromCoordinate(w[1]),v=(0,T.squaredDistance)(u,y),b=(0,T.squaredDistance)(u,_),Math.sqrt(Math.min(v,b))<=this.pixelTolerance_&&(l=b<v?w[1]:w[0],u=i.getPixelFromCoordinate(l)))),a&&(u=[Math.round(u[0]),Math.round(u[1])]),{snapped:a,vertex:l,vertexPixel:u}},v.prototype.updateFeature_=function(t){this.removeFeature(t,!1),this.addFeature(t,!1)},v.prototype.writeCircleGeometry_=function(t,e){var i=this.getMap().getView().getProjection(),n=e,r=(0,O.getUserProjection)();r&&(n=n.clone().transform(r,i));var o=(0,c.fromCircle)(n);r&&o.transform(i,r);for(var s=o.getCoordinates()[0],a=0,l=s.length-1;a<l;++a){var u=s.slice(a,a+2),h={feature:t,segment:u};this.rBush_.insert((0,E.boundingExtent)(u),h)}},v.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n){var r=this.SEGMENT_WRITERS_[i[n].getType()];r&&r(t,i[n])}},v.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length-1;n<r;++n){var o=i.slice(n,n+2),s={feature:t,segment:o};this.rBush_.insert((0,E.boundingExtent)(o),s)}},v.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,segment:l};this.rBush_.insert((0,E.boundingExtent)(l),u)}},v.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n){var o=i[n],s={feature:t,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},v.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,h=l.length-1;u<h;++u){var c=l.slice(u,u+2),d={feature:t,segment:c};this.rBush_.insert((0,E.boundingExtent)(c),d)}},v.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},v.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,segment:l};this.rBush_.insert((0,E.boundingExtent)(l),u)}},v);function v(t){var e=this,i=t||{},n=i;return n.handleDownEvent||(n.handleDownEvent=l.TRUE),n.stopDown||(n.stopDown=l.FALSE),(e=y.call(this,n)||this).source_=i.source?i.source:null,e.vertex_=void 0===i.vertex||i.vertex,e.edge_=void 0===i.edge||i.edge,e.features_=i.features?i.features:null,e.featuresListenerKeys_=[],e.featureChangeListenerKeys_={},e.indexedFeaturesExtents_={},e.pendingFeatures_={},e.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,e.rBush_=new o.default,e.SEGMENT_WRITERS_={Point:e.writePointGeometry_.bind(e),LineString:e.writeLineStringGeometry_.bind(e),LinearRing:e.writeLineStringGeometry_.bind(e),Polygon:e.writePolygonGeometry_.bind(e),MultiPoint:e.writeMultiPointGeometry_.bind(e),MultiLineString:e.writeMultiLineStringGeometry_.bind(e),MultiPolygon:e.writeMultiPolygonGeometry_.bind(e),GeometryCollection:e.writeGeometryCollectionGeometry_.bind(e),Circle:e.writeCircleGeometry_.bind(e)},e}i.default=_},{"../CollectionEventType.js":11,"../coordinate.js":60,"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"../functions.js":125,"../geom/GeometryType.js":131,"../geom/Polygon.js":138,"../obj.js":203,"../proj.js":205,"../source/VectorEventType.js":278,"../structs/RBush.js":290,"../util.js":313,"./Pointer.js":178}],182:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.TranslateEvent=void 0;var o=h(t("../Collection.js")),n=h(t("../events/Event.js")),s=h(t("./Property.js")),r=h(t("./Pointer.js")),a=t("../functions.js"),l=t("../Object.js"),u=t("../array.js");function h(t){return t&&t.__esModule?t:{default:t}}var c,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f="translatestart",g="translating",m="translateend",y=(c=n.default,p(_,c),_);function _(t,e,i,n,r){var o=c.call(this,t)||this;return o.features=e,o.coordinate=i,o.startCoordinate=n,o.mapBrowserEvent=r,o}i.TranslateEvent=y;var v,b=(v=r.default,p(j,v),j.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),this.lastCoordinate_||!this.lastFeature_)return!1;this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new o.default([this.lastFeature_]);return this.dispatchEvent(new y(f,e,t.coordinate,this.startCoordinate_,t)),!0},j.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new o.default([this.lastFeature_]);return this.dispatchEvent(new y(m,e,t.coordinate,this.startCoordinate_,t)),!(this.startCoordinate_=null)}return!1},j.prototype.handleDragEvent=function(t){var e,i,n,r;this.lastCoordinate_&&(e=t.coordinate,i=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],(r=this.features_||new o.default([this.lastFeature_])).forEach(function(t){var e=t.getGeometry();e.translate(i,n),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new y(g,r,e,this.startCoordinate_,t)))},j.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},j.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||(0,u.includes)(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},j.prototype.getHitTolerance=function(){return this.hitTolerance_},j.prototype.setHitTolerance=function(t){this.hitTolerance_=t},j.prototype.setMap=function(t){var e=this.getMap();v.prototype.setMap.call(this,t),this.updateState_(e)},j.prototype.handleActiveChanged_=function(){this.updateState_(null)},j.prototype.updateState_=function(t){var e=this.getMap(),i=this.getActive();e&&i||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},j);function j(t){var e,i,n=this,r=t||{};return(n=v.call(this,r)||this).lastCoordinate_=null,n.startCoordinate_=null,n.features_=void 0!==r.features?r.features:null,i=r.layers?"function"==typeof r.layers?r.layers:(e=r.layers,function(t){return(0,u.includes)(e,t)}):a.TRUE,n.layerFilter_=i,n.filter_=r.filter?r.filter:a.TRUE,n.hitTolerance_=r.hitTolerance?r.hitTolerance:0,n.lastFeature_=null,n.addEventListener((0,l.getChangeEventType)(s.default.ACTIVE),n.handleActiveChanged_),n}i.default=b},{"../Collection.js":10,"../Object.js":28,"../array.js":44,"../events/Event.js":65,"../functions.js":125,"./Pointer.js":178,"./Property.js":179}],183:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"Group",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"Heatmap",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"Image",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"Layer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"Tile",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"Vector",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"VectorImage",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"VectorTile",{enumerable:!0,get:function(){return h.default}});var n=c(t("./layer/Group.js")),r=c(t("./layer/Heatmap.js")),o=c(t("./layer/Image.js")),s=c(t("./layer/Layer.js")),a=c(t("./layer/Tile.js")),l=c(t("./layer/Vector.js")),u=c(t("./layer/VectorImage.js")),h=c(t("./layer/VectorTile.js"));function c(t){return t&&t.__esModule?t:{default:t}}},{"./layer/Group.js":189,"./layer/Heatmap.js":190,"./layer/Image.js":191,"./layer/Layer.js":192,"./layer/Tile.js":194,"./layer/Vector.js":196,"./layer/VectorImage.js":197,"./layer/VectorTile.js":198}],184:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=u(t("../Object.js")),r=u(t("./Property.js")),o=t("../util.js"),s=t("../asserts.js"),a=t("../obj.js"),l=t("../math.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(h=n.default,d(f,h),f.prototype.getClassName=function(){return this.className_},f.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=(0,l.clamp)(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i?i:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e},f.prototype.getLayersArray=function(t){return(0,o.abstract)()},f.prototype.getLayerStatesArray=function(t){return(0,o.abstract)()},f.prototype.getExtent=function(){return this.get(r.default.EXTENT)},f.prototype.getMaxResolution=function(){return this.get(r.default.MAX_RESOLUTION)},f.prototype.getMinResolution=function(){return this.get(r.default.MIN_RESOLUTION)},f.prototype.getMinZoom=function(){return this.get(r.default.MIN_ZOOM)},f.prototype.getMaxZoom=function(){return this.get(r.default.MAX_ZOOM)},f.prototype.getOpacity=function(){return this.get(r.default.OPACITY)},f.prototype.getSourceState=function(){return(0,o.abstract)()},f.prototype.getVisible=function(){return this.get(r.default.VISIBLE)},f.prototype.getZIndex=function(){return this.get(r.default.Z_INDEX)},f.prototype.setExtent=function(t){this.set(r.default.EXTENT,t)},f.prototype.setMaxResolution=function(t){this.set(r.default.MAX_RESOLUTION,t)},f.prototype.setMinResolution=function(t){this.set(r.default.MIN_RESOLUTION,t)},f.prototype.setMaxZoom=function(t){this.set(r.default.MAX_ZOOM,t)},f.prototype.setMinZoom=function(t){this.set(r.default.MIN_ZOOM,t)},f.prototype.setOpacity=function(t){(0,s.assert)("number"==typeof t,64),this.set(r.default.OPACITY,t)},f.prototype.setVisible=function(t){this.set(r.default.VISIBLE,t)},f.prototype.setZIndex=function(t){this.set(r.default.Z_INDEX,t)},f.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),h.prototype.disposeInternal.call(this)},f);function f(t){var e=h.call(this)||this,i=(0,a.assign)({},t);return i[r.default.OPACITY]=void 0!==t.opacity?t.opacity:1,(0,s.assert)("number"==typeof i[r.default.OPACITY],64),i[r.default.VISIBLE]=void 0===t.visible||t.visible,i[r.default.Z_INDEX]=t.zIndex,i[r.default.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,i[r.default.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,i[r.default.MIN_ZOOM]=void 0!==t.minZoom?t.minZoom:-1/0,i[r.default.MAX_ZOOM]=void 0!==t.maxZoom?t.maxZoom:1/0,e.className_=void 0!==i.className?t.className:"ol-layer",delete i.className,e.setProperties(i),e.state_=null,e}i.default=p},{"../Object.js":28,"../asserts.js":45,"../math.js":201,"../obj.js":203,"../util.js":313,"./Property.js":193}],185:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Layer.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t){var e=t||{};return o.call(this,e)||this}i.default=l},{"./Layer.js":192}],186:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./Layer.js")),r=s(t("./TileProperty.js")),o=t("../obj.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.getPreload=function(){return this.get(r.default.PRELOAD)},c.prototype.setPreload=function(t){this.set(r.default.PRELOAD,t)},c.prototype.getUseInterimTilesOnError=function(){return this.get(r.default.USE_INTERIM_TILES_ON_ERROR)},c.prototype.setUseInterimTilesOnError=function(t){this.set(r.default.USE_INTERIM_TILES_ON_ERROR,t)},c);function c(t){var e=this,i=t||{},n=(0,o.assign)({},i);return delete n.preload,delete n.useInterimTilesOnError,(e=a.call(this,n)||this).setPreload(void 0!==i.preload?i.preload:0),e.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),e}i.default=h},{"../obj.js":203,"./Layer.js":192,"./TileProperty.js":195}],187:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Layer.js"))&&n.__esModule?n:{default:n},o=t("../obj.js"),s=t("../style/Style.js");var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h="renderOrder",c=(a=r.default,u(d,a),d.prototype.getDeclutter=function(){return this.declutter_},d.prototype.getFeatures=function(t){return a.prototype.getFeatures.call(this,t)},d.prototype.getRenderBuffer=function(){return this.renderBuffer_},d.prototype.getRenderOrder=function(){return this.get(h)},d.prototype.getStyle=function(){return this.style_},d.prototype.getStyleFunction=function(){return this.styleFunction_},d.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},d.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},d.prototype.setRenderOrder=function(t){this.set(h,t)},d.prototype.setStyle=function(t){this.style_=void 0!==t?t:s.createDefaultStyle,this.styleFunction_=null===t?void 0:(0,s.toFunction)(this.style_),this.changed()},d);function d(t){var e=this,i=t||{},n=(0,o.assign)({},i);return delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,(e=a.call(this,n)||this).declutter_=void 0!==i.declutter&&i.declutter,e.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,e.style_=null,e.styleFunction_=void 0,e.setStyle(i.style),e.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,e.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,e}i.default=c},{"../obj.js":203,"../style/Style.js":302,"./Layer.js":192}],188:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=v(t("../Collection.js")),o=v(t("../render/EventType.js")),f=v(t("../Feature.js")),s=v(t("../style/Fill.js")),a=v(t("../geom/GeometryLayout.js")),l=v(t("../geom/LineString.js")),u=v(t("../geom/Point.js")),h=v(t("../style/Stroke.js")),c=v(t("../style/Style.js")),d=v(t("../style/Text.js")),n=v(t("./Vector.js")),p=v(t("../source/Vector.js")),P=t("../extent.js"),g=t("../obj.js"),S=t("../math.js"),m=t("../coordinate.js"),y=t("../proj.js"),E=t("../render.js"),_=t("../geom/flat/geodesic.js");function v(t){return t&&t.__esModule?t:{default:t}}var b,j,x=(j=function(t,e){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),w=new h.default({color:"rgba(0,0,0,0.2)"}),T=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],O=(b=n.default,x(C,b),C.prototype.strategyFunction=function(t,e){var i=t.slice();return this.projection_&&this.getSource().getWrapX()&&(0,P.wrapX)(i,this.projection_),this.loadedExtent_&&((0,P.approximatelyEquals)(this.loadedExtent_,i,e)?i=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[i]},C.prototype.loaderFunction=function(t,e,i){this.loadedExtent_=t;var n=this.getSource(),r=this.getExtent()||[-1/0,-1/0,1/0,1/0],o=(0,P.getIntersection)(r,t);if(!(this.renderedExtent_&&(0,P.equals)(this.renderedExtent_,o)||(this.renderedExtent_=o,(0,P.isEmpty)(o)))){var s=(0,P.getCenter)(o),a=e*e/4;this.projection_&&(0,y.equivalent)(this.projection_,i)||this.updateProjectionInfo_(i),this.createGraticule_(o,s,e,a);var l,u=this.meridians_.length+this.parallels_.length;for(this.meridiansLabels_&&(u+=this.meridians_.length),this.parallelsLabels_&&(u+=this.parallels_.length);u>this.featurePool_.length;)l=new f.default,this.featurePool_.push(l);var h=n.getFeaturesCollection();h.clear();for(var c=0,d=0,p=this.meridians_.length;d<p;++d)(l=this.featurePool_[c++]).setGeometry(this.meridians_[d]),l.setStyle(this.lineStyle_),h.push(l);for(d=0,p=this.parallels_.length;d<p;++d)(l=this.featurePool_[c++]).setGeometry(this.parallels_[d]),l.setStyle(this.lineStyle_),h.push(l)}},C.prototype.addMeridian_=function(t,e,i,n,r,o){var s,a=this.getMeridian_(t,e,i,n,o);return(0,P.intersects)(a.getExtent(),r)&&(this.meridiansLabels_&&(s=this.lonLabelFormatter_(t),o in this.meridiansLabels_?this.meridiansLabels_[o].text=s:this.meridiansLabels_[o]={geom:new u.default([]),text:s}),this.meridians_[o++]=a),o},C.prototype.addParallel_=function(t,e,i,n,r,o){var s,a=this.getParallel_(t,e,i,n,o);return(0,P.intersects)(a.getExtent(),r)&&(this.parallelsLabels_&&(s=this.latLabelFormatter_(t),o in this.parallelsLabels_?this.parallelsLabels_[o].text=s:this.parallelsLabels_[o]={geom:new u.default([]),text:s}),this.parallels_[o++]=a),o},C.prototype.drawLabels_=function(t){var e,i,n,r,o,s,a=t.frameState.viewState.rotation,l=t.frameState.extent,u=(0,P.getCenter)(l),h=l;a&&(e=(0,P.getWidth)(l),i=(0,P.getHeight)(l),n=Math.abs(Math.cos(a)),o=((r=Math.abs(Math.sin(a)))*i-n*e)/(r*r-n*n),s=(r*e-n*i)/(r*r-n*n),h=[u[0]-o/2,u[1]-s/2,u[0]+o/2,u[1]+s/2]);var c=0,d=0,p=this.latLabelPosition_<.5,f=this.projection_.getExtent(),g=(0,P.getWidth)(f);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,P.containsExtent)(f,l)&&(c=Math.floor((l[0]-f[0])/g),d=Math.ceil((l[2]-f[2])/g),p=p!==Math.abs(a)>Math.PI/2);for(var m=(0,E.getVectorContext)(t),y=c;y<=d;++y){var _=this.meridians_.length+this.parallels_.length,v=void 0,b=void 0,j=void 0,x=void 0;if(this.meridiansLabels_)for(b=0,j=this.meridiansLabels_.length;b<j;++b){var S=this.meridians_[b];a||0!==y?((w=S.clone()).translate(y*g,0),w.rotate(-a,u),(x=this.getMeridianPoint_(w,h,b)).rotate(a,u)):x=this.getMeridianPoint_(S,l,b),(v=this.featurePool_[_++]).setGeometry(x),v.set("graticule_label",this.meridiansLabels_[b].text),m.drawFeature(v,this.lonLabelStyle_(v))}if(this.parallelsLabels_&&(y===c&&p||y===d&&!p))for(b=0,j=this.parallels_.length;b<j;++b){var w,S=this.parallels_[b];a||0!==y?((w=S.clone()).translate(y*g,0),w.rotate(-a,u),(x=this.getParallelPoint_(w,h,b)).rotate(a,u)):x=this.getParallelPoint_(S,l,b),(v=this.featurePool_[_++]).setGeometry(x),v.set("graticule_label",this.parallelsLabels_[b].text),m.drawFeature(v,this.latLabelStyle_(v))}}},C.prototype.createGraticule_=function(t,e,i,n){var r=this.getInterval_(i);if(-1==r)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var o=!1,s=this.projection_.getExtent(),a=(0,P.getWidth)(s);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,P.containsExtent)(s,t)&&((0,P.getWidth)(t)>=a?(t[0]=s[0],t[2]=s[2]):o=!0);var l=[(0,S.clamp)(e[0],this.minX_,this.maxX_),(0,S.clamp)(e[1],this.minY_,this.maxY_)],u=this.toLonLatTransform_(l);isNaN(u[1])&&(u[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);var h,c,d,p,f=(0,S.clamp)(u[0],this.minLon_,this.maxLon_),g=(0,S.clamp)(u[1],this.minLat_,this.maxLat_),m=this.maxLines_,y=t;o||(y=[(0,S.clamp)(t[0],this.minX_,this.maxX_),(0,S.clamp)(t[1],this.minY_,this.maxY_),(0,S.clamp)(t[2],this.minX_,this.maxX_),(0,S.clamp)(t[3],this.minY_,this.maxY_)]);var _=(0,P.applyTransform)(y,this.toLonLatTransform_,void 0,8),v=_[3],b=_[2],j=_[1],x=_[0];if(o||((0,P.containsCoordinate)(y,this.bottomLeft_)&&(x=this.minLon_,j=this.minLat_),(0,P.containsCoordinate)(y,this.bottomRight_)&&(b=this.maxLon_,j=this.minLat_),(0,P.containsCoordinate)(y,this.topLeft_)&&(x=this.minLon_,v=this.maxLat_),(0,P.containsCoordinate)(y,this.topRight_)&&(b=this.maxLon_,v=this.maxLat_),v=(0,S.clamp)(v,g,this.maxLat_),b=(0,S.clamp)(b,f,this.maxLon_),j=(0,S.clamp)(j,this.minLat_,g),x=(0,S.clamp)(x,this.minLon_,f)),f=Math.floor(f/r)*r,p=(0,S.clamp)(f,this.minLon_,this.maxLon_),c=this.addMeridian_(p,j,v,n,t,0),h=0,o)for(;(p-=r)>=x&&h++<m;)c=this.addMeridian_(p,j,v,n,t,c);else for(;p!=this.minLon_&&h++<m;)p=Math.max(p-r,this.minLon_),c=this.addMeridian_(p,j,v,n,t,c);if(p=(0,S.clamp)(f,this.minLon_,this.maxLon_),h=0,o)for(;(p+=r)<=b&&h++<m;)c=this.addMeridian_(p,j,v,n,t,c);else for(;p!=this.maxLon_&&h++<m;)p=Math.min(p+r,this.maxLon_),c=this.addMeridian_(p,j,v,n,t,c);for(this.meridians_.length=c,this.meridiansLabels_&&(this.meridiansLabels_.length=c),g=Math.floor(g/r)*r,d=(0,S.clamp)(g,this.minLat_,this.maxLat_),c=this.addParallel_(d,x,b,n,t,0),h=0;d!=this.minLat_&&h++<m;)d=Math.max(d-r,this.minLat_),c=this.addParallel_(d,x,b,n,t,c);for(d=(0,S.clamp)(g,this.minLat_,this.maxLat_),h=0;d!=this.maxLat_&&h++<m;)d=Math.min(d+r,this.maxLat_),c=this.addParallel_(d,x,b,n,t,c);this.parallels_.length=c,this.parallelsLabels_&&(this.parallelsLabels_.length=c)},C.prototype.getInterval_=function(t){for(var e=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1],n=-1,r=Math.pow(this.targetSize_*t,2),o=[],s=[],a=0,l=this.intervals_.length;a<l;++a){var u=(0,S.clamp)(this.intervals_[a]/2,0,90),h=(0,S.clamp)(i,-90+u,90-u);if(o[0]=e-u,o[1]=h-u,s[0]=e+u,s[1]=h+u,this.fromLonLatTransform_(o,o),this.fromLonLatTransform_(s,s),Math.pow(s[0]-o[0],2)+Math.pow(s[1]-o[1],2)<=r)break;n=this.intervals_[a]}return n},C.prototype.getMeridian_=function(t,e,i,n,r){var o=(0,_.meridian)(t,e,i,this.projection_,n),s=this.meridians_[r];return s?(s.setFlatCoordinates(a.default.XY,o),s.changed()):(s=new l.default(o,a.default.XY),this.meridians_[r]=s),s},C.prototype.getMeridianPoint_=function(t,e,i){var n=t.getFlatCoordinates(),r=1,o=n.length-1;n[r]>n[o]&&(r=o,o=1);var s=Math.max(e[1],n[r]),a=Math.min(e[3],n[o]),l=(0,S.clamp)(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,s,a),u=[n[r-1]+(n[o-1]-n[r-1])*(l-n[r])/(n[o]-n[r]),l],h=this.meridiansLabels_[i].geom;return h.setCoordinates(u),h},C.prototype.getMeridians=function(){return this.meridians_},C.prototype.getParallel_=function(t,e,i,n,r){var o=(0,_.parallel)(t,e,i,this.projection_,n),s=this.parallels_[r];return s?(s.setFlatCoordinates(a.default.XY,o),s.changed()):s=new l.default(o,a.default.XY),s},C.prototype.getParallelPoint_=function(t,e,i){var n=t.getFlatCoordinates(),r=0,o=n.length-2;n[r]>n[o]&&(r=o,o=0);var s=Math.max(e[0],n[r]),a=Math.min(e[2],n[o]),l=(0,S.clamp)(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,s,a),u=[l,n[r+1]+(n[o+1]-n[r+1])*(l-n[r])/(n[o]-n[r])],h=this.parallelsLabels_[i].geom;return h.setCoordinates(u),h},C.prototype.getParallels=function(){return this.parallels_},C.prototype.updateProjectionInfo_=function(t){var e=(0,y.get)("EPSG:4326"),i=t.getWorldExtent();this.maxLat_=i[3],this.maxLon_=i[2],this.minLat_=i[1],this.minLon_=i[0];var a,l=(0,y.getTransform)(t,e);this.minLon_<this.maxLon_?this.toLonLatTransform_=l:(a=this.minLon_+this.maxLon_/2,this.maxLon_+=360,this.toLonLatTransform_=function(t,e,i){for(var n=i||2,r=l(t,e,n),o=0,s=r.length;o<s;o+=n)r[o]<a&&(r[o]+=360);return r}),this.fromLonLatTransform_=(0,y.getTransform)(e,t);var n=(0,P.applyTransform)([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=n[0],this.maxX_=n[2],this.minY_=n[1],this.maxY_=n[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_((0,P.getCenter)(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t},C);function C(t){var e=this,i=t||{},n=(0,g.assign)({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},i);return delete n.maxLines,delete n.strokeStyle,delete n.targetSize,delete n.showLabels,delete n.lonLabelFormatter,delete n.latLabelFormatter,delete n.lonLabelPosition,delete n.latLabelPosition,delete n.lonLabelStyle,delete n.latLabelStyle,delete n.intervals,(e=b.call(this,n)||this).projection_=null,e.maxLat_=1/0,e.maxLon_=1/0,e.minLat_=-1/0,e.minLon_=-1/0,e.maxX_=1/0,e.maxY_=1/0,e.minX_=-1/0,e.minY_=-1/0,e.targetSize_=void 0!==i.targetSize?i.targetSize:100,e.maxLines_=void 0!==i.maxLines?i.maxLines:100,e.meridians_=[],e.parallels_=[],e.strokeStyle_=void 0!==i.strokeStyle?i.strokeStyle:w,e.fromLonLatTransform_=void 0,e.toLonLatTransform_=void 0,e.projectionCenterLonLat_=null,e.bottomLeft_=null,e.bottomRight_=null,e.topLeft_=null,e.topRight_=null,e.meridiansLabels_=null,e.parallelsLabels_=null,i.showLabels&&(e.lonLabelFormatter_=null==i.lonLabelFormatter?m.degreesToStringHDMS.bind(e,"EW"):i.lonLabelFormatter,e.latLabelFormatter_=null==i.latLabelFormatter?m.degreesToStringHDMS.bind(e,"NS"):i.latLabelFormatter,e.lonLabelPosition_=null==i.lonLabelPosition?0:i.lonLabelPosition,e.latLabelPosition_=null==i.latLabelPosition?1:i.latLabelPosition,e.lonLabelStyleBase_=new c.default({text:void 0!==i.lonLabelStyle?i.lonLabelStyle.clone():new d.default({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new s.default({color:"rgba(0,0,0,1)"}),stroke:new h.default({color:"rgba(255,255,255,1)",width:3})})}),e.lonLabelStyle_=function(t){var e=t.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_}.bind(e),e.latLabelStyleBase_=new c.default({text:void 0!==i.latLabelStyle?i.latLabelStyle.clone():new d.default({font:"12px Calibri,sans-serif",textAlign:"right",fill:new s.default({color:"rgba(0,0,0,1)"}),stroke:new h.default({color:"rgba(255,255,255,1)",width:3})})}),e.latLabelStyle_=function(t){var e=t.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_}.bind(e),e.meridiansLabels_=[],e.parallelsLabels_=[],e.addEventListener(o.default.POSTRENDER,e.drawLabels_.bind(e))),e.intervals_=void 0!==i.intervals?i.intervals:T,e.setSource(new p.default({loader:e.loaderFunction.bind(e),strategy:e.strategyFunction.bind(e),features:new r.default,overlaps:!1,useSpatialIndex:!1,wrapX:i.wrapX})),e.featurePool_=[],e.lineStyle_=new c.default({stroke:e.strokeStyle_}),e.loadedExtent_=null,e.renderedExtent_=null,e.setRenderOrder(null),e}i.default=O},{"../Collection.js":10,"../Feature.js":13,"../coordinate.js":60,"../extent.js":70,"../geom/GeometryLayout.js":130,"../geom/LineString.js":132,"../geom/Point.js":137,"../geom/flat/geodesic.js":146,"../math.js":201,"../obj.js":203,"../proj.js":205,"../render.js":213,"../render/EventType.js":216,"../source/Vector.js":277,"../style/Fill.js":293,"../style/Stroke.js":301,"../style/Style.js":302,"../style/Text.js":303,"./Vector.js":196}],189:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=g(t("./Base.js")),o=g(t("../Collection.js")),s=g(t("../CollectionEventType.js")),a=g(t("../events/EventType.js")),l=g(t("../ObjectEventType.js")),r=g(t("../source/State.js")),u=t("../asserts.js"),h=t("../obj.js"),c=t("../Object.js"),d=t("../extent.js"),p=t("../util.js"),f=t("../events.js");function g(t){return t&&t.__esModule?t:{default:t}}var m,y,_=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v="layers",b=(m=n.default,_(j,m),j.prototype.handleLayerChange_=function(){this.changed()},j.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(f.unlistenByKey),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push((0,f.listen)(t,s.default.ADD,this.handleLayersAdd_,this),(0,f.listen)(t,s.default.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(f.unlistenByKey);(0,h.clear)(this.listenerKeys_);for(var i=t.getArray(),n=0,r=i.length;n<r;n++){var o=i[n];this.listenerKeys_[(0,p.getUid)(o)]=[(0,f.listen)(o,l.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,f.listen)(o,a.default.CHANGE,this.handleLayerChange_,this)]}this.changed()},j.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[(0,p.getUid)(e)]=[(0,f.listen)(e,l.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,f.listen)(e,a.default.CHANGE,this.handleLayerChange_,this)],this.changed()},j.prototype.handleLayersRemove_=function(t){var e=t.element,i=(0,p.getUid)(e);this.listenerKeys_[i].forEach(f.unlistenByKey),delete this.listenerKeys_[i],this.changed()},j.prototype.getLayers=function(){return this.get(v)},j.prototype.setLayers=function(t){this.set(v,t)},j.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e},j.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});for(var n=this.getLayerState(),r=i,o=e.length;r<o;r++){var s=e[r];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),s.minZoom=Math.max(s.minZoom,n.minZoom),s.maxZoom=Math.min(s.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==s.extent?s.extent=(0,d.getIntersection)(s.extent,n.extent):s.extent=n.extent)}return e},j.prototype.getSourceState=function(){return r.default.READY},j);function j(t){var e=this,i=t||{},n=(0,h.assign)({},i);delete n.layers;var r=i.layers;return(e=m.call(this,n)||this).layersListenerKeys_=[],e.listenerKeys_={},e.addEventListener((0,c.getChangeEventType)(v),e.handleLayersChanged_),r?Array.isArray(r)?r=new o.default(r.slice(),{unique:!0}):(0,u.assert)("function"==typeof r.getArray,43):r=new o.default(void 0,{unique:!0}),e.setLayers(r),e}i.default=b},{"../Collection.js":10,"../CollectionEventType.js":11,"../Object.js":28,"../ObjectEventType.js":29,"../asserts.js":45,"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"../obj.js":203,"../source/State.js":267,"../util.js":313,"./Base.js":184}],190:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=u(t("./Vector.js")),r=u(t("../renderer/webgl/PointsLayer.js")),o=t("../obj.js"),s=t("../math.js"),a=t("../dom.js"),l=t("../Object.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p="blur",f="gradient",g="radius",m=["#00f","#0ff","#0f0","#ff0","#f00"],y=(h=n.default,d(_,h),_.prototype.getBlur=function(){return this.get(p)},_.prototype.getGradient=function(){return this.get(f)},_.prototype.getRadius=function(){return this.get(g)},_.prototype.handleGradientChanged_=function(){this.gradient_=function(t){for(var e=(0,a.createCanvasContext2D)(1,256),i=e.createLinearGradient(0,0,1,256),n=1/(t.length-1),r=0,o=t.length;r<o;++r)i.addColorStop(r*n,t[r]);return e.fillStyle=i,e.fillRect(0,0,1,256),e.canvas}(this.getGradient())},_.prototype.setBlur=function(t){this.set(p,t)},_.prototype.setGradient=function(t){this.set(f,t)},_.prototype.setRadius=function(t){this.set(g,t)},_.prototype.createRenderer=function(){return new r.default(this,{attributes:[{name:"weight",callback:function(t){var e=this.weightFunction_(t);return void 0!==e?(0,s.clamp)(e,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(g)+this.get(p))}.bind(this),u_blurSlope:function(){return this.get(g)/Math.max(1,this.get(p))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},_);function _(t){var e=this,i=t||{},n=(0,o.assign)({},i);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,(e=h.call(this,n)||this).gradient_=null,e.addEventListener((0,l.getChangeEventType)(f),e.handleGradientChanged_),e.setGradient(i.gradient?i.gradient:m),e.setBlur(void 0!==i.blur?i.blur:15),e.setRadius(void 0!==i.radius?i.radius:8);var r=i.weight?i.weight:"weight";return e.weightFunction_="string"==typeof r?function(t){return t.get(r)}:r,e.setRenderOrder(null),e}i.default=y},{"../Object.js":28,"../dom.js":62,"../math.js":201,"../obj.js":203,"../renderer/webgl/PointsLayer.js":243,"./Vector.js":196}],191:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./BaseImage.js")),r=o(t("../renderer/canvas/ImageLayer.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.createRenderer=function(){return new r.default(this)},h);function h(t){return s.call(this,t)||this}i.default=u},{"../renderer/canvas/ImageLayer.js":235,"./BaseImage.js":185}],192:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.inView=function(t,e){if(!t.visible)return!1;var i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom},i.default=void 0;var n=d(t("./Base.js")),r=d(t("../events/EventType.js")),o=d(t("./Property.js")),s=d(t("../render/EventType.js")),a=d(t("../source/State.js")),l=t("../asserts.js"),u=t("../obj.js"),h=t("../Object.js"),c=t("../events.js");function d(t){return t&&t.__esModule?t:{default:t}}var p,f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m=(p=n.default,g(y,p),y.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},y.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},y.prototype.getSource=function(){return this.get(o.default.SOURCE)||null},y.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():a.default.UNDEFINED},y.prototype.handleSourceChange_=function(){this.changed()},y.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&((0,c.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=(0,c.listen)(t,r.default.CHANGE,this.handleSourceChange_,this)),this.changed()},y.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},y.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return i.renderFrame(t,e)},y.prototype.setMap=function(t){this.mapPrecomposeKey_&&((0,c.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&((0,c.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=(0,c.listen)(t,s.default.PRECOMPOSE,function(t){var e=t.frameState.layerStatesArray,i=this.getLayerState(!1);(0,l.assert)(!e.some(function(t){return t.layer===i.layer}),67),e.push(i)},this),this.mapRenderKey_=(0,c.listen)(this,r.default.CHANGE,t.render,t),this.changed())},y.prototype.setSource=function(t){this.set(o.default.SOURCE,t)},y.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},y.prototype.hasRenderer=function(){return!!this.renderer_},y.prototype.createRenderer=function(){return null},y.prototype.disposeInternal=function(){this.setSource(null),p.prototype.disposeInternal.call(this)},y);function y(t){var e=this,i=(0,u.assign)({},t);delete i.source,(e=p.call(this,i)||this).mapPrecomposeKey_=null,e.mapRenderKey_=null,e.sourceChangeKey_=null,e.renderer_=null,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addEventListener((0,h.getChangeEventType)(o.default.SOURCE),e.handleSourcePropertyChange_);var n=t.source?t.source:null;return e.setSource(n),e}i.default=m},{"../Object.js":28,"../asserts.js":45,"../events.js":64,"../events/EventType.js":66,"../obj.js":203,"../render/EventType.js":216,"../source/State.js":267,"./Base.js":184,"./Property.js":193}],193:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"}},{}],194:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./BaseTile.js")),r=o(t("../renderer/canvas/TileLayer.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.createRenderer=function(){return new r.default(this)},h);function h(t){return s.call(this,t)||this}i.default=u},{"../renderer/canvas/TileLayer.js":237,"./BaseTile.js":186}],195:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"}},{}],196:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./BaseVector.js")),r=o(t("../renderer/canvas/VectorLayer.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.createRenderer=function(){return new r.default(this)},h);function h(t){return s.call(this,t)||this}i.default=u},{"../renderer/canvas/VectorLayer.js":239,"./BaseVector.js":187}],197:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./BaseVector.js")),r=s(t("../renderer/canvas/VectorImageLayer.js")),o=t("../obj.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.getImageRatio=function(){return this.imageRatio_},c.prototype.createRenderer=function(){return new r.default(this)},c);function c(t){var e=this,i=t||{},n=(0,o.assign)({},i);return delete n.imageRatio,(e=a.call(this,n)||this).imageRatio_=void 0!==i.imageRatio?i.imageRatio:1,e}i.default=h},{"../obj.js":203,"../renderer/canvas/VectorImageLayer.js":238,"./BaseVector.js":187}],198:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=u(t("./BaseVector.js")),r=u(t("../renderer/canvas/VectorTileLayer.js")),o=u(t("./TileProperty.js")),s=u(t("./VectorTileRenderType.js")),a=t("../asserts.js"),l=t("../obj.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(h=n.default,d(f,h),f.prototype.createRenderer=function(){return new r.default(this)},f.prototype.getFeatures=function(t){return h.prototype.getFeatures.call(this,t)},f.prototype.getRenderMode=function(){return this.renderMode_},f.prototype.getPreload=function(){return this.get(o.default.PRELOAD)},f.prototype.getUseInterimTilesOnError=function(){return this.get(o.default.USE_INTERIM_TILES_ON_ERROR)},f.prototype.setPreload=function(t){this.set(o.default.PRELOAD,t)},f.prototype.setUseInterimTilesOnError=function(t){this.set(o.default.USE_INTERIM_TILES_ON_ERROR,t)},f);function f(t){var e=this,i=t||{},n=(0,l.assign)({},i);delete n.preload,delete n.useInterimTilesOnError,e=h.call(this,n)||this;var r=i.renderMode||s.default.HYBRID;return(0,a.assert)(null==r||r==s.default.IMAGE||r==s.default.HYBRID||r==s.default.VECTOR,28),e.renderMode_=r,e.setPreload(i.preload?i.preload:0),e.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),e}i.default=p},{"../asserts.js":45,"../obj.js":203,"../renderer/canvas/VectorTileLayer.js":240,"./BaseVector.js":187,"./TileProperty.js":195,"./VectorTileRenderType.js":199}],199:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"}},{}],200:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.all=function(t,e){return[[-1/0,-1/0,1/0,1/0]]},i.bbox=function(t,e){return[t]},i.tile=function(s){return function(t,e){var i=s.getZForResolution(e),n=s.getTileRangeForExtentAndZ(t,i),r=[],o=[i,0,0];for(o[1]=n.minX;o[1]<=n.maxX;++o[1])for(o[2]=n.minY;o[2]<=n.maxY;++o[2])r.push(s.getTileCoordExtent(o));return r}}},{}],201:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},i.squaredSegmentDistance=function(t,e,i,n,r,o){var s=r-i,a=o-n;{var l;0==s&&0==a||(1<(l=((t-i)*s+(e-n)*a)/(s*s+a*a))?(i=r,n=o):0<l&&(i+=s*l,n+=a*l))}return u(t,e,i,n)},i.squaredDistance=u,i.solveLinearSystem=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,r=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);r<s&&(r=s,n=o)}if(0===r)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var l=i+1;l<e;l++)for(var u=-t[l][i]/t[i][i],h=i;h<e+1;h++)i==h?t[l][h]=0:t[l][h]+=u*t[i][h]}for(var c=new Array(e),d=e-1;0<=d;d--){c[d]=t[d][e]/t[d][d];for(var p=d-1;0<=p;p--)t[p][e]-=t[p][d]*c[d]}return c},i.toDegrees=function(t){return 180*t/Math.PI},i.toRadians=function(t){return t*Math.PI/180},i.modulo=function(t,e){var i=t%e;return i*e<0?i+e:i},i.lerp=function(t,e,i){return t+i*(e-t)},i.log2=i.cosh=void 0;var n="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};i.cosh=n;var r="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function u(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}i.log2=r},{}],202:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.jsonp=function(t,e,i,n){var r=document.createElement("script"),o="olc_"+(0,l.getUid)(e);function s(){delete window[o],r.parentNode.removeChild(r)}r.async=!0,r.src=t+(-1==t.indexOf("?")?"?":"&")+(n||"callback")+"="+o;var a=setTimeout(function(){s(),i&&i()},1e4);window[o]=function(t){clearTimeout(a),s(),e(t)},document.getElementsByTagName("head")[0].appendChild(r)};var l=t("./util.js")},{"./util.js":313}],203:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.clear=function(t){for(var e in t)delete t[e]},i.isEmpty=function(t){var e;for(e in t)return!1;return!e},i.getValues=i.assign=void 0;var n="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,r=arguments.length;n<r;++n){var o=arguments[n];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])}return i};i.assign=n;var r="function"==typeof Object.values?Object.values:function(t){var e=[];for(var i in t)e.push(t[i]);return e};i.getValues=r},{}],204:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},{}],205:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.cloneTransform=m,i.identityTransform=y,i.addProjection=_,i.addProjections=v,i.get=b,i.getPointResolution=function(t,e,i,n){var r,o=(t=b(t)).getPointResolutionFunc();{var s,a,l;o?(r=o(e,i),n&&n!==t.getUnits()&&(s=t.getMetersPerUnit())&&(r=r*s/u.METERS_PER_UNIT[n])):t.getUnits()==u.default.DEGREES&&!n||n==u.default.DEGREES?r=e:(a=w(t,b("EPSG:4326")),l=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2],l=a(l,l,2),r=((0,p.getDistance)(l.slice(0,2),l.slice(2,4))+(0,p.getDistance)(l.slice(4,6),l.slice(6,8)))/2,void 0!==(s=n?u.METERS_PER_UNIT[n]:t.getMetersPerUnit())&&(r/=s))}return r},i.addEquivalentProjections=j,i.addEquivalentTransforms=x,i.clearAllProjections=function(){(0,l.clear)(),(0,h.clear)()},i.createProjection=function(t,e){return t?"string"==typeof t?b(t):t:b(e)},i.createTransformFromCoordinateTransform=S,i.addCoordinateTransforms=function(t,e,i,n){var r=b(t),o=b(e);(0,h.add)(r,o,S(i)),(0,h.add)(o,r,S(n))},i.fromLonLat=function(t,e){return E(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")},i.toLonLat=function(t,e){var i=E(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=i[0];return(n<-180||180<n)&&(i[0]=(0,d.modulo)(n+180,360)-180),i},i.equivalent=function(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||w(t,e)===m)&&i},i.getTransformFromProjections=w,i.getTransform=P,i.transform=E,i.transformExtent=T,i.transformWithProjections=function(t,e,i){return w(e,i)(t)},i.setUserProjection=C,i.clearUserProjection=function(){O=null},i.getUserProjection=function(){return O},i.useGeographic=function(){C("EPSG:4326")},i.toUserCoordinate=function(t,e){return O?E(t,e,O):t},i.fromUserCoordinate=function(t,e){return O?E(t,O,e):t},i.toUserExtent=function(t,e){return O?T(t,e,O):t},i.fromUserExtent=function(t,e){return O?T(t,O,e):t},i.createSafeCoordinateTransform=function(a,l,u){return function(t){var e,i,n,r=t[0],o=t[1],s=a.canWrapX()?(i=a.getExtent(),n=(0,c.getWidth)(i),(e=(0,f.getWorldsAway)(t,a,n))&&(r-=e*n),r=(0,d.clamp)(r,i[0],i[2]),o=(0,d.clamp)(o,i[1],i[3]),u([r,o])):u(t);return e&&l.canWrapX()&&(s[0]+=e*(0,c.getWidth)(l.getExtent())),s}},i.addCommon=M,Object.defineProperty(i,"Projection",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"METERS_PER_UNIT",{enumerable:!0,get:function(){return u.METERS_PER_UNIT}});var n,r=(n=t("./proj/Projection.js"))&&n.__esModule?n:{default:n},u=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=g();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./proj/Units.js")),o=t("./proj/epsg3857.js"),a=t("./proj/epsg4326.js"),l=t("./proj/projections.js"),h=t("./proj/transforms.js"),c=t("./extent.js"),d=t("./math.js"),p=t("./sphere.js"),f=t("./coordinate.js");function g(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return g=function(){return t},t}function m(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function y(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function _(t){(0,l.add)(t.getCode(),t),(0,h.add)(t,t,m)}function v(t){t.forEach(_)}function b(t){return"string"==typeof t?(0,l.get)(t):t||null}function j(t){v(t),t.forEach(function(e){t.forEach(function(t){e!==t&&(0,h.add)(e,t,m)})})}function x(t,i,n,r){t.forEach(function(e){i.forEach(function(t){(0,h.add)(e,t,n),(0,h.add)(t,e,r)})})}function S(u){return function(t,e,i){for(var n=t.length,r=void 0!==i?i:2,o=void 0!==e?e:new Array(n),s=0;s<n;s+=r){var a=u([t[s],t[s+1]]);o[s]=a[0],o[s+1]=a[1];for(var l=r-1;2<=l;--l)o[s+l]=t[s+l]}return o}}function w(t,e){var i=t.getCode(),n=e.getCode();return(0,h.get)(i,n)||y}function P(t,e){return w(b(t),b(e))}function E(t,e,i){return P(e,i)(t,void 0,t.length)}function T(t,e,i,n){var r=P(e,i);return(0,c.applyTransform)(t,r,void 0,n)}var O=null;function C(t){O=b(t)}function M(){j(o.PROJECTIONS),j(a.PROJECTIONS),x(a.PROJECTIONS,o.PROJECTIONS,o.fromEPSG4326,o.toEPSG4326)}M()},{"./coordinate.js":60,"./extent.js":70,"./math.js":201,"./proj/Projection.js":206,"./proj/Units.js":207,"./proj/epsg3857.js":208,"./proj/epsg4326.js":209,"./proj/projections.js":211,"./proj/transforms.js":212,"./sphere.js":286}],206:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=t("./Units.js"),r=(o.prototype.canWrapX=function(){return this.canWrapX_},o.prototype.getCode=function(){return this.code_},o.prototype.getExtent=function(){return this.extent_},o.prototype.getUnits=function(){return this.units_},o.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||n.METERS_PER_UNIT[this.units_]},o.prototype.getWorldExtent=function(){return this.worldExtent_},o.prototype.getAxisOrientation=function(){return this.axisOrientation_},o.prototype.isGlobal=function(){return this.global_},o.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},o.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},o.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},o.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},o.prototype.setWorldExtent=function(t){this.worldExtent_=t},o.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},o.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},o);function o(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}i.default=r},{"./Units.js":207}],207:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.METERS_PER_UNIT=void 0;var n={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},r={};(i.METERS_PER_UNIT=r)[n.DEGREES]=2*Math.PI*6370997/360,r[n.FEET]=.3048,r[n.METERS]=1,r[n.USFEET]=1200/3937,i.default=n},{}],208:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.fromEPSG4326=function(t,e,i){var n=t.length,r=1<i?i:2,o=e;void 0===o&&(o=2<r?t.slice():new Array(n));for(var s=h,a=0;a<n;a+=r){o[a]=s*t[a]/180;var l=u*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));s<l?l=s:l<-s&&(l=-s),o[a+1]=l}return o},i.toEPSG4326=function(t,e,i){var n=t.length,r=1<i?i:2,o=e;void 0===o&&(o=2<r?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/h,o[s+1]=360*Math.atan(Math.exp(t[s+1]/u))/Math.PI-90;return o},i.PROJECTIONS=i.WORLD_EXTENT=i.EXTENT=i.HALF_SIZE=i.RADIUS=void 0;var n=s(t("./Projection.js")),r=s(t("./Units.js")),o=t("../math.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=6378137;i.RADIUS=u;var h=Math.PI*u,c=[-(i.HALF_SIZE=h),-h,h,h];i.EXTENT=c;var d=[-180,-85,180,85];i.WORLD_EXTENT=d;var p,f=(p=n.default,l(m,p),m),g=[new f("EPSG:3857"),new f("EPSG:102100"),new f("EPSG:102113"),new f("EPSG:900913"),new f("urn:ogc:def:crs:EPSG:6.18:3:3857"),new f("urn:ogc:def:crs:EPSG::3857"),new f("http://www.opengis.net/gml/srs/epsg.xml#3857")];function m(t){return p.call(this,{code:t,units:r.default.METERS,extent:c,global:!0,worldExtent:d,getPointResolution:function(t,e){return t/(0,o.cosh)(e[1]/u)}})||this}i.PROJECTIONS=g},{"../math.js":201,"./Projection.js":206,"./Units.js":207}],209:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PROJECTIONS=i.METERS_PER_UNIT=i.EXTENT=i.RADIUS=void 0;var n=o(t("./Projection.js")),r=o(t("./Units.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});i.RADIUS=6378137;var l=[-180,-90,180,90];i.EXTENT=l;var u=6378137*Math.PI/180;i.METERS_PER_UNIT=u;var h,c=(h=n.default,a(p,h),p),d=[new c("CRS:84"),new c("EPSG:4326","neu"),new c("urn:ogc:def:crs:EPSG::4326","neu"),new c("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new c("urn:ogc:def:crs:OGC:1.3:CRS84"),new c("urn:ogc:def:crs:OGC:2:84"),new c("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new c("urn:x-ogc:def:crs:EPSG:4326","neu")];function p(t,e){return h.call(this,{code:t,units:r.default.DEGREES,extent:l,axisOrientation:e,global:!0,metersPerUnit:u,worldExtent:l})||this}i.PROJECTIONS=d},{"./Projection.js":206,"./Units.js":207}],210:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.register=function(t){var e,i,n=Object.keys(t.defs),r=n.length;for(e=0;e<r;++e){var o,s=n[e];(0,g.get)(s)||(o=t.defs(s),(0,g.addProjection)(new f.default({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:o.units})))}for(e=0;e<r;++e){var a=n[e],l=(0,g.get)(a);for(i=0;i<r;++i){var u,h,c,d=n[i],p=(0,g.get)(d);(0,y.get)(a,d)||(u=t.defs(a),h=t.defs(d),u===h?(0,g.addEquivalentProjections)([l,p]):(c=t((0,m.assign)({},u,{axis:void 0}),(0,m.assign)({},h,{axis:void 0})),(0,g.addCoordinateTransforms)(l,p,(0,g.createSafeCoordinateTransform)(l,p,c.forward),(0,g.createSafeCoordinateTransform)(p,l,c.inverse))))}}};var n,f=(n=t("./Projection.js"))&&n.__esModule?n:{default:n},g=t("../proj.js"),m=t("../obj.js"),y=t("./transforms.js")},{"../obj.js":203,"../proj.js":205,"./Projection.js":206,"./transforms.js":212}],211:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.clear=function(){n={}},i.get=function(t){return n[t]||null},i.add=function(t,e){n[t]=e};var n={}},{}],212:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.clear=function(){s={}},i.add=function(t,e,i){var n=t.getCode(),r=e.getCode();n in s||(s[n]={}),s[n][r]=i},i.remove=function(t,e){var i=t.getCode(),n=e.getCode(),r=s[i][n];return delete s[i][n],(0,o.isEmpty)(s[i])&&delete s[i],r},i.get=function(t,e){var i;return t in s&&e in s[t]&&(i=s[t][e]),i};var o=t("../obj.js"),s={}},{"../obj.js":203}],213:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.toContext=function(t,e){var i=t.canvas,n=e||{},r=n.pixelRatio||u.DEVICE_PIXEL_RATIO,o=n.size;o&&(i.width=o[0]*r,i.height=o[1]*r,i.style.width=o[0]+"px",i.style.height=o[1]+"px");var s=[0,0,i.width,i.height],a=(0,h.scale)((0,h.create)(),r,r);return new l.default(t,r,s,a,0)},i.getVectorContext=function(t){var e,i=t.frameState,n=(0,h.multiply)(t.inversePixelTransform.slice(),i.coordinateToPixelTransform),r=(0,s.getSquaredTolerance)(i.viewState.resolution,i.pixelRatio),o=(0,a.getUserProjection)();return o&&(e=(0,a.getTransformFromProjections)(o,i.viewState.projection)),new l.default(t.context,i.pixelRatio,i.extent,n,i.viewState.rotation,r,e)},i.getRenderPixel=function(t,e){var i=e.slice(0);return(0,h.apply)(t.inversePixelTransform.slice(),i),i},i.renderDeclutterItems=function(t,e){e&&e.clear();for(var i=t.declutterItems,n=i.length-1;0<=n;--n)for(var r=i[n],o=r.items,s=0,a=o.length;s<a;s+=3)e=o[s].renderDeclutter(o[s+1],o[s+2],r.opacity,e);return i.length=0,e};var n,l=(n=t("./render/canvas/Immediate.js"))&&n.__esModule?n:{default:n},u=t("./has.js"),h=t("./transform.js"),s=t("./renderer/vector.js"),a=t("./proj.js")},{"./has.js":159,"./proj.js":205,"./render/canvas/Immediate.js":226,"./renderer/vector.js":241,"./transform.js":311}],214:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("../Disposable.js")),r=o(t("../geom/Polygon.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.disposeInternal=function(){this.setMap(null)},h.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},h.prototype.setMap=function(t){var e;this.map_&&(this.map_.getOverlayContainer().removeChild(this.element_),(e=this.element_.style).left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"),this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},h.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},h.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new r.default([i])},h.prototype.getGeometry=function(){return this.geometry_},h);function h(t){var e=s.call(this)||this;return e.geometry_=null,e.element_=document.createElement("div"),e.element_.style.position="absolute",e.element_.style.pointerEvents="auto",e.element_.className="ol-box "+t,e.map_=null,e.startPixel_=null,e.endPixel_=null,e}i.default=u},{"../Disposable.js":12,"../geom/Polygon.js":138}],215:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("../events/Event.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u);function u(t,e,i,n){var r=o.call(this,t)||this;return r.inversePixelTransform=e,r.frameState=i,r.context=n,r}i.default=l},{"../events/Event.js":65}],216:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"}},{}],217:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("../geom/GeometryType.js"))&&n.__esModule?n:{default:n},o=t("../transform.js"),s=t("../extent.js"),a=t("../array.js"),l=t("../geom/flat/interiorpoint.js"),u=t("../proj.js"),h=t("../geom/flat/interpolate.js"),c=t("../geom/flat/center.js"),d=t("../geom/flat/transform.js");var p=(0,o.create)(),f=(g.prototype.get=function(t){return this.properties_[t]},g.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===r.default.POINT?(0,s.createOrUpdateFromCoordinate)(this.flatCoordinates_):(0,s.createOrUpdateFromFlatCoordinates)(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},g.prototype.getFlatInteriorPoint=function(){var t;return this.flatInteriorPoints_||(t=(0,s.getCenter)(this.getExtent()),this.flatInteriorPoints_=(0,l.getInteriorPointOfArray)(this.flatCoordinates_,0,this.ends_,2,t,0)),this.flatInteriorPoints_},g.prototype.getFlatInteriorPoints=function(){var t;return this.flatInteriorPoints_||(t=(0,c.linearRingss)(this.flatCoordinates_,0,this.ends_,2),this.flatInteriorPoints_=(0,l.getInteriorPointsOfMultiArray)(this.flatCoordinates_,0,this.ends_,2,t)),this.flatInteriorPoints_},g.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=(0,h.interpolatePoint)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},g.prototype.getFlatMidpoints=function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,i=this.ends_,n=0,r=i.length;n<r;++n){var o=i[n],s=(0,h.interpolatePoint)(t,e,o,2,.5);(0,a.extend)(this.flatMidpoints_,s),e=o}}return this.flatMidpoints_},g.prototype.getId=function(){return this.id_},g.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},g.prototype.getGeometry=function(){return this},g.prototype.getSimplifiedGeometry=function(t){return this},g.prototype.simplifyTransformed=function(t,e){return this},g.prototype.getProperties=function(){return this.properties_},g.prototype.getStride=function(){return 2},g.prototype.getStyleFunction=function(){},g.prototype.getType=function(){return this.type_},g.prototype.transform=function(t,e){var i=(t=(0,u.get)(t)).getExtent(),n=t.getWorldExtent(),r=(0,s.getHeight)(n)/(0,s.getHeight)(i);(0,o.compose)(p,n[0],n[3],r,-r,0,0,0),(0,d.transform2D)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,p,this.flatCoordinates_)},g.prototype.getEnds=function(){return this.ends_},g);function g(t,e,i,n,r){this.extent_,this.id_=r,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=n}f.prototype.getEndss=f.prototype.getEnds,f.prototype.getFlatCoordinates=f.prototype.getOrientedFlatCoordinates,i.default=f},{"../array.js":44,"../extent.js":70,"../geom/GeometryType.js":131,"../geom/flat/center.js":141,"../geom/flat/interiorpoint.js":148,"../geom/flat/interpolate.js":149,"../geom/flat/transform.js":158,"../proj.js":205,"../transform.js":311}],218:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.drawCustom=function(t,e,i){},r.prototype.drawGeometry=function(t){},r.prototype.setStyle=function(t){},r.prototype.drawCircle=function(t,e){},r.prototype.drawFeature=function(t,e){},r.prototype.drawGeometryCollection=function(t,e){},r.prototype.drawLineString=function(t,e){},r.prototype.drawMultiLineString=function(t,e){},r.prototype.drawMultiPoint=function(t,e){},r.prototype.drawMultiPolygon=function(t,e){},r.prototype.drawPoint=function(t,e){},r.prototype.drawPolygon=function(t,e){},r.prototype.drawText=function(t,e){},r.prototype.setFillStrokeStyle=function(t,e){},r.prototype.setImageStyle=function(t,e){},r.prototype.setTextStyle=function(t,e){},r);function r(){}i.default=n},{}],219:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.measureTextWidth=M,i.measureAndCacheTextWidth=function(t,e,i){if(e in i)return i[e];var n=M(t,e);return i[e]=n},i.measureTextWidths=function(t,e,i){for(var n=e.length,r=0,o=0;o<n;++o){var s=M(t,e[o]);r=Math.max(r,s),i.push(s)}return r},i.rotateAtOffset=function(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))},i.drawImageOrLabel=function(t,e,i,n,r,o,s,a,l,u,h){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(l,u),t.scale(h[0],h[1]),function(t,e){for(var i=t.contextInstructions,n=0,r=i.length;n<r;n+=2)Array.isArray(i[n+1])?e[i[n]].apply(e,i[n+1]):e[i[n]]=i[n+1]}(n,t)):h[0]<0||h[1]<0?(t.translate(l,u),t.scale(h[0],h[1]),t.drawImage(n,r,o,s,a,0,0,s,a)):t.drawImage(n,r,o,s,a,l,u,s*h[0],a*h[1]),t.restore()},i.createTransformString=function(t){return o.WORKER_OFFSCREEN_CANVAS?(0,u.toString)(t):(I=I||(0,a.createCanvasContext2D)(1,1).canvas,I.style.transform=(0,u.toString)(t),I.style.transform)},i.measureTextHeight=i.registerFont=i.textHeights=i.labelCache=i.checkedFonts=i.defaultLineWidth=i.defaultPadding=i.defaultTextBaseline=i.defaultTextAlign=i.defaultStrokeStyle=i.defaultMiterLimit=i.defaultLineJoin=i.defaultLineDashOffset=i.defaultLineDash=i.defaultLineCap=i.defaultFillStyle=i.defaultFont=void 0;var n=h(t("../Object.js")),r=h(t("../events/Target.js")),o=t("../has.js"),s=t("../obj.js"),a=t("../dom.js"),l=t("../css.js"),u=t("../transform.js");function h(t){return t&&t.__esModule?t:{default:t}}i.defaultFont="10px sans-serif";i.defaultFillStyle="#000";i.defaultLineCap="round";i.defaultLineDash=[];i.defaultLineDashOffset=0;i.defaultLineJoin="round";i.defaultMiterLimit=10;i.defaultStrokeStyle="#000";i.defaultTextAlign="center";i.defaultTextBaseline="middle";i.defaultPadding=[0,0,0,0];i.defaultLineWidth=1;var c=new n.default;i.checkedFonts=c;var d=new r.default;(i.labelCache=d).setSize=function(){console.warn("labelCache is deprecated.")};var p,f=null,g={};i.textHeights=g;var m,y,_,v,b,j,x,S=(_=100,v="32px ",j=(b=["monospace","serif"]).length,x="wmytzilWMYTZIL@#/&?$%10",function(t){var e=(0,l.getFontParameters)(t);if(e)for(var i=e.families,n=0,r=i.length;n<r;++n){var o=i[n],s=e.style+"\n"+e.weight+"\n"+o;void 0===c.get(s)&&(c.set(s,_,!0),w(e.style,e.weight,o)||(c.set(s,0,!0),void 0===m&&(m=setInterval(P,32))))}});function w(t,e,i){for(var n=!0,r=0;r<j;++r){var o,s=b[r];y=M(t+" "+e+" "+v+s,x),i!=s&&(o=M(t+" "+e+" "+v+i+","+s,x),n=n&&o!=y)}return!!n}function P(){for(var t=!0,e=c.getKeys(),i=0,n=e.length;i<n;++i){var r=e[i];c.get(r)<_&&(w.apply(this,r.split("\n"))?((0,s.clear)(g),f=null,p=void 0,c.set(r,_)):(c.set(r,c.get(r)+1,!0),t=!1))}t&&(clearInterval(m),m=void 0)}i.registerFont=S;var E,T,O=(T=g,function(t){var e,i,n,r=T[t];return null==r&&(o.WORKER_OFFSCREEN_CANVAS?(e=(0,l.getFontParameters)(t),i=C(t,"Žg"),n=isNaN(Number(e.lineHeight))?1.2:Number(e.lineHeight),g[t]=n*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)):(E||((E=document.createElement("div")).innerHTML="M",E.style.margin="0 !important",E.style.padding="0 !important",E.style.position="absolute !important",E.style.left="-99999px !important"),E.style.font=t,document.body.appendChild(E),r=E.offsetHeight,T[t]=r,document.body.removeChild(E))),r});function C(t,e){return f=f||(0,a.createCanvasContext2D)(1,1),t!=p&&(f.font=t,p=f.font),f.measureText(e)}function M(t,e){return C(t,e).width}i.measureTextHeight=O;var I=null},{"../Object.js":28,"../css.js":61,"../dom.js":62,"../events/Target.js":68,"../has.js":159,"../obj.js":203,"../transform.js":311}],220:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var g=r(t("./Instruction.js")),m=r(t("../../geom/GeometryType.js")),y=r(t("../../extent/Relationship.js")),n=r(t("../VectorContext.js")),c=t("../../colorlike.js"),_=t("../../extent.js"),d=t("../canvas.js"),u=t("../../array.js"),v=t("../../geom/flat/inflate.js");function r(t){return t&&t.__esModule?t:{default:t}}var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=n.default,a(h,o),h.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},h.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);for(var l,u,h=t[e],c=t[e+1],d=this.tmpCoordinate_,p=!0,f=e+n;f<i;f+=n)d[0]=t[f],d[1]=t[f+1],p=(u=(0,_.coordinateRelationship)(a,d))!==l?(p&&(this.coordinates[s++]=h,this.coordinates[s++]=c),this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],!1):u!==y.default.INTERSECTING||(this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],!1),h=d[0],c=d[1],l=u;return(r&&p||f===e+n)&&(this.coordinates[s++]=h,this.coordinates[s++]=c),s},h.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],l=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(l),e=a}return e},h.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,r,o,s,a=t.getType(),l=t.getStride(),u=this.coordinates.length;if(a==m.default.MULTI_POLYGON){n=t.getOrientedFlatCoordinates(),s=[];for(var h=t.getEndss(),c=f=0,d=h.length;c<d;++c){var p=[],f=this.drawCustomCoordinates_(n,f,h[c],l,p);s.push(p)}this.instructions.push([g.default.CUSTOM,u,s,t,i,v.inflateMultiCoordinatesArray])}else a==m.default.POLYGON||a==m.default.MULTI_LINE_STRING?(o=[],n=a==m.default.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(n,0,t.getEnds(),l,o),this.instructions.push([g.default.CUSTOM,u,o,t,i,v.inflateCoordinatesArray])):a==m.default.LINE_STRING||a==m.default.MULTI_POINT?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,l,!1,!1),this.instructions.push([g.default.CUSTOM,u,r,t,i,v.inflateCoordinates])):a==m.default.POINT&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([g.default.CUSTOM,u,r,t,i]));this.endGeometry(e)},h.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[g.default.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[g.default.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},h.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},h.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();for(var e,i,n=t.length,r=-1,o=0;o<n;++o)(i=(e=t[o])[0])==g.default.END_GEOMETRY?r=o:i==g.default.BEGIN_GEOMETRY&&(e[2]=o,(0,u.reverseSubArray)(this.hitDetectionInstructions,r,o),r=-1)},h.prototype.setFillStrokeStyle=function(t,e){var i,n,r,o,s,a,l,u,h=this.state;t?(i=t.getColor(),h.fillStyle=(0,c.asColorLike)(i||d.defaultFillStyle)):h.fillStyle=void 0,e?(n=e.getColor(),h.strokeStyle=(0,c.asColorLike)(n||d.defaultStrokeStyle),r=e.getLineCap(),h.lineCap=void 0!==r?r:d.defaultLineCap,o=e.getLineDash(),h.lineDash=o?o.slice():d.defaultLineDash,s=e.getLineDashOffset(),h.lineDashOffset=s||d.defaultLineDashOffset,a=e.getLineJoin(),h.lineJoin=void 0!==a?a:d.defaultLineJoin,l=e.getWidth(),h.lineWidth=void 0!==l?l:d.defaultLineWidth,u=e.getMiterLimit(),h.miterLimit=void 0!==u?u:d.defaultMiterLimit,h.lineWidth>this.maxLineWidth&&(this.maxLineWidth=h.lineWidth,this.bufferedMaxExtent_=null)):(h.strokeStyle=void 0,h.lineCap=void 0,h.lineDash=null,h.lineDashOffset=void 0,h.lineJoin=void 0,h.lineWidth=void 0,h.miterLimit=void 0)},h.prototype.createFill=function(t){var e=t.fillStyle,i=[g.default.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},h.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},h.prototype.createStroke=function(t){return[g.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},h.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},h.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;t.currentStrokeStyle==i&&t.currentLineCap==n&&(r==t.currentLineDash||(0,u.equals)(t.currentLineDash,r))&&t.currentLineDashOffset==o&&t.currentLineJoin==s&&t.currentLineWidth==a&&t.currentMiterLimit==l||(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)},h.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[g.default.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},h.prototype.getBufferedMaxExtent=function(){var t;return!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,_.clone)(this.maxExtent),0<this.maxLineWidth)&&(t=this.resolution*(this.maxLineWidth+1)/2,(0,_.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)),this.bufferedMaxExtent_},h);function h(t,e,i,n){var r=o.call(this)||this;return r.tolerance=t,r.maxExtent=e,r.pixelRatio=n,r.maxLineWidth=0,r.resolution=i,r.beginGeometryInstruction1_=null,r.beginGeometryInstruction2_=null,r.bufferedMaxExtent_=null,r.instructions=[],r.coordinates=[],r.tmpCoordinate_=[],r.hitDetectionInstructions=[],r.state={},r}i.default=l},{"../../array.js":44,"../../colorlike.js":48,"../../extent.js":70,"../../extent/Relationship.js":72,"../../geom/GeometryType.js":131,"../../geom/flat/inflate.js":147,"../VectorContext.js":218,"../canvas.js":219,"./Instruction.js":227}],221:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("./Builder.js")),r=l(t("./ImageBuilder.js")),o=l(t("./LineStringBuilder.js")),s=l(t("./PolygonBuilder.js")),a=l(t("./TextBuilder.js"));function l(t){return t&&t.__esModule?t:{default:t}}var u={Circle:s.default,Default:n.default,Image:r.default,LineString:o.default,Polygon:s.default,Text:a.default},h=(c.prototype.addDeclutter=function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_)[0][0]++:(e=[[1]],this.declutterGroups_=e)),e},c.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var r=i[n].finish();t[e][n]=r}}return t},c.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);var r=n[e];return void 0===r&&(r=new u[e](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r),r},c);function c(t,e,i,n,r){this.declutter_=r,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}i.default=h},{"./Builder.js":220,"./ImageBuilder.js":225,"./LineStringBuilder.js":228,"./PolygonBuilder.js":229,"./TextBuilder.js":230}],222:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"}},{}],223:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var Ft=n(t("./Instruction.js")),f=n(t("rbush/rbush.js")),Nt=t("./TextBuilder.js"),P=t("../../has.js"),Dt=t("../../transform.js"),Gt=t("../../extent.js"),Ut=t("../canvas.js"),zt=t("../../geom/flat/textpath.js"),Bt=t("../../array.js"),Wt=t("../../geom/flat/length.js"),Vt=t("../../geom/flat/transform.js");function n(t){return t&&t.__esModule?t:{default:t}}var A=(0,Gt.createEmpty)(),L=(0,Dt.create)(),F=[],N=[],D=[],G=[],r=(o.prototype.createLabel=function(t,e,i,n){var r=t+e+i+n;if(this.labels_[r])return this.labels_[r];var o=n?this.strokeStates[n]:null,s=i?this.fillStates[i]:null,a=this.textStates[e],l=this.pixelRatio,u=[a.scale[0]*l,a.scale[1]*l],h=Nt.TEXT_ALIGN[a.textAlign||Ut.defaultTextAlign],c=n&&o.lineWidth?o.lineWidth:0,d=t.split("\n"),p=d.length,f=[],g=(0,Ut.measureTextWidths)(a.font,d,f),m=(0,Ut.measureTextHeight)(a.font),y=g+c,_=[],v=(y+2)*u[0],b=(m*p+c)*u[1],j={width:v<0?Math.floor(v):Math.ceil(v),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:_};1==u[0]&&1==u[1]||_.push("scale",u),_.push("font",a.font),n&&(_.push("strokeStyle",o.strokeStyle),_.push("lineWidth",c),_.push("lineCap",o.lineCap),_.push("lineJoin",o.lineJoin),_.push("miterLimit",o.miterLimit),(P.WORKER_OFFSCREEN_CANVAS?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(_.push("setLineDash",[o.lineDash]),_.push("lineDashOffset",o.lineDashOffset))),i&&_.push("fillStyle",s.fillStyle),_.push("textBaseline","middle"),_.push("textAlign","center");var x,S=.5-h,w=h*y+S*c;if(n)for(x=0;x<p;++x)_.push("strokeText",[d[x],w+S*f[x],.5*(c+m)+x*m]);if(i)for(x=0;x<p;++x)_.push("fillText",[d[x],w+S*f[x],.5*(c+m)+x*m]);return this.labels_[r]=j},o.prototype.replayTextBackground_=function(t,e,i,n,r,o,s,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],a&&(t.fillStyle=o[1]),this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},o.prototype.replayImageOrLabel_=function(t,e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_){var v=y||_;i-=o*=p[0],n-=s*=p[1];var b=g+h>r.width?r.width-h:g,j=l+c>r.height?r.height-c:l,x=m[3]+b*p[0]+m[1],S=m[0]+j*p[1]+m[2],w=i-m[3],P=n-m[0];!v&&0===d||(F[0]=w,G[0]=w,F[1]=P,N[1]=P,N[0]=w+x,D[0]=N[0],D[1]=P+S,G[1]=D[1]);var E,T,O=null;0!==d?(E=i+o,T=n+s,O=(0,Dt.compose)(L,E,T,1,1,d,-E,-T),(0,Dt.apply)(L,F),(0,Dt.apply)(L,N),(0,Dt.apply)(L,D),(0,Dt.apply)(L,G),(0,Gt.createOrUpdate)(Math.min(F[0],N[0],D[0],G[0]),Math.min(F[1],N[1],D[1],G[1]),Math.max(F[0],N[0],D[0],G[0]),Math.max(F[1],N[1],D[1],G[1]),A)):(0,Gt.createOrUpdate)(w,P,w+x,P+S,A),this.renderBuffer_[0]=Math.max(this.renderBuffer_[0],(0,Gt.getWidth)(A)),this.renderBuffer_[1]=Math.max(this.renderBuffer_[1],(0,Gt.getHeight)(A));var C=t.canvas,M=_?_[2]*p[0]/2:0,I=this.renderBuffer_,R=A[0]-M<=(C.width+I[0])/e&&A[2]+M>=-I[0]/e&&A[1]-M<=(C.height+I[1])/e&&A[3]+M>=-I[1]/e;if(f&&(i=Math.round(i),n=Math.round(n)),a){if(!R&&1==a[0])return!1;var k=R?[t,O?O.slice(0):null,u,r,h,c,b,j,i,n,p,A.slice()]:null;k&&(v&&k.push(y,_,F.slice(0),N.slice(0),D.slice(0),G.slice(0)),a.push(k))}else R&&(v&&this.replayTextBackground_(t,F,N,D,G,y,_,!1),(0,Ut.drawImageOrLabel)(t,O,u,r,h,c,b,j,i,n,p));return!0},o.prototype.fill_=function(t){var e,i;this.alignFill_&&(e=(0,Dt.apply)(this.renderedTransform_,[0,0]),i=512*this.pixelRatio,t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)),t.fill(),this.alignFill_&&t.restore()},o.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},o.prototype.renderDeclutter=function(t,e,i,n){for(var r=[],o=1,s=t.length;o<s;++o){var a=(c=t[o])[11];r.push({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:e})}n=n||new f.default(9);for(var l=!1,o=0,s=r.length;o<s;++o)if(n.collides(r[o])){l=!0;break}if(!l){n.load(r);for(var u=1,h=t.length;u<h;++u){var c,d=(c=t[u])[0],p=d.globalAlpha;p!==i&&(d.globalAlpha=i),12<c.length&&this.replayTextBackground_(c[0],c[14],c[15],c[16],c[17],c[12],c[13],!0),Ut.drawImageOrLabel.apply(void 0,c),p!==i&&(d.globalAlpha=p)}}return t.length=1,n},o.prototype.drawLabelWithPointPlacement_=function(t,e,i,n){var r=this.textStates[e],o=this.createLabel(t,e,n,i),s=this.strokeStates[i],a=this.pixelRatio,l=Nt.TEXT_ALIGN[r.textAlign||Ut.defaultTextAlign],u=Nt.TEXT_ALIGN[r.textBaseline||Ut.defaultTextBaseline],h=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:l*(o.width/a-2*r.scale[0])+2*(.5-l)*h,anchorY:u*o.height/a+2*(.5-u)*h}},o.prototype.execute_=function(t,e,i,n,r,o,s){var a;this.declutterItems.length=0,this.pixelCoordinates_&&(0,Bt.equals)(i,this.renderedTransform_)?a=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),a=(0,Vt.transform2D)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,Dt.setFromArray)(this.renderedTransform_,i));for(var l,u,h,c,d,p,f,g,m,y=0,_=n.length,v=0,b=0,j=0,x=null,S=null,w=this.coordinateCache_,P=this.viewRotation_,E=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,T={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},O=this.instructions!=n||this.overlaps?0:200;y<_;){var C=n[y];switch(C[0]){case Ft.default.BEGIN_GEOMETRY:(f=C[1]).getGeometry()?void 0===s||(0,Gt.intersects)(s,C[3])?++y:y=C[2]+1:y=C[2];break;case Ft.default.BEGIN_PATH:O<b&&(this.fill_(t),b=0),O<j&&(t.stroke(),j=0),b||j||(t.beginPath(),h=u=NaN),++y;break;case Ft.default.CIRCLE:var M=a[v=C[1]],I=a[v+1],R=a[v+2]-M,k=a[v+3]-I,A=Math.sqrt(R*R+k*k);t.moveTo(M+A,I),t.arc(M,I,A,0,2*Math.PI,!0),++y;break;case Ft.default.CLOSE_PATH:t.closePath(),++y;break;case Ft.default.CUSTOM:v=C[1],l=C[2];var L=C[3],F=C[4],N=6==C.length?C[5]:void 0;T.geometry=L,T.feature=f,y in w||(w[y]=[]);var D=w[y];N?N(a,v,l,2,D):(D[0]=a[v],D[1]=a[v+1],D.length=2),F(D,T),++y;break;case Ft.default.DRAW_IMAGE:v=C[1],l=C[2],U=C[3],B=C[4],V=C[5],p=o?null:C[6];var G,U,z,B,W,V,Y=C[7],H=C[8],X=C[9],q=C[10],K=C[11],Z=C[12],$=C[13],Q=C[14];!U&&19<=C.length&&(yt=C[18],_t=C[19],gt=C[20],ct=C[21],U=(G=this.drawLabelWithPointPlacement_(yt,_t,gt,ct)).label,C[3]=U,z=C[22],B=(G.anchorX-z)*this.pixelRatio,C[4]=B,W=C[23],V=(G.anchorY-W)*this.pixelRatio,C[5]=V,Y=U.height,C[7]=Y,Q=U.width,C[14]=Q);var J=void 0;24<C.length&&(J=C[24]);var tt=void 0,et=void 0,it=void 0,it=16<C.length?(tt=C[15],et=C[16],C[17]):(tt=Ut.defaultPadding,et=!1);K&&E?Z+=P:K||E||(Z-=P);for(var nt,rt,ot=0,st=0;v<l;v+=2)J&&J[ot++]<Q/this.pixelRatio||(p&&(nt=Math.floor(st),rt=p.length<nt+1?[p[0][0]]:p[nt]),(Ct=this.replayImageOrLabel_(t,e,a[v],a[v+1],U,B,V,rt,Y,H,X,q,Z,$,r,Q,tt,et?x:null,it?S:null))&&rt&&p[p.length-1]!==rt&&p.push(rt),rt&&(rt.length-1===rt[0]&&this.declutterItems.push(this,rt,f),st+=1/rt[0]));++y;break;case Ft.default.DRAW_CHARS:var at=C[1],lt=C[2],ut=C[3];rt=o?null:C[4];var ht=C[5],ct=C[6],dt=C[7],pt=C[8],ft=C[9],gt=C[10],mt=C[11],yt=C[12],_t=C[13],vt=[C[14],C[14]],bt=this.textStates[_t],jt=bt.font,xt=[bt.scale[0]*pt,bt.scale[1]*pt],St=void 0;jt in this.widths_?St=this.widths_[jt]:(St={},this.widths_[jt]=St);var wt=(0,Wt.lineStringLength)(a,at,lt,2),Pt=Math.abs(xt[0])*(0,Ut.measureAndCacheTextWidth)(jt,yt,St);if(ht||Pt<=wt){var Et=this.textStates[_t].textAlign,Tt=(wt-Pt)*Nt.TEXT_ALIGN[Et],Ot=(0,zt.drawTextOnPath)(a,at,lt,2,yt,Tt,dt,Math.abs(xt[0]),Ut.measureAndCacheTextWidth,jt,St,E?0:this.viewRotation_);if(Ot){var Ct=!1,Mt=void 0,It=void 0,Rt=void 0,kt=void 0,At=void 0;if(gt)for(Mt=0,It=Ot.length;Mt<It;++Mt)Rt=(At=Ot[Mt])[4],kt=this.createLabel(Rt,_t,"",gt),B=At[2]+mt,V=ut*kt.height+2*(.5-ut)*mt*xt[1]/xt[0]-ft,Ct=this.replayImageOrLabel_(t,e,At[0],At[1],kt,B,V,rt,kt.height,1,0,0,At[3],vt,!1,kt.width,Ut.defaultPadding,null,null)||Ct;if(ct)for(Mt=0,It=Ot.length;Mt<It;++Mt)Rt=(At=Ot[Mt])[4],kt=this.createLabel(Rt,_t,ct,""),B=At[2],V=ut*kt.height-ft,Ct=this.replayImageOrLabel_(t,e,At[0],At[1],kt,B,V,rt,kt.height,1,0,0,At[3],vt,!1,kt.width,Ut.defaultPadding,null,null)||Ct;Ct&&this.declutterItems.push(this,rt,f)}}++y;break;case Ft.default.END_GEOMETRY:if(void 0!==o){var Lt=o(f=C[1]);if(Lt)return Lt}++y;break;case Ft.default.FILL:O?b++:this.fill_(t),++y;break;case Ft.default.MOVE_TO_LINE_TO:for(v=C[1],l=C[2],g=a[v],d=(m=a[v+1])+.5|0,(c=g+.5|0)===u&&d===h||(t.moveTo(g,m),u=c,h=d),v+=2;v<l;v+=2)c=(g=a[v])+.5|0,d=(m=a[v+1])+.5|0,v!=l-2&&c===u&&d===h||(t.lineTo(g,m),u=c,h=d);++y;break;case Ft.default.SET_FILL_STYLE:x=C,this.alignFill_=C[2],b&&(this.fill_(t),b=0,j&&(t.stroke(),j=0)),t.fillStyle=C[1],++y;break;case Ft.default.SET_STROKE_STYLE:S=C,j&&(t.stroke(),j=0),this.setStrokeStyle_(t,C),++y;break;case Ft.default.STROKE:O?j++:t.stroke(),++y;break;default:++y}}b&&this.fill_(t),j&&t.stroke()},o.prototype.execute=function(t,e,i,n,r){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0)},o.prototype.executeHitDetection=function(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)},o);function o(t,e,i,n,r){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.declutterItems=[],this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderBuffer_=r,this.renderedTransform_=(0,Dt.create)(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}i.default=r},{"../../array.js":44,"../../extent.js":70,"../../geom/flat/length.js":151,"../../geom/flat/textpath.js":157,"../../geom/flat/transform.js":158,"../../has.js":159,"../../transform.js":311,"../canvas.js":219,"./Instruction.js":227,"./TextBuilder.js":230,"rbush/rbush.js":324}],224:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getCircleArray=E,i.replayDeclutter=function(t,e,i,n,r,o){for(var s=Object.keys(t).map(Number).sort(w.numberSafeCompareFunction),a=0,l=s.length;a<l;++a)for(var u=t[s[a].toString()],h=void 0,c=0,d=u.length;c<d;){var p=u[c++],f=u[c++];p.execute(e,1,f,i,r),p!==h&&0<p.declutterItems.length&&(h=p,o.push({items:p.declutterItems,opacity:n}))}},i.default=void 0;var b=r(t("./BuilderType.js")),a=r(t("./Executor.js")),j=t("../../extent.js"),x=t("../../transform.js"),S=t("../../dom.js"),n=t("../../obj.js"),w=t("../../array.js"),l=t("../../geom/flat/transform.js");function r(t){return t&&t.__esModule?t:{default:t}}var P=[b.default.POLYGON,b.default.CIRCLE,b.default.LINE_STRING,b.default.IMAGE,b.default.TEXT,b.default.DEFAULT],o=(s.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},s.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);var n=t[e],r=[this.renderBuffer_||0,this.renderBuffer_||0];for(var o in n){var s=n[o];i[o]=new a.default(this.resolution_,this.pixelRatio_,this.overlaps_,s,r)}}},s.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],n=0,r=t.length;n<r;++n)if(t[n]in i)return!0;return!1},s.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,s){var a=2*(n=Math.round(n))+1,r=(0,x.compose)(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=(0,S.createCanvasContext2D)(a,a));var l,u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):u.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(l=(0,j.createEmpty)(),(0,j.extendCoordinate)(l,t),(0,j.buffer)(l,e*(this.renderBuffer_+n),l));var h,c=E(n);function d(t){for(var e=u.getImageData(0,0,a,a).data,i=0;i<a;i++)for(var n=0;n<a;n++)if(c[i][n]&&0<e[4*(n*a+i)+3]){var r=void 0;return s&&(h==b.default.IMAGE||h==b.default.TEXT)&&-1===s.indexOf(t)||(r=o(t)),r||void u.clearRect(0,0,a,a)}}var p,f,g,m=Object.keys(this.executorsByZIndex_).map(Number);for(m.sort(w.numberSafeCompareFunction),p=m.length-1;0<=p;--p)for(var y=m[p].toString(),_=this.executorsByZIndex_[y],v=P.length-1;0<=v;--v)if(void 0!==(f=_[h=P[v]])&&(g=f.executeHitDetection(u,r,i,d,l)))return g},s.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],n=e[1],r=e[2],o=e[3],s=[i,n,i,o,r,o,r,n];return(0,l.transform2D)(s,0,8,2,t,s),s},s.prototype.isEmpty=function(){return(0,n.isEmpty)(this.executorsByZIndex_)},s.prototype.execute=function(t,e,i,n,r,o,s){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(w.numberSafeCompareFunction),this.maxExtent_&&(t.save(),this.clip(t,i));for(var l,u=o||P,h=0,c=a.length;h<c;++h)for(var d=a[h].toString(),p=this.executorsByZIndex_[d],f=0,g=u.length;f<g;++f){var m,y=u[f];void 0!==(l=p[y])&&(!s||y!=b.default.IMAGE&&y!=b.default.TEXT?l.execute(t,e,i,n,r):(m=s[d])?m.push(l,i.slice(0)):s[d]=[l,i.slice(0)])}this.maxExtent_&&t.restore()},s),u={0:[[!0]]};function s(t,e,i,n,r,o){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,x.create)(),this.createExecutors_(r)}function h(t,e,i){var n,r=Math.floor(t.length/2);if(r<=e)for(n=r;n<e;n++)t[n][i]=!0;else if(e<r)for(n=e+1;n<r;n++)t[n][i]=!0}function E(t){if(void 0!==u[t])return u[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);for(var r=t,o=0,s=0;o<=r;)h(i,t+r,t+o),h(i,t+o,t+r),h(i,t-o,t+r),h(i,t-r,t+o),h(i,t-r,t-o),h(i,t-o,t-r),h(i,t+o,t-r),h(i,t+r,t-o),0<2*((s+=1+2*++o)-r)+1&&(s+=1-2*--r);return u[t]=i}i.default=o},{"../../array.js":44,"../../dom.js":62,"../../extent.js":70,"../../geom/flat/transform.js":158,"../../obj.js":203,"../../transform.js":311,"./BuilderType.js":222,"./Executor.js":223}],225:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(t("./Builder.js")),s=r(t("./Instruction.js"));function r(t){return t&&t.__esModule?t:{default:t}}var o,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(o=n.default,l(h,o),h.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},h.prototype.drawPoint=function(t,e){var i,n,r,o;this.image_&&(this.beginGeometry(t,e),i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n),this.instructions.push([s.default.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.hitDetectionInstructions.push([s.default.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.endGeometry(e))},h.prototype.drawMultiPoint=function(t,e){var i,n,r,o;this.image_&&(this.beginGeometry(t,e),i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n),this.instructions.push([s.default.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.hitDetectionInstructions.push([s.default.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.endGeometry(e))},h.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,o.prototype.finish.call(this)},h.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),r=t.getHitDetectionImage(this.pixelRatio),o=t.getImage(this.pixelRatio),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroups_=e,this.hitDetectionImage_=r,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0]},h);function h(t,e,i,n){var r=o.call(this,t,e,i,n)||this;return r.declutterGroups_=null,r.hitDetectionImage_=null,r.image_=null,r.imagePixelRatio_=void 0,r.anchorX_=void 0,r.anchorY_=void 0,r.height_=void 0,r.opacity_=void 0,r.originX_=void 0,r.originY_=void 0,r.rotateWithView_=void 0,r.rotation_=void 0,r.scale_=void 0,r.width_=void 0,r}i.default=u},{"./Builder.js":220,"./Instruction.js":227}],226:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("../../geom/GeometryType.js")),r=a(t("../VectorContext.js")),b=t("../../colorlike.js"),g=t("../../transform.js"),j=t("../canvas.js"),o=t("../../array.js"),h=t("../../extent.js"),m=t("../../geom/flat/transform.js"),s=t("../../geom/SimpleGeometry.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,c=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(l=r.default,c(p,l),p.prototype.drawImages_=function(t,e,i,n){if(this.image_){var r=(0,m.transform2D)(t,e,i,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,h=r.length;u<h;u+=2){var c,d,p=r[u]-this.imageAnchorX_,f=r[u+1]-this.imageAnchorY_;0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]?(c=p+this.imageAnchorX_,d=f+this.imageAnchorY_,(0,g.compose)(s,c,d,1,1,l,-c,-d),o.setTransform.apply(o,s),o.translate(c,d),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)):o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,p,f,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=a)}},p.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=(0,m.transform2D)(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a,l=r[e]+this.textOffsetX_,u=r[e+1]+this.textOffsetY_;0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]?(a=(0,g.compose)(this.tmpLocalTransform_,l,u,1,1,s,-l,-u),o.setTransform.apply(o,a),o.translate(l,u),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u))}}},p.prototype.moveToLineTo_=function(t,e,i,n,r){var o=this.context_,s=(0,m.transform2D)(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;r&&(a-=2);for(var l=2;l<a;l+=2)o.lineTo(s[l],s[l+1]);return r&&o.closePath(),i},p.prototype.drawRings_=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e},p.prototype.drawCircle=function(t){var e,i,n,r,o;(0,h.intersects)(this.extent_,t.getExtent())&&((this.fillState_||this.strokeState_)&&(this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_),i=(e=(0,s.transformGeom2D)(t,this.transform_,this.pixelCoordinates_))[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),(o=this.context_).beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()),""!==this.text_&&this.drawText_(t.getCenter(),0,2,2))},p.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},p.prototype.setTransform=function(t){this.transform_=t},p.prototype.drawGeometry=function(t){switch(t.getType()){case n.default.POINT:this.drawPoint(t);break;case n.default.LINE_STRING:this.drawLineString(t);break;case n.default.POLYGON:this.drawPolygon(t);break;case n.default.MULTI_POINT:this.drawMultiPoint(t);break;case n.default.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case n.default.MULTI_POLYGON:this.drawMultiPolygon(t);break;case n.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case n.default.CIRCLE:this.drawCircle(t)}},p.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&(0,h.intersects)(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},p.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},p.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},p.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},p.prototype.drawLineString=function(t){var e,i,n;this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,h.intersects)(this.extent_,t.getExtent())&&(this.strokeState_&&(this.setContextStrokeState_(this.strokeState_),e=this.context_,i=t.getFlatCoordinates(),e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()),""!==this.text_&&(n=t.getFlatMidpoint(),this.drawText_(n,0,2,2)))},p.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e,i=t.getExtent();if((0,h.intersects)(this.extent_,i)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getFlatCoordinates(),o=0,s=t.getEnds(),a=t.getStride();n.beginPath();for(var l=0,u=s.length;l<u;++l)o=this.moveToLineTo_(r,o,s[l],a,!1);n.stroke()}""!==this.text_&&(e=t.getFlatMidpoints(),this.drawText_(e,0,e.length,2))}},p.prototype.drawPolygon=function(t){var e,i;this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,h.intersects)(this.extent_,t.getExtent())&&((this.strokeState_||this.fillState_)&&(this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_),(e=this.context_).beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()),""!==this.text_&&(i=t.getFlatInteriorPoint(),this.drawText_(i,0,2,2)))},p.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,h.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,r=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=r.length;s<a;++s)var l=r[s],n=this.drawRings_(i,n,l,o);this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}var u;""!==this.text_&&(u=t.getFlatInteriorPoints(),this.drawText_(u,0,u.length,2))}},p.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},p.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&((0,o.equals)(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},p.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:j.defaultTextAlign;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},p.prototype.setFillStrokeStyle=function(t,e){var i,n,r,o,s,a,l,u;t?(i=t.getColor(),this.fillState_={fillStyle:(0,b.asColorLike)(i||j.defaultFillStyle)}):this.fillState_=null,e?(n=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit(),this.strokeState_={lineCap:void 0!==r?r:j.defaultLineCap,lineDash:o||j.defaultLineDash,lineDashOffset:s||j.defaultLineDashOffset,lineJoin:void 0!==a?a:j.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==l?l:j.defaultLineWidth),miterLimit:void 0!==u?u:j.defaultMiterLimit,strokeStyle:(0,b.asColorLike)(n||j.defaultStrokeStyle)}):this.strokeState_=null},p.prototype.setImageStyle=function(t){var e,i,n,r,o;t&&(e=t.getSize())?(i=t.getAnchor(),n=t.getImage(1),r=t.getOrigin(),o=t.getScaleArray(),this.imageAnchorX_=i[0],this.imageAnchorY_=i[1],this.imageHeight_=e[1],this.image_=n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=[this.pixelRatio_*o[0],this.pixelRatio_*o[1]],this.imageWidth_=e[0]):this.image_=null},p.prototype.setTextStyle=function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p,f,g,m,y,_,v;t?((e=t.getFill())?(i=e.getColor(),this.textFillState_={fillStyle:(0,b.asColorLike)(i||j.defaultFillStyle)}):this.textFillState_=null,(n=t.getStroke())?(r=n.getColor(),o=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),l=n.getLineJoin(),u=n.getWidth(),h=n.getMiterLimit(),this.textStrokeState_={lineCap:void 0!==o?o:j.defaultLineCap,lineDash:s||j.defaultLineDash,lineDashOffset:a||j.defaultLineDashOffset,lineJoin:void 0!==l?l:j.defaultLineJoin,lineWidth:void 0!==u?u:j.defaultLineWidth,miterLimit:void 0!==h?h:j.defaultMiterLimit,strokeStyle:(0,b.asColorLike)(r||j.defaultStrokeStyle)}):this.textStrokeState_=null,c=t.getFont(),d=t.getOffsetX(),p=t.getOffsetY(),f=t.getRotateWithView(),g=t.getRotation(),m=t.getScaleArray(),y=t.getText(),_=t.getTextAlign(),v=t.getTextBaseline(),this.textState_={font:void 0!==c?c:j.defaultFont,textAlign:void 0!==_?_:j.defaultTextAlign,textBaseline:void 0!==v?v:j.defaultTextBaseline},this.text_=void 0!==y?y:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==f&&f,this.textRotation_=void 0!==g?g:0,this.textScale_=[this.pixelRatio_*m[0],this.pixelRatio_*m[1]]):this.text_=""},p);function p(t,e,i,n,r,o,s){var a=l.call(this)||this;return a.context_=t,a.pixelRatio_=e,a.extent_=i,a.transform_=n,a.viewRotation_=r,a.squaredTolerance_=o,a.userTransform_=s,a.contextFillState_=null,a.contextStrokeState_=null,a.contextTextState_=null,a.fillState_=null,a.strokeState_=null,a.image_=null,a.imageAnchorX_=0,a.imageAnchorY_=0,a.imageHeight_=0,a.imageOpacity_=0,a.imageOriginX_=0,a.imageOriginY_=0,a.imageRotateWithView_=!1,a.imageRotation_=0,a.imageScale_=[0,0],a.imageWidth_=0,a.text_="",a.textOffsetX_=0,a.textOffsetY_=0,a.textRotateWithView_=!1,a.textRotation_=0,a.textScale_=[0,0],a.textFillState_=null,a.textStrokeState_=null,a.textState_=null,a.pixelCoordinates_=[],a.tmpLocalTransform_=(0,g.create)(),a}i.default=d},{"../../array.js":44,"../../colorlike.js":48,"../../extent.js":70,"../../geom/GeometryType.js":131,"../../geom/SimpleGeometry.js":139,"../../geom/flat/transform.js":158,"../../transform.js":311,"../VectorContext.js":218,"../canvas.js":219}],227:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.closePathInstruction=i.beginPathInstruction=i.strokeInstruction=i.fillInstruction=void 0;var n={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},r=[n.FILL];i.fillInstruction=r;var o=[n.STROKE];i.strokeInstruction=o;var s=[n.BEGIN_PATH];i.beginPathInstruction=s;var a=[n.CLOSE_PATH];i.closePathInstruction=a;i.default=n},{}],228:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Builder.js"))&&n.__esModule?n:{default:n},c=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Instruction.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var o,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(o=r.default,u(d,o),d.prototype.drawFlatCoordinates_=function(t,e,i,n){var r=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[c.default.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},d.prototype.drawLineString=function(t,e){var i,n,r=this.state,o=r.strokeStyle,s=r.lineWidth;void 0!==o&&void 0!==s&&(this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([c.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],c.beginPathInstruction),i=t.getFlatCoordinates(),n=t.getStride(),this.drawFlatCoordinates_(i,0,i.length,n),this.hitDetectionInstructions.push(c.strokeInstruction),this.endGeometry(e))},d.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([c.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],c.beginPathInstruction);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinates_(s,l,o[u],a);this.hitDetectionInstructions.push(c.strokeInstruction),this.endGeometry(e)}},d.prototype.finish=function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(c.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,o.prototype.finish.call(this)},d.prototype.applyStroke=function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(c.strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,o.prototype.applyStroke.call(this,t),this.instructions.push(c.beginPathInstruction)},d);function d(t,e,i,n){return o.call(this,t,e,i,n)||this}i.default=h},{"./Builder.js":220,"./Instruction.js":227}],229:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./Builder.js"))&&n.__esModule?n:{default:n},p=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Instruction.js")),c=t("../canvas.js"),o=t("../../geom/flat/simplify.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(l=r.default,h(f,l),f.prototype.drawFlatCoordinatess_=function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=void 0!==r.strokeStyle,a=i.length;this.instructions.push(p.beginPathInstruction),this.hitDetectionInstructions.push(p.beginPathInstruction);for(var l=0;l<a;++l){var u=i[l],h=this.coordinates.length,c=this.appendFlatCoordinates(t,e,u,n,!0,!s),d=[p.default.MOVE_TO_LINE_TO,h,c];this.instructions.push(d),this.hitDetectionInstructions.push(d),s&&(this.instructions.push(p.closePathInstruction),this.hitDetectionInstructions.push(p.closePathInstruction)),e=u}return o&&(this.instructions.push(p.fillInstruction),this.hitDetectionInstructions.push(p.fillInstruction)),s&&(this.instructions.push(p.strokeInstruction),this.hitDetectionInstructions.push(p.strokeInstruction)),e},f.prototype.drawCircle=function(t,e){var i,n,r,o,s=this.state,a=s.fillStyle,l=s.strokeStyle;void 0===a&&void 0===l||(this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([p.default.SET_FILL_STYLE,c.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([p.default.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,s.lineDash,s.lineDashOffset]),i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,this.appendFlatCoordinates(i,0,i.length,n,!1,!1),o=[p.default.CIRCLE,r],this.instructions.push(p.beginPathInstruction,o),this.hitDetectionInstructions.push(p.beginPathInstruction,o),void 0!==s.fillStyle&&(this.instructions.push(p.fillInstruction),this.hitDetectionInstructions.push(p.fillInstruction)),void 0!==s.strokeStyle&&(this.instructions.push(p.strokeInstruction),this.hitDetectionInstructions.push(p.strokeInstruction)),this.endGeometry(e))},f.prototype.drawPolygon=function(t,e){var i,n,r,o=this.state,s=o.fillStyle,a=o.strokeStyle;void 0===s&&void 0===a||(this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==o.fillStyle&&this.hitDetectionInstructions.push([p.default.SET_FILL_STYLE,c.defaultFillStyle]),void 0!==o.strokeStyle&&this.hitDetectionInstructions.push([p.default.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset]),i=t.getEnds(),n=t.getOrientedFlatCoordinates(),r=t.getStride(),this.drawFlatCoordinatess_(n,0,i,r),this.endGeometry(e))},f.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([p.default.SET_FILL_STYLE,c.defaultFillStyle]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([p.default.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinatess_(s,l,o[u],a);this.endGeometry(e)}},f.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,i=0,n=e.length;i<n;++i)e[i]=(0,o.snap)(e[i],t);return l.prototype.finish.call(this)},f.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},f);function f(t,e,i,n){return l.call(this,t,e,i,n)||this}i.default=d},{"../../geom/flat/simplify.js":155,"../canvas.js":219,"./Builder.js":220,"./Instruction.js":227}],230:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.TEXT_ALIGN=void 0;var n=r(t("./Builder.js")),M=r(t("./Instruction.js")),I=r(t("../../geom/GeometryType.js")),R=r(t("../../style/TextPlacement.js")),y=t("../../colorlike.js"),k=t("../canvas.js"),_=t("../../util.js"),A=t("../../extent.js"),L=t("../../geom/flat/straightchunk.js");function r(t){return t&&t.__esModule?t:{default:t}}var o,s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};i.TEXT_ALIGN=p;var a,l=(a=n.default,s(u,a),u.prototype.finish=function(){var t=a.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},u.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(i||n)){var o=this.coordinates.length,s=t.getType(),a=null,l=2,u=2;if(r.placement===R.default.LINE){if(!(0,A.intersects)(this.getBufferedMaxExtent(),t.getExtent()))return;var h=void 0,a=t.getFlatCoordinates(),u=t.getStride();if(s==I.default.LINE_STRING)h=[a.length];else if(s==I.default.MULTI_LINE_STRING)h=t.getEnds();else if(s==I.default.POLYGON)h=t.getEnds().slice(0,1);else if(s==I.default.MULTI_POLYGON)for(var c=t.getEndss(),h=[],d=0,p=c.length;d<p;++d)h.push(c[d][0]);this.beginGeometry(t,e);for(var f,g=r.textAlign,m=0,y=void 0,_=0,v=h.length;_<v;++_){for(y=null==g?(m=(f=(0,L.matchingChunk)(r.maxAngle,a,m,h[_],u))[0],f[1]):h[_],d=m;d<y;d+=u)this.coordinates.push(a[d],a[d+1]);l=this.coordinates.length,m=h[_];var b=this.declutterGroups_?0===_?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(o,l,b),o=l}this.endGeometry(e)}else{var j=null;switch(r.overflow||(j=[]),s){case I.default.POINT:case I.default.MULTI_POINT:l=(a=t.getFlatCoordinates()).length;break;case I.default.LINE_STRING:a=t.getFlatMidpoint();break;case I.default.CIRCLE:a=t.getCenter();break;case I.default.MULTI_LINE_STRING:l=(a=t.getFlatMidpoints()).length;break;case I.default.POLYGON:a=t.getFlatInteriorPoint(),r.overflow||j.push(a[2]/this.resolution),u=3;break;case I.default.MULTI_POLYGON:var x=t.getFlatInteriorPoints();for(a=[],d=0,p=x.length;d<p;d+=3)r.overflow||j.push(x[d+2]/this.resolution),a.push(x[d],x[d+1]);if(0==(l=a.length))return}l=this.appendFlatCoordinates(a,0,l,u,!1,!1),this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var S,w,P,E,T=r.padding;T!=k.defaultPadding&&(r.scale[0]<0||r.scale[1]<0)&&(S=r.padding[0],w=r.padding[1],P=r.padding[2],E=r.padding[3],r.scale[0]<0&&(w=-w,E=-E),r.scale[1]<0&&(S=-S,P=-P),T=[S,w,P,E]);var O=this.pixelRatio;this.instructions.push([M.default.DRAW_IMAGE,o,l,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,T==k.defaultPadding?k.defaultPadding:T.map(function(t){return t*O}),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,j]);var C=1/O;this.hitDetectionInstructions.push([M.default.DRAW_IMAGE,o,l,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[C,C],NaN,T,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,j]),this.endGeometry(e)}}},u.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||k.defaultTextAlign,textBaseline:e.textBaseline||k.defaultTextBaseline,scale:e.scale});var o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))},u.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,r=this.textState_,o=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,u=p[r.textBaseline],h=this.textOffsetY_*l,c=this.text_,d=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([M.default.DRAW_CHARS,t,e,u,i,r.overflow,a,r.maxAngle,l,h,o,d*l,c,s,1]),this.hitDetectionInstructions.push([M.default.DRAW_CHARS,t,e,u,i,r.overflow,a,r.maxAngle,1,h,o,d,c,s,1/l])},u.prototype.setTextStyle=function(t,e){var i,n,r,o,s,a,l,u,h,c,d,p,f,g,m;t?(this.declutterGroups_=e,(o=t.getFill())?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=(0,y.asColorLike)(o.getColor()||k.defaultFillStyle)):(n=null,this.textFillState_=n),(s=t.getStroke())?((r=this.textStrokeState_)||(r={},this.textStrokeState_=r),a=s.getLineDash(),l=s.getLineDashOffset(),u=s.getWidth(),h=s.getMiterLimit(),r.lineCap=s.getLineCap()||k.defaultLineCap,r.lineDash=a?a.slice():k.defaultLineDash,r.lineDashOffset=void 0===l?k.defaultLineDashOffset:l,r.lineJoin=s.getLineJoin()||k.defaultLineJoin,r.lineWidth=void 0===u?k.defaultLineWidth:u,r.miterLimit=void 0===h?k.defaultMiterLimit:h,r.strokeStyle=(0,y.asColorLike)(s.getColor()||k.defaultStrokeStyle)):(r=null,this.textStrokeState_=r),i=this.textState_,c=t.getFont()||k.defaultFont,(0,k.registerFont)(c),d=t.getScaleArray(),i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||k.defaultTextBaseline,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||k.defaultPadding,i.scale=void 0===d?[1,1]:d,p=t.getOffsetX(),f=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation(),this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===f?0:f,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===m?0:m,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:(0,_.getUid)(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+(0,_.getUid)(n.fillStyle):""):this.text_=""},u);function u(t,e,i,n){var r=a.call(this,t,e,i,n)||this;return r.declutterGroups_,r.labels_=null,r.text_="",r.textOffsetX_=0,r.textOffsetY_=0,r.textRotateWithView_=void 0,r.textRotation_=0,r.textFillState_=null,r.fillStates={},r.textStrokeState_=null,r.strokeStates={},r.textState_={},r.textStates={},r.textKey_="",r.fillKey_="",r.strokeKey_="",r}i.default=l},{"../../colorlike.js":48,"../../extent.js":70,"../../geom/GeometryType.js":131,"../../geom/flat/straightchunk.js":156,"../../style/TextPlacement.js":304,"../../util.js":313,"../canvas.js":219,"./Builder.js":220,"./Instruction.js":227}],231:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createHitDetectionImageData=function(t,e,i,n,r,o,s){var a=t[0]/2,l=t[1]/2,u=(0,H.createCanvasContext2D)(a,l);u.imageSmoothingEnabled=!1;for(var h=u.canvas,c=new B.default(u,.5,r,null,s),d=i.length,p=Math.floor(16777215/d),f={},g=1;g<=d;++g){var m=i[g-1],y=m.getStyleFunction()||n;if(n){var _=y(m,o);if(_){Array.isArray(_)||(_=[_]);for(var v="#"+("000000"+(g*p).toString(16)).slice(-6),b=0,j=_.length;b<j;++b){var x=_[b],S=x.clone(),w=S.getFill();w&&w.setColor(v);var P=S.getStroke();P&&P.setColor(v),S.setText(void 0);var E=x.getImage();if(E){var T=E.getImageSize();if(!T)continue;var O=document.createElement("canvas");O.width=T[0],O.height=T[1];var C=O.getContext("2d",{alpha:!1});C.fillStyle=v;var M=C.canvas;C.fillRect(0,0,M.width,M.height);var I=T?T[0]:M.width,R=T?T[1]:M.height;(0,H.createCanvasContext2D)(I,R).drawImage(M,0,0),S.setImage(new Y.Icon({img:M,imgSize:T,anchor:E.getAnchor(),anchorXUnits:V.default.PIXELS,anchorYUnits:V.default.PIXELS,offset:E.getOrigin(),size:E.getSize(),opacity:E.getOpacity(),scale:E.getScale(),rotation:E.getRotation(),rotateWithView:E.getRotateWithView()}))}var k=Number(S.getZIndex());(N=f[k])||(N={},(f[k]=N)[W.default.POLYGON]=[],N[W.default.CIRCLE]=[],N[W.default.LINE_STRING]=[],N[W.default.POINT]=[]);var A=S.getGeometryFunction()(m);A&&(0,X.intersects)(r,A.getExtent())&&N[A.getType().replace("Multi","")].push(A,S)}}}}for(var L=Object.keys(f).map(Number).sort(q.numberSafeCompareFunction),F=(g=0,L.length);g<F;++g){var N=f[L[g]];for(var D in N){var G=N[D];for(b=0,j=G.length;b<j;b+=2){c.setStyle(G[b+1]);for(var U=0,z=e.length;U<z;++U)c.setTransform(e[U]),c.drawGeometry(G[b])}}}return u.getImageData(0,0,h.width,h.height)},i.hitDetect=function(t,e,i){var n=[];{var r,o,s,a,l;i&&(r=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width),o=i.data[r],s=i.data[1+r],a=i.data[2+r]+256*(s+256*o),l=Math.floor(16777215/e.length),a&&a%l==0&&n.push(e[a/l-1]))}return n};var B=n(t("./Immediate.js")),W=n(t("../../geom/GeometryType.js")),V=n(t("../../style/IconAnchorUnits.js")),Y=t("../../style.js"),H=t("../../dom.js"),X=t("../../extent.js"),q=t("../../array.js");function n(t){return t&&t.__esModule?t:{default:t}}},{"../../array.js":44,"../../dom.js":62,"../../extent.js":70,"../../geom/GeometryType.js":131,"../../style.js":291,"../../style/IconAnchorUnits.js":295,"./Immediate.js":226}],232:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=p(t("./Map.js")),r=p(t("../ObjectEventType.js")),o=p(t("../render/Event.js")),l=p(t("../render/EventType.js")),u=p(t("../source/State.js")),s=t("../css.js"),a=t("../render/canvas.js"),d=t("../layer/Layer.js"),h=t("../events.js"),c=t("../dom.js");function p(t){return t&&t.__esModule?t:{default:t}}var f,g,m=(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),y=(f=n.default,m(_,f),_.prototype.dispatchRenderEvent=function(t,e){var i,n=this.getMap();n.hasListener(t)&&(i=new o.default(t,void 0,e),n.dispatchEvent(i))},_.prototype.disposeInternal=function(){(0,h.unlistenByKey)(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),f.prototype.disposeInternal.call(this)},_.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(l.default.PRECOMPOSE,t);for(var e=t.layerStatesArray.sort(function(t,e){return t.zIndex-e.zIndex}),i=t.viewState,n=null,r=this.children_.length=0,o=e.length;r<o;++r){var s,a=e[r];t.layerIndex=r,!(0,d.inView)(a,i)||a.sourceState!=u.default.READY&&a.sourceState!=u.default.UNDEFINED||(s=a.layer.render(t,n))&&s!==n&&(this.children_.push(s),n=s)}f.prototype.renderFrame.call(this,t),(0,c.replaceChildren)(this.element_,this.children_),this.dispatchRenderEvent(l.default.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},_.prototype.forEachLayerAtPixel=function(t,e,i,n,r){for(var o=e.viewState,s=e.layerStatesArray,a=s.length-1;0<=a;--a){var l=s[a],u=l.layer;if(u.hasRenderer()&&(0,d.inView)(l,o)&&r(u)){var h=u.getRenderer().getDataAtPixel(t,e,i);if(h){var c=n(u,h);if(c)return c}}}},_);function _(t){var e=f.call(this,t)||this;e.fontChangeListenerKey_=(0,h.listen)(a.checkedFonts,r.default.PROPERTYCHANGE,t.redrawText.bind(t)),e.element_=document.createElement("div");var i=e.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",e.element_.className=s.CLASS_UNSELECTABLE+" ol-layers";var n=t.getViewport();return n.insertBefore(e.element_,n.firstChild||null),e.children_=[],e.renderedVisible_=!0,e}i.default=y},{"../ObjectEventType.js":29,"../css.js":61,"../dom.js":62,"../events.js":64,"../layer/Layer.js":192,"../render/Event.js":215,"../render/EventType.js":216,"../render/canvas.js":219,"../source/State.js":267,"./Map.js":234}],233:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=l(t("../events/EventType.js")),r=l(t("../ImageState.js")),o=l(t("../Observable.js")),s=l(t("../source/State.js")),a=t("../util.js");function l(t){return t&&t.__esModule?t:{default:t}}var u,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(u=o.default,c(p,u),p.prototype.getFeatures=function(t){return(0,a.abstract)()},p.prototype.prepareFrame=function(t){return(0,a.abstract)()},p.prototype.renderFrame=function(t,e){return(0,a.abstract)()},p.prototype.loadedTileCallback=function(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i},p.prototype.createLoadedTileFinder=function(n,r,o){return function(t,e){var i=this.loadedTileCallback.bind(this,o,t);return n.forEachLoadedTile(r,t,e,i)}.bind(this)},p.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){},p.prototype.getDataAtPixel=function(t,e,i){return(0,a.abstract)()},p.prototype.getLayer=function(){return this.layer_},p.prototype.handleFontsChanged=function(){},p.prototype.handleImageChange_=function(t){t.target.getState()===r.default.LOADED&&this.renderIfReadyAndVisible()},p.prototype.loadImage=function(t){var e=t.getState();return e!=r.default.LOADED&&e!=r.default.ERROR&&t.addEventListener(n.default.CHANGE,this.boundHandleImageChange_),e==r.default.IDLE&&(t.load(),e=t.getState()),e==r.default.LOADED},p.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==s.default.READY&&t.changed()},p);function p(t){var e=u.call(this)||this;return e.boundHandleImageChange_=e.handleImageChange_.bind(e),e.layer_=t,e}i.default=d},{"../ImageState.js":18,"../Observable.js":30,"../events/EventType.js":66,"../source/State.js":267,"../util.js":313}],234:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("../Disposable.js"))&&n.__esModule?n:{default:n},s=t("../functions.js"),o=t("../util.js"),a=t("../transform.js"),O=t("../extent.js"),l=t("../style/IconImageCache.js"),C=t("../layer/Layer.js"),u=t("../render.js"),M=t("../coordinate.js");var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(h=r.default,d(f,h),f.prototype.dispatchRenderEvent=function(t,e){(0,o.abstract)()},f.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;(0,a.compose)(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),(0,a.makeInverse)(n,i)},f.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s,a){var l,u=e.viewState;function h(t,e,i){return r.call(o,e,t?i:null)}var c,d,p=u.projection,f=(0,M.wrapX)(t.slice(),p),g=[[0,0]];p.canWrapX()&&n&&(c=p.getExtent(),d=(0,O.getWidth)(c),g.push([-d,0],[d,0]));var m,y=e.layerStatesArray,_=y.length;this.declutterTree_&&(m=this.declutterTree_.all().map(function(t){return t.value}));for(var v=[],b=0;b<g.length;b++)for(var j=_-1;0<=j;--j){var x=y[j],S=x.layer;if(S.hasRenderer()&&(0,C.inView)(x,u)&&s.call(a,S)){var w,P,E=S.getRenderer(),T=S.getSource();if(E&&T&&(w=T.getWrapX()?f:t,P=h.bind(null,x.managed),v[0]=w[0]+g[b][0],v[1]=w[1]+g[b][1],l=E.forEachFeatureAtCoordinate(v,e,i,P,m)),l)return l}}},f.prototype.forEachLayerAtPixel=function(t,e,i,n,r){return(0,o.abstract)()},f.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,s.TRUE,this,r,o)},f.prototype.getMap=function(){return this.map_},f.prototype.renderFrame=function(t){this.declutterTree_=(0,u.renderDeclutterItems)(t,this.declutterTree_)},f.prototype.scheduleExpireIconCache=function(t){l.shared.canExpireCache()&&t.postRenderFunctions.push(g)},f);function f(t){var e=h.call(this)||this;return e.map_=t,e.declutterTree_=null,e}function g(t,e){l.shared.expire()}i.default=p},{"../Disposable.js":12,"../coordinate.js":60,"../extent.js":70,"../functions.js":125,"../layer/Layer.js":192,"../render.js":213,"../style/IconImageCache.js":297,"../transform.js":311,"../util.js":313}],235:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=r(t("./Layer.js")),c=r(t("../../ViewHint.js")),d=t("../../reproj/common.js"),C=t("../../obj.js"),M=t("../../transform.js"),I=t("../../extent.js"),R=t("../../render/canvas.js"),k=t("../../proj.js");function r(t){return t&&t.__esModule?t:{default:t}}var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=n.default,a(u,o),u.prototype.getImage=function(){return this.image_?this.image_.getImage():null},u.prototype.prepareFrame=function(t){var e,i,n,r=t.layerStatesArray[t.layerIndex],o=t.pixelRatio,s=t.viewState,a=s.resolution,l=this.getLayer().getSource(),u=t.viewHints,h=t.extent;return void 0!==r.extent&&(h=(0,I.getIntersection)(h,(0,k.fromUserExtent)(r.extent,s.projection))),u[c.default.ANIMATING]||u[c.default.INTERACTING]||(0,I.isEmpty)(h)||(l?(e=s.projection,d.ENABLE_RASTER_REPROJECTION||(i=l.getProjection())&&(e=i),(n=l.getImage(h,a,o,e))&&this.loadImage(n)&&(this.image_=n)):this.image_=null),!!this.image_},u.prototype.renderFrame=function(t,e){var i=this.image_,n=i.getExtent(),r=i.getResolution(),o=i.getPixelRatio(),s=t.layerStatesArray[t.layerIndex],a=t.pixelRatio,l=t.viewState,u=l.center,h=l.resolution,c=t.size,d=a*r/(h*o),p=Math.round(c[0]*a),f=Math.round(c[1]*a),g=l.rotation;g&&(f=p=Math.round(Math.sqrt(p*p+f*f))),(0,M.compose)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,g,-p/2,-f/2),(0,M.makeInverse)(this.inversePixelTransform,this.pixelTransform);var m=(0,R.createTransformString)(this.pixelTransform);this.useContainer(e,m,s.opacity);var y=this.context,_=y.canvas;_.width!=p||_.height!=f?(_.width=p,_.height=f):this.containerReused||y.clearRect(0,0,p,f);var v,b=!1;s.extent&&(v=(0,k.fromUserExtent)(s.extent,l.projection),(b=!(0,I.containsExtent)(v,t.extent)&&(0,I.intersects)(v,t.extent))&&this.clipUnrotated(y,t,v));var j=i.getImage(),x=(0,M.compose)(this.tempTransform,p/2,f/2,d,d,0,o*(n[0]-u[0])/r,o*(u[1]-n[3])/r);this.renderedResolution=r*a/o;var S,w,P=x[4],E=x[5],T=j.width*x[0],O=j.height*x[3];return(0,C.assign)(y,this.getLayer().getSource().getContextOptions()),this.preRender(y,t),.5<=T&&.5<=O&&(w=void 0,1!==(S=s.opacity)&&(w=this.context.globalAlpha,this.context.globalAlpha=S),this.context.drawImage(j,0,0,+j.width,+j.height,Math.round(P),Math.round(E),Math.round(T),Math.round(O)),1!==S&&(this.context.globalAlpha=w)),this.postRender(y,t),b&&y.restore(),m!==_.style.transform&&(_.style.transform=m),this.container},u);function u(t){var e=o.call(this,t)||this;return e.image_=null,e}i.default=l},{"../../ViewHint.js":42,"../../extent.js":70,"../../obj.js":203,"../../proj.js":205,"../../render/canvas.js":219,"../../reproj/common.js":248,"../../transform.js":311,"./Layer.js":236}],236:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("../Layer.js")),o=s(t("../../render/Event.js")),r=s(t("../../render/EventType.js")),p=t("../../transform.js"),l=t("../../dom.js"),c=t("../../extent.js"),d=t("../../render/canvas.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f=(a=n.default,h(g,a),g.prototype.useContainer=function(t,e,i){var n,r,o,s,a=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===a&&(s=t.firstElementChild)instanceof HTMLCanvasElement&&(r=s.getContext("2d")),!r||0!==r.canvas.width&&r.canvas.style.transform!==e?this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1):(this.container=t,this.context=r,this.containerReused=!0),this.container||((n=document.createElement("div")).className=a,(o=n.style).position="absolute",o.width="100%",o.height="100%",s=(r=(0,l.createCanvasContext2D)()).canvas,n.appendChild(s),(o=s.style).position="absolute",o.left="0",o.transformOrigin="top left",this.container=n,this.context=r)},g.prototype.clip=function(t,e,i){var n=e.pixelRatio,r=e.size[0]*n/2,o=e.size[1]*n/2,s=e.viewState.rotation,a=(0,c.getTopLeft)(i),l=(0,c.getTopRight)(i),u=(0,c.getBottomRight)(i),h=(0,c.getBottomLeft)(i);(0,p.apply)(e.coordinateToPixelTransform,a),(0,p.apply)(e.coordinateToPixelTransform,l),(0,p.apply)(e.coordinateToPixelTransform,u),(0,p.apply)(e.coordinateToPixelTransform,h),t.save(),(0,d.rotateAtOffset)(t,-s,r,o),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(h[0]*n,h[1]*n),t.clip(),(0,d.rotateAtOffset)(t,s,r,o)},g.prototype.clipUnrotated=function(t,e,i){var n=(0,c.getTopLeft)(i),r=(0,c.getTopRight)(i),o=(0,c.getBottomRight)(i),s=(0,c.getBottomLeft)(i);(0,p.apply)(e.coordinateToPixelTransform,n),(0,p.apply)(e.coordinateToPixelTransform,r),(0,p.apply)(e.coordinateToPixelTransform,o),(0,p.apply)(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;(0,p.apply)(a,n),(0,p.apply)(a,r),(0,p.apply)(a,o),(0,p.apply)(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},g.prototype.dispatchRenderEvent_=function(t,e,i){var n,r=this.getLayer();r.hasListener(t)&&(n=new o.default(t,this.inversePixelTransform,i,e),r.dispatchEvent(n))},g.prototype.preRender=function(t,e){this.dispatchRenderEvent_(r.default.PRERENDER,t,e)},g.prototype.postRender=function(t,e){this.dispatchRenderEvent_(r.default.POSTRENDER,t,e)},g.prototype.getRenderTransform=function(t,e,i,n,r,o,s){var a=r/2,l=o/2,u=n/e,h=-u,c=-t[0]+s,d=-t[1];return(0,p.compose)(this.tempTransform,a,l,u,h,-i,c,d)},g.prototype.getDataAtPixel=function(t,e,i){var n,r=(0,p.apply)(this.inversePixelTransform,t.slice()),o=this.context;try{var s=Math.round(r[0]),a=Math.round(r[1]),l=document.createElement("canvas"),u=l.getContext("2d");l.width=1,l.height=1,u.clearRect(0,0,1,1),u.drawImage(o.canvas,s,a,1,1,0,0,1,1),n=u.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},g);function g(t){var e=a.call(this,t)||this;return e.container=null,e.renderedResolution,e.tempTransform=(0,p.create)(),e.pixelTransform=(0,p.create)(),e.inversePixelTransform=(0,p.create)(),e.context=null,e.containerReused=!1,e}i.default=f},{"../../dom.js":62,"../../extent.js":70,"../../render/Event.js":215,"../../render/EventType.js":216,"../../render/canvas.js":219,"../../transform.js":311,"../Layer.js":233}],237:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./Layer.js")),r=o(t("../../TileRange.js")),dt=o(t("../../TileState.js")),pt=t("../../transform.js"),ft=t("../../obj.js"),gt=t("../../extent.js"),mt=t("../../render/canvas.js"),yt=t("../../proj.js"),_t=t("../../util.js"),vt=t("../../array.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.isDrawableTile=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==dt.default.LOADED||i==dt.default.EMPTY||i==dt.default.ERROR&&!n},h.prototype.getTile=function(t,e,i,n){var r=n.pixelRatio,o=n.viewState.projection,s=this.getLayer(),a=s.getSource().getTile(t,e,i,r,o);return a.getState()==dt.default.ERROR&&(s.getUseInterimTilesOnError()?0<s.getPreload()&&(this.newTiles_=!0):a.setState(dt.default.LOADED)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},h.prototype.loadedTileCallback=function(t,e,i){return!!this.isDrawableTile(i)&&s.prototype.loadedTileCallback.call(this,t,e,i)},h.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},h.prototype.renderFrame=function(t,e){var i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,o=n.resolution,s=n.center,a=n.rotation,l=t.pixelRatio,u=this.getLayer(),h=u.getSource(),c=h.getRevision(),d=h.getTileGridForProjection(r),p=d.getZForResolution(o,h.zDirection),f=d.getResolution(p),g=t.extent,m=i.extent&&(0,yt.fromUserExtent)(i.extent,r);m&&(g=(0,gt.getIntersection)(g,(0,yt.fromUserExtent)(i.extent,r)));var y=h.getTilePixelRatio(l),_=Math.round(t.size[0]*y),v=Math.round(t.size[1]*y);a&&(v=_=Math.round(Math.sqrt(_*_+v*v)));var b=f*_/2/y,j=f*v/2/y,x=[s[0]-b,s[1]-j,s[0]+b,s[1]+j],S=d.getTileRangeForExtentAndZ(g,p),w={};w[p]={};var P=this.createLoadedTileFinder(h,r,w),E=this.tmpExtent,T=this.tmpTileRange_;this.newTiles_=!1;for(var O=S.minX;O<=S.maxX;++O)for(var C=S.minY;C<=S.maxY;++C){var M=this.getTile(p,O,C,t);if(this.isDrawableTile(M)){var I,R=(0,_t.getUid)(this);if(M.getState()==dt.default.LOADED&&(I=(w[p][M.tileCoord.toString()]=M).inTransition(R),this.newTiles_||!I&&-1!==this.renderedTiles.indexOf(M)||(this.newTiles_=!0)),1===M.getAlpha(R,t.time))continue}var k=d.getTileCoordChildTileRange(M.tileCoord,T,E),A=!1;k&&(A=P(p+1,k)),A||d.forEachTileCoordParentTileRange(M.tileCoord,P,T,E)}var L=f/o;(0,pt.compose)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/y,1/y,a,-_/2,-v/2);var F=(0,mt.createTransformString)(this.pixelTransform);this.useContainer(e,F,i.opacity);var N=this.context,D=N.canvas;(0,pt.makeInverse)(this.inversePixelTransform,this.pixelTransform),(0,pt.compose)(this.tempTransform,_/2,v/2,L,L,0,-_/2,-v/2),D.width!=_||D.height!=v?(D.width=_,D.height=v):this.containerReused||N.clearRect(0,0,_,v),m&&this.clipUnrotated(N,t,m),(0,ft.assign)(N,h.getContextOptions()),this.preRender(N,t),this.renderedTiles.length=0;var G,U,z,B=Object.keys(w).map(Number);B.sort(vt.numberSafeCompareFunction),1!==i.opacity||this.containerReused&&!h.getOpaque(t.viewState.projection)?(G=[],U=[]):B=B.reverse();for(var W=B.length-1;0<=W;--W){var V=B[W],Y=h.getTilePixelSize(V,l,r),H=d.getResolution(V)/f,X=Y[0]*H*L,q=Y[1]*H*L,K=d.getTileCoordForCoordAndZ((0,gt.getTopLeft)(x),V),Z=d.getTileCoordExtent(K),$=(0,pt.apply)(this.tempTransform,[y*(Z[0]-x[0])/f,y*(x[3]-Z[3])/f]),Q=y*h.getGutterForProjection(r),J=w[V];for(var tt in J){var et=(M=J[tt]).tileCoord,it=$[0]-(K[1]-et[1])*X,nt=Math.round(it+X),rt=$[1]-(K[2]-et[2])*q,ot=Math.round(rt+q),st=nt-(O=Math.round(it)),at=ot-(C=Math.round(rt)),lt=p===V;if(!(I=lt&&1!==M.getAlpha((0,_t.getUid)(this),t.time)))if(G){N.save(),z=[O,C,O+st,C,O+st,C+at,O,C+at];for(var ut,ht=0,ct=G.length;ht<ct;++ht)p!==V&&V<U[ht]&&(ut=G[ht],N.beginPath(),N.moveTo(z[0],z[1]),N.lineTo(z[2],z[3]),N.lineTo(z[4],z[5]),N.lineTo(z[6],z[7]),N.moveTo(ut[6],ut[7]),N.lineTo(ut[4],ut[5]),N.lineTo(ut[2],ut[3]),N.lineTo(ut[0],ut[1]),N.clip());G.push(z),U.push(V)}else N.clearRect(O,C,st,at);this.drawTileImage(M,t,O,C,st,at,Q,lt,i.opacity),G&&!I&&N.restore(),this.renderedTiles.push(M),this.updateUsedTiles(t.usedTiles,h,M)}}return this.renderedRevision=c,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!(0,gt.equals)(this.renderedExtent_,x),this.renderedExtent_=x,this.renderedPixelRatio=l,this.renderedProjection=r,this.manageTilePyramid(t,h,d,l,r,g,p,u.getPreload()),this.scheduleExpireCache(t,h),this.postRender(N,t),i.extent&&N.restore(),F!==D.style.transform&&(D.style.transform=F),this.container},h.prototype.drawTileImage=function(t,e,i,n,r,o,s,a,l){var u,h,c,d,p=this.getTileImage(t);p&&(u=(0,_t.getUid)(this),(d=(c=l*(h=a?t.getAlpha(u,e.time):1))!==this.context.globalAlpha)&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(p,s,s,p.width-2*s,p.height-2*s,i,n,r,o),d&&this.context.restore(),1!==h?e.animate=!0:a&&t.endTransition(u))},h.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},h.prototype.getTileImage=function(t){return t.getImage()},h.prototype.scheduleExpireCache=function(t,e){var i;e.canExpireCache()&&(i=function(t,e,i){var n=(0,_t.getUid)(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e),t.postRenderFunctions.push(i))},h.prototype.updateUsedTiles=function(t,e,i){var n=(0,_t.getUid)(e);n in t||(t[n]={}),t[n][i.getKey()]=!0},h.prototype.manageTilePyramid=function(t,e,i,n,r,o,s,a,l){var u=(0,_t.getUid)(e);u in t.wantedTiles||(t.wantedTiles[u]={});for(var h,c,d,p,f,g=t.wantedTiles[u],m=t.tileQueue,y=0,_=i.getMinZoom();_<=s;++_)for(c=i.getTileRangeForExtentAndZ(o,_,c),d=i.getResolution(_),p=c.minX;p<=c.maxX;++p)for(f=c.minY;f<=c.maxY;++f)s-_<=a?(++y,(h=e.getTile(_,p,f,n,r)).getState()==dt.default.IDLE&&(g[h.getKey()]=!0,m.isKeyQueued(h.getKey())||m.enqueue([h,u,i.getTileCoordCenter(h.tileCoord),d])),void 0!==l&&l(h)):e.useTile(_,p,f,r);e.updateCacheSize(y,r)},h);function h(t){var e=s.call(this,t)||this;return e.extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=(0,gt.createEmpty)(),e.tmpTileRange_=new r.default(0,0,0,0),e}u.prototype.getLayer,i.default=u},{"../../TileRange.js":37,"../../TileState.js":38,"../../array.js":44,"../../extent.js":70,"../../obj.js":203,"../../proj.js":205,"../../render/canvas.js":219,"../../transform.js":311,"../../util.js":313,"./Layer.js":236}],238:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("./ImageLayer.js")),r=o(t("./VectorLayer.js")),d=o(t("../../events/EventType.js")),p=o(t("../../ImageCanvas.js")),f=o(t("../../ImageState.js")),g=o(t("../../ViewHint.js")),m=t("../../transform.js"),y=t("../../obj.js"),_=t("../../extent.js"),v=t("../../render.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.disposeInternal=function(){this.vectorRenderer_.dispose(),s.prototype.disposeInternal.call(this)},h.prototype.getFeatures=function(t){if(this.vectorRenderer_){var e=(0,m.apply)(this.coordinateToVectorPixelTransform_,(0,m.apply)(this.renderedPixelToCoordinateTransform_,t.slice()));return this.vectorRenderer_.getFeatures(e)}return new Promise(function(t,e){t([])})},h.prototype.handleFontsChanged=function(){this.vectorRenderer_.handleFontsChanged()},h.prototype.prepareFrame=function(t){var n=t.pixelRatio,r=t.viewState,e=r.resolution,i=t.viewHints,o=this.vectorRenderer_,s=t.extent;1!==this.layerImageRatio_&&(s=s.slice(0),(0,_.scaleFromCenter)(s,this.layerImageRatio_));var a,l,u,h=(0,_.getWidth)(s)/e,c=(0,_.getHeight)(s)/e;return i[g.default.ANIMATING]||i[g.default.INTERACTING]||(0,_.isEmpty)(s)||(o.useContainer(null,null,1),a=o.context,l=(0,y.assign)({},t,{coordinateToPixelTransform:(0,m.create)(),declutterItems:[],extent:s,size:[h,c],viewState:(0,y.assign)({},t.viewState,{rotation:0})}),(u=new p.default(s,e,n,a.canvas,function(t){o.prepareFrame(l)&&o.replayGroupChanged&&(o.renderFrame(l,null),(0,v.renderDeclutterItems)(l,null),t())})).addEventListener(d.default.CHANGE,function(){var t,e,i;u.getState()===f.default.LOADED&&(t=(this.image_=u).getResolution(),e=u.getPixelRatio(),i=t*n/e,this.renderedResolution=i,this.coordinateToVectorPixelTransform_=(0,m.compose)(this.coordinateToVectorPixelTransform_,h/2,c/2,1/i,-1/i,0,-r.center[0],-r.center[1]))}.bind(this)),u.load()),this.image_&&(this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice()),!!this.image_},h.prototype.preRender=function(){},h.prototype.postRender=function(){},h.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(t,e,i,n,r):s.prototype.forEachFeatureAtCoordinate.call(this,t,e,i,n,r)},h);function h(t){var e=s.call(this,t)||this;return e.vectorRenderer_=new r.default(t),e.layerImageRatio_=t.getImageRatio(),e.coordinateToVectorPixelTransform_=(0,m.create)(),e.renderedPixelToCoordinateTransform_=null,e}i.default=u},{"../../ImageCanvas.js":17,"../../ImageState.js":18,"../../ViewHint.js":42,"../../events/EventType.js":66,"../../extent.js":70,"../../obj.js":203,"../../render.js":213,"../../transform.js":311,"./ImageLayer.js":235,"./VectorLayer.js":239}],239:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var k=r(t("../../render/canvas/BuilderGroup.js")),n=r(t("./Layer.js")),A=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("../../render/canvas/ExecutorGroup.js")),L=r(t("../../ViewHint.js")),F=t("../../transform.js"),N=t("../../extent.js"),v=t("../../render/canvas/hitdetect.js"),D=t("../vector.js"),G=t("../../proj.js"),u=t("../../util.js"),U=t("../../coordinate.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function r(t){return t&&t.__esModule?t:{default:t}}var o,l,h=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=(o=n.default,h(d,o),d.prototype.useContainer=function(t,e,i){i<1&&(t=null),o.prototype.useContainer.call(this,t,e,i)},d.prototype.renderFrame=function(t,e){var i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];(0,F.makeScale)(this.pixelTransform,1/i,1/i),(0,F.makeInverse)(this.inversePixelTransform,this.pixelTransform);var r=(0,F.toString)(this.pixelTransform);this.useContainer(e,r,n.opacity);var o=this.context,s=o.canvas,a=this.replayGroup_;if(!a||a.isEmpty())return!this.containerReused&&0<s.width&&(s.width=0),this.container;var l=Math.round(t.size[0]*i),u=Math.round(t.size[1]*i);s.width!=l||s.height!=u?(s.width=l,s.height=u,s.style.transform!==r&&(s.style.transform=r)):this.containerReused||o.clearRect(0,0,l,u),this.preRender(o,t);var h,c=t.extent,d=t.viewState,p=d.center,f=d.resolution,g=d.projection,m=d.rotation,y=g.getExtent(),_=this.getLayer().getSource(),v=!1;n.extent&&(h=(0,G.fromUserExtent)(n.extent,g),(v=!(0,N.containsExtent)(h,t.extent)&&(0,N.intersects)(h,t.extent))&&this.clipUnrotated(o,t,h));var b,j,x=t.viewHints,S=!(x[L.default.ANIMATING]||x[L.default.INTERACTING]),w=this.getRenderTransform(p,f,m,i,l,u,0),P=this.getLayer().getDeclutter()?{}:null;if(a.execute(o,1,w,m,S,void 0,P),_.getWrapX()&&g.canWrapX()&&!(0,N.containsExtent)(y,c)){for(var E=c[0],T=(0,N.getWidth)(y),O=0,C=void 0;E<y[0];){C=T*--O;var M=this.getRenderTransform(p,f,m,i,l,u,C);a.execute(o,1,M,m,S,void 0,P),E+=T}for(O=0,E=c[2];E>y[2];){C=T*++O;var I=this.getRenderTransform(p,f,m,i,l,u,C);a.execute(o,1,I,m,S,void 0,P),E-=T}}P&&(j=!((b=t.viewHints)[L.default.ANIMATING]||b[L.default.INTERACTING]),(0,A.replayDeclutter)(P,o,m,1,j,t.declutterItems)),v&&o.restore(),this.postRender(o,t);var R=n.opacity,k=this.container;return R!==parseFloat(k.style.opacity)&&(k.style.opacity=1===R?"":String(R)),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),this.container},d.prototype.getFeatures=function(_){return new Promise(function(t,e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var i=[this.context.canvas.width,this.context.canvas.height];(0,F.apply)(this.pixelTransform,i);var n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,a=this.renderedExtent_,l=this.getLayer(),u=[],h=i[0]/2,c=i[1]/2;u.push(this.getRenderTransform(n,r,o,.5,h,c,0).slice());var d=l.getSource(),p=s.getExtent();if(d.getWrapX()&&s.canWrapX()&&!(0,N.containsExtent)(p,a)){for(var f=a[0],g=(0,N.getWidth)(p),m=0,y=void 0;f<p[0];)y=g*--m,u.push(this.getRenderTransform(n,r,o,.5,h,c,y).slice()),f+=g;for(m=0,f=a[2];f>p[2];)y=g*++m,u.push(this.getRenderTransform(n,r,o,.5,h,c,y).slice()),f-=g}this.hitDetectionImageData_=(0,v.createHitDetectionImageData)(i,u,this.renderedFeatures_,l.getStyleFunction(),a,r,o)}t((0,v.hitDetect)(_,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},d.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if(this.replayGroup_){var o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,o,s,i,function(t){var e=(0,u.getUid)(t);if(!(e in l))return l[e]=!0,n(t,a)},a.getDeclutter()?r:null)}},d.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},d.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},d.prototype.prepareFrame=function(t){var r=this.getLayer(),e=r.getSource();if(!e)return!1;var i=t.viewHints[L.default.ANIMATING],n=t.viewHints[L.default.INTERACTING],o=r.getUpdateWhileAnimating(),s=r.getUpdateWhileInteracting();if(!this.dirty_&&!o&&i||!s&&n)return this.animatingOrInteracting_=!0;this.animatingOrInteracting_=!1;var a=t.extent,l=t.viewState,u=l.projection,h=l.resolution,c=t.pixelRatio,d=r.getRevision(),p=r.getRenderBuffer(),f=r.getRenderOrder();void 0===f&&(f=D.defaultOrder);var g,m,y,_=l.center.slice(),v=(0,N.buffer)(a,p*h),b=[v.slice()],j=u.getExtent();if(e.getWrapX()&&u.canWrapX()&&!(0,N.containsExtent)(j,t.extent)&&(g=(0,N.getWidth)(j),m=Math.max((0,N.getWidth)(v)/2,g),v[0]=j[0]-m,v[2]=j[2]+m,(0,U.wrapX)(_,u),(y=(0,N.wrapX)(b[0],u))[0]<j[0]&&y[2]<j[2]?b.push([y[0]+g,y[1],y[2]+g,y[3]]):y[0]>j[0]&&y[2]>j[2]&&b.push([y[0]-g,y[1],y[2]-g,y[3]])),!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==d&&this.renderedRenderOrder_==f&&(0,N.containsExtent)(this.renderedExtent_,v))return!(this.replayGroupChanged=!1);this.replayGroup_=null,this.dirty_=!1;var x,S=new k.default((0,D.getTolerance)(h,c),v,h,c,r.getDeclutter()),w=(0,G.getUserProjection)();if(w){for(var P=0,E=b.length;P<E;++P)e.loadFeatures((0,G.toUserExtent)(b[P],u),h,w);x=(0,G.getTransformFromProjections)(w,u)}else for(P=0,E=b.length;P<E;++P)e.loadFeatures(b[P],h,u);var T=(0,D.getSquaredTolerance)(h,c),O=function(t){var e,i,n=t.getStyleFunction()||r.getStyleFunction();n&&(e=n(t,h)),e&&(i=this.renderFeature(t,T,e,S,x),this.dirty_=this.dirty_||i)}.bind(this),C=(0,G.toUserExtent)(v,u),M=e.getFeaturesInExtent(C);for(f&&M.sort(f),P=0,E=M.length;P<E;++P)O(M[P]);this.renderedFeatures_=M;var I=S.finish(),R=new A.default(v,h,c,e.getOverlaps(),I,r.getRenderBuffer());return this.renderedResolution_=h,this.renderedRevision_=d,this.renderedRenderOrder_=f,this.renderedExtent_=v,this.renderedCenter_=_,this.renderedProjection_=u,this.replayGroup_=R,this.hitDetectionImageData_=null,this.replayGroupChanged=!0},d.prototype.renderFeature=function(t,e,i,n,r){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var s=0,a=i.length;s<a;++s)o=(0,D.renderFeature)(n,t,i[s],e,this.boundHandleStyleImageChange_,r)||o;else o=(0,D.renderFeature)(n,t,i,e,this.boundHandleStyleImageChange_,r);return o},d);function d(t){var e=o.call(this,t)||this;return e.boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(e),e.animatingOrInteracting_,e.dirty_=!1,e.hitDetectionImageData_=null,e.renderedFeatures_=null,e.renderedRevision_=-1,e.renderedResolution_=NaN,e.renderedExtent_=(0,N.createEmpty)(),e.renderedRotation_,e.renderedCenter_=null,e.renderedProjection_=null,e.renderedRenderOrder_=null,e.replayGroup_=null,e.replayGroupChanged=!0,e}i.default=c},{"../../ViewHint.js":42,"../../coordinate.js":60,"../../extent.js":70,"../../proj.js":205,"../../render/canvas/BuilderGroup.js":221,"../../render/canvas/ExecutorGroup.js":224,"../../render/canvas/hitdetect.js":231,"../../transform.js":311,"../../util.js":313,"../vector.js":241,"./Layer.js":236}],240:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var O=l(t("../../render/canvas/BuilderGroup.js")),z=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("../../render/canvas/ExecutorGroup.js")),n=l(t("./TileLayer.js")),p=l(t("../../events/EventType.js")),r=l(t("../../render/canvas/BuilderType.js")),C=l(t("../../TileState.js")),B=l(t("../../layer/VectorTileRenderType.js")),W=l(t("../../ViewHint.js")),V=t("../../transform.js"),M=t("../../extent.js"),o=t("../../obj.js"),P=t("../../render/canvas/hitdetect.js"),I=t("../vector.js"),Y=t("../../util.js"),f=t("../../events.js"),E=t("../../size.js"),T=t("../../coordinate.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function l(t){return t&&t.__esModule?t:{default:t}}var H,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),w={image:[r.default.POLYGON,r.default.CIRCLE,r.default.LINE_STRING,r.default.IMAGE,r.default.TEXT],hybrid:[r.default.POLYGON,r.default.LINE_STRING],vector:[]},X={image:[r.default.DEFAULT],hybrid:[r.default.IMAGE,r.default.TEXT,r.default.DEFAULT],vector:[r.default.POLYGON,r.default.CIRCLE,r.default.LINE_STRING,r.default.IMAGE,r.default.TEXT,r.default.DEFAULT]},c=(H=n.default,h(d,H),d.prototype.prepareTile=function(t,e,i,n){var r,o=(0,Y.getUid)(t),s=t.getState();return(s===C.default.LOADED&&t.hifi||s===C.default.ERROR)&&o in this.tileListenerKeys_&&((0,f.unlistenByKey)(this.tileListenerKeys_[o]),delete this.tileListenerKeys_[o]),s!==C.default.LOADED&&s!==C.default.ERROR||(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t,e,i)&&(r=!0,n&&(this.renderTileImageQueue_[o]=t))),r},d.prototype.getTile=function(t,e,i,n){var r,o,s,a=n.pixelRatio,l=n.viewState,u=l.resolution,h=l.projection,c=this.getLayer(),d=c.getSource().getTile(t,e,i,a,h);return d.getState()<C.default.LOADED?(d.wantedResolution=u,(r=(0,Y.getUid)(d))in this.tileListenerKeys_||(o=(0,f.listen)(d,p.default.CHANGE,this.prepareTile.bind(this,d,a,h,!0)),this.tileListenerKeys_[r]=o)):(((s=n.viewHints)[W.default.ANIMATING]||s[W.default.INTERACTING])&&d.wantedResolution||(d.wantedResolution=u),this.prepareTile(d,a,h,!1)&&c.getRenderMode()!==B.default.VECTOR&&this.renderTileImage_(d,n)),H.prototype.getTile.call(this,t,e,i,n)},d.prototype.isDrawableTile=function(t){var e=this.getLayer();return H.prototype.isDrawableTile.call(this,t)&&(e.getRenderMode()===B.default.VECTOR?(0,Y.getUid)(e)in t.executorGroups:t.hasContext(e))},d.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},d.prototype.prepareFrame=function(t){var e=this.getLayer().getRevision();return this.renderedLayerRevision_!=e&&(this.renderedTiles.length=0),this.renderedLayerRevision_=e,H.prototype.prepareFrame.call(this,t)},d.prototype.updateExecutorGroup_=function(m,y,t){var _=this.getLayer(),e=_.getRevision(),v=_.getRenderOrder()||null,b=m.wantedResolution,j=m.getReplayState(_);if(j.dirty||j.renderedResolution!==b||j.renderedRevision!=e||j.renderedRenderOrder!=v||j.renderedZ!==m.sourceZ){var x=_.getSource(),S=x.getTileGrid(),w=x.getTileGridForProjection(t).getTileCoordExtent(m.wrappedTileCoord),P=x.getSourceTiles(y,t,m),E=(0,Y.getUid)(_);delete m.hitDetectionImageData[E],m.executorGroups[E]=[];for(var T=this,i=0,n=P.length;i<n;++i)!function(t){var e=P[t];if(e.getState()==C.default.LOADED){var i=e.tileCoord,n=S.getTileCoordExtent(i),r=(0,M.getIntersection)(w,n),o=(0,M.equals)(n,r)?null:(0,M.buffer)(r,_.getRenderBuffer()*b,T.tmpExtent);j.dirty=!1;var s=new O.default(0,r,b,y,_.getDeclutter()),a=(0,I.getSquaredTolerance)(b,y),l=e.getFeatures();v&&v!==j.renderedRenderOrder&&l.sort(v);for(var u=0,h=l.length;u<h;++u){var c=l[u];o&&!(0,M.intersects)(o,c.getGeometry().getExtent())||g.call(T,c)}var d=s.finish(),p=_.getRenderMode()!==B.default.VECTOR&&_.getDeclutter()&&1===P.length?null:r,f=new z.default(p,b,y,x.getOverlaps(),d,_.getRenderBuffer());m.executorGroups[E].push(f)}function g(t){var e,i,n=t.getStyleFunction()||_.getStyleFunction();n&&(e=n(t,b)),e&&(i=this.renderFeature(t,a,e,s),this.dirty_=this.dirty_||i,j.dirty=j.dirty||i)}}(i);j.renderedRevision=e,j.renderedZ=m.sourceZ,j.renderedRenderOrder=v,j.renderedResolution=b}},d.prototype.forEachFeatureAtCoordinate=function(a,t,l,u,h){var c=t.viewState.resolution,d=t.viewState.rotation;l=null==l?0:l;for(var p,f=this.getLayer(),g=f.getDeclutter(),m=f.getSource().getTileGridForProjection(t.viewState.projection),y={},_=this.renderedTiles,v=0,e=_.length;v<e;++v)!function(){var t=_[v],e=m.getTileCoordExtent(t.wrappedTileCoord),i=(0,M.containsCoordinate)(e,a);if(g||i)for(var n=t.executorGroups[(0,Y.getUid)(f)],r=0,o=n.length;r<o;++r){var s=n[r];p=p||s.forEachFeatureAtCoordinate(a,c,d,l,function(t){if(i||h&&-1!==h.indexOf(t)){var e=t.getId();if(void 0===e&&(e=(0,Y.getUid)(t)),!(e in y))return y[e]=!0,u(t,f)}},f.getDeclutter()?h:null)}}();return p},d.prototype.getFeatures=function(w){return new Promise(function(t,e){for(var i,n,r,o,s,a,l,u,h,c,d=this.getLayer(),p=(0,Y.getUid)(d),f=d.getSource(),g=this.renderedProjection,m=g.getExtent(),y=this.renderedResolution,_=f.getTileGridForProjection(g),v=(0,V.apply)(this.renderedPixelToCoordinateTransform_,w.slice()),b=_.getTileCoordForCoordAndResolution(v,y),j=0,x=this.renderedTiles.length;j<x;++j)if(b.toString()===this.renderedTiles[j].tileCoord.toString()){if((i=this.renderedTiles[j]).getState()===C.default.LOADED&&i.hifi){var S=_.getTileCoordExtent(i.tileCoord);f.getWrapX()&&g.canWrapX()&&!(0,M.containsExtent)(m,S)&&(0,T.wrapX)(v,g);break}i=void 0}!i||0<i.loadingSourceTiles?t([]):(n=_.getTileCoordExtent(i.wrappedTileCoord),r=(0,M.getTopLeft)(n),o=[(v[0]-r[0])/y,(r[1]-v[1])/y],s=i.getSourceTiles().reduce(function(t,e){return t.concat(e.getFeatures())},[]),(c=i.hitDetectionImageData[p])||this.animatingOrInteracting_||(l=[(a=(0,E.toSize)(_.getTileSize(_.getZForResolution(y))))[0]/2,a[1]/2],u=this.renderedRotation_,h=[this.getRenderTransform(_.getTileCoordCenter(i.wrappedTileCoord),y,0,.5,l[0],l[1],0)],c=(0,P.createHitDetectionImageData)(a,h,s,d.getStyleFunction(),_.getTileCoordExtent(i.wrappedTileCoord),i.getReplayState(d).renderedResolution,u),i.hitDetectionImageData[p]=c),t((0,P.hitDetect)(o,s,c)))}.bind(this))},d.prototype.handleFontsChanged=function(){(0,o.clear)(this.renderTileImageQueue_);var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},d.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},d.prototype.renderFrame=function(t,e){var i=t.viewHints,n=!(i[W.default.ANIMATING]||i[W.default.INTERACTING]);this.renderQueuedTileImages_(n,t),H.prototype.renderFrame.call(this,t,e),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;var r=this.getLayer(),o=r.getRenderMode();if(o===B.default.IMAGE)return this.container;var s=r.getSource(),a=t.usedTiles[(0,Y.getUid)(s)];for(var l in this.renderTileImageQueue_)a&&l in a||delete this.renderTileImageQueue_[l];for(var u,h=this.context,c=r.getDeclutter()?{}:null,d=X[o],p=t.pixelRatio,f=t.viewState,g=f.center,m=f.resolution,y=f.rotation,_=t.size,v=Math.round(_[0]*p),b=Math.round(_[1]*p),j=this.renderedTiles,x=s.getTileGridForProjection(t.viewState.projection),S=[],w=[],P=j.length-1;0<=P;--P)for(var E=j[P],T=E.tileCoord,O=x.getTileCoordExtent(E.wrappedTileCoord),C=x.getTileCoordExtent(T,this.tmpExtent)[0]-O[0],M=(0,V.multiply)((0,V.scale)(this.inversePixelTransform.slice(),1/p,1/p),this.getRenderTransform(g,m,y,p,v,b,C)),I=E.executorGroups[(0,Y.getUid)(r)],R=!1,k=0,A=I.length;k<A;++k){var L=I[k];if(L.hasExecutors(d)){var F=E.tileCoord[0],N=void 0;if(!c&&!R){N=L.getClipCoords(M),h.save();for(var D=0,G=S.length;D<G;++D){var U=S[D];F<w[D]&&(h.beginPath(),h.moveTo(N[0],N[1]),h.lineTo(N[2],N[3]),h.lineTo(N[4],N[5]),h.lineTo(N[6],N[7]),h.moveTo(U[6],U[7]),h.lineTo(U[4],U[5]),h.lineTo(U[2],U[3]),h.lineTo(U[0],U[1]),h.clip())}}L.execute(h,1,M,y,n,d,c),c||R||(h.restore(),S.push(N),w.push(F),R=!0)}}return c&&(u=t.layerStatesArray[t.layerIndex],(0,z.replayDeclutter)(c,h,y,u.opacity,n,t.declutterItems)),this.container},d.prototype.renderQueuedTileImages_=function(t,e){for(var i in this.renderTileImageQueue_){if(!t&&8<Date.now()-e.time){e.animate=!0;break}var n=this.renderTileImageQueue_[i];delete this.renderTileImageQueue_[i],this.renderTileImage_(n,e)}},d.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var r=!1;if(Array.isArray(i))for(var o=0,s=i.length;o<s;++o)r=(0,I.renderFeature)(n,t,i[o],e,this.boundHandleStyleImageChange_)||r;else r=(0,I.renderFeature)(n,t,i,e,this.boundHandleStyleImageChange_);return r},d.prototype.tileImageNeedsRender_=function(t,e,i){var n=this.getLayer(),r=t.getReplayState(n),o=n.getRevision(),s=t.sourceZ,a=t.wantedResolution;return r.renderedTileResolution!==a||r.renderedTileRevision!==o||r.renderedTileZ!==s},d.prototype.renderTileImage_=function(t,e){var i=this.getLayer(),n=t.getReplayState(i),r=i.getRevision(),o=t.executorGroups[(0,Y.getUid)(i)];n.renderedTileRevision=r,n.renderedTileZ=t.sourceZ;var s=t.wrappedTileCoord,a=s[0],l=i.getSource(),u=e.pixelRatio,h=e.viewState.projection,c=l.getTileGridForProjection(h),d=c.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*d,f=c.getResolution(a),g=t.getContext(i),u=Math.max(u,p/u),m=l.getTilePixelSize(a,u,h);g.canvas.width=m[0],g.canvas.height=m[1];var y,_=u/p;1!=_&&(y=(0,V.reset)(this.tmpTransform_),(0,V.scale)(y,_,_),g.setTransform.apply(g,y));var v=c.getTileCoordExtent(s,this.tmpExtent),b=p/f,j=(0,V.reset)(this.tmpTransform_);(0,V.scale)(j,b,-b),(0,V.translate)(j,-v[0],-v[3]);for(var x=0,S=o.length;x<S;++x)o[x].execute(g,_,j,0,!0,w[i.getRenderMode()]);n.renderedTileResolution=t.wantedResolution},d);function d(t){var e=H.call(this,t)||this;return e.boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(e),e.dirty_=!1,e.renderedLayerRevision_,e.renderedPixelToCoordinateTransform_=null,e.renderedRotation_,e.renderTileImageQueue_={},e.tileListenerKeys_={},e.tmpTransform_=(0,V.create)(),e}i.default=c},{"../../TileState.js":38,"../../ViewHint.js":42,"../../coordinate.js":60,"../../events.js":64,"../../events/EventType.js":66,"../../extent.js":70,"../../layer/VectorTileRenderType.js":199,"../../obj.js":203,"../../render/canvas/BuilderGroup.js":221,"../../render/canvas/BuilderType.js":222,"../../render/canvas/ExecutorGroup.js":224,"../../render/canvas/hitdetect.js":231,"../../size.js":251,"../../transform.js":311,"../../util.js":313,"../vector.js":241,"./TileLayer.js":237}],241:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.defaultOrder=function(t,e){return parseInt((0,n.getUid)(t),10)-parseInt((0,n.getUid)(e),10)},i.getSquaredTolerance=function(t,e){var i=o*t/e;return i*i},i.getTolerance=s,i.renderFeature=function(t,e,i,n,r,o){var s=!1,a=i.getImage();{var l;a&&((l=a.getImageState())==c.default.LOADED||l==c.default.ERROR?a.unlistenImageChange(r):(l==c.default.IDLE&&a.load(),l=a.getImageState(),a.listenImageChange(r),s=!0))}return function(t,e,i,n,r){var o=i.getGeometryFunction()(e);{var s;o&&(s=o.simplifyTransformed(n,r),(i.getRenderer()?function t(e,i,n,r){if(i.getType()!=h.default.GEOMETRY_COLLECTION)e.getBuilder(n.getZIndex(),u.default.DEFAULT).drawCustom(i,r,n.getRenderer());else for(var o=i.getGeometries(),s=0,a=o.length;s<a;++s)t(e,o[s],n,r)}:(0,d[s.getType()]))(t,s,i,e))}}(t,e,i,n,o),s};var u=r(t("../render/canvas/BuilderType.js")),h=r(t("../geom/GeometryType.js")),c=r(t("../ImageState.js")),n=t("../util.js");function r(t){return t&&t.__esModule?t:{default:t}}var o=.5,d={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=c.default.LOADED)return;var o=t.getBuilder(i.getZIndex(),u.default.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();{var a;s&&((a=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n))}},LineString:function(t,e,i,n){var r=i.getStroke();{var o;r&&((o=t.getBuilder(i.getZIndex(),u.default.LINE_STRING)).setFillStrokeStyle(null,r),o.drawLineString(e,n))}var s=i.getText();{var a;s&&((a=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n))}},Polygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();{var s;(r||o)&&((s=t.getBuilder(i.getZIndex(),u.default.POLYGON)).setFillStrokeStyle(r,o),s.drawPolygon(e,n))}var a=i.getText();{var l;a&&((l=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n))}},MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=c.default.LOADED)return;var o=t.getBuilder(i.getZIndex(),u.default.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();{var a;s&&((a=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n))}},MultiLineString:function(t,e,i,n){var r=i.getStroke();{var o;r&&((o=t.getBuilder(i.getZIndex(),u.default.LINE_STRING)).setFillStrokeStyle(null,r),o.drawMultiLineString(e,n))}var s=i.getText();{var a;s&&((a=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n))}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();{var s;(o||r)&&((s=t.getBuilder(i.getZIndex(),u.default.POLYGON)).setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n))}var a=i.getText();{var l;a&&((l=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n))}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r)(0,d[s[r].getType()])(t,s[r],i,n)},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();{var s;(r||o)&&((s=t.getBuilder(i.getZIndex(),u.default.CIRCLE)).setFillStrokeStyle(r,o),s.drawCircle(e,n))}var a=i.getText();{var l;a&&((l=t.getBuilder(i.getZIndex(),u.default.TEXT)).setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n))}}};function s(t,e){return o*t/e}},{"../ImageState.js":18,"../geom/GeometryType.js":131,"../render/canvas/BuilderType.js":222,"../util.js":313}],242:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.writePointFeatureToBuffers=function(t,e,i,n,r,o){var s=3+r,a=t[e+0],l=t[e+1],u=f;u.length=r;for(var h=0;h<u.length;h++)u[h]=t[e+2+h];var c=o?o.vertexPosition:0,d=o?o.indexPosition:0,p=c/s;return m(i,c,a,l,0),u.length&&i.set(u,c+3),m(i,c+=s,a,l,1),u.length&&i.set(u,c+3),m(i,c+=s,a,l,2),u.length&&i.set(u,c+3),m(i,c+=s,a,l,3),u.length&&i.set(u,c+3),c+=s,n[d++]=p,n[d++]=1+p,n[d++]=3+p,n[d++]=1+p,n[d++]=2+p,n[d++]=3+p,g.vertexPosition=c,g.indexPosition=d,g},i.getBlankImageData=function(){var t=document.createElement("canvas").getContext("2d").createImageData(1,1);return t.data[0]=255,t.data[1]=255,t.data[2]=255,t.data[3]=255,t},i.colorEncodeId=function(t,e){var i=e||[];return i[0]=Math.floor(t/256/256/256)/255,i[1]=Math.floor(t/256/256)%256/255,i[2]=Math.floor(t/256)%256/255,i[3]=t%256/255,i},i.colorDecodeId=function(t){var e=0;return e+=Math.round(256*t[0]*256*256*255),e+=Math.round(256*t[1]*256*255),e+=Math.round(256*t[2]*255),e+=Math.round(255*t[3])},i.default=i.WebGLWorkerMessageType=void 0;var n=o(t("../Layer.js")),r=o(t("../../webgl/Helper.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});i.WebGLWorkerMessageType={GENERATE_BUFFERS:"GENERATE_BUFFERS"};var l,u=(l=n.default,a(h,l),h.prototype.disposeInternal=function(){this.helper.dispose(),l.prototype.disposeInternal.call(this)},h.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},h),f=[],g={vertexPosition:0,indexPosition:0};function h(t,e){var i=l.call(this,t)||this,n=e||{};return i.helper=new r.default({postProcesses:n.postProcesses,uniforms:n.uniforms}),i}function m(t,e,i,n,r){t[e+0]=i,t[e+1]=n,t[e+2]=r}i.default=u},{"../../webgl/Helper.js":318,"../Layer.js":233}],243:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=n(t("../../layer/BaseVector.js")),m=n(t("../../geom/GeometryType.js")),a=n(t("../../source/VectorEventType.js")),d=n(t("../../ViewHint.js")),l=n(t("../../webgl/Buffer.js")),y=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=x();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Layer.js")),u=n(t("../../webgl/RenderTarget.js")),h=t("../../webgl.js"),p=t("../../webgl/Helper.js"),_=t("../../transform.js"),f=t("../../asserts.js"),g=t("../../extent.js"),v=t("../../worker/webgl.js"),b=t("../../util.js"),j=t("../../events.js");function x(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return x=function(){return t},t}function n(t){return t&&t.__esModule?t:{default:t}}var S,r,o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),w=(S=y.default,o(P,S),P.prototype.handleSourceFeatureAdded_=function(t){var e=t.feature;this.featureCache_[(0,b.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++},P.prototype.handleSourceFeatureChanged_=function(t){var e=t.feature;this.featureCache_[(0,b.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}},P.prototype.handleSourceFeatureDelete_=function(t){var e=t.feature;delete this.featureCache_[(0,b.getUid)(e)],this.featureCount_--},P.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},P.prototype.renderFrame=function(t){var e=this.indicesBuffer_.getSize();this.helper.drawElements(0,e),this.helper.finalizeDraw(t);var i=this.helper.getCanvas(),n=t.layerStatesArray[t.layerIndex].opacity;return n!==parseFloat(i.style.opacity)&&(i.style.opacity=String(n)),this.hitDetectionEnabled_&&(this.renderHitDetection(t),this.hitRenderTarget_.clearCachedData()),i},P.prototype.prepareFrame=function(t){var e,i,n,r,o=this.getLayer(),s=o.getSource(),a=t.viewState,l=!t.viewHints[d.default.ANIMATING]&&!t.viewHints[d.default.INTERACTING],u=!(0,g.equals)(this.previousExtent_,t.extent),h=this.sourceRevision_<s.getRevision();return h&&(this.sourceRevision_=s.getRevision()),l&&(u||h)&&(e=a.projection,i=a.resolution,n=o instanceof c.default?o.getRenderBuffer():0,r=(0,g.buffer)(t.extent,n*i),s.loadFeatures(r,i,e),this.rebuildBuffers_(t),this.previousExtent_=t.extent.slice()),this.helper.makeProjectionTransform(t,this.currentTransform_),(0,_.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(t),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},P.prototype.rebuildBuffers_=function(t){var e=(0,_.create)();this.helper.makeProjectionTransform(t,e);var i,n,r,o=(2+this.customAttributes.length)*this.featureCount_;this.renderInstructions_&&this.renderInstructions_.length===o||(this.renderInstructions_=new Float32Array(o)),this.hitDetectionEnabled_&&(r=(7+this.customAttributes.length)*this.featureCount_,this.hitRenderInstructions_&&this.hitRenderInstructions_.length===r||(this.hitRenderInstructions_=new Float32Array(r)));var s,a=[],l=[],u=0,h=0;for(var c in this.featureCache_)if((n=(i=this.featureCache_[c]).geometry)&&n.getType()===m.default.POINT){a[0]=n.getFlatCoordinates()[0],a[1]=n.getFlatCoordinates()[1],(0,_.apply)(e,a),s=(0,y.colorEncodeId)(h+6,l),this.renderInstructions_[u++]=a[0],this.renderInstructions_[u++]=a[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=a[0],this.hitRenderInstructions_[h++]=a[1],this.hitRenderInstructions_[h++]=s[0],this.hitRenderInstructions_[h++]=s[1],this.hitRenderInstructions_[h++]=s[2],this.hitRenderInstructions_[h++]=s[3],this.hitRenderInstructions_[h++]=Number(c));for(var d=void 0,p=0;p<this.customAttributes.length;p++)d=this.customAttributes[p].callback(i.feature,i.properties),this.renderInstructions_[u++]=d,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=d)}var f,g={type:y.WebGLWorkerMessageType.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};g.projectionTransform=e,this.worker_.postMessage(g,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_&&((f={type:y.WebGLWorkerMessageType.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length}).projectionTransform=e,f.hitDetection=!0,this.worker_.postMessage(f,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null)},P.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if((0,f.assert)(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var o=(0,_.apply)(e.coordinateToPixelTransform,t.slice()),s=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),a=[s[0]/255,s[1]/255,s[2]/255,s[3]/255],l=(0,y.colorDecodeId)(a),u=this.hitRenderInstructions_[l],h=Math.floor(u).toString(),c=this.getLayer().getSource().getFeatureByUid(h);return c?n(c,this.getLayer()):void 0}},P.prototype.renderHitDetection=function(t){var e;this.hitVerticesBuffer_.getSize()&&(this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes),e=this.indicesBuffer_.getSize(),this.helper.drawElements(0,e))},P.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(t){(0,j.unlistenByKey)(t)}),this.sourceListenKeys_=null,S.prototype.disposeInternal.call(this)},P);function P(t,e){var i=this,n=e.uniforms||{},r=(0,_.create)();n[p.DefaultUniform.PROJECTION_MATRIX]=r,(i=S.call(this,t,{uniforms:n,postProcesses:e.postProcesses})||this).sourceRevision_=-1,i.verticesBuffer_=new l.default(h.ARRAY_BUFFER,h.DYNAMIC_DRAW),i.hitVerticesBuffer_=new l.default(h.ARRAY_BUFFER,h.DYNAMIC_DRAW),i.indicesBuffer_=new l.default(h.ELEMENT_ARRAY_BUFFER,h.DYNAMIC_DRAW),i.program_=i.helper.getProgram(e.fragmentShader,e.vertexShader),i.hitDetectionEnabled_=!(!e.hitFragmentShader||!e.hitVertexShader),i.hitProgram_=i.hitDetectionEnabled_&&i.helper.getProgram(e.hitFragmentShader,e.hitVertexShader);var o=e.attributes?e.attributes.map(function(t){return{name:"a_"+t.name,size:1,type:p.AttributeType.FLOAT}}):[];i.attributes=[{name:"a_position",size:2,type:p.AttributeType.FLOAT},{name:"a_index",size:1,type:p.AttributeType.FLOAT}].concat(o),i.hitDetectionAttributes=[{name:"a_position",size:2,type:p.AttributeType.FLOAT},{name:"a_index",size:1,type:p.AttributeType.FLOAT},{name:"a_hitColor",size:4,type:p.AttributeType.FLOAT},{name:"a_featureUid",size:1,type:p.AttributeType.FLOAT}].concat(o),i.customAttributes=e.attributes?e.attributes:[],i.previousExtent_=(0,g.createEmpty)(),i.currentTransform_=r,i.renderTransform_=(0,_.create)(),i.invertRenderTransform_=(0,_.create)(),i.renderInstructions_=new Float32Array(0),i.hitRenderInstructions_=new Float32Array(0),i.hitRenderTarget_=i.hitDetectionEnabled_&&new u.default(i.helper),i.worker_=(0,v.create)(),i.worker_.addEventListener("message",function(t){var e,i=t.data;i.type===y.WebGLWorkerMessageType.GENERATE_BUFFERS&&(e=i.projectionTransform,i.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(i.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(i.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(i.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=e,(0,_.makeInverse)(this.invertRenderTransform_,this.renderTransform_),i.hitDetection?this.hitRenderInstructions_=new Float32Array(t.data.renderInstructions):this.renderInstructions_=new Float32Array(t.data.renderInstructions),this.getLayer().changed())}.bind(i)),i.featureCache_={},i.featureCount_=0;var s=i.getLayer().getSource();return i.sourceListenKeys_=[(0,j.listen)(s,a.default.ADDFEATURE,i.handleSourceFeatureAdded_,i),(0,j.listen)(s,a.default.CHANGEFEATURE,i.handleSourceFeatureChanged_,i),(0,j.listen)(s,a.default.REMOVEFEATURE,i.handleSourceFeatureDelete_,i),(0,j.listen)(s,a.default.CLEAR,i.handleSourceFeatureClear_,i)],s.forEachFeature(function(t){this.featureCache_[(0,b.getUid)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}.bind(i)),i}i.default=w},{"../../ViewHint.js":42,"../../asserts.js":45,"../../events.js":64,"../../extent.js":70,"../../geom/GeometryType.js":131,"../../layer/BaseVector.js":187,"../../source/VectorEventType.js":278,"../../transform.js":311,"../../util.js":313,"../../webgl.js":315,"../../webgl/Buffer.js":316,"../../webgl/Helper.js":318,"../../webgl/RenderTarget.js":320,"../../worker/webgl.js":321,"./Layer.js":242}],244:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.calculateSourceResolution=s,i.calculateSourceExtentResolution=function(e,i,t,n){var r=(0,d.getCenter)(t),o=s(e,i,r,n);return(!isFinite(o)||o<=0)&&(0,d.forEachCorner)(t,function(t){return o=s(e,i,t,n),isFinite(o)&&0<o}),o},i.render=function(t,e,w,P,i,E,n,r,o,a,s,T){var O=(0,p.createCanvasContext2D)(Math.round(w*t),Math.round(w*e));if((0,c.assign)(O,T),0===o.length)return O.canvas;function C(t){return Math.round(t*w)/w}O.scale(w,w),O.globalCompositeOperation="lighter";var M=(0,d.createEmpty)();o.forEach(function(t,e,i){(0,d.extend)(M,t.extent)});var l=(0,d.getWidth)(M),u=(0,d.getHeight)(M),I=(0,p.createCanvasContext2D)(Math.round(w*l/P),Math.round(w*u/P));(0,c.assign)(I,T);var h=w/P;o.forEach(function(t,e,i){var n=t.extent[0]-M[0],r=-(t.extent[3]-M[3]),o=(0,d.getWidth)(t.extent),s=(0,d.getHeight)(t.extent);0<t.image.width&&0<t.image.height&&I.drawImage(t.image,a,a,t.image.width-2*a,t.image.height-2*a,n*h,r*h,o*h,s*h)});var R=(0,d.getTopLeft)(n);return r.getTriangles().forEach(function(t,e,i){var n=t.source,r=t.target,o=n[0][0],s=n[0][1],a=n[1][0],l=n[1][1],u=n[2][0],h=n[2][1],c=C((r[0][0]-R[0])/E),d=C(-(r[0][1]-R[1])/E),p=C((r[1][0]-R[0])/E),f=C(-(r[1][1]-R[1])/E),g=C((r[2][0]-R[0])/E),m=C(-(r[2][1]-R[1])/E),y=o,_=s,o=0,s=0,v=[[a-=y,l-=_,0,0,p-c],[u-=y,h-=_,0,0,g-c],[0,0,a,l,f-d],[0,0,u,h,m-d]],b=(0,L.solveLinearSystem)(v);if(b){if(O.save(),O.beginPath(),function(){{var t,e;void 0===k&&((t=document.createElement("canvas").getContext("2d")).globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",F(t,4,5,4,0),F(t,4,5,0,5),e=t.getImageData(0,0,3,3).data,k=N(e,0)||N(e,4)||N(e,8))}return k}()||T===A.IMAGE_SMOOTHING_DISABLED){O.moveTo(p,f);for(var j=c-p,x=d-f,S=0;S<4;S++)O.lineTo(p+C((S+1)*j/4),f+C(S*x/3)),3!=S&&O.lineTo(p+C((S+1)*j/4),f+C((S+1)*x/3));O.lineTo(g,m)}else O.moveTo(p,f),O.lineTo(c,d),O.lineTo(g,m);O.clip(),O.transform(b[0],b[2],b[1],b[3],c,d),O.translate(M[0]-y,M[3]-_),O.scale(P/w,-P/w),O.drawImage(I.canvas,0,0),O.restore()}}),s&&(O.save(),O.globalCompositeOperation="source-over",O.strokeStyle="black",O.lineWidth=1,r.getTriangles().forEach(function(t,e,i){var n=t.target,r=(n[0][0]-R[0])/E,o=-(n[0][1]-R[1])/E,s=(n[1][0]-R[0])/E,a=-(n[1][1]-R[1])/E,l=(n[2][0]-R[0])/E,u=-(n[2][1]-R[1])/E;O.beginPath(),O.moveTo(s,a),O.lineTo(r,o),O.lineTo(l,u),O.closePath(),O.stroke()}),O.restore()),O.canvas};var k,A=t("./source/common.js"),c=t("./obj.js"),d=t("./extent.js"),p=t("./dom.js"),h=t("./proj.js"),L=t("./math.js");function F(t,e,i,n,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r)),t.restore()}function N(t,e){return 2<Math.abs(t[4*e]-210)||2<Math.abs(t[4*e+3]-191.25)}function s(t,e,i,n){var r=(0,h.transform)(i,e,t),o=(0,h.getPointResolution)(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var l,u=t.getExtent();return u&&!(0,d.containsCoordinate)(u,r)||(l=(0,h.getPointResolution)(t,o,r)/o,isFinite(l)&&0<l&&(o/=l)),o}},{"./dom.js":62,"./extent.js":70,"./math.js":201,"./obj.js":203,"./proj.js":205,"./source/common.js":285}],245:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var _=t("./common.js"),n=s(t("../events/EventType.js")),r=s(t("../ImageBase.js")),v=s(t("../ImageState.js")),b=s(t("./Triangulation.js")),j=t("../reproj.js"),x=t("../extent.js"),o=t("../events.js");function s(t){return t&&t.__esModule?t:{default:t}}var S,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(S=r.default,l(h,S),h.prototype.disposeInternal=function(){this.state==v.default.LOADING&&this.unlistenSource_(),S.prototype.disposeInternal.call(this)},h.prototype.getImage=function(){return this.canvas_},h.prototype.getProjection=function(){return this.targetProj_},h.prototype.reproject_=function(){var t,e,i=this.sourceImage_.getState();i==v.default.LOADED&&(t=(0,x.getWidth)(this.targetExtent_)/this.targetResolution_,e=(0,x.getHeight)(this.targetExtent_)/this.targetResolution_,this.canvas_=(0,j.render)(t,e,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.contextOptions_)),this.state=i,this.changed()},h.prototype.load=function(){var t;this.state==v.default.IDLE&&(this.state=v.default.LOADING,this.changed(),(t=this.sourceImage_.getState())==v.default.LOADED||t==v.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,o.listen)(this.sourceImage_,n.default.CHANGE,function(t){var e=this.sourceImage_.getState();e!=v.default.LOADED&&e!=v.default.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load()))},h.prototype.unlistenSource_=function(){(0,o.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null},h);function h(t,e,i,n,r,o,s){var a=this,l=t.getExtent(),u=e.getExtent(),h=u?(0,x.getIntersection)(i,u):i,c=(0,x.getCenter)(h),d=(0,j.calculateSourceResolution)(t,e,c,n),p=_.ERROR_THRESHOLD,f=new b.default(t,e,h,l,d*p,n),g=o(f.calculateSourceExtent(),d,r),m=g?v.default.IDLE:v.default.EMPTY,y=g?g.getPixelRatio():1;return(a=S.call(this,i,n,y,m)||this).targetProj_=e,a.maxSourceExtent_=l,a.triangulation_=f,a.targetResolution_=n,a.targetExtent_=i,a.sourceImage_=g,a.sourcePixelRatio_=y,a.contextOptions_=s,a.canvas_=null,a.sourceListenerKey_=null,a}i.default=u},{"../ImageBase.js":16,"../ImageState.js":18,"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"../reproj.js":244,"./Triangulation.js":247,"./common.js":248}],246:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var E=t("./common.js"),s=r(t("../events/EventType.js")),n=r(t("../Tile.js")),T=r(t("../TileState.js")),O=r(t("./Triangulation.js")),C=t("../reproj.js"),M=t("../math.js"),I=t("../extent.js"),a=t("../events.js");function r(t){return t&&t.__esModule?t:{default:t}}var R,o,l=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(R=n.default,l(h,R),h.prototype.getImage=function(){return this.canvas_},h.prototype.reproject_=function(){var t,e,i,n,r,o,s,a=[];this.sourceTiles_.forEach(function(t,e,i){t&&t.getState()==T.default.LOADED&&a.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}.bind(this)),(this.sourceTiles_.length=0)===a.length?this.state=T.default.ERROR:(t=this.wrappedTileCoord_[0],i="number"==typeof(e=this.targetTileGrid_.getTileSize(t))?e:e[0],n="number"==typeof e?e:e[1],r=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),this.canvas_=(0,C.render)(i,n,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),r,s,this.triangulation_,a,this.gutter_,this.renderEdges_,this.contextOptions_),this.state=T.default.LOADED),this.changed()},h.prototype.load=function(){var o;this.state==T.default.IDLE&&(this.state=T.default.LOADING,this.changed(),o=0,this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(i,t,e){var n,r=i.getState();r!=T.default.IDLE&&r!=T.default.LOADING||(o++,n=(0,a.listen)(i,s.default.CHANGE,function(t){var e=i.getState();e!=T.default.LOADED&&e!=T.default.ERROR&&e!=T.default.EMPTY||((0,a.unlistenByKey)(n),0==--o&&(this.unlistenSources_(),this.reproject_()))},this),this.sourcesListenerKeys_.push(n))}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==T.default.IDLE&&t.load()}),0===o&&setTimeout(this.reproject_.bind(this),0))},h.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(a.unlistenByKey),this.sourcesListenerKeys_=null},h);function h(t,e,i,n,r,o,s,a,l,u,h,c){var d=R.call(this,r,T.default.IDLE)||this;d.renderEdges_=void 0!==h&&h,d.contextOptions_=c,d.pixelRatio_=s,d.gutter_=a,d.canvas_=null,d.sourceTileGrid_=e,d.targetTileGrid_=n,d.wrappedTileCoord_=o||r,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var p=n.getTileCoordExtent(d.wrappedTileCoord_),f=d.targetTileGrid_.getExtent(),g=d.sourceTileGrid_.getExtent(),m=f?(0,I.getIntersection)(p,f):p;if(0===(0,I.getArea)(m))return d.state=T.default.EMPTY,d;var y=t.getExtent();y&&(g=g?(0,I.getIntersection)(g,y):y);var _=n.getResolution(d.wrappedTileCoord_[0]),v=(0,C.calculateSourceExtentResolution)(t,i,m,_);if(!isFinite(v)||v<=0)return d.state=T.default.EMPTY,d;var b=void 0!==u?u:E.ERROR_THRESHOLD;if(d.triangulation_=new O.default(t,i,m,g,v*b,_),0===d.triangulation_.getTriangles().length)return d.state=T.default.EMPTY,d;d.sourceZ_=e.getZForResolution(v);var j=d.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(j[1]=(0,M.clamp)(j[1],g[1],g[3]),j[3]=(0,M.clamp)(j[3],g[1],g[3])):j=(0,I.getIntersection)(j,g)),(0,I.getArea)(j)){for(var x=e.getTileRangeForExtentAndZ(j,d.sourceZ_),S=x.minX;S<=x.maxX;S++)for(var w=x.minY;w<=x.maxY;w++){var P=l(d.sourceZ_,S,w,s);P&&d.sourceTiles_.push(P)}0===d.sourceTiles_.length&&(d.state=T.default.EMPTY)}else d.state=T.default.EMPTY;return d}i.default=u},{"../Tile.js":34,"../TileState.js":38,"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"../math.js":201,"../reproj.js":244,"./Triangulation.js":247,"./common.js":248}],247:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var O=t("../extent.js"),_=t("../proj.js"),C=t("../math.js"),n=(r.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})},r.prototype.addQuad_=function(t,e,i,n,r,o,s,a,l){var u,h=(0,O.boundingExtent)([r,o,s,a]),c=this.sourceWorldWidth_?(0,O.getWidth)(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&.5<c&&c<1,f=!1;if(0<l&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(u=(0,O.boundingExtent)([t,e,i,n]),f=.25<(0,O.getWidth)(u)/this.targetWorldWidth_||f),!p&&this.sourceProj_.isGlobal()&&c&&(f=.25<c||f)),!(!f&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3]))||(0,O.intersects)(h,this.maxSourceExtent_)){var g,m,y,_,v,b,j,x,S,w,P,E,T=0;if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(0<l)f=!0;else if(1!=(T=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1))&&2!=T&&4!=T&&8!=T)return;if(0<l&&(f||(g=[(t[0]+i[0])/2,(t[1]+i[1])/2],m=this.transformInv_(g),y=void 0,f=(y=p?((0,C.modulo)(r[0],d)+(0,C.modulo)(s[0],d))/2-(0,C.modulo)(m[0],d):(r[0]+s[0])/2-m[0])*y+(_=(r[1]+s[1])/2-m[1])*_>this.errorThresholdSquared_),f))return void(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])?(v=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(v),j=[(n[0]+t[0])/2,(n[1]+t[1])/2],x=this.transformInv_(j),this.addQuad_(t,e,v,j,r,o,b,x,l-1),this.addQuad_(j,v,i,n,x,b,s,a,l-1)):(S=[(t[0]+e[0])/2,(t[1]+e[1])/2],w=this.transformInv_(S),P=[(i[0]+n[0])/2,(i[1]+n[1])/2],E=this.transformInv_(P),this.addQuad_(t,S,P,n,r,w,E,a,l-1),this.addQuad_(S,e,i,P,w,o,s,E,l-1)));if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&T)&&this.addTriangle_(t,i,n,r,s,a),0==(14&T)&&this.addTriangle_(t,i,e,r,s,o),T&&(0==(13&T)&&this.addTriangle_(e,n,t,o,a,r),0==(7&T)&&this.addTriangle_(e,n,i,o,a,s))}},r.prototype.calculateSourceExtent=function(){var r=(0,O.createEmpty)();return this.triangles_.forEach(function(t,e,i){var n=t.source;(0,O.extendCoordinate)(r,n[0]),(0,O.extendCoordinate)(r,n[1]),(0,O.extendCoordinate)(r,n[2])}),r},r.prototype.getTriangles=function(){return this.triangles_},r);function r(t,e,i,n,r,o){this.sourceProj_=t,this.targetProj_=e;var s={},a=(0,_.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&(0,O.getWidth)(n)==(0,O.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,O.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,O.getWidth)(this.targetProj_.getExtent()):null;var l,u=(0,O.getTopLeft)(i),h=(0,O.getTopRight)(i),c=(0,O.getBottomRight)(i),d=(0,O.getBottomLeft)(i),p=this.transformInv_(u),f=this.transformInv_(h),g=this.transformInv_(c),m=this.transformInv_(d),y=10+(o?Math.max(0,Math.ceil((0,C.log2)((0,O.getArea)(i)/(o*o*256*256)))):0);this.addQuad_(u,h,c,d,p,f,g,m,y),this.wrapsXInSource_&&(l=1/0,this.triangles_.forEach(function(t,e,i){l=Math.min(l,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){var e,i;Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-l>this.sourceWorldWidth_/2&&((e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]])[0][0]-l>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-l>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-l>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_),i=Math.min(e[0][0],e[1][0],e[2][0]),Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e))}.bind(this))),s={}}i.default=n},{"../extent.js":70,"../math.js":201,"../proj.js":205}],248:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ENABLE_RASTER_REPROJECTION=i.ERROR_THRESHOLD=void 0;i.ERROR_THRESHOLD=.5;i.ENABLE_RASTER_REPROJECTION=!0},{}],249:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createSnapToResolutions=function(u,h,c,d){return function(t,e,i,n){if(void 0!==t){var r=u[0],o=u[u.length-1],s=c?v(r,c,i,d):r;if(n)return void 0===h||h?b(t,s,o):(0,_.clamp)(t,o,s);var a=Math.min(s,t),l=Math.floor((0,p.linearFindNearest)(u,a,e));return u[l]>s&&l<u.length-1?u[l+1]:u[l]}}},i.createSnapToPower=function(d,p,f,g,m,y){return function(t,e,i,n){if(void 0!==t){var r=m?v(p,m,i,y):p,o=void 0!==f?f:0;if(n)return void 0===g||g?b(t,r,o):(0,_.clamp)(t,o,r);var s=Math.ceil(Math.log(p/r)/Math.log(d)-1e-9),a=-e*(.5-1e-9)+.5,l=Math.min(r,t),u=Math.floor(Math.log(p/l)/Math.log(d)+a),h=Math.max(s,u),c=p/Math.pow(d,h);return(0,_.clamp)(c,o,r)}}},i.createMinMaxResolution=function(o,s,a,l,u){return function(t,e,i,n){if(void 0!==t){var r=l?v(o,l,i,u):o;return(void 0===a||a)&&n?b(t,r,s):(0,_.clamp)(t,s,r)}}};var _=t("./math.js"),s=t("./extent.js"),p=t("./array.js");function v(t,e,i,n){var r=(0,s.getWidth)(e)/i[0],o=(0,s.getHeight)(e)/i[1];return n?Math.min(t,Math.max(r,o)):Math.min(t,Math.min(r,o))}function b(t,e,i){var n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),(0,_.clamp)(n,i/2,2*e)}},{"./array.js":44,"./extent.js":70,"./math.js":201}],250:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.disable=function(t){return void 0!==t?0:void 0},i.none=function(t){return void 0!==t?t:void 0},i.createSnapToN=function(t){var i=2*Math.PI/t;return function(t,e){return e?t:void 0!==t?t=Math.floor(t/i+.5)*i:void 0}},i.createSnapToZero=function(t){var i=t||(0,n.toRadians)(5);return function(t,e){return e?t:void 0!==t?Math.abs(t)<=i?0:t:void 0}};var n=t("./math.js")},{"./math.js":201}],251:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.buffer=function(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]+2*e,i[1]=t[1]+2*e,i},i.hasArea=function(t){return 0<t[0]&&0<t[1]},i.scale=function(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i},i.toSize=function(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}},{}],252:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"BingMaps",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"CartoDB",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"Cluster",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"IIIF",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"Image",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"ImageArcGISRest",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"ImageCanvas",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"ImageMapGuide",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"ImageStatic",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"ImageWMS",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"OSM",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(i,"Raster",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(i,"Source",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(i,"Stamen",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(i,"Tile",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(i,"TileArcGISRest",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(i,"TileDebug",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(i,"TileImage",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(i,"TileJSON",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(i,"TileWMS",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(i,"UrlTile",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(i,"UTFGrid",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(i,"Vector",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(i,"VectorTile",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(i,"WMTS",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(i,"XYZ",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(i,"Zoomify",{enumerable:!0,get:function(){return C.default}});var n=M(t("./source/BingMaps.js")),r=M(t("./source/CartoDB.js")),o=M(t("./source/Cluster.js")),s=M(t("./source/IIIF.js")),a=M(t("./source/Image.js")),l=M(t("./source/ImageArcGISRest.js")),u=M(t("./source/ImageCanvas.js")),h=M(t("./source/ImageMapGuide.js")),c=M(t("./source/ImageStatic.js")),d=M(t("./source/ImageWMS.js")),p=M(t("./source/OSM.js")),f=M(t("./source/Raster.js")),g=M(t("./source/Source.js")),m=M(t("./source/Stamen.js")),y=M(t("./source/Tile.js")),_=M(t("./source/TileArcGISRest.js")),v=M(t("./source/TileDebug.js")),b=M(t("./source/TileImage.js")),j=M(t("./source/TileJSON.js")),x=M(t("./source/TileWMS.js")),S=M(t("./source/UrlTile.js")),w=M(t("./source/UTFGrid.js")),P=M(t("./source/Vector.js")),E=M(t("./source/VectorTile.js")),T=M(t("./source/WMTS.js")),O=M(t("./source/XYZ.js")),C=M(t("./source/Zoomify.js"));function M(t){return t&&t.__esModule?t:{default:t}}},{"./source/BingMaps.js":253,"./source/CartoDB.js":254,"./source/Cluster.js":255,"./source/IIIF.js":256,"./source/Image.js":257,"./source/ImageArcGISRest.js":258,"./source/ImageCanvas.js":259,"./source/ImageMapGuide.js":260,"./source/ImageStatic.js":261,"./source/ImageWMS.js":262,"./source/OSM.js":263,"./source/Raster.js":264,"./source/Source.js":265,"./source/Stamen.js":266,"./source/Tile.js":268,"./source/TileArcGISRest.js":269,"./source/TileDebug.js":270,"./source/TileImage.js":272,"./source/TileJSON.js":273,"./source/TileWMS.js":274,"./source/UTFGrid.js":275,"./source/UrlTile.js":276,"./source/Vector.js":277,"./source/VectorTile.js":279,"./source/WMTS.js":281,"./source/XYZ.js":283,"./source/Zoomify.js":284}],253:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.quadKey=y,i.default=void 0;var h=o(t("./State.js")),n=o(t("./TileImage.js")),p=t("../extent.js"),c=t("../tileurlfunction.js"),f=t("../tilecoord.js"),g=t("../tilegrid.js"),m=t("../proj.js"),r=t("../net.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});function y(t){for(var e,i=t[0],n=new Array(i),r=1<<i-1,o=0;o<i;++o)e=48,t[1]&r&&(e+=1),t[2]&r&&(e+=2),n[o]=String.fromCharCode(e),r>>=1;return n.join("")}var l,u=(l=n.default,a(d,l),d.prototype.getApiKey=function(){return this.apiKey_},d.prototype.getImagerySet=function(){return this.imagerySet_},d.prototype.handleImageryMetadataResponse=function(t){var n,e,i,r,o,s,a,l,u,d;200==t.statusCode&&"OK"==t.statusDescription&&"ValidCredentials"==t.authenticationResultCode&&1==t.resourceSets.length&&1==t.resourceSets[0].resources.length?(n=t.resourceSets[0].resources[0],e=-1==this.maxZoom_?n.zoomMax:this.maxZoom_,i=this.getProjection(),r=(0,g.extentFromProjection)(i),o=this.hidpi_?2:1,s=n.imageWidth==n.imageHeight?n.imageWidth/o:[n.imageWidth/o,n.imageHeight/o],a=(0,g.createXYZ)({extent:r,minZoom:n.zoomMin,maxZoom:e,tileSize:s}),this.tileGrid=a,l=this.culture_,u=this.hidpi_,this.tileUrlFunction=(0,c.createFromTileUrlFunctions)(n.imageUrlSubdomains.map(function(t){var r=[0,0,0],o=n.imageUrl.replace("{subdomain}",t).replace("{culture}",l);return function(t,e,i){if(t){(0,f.createOrUpdate)(t[0],t[1],t[2],r);var n=o;return u&&(n+="&dpi=d1&device=mobile"),n.replace("{quadkey}",y(r))}}})),n.imageryProviders&&(d=(0,m.getTransformFromProjections)((0,m.get)("EPSG:4326"),this.getProjection()),this.setAttributions(function(u){var h=[],t=u.viewState,e=this.getTileGrid(),i=e.getZForResolution(t.resolution,this.zDirection),c=e.getTileCoordForCoordAndZ(t.center,i)[0];return n.imageryProviders.map(function(t){for(var e=!1,i=t.coverageAreas,n=0,r=i.length;n<r;++n){var o=i[n];if(c>=o.zoomMin&&c<=o.zoomMax){var s=o.bbox,a=[s[1],s[0],s[3],s[2]],l=(0,p.applyTransform)(a,d);if((0,p.intersects)(l,u.extent)){e=!0;break}}}e&&h.push(t.attribution)}),h.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),h}.bind(this))),this.setState(h.default.READY)):this.setState(h.default.ERROR)},d);function d(t){var e=this,i=void 0!==t.hidpi&&t.hidpi;(e=l.call(this,{cacheSize:t.cacheSize,crossOrigin:"anonymous",imageSmoothing:t.imageSmoothing,opaque:!0,projection:(0,m.get)("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:h.default.LOADING,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:i?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this).hidpi_=i,e.culture_=void 0!==t.culture?t.culture:"en-us",e.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,e.apiKey_=t.key,e.imagerySet_=t.imagerySet;var n="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+e.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+e.apiKey_+"&c="+e.culture_;return(0,r.jsonp)(n,e.handleImageryMetadataResponse.bind(e),void 0,"jsonp"),e}i.default=u},{"../extent.js":70,"../net.js":202,"../proj.js":205,"../tilecoord.js":305,"../tilegrid.js":306,"../tileurlfunction.js":310,"./State.js":267,"./TileImage.js":272}],254:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=s(t("./State.js")),n=s(t("./XYZ.js")),o=t("../obj.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(a=n.default,u(c,a),c.prototype.getConfig=function(){return this.config_},c.prototype.updateConfig=function(t){(0,o.assign)(this.config_,t),this.initializeMap_()},c.prototype.setConfig=function(t){this.config_=t||{},this.initializeMap_()},c.prototype.initializeMap_=function(){var t,e,i=JSON.stringify(this.config_);this.templateCache_[i]?this.applyTemplate_(this.templateCache_[i]):(t="https://"+this.account_+".carto.com/api/v1/map",this.mapId_&&(t+="/named/"+this.mapId_),(e=new XMLHttpRequest).addEventListener("load",this.handleInitResponse_.bind(this,i)),e.addEventListener("error",this.handleInitError_.bind(this)),e.open("POST",t),e.setRequestHeader("Content-type","application/json"),e.send(JSON.stringify(this.config_)))},c.prototype.handleInitResponse_=function(t,e){var i=e.target;if(!i.status||200<=i.status&&i.status<300){var n=void 0;try{n=JSON.parse(i.responseText)}catch(t){return void this.setState(r.default.ERROR)}this.applyTemplate_(n),this.templateCache_[t]=n,this.setState(r.default.READY)}else this.setState(r.default.ERROR)},c.prototype.handleInitError_=function(t){this.setState(r.default.ERROR)},c.prototype.applyTemplate_=function(t){var e="https://"+t.cdn_url.https+"/"+this.account_+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)},c);function c(t){var e=a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,maxZoom:void 0!==t.maxZoom?t.maxZoom:18,minZoom:t.minZoom,projection:t.projection,wrapX:t.wrapX})||this;return e.account_=t.account,e.mapId_=t.map||"",e.config_=t.config||{},e.templateCache_={},e.initializeMap_(),e}i.default=h},{"../obj.js":203,"./State.js":267,"./XYZ.js":283}],255:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=d(t("../events/EventType.js")),o=d(t("../Feature.js")),r=d(t("../geom/GeometryType.js")),s=d(t("../geom/Point.js")),a=d(t("./Vector.js")),l=t("../coordinate.js"),u=t("../asserts.js"),h=t("../extent.js"),c=t("../util.js");function d(t){return t&&t.__esModule?t:{default:t}}var p,f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m=(p=a.default,g(y,p),y.prototype.clear=function(t){this.features.length=0,p.prototype.clear.call(this,t)},y.prototype.getDistance=function(){return this.distance},y.prototype.getSource=function(){return this.source},y.prototype.loadFeatures=function(t,e,i){this.source.loadFeatures(t,e,i),e!==this.resolution&&(this.clear(),this.resolution=e,this.cluster(),this.addFeatures(this.features))},y.prototype.setDistance=function(t){this.distance=t,this.refresh()},y.prototype.setSource=function(t){this.source&&this.source.removeEventListener(n.default.CHANGE,this.boundRefresh_),(this.source=t)&&t.addEventListener(n.default.CHANGE,this.boundRefresh_),this.refresh()},y.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},y.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var t=(0,h.createEmpty)(),e=this.distance*this.resolution,i=this.source.getFeatures(),n={},r=0,o=i.length;r<o;r++){var s,a,l,u=i[r];(0,c.getUid)(u)in n||(s=this.geometryFunction(u))&&(a=s.getCoordinates(),(0,h.createOrUpdateFromCoordinate)(a,t),(0,h.buffer)(t,e,t),l=(l=this.source.getFeaturesInExtent(t)).filter(function(t){var e=(0,c.getUid)(t);return!(e in n||(n[e]=!0,0))}),this.features.push(this.createCluster(l)))}},y.prototype.createCluster=function(t){for(var e=[0,0],i=t.length-1;0<=i;--i){var n=this.geometryFunction(t[i]);n?(0,l.add)(e,n.getCoordinates()):t.splice(i,1)}(0,l.scale)(e,1/t.length);var r=new o.default(new s.default(e));return r.set("features",t),r},y);function y(t){var e=p.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return e.resolution=void 0,e.distance=void 0!==t.distance?t.distance:20,e.features=[],e.geometryFunction=t.geometryFunction||function(t){var e=t.getGeometry();return(0,u.assert)(e.getType()==r.default.POINT,10),e},e.boundRefresh_=e.refresh.bind(e),e.setSource(t.source||null),e}i.default=m},{"../Feature.js":13,"../asserts.js":45,"../coordinate.js":60,"../events/EventType.js":66,"../extent.js":70,"../geom/GeometryType.js":131,"../geom/Point.js":137,"../util.js":313,"./Vector.js":277}],256:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var p=r(t("../tilegrid/TileGrid.js")),n=r(t("./TileImage.js")),f=t("./Zoomify.js"),g=t("../tilegrid/common.js"),R=t("../format/IIIFInfo.js"),m=t("../asserts.js"),k=t("../extent.js"),A=t("../size.js");function r(t){return t&&t.__esModule?t:{default:t}}var o,s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});function L(t){return t.toLocaleString("en",{maximumFractionDigits:10})}var F,a=(F=n.default,s(l,F),l);function l(t){var e=this,i=t||{},y=i.url||"";y+=y.lastIndexOf("/")===y.length-1||""===y?"":"/";var _=i.version||R.Versions.VERSION2,v=i.sizes||[],n=i.size;(0,m.assert)(null!=n&&Array.isArray(n)&&2==n.length&&!isNaN(n[0])&&0<n[0]&&!isNaN(n[1])&&0<n[1],60);var b,j,x=n[0],S=n[1],r=i.tileSize,o=i.tilePixelRatio||1,w=i.format||"jpg",P=i.quality||(i.version==R.Versions.VERSION1?"native":"default"),E=i.resolutions||[],T=i.supports||[],s=i.extent||[0,-S,x,0],O=null!=v&&Array.isArray(v)&&0<v.length,C=void 0!==r&&("number"==typeof r&&Number.isInteger(r)&&0<r||Array.isArray(r)&&0<r.length),M=null!=T&&Array.isArray(T)&&(T.includes("regionByPx")||T.includes("regionByPct"))&&(T.includes("sizeByWh")||T.includes("sizeByH")||T.includes("sizeByW")||T.includes("sizeByPct"));if(E.sort(function(t,e){return e-t}),C||M)if(null!=r&&("number"==typeof r&&Number.isInteger(r)&&0<r?j=b=r:Array.isArray(r)&&0<r.length&&((1==r.length||null==r[1]&&Number.isInteger(r[0]))&&(b=r[0],j=r[0]),2==r.length&&(Number.isInteger(r[0])&&Number.isInteger(r[1])?(b=r[0],j=r[1]):null==r[0]&&Number.isInteger(r[1])&&(b=r[1],j=r[1])))),void 0!==b&&void 0!==j||(b=g.DEFAULT_TILE_SIZE,j=g.DEFAULT_TILE_SIZE),0==E.length)for(var a=I=Math.max(Math.ceil(Math.log(x/b)/Math.LN2),Math.ceil(Math.log(S/j)/Math.LN2));0<=a;a--)E.push(Math.pow(2,a));else var l=Math.max.apply(Math,E),I=Math.round(Math.log(l)/Math.LN2);else if(b=x,j=S,E=[],O){v.sort(function(t,e){return t[0]-e[0]}),I=-1;for(var u=[],a=0;a<v.length;a++){var h=x/v[a][0];0<E.length&&E[E.length-1]==h?u.push(a):(E.push(h),I++)}if(0<u.length)for(a=0;a<u.length;a++)v.splice(u[a]-a,1)}else E.push(1),v.push([x,S]),I=0;var c=new p.default({tileSize:[b,j],extent:s,origin:(0,k.getTopLeft)(s),resolutions:E}),d=f.CustomTile.bind(null,(0,A.toSize)(r||256).map(function(t){return t*o}));return(e=F.call(this,{attributions:i.attributions,attributionsCollapsible:i.attributionsCollapsible,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,imageSmoothing:i.imageSmoothing,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,state:i.state,tileClass:d,tileGrid:c,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:function(t,e,i){var n,r=t[0];if(!(I<r)){var o,s,a,l,u,h,c,d,p,f=t[1],g=t[2],m=E[r];if(!(void 0===f||void 0===g||void 0===m||f<0||Math.ceil(x/m/b)<=f||g<0||Math.ceil(S/m/j)<=g))return M||C?(x<(o=f*b*m)+(a=b*m)&&(a=x-o),S<(s=g*(h=j)*m)+(l=j*m)&&(l=S-s),x<o+(u=b)*m&&(u=Math.floor((x-o+m-1)/m)),S<s+j*m&&(h=Math.floor((S-s+m-1)/m)),0==o&&a==x&&0==s&&l==S?n="full":!M||T.includes("regionByPx")?n=o+","+s+","+a+","+l:T.includes("regionByPct")&&(n="pct:"+L(o/x*100)+","+L(s/S*100)+","+L(a/x*100)+","+L(l/S*100)),_!=R.Versions.VERSION3||M&&!T.includes("sizeByWh")?!M||T.includes("sizeByW")?p=u+",":T.includes("sizeByH")?p=","+h:T.includes("sizeByWh")?p=u+","+h:T.includes("sizeByPct")&&(p="pct:"+L(100/m)):p=u+","+h):(n="full",p=O?(c=v[r][0],d=v[r][1],_==R.Versions.VERSION3?c==x&&d==S?"max":c+","+d:c==x?"full":c+","):_==R.Versions.VERSION3?"max":"full"),y+n+"/"+p+"/0/"+P+"."+w}},transition:i.transition})||this).zDirection=i.zDirection,e}i.default=a},{"../asserts.js":45,"../extent.js":70,"../format/IIIFInfo.js":85,"../size.js":251,"../tilegrid/TileGrid.js":307,"../tilegrid/common.js":309,"./TileImage.js":272,"./Zoomify.js":284}],257:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.defaultImageLoadFunction=function(t,e){t.getImage().src=e},i.default=i.ImageSourceEvent=i.ImageSourceEventType=void 0;var n=p(t("../events/Event.js")),r=p(t("../ImageState.js")),o=p(t("../reproj/Image.js")),s=p(t("./Source.js")),a=t("../reproj/common.js"),l=t("./common.js"),u=t("../util.js"),h=t("../extent.js"),c=t("../proj.js"),d=t("../array.js");function p(t){return t&&t.__esModule?t:{default:t}}var f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};i.ImageSourceEventType=m;var y,_=(y=n.default,g(v,y),v);function v(t,e){var i=y.call(this,t)||this;return i.image=e,i}i.ImageSourceEvent=_;var b,j=(b=s.default,g(x,b),x.prototype.getResolutions=function(){return this.resolutions_},x.prototype.getContextOptions=function(){return this.contextOptions_},x.prototype.findNearestResolution=function(t){var e;return this.resolutions_&&(e=(0,d.linearFindNearest)(this.resolutions_,t,0),t=this.resolutions_[e]),t},x.prototype.getImage=function(t,e,i,n){var r=this.getProjection();if(a.ENABLE_RASTER_REPROJECTION&&r&&n&&!(0,c.equivalent)(r,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,c.equivalent)(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&(0,h.equals)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new o.default(r,n,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,r)}.bind(this),this.contextOptions_),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(n=r),this.getImageInternal(t,e,i,n)},x.prototype.getImageInternal=function(t,e,i,n){return(0,u.abstract)()},x.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case r.default.LOADING:this.loading=!0,this.dispatchEvent(new _(m.IMAGELOADSTART,e));break;case r.default.LOADED:this.loading=!1,this.dispatchEvent(new _(m.IMAGELOADEND,e));break;case r.default.ERROR:this.loading=!1,this.dispatchEvent(new _(m.IMAGELOADERROR,e))}},x);function x(t){var e=b.call(this,{attributions:t.attributions,projection:t.projection,state:t.state})||this;return e.resolutions_=void 0!==t.resolutions?t.resolutions:null,e.reprojectedImage_=null,e.reprojectedRevision_=0,e.contextOptions_=!1===t.imageSmoothing?l.IMAGE_SMOOTHING_DISABLED:void 0,e}i.default=j},{"../ImageState.js":18,"../array.js":44,"../events/Event.js":65,"../extent.js":70,"../proj.js":205,"../reproj/Image.js":245,"../reproj/common.js":248,"../util.js":313,"./Source.js":265,"./common.js":285}],258:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var f=r(t("../events/EventType.js")),n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Image.js")),g=r(t("../Image.js")),l=t("../uri.js"),u=t("../asserts.js"),m=t("../obj.js"),y=t("../extent.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function r(t){return t&&t.__esModule?t:{default:t}}var o,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(o=n.default,c(p,o),p.prototype.getParams=function(){return this.params_},p.prototype.getImageInternal=function(t,e,i,n){if(void 0===this.url_)return null;e=this.findNearestResolution(e),i=this.hidpi_?i:1;var r=this.image_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==i&&(0,y.containsExtent)(r.getExtent(),t))return r;var o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};(0,m.assign)(o,this.params_);var s,a,l=((t=t.slice())[0]+t[2])/2,u=(t[1]+t[3])/2;1!=this.ratio_&&(s=this.ratio_*(0,y.getWidth)(t)/2,a=this.ratio_*(0,y.getHeight)(t)/2,t[0]=l-s,t[1]=u-a,t[2]=l+s,t[3]=u+a);var h=e/i,c=Math.ceil((0,y.getWidth)(t)/h),d=Math.ceil((0,y.getHeight)(t)/h);t[0]=l-h*c/2,t[2]=l+h*c/2,t[1]=u-h*d/2,t[3]=u+h*d/2,this.imageSize_[0]=c,this.imageSize_[1]=d;var p=this.getRequestUrl_(t,this.imageSize_,i,n,o);return this.image_=new g.default(t,e,i,p,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(f.default.CHANGE,this.handleImageChange.bind(this)),this.image_},p.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},p.prototype.getRequestUrl_=function(t,e,i,n,r){var o=n.getCode().split(":").pop();r.SIZE=e[0]+","+e[1],r.BBOX=t.join(","),r.BBOXSR=o,r.IMAGESR=o,r.DPI=Math.round(90*i);var s=this.url_,a=s.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return a==s&&(0,u.assert)(!1,50),(0,l.appendParams)(a,r)},p.prototype.getUrl=function(){return this.url_},p.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},p.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},p.prototype.updateParams=function(t){(0,m.assign)(this.params_,t),this.image_=null,this.changed()},p);function p(t){var e=this,i=t||{};return(e=o.call(this,{attributions:i.attributions,imageSmoothing:i.imageSmoothing,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,e.hidpi_=void 0===i.hidpi||i.hidpi,e.url_=i.url,e.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:n.defaultImageLoadFunction,e.params_=i.params||{},e.image_=null,e.imageSize_=[0,0],e.renderedRevision_=0,e.ratio_=void 0!==i.ratio?i.ratio:1.5,e}i.default=d},{"../Image.js":15,"../asserts.js":45,"../events/EventType.js":66,"../extent.js":70,"../obj.js":203,"../uri.js":312,"./Image.js":257}],259:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=r(t("../ImageCanvas.js")),n=r(t("./Image.js")),l=t("../extent.js");function r(t){return t&&t.__esModule?t:{default:t}}var o,s,u=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=(o=n.default,u(c,o),c.prototype.getImageInternal=function(t,e,i,n){e=this.findNearestResolution(e);var r=this.canvas_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==i&&(0,l.containsExtent)(r.getExtent(),t))return r;t=t.slice(),(0,l.scaleFromCenter)(t,this.ratio_);var o=[(0,l.getWidth)(t)/e*i,(0,l.getHeight)(t)/e*i],s=this.canvasFunction_.call(this,t,e,i,o,n);return s&&(r=new a.default(t,e,i,s)),this.canvas_=r,this.renderedRevision_=this.getRevision(),r},c);function c(t){var e=this,i=t||{};return(e=o.call(this,{attributions:i.attributions,imageSmoothing:i.imageSmoothing,projection:i.projection,resolutions:i.resolutions,state:i.state})||this).canvasFunction_=i.canvasFunction,e.canvas_=null,e.renderedRevision_=0,e.ratio_=void 0!==i.ratio?i.ratio:1.5,e}i.default=h},{"../ImageCanvas.js":17,"../extent.js":70,"./Image.js":257}],260:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=r(t("../events/EventType.js")),n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Image.js")),l=r(t("../Image.js")),y=t("../uri.js"),_=t("../obj.js"),v=t("../extent.js");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(t){return t&&t.__esModule?t:{default:t}}var o,h,c=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=(o=n.default,c(p,o),p.prototype.getParams=function(){return this.params_},p.prototype.getImageInternal=function(t,e,i,n){e=this.findNearestResolution(e),i=this.hidpi_?i:1;var r=this.image_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==i&&(0,v.containsExtent)(r.getExtent(),t))return r;1!=this.ratio_&&(t=t.slice(),(0,v.scaleFromCenter)(t,this.ratio_));var o,s=[(0,v.getWidth)(t)/e*i,(0,v.getHeight)(t)/e*i];return void 0!==this.url_?(o=this.getUrl(this.url_,this.params_,t,s,n),(r=new l.default(t,e,i,o,this.crossOrigin_,this.imageLoadFunction_)).addEventListener(a.default.CHANGE,this.handleImageChange.bind(this))):r=null,this.image_=r,this.renderedRevision_=this.getRevision(),r},p.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},p.prototype.updateParams=function(t){(0,_.assign)(this.params_,t),this.changed()},p.prototype.getUrl=function(t,e,i,n,r){var o,s,a,l,u,h,c,d,p,f=(o=i,s=n,a=this.metersPerUnit_,l=this.displayDpi_,u=(0,v.getWidth)(o),h=(0,v.getHeight)(o),c=s[0],d=s[1],p=.0254/l,c*h<d*u?u*a/(c*p):h*a/(d*p)),g=(0,v.getCenter)(i),m={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(n[0]),SETDISPLAYHEIGHT:Math.round(n[1]),SETVIEWSCALE:f,SETVIEWCENTERX:g[0],SETVIEWCENTERY:g[1]};return(0,_.assign)(m,e),(0,y.appendParams)(t,m)},p.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},p);function p(t){var e=o.call(this,{imageSmoothing:t.imageSmoothing,projection:t.projection,resolutions:t.resolutions})||this;return e.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,e.displayDpi_=void 0!==t.displayDpi?t.displayDpi:96,e.params_=t.params||{},e.url_=t.url,e.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:n.defaultImageLoadFunction,e.hidpi_=void 0===t.hidpi||t.hidpi,e.metersPerUnit_=void 0!==t.metersPerUnit?t.metersPerUnit:1,e.ratio_=void 0!==t.ratio?t.ratio:1,e.useOverlay_=void 0!==t.useOverlay&&t.useOverlay,e.image_=null,e.renderedRevision_=0,e}i.default=d},{"../Image.js":15,"../events/EventType.js":66,"../extent.js":70,"../obj.js":203,"../uri.js":312,"./Image.js":257}],261:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=n(t("../events/EventType.js")),o=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=d();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Image.js")),u=n(t("../ImageState.js")),a=n(t("../Image.js")),h=t("../dom.js"),c=t("../extent.js"),l=t("../proj.js");function d(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return d=function(){return t},t}function n(t){return t&&t.__esModule?t:{default:t}}var p,f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m=(p=o.default,g(y,p),y.prototype.getImageExtent=function(){return this.imageExtent_},y.prototype.getImageInternal=function(t,e,i,n){return(0,c.intersects)(t,this.image_.getExtent())?this.image_:null},y.prototype.getUrl=function(){return this.url_},y.prototype.handleImageChange=function(t){var e,i,n,r,o,s,a,l;this.image_.getState()==u.default.LOADED&&(e=this.image_.getExtent(),i=this.image_.getImage(),r=n=void 0,r=this.imageSize_?(n=this.imageSize_[0],this.imageSize_[1]):(n=i.width,i.height),o=(0,c.getHeight)(e)/r,(s=Math.ceil((0,c.getWidth)(e)/o))!=n&&(l=(a=(0,h.createCanvasContext2D)(s,r)).canvas,a.drawImage(i,0,0,n,r,0,0,l.width,l.height),this.image_.setImage(l))),p.prototype.handleImageChange.call(this,t)},y);function y(t){var e=this,i=void 0!==t.crossOrigin?t.crossOrigin:null,n=void 0!==t.imageLoadFunction?t.imageLoadFunction:o.defaultImageLoadFunction;return(e=p.call(this,{attributions:t.attributions,imageSmoothing:t.imageSmoothing,projection:(0,l.get)(t.projection)})||this).url_=t.url,e.imageExtent_=t.imageExtent,e.image_=new a.default(e.imageExtent_,void 0,1,e.url_,i,n),e.imageSize_=t.imageSize?t.imageSize:null,e.image_.addEventListener(r.default.CHANGE,e.handleImageChange.bind(e)),e}i.default=m},{"../Image.js":15,"../ImageState.js":18,"../dom.js":62,"../events/EventType.js":66,"../extent.js":70,"../proj.js":205,"./Image.js":257}],262:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var g=t("./common.js"),m=o(t("../events/EventType.js")),n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Image.js")),y=o(t("../Image.js")),l=o(t("./WMSServerType.js")),u=t("../uri.js"),h=t("../asserts.js"),_=t("../obj.js"),c=t("../reproj.js"),r=t("../string.js"),v=t("../extent.js"),d=t("../proj.js");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t){return t&&t.__esModule?t:{default:t}}var p,f,b=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),j=[101,101],x=(p=n.default,b(S,p),S.prototype.getFeatureInfoUrl=function(t,e,i,n){if(void 0!==this.url_){var r=(0,d.get)(i),o=this.getProjection();o&&o!==r&&(e=(0,c.calculateSourceResolution)(o,r,t,e),t=(0,d.transform)(t,r,o));var s=(0,v.getForViewAndSize)(t,e,0,j),a={SERVICE:"WMS",VERSION:g.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};(0,_.assign)(a,this.params_,n);var l=Math.floor((t[0]-s[0])/e),u=Math.floor((s[3]-t[1])/e);return a[this.v13_?"I":"X"]=l,a[this.v13_?"J":"Y"]=u,this.getRequestUrl_(s,j,1,o||r,a)}},S.prototype.getLegendUrl=function(t,e){if(void 0!==this.url_){var i,n={SERVICE:"WMS",VERSION:g.DEFAULT_WMS_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var r=this.params_.LAYERS;if(Array.isArray(r)&&1!==r.length)return;n.LAYER=r}return void 0!==t&&(i=this.getProjection()?this.getProjection().getMetersPerUnit():1,n.SCALE=t*i*39.37*(25.4/.28)),(0,_.assign)(n,e),(0,u.appendParams)(this.url_,n)}},S.prototype.getParams=function(){return this.params_},S.prototype.getImageInternal=function(t,e,i,n){if(void 0===this.url_)return null;e=this.findNearestResolution(e),1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);var r=e/i,o=(0,v.getCenter)(t),s=Math.ceil((0,v.getWidth)(t)/r),a=Math.ceil((0,v.getHeight)(t)/r),l=(0,v.getForViewAndSize)(o,r,0,[s,a]),u=Math.ceil(this.ratio_*(0,v.getWidth)(t)/r),h=Math.ceil(this.ratio_*(0,v.getHeight)(t)/r),c=(0,v.getForViewAndSize)(o,r,0,[u,h]),d=this.image_;if(d&&this.renderedRevision_==this.getRevision()&&d.getResolution()==e&&d.getPixelRatio()==i&&(0,v.containsExtent)(d.getExtent(),l))return d;var p={SERVICE:"WMS",VERSION:g.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};(0,_.assign)(p,this.params_),this.imageSize_[0]=Math.round((0,v.getWidth)(c)/r),this.imageSize_[1]=Math.round((0,v.getHeight)(c)/r);var f=this.getRequestUrl_(c,this.imageSize_,i,n,p);return this.image_=new y.default(c,e,i,f,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(m.default.CHANGE,this.handleImageChange.bind(this)),this.image_},S.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},S.prototype.getRequestUrl_=function(t,e,i,n,r){if((0,h.assert)(void 0!==this.url_,9),r[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(r.STYLES=""),1!=i)switch(this.serverType_){case l.default.GEOSERVER:var o=90*i+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+o:r.FORMAT_OPTIONS="dpi:"+o;break;case l.default.MAPSERVER:r.MAP_RESOLUTION=90*i;break;case l.default.CARMENTA_SERVER:case l.default.QGIS:r.DPI=90*i;break;default:(0,h.assert)(!1,8)}r.WIDTH=e[0],r.HEIGHT=e[1];var s=n.getAxisOrientation(),a=this.v13_&&"ne"==s.substr(0,2)?[t[1],t[0],t[3],t[2]]:t;return r.BBOX=a.join(","),(0,u.appendParams)(this.url_,r)},S.prototype.getUrl=function(){return this.url_},S.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},S.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},S.prototype.updateParams=function(t){(0,_.assign)(this.params_,t),this.updateV13_(),this.image_=null,this.changed()},S.prototype.updateV13_=function(){var t=this.params_.VERSION||g.DEFAULT_WMS_VERSION;this.v13_=0<=(0,r.compareVersions)(t,"1.3")},S);function S(t){var e=this,i=t||{};return(e=p.call(this,{attributions:i.attributions,imageSmoothing:i.imageSmoothing,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,e.url_=i.url,e.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:n.defaultImageLoadFunction,e.params_=i.params||{},e.v13_=!0,e.updateV13_(),e.serverType_=i.serverType,e.hidpi_=void 0===i.hidpi||i.hidpi,e.image_=null,e.imageSize_=[0,0],e.renderedRevision_=0,e.ratio_=void 0!==i.ratio?i.ratio:1.5,e}i.default=x},{"../Image.js":15,"../asserts.js":45,"../events/EventType.js":66,"../extent.js":70,"../obj.js":203,"../proj.js":205,"../reproj.js":244,"../string.js":287,"../uri.js":312,"./Image.js":257,"./WMSServerType.js":280,"./common.js":285}],263:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.ATTRIBUTION=void 0;var n,r=(n=t("./XYZ.js"))&&n.__esModule?n:{default:n};var o,s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';i.ATTRIBUTION=a;var l,u=(l=r.default,s(h,l),h);function h(t){var e=t||{},i=void 0!==e.attributions?e.attributions:[a],n=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",r=void 0!==e.url?e.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return l.call(this,{attributions:i,cacheSize:e.cacheSize,crossOrigin:n,imageSmoothing:e.imageSmoothing,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:r,wrapX:e.wrapX,attributionsCollapsible:!1})||this}i.default=u},{"./XYZ.js":283}],264:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.newImageData=S,i.default=i.RasterSourceEvent=i.Processor=void 0;var n=_(t("../Disposable.js")),r=_(t("../events/Event.js")),o=_(t("../events/EventType.js")),u=_(t("../ImageCanvas.js")),s=_(t("../layer/Image.js")),l=_(t("./Image.js")),h=_(t("./Source.js")),a=_(t("./State.js")),c=_(t("../layer/Tile.js")),d=_(t("../TileQueue.js")),p=_(t("./Tile.js")),f=t("../obj.js"),g=t("../dom.js"),m=t("../transform.js"),y=t("../extent.js");function _(t){return t&&t.__esModule?t:{default:t}}var v,b=(v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),j=!0;try{new ImageData(10,10)}catch(t){j=!1}var x=document.createElement("canvas").getContext("2d");function S(t,e,i){if(j)return new ImageData(t,e,i);var n=x.createImageData(e,i);return n.data.set(t),n}function w(b){var j=!0;try{new ImageData(10,10)}catch(b){j=!1}return function(t){var e,i,n,r,o=t.buffers,s=t.meta,a=t.imageOps,l=t.width,u=t.height,h=o.length,c=o[0].byteLength;if(a){for(var d=new Array(h),p=0;p<h;++p)d[p]=(i=new Uint8ClampedArray(o[p]),n=l,r=u,j?new ImageData(i,n,r):{data:i,width:n,height:r});e=b(d,s).data}else{e=new Uint8ClampedArray(c);var f=new Array(h),g=new Array(h);for(p=0;p<h;++p)f[p]=new Uint8ClampedArray(o[p]),g[p]=[0,0,0,0];for(var m=0;m<c;m+=4){for(var y=0;y<h;++y){var _=f[y];g[y][0]=_[m],g[y][1]=_[m+1],g[y][2]=_[m+2],g[y][3]=_[m+3]}var v=b(g,s);e[m]=v[0],e[m+1]=v[1],e[m+2]=v[2],e[m+3]=v[3]}}return e.buffer}}var P,E=(P=n.default,b(T,P),T.prototype.process=function(t,e,i){this._enqueue({inputs:t,meta:e,callback:i}),this._dispatch()},T.prototype._enqueue=function(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},T.prototype._dispatch=function(){if(0===this._running&&0<this._queue.length){var t=this._queue.shift(),e=(this._job=t).inputs[0].width,i=t.inputs[0].height,n=t.inputs.map(function(t){return t.data.buffer}),r=this._workers.length;if(1===(this._running=r))this._workers[0].postMessage({buffers:n,meta:t.meta,imageOps:this._imageOps,width:e,height:i},n);else for(var o=t.inputs[0].data.length,s=4*Math.ceil(o/4/r),a=0;a<r;++a){for(var l=a*s,u=[],h=0,c=n.length;h<c;++h)u.push(n[a].slice(l,l+s));this._workers[a].postMessage({buffers:u,meta:t.meta,imageOps:this._imageOps,width:e,height:i},u)}}},T.prototype._onWorkerMessage=function(t,e){this.disposed||(this._dataLookup[t]=e.data,--this._running,0===this._running&&this._resolveJob())},T.prototype._resolveJob=function(){var t=this._job,e=this._workers.length;if(1===e)n=new Uint8ClampedArray(this._dataLookup[0].buffer),r=this._dataLookup[0].meta;else for(var i=t.inputs[0].data.length,n=new Uint8ClampedArray(i),r=new Array(i),o=4*Math.ceil(i/4/e),s=0;s<e;++s){var a=this._dataLookup[s].buffer,l=s*o;n.set(new Uint8ClampedArray(a),l),r[s]=this._dataLookup[s].meta}this._job=null,this._dataLookup={},t.callback(null,S(n,t.inputs[0].width,t.inputs[0].height),r),this._dispatch()},T.prototype.disposeInternal=function(){for(var t=0;t<this._workers.length;++t)this._workers[t].terminate();this._workers.length=0},T);function T(t){var e,i=P.call(this)||this;i._imageOps=!!t.imageOps;var n,r,o,s,a=[];if(e=0===t.threads?0:!i._imageOps&&t.threads||1)for(var l=0;l<e;++l)a[l]=function(e,t){var i=Object.keys(e.lib||{}).map(function(t){return"var "+t+" = "+e.lib[t].toString()+";"}).concat(["var __minion__ = ("+w.toString()+")(",e.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),n=new Blob(i,{type:"text/javascript"}),r=URL.createObjectURL(n),o=new Worker(r);return o.addEventListener("message",t),o}(t,i._onWorkerMessage.bind(i,l));else a[0]=(n=t,r=i._onWorkerMessage.bind(i,0),o=w(n.operation),s=!1,{postMessage:function(t){setTimeout(function(){s||r({data:{buffer:o(t),meta:t.meta}})},0)},terminate:function(){s=!0}});return i._workers=a,i._queue=[],i._maxQueueLength=t.queue||1/0,i._running=0,i._dataLookup={},i._job=null,i}i.Processor=E;var O,C="beforeoperations",M="afteroperations",I="pixel",R="image",k=(O=r.default,b(A,O),A);function A(t,e,i){var n=O.call(this,t)||this;return n.extent=e.extent,n.resolution=e.viewState.resolution/e.pixelRatio,n.data=i,n}i.RasterSourceEvent=k;var L,F=(L=l.default,b(N,L),N.prototype.setOperation=function(t,e){this.processor_&&this.processor_.dispose(),this.processor_=new E({operation:t,imageOps:this.operationType_===R,queue:1,lib:e,threads:this.threads_}),this.changed()},N.prototype.updateFrameState_=function(t,e,i){var n=(0,f.assign)({},this.frameState_);n.viewState=(0,f.assign)({},n.viewState);var r=(0,y.getCenter)(t);n.extent=t.slice(),n.size[0]=Math.round((0,y.getWidth)(t)/e),n.size[1]=Math.round((0,y.getHeight)(t)/e),n.time=1/0;var o=n.viewState;return o.center=r,o.projection=i,o.resolution=e,n},N.prototype.allSourcesReady_=function(){for(var t=!0,e=0,i=this.layers_.length;e<i;++e)if(this.layers_[e].getSource().getState()!==a.default.READY){t=!1;break}return t},N.prototype.getImage=function(t,e,i,n){if(!this.allSourcesReady_())return null;var r,o,s=this.updateFrameState_(t,e,n);return this.requestedFrameState_=s,this.renderedImageCanvas_&&(r=this.renderedImageCanvas_.getResolution(),o=this.renderedImageCanvas_.getExtent(),e===r&&(0,y.equals)(t,o)||(this.renderedImageCanvas_=null)),this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),s.tileQueue.loadMoreTiles(16,16),s.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},N.prototype.processSources_=function(){for(var t=this.requestedFrameState_,e=this.layers_.length,i=new Array(e),n=0;n<e;++n){t.layerIndex=n;var r=function(t,e){var i=t.getRenderer();if(!i)throw new Error("Unsupported layer type: "+t);if(!i.prepareFrame(e))return null;var n,r,o=e.size[0],s=e.size[1],a=i.renderFrame(e,null);if(a&&(n=a.firstElementChild),!(n instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+n);return n.width===o&&n.height===s?n.getContext("2d").getImageData(0,0,o,s):(D&&(r=D.canvas).width===o&&r.height===s?D.clearRect(0,0,o,s):D=(0,g.createCanvasContext2D)(o,s),D.drawImage(n,0,0,o,s),D.getImageData(0,0,o,s))}(this.layers_[n],t);if(!r)return;i[n]=r}var o={};this.dispatchEvent(new k(C,t,o)),this.processor_.process(i,o,this.onWorkerComplete_.bind(this,t))},N.prototype.onWorkerComplete_=function(t,e,i,n){var r,o,s,a,l;!e&&i&&(r=t.extent,(o=t.viewState.resolution)===this.requestedFrameState_.viewState.resolution&&(0,y.equals)(r,this.requestedFrameState_.extent)&&(this.renderedImageCanvas_?l=this.renderedImageCanvas_.getImage().getContext("2d"):(s=Math.round((0,y.getWidth)(r)/o),a=Math.round((0,y.getHeight)(r)/o),l=(0,g.createCanvasContext2D)(s,a),this.renderedImageCanvas_=new u.default(r,o,1,l.canvas)),l.putImageData(i,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new k(M,t,n))))},N.prototype.getImageInternal=function(){return null},N.prototype.disposeInternal=function(){this.processor_&&this.processor_.dispose(),L.prototype.disposeInternal.call(this)},N);function N(a){var t=L.call(this,{projection:null})||this;t.processor_=null,t.operationType_=void 0!==a.operationType?a.operationType:I,t.threads_=void 0!==a.threads?a.threads:1,t.layers_=function(t){for(var e=t.length,i=new Array(e),n=0;n<e;++n)i[n]=function(t){var e;return t instanceof h.default?t instanceof p.default?e=new c.default({source:t}):t instanceof l.default&&(e=new s.default({source:t})):e=t,e}(t[n]);return i}(a.sources);for(var e=t.changed.bind(t),i=0,n=t.layers_.length;i<n;++i)t.layers_[i].addEventListener(o.default.CHANGE,e);return t.tileQueue_=new d.default(function(){return 1},t.changed.bind(t)),t.requestedFrameState_,t.renderedImageCanvas_=null,t.renderedRevision_,t.frameState_={animate:!1,coordinateToPixelTransform:(0,m.create)(),extent:null,index:0,layerIndex:0,layerStatesArray:t.layers_.map(function(t){return t.getLayerState()}),pixelRatio:1,pixelToCoordinateTransform:(0,m.create)(),postRenderFunctions:[],size:[0,0],tileQueue:t.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},declutterItems:[]},t.setAttributions(function(t){for(var e=[],i=0,n=a.sources.length;i<n;++i){var r,o=a.sources[i],s=(o instanceof h.default?o:o.getSource()).getAttributions();"function"==typeof s&&(r=s(t),e.push.apply(e,r))}return 0!==e.length?e:null}),void 0!==a.operation&&t.setOperation(a.operation,a.lib),t}F.prototype.dispose;var D=null;i.default=F},{"../Disposable.js":12,"../ImageCanvas.js":17,"../TileQueue.js":36,"../dom.js":62,"../events/Event.js":65,"../events/EventType.js":66,"../extent.js":70,"../layer/Image.js":191,"../layer/Tile.js":194,"../obj.js":203,"../transform.js":311,"./Image.js":257,"./Source.js":265,"./State.js":267,"./Tile.js":268}],265:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("../Object.js")),r=a(t("./State.js")),o=t("../util.js"),s=t("../proj.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=(l=n.default,h(d,l),d.prototype.getAttributions=function(){return this.attributions_},d.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},d.prototype.getProjection=function(){return this.projection_},d.prototype.getResolutions=function(){return(0,o.abstract)()},d.prototype.getState=function(){return this.state_},d.prototype.getWrapX=function(){return this.wrapX_},d.prototype.getContextOptions=function(){},d.prototype.refresh=function(){this.changed()},d.prototype.setAttributions=function(t){this.attributions_=p(t),this.changed()},d.prototype.setState=function(t){this.state_=t,this.changed()},d);function d(t){var e=l.call(this)||this;return e.projection_=(0,s.get)(t.projection),e.attributions_=p(t.attributions),e.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,e.loading=!1,e.state_=void 0!==t.state?t.state:r.default.READY,e.wrapX_=void 0!==t.wrapX&&t.wrapX,e}function p(e){return e?Array.isArray(e)?function(t){return e}:"function"==typeof e?e:function(t){return[e]}:null}i.default=c},{"../Object.js":28,"../proj.js":205,"../util.js":313,"./State.js":267}],266:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./XYZ.js"))&&n.__esModule?n:{default:n},o=t("./OSM.js");var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',o.ATTRIBUTION],h={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},c={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},d=(s=r.default,l(p,s),p);function p(t){var e=t.layer.indexOf("-"),i=-1==e?t.layer:t.layer.slice(0,e),n=c[i],r=h[t.layer],o=void 0!==t.url?t.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+t.layer+"/{z}/{x}/{y}."+r.extension;return s.call(this,{attributions:u,cacheSize:t.cacheSize,crossOrigin:"anonymous",imageSmoothing:t.imageSmoothing,maxZoom:null!=t.maxZoom?t.maxZoom:n.maxZoom,minZoom:null!=t.minZoom?t.minZoom:n.minZoom,opaque:r.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:o,wrapX:t.wrapX})||this}i.default=d},{"./OSM.js":263,"./XYZ.js":283}],267:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"}},{}],268:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.TileSourceEvent=void 0;var n=h(t("../events/Event.js")),r=h(t("./Source.js")),o=h(t("../TileCache.js")),c=h(t("../TileState.js")),s=t("../util.js"),a=t("../proj.js"),d=t("../tilecoord.js"),l=t("../tilegrid.js"),u=t("../size.js");function h(t){return t&&t.__esModule?t:{default:t}}var p,f,g,m=(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),y=(f=r.default,m(b,f),b.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},b.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},b.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,a,l=!0,u=i.minX;u<=i.maxX;++u)for(var h=i.minY;h<=i.maxY;++h)s=(0,d.getKeyZXY)(e,u,h),a=!1,r.containsKey(s)&&(a=(o=r.get(s)).getState()===c.default.LOADED)&&(a=!1!==n(o)),a||(l=!1);return l},b.prototype.getGutterForProjection=function(t){return 0},b.prototype.getKey=function(){return this.key_},b.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},b.prototype.getOpaque=function(t){return this.opaque_},b.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},b.prototype.getTile=function(t,e,i,n,r){return(0,s.abstract)()},b.prototype.getTileGrid=function(){return this.tileGrid},b.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:(0,l.getForProjection)(t)},b.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!(0,a.equivalent)(e,t)?null:this.tileCache},b.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},b.prototype.getTilePixelSize=function(t,e,i){var n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=(0,u.toSize)(n.getTileSize(t),this.tmpSize);return 1==r?o:(0,u.scale)(o,r,this.tmpSize)},b.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=(0,l.wrapX)(n,t,i)),(0,d.withinExtentAndZ)(t,n)?t:null},b.prototype.clear=function(){this.tileCache.clear()},b.prototype.refresh=function(){this.clear(),f.prototype.refresh.call(this)},b.prototype.updateCacheSize=function(t,e){var i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)},b.prototype.useTile=function(t,e,i,n){},b),_=(p=n.default,m(v,p),v);function v(t,e){var i=p.call(this,t)||this;return i.tile=e,i}function b(t){var e=f.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX})||this;e.opaque_=void 0!==t.opaque&&t.opaque,e.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,e.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;var i=t.tileGrid;return i&&(0,u.toSize)(i.getTileSize(i.getMinZoom()),[256,256]),e.tileCache=new o.default(t.cacheSize||0),e.tmpSize=[0,0],e.key_=t.key||"",e.tileOptions={transition:t.transition},e.zDirection=t.zDirection?t.zDirection:0,e}i.TileSourceEvent=_,i.default=y},{"../TileCache.js":35,"../TileState.js":38,"../events/Event.js":65,"../proj.js":205,"../size.js":251,"../tilecoord.js":305,"../tilegrid.js":306,"../util.js":313,"./Source.js":265}],269:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./TileImage.js"))&&n.__esModule?n:{default:n},u=t("../uri.js"),a=t("../obj.js"),o=t("../extent.js"),h=t("../math.js"),l=t("../size.js"),c=t("../tilecoord.js");var s,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f=(s=r.default,p(g,s),g.prototype.getKeyForParams_=function(){var t=0,e=[];for(var i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},g.prototype.getParams=function(){return this.params_},g.prototype.getRequestUrl_=function(t,e,i,n,r,o){var s=this.urls;if(s){var a=r.getCode().split(":").pop();o.SIZE=e[0]+","+e[1],o.BBOX=i.join(","),o.BBOXSR=a,o.IMAGESR=a,o.DPI=Math.round(o.DPI?o.DPI*n:90*n);var l=(1==s.length?s[0]:s[(0,h.modulo)((0,c.hash)(t),s.length)]).replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return(0,u.appendParams)(l,o)}},g.prototype.getTilePixelRatio=function(t){return this.hidpi_?t:1},g.prototype.updateParams=function(t){(0,a.assign)(this.params_,t),this.setKey(this.getKeyForParams_())},g.prototype.tileUrlFunction=function(t,e,i){var n=this.getTileGrid();if(!((n=n||this.getTileGridForProjection(i)).getResolutions().length<=t[0])){1==e||this.hidpi_||(e=1);var r=n.getTileCoordExtent(t,this.tmpExtent_),o=(0,l.toSize)(n.getTileSize(t[0]),this.tmpSize);1!=e&&(o=(0,l.scale)(o,e,this.tmpSize));var s={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return(0,a.assign)(s,this.params_),this.getRequestUrl_(t,o,r,e,i,s)}},g);function g(t){var e=this,i=t||{};return(e=s.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,imageSmoothing:i.imageSmoothing,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).params_=i.params||{},e.hidpi_=void 0===i.hidpi||i.hidpi,e.tmpExtent_=(0,o.createEmpty)(),e.setKey(e.getKeyForParams_()),e}i.default=f},{"../extent.js":70,"../math.js":201,"../obj.js":203,"../size.js":251,"../tilecoord.js":305,"../uri.js":312,"./TileImage.js":272}],270:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("../Tile.js")),r=a(t("../TileState.js")),o=a(t("./XYZ.js")),s=t("../dom.js"),u=t("../tilecoord.js"),h=t("../size.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,c,d,p=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),f=(c=n.default,p(y,c),y.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var t=this.tileSize_,e=(0,s.createCanvasContext2D)(t[0],t[1]);return e.strokeStyle="grey",e.strokeRect(.5,.5,t[0]+.5,t[1]+.5),e.fillStyle="grey",e.strokeStyle="white",e.textAlign="center",e.textBaseline="middle",e.font="24px sans-serif",e.lineWidth=4,e.strokeText(this.text_,t[0]/2,t[1]/2,t[0]),e.fillText(this.text_,t[0]/2,t[1]/2,t[0]),this.canvas_=e.canvas,e.canvas},y.prototype.load=function(){},y),g=(l=o.default,p(m,l),m.prototype.getTile=function(t,e,i){var n=(0,u.getKeyZXY)(t,e,i);if(this.tileCache.containsKey(n))return this.tileCache.get(n);var r=(0,h.toSize)(this.tileGrid.getTileSize(t)),o=[t,e,i],s=this.getTileCoordForTileUrlFunction(o),a=s?"z:"+s[0]+" x:"+s[1]+" y:"+s[2]:"none",l=new f(o,r,a);return this.tileCache.set(n,l),l},m);function m(t){var e=t||{};return l.call(this,{opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:void 0===e.wrapX||e.wrapX,zDirection:e.zDirection})||this}function y(t,e,i){var n=c.call(this,t,r.default.LOADED)||this;return n.tileSize_=e,n.text_=i,n.canvas_=null,n}i.default=g},{"../Tile.js":34,"../TileState.js":38,"../dom.js":62,"../size.js":251,"../tilecoord.js":305,"./XYZ.js":283}],271:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"}},{}],272:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var h=u(t("../events/EventType.js")),n=u(t("../ImageTile.js")),g=u(t("../reproj/Tile.js")),r=u(t("../TileCache.js")),c=u(t("../TileState.js")),o=u(t("./UrlTile.js")),m=t("../reproj/common.js"),s=t("./common.js"),y=t("../proj.js"),_=t("../tilecoord.js"),a=t("../tilegrid.js"),l=t("../util.js");function u(t){return t&&t.__esModule?t:{default:t}}var d,p,f=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v=(d=o.default,f(b,d),b.prototype.canExpireCache=function(){if(!m.ENABLE_RASTER_REPROJECTION)return d.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},b.prototype.expireCache=function(t,e){if(m.ENABLE_RASTER_REPROJECTION){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}}else d.prototype.expireCache.call(this,t,e)},b.prototype.getContextOptions=function(){return this.contextOptions_},b.prototype.getGutterForProjection=function(t){return m.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,y.equivalent)(this.getProjection(),t)?0:this.getGutter()},b.prototype.getGutter=function(){return 0},b.prototype.getKey=function(){return d.prototype.getKey.call(this)+(this.contextOptions_?"\n"+JSON.stringify(this.contextOptions_):"")},b.prototype.getOpaque=function(t){return!(m.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,y.equivalent)(this.getProjection(),t))&&d.prototype.getOpaque.call(this,t)},b.prototype.getTileGridForProjection=function(t){if(!m.ENABLE_RASTER_REPROJECTION)return d.prototype.getTileGridForProjection.call(this,t);var e=this.getProjection();if(!this.tileGrid||e&&!(0,y.equivalent)(e,t)){var i=(0,l.getUid)(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=(0,a.getForProjection)(t)),this.tileGridForProjection[i]}return this.tileGrid},b.prototype.getTileCacheForProjection=function(t){if(!m.ENABLE_RASTER_REPROJECTION)return d.prototype.getTileCacheForProjection.call(this,t);var e=this.getProjection();if(!e||(0,y.equivalent)(e,t))return this.tileCache;var i=(0,l.getUid)(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new r.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},b.prototype.createTile_=function(t,e,i,n,r,o){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,r),l=a?this.tileUrlFunction(a,n,r):void 0,u=new this.tileClass(s,void 0!==l?c.default.IDLE:c.default.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(h.default.CHANGE,this.handleTileChange.bind(this)),u},b.prototype.getTile=function(t,e,i,n,r){var o=this.getProjection();if(m.ENABLE_RASTER_REPROJECTION&&o&&r&&!(0,y.equivalent)(o,r)){var s=this.getTileCacheForProjection(r),a=[t,e,i],l=void 0,u=(0,_.getKey)(a);s.containsKey(u)&&(l=s.get(u));var h=this.getKey();if(l&&l.key==h)return l;var c=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),p=this.getTileCoordForTileUrlFunction(a,r),f=new g.default(o,c,r,d,a,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.contextOptions_);return f.key=h,l?(f.interimTile=l,f.refreshInterimChain(),s.replace(u,f)):s.set(u,f),f}return this.getTileInternal(t,e,i,n,o||r)},b.prototype.getTileInternal=function(t,e,i,n,r){var o,s=null,a=(0,_.getKeyZXY)(t,e,i),l=this.getKey();return this.tileCache.containsKey(a)?(s=this.tileCache.get(a)).key!=l&&(o=s,s=this.createTile_(t,e,i,n,r,l),o.getState()==c.default.IDLE?s.interimTile=o.interimTile:s.interimTile=o,s.refreshInterimChain(),this.tileCache.replace(a,s)):(s=this.createTile_(t,e,i,n,r,l),this.tileCache.set(a,s)),s},b.prototype.setRenderReprojectionEdges=function(t){if(m.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},b.prototype.setTileGridForProjection=function(t,e){var i,n;!m.ENABLE_RASTER_REPROJECTION||(i=(0,y.get)(t))&&((n=(0,l.getUid)(i))in this.tileGridForProjection||(this.tileGridForProjection[n]=e))},b);function b(t){var e=d.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:j,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return e.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,e.tileClass=void 0!==t.tileClass?t.tileClass:n.default,e.tileCacheForProjection={},e.tileGridForProjection={},e.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,e.contextOptions_=!1===t.imageSmoothing?s.IMAGE_SMOOTHING_DISABLED:void 0,e.renderReprojectionEdges_=!1,e}function j(t,e){t.getImage().src=e}i.default=v},{"../ImageTile.js":19,"../TileCache.js":35,"../TileState.js":38,"../events/EventType.js":66,"../proj.js":205,"../reproj/Tile.js":246,"../reproj/common.js":248,"../tilecoord.js":305,"../tilegrid.js":306,"../util.js":313,"./UrlTile.js":276,"./common.js":285}],273:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var u=s(t("./State.js")),n=s(t("./TileImage.js")),h=t("../extent.js"),r=t("../asserts.js"),c=t("../tileurlfunction.js"),d=t("../tilegrid.js"),p=t("../proj.js"),o=t("../net.js");function s(t){return t&&t.__esModule?t:{default:t}}var a,l,f=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),g=(a=n.default,f(m,a),m.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||200<=e.status&&e.status<300){var i=void 0;try{i=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},m.prototype.onXHRError_=function(t){this.handleTileJSONError()},m.prototype.getTileJSON=function(){return this.tileJSON_},m.prototype.handleTileJSONResponse=function(e){var t,i,n=(0,p.get)("EPSG:4326"),r=this.getProjection();void 0!==e.bounds&&(t=(0,p.getTransformFromProjections)(n,r),i=(0,h.applyTransform)(e.bounds,t));var o,s=e.minzoom||0,a=e.maxzoom||22,l=(0,d.createXYZ)({extent:(0,d.extentFromProjection)(r),maxZoom:a,minZoom:s,tileSize:this.tileSize_});this.tileGrid=l,this.tileUrlFunction=(0,c.createFromTemplates)(e.tiles,l),void 0===e.attribution||this.getAttributions()||(o=void 0!==i?i:n.getExtent(),this.setAttributions(function(t){return(0,h.intersects)(o,t.extent)?[e.attribution]:null})),this.tileJSON_=e,this.setState(u.default.READY)},m.prototype.handleTileJSONError=function(){this.setState(u.default.ERROR)},m);function m(t){var e,i=a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,imageSmoothing:t.imageSmoothing,projection:(0,p.get)("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:u.default.LOADING,tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this;return i.tileJSON_=null,i.tileSize_=t.tileSize,t.url?t.jsonp?(0,o.jsonp)(t.url,i.handleTileJSONResponse.bind(i),i.handleTileJSONError.bind(i)):((e=new XMLHttpRequest).addEventListener("load",i.onXHRLoad_.bind(i)),e.addEventListener("error",i.onXHRError_.bind(i)),e.open("GET",t.url),e.send()):t.tileJSON?i.handleTileJSONResponse(t.tileJSON):(0,r.assert)(!1,51),i}i.default=g},{"../asserts.js":45,"../extent.js":70,"../net.js":202,"../proj.js":205,"../tilegrid.js":306,"../tileurlfunction.js":310,"./State.js":267,"./TileImage.js":272}],274:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var m=t("./common.js"),n=o(t("./TileImage.js")),d=o(t("./WMSServerType.js")),p=t("../uri.js"),f=t("../asserts.js"),y=t("../obj.js"),_=t("../extent.js"),v=t("../size.js"),b=t("../reproj.js"),r=t("../string.js"),j=t("../proj.js"),g=t("../math.js"),x=t("../tilecoord.js");function o(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=n.default,l(h,s),h.prototype.getFeatureInfoUrl=function(t,e,i,n){var r=(0,j.get)(i),o=this.getProjection(),s=this.getTileGrid(),a=(s=s||this.getTileGridForProjection(r)).getZForResolution(e,this.zDirection),l=s.getTileCoordForCoordAndZ(t,a);if(!(s.getResolutions().length<=l[0])){var u=s.getResolution(l[0]),h=s.getTileCoordExtent(l,this.tmpExtent_),c=(0,v.toSize)(s.getTileSize(l[0]),this.tmpSize),d=this.gutter_;0!==d&&(c=(0,v.buffer)(c,d,this.tmpSize),h=(0,_.buffer)(h,u*d,h)),o&&o!==r&&(u=(0,b.calculateSourceResolution)(o,r,t,u),h=(0,j.transformExtent)(h,r,o),t=(0,j.transform)(t,r,o));var p={SERVICE:"WMS",VERSION:m.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};(0,y.assign)(p,this.params_,n);var f=Math.floor((t[0]-h[0])/u),g=Math.floor((h[3]-t[1])/u);return p[this.v13_?"I":"X"]=f,p[this.v13_?"J":"Y"]=g,this.getRequestUrl_(l,c,h,1,o||r,p)}},h.prototype.getLegendUrl=function(t,e){if(void 0!==this.urls[0]){var i,n={SERVICE:"WMS",VERSION:m.DEFAULT_WMS_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var r=this.params_.LAYERS;if(Array.isArray(r)&&1!==r.length)return;n.LAYER=r}return void 0!==t&&(i=this.getProjection()?this.getProjection().getMetersPerUnit():1,n.SCALE=t*i*39.37*(25.4/.28)),(0,y.assign)(n,e),(0,p.appendParams)(this.urls[0],n)}},h.prototype.getGutter=function(){return this.gutter_},h.prototype.getParams=function(){return this.params_},h.prototype.getRequestUrl_=function(t,e,i,n,r,o){var s=this.urls;if(s){if(o.WIDTH=e[0],o.HEIGHT=e[1],o[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=n)switch(this.serverType_){case d.default.GEOSERVER:var a=90*n+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+a:o.FORMAT_OPTIONS="dpi:"+a;break;case d.default.MAPSERVER:o.MAP_RESOLUTION=90*n;break;case d.default.CARMENTA_SERVER:case d.default.QGIS:o.DPI=90*n;break;default:(0,f.assert)(!1,52)}var l,u,h=r.getAxisOrientation(),c=i;return this.v13_&&"ne"==h.substr(0,2)&&(u=void 0,u=i[0],c[0]=i[1],c[1]=u,u=i[2],c[2]=i[3],c[3]=u),o.BBOX=c.join(","),l=1==s.length?s[0]:s[(0,g.modulo)((0,x.hash)(t),s.length)],(0,p.appendParams)(l,o)}},h.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},h.prototype.getKeyForParams_=function(){var t=0,e=[];for(var i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},h.prototype.updateParams=function(t){(0,y.assign)(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},h.prototype.updateV13_=function(){var t=this.params_.VERSION||m.DEFAULT_WMS_VERSION;this.v13_=0<=(0,r.compareVersions)(t,"1.3")},h.prototype.tileUrlFunction=function(t,e,i){var n=this.getTileGrid();if(!((n=n||this.getTileGridForProjection(i)).getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var r=n.getResolution(t[0]),o=n.getTileCoordExtent(t,this.tmpExtent_),s=(0,v.toSize)(n.getTileSize(t[0]),this.tmpSize),a=this.gutter_;0!==a&&(s=(0,v.buffer)(s,a,this.tmpSize),o=(0,_.buffer)(o,r*a,o)),1!=e&&(s=(0,v.scale)(s,e,this.tmpSize));var l={SERVICE:"WMS",VERSION:m.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return(0,y.assign)(l,this.params_),this.getRequestUrl_(t,s,o,e,i,l)}},h);function h(t){var e=this,i=t||{},n=i.params||{},r=!("TRANSPARENT"in n)||n.TRANSPARENT;return(e=s.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,imageSmoothing:i.imageSmoothing,opaque:!r,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:i.tileClass,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).gutter_=void 0!==i.gutter?i.gutter:0,e.params_=n,e.v13_=!0,e.serverType_=i.serverType,e.hidpi_=void 0===i.hidpi||i.hidpi,e.tmpExtent_=(0,_.createEmpty)(),e.updateV13_(),e.setKey(e.getKeyForParams_()),e}i.default=u},{"../asserts.js":45,"../extent.js":70,"../math.js":201,"../obj.js":203,"../proj.js":205,"../reproj.js":244,"../size.js":251,"../string.js":287,"../tilecoord.js":305,"../uri.js":312,"./TileImage.js":272,"./WMSServerType.js":280,"./common.js":285}],275:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.CustomTile=void 0;var n=u(t("../events/EventType.js")),h=u(t("./State.js")),r=u(t("../Tile.js")),o=u(t("./Tile.js")),c=u(t("../TileState.js")),d=t("../extent.js"),s=t("../asserts.js"),p=t("../tileurlfunction.js"),f=t("../tilegrid.js"),g=t("../tilecoord.js"),m=t("../proj.js"),a=t("../events.js"),l=t("../net.js");function u(t){return t&&t.__esModule?t:{default:t}}var y,_,v=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),b=(y=r.default,v(j,y),j.prototype.getImage=function(){return null},j.prototype.getData=function(t){if(!this.grid_||!this.keys_)return null;var e=(t[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),i=(t[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),n=this.grid_[Math.floor((1-i)*this.grid_.length)];if("string"!=typeof n)return null;var r=n.charCodeAt(Math.floor(e*n.length));93<=r&&r--,35<=r&&r--;var o,s=null;return(r-=32)in this.keys_&&(o=this.keys_[r],s=this.data_&&o in this.data_?this.data_[o]:o),s},j.prototype.forDataAtCoordinate=function(e,i,t){this.state==c.default.EMPTY&&!0===t?(this.state=c.default.IDLE,(0,a.listenOnce)(this,n.default.CHANGE,function(t){i(this.getData(e))},this),this.loadInternal_()):!0===t?setTimeout(function(){i(this.getData(e))}.bind(this),0):i(this.getData(e))},j.prototype.getKey=function(){return this.src_},j.prototype.handleError_=function(){this.state=c.default.ERROR,this.changed()},j.prototype.handleLoad_=function(t){this.grid_=t.grid,this.keys_=t.keys,this.data_=t.data,this.state=c.default.LOADED,this.changed()},j.prototype.loadInternal_=function(){var t;this.state==c.default.IDLE&&(this.state=c.default.LOADING,this.jsonp_?(0,l.jsonp)(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this)):((t=new XMLHttpRequest).addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",this.src_),t.send()))},j.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||200<=e.status&&e.status<300){var i=void 0;try{i=JSON.parse(e.responseText)}catch(t){return void this.handleError_()}this.handleLoad_(i)}else this.handleError_()},j.prototype.onXHRError_=function(t){this.handleError_()},j.prototype.load=function(){this.preemptive_?this.loadInternal_():this.setState(c.default.EMPTY)},j);function j(t,e,i,n,r,o){var s=y.call(this,t,e)||this;return s.src_=i,s.extent_=n,s.preemptive_=r,s.grid_=null,s.keys_=null,s.data_=null,s.jsonp_=o,s}i.CustomTile=b;var x,S=(x=o.default,v(w,x),w.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||200<=e.status&&e.status<300){var i=void 0;try{i=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},w.prototype.onXHRError_=function(t){this.handleTileJSONError()},w.prototype.getTemplate=function(){return this.template_},w.prototype.forDataAtCoordinateAndResolution=function(t,e,i,n){var r,o;this.tileGrid?(r=this.tileGrid.getZForResolution(e,this.zDirection),o=this.tileGrid.getTileCoordForCoordAndZ(t,r),this.getTile(o[0],o[1],o[2],1,this.getProjection()).forDataAtCoordinate(t,i,n)):!0===n?setTimeout(function(){i(null)},0):i(null)},w.prototype.handleTileJSONError=function(){this.setState(h.default.ERROR)},w.prototype.handleTileJSONResponse=function(e){var t,i,n=(0,m.get)("EPSG:4326"),r=this.getProjection();void 0!==e.bounds&&(t=(0,m.getTransformFromProjections)(n,r),i=(0,d.applyTransform)(e.bounds,t));var o=e.minzoom||0,s=e.maxzoom||22,a=(0,f.createXYZ)({extent:(0,f.extentFromProjection)(r),maxZoom:s,minZoom:o});this.tileGrid=a,this.template_=e.template;var l,u=e.grids;u?(this.tileUrlFunction_=(0,p.createFromTemplates)(u,a),void 0!==e.attribution&&(l=void 0!==i?i:n.getExtent(),this.setAttributions(function(t){return(0,d.intersects)(l,t.extent)?[e.attribution]:null})),this.setState(h.default.READY)):this.setState(h.default.ERROR)},w.prototype.getTile=function(t,e,i,n,r){var o=(0,g.getKeyZXY)(t,e,i);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,r),l=this.tileUrlFunction_(a,n,r),u=new b(s,void 0!==l?c.default.IDLE:c.default.EMPTY,void 0!==l?l:"",this.tileGrid.getTileCoordExtent(s),this.preemptive_,this.jsonp_);return this.tileCache.set(o,u),u},w.prototype.useTile=function(t,e,i){var n=(0,g.getKeyZXY)(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},w);function w(t){var e,i=x.call(this,{projection:(0,m.get)("EPSG:3857"),state:h.default.LOADING})||this;return i.preemptive_=void 0===t.preemptive||t.preemptive,i.tileUrlFunction_=p.nullTileUrlFunction,i.template_=void 0,i.jsonp_=t.jsonp||!1,t.url?i.jsonp_?(0,l.jsonp)(t.url,i.handleTileJSONResponse.bind(i),i.handleTileJSONError.bind(i)):((e=new XMLHttpRequest).addEventListener("load",i.onXHRLoad_.bind(i)),e.addEventListener("error",i.onXHRError_.bind(i)),e.open("GET",t.url),e.send()):t.tileJSON?i.handleTileJSONResponse(t.tileJSON):(0,s.assert)(!1,51),i}i.default=S},{"../Tile.js":34,"../TileState.js":38,"../asserts.js":45,"../events.js":64,"../events/EventType.js":66,"../extent.js":70,"../net.js":202,"../proj.js":205,"../tilecoord.js":305,"../tilegrid.js":306,"../tileurlfunction.js":310,"./State.js":267,"./Tile.js":268}],276:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=c(t("./TileEventType.js")),a=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("./Tile.js")),l=c(t("../TileState.js")),n=t("../tileurlfunction.js"),r=t("../tilecoord.js"),u=t("../util.js");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function c(t){return t&&t.__esModule?t:{default:t}}var d,p,f=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),g=(d=a.default,f(m,d),m.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},m.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},m.prototype.getUrls=function(){return this.urls},m.prototype.handleTileChange=function(t){var e,i=t.target,n=(0,u.getUid)(i),r=i.getState();r==l.default.LOADING?(this.tileLoadingKeys_[n]=!0,e=o.default.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=r==l.default.ERROR?o.default.TILELOADERROR:r==l.default.LOADED?o.default.TILELOADEND:void 0),null!=e&&this.dispatchEvent(new a.TileSourceEvent(e,i))},m.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},m.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},m.prototype.setUrl=function(t){var e=(0,n.expandUrl)(t);this.urls=e,this.setUrls(e)},m.prototype.setUrls=function(t){var e=(this.urls=t).join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction((0,n.createFromTemplates)(t,this.tileGrid),e):this.setKey(e)},m.prototype.tileUrlFunction=function(t,e,i){},m.prototype.useTile=function(t,e,i){var n=(0,r.getKeyZXY)(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},m);function m(t){var e=d.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return e.generateTileUrlFunction_=e.tileUrlFunction===m.prototype.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(e.tileUrlFunction=t.tileUrlFunction.bind(e)),e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.tileLoadingKeys_={},e}i.default=g},{"../TileState.js":38,"../tilecoord.js":305,"../tileurlfunction.js":310,"../util.js":313,"./Tile.js":268,"./TileEventType.js":271}],277:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.VectorSourceEvent=void 0;var s=j(t("../Collection.js")),n=j(t("../CollectionEventType.js")),r=j(t("../events/Event.js")),o=j(t("../events/EventType.js")),a=j(t("../ObjectEventType.js")),l=j(t("../structs/RBush.js")),u=j(t("./Source.js")),h=j(t("./State.js")),d=j(t("./VectorEventType.js")),c=t("../functions.js"),p=t("../loadingstrategy.js"),f=t("../asserts.js"),g=t("../extent.js"),m=t("../array.js"),y=t("../util.js"),_=t("../obj.js"),v=t("../events.js"),b=t("../featureloader.js");function j(t){return t&&t.__esModule?t:{default:t}}var x,S,w=(S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),P=(x=r.default,w(E,x),E);function E(t,e){var i=x.call(this,t)||this;return i.feature=e,i}i.VectorSourceEvent=P;var T,O=(T=u.default,w(C,T),C.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},C.prototype.addFeatureInternal=function(t){var e,i,n=(0,y.getUid)(t);this.addToIndex_(n,t)?(this.setupChangeEvents_(n,t),(e=t.getGeometry())?(i=e.getExtent(),this.featuresRtree_&&this.featuresRtree_.insert(i,t)):this.nullGeometryFeatures_[n]=t,this.dispatchEvent(new P(d.default.ADDFEATURE,t))):this.featuresCollection_&&this.featuresCollection_.remove(t)},C.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[(0,v.listen)(e,o.default.CHANGE,this.handleFeatureChange_,this),(0,v.listen)(e,a.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]},C.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&((0,f.assert)(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i},C.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},C.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,o=t.length;r<o;r++){var s=t[r],a=(0,y.getUid)(s);this.addToIndex_(a,s)&&i.push(s)}r=0;for(var l=i.length;r<l;r++){s=i[r],a=(0,y.getUid)(s),this.setupChangeEvents_(a,s);var u,h=s.getGeometry();h?(u=h.getExtent(),e.push(u),n.push(s)):this.nullGeometryFeatures_[a]=s}this.featuresRtree_&&this.featuresRtree_.load(e,n),r=0;for(var c=i.length;r<c;r++)this.dispatchEvent(new P(d.default.ADDFEATURE,i[r]))},C.prototype.bindFeaturesCollection_=function(e){var i=!1;this.addEventListener(d.default.ADDFEATURE,function(t){i||(i=!0,e.push(t.feature),i=!1)}),this.addEventListener(d.default.REMOVEFEATURE,function(t){i||(i=!0,e.remove(t.feature),i=!1)}),e.addEventListener(n.default.ADD,function(t){i||(i=!0,this.addFeature(t.element),i=!1)}.bind(this)),e.addEventListener(n.default.REMOVE,function(t){i||(i=!0,this.removeFeature(t.element),i=!1)}.bind(this)),this.featuresCollection_=e},C.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(v.unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var n=new P(d.default.CLEAR);this.dispatchEvent(n),this.changed()},C.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},C.prototype.forEachFeatureAtCoordinateDirect=function(e,i){var t=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(t,function(t){return t.getGeometry().intersectsCoordinate(e)?i(t):void 0})},C.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},C.prototype.forEachFeatureIntersectingExtent=function(i,n){return this.forEachFeatureInExtent(i,function(t){if(t.getGeometry().intersectsExtent(i)){var e=n(t);if(e)return e}})},C.prototype.getFeaturesCollection=function(){return this.featuresCollection_},C.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),(0,_.isEmpty)(this.nullGeometryFeatures_)||(0,m.extend)(t,(0,_.getValues)(this.nullGeometryFeatures_))),t},C.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},C.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},C.prototype.getClosestFeatureToCoordinate=function(t,e){var r=t[0],o=t[1],s=null,a=[NaN,NaN],l=1/0,u=[-1/0,-1/0,1/0,1/0],h=e||c.TRUE;return this.featuresRtree_.forEachInExtent(u,function(t){var e,i,n;h(t)&&(e=t.getGeometry(),i=l,(l=e.closestPointXY(r,o,a,l))<i&&(s=t,n=Math.sqrt(l),u[0]=r-n,u[1]=o-n,u[2]=r+n,u[3]=o+n))}),s},C.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},C.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},C.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},C.prototype.getFormat=function(){return this.format_},C.prototype.getOverlaps=function(){return this.overlaps_},C.prototype.getUrl=function(){return this.url_},C.prototype.handleFeatureChange_=function(t){var e,i=t.target,n=(0,y.getUid)(i),r=i.getGeometry();r?(e=r.getExtent(),n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(e,i)):this.featuresRtree_&&this.featuresRtree_.update(e,i)):n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(i),this.nullGeometryFeatures_[n]=i);var o,s=i.getId();void 0!==s?(o=s.toString(),this.idIndex_[o]!==i&&(this.removeFromIdIndex_(i),this.idIndex_[o]=i)):(this.removeFromIdIndex_(i),this.uidIndex_[n]=i),this.changed(),this.dispatchEvent(new P(d.default.CHANGEFEATURE,i))},C.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:(0,y.getUid)(t)in this.uidIndex_},C.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&(0,_.isEmpty)(this.nullGeometryFeatures_)},C.prototype.loadFeatures=function(t,i,n){var r=this.loadedExtentsRtree_,o=this.strategy_(t,i);this.loading=!1;for(var s=this,e=0,a=o.length;e<a;++e)!function(t){var e=o[t];r.forEachInExtent(e,function(t){return(0,g.containsExtent)(t.extent,e)})||(s.loader_.call(s,e,i,n),r.insert(e,{extent:e.slice()}),s.loading=s.loader_!==c.VOID)}(e)},C.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),T.prototype.refresh.call(this)},C.prototype.removeLoadedExtent=function(e){var i,t=this.loadedExtentsRtree_;t.forEachInExtent(e,function(t){if((0,g.equals)(t.extent,e))return i=t,!0}),i&&t.remove(i)},C.prototype.removeFeature=function(t){var e=(0,y.getUid)(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},C.prototype.removeFeatureInternal=function(t){var e=(0,y.getUid)(t);this.featureChangeKeys_[e].forEach(v.unlistenByKey),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new P(d.default.REMOVEFEATURE,t))},C.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},C.prototype.setLoader=function(t){this.loader_=t},C.prototype.setUrl=function(t){(0,f.assert)(this.format_,7),this.setLoader((0,b.xhr)(t,this.format_))},C);function C(t){var e=this,i=t||{};(e=T.call(this,{attributions:i.attributions,projection:void 0,state:h.default.READY,wrapX:void 0===i.wrapX||i.wrapX})||this).loader_=c.VOID,e.format_=i.format,e.overlaps_=void 0===i.overlaps||i.overlaps,e.url_=i.url,void 0!==i.loader?e.loader_=i.loader:void 0!==e.url_&&((0,f.assert)(e.format_,7),e.loader_=(0,b.xhr)(e.url_,e.format_)),e.strategy_=void 0!==i.strategy?i.strategy:p.all;var n,r,o=void 0===i.useSpatialIndex||i.useSpatialIndex;return e.featuresRtree_=o?new l.default:null,e.loadedExtentsRtree_=new l.default,e.nullGeometryFeatures_={},e.idIndex_={},e.uidIndex_={},e.featureChangeKeys_={},e.featuresCollection_=null,Array.isArray(i.features)?r=i.features:i.features&&(r=(n=i.features).getArray()),o||void 0!==n||(n=new s.default(r)),void 0!==r&&e.addFeaturesInternal(r),void 0!==n&&e.bindFeaturesCollection_(n),e}i.default=O},{"../Collection.js":10,"../CollectionEventType.js":11,"../ObjectEventType.js":29,"../array.js":44,"../asserts.js":45,"../events.js":64,"../events/Event.js":65,"../events/EventType.js":66,"../extent.js":70,"../featureloader.js":73,"../functions.js":125,"../loadingstrategy.js":200,"../obj.js":203,"../structs/RBush.js":290,"../util.js":313,"./Source.js":265,"./State.js":267,"./VectorEventType.js":278}],278:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"}},{}],279:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.defaultLoadFunction=g,i.default=void 0;var m=u(t("../events/EventType.js")),o=u(t("../VectorTile.js")),s=u(t("../TileCache.js")),v=u(t("../TileState.js")),n=u(t("./UrlTile.js")),b=u(t("../VectorRenderTile.js")),j=t("../extent.js"),a=t("../tilegrid.js"),y=t("../array.js"),x=t("../tilecoord.js"),r=t("../featureloader.js"),l=t("../size.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(h=n.default,d(f,h),f.prototype.getFeaturesInExtent=function(c){var d=[],t=this.tileCache;if(0===t.getCount())return d;var p=(0,x.fromKey)(t.peekFirstKey())[0],f=this.tileGrid;return t.forEach(function(t){if(t.tileCoord[0]===p&&t.getState()===v.default.LOADED)for(var e=t.getSourceTiles(),i=0,n=e.length;i<n;++i){var r=e[i],o=r.tileCoord;if((0,j.intersects)(c,f.getTileCoordExtent(o))){var s=r.getFeatures();if(s)for(var a=0,l=s.length;a<l;++a){var u=s[a],h=u.getGeometry();(0,j.intersects)(c,h.getExtent())&&d.push(u)}}}}),d},f.prototype.getOverlaps=function(){return this.overlaps_},f.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},f.prototype.expireCache=function(t,e){h.prototype.expireCache.call(this,t,e),this.sourceTileCache.expireCache({})},f.prototype.getSourceTiles=function(n,o,s){var t=s.wrappedTileCoord,e=this.getTileGridForProjection(o),i=e.getTileCoordExtent(t),r=t[0],a=e.getResolution(r);(0,j.buffer)(i,-a,i);var l=this.tileGrid,u=l.getExtent();u&&(0,j.getIntersection)(i,u,i);var h,c,d,p=l.getZForResolution(a,1),f=l.getMinZoom(),g=s.sourceTiles;if(g&&0<g.length&&g[0].tileCoord[0]===p)h=g,c=!0,d=p;else for(h=[],d=p+1;--d,c=!0,l.forEachTileCoord(i,d,function(t){var r,e=this.tileUrlFunction(t,n,o);if(void 0!==e)if(this.sourceTileCache.containsKey(e)){var i=(r=this.sourceTileCache.get(e)).getState();if(i===v.default.LOADED||i===v.default.ERROR||i===v.default.EMPTY)return void h.push(r)}else d===p&&((r=new this.tileClass(t,v.default.IDLE,e,this.format_,this.tileLoadFunction)).extent=l.getTileCoordExtent(t),r.projection=o,r.resolution=l.getResolution(t[0]),this.sourceTileCache.set(e,r),r.addEventListener(m.default.CHANGE,this.handleTileChange.bind(this)),r.load());c=c&&r&&r.getState()===v.default.LOADED,r&&r.getState()!==v.default.EMPTY&&s.getState()===v.default.IDLE&&(s.loadingSourceTiles++,r.addEventListener(m.default.CHANGE,function t(){var e,i=r.getState(),n=r.getKey();i!==v.default.LOADED&&i!==v.default.ERROR||(i===v.default.LOADED?(r.removeEventListener(m.default.CHANGE,t),s.loadingSourceTiles--,delete s.errorSourceTileKeys[n]):i===v.default.ERROR&&(s.errorSourceTileKeys[n]=!0),e=Object.keys(s.errorSourceTileKeys).length,s.loadingSourceTiles-e==0&&(s.hifi=0===e,s.sourceZ=p,s.setState(v.default.LOADED)))}))}.bind(this)),c||(h.length=0),!c&&f<d;);return s.getState()===v.default.IDLE&&s.setState(v.default.LOADING),c&&(s.hifi=p===d,s.sourceZ=d,s.getState()<v.default.LOADED?s.setState(v.default.LOADED):g&&(0,y.equals)(h,g)||(s.sourceTiles=h)),h},f.prototype.getTile=function(t,e,i,n,r){var o,s=(0,x.getKeyZXY)(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)&&(o=this.tileCache.get(s)).key===a)return o;var l,u=[t,e,i],h=this.getTileCoordForTileUrlFunction(u,r),c=this.getTileGrid().getExtent(),d=this.getTileGridForProjection(r);h&&c&&(l=d.getTileCoordExtent(h),(0,j.buffer)(l,-d.getResolution(t),l),(0,j.intersects)(c,l)||(h=null));var p,f,g,m,y=!0;null!==h&&(p=this.tileGrid,f=d.getResolution(t),g=p.getZForResolution(f,1),m=d.getTileCoordExtent(h),(0,j.buffer)(m,-f,m),p.forEachTileCoord(m,g,function(t){y=y&&!this.tileUrlFunction(t,n,r)}.bind(this)));var _=new b.default(u,y?v.default.EMPTY:v.default.IDLE,h,this.getSourceTiles.bind(this,n,r));return _.key=a,o?(_.interimTile=o,_.refreshInterimChain(),this.tileCache.replace(s,_)):this.tileCache.set(s,_),_},f.prototype.getTileGridForProjection=function(t){var e,i=t.getCode(),n=this.tileGrids_[i];return n||(e=this.tileGrid,n=(0,a.createForProjection)(t,void 0,e?e.getTileSize(e.getMinZoom()):void 0),this.tileGrids_[i]=n),n},f.prototype.getTilePixelRatio=function(t){return t},f.prototype.getTilePixelSize=function(t,e,i){var n=this.getTileGridForProjection(i),r=(0,l.toSize)(n.getTileSize(t),this.tmpSize);return[Math.round(r[0]*e),Math.round(r[1]*e)]},f.prototype.updateCacheSize=function(t,e){h.prototype.updateCacheSize.call(this,2*t,e)},f);function f(t){var e=this,i=t.projection||"EPSG:3857",n=t.extent||(0,a.extentFromProjection)(i),r=t.tileGrid||(0,a.createXYZ)({extent:n,maxResolution:t.maxResolution,maxZoom:void 0!==t.maxZoom?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});return(e=h.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,opaque:!1,projection:i,state:t.state,tileGrid:r,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:g,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection})||this).format_=t.format?t.format:null,e.loadingTiles_={},e.sourceTileCache=new s.default(e.tileCache.highWaterMark),e.overlaps_=null==t.overlaps||t.overlaps,e.tileClass=t.tileClass?t.tileClass:o.default,e.tileGrids_={},e}function g(t,e){var i=(0,r.loadFeaturesXhr)(e,t.getFormat(),t.onLoad.bind(t),t.onError.bind(t));t.setLoader(i)}i.default=p},{"../TileCache.js":35,"../TileState.js":38,"../VectorRenderTile.js":39,"../VectorTile.js":40,"../array.js":44,"../events/EventType.js":66,"../extent.js":70,"../featureloader.js":73,"../size.js":251,"../tilecoord.js":305,"../tilegrid.js":306,"./UrlTile.js":276}],280:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"}},{}],281:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.optionsFromCapabilities=function(t,s){var e=t.Contents.Layer,i=(0,A.find)(e,function(t,e,i){return t.Identifier==s.layer});if(null===i)return null;var n,a=t.Contents.TileMatrixSet;(n=1<i.TileMatrixSetLink.length?"projection"in s?(0,A.findIndex)(i.TileMatrixSetLink,function(e,t,i){var n=(0,A.find)(a,function(t){return t.Identifier==e.TileMatrixSet}).SupportedCRS,r=(0,k.get)(n.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,k.get)(n),o=(0,k.get)(s.projection);return r&&o?(0,k.equivalent)(r,o):n==s.projection}):(0,A.findIndex)(i.TileMatrixSetLink,function(t,e,i){return t.TileMatrixSet==s.matrixSet}):0)<0&&(n=0);var r=i.TileMatrixSetLink[n].TileMatrixSet,o=i.TileMatrixSetLink[n].TileMatrixSetLimits,l=i.Format[0];"format"in s&&(l=s.format),(n=(0,A.findIndex)(i.Style,function(t,e,i){return"style"in s?t.Title==s.style:t.isDefault}))<0&&(n=0);var u=i.Style[n].Identifier,h={};"Dimension"in i&&i.Dimension.forEach(function(t,e,i){var n=t.Identifier,r=t.Default;void 0===r&&(r=t.Value[0]),h[n]=r});var c,d=t.Contents.TileMatrixSet,p=(0,A.find)(d,function(t,e,i){return t.Identifier==r}),f=p.SupportedCRS;{var g;f&&(c=(0,k.get)(f.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,k.get)(f)),"projection"in s&&(g=(0,k.get)(s.projection))&&(c&&!(0,k.equivalent)(g,c)||(c=g))}var m="ne"==c.getAxisOrientation().substr(0,2),y=p.TileMatrix[0],_={MinTileCol:0,MinTileRow:0,MaxTileCol:y.MatrixWidth-1,MaxTileRow:y.MatrixHeight-1};o&&(_=o[o.length-1],y=(0,A.find)(p.TileMatrix,function(t){return t.Identifier===_.TileMatrix}));var v=28e-5*y.ScaleDenominator/c.getMetersPerUnit(),b=m?[y.TopLeftCorner[1],y.TopLeftCorner[0]]:y.TopLeftCorner,j=y.TileWidth*v,x=y.TileHeight*v,S=[b[0]+j*_.MinTileCol,b[1]-x*(1+_.MaxTileRow),b[0]+j*(1+_.MaxTileCol),b[1]-x*_.MinTileRow];null===c.getExtent()&&c.setExtent(S);var w=(0,R.createFromCapabilitiesMatrixSet)(p,S,o),P=[],E=s.requestEncoding;if(E=void 0!==E?E:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var T=t.OperationsMetadata.GetTile.DCP.HTTP.Get,O=0,C=T.length;O<C;++O)if(T[O].Constraint){var M=(0,A.find)(T[O].Constraint,function(t){return"GetEncoding"==t.name}).AllowedValues.Value;if(""===E&&(E=M[0]),E!==I.default.KVP)break;(0,A.includes)(M,I.default.KVP)&&P.push(T[O].href)}else T[O].href&&(E=I.default.KVP,P.push(T[O].href));return 0===P.length&&(E=I.default.REST,i.ResourceURL.forEach(function(t){"tile"===t.resourceType&&(l=t.format,P.push(t.template))})),{urls:P,layer:s.layer,matrixSet:r,format:l,projection:c,requestEncoding:E,tileGrid:w,style:u,dimensions:h,wrapX:!1,crossOrigin:s.crossOrigin}},i.default=void 0;var n=r(t("./TileImage.js")),I=r(t("./WMTSRequestEncoding.js")),u=t("../uri.js"),h=t("../obj.js"),R=t("../tilegrid/WMTS.js"),o=t("../tileurlfunction.js"),k=t("../proj.js"),A=t("../array.js");function r(t){return t&&t.__esModule?t:{default:t}}var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=(s=n.default,l(d,s),d.prototype.setUrls=function(t){var e=(this.urls=t).join("\n");this.setTileUrlFunction((0,o.createFromTileUrlFunctions)(t.map(this.createFromWMTSTemplate.bind(this))),e)},d.prototype.getDimensions=function(){return this.dimensions_},d.prototype.getFormat=function(){return this.format_},d.prototype.getLayer=function(){return this.layer_},d.prototype.getMatrixSet=function(){return this.matrixSet_},d.prototype.getRequestEncoding=function(){return this.requestEncoding_},d.prototype.getStyle=function(){return this.style_},d.prototype.getVersion=function(){return this.version_},d.prototype.getKeyForDimensions_=function(){var t=0,e=[];for(var i in this.dimensions_)e[t++]=i+"-"+this.dimensions_[i];return e.join("/")},d.prototype.updateDimensions=function(t){(0,h.assign)(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())},d.prototype.createFromWMTSTemplate=function(o){var s=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};s==I.default.KVP&&(0,h.assign)(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),o=s==I.default.KVP?(0,u.appendParams)(o,i):o.replace(/\{(\w+?)\}/g,function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t});var a=this.tileGrid,l=this.dimensions_;return function(t,e,i){if(t){var n={TileMatrix:a.getMatrixId(t[0]),TileCol:t[1],TileRow:t[2]};(0,h.assign)(n,l);var r=o;return s==I.default.KVP?(0,u.appendParams)(r,n):r.replace(/\{(\w+?)\}/g,function(t,e){return n[e]})}}},d);function d(t){var e=this,i=void 0!==t.requestEncoding?t.requestEncoding:I.default.KVP,n=t.tileGrid,r=t.urls;return void 0===r&&void 0!==t.url&&(r=(0,o.expandUrl)(t.url)),(e=s.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,imageSmoothing:t.imageSmoothing,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:r,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition})||this).version_=void 0!==t.version?t.version:"1.0.0",e.format_=void 0!==t.format?t.format:"image/jpeg",e.dimensions_=void 0!==t.dimensions?t.dimensions:{},e.layer_=t.layer,e.matrixSet_=t.matrixSet,e.style_=t.style,e.requestEncoding_=i,e.setKey(e.getKeyForDimensions_()),r&&0<r.length&&(e.tileUrlFunction=(0,o.createFromTileUrlFunctions)(r.map(e.createFromWMTSTemplate.bind(e)))),e}i.default=c},{"../array.js":44,"../obj.js":203,"../proj.js":205,"../tilegrid/WMTS.js":308,"../tileurlfunction.js":310,"../uri.js":312,"./TileImage.js":272,"./WMTSRequestEncoding.js":282}],282:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={KVP:"KVP",REST:"REST"}},{}],283:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./TileImage.js"))&&n.__esModule?n:{default:n},o=t("../tilegrid.js");var s,a,l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=(s=r.default,l(h,s),h);function h(t){var e=t||{},i=void 0!==e.projection?e.projection:"EPSG:3857",n=void 0!==e.tileGrid?e.tileGrid:(0,o.createXYZ)({extent:(0,o.extentFromProjection)(i),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});return s.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,imageSmoothing:e.imageSmoothing,opaque:e.opaque,projection:i,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this}i.default=u},{"../tilegrid.js":306,"./TileImage.js":272}],284:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.CustomTile=void 0;var P=t("../tilegrid/common.js"),n=a(t("../ImageTile.js")),E=a(t("../tilegrid/TileGrid.js")),r=a(t("./TileImage.js")),o=a(t("../TileState.js")),T=t("../asserts.js"),s=t("../dom.js"),O=t("../tileurlfunction.js"),C=t("../extent.js"),M=t("../size.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),I="default",R="truncated",k=(l=n.default,h(c,l),c.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var t=l.prototype.getImage.call(this);if(this.state!=o.default.LOADED)return t;var e=this.tileSize_;if(t.width==e[0]&&t.height==e[1])return this.zoomifyImage_=t;var i=(0,s.createCanvasContext2D)(e[0],e[1]);return i.drawImage(t,0,0),this.zoomifyImage_=i.canvas,i.canvas},c);function c(t,e,i,n,r,o,s){var a=l.call(this,e,i,n,r,o,s)||this;return a.zoomifyImage_=null,a.tileSize_=t,a}i.CustomTile=k;var A,d=(A=r.default,h(p,A),p);function p(t){var e=this,i=t,n=i.size,r=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:I,o=i.tilePixelRatio||1,s=n[0],a=n[1],u=[],l=i.tileSize||P.DEFAULT_TILE_SIZE,h=l*o;switch(r){case I:for(;h<s||h<a;)u.push([Math.ceil(s/h),Math.ceil(a/h)]),h+=h;break;case R:for(var c=s,d=a;h<c||h<d;)u.push([Math.ceil(c/h),Math.ceil(d/h)]),c>>=1,d>>=1;break;default:(0,T.assert)(!1,53)}u.push([1,1]),u.reverse();for(var p=[o],f=[0],g=1,m=u.length;g<m;g++)p.push(o<<g),f.push(u[g-1][0]*u[g-1][1]+f[g-1]);p.reverse();var y=new E.default({tileSize:l,extent:i.extent||[0,-a,s,0],resolutions:p}),_=i.url;_&&-1==_.indexOf("{TileGroup}")&&-1==_.indexOf("{tileIndex}")&&(_+="{TileGroup}/{z}-{x}-{y}.jpg");var v=(0,O.expandUrl)(_),b=l*o,j=(0,O.createFromTileUrlFunctions)(v.map(function(l){return function(t,e,i){if(t){var n=t[0],r=t[1],o=t[2],s=r+o*u[n][0],a={z:n,x:r,y:o,tileIndex:s,TileGroup:"TileGroup"+((s+f[n])/b|0)};return l.replace(/\{(\w+?)\}/g,function(t,e){return a[e]})}}})),x=k.bind(null,(0,M.toSize)(l*o));(e=A.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,imageSmoothing:i.imageSmoothing,projection:i.projection,tilePixelRatio:o,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:x,tileGrid:y,tileUrlFunction:j,transition:i.transition})||this).zDirection=i.zDirection;var S=j(y.getTileCoordForCoordAndResolution((0,C.getCenter)(y.getExtent()),p[p.length-1]),1,null),w=new Image;return w.addEventListener("error",function(){b=l,this.changed()}.bind(e)),w.src=S,e}i.default=d},{"../ImageTile.js":19,"../TileState.js":38,"../asserts.js":45,"../dom.js":62,"../extent.js":70,"../size.js":251,"../tilegrid/TileGrid.js":307,"../tilegrid/common.js":309,"../tileurlfunction.js":310,"./TileImage.js":272}],285:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.IMAGE_SMOOTHING_DISABLED=i.DEFAULT_WMS_VERSION=void 0;i.DEFAULT_WMS_VERSION="1.3.0";i.IMAGE_SMOOTHING_DISABLED={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1}},{}],286:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getDistance=o,i.getLength=function t(e,i){var n=i||{},r=n.radius||m,o=n.projection||"EPSG:3857",s=e.getType();s!==g.default.GEOMETRY_COLLECTION&&(e=e.clone().transform(o,"EPSG:4326"));var a,l,u,h,c,d,p=0;switch(s){case g.default.POINT:case g.default.MULTI_POINT:break;case g.default.LINE_STRING:case g.default.LINEAR_RING:p=y(a=e.getCoordinates(),r);break;case g.default.MULTI_LINE_STRING:case g.default.POLYGON:for(u=0,h=(a=e.getCoordinates()).length;u<h;++u)p+=y(a[u],r);break;case g.default.MULTI_POLYGON:for(u=0,h=(a=e.getCoordinates()).length;u<h;++u)for(c=0,d=(l=a[u]).length;c<d;++c)p+=y(l[c],r);break;case g.default.GEOMETRY_COLLECTION:var f=e.getGeometries();for(u=0,h=f.length;u<h;++u)p+=t(f[u],i);break;default:throw new Error("Unsupported geometry type: "+s)}return p},i.getArea=function t(e,i){var n=i||{},r=n.radius||m,o=n.projection||"EPSG:3857",s=e.getType();s!==g.default.GEOMETRY_COLLECTION&&(e=e.clone().transform(o,"EPSG:4326"));var a,l,u,h,c,d,p=0;switch(s){case g.default.POINT:case g.default.MULTI_POINT:case g.default.LINE_STRING:case g.default.MULTI_LINE_STRING:case g.default.LINEAR_RING:break;case g.default.POLYGON:for(a=e.getCoordinates(),p=Math.abs(_(a[0],r)),u=1,h=a.length;u<h;++u)p-=Math.abs(_(a[u],r));break;case g.default.MULTI_POLYGON:for(u=0,h=(a=e.getCoordinates()).length;u<h;++u)for(l=a[u],p+=Math.abs(_(l[0],r)),c=1,d=l.length;c<d;++c)p-=Math.abs(_(l[c],r));break;case g.default.GEOMETRY_COLLECTION:var f=e.getGeometries();for(u=0,h=f.length;u<h;++u)p+=t(f[u],i);break;default:throw new Error("Unsupported geometry type: "+s)}return p},i.offset=function(t,e,i,n){var r=n||m,o=(0,h.toRadians)(t[1]),s=(0,h.toRadians)(t[0]),a=e/r,l=Math.asin(Math.sin(o)*Math.cos(a)+Math.cos(o)*Math.sin(a)*Math.cos(i)),u=s+Math.atan2(Math.sin(i)*Math.sin(a)*Math.cos(o),Math.cos(a)-Math.sin(o)*Math.sin(l));return[(0,h.toDegrees)(u),(0,h.toDegrees)(l)]},i.DEFAULT_RADIUS=void 0;var n,g=(n=t("./geom/GeometryType.js"))&&n.__esModule?n:{default:n},h=t("./math.js");var m=6371008.8;function o(t,e,i){var n=i||m,r=(0,h.toRadians)(t[1]),o=(0,h.toRadians)(e[1]),s=(o-r)/2,a=(0,h.toRadians)(e[0]-t[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function y(t,e){for(var i=0,n=0,r=t.length;n<r-1;++n)i+=o(t[n],t[n+1],e);return i}function _(t,e){for(var i=0,n=t.length,r=t[n-1][0],o=t[n-1][1],s=0;s<n;s++){var a=t[s][0],l=t[s][1];i+=(0,h.toRadians)(a-r)*(2+Math.sin((0,h.toRadians)(o))+Math.sin((0,h.toRadians)(l))),r=a,o=l}return i*e*e/2}i.DEFAULT_RADIUS=m},{"./geom/GeometryType.js":131,"./math.js":201}],287:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.padNumber=function(t,e,i){var n=void 0!==i?t.toFixed(i):""+t,r=n.indexOf(".");return(r=-1===r?n.length:r)>e?n:new Array(1+e-r).join("0")+n},i.compareVersions=function(t,e){for(var i=(""+t).split("."),n=(""+e).split("."),r=0;r<Math.max(i.length,n.length);r++){var o=parseInt(i[r]||"0",10),s=parseInt(n[r]||"0",10);if(s<o)return 1;if(o<s)return-1}return 0}},{}],288:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=t("../asserts.js"),r=(o.prototype.canExpireCache=function(){return 0<this.highWaterMark&&this.getCount()>this.highWaterMark},o.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},o.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},o.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},o.prototype.get=function(t,e){var i=this.entries_[t];return(0,n.assert)(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},o.prototype.remove=function(t){var e=this.entries_[t];return(0,n.assert)(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},o.prototype.getCount=function(){return this.count_},o.prototype.getKeys=function(){for(var t=new Array(this.count_),e=0,i=this.newest_;i;i=i.older)t[e++]=i.key_;return t},o.prototype.getValues=function(){for(var t=new Array(this.count_),e=0,i=this.newest_;i;i=i.older)t[e++]=i.value_;return t},o.prototype.peekLast=function(){return this.oldest_.value_},o.prototype.peekLastKey=function(){return this.oldest_.key_},o.prototype.peekFirstKey=function(){return this.newest_.key_},o.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},o.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},o.prototype.set=function(t,e){(0,n.assert)(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},o.prototype.setSize=function(t){this.highWaterMark=t},o);function o(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}i.default=r},{"../asserts.js":45}],289:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.DROP=void 0;var n=t("../asserts.js"),r=t("../obj.js");i.DROP=1/0;var o=(s.prototype.clear=function(){this.elements_.length=0,(this.priorities_.length=0,r.clear)(this.queuedElements_)},s.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},s.prototype.enqueue=function(t){(0,n.assert)(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},s.prototype.getCount=function(){return this.elements_.length},s.prototype.getLeftChildIndex_=function(t){return 2*t+1},s.prototype.getRightChildIndex_=function(t){return 2*t+2},s.prototype.getParentIndex_=function(t){return t-1>>1},s.prototype.heapify_=function(){for(var t=(this.elements_.length>>1)-1;0<=t;t--)this.siftUp_(t)},s.prototype.isEmpty=function(){return 0===this.elements_.length},s.prototype.isKeyQueued=function(t){return t in this.queuedElements_},s.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},s.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<n&&i[l]<i[a]?l:a;e[t]=e[u],i[t]=i[u],t=u}e[t]=r,i[t]=o,this.siftDown_(s,t)},s.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],o=n[e];t<e;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=r,n[e]=o},s.prototype.reprioritize=function(){for(var t,e,i=this.priorityFunction_,n=this.elements_,r=this.priorities_,o=0,s=n.length,a=0;a<s;++a)(e=i(t=n[a]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(r[o]=e,n[o++]=t);n.length=o,r.length=o,this.heapify_()},s);function s(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}i.default=o},{"../asserts.js":45,"../obj.js":203}],290:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("rbush/rbush.js"))&&n.__esModule?n:{default:n},o=t("../extent.js"),l=t("../util.js"),s=t("../obj.js");var a=(u.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[(0,l.getUid)(e)]=i},u.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[(0,l.getUid)(s)]=a}this.rbush_.load(i)},u.prototype.remove=function(t){var e=(0,l.getUid)(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},u.prototype.update=function(t,e){var i=this.items_[(0,l.getUid)(e)],n=[i.minX,i.minY,i.maxX,i.maxY];(0,o.equals)(n,t)||(this.remove(e),this.insert(t,e))},u.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},u.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},u.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},u.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},u.prototype.forEach_=function(t,e){for(var i,n=0,r=t.length;n<r;n++)if(i=e(t[n]))return i;return i},u.prototype.isEmpty=function(){return(0,s.isEmpty)(this.items_)},u.prototype.clear=function(){this.rbush_.clear(),this.items_={}},u.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return(0,o.createOrUpdate)(e.minX,e.minY,e.maxX,e.maxY,t)},u.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},u);function u(t){this.rbush_=new r.default(t),this.items_={}}i.default=a},{"../extent.js":70,"../obj.js":203,"../util.js":313,"rbush/rbush.js":324}],291:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"Circle",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"Fill",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"Icon",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"IconImage",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"Image",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"RegularShape",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"Stroke",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"Style",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"Text",{enumerable:!0,get:function(){return c.default}});var n=d(t("./style/Circle.js")),r=d(t("./style/Fill.js")),o=d(t("./style/Icon.js")),s=d(t("./style/IconImage.js")),a=d(t("./style/Image.js")),l=d(t("./style/RegularShape.js")),u=d(t("./style/Stroke.js")),h=d(t("./style/Style.js")),c=d(t("./style/Text.js"));function d(t){return t&&t.__esModule?t:{default:t}}},{"./style/Circle.js":292,"./style/Fill.js":293,"./style/Icon.js":294,"./style/IconImage.js":296,"./style/Image.js":299,"./style/RegularShape.js":300,"./style/Stroke.js":301,"./style/Style.js":302,"./style/Text.js":303}],292:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n,r=(n=t("./RegularShape.js"))&&n.__esModule?n:{default:n};var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(o=r.default,a(u,o),u.prototype.clone=function(){var t=new u({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},u.prototype.setRadius=function(t){this.radius_=t,this.render()},u);function u(t){var e=t||{};return o.call(this,{points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this}i.default=l},{"./RegularShape.js":300}],293:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.clone=function(){var t=this.getColor();return new r({color:Array.isArray(t)?t.slice():t||void 0})},r.prototype.getColor=function(){return this.color_},r.prototype.setColor=function(t){this.color_=t},r);function r(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}i.default=n},{}],294:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=o(t("../events/EventType.js")),c=o(t("./IconAnchorUnits.js")),d=o(t("./IconOrigin.js")),p=o(t("../ImageState.js")),r=o(t("./Image.js")),f=t("../color.js"),g=t("../asserts.js"),m=t("./IconImage.js"),y=t("../util.js");function o(t){return t&&t.__esModule?t:{default:t}}var _,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=(_=r.default,a(u,_),u.prototype.clone=function(){var t=this.getScale();return new u({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},u.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==c.default.FRACTION||this.anchorYUnits_==c.default.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==c.default.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==c.default.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=d.default.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=d.default.TOP_RIGHT&&this.anchorOrigin_!=d.default.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=d.default.BOTTOM_LEFT&&this.anchorOrigin_!=d.default.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},u.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},u.prototype.getColor=function(){return this.color_},u.prototype.getImage=function(t){return this.iconImage_.getImage(t)},u.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},u.prototype.getImageSize=function(){return this.iconImage_.getSize()},u.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},u.prototype.getImageState=function(){return this.iconImage_.getImageState()},u.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},u.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_,e=this.getDisplacement();if(this.offsetOrigin_!=d.default.TOP_LEFT){var i=this.getSize(),n=this.iconImage_.getSize();if(!i||!n)return null;t=t.slice(),this.offsetOrigin_!=d.default.TOP_RIGHT&&this.offsetOrigin_!=d.default.BOTTOM_RIGHT||(t[0]=n[0]-i[0]-t[0]),this.offsetOrigin_!=d.default.BOTTOM_LEFT&&this.offsetOrigin_!=d.default.BOTTOM_RIGHT||(t[1]=n[1]-i[1]-t[1])}return t[0]+=e[0],t[1]+=e[1],this.origin_=t,this.origin_},u.prototype.getSrc=function(){return this.iconImage_.getSrc()},u.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},u.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(n.default.CHANGE,t)},u.prototype.load=function(){this.iconImage_.load()},u.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(n.default.CHANGE,t)},u);function u(t){var e=this,i=t||{},n=void 0!==i.opacity?i.opacity:1,r=void 0!==i.rotation?i.rotation:0,o=void 0!==i.scale?i.scale:1,s=void 0!==i.rotateWithView&&i.rotateWithView;(e=_.call(this,{opacity:n,rotation:r,scale:o,displacement:void 0!==i.displacement?i.displacement:[0,0],rotateWithView:s})||this).anchor_=void 0!==i.anchor?i.anchor:[.5,.5],e.normalizedAnchor_=null,e.anchorOrigin_=void 0!==i.anchorOrigin?i.anchorOrigin:d.default.TOP_LEFT,e.anchorXUnits_=void 0!==i.anchorXUnits?i.anchorXUnits:c.default.FRACTION,e.anchorYUnits_=void 0!==i.anchorYUnits?i.anchorYUnits:c.default.FRACTION,e.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null;var a=void 0!==i.img?i.img:null,l=void 0!==i.imgSize?i.imgSize:null,u=i.src;(0,g.assert)(!(void 0!==u&&a),4),(0,g.assert)(!a||a&&l,5),void 0!==u&&0!==u.length||!a||(u=a.src||(0,y.getUid)(a)),(0,g.assert)(void 0!==u&&0<u.length,6);var h=void 0!==i.src?p.default.IDLE:p.default.LOADED;return e.color_=void 0!==i.color?(0,f.asArray)(i.color):null,e.iconImage_=(0,m.get)(a,u,l,e.crossOrigin_,h,e.color_),e.offset_=void 0!==i.offset?i.offset:[0,0],e.offsetOrigin_=void 0!==i.offsetOrigin?i.offsetOrigin:d.default.TOP_LEFT,e.origin_=null,e.size_=void 0!==i.size?i.size:null,e}i.default=l},{"../ImageState.js":18,"../asserts.js":45,"../color.js":47,"../events/EventType.js":66,"../util.js":313,"./IconAnchorUnits.js":295,"./IconImage.js":296,"./IconOrigin.js":298,"./Image.js":299}],295:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={FRACTION:"fraction",PIXELS:"pixels"}},{}],296:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.get=function(t,e,i,n,r,o){var s=a.shared.get(e,n,o);return s||(s=new f(t,e,i,n,r,o),a.shared.set(e,n,o,s)),s},i.default=void 0;var n=u(t("../events/Target.js")),r=u(t("../events/EventType.js")),o=u(t("../ImageState.js")),s=t("../dom.js"),a=t("./IconImageCache.js"),l=t("../Image.js");function u(t){return t&&t.__esModule?t:{default:t}}var h,c,d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=null,f=(h=n.default,d(g,h),g.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===o.default.LOADED){(p=p||(0,s.createCanvasContext2D)(1,1)).drawImage(this.image_,0,0);try{p.getImageData(0,0,1,1),this.tainted_=!1}catch(t){p=null,this.tainted_=!0}}return!0===this.tainted_},g.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(r.default.CHANGE)},g.prototype.handleImageError_=function(){this.imageState_=o.default.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},g.prototype.handleImageLoad_=function(){this.imageState_=o.default.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},g.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},g.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},g.prototype.getImageState=function(){return this.imageState_},g.prototype.getHitDetectionImage=function(t){var e,i,n,r;return this.hitDetectionImage_[t]||(this.isTainted_()?(e=this.color_?t:1,i=this.size_[0],n=this.size_[1],(r=(0,s.createCanvasContext2D)(Math.ceil(i*e),Math.ceil(n*e))).scale(e,e),r.fillRect(0,0,i,n),this.hitDetectionImage_[t]=r.canvas):this.hitDetectionImage_[t]=this.image_),this.hitDetectionImage_[t]},g.prototype.getSize=function(){return this.size_},g.prototype.getSrc=function(){return this.src_},g.prototype.load=function(){if(this.imageState_==o.default.IDLE){this.imageState_=o.default.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=(0,l.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},g.prototype.replaceColor_=function(t){if(this.color_&&!this.canvas_[t]){var e=document.createElement("canvas");(this.canvas_[t]=e).width=Math.ceil(this.image_.width*t),e.height=Math.ceil(this.image_.height*t);var i=e.getContext("2d");if(i.scale(t,t),i.drawImage(this.image_,0,0),this.isTainted_()){var n=this.color_;return i.globalCompositeOperation="multiply",i.fillStyle="rgb("+n[0]+","+n[1]+","+n[2]+")",i.fillRect(0,0,e.width,e.height),i.globalCompositeOperation="destination-in",void i.drawImage(this.image_,0,0)}for(var r=i.getImageData(0,0,e.width,e.height),o=r.data,s=this.color_[0]/255,a=this.color_[1]/255,l=this.color_[2]/255,u=0,h=o.length;u<h;u+=4)o[u]*=s,o[u+1]*=a,o[u+2]*=l;i.putImageData(r,0,0)}},g.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},g);function g(t,e,i,n,r,o){var s=h.call(this)||this;return s.hitDetectionImage_={},s.image_=t||new Image,null!==n&&(s.image_.crossOrigin=n),s.canvas_={},s.color_=o,s.unlisten_=null,s.imageState_=r,s.size_=i,s.src_=e,s.tainted_,s}i.default=f},{"../Image.js":15,"../ImageState.js":18,"../dom.js":62,"../events/EventType.js":66,"../events/Target.js":68,"./IconImageCache.js":297}],297:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shared=i.default=void 0;var n=t("../color.js"),r=(o.prototype.clear=function(){this.cache_={},this.cacheSize_=0},o.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},o.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},o.prototype.get=function(t,e,i){var n=s(t,e,i);return n in this.cache_?this.cache_[n]:null},o.prototype.set=function(t,e,i,n){var r=s(t,e,i);this.cache_[r]=n,++this.cacheSize_},o.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},o);function o(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}function s(t,e,i){return e+":"+t+":"+(i?(0,n.asString)(i):"null")}i.default=r;var a=new r;i.shared=a},{"../color.js":47}],298:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},{}],299:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=t("../util.js"),r=t("../size.js"),o=(s.prototype.clone=function(){var t=this.getScale();return new s({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},s.prototype.getOpacity=function(){return this.opacity_},s.prototype.getRotateWithView=function(){return this.rotateWithView_},s.prototype.getRotation=function(){return this.rotation_},s.prototype.getScale=function(){return this.scale_},s.prototype.getScaleArray=function(){return this.scaleArray_},s.prototype.getDisplacement=function(){return this.displacement_},s.prototype.getAnchor=function(){return(0,n.abstract)()},s.prototype.getImage=function(t){return(0,n.abstract)()},s.prototype.getHitDetectionImage=function(t){return(0,n.abstract)()},s.prototype.getPixelRatio=function(t){return 1},s.prototype.getImageState=function(){return(0,n.abstract)()},s.prototype.getImageSize=function(){return(0,n.abstract)()},s.prototype.getHitDetectionImageSize=function(){return(0,n.abstract)()},s.prototype.getOrigin=function(){return(0,n.abstract)()},s.prototype.getSize=function(){return(0,n.abstract)()},s.prototype.setOpacity=function(t){this.opacity_=t},s.prototype.setRotateWithView=function(t){this.rotateWithView_=t},s.prototype.setRotation=function(t){this.rotation_=t},s.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=(0,r.toSize)(t)},s.prototype.listenImageChange=function(t){(0,n.abstract)()},s.prototype.load=function(){(0,n.abstract)()},s.prototype.unlistenImageChange=function(t){(0,n.abstract)()},s);function s(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=(0,r.toSize)(t.scale),this.displacement_=t.displacement}i.default=o},{"../size.js":251,"../util.js":313}],300:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(t("../ImageState.js")),r=a(t("./Image.js")),o=t("../color.js"),c=t("../colorlike.js"),s=t("../dom.js"),d=t("../render/canvas.js");function a(t){return t&&t.__esModule?t:{default:t}}var l,u,h=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=(l=r.default,h(f,l),f.prototype.clone=function(){var t=new f({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},f.prototype.getAnchor=function(){return this.anchor_},f.prototype.getAngle=function(){return this.angle_},f.prototype.getFill=function(){return this.fill_},f.prototype.getHitDetectionImage=function(t){var e;return this.hitDetectionCanvas_[t||1]||(e=this.createRenderOptions(),this.createHitDetectionCanvas_(e,t||1)),this.hitDetectionCanvas_[t||1]},f.prototype.getImage=function(t){var e,i;return this.canvas_[t||1]||(e=this.createRenderOptions(),i=(0,s.createCanvasContext2D)(e.size*t||1,e.size*t||1),this.draw_(e,i,0,0,t||1),this.canvas_[t||1]=i.canvas),this.canvas_[t||1]},f.prototype.getPixelRatio=function(t){return t},f.prototype.getImageSize=function(){return this.imageSize_},f.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},f.prototype.getImageState=function(){return n.default.LOADED},f.prototype.getOrigin=function(){return this.origin_},f.prototype.getPoints=function(){return this.points_},f.prototype.getRadius=function(){return this.radius_},f.prototype.getRadius2=function(){return this.radius2_},f.prototype.getSize=function(){return this.size_},f.prototype.getStroke=function(){return this.stroke_},f.prototype.listenImageChange=function(t){},f.prototype.load=function(){},f.prototype.unlistenImageChange=function(t){},f.prototype.createRenderOptions=function(){var t,e=d.defaultLineCap,i=d.defaultLineJoin,n=0,r=null,o=0,s=0;return this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=d.defaultStrokeStyle),t=(0,c.asColorLike)(t),void 0===(s=this.stroke_.getWidth())&&(s=d.defaultLineWidth),r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),void 0===(i=this.stroke_.getLineJoin())&&(i=d.defaultLineJoin),void 0===(e=this.stroke_.getLineCap())&&(e=d.defaultLineCap),void 0===(n=this.stroke_.getMiterLimit())&&(n=d.defaultMiterLimit)),{strokeStyle:t,strokeWidth:s,size:2*(this.radius_+s)+1,lineCap:e,lineDash:r,lineDashOffset:o,lineJoin:i,miterLimit:n}},f.prototype.render=function(){var t=this.createRenderOptions(),e=(0,s.createCanvasContext2D)(t.size,t.size);this.draw_(t,e,0,0,1),this.canvas_[1]=e.canvas;var i=e.canvas.width,n=i,r=this.getDisplacement();this.hitDetectionImageSize_=[t.size,t.size],this.createHitDetectionCanvas_(t,1),this.anchor_=[i/2-r[0],i/2+r[1]],this.size_=[i,i],this.imageSize_=[n,n]},f.prototype.draw_=function(t,e,i,n,r){var o,s,a;e.setTransform(r,0,0,r,0,0),e.translate(i,n),e.beginPath();var l,u=this.points_;if(u===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(u*=2),o=0;o<=u;o++)s=2*o*Math.PI/u-Math.PI/2+this.angle_,a=o%2==0?this.radius_:h,e.lineTo(t.size/2+a*Math.cos(s),t.size/2+a*Math.sin(s))}this.fill_&&(null===(l=this.fill_.getColor())&&(l=d.defaultFillStyle),e.fillStyle=(0,c.asColorLike)(l),e.fill()),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},f.prototype.createHitDetectionCanvas_=function(t,e){var i,n,r;this.hitDetectionCanvas_[e]=this.getImage(e),this.fill_&&(n=0,"string"==typeof(i=this.fill_.getColor())&&(i=(0,o.asArray)(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(r=(0,s.createCanvasContext2D)(t.size*e,t.size*e),this.hitDetectionCanvas_[e]=r.canvas,this.drawHitDetectionCanvas_(t,r,0,0,e)))},f.prototype.drawHitDetectionCanvas_=function(t,e,i,n,r){e.setTransform(r,0,0,r,0,0),e.translate(i,n),e.beginPath();var o=this.points_;if(o===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var s=void 0!==this.radius2_?this.radius2_:this.radius_;s!==this.radius_&&(o*=2);for(var a=void 0,l=void 0,u=void 0,a=0;a<=o;a++)u=2*a*Math.PI/o-Math.PI/2+this.angle_,l=a%2==0?this.radius_:s,e.lineTo(t.size/2+l*Math.cos(u),t.size/2+l*Math.sin(u))}e.fillStyle=d.defaultFillStyle,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},f);function f(t){var e=this,i=void 0!==t.rotateWithView&&t.rotateWithView;return(e=l.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==t.rotation?t.rotation:0,scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0]})||this).canvas_={},e.hitDetectionCanvas_={},e.fill_=void 0!==t.fill?t.fill:null,e.origin_=[0,0],e.points_=t.points,e.radius_=void 0!==t.radius?t.radius:t.radius1,e.radius2_=t.radius2,e.angle_=void 0!==t.angle?t.angle:0,e.stroke_=void 0!==t.stroke?t.stroke:null,e.anchor_=null,e.size_=null,e.imageSize_=null,e.hitDetectionImageSize_=null,e.render(),e}i.default=p},{"../ImageState.js":18,"../color.js":47,"../colorlike.js":48,"../dom.js":62,"../render/canvas.js":219,"./Image.js":299}],301:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.clone=function(){var t=this.getColor();return new r({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},r.prototype.getColor=function(){return this.color_},r.prototype.getLineCap=function(){return this.lineCap_},r.prototype.getLineDash=function(){return this.lineDash_},r.prototype.getLineDashOffset=function(){return this.lineDashOffset_},r.prototype.getLineJoin=function(){return this.lineJoin_},r.prototype.getMiterLimit=function(){return this.miterLimit_},r.prototype.getWidth=function(){return this.width_},r.prototype.setColor=function(t){this.color_=t},r.prototype.setLineCap=function(t){this.lineCap_=t},r.prototype.setLineDash=function(t){this.lineDash_=t},r.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},r.prototype.setLineJoin=function(t){this.lineJoin_=t},r.prototype.setMiterLimit=function(t){this.miterLimit_=t},r.prototype.setWidth=function(t){this.width_=t},r);function r(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}i.default=n},{}],302:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.toFunction=function(t){var e,i;e="function"==typeof t?t:(i=Array.isArray(t)?t:((0,a.assert)("function"==typeof t.getZIndex,41),[t]),function(){return i});return e},i.createDefaultStyle=function(t,e){{var i,n;d||(i=new o.default({color:"rgba(255,255,255,0.4)"}),n=new s.default({color:"#3399CC",width:1.25}),d=[new h({image:new r.default({fill:i,stroke:n,radius:5}),fill:i,stroke:n})])}return d},i.createEditingStyle=function(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[n.default.POLYGON]=[new h({fill:new o.default({color:[255,255,255,.5]})})],t[n.default.MULTI_POLYGON]=t[n.default.POLYGON],t[n.default.LINE_STRING]=[new h({stroke:new s.default({color:e,width:5})}),new h({stroke:new s.default({color:i,width:3})})],t[n.default.MULTI_LINE_STRING]=t[n.default.LINE_STRING],t[n.default.CIRCLE]=t[n.default.POLYGON].concat(t[n.default.LINE_STRING]),t[n.default.POINT]=[new h({image:new r.default({radius:6,fill:new o.default({color:i}),stroke:new s.default({color:e,width:1.5})}),zIndex:1/0})],t[n.default.MULTI_POINT]=t[n.default.POINT],t[n.default.GEOMETRY_COLLECTION]=t[n.default.POLYGON].concat(t[n.default.LINE_STRING],t[n.default.POINT]),t},i.default=void 0;var r=l(t("./Circle.js")),o=l(t("./Fill.js")),n=l(t("../geom/GeometryType.js")),s=l(t("./Stroke.js")),a=t("../asserts.js");function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=(c.prototype.clone=function(){var t=this.getGeometry();return t&&"object"===u(t)&&(t=t.clone()),new c({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},c.prototype.getRenderer=function(){return this.renderer_},c.prototype.setRenderer=function(t){this.renderer_=t},c.prototype.getGeometry=function(){return this.geometry_},c.prototype.getGeometryFunction=function(){return this.geometryFunction_},c.prototype.getFill=function(){return this.fill_},c.prototype.setFill=function(t){this.fill_=t},c.prototype.getImage=function(){return this.image_},c.prototype.setImage=function(t){this.image_=t},c.prototype.getStroke=function(){return this.stroke_},c.prototype.setStroke=function(t){this.stroke_=t},c.prototype.getText=function(){return this.text_},c.prototype.setText=function(t){this.text_=t},c.prototype.getZIndex=function(){return this.zIndex_},c.prototype.setGeometry=function(e){"function"==typeof e?this.geometryFunction_=e:"string"==typeof e?this.geometryFunction_=function(t){return t.get(e)}:e?void 0!==e&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=p,this.geometry_=e},c.prototype.setZIndex=function(t){this.zIndex_=t},c);function c(t){var e=t||{};this.geometry_=null,this.geometryFunction_=p,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}var d=null;function p(t){return t.getGeometry()}i.default=h},{"../asserts.js":45,"../geom/GeometryType.js":131,"./Circle.js":292,"./Fill.js":293,"./Stroke.js":301}],303:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(t("./Fill.js")),r=s(t("./TextPlacement.js")),o=t("../size.js");function s(t){return t&&t.__esModule?t:{default:t}}var a=(l.prototype.clone=function(){var t=this.getScale();return new l({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},l.prototype.getOverflow=function(){return this.overflow_},l.prototype.getFont=function(){return this.font_},l.prototype.getMaxAngle=function(){return this.maxAngle_},l.prototype.getPlacement=function(){return this.placement_},l.prototype.getOffsetX=function(){return this.offsetX_},l.prototype.getOffsetY=function(){return this.offsetY_},l.prototype.getFill=function(){return this.fill_},l.prototype.getRotateWithView=function(){return this.rotateWithView_},l.prototype.getRotation=function(){return this.rotation_},l.prototype.getScale=function(){return this.scale_},l.prototype.getScaleArray=function(){return this.scaleArray_},l.prototype.getStroke=function(){return this.stroke_},l.prototype.getText=function(){return this.text_},l.prototype.getTextAlign=function(){return this.textAlign_},l.prototype.getTextBaseline=function(){return this.textBaseline_},l.prototype.getBackgroundFill=function(){return this.backgroundFill_},l.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},l.prototype.getPadding=function(){return this.padding_},l.prototype.setOverflow=function(t){this.overflow_=t},l.prototype.setFont=function(t){this.font_=t},l.prototype.setMaxAngle=function(t){this.maxAngle_=t},l.prototype.setOffsetX=function(t){this.offsetX_=t},l.prototype.setOffsetY=function(t){this.offsetY_=t},l.prototype.setPlacement=function(t){this.placement_=t},l.prototype.setRotateWithView=function(t){this.rotateWithView_=t},l.prototype.setFill=function(t){this.fill_=t},l.prototype.setRotation=function(t){this.rotation_=t},l.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=(0,o.toSize)(void 0!==t?t:1)},l.prototype.setStroke=function(t){this.stroke_=t},l.prototype.setText=function(t){this.text_=t},l.prototype.setTextAlign=function(t){this.textAlign_=t},l.prototype.setTextBaseline=function(t){this.textBaseline_=t},l.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},l.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},l.prototype.setPadding=function(t){this.padding_=t},l);function l(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=(0,o.toSize)(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new n.default({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:r.default.POINT,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}i.default=a},{"../size.js":251,"./Fill.js":293,"./TextPlacement.js":304}],304:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={POINT:"point",LINE:"line"}},{}],305:[function(t,e,i){"use strict";function n(t,e,i){return t+"/"+e+"/"+i}Object.defineProperty(i,"__esModule",{value:!0}),i.createOrUpdate=function(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]},i.getKeyZXY=n,i.getKey=function(t){return n(t[0],t[1],t[2])},i.fromKey=function(t){return t.split("/").map(Number)},i.hash=function(t){return(t[1]<<t[0])+t[2]},i.withinExtentAndZ=function(t,e){var i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(n,r)}},{}],306:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getForProjection=function(t){var e=t.getDefaultTileGrid();return e||(e=h(t),t.setDefaultTileGrid(e)),e},i.wrapX=function(t,e,i){var n=e[0],r=t.getTileCoordCenter(e),o=c(i);if((0,p.containsCoordinate)(o,r))return e;var s=(0,p.getWidth)(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,n)},i.createForExtent=l,i.createXYZ=function(t){var e=t||{},i=e.extent||(0,r.get)("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:u(i,e.maxZoom,e.tileSize,e.maxResolution)};return new a.default(n)},i.createForProjection=h,i.extentFromProjection=c;var s=o(t("./extent/Corner.js")),a=o(t("./tilegrid/TileGrid.js")),n=o(t("./proj/Units.js")),d=t("./tilegrid/common.js"),r=t("./proj.js"),p=t("./extent.js"),f=t("./size.js");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e,i,n){var r=void 0!==n?n:s.default.TOP_LEFT,o=u(t,e,i);return new a.default({extent:t,origin:(0,p.getCorner)(t,r),resolutions:o,tileSize:i})}function u(t,e,i,n){for(var r=void 0!==e?e:d.DEFAULT_MAX_ZOOM,o=(0,p.getHeight)(t),s=(0,p.getWidth)(t),a=(0,f.toSize)(void 0!==i?i:d.DEFAULT_TILE_SIZE),l=0<n?n:Math.max(s/a[0],o/a[1]),u=r+1,h=new Array(u),c=0;c<u;++c)h[c]=l/Math.pow(2,c);return h}function h(t,e,i,n){return l(c(t),e,i,n)}function c(t){var e,i=(t=(0,r.get)(t)).getExtent();return i||(e=180*r.METERS_PER_UNIT[n.default.DEGREES]/t.getMetersPerUnit(),i=(0,p.createOrUpdate)(-e,-e,e,e)),i}},{"./extent.js":70,"./extent/Corner.js":71,"./proj.js":205,"./proj/Units.js":207,"./size.js":251,"./tilegrid/TileGrid.js":307,"./tilegrid/common.js":309}],307:[function(t,e,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==s(t)&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=n?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r])}return i.default=t,e&&e.set(t,i),i}(t("../TileRange.js")),o=t("./common.js"),a=t("../asserts.js"),n=t("../math.js"),h=t("../extent.js"),g=t("../tilecoord.js"),u=t("../array.js"),m=t("../size.js");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var d=[0,0,0],r=(p.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),r=n.minX,o=n.maxX;r<=o;++r)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,r,s])},p.prototype.forEachTileCoordParentTileRange=function(t,e,i,n){var r,o,s=null,a=t[0]-1;for(2===this.zoomFactor_?(r=t[1],o=t[2]):s=this.getTileCoordExtent(t,n);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?(r=Math.floor(r/2),o=Math.floor(o/2),(0,l.createOrUpdate)(r,r,o,o,i)):this.getTileRangeForExtentAndZ(s,a,i)))return!0;--a}return!1},p.prototype.getExtent=function(){return this.extent_},p.prototype.getMaxZoom=function(){return this.maxZoom},p.prototype.getMinZoom=function(){return this.minZoom},p.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},p.prototype.getResolution=function(t){return this.resolutions_[t]},p.prototype.getResolutions=function(){return this.resolutions_},p.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],r=2*t[2];return(0,l.createOrUpdate)(n,1+n,r,1+r,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},p.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),r=this.getResolution(t),o=(0,m.toSize)(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r,l=n[1]+e.minY*o[1]*r,u=n[1]+(e.maxY+1)*o[1]*r;return(0,h.createOrUpdate)(s,l,a,u,i)},p.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=d;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),(0,l.createOrUpdate)(r,n[1],o,n[2],i)},p.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=(0,m.toSize)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]},p.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=(0,m.toSize)(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]-(t[2]+1)*r[1]*n,a=o+r[0]*n,l=s+r[1]*n;return(0,h.createOrUpdate)(o,s,a,l,e)},p.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},p.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),l=(0,m.toSize)(this.getTileSize(o),this.tmpSize_),u=n?.5:0,h=n?.5:0,c=Math.floor((t-a[0])/i+u),d=Math.floor((a[1]-e)/i+h),p=s*c/l[0],f=s*d/l[1],f=n?(p=Math.ceil(p)-1,Math.ceil(f)-1):(p=Math.floor(p),Math.floor(f));return(0,g.createOrUpdate)(o,p,f,r)},p.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i),s=this.getResolution(i),a=(0,m.toSize)(this.getTileSize(i),this.tmpSize_),l=n?.5:0,u=n?.5:0,h=Math.floor((t-o[0])/s+l),c=Math.floor((o[1]-e)/s+u),d=h/a[0],p=c/a[1],p=n?(d=Math.ceil(d)-1,Math.ceil(p)-1):(d=Math.floor(d),Math.floor(p));return(0,g.createOrUpdate)(i,d,p,r)},p.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},p.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},p.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},p.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},p.prototype.getZForResolution=function(t,e){var i=(0,u.linearFindNearest)(this.resolutions_,t,e||0);return(0,n.clamp)(i,this.minZoom,this.maxZoom)},p.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i},p);function p(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,(0,a.assert)((0,u.isSorted)(this.resolutions_,function(t,e){return e-t},!0),17),!t.origins)for(var i=0,n=this.resolutions_.length-1;i<n;++i)if(e){if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=void 0;break}}else e=this.resolutions_[i]/this.resolutions_[i+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,(0,a.assert)(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=(0,h.getTopLeft)(r)),(0,a.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,(0,a.assert)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:o.DEFAULT_TILE_SIZE,(0,a.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new l.default(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):r&&this.calculateTileRanges_(r)}i.default=r},{"../TileRange.js":37,"../array.js":44,"../asserts.js":45,"../extent.js":70,"../math.js":201,"../size.js":251,"../tilecoord.js":305,"./common.js":309}],308:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createFromCapabilitiesMatrixSet=function(r,t,e){var o=[],s=[],a=[],l=[],u=[],h=void 0!==e?e:[],i=r.SupportedCRS,n=(0,f.get)(i.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,f.get)(i),c=n.getMetersPerUnit(),d="ne"==n.getAxisOrientation().substr(0,2);return r.TileMatrix.sort(function(t,e){return e.ScaleDenominator-t.ScaleDenominator}),r.TileMatrix.forEach(function(e){var t,i,n;0<h.length&&!(0,p.find)(h,function(t){return e.Identifier==t.TileMatrix||-1===e.Identifier.indexOf(":")&&r.Identifier+":"+e.Identifier===t.TileMatrix})||(s.push(e.Identifier),t=28e-5*e.ScaleDenominator/c,i=e.TileWidth,n=e.TileHeight,d?a.push([e.TopLeftCorner[1],e.TopLeftCorner[0]]):a.push(e.TopLeftCorner),o.push(t),l.push(i==n?i:[i,n]),u.push([e.MatrixWidth,e.MatrixHeight]))}),new g({extent:t,origins:a,resolutions:o,matrixIds:s,tileSizes:l,sizes:u})},i.default=void 0;var n,r=(n=t("./TileGrid.js"))&&n.__esModule?n:{default:n},p=t("../array.js"),f=t("../proj.js");var o,s,a=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),g=(o=r.default,a(l,o),l.prototype.getMatrixId=function(t){return this.matrixIds_[t]},l.prototype.getMatrixIds=function(){return this.matrixIds_},l);function l(t){var e=o.call(this,{extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes})||this;return e.matrixIds_=t.matrixIds,e}i.default=g},{"../array.js":44,"../proj.js":205,"./TileGrid.js":307}],309:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_TILE_SIZE=i.DEFAULT_MAX_ZOOM=void 0;i.DEFAULT_MAX_ZOOM=42;i.DEFAULT_TILE_SIZE=256},{}],310:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createFromTemplate=o,i.createFromTemplates=function(t,e){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=o(t[r],e);return l(n)},i.createFromTileUrlFunctions=l,i.nullTileUrlFunction=function(t,e,i){},i.expandUrl=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n=i[1].charCodeAt(0),r=i[2].charCodeAt(0),o=void 0;for(o=n;o<=r;++o)e.push(t.replace(i[0],String.fromCharCode(o)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e};var u=t("./asserts.js"),s=t("./math.js"),a=t("./tilecoord.js");function o(n,r){var o=/\{z\}/g,s=/\{x\}/g,a=/\{y\}/g,l=/\{-y\}/g;return function(i,t,e){return i?n.replace(o,i[0].toString()).replace(s,i[1].toString()).replace(a,i[2].toString()).replace(l,function(){var t=i[0],e=r.getFullTileRange(t);return(0,u.assert)(e,55),(e.getHeight()-i[2]-1).toString()}):void 0}}function l(o){return 1===o.length?o[0]:function(t,e,i){if(t){var n=(0,a.hash)(t),r=(0,s.modulo)(n,o.length);return o[r](t,e,i)}}}},{"./asserts.js":45,"./math.js":201,"./tilecoord.js":305}],311:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.create=a,i.reset=function(t){return s(t,1,0,0,1,0,0)},i.multiply=o,i.set=s,i.setFromArray=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.apply=function(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e},i.rotate=function(t,e){var i=Math.cos(e),n=Math.sin(e);return o(t,s(r,i,n,-n,i,0,0))},i.scale=function(t,e,i){return o(t,s(r,e,0,0,i,0,0))},i.makeScale=function(t,e,i){return s(t,e,0,0,i,0,0)},i.translate=function(t,e,i){return o(t,s(r,1,0,0,1,e,i))},i.compose=l,i.composeCssTransform=function(t,e,i,n,r,o,s){return c(l(a(),t,e,i,n,r,o,s))},i.invert=function(t){return n(t,t)},i.makeInverse=n,i.determinant=h,i.toString=c;var u=t("./asserts.js"),r=new Array(6);function a(){return[1,0,0,1,0,0]}function o(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=e[0],u=e[1],h=e[2],c=e[3],d=e[4],p=e[5];return t[0]=i*l+r*u,t[1]=n*l+o*u,t[2]=i*h+r*c,t[3]=n*h+o*c,t[4]=i*d+r*p+s,t[5]=n*d+o*p+a,t}function s(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function l(t,e,i,n,r,o,s,a){var l=Math.sin(o),u=Math.cos(o);return t[0]=n*u,t[1]=r*l,t[2]=-n*l,t[3]=r*u,t[4]=s*n*u-a*n*l+e,t[5]=s*r*l+a*r*u+i,t}function n(t,e){var i=h(e);(0,u.assert)(0!==i,32);var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5];return t[0]=s/i,t[1]=-r/i,t[2]=-o/i,t[3]=n/i,t[4]=(o*l-s*a)/i,t[5]=-(n*l-r*a)/i,t}function h(t){return t[0]*t[3]-t[1]*t[2]}function c(t){return"matrix("+t.join(", ")+")"}},{"./asserts.js":45}],312:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.appendParams=function(t,e){var i=[];Object.keys(e).forEach(function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))});var n=i.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+n}},{}],313:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.abstract=function(){return function(){throw new Error("Unimplemented abstract method.")}()},i.getUid=function(t){return t.ol_uid||(t.ol_uid=String(++n))},i.VERSION=void 0;var n=0;i.VERSION="6.4.0"},{}],314:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},i.fromTransform=function(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}},{}],315:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getContext=r,i.getSupportedExtensions=function(){{var t;n||(t=r(document.createElement("canvas")))&&(n=t.getSupportedExtensions())}return n},i.FLOAT=i.UNSIGNED_INT=i.UNSIGNED_SHORT=i.UNSIGNED_BYTE=i.DYNAMIC_DRAW=i.STATIC_DRAW=i.STREAM_DRAW=i.ELEMENT_ARRAY_BUFFER=i.ARRAY_BUFFER=void 0;i.ARRAY_BUFFER=34962;i.ELEMENT_ARRAY_BUFFER=34963;i.STREAM_DRAW=35040;i.STATIC_DRAW=35044;i.DYNAMIC_DRAW=35048;i.UNSIGNED_BYTE=5121;i.UNSIGNED_SHORT=5123;i.UNSIGNED_INT=5125;i.FLOAT=5126;var n,o=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function r(t,e){for(var i=o.length,n=0;n<i;++n)try{var r=t.getContext(o[n],e);if(r)return r}catch(t){}return null}},{}],316:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getArrayClassForType=l,i.default=i.BufferUsage=void 0;var n=t("../webgl.js"),r=t("../asserts.js"),o={STATIC_DRAW:n.STATIC_DRAW,STREAM_DRAW:n.STREAM_DRAW,DYNAMIC_DRAW:n.DYNAMIC_DRAW};i.BufferUsage=o;var s=(a.prototype.ofSize=function(t){this.array=new(l(this.type))(t)},a.prototype.fromArray=function(t){this.array=l(this.type).from(t)},a.prototype.fromArrayBuffer=function(t){this.array=new(l(this.type))(t)},a.prototype.getType=function(){return this.type},a.prototype.getArray=function(){return this.array},a.prototype.getUsage=function(){return this.usage},a.prototype.getSize=function(){return this.array?this.array.length:0},a);function a(t,e){this.array=null,this.type=t,(0,r.assert)(t===n.ARRAY_BUFFER||t===n.ELEMENT_ARRAY_BUFFER,62),this.usage=void 0!==e?e:o.STATIC_DRAW}function l(t){switch(t){case n.ARRAY_BUFFER:return Float32Array;case n.ELEMENT_ARRAY_BUFFER:return Uint32Array;default:return Float32Array}}i.default=s},{"../asserts.js":45,"../webgl.js":315}],317:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;i.default={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"}},{}],318:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.computeAttributesStride=j,i.default=i.AttributeType=i.DefaultUniform=i.ShaderType=void 0;var o=p(t("../webgl/ContextEventType.js")),n=p(t("../Disposable.js")),s=p(t("./PostProcessingPass.js")),a=t("../webgl.js"),l=t("../asserts.js"),r=t("../obj.js"),u=t("../transform.js"),h=t("../vec/mat4.js"),c=t("../util.js"),d=t("../array.js");function p(t){return t&&t.__esModule?t:{default:t}}var f,g=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});i.ShaderType={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633};var m={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"};i.DefaultUniform=m;var y={UNSIGNED_BYTE:a.UNSIGNED_BYTE,UNSIGNED_SHORT:a.UNSIGNED_SHORT,UNSIGNED_INT:a.UNSIGNED_INT,FLOAT:a.FLOAT};i.AttributeType=y;var _,v=(_=n.default,g(b,_),b.prototype.bindBuffer=function(t){var e=this.getGL(),i=(0,c.getUid)(t),n=this.bufferCache_[i];n||(n={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[i]=n),e.bindBuffer(t.getType(),n.webGlBuffer)},b.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},b.prototype.deleteBuffer=function(t){var e=this.getGL(),i=(0,c.getUid)(t),n=this.bufferCache_[i];e.isContextLost()||e.deleteBuffer(n.buffer),delete this.bufferCache_[i]},b.prototype.disposeInternal=function(){this.canvas_.removeEventListener(o.default.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(o.default.RESTORED,this.boundHandleWebGLContextRestored_)},b.prototype.prepareDraw=function(t){var e=this.getGL(),i=this.getCanvas(),n=t.size,r=t.pixelRatio;i.width=n[0]*r,i.height=n[1]*r,i.style.width=n[0]+"px",i.style.height=n[1]+"px",e.useProgram(this.currentProgram_);for(var o=this.postProcessPasses_.length-1;0<=o;o--)this.postProcessPasses_[o].init(t);e.bindTexture(e.TEXTURE_2D,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},b.prototype.prepareDrawToRenderTarget=function(t,e,i){var n=this.getGL(),r=e.getSize();n.bindFramebuffer(n.FRAMEBUFFER,e.getFramebuffer()),n.viewport(0,0,r[0],r[1]),n.bindTexture(n.TEXTURE_2D,e.getTexture()),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,i?n.ZERO:n.ONE_MINUS_SRC_ALPHA),n.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},b.prototype.drawElements=function(t,e){var i=this.getGL(),n=i.UNSIGNED_INT,r=e-t,o=4*t;i.drawElements(i.TRIANGLES,r,n,o)},b.prototype.finalizeDraw=function(t){for(var e=0;e<this.postProcessPasses_.length;e++)this.postProcessPasses_[e].apply(t,this.postProcessPasses_[e+1]||null)},b.prototype.getCanvas=function(){return this.canvas_},b.prototype.getGL=function(){return this.gl_},b.prototype.applyFrameState=function(t){var e=t.size,i=t.viewState.rotation,n=(0,u.reset)(this.offsetScaleMatrix_);(0,u.scale)(n,2/e[0],2/e[1]);var r=(0,u.reset)(this.offsetRotateMatrix_);0!==i&&(0,u.rotate)(r,-i),this.setUniformMatrixValue(m.OFFSET_SCALE_MATRIX,(0,h.fromTransform)(this.tmpMat4_,n)),this.setUniformMatrixValue(m.OFFSET_ROTATION_MATRIX,(0,h.fromTransform)(this.tmpMat4_,r)),this.setUniformFloatValue(m.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(m.ZOOM,t.viewState.zoom),this.setUniformFloatValue(m.RESOLUTION,t.viewState.resolution)},b.prototype.applyUniforms=function(e){var i,n=this.getGL(),r=0;this.uniforms_.forEach(function(t){if((i="function"==typeof t.value?t.value(e):t.value)instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData)t.texture||(t.prevValue=void 0,t.texture=n.createTexture()),n.activeTexture(n["TEXTURE"+r]),n.bindTexture(n.TEXTURE_2D,t.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i instanceof HTMLImageElement&&!i.complete||t.prevValue===i||(t.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),n.uniform1i(this.getUniformLocation(t.name),r++);else if(Array.isArray(i)&&6===i.length)this.setUniformMatrixValue(t.name,(0,h.fromTransform)(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:return void n.uniform2f(this.getUniformLocation(t.name),i[0],i[1]);case 3:return void n.uniform3f(this.getUniformLocation(t.name),i[0],i[1],i[2]);case 4:return void n.uniform4f(this.getUniformLocation(t.name),i[0],i[1],i[2],i[3]);default:return}else"number"==typeof i&&n.uniform1f(this.getUniformLocation(t.name),i)}.bind(this))},b.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0)},b.prototype.compileShader=function(t,e){var i=this.getGL(),n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n},b.prototype.getProgram=function(t,e){var i=this.getGL(),n=this.compileShader(t,i.FRAGMENT_SHADER),r=this.compileShader(e,i.VERTEX_SHADER);this.shaderCompileErrors_=null,i.getShaderInfoLog(n)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+i.getShaderInfoLog(n)),i.getShaderInfoLog(r)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+i.getShaderInfoLog(r));var o=i.createProgram();return i.attachShader(o,n),i.attachShader(o,r),i.linkProgram(o),o},b.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},b.prototype.getUniformLocation=function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},b.prototype.getAttributeLocation=function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},b.prototype.makeProjectionTransform=function(t,e){var i=t.size,n=t.viewState.rotation,r=t.viewState.resolution,o=t.viewState.center;return(0,u.reset)(e),(0,u.compose)(e,0,0,2/(r*i[0]),2/(r*i[1]),-n,-o[0],-o[1]),e},b.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},b.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},b.prototype.enableAttributeArray_=function(t,e,i,n,r){var o=this.getAttributeLocation(t);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,e,i,!1,n,r))},b.prototype.enableAttributes=function(t){for(var e=j(t),i=0,n=0;n<t.length;n++){var r=t[n];this.enableAttributeArray_(r.name,r.size,r.type||a.FLOAT,e,i),i+=r.size*x(r.type)}},b.prototype.handleWebGLContextLost=function(){(0,r.clear)(this.bufferCache_),this.currentProgram_=null},b.prototype.handleWebGLContextRestored=function(){},b.prototype.createTexture=function(t,e,i){var n=this.getGL(),r=i||n.createTexture(),o=n.RGBA,s=n.RGBA,a=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,r),e?n.texImage2D(n.TEXTURE_2D,0,o,s,a,e):n.texImage2D(n.TEXTURE_2D,0,o,t[0],t[1],0,s,a,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r},b);function b(t){var e=_.call(this)||this,i=t||{};e.boundHandleWebGLContextLost_=e.handleWebGLContextLost.bind(e),e.boundHandleWebGLContextRestored_=e.handleWebGLContextRestored.bind(e),e.canvas_=document.createElement("canvas"),e.canvas_.style.position="absolute",e.canvas_.style.left="0",e.gl_=(0,a.getContext)(e.canvas_);var n=e.getGL();if(e.bufferCache_={},(e.currentProgram_=null,l.assert)((0,d.includes)((0,a.getSupportedExtensions)(),"OES_element_index_uint"),63),n.getExtension("OES_element_index_uint"),e.canvas_.addEventListener(o.default.LOST,e.boundHandleWebGLContextLost_),e.canvas_.addEventListener(o.default.RESTORED,e.boundHandleWebGLContextRestored_),e.offsetRotateMatrix_=(0,u.create)(),e.offsetScaleMatrix_=(0,u.create)(),e.tmpMat4_=(0,h.create)(),e.uniformLocations_={},e.attribLocations_={},e.uniforms_=[],i.uniforms)for(var r in i.uniforms)e.uniforms_.push({name:r,value:i.uniforms[r]});return e.postProcessPasses_=i.postProcesses?i.postProcesses.map(function(t){return new s.default({webGlContext:n,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})}):[new s.default({webGlContext:n})],e.shaderCompileErrors_=null,e.startTime_=Date.now(),e}function j(t){for(var e=0,i=0;i<t.length;i++){var n=t[i];e+=n.size*x(n.type)}return e}function x(t){switch(t){case y.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case y.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case y.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case y.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}i.default=v},{"../Disposable.js":12,"../array.js":44,"../asserts.js":45,"../obj.js":203,"../transform.js":311,"../util.js":313,"../vec/mat4.js":314,"../webgl.js":315,"../webgl/ContextEventType.js":317,"./PostProcessingPass.js":319}],319:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=(r.prototype.getGL=function(){return this.gl_},r.prototype.init=function(t){var e,i,n,r=this.getGL(),o=[r.drawingBufferWidth*this.scaleRatio_,r.drawingBufferHeight*this.scaleRatio_];r.bindFramebuffer(r.FRAMEBUFFER,this.getFrameBuffer()),r.viewport(0,0,o[0],o[1]),this.renderTargetTextureSize_&&this.renderTargetTextureSize_[0]===o[0]&&this.renderTargetTextureSize_[1]===o[1]||(this.renderTargetTextureSize_=o,e=r.RGBA,i=r.RGBA,n=r.UNSIGNED_BYTE,r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.texImage2D(r.TEXTURE_2D,0,e,o[0],o[1],0,i,n,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.renderTargetTexture_,0))},r.prototype.apply=function(t,e){var i=this.getGL(),n=t.size;i.bindFramebuffer(i.FRAMEBUFFER,e?e.getFrameBuffer():null),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.renderTargetTexture_),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),i.useProgram(this.renderTargetProgram_),i.enableVertexAttribArray(this.renderTargetAttribLocation_),i.vertexAttribPointer(this.renderTargetAttribLocation_,2,i.FLOAT,!1,0,0),i.uniform2f(this.renderTargetUniformLocation_,n[0],n[1]),i.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(t),i.drawArrays(i.TRIANGLES,0,6)},r.prototype.getFrameBuffer=function(){return this.frameBuffer_},r.prototype.applyUniforms=function(e){var i,n=this.getGL(),r=1;this.uniforms_.forEach(function(t){if((i="function"==typeof t.value?t.value(e):t.value)instanceof HTMLCanvasElement||i instanceof ImageData)t.texture||(t.texture=n.createTexture()),n.activeTexture(n["TEXTURE"+r]),n.bindTexture(n.TEXTURE_2D,t.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,i.width,i.height,0,n.UNSIGNED_BYTE,new Uint8Array(i.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),n.uniform1i(t.location,r++);else if(Array.isArray(i))switch(i.length){case 2:return void n.uniform2f(t.location,i[0],i[1]);case 3:return void n.uniform3f(t.location,i[0],i[1],i[2]);case 4:return void n.uniform4f(t.location,i[0],i[1],i[2],i[3]);default:return}else"number"==typeof i&&n.uniform1f(t.location,i)})},r);function r(e){this.gl_=e.webGlContext;var i=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=i.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=i.createFramebuffer();var t=i.createShader(i.VERTEX_SHADER);i.shaderSource(t,e.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),i.compileShader(t);var n=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(n,e.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n"),i.compileShader(n),this.renderTargetProgram_=i.createProgram(),i.attachShader(this.renderTargetProgram_,t),i.attachShader(this.renderTargetProgram_,n),i.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),i.bufferData(i.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),i.STATIC_DRAW),this.renderTargetAttribLocation_=i.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(t){this.uniforms_.push({value:e.uniforms[t],location:i.getUniformLocation(this.renderTargetProgram_,t)})}.bind(this))}i.default=n},{}],320:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=t("../array.js"),r=new Uint8Array(4),o=(s.prototype.setSize=function(t){(0,n.equals)(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())},s.prototype.getSize=function(){return this.size_},s.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},s.prototype.readAll=function(){var t,e;return this.dataCacheDirty_&&(t=this.size_,(e=this.helper_.getGL()).bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1),this.data_},s.prototype.readPixel=function(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r;this.readAll();var i=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return r[0]=this.data_[4*i],r[1]=this.data_[4*i+1],r[2]=this.data_[4*i+2],r[3]=this.data_[4*i+3],r},s.prototype.getTexture=function(){return this.texture_},s.prototype.getFramebuffer=function(){return this.framebuffer_},s.prototype.updateSize_=function(){var t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)},s);function s(t,e){var i=(this.helper_=t).getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}i.default=o},{"../array.js":44}],321:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.create=function(){return new Worker(r)};var n=new Blob(['var e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n="GENERATE_BUFFERS",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};'],{type:"application/javascript"}),r=URL.createObjectURL(n)},{}],322:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createElementNS=a,i.getAllTextContent=function(t,e){return r(t,e,[]).join("")},i.getAllTextContent_=r,i.isDocument=function(t){return"documentElement"in t},i.getAttributeNS=function(t,e,i){return t.getAttributeNS(e,i)||""},i.parse=function(t){return(new DOMParser).parseFromString(t,"application/xml")},i.makeArrayExtender=function(r,o){return function(t,e){var i,n=r.call(void 0!==o?o:this,t,e);void 0!==n&&(i=e[e.length-1],(0,s.extend)(i,n))}},i.makeArrayPusher=function(n,r){return function(t,e){var i=n.call(void 0!==r?r:this,t,e);void 0!==i&&e[e.length-1].push(i)}},i.makeReplacer=function(n,r){return function(t,e){var i=n.call(void 0!==r?r:this,t,e);void 0!==i&&(e[e.length-1]=i)}},i.makeObjectPropertyPusher=function(s,a,l){return function(t,e){var i,n,r,o=s.call(void 0!==l?l:this,t,e);void 0!==o&&(i=e[e.length-1],(n=(r=void 0)!==a?a:t.localName)in i?r=i[n]:(r=[],i[n]=r),r.push(o))}},i.makeObjectPropertySetter=function(n,r,o){return function(t,e){var i=n.call(void 0!==o?o:this,t,e);void 0!==i&&(e[e.length-1][void 0!==r?r:t.localName]=i)}},i.makeChildAppender=function(n,r){return function(t,e,i){n.call(void 0!==r?r:this,t,e,i),i[i.length-1].node.appendChild(t)}},i.makeArraySerializer=function(r,t){var o,s;return function(t,e,i){var n;void 0===o&&(o={},(n={})[t.localName]=r,o[t.namespaceURI]=n,s=l(t.localName)),u(o,s,e,i)}},i.makeSimpleNodeFactory=l,i.makeSequence=function(t,e){for(var i=e.length,n=new Array(i),r=0;r<i;++r)n[r]=t[e[r]];return n},i.makeStructureNS=function(t,e,i){var n,r,o=void 0!==i?i:{};for(n=0,r=t.length;n<r;++n)o[t[n]]=e;return o},i.parseNode=o,i.pushParseAndPop=function(t,e,i,n,r){return n.push(t),o(e,i,n,r),n.pop()},i.serialize=u,i.pushSerializeAndPop=function(t,e,i,n,r,o,s){return r.push(t),u(e,i,n,r,o,s),r.pop()},i.registerXMLSerializer=function(t){h=t},i.getXMLSerializer=function(){return void 0===h&&"undefined"!=typeof XMLSerializer&&(h=new XMLSerializer),h},i.registerDocument=function(t){c=t},i.getDocument=d,i.OBJECT_PROPERTY_NODE_FACTORY=i.XML_SCHEMA_INSTANCE_URI=void 0;var s=t("./array.js");function a(t,e){return d().createElementNS(t,e)}function r(t,e,i){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?i.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(t.nodeValue);else for(var n=void 0,n=t.firstChild;n;n=n.nextSibling)r(n,e,i);return i}function l(t,o){var s=t;return function(t,e,i){var n=e[e.length-1].node,r=s;return void 0===r&&(r=i),a(void 0!==o?o:n.namespaceURI,r)}}i.XML_SCHEMA_INSTANCE_URI="http://www.w3.org/2001/XMLSchema-instance";var n=l();function o(t,e,i,n){for(var r=e.firstElementChild;r;r=r.nextElementSibling){var o,s=t[r.namespaceURI];void 0===s||void 0!==(o=s[r.localName])&&o.call(n,r,i)}}function u(t,e,i,n,r,o){for(var s,a,l=(void 0!==r?r:i).length,u=0;u<l;++u)void 0!==(s=i[u])&&void 0!==(a=e.call(void 0!==o?o:this,s,n,void 0!==r?r[u]:void 0))&&t[a.namespaceURI][a.localName].call(o,a,s,n)}i.OBJECT_PROPERTY_NODE_FACTORY=n;var h=void 0;var c=void 0;function d(){return void 0===c&&"undefined"!=typeof document&&(c=document.implementation.createDocument("","",null)),c}},{"./array.js":44}],323:[function(t,e,i){"use strict";e.exports=r;var n=t("ieee754");function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var o=4294967296,s=1/o,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function u(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function h(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;t<=r;r--)i.buf[r+n]=i.buf[r]}function c(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function g(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function m(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function y(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function _(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function v(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function j(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,o=this.pos;this.type=7&n,t(r,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=b(this.buf,this.pos)+b(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=b(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i=this.buf,n=127&(e=i[this.pos++]);return e<128?n:(n|=(127&(e=i[this.pos++]))<<7,e<128?n:(n|=(127&(e=i[this.pos++]))<<14,e<128?n:(n|=(127&(e=i[this.pos++]))<<21,e<128?n:function(t,e,i){var n,r=i.buf,o=(112&(n=r[i.pos++]))>>4;if(n<128)return u(t,o,e);if(o|=(127&(n=r[i.pos++]))<<3,n<128)return u(t,o,e);if(o|=(127&(n=r[i.pos++]))<<10,n<128)return u(t,o,e);if(o|=(127&(n=r[i.pos++]))<<17,n<128)return u(t,o,e);if(o|=(127&(n=r[i.pos++]))<<24,n<128)return u(t,o,e);if(o|=(1&(n=r[i.pos++]))<<31,n<128)return u(t,o,e);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(e=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t,e,i,n=this.readVarint()+this.pos,r=this.pos;return 12<=(this.pos=n)-r&&a?(t=this.buf,e=r,i=n,a.decode(t.subarray(e,i))):function(t,e,i){for(var n="",r=e;r<i;){var o,s,a,l=t[r],u=null,h=239<l?4:223<l?3:191<l?2:1;if(i<r+h)break;1===h?l<128&&(u=l):2===h?128==(192&(o=t[r+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===h?(o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&((u=(15&l)<<12|(63&o)<<6|63&s)<=2047||55296<=u&&u<=57343)&&(u=null)):4===h&&(o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||1114112<=u)&&(u=null)),null===u?(u=65533,h=1):65535<u&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),r+=h}return n}(this.buf,r,n)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var i=l(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;127<this.buf[this.pos++];);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e,i=this.length||16;i<this.pos+t;)i*=2;i!==this.length&&((e=new Uint8Array(i)).set(this.buf),this.buf=e,this.length=i)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),j(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),j(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),j(this.buf,-1&t,this.pos),j(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),j(this.buf,-1&t,this.pos),j(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeVarint:function(t){268435455<(t=+t||0)||t<0?function(t,e){var i,n,r,o,s,a,l;if(0<=t?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:n=n+1|(i=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),a=i,(l=e).buf[l.pos++]=127&a|128,a>>>=7,l.buf[l.pos++]=127&a|128,a>>>=7,l.buf[l.pos++]=127&a|128,a>>>=7,l.buf[l.pos++]=127&a|128,a>>>=7,l.buf[l.pos]=127&a,s=(7&(r=n))<<4,(o=e).buf[o.pos++]|=s|((r>>>=3)?128:0),r&&(o.buf[o.pos++]=127&r|((r>>>=7)?128:0),r&&(o.buf[o.pos++]=127&r|((r>>>=7)?128:0),r&&(o.buf[o.pos++]=127&r|((r>>>=7)?128:0),r&&(o.buf[o.pos++]=127&r|((r>>>=7)?128:0),r&&(o.buf[o.pos++]=127&r)))))}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,o=0;o<e.length;o++){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!r){56319<n||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;128<=i&&h(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;128<=n&&h(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,r.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,_,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},{ieee754:2}],324:[function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r,o;o=function(){function f(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function u(t,e){return t<e?-1:e<t?1:0}function t(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function p(t,e){y(t,0,t.children.length,e,t)}function y(t,e,i,n,r){(r=r||m(null)).minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<i;o++){var s=t.children[o];d(r,t.leaf?n(s):s)}return r}function d(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function o(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function _(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function g(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function l(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,i,n,r){for(var o,s,a,l=[e,i];l.length;){(i=l.pop())-(e=l.pop())<=n||(o=e+Math.ceil((i-e)/n/2)*n,a=r,function t(e,i,n,r,o){for(;n<r;){var s,a,l,u,h;600<r-n&&(s=r-n+1,a=i-n+1,l=Math.log(s),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1),t(e,i,Math.max(n,Math.floor(i-a*u/s+h)),Math.min(r,Math.floor(i+(s-a)*u/s+h)),o));var c=e[i],d=n,p=r;for(f(e,n,i),0<o(e[r],c)&&f(e,n,r);d<p;){for(f(e,d,p),d++,p--;o(e[d],c)<0;)d++;for(;0<o(e[p],c);)p--}0===o(e[n],c)?f(e,n,p):f(e,++p,r),p<=i&&(n=p+1),i<=p&&(r=p-1)}}(s=t,o,e||0,i||s.length-1,a||u),l.push(e,o,o,i))}}return t.prototype.all=function(){return this._all(this.data,[])},t.prototype.search=function(t){var e=this.data,i=[];if(!l(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;l(t,a)&&(e.leaf?i.push(s):h(t,a)?this._all(s,i):r.push(s))}e=r.pop()}return i},t.prototype.collides=function(t){var e=this.data;if(!l(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],o=e.leaf?this.toBBox(r):r;if(l(t,o)){if(e.leaf||h(t,o))return!0;i.push(r)}}e=i.pop()}return!1},t.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i,n=this._build(t.slice(),0,t.length-1,0);return this.data.children.length?this.data.height===n.height?this._splitRoot(this.data,n):(this.data.height<n.height&&(i=this.data,this.data=n,n=i),this._insert(n,this.data.height-n.height-1,!0)):this.data=n,this},t.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},t.prototype.clear=function(){return this.data=m([]),this},t.prototype.remove=function(t,e){if(!t)return this;for(var i,n,r,o=this.data,s=this.toBBox(t),a=[],l=[];o||a.length;){if(o||(o=a.pop(),n=a[a.length-1],i=l.pop(),r=!0),o.leaf){var u=function(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}(t,o.children,e);if(-1!==u)return o.children.splice(u,1),a.push(o),this._condense(a),this}r||o.leaf||!h(o,s)?n?(i++,o=n.children[i],r=!1):o=null:(a.push(o),l.push(i),i=0,o=(n=o).children[0])}return this},t.prototype.toBBox=function(t){return t},t.prototype.compareMinX=function(t,e){return t.minX-e.minX},t.prototype.compareMinY=function(t,e){return t.minY-e.minY},t.prototype.toJSON=function(){return this.data},t.prototype.fromJSON=function(t){return this.data=t,this},t.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},t.prototype._build=function(t,e,i,n){var r,o=i-e+1,s=this._maxEntries;if(o<=s)return p(r=m(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(r=m([])).leaf=!1,r.height=n;var a=Math.ceil(o/s),l=a*Math.ceil(Math.sqrt(s));v(t,e,i,l,this.compareMinX);for(var u=e;u<=i;u+=l){var h=Math.min(u+l-1,i);v(t,u,h,a,this.compareMinY);for(var c=u;c<=h;c+=a){var d=Math.min(c+a-1,h);r.children.push(this._build(t,c,d,n-1))}}return p(r,this.toBBox),r},t.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=_(l),h=(c=t,d=l,(Math.max(d.maxX,c.maxX)-Math.min(d.minX,c.minX))*(Math.max(d.maxY,c.maxY)-Math.min(d.minY,c.minY))-u);h<o?(o=h,r=u<r?u:r,s=l):h===o&&u<r&&(r=u,s=l)}e=s||e.children[0]}var c,d;return e},t.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),d(o,n);0<=e&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},t.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),s=m(i.children.splice(o,i.children.length-o));s.height=i.height,s.leaf=i.leaf,p(i,this.toBBox),p(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},t.prototype._splitRoot=function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,p(this.data,this.toBBox)},t.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,o,s,a,l,u,h=1/0,c=1/0,d=e;d<=i-e;d++){var p=y(t,0,d,this.toBBox),f=y(t,d,i,this.toBBox),g=(r=p,o=f,0,s=Math.max(r.minX,o.minX),a=Math.max(r.minY,o.minY),l=Math.min(r.maxX,o.maxX),u=Math.min(r.maxY,o.maxY),Math.max(0,l-s)*Math.max(0,u-a)),m=_(p)+_(f);g<h?(h=g,n=d,c=m<c?m:c):g===h&&m<c&&(c=m,n=d)}return n||i-e},t.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:o,r=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},t.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,o=y(t,0,e,r),s=y(t,i-e,i,r),a=g(o)+g(s),l=e;l<i-e;l++){var u=t.children[l];d(o,t.leaf?r(u):u),a+=g(o)}for(var h=i-e-1;e<=h;h--){var c=t.children[h];d(s,t.leaf?r(c):c),a+=g(s)}return a},t.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;0<=n;n--)d(e[n],t)},t.prototype._condense=function(t){for(var e=t.length-1,i=void 0;0<=e;e--)0===t[e].children.length?0<e?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():p(t[e],this.toBBox)},t},"object"===((r=void 0)===i?"undefined":n(i))&&void 0!==e?e.exports=o():"function"==typeof define&&define.amd?define(o):(r=r||self).RBush=o()},{}]},{},[1]),function(L,F){"use strict";var e;function i(t){var e=null,i=!0,a=L.extend(!0,{},t),r=250,n={};function o(t,e){var i=L("body");a.utils.trigger(i,t,e)}function l(){return a.utils.t.apply(this,arguments)}function s(){var t=window.location.hash.replace("#",""),e=L("#p-donate"),i=L("#p-loading"),n=i.find(".progressbar"),r=L(".progress-label");L(".section, .searchbtn").addClass("ui-corner-all"),L(".view").addClass("ui-corner-br ui-corner-tr"),L(".search-field").addClass("ui-corner-bl ui-corner-tl"),L("#p-poll").dialog({closeText:l("close"),modal:!0,title:l("poll"),width:500,open:function(){E("poll")},close:function(){P()},autoOpen:"poll"==t}),a.system.raterMasterSw&&!a.context.session.userHasRatedOne&&j(!1),L("#p-contact").dialog({closeText:l("close"),modal:!0,title:l("contactUs"),width:500,open:function(){E("contact")},close:function(){P()},autoOpen:"contact"==t}),L(".contact-button").button({icons:{secondary:"ui-icon-mail-closed"}}),e.find("input.dont-show-again").prop("checked",M("p-donate")),L(".help-1").find("input.dont-show-again").prop("checked",M("help-1")),e.dialog({closeText:l("close"),modal:!0,title:l("donate"),width:750,open:function(){E("donate")},close:function(){P()},autoOpen:"donate"==t}),e.find(".progressbar").progressbar({value:a.donations.total,max:a.donations.max}),n.progressbar({value:!1,change:function(){r.text(Math.round(n.progressbar("value"))+"%")},complete:function(){r.text("Complete!")}}),L("#p-about").dialog({closeText:l("close"),modal:!0,title:l("about"),width:"70%",open:function(){E("about")},close:function(){P()},autoOpen:"about"==t}),L("body").on("history.indexchanged",function(t,e){var i=e.data;R(i.currentIndex,i.maxIndex)}),L("#p-info").dialog({closeText:l("close"),modal:!0,title:"Information",width:750,autoOpen:!0}),L("#csvFeatures").hide(),L("#language").find(">dt>a").button({icons:{secondary:"ui-icon-triangle-1-s"}}),a.system.facebookEnabled&&(window.fbAsyncInit=function(){FB.init({appId:a.system.facebookAppId,xfbml:!0,version:"v2.2"})},L.fn.getXDomain({url:"http://connect.facebook.net/"+a.context.locale+"/sdk.js"})),a.context.isDevEnv||(window.___gcfg={lang:a.context.googlePlusLocale,parsetags:"onload"},L.fn.getXDomain({url:"https://apis.google.com/js/plusone.js"})),i.dialog({dialogClass:"no-close",modal:!0,title:l("loading"),autoOpen:!0}),L(".ui-widget-overlay").css({backgroundImage:"none",opacity:.7})}function u(t){return t.closest(".converter-container").hasClass("source")?"source":"destination"}function h(){var t=L("a.snippet"),e=L("#converter"),i=L("body");t.on("mouseenter",function(){L("body").append('<div id="Tip" style="z-index:9999;" class="ui-corner-all"><img src="'+this.href+'" alt="'+this.href+'"></div>')}),t.on("mousemove",function(t){L("#Tip").css({left:t.pageX+16,top:t.pageY+16}).show()}),t.on("mouseout",function(){L("#Tip").remove()}),t.click(function(t){t.preventDefault()}),L(".search-crs").click(function(t){var e=u(L(this));t.preventDefault(),L("#select").val(e),L("#p-research").dialog("open")}),e.on("converter.info",w),e.on("click",".show-p-new",function(t){var e=u(L(this));t.preventDefault(),L('#new-form input[name="target"]').val(e),L("#p-new").dialog("open")}),i.on("click","#view-reference",function(t){var e="http://spatialreference.org/ref/?search="+encodeURIComponent(L("#find-reference").val());t.preventDefault(),window.open(e)}),i.on("submit","#reference-form",function(t){t.preventDefault(),L("#view-reference").click()}),L("#crsResult").on("change",function(t){!function(t){var e=L("#select").val();L("#closeSearch").prop("checked")&&L("#p-research").dialog("close");App.TWCCConverter.setSelection(e,t)}(L(t.target).val())}),L("#research").click(function(t){var e;t.preventDefault(),(e=L("#crsResult")).html('<option value="#" class="disabledoption">'+l("loading")+"</option>").prop("disabled",!0),L.post(a.system.httpServer+"/"+a.system.dirWsIncludes+"c.php",{l:a.context.languageCode,i:L("#crsCountry").val(),c:L("#crsCode").val(),n:L("#crsName").val(),f:""}).done(function(t){e.html(""),L(t).length?(e.prop("disabled",!1),L.each(t,function(i,t){L.each(t,function(t,e){a.utils.addOptionToSelect(i,t,L("#crsResult"),e.def)})})):e.append(L("<option>",{val:"",text:l("resultEmpty"),classname:"disabledoption"}))}).fail(function(){e.html(""),e.append(L("<option>",{val:"",text:l("resultEmpty"),classname:"disabledoption"}))})}),new F("#converter .octicon-clippy",{text:function(t){var e=L(t).closest(".converter-container");if(e.length)return e.converter("value").toString()}}).on("success",function(t){L(t.trigger).animate({opacity:.3},500,function(){L(this).animate({opacity:1},500)}),o("clipboard.aftercopy")})}function c(){L("#help").animate({opacity:"hide"},r),L(".crs-list").first().btOn()}function d(t){I(t),o("ui.csv_changed",t)}function p(){L(".convention").click(function(t){t.preventDefault(),L("#p-convention_help").dialog("open")}),L("#full-screen").click(function(t){t.preventDefault(),o("ui.full_screen")}),L("#auto-zoom-toggle").click(function(){a.utils.enableAutoZoom(L(this).is(":checked"))}),L('input[name="csv"]').click(function(){d(!!+L(this).val())}),L('input[name="convention"]').click(function(){var t;t=!!+L(this).val(),i=t,o("ui.convergence_changed")}),L("body").on("converterset.csv_changed main.ready",function(t,e){var i,n=void 0===e.data?e.csv:e.data.csv;(i=n)!==!!+L('input[name="csv"]:checked').val()&&(L('input[name="csv"][value="'+ +i+'"]').prop("checked",!0),L(".csv-radio").buttonset("refresh")),I(n)})}function f(){var t=L("body");L(".toggle-next").click(function(t){t.preventDefault(),L(this).parent().find(".toogle-me").toggle()}),L(document).on("fullscreenchange",function(){O(),L(document).fullScreen()?L(".trsp-panel, .spare, #converter, #h-container").fadeOut():L(".trsp-panel, .spare, #converter, #h-container").fadeIn()}),L(document).on("mousemove",function(t){var e,i;e=t.target,i=".trsp-panel, #converter",L(document).fullScreen()&&(L(i).is(":hidden")?L(i).fadeIn():L(e).closest(i).length?clearInterval(n[i]):(clearInterval(n[i]),n[i]=setTimeout(function(){L(document).fullScreen()&&L(i).fadeOut()},1e3)))}),t.on("click",".show-p-poll",function(t){t.preventDefault(),j()}),t.on("mousedown","#view-map, .donate_btn, .about, converter.info, .convert-button, .contact, .search-crs, .show-p-new",function(){O()}),t.on("map.metrics_changed",function(t,e){v(e.data)}),t.on("map.tiles_loaded",function(){var t;t=a.system.adsense.parameters,window.adsbygoogle=window.adsbygoogle||[],L("ins.adsbygoogle").each(function(){window.adsbygoogle.push({params:L.extend({},t)})})}),t.on("converter.changed",function(t,e){var i,n;i=e.data.magneticDeclinationInDegrees,n=void 0===i?"":a.math.round(i,4).toString(),L("#magneticDeclinationContainer").text(n)}),L("#p-donate").find("input.dont-show-again").on("change",function(){C("p-donate",L(this)[0].checked)}),L(".donate_btn").click(function(t){t.preventDefault(),L("#p-donate").dialog("open")}),L(".about").click(function(t){t.preventDefault(),L("#p-about").dialog("open")}),t.one("main.ready",function(){setTimeout(y,800)}),t.on("main.start",_),t.on("main.failed",{message:": failure! "+l("contactUs"),className:"failure"},function(){_.apply(this,arguments),y()}),t.on("main.succeeded",{message:": success.",className:"success"},function(){var t=L("#p-loading").find(".progressbar"),e=t.progressbar("value")||0;_.apply(this,arguments),t.progressbar("value",e+20)}),t.on("click",".ui-widget-overlay",function(){O()})}function g(t){L(".contact").click(function(t){t.preventDefault(),L("#p-contact").dialog("open")}),t||(L("#contact-form").on("submit",function(t){t.preventDefault(),L("#send-message").click()}),L("#send-message").click(function(t){t.preventDefault(),L("#p-contact").dialog("close"),function(){if(L("#message").val().length<1)return alert(l("messageNotSent")+"empty msg."),L("#p-contact").dialog("open"),!1;if(L("#email").val().length<1)return alert(l("messageWrongEmail")),L("#p-contact").dialog("open"),!1;return!0}()&&a.utils.sendMsg(L("#message").val(),L("#email").val(),T)}))}function m(){var t,e,i,n;L(".previous.history").button({icons:{primary:"ui-icon-seek-first"},text:!1}),L("#help").button({icons:{primary:"ui-icon-help"},text:!1}),L(".next.history").button({icons:{primary:"ui-icon-seek-end"},text:!1}),L(".source .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-s"}}),L(".destination .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-n"}}),L("#converter").draggable({handle:".drag-handle"}),L('input[type="text"]',"#p-research").addClass("ui-corner-all"),L("#p-new").dialog({closeText:l("close"),modal:!0,title:l("customSystem"),width:400,autoOpen:!1}),L("#p-crs").dialog({closeText:l("close"),modal:!0,title:l("systemDefinition"),width:500,autoOpen:!1}),L("#p-research").dialog({closeText:l("close"),modal:!0,title:l("research"),width:400,autoOpen:!1}),R(0,0),L(".button-set").buttonset(),L("#auto-zoom-toggle").button({icons:{primary:"ui-icon-zoomin"},text:!1,disabled:!0}),L("#full-screen").button({icons:{primary:"ui-icon-arrow-4-diag"},text:!1}).closest("p").toggle(null!==L(document).fullScreen()),L("#o-container").accordion({collapsible:!0,active:!1,heightStyle:"content",icons:{header:"ui-icon-gear"}}),L("#p-convention_help").dialog({closeText:l("close"),modal:!0,title:l("conventionTitle"),width:"840px",autoOpen:!1}),t={trigger:"none",showTip:function(t){L(t).fadeIn(r)},hideTip:function(t,e){L(t).animate({opacity:0},r,e)},shrinkToFit:!0,padding:"0px",windowMargin:"0px",fill:"rgba(0, 0, 0, .9)",cornerRadius:10,strokeWidth:1,shadow:!0,shadowOffsetX:3,shadowOffsetY:3,shadowBlur:3,shadowColor:"rgba(6,6,6,.5)",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#666",strokeWidth:1},positions:["left","top"],cssStyles:{color:"#FFF"},closeWhenOthersOpen:!0,clickAnywhereToClose:!1},e=L(".crs-list"),L.extend(L.bt.defaults,t),e.first().bt({contentSelector:"$('.help-1')"}),e.last().bt({contentSelector:"$('.help-2')"}),L(".source .container").bt({contentSelector:"$('.help-3')"}),L(".source .convert-button").bt({contentSelector:"$('.help-4')"}),L(".next_button").button({icons:{secondary:"ui-icon-seek-next"}}),s(),h(),p(),L(".close_button, .help-4 .next_button").click(function(t){t.preventDefault(),L("#help").animate({opacity:"show"},r)}),L(".next_button").click(function(t){t.preventDefault()}),L(".close_button",".help-1").click(function(){L(".crs-list").first().btOff()}),L(".close_button",".help-2").click(function(){L(".crs-list").last().btOff()}),L(".close_button",".help-3").click(function(){L(".source .container").btOff()}),L(".close_button, .next_button",".help-4").click(function(){L(".source .convert-button").btOff()}),L(".next_button",".help-1").click(function(){L(".crs-list").last().btOn()}),L(".next_button",".help-2").click(function(){L(".source .container").btOn()}),L(".next_button",".help-3").click(function(){L(".source .convert-button").btOn()}),L(".help-1").find("input.dont-show-again").on("change",function(){C("help-1",L(this)[0].checked)}),L("#help").click(function(){event.preventDefault(),c()}),f(),g(),i=L(".dropdown dd ul"),(n=L(".dropdown dt a")).click(function(t){t.preventDefault(),i.slideToggle(200)}),i.find("li a").click(function(t){var e;t.preventDefault(),e=L(this).html(),L(this).parent().find("span.value").text(),n.find("span").html(e),i.hide(),document.location.href=L(this).prop("href")}),L(document).click(function(t){L(t.target).parents().hasClass("dropdown")||i.hide()}),L(document).keyup(function(t){switch(t.keyCode){case 27:t.preventDefault(),O();break;case 122:t.preventDefault(),o("ui.full_screen")}})}function y(){var t=L("#p-loading");t.find(".failure").length?t.closest(".no-close").find(".ui-dialog-titlebar-close").show():(t.dialog("close"),M("p-donate")||a.context.GET.isSetNoDonate||L("#p-donate").dialog("open")),L(".ui-widget-overlay").removeAttr("style")}function _(t,e){var i,n,r=e.data,o=r.name,s=L("#p-loading .logs"),a="loading-"+o.toLowerCase().replace(/\s/gi,"-"),l=t.data,u=r.message?": "+r.message:l?l.message:void 0;s.find("."+a).length||(n=L("<div>",{class:a}).text("Loading "+o),s.append(n)),i=s.find("."+a),l&&u&&l.className&&i.length&&!i.hasClass(l.className)&&i.addClass(l.className).append(u)}function v(t){var e,i,n,r,o,s;void 0!==t&&(r=t.length,o=l("unitMeter"),s=0,r&&void 0!==r?(999<r&&(o=l("unitKilometer"),r/=1e3,s=1),L("#lengthContainer").text(a.math.round(r,s).toString()+o)):L("#lengthContainer").text("-"+o),e=t.area,i=l("unitMeter")+"<sup>2</sup>",n=0,e&&void 0!==e?(999999<e&&(i=l("unitKilometer")+"<sup>2</sup>",e/=1e6,n=1),L("#areaContainer").html(a.math.round(e,n).toString()+i)):L("#areaContainer").html("-"+i))}function b(){return'<div class="loading"><img src="'+a.system.dirWsImages+'loading.gif" alt="" width="35" height="35">'+l("loading")+"</div>"}function j(t){t=void 0===t||t,L("#poll-info").html(b()),t&&O(),L("#p-poll").dialog("open"),x()}function x(t){t=t||"",L("#poll-info").html(b()),L.post(a.system.dirWsModules+"rater/forms.php","rater=true&"+t,S)}function S(t){var e=L("#poll-info");e.html(t),e.find("form").each(function(){L(this).on("submit",function(t){t.preventDefault(),x(L(this).serialize())}),g(!0)})}function w(t,e){var i=L("#crs-info");i.html(b()),L.post(a.system.dirWsIncludes+"crs_info.php",{c:e.srsCode,d:e.definitionString,l:a.context.languageCode},function(t){i.html(t)}),L("#p-crs").dialog("open")}function P(){window.location.hash=""}function E(t){window.location.hash="#"+t}function T(t){switch(t){case"1":alert(l("messageSent"));break;case"-3":alert(l("messageWrongEmail"));break;default:alert(l("messageNotSent")+t)}"1"==t?(L("#email").val(""),L("#message").val("")):L("#p-contact").dialog("open")}function O(){L(".crs-list, .source .container, .source .convert-button").each(function(){L(this).btOff()}),L("#help").animate({opacity:"show"},r),L("#p-new").dialog("close"),L("#p-contact").dialog("close"),L("#p-about").dialog("close"),L("#p-crs").dialog("close"),L("#p-poll").dialog("close"),L("#p-info").dialog("close"),L("#p-donate").dialog("close"),L("#p-research").dialog("close"),L("#p-convention_help").dialog("close")}function C(t,e){a.utils.setPreferenceCookie(t,e)}function M(t){return a.utils.getPreferenceCookie(t)}function I(t){t=!!t,L("#manualFeatures").toggle(!t),L("#csvFeatures").toggle(t),t?(L("#auto-zoom-toggle").button("enable"),L(".convention-radio").buttonset("disable"),v()):(L("#auto-zoom-toggle").button("disable"),L(".convention-radio").buttonset("enable"))}function R(t,e){var i=t<e,n=0<t;L(".previous.history").button("option","disabled",!n),L(".next.history").button("option","disabled",!i)}function k(){e.reject(l("pleaseDisableYourAdblock"))}function A(){e.resolve()}return e=function(){return a.utils.newDeferred.apply(this,arguments)}("UI"),m(),void 0===window.blockAdBlock?k():window.blockAdBlock.onDetected(k).onNotDetected(A),{promise:e.promise(),getConvergenceConvention:function(){return i},startHelp:function(){M("help-1")||c()},setCsvMode:d}}void 0===window.TWCCUi&&(window.TWCCUi={getInstance:function(t){return e=e||i(t)}})}(jQuery,ClipboardJS),function(O){"use strict";var e,i;void 0===window.TWCCConverter&&(i=function(t){var e,i,n,r,o,s,a,l,u=null,v=null,b=0,j=O.extend(!0,{},t);function x(){return j.utils.t.apply(this,arguments)}function h(t){return x("errorContactUs").replace("%s",t.status.toString())}function S(r,o){var s="",a=new RegExp("\\+title=[^\\+]+","i");return""===r?"":(r=r.toString().replace(a,""),O.each(v.options.definitions,function(n,t){if(O.each(t,function(t,e){var i=e.def||"";if(t.toUpperCase()==r.toUpperCase()||i.toUpperCase().replace(a,"")==r.toUpperCase())return s=x("crsAlreadyExists")+n+" > "+(i?j.utils.getTitleFromDefinitionString(i,t):t),T(o,t),!1}),""!==s)return!1}),s)}function w(t,e){alert(t),O("#loadingxtra").hide(),O("#new-form").show(),e?b--:(O("#p-new").dialog("close"),O("#find-reference").val(""),O("#add-reference").val(""))}function P(t,e,i){var n=t.split(":");return i=i||!1,e.replace(/\$\{\d\}/gi,function(t){t=t.match(/\d+/)[0];var e=n[t]||t;return i?e.toUpperCase():e.toLowerCase()})}function E(t,e,i){window.Proj4js={defs:{}},e(i).done(function(){c(Proj4js.defs[t])}).fail(function(t){w(h(t),!0)}).always(function(){delete window.Proj4js})}function c(i){var t,n,e,r,o,s,a,l,u,h,c,d=O("#new-form input[name='target']").val(),p=i.toUpperCase(),f=0===p.indexOf("EPSG:"),g=0===p.indexOf("ESRI:"),m=0===p.indexOf("IAU2000:"),y=0===p.indexOf("SR-ORG:"),_=0===p.indexOf("IGNF:");if(O("#new-form").hide(),O("#loadingxtra").show(),r=S(i,d))w(r);else if(f||g||m||y)c=P(h=n=p,"http://spatialreference.org/ref/${0}/${1}/proj4js/"),window.Proj4js={defs:{}},E(h,O.fn.getXDomain,{url:c});else if(_)u=P(l=n=p,"/js/data/defs/${0}${1}.js",!0),E(l,O.ajax,{url:u,cache:!0,dataType:"script"});else{if(null!==(e=i.match(new RegExp('^[^\\[]+\\["([^\\]]+)"\\][\\s=]+"([^"]+)";$',"i")))&&(i=e[2]),t=j.utils.getTitleFromDefinitionString(i,""),n="UD"+ ++b,void 0===t&&(t=x("undefinedTitle"),i="+title="+t+" "+i),o=n+" "+t,i=i.replace("+title="+t,"+title="+o),r=(r=S(n,d))||S(i,d))return void w(r);s=i,(a={"*[UD]":{}})["*[UD]"][n]={def:s,isConnector:!1},v.mergeDefinitions(a).done(function(){O("#loadingxtra").hide(),O("#new-form").show();var e=T(d);try{T(d,n),alert(x("newSystemAdded")+'"'+o+'".'),O("#p-new").dialog("close"),O("#find-reference").val(""),O("#add-reference").val(""),j.utils.sendMsg("New user-defined system:\n\r"+n+' = "'+i+'"')}catch(t){b--,T(d,e),function(t){v.unloadCRS(t)}(n),""===i?alert(x("errorContactUs").replace("%s","-2 (NotFound)")):alert(x("errorContactUs").replace("%s","-1 (WrongFormat:"+i+")"))}})}}function T(t,e){var i="pushPull"+(t=t.toLowerCase()).charAt(0).toUpperCase()+t.slice(1);return v[i]("selection",e)}return e=j.context.converter,i=e.defaultSourceSrs,n=e.defaultDestSrs,r=e.defaultWgs84,o=!(""===r||""===r.x||""===r.y),s=O("#converter"),a=O("body"),l={units:{dms:{D:x("unitDegree"),M:x("unitMinute"),S:x("unitSecond")},dd:{x:{DD:x("unitDegreeEast")},y:{DD:x("unitDegreeNorth")}},cartesian:{XY:{m:x("unitMeter"),km:x("unitKilometer"),"us-ft":x("unitFeet")},CONVERGENCE:x("unitDegree")}},labels:{spherical:{x:x("labelLng"),y:x("labelLat"),convergence:x("labelConvergence")},cartesian:{x:x("labelX"),y:x("labelY"),z:x("labelZone"),h:x("labelHemi"),convergence:x("labelConvergence")},csv:{csv:x("labelCsv"),l:x("labelFormat")}},options:{x:{E:x("optionE"),W:x("optionW")},y:{N:x("optionN"),S:x("optionS")},o:{_DMS:x("optionDMS"),_DM:x("optionDM"),_DD:x("optionDD")},h:{n:x("optionNorth"),s:x("optionSouth")},u:{_M:x("optionM"),_KM:x("optionKM"),_F:x("optionF")}}},e.fromUrl&&!o&&alert("Invalid URL"),r=e.fromUrl&&o?[r]:e.fromRss?[{x:10,y:10}]:null,j.context.converter.fromUrl=!1,j.context.converter.fromRss=!1,u=function(){return j.utils.newDeferred.apply(this,arguments)}("Converter"),v=s.converterSet({units:l.units,labels:l.labels,options:l.options,wgs84:r,defaultWgs84:[j.utils.getRandomCityLocation()],value:{x:0,y:0},selections:{source:i,destination:n},url:j.system.httpServer+"/"+j.system.dirWsIncludes+"c.php"}).data("twccConverterSet"),s.one("converterset.done",function(t,e){u.resolve(e)}),s.on("converterset.fail",function(t,e){var i=h.call(null,e);alert(i)}),a.on("click","#new-reference",function(t){t.preventDefault(),c(O("#add-reference").val())}),a.on("submit","#new-form",function(t){t.preventDefault(),O("#new-reference").click()}),a.on("ui.convergence_changed",function(){v.setConvergence()}),a.on("ui.csv_changed",function(t,e){v.csv(e.data)}),O(".to-remove").remove(),{promise:u.promise(),converterWidget:v,setSelection:T}},window.TWCCConverter={getInstance:function(t){return e=e||i(t)}})}(jQuery),function(t,e,d,p){"use strict";var i,n,r,o;n=e,(i=t).GoogleAnalyticsObject="ga",i.ga=i.ga||function(){(i.ga.q=i.ga.q||[]).push(arguments)},i.ga.l=+new Date,r=n.createElement("script"),o=n.getElementsByTagName("script")[0],r.async=1,r.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(r,o),ga("create","UA-17790812-2","auto"),ga("send","pageview"),d(e).ready(function(){function i(t,e,i,n){try{ga("send","event",t,e,i,n)}catch(t){}}function t(t,e){i("main","fails",e.data.name)}function e(t,e){i("xhr","fails",e.data)}function n(t,e){i("layer","change",e.data)}function r(t){i("select","change",d(t.target).find("option:selected").text())}function o(t){i("radio","click",d(t.target).val())}function s(t){i("radio","click",d(t.target).prop("name"))}function a(){i("clipboard","click")}function l(){i("clipboard","success")}function u(){i("converter","changed")}function h(){!function(t,e,i,n){try{ga("send","timing",t,e,i,n)}catch(t){}}("TWCC","Render infowindow",(new Date).getTime()-p.context.startTime),i("infowindow","opened")}var c;(c=d("body")).on("change",".crs-list",r),c.on("click",'#converter input[type="radio"]',o),c.on("click",'#o-container input[type="radio"]',s),c.on("click",".octicon-clippy",a),c.on("clipboard.aftercopy",l),c.on("converter.changed",u),c.on("xhr.failed",e),c.on("map.layer.change",n),c.one("infowindow.dom_ready",h),c.one("main.failed",t),c.one("main.ready",function(t,e){(void 0===e.data?e.csv:e.data.csv)&&c.off("infowindow.dom_ready",h)})})}(window,document,jQuery,App);