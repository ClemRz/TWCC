/*!
 * clipboard.js v2.0.0
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT Â© Zeno Rocha
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ClipboardJS=e():t.ClipboardJS=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){var o,r,i;!function(a,c){r=[t,n(7)],o=c,void 0!==(i="function"==typeof o?o.apply(e,r):o)&&(t.exports=i)}(0,function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(t){return t&&t.__esModule?t:{default:t}}(e),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=function(){function t(e){n(this,t),this.resolveOptions(e),this.initSelection()}return i(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,o.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,o.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":r(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=a})},function(t,e,n){function o(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!c.string(e))throw new TypeError("Second argument must be a String");if(!c.fn(n))throw new TypeError("Third argument must be a Function");if(c.node(t))return r(t,e,n);if(c.nodeList(t))return i(t,e,n);if(c.string(t))return a(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function r(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function i(t,e,n){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,n)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,n)})}}}function a(t,e,n){return u(document.body,t,e,n)}var c=n(6),u=n(5);t.exports=o},function(t,e){function n(){}n.prototype={on:function(t,e,n){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function o(){r.off(t,o),e.apply(n,arguments)}var r=this;return o._=e,this.on(t,o,n)},emit:function(t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),o=0,r=n.length;for(o;o<r;o++)n[o].fn.apply(n[o].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),o=n[t],r=[];if(o&&e)for(var i=0,a=o.length;i<a;i++)o[i].fn!==e&&o[i].fn._!==e&&r.push(o[i]);return r.length?n[t]=r:delete n[t],this}},t.exports=n},function(t,e,n){var o,r,i;!function(a,c){r=[t,n(0),n(2),n(1)],o=c,void 0!==(i="function"==typeof o?o.apply(e,r):o)&&(t.exports=i)}(0,function(t,e,n,o){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}var l=r(e),s=r(n),f=r(o),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function(t){function e(t,n){i(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.resolveOptions(n),o.listenClick(t),o}return c(e,t),h(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===d(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,f.default)(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new l.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return u("action",t)}},{key:"defaultTarget",value:function(t){var e=u("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return u("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach(function(t){n=n&&!!document.queryCommandSupported(t)}),n}}]),e}(s.default);t.exports=p})},function(t,e){function n(t,e){for(;t&&t.nodeType!==o;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}var o=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}t.exports=n},function(t,e,n){function o(t,e,n,o,r){var a=i.apply(this,arguments);return t.addEventListener(n,a,r),{destroy:function(){t.removeEventListener(n,a,r)}}}function r(t,e,n,r,i){return"function"==typeof t.addEventListener?o.apply(null,arguments):"function"==typeof n?o.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,function(t){return o(t,e,n,r,i)}))}function i(t,e,n,o){return function(n){n.delegateTarget=a(n.target,e),n.delegateTarget&&o.call(t,n)}}var a=n(4);t.exports=r},function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e){function n(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var o=window.getSelection(),r=document.createRange();r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r),e=o.toString()}return e}t.exports=n}])});;/**
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 ClÃ©ment Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */

(function($) {
    "use strict";
    /*global window, document, jQuery */

    if (window.TWCCHistory !== undefined) {
        return;
    }

    var instance,
    init = function(opts) {

        var _options = $.extend(true, {}, opts),
            _array,
            _index,
            _enabled = true,
            _cookieName = _options.system.historyCookie,
            _min = 0,
            _max = _options.system.historyLimit;

        function _cleanWgs84(obj) {
            var wgs84, idx;
            if(obj === null || typeof(obj) != 'object') return obj;
            wgs84 = obj.constructor();
            for (idx in obj) {
                if (obj.hasOwnProperty(idx)) wgs84[idx] = _cleanWgs84(obj[idx]);
            }
            return wgs84;
        }
        function _importArray() {
            _array = _options.utils.getCookieContent(_cookieName);
            if ($.isEmptyObject(_array)) {
                _array = [];
            }
            _setIndexAt(_getMaxPosition());
        }
        function _getArray() {
            return _array;
        }
        function _exportArray() {
            _options.utils.setCookieContent(_cookieName, _getArray());
        }
        function _setArray(value) {
            _array = value;
        }
        function _toggle(enabled) {
            _enabled = enabled;
        }
        function _getMaxPosition() {
            return _getArray().length - 1;
        }
        function _setIndexAt(idx) {
            _index = Math.min(Math.abs(idx), _max);
            _options.utils.trigger($('body'), 'history.indexchanged', {
                currentIndex: idx,
                maxIndex: _getMaxPosition(),
                currentValue: _getCurrentValue()
            });
        }
        function _resetIndex() {
            _setIndexAt(_getMaxPosition());
        }
        function _getCurrentValue() {
            return _getArray()[_index];
        }
        function _push(value) {
            _array.push(value);
        }
        function _moveTo(idx) {
            _setIndexAt(idx);
            return _getCurrentValue();
        }
        function _sliceContent() {
            _setArray(_getArray().slice(_min, _index+1));
        }
        function _limit() {
            _setArray(_getArray().slice(-_max));
        }
        function _add(value) {
            if (_enabled && value) {
                value.wgs84 = _cleanWgs84(value.wgs84);
                if (JSON.stringify(value) !== JSON.stringify(_getCurrentValue())) {
                    _sliceContent();
                    _push(value);
                    _limit();
                    _resetIndex();
                    _exportArray();
                }
            }
        }
        function _moveToPrevious() {
            if (_index > _min) {
                return _moveTo(_index - 1);
            } else {
                return _getCurrentValue();
            }
        }
        function _moveToNext() {
            if (_index < _getMaxPosition()) {
                return _moveTo(_index + 1);
            } else {
                return _getCurrentValue();
            }
        }

        function _init() {
            _importArray();
        }

        _init();
        return {
            toggle: _toggle,
            isEnabled: function() {return _enabled;},
            add: _add,
            moveToPrevious: _moveToPrevious,
            moveToNext: _moveToNext,
            getCurrentValue: _getCurrentValue
        };
    };

    // exports
    window.TWCCHistory = {
        getInstance: function (opts) {
            instance = instance || init(opts);
            return instance;
        }
    };
})(jQuery);;(function($, App) {
    "use strict";
    /*global window, jQuery, App */

    function _getRandomInteger(start, end) {
        var x, y, rnd;
        x = end - start;
        y = start;
        rnd = Math.random()*x + y;
        return Math.round(rnd);
    }

    function _round(value, decimals) {
        var valStr;
        decimals = decimals === undefined ? 0 : decimals;
        valStr = value.toString();
        if (valStr === '' || valStr == 'NaN') {
            return '';
        } else {
            return Math.round(_parseFloat(value) * Math.pow(10, _parseFloat(decimals))) / Math.pow(10, _parseFloat(decimals));
        }
    }

    function _parseFloat(value) {
        value = value.toString().replace(/,/gi, '.');
        if (isNaN(value)) value = 0;
        return parseFloat(value);
    }

    /**
     * Add Math to App
     */
    $.extend(App, {
        math: {
            getRandomInteger: _getRandomInteger,
            round: _round,
            parseFloat: _parseFloat
        }
    });
})(jQuery, App);;/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version 3.0.1
 *
 * Requires jQuery >= 1.2.6
 */

(function (factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(['jquery'], factory);
    } else if (typeof exports === 'object') {
        // Node/CommonJS style for Browserify
        module.exports = factory;
    } else {
        // Browser globals
        factory(jQuery);
    }
}(function ($) {
    $.fn.bgiframe = function(s) {
        s = $.extend({
            top         : 'auto', // auto == borderTopWidth
            left        : 'auto', // auto == borderLeftWidth
            width       : 'auto', // auto == offsetWidth
            height      : 'auto', // auto == offsetHeight
            opacity     : true,
            src         : 'javascript:false;',
            conditional : /MSIE 6\.0/.test(navigator.userAgent) // expresion or function. return false to prevent iframe insertion
        }, s);

        // wrap conditional in a function if it isn't already
        if (!$.isFunction(s.conditional)) {
            var condition = s.conditional;
            s.conditional = function() { return condition; };
        }

        var $iframe = $('<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+s.src+'"'+
                           'style="display:block;position:absolute;z-index:-1;"/>');

        return this.each(function() {
            var $this = $(this);
            if ( s.conditional(this) === false ) { return; }
            var existing = $this.children('iframe.bgiframe');
            var $el = existing.length === 0 ? $iframe.clone() : existing;
            $el.css({
                'top': s.top == 'auto' ?
                    ((parseInt($this.css('borderTopWidth'),10)||0)*-1)+'px' : prop(s.top),
                'left': s.left == 'auto' ?
                    ((parseInt($this.css('borderLeftWidth'),10)||0)*-1)+'px' : prop(s.left),
                'width': s.width == 'auto' ? (this.offsetWidth + 'px') : prop(s.width),
                'height': s.height == 'auto' ? (this.offsetHeight + 'px') : prop(s.height),
                'opacity': s.opacity === true ? 0 : undefined
            });

            if ( existing.length === 0 ) {
                $this.prepend($el);
            }
        });
    };

    // old alias
    $.fn.bgIframe = $.fn.bgiframe;

    function prop(n) {
        return n && n.constructor === Number ? n + 'px' : n;
    }

}));
;/*
 * @name BeautyTips
 * @desc a tooltips/baloon-help plugin for jQuery
 *
 * @author Jeff Robbins - Lullabot - http://www.lullabot.com
 * @version 0.9.5 release candidate 1  (5/20/2009)
 */
jQuery.bt={version:'0.9.5-rc1'};;(function($){jQuery.fn.bt=function(content,options){if(typeof content!='string'){var contentSelect=true;options=content;content=false;}
else{var contentSelect=false;}
if(jQuery.fn.hoverIntent&&jQuery.bt.defaults.trigger=='hover'){jQuery.bt.defaults.trigger='hoverIntent';}
return this.each(function(index){var opts=jQuery.extend(false,jQuery.bt.defaults,jQuery.bt.options,options);opts.spikeLength=numb(opts.spikeLength);opts.spikeGirth=numb(opts.spikeGirth);opts.overlap=numb(opts.overlap);var ajaxTimeout=false;if(opts.killTitle){$(this).find('[title]').addBack().each(function(){if(!$(this).prop('bt-xTitle')){$(this).prop('bt-xTitle',$(this).prop('title')).prop('title','');}});}
if(typeof opts.tpropigger=='string'){opts.trigger=[opts.trigger];}
if(opts.trigger[0]=='hoverIntent'){var hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn();},out:function(){this.btOff();}});$(this).hoverIntent(hoverOpts);}
else if(opts.trigger[0]=='hover'){$(this).hover(function(){this.btOn();},function(){this.btOff();});}
else if(opts.trigger[0]=='now'){if($(this).hasClass('bt-active')){this.btOff();}
else{this.btOn();}}
else if(opts.trigger[0]=='none'){}
else if(opts.trigger.length>1&&opts.trigger[0]!=opts.trigger[1]){$(this).bind(opts.trigger[0],function(){this.btOn();}).bind(opts.trigger[1],function(){this.btOff();});}
else{$(this).bind(opts.trigger[0],function(){if($(this).hasClass('bt-active')){this.btOff();}
else{this.btOn();}});}
this.btOn=function(){if(typeof $(this).data('bt-box')=='object'){this.btOff();}
opts.preBuild.apply(this);$(jQuery.bt.vars.closeWhenOpenStack).btOff();$(this).addClass('bt-active '+opts.activeClass);if(contentSelect&&opts.ajaxPath==null){if(opts.killTitle){$(this).prop('title',$(this).prop('bt-xTitle'));}
content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector);if(opts.killTitle){$(this).prop('title','');}}
if(opts.ajaxPath!=null&&content==false){if(typeof opts.ajaxPath=='object'){var url=eval(opts.ajaxPath[0]);url+=opts.ajaxPath[1]?' '+opts.ajaxPath[1]:'';}
else{var url=opts.ajaxPath;}
var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off);}
var cacheData=opts.ajaxCache?$(document.body).data('btCache-'+url.replace(/\./g,'')):null;if(typeof cacheData=='string'){content=selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData;}
else{var target=this;var ajaxOpts=jQuery.extend(false,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(XMLHttpRequest,textStatus){if(textStatus=='success'||textStatus=='notmodified'){if(opts.ajaxCache){$(document.body).data('btCache-'+url.replace(/\./g,''),XMLHttpRequest.responseText);}
ajaxTimeout=false;content=selector?$("<div/>").append(XMLHttpRequest.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):XMLHttpRequest.responseText;}
else{if(textStatus=='timeout'){ajaxTimeout=true;}
content=opts.ajaxError.replace(/%error/g,XMLHttpRequest.statusText);}
if($(target).hasClass('bt-active')){target.btOn();}}},opts.ajaxOpts);jQuery.ajax(ajaxOpts);content=opts.ajaxLoading;}}
var shadowMarginX=0;var shadowMarginY=0;var shadowShiftX=0;var shadowShiftY=0;if(opts.shadow&&!shadowSupport()){opts.shadow=false;jQuery.extend(opts,opts.noShadowOpts);}
if(opts.shadow){if(opts.shadowBlur>Math.abs(opts.shadowOffsetX)){shadowMarginX=opts.shadowBlur*2;}
else{shadowMarginX=opts.shadowBlur+Math.abs(opts.shadowOffsetX);}
shadowShiftX=(opts.shadowBlur-opts.shadowOffsetX)>0?opts.shadowBlur-opts.shadowOffsetX:0;if(opts.shadowBlur>Math.abs(opts.shadowOffsetY)){shadowMarginY=opts.shadowBlur*2;}
else{shadowMarginY=opts.shadowBlur+Math.abs(opts.shadowOffsetY);}
shadowShiftY=(opts.shadowBlur-opts.shadowOffsetY)>0?opts.shadowBlur-opts.shadowOffsetY:0;}
if(opts.offsetParent){var offsetParent=$(opts.offsetParent);var offsetParentPos=offsetParent.offset();var pos=$(this).offset();var top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css('margin-top'))-shadowShiftY;var left=numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css('margin-left'))-shadowShiftX;}
else{var offsetParent=($(this).css('position')=='absolute')?$(this).parents().eq(0).offsetParent():$(this).offsetParent();var pos=$(this).btPosition();var top=numb(pos.top)+numb($(this).css('margin-top'))-shadowShiftY;var left=numb(pos.left)+numb($(this).css('margin-left'))-shadowShiftX;}
var width=$(this).btOuterWidth();var height=$(this).outerHeight();if(typeof content=='object'){if(content==null){return;}
var original=content;var clone=$(original).clone(true).show();var origClones=$(original).data('bt-clones')||[];origClones.push(clone);$(original).data('bt-clones',origClones);$(clone).data('bt-orig',original);$(this).data('bt-content-orig',{original:original,clone:clone});content=clone;}
if(typeof content=='null'||content==''){return;}
var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:'absolute',width:(opts.shrinkToFit?'auto':opts.width),zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles);var $box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:'absolute',width:opts.width,zIndex:opts.wrapperzIndex,visibility:'hidden'}).appendTo(offsetParent);if(jQuery.fn.bgiframe){$text.bgiframe();$box.bgiframe();}
$(this).data('bt-box',$box);var scrollTop=numb($(document).scrollTop());var scrollLeft=numb($(document).scrollLeft());var docWidth=numb($(window).width());var docHeight=numb($(window).height());var winRight=scrollLeft+docWidth;var winBottom=scrollTop+docHeight;var space=new Object();var thisOffset=$(this).offset();space.top=thisOffset.top-scrollTop;space.bottom=docHeight-((thisOffset+height)-scrollTop);space.left=thisOffset.left-scrollLeft;space.right=docWidth-((thisOffset.left+width)-scrollLeft);var textOutHeight=numb($text.outerHeight());var textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String){opts.positions=opts.positions.replace(/ /,'').split(',');}
if(opts.positions[0]=='most'){var position='top';for(var pig in space){position=space[pig]>space[position]?pig:position;}}
else{for(var x in opts.positions){var position=opts.positions[x];if((position=='left'||position=='right')&&space[position]>textOutWidth+opts.spikeLength){break;}
else if((position=='top'||position=='bottom')&&space[position]>textOutHeight+opts.spikeLength){break;}}}
var horiz=left+((width-textOutWidth)*.5);var vert=top+((height-textOutHeight)*.5);var points=new Array();var textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(position){case'top':$text.css('margin-bottom',opts.spikeLength+'px');$box.css({top:(top-$text.outerHeight(true))+opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css('left',(numb($box.css('left'))+textRightSpace)+'px');xShift-=textRightSpace;}
textLeftSpace=($text.offset().left+numb($text.css('margin-left')))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css('left',(numb($box.css('left'))-textLeftSpace)+'px');xShift+=textLeftSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:((textRight-textLeft)*.5)+xShift,type:'spike'};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.CornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textBottom,type:'join'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:crossPoint.x+(opts.spikeGirth/2),y:textBottom,type:'join'};points[points.length]=spikePoint;break;case'left':$text.css('margin-right',opts.spikeLength+'px');$box.css({top:vert+'px',left:((left-$text.btOuterWidth(true))+opts.overlap)+'px'});textBottomSpace=(winBottom-opts.windowMargin)-($text.offset().top+$text.outerHeight(true));var yShift=shadowShiftY;if(textBottomSpace<0){$box.css('top',(numb($box.css('top'))+textBottomSpace)+'px');yShift-=textBottomSpace;}
textTopSpace=($text.offset().top+numb($text.css('margin-top')))-(scrollTop+opts.windowMargin);if(textTopSpace<0){$box.css('top',(numb($box.css('top'))-textTopSpace)+'px');yShift+=textTopSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:((textBottom-textTop)*.5)+yShift,type:'spike'};crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight);crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y;crossPoint.y=crossPoint.y>(textBottom-opts.spikeGirth/2)-opts.cornerRadius?(textBottom-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.y;points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:'join'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:'join'};points[points.length]=spikePoint;break;case'bottom':$text.css('margin-top',opts.spikeLength+'px');$box.css({top:(top+height)-opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css('left',(numb($box.css('left'))+textRightSpace)+'px');xShift-=textRightSpace;}
textLeftSpace=($text.offset().left+numb($text.css('margin-left')))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css('left',(numb($box.css('left'))-textLeftSpace)+'px');xShift+=textLeftSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:((textRight-textLeft)*.5)+xShift,y:shadowShiftY,type:'spike'};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:'join'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textTop,type:'join'};points[points.length]=spikePoint;break;case'right':$text.css('margin-left',(opts.spikeLength+'px'));$box.css({top:vert+'px',left:((left+width)-opts.overlap)+'px'});textBottomSpace=(winBottom-opts.windowMargin)-($text.offset().top+$text.outerHeight(true));var yShift=shadowShiftY;if(textBottomSpace<0){$box.css('top',(numb($box.css('top'))+textBottomSpace)+'px');yShift-=textBottomSpace;}
textTopSpace=($text.offset().top+numb($text.css('margin-top')))-(scrollTop+opts.windowMargin);if(textTopSpace<0){$box.css('top',(numb($box.css('top'))-textTopSpace)+'px');yShift+=textTopSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:shadowShiftX,y:((textBottom-textTop)*.5)+yShift,type:'spike'};crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft);crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y;crossPoint.y=crossPoint.y>(textBottom-opts.spikeGirth/2)-opts.cornerRadius?(textBottom-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.y;points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:'join'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:'join'};points[points.length]=spikePoint;break;}
var canvas=document.createElement('canvas');$(canvas).prop('width',(numb($text.btOuterWidth(true))+opts.strokeWidth*2+shadowMarginX)).prop('height',(numb($text.outerHeight(true))+opts.strokeWidth*2+shadowMarginY)).appendTo($box).css({position:'absolute',zIndex:opts.boxzIndex});if(typeof G_vmlCanvasManager!='undefined'){canvas=G_vmlCanvasManager.initElement(canvas);}
if(opts.cornerRadius>0){var newPoints=new Array();var newPoint;for(var i=0;i<points.length;i++){if(points[i].type=='corner'){newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius);newPoint.type='arcStart';newPoints[newPoints.length]=newPoint;newPoints[newPoints.length]=points[i];newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius);newPoint.type='arcEnd';newPoints[newPoints.length]=newPoint;}
else{newPoints[newPoints.length]=points[i];}}
points=newPoints;}
var ctx=canvas.getContext("2d");if(opts.shadow&&opts.shadowOverlap!==true){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case'top':if(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap>0){$box.css('top',(numb($box.css('top'))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap)));}
break;case'right':if(shadowShiftX-shadowOverlap>0){$box.css('left',(numb($box.css('left'))+shadowShiftX-shadowOverlap));}
break;case'bottom':if(shadowShiftY-shadowOverlap>0){$box.css('top',(numb($box.css('top'))+shadowShiftY-shadowOverlap));}
break;case'left':if(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap>0){$box.css('left',(numb($box.css('left'))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap)));}
break;}}
drawIt.apply(ctx,[points],opts.strokeWidth);ctx.fillStyle=opts.fill;if(opts.shadow){ctx.shadowOffsetX=opts.shadowOffsetX;ctx.shadowOffsetY=opts.shadowOffsetY;ctx.shadowBlur=opts.shadowBlur;ctx.shadowColor=opts.shadowColor;}
ctx.closePath();ctx.fill();if(opts.strokeWidth>0){ctx.shadowColor='rgba(0, 0, 0, 0)';ctx.lineWidth=opts.strokeWidth;ctx.strokeStyle=opts.strokeStyle;ctx.beginPath();drawIt.apply(ctx,[points],opts.strokeWidth);ctx.closePath();ctx.stroke();}
opts.preShow.apply(this,[$box[0]]);$box.css({display:'none',visibility:'visible'});opts.showTip.apply(this,[$box[0]]);if(opts.overlay){var overlay=$('<div class="bt-overlay"></div>').css({position:'absolute',backgroundColor:'blue',top:top,left:left,width:width,height:height,opacity:'.2'}).appendTo(offsetParent);$(this).data('overlay',overlay);}
if((opts.ajaxPath!=null&&opts.ajaxCache==false)||ajaxTimeout){content=false;}
if(opts.clickAnywhereToClose){jQuery.bt.vars.clickAnywhereStack.push(this);$(document).click(jQuery.bt.docClick);}
if(opts.closeWhenOthersOpen){jQuery.bt.vars.closeWhenOpenStack.push(this);}
opts.postShow.apply(this,[$box[0]]);};this.btOff=function(){var box=$(this).data('bt-box');if(typeof box=='undefined'){return;}
opts.preHide.apply(this,[box]);var i=this;i.btCleanup=function(){var box=$(i).data('bt-box');var contentOrig=$(i).data('bt-content-orig');var overlay=$(i).data('bt-overlay');if(typeof box=='object'){$(box).remove();$(i).removeData('bt-box');}
if(typeof contentOrig=='object'){var clones=$(contentOrig.original).data('bt-clones');$(contentOrig).data('bt-clones',arrayRemove(clones,contentOrig.clone));}
if(typeof overlay=='object'){$(overlay).remove();$(i).removeData('bt-overlay');}
jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,i);jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,i);$(i).removeClass('bt-active '+opts.activeClass);opts.postHide.apply(i);}
opts.hideTip.apply(this,[box,i.btCleanup]);};var refresh=this.btRefresh=function(){this.btOff();this.btOn();};});function drawIt(points,strokeWidth){this.moveTo(points[0].x,points[0].y);for(i=1;i<points.length;i++){if(points[i-1].type=='arcStart'){this.quadraticCurveTo(round5(points[i].x,strokeWidth),round5(points[i].y,strokeWidth),round5(points[(i+1)%points.length].x,strokeWidth),round5(points[(i+1)%points.length].y,strokeWidth));i++;}
else{this.lineTo(round5(points[i].x,strokeWidth),round5(points[i].y,strokeWidth));}}};function round5(num,strokeWidth){var ret;strokeWidth=numb(strokeWidth);if(strokeWidth%2){ret=num;}
else{ret=Math.round(num-.5)+.5;}
return ret;};function numb(num){return parseInt(num)||0;};function arrayRemove(arr,elem){var x,newArr=new Array();for(x in arr){if(arr[x]!=elem){newArr.push(arr[x]);}}
return newArr;};function canvasSupport(){var canvas_compatible=false;try{canvas_compatible=!!(document.createElement('canvas').getContext('2d'));}catch(e){canvas_compatible=!!(document.createElement('canvas').getContext);}
return canvas_compatible;}
function shadowSupport(){try{var userAgent=navigator.userAgent.toLowerCase();if(/webkit/.test(userAgent)){return true;}
else if(/gecko|mozilla/.test(userAgent)&&parseFloat(userAgent.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1){return true;}}
catch(err){}
return false;}
function betweenPoint(point1,point2,dist){var y,x;if(point1.x==point2.x){y=point1.y<point2.y?point1.y+dist:point1.y-dist;return{x:point1.x,y:y};}
else if(point1.y==point2.y){x=point1.x<point2.x?point1.x+dist:point1.x-dist;return{x:x,y:point1.y};}};function centerPoint(arcStart,corner,arcEnd){var x=corner.x==arcStart.x?arcEnd.x:arcStart.x;var y=corner.y==arcStart.y?arcEnd.y:arcStart.y;var startAngle,endAngle;if(arcStart.x<arcEnd.x){if(arcStart.y>arcEnd.y){startAngle=(Math.PI/180)*180;endAngle=(Math.PI/180)*90;}
else{startAngle=(Math.PI/180)*90;endAngle=0;}}
else{if(arcStart.y>arcEnd.y){startAngle=(Math.PI/180)*270;endAngle=(Math.PI/180)*180;}
else{startAngle=0;endAngle=(Math.PI/180)*270;}}
return{x:x,y:y,type:'center',startAngle:startAngle,endAngle:endAngle};};function findIntersect(r1x1,r1y1,r1x2,r1y2,r2x1,r2y1,r2x2,r2y2){if(r2x1==r2x2){return findIntersectY(r1x1,r1y1,r1x2,r1y2,r2x1);}
if(r2y1==r2y2){return findIntersectX(r1x1,r1y1,r1x2,r1y2,r2y1);}
var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var r2m=(r2y1-r2y2)/(r2x1-r2x2);var r2b=r2y1-(r2m*r2x1);var x=(r2b-r1b)/(r1m-r2m);var y=r1m*x+r1b;return{x:x,y:y};};function findIntersectY(r1x1,r1y1,r1x2,r1y2,x){if(r1y1==r1y2){return{x:x,y:r1y1};}
var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var y=r1m*x+r1b;return{x:x,y:y};};function findIntersectX(r1x1,r1y1,r1x2,r1y2,y){if(r1x1==r1x2){return{x:r1x1,y:y};}
var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var x=(y-r1b)/r1m;return{x:x,y:y};};};jQuery.fn.btPosition=function(){function num(elem,prop){return elem[0]&&parseInt(jQuery.css(elem[0],prop,true),10)||0;};var left=0,top=0,results;if(this[0]){var offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=/^body|html$/i.test(offsetParent[0].tagName)?{top:0,left:0}:offsetParent.offset();offset.top-=num(this,'marginTop');offset.left-=num(this,'marginLeft');parentOffset.top+=num(offsetParent,'borderTopWidth');parentOffset.left+=num(offsetParent,'borderLeftWidth');results={top:offset.top-parentOffset.top,left:offset.left-parentOffset.left};}
return results;};jQuery.fn.btOuterWidth=function(margin){function num(elem,prop){return elem[0]&&parseInt(jQuery.css(elem[0],prop,true),10)||0;};return this["innerWidth"]()
+num(this,"borderLeftWidth")
+num(this,"borderRightWidth")
+(margin?num(this,"marginLeft")
+num(this,"marginRight"):0);};jQuery.fn.btOn=function(){return this.each(function(index){if(jQuery.isFunction(this.btOn)){this.btOn();}});};jQuery.fn.btOff=function(){return this.each(function(index){if(jQuery.isFunction(this.btOff)){this.btOff();}});};jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]};jQuery.bt.docClick=function(e){if(!e){var e=window.event;};if(!$(e.target).parents().addBack().filter('.bt-wrapper, .bt-active').length&&jQuery.bt.vars.clickAnywhereStack.length){$(jQuery.bt.vars.clickAnywhereStack).btOff();$(document).unbind('click',jQuery.bt.docClick);}};jQuery.bt.defaults={trigger:'hover',clickAnywhereToClose:true,closeWhenOthersOpen:false,shrinkToFit:false,width:'200px',padding:'10px',spikeGirth:10,spikeLength:15,overlap:0,overlay:false,killTitle:true,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:['most'],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:.5,centerPointY:.5,shadow:false,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:false,noShadowOpts:{strokeStyle:'#999'},cssClass:'',cssStyles:{},activeClass:'bt-active',contentSelector:"$(this).prop('title')",ajaxPath:null,ajaxError:'<strong>ERROR:</strong> <em>%error</em>',ajaxLoading:'<blink>Loading...</blink>',ajaxData:{},ajaxType:'GET',ajaxCache:true,ajaxOpts:{},preBuild:function(){},preShow:function(box){},showTip:function(box){$(box).show();},postShow:function(box){},preHide:function(box){},hideTip:function(box,callback){$(box).hide();callback();},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}};jQuery.bt.options={};})(jQuery);;/*! jQuery UI - v1.11.2 - 2014-12-08
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, selectmenu.js, slider.js, spinner.js, tabs.js, tooltip.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=u.call(arguments,1),r=this;return n=!a&&o.length?e.widget.extend.apply(null,[n].concat(o)):n,a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))}),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),C=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?M.left-=d:"center"===n.my[0]&&(M.left-=d/2),"bottom"===n.my[1]?M.top-=c:"center"===n.my[1]&&(M.top-=c/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,e.top+p+f+m>u&&(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,e.top+p+f+m>d&&(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,"left")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable("instance"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(t,s){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),a={},o=s&&s.length?s:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(n[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):e.each(n.alsoResize,function(e,t){h(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=u-t.height,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;
this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),n=s.uniqueId().attr("id");
t.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=n.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.length&&(!t.length||e.index()<t.index()),l=this.options.animate||{},u=h&&l.down||l,d=function(){o._toggleComplete(i)};return"number"==typeof u&&(a=u),"string"==typeof u&&(n=u),n=n||u.easing||l.easing,a=a||u.duration||l.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:d,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?r+=i.now:"content"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,d):e.animate(this.showProps,a,n,d)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,n,a,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,s=this.previousFilter||"",n=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(t.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(t,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.2"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())
},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,C,N,A,P,I,z,H,F,E,O,j,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),K=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;K[0]>w;w++){for(k="",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",K[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case K[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",C=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,C+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=C+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),P=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((P+A)/7),z=Q?this.maxRows>I?this.maxRows:I:I,this.maxRows=z,H=this._daylightSavingAdjust(new Date(et,Z,1-P)),F=0;z>F;F++){for(M+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(H)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[H]):[!0,""],j=H.getMonth()!==Z,W=j&&!y||!O[0]||X&&X>H||$&&H>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(H.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===H.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!v?"":" "+O[1]+(H.getTime()===G.getTime()?" "+this._currentClass:"")+(H.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(j&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+H.getMonth()+"' data-year='"+H.getFullYear()+"'")+">"+(j&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+H.getDate()+"</span>":"<a class='ui-state-default"+(H.getTime()===R.getTime()?" ui-state-highlight":"")+(H.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H);M+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(K[0]>0&&T===K[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.2",e.datepicker,e.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;
e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,i=this.element.attr("tabindex");this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:i||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n="";e.each(i,function(i,a){a.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](n).eq(-1):i[e+"All"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent("optgroup");i.push({element:n,index:t,value:n.attr("value"),label:n.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-e},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"
},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),r={tab:n,panel:o};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){o.html(e),s._trigger("load",i,r)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&s.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href"),beforeSend:function(t,a){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur");n.target=n.currentTarget=s.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){e.data("ui-tooltip-open")&&n._delay(function(){t&&(t.type=a),this._open(t,e,i)})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){u.of=e,o.is(":hidden")||o.position(u)}var a,o,r,h,l,u=e.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(l=s.clone(),l.removeAttr("id").find("[id]").removeAttr("id")):l=s,e("<div>").html(l).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(u.of),clearInterval(h))},e.fx.interval)),this._trigger("open",t,{tooltip:o}),r={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}},i[0]!==this.element[0]&&(r.remove=function(){this._removeTooltip(o)}),t&&"mouseover"!==t.type||(r.mouseleave="close"),t&&"focusin"!==t.type||(r.focusout="close"),this._on(!0,i,r)}},close:function(t){var i,s=this,n=e(t?t.currentTarget:this.element),a=this._find(n);a&&(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),a.closing=!0,this._trigger("close",t,{tooltip:i}),a.hiding||(a.closing=!1)))},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur"),a=s.element;n.target=n.currentTarget=a[0],t.close(n,!0),e("#"+i).remove(),a.data("ui-tooltip-title")&&(a.attr("title")||a.attr("title",a.data("ui-tooltip-title")),a.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c="array"),"string"===c?this.parse(s(n)||a._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if("alpha"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d="array"===r||"object"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d["object"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+"Class"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return"boolean"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.2",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);
var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(o,t.mode||"hide"),d=t.direction||"up",c=r.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})}});;/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd) {
		// AMD
		define(['jquery'], factory);
	} else if (typeof exports === 'object') {
		// CommonJS
		factory(require('jquery'));
	} else {
		// Browser globals
		factory(jQuery);
	}
}(function ($) {

	var pluses = /\+/g;

	function encode(s) {
		return config.raw ? s : encodeURIComponent(s);
	}

	function decode(s) {
		return config.raw ? s : decodeURIComponent(s);
	}

	function stringifyCookieValue(value) {
		return encode(config.json ? JSON.stringify(value) : String(value));
	}

	function parseCookieValue(s) {
		if (s.indexOf('"') === 0) {
			// This is a quoted cookie as according to RFC2068, unescape...
			s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}

		try {
			// Replace server-side written pluses with spaces.
			// If we can't decode the cookie, ignore it, it's unusable.
			// If we can't parse the cookie, ignore it, it's unusable.
			s = decodeURIComponent(s.replace(pluses, ' '));
			return config.json ? JSON.parse(s) : s;
		} catch(e) {}
	}

	function read(s, converter) {
		var value = config.raw ? s : parseCookieValue(s);
		return $.isFunction(converter) ? converter(value) : value;
	}

	var config = $.cookie = function (key, value, options) {

		// Write

		if (value !== undefined && !$.isFunction(value)) {
			options = $.extend({}, config.defaults, options);

			if (typeof options.expires === 'number') {
				var days = options.expires, t = options.expires = new Date();
				t.setTime(+t + days * 864e+5);
			}

			return (document.cookie = [
				encode(key), '=', stringifyCookieValue(value),
				options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
				options.path    ? '; path=' + options.path : '',
				options.domain  ? '; domain=' + options.domain : '',
				options.secure  ? '; secure' : ''
			].join(''));
		}

		// Read

		var result = key ? undefined : {};

		// To prevent the for loop in the first place assign an empty array
		// in case there are no cookies at all. Also prevents odd result when
		// calling $.cookie().
		var cookies = document.cookie ? document.cookie.split('; ') : [];

		for (var i = 0, l = cookies.length; i < l; i++) {
			var parts = cookies[i].split('=');
			var name = decode(parts.shift());
			var cookie = parts.join('=');

			if (key && key === name) {
				// If second argument (value) is a function it's a converter...
				result = read(cookie, value);
				break;
			}

			// Prevent storing a cookie that we couldn't decode.
			if (!key && (cookie = read(cookie)) !== undefined) {
				result[name] = cookie;
			}
		}

		return result;
	};

	config.defaults = {};

	$.removeCookie = function (key, options) {
		if ($.cookie(key) === undefined) {
			return false;
		}

		// Must not alter options, thus extending a fresh object...
		$.cookie(key, '', $.extend({}, options, { expires: -1 }));
		return !$.cookie(key);
	};

}));
;/*
 jquery.fullscreen 1.1.4
 https://github.com/kayahr/jquery-fullscreen-plugin
 Copyright (C) 2012 Klaus Reimer <k@ailis.de>
 Licensed under the MIT license
 (See http://www.opensource.org/licenses/mit-license)
*/
function d(b){var c,a;if(!this.length)return this;c=this[0];c.ownerDocument?a=c.ownerDocument:(a=c,c=a.documentElement);if(null==b){if(!a.cancelFullScreen&&!a.webkitCancelFullScreen&&!a.mozCancelFullScreen)return null;b=!!a.fullScreen||!!a.webkitIsFullScreen||!!a.mozFullScreen;return!b?b:a.fullScreenElement||a.webkitCurrentFullScreenElement||a.mozFullScreenElement||b}b?(b=c.requestFullScreen||c.webkitRequestFullScreen||c.mozRequestFullScreen)&&b.call(c,Element.ALLOW_KEYBOARD_INPUT):(b=a.cancelFullScreen||
a.webkitCancelFullScreen||a.mozCancelFullScreen)&&b.call(a);return this}jQuery.fn.fullScreen=d;jQuery.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))};var e,f,g;e=document;e.webkitCancelFullScreen?(f="webkitfullscreenchange",g="webkitfullscreenerror"):e.mozCancelFullScreen?(f="mozfullscreenchange",g="mozfullscreenerror"):(f="fullscreenchange",g="fullscreenerror");jQuery(document).bind(f,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))});
jQuery(document).bind(g,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))});;var cookieScripts=document.getElementsByTagName("script"),cookieScriptSrc=cookieScripts[cookieScripts.length-1].src,cookieQuery=null,cookieScriptPosition="bottom",cookieScriptSide="right",cookieScriptSource="cookie-script.com",cookieScriptDomain="",cookieScriptReadMore="/policies/cookie_"+App.context.languageCode+".html",cookieId="6a00eb3cf69b00d1af83ec32b891828a",cookieScriptDebug=0,cookieScriptCurrentUrl=window.location.href,cookieScriptTitle='<h4 id="cookiescript_header">'+App.translations.weUseCookies+'</h4>',cookieScriptDesc=App.translations.weUseCookiesDescription,
cookieScriptAccept="\u00d7",cookieScriptMore=App.translations.readMore,cookieScriptCopyrights="",cookieScriptLoadJavaScript=function(f,d){var b=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript";a.src=f;void 0!=d&&(a.onload=a.onreadystatechange=function(){a.readyState&&!/loaded|complete/.test(a.readyState)||(a.onload=a.onreadystatechange=null,b&&a.parentNode&&b.removeChild(a),a=void 0,d())});b.insertBefore(a,b.firstChild)},InjectCookieScript=function(){function f(){cookieQuery('iframe[data-cookiescript="accepted"]').not(":has([src])").each(function(){var a=
this,a=a.contentWindow?a.contentWindow:a.contentDocument.document?a.contentDocument.document:a.contentDocument;a.document.open();a.document.write(cookieQuery(this).attr("alt"));a.document.close()})}function d(a){"show"==a?(cookieQuery("#cookiescript_overlay",cookieScriptWindow).show(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).show()):"hide"==a&&(cookieQuery("#cookiescript_overlay",cookieScriptWindow).hide(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).hide())}function b(){cookieQuery('img[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",
cookieQuery(this).attr("data-src"))});cookieQuery('script[type="text/plain"][data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src")?cookieQuery(this).after('<script type="text/javascript" src="'+cookieQuery(this).attr("src")+'">\x3c/script>'):cookieQuery(this).after('<script type="text/javascript">'+cookieQuery(this).html()+"\x3c/script>");cookieQuery(this).empty()});cookieQuery('iframe[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))});
cookieQuery('embed[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))[0].outerHTML)});cookieQuery('object[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("data",cookieQuery(this).attr("data-data"))[0].outerHTML)});cookieQuery('link[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("href",cookieQuery(this).attr("data-href"))})}cookieScriptDropfromFlag=
0;cookieScriptDroptoFlag=0;cookieScriptCreateCookie=function(a,b,c){var d="",e;c&&(e=new Date,e.setTime(e.getTime()+864E5*c),d="; expires="+e.toGMTString());c="";""!=cookieScriptDomain&&
(c="; domain="+cookieScriptDomain);document.cookie=a+"="+b+d+c+"; path=/"};cookieScriptReadCookie=function(a){a+="=";for(var d=document.cookie.split(";"),c,b=0;b<d.length;b++){for(c=d[b];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(a))return c.substring(a.length,c.length)}return null};cookieQuery(function(){cookieScriptWindow=window.document;cookieQuery("#cookiescript_injected",cookieScriptWindow).remove();cookieQuery("#cookiescript_overlay",cookieScriptWindow).remove();cookieQuery("#cookiescript_info_box",
cookieScriptWindow).remove();cookieScriptCurrentValue=cookieScriptReadCookie("cookiescriptaccept");if("visit"==cookieScriptCurrentValue)return!1;if(cookieScriptCurrentValue){if("firstvisit"==cookieScriptCurrentValue.substring(0,10)&&cookieScriptCurrentValue!="firstvisit-"+cookieScriptCurrentUrl)return cookieScriptCreateCookie("cookiescriptaccept","visit",30),b(),!1}else cookieScriptCreateCookie("cookiescriptaccept","firstvisit-"+cookieScriptCurrentUrl,30);cookieQuery("body",cookieScriptWindow).append('<div id="cookiescript_injected">'+
cookieScriptTitle+cookieScriptDesc+' <span id="cookiescript_readmore">'+cookieScriptMore+'</span><div id="cookiescript_accept">'+cookieScriptAccept+'</div><div style="clear:both"></div>');cookieQuery("#cookiescript_injected",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,opacity:1,position:"fixed",
padding:"15px",width:"300px","font-size":"13px","font-weight":"normal","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"none","line-height":"15px","letter-spacing":"normal","-moz-box-shadow":"0px 0px 8px #000000","-webkit-box-shadow":"0px 0px 8px #000000","box-shadow":"0px 0px 8px #000000"});"top"==cookieScriptPosition?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("top",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("bottom",0);"left"==
cookieScriptSide?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("left",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("right",0);cookieQuery("#cookiescript_injected h4#cookiescript_header",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,padding:"0 0 7px 0","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"block","font-size":"15px","font-weight":"bold","line-height":"normal","letter-spacing":"normal","font-style":"normal",
margin:"0"});cookieQuery("#cookiescript_injected a",cookieScriptWindow).css({"text-decoration":"underline",color:"#FFFFFF"});cookieQuery("#cookiescript_injected a#cookiescript_link",cookieScriptWindow).css({"text-decoration":"none",color:"#FFFFFF","float":"right","font-size":"90%","text-decoration":"none","margin-top":"8px"});cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({border:0,padding:"0","text-decoration":"underline",cursor:"pointer",margin:"0","white-space":"nowrap"});
cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"-webkit-border-radius":"10px","-khtml-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",border:0,padding:"0",cursor:"pointer",margin:"0","-webkit-transition":"0.25s","-moz-transition":"0.25s",transition:"0.25s",width:"20px",height:"20px",position:"absolute",top:"12px",right:"17px","border-radius":"10px","text-align":"center","font-weight":"bold","line-height":"21px","font-size":"20px"});cookieQuery("#cookiescript_injected div#cookiescript_accept",
cookieScriptWindow).css({"background-color":"#5BB75B",color:"#FFFFFF","float":"left"});cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({});cookieQuery("#cookiescript_injected div#cookiescript_pixel",cookieScriptWindow).css({width:"1px",height:"1px","float":"left"});cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeIn(1E3);cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).click(function(){"undefined"===typeof cookieScriptScrollfired&&
(cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeOut(200),cookieScriptCreateCookie("cookiescriptaccept","visit",30),d("hide"),b())});cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).click(function(){window.open(cookieScriptReadMore,"_blank");return!1});cookieQuery("#cookiescript_overlay",cookieScriptWindow).click(function(){d("hide")});cookieQuery("#cookiescript_info_close",cookieScriptWindow).click(function(){d("hide")});document.onkeydown=function(a){a=
a||window.event;27==a.keyCode&&d("hide")};f()});"visit"!=cookieScriptReadCookie("cookiescriptaccept")&&"shown"!=cookieScriptReadCookie("cookiescriptaccept")||b()};
window.jQuery&&jQuery.fn&&/^(1\.[8-9]|2\.[0-9])/.test(jQuery.fn.jquery)?(cookieScriptDebug&&window.console&&console.log("Using existing jQuery version "+jQuery.fn.jquery),cookieQuery=window.jQuery,InjectCookieScript()):(cookieScriptDebug&&window.console&&console.log("Loading jQuery 1.8.1 from ajax.googleapis.com"),cookieScriptLoadJavaScript(("https:"==document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js",function(){cookieQuery=jQuery.noConflict(!0);
InjectCookieScript()}));
;/*
	cof2Obj.js
	Converts the WMM.COF text to a JSON object usable by geoMagFactory().
*/

function cof2Obj(cof) {
	'use strict';
	var modelLines = cof.split('\n'),
		wmm = [],
		i, vals, epoch, model, modelDate;
	for (i in modelLines) {
		if (modelLines.hasOwnProperty(i)) {
			vals = modelLines[i].replace(/^\s+|\s+$/g, "").split(/\s+/);
			if (vals.length === 3) {
				epoch = parseFloat(vals[0]);
				model = vals[1];
				modelDate = vals[2];
			} else if (vals.length === 6) {
				wmm.push({
					n: parseInt(vals[0], 10),
					m: parseInt(vals[1], 10),
					gnm: parseFloat(vals[2]),
					hnm: parseFloat(vals[3]),
					dgnm: parseFloat(vals[4]),
					dhnm: parseFloat(vals[5])
				});
			}
		}
	}

	return {epoch: epoch, model: model, modelDate: modelDate, wmm: wmm};
}
;/*	2012-03-26
    Copyright 2012 Christopher Weiss (cmweiss@gmail.com)

    Suggestions for improvements are appreciated.

    Adapted from the geomagc software and World Magnetic Model of the NOAA
    Satellite and Information Service, National Geophysical Data Center
    http://www.ngdc.noaa.gov/geomag/WMM/DoDWMM.shtml

    geoMagFactory() requires a world magnetic model (WMM) object. The helper
    function cof2Obj(), available in cof2Obj.js, takes the text of WMM.COF and
    returns an object suitable for geoMagFactory(). A syncronous XMLHttpRequest
    to fetch the WMM.COF is recommended in a web environment. The helper
    function syncXHR(), available in syncXHR.js, takes the url of the WMM.COF
    file and returns the WMM.COF file as text.

    Usage:
    geoMagFactory(wmm) returns a function which can compute the Earth's
    magnetic field.
    The returned function requires two arguments, latitude and longitude (in
    decimal degrees), and, optionally, altitude in feet (default is 0), and
    a date object (default is the current system time).

    var cof = syncXHR('http://host/path/WMM.COF'),
	    wmm = cof2Obj(cof),
	    geoMag = geoMagFactory(wmm),
	    latitude = 40.0,                // decimal degrees (north is positive)
	    longitude = -80.0,              // decimal degrees (east is positive)
	    altitude = 0,                   // feet (optional, default is 0)
	    time = new Date(2012, 4, 20),   // (optional, default is the current
                                        // system time)
	    myGeoMag = geoMag(latitude, longitude, altitude, time),
	    magneticVariation = myGeoMag.dec,   // Geomagnetic declination
                                            // (variation) in decimal degrees
                                            // -- east is positive
	    magneticDip = myGeoMag.dip, // Geomagnetic dip in decimal degrees
                                    // (down is positive)
	    magneticFieldIntensity = myGeoMag.ti,   // Total intensity of the
                                                // geomagnetic field in
                                                // nanoteslas
	    magneticBH = myGeoMag.bh,   // Horizontal intensity of the geomagnetic
                                    // field in nT
	    magneticBX = myGeoMag.bx,   // North component of the geomagnetic field
                                    // in nT
	    magneticBY = myGeoMag.by,   // East component of the geomagnetic field
                                    // in nT
	    magneticBZ = myGeoMag.bz,   // Vertical component of the geomagnetic
                                    // field (down is positive)
	    lat = myGeoMag.lat, // input latitude
	    lon = myGeoMag.lon; // input longitude
*/

/*jslint plusplus: true */
function geoMagFactory(wmm) {
	'use strict';
	function rad2deg(rad) {
		return rad * (180 / Math.PI);
	}
	function deg2rad(deg) {
		return deg * (Math.PI / 180);
	}

	var i, model, epoch = wmm.epoch,
		z = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
		maxord = 12,
		tc = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice()],
		sp = z.slice(),
		cp = z.slice(),
		pp = z.slice(),
		p = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice()],
		dp = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice()],
		a = 6378.137,
		b = 6356.7523142,
		re = 6371.2,
		a2 = a * a,
		b2 = b * b,
		c2 = a2 - b2,
		a4 = a2 * a2,
		b4 = b2 * b2,
		c4 = a4 - b4,
		c = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice()],
		cd = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice()],
		n, m,
		snorm = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice()],
		j,
		k = [z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice(), z.slice(), z.slice(), z.slice(), z.slice(), z.slice(),
			z.slice()],
		flnmj,
		fn = [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13],
		fm = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
		D2;

	tc[0][0] = 0;
	sp[0] = 0.0;
	cp[0] = 1.0;
	pp[0] = 1.0;
	p[0][0] = 1;

	model = wmm.wmm;
	for (i in model) {
		if (model.hasOwnProperty(i)) {
			if (model[i].m <= model[i].n) {
				c[model[i].m][model[i].n] = model[i].gnm;
				cd[model[i].m][model[i].n] = model[i].dgnm;
				if (model[i].m !== 0) {
					c[model[i].n][model[i].m - 1] = model[i].hnm;
					cd[model[i].n][model[i].m - 1] = model[i].dhnm;
				}
			}
		}
	}
	wmm = null;
	model = null;

	/* CONVERT SCHMIDT NORMALIZED GAUSS COEFFICIENTS TO UNNORMALIZED */
	snorm[0][0] = 1;

	for (n = 1; n <= maxord; n++) {
		snorm[0][n] = snorm[0][n - 1] * (2 * n - 1) / n;
		j = 2;

		for (m = 0, D2 = (n - m + 1); D2 > 0; D2--, m++) {
			k[m][n] = (((n - 1) * (n - 1)) - (m * m)) /
				((2 * n - 1) * (2 * n - 3));
			if (m > 0) {
				flnmj = ((n - m + 1) * j) / (n + m);
				snorm[m][n] = snorm[m - 1][n] * Math.sqrt(flnmj);
				j = 1;
				c[n][m - 1] = snorm[m][n] * c[n][m - 1];
				cd[n][m - 1] = snorm[m][n] * cd[n][m - 1];
			}
			c[m][n] = snorm[m][n] * c[m][n];
			cd[m][n] = snorm[m][n] * cd[m][n];
		}
	}
	k[1][1] = 0.0;

	return function (glat, glon, h, date) {
		function decimalDate(date) {
			date = date || new Date();
			var year = date.getFullYear(),
				daysInYear = 365 +
					(((year % 400 === 0) || (year % 4 === 0 && (year % 100 > 0))) ? 1 : 0),
				msInYear = daysInYear * 24 * 60 * 60 * 1000;

			return date.getFullYear() + (date.valueOf() - (new Date(year, 0)).valueOf()) / msInYear;
		}

		var alt = (h / 3280.8399) || 0, // convert h (in feet) to kilometers or set default of 0
			time = decimalDate(date),
			dt = time - epoch,
			rlat = deg2rad(glat),
			rlon = deg2rad(glon),
			srlon = Math.sin(rlon),
			srlat = Math.sin(rlat),
			crlon = Math.cos(rlon),
			crlat = Math.cos(rlat),
			srlat2 = srlat * srlat,
			crlat2 = crlat * crlat,
			q,
			q1,
			q2,
			ct,
			st,
			r2,
			r,
			d,
			ca,
			sa,
			aor,
			ar,
			br = 0.0,
			bt = 0.0,
			bp = 0.0,
			bpp = 0.0,
			par,
			temp1,
			temp2,
			parp,
			D4,
			bx,
			by,
			bz,
			bh,
			ti,
			dec,
			dip,
			gv;
		sp[1] = srlon;
		cp[1] = crlon;

		/* CONVERT FROM GEODETIC COORDS. TO SPHERICAL COORDS. */
		q = Math.sqrt(a2 - c2 * srlat2);
		q1 = alt * q;
		q2 = ((q1 + a2) / (q1 + b2)) * ((q1 + a2) / (q1 + b2));
		ct = srlat / Math.sqrt(q2 * crlat2 + srlat2);
		st = Math.sqrt(1.0 - (ct * ct));
		r2 = (alt * alt) + 2.0 * q1 + (a4 - c4 * srlat2) / (q * q);
		r = Math.sqrt(r2);
		d = Math.sqrt(a2 * crlat2 + b2 * srlat2);
		ca = (alt + d) / r;
		sa = c2 * crlat * srlat / (r * d);

		for (m = 2; m <= maxord; m++) {
			sp[m] = sp[1] * cp[m - 1] + cp[1] * sp[m - 1];
			cp[m] = cp[1] * cp[m - 1] - sp[1] * sp[m - 1];
		}

		aor = re / r;
		ar = aor * aor;

		for (n = 1; n <= maxord; n++) {
			ar = ar * aor;
			for (m = 0, D4 = (n + m + 1); D4 > 0; D4--, m++) {

		/*
				COMPUTE UNNORMALIZED ASSOCIATED LEGENDRE POLYNOMIALS
				AND DERIVATIVES VIA RECURSION RELATIONS
		*/
				if (n === m) {
					p[m][n] = st * p[m - 1][n - 1];
					dp[m][n] = st * dp[m - 1][n - 1] + ct *
						p[m - 1][n - 1];
				} else if (n === 1 && m === 0) {
					p[m][n] = ct * p[m][n - 1];
					dp[m][n] = ct * dp[m][n - 1] - st * p[m][n - 1];
				} else if (n > 1 && n !== m) {
					if (m > n - 2) { p[m][n - 2] = 0; }
					if (m > n - 2) { dp[m][n - 2] = 0.0; }
					p[m][n] = ct * p[m][n - 1] - k[m][n] * p[m][n - 2];
					dp[m][n] = ct * dp[m][n - 1] - st * p[m][n - 1] -
						k[m][n] * dp[m][n - 2];
				}

		/*
				TIME ADJUST THE GAUSS COEFFICIENTS
		*/

				tc[m][n] = c[m][n] + dt * cd[m][n];
				if (m !== 0) {
					tc[n][m - 1] = c[n][m - 1] + dt * cd[n][m - 1];
				}

		/*
				ACCUMULATE TERMS OF THE SPHERICAL HARMONIC EXPANSIONS
		*/
				par = ar * p[m][n];
				if (m === 0) {
					temp1 = tc[m][n] * cp[m];
					temp2 = tc[m][n] * sp[m];
				} else {
					temp1 = tc[m][n] * cp[m] + tc[n][m - 1] * sp[m];
					temp2 = tc[m][n] * sp[m] - tc[n][m - 1] * cp[m];
				}
				bt = bt - ar * temp1 * dp[m][n];
				bp += (fm[m] * temp2 * par);
				br += (fn[n] * temp1 * par);
		/*
					SPECIAL CASE:  NORTH/SOUTH GEOGRAPHIC POLES
		*/
				if (st === 0.0 && m === 1) {
					if (n === 1) {
						pp[n] = pp[n - 1];
					} else {
						pp[n] = ct * pp[n - 1] - k[m][n] * pp[n - 2];
					}
					parp = ar * pp[n];
					bpp += (fm[m] * temp2 * parp);
				}
			}
		}

		bp = (st === 0.0 ? bpp : bp / st);
		/*
			ROTATE MAGNETIC VECTOR COMPONENTS FROM SPHERICAL TO
			GEODETIC COORDINATES
		*/
		bx = -bt * ca - br * sa;
		by = bp;
		bz = bt * sa - br * ca;

		/*
			COMPUTE DECLINATION (DEC), INCLINATION (DIP) AND
			TOTAL INTENSITY (TI)
		*/
		bh = Math.sqrt((bx * bx) + (by * by));
		ti = Math.sqrt((bh * bh) + (bz * bz));
		dec = rad2deg(Math.atan2(by, bx));
		dip = rad2deg(Math.atan2(bz, bh));

		/*
			COMPUTE MAGNETIC GRID VARIATION IF THE CURRENT
			GEODETIC POSITION IS IN THE ARCTIC OR ANTARCTIC
			(I.E. GLAT > +55 DEGREES OR GLAT < -55 DEGREES)
			OTHERWISE, SET MAGNETIC GRID VARIATION TO -999.0
		*/

		if (Math.abs(glat) >= 55.0) {
			if (glat > 0.0 && glon >= 0.0) {
				gv = dec - glon;
			} else if (glat > 0.0 && glon < 0.0) {
				gv = dec + Math.abs(glon);
			} else if (glat < 0.0 && glon >= 0.0) {
				gv = dec + glon;
			} else if (glat < 0.0 && glon < 0.0) {
				gv = dec - Math.abs(glon);
			}
			if (gv > 180.0) {
				gv -= 360.0;
			} else if (gv < -180.0) { gv += 360.0; }
		}

		return {dec: dec, dip: dip, ti: ti, bh: bh, bx: bx, by: by, bz: bz, lat: glat, lon: glon, gv: gv, epoch: epoch};
	};
}
;(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var _proj=_interopRequireDefault(require("proj4"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}!function(t,e,i){function n(t){return t=+t.toString().replace(/\,/gi,"."),isNaN(t)?0:t}function o(){return i.utils.newDeferred.apply(this,arguments)}function s(t){return t>=0?Math.floor((t+180)/6)+1:Math.floor(t/6)+31}function l(t){return t>=0?"n":"s"}function r(t){var e;switch(t){case"m":e=1;break;case"km":e=1e3;break;case"us-ft":e=.304800609601219;break;default:e=1e3}return e}function a(t,e){return n(t)*r(e)}t.widget("twcc.converterSet",{options:{units:{dms:{D:"Â°",M:"'",S:"''"},dd:{x:{DD:"Â°E"},y:{DD:"Â°N"}},cartesian:{XY:{m:"m",km:"km","us-ft":"ft"},CONVERGENCE:"Â°"}},labels:{spherical:{x:"Lng = ",y:"Lat = ",convergence:"Conv. = "},cartesian:{x:"X = ",y:"Y = ",z:"Zone = ",h:"Hemisphere = ",convergence:"Conv. = "},csv:{csv:"CSV : ",l:"Format : "}},options:{x:{E:"East",W:"West"},y:{N:"North",S:"South"},o:{_DMS:"Deg. min. sec.",_DM:"Deg. min.",_DD:"Decimal deg."},h:{n:"North",s:"South"},u:{_M:"Meters",_KM:"Kilometers",_F:"Feet"}},value:{x:0,y:0},wgs84:[],defaultWgs84:[{x:0,y:0}],selections:{},definitions:{},url:"",$containers:[],masterLoadingToggleSwitch:!1,csv:!1},_create:function(){var n,o=this;if(this._bindEvents(),this._historyManager=e.getInstance(i),n=this._historyManager.getCurrentValue(),!this.options.wgs84)if(n){var s=/UD\d+/gi;if(n.wgs84.length>1)this.options.wgs84=n.wgs84,o.options.csv=!0;else{if("array"!==t.type(n.wgs84))throw"Wrong data type";this.options.wgs84=n.wgs84}this.options.selections.source=s.test(n.sc)?"WGS84":n.sc,this.options.selections.destination=s.test(n.dc)?"WGS84":n.dc}else this.options.wgs84=this.options.defaultWgs84;this.options.$containers=this.element.find(".converter-container"),this.options.$containers.each(function(e){t(this).converter({units:o.options.units,labels:o.options.labels,options:o.options.options,csv:o.options.csv,target:e?"dest":"source",selection:o.options.selections[e?"destination":"source"],value:o.options.value,wgs84:o.options.wgs84})}),this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this._reload().progress(function(t){o._trigger(".notify",null,t)}).done(function(){o._reloadSucceeded.apply(o,arguments),o._trigger(".done",null,{wgs84:o.wgs84(),csv:o.csv(),selections:o.options.selections}),o.setConvergence()}).fail(function(){o._reloadFailed.apply(o,arguments)})},_bindEvents:function(){var e=this;this.element.on("converter.transform",function(t,i){e.transform(i)}),this.element.on("converter.source.wgs84_changed converterset.done ",function(t,n){if(n.wgs84.length){var o={wgs84:n.wgs84,convergenceInDegrees:e._convergence(),srsCode:e._selection(),magneticDeclinationInDegrees:(s=n.wgs84,i.utils.getWMM()(s[0].y,s[0].x).dec)};e._addToHistory(o),e._triggerWgs84Changed(t,o)}var s}),this.element.on("converter.source.selection_changed converter.dest.selection_changed ",function(t,i){var n={wgs84:i.wgs84,srsCode:e._selection()};e._addToHistory(n),e._triggerConvergenceChange()}),this.element.on("converter.source.convergence_changed converter.dest.convergence_changed ",function(){e._triggerConvergenceChange()}),this.element.find(".history").click(function(){t(this).hasClass("next")?e._historyManager.moveToNext():e._historyManager.moveToPrevious(),e._restoreFromHistory()})},_triggerWgs84Changed:function(t,e){this._trigger(".wgs84_changed",t,e)},_triggerConvergenceChange:function(){this._trigger(".convergence_changed",null,{convergenceInDegrees:this._convergence()})},_reloadSucceeded:function(){this._loadDefinitionsObject(),this.options.masterLoadingToggleSwitch=!1,this._toggleLoading()},_reloadFailed:function(t){this._trigger(".fail",null,t)},_reload:function(){var e=this,i=o("Reload");return this._toggleLoading(!0),this._loadDefinitions().always(function(){e._toggleLoading(!1)}).done(function(){var n={};e.options.definitions.WGS84&&(e.options.definitions={"*World":e.options.definitions}),t.each(e.options.definitions,function(e,i){t.extend(n,i)}),i.resolve()}).fail(function(t,e){i.reject(e)}),i.promise()},_loadDefinitions:function(){var e=this,i=o("Load definitions");return"object"!==t.type(this.options.definitions)?i.reject("Wrong definitions type"):t.isEmptyObject(this.options.definitions)?t.ajax({url:this.options.url,data:{u:"u"},type:"POST",cache:!1,dataType:"json"}).done(function(t,n,o){void 0!==t.error?i.reject("Server Error",[o,n,t]):(e.options.definitions=t,i.resolve())}).fail(function(t,e,n){i.reject("Server Error",arguments)}):i.resolve(),i.promise()},_loadDefinitionsObject:function(){this._pushPullAll("loadDefinitionsObject",this.options.definitions)},_toggleLoading:function(t){t=this.options.masterLoadingToggleSwitch||!!t,this._pushPullAll("toggleLoading",t)},_addToHistory:function(t){this._historyManager.isEnabled()&&this._historyManager.add({wgs84:t.wgs84,sc:t.srsCode.source,dc:t.srsCode.destination})},_restoreFromHistory:function(){var t=this,e=this._historyManager.getCurrentValue();this._underTheRadar(function(){var i=e.wgs84.length>1;t.csv()!==i&&t.csv(i),t.transform(e),t.pushPullSource("selection",e.sc),t.pushPullDestination("selection",e.dc)})},_underTheRadar:function(e){if("function"!==t.type(e))throw"Invalid function";this._historyManager.toggle(!1),e(),this._historyManager.toggle(!0)},_pushPullWithCriterion:function(e,i,n,o){var s=null,l=this;return this.options.$containers.each(function(){t(this).converter("option",n)===o&&(s=l._pushPullOne(e,i,t(this)))}),s},_pushPullOne:function(t,e,i){var n=void 0===e?i.converter(t):i.converter(t,e);return this.options.hasOwnProperty(t)&&(this.options[t]=n),n},pushPullSource:function(t,e){return this._pushPullWithCriterion(t,e,"target","source")},pushPullDestination:function(t,e){return this._pushPullWithCriterion(t,e,"target","dest")},_pushPullAll:function(e,i){var n=this;return this.options.$containers.each(function(){n._pushPullOne(e,i,t(this))}),this.options[e]},_pullAll:function(t){return{source:this.pushPullSource(t),destination:this.pushPullDestination(t)}},wgs84:function(t){return this._pushPullAll("wgs84",t)},toggle:function(t){return this._pushPullAll("toggle",t)},_getFirstWgs84:function(){var e=null,i=this.wgs84();return t.each(i,function(){return!!this.error||(e=this,!1)}),e||{x:0,y:0}},_convergence:function(){return this._pullAll("convergence")},_selection:function(){return this.options.selections=this._pullAll("selection"),this.options.selections},setConvergence:function(){this._pushPullAll("setConvergence")},readOnly:function(){return this.options.readOnly},csv:function(t){if(t!=this.options.csv&&void 0!==t){if(!t){var e=[this._getFirstWgs84()];JSON.stringify(e[0])===JSON.stringify(this.wgs84()[0])?this.wgs84(e):this.transform({wgs84:e})}this._trigger(".csv_changed",null,{csv:t})}return this._pushPullAll("csv",t)},unloadCRS:function(t){this._pushPullAll("unloadCRS",t)},removeEmptyOptgroups:function(){this._pushPullAll("removeEmptyOptgroups")},mergeDefinitions:function(e){var i=this,n=new t.Deferred;return this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this.options.definitions="object"!==t.type(this.options.definitions)?{}:this.options.definitions,t.extend(!0,this.options.definitions,e),this._reload().progress(function(){n.notify("Reloading")}).done(function(){i._reloadSucceeded.apply(i,arguments),n.resolve()}).fail(function(){i._reloadFailed.apply(i,arguments),n.reject.apply(null,arguments)}),n.promise()},transform:function(e){var i,n=e.hasOwnProperty("wgs84");if(!(n&&"array"===t.type(e.wgs84)||e.hasOwnProperty("target")))throw"Wrong data format";n?this._pushPullAll("transform",e):"source"===e.target?(i=this.pushPullSource("transform",{input:null}),this.pushPullDestination("transform",{wgs84:i})):(i=this.pushPullDestination("transform",{input:null}),this.pushPullSource("transform",{wgs84:i}))},_setOption:function(t,e){return this._superApply(arguments)},_destroy:function(){return this._toggleLoading(!0),this._pushPullAll("destroy"),this._super()}}),t.widget("twcc.converter",{options:{readOnly:!1,wrapper:{fieldSet:["<div>"],title:["<h3>"],info:["<a>",{name:"info",href:"#"}]},projections:{},units:{},labels:{},options:{},angleUnit:"dd",lengthUnit:"m",convergence:null,hint:"",wgs84:[{x:0,y:0}],value:{x:0,y:0},selection:null,mapping:{aea:"cartesian",aeqd:"cartesian",cass:"cartesian",cea:"cartesian",csv:"csv",eqc:"cartesian",eqdc:"cartesian",equi:"cartesian",gauss:"cartesian",geocent:"cartesian",gnom:"cartesian",gstmerc:"cartesian",laea:"cartesian",lcc:"cartesian",longlat:"spherical",merc:"cartesian",mill:"cartesian",moll:"cartesian",nzmg:"cartesian",omerc:"cartesian",ortho:"cartesian",poly:"cartesian",sinu:"cartesian",somerc:"cartesian",stere:"cartesian",sterea:"cartesian",tmerc:"cartesian",utm:"utm",vandg:"spherical",connector:"connector"},$select:null,$container:null,csv:!1},_widget:void 0,_create:function(){t.extend(this.options,{$select:this.element.find("select.crs-list"),$container:this.element.find(".container")}),this._bindEvents(),this._unload()},_triggerTransform:function(t){t.preventDefault(),this._trigger(".transform",t,{target:this.options.target})},_bindEvents:function(){var t=this;this.options.$select.on("change",function(){t.selection()}),this.element.on("angleswitchgeofield.update_display",function(e,i){t.options.angleUnit=i.value,t.value(),t.updateContainer()}),this.element.find(".convert-button").click(function(e){t._triggerTransform(e)}),this.element.on("keyup","input, select",function(e){(function(t){return t.keyCode?t.keyCode:t.which})(e)==i.constants.keyboard.RETURN&&t._triggerTransform(e)})},_getFieldSetUnit:function(t){var e=this._getWidgetPrefix(t),i=this._getFieldSetUnitName(e);if(i)return this.options.units[i];var n=e.match(/([A-Z]?[a-z]*)/g);return(i=this._getFieldSetUnitName(n[1]))?this.options.units[i]:void 0},_getFieldSetUnitName:function(t){var e;switch(t){case"utm":e="cartesian";break;case"Dm":e="dms";break;case"csv":case"connector":break;default:e=t.toLowerCase()}if(e&&this.options.units.hasOwnProperty(e))return e},_getFieldSetLabel:function(t){var e=this._getWidgetPrefix(t),i=this._getFieldSetLabelName(e);if(i)return this.options.labels[i];var n=e.match(/([A-Z]?[a-z]*)/g);return(i=this._getFieldSetLabelName(n[0]))?this.options.labels[i]:void 0},_getFieldSetLabelName:function(t){var e;switch(t){case"utm":e="cartesian";break;case"connector":break;default:e=t.toLowerCase()}if(e&&this.options.labels.hasOwnProperty(e))return e},_getWidgetMidfix:function(t){var e="";return"spherical"===t&&(e=(e=this.options.angleUnit).charAt(0).toUpperCase()+e.substr(1).toLowerCase()),e},_getWidgetPrefix:function(t){var e;return t=this.options.projections[this.options.selection].isConnector&&"csv"!==t?"connector":t,this.options.mapping.hasOwnProperty(t)?e=this.options.mapping[t]:(console.error("Projection not found: "+t),e="cartesian"),e+this._getWidgetMidfix(e)},_getWidgetName:function(t){return this._getWidgetPrefix(t)+"FieldSet"},_unload:function(){this.element.find("select.crs-list, .container").empty(),this.projections={}},toggleLoading:function(t){this.element.find(".container").toggle(!t),this.element.find(".loading").toggle(!!t)},removeEmptyOptgroups:function(){this.options.$select.find("optgroup:empty").remove()},loadDefinitionsObject:function(e){var n,o=this,s=this.options.$select;if(this.options.definitions=e,this.removeEmptyOptgroups(),n=!1,t.each(this.options.definitions,function(e,s){t.each(s,function(t,s){o.options.$select.has('optgroup[label="'+e+'"] option[value="'+t+'"]').length||(i.utils.addOptionToSelect(e,t,o.options.$select,s.def),n=!0)})}),n){s.sortGrpsNOptionsByText();try{this.selection(this.options.selection||s.find("option:first").val())}catch(t){this.selection(s.find("option:first").val())}}},unloadCRS:function(e){var i=this;if(this.selection()===e){var n=this._widget.options.srsCode;this.selection(n)}this.options.$select.find('option[value="'+e.toString()+'"]').remove(),_proj.default.defs(e,void 0),delete this.options.projections[e],t.each(this.options.definitions,function(t,n){return!n.hasOwnProperty(e)||(delete i.options.definitions[t][e],!1)}),this.removeEmptyOptgroups()},updateContainer:function(){var e,i=this,n=this.selection();if(this.options.value=this.options.csv||"array"!==t.type(this.options.value)?this.options.value:this.options.value[0],this.options.value=this.options.csv&&"array"!==t.type(this.options.value)?[this.options.value]:this.options.value,n){this.options.projections.hasOwnProperty(n)||this._registerProjection(n);var o,s,l=this._getProjection(n),r=l.projName,a=this._getFieldSetUnit(r)||"",u=this._getFieldSetLabel(r)||"",p={srsCode:n,target:this.options.target,convergence:this.options.convergence,wgs84:this.options.wgs84,value:this.options.value,units:a,labels:u,lengthUnit:this.options.lengthUnit,options:this.options.options,readOnly:this.options.readOnly},c=l.title||n,h=this._getWidgetName(this.options.csv?"csv":l.projName),d=t.apply(null,this.options.wrapper.fieldSet);if(this.options.$container.empty(),(o=t.apply(null,this.options.wrapper.title)).append(c),(s=t.apply(null,this.options.wrapper.info)).click(function(t){i._trigger(".info",t,{srsCode:n,definitionString:l.defData})}),s.text(" [?]"),o.append(s),d.append(o),"csvFieldSet"==h){a=a.D?this.options.units.dd:a;var g=(("utm"===r?u.h+","+u.z+",":"")+(u.x?u.x+(a.x?"("+a.x.DD+")":"("+a.XY.m+")"):"")+(u.y?","+u.y+(a.y?"("+a.y.DD+")":"("+a.XY.m+")"):"")).replace(/[\s]*=[\s]*/gi,"");t.extend(p,{originalProjection:l.isConnector?"connector":r,hint:g,units:null,labels:this.options.labels.csv})}this._widget=d[h](p).data("twcc"+((e=h).charAt(0).toUpperCase()+e.substring(1))),this.options.$container.append(d)}},_registerProjection:function(e){var i;if(!_proj.default.defs(e)){var n=e.indexOf("Connector")>=0,o=function(e,i){var n="";return t.each(i,function(t,i){return!i.hasOwnProperty(e)||(n=i[e].def,!1)}),n}(e,this.options.definitions),s={defData:o,isConnector:n};_proj.default.defs(e,o),t.extend(_proj.default.defs(e),s)}i=t.extend({},_proj.default.defs(e)),this._setProjection(e,i)},_getProjection:function(t){if(!this.options.projections.hasOwnProperty(t))throw"Unknown srsCode";return this.options.projections[t]},_setProjection:function(t,e){this.options.projections[t]=e},selection:function(t){var e=this.options.$select,i=!1,n=this.options.selection;if(void 0!==t){this.options.selection=t;try{e.val(this.options.selection)}catch(t){}i=!0}else e.val()&&e.val()!=this.options.selection&&(this.options.selection=e.val(),i=!0);if(i){this.updateContainer();var o=this.options.selection,s=this.wgs84();this.transform({wgs84:s}),this.setConvergence(),n!==o&&this._trigger("."+this.options.target+".selection_changed",null,{wgs84:s,srsCode:o})}return this.options.selection},projection:function(){return this._getProjection(this.selection())},_pushPull:function(t,e){var i;return this._widget?(i=this._widget[t](e),this.options.hasOwnProperty(t)&&(this.options[t]=i),i):null},value:function(e){if(void 0!==e&&(!this.options.csv&&"object"!==t.type(e)||this.options.csv&&"array"!==t.type(e)))throw"Invalid type";return this._pushPull("value",e)},wgs84:function(t){return void 0!==t&&JSON.stringify(this.options.wgs84)!==JSON.stringify(t)&&(this._pushPull("wgs84",t),this._trigger("."+this.options.target+".wgs84_changed",null,{wgs84:t}),this.setConvergence()),this.options.wgs84},convergence:function(t){if(this._pushPull("convergence",t),void 0!==t){var e=this.wgs84();this._trigger("."+this.options.target+".convergence_changed",null,{wgs84:e})}return this.options.convergence},setConvergence:function(){if(this._widget&&"null"!==t.type(this._widget.convergence())){var e,n=this.wgs84()[0],o=new _proj.default.Proj(this.projection().defData),l=this._widget.zone?null:o.long0||null;e=function(t,e,n,o){var l=n||i.utils.degToRad(6*s(o.x)-183),r=i.utils.degToRad(o.y),a=i.utils.degToRad(o.x),u=(t-e)/t,p=u*Math.pow(Math.cos(r),2)/(1-u),c=a-l,h=Math.sin(r),d=(1+3*p+2*Math.pow(p,2))*Math.sin(r)*Math.pow(Math.cos(r),2)/3,g=(2-Math.pow(Math.tan(r),2))*Math.sin(r)*Math.pow(Math.cos(r),4)/15,f=c*h+Math.pow(c,3)*d+Math.pow(c,5)*g;return f*=-1,i.utils.radToDeg(f)}(o.a,o.b,l,n),this.convergence(e)}},csv:function(t){return void 0!==t&&(this.value(),this.options.csv=!!t,this.updateContainer()),this.options.csv},hint:function(t){return this._pushPull("hint",t)},toggle:function(t){return this._pushPull("toggle",t)},readOnly:function(){return this.options.readOnly},_formatCoordinates:function(e){if(t.inArray(t.type(e),["array","object"])<0)throw"Wrong data type";return"array"===t.type(e)?e:[e]},_setupInputProjection:function(t,e,i,n){var o=i?{z:s(e.x),h:l(e.y)}:n,r=t.defData;return r=(r=r.replace(/\+zone=[^\s]+/gi,"+zone="+o.z)).replace("+south",""),r+="s"===o.h?" +south":"",new _proj.default.Proj(r)},_isValidPoint:function(e,i){var n=1;return n&="object"===t.type(e),n&=e.hasOwnProperty("x"),i?n&=e.x.indexOf("INPUT ERROR ON LINE ")<0:(n&=e.hasOwnProperty("y"),n&="number"===t.type(e.x)&&!isNaN(e.x),n&="number"===t.type(e.y)&&!isNaN(e.y)),!!n},_getConnector:function(){var e=this.selection();return window.hasOwnProperty(e)||t.ajax({url:"/js/connectors/"+e+".js",async:!1,cache:!0,dataType:"script"}),window[e].getInstance(i.context)},transform:function(e){var i,n,o,s,l=this,r=[],a=[],u=e.hasOwnProperty("wgs84"),p=this.value(),c=_proj.default.WGS84,h=this.projection(),d=h.defData.indexOf("+proj=utm")>-1,g={type:"pivot",getProjection:function(){return t.extend({isConnector:c.isConnector},new _proj.default.Proj(c.defData))}},f={type:"input",getProjection:function(){return d?l._setupInputProjection.apply(l,arguments):t.extend({isConnector:h.isConnector},new _proj.default.Proj(h.defData))}};if(!u&&!e.hasOwnProperty("input"))throw"Wrong data format";this.toggleLoading(!0);var _=u?e.wgs84:e.input;return u&&_&&this.wgs84(_),u?(i=_||this.wgs84(),s={A:g,B:f}):(i=_||p,s={A:f,B:g},o=this._widget.options.originalProjection),n=this._formatCoordinates(i),t.each(n,function(e,i){var n,c={},d=l.wgs84()[e],g="array"===t.type(p)?p[e]:p,f=s.A.getProjection(h,d,u,g),_=s.B.getProjection(h,d,u,g),v="connector"===o||!u&&f.isConnector,F=u&&_.isConnector,y=v||F;!l._isValidPoint(i,v)||u&&d.error?(a.push({x:0,y:0,error:!0}),r.push("INPUT ERROR ON LINE "+(e+1))):(y&&(n=l._getConnector()),y&&u?c[s.B.type]=n.forward(i):(y&&(i=n.inverse(i)),c[s.B.type]=(0,_proj.default)(f,_,t.extend({},i))),c[s.A.type]=t.extend({},i),a.push({x:c.pivot.x,y:c.pivot.y}),r.push({x:c.input.x,y:c.input.y}))}),this.csv()||(r=r[0]),u?this.value(r):this.wgs84(a),this.toggleLoading(!1),this.wgs84()},_setOption:function(t,e){return this._superApply(arguments)},_destroy:function(){return this._unload(),this._super()}}),t.widget("twcc.fieldSet",{options:{srsCode:null,value:{},units:{},target:null,wrapper:{set:["<div>",{class:"table"}],geoField:["<div>",{class:"row"}],geoCaption:["<div>",{class:"caption"}]},readOnly:!1,geoFields:{},geoFieldsIndex:0,wgs84:null},_create:function(){var e,i=t.apply(null,this.options.wrapper.set);e=this._getGeoFieldsOptions(),this._setDefaultsGeoFieldsOptions(e),this._buildGeoFields(i,e),this._setFieldsHandlers(),this.element.append(i)},_setFieldsHandlers:function(){},_setDefaultsGeoFieldsOptions:function(e){var i=this;t.each(e,function(n,o){var s={name:i.options.srsCode+"_"+i.options.target,readOnly:i.options.readOnly,unit:i.options.units,target:i.options.target,value:i.options.value[o.options.axis]};e[n].options=t.extend(s,e[n].options)})},_buildGeoField:function(e,i,n,o){var s,l=this.options.geoFieldsIndex++;s=n.indexOf("Switch")>=0||n.indexOf("connector")>=0?t.apply(null,this.options.wrapper.geoCaption):t.apply(null,this.options.wrapper.geoField),this.options.geoFields[l]=s[n](o),e.append(s)},_buildGeoFields:function(e,i){var n=this;t.each(i,function(t,i){n._buildGeoField(e,t,i.type,i.options)})},_getGeoFieldsOptions:function(){return{}},_getConvergenceIcon:function(){return'<img src="'+i.system.dirWsImages+"GN_"+this.options.target+'.png" alt="">'},convergence:function(){return null},hint:function(){return null},wgs84:function(t){return void 0===t?this._getWgs84():this._setWgs84(t)},_getWgs84:function(){return this.options.wgs84},_setWgs84:function(t){return this.options.wgs84=t,this.options.wgs84},value:function(t){return this.options.value=void 0===t?this._getValue():this._setValue(t),this._setToStringMethod(),this.options.value},_getValue:function(){return this.options.value},_setValue:function(t){this.options.value=t},_setToStringMethod:function(){var t=this;this.options.value.toString=function(){return t._getStringValue()}},_getStringValue:function(){return""},toggle:function(t){return t=void 0===t?this.options.readOnly:!!t,this.options.readOnly=this._toggle(t),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(t){return!t},_setOption:function(t,e){return this._superApply(arguments)},_destroy:function(){return this.element.empty(),this._super()}}),t.widget("twcc.connectorFieldSet",t.twcc.fieldSet,{options:{options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"connectorGeoField",options:{axis:"x"}}]},_getValue:function(){return{x:this.options.geoFields[0].connectorGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[0].connectorGeoField("value",t.x)}},_toggle:function(t){return this.options.geoFields[0].connectorGeoField("toggle",t)},_getStringValue:function(){return this.options.geoFields[0].connectorGeoField("value")}}),t.widget("twcc.csvFieldSet",t.twcc.fieldSet,{options:{labels:{},units:{},options:{},geoFields:{},value:[],hint:"",wgs84:[],originalProjection:null},_getGeoFieldsOptions:function(){return[{type:"csvGeoField",options:{value:this._toString(this.options.value),label:this.options.labels.csv}},{type:"labelGeoField",options:{value:this.options.hint,label:this.options.labels.l}}]},_getValue:function(){return this._fromString(this.options.geoFields[0].csvGeoField("value"))},_setValue:function(t){return this._fromString(this.options.geoFields[0].csvGeoField("value",this._toString(t)))},_fromString:function(e){var i=e.split("\n"),n=this;return t.each(i,function(t,e){var o=e.split(",");switch(n.options.originalProjection){case"utm":i[t]={h:o[0],z:+o[1],x:+o[2],y:+o[3]};break;case"connector":i[t]={x:o[0],y:o[1]};break;default:i[t]={x:+o[0],y:+o[1]}}}),i},_toString:function(e){var i=[],n=this;if("array"!==t.type(e))throw"Invalid type";return t.each(e,function(t,e){var o=n.wgs84()[t];if(o.error)i.push(e.toString());else if("utm"==n.options.originalProjection){var r=e.h||l(o.y),a=e.z||s(o.x);i.push(r+","+a+","+e.x+","+e.y)}else i.push(e.x+","+e.y)}),i.join("\n")},originalProjection:function(t){if(void 0===t)return this.options.originalProjection;this.options.originalProjection=t},hint:function(t){if(void 0===t)return this.options.hint=this.options.geoFields[1].labelGeoField("value"),this.options.hint;this.options.hint=t,this.options.geoFields[1].labelGeoField("value",this.options.hint)},_toggle:function(t){return this.options.geoFields[0].csvGeoField("toggle",t),this.options.geoFields[1].labelGeoField("toggle",t)},_getStringValue:function(){return this.options.hint+"\n"+this.options.geoFields[0].csvGeoField("value")}}),t.widget("twcc.utmFieldSet",t.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0,wgs84:[]},_getGeoFieldsOptions:function(){return[{type:"hemisphereGeoField",options:{label:this.options.labels.h,options:this.options.options.h,axis:"h"}},{type:"zoneGeoField",options:{label:this.options.labels.z,options:this.options.options.z,axis:"z"}},{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var t=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(e,i){t.options.lengthUnit=t.unit(i.value)})},_getValue:function(){return{h:this.hemisphere(),z:this.zone(),x:this.options.geoFields[2].xyGeoField("value"),y:this.options.geoFields[3].xyGeoField("value")}},_setValue:function(e){var i=this._getWgs84()[0];return e.h&&e.z||t.extend(e,{y:Math.abs(e.y),h:l(i.y),z:s(i.x)}),{h:this.hemisphere(e.h),z:this.zone(e.z),x:this.options.geoFields[2].xyGeoField("value",e.x),y:this.options.geoFields[3].xyGeoField("value",e.y)}},unit:function(t){return void 0===t?this.options.lengthUnit=this.options.geoFields[2].xyGeoField("unit"):(this.options.geoFields[2].xyGeoField("unit",t),this.options.geoFields[3].xyGeoField("unit",t),this.options.lengthUnit=this.options.geoFields[5].lengthSwitchGeoField("value",t)),this.options.lengthUnit},convergence:function(t){return this.options.convergence=void 0===t?this.options.geoFields[4].convergenceGeoField("value"):this.options.geoFields[4].convergenceGeoField("value",t),this.options.convergence},zone:function(t){return this.options.value.z=void 0===t?this.options.geoFields[1].zoneGeoField("value"):this.options.geoFields[1].zoneGeoField("value",t),this.options.value.z},hemisphere:function(t){return this.options.value.h=void 0===t?this.options.geoFields[0].hemisphereGeoField("value"):this.options.geoFields[0].hemisphereGeoField("value",t),this.options.value.h},_toggle:function(t){return this.options.geoFields[0].hemisphereGeoField("toggle",t),this.options.geoFields[1].zoneGeoField("toggle",t),this.options.geoFields[2].xyGeoField("toggle",t),this.options.geoFields[3].xyGeoField("toggle",t),this.options.geoFields[5].lengthSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[2].xyGeoField("getStringValue")+", "+t[3].xyGeoField("getStringValue")+" "+t[1].zoneGeoField("value")+t[0].hemisphereGeoField("value")}}),t.widget("twcc.cartesianFieldSet",t.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0},_getGeoFieldsOptions:function(){return[{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var t=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(e,i){t.options.lengthUnit=t.unit(i.value)})},_getValue:function(){return{x:this.options.geoFields[0].xyGeoField("value"),y:this.options.geoFields[1].xyGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[0].xyGeoField("value",t.x),y:this.options.geoFields[1].xyGeoField("value",t.y)}},unit:function(t){return void 0===t?this.options.lengthUnit=this.options.geoFields[0].xyGeoField("unit"):(this.options.geoFields[0].xyGeoField("unit",t),this.options.geoFields[1].xyGeoField("unit",t),this.options.lengthUnit=this.options.geoFields[3].lengthSwitchGeoField("value",t)),this.options.lengthUnit},convergence:function(t){return this.options.convergence=void 0===t?this.options.geoFields[2].convergenceGeoField("value"):this.options.geoFields[2].convergenceGeoField("value",t),this.options.convergence},_toggle:function(t){return this.options.geoFields[0].xyGeoField("toggle",t),this.options.geoFields[1].xyGeoField("toggle",t),this.options.geoFields[3].lengthSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].xyGeoField("getStringValue")+", "+t[1].xyGeoField("getStringValue")}}),t.widget("twcc.sphericalDdFieldSet",t.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"ddGeoField",options:{unit:this.options.units.y,label:this.options.labels.y,axis:"y"}},{type:"ddGeoField",options:{unit:this.options.units.x,label:this.options.labels.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dd",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].ddGeoField("value"),y:this.options.geoFields[0].ddGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[1].ddGeoField("value",t.x),y:this.options.geoFields[0].ddGeoField("value",t.y)}},_toggle:function(t){return this.options.geoFields[0].ddGeoField("toggle",t),this.options.geoFields[1].ddGeoField("toggle",t),this.options.geoFields[2].angleSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].ddGeoField("getStringValue")+", "+t[1].ddGeoField("getStringValue")}}),t.widget("twcc.sphericalDmFieldSet",t.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dm",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmGeoField("value"),y:this.options.geoFields[0].dmGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[1].dmGeoField("value",t.x),y:this.options.geoFields[0].dmGeoField("value",t.y)}},_toggle:function(t){return this.options.geoFields[0].dmGeoField("toggle",t),this.options.geoFields[1].dmGeoField("toggle",t),this.options.geoFields[2].angleSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].dmGeoField("getStringValue")+", "+t[1].dmGeoField("getStringValue")}}),t.widget("twcc.sphericalDmsFieldSet",t.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmsGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmsGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dms",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmsGeoField("value"),y:this.options.geoFields[0].dmsGeoField("value")}},_setValue:function(t){return{x:this.options.geoFields[1].dmsGeoField("value",t.x),y:this.options.geoFields[0].dmsGeoField("value",t.y)}},_toggle:function(t){return this.options.geoFields[0].dmsGeoField("toggle",t),this.options.geoFields[1].dmsGeoField("toggle",t),this.options.geoFields[2].angleSwitchGeoField("toggle",t)},_getStringValue:function(){var t=this.options.geoFields;return t[0].dmsGeoField("getStringValue")+", "+t[1].dmsGeoField("getStringValue")}}),t.widget("twcc.geoField",{options:{name:null,unit:null,label:null,readOnly:!1,lengthUnit:"m",glue:"_",wrapper:{field:["<span>"],fields:["<div>",{class:"cell fields"}],label:["<div>",{class:"cell label"}],options:["<div>",{class:"fields"}]},attributes:{},fields:{},icon:""},_create:function(){var e,i,n=this;t.each(this.options.attributes,function(e){var i={disabled:n.options.readOnly,readonly:n.options.readOnly};n.options.attributes[e]=t.extend(i,n.options.attributes[e])}),e=this._getEmptyFieldCell(),i=this._getFieldsOptions(),this._setDefaultsFieldsOptions(i),t.each(i,function(t,i){var o=n._buildField(t,i);n._setFieldHandlers(o),o.append(n._getFieldSetUnit(t)),o.append("&nbsp;"),e.append(o)}),this._appendLabelCell(),this.element.append(e)},_getFieldSetUnit:function(t){return this.options.unit[t]},_setFieldHandlers:function(){},_clean:function(t,e){return this._superClean(t,e)},_superClean:function(t,e){return isNaN(t)||null===t?"":i.math.round(t,e||0)},_buildField:function(e,i){return this.options.fields[e]=t.apply(null,this.options.wrapper.field).field(i),this.options.fields[e]},_appendLabelCell:function(){var e,i,n=this._getForId();e=n?t("<label>",{for:n}).html(this.options.icon+this.options.label):this.options.icon+this.options.label,i=t.apply(null,this.options.wrapper.label).append(e),this.element.append(i)},_getForId:function(){},_getEmptyFieldCell:function(){return t.apply(null,this.options.wrapper.fields)},_getFieldsOptions:function(){return{}},_setDefaultsFieldsOptions:function(e){var i=this;t.each(e,function(n){var o={name:i.options.name+i.options.glue+n,attributes:i.options.attributes[n],value:i._clean(i.options.value)};e[n]=t.extend(o,e[n])})},value:function(t){return this.options.value=void 0===t?this._constraint(this._getRawValue()):this._setValue(this._clean(t)),this.options.value},toggle:function(t){return t=void 0===t?this.options.readOnly:!!t,this.options.readOnly=this._toggle(t),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(e){var i=this;return t.each(this.options.fields,function(t,n){var o=i._getFieldsOptions()[t];i._toggleField(n,e,o)}),!e},_toggleField:function(t,e){t.field("toggle",e)},_getRawValue:function(){return this.options.value},getStringValue:function(){return this.options.value},_constraint:function(t){return t},_setValue:function(t){this.options.value=t},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),t.widget("twcc.ddGeoField",t.twcc.geoField,{options:{value:0,attributes:{DD:{size:"20",class:"width_5"}}},_getFieldsOptions:function(){return{DD:{type:"text"}}},_getForId:function(){return this.options.fields.DD.field("id")},_getRawValue:function(){return i.math.parseFloat(this.options.fields.DD.field("value"))},getStringValue:function(){return this.options.value+this._getFieldSetUnit("DD")},_setValue:function(t){return this.options.fields.DD.field("value",t)},_constraint:function(t){var e="y"===this.options.axis?180*Math.atan(Math.sinh(Math.PI))/Math.PI:180,i=-e;return t=Math.max(t,i),t=Math.min(t,e)},_clean:function(t){return this._constraint(this._super(t,15))}}),t.widget("twcc.dmGeoField",t.twcc.ddGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"6",class:"width_3"}}},_buildField:function(e,i){return"option"===i.type?(this.options.fields[e]=t.apply(null,this.options.wrapper.field).optionField(i),this.options.fields[e]):this._superApply(arguments)},_getFieldsOptions:function(){var t=this._clean(this.options.value);return{C:{type:"option",value:t.C||"",options:this.options.options},D:{type:"text",value:this._superClean(t.D)},M:{type:"text",value:this._superClean(t.M,12)}}},_getForId:function(){return this.options.fields.D.field("id")},_getFieldSetUnit:function(t){return"C"!=t?this._superApply(arguments):""},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:i.math.parseFloat(this.options.fields.D.field("value")),M:i.math.parseFloat(this.options.fields.M.field("value"))}},value:function(t){return void 0===t?this._clean(function(t){var e,i,o;return void 0!==t&&(e=Math.abs(n(t.D)),e+=Math.abs(n(t.M))/60,i=n(t.D)>=0?1:-1,o=(i*="N"==t.C||"E"==t.C?1:-1)*e),o}(this._getObjectValue())):(t=this._clean(t),this.options.fields.C.optionField("value",t.C||""),this.options.fields.D.field("value",this._superClean(t.D)),this.options.fields.M.field("value",this._superClean(t.M,12))),this.options.value},getStringValue:function(){var t=this._getObjectValue();return t.D+this._getFieldSetUnit("D")+t.M+this._getFieldSetUnit("M")+t.C},_clean:function(e){return this.options.value=this._constraint(e),function(e,i){var n,o,s;return"number"!==t.type(+e)||isNaN(e)?(n=0,o=0,i&&(s=i.N?"N":"E")):(i&&(s=e>=0?i.N?"N":"E":i.S?"S":"W"),o=60*((e=Math.abs(e))-(n=Math.floor(e)))),{C:s,D:n.toString(),M:o.toString()}}(this.options.value,this.options.options)},_toggleField:function(t,e,i){return"option"===i.type?t.optionField("toggle",e):this._superApply(arguments)}}),t.widget("twcc.dmsGeoField",t.twcc.dmGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"4",class:"width_1"},S:{size:"6",class:"width_3"}}},_getFieldsOptions:function(){var t=this._clean(this.options.value);return{C:{type:"option",value:t.C||"",options:this.options.options},D:{type:"text",value:this._superClean(t.D)},M:{type:"text",value:this._superClean(t.M)},S:{type:"text",value:this._superClean(t.S,12)}}},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:i.math.parseFloat(this.options.fields.D.field("value")),M:i.math.parseFloat(this.options.fields.M.field("value")),S:i.math.parseFloat(this.options.fields.S.field("value"))}},value:function(t){return void 0===t?this._clean(function(t){var e,i,o;return void 0!==t&&(e=Math.abs(n(t.D)),e+=Math.abs(n(t.M))/60,e+=Math.abs(n(t.S))/3600,i=n(t.D)>=0?1:-1,o=(i*="N"==t.C||"E"==t.C?1:-1)*e),o}(this._getObjectValue())):(t=this._clean(t),this.options.fields.C.optionField("value",t.C||""),this.options.fields.D.field("value",this._superClean(t.D)),this.options.fields.M.field("value",this._superClean(t.M)),this.options.fields.S.field("value",this._superClean(t.S,12))),this.options.value},getStringValue:function(){var t=this._getObjectValue();return t.D+this._getFieldSetUnit("D")+t.M+this._getFieldSetUnit("M")+t.S+this._getFieldSetUnit("S")+t.C},_clean:function(e){return this.options.value=this._constraint(e),function(e,i){var n,o,s,l,r;return"number"!==t.type(+e)||isNaN(e)?(n=0,s=0,l=0,i&&(r=i.N?"N":"E")):(i&&(r=e>=0?i.N?"N":"E":i.S?"S":"W"),l=60*((o=60*((e=Math.abs(e))-(n=Math.floor(e))))-(s=Math.floor(o)))),{C:r,D:n.toString(),M:s.toString(),S:l.toString()}}(this.options.value,this.options.options)}}),t.widget("twcc.switchGeoField",t.twcc.geoField,{_clean:function(t){return this._constraint(t)},_setFieldHandlers:function(t){var e=this;t.find(":first-child").click(function(t){e._trigger(".update_display",t,{value:e.value()})})},_appendLabelCell:function(){},_getEmptyFieldCell:function(){return t.apply(null,this.options.wrapper.options)},_setDefaultsFieldsOptions:function(){},_getRawValue:function(){return t("input:radio:checked",this.element).val()},_setValue:function(t){return this.element.find('input:radio[value="'+t+'"]').prop("checked",!0),t},_getForId:function(t){return this.options.fields[t].field("id")},_getFieldSetUnit:function(e){var i=this._superApply(arguments),n=this._getForId(e);return t("<label>",{for:n}).append(i)}}),t.widget("twcc.angleSwitchGeoField",t.twcc.switchGeoField,{options:{value:"dd"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var t=this.options.name+"_DMS_DM_DD",e=this.options.value,i="dd"===e,n="dm"===e;return{_DMS:{name:t,type:"radio",value:"dms",attributes:{checked:!i&&!n}},_DM:{name:t,type:"radio",value:"dm",attributes:{checked:n}},_DD:{name:t,type:"radio",value:"dd",attributes:{checked:i}}}},_constraint:function(e){return t.inArray(e,["dms","dm","dd"])<0?"dms":e}}),t.widget("twcc.lengthSwitchGeoField",t.twcc.switchGeoField,{options:{value:"m"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var t=this.options.name+"_M_KM_F",e=this.options.value,i="km"===e,n="us-ft"===e;return{_M:{name:t,type:"radio",value:"m",attributes:{checked:!i&&!n}},_KM:{name:t,type:"radio",value:"km",attributes:{checked:i}},_F:{name:t,type:"radio",value:"us-ft",attributes:{checked:n}}}},_constraint:function(e){return t.inArray(e,["m","km","us-ft"])<0?"m":e}}),t.widget("twcc.xyGeoField",t.twcc.geoField,{options:{value:0,attributes:{XY:{size:"20",class:"width_4"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XY:{type:"text"}}},_getForId:function(){return this.options.fields.XY.field("id")},_getFieldSetUnit:function(){return this.options.unit.XY[this.options.lengthUnit]},_getRawValue:function(){return a(this.options.fields.XY.field("value"),this.options.lengthUnit)},getStringValue:function(){return this.options.fields.XY.field("value")+this.options.lengthUnit},_setValue:function(t){return a(this.options.fields.XY.field("value",t),this.options.lengthUnit)},_clean:function(t){return this._super(function(t,e){return n(t)/r(e)}(t,this.options.lengthUnit),"m"==this.options.lengthUnit?3:5)},unit:function(t){return void 0!==t&&(this.value(),this.options.lengthUnit=this._cleanUnit(t),this._update()),this.options.lengthUnit},_cleanUnit:function(e){return t.inArray(e,["m","km","us-ft"])<0?"m":e}}),t.widget("twcc.zoneGeoField",t.twcc.geoField,{options:{value:31,attributes:{Z:{size:"5",class:"width_2"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{Z:{type:"text"}}},_getForId:function(){return this.options.fields.Z.field("id")},_getRawValue:function(){return parseInt(this.options.fields.Z.field("value"))},_setValue:function(t){return this.options.fields.Z.field("value",t)},_constraint:function(t){return t=Math.max(t,0)},_clean:function(t){return this._constraint(this._super(t))}}),t.widget("twcc.hemisphereGeoField",t.twcc.geoField,{options:{value:"n",attributes:{E:{size:"1"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{E:{type:"option",options:this.options.options}}},_getForId:function(){return this.options.fields.E.optionField("id")},_getFieldSetUnit:function(){},_buildField:function(e,i){return this.options.fields[e]=t.apply(null,this.options.wrapper.field).optionField(i),this.options.fields[e]},_clean:function(t){return this._constraint(t||"n")},_getRawValue:function(){return this.options.fields.E.optionField("value")},_constraint:function(e){return t.inArray(e,["n","s"])<0?"n":e},_setValue:function(t){return this.options.fields.E.optionField("value",t)},_toggleField:function(t,e){return t.optionField("toggle",e)}}),t.widget("twcc.csvGeoField",t.twcc.geoField,{options:{value:"",attributes:{CSV:{rows:"5",wrap:"off"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CSV:{type:"textarea"}}},_getFieldSetUnit:function(){return""},_getForId:function(){return this.options.fields.CSV.textareaField("id")},_buildField:function(e,i){return this.options.fields[e]=t.apply(null,this.options.wrapper.field).textareaField(i),this.options.fields[e]},_clean:function(t){return this._constraint(t||"")},_getRawValue:function(){return this.options.fields.CSV.textareaField("value")},_setValue:function(t){return this.options.fields.CSV.textareaField("value",t)},_toggleField:function(t,e){return t.textareaField("toggle",e)}}),t.widget("twcc.convergenceGeoField",t.twcc.geoField,{options:{value:0,attributes:{CONVERGENCE:{size:"10",class:"width_4",readonly:!0}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CONVERGENCE:{type:"text"}}},_getForId:function(){return this.options.fields.CONVERGENCE.field("id")},_getRawValue:function(){return this.options.fields.CONVERGENCE.field("value")},_constraint:function(t){return t=Math.max(t,-360),t=Math.min(t,360)},_setValue:function(t){return this.options.fields.CONVERGENCE.field("value",t)},_clean:function(t){return this._constraint(this._super(t,4))}}),t.widget("twcc.connectorGeoField",t.twcc.geoField,{options:{value:""},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XX:{type:"text"}}},_appendLabelCell:function(){},_getRawValue:function(){return this.options.fields.XX.field("value")},_setValue:function(t){return this.options.fields.XX.field("value",t)},_constraint:function(t){return t},_clean:function(t){return this._constraint(t)}}),t.widget("twcc.labelGeoField",t.twcc.geoField,{options:{value:""},_create:function(){this._super(),this.options.fields.L.text(this.options.value)},_buildField:function(t,e){return this.options.fields[t]=e,this.options.fields[t]},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{L:t("<span>")}},_getFieldSetUnit:function(){return""},_getRawValue:function(){return this.options.fields.L.text()},_constraint:function(t){return t},_setValue:function(t){return this.options.fields.L.text(t),t},_clean:function(t){return this._constraint(t)},_toggleField:function(){return this.options.readonly}}),t.widget("twcc.field",{options:{type:null,value:null,name:null,glue:"_id_",attributes:{},readOnly:!1},_create:function(){this.options.attributes=t.extend({val:this.options.value,id:this.options.name+this.options.glue+Math.floor(10001*Math.random()),name:this.options.name,disabled:this.options.readOnly,readonly:this.options.readOnly},this.options.attributes),this._setTag()},_setTag:function(){t.extend(this.options.attributes,{type:this.options.type}),this.element.tag({name:"input",attributes:this.options.attributes})},value:function(t){return this.options.value=void 0===t?this.element.tag("value"):this.element.tag("value",t),this.options.value},toggle:function(t){return t=void 0===t?this.options.readOnly:!!t,this.options.readOnly=this._toggle(t),this.options.readOnly},_toggle:function(t){return this.element.tag("toggle",t)},readOnly:function(){return this.options.readOnly},id:function(){return this.options.attributes.id},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),t.widget("twcc.textareaField",t.twcc.field,{options:{type:"textarea"},_setTag:function(){this.element.tag({name:"textarea",attributes:this.options.attributes})}}),t.widget("twcc.optionField",t.twcc.field,{options:{type:"option",options:{}},_setTag:function(){this.element.selectTag({attributes:this.options.attributes,options:this.options.options})},value:function(t){return this.options.value=void 0===t?this.element.selectTag("value"):this.element.selectTag("value",t),this.options.value},_toggle:function(t){return this.element.selectTag("toggle",t)}}),t.widget("twcc.tag",{options:{name:null,attributes:{},readOnly:!1},_$elt:null,_create:function(){var e;this.options.attributes.val&&(this.options.attributes.val=this._clean(this.options.attributes.val)),this.options.attributes.hasOwnProperty("checked")&&(e=this.options.attributes.checked,delete this.options.attributes.checked),this._$elt=t("<"+this.options.name+">",this.options.attributes),void 0!==e&&this._$elt.prop("checked",e),this._appendChildren(),this.value(this.options.attributes.val),this.element.append(this._$elt)},value:function(t){return void 0===t?this.options.attributes.val=this._$elt.val():(this.options.attributes.val=this._clean(t),this._$elt.val(this.options.attributes.val)),this.options.attributes.val},toggle:function(t){var e=void 0===t?this.options.readOnly:!t;return this.options.readOnly=this._toggle(e),this.options.readOnly},_toggle:function(t){return this._$elt.prop("disabled",t).prop("readonly",t),t},readOnly:function(){return this.options.readOnly},_clean:function(t){return"number"==typeof t&&t.toString().split("e").length>1&&(t=i.math.round(t)),t},_appendChildren:function(){},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this._$elt.remove(),this._super()}}),t.widget("twcc.selectTag",t.twcc.tag,{options:{name:"select",options:{}},_$elt:null,_appendChildren:function(){var e=this;t.each(this.options.options,function(i,n){e._$elt.append(t("<option>",{value:i,text:n}))})}})}(jQuery,TWCCHistory,App);

},{"proj4":421}],2:[function(require,module,exports){
"use strict";var _proj=_interopRequireDefault(require("proj4"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}!function(t,e){console.log("proj4 version:",_proj.default.version);var n,o,i=e.locations.capitals;function r(t){return e.translations.hasOwnProperty(t)?e.translations[t]:t}function a(t,e,n){t.trigger(e,{data:n})}function s(e){return t.cookie(e)}function u(e,n,o){o=o||30,t.cookie(e,n,{expires:o})}function p(t,e,n){u(t,JSON.stringify(e),n)}function c(e){return s(e)?t.parseJSON(s(e)):{}}function f(t,n){var o,i,r,a,s;o=e.system.preferencesCookie,i=t,r=n,a=7,(s=c(o))[i]=r,p(o,s,a)}function d(t){return n=e.system.preferencesCookie,o=t,c(n)[o];var n,o}function l(){var n=t("#map");n.on("linestring.edit_end",function(t,n){!function(t){v()||e.TWCCUi.setCsvMode(!0);m(t.map(h))}(n.data)}),n.on("map.click",function(t,e){y(e.data)}),n.on("marker.drag_end",function(t,e){y(e.data)}),n.on("linestring.add_vertice",function(t,e){if(v()){var n=g();n.push(h(e.data)),m(n)}}),n.on("linestring.remove_vertice",function(t,e){if(v()){var n=h(e.data);m(g().filter(function(t){return!(t.x.toFixed(13)===n.x.toFixed(13)&&t.y.toFixed(13)===n.y.toFixed(13))}))}}),n.on("place.changed",function(t,e){y(e.data)}),n.on("map.layer.change",function(t,e){var n=e.data.split(" "),o=d("layers")||{};n.indexOf("on")>-1||n.indexOf("off")>-1?(o.hasOwnProperty("opt")||(o.opt={}),o.opt[n[1]]="on"===n[2]):(o.base={},o.base[n[0]]=n[1]),f("layers",o)})}function C(t,e){return/\+title=/gi.test(t)?t.replace(/.*\+title=([^\+]+).*/gi,"$1"):e}function g(){return n.wgs84().slice()}function y(t){m([h(t)])}function m(t){n.transform({wgs84:t})}function h(t){return{x:t[0],y:t[1]}}function v(){return n.csv()}function T(){t("#map-container").length?e.initialisers.initializeMap().done(x):x()}function x(){e.initialisers.initializeConverter().done(function(n){e.context.GET.isSetGraticule&&e.TWCCMap.setGraticule(),e.TWCCUi.startHelp(),a(t("body"),"main.ready",n)})}t.fn.extend({sort:function(){return this.pushStack([].sort.apply(this,arguments),[])},sortOptions:function(t){return jQuery("option",this).sort(t).appendTo(this),this},sortGroups:function(t){return jQuery("optgroup",this).sort(t).appendTo(this),this},sortOptionsByText:function(){return this.sortOptions(function(t,e){var n=jQuery(t).text().toUpperCase(),o=jQuery(e).text().toUpperCase();return n<o?-1:n>o?1:0})},sortOptgroupsByLabel:function(){return this.sortGroups(function(t,e){var n=jQuery(t).prop("label").toUpperCase(),o=jQuery(e).prop("label").toUpperCase();return n<o?-1:n>o?1:0})},sortGrpsNOptionsByText:function(){var e=this;return t("optgroup",this).each(function(n){t("optgroup:eq("+n+")",e).sortOptionsByText()}),this.sortOptgroupsByLabel()},getXDomain:function(n){var o=e.system.httpServer+"/"+e.system.dirWsIncludes+"proxy.php",i=n.data?"?"+t.param(n.data,!0):"";return t.ajax(t.extend({dataType:"script"},n,{url:o,cache:!0,data:{u:n.url+i}}))}}),t.extend(e,{utils:{addOptionToSelect:function(e,n,o,i){var r=_proj.default.defs(n),a=r?r.title||n:C(i,n),s='optgroup[label="'+e+'"]';o.find(s).length||o.append(t("<optgroup>",{label:e})),o.find(s).append(t("<option>",{val:n,text:a}))},degToRad:function e(n){var o;switch(t.type(n)){case"object":o={},t.each(n,function(n,i){if(i&&"number"!==t.type(i))throw"Wrong data type";o[n]=e(i)});break;case"number":o="number"===t.type(n)?n*Math.PI/180:void 0}return o},enableAutoZoom:function(t){e.TWCCMap.model.setBoolean("autoZoom",t)},getConvergenceConvention:function(){return e.TWCCUi.getConvergenceConvention()},getCookieContent:c,getPreferenceCookie:d,getRandomCityLocation:function(){var t=e.math.getRandomInteger(0,i.length-1);return{x:i[t].lng,y:i[t].lat}},getTitleFromDefinitionString:C,getWMM:function(){return o},newDeferred:function(n,o,i){var r=new t.Deferred(function(){a(t("body"),"main.start",{name:n})});return o=o||e.system.timeout,i=i||0,setTimeout(function t(){i>0?(i--,r.notify("retry"),setTimeout(t,o)):r.reject(n+" timed out")},o),setTimeout(function t(){"pending"===r.state()&&(r.notify(n+" pending"),setTimeout(t,500))},1),function(e,n){t.when(e).then(function(e){var o="string"==typeof e||e instanceof String?e:null;a(t("body"),o?"main.failed":"main.succeeded",{name:n,message:o})},function(e){a(t("body"),"main.failed",{name:n,message:e})},function(e){a(t("body"),"main.progress",{name:n,message:e})})}(r,n),r},radToDeg:function(e){return"number"===t.type(e)?180*e/Math.PI:void 0},sendMsg:function(n,o,i){var a,s;return o=o||e.system.applicationNoreply,s=e.system.httpServer+"/"+e.system.dirWsIncludes+"s.php",(a=t.ajax({type:"POST",url:s,async:!1,cache:!1,data:"ff=g"}).responseText).length<10?(alert(r("messageNotSent")+a),!1):(u(e.system.tokenName,a),t.post(s,{ff:"d",f:o,b:n,l:e.context.languageCode},function(t){"function"==typeof i&&i(t)}),!0)},setCookie:u,setCookieContent:p,setPreferenceCookie:f,t:r,trigger:a}}),t.extend(e,{constants:{keyboard:{RETURN:13}}}),t.extend(e,{Class:function(t){var e=function(){this.initialize.apply(this,arguments)};for(var n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n]);return e.prototype.initialize=e.prototype.initialize||function(){},e}}),t.extend(e,{initialisers:{initializeMap:function(){var n=t.extend(!0,{},e,e.TWCCMapOptions);return delete n.TWCCMapOptions,e.TWCCMap=window.TWCCMap.getInstance(n),e.map=e.TWCCMap.getMap(),l(),e.TWCCMap.promise},initializeUi:function(){var n=t.extend(!0,{},e);return e.TWCCUi=window.TWCCUi.getInstance(n),e.TWCCUi.promise},initializeConverter:function(){var o=t.extend(!0,{},e,e.TWCCConverterOptions);return delete o.TWCCConverterOptions,e.TWCCConverter=window.TWCCConverter.getInstance(o),n=e.TWCCConverter.converterWidget,e.TWCCConverter.promise}}}),t(document).ready(function(){e.context.mobileDetected&&confirm(r("redirectToMobileVersion"))&&(window.location.href="/m");var n="*GPS (WGS84) (deg)",i={title:n,defData:"+title="+n+" +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees",isConnector:!1};"function"!==t.type(Math.sinh)&&(Math.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2}),t.ajax({url:"/js/data/WMM.COF",cache:!0,dataType:"text"}).done(function(t){o=geoMagFactory(cof2Obj(t))}).fail(function(){o=function(){return{}}}),t.extend(_proj.default.WGS84,i),t.extend(_proj.default.defs("WGS84"),i),e.initialisers.initializeUi().done(T)})}(jQuery,App);

},{"proj4":421}],3:[function(require,module,exports){
"use strict";var _proj=_interopRequireDefault(require("proj4")),_ol=require("ol"),_proj2=require("ol/proj/proj4.js"),_layer=require("ol/layer.js"),_source=require("ol/source"),_Vector=_interopRequireDefault(require("ol/source/Vector")),_geom=require("ol/geom"),_style=require("ol/style.js"),_control=require("ol/control.js"),_format=require("ol/format.js"),_interaction=require("ol/interaction.js"),_proj3=require("ol/proj.js"),_coordinate=require("ol/coordinate.js"),_olGeocoder2=_interopRequireDefault(require("@kirtandesai/ol-geocoder")),_Group=_interopRequireDefault(require("ol/layer/Group")),_sphere=require("ol/sphere"),_olLayerswitcher=_interopRequireDefault(require("ol-layerswitcher")),_Graticule=_interopRequireDefault(require("ol-ext/control/Graticule"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}!function(e){if(void 0===window.TWCCMap){var t,n=function(t){var n,r,o,i,a,s,l,c,u,g,d,p,f,m,y=null,v={mapOptions:{zoom:2,center:[0,0],azimuthOpacity:.7},mapContainerElt:e("#map")[0],context:{languageCode:"en"}},_={HYBRID:{title:"Hybrid",lyrs:"y"},SATELLITE:{title:"Satellite",lyrs:"s"},TERRAIN:{title:"Terrain",lyrs:"p"},ROAD:{title:"Road",lyrs:"m"}};function h(e){this._array=e,this._index=0;var t=this;this.get=function(){var e=t._array[t._index];return++t._index,t._index===t._array.length&&(t._index=0),e}}function w(){return v.utils.t.apply(this,arguments)}function x(t,n){v.utils.trigger(e(v.mapContainerElt),t,n)}function b(e){return(0,_proj3.fromLonLat)(e,o.getProjection())}function I(e){return(0,_proj3.toLonLat)(e,o.getProjection())}function S(e){return b([e.x,e.y])}function A(e,t){n.setMetrics("length",e),n.setMetrics("area",t),x("map.metrics_changed",{length:e,area:t})}function k(){var e=u.getFeatures()[0];if(e){var t=e.getGeometry(),n=t.getCoordinates();n.push(n[0]);var r=new _geom.Polygon([n]);A((0,_sphere.getLength)(t),(0,_sphere.getArea)(r))}}function C(){f.setPosition(void 0)}function G(e){c.getFeatures().forEach(function(t){t.getGeometry().setCoordinates(e||t.getGeometry().getCoordinates());var r=t.get("name"),o=n.getAngleInRadians(r)||0,i="true"===r||o?v.mapOptions.azimuthOpacity:0,a=t.get("style").getImage();a.setRotation(o),a.setOpacity(i)})}function M(e){return"data:image/svg+xml,"+escape('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'+e)}function D(){c.clear()}function R(t){var n=[new _style.Style({stroke:new _style.Stroke({color:"rgba(0,0,0,0.5)",width:2})})],r=0,o=t.getGeometry(),i=o.getCoordinates().length-1,a={font:"10px Arial",stroke:new _style.Stroke({color:"#fff",width:2}),fill:new _style.Fill({color:"#000"})};return o.forEachSegment(function(t,o){++r,n.push(new _style.Style({geometry:new _geom.Point(t),text:new _style.Text(e.extend(a,{text:r.toString()}))})),r===i&&n.push(new _style.Style({geometry:new _geom.Point(o),text:new _style.Text(e.extend(a,{text:(r+1).toString()}))}))}),n}function T(t){var n=new e.Deferred;return o.animate({center:t,duration:200},n.resolve),n.promise()}function P(){e("#zoom-btn").button("option","disabled",!0);var t,n,r=g.getFeatures()[0].getGeometry().getCoordinates();e.when(T(r),(t=10,n=new e.Deferred,o.animate({zoom:t,duration:200},n.resolve),n.promise())).done(function(){e("#zoom-btn").button("option","disabled",!1)})}function j(e){if(u){var t=e.map(S);u.getFeatures().length?function(e){u.getFeatures()[0].getGeometry().setCoordinates(e)}(t):(!function(e){u.addFeature(new _ol.Feature({geometry:new _geom.LineString(e)}))}(t),r.addInteraction(s)),k(),!0===n.getBoolean("autoZoom")&&r.getView().fit(u.getExtent(),{duration:200,padding:[0,270,36,204]})}}function O(t){var n,r,o,i,a="",s="",l="",c=I(t),u={key:v.mapOptions.timezonedbKey,format:"json",by:"position",lng:c[0],lat:c[1],fields:"abbreviation,gmtOffset"},g=(0,_coordinate.degreesToStringHDMS)("NS",c[1]),d=(0,_coordinate.degreesToStringHDMS)("EW",c[0]);n=e.get("https://api.open-meteo.com/v1/elevation?latitude=".concat(c[1],"&longitude=").concat(c[0])).done(function(t){if(t.elevation){var n=t.elevation[0].toString();a='<p><img src="'.concat(v.system.dirWsImages,'elevation_icon.png" alt="').concat(w("elevation"),'" title="').concat(w("elevation"),'" width="38" height="30"> ').concat(n).concat(w("unitMeter"),"</p>"),e("#elevation").html(a)}}).fail(function(){x("xhr.failed","Elevation API")}),r=e.get("https://api.timezonedb.com/v2.1/get-time-zone",u).done(function(t){if("OK"===t.status){var n=t.gmtOffset/3600;l="<p>"+t.abbreviation+" (GMT",n>0&&(l+="+"),0!==n&&(l+=n),l+=")</p>",e("#timezone").html(l)}}).fail(function(){x("xhr.failed","Timezonedb API")}),o=e.get("https://nominatim.openstreetmap.org/reverse",{format:"json",lat:c[1],lon:c[0],"accept-language":v.context.languageCode}).done(function(t){if(t&&!t.error){var n=t.address.country_code.toUpperCase();s='<img src="'+v.system.dirWsImages+'address_icon.png" alt="'+w("address")+'" title="'+w("address")+'" width="38" height="30"><p>'+t.display_name+'   <img src="'+v.system.dirWsImages+"flags/"+n+'.png" alt="'+n+'" width="22" height="15"></p>',e("#direction").html(s)}}).fail(function(){x("xhr.failed","Nominatim API")}),C(),e.when(o,n,r).always(function(){i='<div id="popup" class="ol-popup">   <a href="#" id="popup-closer" class="ol-popup-closer"></a>   <div class="popup-content" dir="'+w("dir")+'">       <h3>'+w("dragMe")+'</h3>       <div><span id="direction">'+s+'</span>           <a id="zoom-btn" href="#" title="'+w("zoom")+'">'+w("zoom")+'</a>       </div>       <div>           <img src="'+v.system.dirWsImages+'gps_icon.png" alt="GPS (WGS84)" title="GPS (WGS84)" width="38" height="30">           <p>'+g+"<br>"+d+'</p><span id="timezone">'+l+'</span>           <span id="elevation">'+a+"</span>       </div>   </div></div>",p.innerHTML=i,e("#zoom-btn").button({icons:{primary:"ui-icon-zoomin"},text:!1}).click(function(){P()}),e("#popup-closer").click(function(e){return C(),this.blur(),e.stopPropagation(),e.preventDefault(),!1}),x("infowindow.dom_ready"),f.setPosition(t)})}function q(t){if(g){var o=S(t);g.getFeatures().length?function(e){g.getFeatures().forEach(function(t){t.getGeometry().setCoordinates(e)})}(o):(!function(e){g.addFeature(new _ol.Feature({geometry:new _geom.Point(e),style:new _style.Style({image:new _style.Icon({src:v.system.dirWsImages+"twcc_icon_with_shadow.png",anchor:[19,1],anchorXUnits:"pixels"})})}))}(o),r.addInteraction(a)),c.getFeatures().length?G(o):function(t){var r=M('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/><rect style="fill:#fff;stroke:#fff;stroke-width:1;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;" width="8.779562" height="8.2131386" x="3.610219" y="4.5313869"/></svg>'),o={true:{src:M('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><polygon style="fill:#fff;stroke:#fff;stroke-width:37.61520004;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10" stroke-miterlimit="10" points="374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 259.216,29.942 330.27,173.919 489.16,197.007 " transform="matrix(0.03217603,0,0,0.03217603,-0.33683664,-0.35833699)"/><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/></svg>')},magneticDeclination:{src:M('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16 97" xml:space="preserve" width="16" height="97"><g transform="matrix(0.07106223,0,0,0.07106223,-0.43846047,1.8741008e-6)"><path style="fill:#fff" d="m 7.954,226.53 c -2.23,4.623 -2.295,8.072 -0.609,9.915 3.911,4.275 15.926,-3.905 23.323,-9.051 l 58.416,-40.662 c 7.397,-5.145 20.402,-11.835 29.414,-11.993 0.897,-0.016 1.8,-0.011 2.703,0.011 9.007,0.218 21.958,7.016 29.3,12.238 l 56.403,40.151 c 7.343,5.221 19.303,13.473 23.301,9.219 1.74,-1.849 1.751,-5.33 -0.381,-9.997 L 129.648,7.047 c -4.264,-9.333 -11.335,-9.404 -15.79,-0.163 L 7.954,226.53 Z"/><path style="stroke:#fff;stroke-width:28.14434624;" d="m 118.74748,174.45383 0,1190.45957"/></g></svg>'),rotation:n.getAngleInRadians("magneticDeclination")},srcConvergence:{src:r,color:"#f00",rotation:n.getAngleInRadians("srcConvergence")},dstConvergence:{src:r,rotation:n.getAngleInRadians("dstConvergence")}};for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];c.addFeature(new _ol.Feature({geometry:new _geom.Point(t),name:i,style:new _style.Style({image:new _style.Icon(e.extend({anchor:[.5,1],rotateWithView:!0,opacity:"true"===i||a.rotation?v.mapOptions.azimuthOpacity:0,scale:.75,color:"#000"},a))})}))}}(o),T(o),O(o),A()}}function z(e){1===e.length?(u.clear(),r.removeInteraction(s),q(e[0])):(C(),g.clear(),r.removeInteraction(a),D(),j(e))}function E(e,t){return e.reduce(function(e,n){return e.concat(t(n))},[])}function L(e){return E(e,function(e){return e})}function F(e){switch(e.getType()){case"Point":return[e.getCoordinates()];case"LineString":case"LinearRing":case"MultiPoint":return e.getCoordinates();case"Polygon":case"MultiLineString":return L(e.getCoordinates());case"MultiPolygon":return L(L(e.getCoordinates()));case"GeometryCollection":return E(e.getGeometries(),function(e){return F(e)});case"Circle":return[e.getCenter()];default:return[]}}function W(e){return new _layer.Tile({title:e.title,type:"base",visible:!1,preload:1/0,source:new _source.XYZ({attributions:'Â© Google <a href="https://developers.google.com/maps/terms" target="_blank">Terms of Use.</a>',url:"http://mt0.google.com/vt/lyrs="+e.lyrs+"&hl=en&x={x}&y={y}&z={z}&s=Ga"})})}function V(){var t,n=(t="layers",v.utils.getPreferenceCookie(t));if(n){var r=n.opt;if(r)for(var o in r)if(r.hasOwnProperty(o)){var i=e(".ol-control.layer-switcher label:contains('"+o+"')").closest("li").children("input[type=checkbox]");i.length&&i[0].checked!==r[o]&&i.click()}var a=n.base;if(a)for(var s in a)if(a.hasOwnProperty(s)){var l=e(".ol-control.layer-switcher label:contains('"+s+"')").closest("li").find("label:contains('"+a[s]+"')").closest("li").children("input[type=radio]");l.length&&l.click()}}}function B(t){if(t.features){var n;if(e.isFunction(t.features.getArray))n=t.features.getArray();else{if(!e.isArray(t.features))return;n=t.features}x("linestring.edit_end",E(n,function(e){return F(e.getGeometry())}).map(I)),k()}}function N(e){var t=v.utils.getConvergenceConvention()?-1:1;e.convergenceInDegrees.source=t*e.convergenceInDegrees.source,e.convergenceInDegrees.destination=t*e.convergenceInDegrees.destination;var r=v.utils.degToRad(e.convergenceInDegrees);return n.setAngleInRadians("srcConvergence",r.source),n.setAngleInRadians("dstConvergence",r.destination),e}function Z(){var t=e("body");i.once("tileloadend",function(){V(),x("map.tiles_loaded"),e(".ol-control.layer-switcher").on("change","input",function(t){var n=e(t.target),r=n.closest("li.group").children("label").text();r+=" "+n.closest("li.layer").children("label").text(),"checkbox"===n.attr("type")&&(r+=" ",r+=this.checked?"on":"off"),x("map.layer.change",r)}),y.resolve()}),i.on("tileloaderror",y.reject),r.on("singleclick",function(e){var t=r.forEachFeatureAtPixel(r.getEventPixel(e.originalEvent),function(e){return e});t?O(t.getGeometry().getCoordinates()):(C(),x("map.click",I(e.coordinate)))}),d.on("addresschosen",function(e){x("place.changed",I(e.coordinate))}),a.on("modifystart",function(){C(),D(),x("marker.drag_start")}),a.on("modifyend",function(e){x("marker.drag_end",I(e.features.getArray()[0].getGeometry().getCoordinates()))}),s.on("modifyend",B),l.on("addfeatures",B),r.getViewport().addEventListener("contextmenu",function(e){var t=r.forEachFeatureAtPixel(r.getEventPixel(e),function(e){return e});if(t){var n=t.getGeometry().getCoordinates();if(Array.isArray(n[0])){var o=r.getEventCoordinate(e);n=n.map(function(e){return{coordinates:e,distance:new _geom.LineString([o,e]).getLength()}}).sort(function(e,t){return e.distance-t.distance})[0].coordinates}x("linestring.remove_vertice",I(n))}else x("linestring.add_vertice",I(r.getEventCoordinate(e)));k(),e.stopPropagation(),e.preventDefault()}),t.on("converter.source.selection_changed converterset.done",function(e,t){}),t.on("converterset.wgs84_changed",function(t,r){var o,i;(r=N(r)).wgs84=(o=r.wgs84,i=[],e.each(o,function(){if(void 0===this.lat&&void 0===this.x||this.error)return!0;i.push(this)}),i),n.setAngleInDegrees("magneticDeclination",r.magneticDeclinationInDegrees),z(r.wgs84),x("converter.changed",r)}),t.on("converterset.convergence_changed",function(e,t){c.getFeatures().length&&(t=N(t),G(),x("converter.convergence_changed",t))}),t.on("ui.full_screen",function(){e(".ol-full-screen button").trigger("click")});var o=new h("degrees","imperial","nautical","metric","us");e(".ol-scale-line").click(function(){m.setUnits(o.get())})}e.extend(!0,v,t),n={anglesInRadians:{},booleans:{autoZoom:!0},metrics:{},setAngleInRadians:function(e,t){n.anglesInRadians[e]=t},setAngleInDegrees:function(e,t){n.setAngleInRadians(e,v.utils.degToRad(t))},getAngleInRadians:function(e){return n.anglesInRadians[e]},setBoolean:function(e,t){n.booleans[e]=!!t},getBoolean:function(e){return n.booleans[e]},setMetrics:function(e,t){n.metrics[e]=t},getMetrics:function(e){return n.metrics[e]}};!function(t){function n(n){var r=n||{},o=e("#c-ads-1")[0];t.call(this,{element:o,target:r.target})}t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n}(_control.Control);return function(){y=function(){return v.utils.newDeferred.apply(this,arguments)}("Map"),(0,_proj2.register)(_proj.default);var t=new _style.Style({image:new _style.Circle({radius:6,fill:null,stroke:new _style.Stroke({color:"rgba(0,0,0,0.6)",width:3})})});p=e("<div>")[0],m=new _control.ScaleLine,c=new _Vector.default,g=new _Vector.default,u=new _Vector.default,a=new _interaction.Modify({source:g,style:t,pixelTolerance:30}),s=new _interaction.Modify({source:u,style:t}),l=new _interaction.DragAndDrop({formatConstructors:[_format.GPX,_format.GeoJSON,_format.IGC,_format.KML,_format.TopoJSON]}),i=new _source.XYZ({attributions:'Tiles Â© <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),o=new _ol.View({zoom:v.mapOptions.zoom}),d=new _olGeocoder2.default("nominatim",{provider:"osm",autoComplete:!0,autoCompleteMinLength:2,placeholder:w("searchByAddress"),targetType:"glass-button",lang:v.context.languageCode,limit:5,keepOpen:!1,preventDefault:!0,debug:!1}),f=new _ol.Overlay({element:p,autoPan:!0,autoPanAnimation:{duration:200}});var n=b(v.mapOptions.center);o.setCenter(n),r=new _ol.Map({controls:(0,_control.defaults)().extend([new _control.FullScreen({source:"map-container"}),new _olLayerswitcher.default,d,m]),interactions:(0,_interaction.defaults)().extend([new _interaction.DragRotateAndZoom,l]),target:v.mapContainerElt,loadTilesWhileAnimating:!0,overlays:[f],layers:[new _Group.default({title:"Maps",layers:[new _Group.default({title:"ArcGIS",layers:[new _layer.Tile({title:"Satellite",type:"base",visible:!1,preload:1/0,source:new _source.XYZ({attributions:'Tiles Â© <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer">ArcGIS</a>',url:"http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg"})}),new _layer.Tile({title:"Terrain",type:"base",preload:1/0,source:i})]}),new _Group.default({title:"OSM",layers:[new _layer.Tile({title:"Stamen toner",type:"base",visible:!1,preload:1/0,source:new _source.StadiaMaps({layer:"stamen_toner"})}),new _layer.Tile({title:"Stamen terrain",type:"base",visible:!1,preload:1/0,source:new _source.StadiaMaps({layer:"stamen_terrain"})}),new _layer.Tile({title:"Open Street Map",type:"base",visible:!1,preload:1/0,source:new _source.OSM})]}),new _Group.default({title:"Google",layers:[W(_.HYBRID),W(_.SATELLITE),W(_.TERRAIN),W(_.ROAD)]})]}),new _Group.default({title:"Features",layers:[new _layer.Vector({title:"Azimuths",style:function(e){return e.get("style")},source:c})]}),new _layer.Vector({style:function(e){return e.get("style")},source:g}),new _layer.Vector({style:R,source:u})],view:o}),Z()}(),{promise:y.promise(),setGraticule:function(){new GridOverlay(r).setMap(r)},model:{setAngleInRadians:n.setAngleInRadians,setAngleInDegrees:n.setAngleInDegrees,getMetrics:n.getMetrics,setBoolean:n.setBoolean},getMap:function(){return r},olVersion:_ol.VERSION}};window.TWCCMap={getInstance:function(e){return t=t||n(e)}}}}(jQuery);

},{"@kirtandesai/ol-geocoder":4,"ol":234,"ol-ext/control/Graticule":75,"ol-layerswitcher":77,"ol/control.js":116,"ol/coordinate.js":128,"ol/format.js":145,"ol/geom":201,"ol/interaction.js":235,"ol/layer.js":260,"ol/layer/Group":266,"ol/proj.js":283,"ol/proj/proj4.js":288,"ol/source":338,"ol/source/Vector":367,"ol/sphere":379,"ol/style.js":384,"proj4":421}],4:[function(require,module,exports){
"use strict";function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t(require("ol/control/Control"),require("ol/style/Style"),require("ol/style/Icon"),require("ol/layer/Vector"),require("ol/source/Vector"),require("ol/geom/Point"),require("ol/Feature"),require("ol/proj")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/style/Style","ol/style/Icon","ol/layer/Vector","ol/source/Vector","ol/geom/Point","ol/Feature","ol/proj"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Geocoder=t(e.ol.control.Control,e.ol.style.Style,e.ol.style.Icon,e.ol.layer.Vector,e.ol.source.Vector,e.ol.geom.Point,e.ol.Feature,e.ol.proj)}(void 0,function(e,t,n,r,o,s,a,i){function c(e){return e&&"object"==_typeof(e)&&"default"in e?e:{default:e}}var l=c(e),u=c(t),d=c(n),p=c(r),f=c(o),h=c(s),y=c(a),m=c(i),g="gcd-container",v="gcd-button-control",b="gcd-input-query",k="gcd-input-reset",w={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},_={containerId:g,buttonControlId:v,inputQueryId:b,inputResetId:k,cssClasses:w},C=Object.freeze({__proto__:null,containerId:g,buttonControlId:v,inputQueryId:b,inputResetId:k,cssClasses:w,default:_}),x="addresschosen",P="nominatim",S="reverse",j="glass-button",q="osm",E={provider:q,placeholder:"Search for an address",featureStyle:null,targetType:j,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,autoCompleteTimeout:200,debug:!1};function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Assertion failed";if(!e){if("undefined"!=typeof Error)throw new Error(t);throw t}}function L(e){var t=function(){if("performance"in window==0&&(window.performance={}),"now"in window.performance==0){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}return window.performance.now()}().toString(36);return e?e+t:t}function O(e){return/^[0-9]+$/.test(e)}function R(e,t,n){if(Array.isArray(e))e.forEach(function(e){return R(e,t)});else for(var r=Array.isArray(t)?t:t.split(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/),o=r.length;o--;)F(e,r[o])||M(e,r[o],n)}function A(e,t,n){if(Array.isArray(e))e.forEach(function(e){return A(e,t,n)});else for(var r=Array.isArray(t)?t:t.split(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/),o=r.length;o--;)F(e,r[o])&&D(e,r[o],n)}function F(e,t){return e.classList?e.classList.contains(t):I(t).test(e.className)}function N(e,t){var n;if(Array.isArray(e)){if(n=document.createElement(e[0]),e[1].id&&(n.id=e[1].id),e[1].classname&&(n.className=e[1].classname),e[1].attr){var r=e[1].attr;if(Array.isArray(r))for(var o=-1;++o<r.length;)n.setAttribute(r[o].name,r[o].value);else n.setAttribute(r.name,r.value)}}else n=document.createElement(e);n.innerHTML=t;for(var s=document.createDocumentFragment();n.childNodes[0];)s.append(n.childNodes[0]);return n.append(s),n}function I(e){return new RegExp("(^|\\s+) ".concat(e," (\\s+|$)"),"u")}function M(e,t,n){e.classList?e.classList.add(t):e.className="".concat(e.className," ").concat(t).trim(),n&&O(n)&&window.setTimeout(function(){return D(e,t)},n)}function D(e,t,n){e.classList?e.classList.remove(t):e.className=e.className.replace(I(t)," ").trim(),n&&O(n)&&window.setTimeout(function(){return M(e,t)},n)}var V=C.cssClasses,B=function(){function e(t){_classCallCheck(this,e),this.options=t,this.els=this.createControl()}return _createClass(e,[{key:"createControl",value:function(){var t,n,r;return"text-input"===this.options.targetType?(n="".concat(V.namespace," ").concat(V.inputText.container),r={container:t=N(["div",{id:C.containerId,classname:n}],e.input),control:t.querySelector(".".concat(V.inputText.control)),input:t.querySelector(".".concat(V.inputText.input)),reset:t.querySelector(".".concat(V.inputText.reset)),result:t.querySelector(".".concat(V.inputText.result))}):(n="".concat(V.namespace," ").concat(V.glass.container),r={container:t=N(["div",{id:C.containerId,classname:n}],e.glass),control:t.querySelector(".".concat(V.glass.control)),button:t.querySelector(".".concat(V.glass.button)),input:t.querySelector(".".concat(V.glass.input)),reset:t.querySelector(".".concat(V.glass.reset)),result:t.querySelector(".".concat(V.glass.result))}),r.input.placeholder=this.options.placeholder,r}}])}();B.glass='\n  <div class="'.concat(V.glass.control," ").concat(V.olControl,'">\n    <button type="button" id="').concat(C.buttonControlId,'" class="').concat(V.glass.button,'"></button>\n    <input type="text" id="').concat(C.inputQueryId,'" class="').concat(V.glass.input,'" autocomplete="off" placeholder="Search ...">\n    <a id="').concat(C.inputResetId,'" class="').concat(V.glass.reset," ").concat(V.hidden,'"></a>\n  </div>\n  <ul class="').concat(V.glass.result,'"></ul>\n'),B.input='\n  <div class="'.concat(V.inputText.control,'">\n    <input type="text" id="').concat(C.inputQueryId,'" class="').concat(V.inputText.input,'" autocomplete="off" placeholder="Search ...">\n    <span class="').concat(V.inputText.icon,'"></span>\n    <button type="button" id="').concat(C.inputResetId,'" class="').concat(V.inputText.reset," ").concat(V.hidden,'"></button>\n  </div>\n  <ul class="').concat(V.inputText.result,'"></ul>\n');var Q=function(){return _createClass(function e(){_classCallCheck(this,e),this.settings={url:"https://photon.komoot.io/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}},[{key:"getParameters",value:function(e){return e.lang=e.lang.toLowerCase(),{url:this.settings.url,params:{q:e.query,limit:e.limit||this.settings.params.limit,lang:this.settings.langs.includes(e.lang)?e.lang:this.settings.params.lang}}}},{key:"handleResponse",value:function(e){return 0===e.features.length?[]:e.features.map(function(e){return{lon:e.geometry.coordinates[0],lat:e.geometry.coordinates[1],address:{name:e.properties.name,postcode:e.properties.postcode,city:e.properties.city,state:e.properties.state,country:e.properties.country},original:{formatted:e.properties.name,details:e.properties}}})}}])}(),z=function(){return _createClass(function e(){_classCallCheck(this,e),this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}},[{key:"getParameters",value:function(e){return{url:this.settings.url,params:{q:e.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,"accept-language":e.lang||this.settings.params["accept-language"]}}}},{key:"handleResponse",value:function(e){return 0===e.length?[]:e.map(function(e){return{lon:e.lon,lat:e.lat,bbox:e.boundingbox,address:{name:e.display_name,road:e.address.road||"",houseNumber:e.address.house_number||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}})}}])}(),U=function(){return _createClass(function e(){_classCallCheck(this,e),this.settings={url:"https://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}},[{key:"getParameters",value:function(e){return{url:this.settings.url,params:{q:e.query,key:e.key,format:"json",addressdetails:1,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,"accept-language":e.lang||this.settings.params["accept-language"]}}}},{key:"handleResponse",value:function(e){return 0===e.length?[]:e.map(function(e){return{lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||"",road:e.address.road||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}})}}])}(),G=function(){return _createClass(function e(){_classCallCheck(this,e),this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}},[{key:"getParameters",value:function(e){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:e.query,key:e.key,includeNeighborhood:e.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:e.maxResults||this.settings.params.maxResults}}}},{key:"handleResponse",value:function(e){var t=e.resourceSets[0].resources;return 0===t.length?[]:t.map(function(e){return{lon:e.point.coordinates[1],lat:e.point.coordinates[0],address:{name:e.name},original:{formatted:e.address.formattedAddress,details:e.address}}})}}])}(),K=function(){return _createClass(function e(){_classCallCheck(this,e),this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}},[{key:"getParameters",value:function(e){return{url:this.settings.url,params:{q:e.query,key:e.key,limit:e.limit||this.settings.params.limit,countrycode:e.countrycodes||this.settings.params.countrycodes}}}},{key:"handleResponse",value:function(e){return 0===e.results.length?[]:e.results.map(function(e){return{lon:e.geometry.lng,lat:e.geometry.lat,address:{name:e.components.house_number||"",road:e.components.road||"",postcode:e.components.postcode,city:e.components.city||e.components.town,state:e.components.state,country:e.components.country},original:{formatted:e.formatted,details:e.components}}})}}])}();function $(e){return new Promise(function(t,n){var r=function(e,t){return t&&"object"==_typeof(t)&&(e+=(/\?/.test(e)?"&":"?")+function e(t){return Object.keys(t).reduce(function(n,r){return n.push("object"==_typeof(t[r])?e(t[r]):"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(t[r]))),n},[]).join("&")}(t)),e}(e.url,e.data);e.jsonp?function(e,t,n){var r=document.head,o=document.createElement("script"),s="f".concat(Math.round(Math.random()*Date.now()));o.setAttribute("src","".concat(e+(e.indexOf("?")>0?"&":"?")+t,"=").concat(s)),window[s]=function(e){window[s]=void 0,setTimeout(function(){return r.removeChild(o)},0),n(e)},r.append(o)}(r,e.callbackName,t):fetch(r,{method:"GET",mode:"cors",credentials:"same-origin"}).then(function(e){return e.json()}).then(t).catch(n)})}var H=C.cssClasses,Z=function(){return _createClass(function e(t,n){_classCallCheck(this,e),this.Base=t,this.layerName=L("geocoder-layer-"),this.layer=new p.default({name:this.layerName,source:new f.default}),this.options=t.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.provider=this.newProvider(),this.els=n,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners()},[{key:"setListeners",value:function(){var e,t,n=this;this.els.input.addEventListener("keypress",function(e){var t=e.target.value.trim();(e.key?"Enter"===e.key:e.which?13===e.which:e.keyCode&&13===e.keyCode)&&(e.preventDefault(),n.query(t))},!1),this.els.input.addEventListener("click",function(e){return e.stopPropagation()},!1),this.els.input.addEventListener("input",function(r){var o=r.target.value.trim();0!==o.length?A(n.els.reset,H.hidden):R(n.els.reset,H.hidden),n.options.autoComplete&&o!==t&&(t=o,e&&clearTimeout(e),e=setTimeout(function(){o.length>=n.options.autoCompleteMinLength&&n.query(o)},n.options.autoCompleteTimeout))},!1),this.els.reset.addEventListener("click",function(e){n.els.input.focus(),n.els.input.value="",n.lastQuery="",R(n.els.reset,H.hidden),n.clearResults()},!1),this.options.targetType===j&&this.els.button.addEventListener("click",function(e){e.stopPropagation(),F(n.els.control,H.glass.expanded)?n.collapse():n.expand()},!1)}},{key:"query",value:function(e){var t=this;this.provider||(this.provider=this.newProvider());var n=this.provider.getParameters({query:e,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});if(this.lastQuery!==e||!this.els.result.firstChild){this.lastQuery=e,this.clearResults(),R(this.els.reset,H.spin);var r={url:n.url,data:n.params};n.callbackName&&(r.jsonp=!0,r.callbackName=n.callbackName),$(r).then(function(e){t.options.debug&&console.info(e),A(t.els.reset,H.spin);var n=t.provider.handleResponse(e);n&&(t.createList(n),t.listenMapClick())}).catch(function(e){A(t.els.reset,H.spin);var n=N("li","<h5>Error! No internet connection?</h5>");t.els.result.append(n)})}}},{key:"createList",value:function(e){var t=this,n=this.els.result;e.forEach(function(e){var r;r=t.options.provider===q?'<span class="'.concat(H.road,'">').concat(e.address.name,"</span>"):t.addressTemplate(e.address);var o=N("li",'<a href="#">'.concat(r,"</a>"));o.addEventListener("click",function(n){n.preventDefault(),t.chosen(e,r,e.address,e.original)},!1),n.append(o)})}},{key:"chosen",value:function(e,t,n,r){var o=this.Base.getMap(),s=[Number.parseFloat(e.lon),Number.parseFloat(e.lat)],a=o.getView().getProjection(),i=m.default.transform(s,"EPSG:4326",a),c=e.bbox;c&&(c=m.default.transformExtent([c[2],c[1],c[3],c[0]],"EPSG:4326",a));var l={formatted:t,details:n,original:r};if(!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault)this.Base.dispatchEvent({type:x,address:l,coordinate:i,bbox:c,place:e});else{c?o.getView().fit(c,{duration:500}):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2.388657133911758;e.getView().animate({duration:n,resolution:r},{duration:n,center:t})}(o,i);var u=this.createFeature(i,l);this.Base.dispatchEvent({type:x,address:l,feature:u,coordinate:i,bbox:c,place:e})}}},{key:"createFeature",value:function(e){var t=new y.default(new h.default(e));return this.addLayer(),t.setStyle(this.options.featureStyle),t.setId(L("geocoder-ft-")),this.getSource().addFeature(t),t}},{key:"addressTemplate",value:function(e){var t=[];return e.name&&t.push(['<span class="',H.road,'">{name}</span>'].join("")),(e.road||e.building||e.house_number)&&t.push(['<span class="',H.road,'">{building} {road} {house_number}</span>'].join("")),(e.city||e.town||e.village)&&t.push(['<span class="',H.city,'">{postcode} {city} {town} {village}</span>'].join("")),(e.state||e.country)&&t.push(['<span class="',H.country,'">{state} {country}</span>'].join("")),function(e,t){return e.replace(/\{[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([\x2D0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\}/g,function(e,n){var r=void 0===t[n]?"":t[n];return String(r).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")})}(t.join("<br>"),e)}},{key:"newProvider",value:function(){switch(this.options.provider){case q:return new z;case"mapquest":return new U;case"photon":return new Q;case"bing":return new G;case"opencage":return new K;default:return this.options.provider}}},{key:"expand",value:function(){var e=this;A(this.els.input,H.spin),R(this.els.control,H.glass.expanded),window.setTimeout(function(){return e.els.input.focus()},100),this.listenMapClick()}},{key:"collapse",value:function(){this.els.input.value="",this.els.input.blur(),R(this.els.reset,H.hidden),A(this.els.control,H.glass.expanded),this.clearResults()}},{key:"listenMapClick",value:function(){if(!this.registeredListeners.mapClick){var e=this,t=this.Base.getMap().getTargetElement();this.registeredListeners.mapClick=!0,t.addEventListener("click",{handleEvent:function(n){e.clearResults(!0),t.removeEventListener(n.type,this,!1),e.registeredListeners.mapClick=!1}},!1)}}},{key:"clearResults",value:function(e){e&&this.options.targetType===j?this.collapse():function(e){for(;e.firstChild;)e.firstChild.remove()}(this.els.result)}},{key:"getSource",value:function(){return this.layer.getSource()}},{key:"addLayer",value:function(){var e=this,t=!1,n=this.Base.getMap();n.getLayers().forEach(function(n){n===e.layer&&(t=!0)}),t||n.addLayer(this.layer)}}])}();return function(e){function t(){var e,n,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),T("string"==typeof o,"@param `type` should be string!"),T(o===P||o===S,"@param 'type' should be '".concat(P,"'\n      or '").concat(S,"'!")),T("object"==_typeof(s),"@param `options` should be object!"),E.featureStyle=[new u.default({image:new d.default({scale:.7,src:"//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png"})})];var a=new B(s);return o===P&&(n=a.els.container),_assertThisInitialized(e=_callSuper(this,t,[{element:n}]))instanceof t?(e.options=function(e,t){var n={};return Object.keys(e).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}),Object.keys(t).forEach(function(e){Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}),n}(E,s),e.container=n,o===P&&(r=new Z(_assertThisInitialized(e),a.els),e.layer=r.layer),_assertThisInitialized(e)):_possibleConstructorReturn(e,new t)}return _inherits(t,l["default"]),_createClass(t,[{key:"getLayer",value:function(){return this.layer}},{key:"getSource",value:function(){return this.getLayer().getSource()}},{key:"setProvider",value:function(e){this.options.provider=e}},{key:"setProviderKey",value:function(e){this.options.key=e}}])}()});

},{"ol/Feature":82,"ol/control/Control":118,"ol/geom/Point":210,"ol/layer/Vector":273,"ol/proj":283,"ol/source/Vector":367,"ol/style/Icon":387,"ol/style/Style":393}],5:[function(require,module,exports){
"use strict";function _slicedToArray(t,r){return _arrayWithHoles(t)||_iterableToArrayLimit(t,r)||_unsupportedIterableToArray(t,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i,a,u=[],f=!0,c=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;f=!1}else for(;!(f=(n=i.call(e)).done)&&(u.push(n.value),u.length!==r);f=!0);}catch(t){c=!0,o=t}finally{try{if(!f&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,r,e){return r&&_defineProperties(t.prototype,r),e&&_defineProperties(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function _defineProperty(t,r,e){return(r=_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function _toPropertyKey(t){var r=_toPrimitive(t,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",f=i.toStringTag||"@@toStringTag";function c(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),u=new j(n||[]);return o(a,"_invoke",{value:S(t,e,u)}),a}function s(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",v="suspendedYield",y="executing",p="completed",d={};function g(){}function w(){}function b(){}var m={};c(m,a,function(){return this});var _=Object.getPrototypeOf,A=_&&_(_(P([])));A&&A!==e&&n.call(A,a)&&(m=A);var k=b.prototype=g.prototype=Object.create(m);function x(t){["next","throw","return"].forEach(function(r){c(t,r,function(t){return this._invoke(r,t)})})}function E(t,r){function e(o,i,a,u){var f=s(t[o],t,i);if("throw"!==f.type){var c=f.arg,l=c.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?r.resolve(l.__await).then(function(t){e("next",t,a,u)},function(t){e("throw",t,a,u)}):r.resolve(l).then(function(t){c.value=t,a(c)},function(t){return e("throw",t,a,u)})}u(f.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r(function(r,o){e(t,n,r,o)})}return i=i?i.then(o,o):o()}})}function S(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===p){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var f=L(u,n);if(f){if(f===d)continue;return f}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=s(r,e,n);if("normal"===c.type){if(o=n.done?p:v,c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=p,n.method="throw",n.arg=c.arg)}}}function L(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,L(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=s(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function T(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function P(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(_typeof(r)+" is not iterable")}return w.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:w,configurable:!0}),w.displayName=c(b,f,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,f,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},x(E.prototype),c(E.prototype,u,function(){return this}),r.AsyncIterator=E,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(k),c(k,f,"Generator"),c(k,a,function(){return this}),c(k,"toString",function(){return"[object Generator]"}),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=P,j.prototype={constructor:j,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return u.type="throw",u.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var f=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(f&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),O(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;O(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:P(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}var float16=function(t){var r="This is not an object",e="This is not a Float16Array object",n="The constructor property value is not an object",o="Species constructor didn't return TypedArray object",i="Derived constructor created TypedArray object which was too small length",a="Attempting to access detached ArrayBuffer",u="Cannot mix BigInt and other types, use explicit conversions",f="@@iterator property is not callable";function c(t){return function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return s(t,r,n)}}function l(t,r){return c(p(t,r).get)}var s=Reflect.apply,h=Reflect.construct,v=Reflect.defineProperty,y=Reflect.get,p=Reflect.getOwnPropertyDescriptor,d=Reflect.getPrototypeOf,g=Reflect.has,w=Reflect.ownKeys,b=Reflect.set,m=Reflect.setPrototypeOf,_=Proxy,A=Number.EPSILON,k=Number.MAX_SAFE_INTEGER,x=Number.isFinite,E=Number.isNaN,S=Symbol.iterator,L=Symbol.species,T=Symbol.toStringTag,O=Symbol.for,j=Object,P=j.create,I=j.defineProperty,R=j.freeze,F=j.is,C=j.prototype,N=C.__lookupGetter__?c(C.__lookupGetter__):function(t,r){if(null==t)throw Pt("Cannot convert undefined or null to object");var e=j(t);do{var n=p(e,r);if(void 0!==n)return G(n,"get")?n.get:void 0}while(null!==(e=d(e)))},G=j.hasOwn||c(C.hasOwnProperty),B=Array,H=B.isArray,M=B.prototype,U=c(M.join),W=c(M.push),D=c(M.toLocaleString),K=M[S],Y=c(K),V=Math.abs,z=Math.trunc,X=ArrayBuffer,$=X.isView,q=X.prototype,J=c(q.slice),Q=l(q,"byteLength"),Z="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null,tt=Z&&l(Z.prototype,"byteLength"),rt=d(Uint8Array),et=rt.from,nt=rt.prototype,ot=nt[S],it=c(nt.keys),at=c(nt.values),ut=c(nt.entries),ft=c(nt.set),ct=c(nt.reverse),lt=c(nt.fill),st=c(nt.copyWithin),ht=c(nt.sort),vt=c(nt.slice),yt=c(nt.subarray),pt=l(nt,"buffer"),dt=l(nt,"byteOffset"),gt=l(nt,"length"),wt=l(nt,T),bt=Uint8Array,mt=Uint16Array,_t=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return s(et,mt,r)},At=Uint32Array,kt=Float32Array,xt=d([][S]()),Et=c(xt.next),St=c(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})().next),Lt=d(xt),Tt=DataView.prototype,Ot=c(Tt.getUint16),jt=c(Tt.setUint16),Pt=TypeError,It=RangeError,Rt=WeakSet,Ft=Rt.prototype,Ct=c(Ft.add),Nt=c(Ft.has),Gt=WeakMap,Bt=Gt.prototype,Ht=c(Bt.get),Mt=c(Bt.has),Ut=c(Bt.set),Wt=new Gt,Dt=P(null,_defineProperty({next:{value:function(){var t=Ht(Wt,this);return Et(t)}}},S,{value:function(){return this}}));function Kt(t){if(t[S]===K&&xt.next===Et)return t;var r=P(Dt);return Ut(Wt,r,Y(t)),r}var Yt,Vt=new Gt,zt=P(Lt,{next:{value:function(){var t=Ht(Vt,this);return St(t)},writable:!0,configurable:!0}}),Xt=_createForOfIteratorHelper(w(xt));try{for(Xt.s();!(Yt=Xt.n()).done;){var $t=Yt.value;"next"!==$t&&I(zt,$t,p(xt,$t))}}catch(t){Xt.e(t)}finally{Xt.f()}function qt(t){var r=P(zt);return Ut(Vt,r,t),r}function Jt(t){return null!==t&&"object"===_typeof(t)||"function"==typeof t}function Qt(t){return null!==t&&"object"===_typeof(t)}function Zt(t){return void 0!==wt(t)}function tr(t){var r=wt(t);return"BigInt64Array"===r||"BigUint64Array"===r}function rr(t){if(null===Z)return!1;try{return tt(t),!0}catch(t){return!1}}function er(t){return function(t){try{return Q(t),!0}catch(t){return!1}}(t)||rr(t)}function nr(t){return!!H(t)&&(t[S]===K&&xt.next===Et)}function or(t){if("string"!=typeof t)return!1;var r=+t;return t===r+""&&(!!x(r)&&r===z(r))}var ir=O("__Float16Array__");var ar=1/A;var ur=6103515625e-14,fr=65504,cr=.0009765625*ur,lr=.0009765625*ar;function sr(t){var r=+t;if(!x(r)||0===r)return r;var e=r>0?1:-1,n=V(r);if(n<ur)return e*function(t){return t+ar-ar}(n/cr)*cr;var o=(1+lr)*n,i=o-(o-n);return i>fr||E(i)?e*(1/0):e*i}for(var hr=new X(4),vr=new kt(hr),yr=new At(hr),pr=new mt(512),dr=new bt(512),gr=0;gr<256;++gr){var wr=gr-127;wr<-27?(pr[gr]=0,pr[256|gr]=32768,dr[gr]=24,dr[256|gr]=24):wr<-14?(pr[gr]=1024>>-wr-14,pr[256|gr]=1024>>-wr-14|32768,dr[gr]=-wr-1,dr[256|gr]=-wr-1):wr<=15?(pr[gr]=wr+15<<10,pr[256|gr]=wr+15<<10|32768,dr[gr]=13,dr[256|gr]=13):wr<128?(pr[gr]=31744,pr[256|gr]=64512,dr[gr]=24,dr[256|gr]=24):(pr[gr]=31744,pr[256|gr]=64512,dr[gr]=13,dr[256|gr]=13)}function br(t){vr[0]=sr(t);var r=yr[0],e=r>>23&511;return pr[e]+((8388607&r)>>dr[e])}for(var mr=new At(2048),_r=1;_r<1024;++_r){for(var Ar=_r<<13,kr=0;0==(8388608&Ar);)Ar<<=1,kr-=8388608;Ar&=-8388609,kr+=947912704,mr[_r]=Ar|kr}for(var xr=1024;xr<2048;++xr)mr[xr]=939524096+(xr-1024<<13);for(var Er=new At(64),Sr=1;Sr<31;++Sr)Er[Sr]=Sr<<23;Er[31]=1199570944,Er[32]=2147483648;for(var Lr=33;Lr<63;++Lr)Er[Lr]=2147483648+(Lr-32<<23);Er[63]=3347054592;for(var Tr=new mt(64),Or=1;Or<64;++Or)32!==Or&&(Tr[Or]=1024);function jr(t){var r=t>>10;return yr[0]=mr[Tr[r]+(1023&t)]+Er[r],vr[0]}function Pr(t){var r=+t;return E(r)||0===r?0:z(r)}function Ir(t){var r=Pr(t);return r<0?0:r<k?r:k}function Rr(t,e){if(!Jt(t))throw Pt(r);var o=t.constructor;if(void 0===o)return e;if(!Jt(o))throw Pt(n);var i=o[L];return null==i?e:i}function Fr(t){if(rr(t))return!1;try{return J(t,0,0),!1}catch(t){}return!0}function Cr(t,r){var e=E(t),n=E(r);if(e&&n)return 0;if(e)return 1;if(n)return-1;if(t<r)return-1;if(t>r)return 1;if(0===t&&0===r){var o=F(t,0),i=F(r,0);if(!o&&i)return-1;if(o&&!i)return 1}return 0}var Nr=2,Gr=new Gt;function Br(t){return Mt(Gr,t)||!$(t)&&function(t){if(!Qt(t))return!1;var r=d(t);if(!Qt(r))return!1;var e=r.constructor;if(void 0===e)return!1;if(!Jt(e))throw Pt(n);return g(e,ir)}(t)}function Hr(t){if(!Br(t))throw Pt(e)}function Mr(t,r){var e=Br(t),n=Zt(t);if(!e&&!n)throw Pt(o);if("number"==typeof r){var a;if(e){var f=Ur(t);a=gt(f)}else a=gt(t);if(a<r)throw Pt(i)}if(tr(t))throw Pt(u)}function Ur(t){var r=Ht(Gr,t);if(void 0!==r){if(Fr(pt(r)))throw Pt(a);return r}var e=t.buffer;if(Fr(e))throw Pt(a);var n=h($r,[e,t.byteOffset,t.length],t.constructor);return Ht(Gr,n)}function Wr(t){for(var r=gt(t),e=[],n=0;n<r;++n)e[n]=jr(t[n]);return e}var Dr,Kr=new Rt,Yr=_createForOfIteratorHelper(w(nt));try{for(Yr.s();!(Dr=Yr.n()).done;){var Vr=Dr.value;if(Vr!==T){var zr=p(nt,Vr);G(zr,"get")&&"function"==typeof zr.get&&Ct(Kr,zr.get)}}}catch(t){Yr.e(t)}finally{Yr.f()}var Xr=R({get:function(t,r,e){return or(r)&&G(t,r)?jr(y(t,r)):Nt(Kr,N(t,r))?y(t,r):y(t,r,e)},set:function(t,r,e,n){return or(r)&&G(t,r)?b(t,r,br(e)):b(t,r,e,n)},getOwnPropertyDescriptor:function(t,r){if(or(r)&&G(t,r)){var e=p(t,r);return e.value=jr(e.value),e}return p(t,r)},defineProperty:function(t,r,e){return or(r)&&G(t,r)&&G(e,"value")?(e.value=br(e.value),v(t,r,e)):v(t,r,e)}}),$r=function(){function t(r,e,n){var o;if(_classCallCheck(this,t),Br(r))o=h(mt,[Ur(r)],this instanceof t?this.constructor:void 0);else if(Jt(r)&&!er(r)){var i,c;if(Zt(r)){if(i=r,c=gt(r),Fr(pt(r)))throw Pt(a);if(tr(r))throw Pt(u);var l=new X(c*Nr);o=h(mt,[l],this instanceof t?this.constructor:void 0)}else{var s=r[S];if(null!=s&&"function"!=typeof s)throw Pt(f);null!=s?nr(r)?(i=r,c=r.length):c=(i=_toConsumableArray(r)).length:c=Ir((i=r).length),o=h(mt,[c],this instanceof t?this.constructor:void 0)}for(var v=0;v<c;++v)o[v]=br(i[v])}else o=h(mt,arguments,this instanceof t?this.constructor:void 0);var y=new _(o,Xr);return Ut(Gr,y,o),y}return _createClass(t,[{key:"keys",value:function(){Hr(this);var t=Ur(this);return it(t)}},{key:"values",value:function(){Hr(this);var t=Ur(this);return qt(_regeneratorRuntime().mark(function r(){var e,n,o;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e=_createForOfIteratorHelper(at(t)),r.prev=1,e.s();case 3:if((n=e.n()).done){r.next=9;break}return o=n.value,r.next=7,jr(o);case 7:r.next=3;break;case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),e.e(r.t0);case 14:return r.prev=14,e.f(),r.finish(14);case 17:case"end":return r.stop()}},r,null,[[1,11,14,17]])})())}},{key:"entries",value:function(){Hr(this);var t=Ur(this);return qt(_regeneratorRuntime().mark(function r(){var e,n,o,i,a;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e=_createForOfIteratorHelper(ut(t)),r.prev=1,e.s();case 3:if((n=e.n()).done){r.next=9;break}return o=_slicedToArray(n.value,2),i=o[0],a=o[1],r.next=7,[i,jr(a)];case 7:r.next=3;break;case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),e.e(r.t0);case 14:return r.prev=14,e.f(),r.finish(14);case 17:case"end":return r.stop()}},r,null,[[1,11,14,17]])})())}},{key:"at",value:function(t){Hr(this);var r=Ur(this),e=gt(r),n=Pr(t),o=n>=0?n:e+n;if(!(o<0||o>=e))return jr(r[o])}},{key:"with",value:function(r,e){Hr(this);var n=Ur(this),o=gt(n),i=Pr(r),a=i>=0?i:o+i,u=+e;if(a<0||a>=o)throw It("Offset is out of bounds");var f=new mt(pt(n),dt(n),gt(n)),c=new t(pt(vt(f)));return Ur(c)[a]=br(u),c}},{key:"map",value:function(r){Hr(this);var e=Ur(this),n=gt(e),o=arguments.length<=1?void 0:arguments[1],i=Rr(e,t);if(i===t){for(var a=new t(n),u=Ur(a),f=0;f<n;++f){var c=jr(e[f]);u[f]=br(s(r,o,[c,f,this]))}return a}var l=new i(n);Mr(l,n);for(var h=0;h<n;++h){var v=jr(e[h]);l[h]=s(r,o,[v,h,this])}return l}},{key:"filter",value:function(r){Hr(this);for(var e=Ur(this),n=gt(e),o=arguments.length<=1?void 0:arguments[1],i=[],a=0;a<n;++a){var u=jr(e[a]);s(r,o,[u,a,this])&&W(i,u)}var f=new(Rr(e,t))(i);return Mr(f),f}},{key:"reduce",value:function(t){Hr(this);var r,e,n=Ur(this),o=gt(n);if(0===o&&0==(arguments.length<=1?0:arguments.length-1))throw Pt("Reduce of empty array with no initial value");0==(arguments.length<=1?0:arguments.length-1)?(r=jr(n[0]),e=1):(r=arguments.length<=1?void 0:arguments[1],e=0);for(var i=e;i<o;++i)r=t(r,jr(n[i]),i,this);return r}},{key:"reduceRight",value:function(t){Hr(this);var r,e,n=Ur(this),o=gt(n);if(0===o&&0==(arguments.length<=1?0:arguments.length-1))throw Pt("Reduce of empty array with no initial value");0==(arguments.length<=1?0:arguments.length-1)?(r=jr(n[o-1]),e=o-2):(r=arguments.length<=1?void 0:arguments[1],e=o-1);for(var i=e;i>=0;--i)r=t(r,jr(n[i]),i,this);return r}},{key:"forEach",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=0;o<e;++o)s(t,n,[jr(r[o]),o,this])}},{key:"find",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=0;o<e;++o){var i=jr(r[o]);if(s(t,n,[i,o,this]))return i}}},{key:"findIndex",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=0;o<e;++o){var i=jr(r[o]);if(s(t,n,[i,o,this]))return o}return-1}},{key:"findLast",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=e-1;o>=0;--o){var i=jr(r[o]);if(s(t,n,[i,o,this]))return i}}},{key:"findLastIndex",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=e-1;o>=0;--o){var i=jr(r[o]);if(s(t,n,[i,o,this]))return o}return-1}},{key:"every",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=0;o<e;++o)if(!s(t,n,[jr(r[o]),o,this]))return!1;return!0}},{key:"some",value:function(t){Hr(this);for(var r=Ur(this),e=gt(r),n=arguments.length<=1?void 0:arguments[1],o=0;o<e;++o)if(s(t,n,[jr(r[o]),o,this]))return!0;return!1}},{key:"set",value:function(t){Hr(this);var r=Ur(this),e=Pr(arguments.length<=1?void 0:arguments[1]);if(e<0)throw It("Offset is out of bounds");if(null==t)throw Pt("Cannot convert undefined or null to object");if(tr(t))throw Pt(u);if(Br(t))return ft(Ur(this),Ur(t),e);if(Zt(t)&&Fr(pt(t)))throw Pt(a);var n=gt(r),o=j(t),i=Ir(o.length);if(e===1/0||i+e>n)throw It("Offset is out of bounds");for(var f=0;f<i;++f)r[f+e]=br(o[f])}},{key:"reverse",value:function(){Hr(this);var t=Ur(this);return ct(t),this}},{key:"toReversed",value:function(){Hr(this);var r=Ur(this),e=new mt(pt(r),dt(r),gt(r)),n=new t(pt(vt(e))),o=Ur(n);return ct(o),n}},{key:"fill",value:function(t){Hr(this);for(var r=Ur(this),e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return lt.apply(void 0,[r,br(t)].concat(_toConsumableArray(Kt(n)))),this}},{key:"copyWithin",value:function(t,r){Hr(this);for(var e=Ur(this),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return st.apply(void 0,[e,t,r].concat(_toConsumableArray(Kt(o)))),this}},{key:"sort",value:function(t){Hr(this);var r=Ur(this),e=void 0!==t?t:Cr;return ht(r,function(t,r){return e(jr(t),jr(r))}),this}},{key:"toSorted",value:function(r){Hr(this);var e=Ur(this);if(void 0!==r&&"function"!=typeof r)throw new Pt("The comparison function must be either a function or undefined");var n=void 0!==r?r:Cr,o=new mt(pt(e),dt(e),gt(e)),i=new t(pt(vt(o))),a=Ur(i);return ht(a,function(t,r){return n(jr(t),jr(r))}),i}},{key:"slice",value:function(r,e){Hr(this);var n=Ur(this),o=Rr(n,t);if(o===t){var i=new mt(pt(n),dt(n),gt(n));return new t(pt(vt(i,r,e)))}var u,f,c=gt(n),l=Pr(r),s=void 0===e?c:Pr(e),h=(f=s===-1/0?0:s<0?c+s>0?c+s:0:c<s?c:s)-(u=l===-1/0?0:l<0?c+l>0?c+l:0:c<l?c:l)>0?f-u:0,v=new o(h);if(Mr(v,h),0===h)return v;if(Fr(pt(n)))throw Pt(a);for(var y=0;u<f;)v[y]=jr(n[u]),++u,++y;return v}},{key:"subarray",value:function(r,e){Hr(this);var n=Ur(this),o=Rr(n,t),i=new mt(pt(n),dt(n),gt(n)),a=yt(i,r,e),u=new o(pt(a),dt(a),gt(a));return Mr(u),u}},{key:"indexOf",value:function(t){Hr(this);var r=Ur(this),e=gt(r),n=Pr(arguments.length<=1?void 0:arguments[1]);if(n===1/0)return-1;n<0&&(n+=e)<0&&(n=0);for(var o=n;o<e;++o)if(G(r,o)&&jr(r[o])===t)return o;return-1}},{key:"lastIndexOf",value:function(t){Hr(this);var r=Ur(this),e=gt(r),n=(arguments.length<=1?0:arguments.length-1)>=1?Pr(arguments.length<=1?void 0:arguments[1]):e-1;if(n===-1/0)return-1;n>=0?n=n<e-1?n:e-1:n+=e;for(var o=n;o>=0;--o)if(G(r,o)&&jr(r[o])===t)return o;return-1}},{key:"includes",value:function(t){Hr(this);var r=Ur(this),e=gt(r),n=Pr(arguments.length<=1?void 0:arguments[1]);if(n===1/0)return!1;n<0&&(n+=e)<0&&(n=0);for(var o=E(t),i=n;i<e;++i){var a=jr(r[i]);if(o&&E(a))return!0;if(a===t)return!0}return!1}},{key:"join",value:function(t){Hr(this);var r=Wr(Ur(this));return U(r,t)}},{key:"toLocaleString",value:function(){Hr(this);for(var t=Wr(Ur(this)),r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return D.apply(void 0,[t].concat(_toConsumableArray(Kt(e))))}},{key:T,get:function(){if(Br(this))return"Float16Array"}}],[{key:"from",value:function(r){var e,n;if(!g(this,ir))throw Pt("This constructor is not a subclass of Float16Array");if(this===t){if(Br(r)&&0==(arguments.length<=1?0:arguments.length-1)){var o=Ur(r),i=new mt(pt(o),dt(o),gt(o));return new t(pt(vt(i)))}if(0==(arguments.length<=1?0:arguments.length-1))return new t(pt(_t(r,br)));var a=arguments.length<=1?void 0:arguments[1],u=arguments.length<=2?void 0:arguments[2];return new t(pt(_t(r,function(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return br(s(a,this,[t].concat(_toConsumableArray(Kt(e)))))},u)))}var c,l=r[S];if(null!=l&&"function"!=typeof l)throw Pt(f);if(null!=l)nr(r)?(e=r,n=r.length):Zt(c=r)&&c[S]===ot&&xt.next===Et?(e=r,n=gt(r)):n=(e=_toConsumableArray(r)).length;else{if(null==r)throw Pt("Cannot convert undefined or null to object");n=Ir((e=j(r)).length)}var h=new this(n);if(0==(arguments.length<=1?0:arguments.length-1))for(var v=0;v<n;++v)h[v]=e[v];else for(var y=arguments.length<=1?void 0:arguments[1],p=arguments.length<=2?void 0:arguments[2],d=0;d<n;++d)h[d]=s(y,p,[e[d],d]);return h}},{key:"of",value:function(){if(!g(this,ir))throw Pt("This constructor is not a subclass of Float16Array");var r=arguments.length;if(this===t){for(var e=new t(r),n=Ur(e),o=0;o<r;++o)n[o]=br(o<0||arguments.length<=o?void 0:arguments[o]);return e}for(var i=new this(r),a=0;a<r;++a)i[a]=a<0||arguments.length<=a?void 0:arguments[a];return i}}])}();I($r,"BYTES_PER_ELEMENT",{value:Nr}),I($r,ir,{}),m($r,rt);var qr=$r.prototype;function Jr(t){return sr(t)}return I(qr,"BYTES_PER_ELEMENT",{value:Nr}),I(qr,S,{value:qr.values,writable:!0,configurable:!0}),m(qr,nt),t.Float16Array=$r,t.f16round=Jr,t.getFloat16=function(t,r){for(var e=arguments.length,n=new Array(e>2?e-2:0),o=2;o<e;o++)n[o-2]=arguments[o];return jr(Ot.apply(void 0,[t,r].concat(_toConsumableArray(Kt(n)))))},t.hfround=Jr,t.isFloat16Array=Br,t.isTypedArray=function(t){return Zt(t)||Br(t)},t.setFloat16=function(t,r,e){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];return jt.apply(void 0,[t,r,br(e)].concat(_toConsumableArray(Kt(o))))},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t}({});

},{}],6:[function(require,module,exports){
"use strict";exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(o){var r=o.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=o.indexOf("=");return-1===e&&(e=r),[e,e===r?0:4-e%4]}function byteLength(o){var r=getLens(o),e=r[0],t=r[1];return 3*(e+t)/4-t}function _byteLength(o,r,e){return 3*(r+e)/4-e}function toByteArray(o){var r,e,t=getLens(o),n=t[0],u=t[1],p=new Arr(_byteLength(o,n,u)),a=0,h=u>0?n-4:n;for(e=0;e<h;e+=4)r=revLookup[o.charCodeAt(e)]<<18|revLookup[o.charCodeAt(e+1)]<<12|revLookup[o.charCodeAt(e+2)]<<6|revLookup[o.charCodeAt(e+3)],p[a++]=r>>16&255,p[a++]=r>>8&255,p[a++]=255&r;return 2===u&&(r=revLookup[o.charCodeAt(e)]<<2|revLookup[o.charCodeAt(e+1)]>>4,p[a++]=255&r),1===u&&(r=revLookup[o.charCodeAt(e)]<<10|revLookup[o.charCodeAt(e+1)]<<4|revLookup[o.charCodeAt(e+2)]>>2,p[a++]=r>>8&255,p[a++]=255&r),p}function tripletToBase64(o){return lookup[o>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]}function encodeChunk(o,r,e){for(var t,n=[],u=r;u<e;u+=3)t=(o[u]<<16&16711680)+(o[u+1]<<8&65280)+(255&o[u+2]),n.push(tripletToBase64(t));return n.join("")}function fromByteArray(o){for(var r,e=o.length,t=e%3,n=[],u=0,p=e-t;u<p;u+=16383)n.push(encodeChunk(o,u,u+16383>p?p:u+16383));return 1===t?(r=o[e-1],n.push(lookup[r>>2]+lookup[r<<4&63]+"==")):2===t&&(r=(o[e-2]<<8)+o[e-1],n.push(lookup[r>>10]+lookup[r>>4&63]+lookup[r<<2&63]+"=")),n.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;

},{}],7:[function(require,module,exports){
"use strict";

},{}],8:[function(require,module,exports){
"use strict";

},{}],9:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;function typedArraySupport(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}function createBuffer(e){if(e>K_MAX_LENGTH)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=Buffer.prototype,t}function Buffer(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(e)}return from(e,t,r)}function from(e,t,r){if("string"==typeof e)return fromString(e,t);if(ArrayBuffer.isView(e))return fromArrayLike(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof(e));if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer))return fromArrayBuffer(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return Buffer.from(n,t,r);var f=fromObject(e);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Buffer.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof(e))}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function alloc(e,t,r){return assertSize(e),e<=0?createBuffer(e):void 0!==t?"string"==typeof r?createBuffer(e).fill(t,r):createBuffer(e).fill(t):createBuffer(e)}function allocUnsafe(e){return assertSize(e),createBuffer(e<0?0:0|checked(e))}function fromString(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|byteLength(e,t),n=createBuffer(r),f=n.write(e,t);return f!==r&&(n=n.slice(0,f)),n}function fromArrayLike(e){for(var t=e.length<0?0:0|checked(e.length),r=createBuffer(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function fromArrayBuffer(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=Buffer.prototype,n}function fromObject(e){if(Buffer.isBuffer(e)){var t=0|checked(e.length),r=createBuffer(t);return 0===r.length?r:(e.copy(r,0,0,t),r)}return void 0!==e.length?"number"!=typeof e.length||numberIsNaN(e.length)?createBuffer(0):fromArrayLike(e):"Buffer"===e.type&&Array.isArray(e.data)?fromArrayLike(e.data):void 0}function checked(e){if(e>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function byteLength(e,t){if(Buffer.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+_typeof(e));var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var f=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(f)return n?-1:utf8ToBytes(e).length;t=(""+t).toLowerCase(),f=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,f){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),numberIsNaN(r=+r)&&(r=f?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(f)return-1;r=e.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof t&&(t=Buffer.from(t,n)),Buffer.isBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,f);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,f);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,f){var i,o=1,u=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,u/=2,s/=2,r/=2}function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(f){var h=-1;for(i=r;i<u;i++)if(a(e,i)===a(t,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===s)return h*o}else-1!==h&&(i-=i-h),h=-1}else for(r+s>u&&(r=u-s),i=r;i>=0;i--){for(var c=!0,l=0;l<s;l++)if(a(e,i+l)!==a(t,l)){c=!1;break}if(c)return i}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var f=e.length-r;n?(n=Number(n))>f&&(n=f):n=f;var i=t.length;n>i/2&&(n=i/2);for(var o=0;o<n;++o){var u=parseInt(t.substr(2*o,2),16);if(numberIsNaN(u))return o;e[r+o]=u}return o}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(asciiToBytes(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(utf16leToBytes(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?base64.fromByteArray(e):base64.fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],f=t;f<r;){var i,o,u,s,a=e[f],h=null,c=a>239?4:a>223?3:a>191?2:1;if(f+c<=r)switch(c){case 1:a<128&&(h=a);break;case 2:128==(192&(i=e[f+1]))&&(s=(31&a)<<6|63&i)>127&&(h=s);break;case 3:i=e[f+1],o=e[f+2],128==(192&i)&&128==(192&o)&&(s=(15&a)<<12|(63&i)<<6|63&o)>2047&&(s<55296||s>57343)&&(h=s);break;case 4:i=e[f+1],o=e[f+2],u=e[f+3],128==(192&i)&&128==(192&o)&&128==(192&u)&&(s=(15&a)<<18|(63&i)<<12|(63&o)<<6|63&u)>65535&&s<1114112&&(h=s)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),f+=c}return decodeCodePointsArray(n)}exports.kMaxLength=K_MAX_LENGTH,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(e,t,r){return from(e,t,r)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(e,t,r){return alloc(e,t,r)},Buffer.allocUnsafe=function(e){return allocUnsafe(e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)},Buffer.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Buffer.prototype},Buffer.compare=function(e,t){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),isInstance(t,Uint8Array)&&(t=Buffer.from(t,t.offset,t.byteLength)),!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,f=0,i=Math.min(r,n);f<i;++f)if(e[f]!==t[f]){r=e[f],n=t[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer.allocUnsafe(t),f=0;for(r=0;r<e.length;++r){var i=e[r];if(isInstance(i,Uint8Array)&&(i=Buffer.from(i)),!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,f),f+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function(){var e="",t=exports.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},Buffer.prototype.compare=function(e,t,r,n,f){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),!Buffer.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+_typeof(e));if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),t<0||r>e.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&t>=r)return 0;if(n>=f)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(f>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),u=Math.min(i,o),s=this.slice(n,f),a=e.slice(t,r),h=0;h<u;++h)if(s[h]!==a[h]){i=s[h],o=a[h];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var f=this.length-t;if((void 0===r||r>f)&&(r=f),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var f=t;f<r;++f)n+=String.fromCharCode(127&e[f]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var f=t;f<r;++f)n+=String.fromCharCode(e[f]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var f="",i=t;i<r;++i)f+=toHex(e[i]);return f}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),f="",i=0;i<n.length;i+=2)f+=String.fromCharCode(n[i]+256*n[i+1]);return f}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,f,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>f||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function checkIEEE754(e,t,r,n,f,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,f){return t=+t,r>>>=0,f||checkIEEE754(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,f){return t=+t,r>>>=0,f||checkIEEE754(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(e,t,r,n,52,8),r+8}Buffer.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=Buffer.prototype,n},Buffer.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e],f=1,i=0;++i<t&&(f*=256);)n+=this[e+i]*f;return n},Buffer.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],f=1;t>0&&(f*=256);)n+=this[e+--t]*f;return n},Buffer.prototype.readUInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e],f=1,i=0;++i<t&&(f*=256);)n+=this[e+i]*f;return n>=(f*=128)&&(n-=Math.pow(2,8*t)),n},Buffer.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=t,f=1,i=this[e+--n];n>0&&(f*=256);)i+=this[e+--n]*f;return i>=(f*=128)&&(i-=Math.pow(2,8*t)),i},Buffer.prototype.readInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),ieee754.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),ieee754.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),ieee754.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),ieee754.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var f=1,i=0;for(this[t]=255&e;++i<r&&(f*=256);)this[t+i]=e/f&255;return t+r},Buffer.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var f=r-1,i=1;for(this[t+f]=255&e;--f>=0&&(i*=256);)this[t+f]=e/i&255;return t+r},Buffer.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,255,0),this[t]=255&e,t+1},Buffer.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},Buffer.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,e,t,r,f-1,-f)}var i=0,o=1,u=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+r},Buffer.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,e,t,r,f-1,-f)}var i=r-1,o=1,u=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+r},Buffer.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},Buffer.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer.prototype.copy=function(e,t,r,n){if(!Buffer.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var f=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=f-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return f},Buffer.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var f=e.charCodeAt(0);("utf8"===n&&f<128||"latin1"===n)&&(e=f)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=Buffer.isBuffer(e)?e:Buffer.from(e,n),u=o.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%u]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(e){if((e=(e=e.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){var r;t=t||1/0;for(var n=e.length,f=null,i=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!f){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),f=r;continue}r=65536+(f-55296<<10|r-56320)}else f&&(t-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function utf16leToBytes(e,t){for(var r,n,f,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,f=r%256,i.push(f),i.push(n);return i}function base64ToBytes(e){return base64.toByteArray(base64clean(e))}function blitBuffer(e,t,r,n){for(var f=0;f<n&&!(f+r>=t.length||f>=e.length);++f)t[f+r]=e[f];return f}function isInstance(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function numberIsNaN(e){return e!=e}

}).call(this)}).call(this,require("buffer").Buffer)
},{"base64-js":6,"buffer":9,"ieee754":71}],10:[function(require,module,exports){
"use strict";module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"};

},{}],11:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _colorName=_interopRequireDefault(require("color-name"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=parse,baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function parse(e){var r,a,t=[],l=1;if("number"==typeof e)return{space:"rgb",values:[e>>>16,(65280&e)>>>8,255&e],alpha:1};if("number"==typeof e)return{space:"rgb",values:[e>>>16,(65280&e)>>>8,255&e],alpha:1};if(e=String(e).toLowerCase(),_colorName.default[e])t=_colorName.default[e].slice(),a="rgb";else if("transparent"===e)l=0,a="rgb",t=[0,0,0];else if("#"===e[0]){var s=e.slice(1),n=s.length;l=1,n<=4?(t=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===n&&(l=parseInt(s[3]+s[3],16)/255)):(t=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===n&&(l=parseInt(s[6]+s[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),a="rgb"}else if(r=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(e)){var o=r[1],u="cmyk"===(a=o.replace(/a$/,""))?4:"gray"===a?1:3;t=r[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===a&&(a=t.shift()),l=(t=t.map(function(e,r){if("%"===e[e.length-1])return e=parseFloat(e)/100,3===r?e:"rgb"===a?255*e:"h"===a[0]?100*e:"l"!==a[0]||r?"lab"===a?125*e:"lch"===a?r<2?150*e:360*e:"o"!==a[0]||r?"oklab"===a?.4*e:"oklch"===a?r<2?.4*e:360*e:e:e:100*e;if("h"===a[r]||2===r&&"h"===a[a.length-1]){if(void 0!==baseHues[e])return baseHues[e];if(e.endsWith("deg"))return parseFloat(e);if(e.endsWith("turn"))return 360*parseFloat(e);if(e.endsWith("grad"))return 360*parseFloat(e)/400;if(e.endsWith("rad"))return 180*parseFloat(e)/Math.PI}return"none"===e?0:parseFloat(e)})).length>u?t.pop():1}else if(/[0-9](?:\s|\/|,)/.test(e)){var i;t=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),a=(null===(i=e.match(/([a-z])/gi))||void 0===i||null===(i=i.join(""))||void 0===i?void 0:i.toLowerCase())||"rgb"}return{space:a,values:t,alpha:l}}

},{"color-name":12}],12:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};

},{}],13:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=rgba;var _colorParse=_interopRequireDefault(require("color-parse")),_rgb=_interopRequireDefault(require("color-space/rgb.js")),_hsl=_interopRequireDefault(require("color-space/hsl.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function rgba(e){var r;Array.isArray(e)&&e.raw&&(e=String.raw.apply(String,arguments)),e instanceof Number&&(e=+e);var a=(0,_colorParse.default)(e);if(!a.space)return[];var t="h"===a.space[0]?_hsl.default.min:_rgb.default.min,u="h"===a.space[0]?_hsl.default.max:_rgb.default.max;return(r=Array(3))[0]=Math.min(Math.max(a.values[0],t[0]),u[0]),r[1]=Math.min(Math.max(a.values[1],t[1]),u[1]),r[2]=Math.min(Math.max(a.values[2],t[2]),u[2]),"h"===a.space[0]&&(r=_hsl.default.rgb(r)),r.push(Math.min(Math.max(a.alpha,0),1)),r}

},{"color-parse":11,"color-space/hsl.js":14,"color-space/rgb.js":17}],14:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rgb=_interopRequireDefault(require("./rgb.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var r,t,a,u,n,i=e[0]/360,l=e[1]/100,o=e[2]/100,s=0;if(0===l)return[n=255*o,n,n];for(r=2*o-(t=o<.5?o*(1+l):o+l-o*l),u=[0,0,0];s<3;)(a=i+1/3*-(s-1))<0?a++:a>1&&a--,n=6*a<1?r+6*(t-r)*a:2*a<1?t:3*a<2?r+(t-r)*(2/3-a)*6:r,u[s++]=255*n;return u}};_rgb.default.hsl=function(e){var r,t,a=e[0]/255,u=e[1]/255,n=e[2]/255,i=Math.min(a,u,n),l=Math.max(a,u,n),o=l-i;return l===i?r=0:a===l?r=(u-n)/o:u===l?r=2+(n-a)/o:n===l&&(r=4+(a-u)/o),(r=Math.min(60*r,360))<0&&(r+=360),t=(i+l)/2,[r,100*(l===i?0:t<=.5?o/(l+i):o/(2-l-i)),100*t]};

},{"./rgb.js":17}],15:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _luv2=_interopRequireDefault(require("./luv.js")),_xyz=_interopRequireDefault(require("./xyz.js"));function _interopRequireDefault(u){return u&&u.__esModule?u:{default:u}}var lchuv={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(u){var e,t=u[0],l=u[1];return e=u[2]/360*2*Math.PI,[t,l*Math.cos(e),l*Math.sin(e)]},xyz:function(u){return _luv2.default.xyz(lchuv.luv(u))}},_default=exports.default=lchuv;_luv2.default.lchuv=function(u){var e=u[0],t=u[1],l=u[2],r=Math.sqrt(t*t+l*l),a=360*Math.atan2(l,t)/2/Math.PI;return a<0&&(a+=360),[e,r,a]},_xyz.default.lchuv=function(u){return _luv2.default.lchuv(_xyz.default.luv(u))};

},{"./luv.js":16,"./xyz.js":18}],16:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xyz2=_interopRequireDefault(require("./xyz.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(e,t,u){var i,a,r,n,l,o,f,d,_;if(r=e[0],n=e[1],l=e[2],0===r)return[0,0,0];return t=t||"D65",u=u||2,i=n/(13*r)+4*(f=_xyz2.default.whitepoint[u][t][0])/(f+15*(d=_xyz2.default.whitepoint[u][t][1])+3*(_=_xyz2.default.whitepoint[u][t][2]))||0,a=l/(13*r)+9*d/(f+15*d+3*_)||0,[9*(o=r>8?d*Math.pow((r+16)/116,3):d*r*.0011070564598794539)*i/(4*a)||0,o,o*(12-3*i-20*a)/(4*a)||0]}};_xyz2.default.luv=function(e,t,u){var i,a,r,n,l,o,f,d,_,p,x;t=t||"D65",u=u||2,p=4*(f=_xyz2.default.whitepoint[u][t][0])/(f+15*(d=_xyz2.default.whitepoint[u][t][1])+3*(_=_xyz2.default.whitepoint[u][t][2])),x=9*d/(f+15*d+3*_),i=4*(n=e[0])/(n+15*(l=e[1])+3*(o=e[2]))||0,a=9*l/(n+15*l+3*o)||0;var s=l/d;return[r=s<=.008856451679035631?903.2962962962961*s:116*Math.pow(s,1/3)-16,13*r*(i-p),13*r*(a-x)]};

},{"./xyz.js":18}],17:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};

},{}],18:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rgb=_interopRequireDefault(require("./rgb.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var xyz={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};xyz.max=xyz.whitepoint[2].D65,xyz.rgb=function(t,e){e=e||xyz.whitepoint[2].E;var a,r,i,n=t[0]/e[0],o=t[1]/e[1],u=t[2]/e[2];return r=-.96924363628087*n+1.87596750150772*o+.041555057407175*u,i=.055630079696993*n+-.20397695888897*o+1.056971514242878*u,a=(a=3.240969941904521*n+-1.537383177570093*o+-.498610760293*u)>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,[255*(a=Math.min(Math.max(0,a),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},_rgb.default.xyz=function(t,e){var a=t[0]/255,r=t[1]/255,i=t[2]/255,n=.21263900587151*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92)+.71516867876775*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.072192315360733*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92),o=.019330818715591*a+.11919477979462*r+.95053215224966*i;return[(.41239079926595*a+.35758433938387*r+.18048078840183*i)*(e=e||xyz.whitepoint[2].E)[0],n*e[1],o*e[2]]};var _default=exports.default=xyz;

},{"./rgb.js":17}],19:[function(require,module,exports){
"use strict";function earcut(e,n,r){r=r||2;var t,i,a,x,o,l,u,s=n&&n.length,v=s?n[0]*r:e.length,f=linkedList(e,0,v,r,!0),p=[];if(!f||f.next===f.prev)return p;if(s&&(f=eliminateHoles(e,n,f,r)),e.length>80*r){t=a=e[0],i=x=e[1];for(var c=r;c<v;c+=r)(o=e[c])<t&&(t=o),(l=e[c+1])<i&&(i=l),o>a&&(a=o),l>x&&(x=l);u=0!==(u=Math.max(a-t,x-i))?32767/u:0}return earcutLinked(f,p,r,t,i,u,0),p}function linkedList(e,n,r,t,i){var a,x;if(i===signedArea(e,n,r,t)>0)for(a=n;a<r;a+=t)x=insertNode(a,e[a],e[a+1],x);else for(a=r-t;a>=n;a-=t)x=insertNode(a,e[a],e[a+1],x);return x&&equals(x,x.next)&&(removeNode(x),x=x.next),x}function filterPoints(e,n){if(!e)return e;n||(n=e);var r,t=e;do{if(r=!1,t.steiner||!equals(t,t.next)&&0!==area(t.prev,t,t.next))t=t.next;else{if(removeNode(t),(t=n=t.prev)===t.next)break;r=!0}}while(r||t!==n);return n}function earcutLinked(e,n,r,t,i,a,x){if(e){!x&&a&&indexCurve(e,t,i,a);for(var o,l,u=e;e.prev!==e.next;)if(o=e.prev,l=e.next,a?isEarHashed(e,t,i,a):isEar(e))n.push(o.i/r|0),n.push(e.i/r|0),n.push(l.i/r|0),removeNode(e),e=l.next,u=l.next;else if((e=l)===u){x?1===x?earcutLinked(e=cureLocalIntersections(filterPoints(e),n,r),n,r,t,i,a,2):2===x&&splitEarcut(e,n,r,t,i,a):earcutLinked(filterPoints(e),n,r,t,i,a,1);break}}}function isEar(e){var n=e.prev,r=e,t=e.next;if(area(n,r,t)>=0)return!1;for(var i=n.x,a=r.x,x=t.x,o=n.y,l=r.y,u=t.y,s=i<a?i<x?i:x:a<x?a:x,v=o<l?o<u?o:u:l<u?l:u,f=i>a?i>x?i:x:a>x?a:x,p=o>l?o>u?o:u:l>u?l:u,c=t.next;c!==n;){if(c.x>=s&&c.x<=f&&c.y>=v&&c.y<=p&&pointInTriangle(i,o,a,l,x,u,c.x,c.y)&&area(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function isEarHashed(e,n,r,t){var i=e.prev,a=e,x=e.next;if(area(i,a,x)>=0)return!1;for(var o=i.x,l=a.x,u=x.x,s=i.y,v=a.y,f=x.y,p=o<l?o<u?o:u:l<u?l:u,c=s<v?s<f?s:f:v<f?v:f,d=o>l?o>u?o:u:l>u?l:u,y=s>v?s>f?s:f:v>f?v:f,h=zOrder(p,c,n,r,t),g=zOrder(d,y,n,r,t),m=e.prevZ,Z=e.nextZ;m&&m.z>=h&&Z&&Z.z<=g;){if(m.x>=p&&m.x<=d&&m.y>=c&&m.y<=y&&m!==i&&m!==x&&pointInTriangle(o,s,l,v,u,f,m.x,m.y)&&area(m.prev,m,m.next)>=0)return!1;if(m=m.prevZ,Z.x>=p&&Z.x<=d&&Z.y>=c&&Z.y<=y&&Z!==i&&Z!==x&&pointInTriangle(o,s,l,v,u,f,Z.x,Z.y)&&area(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}for(;m&&m.z>=h;){if(m.x>=p&&m.x<=d&&m.y>=c&&m.y<=y&&m!==i&&m!==x&&pointInTriangle(o,s,l,v,u,f,m.x,m.y)&&area(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;Z&&Z.z<=g;){if(Z.x>=p&&Z.x<=d&&Z.y>=c&&Z.y<=y&&Z!==i&&Z!==x&&pointInTriangle(o,s,l,v,u,f,Z.x,Z.y)&&area(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}return!0}function cureLocalIntersections(e,n,r){var t=e;do{var i=t.prev,a=t.next.next;!equals(i,a)&&intersects(i,t,t.next,a)&&locallyInside(i,a)&&locallyInside(a,i)&&(n.push(i.i/r|0),n.push(t.i/r|0),n.push(a.i/r|0),removeNode(t),removeNode(t.next),t=e=a),t=t.next}while(t!==e);return filterPoints(t)}function splitEarcut(e,n,r,t,i,a){var x=e;do{for(var o=x.next.next;o!==x.prev;){if(x.i!==o.i&&isValidDiagonal(x,o)){var l=splitPolygon(x,o);return x=filterPoints(x,x.next),l=filterPoints(l,l.next),earcutLinked(x,n,r,t,i,a,0),void earcutLinked(l,n,r,t,i,a,0)}o=o.next}x=x.next}while(x!==e)}function eliminateHoles(e,n,r,t){var i,a,x,o=[];for(i=0,a=n.length;i<a;i++)(x=linkedList(e,n[i]*t,i<a-1?n[i+1]*t:e.length,t,!1))===x.next&&(x.steiner=!0),o.push(getLeftmost(x));for(o.sort(compareX),i=0;i<o.length;i++)r=eliminateHole(o[i],r);return r}function compareX(e,n){return e.x-n.x}function eliminateHole(e,n){var r=findHoleBridge(e,n);if(!r)return n;var t=splitPolygon(r,e);return filterPoints(t,t.next),filterPoints(r,r.next)}function findHoleBridge(e,n){var r,t=n,i=e.x,a=e.y,x=-1/0;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){var o=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(o<=i&&o>x&&(x=o,r=t.x<t.next.x?t:t.next,o===i))return r}t=t.next}while(t!==n);if(!r)return null;var l,u=r,s=r.x,v=r.y,f=1/0;t=r;do{i>=t.x&&t.x>=s&&i!==t.x&&pointInTriangle(a<v?i:x,a,s,v,a<v?x:i,a,t.x,t.y)&&(l=Math.abs(a-t.y)/(i-t.x),locallyInside(t,e)&&(l<f||l===f&&(t.x>r.x||t.x===r.x&&sectorContainsSector(r,t)))&&(r=t,f=l)),t=t.next}while(t!==u);return r}function sectorContainsSector(e,n){return area(e.prev,e,n.prev)<0&&area(n.next,e,e.next)<0}function indexCurve(e,n,r,t){var i=e;do{0===i.z&&(i.z=zOrder(i.x,i.y,n,r,t)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,sortLinked(i)}function sortLinked(e){var n,r,t,i,a,x,o,l,u=1;do{for(r=e,e=null,a=null,x=0;r;){for(x++,t=r,o=0,n=0;n<u&&(o++,t=t.nextZ);n++);for(l=u;o>0||l>0&&t;)0!==o&&(0===l||!t||r.z<=t.z)?(i=r,r=r.nextZ,o--):(i=t,t=t.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=t}a.nextZ=null,u*=2}while(x>1);return e}function zOrder(e,n,r,t,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*i|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function getLeftmost(e){var n=e,r=e;do{(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next}while(n!==e);return r}function pointInTriangle(e,n,r,t,i,a,x,o){return(i-x)*(n-o)>=(e-x)*(a-o)&&(e-x)*(t-o)>=(r-x)*(n-o)&&(r-x)*(a-o)>=(i-x)*(t-o)}function isValidDiagonal(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!intersectsPolygon(e,n)&&(locallyInside(e,n)&&locallyInside(n,e)&&middleInside(e,n)&&(area(e.prev,e,n.prev)||area(e,n.prev,n))||equals(e,n)&&area(e.prev,e,e.next)>0&&area(n.prev,n,n.next)>0)}function area(e,n,r){return(n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y)}function equals(e,n){return e.x===n.x&&e.y===n.y}function intersects(e,n,r,t){var i=sign(area(e,n,r)),a=sign(area(e,n,t)),x=sign(area(r,t,e)),o=sign(area(r,t,n));return i!==a&&x!==o||(!(0!==i||!onSegment(e,r,n))||(!(0!==a||!onSegment(e,t,n))||(!(0!==x||!onSegment(r,e,t))||!(0!==o||!onSegment(r,n,t)))))}function onSegment(e,n,r){return n.x<=Math.max(e.x,r.x)&&n.x>=Math.min(e.x,r.x)&&n.y<=Math.max(e.y,r.y)&&n.y>=Math.min(e.y,r.y)}function sign(e){return e>0?1:e<0?-1:0}function intersectsPolygon(e,n){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&intersects(r,r.next,e,n))return!0;r=r.next}while(r!==e);return!1}function locallyInside(e,n){return area(e.prev,e,e.next)<0?area(e,n,e.next)>=0&&area(e,e.prev,n)>=0:area(e,n,e.prev)<0||area(e,e.next,n)<0}function middleInside(e,n){var r=e,t=!1,i=(e.x+n.x)/2,a=(e.y+n.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(t=!t),r=r.next}while(r!==e);return t}function splitPolygon(e,n){var r=new Node(e.i,e.x,e.y),t=new Node(n.i,n.x,n.y),i=e.next,a=n.prev;return e.next=n,n.prev=e,r.next=i,i.prev=r,t.next=r,r.prev=t,a.next=t,t.prev=a,t}function insertNode(e,n,r,t){var i=new Node(e,n,r);return t?(i.next=t.next,i.prev=t,t.next.prev=i,t.next=i):(i.prev=i,i.next=i),i}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,n,r){this.i=e,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,n,r,t){for(var i=0,a=n,x=r-t;a<r;a+=t)i+=(e[x]-e[a])*(e[a+1]+e[x+1]),x=a;return i}module.exports=earcut,module.exports.default=earcut,earcut.deviation=function(e,n,r,t){var i=n&&n.length,a=i?n[0]*r:e.length,x=Math.abs(signedArea(e,0,a,r));if(i)for(var o=0,l=n.length;o<l;o++){var u=n[o]*r,s=o<l-1?n[o+1]*r:e.length;x-=Math.abs(signedArea(e,u,s,r))}var v=0;for(o=0;o<t.length;o+=3){var f=t[o]*r,p=t[o+1]*r,c=t[o+2]*r;v+=Math.abs((e[f]-e[c])*(e[p+1]-e[f+1])-(e[f]-e[p])*(e[c+1]-e[f+1]))}return 0===x&&0===v?0:Math.abs((v-x)/x)},earcut.flatten=function(e){for(var n=e[0][0].length,r={vertices:[],holes:[],dimensions:n},t=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var x=0;x<n;x++)r.vertices.push(e[i][a][x]);i>0&&(t+=e[i-1].length,r.holes.push(t))}return r};

},{}],20:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ReflectOwnKeys,R="object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var NumberIsNaN=Number.isNaN||function(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,module.exports.once=once,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+_typeof(e))}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,n,r){var i,o,s;if(checkListener(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=_getMaxListeners(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,ProcessEmitWarning(u)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=onceWrapper.bind(r);return i.listener=n,r.wrapFn=i,i}function _listeners(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?unwrapListeners(i):arrayClone(i,i.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function once(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,o,{once:!0}),"error"!==t&&addErrorHandlerIfEventEmitter(e,i,{once:!0})})}function addErrorHandlerIfEventEmitter(e,t,n){"function"==typeof e.on&&eventTargetAgnosticAddListener(e,"error",t,n)}function eventTargetAgnosticAddListener(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+_typeof(e));e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)})}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");defaultMaxListeners=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)ReflectApply(u,this,t);else{var f=u.length,c=arrayClone(u,f);for(n=0;n<f;++n)ReflectApply(c[n],this,t)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var n,r,i,o,s;if(checkListener(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():spliceOne(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};

},{}],21:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function f(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function s(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new G(n||[]);return o(a,"_invoke",{value:j(t,e,c)}),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};f(b,a,function(){return this});var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==e&&n.call(x,a)&&(b=x);var L=w.prototype=g.prototype=Object.create(b);function P(t){["next","throw","return"].forEach(function(r){f(t,r,function(t){return this._invoke(r,t)})})}function E(t,r){function e(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?r.resolve(s.__await).then(function(t){e("next",t,a,c)},function(t){e("throw",t,a,c)}):r.resolve(s).then(function(t){f.value=t,a(f)},function(t){return e("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r(function(r,o){e(t,n,r,o)})}return i=i?i.then(o,o):o()}})}function j(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=S(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var f=l(r,e,n);if("normal"===f.type){if(o=n.done?v:p,f.arg===d)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=v,n.method="throw",n.arg=f.arg)}}}function S(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,S(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function O(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function k(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(_typeof(r)+" is not iterable")}return m.prototype=w,o(L,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=f(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,u,"GeneratorFunction")),t.prototype=Object.create(L),t},r.awrap=function(t){return{__await:t}},P(E.prototype),f(E.prototype,c,function(){return this}),r.AsyncIterator=E,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new E(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},P(L),f(L,u,"Generator"),f(L,a,function(){return this}),f(L,"toString",function(){return"[object Generator]"}),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,G.prototype={constructor:G,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),f=n.call(a,"finallyLoc");if(u&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),k(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function asyncGeneratorStep(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,r,e){return r&&_defineProperties(t.prototype,r),e&&_defineProperties(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var r=_toPrimitive(t,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0});var predictor_js_1=require("../predictor.js"),BaseDecoder=function(){return _createClass(function t(){_classCallCheck(this,t)},[{key:"decode",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(r,e){var n,o,i,a,c;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.decodeBlock(e);case 2:if(n=t.sent,1===(o=r.Predictor||1)){t.next=9;break}return i=!r.StripOffsets,a=i?r.TileWidth:r.ImageWidth,c=i?r.TileLength:r.RowsPerStrip||r.ImageLength,t.abrupt("return",(0,predictor_js_1.applyPredictor)(n,o,a,c,r.BitsPerSample,r.PlanarConfiguration));case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}},t,this)}));return function(r,e){return t.apply(this,arguments)}}()}])}();exports.default=BaseDecoder;

},{"../predictor.js":38}],22:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var pako_1=require("pako"),basedecoder_js_1=__importDefault(require("./basedecoder.js")),DeflateDecoder=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,basedecoder_js_1["default"]),_createClass(t,[{key:"decodeBlock",value:function(e){return(0,pako_1.inflate)(new Uint8Array(e)).buffer}}])}();exports.default=DeflateDecoder;

},{"./basedecoder.js":21,"pako":54}],23:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new G(n||[]);return o(a,"_invoke",{value:S(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function w(){}var _={};f(_,a,function(){return this});var b=Object.getPrototypeOf,x=b&&b(b(k([])));x&&x!==r&&n.call(x,a)&&(_=x);var L=w.prototype=m.prototype=Object.create(_);function j(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function E(t,e){function r(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?e.resolve(s.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(s).then(function(t){f.value=t,a(f)},function(t){return r("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=D(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var f=l(e,r,n);if("normal"===f.type){if(o=n.done?y:p,f.arg===v)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=y,n.method="throw",n.arg=f.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=w,o(L,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=f(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},j(E.prototype),f(E.prototype,u,function(){return this}),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},j(L),f(L,c,"Generator"),f(L,a,function(){return this}),f(L,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=k,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),f=n.call(a,"finallyLoc");if(c&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}var __createBinding=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDecoder=exports.addDecoder=void 0;var registry=new Map;function addDecoder(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(t){return registry.set(t,e)})}function getDecoder(t){return _getDecoder.apply(this,arguments)}function _getDecoder(){return(_getDecoder=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=registry.get(e.Compression)){t.next=3;break}throw new Error("Unknown compression method identifier: ".concat(e.Compression));case 3:return t.next=5,r();case 5:return n=t.sent,t.abrupt("return",new n(e));case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}exports.addDecoder=addDecoder,exports.getDecoder=getDecoder,addDecoder([void 0,1],function(){return Promise.resolve().then(function(){return __importStar(require("./raw.js"))}).then(function(t){return t.default})}),addDecoder(5,function(){return Promise.resolve().then(function(){return __importStar(require("./lzw.js"))}).then(function(t){return t.default})}),addDecoder(6,function(){throw new Error("old style JPEG compression is not supported.")}),addDecoder(7,function(){return Promise.resolve().then(function(){return __importStar(require("./jpeg.js"))}).then(function(t){return t.default})}),addDecoder([8,32946],function(){return Promise.resolve().then(function(){return __importStar(require("./deflate.js"))}).then(function(t){return t.default})}),addDecoder(32773,function(){return Promise.resolve().then(function(){return __importStar(require("./packbits.js"))}).then(function(t){return t.default})}),addDecoder(34887,function(){return Promise.resolve().then(function(){return __importStar(require("./lerc.js"))}).then(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.zstd.init();case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).then(function(t){return t.default})}),addDecoder(50001,function(){return Promise.resolve().then(function(){return __importStar(require("./webimage.js"))}).then(function(t){return t.default})});

},{"./deflate.js":22,"./jpeg.js":24,"./lerc.js":25,"./lzw.js":26,"./packbits.js":27,"./raw.js":28,"./webimage.js":29}],24:[function(require,module,exports){
"use strict";function _callSuper(e,r,t){return r=_getPrototypeOf(r),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(r,t||[],_getPrototypeOf(e).constructor):r.apply(e,t))}function _possibleConstructorReturn(e,r){if(r&&("object"==_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&_setPrototypeOf(e,r)}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var basedecoder_js_1=__importDefault(require("./basedecoder.js")),dctZigZag=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),dctCos1=4017,dctSin1=799,dctCos3=3406,dctSin3=2276,dctCos6=1567,dctSin6=3784,dctSqrt2=5793,dctSqrt1d2=2896;function buildHuffmanTable(e,r){for(var t=0,n=[],o=16;o>0&&!e[o-1];)--o;n.push({children:[],index:0});for(var a,i=n[0],s=0;s<o;s++){for(var c=0;c<e[s];c++){for((i=n.pop()).children[i.index]=r[t];i.index>0;)i=n.pop();for(i.index++,n.push(i);n.length<=s;)n.push(a={children:[],index:0}),i.children[i.index]=a.children,i=a;t++}s+1<o&&(n.push(a={children:[],index:0}),i.children[i.index]=a.children,i=a)}return n[0].children}function decodeScan(e,r,t,n,o,a,i,s,c){var f=t.mcusPerLine,u=t.progressive,l=r,d=r,p=0,h=0;function v(){if(h>0)return p>>--h&1;if(255===(p=e[d++])){var r=e[d++];if(r)throw new Error("unexpected marker: ".concat((p<<8|r).toString(16)))}return h=7,p>>>7}function b(e){for(var r,t=e;null!==(r=v());){if("number"==typeof(t=t[r]))return t;if("object"!==_typeof(t))throw new Error("invalid huffman sequence")}return null}function m(e){for(var r=e,t=0;r>0;){var n=v();if(null===n)return;t=t<<1|n,--r}return t}function y(e){var r=m(e);return r>=1<<e-1?r:r+(-1<<e)+1}var _=0;var C,w=0;function g(e,r,t,n,o){var a=t%f,i=(t/f|0)*e.v+n,s=a*e.h+o;r(e,e.blocks[i][s])}function P(e,r,t){var n=t/e.blocksPerLine|0,o=t%e.blocksPerLine;r(e,e.blocks[n][o])}var S,k,O,T,j,q,x=n.length;q=u?0===a?0===s?function(e,r){var t=b(e.huffmanTableDC),n=0===t?0:y(t)<<c;e.pred+=n,r[0]=e.pred}:function(e,r){r[0]|=v()<<c}:0===s?function(e,r){if(_>0)_--;else for(var t=a,n=i;t<=n;){var o=b(e.huffmanTableAC),s=15&o,f=o>>4;if(0===s){if(f<15){_=m(f)+(1<<f)-1;break}t+=16}else r[dctZigZag[t+=f]]=y(s)*(1<<c),t++}}:function(e,r){for(var t=a,n=i,o=0;t<=n;){var s=dctZigZag[t],f=r[s]<0?-1:1;switch(w){case 0:var u=b(e.huffmanTableAC),l=15&u;if(o=u>>4,0===l)o<15?(_=m(o)+(1<<o),w=4):(o=16,w=1);else{if(1!==l)throw new Error("invalid ACn encoding");C=y(l),w=o?2:3}continue;case 1:case 2:r[s]?r[s]+=(v()<<c)*f:0==--o&&(w=2===w?3:0);break;case 3:r[s]?r[s]+=(v()<<c)*f:(r[s]=C<<c,w=0);break;case 4:r[s]&&(r[s]+=(v()<<c)*f)}t++}4===w&&0==--_&&(w=0)}:function(e,r){var t=b(e.huffmanTableDC),n=0===t?0:y(t);e.pred+=n,r[0]=e.pred;for(var o=1;o<64;){var a=b(e.huffmanTableAC),i=15&a,s=a>>4;if(0===i){if(s<15)break;o+=16}else r[dctZigZag[o+=s]]=y(i),o++}};var A,D,E=0;D=1===x?n[0].blocksPerLine*n[0].blocksPerColumn:f*t.mcusPerColumn;for(var L=o||D;E<D;){for(k=0;k<x;k++)n[k].pred=0;if(_=0,1===x)for(S=n[0],j=0;j<L;j++)P(S,q,E),E++;else for(j=0;j<L;j++){for(k=0;k<x;k++){var I=S=n[k],R=I.h,Z=I.v;for(O=0;O<Z;O++)for(T=0;T<R;T++)g(S,q,E,O,T)}if(++E===D)break}if(h=0,(A=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(A>=65488&&A<=65495))break;d+=2}return d-l}function buildComponentData(e,r){var t=[],n=r.blocksPerLine,o=r.blocksPerColumn,a=n<<3,i=new Int32Array(64),s=new Uint8Array(64);function c(e,t,n){var o,a,i,s,c,f,u,l,d,p,h=r.quantizationTable,v=n;for(p=0;p<64;p++)v[p]=e[p]*h[p];for(p=0;p<8;++p){var b=8*p;0!==v[1+b]||0!==v[2+b]||0!==v[3+b]||0!==v[4+b]||0!==v[5+b]||0!==v[6+b]||0!==v[7+b]?(o=dctSqrt2*v[0+b]+128>>8,a=dctSqrt2*v[4+b]+128>>8,i=v[2+b],s=v[6+b],c=dctSqrt1d2*(v[1+b]-v[7+b])+128>>8,l=dctSqrt1d2*(v[1+b]+v[7+b])+128>>8,f=v[3+b]<<4,u=v[5+b]<<4,d=o-a+1>>1,o=o+a+1>>1,a=d,d=i*dctSin6+s*dctCos6+128>>8,i=i*dctCos6-s*dctSin6+128>>8,s=d,d=c-u+1>>1,c=c+u+1>>1,u=d,d=l+f+1>>1,f=l-f+1>>1,l=d,d=o-s+1>>1,o=o+s+1>>1,s=d,d=a-i+1>>1,a=a+i+1>>1,i=d,d=c*dctSin3+l*dctCos3+2048>>12,c=c*dctCos3-l*dctSin3+2048>>12,l=d,d=f*dctSin1+u*dctCos1+2048>>12,f=f*dctCos1-u*dctSin1+2048>>12,u=d,v[0+b]=o+l,v[7+b]=o-l,v[1+b]=a+u,v[6+b]=a-u,v[2+b]=i+f,v[5+b]=i-f,v[3+b]=s+c,v[4+b]=s-c):(d=dctSqrt2*v[0+b]+512>>10,v[0+b]=d,v[1+b]=d,v[2+b]=d,v[3+b]=d,v[4+b]=d,v[5+b]=d,v[6+b]=d,v[7+b]=d)}for(p=0;p<8;++p){var m=p;0!==v[8+m]||0!==v[16+m]||0!==v[24+m]||0!==v[32+m]||0!==v[40+m]||0!==v[48+m]||0!==v[56+m]?(o=dctSqrt2*v[0+m]+2048>>12,a=dctSqrt2*v[32+m]+2048>>12,i=v[16+m],s=v[48+m],c=dctSqrt1d2*(v[8+m]-v[56+m])+2048>>12,l=dctSqrt1d2*(v[8+m]+v[56+m])+2048>>12,f=v[24+m],u=v[40+m],d=o-a+1>>1,o=o+a+1>>1,a=d,d=i*dctSin6+s*dctCos6+2048>>12,i=i*dctCos6-s*dctSin6+2048>>12,s=d,d=c-u+1>>1,c=c+u+1>>1,u=d,d=l+f+1>>1,f=l-f+1>>1,l=d,d=o-s+1>>1,o=o+s+1>>1,s=d,d=a-i+1>>1,a=a+i+1>>1,i=d,d=c*dctSin3+l*dctCos3+2048>>12,c=c*dctCos3-l*dctSin3+2048>>12,l=d,d=f*dctSin1+u*dctCos1+2048>>12,f=f*dctCos1-u*dctSin1+2048>>12,u=d,v[0+m]=o+l,v[56+m]=o-l,v[8+m]=a+u,v[48+m]=a-u,v[16+m]=i+f,v[40+m]=i-f,v[24+m]=s+c,v[32+m]=s-c):(d=dctSqrt2*n[p+0]+8192>>14,v[0+m]=d,v[8+m]=d,v[16+m]=d,v[24+m]=d,v[32+m]=d,v[40+m]=d,v[48+m]=d,v[56+m]=d)}for(p=0;p<64;++p){var y=128+(v[p]+8>>4);t[p]=y<0?0:y>255?255:y}}for(var f=0;f<o;f++){for(var u=f<<3,l=0;l<8;l++)t.push(new Uint8Array(a));for(var d=0;d<n;d++){c(r.blocks[f][d],s,i);for(var p=0,h=d<<3,v=0;v<8;v++)for(var b=t[u+v],m=0;m<8;m++)b[h+m]=s[p++]}}return t}var JpegStreamReader=function(){return _createClass(function e(){_classCallCheck(this,e),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()},[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(e){var r=0;function t(){var t=e[r]<<8|e[r+1];return r+=2,t}function n(e){var r,t,n=0,o=0;for(t in e.components)e.components.hasOwnProperty(t)&&(n<(r=e.components[t]).h&&(n=r.h),o<r.v&&(o=r.v));var a=Math.ceil(e.samplesPerLine/8/n),i=Math.ceil(e.scanLines/8/o);for(t in e.components)if(e.components.hasOwnProperty(t)){r=e.components[t];for(var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*r.h/n),c=Math.ceil(Math.ceil(e.scanLines/8)*r.v/o),f=a*r.h,u=i*r.v,l=[],d=0;d<u;d++){for(var p=[],h=0;h<f;h++)p.push(new Int32Array(64));l.push(p)}r.blocksPerLine=s,r.blocksPerColumn=c,r.blocks=l}e.maxH=n,e.maxV=o,e.mcusPerLine=a,e.mcusPerColumn=i}var o,a,i=t();if(65496!==i)throw new Error("SOI not found");for(i=t();65497!==i;){switch(i){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var s=(o=void 0,a=void 0,o=t(),a=e.subarray(r,r+o-2),r+=a.length,a);65504===i&&74===s[0]&&70===s[1]&&73===s[2]&&70===s[3]&&0===s[4]&&(this.jfif={version:{major:s[5],minor:s[6]},densityUnits:s[7],xDensity:s[8]<<8|s[9],yDensity:s[10]<<8|s[11],thumbWidth:s[12],thumbHeight:s[13],thumbData:s.subarray(14,14+3*s[12]*s[13])}),65518===i&&65===s[0]&&100===s[1]&&111===s[2]&&98===s[3]&&101===s[4]&&0===s[5]&&(this.adobe={version:s[6],flags0:s[7]<<8|s[8],flags1:s[9]<<8|s[10],transformCode:s[11]});break;case 65499:for(var c=t()+r-2;r<c;){var f=e[r++],u=new Int32Array(64);if(f>>4==0)for(var l=0;l<64;l++){u[dctZigZag[l]]=e[r++]}else{if(f>>4!=1)throw new Error("DQT: invalid table spec");for(var d=0;d<64;d++){u[dctZigZag[d]]=t()}}this.quantizationTables[15&f]=u}break;case 65472:case 65473:case 65474:t();for(var p={extended:65473===i,progressive:65474===i,precision:e[r++],scanLines:t(),samplesPerLine:t(),components:{},componentsOrder:[]},h=e[r++],v=void 0,b=0;b<h;b++){v=e[r];var m=e[r+1]>>4,y=15&e[r+1],_=e[r+2];p.componentsOrder.push(v),p.components[v]={h:m,v:y,quantizationIdx:_},r+=3}n(p),this.frames.push(p);break;case 65476:for(var C=t(),w=2;w<C;){for(var g=e[r++],P=new Uint8Array(16),S=0,k=0;k<16;k++,r++)P[k]=e[r],S+=P[k];for(var O=new Uint8Array(S),T=0;T<S;T++,r++)O[T]=e[r];w+=17+S,g>>4==0?this.huffmanTablesDC[15&g]=buildHuffmanTable(P,O):this.huffmanTablesAC[15&g]=buildHuffmanTable(P,O)}break;case 65501:t(),this.resetInterval=t();break;case 65498:t();for(var j=e[r++],q=[],x=this.frames[0],A=0;A<j;A++){var D=x.components[e[r++]],E=e[r++];D.huffmanTableDC=this.huffmanTablesDC[E>>4],D.huffmanTableAC=this.huffmanTablesAC[15&E],q.push(D)}var L=e[r++],I=e[r++],R=e[r++],Z=decodeScan(e,r,x,q,this.resetInterval,L,I,R>>4,15&R);r+=Z;break;case 65535:255!==e[r]&&r--;break;default:if(255===e[r-3]&&e[r-2]>=192&&e[r-2]<=254){r-=3;break}throw new Error("unknown JPEG marker ".concat(i.toString(16)))}i=t()}}},{key:"getResult",value:function(){var e=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var r=0;r<this.frames.length;r++)for(var t=this.frames[r].components,n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];t[a].quantizationTable=this.quantizationTables[t[a].quantizationIdx],delete t[a].quantizationIdx}for(var i=e[0],s=i.components,c=i.componentsOrder,f=[],u=i.samplesPerLine,l=i.scanLines,d=0;d<c.length;d++){var p=s[c[d]];f.push({lines:buildComponentData(i,p),scaleX:p.h/i.maxH,scaleY:p.v/i.maxV})}for(var h=new Uint8Array(u*l*f.length),v=0,b=0;b<l;++b)for(var m=0;m<u;++m)for(var y=0;y<f.length;++y){var _=f[y];h[v]=_.lines[0|b*_.scaleY][0|m*_.scaleX],++v}return h}}])}(),JpegDecoder=function(e){function r(e){var t;return _classCallCheck(this,r),(t=_callSuper(this,r)).reader=new JpegStreamReader,e.JPEGTables&&t.reader.parse(e.JPEGTables),t}return _inherits(r,basedecoder_js_1["default"]),_createClass(r,[{key:"decodeBlock",value:function(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}])}();exports.default=JpegDecoder;

},{"./basedecoder.js":21}],25:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.zstd=void 0;var pako_1=require("pako"),lerc_1=__importDefault(require("lerc")),zstddec_1=require("zstddec"),basedecoder_js_1=__importDefault(require("./basedecoder.js")),globals_js_1=require("../globals.js");exports.zstd=new zstddec_1.ZSTDDecoder;var LercDecoder=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).planarConfiguration=void 0!==e.PlanarConfiguration?e.PlanarConfiguration:1,r.samplesPerPixel=void 0!==e.SamplesPerPixel?e.SamplesPerPixel:1,r.addCompression=e.LercParameters[globals_js_1.LercParameters.AddCompression],r}return _inherits(t,basedecoder_js_1["default"]),_createClass(t,[{key:"decodeBlock",value:function(e){switch(this.addCompression){case globals_js_1.LercAddCompression.None:break;case globals_js_1.LercAddCompression.Deflate:e=(0,pako_1.inflate)(new Uint8Array(e)).buffer;break;case globals_js_1.LercAddCompression.Zstandard:e=exports.zstd.decode(new Uint8Array(e)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return lerc_1.default.decode(e,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}])}();exports.default=LercDecoder;

},{"../globals.js":35,"./basedecoder.js":21,"lerc":73,"pako":54,"zstddec":460}],26:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var basedecoder_js_1=__importDefault(require("./basedecoder.js")),MIN_BITS=9,CLEAR_CODE=256,EOI_CODE=257,MAX_BYTELENGTH=12;function getByte(e,t,r){var o=t%8,n=Math.floor(t/8),i=8-o,u=t+r-8*(n+1),f=8*(n+2)-(t+r),c=8*(n+2)-t;if(f=Math.max(0,f),n>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),EOI_CODE;var a=e[n]&Math.pow(2,8-o)-1,s=a<<=r-i;if(n+1<e.length){var p=e[n+1]>>>f;s+=p<<=Math.max(0,r-c)}if(u>8&&n+2<e.length){var l=8*(n+3)-(t+r);s+=e[n+2]>>>l}return s}function appendReversed(e,t){for(var r=t.length-1;r>=0;r--)e.push(t[r]);return e}function decompress(e){for(var t=new Uint16Array(4093),r=new Uint8Array(4093),o=0;o<=257;o++)t[o]=4096,r[o]=o;var n=258,i=MIN_BITS,u=0;function f(){n=258,i=MIN_BITS}function c(e){var t=getByte(e,u,i);return u+=i,t}function a(e,o){return r[n]=o,t[n]=e,++n-1}function s(e){for(var o=[],n=e;4096!==n;n=t[n])o.push(r[n]);return o}var p=[];f();for(var l,_=new Uint8Array(e),y=c(_);y!==EOI_CODE;){if(y===CLEAR_CODE){for(f(),y=c(_);y===CLEAR_CODE;)y=c(_);if(y===EOI_CODE)break;if(y>CLEAR_CODE)throw new Error("corrupted code at scanline ".concat(y));appendReversed(p,s(y)),l=y}else if(y<n){var d=s(y);appendReversed(p,d),a(l,d[d.length-1]),l=y}else{var b=s(l);if(!b)throw new Error("Bogus entry. Not in dictionary, ".concat(l," / ").concat(n,", position: ").concat(u));appendReversed(p,b),p.push(b[b.length-1]),a(l,b[b.length-1]),l=y}n+1>=Math.pow(2,i)&&(i===MAX_BYTELENGTH?l=void 0:i++),y=c(_)}return new Uint8Array(p)}var LZWDecoder=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,basedecoder_js_1["default"]),_createClass(t,[{key:"decodeBlock",value:function(e){return decompress(e,!1).buffer}}])}();exports.default=LZWDecoder;

},{"./basedecoder.js":21}],27:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var basedecoder_js_1=__importDefault(require("./basedecoder.js")),PackbitsDecoder=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,basedecoder_js_1["default"]),_createClass(t,[{key:"decodeBlock",value:function(e){for(var t=new DataView(e),r=[],o=0;o<e.byteLength;++o){var n=t.getInt8(o);if(n<0){var i=t.getUint8(o+1);n=-n;for(var u=0;u<=n;++u)r.push(i);o+=1}else{for(var c=0;c<=n;++c)r.push(t.getUint8(o+c+1));o+=n+1}}return new Uint8Array(r).buffer}}])}();exports.default=PackbitsDecoder;

},{"./basedecoder.js":21}],28:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var basedecoder_js_1=__importDefault(require("./basedecoder.js")),RawDecoder=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,basedecoder_js_1["default"]),_createClass(t,[{key:"decodeBlock",value:function(e){return e}}])}();exports.default=RawDecoder;

},{"./basedecoder.js":21}],29:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:j(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function _(){}var b={};f(b,a,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,a)&&(b=O);var P=_.prototype=m.prototype=Object.create(b);function x(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function E(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?e.resolve(s.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(s).then(function(t){f.value=t,a(f)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var f=l(e,r,n);if("normal"===f.type){if(o=n.done?d:p,f.arg===v)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=d,n.method="throw",n.arg=f.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=_,o(P,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:g,configurable:!0}),g.displayName=f(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,u,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},x(E.prototype),f(E.prototype,c,function(){return this}),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(P),f(P,u,"Generator"),f(P,a,function(){return this}),f(P,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),f=n.call(a,"finallyLoc");if(u&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var __importDefault=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var basedecoder_js_1=__importDefault(require("./basedecoder.js")),WebImageDecoder=function(t){function e(){var t;if(_classCallCheck(this,e),t=_callSuper(this,e),"undefined"==typeof createImageBitmap)throw new Error("Cannot decode WebImage as `createImageBitmap` is not available");if("undefined"==typeof document&&"undefined"==typeof OffscreenCanvas)throw new Error("Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available");return t}return _inherits(e,basedecoder_js_1["default"]),_createClass(e,[{key:"decode",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){var n,o,i,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Blob([r]),t.next=3,createImageBitmap(n);case 3:return o=t.sent,"undefined"!=typeof document?((i=document.createElement("canvas")).width=o.width,i.height=o.height):i=new OffscreenCanvas(o.width,o.height),(a=i.getContext("2d")).drawImage(o,0,0),t.abrupt("return",a.getImageData(0,0,o.width,o.height).data.buffer);case 8:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()}])}();exports.default=WebImageDecoder;

},{"./basedecoder.js":21}],30:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0});var DataSlice=function(){return _createClass(function t(e,i,n,r){_classCallCheck(this,t),this._dataView=new DataView(e),this._sliceOffset=i,this._littleEndian=n,this._bigTiff=r},[{key:"sliceOffset",get:function(){return this._sliceOffset}},{key:"sliceTop",get:function(){return this._sliceOffset+this.buffer.byteLength}},{key:"littleEndian",get:function(){return this._littleEndian}},{key:"bigTiff",get:function(){return this._bigTiff}},{key:"buffer",get:function(){return this._dataView.buffer}},{key:"covers",value:function(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}},{key:"readUint8",value:function(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}},{key:"readInt8",value:function(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}},{key:"readUint16",value:function(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}},{key:"readInt16",value:function(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}},{key:"readUint32",value:function(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}},{key:"readInt32",value:function(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}},{key:"readFloat32",value:function(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}},{key:"readFloat64",value:function(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}},{key:"readUint64",value:function(t){var e,i=this.readUint32(t),n=this.readUint32(t+4);if(this._littleEndian){if(e=i+Math.pow(2,32)*n,!Number.isSafeInteger(e))throw new Error("".concat(e," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return e}if(e=Math.pow(2,32)*i+n,!Number.isSafeInteger(e))throw new Error("".concat(e," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return e}},{key:"readInt64",value:function(t){for(var e=0,i=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0,n=!0,r=0;r<8;r++){var s=this._dataView.getUint8(t+(this._littleEndian?r:7-r));i&&(n?0!==s&&(s=255&~(s-1),n=!1):s=255&~s),e+=s*Math.pow(256,r)}return i&&(e=-e),e}},{key:"readOffset",value:function(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}])}();exports.default=DataSlice;

},{}],31:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0});var float16_1=require("@petamoriken/float16"),DataView64=function(){return _createClass(function t(e){_classCallCheck(this,t),this._dataView=new DataView(e)},[{key:"buffer",get:function(){return this._dataView.buffer}},{key:"getUint64",value:function(t,e){var i,r=this.getUint32(t,e),n=this.getUint32(t+4,e);if(e){if(i=r+Math.pow(2,32)*n,!Number.isSafeInteger(i))throw new Error("".concat(i," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}if(i=Math.pow(2,32)*r+n,!Number.isSafeInteger(i))throw new Error("".concat(i," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}},{key:"getInt64",value:function(t,e){for(var i=0,r=(128&this._dataView.getUint8(t+(e?7:0)))>0,n=!0,o=0;o<8;o++){var a=this._dataView.getUint8(t+(e?o:7-o));r&&(n?0!==a&&(a=255&~(a-1),n=!1):a=255&~a),i+=a*Math.pow(256,o)}return r&&(i=-i),i}},{key:"getUint8",value:function(t,e){return this._dataView.getUint8(t,e)}},{key:"getInt8",value:function(t,e){return this._dataView.getInt8(t,e)}},{key:"getUint16",value:function(t,e){return this._dataView.getUint16(t,e)}},{key:"getInt16",value:function(t,e){return this._dataView.getInt16(t,e)}},{key:"getUint32",value:function(t,e){return this._dataView.getUint32(t,e)}},{key:"getInt32",value:function(t,e){return this._dataView.getInt32(t,e)}},{key:"getFloat16",value:function(t,e){return(0,float16_1.getFloat16)(this._dataView,t,e)}},{key:"getFloat32",value:function(t,e){return this._dataView.getFloat32(t,e)}},{key:"getFloat64",value:function(t,e){return this._dataView.getFloat64(t,e)}}])}();exports.default=DataView64;

},{"@petamoriken/float16":5}],32:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,r,t){e[r]=t.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{c({},"")}catch(e){c=function(e,r,t){return e[r]=t}}function l(e,r,t,n){var a=r&&r.prototype instanceof d?r:d,i=Object.create(a.prototype),s=new S(n||[]);return o(i,"_invoke",{value:k(e,t,s)}),i}function f(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(e){return{type:"throw",arg:e}}}r.wrap=l;var p="suspendedStart",y="suspendedYield",h="executing",_="completed",g={};function d(){}function b(){}function m(){}var v={};c(v,i,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(A([])));x&&x!==t&&n.call(x,i)&&(v=x);var T=m.prototype=d.prototype=Object.create(v);function j(e){["next","throw","return"].forEach(function(r){c(e,r,function(e){return this._invoke(r,e)})})}function F(e,r){function t(o,a,i,s){var u=f(e[o],e,a);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?r.resolve(l.__await).then(function(e){t("next",e,i,s)},function(e){t("throw",e,i,s)}):r.resolve(l).then(function(e){c.value=e,i(c)},function(e){return t("throw",e,i,s)})}s(u.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new r(function(r,o){t(e,n,r,o)})}return a=a?a.then(o,o):o()}})}function k(r,t,n){var o=p;return function(a,i){if(o===h)throw Error("Generator is already running");if(o===_){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var u=I(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var c=f(r,t,n);if("normal"===c.type){if(o=n.done?_:y,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=_,n.method="throw",n.arg=c.arg)}}}function I(r,t){var n=t.method,o=r.iterator[n];if(o===e)return t.delegate=null,"throw"===n&&r.iterator.return&&(t.method="return",t.arg=e,I(r,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=f(o,r.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,g;var i=a.arg;return i?i.done?(t[r.resultName]=i.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function O(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function R(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function A(r){if(r||""===r){var t=r[i];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function t(){for(;++o<r.length;)if(n.call(r,o))return t.value=r[o],t.done=!1,t;return t.value=e,t.done=!0,t};return a.next=a}}throw new TypeError(_typeof(r)+" is not iterable")}return b.prototype=m,o(T,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:b,configurable:!0}),b.displayName=c(m,u,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===b||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,u,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},j(F.prototype),c(F.prototype,s,function(){return this}),r.AsyncIterator=F,r.async=function(e,t,n,o,a){void 0===a&&(a=Promise);var i=new F(l(e,t,n,o),a);return r.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(T),c(T,u,"Generator"),c(T,i,function(){return this}),c(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),t=[];for(var n in r)t.push(n);return t.reverse(),function e(){for(;t.length;){var n=t.pop();if(n in r)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=A,S.prototype={constructor:S,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!r)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function o(n,o){return s.type="throw",s.arg=r,t.next=n,o&&(t.method="next",t.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,r){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),R(t),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var o=n.arg;R(t)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,t,n){return this.delegate={iterator:A(r),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=e),g}},r}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a,i,s=[],u=!0,c=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=a.call(t)).done)&&(s.push(n.value),s.length!==r);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,r,t,n,o,a,i){try{var s=e[a](i),u=s.value}catch(e){return void t(e)}s.done?r(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise(function(n,o){var a=e.apply(r,t);function i(e){asyncGeneratorStep(a,n,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,n,o,i,s,"throw",e)}i(void 0)})}}function _callSuper(e,r,t){return r=_getPrototypeOf(r),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(r,t||[],_getPrototypeOf(e).constructor):r.apply(e,t))}function _possibleConstructorReturn(e,r){if(r&&("object"==_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&_setPrototypeOf(e,r)}function _wrapNativeSuper(e){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,r,t){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,r);var o=new(e.bind.apply(e,n));return t&&_setPrototypeOf(o,t.prototype),o}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(r){return"function"==typeof e}}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var __createBinding=Object.create?function(e,r,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]},__setModuleDefault=Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r},__importStar=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(r,e,t);return __setModuleDefault(r,e),r},__importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseResponse=exports.BaseClient=exports.GeoTIFFImage=exports.Pool=exports.writeArrayBuffer=exports.fromUrls=exports.fromBlob=exports.fromFile=exports.fromArrayBuffer=exports.fromCustomClient=exports.fromUrl=exports.MultiGeoTIFF=exports.GeoTIFF=exports.setLogger=exports.addDecoder=exports.getDecoder=exports.BaseDecoder=exports.rgb=exports.globals=void 0;var geotiffimage_js_1=__importDefault(require("./geotiffimage.js"));exports.GeoTIFFImage=geotiffimage_js_1.default;var dataview64_js_1=__importDefault(require("./dataview64.js")),dataslice_js_1=__importDefault(require("./dataslice.js")),pool_js_1=__importDefault(require("./pool.js"));exports.Pool=pool_js_1.default;var remote_js_1=require("./source/remote.js"),arraybuffer_js_1=require("./source/arraybuffer.js"),filereader_js_1=require("./source/filereader.js"),file_js_1=require("./source/file.js"),base_js_1=require("./source/client/base.js");Object.defineProperty(exports,"BaseClient",{enumerable:!0,get:function(){return base_js_1.BaseClient}}),Object.defineProperty(exports,"BaseResponse",{enumerable:!0,get:function(){return base_js_1.BaseResponse}});var globals_js_1=require("./globals.js"),geotiffwriter_js_1=require("./geotiffwriter.js"),globals=__importStar(require("./globals.js"));exports.globals=globals;var rgb=__importStar(require("./rgb.js"));exports.rgb=rgb;var index_js_1=require("./compression/index.js");Object.defineProperty(exports,"getDecoder",{enumerable:!0,get:function(){return index_js_1.getDecoder}}),Object.defineProperty(exports,"addDecoder",{enumerable:!0,get:function(){return index_js_1.addDecoder}});var logging_js_1=require("./logging.js");Object.defineProperty(exports,"setLogger",{enumerable:!0,get:function(){return logging_js_1.setLogger}});var basedecoder_js_1=require("./compression/basedecoder.js");function getFieldTypeLength(e){switch(e){case globals_js_1.fieldTypes.BYTE:case globals_js_1.fieldTypes.ASCII:case globals_js_1.fieldTypes.SBYTE:case globals_js_1.fieldTypes.UNDEFINED:return 1;case globals_js_1.fieldTypes.SHORT:case globals_js_1.fieldTypes.SSHORT:return 2;case globals_js_1.fieldTypes.LONG:case globals_js_1.fieldTypes.SLONG:case globals_js_1.fieldTypes.FLOAT:case globals_js_1.fieldTypes.IFD:return 4;case globals_js_1.fieldTypes.RATIONAL:case globals_js_1.fieldTypes.SRATIONAL:case globals_js_1.fieldTypes.DOUBLE:case globals_js_1.fieldTypes.LONG8:case globals_js_1.fieldTypes.SLONG8:case globals_js_1.fieldTypes.IFD8:return 8;default:throw new RangeError("Invalid field type: ".concat(e))}}function parseGeoKeyDirectory(e){var r=e.GeoKeyDirectory;if(!r)return null;for(var t={},n=4;n<=4*r[3];n+=4){var o=globals_js_1.geoKeyNames[r[n]],a=r[n+1]?globals_js_1.fieldTagNames[r[n+1]]:null,i=r[n+2],s=r[n+3],u=null;if(a){if(null==(u=e[a]))throw new Error("Could not get value of geoKey '".concat(o,"'."));"string"==typeof u?u=u.substring(s,s+i-1):u.subarray&&(u=u.subarray(s,s+i),1===i&&(u=u[0]))}else u=s;t[o]=u}return t}function getValues(e,r,t,n){var o=null,a=null,i=getFieldTypeLength(r);switch(r){case globals_js_1.fieldTypes.BYTE:case globals_js_1.fieldTypes.ASCII:case globals_js_1.fieldTypes.UNDEFINED:o=new Uint8Array(t),a=e.readUint8;break;case globals_js_1.fieldTypes.SBYTE:o=new Int8Array(t),a=e.readInt8;break;case globals_js_1.fieldTypes.SHORT:o=new Uint16Array(t),a=e.readUint16;break;case globals_js_1.fieldTypes.SSHORT:o=new Int16Array(t),a=e.readInt16;break;case globals_js_1.fieldTypes.LONG:case globals_js_1.fieldTypes.IFD:o=new Uint32Array(t),a=e.readUint32;break;case globals_js_1.fieldTypes.SLONG:o=new Int32Array(t),a=e.readInt32;break;case globals_js_1.fieldTypes.LONG8:case globals_js_1.fieldTypes.IFD8:o=new Array(t),a=e.readUint64;break;case globals_js_1.fieldTypes.SLONG8:o=new Array(t),a=e.readInt64;break;case globals_js_1.fieldTypes.RATIONAL:o=new Uint32Array(2*t),a=e.readUint32;break;case globals_js_1.fieldTypes.SRATIONAL:o=new Int32Array(2*t),a=e.readInt32;break;case globals_js_1.fieldTypes.FLOAT:o=new Float32Array(t),a=e.readFloat32;break;case globals_js_1.fieldTypes.DOUBLE:o=new Float64Array(t),a=e.readFloat64;break;default:throw new RangeError("Invalid field type: ".concat(r))}if(r!==globals_js_1.fieldTypes.RATIONAL&&r!==globals_js_1.fieldTypes.SRATIONAL)for(var s=0;s<t;++s)o[s]=a.call(e,n+s*i);else for(var u=0;u<t;u+=2)o[u]=a.call(e,n+u*i),o[u+1]=a.call(e,n+(u*i+4));return r===globals_js_1.fieldTypes.ASCII?new TextDecoder("utf-8").decode(o):o}Object.defineProperty(exports,"BaseDecoder",{enumerable:!0,get:function(){return __importDefault(basedecoder_js_1).default}});var ImageFileDirectory=_createClass(function e(r,t,n){_classCallCheck(this,e),this.fileDirectory=r,this.geoKeyDirectory=t,this.nextIFDByteOffset=n}),GeoTIFFImageIndexError=function(e){function r(e){var t;return _classCallCheck(this,r),(t=_callSuper(this,r,["No image at index ".concat(e)])).index=e,t}return _inherits(r,_wrapNativeSuper(Error)),_createClass(r)}(),GeoTIFFBase=function(){return _createClass(function e(){_classCallCheck(this,e)},[{key:"readRasters",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r,t,n,o,a,i,s,u,c,l,f,p,y,h,_,g,d,b,m,v,w,x,T,j,F,k,I,O,R,S,A,G,P,D,C,E,L,B,N,U=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=U.length>0&&void 0!==U[0]?U[0]:{},t=r.window,n=r.width,o=r.height,a=r.resX,i=r.resY,s=r.bbox,e.next=5,this.getImage();case 5:return u=e.sent,c=u,e.next=9,this.getImageCount();case 9:if(l=e.sent,f=u.getBoundingBox(),!t||!s){e.next=13;break}throw new Error('Both "bbox" and "window" passed.');case 13:if(!n&&!o){e.next=24;break}if(t&&(p=u.getOrigin(),y=_slicedToArray(p,2),h=y[0],_=y[1],g=u.getResolution(),d=_slicedToArray(g,2),b=d[0],m=d[1],s=[h+t[0]*b,_+t[1]*m,h+t[2]*b,_+t[3]*m]),v=s||f,!n){e.next=20;break}if(!a){e.next=19;break}throw new Error("Both width and resX passed");case 19:a=(v[2]-v[0])/n;case 20:if(!o){e.next=24;break}if(!i){e.next=23;break}throw new Error("Both width and resY passed");case 23:i=(v[3]-v[1])/o;case 24:if(!a&&!i){e.next=48;break}w=[],x=0;case 27:if(!(x<l)){e.next=36;break}return e.next=30,this.getImage(x);case 30:T=e.sent,j=T.fileDirectory,F=j.SubfileType,k=j.NewSubfileType,(0===x||2===F||1&k)&&w.push(T);case 33:++x,e.next=27;break;case 36:w.sort(function(e,r){return e.getWidth()-r.getWidth()}),I=0;case 38:if(!(I<w.length)){e.next=48;break}if(O=w[I],R=(f[2]-f[0])/O.getWidth(),S=(f[3]-f[1])/O.getHeight(),c=O,!(a&&a>R||i&&i>S)){e.next=45;break}return e.abrupt("break",48);case 45:++I,e.next=38;break;case 48:return A=t,s&&(G=u.getOrigin(),P=_slicedToArray(G,2),D=P[0],C=P[1],E=c.getResolution(u),L=_slicedToArray(E,2),B=L[0],N=L[1],A=[Math.round((s[0]-D)/B),Math.round((s[1]-C)/N),Math.round((s[2]-D)/B),Math.round((s[3]-C)/N)],A=[Math.min(A[0],A[2]),Math.min(A[1],A[3]),Math.max(A[0],A[2]),Math.max(A[1],A[3])]),e.abrupt("return",c.readRasters(_objectSpread(_objectSpread({},r),{},{window:A})));case 51:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}(),GeoTIFF=function(e){function r(e,t,n,o){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return _classCallCheck(this,r),(a=_callSuper(this,r)).source=e,a.littleEndian=t,a.bigTiff=n,a.firstIFDOffset=o,a.cache=i.cache||!1,a.ifdRequests=[],a.ghostValues=null,a}return _inherits(r,GeoTIFFBase),_createClass(r,[{key:"getSlice",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(r,t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.bigTiff?4048:1024,e.t0=dataslice_js_1.default,e.next=4,this.source.fetch([{offset:r,length:void 0!==t?t:n}]);case 4:return e.t1=e.sent[0],e.t2=r,e.t3=this.littleEndian,e.t4=this.bigTiff,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 9:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"parseFileDirectoryAt",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){var t,n,o,a,i,s,u,c,l,f,p,y,h,_,g,d,b,m,v,w;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.bigTiff?20:12,n=this.bigTiff?8:2,e.next=4,this.getSlice(r);case 4:if(o=e.sent,a=this.bigTiff?o.readUint64(r):o.readUint16(r),i=a*t+(this.bigTiff?16:6),o.covers(r,i)){e.next=11;break}return e.next=10,this.getSlice(r,i);case 10:o=e.sent;case 11:s={},u=r+(this.bigTiff?8:2),c=0;case 14:if(!(c<a)){e.next=41;break}if(l=o.readUint16(u),f=o.readUint16(u+2),p=this.bigTiff?o.readUint64(u+4):o.readUint32(u+4),y=void 0,h=void 0,_=getFieldTypeLength(f),g=u+(this.bigTiff?12:8),!(_*p<=(this.bigTiff?8:4))){e.next=26;break}y=getValues(o,f,p,g),e.next=36;break;case 26:if(d=o.readOffset(g),b=getFieldTypeLength(f)*p,!o.covers(d,b)){e.next=32;break}y=getValues(o,f,p,d),e.next=36;break;case 32:return e.next=34,this.getSlice(d,b);case 34:m=e.sent,y=getValues(m,f,p,d);case 36:h=1===p&&-1===globals_js_1.arrayFields.indexOf(l)&&f!==globals_js_1.fieldTypes.RATIONAL&&f!==globals_js_1.fieldTypes.SRATIONAL?y[0]:y,s[globals_js_1.fieldTagNames[l]]=h;case 38:u+=t,++c,e.next=14;break;case 41:return v=parseGeoKeyDirectory(s),w=o.readOffset(r+n+t*a),e.abrupt("return",new ImageFileDirectory(s,v,w));case 44:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"requestIFD",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){var t=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ifdRequests[r]){e.next=4;break}return e.abrupt("return",this.ifdRequests[r]);case 4:if(0!==r){e.next=9;break}return this.ifdRequests[r]=this.parseFileDirectoryAt(this.firstIFDOffset),e.abrupt("return",this.ifdRequests[r]);case 9:if(this.ifdRequests[r-1]){e.next=19;break}e.prev=10,this.ifdRequests[r-1]=this.requestIFD(r-1),e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(10),!(e.t0 instanceof GeoTIFFImageIndexError)){e.next=18;break}throw new GeoTIFFImageIndexError(r);case 18:throw e.t0;case 19:return this.ifdRequests[r]=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ifdRequests[r-1];case 2:if(0!==(n=e.sent).nextIFDByteOffset){e.next=5;break}throw new GeoTIFFImageIndexError(r);case 5:return e.abrupt("return",t.parseFileDirectoryAt(n.nextIFDByteOffset));case 6:case"end":return e.stop()}},e)}))(),e.abrupt("return",this.ifdRequests[r]);case 21:case"end":return e.stop()}},e,this,[[10,14]])}));return function(r){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r,t,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>0&&void 0!==n[0]?n[0]:0,e.next=3,this.requestIFD(r);case 3:return t=e.sent,e.abrupt("return",new geotiffimage_js_1.default(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getImageCount",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r,t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=0,t=!0;case 2:if(!t){e.next=18;break}return e.prev=3,e.next=6,this.requestIFD(r);case 6:++r,e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof GeoTIFFImageIndexError)){e.next=15;break}t=!1,e.next=16;break;case 15:throw e.t0;case 16:e.next=2;break;case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"getGhostValues",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r,t,n,o,a,i,s,u,c=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.bigTiff?16:8,!this.ghostValues){e.next=3;break}return e.abrupt("return",this.ghostValues);case 3:return n=(t="GDAL_STRUCTURAL_METADATA_SIZE=").length+100,e.next=7,this.getSlice(r,n);case 7:if(o=e.sent,t!==getValues(o,globals_js_1.fieldTypes.ASCII,t.length,r)){e.next=19;break}if(a=getValues(o,globals_js_1.fieldTypes.ASCII,n,r),i=a.split("\n")[0],!((s=Number(i.split("=")[1].split(" ")[0])+i.length)>n)){e.next=16;break}return e.next=15,this.getSlice(r,s);case 15:o=e.sent;case 16:u=getValues(o,globals_js_1.fieldTypes.ASCII,s,r),this.ghostValues={},u.split("\n").filter(function(e){return e.length>0}).map(function(e){return e.split("=")}).forEach(function(e){var r=_slicedToArray(e,2),t=r[0],n=r[1];c.ghostValues[t]=n});case 19:return e.abrupt("return",this.ghostValues);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){return"function"==typeof this.source.close&&this.source.close()}}],[{key:"fromSource",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,o){var a,i,s,u,c,l,f;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetch([{offset:0,length:1024}],o);case 2:if(a=e.sent[0],i=new dataview64_js_1.default(a),18761!==(s=i.getUint16(0,0))){e.next=9;break}u=!0,e.next=14;break;case 9:if(19789!==s){e.next=13;break}u=!1,e.next=14;break;case 13:throw new TypeError("Invalid byte order value.");case 14:if(42!==(c=i.getUint16(2,u))){e.next=19;break}l=!1,e.next=27;break;case 19:if(43!==c){e.next=26;break}if(l=!0,8===i.getUint16(4,u)){e.next=24;break}throw new Error("Unsupported offset byte-size.");case 24:e.next=27;break;case 26:throw new TypeError("Invalid magic number.");case 27:return f=l?i.getUint64(8,u):i.getUint32(4,u),e.abrupt("return",new r(t,u,l,f,n));case 29:case"end":return e.stop()}},e)}));return function(r,t,n){return e.apply(this,arguments)}}()}])}();exports.GeoTIFF=GeoTIFF,exports.default=GeoTIFF;var MultiGeoTIFF=function(e){function r(e,t){var n;return _classCallCheck(this,r),(n=_callSuper(this,r)).mainFile=e,n.overviewFiles=t,n.imageFiles=[e].concat(t),n.fileDirectoriesPerFile=null,n.fileDirectoriesPerFileParsing=null,n.imageCount=null,n}return _inherits(r,GeoTIFFBase),_createClass(r,[{key:"parseFileDirectoriesPerFile",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(function(e){return e.parseFileDirectoryAt(e.firstIFDOffset)})),e.next=3,Promise.all(r);case 3:return this.fileDirectoriesPerFile=e.sent,e.abrupt("return",this.fileDirectoriesPerFile);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r,t,n,o,a,i,s,u=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:0,e.next=3,this.getImageCount();case 3:return e.next=5,this.parseFileDirectoriesPerFile();case 5:t=0,n=0,o=0;case 8:if(!(o<this.imageFiles.length)){e.next=26;break}a=this.imageFiles[o],i=0;case 11:if(!(i<this.imageCounts[o])){e.next=22;break}if(r!==t){e.next=17;break}return e.next=15,a.requestIFD(n);case 15:return s=e.sent,e.abrupt("return",new geotiffimage_js_1.default(s.fileDirectory,s.geoKeyDirectory,a.dataView,a.littleEndian,a.cache,a.source));case 17:t++,n++;case 19:i++,e.next=11;break;case 22:n=0;case 23:o++,e.next=8;break;case 26:throw new RangeError("Invalid image index");case 27:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getImageCount",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.imageCount){e.next=2;break}return e.abrupt("return",this.imageCount);case 2:return r=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(function(e){return e.getImageCount()})),e.next=5,Promise.all(r);case 5:return this.imageCounts=e.sent,this.imageCount=this.imageCounts.reduce(function(e,r){return e+r},0),e.abrupt("return",this.imageCount);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}();function fromUrl(e){return _fromUrl.apply(this,arguments)}function _fromUrl(){return(_fromUrl=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){var t,n,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2?o[2]:void 0,e.abrupt("return",GeoTIFF.fromSource((0,remote_js_1.makeRemoteSource)(r,t),n));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fromCustomClient(e){return _fromCustomClient.apply(this,arguments)}function _fromCustomClient(){return(_fromCustomClient=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){var t,n,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2?o[2]:void 0,e.abrupt("return",GeoTIFF.fromSource((0,remote_js_1.makeCustomSource)(r,t),n));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fromArrayBuffer(e,r){return _fromArrayBuffer.apply(this,arguments)}function _fromArrayBuffer(){return(_fromArrayBuffer=_asyncToGenerator(_regeneratorRuntime().mark(function e(r,t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",GeoTIFF.fromSource((0,arraybuffer_js_1.makeBufferSource)(r),t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fromFile(e,r){return _fromFile.apply(this,arguments)}function _fromFile(){return(_fromFile=_asyncToGenerator(_regeneratorRuntime().mark(function e(r,t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",GeoTIFF.fromSource((0,file_js_1.makeFileSource)(r),t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fromBlob(e,r){return _fromBlob.apply(this,arguments)}function _fromBlob(){return(_fromBlob=_asyncToGenerator(_regeneratorRuntime().mark(function e(r,t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",GeoTIFF.fromSource((0,filereader_js_1.makeFileReaderSource)(r),t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fromUrls(e){return _fromUrls.apply(this,arguments)}function _fromUrls(){return(_fromUrls=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){var t,n,o,a,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>1&&void 0!==s[1]?s[1]:[],n=s.length>2&&void 0!==s[2]?s[2]:{},o=s.length>3?s[3]:void 0,e.next=5,GeoTIFF.fromSource((0,remote_js_1.makeRemoteSource)(r,n),o);case 5:return a=e.sent,e.next=8,Promise.all(t.map(function(e){return GeoTIFF.fromSource((0,remote_js_1.makeRemoteSource)(e,n))}));case 8:return i=e.sent,e.abrupt("return",new MultiGeoTIFF(a,i));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function writeArrayBuffer(e,r){return(0,geotiffwriter_js_1.writeGeotiff)(e,r)}exports.MultiGeoTIFF=MultiGeoTIFF,exports.fromUrl=fromUrl,exports.fromCustomClient=fromCustomClient,exports.fromArrayBuffer=fromArrayBuffer,exports.fromFile=fromFile,exports.fromBlob=fromBlob,exports.fromUrls=fromUrls,exports.writeArrayBuffer=writeArrayBuffer;

},{"./compression/basedecoder.js":21,"./compression/index.js":23,"./dataslice.js":30,"./dataview64.js":31,"./geotiffimage.js":33,"./geotiffwriter.js":34,"./globals.js":35,"./logging.js":36,"./pool.js":37,"./rgb.js":40,"./source/arraybuffer.js":41,"./source/client/base.js":44,"./source/file.js":48,"./source/filereader.js":49,"./source/remote.js":51}],33:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=a.call(r)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){u=!0,n=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw n}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var a=e&&e.prototype instanceof d?e:d,o=Object.create(a.prototype),s=new P(i||[]);return n(o,"_invoke",{value:S(t,r,s)}),o}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f="suspendedStart",p="suspendedYield",y="executing",g="completed",m={};function d(){}function v(){}function _(){}var b={};u(b,o,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(I([])));x&&x!==r&&i.call(x,o)&&(b=x);var k=_.prototype=d.prototype=Object.create(b);function T(t){["next","throw","return"].forEach(function(e){u(t,e,function(t){return this._invoke(e,t)})})}function D(t,e){function r(n,a,o,s){var l=h(t[n],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==_typeof(c)&&i.call(c,"__await")?e.resolve(c.__await).then(function(t){r("next",t,o,s)},function(t){r("throw",t,o,s)}):e.resolve(c).then(function(t){u.value=t,o(u)},function(t){return r("throw",t,o,s)})}s(l.arg)}var a;n(this,"_invoke",{value:function(t,i){function n(){return new e(function(e,n){r(t,i,e,n)})}return a=a?a.then(n,n):n()}})}function S(e,r,i){var n=f;return function(a,o){if(n===y)throw Error("Generator is already running");if(n===g){if("throw"===a)throw o;return{value:t,done:!0}}for(i.method=a,i.arg=o;;){var s=i.delegate;if(s){var l=A(s,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=y;var u=h(e,r,i);if("normal"===u.type){if(n=i.done?g:p,u.arg===m)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(n=g,i.method="throw",i.arg=u.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var o=a.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_typeof(e)+" is not iterable")}return v.prototype=_,n(k,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:v,configurable:!0}),v.displayName=u(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},T(D.prototype),u(D.prototype,s,function(){return this}),e.AsyncIterator=D,e.async=function(t,r,i,n,a){void 0===a&&(a=Promise);var o=new D(c(t,r,i,n),a);return e.isGeneratorFunction(r)?o:o.next().then(function(t){return t.done?t.value:o.next()})},T(k),u(k,l,"Generator"),u(k,o,function(){return this}),u(k,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=I,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),M(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;M(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:I(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function asyncGeneratorStep(t,e,r,i,n,a,o){try{var s=t[a](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(i,n)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(i,n){var a=t.apply(e,r);function o(t){asyncGeneratorStep(a,i,n,o,s,"next",t)}function s(t){asyncGeneratorStep(a,i,n,o,s,"throw",t)}o(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var __importDefault=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var float16_1=require("@petamoriken/float16"),get_attribute_js_1=__importDefault(require("xml-utils/get-attribute.js")),find_tags_by_name_js_1=__importDefault(require("xml-utils/find-tags-by-name.js")),globals_js_1=require("./globals.js"),rgb_js_1=require("./rgb.js"),index_js_1=require("./compression/index.js"),resample_js_1=require("./resample.js");function sum(t,e,r){for(var i=0,n=e;n<r;++n)i+=t[n];return i}function arrayForType(t,e,r){switch(t){case 1:if(e<=8)return new Uint8Array(r);if(e<=16)return new Uint16Array(r);if(e<=32)return new Uint32Array(r);break;case 2:if(8===e)return new Int8Array(r);if(16===e)return new Int16Array(r);if(32===e)return new Int32Array(r);break;case 3:switch(e){case 16:case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}function needsNormalization(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!=0)&&(3!==t||16!==e&&32!==e&&64!==e)}function normalizeArray(t,e,r,i,n,a,o){var s=new DataView(t),l=2===r?1:i,u=arrayForType(e,n,2===r?o*a:o*a*i),c=parseInt("1".repeat(n),2);if(1===e){var h=a*(1===r?i*n:n);0!=(7&h)&&(h=h+7&-8);for(var f=0;f<o;++f)for(var p=f*h,y=0;y<a;++y)for(var g=p+y*l*n,m=0;m<l;++m){var d=g+m*n,v=(f*a+y)*l+m,_=Math.floor(d/8),b=d%8;if(b+n<=8)u[v]=s.getUint8(_)>>8-n-b&c;else if(b+n<=16)u[v]=s.getUint16(_)>>16-n-b&c;else if(b+n<=24){var w=s.getUint16(_)<<8|s.getUint8(_+2);u[v]=w>>24-n-b&c}else u[v]=s.getUint32(_)>>32-n-b&c}}return u.buffer}var GeoTIFFImage=function(){return _createClass(function t(e,r,i,n,a,o){_classCallCheck(this,t),this.fileDirectory=e,this.geoKeys=r,this.dataView=i,this.littleEndian=n,this.tiles=a?{}:null,this.isTiled=!e.StripOffsets;var s=e.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o},[{key:"getFileDirectory",value:function(){return this.fileDirectory}},{key:"getGeoKeys",value:function(){return this.geoKeys}},{key:"getWidth",value:function(){return this.fileDirectory.ImageWidth}},{key:"getHeight",value:function(){return this.fileDirectory.ImageLength}},{key:"getSamplesPerPixel",value:function(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}},{key:"getTileWidth",value:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}},{key:"getTileHeight",value:function(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}},{key:"getBlockWidth",value:function(){return this.getTileWidth()}},{key:"getBlockHeight",value:function(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}},{key:"getBytesPerPixel",value:function(){for(var t=0,e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}},{key:"getSampleByteSize",value:function(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index ".concat(t," is out of range."));return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}},{key:"getReaderForSample",value:function(t){var e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,r=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(r<=8)return DataView.prototype.getUint8;if(r<=16)return DataView.prototype.getUint16;if(r<=32)return DataView.prototype.getUint32;break;case 2:if(r<=8)return DataView.prototype.getInt8;if(r<=16)return DataView.prototype.getInt16;if(r<=32)return DataView.prototype.getInt32;break;case 3:switch(r){case 16:return function(t,e){return(0,float16_1.getFloat16)(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}},{key:"getSampleFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}},{key:"getBitsPerSample",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.BitsPerSample[t]}},{key:"getArrayForSample",value:function(t,e){return arrayForType(this.getSampleFormat(t),this.getBitsPerSample(t),e)}},{key:"getTileOrStrip",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,i,n,a){var o,s,l,u,c,h,f,p,y=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight()),u=this.tiles,1===this.planarConfiguration?l=r*o+e:2===this.planarConfiguration&&(l=i*o*s+r*o+e),this.isTiled?(c=this.fileDirectory.TileOffsets[l],h=this.fileDirectory.TileByteCounts[l]):(c=this.fileDirectory.StripOffsets[l],h=this.fileDirectory.StripByteCounts[l]),t.next=7,this.source.fetch([{offset:c,length:h}],a);case 7:return f=t.sent[0],null!==u&&u[l]?p=u[l]:(p=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,i,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.decode(y.fileDirectory,f);case 2:return e=t.sent,i=y.getSampleFormat(),a=y.getBitsPerSample(),needsNormalization(i,a)&&(e=normalizeArray(e,i,y.planarConfiguration,y.getSamplesPerPixel(),a,y.getTileWidth(),y.getBlockHeight(r))),t.abrupt("return",e);case 7:case"end":return t.stop()}},t)}))(),null!==u&&(u[l]=p)),t.t0=e,t.t1=r,t.t2=i,t.next=14,p;case 14:return t.t3=t.sent,t.abrupt("return",{x:t.t0,y:t.t1,sample:t.t2,data:t.t3});case 16:case"end":return t.stop()}},t,this)}));return function(e,r,i,n,a){return t.apply(this,arguments)}}()},{key:"_readRaster",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r,i,n,a,o,s,l,u){var c,h,f,p,y,g,m,d,v,_,b,w,x,k,T,D,S,A,j,M,P,I=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(c=this.getTileWidth(),h=this.getTileHeight(),f=this.getWidth(),p=this.getHeight(),y=Math.max(Math.floor(e[0]/c),0),g=Math.min(Math.ceil(e[2]/c),Math.ceil(f/c)),m=Math.max(Math.floor(e[1]/h),0),d=Math.min(Math.ceil(e[3]/h),Math.ceil(p/h)),v=e[2]-e[0],_=this.getBytesPerPixel(),b=[],w=[],x=0;x<r.length;++x)1===this.planarConfiguration?b.push(sum(this.fileDirectory.BitsPerSample,0,r[x])/8):b.push(0),w.push(this.getReaderForSample(r[x]));k=[],T=this.littleEndian,D=m;case 16:if(!(D<d)){t.next=34;break}S=y;case 18:if(!(S<g)){t.next=31;break}A=void 0,1===this.planarConfiguration&&(A=this.getTileOrStrip(S,D,0,a,u)),j=_regeneratorRuntime().mark(function t(){var o,s,l;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=M,s=r[M],2===I.planarConfiguration&&(_=I.getSampleByteSize(s),A=I.getTileOrStrip(S,D,s,a,u)),l=A.then(function(t){for(var a=t.data,s=new DataView(a),l=I.getBlockHeight(t.y),u=t.y*h,y=t.x*c,g=u+l,m=(t.x+1)*c,d=w[o],x=Math.min(l,l-(g-e[3]),p-u),k=Math.min(c,c-(m-e[2]),f-y),D=Math.max(0,e[1]-u);D<x;++D)for(var S=Math.max(0,e[0]-y);S<k;++S){var A=(D*c+S)*_,j=d.call(s,A+b[o],T),M=void 0;n?(M=(D+u-e[1])*v*r.length+(S+y-e[0])*r.length+o,i[M]=j):(M=(D+u-e[1])*v+S+y-e[0],i[o][M]=j)}}),k.push(l);case 5:case"end":return t.stop()}},t)}),M=0;case 23:if(!(M<r.length)){t.next=28;break}return t.delegateYield(j(),"t0",25);case 25:++M,t.next=23;break;case 28:++S,t.next=18;break;case 31:++D,t.next=16;break;case 34:return t.next=36,Promise.all(k);case 36:if(!(o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s)){t.next=41;break}return(P=n?(0,resample_js_1.resampleInterleaved)(i,e[2]-e[0],e[3]-e[1],o,s,r.length,l):(0,resample_js_1.resample)(i,e[2]-e[0],e[3]-e[1],o,s,l)).width=o,P.height=s,t.abrupt("return",P);case 41:return i.width=o||e[2]-e[0],i.height=s||e[3]-e[1],t.abrupt("return",i);case 44:case"end":return t.stop()}},t,this)}));return function(e,r,i,n,a,o,s,l,u){return t.apply(this,arguments)}}()},{key:"readRasters",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,i,n,a,o,s,l,u,c,h,f,p,y,g,m,d,v,_,b,w,x,k,T,D,S,A=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=A.length>0&&void 0!==A[0]?A[0]:{},r=e.window,i=e.samples,n=void 0===i?[]:i,a=e.interleave,o=e.pool,s=void 0===o?null:o,l=e.width,u=e.height,c=e.resampleMethod,h=e.fillValue,f=e.signal,!((p=r||[0,0,this.getWidth(),this.getHeight()])[0]>p[2]||p[1]>p[3])){t.next=4;break}throw new Error("Invalid subsets");case 4:if(y=p[2]-p[0],g=p[3]-p[1],m=y*g,d=this.getSamplesPerPixel(),n&&n.length){t.next=12;break}for(v=0;v<d;++v)n.push(v);t.next=19;break;case 12:_=0;case 13:if(!(_<n.length)){t.next=19;break}if(!(n[_]>=d)){t.next=16;break}return t.abrupt("return",Promise.reject(new RangeError("Invalid sample index '".concat(n[_],"'."))));case 16:++_,t.next=13;break;case 19:if(a)w=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,x=Math.max.apply(null,this.fileDirectory.BitsPerSample),b=arrayForType(w,x,m*n.length),h&&b.fill(h);else for(b=[],k=0;k<n.length;++k)T=this.getArrayForSample(n[k],m),Array.isArray(h)&&k<h.length?T.fill(h[k]):h&&!Array.isArray(h)&&T.fill(h),b.push(T);if(t.t0=s,t.t0){t.next=25;break}return t.next=24,(0,index_js_1.getDecoder)(this.fileDirectory);case 24:t.t0=t.sent;case 25:return D=t.t0,t.next=28,this._readRaster(p,n,b,a,D,l,u,c,f);case 28:return S=t.sent,t.abrupt("return",S);case 30:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"readRGB",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,i,n,a,o,s,l,u,c,h,f,p,y,g,m,d,v,_,b,w,x,k,T,D,S,A,j=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=j.length>0&&void 0!==j[0]?j[0]:{},r=e.window,i=e.interleave,n=void 0===i||i,a=e.pool,o=void 0===a?null:a,s=e.width,l=e.height,u=e.resampleMethod,c=e.enableAlpha,h=void 0!==c&&c,f=e.signal,!((p=r||[0,0,this.getWidth(),this.getHeight()])[0]>p[2]||p[1]>p[3])){t.next=4;break}throw new Error("Invalid subsets");case 4:if((y=this.fileDirectory.PhotometricInterpretation)!==globals_js_1.photometricInterpretations.RGB){t.next=9;break}if(g=[0,1,2],this.fileDirectory.ExtraSamples!==globals_js_1.ExtraSamplesValues.Unspecified&&h)for(g=[],m=0;m<this.fileDirectory.BitsPerSample.length;m+=1)g.push(m);return t.abrupt("return",this.readRasters({window:r,interleave:n,samples:g,pool:o,width:s,height:l,resampleMethod:u,signal:f}));case 9:t.t0=y,t.next=t.t0===globals_js_1.photometricInterpretations.WhiteIsZero?12:t.t0===globals_js_1.photometricInterpretations.BlackIsZero?12:t.t0===globals_js_1.photometricInterpretations.Palette?12:t.t0===globals_js_1.photometricInterpretations.CMYK?14:t.t0===globals_js_1.photometricInterpretations.YCbCr?16:t.t0===globals_js_1.photometricInterpretations.CIELab?16:18;break;case 12:return d=[0],t.abrupt("break",19);case 14:return d=[0,1,2,3],t.abrupt("break",19);case 16:return d=[0,1,2],t.abrupt("break",19);case 18:throw new Error("Invalid or unsupported photometric interpretation.");case 19:return v={window:p,interleave:!0,samples:d,pool:o,width:s,height:l,resampleMethod:u,signal:f},_=this.fileDirectory,t.next=23,this.readRasters(v);case 23:b=t.sent,w=Math.pow(2,this.fileDirectory.BitsPerSample[0]),t.t1=y,t.next=t.t1===globals_js_1.photometricInterpretations.WhiteIsZero?28:t.t1===globals_js_1.photometricInterpretations.BlackIsZero?30:t.t1===globals_js_1.photometricInterpretations.Palette?32:t.t1===globals_js_1.photometricInterpretations.CMYK?34:t.t1===globals_js_1.photometricInterpretations.YCbCr?36:t.t1===globals_js_1.photometricInterpretations.CIELab?38:40;break;case 28:return x=(0,rgb_js_1.fromWhiteIsZero)(b,w),t.abrupt("break",41);case 30:return x=(0,rgb_js_1.fromBlackIsZero)(b,w),t.abrupt("break",41);case 32:return x=(0,rgb_js_1.fromPalette)(b,_.ColorMap),t.abrupt("break",41);case 34:return x=(0,rgb_js_1.fromCMYK)(b),t.abrupt("break",41);case 36:return x=(0,rgb_js_1.fromYCbCr)(b),t.abrupt("break",41);case 38:return x=(0,rgb_js_1.fromCIELab)(b),t.abrupt("break",41);case 40:throw new Error("Unsupported photometric interpretation.");case 41:if(!n){for(k=new Uint8Array(x.length/3),T=new Uint8Array(x.length/3),D=new Uint8Array(x.length/3),S=0,A=0;S<x.length;S+=3,++A)k[A]=x[S],T[A]=x[S+1],D[A]=x[S+2];x=[k,T,D]}return x.width=b.width,x.height=b.height,t.abrupt("return",x);case 45:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getTiePoints",value:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var t=[],e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}},{key:"getGDALMetadata",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={};if(!this.fileDirectory.GDAL_METADATA)return null;var r=this.fileDirectory.GDAL_METADATA,i=(0,find_tags_by_name_js_1.default)(r,"Item");i=null===t?i.filter(function(t){return void 0===(0,get_attribute_js_1.default)(t,"sample")}):i.filter(function(e){return Number((0,get_attribute_js_1.default)(e,"sample"))===t});for(var n=0;n<i.length;++n){var a=i[n];e[(0,get_attribute_js_1.default)(a,"name")]=a.inner}return e}},{key:"getGDALNoData",value:function(){if(!this.fileDirectory.GDAL_NODATA)return null;var t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}},{key:"getOrigin",value:function(){var t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}},{key:"getResolution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(r)return[r[0],-r[5],r[10]];if(t){var i=_slicedToArray(t.getResolution(),3),n=i[0],a=i[1],o=i[2];return[n*t.getWidth()/this.getWidth(),a*t.getHeight()/this.getHeight(),o*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}},{key:"pixelIsArea",value:function(){return 1===this.geoKeys.GTRasterTypeGeoKey}},{key:"getBoundingBox",value:function(){var t=this.getHeight(),e=this.getWidth();if(this.fileDirectory.ModelTransformation){var r=_slicedToArray(this.fileDirectory.ModelTransformation,8),i=r[0],n=r[1],a=(r[2],r[3]),o=r[4],s=r[5],l=(r[6],r[7]),u=[[0,0],[0,t],[e,0],[e,t]].map(function(t){var e=_slicedToArray(t,2),r=e[0],u=e[1];return[a+i*r+n*u,l+o*r+s*u]}),c=u.map(function(t){return t[0]}),h=u.map(function(t){return t[1]});return[Math.min.apply(Math,_toConsumableArray(c)),Math.min.apply(Math,_toConsumableArray(h)),Math.max.apply(Math,_toConsumableArray(c)),Math.max.apply(Math,_toConsumableArray(h))]}var f=this.getOrigin(),p=this.getResolution(),y=f[0],g=f[1],m=y+p[0]*this.getWidth(),d=g+p[1]*this.getHeight();return[Math.min(y,m),Math.min(g,d),Math.max(y,m),Math.max(g,d)]}}])}();exports.default=GeoTIFFImage;

},{"./compression/index.js":23,"./globals.js":35,"./resample.js":39,"./rgb.js":40,"@petamoriken/float16":5,"xml-utils/find-tags-by-name.js":455,"xml-utils/get-attribute.js":456}],34:[function(require,module,exports){
"use strict";function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.writeGeotiff=void 0;var globals_js_1=require("./globals.js"),utils_js_1=require("./utils.js"),tagName2Code=(0,utils_js_1.invert)(globals_js_1.fieldTagNames),geoKeyName2Code=(0,utils_js_1.invert)(globals_js_1.geoKeyNames),name2code={};(0,utils_js_1.assign)(name2code,tagName2Code),(0,utils_js_1.assign)(name2code,geoKeyName2Code);var typeName2byte=(0,utils_js_1.invert)(globals_js_1.fieldTypeNames),numBytesInIfd=1e3,_binBE={nextZero:function(e,t){for(var r=t;0!==e[r];)r++;return r},readUshort:function(e,t){return e[t]<<8|e[t+1]},readShort:function(e,t){var r=_binBE.ui8;return r[0]=e[t+1],r[1]=e[t+0],_binBE.i16[0]},readInt:function(e,t){var r=_binBE.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],_binBE.i32[0]},readUint:function(e,t){var r=_binBE.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],_binBE.ui32[0]},readASCII:function(e,t,r){return r.map(function(r){return String.fromCharCode(e[t+r])}).join("")},readFloat:function(e,t){var r=_binBE.ui8;return(0,utils_js_1.times)(4,function(n){r[n]=e[t+3-n]}),_binBE.fl32[0]},readDouble:function(e,t){var r=_binBE.ui8;return(0,utils_js_1.times)(8,function(n){r[n]=e[t+7-n]}),_binBE.fl64[0]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:function(e,t,r){(0,utils_js_1.times)(r.length,function(n){e[t+n]=r.charCodeAt(n)})},ui8:new Uint8Array(8)};_binBE.fl64=new Float64Array(_binBE.ui8.buffer),_binBE.writeDouble=function(e,t,r){_binBE.fl64[0]=r,(0,utils_js_1.times)(8,function(r){e[t+r]=_binBE.ui8[7-r]})};var _writeIFD=function(e,t,r,n){var i=r,o=Object.keys(n).filter(function(e){return null!=e&&"undefined"!==e});e.writeUshort(t,i,o.length);var a,s=(i+=2)+12*o.length+4,u=_createForOfIteratorHelper(o);try{var l=function(){var r=a.value,o=null;"number"==typeof r?o=r:"string"==typeof r&&(o=parseInt(r,10));var u=globals_js_1.fieldTagTypes[o],l=typeName2byte[u];if(null==u||void 0===u||void 0===u)throw new Error("unknown type of tag: ".concat(o));var f=n[r];if(void 0===f)throw new Error("failed to get value for key ".concat(r));"ASCII"===u&&"string"==typeof f&&!1===(0,utils_js_1.endsWith)(f,"\0")&&(f+="\0");var c=f.length;e.writeUshort(t,i,o),i+=2,e.writeUshort(t,i,l),i+=2,e.writeUint(t,i,c);var y=[-1,1,1,2,4,8,0,0,0,0,0,0,8][l]*c,d=i+=4;y>4&&(e.writeUint(t,i,s),d=s),"ASCII"===u?e.writeASCII(t,d,f):"SHORT"===u?(0,utils_js_1.times)(c,function(r){e.writeUshort(t,d+2*r,f[r])}):"LONG"===u?(0,utils_js_1.times)(c,function(r){e.writeUint(t,d+4*r,f[r])}):"RATIONAL"===u?(0,utils_js_1.times)(c,function(r){e.writeUint(t,d+8*r,Math.round(1e4*f[r])),e.writeUint(t,d+8*r+4,1e4)}):"DOUBLE"===u&&(0,utils_js_1.times)(c,function(r){e.writeDouble(t,d+8*r,f[r])}),y>4&&(s+=y+=1&y),i+=4};for(u.s();!(a=u.n()).done;)l()}catch(e){u.e(e)}finally{u.f()}return[i,s]},encodeIfds=function(e){var t=new Uint8Array(numBytesInIfd),r=4,n=_binBE;t[0]=77,t[1]=77,t[3]=42;var i=8;if(n.writeUint(t,r,i),r+=4,e.forEach(function(r,o){var a=_writeIFD(n,t,i,r);i=a[1],o<e.length-1&&n.writeUint(t,a[0],i)}),t.slice)return t.slice(0,i).buffer;for(var o=new Uint8Array(i),a=0;a<i;a++)o[a]=t[a];return o.buffer},encodeImage=function(e,t,r,n){if(null==r)throw new Error("you passed into encodeImage a width of type ".concat(r));if(null==t)throw new Error("you passed into encodeImage a width of type ".concat(t));var i={256:[t],257:[r],273:[numBytesInIfd],278:[r],305:"geotiff.js"};if(n)for(var o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);var a=new Uint8Array(encodeIfds([i])),s=new Uint8Array(e),u=i[277],l=new Uint8Array(numBytesInIfd+t*r*u);return(0,utils_js_1.times)(a.length,function(e){l[e]=a[e]}),(0,utils_js_1.forEach)(s,function(e,t){l[numBytesInIfd+t]=e}),l.buffer},convertToTids=function(e){var t={};for(var r in e)"StripOffsets"!==r&&(name2code[r]||console.error(r,"not in name2code:",Object.keys(name2code)),t[name2code[r]]=e[r]);return t},toArray=function(e){return Array.isArray(e)?e:[e]},metadataDefaults=[["Compression",1],["PlanarConfiguration",1],["ExtraSamples",0]];function writeGeotiff(e,t){var r,n,i,o;"number"==typeof e[0]?(r=t.height||t.ImageLength,i=t.width||t.ImageWidth,n=e.length/(r*i),o=e):(n=e.length,r=e[0].length,i=e[0][0].length,o=[],(0,utils_js_1.times)(r,function(t){(0,utils_js_1.times)(i,function(r){(0,utils_js_1.times)(n,function(n){o.push(e[n][t][r])})})})),t.ImageLength=r,delete t.height,t.ImageWidth=i,delete t.width,t.BitsPerSample||(t.BitsPerSample=(0,utils_js_1.times)(n,function(){return 8})),metadataDefaults.forEach(function(e){var r=e[0];if(!t[r]){var n=e[1];t[r]=n}}),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[n]),t.StripByteCounts||(t.StripByteCounts=[n*r*i]),t.ModelPixelScale||(t.ModelPixelScale=[360/i,180/r,0]),t.SampleFormat||(t.SampleFormat=(0,utils_js_1.times)(n,function(){return 1})),t.hasOwnProperty("GeographicTypeGeoKey")||t.hasOwnProperty("ProjectedCSTypeGeoKey")||(t.GeographicTypeGeoKey=4326,t.ModelTiepoint=[0,0,0,-180,90,0],t.GeogCitationGeoKey="WGS 84",t.GTModelTypeGeoKey=2);var a=Object.keys(t).filter(function(e){return(0,utils_js_1.endsWith)(e,"GeoKey")}).sort(function(e,t){return name2code[e]-name2code[t]});if(!t.GeoAsciiParams){var s="";a.forEach(function(e){var r=Number(name2code[e]);"ASCII"===globals_js_1.fieldTagTypes[r]&&(s+="".concat(t[e].toString(),"\0"))}),s.length>0&&(t.GeoAsciiParams=s)}if(!t.GeoKeyDirectory){var u=[1,1,0,a.length];a.forEach(function(e){var r,n,i,o=Number(name2code[e]);u.push(o),"SHORT"===globals_js_1.fieldTagTypes[o]?(r=1,n=0,i=t[e]):"GeogCitationGeoKey"===e?(r=t.GeoAsciiParams.length,n=Number(name2code.GeoAsciiParams),i=0):console.log("[geotiff.js] couldn't get TIFFTagLocation for ".concat(e)),u.push(n),u.push(r),u.push(i)}),t.GeoKeyDirectory=u}var l,f=_createForOfIteratorHelper(a);try{for(f.s();!(l=f.n()).done;){var c=l.value;t.hasOwnProperty(c)&&delete t[c]}}catch(e){f.e(e)}finally{f.f()}["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","Orientation","PhotometricInterpretation","ProjectedCSTypeGeoKey","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition","RowsPerStrip"].forEach(function(e){t[e]&&(t[e]=toArray(t[e]))});var y=convertToTids(t);return encodeImage(o,i,r,y)}exports.writeGeotiff=writeGeotiff;

},{"./globals.js":35,"./utils.js":52}],35:[function(require,module,exports){
"use strict";for(var key in Object.defineProperty(exports,"__esModule",{value:!0}),exports.geoKeys=exports.geoKeyNames=exports.LercAddCompression=exports.LercParameters=exports.ExtraSamplesValues=exports.photometricInterpretations=exports.fieldTypes=exports.fieldTypeNames=exports.arrayFields=exports.fieldTagTypes=exports.fieldTags=exports.fieldTagNames=void 0,exports.fieldTagNames={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},exports.fieldTags={},exports.fieldTagNames)exports.fieldTagNames.hasOwnProperty(key)&&(exports.fieldTags[exports.fieldTagNames[key]]=parseInt(key,10));for(var _key in exports.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",297:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",3072:"SHORT",3073:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34264:"DOUBLE",34665:"LONG",34735:"SHORT",34736:"DOUBLE",34737:"ASCII",42113:"ASCII"},exports.arrayFields=[exports.fieldTags.BitsPerSample,exports.fieldTags.ExtraSamples,exports.fieldTags.SampleFormat,exports.fieldTags.StripByteCounts,exports.fieldTags.StripOffsets,exports.fieldTags.StripRowCounts,exports.fieldTags.TileByteCounts,exports.fieldTags.TileOffsets,exports.fieldTags.SubIFDs],exports.fieldTypeNames={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},exports.fieldTypes={},exports.fieldTypeNames)exports.fieldTypeNames.hasOwnProperty(_key)&&(exports.fieldTypes[exports.fieldTypeNames[_key]]=parseInt(_key,10));for(var _key2 in exports.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},exports.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2},exports.LercParameters={Version:0,AddCompression:1},exports.LercAddCompression={None:0,Deflate:1,Zstandard:2},exports.geoKeyNames={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},exports.geoKeys={},exports.geoKeyNames)exports.geoKeyNames.hasOwnProperty(_key2)&&(exports.geoKeys[exports.geoKeyNames[_key2]]=parseInt(_key2,10));

},{}],36:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.timeEnd=exports.time=exports.error=exports.warn=exports.info=exports.log=exports.debug=exports.setLogger=void 0;var DummyLogger=function(){return _createClass(function e(){_classCallCheck(this,e)},[{key:"log",value:function(){}},{key:"debug",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}},{key:"time",value:function(){}},{key:"timeEnd",value:function(){}}])}(),LOGGER=new DummyLogger;function setLogger(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DummyLogger;LOGGER=e}function debug(){var e;return(e=LOGGER).debug.apply(e,arguments)}function log(){var e;return(e=LOGGER).log.apply(e,arguments)}function info(){var e;return(e=LOGGER).info.apply(e,arguments)}function warn(){var e;return(e=LOGGER).warn.apply(e,arguments)}function error(){var e;return(e=LOGGER).error.apply(e,arguments)}function time(){var e;return(e=LOGGER).time.apply(e,arguments)}function timeEnd(){var e;return(e=LOGGER).timeEnd.apply(e,arguments)}exports.setLogger=setLogger,exports.debug=debug,exports.log=log,exports.info=info,exports.warn=warn,exports.error=error,exports.time=time,exports.timeEnd=timeEnd;

},{}],37:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new G(n||[]);return o(a,"_invoke",{value:E(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function g(){}function m(){}function w(){}var _={};s(_,a,function(){return this});var b=Object.getPrototypeOf,x=b&&b(b(D([])));x&&x!==r&&n.call(x,a)&&(_=x);var P=w.prototype=g.prototype=Object.create(_);function L(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function k(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(f).then(function(t){s.value=t,a(s)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function E(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return m.prototype=w,o(P,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},L(k.prototype),s(k.prototype,c,function(){return this}),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},L(P),s(P,u,"Generator"),s(P,a,function(){return this}),s(P,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var __createBinding=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e};Object.defineProperty(exports,"__esModule",{value:!0});var index_js_1=require("./compression/index.js"),defaultPoolSize="undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,Pool=function(){return _createClass(function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultPoolSize,n=arguments.length>1?arguments[1]:void 0;_classCallCheck(this,t),this.workers=null,this._awaitingDecoder=null,this.size=r,this.messageId=0,r&&(this._awaitingDecoder=n?Promise.resolve(n):new Promise(function(t){Promise.resolve().then(function(){return __importStar(require("./worker/decoder.js"))}).then(function(e){t(e.create)})}),this._awaitingDecoder.then(function(t){e._awaitingDecoder=null,e.workers=[];for(var n=0;n<r;n++)e.workers.push({worker:t(),idle:!0})}))},[{key:"decode",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){var n=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._awaitingDecoder){t.next=3;break}return t.next=3,this._awaitingDecoder;case 3:return t.abrupt("return",0===this.size?(0,index_js_1.getDecoder)(e).then(function(t){return t.decode(e,r)}):new Promise(function(t){var o=n.workers.find(function(t){return t.idle})||n.workers[Math.floor(Math.random()*n.size)];o.idle=!1;var i=n.messageId++;o.worker.addEventListener("message",function e(r){r.data.id===i&&(o.idle=!0,t(r.data.decoded),o.worker.removeEventListener("message",e))}),o.worker.postMessage({fileDirectory:e,buffer:r,id:i},[r])}));case 4:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"destroy",value:function(){this.workers&&(this.workers.forEach(function(t){t.worker.terminate()}),this.workers=null)}}])}();exports.default=Pool;

},{"./compression/index.js":23,"./worker/decoder.js":53}],38:[function(require,module,exports){
"use strict";function decodeRowAcc(e,r){var o=e.length-r,t=0;do{for(var i=r;i>0;i--)e[t+r]+=e[t],t++;o-=r}while(o>0)}function decodeRowFloatingPoint(e,r,o){for(var t=0,i=e.length,n=i/o;i>r;){for(var a=r;a>0;--a)e[t+r]+=e[t],++t;i-=r}for(var c=e.slice(),d=0;d<n;++d)for(var l=0;l<o;++l)e[o*d+l]=c[(o-l-1)*n+d]}function applyPredictor(e,r,o,t,i,n){if(!r||1===r)return e;for(var a=0;a<i.length;++a){if(i[a]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(i[a]!==i[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var c=i[0]/8,d=2===n?1:i.length,l=0;l<t&&!(l*d*o*c>=e.byteLength);++l){var s=void 0;if(2===r){switch(i[0]){case 8:s=new Uint8Array(e,l*d*o*c,d*o*c);break;case 16:s=new Uint16Array(e,l*d*o*c,d*o*c/2);break;case 32:s=new Uint32Array(e,l*d*o*c,d*o*c/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(i[0]," bits per sample."))}decodeRowAcc(s,d,c)}else 3===r&&decodeRowFloatingPoint(s=new Uint8Array(e,l*d*o*c,d*o*c),d,c)}return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyPredictor=void 0,exports.applyPredictor=applyPredictor;

},{}],39:[function(require,module,exports){
"use strict";function copyNewSize(e,r,a){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new(Object.getPrototypeOf(e).constructor)(r*a*t)}function resampleNearest(e,r,a,t,n){var l=r/t,o=a/n;return e.map(function(e){for(var s=copyNewSize(e,t,n),i=0;i<n;++i)for(var p=Math.min(Math.round(o*i),a-1),m=0;m<t;++m){var v=Math.min(Math.round(l*m),r-1),c=e[p*r+v];s[i*t+m]=c}return s})}function lerp(e,r,a){return(1-a)*e+a*r}function resampleBilinear(e,r,a,t,n){var l=r/t,o=a/n;return e.map(function(e){for(var s=copyNewSize(e,t,n),i=0;i<n;++i)for(var p=o*i,m=Math.floor(p),v=Math.min(Math.ceil(p),a-1),c=0;c<t;++c){var u=l*c,d=u%1,h=Math.floor(u),f=Math.min(Math.ceil(u),r-1),M=e[m*r+h],N=e[m*r+f],w=e[v*r+h],I=e[v*r+f],x=lerp(lerp(M,N,d),lerp(w,I,d),p%1);s[i*t+c]=x}return s})}function resample(e,r,a,t,n){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"nearest";switch(l.toLowerCase()){case"nearest":return resampleNearest(e,r,a,t,n);case"bilinear":case"linear":return resampleBilinear(e,r,a,t,n);default:throw new Error("Unsupported resampling method: '".concat(l,"'"))}}function resampleNearestInterleaved(e,r,a,t,n,l){for(var o=r/t,s=a/n,i=copyNewSize(e,t,n,l),p=0;p<n;++p)for(var m=Math.min(Math.round(s*p),a-1),v=0;v<t;++v)for(var c=Math.min(Math.round(o*v),r-1),u=0;u<l;++u){var d=e[m*r*l+c*l+u];i[p*t*l+v*l+u]=d}return i}function resampleBilinearInterleaved(e,r,a,t,n,l){for(var o=r/t,s=a/n,i=copyNewSize(e,t,n,l),p=0;p<n;++p)for(var m=s*p,v=Math.floor(m),c=Math.min(Math.ceil(m),a-1),u=0;u<t;++u)for(var d=o*u,h=d%1,f=Math.floor(d),M=Math.min(Math.ceil(d),r-1),N=0;N<l;++N){var w=e[v*r*l+f*l+N],I=e[v*r*l+M*l+N],x=e[c*r*l+f*l+N],B=e[c*r*l+M*l+N],y=lerp(lerp(w,I,h),lerp(x,B,h),m%1);i[p*t*l+u*l+N]=y}return i}function resampleInterleaved(e,r,a,t,n,l){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"nearest";switch(o.toLowerCase()){case"nearest":return resampleNearestInterleaved(e,r,a,t,n,l);case"bilinear":case"linear":return resampleBilinearInterleaved(e,r,a,t,n,l);default:throw new Error("Unsupported resampling method: '".concat(o,"'"))}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.resampleInterleaved=exports.resampleBilinearInterleaved=exports.resampleNearestInterleaved=exports.resample=exports.resampleBilinear=exports.resampleNearest=void 0,exports.resampleNearest=resampleNearest,exports.resampleBilinear=resampleBilinear,exports.resample=resample,exports.resampleNearestInterleaved=resampleNearestInterleaved,exports.resampleBilinearInterleaved=resampleBilinearInterleaved,exports.resampleInterleaved=resampleInterleaved;

},{}],40:[function(require,module,exports){
"use strict";function fromWhiteIsZero(r,t){for(var e,o=r.width,n=r.height,a=new Uint8Array(o*n*3),h=0,f=0;h<r.length;++h,f+=3)e=256-r[h]/t*256,a[f]=e,a[f+1]=e,a[f+2]=e;return a}function fromBlackIsZero(r,t){for(var e,o=r.width,n=r.height,a=new Uint8Array(o*n*3),h=0,f=0;h<r.length;++h,f+=3)e=r[h]/t*256,a[f]=e,a[f+1]=e,a[f+2]=e;return a}function fromPalette(r,t){for(var e=r.width,o=r.height,n=new Uint8Array(e*o*3),a=t.length/3,h=t.length/3*2,f=0,i=0;f<r.length;++f,i+=3){var m=r[f];n[i]=t[m]/65536*256,n[i+1]=t[m+a]/65536*256,n[i+2]=t[m+h]/65536*256}return n}function fromCMYK(r){for(var t=r.width,e=r.height,o=new Uint8Array(t*e*3),n=0,a=0;n<r.length;n+=4,a+=3){var h=r[n],f=r[n+1],i=r[n+2],m=r[n+3];o[a]=(255-h)/256*255*((255-m)/256),o[a+1]=(255-f)/256*255*((255-m)/256),o[a+2]=(255-i)/256*255*((255-m)/256)}return o}function fromYCbCr(r){for(var t=r.width,e=r.height,o=new Uint8ClampedArray(t*e*3),n=0,a=0;n<r.length;n+=3,a+=3){var h=r[n],f=r[n+1],i=r[n+2];o[a]=h+1.402*(i-128),o[a+1]=h-.34414*(f-128)-.71414*(i-128),o[a+2]=h+1.772*(f-128)}return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromCIELab=exports.fromYCbCr=exports.fromCMYK=exports.fromPalette=exports.fromBlackIsZero=exports.fromWhiteIsZero=void 0,exports.fromWhiteIsZero=fromWhiteIsZero,exports.fromBlackIsZero=fromBlackIsZero,exports.fromPalette=fromPalette,exports.fromCMYK=fromCMYK,exports.fromYCbCr=fromYCbCr;var Xn=.95047,Yn=1,Zn=1.08883;function fromCIELab(r){for(var t=r.width,e=r.height,o=new Uint8Array(t*e*3),n=0,a=0;n<r.length;n+=3,a+=3){var h=(r[n+0]+16)/116,f=(r[n+1]<<24>>24)/500+h,i=h-(r[n+2]<<24>>24)/200,m=void 0,s=void 0,l=void 0;s=-.9689*(f=Xn*(f*f*f>.008856?f*f*f:(f-16/116)/7.787))+1.8758*(h=Yn*(h*h*h>.008856?h*h*h:(h-16/116)/7.787))+.0415*(i=Zn*(i*i*i>.008856?i*i*i:(i-16/116)/7.787)),l=.0557*f+-.204*h+1.057*i,m=(m=3.2406*f+-1.5372*h+-.4986*i)>.0031308?1.055*Math.pow(m,1/2.4)-.055:12.92*m,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:12.92*s,l=l>.0031308?1.055*Math.pow(l,1/2.4)-.055:12.92*l,o[a]=255*Math.max(0,Math.min(1,m)),o[a+1]=255*Math.max(0,Math.min(1,s)),o[a+2]=255*Math.max(0,Math.min(1,l))}return o}exports.fromCIELab=fromCIELab;

},{}],41:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeBufferSource=void 0;var basesource_js_1=require("./basesource.js"),utils_js_1=require("../utils.js"),ArrayBufferSource=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).arrayBuffer=e,r}return _inherits(t,basesource_js_1.BaseSource),_createClass(t,[{key:"fetchSlice",value:function(e,t){if(t&&t.aborted)throw new utils_js_1.AbortError("Request aborted");return this.arrayBuffer.slice(e.offset,e.offset+e.length)}}])}();function makeBufferSource(e){return new ArrayBufferSource(e)}exports.makeBufferSource=makeBufferSource;

},{"../utils.js":52,"./basesource.js":42}],42:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new G(n||[]);return o(a,"_invoke",{value:P(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",m={};function d(){}function g(){}function w(){}var b={};f(b,a,function(){return this});var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(b=x);var L=w.prototype=d.prototype=Object.create(b);function E(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function S(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?e.resolve(s.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(s).then(function(t){f.value=t,a(f)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var f=l(e,r,n);if("normal"===f.type){if(o=n.done?v:p,f.arg===m)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=v,n.method="throw",n.arg=f.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=w,o(L,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=f(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,u,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),f(S.prototype,c,function(){return this}),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(L),f(L,u,"Generator"),f(L,a,function(){return this}),f(L,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),f=n.call(a,"finallyLoc");if(u&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseSource=void 0;var BaseSource=function(){return _createClass(function t(){_classCallCheck(this,t)},[{key:"fetch",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n=this,o=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:void 0,t.abrupt("return",Promise.all(e.map(function(t){return n.fetchSlice(t,r)})));case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"fetchSlice",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("fetching of slice ".concat(e," not possible, not implemented"));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"fileSize",get:function(){return null}},{key:"close",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}])}();exports.BaseSource=BaseSource;

},{}],43:[function(require,module,exports){
"use strict";function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),c=new B(n||[]);return o(a,"_invoke",{value:j(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function b(){}function g(){}function _(){}var m={};s(m,a,function(){return this});var k=Object.getPrototypeOf,w=k&&k(k(I([])));w&&w!==r&&n.call(w,a)&&(m=w);var S=_.prototype=b.prototype=Object.create(m);function x(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function O(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(l).then(function(t){s.value=t,a(s)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=_,o(S,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:g,configurable:!0}),g.displayName=s(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(O.prototype),s(O.prototype,c,function(){return this}),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(S),s(S,u,"Generator"),s(S,a,function(){return this}),s(S,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var __importDefault=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BlockedSource=void 0;var quick_lru_1=__importDefault(require("quick-lru")),basesource_js_1=require("./basesource.js"),utils_js_1=require("../utils.js"),Block=function(){return _createClass(function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,t),this.offset=e,this.length=r,this.data=n},[{key:"top",get:function(){return this.offset+this.length}}])}(),BlockGroup=_createClass(function t(e,r,n){_classCallCheck(this,t),this.offset=e,this.length=r,this.blockIds=n}),BlockedSource=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.blockSize,i=void 0===o?65536:o,a=n.cacheSize,c=void 0===a?100:a;return _classCallCheck(this,e),(r=_callSuper(this,e)).source=t,r.blockSize=i,r.blockCache=new quick_lru_1.default({maxSize:c,onEviction:function(t,e){r.evictedBlocks.set(t,e)}}),r.evictedBlocks=new Map,r.blockRequests=new Map,r.blockIdsToFetch=new Set,r.abortedBlockIds=new Set,r}return _inherits(e,basesource_js_1.BaseSource),_createClass(e,[{key:"fileSize",get:function(){return this.source.fileSize}},{key:"fetch",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){var n,o,i,a,c,u,s,l,f,h,p,y,v,d,b,g,_,m,k,w,S,x,O,j,P,E,L=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=[],o=[],i=[],this.evictedBlocks.clear(),a=_createForOfIteratorHelper(e);try{for(a.s();!(c=a.n()).done;)for(u=c.value,s=u.offset,l=u.length,f=s+l,null!==(h=this.fileSize)&&(f=Math.min(f,h)),p=Math.floor(s/this.blockSize)*this.blockSize,y=p;y<f;y+=this.blockSize)v=Math.floor(y/this.blockSize),this.blockCache.has(v)||this.blockRequests.has(v)||(this.blockIdsToFetch.add(v),o.push(v)),this.blockRequests.has(v)&&n.push(this.blockRequests.get(v)),i.push(v)}catch(t){a.e(t)}finally{a.f()}return t.next=8,(0,utils_js_1.wait)();case 8:for(this.fetchBlocks(r),d=[],b=0,g=o;b<g.length;b++)_=g[b],this.blockRequests.has(_)&&d.push(this.blockRequests.get(_));return t.next=13,Promise.allSettled(n);case 13:return t.next=15,Promise.allSettled(d);case 15:if(m=[],(k=i.filter(function(t){return L.abortedBlockIds.has(t)||!L.blockCache.has(t)})).forEach(function(t){return L.blockIdsToFetch.add(t)}),!(k.length>0&&r)||r.aborted){t.next=41;break}this.fetchBlocks(null),w=_createForOfIteratorHelper(k),t.prev=21,w.s();case 23:if((S=w.n()).done){t.next=31;break}if(x=S.value,O=this.blockRequests.get(x)){t.next=28;break}throw new Error("Block ".concat(x," is not in the block requests"));case 28:m.push(O);case 29:t.next=23;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(21),w.e(t.t0);case 36:return t.prev=36,w.f(),t.finish(36);case 39:return t.next=41,Promise.allSettled(m);case 41:if(!r||!r.aborted){t.next=43;break}throw new utils_js_1.AbortError("Request was aborted");case 43:if(j=i.map(function(t){return L.blockCache.get(t)||L.evictedBlocks.get(t)}),!(P=j.filter(function(t){return!t})).length){t.next=47;break}throw new utils_js_1.AggregateError(P,"Request failed");case 47:return E=new Map((0,utils_js_1.zip)(i,j)),t.abrupt("return",this.readSliceData(e,E));case 49:case"end":return t.stop()}},t,this,[[21,33,36,39]])}));return function(e,r){return t.apply(this,arguments)}}()},{key:"fetchBlocks",value:function(t){var e=this;if(this.blockIdsToFetch.size>0){for(var r=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(r,t),o=function(o){var i,a=_createForOfIteratorHelper(r[o].blockIds);try{var c=function(){var r=i.value;e.blockRequests.set(r,_asyncToGenerator(_regeneratorRuntime().mark(function i(){var a,c,u,s,l,f;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,n;case 3:i.t0=o,a=i.sent[i.t0],c=r*e.blockSize,u=c-a.offset,s=Math.min(u+e.blockSize,a.data.byteLength),l=a.data.slice(u,s),f=new Block(c,l.byteLength,l,r),e.blockCache.set(r,f),e.abortedBlockIds.delete(r),i.next=23;break;case 14:if(i.prev=14,i.t1=i.catch(0),"AbortError"!==i.t1.name){i.next=22;break}i.t1.signal=t,e.blockCache.delete(r),e.abortedBlockIds.add(r),i.next=23;break;case 22:throw i.t1;case 23:return i.prev=23,e.blockRequests.delete(r),i.finish(23);case 26:case"end":return i.stop()}},i,null,[[0,14,23,26]])}))())};for(a.s();!(i=a.n()).done;)c()}catch(t){a.e(t)}finally{a.f()}},i=0;i<r.length;++i)o(i);this.blockIdsToFetch.clear()}}},{key:"groupBlocks",value:function(t){var e=Array.from(t).sort(function(t,e){return t-e});if(0===e.length)return[];var r,n=[],o=null,i=[],a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var c=r.value;null===o||o+1===c?(n.push(c),o=c):(i.push(new BlockGroup(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[c],o=c)}}catch(t){a.e(t)}finally{a.f()}return i.push(new BlockGroup(n[0]*this.blockSize,n.length*this.blockSize,n)),i}},{key:"readSliceData",value:function(t,e){var r=this;return t.map(function(t){var n=t.offset+t.length;null!==r.fileSize&&(n=Math.min(r.fileSize,n));for(var o=Math.floor(t.offset/r.blockSize),i=Math.floor(n/r.blockSize),a=new ArrayBuffer(t.length),c=new Uint8Array(a),u=o;u<=i;++u){var s=e.get(u),l=s.offset-t.offset,f=0,h=0,p=void 0;l<0?f=-l:l>0&&(h=l),p=s.top-n<0?s.length-f:n-s.offset-f;var y=new Uint8Array(s.data,f,p);c.set(y,h)}return a})}}])}();exports.BlockedSource=BlockedSource;

},{"../utils.js":52,"./basesource.js":42,"quick-lru":426}],44:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:k(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function m(){}function g(){}function w(){}var b={};s(b,a,function(){return this});var _=Object.getPrototypeOf,x=_&&_(_(G([])));x&&x!==r&&n.call(x,a)&&(b=x);var E=w.prototype=m.prototype=Object.create(b);function L(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function P(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(f).then(function(t){s.value=t,a(s)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function k(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function G(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(P.prototype),s(P.prototype,c,function(){return this}),e.AsyncIterator=P,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new P(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},L(E),s(E,u,"Generator"),s(E,a,function(){return this}),s(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=G,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:G(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseClient=exports.BaseResponse=void 0;var BaseResponse=function(){return _createClass(function t(){_classCallCheck(this,t)},[{key:"ok",get:function(){return this.status>=200&&this.status<=299}},{key:"status",get:function(){throw new Error("not implemented")}},{key:"getHeader",value:function(t){throw new Error("not implemented")}},{key:"getData",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("not implemented");case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}])}();exports.BaseResponse=BaseResponse;var BaseClient=function(){return _createClass(function t(e){_classCallCheck(this,t),this.url=e},[{key:"request",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:throw e=r.length>0&&void 0!==r[0]?r[0]:{},e.headers,e.credentials,e.signal,new Error("request is not implemented");case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}])}();exports.BaseClient=BaseClient;

},{}],45:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new S(n||[]);return o(a,"_invoke",{value:E(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function _(){}function m(){}var b={};s(b,a,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(R([])));O&&O!==r&&n.call(O,a)&&(b=O);var x=m.prototype=g.prototype=Object.create(b);function P(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function j(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(f).then(function(t){s.value=t,a(s)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function E(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function R(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return _.prototype=m,o(x,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:_,configurable:!0}),_.displayName=s(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},P(j.prototype),s(j.prototype,c,function(){return this}),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},P(x),s(x,u,"Generator"),s(x,a,function(){return this}),s(x,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=R,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.FetchClient=void 0;var base_js_1=require("./base.js"),FetchResponse=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e)).response=t,r}return _inherits(e,base_js_1.BaseResponse),_createClass(e,[{key:"status",get:function(){return this.response.status}},{key:"getHeader",value:function(t){return this.response.headers.get(t)}},{key:"getData",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.response.arrayBuffer){t.next=6;break}return t.next=3,this.response.arrayBuffer();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,this.response.buffer();case 8:t.t0=t.sent.buffer;case 9:return e=t.t0,t.abrupt("return",e);case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(),FetchClient=function(t){function e(t,r){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,[t])).credentials=r,n}return _inherits(e,base_js_1.BaseClient),_createClass(e,[{key:"request",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,n,o,i,a=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:{},r=e.headers,n=e.credentials,o=e.signal,t.next=3,fetch(this.url,{headers:r,credentials:n,signal:o});case 3:return i=t.sent,t.abrupt("return",new FetchResponse(i));case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}();exports.FetchClient=FetchClient;

},{"./base.js":44}],46:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof _?e:_,a=Object.create(i.prototype),u=new R(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",d={};function _(){}function b(){}function g(){}var m={};s(m,a,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(k([])));O&&O!==r&&n.call(O,a)&&(m=O);var j=g.prototype=_.prototype=Object.create(m);function P(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function x(t,e){function r(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(f).then(function(t){s.value=t,a(s)},function(t){return r("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function E(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=L(u,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?v:h,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function k(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return b.prototype=g,o(j,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},P(x.prototype),s(x.prototype,u,function(){return this}),e.AsyncIterator=x,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new x(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},P(j),s(j,c,"Generator"),s(j,a,function(){return this}),s(j,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=k,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var __importDefault=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.HttpClient=void 0;var http_1=__importDefault(require("http")),https_1=__importDefault(require("https")),url_1=__importDefault(require("url")),base_js_1=require("./base.js"),utils_js_1=require("../../utils.js"),HttpResponse=function(t){function e(t,r){var n;return _classCallCheck(this,e),(n=_callSuper(this,e)).response=t,n.dataPromise=r,n}return _inherits(e,base_js_1.BaseResponse),_createClass(e,[{key:"status",get:function(){return this.response.statusCode}},{key:"getHeader",value:function(t){return this.response.headers[t]}},{key:"getData",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dataPromise;case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(),HttpClient=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,[t])).parsedUrl=url_1.default.parse(r.url),r.httpApi="http:"===r.parsedUrl.protocol?http_1.default:https_1.default,r}return _inherits(e,base_js_1.BaseClient),_createClass(e,[{key:"constructRequest",value:function(t,e){var r=this;return new Promise(function(n,o){var i=r.httpApi.get(_objectSpread(_objectSpread({},r.parsedUrl),{},{headers:t}),function(t){var e=new Promise(function(e){var r=[];t.on("data",function(t){r.push(t)}),t.on("end",function(){var t=Buffer.concat(r).buffer;e(t)}),t.on("error",o)});n(new HttpResponse(t,e))});i.on("error",o),e&&(e.aborted&&i.destroy(new utils_js_1.AbortError("Request aborted")),e.addEventListener("abort",function(){return i.destroy(new utils_js_1.AbortError("Request aborted"))}))})}},{key:"request",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,n,o,i=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{},r=e.headers,n=e.signal,t.next=3,this.constructRequest(r,n);case 3:return o=t.sent,t.abrupt("return",o);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}();exports.HttpClient=HttpClient;

}).call(this)}).call(this,require("buffer").Buffer)
},{"../../utils.js":52,"./base.js":44,"buffer":9,"http":428,"https":70,"url":449}],47:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof _?e:_,a=Object.create(i.prototype),u=new S(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",d={};function _(){}function b(){}function g(){}var m={};s(m,a,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(k([])));O&&O!==r&&n.call(O,a)&&(m=O);var j=g.prototype=_.prototype=Object.create(m);function x(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function L(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(l).then(function(t){s.value=t,a(s)},function(t){return r("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=E(u,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:h,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function E(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function k(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return b.prototype=g,o(j,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},x(L.prototype),s(L.prototype,u,function(){return this}),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(j),s(j,c,"Generator"),s(j,a,function(){return this}),s(j,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=k,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.XHRClient=void 0;var base_js_1=require("./base.js"),utils_js_1=require("../../utils.js"),XHRResponse=function(t){function e(t,r){var n;return _classCallCheck(this,e),(n=_callSuper(this,e)).xhr=t,n.data=r,n}return _inherits(e,base_js_1.BaseResponse),_createClass(e,[{key:"status",get:function(){return this.xhr.status}},{key:"getHeader",value:function(t){return this.xhr.getResponseHeader(t)}},{key:"getData",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.data);case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(),XHRClient=function(t){function e(){return _classCallCheck(this,e),_callSuper(this,e,arguments)}return _inherits(e,base_js_1.BaseClient),_createClass(e,[{key:"constructRequest",value:function(t,e){var r=this;return new Promise(function(n,o){var i=new XMLHttpRequest;i.open("GET",r.url),i.responseType="arraybuffer";for(var a=0,u=Object.entries(t);a<u.length;a++){var c=_slicedToArray(u[a],2),s=c[0],l=c[1];i.setRequestHeader(s,l)}i.onload=function(){var t=i.response;n(new XHRResponse(i,t))},i.onerror=o,i.onabort=function(){return o(new utils_js_1.AbortError("Request aborted"))},i.send(),e&&(e.aborted&&i.abort(),e.addEventListener("abort",function(){return i.abort()}))})}},{key:"request",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,n,o,i=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{},r=e.headers,n=e.signal,t.next=3,this.constructRequest(r,n);case 3:return o=t.sent,t.abrupt("return",o);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}();exports.XHRClient=XHRClient;

},{"../../utils.js":52,"./base.js":44}],48:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new R(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",d={};function m(){}function _(){}function g(){}var b={};f(b,a,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,a)&&(b=O);var P=g.prototype=m.prototype=Object.create(b);function x(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function j(t,e){function r(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?e.resolve(s.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(s).then(function(t){f.value=t,a(f)},function(t){return r("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function E(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=L(u,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var f=l(e,r,n);if("normal"===f.type){if(o=n.done?v:h,f.arg===d)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=v,n.method="throw",n.arg=f.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return _.prototype=g,o(P,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:_,configurable:!0}),_.displayName=f(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,f(t,c,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},x(j.prototype),f(j.prototype,u,function(){return this}),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},x(P),f(P,c,"Generator"),f(P,a,function(){return this}),f(P,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),f=n.call(a,"finallyLoc");if(c&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var __importDefault=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeFileSource=void 0;var fs_1=__importDefault(require("fs")),basesource_js_1=require("./basesource.js");function closeAsync(t){return new Promise(function(e,r){fs_1.default.close(t,function(t){t?r(t):e()})})}function openAsync(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return new Promise(function(n,o){fs_1.default.open(t,e,r,function(t,e){t?o(t):n(e)})})}function readAsync(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return new Promise(function(t,r){var n;(n=fs_1.default).read.apply(n,e.concat([function(e,n,o){e?r(e):t({bytesRead:n,buffer:o})}]))})}var FileSource=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e)).path=t,r.openRequest=openAsync(t,"r"),r}return _inherits(e,basesource_js_1.BaseSource),_createClass(e,[{key:"fetchSlice",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openRequest;case 2:return r=t.sent,t.next=5,readAsync(r,Buffer.alloc(e.length),0,e.length,e.offset);case 5:return n=t.sent,o=n.buffer,t.abrupt("return",o.buffer);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"close",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openRequest;case 2:return e=t.sent,t.next=5,closeAsync(e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}();function makeFileSource(t){return new FileSource(t)}exports.makeFileSource=makeFileSource;

}).call(this)}).call(this,require("buffer").Buffer)
},{"./basesource.js":42,"buffer":9,"fs":8}],49:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new k(n||[]);return o(a,"_invoke",{value:E(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function b(){}var _={};f(_,a,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var P=b.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function x(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?e.resolve(s.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):e.resolve(s).then(function(t){f.value=t,a(f)},function(t){return r("throw",t,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function E(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var f=l(e,r,n);if("normal"===f.type){if(o=n.done?v:h,f.arg===d)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=v,n.method="throw",n.arg=f.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return m.prototype=b,o(P,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=f(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,f(t,u,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},j(x.prototype),f(x.prototype,c,function(){return this}),e.AsyncIterator=x,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new x(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},j(P),f(P,u,"Generator"),f(P,a,function(){return this}),f(P,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),f=n.call(a,"finallyLoc");if(u&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,a,c,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeFileReaderSource=void 0;var basesource_js_1=require("./basesource.js"),FileReaderSource=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e)).file=t,r}return _inherits(e,basesource_js_1.BaseSource),_createClass(e,[{key:"fetchSlice",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,r){var n=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,o){var i=n.file.slice(e.offset,e.offset+e.length),a=new FileReader;a.onload=function(e){return t(e.target.result)},a.onerror=o,a.onabort=o,a.readAsArrayBuffer(i),r&&r.addEventListener("abort",function(){return a.abort()})}));case 1:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()}])}();function makeFileReaderSource(t){return new FileReaderSource(t)}exports.makeFileReaderSource=makeFileReaderSource;

},{"./basesource.js":42}],50:[function(require,module,exports){
"use strict";function _toArray(r){return _arrayWithHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableRest()}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,a,o,i,l=[],s=!0,u=!1;try{if(o=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(n=o.call(t)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(r){u=!0,a=r}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){t=t.call(r)},n:function(){var r=t.next();return i=r.done,r},e:function(r){l=!0,o=r},f:function(){try{i||null==t.return||t.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseByteRanges=exports.parseContentRange=exports.parseContentType=void 0;var CRLFCRLF="\r\n\r\n";function itemsToObject(r){if(void 0!==Object.fromEntries)return Object.fromEntries(r);var e,t={},n=_createForOfIteratorHelper(r);try{for(n.s();!(e=n.n()).done;){var a=_slicedToArray(e.value,2),o=a[0],i=a[1];t[o.toLowerCase()]=i}}catch(r){n.e(r)}finally{n.f()}return t}function parseHeaders(r){return itemsToObject(r.split("\r\n").map(function(r){var e=r.split(":").map(function(r){return r.trim()});return e[0]=e[0].toLowerCase(),e}))}function parseContentType(r){var e=_toArray(r.split(";").map(function(r){return r.trim()}));return{type:e[0],params:itemsToObject(e.slice(1).map(function(r){return r.split("=")}))}}function parseContentRange(r){var e,t,n;if(r){var a=_slicedToArray(r.match(/bytes (\d+)-(\d+)\/(\d+)/),4);e=a[1],t=a[2],n=a[3],e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10)}return{start:e,end:t,total:n}}function parseByteRanges(r,e){for(var t=null,n=new TextDecoder("ascii"),a=[],o="--".concat(e),i="".concat(o,"--"),l=0;l<10;++l){n.decode(new Uint8Array(r,l,o.length))===o&&(t=l)}if(null===t)throw new Error("Could not find initial boundary");for(;t<r.byteLength;){var s=n.decode(new Uint8Array(r,t,Math.min(o.length+1024,r.byteLength-t)));if(0===s.length||s.startsWith(i))break;if(!s.startsWith(o))throw new Error("Part does not start with boundary");var u=s.substr(o.length+2);if(0===u.length)break;var f=u.indexOf(CRLFCRLF),y=parseHeaders(u.substr(0,f)),c=parseContentRange(y["content-range"]),p=c.start,d=c.end,b=c.total,h=t+o.length+f+CRLFCRLF.length,m=parseInt(d,10)+1-parseInt(p,10);a.push({headers:y,data:r.slice(h,h+m),offset:p,length:m,fileSize:b}),t=h+m+4}return a}exports.parseContentType=parseContentType,exports.parseContentRange=parseContentRange,exports.parseByteRanges=parseByteRanges;

},{}],51:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _excluded=["headers","credentials","maxRanges","allowFullFile"],_excluded2=["headers","maxRanges","allowFullFile"],_excluded3=["headers","maxRanges","allowFullFile"],_excluded4=["headers","maxRanges","allowFullFile"],_excluded5=["forceXHR"];function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),c=new L(n||[]);return o(a,"_invoke",{value:O(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var _={};s(_,a,function(){return this});var w=Object.getPrototypeOf,S=w&&w(w(F([])));S&&S!==r&&n.call(S,a)&&(_=S);var x=b.prototype=m.prototype=Object.create(_);function j(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function k(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,a,c)},function(e){r("throw",e,a,c)}):t.resolve(l).then(function(e){s.value=e,a(s)},function(e){return r("throw",e,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t(function(t,o){r(e,n,t,o)})}return i=i?i.then(o,o):o()}})}function O(t,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(t,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function P(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(t)+" is not iterable")}return g.prototype=b,o(x,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},j(k.prototype),s(k.prototype,c,function(){return this}),t.AsyncIterator=k,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},j(x),s(x,u,"Generator"),s(x,a,function(){return this}),s(x,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function asyncGeneratorStep(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep(i,n,o,a,c,"next",e)}function c(e){asyncGeneratorStep(i,n,o,a,c,"throw",e)}a(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeRemoteSource=exports.makeCustomSource=exports.makeHttpSource=exports.makeXHRSource=exports.makeFetchSource=void 0;var httputils_js_1=require("./httputils.js"),basesource_js_1=require("./basesource.js"),blockedsource_js_1=require("./blockedsource.js"),fetch_js_1=require("./client/fetch.js"),xhr_js_1=require("./client/xhr.js"),http_js_1=require("./client/http.js"),RemoteSource=function(e){function t(e,r,n,o){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).client=e,i.headers=r,i.maxRanges=n,i.allowFullFile=o,i._fileSize=null,i}return _inherits(t,basesource_js_1.BaseSource),_createClass(t,[{key:"fetch",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.maxRanges>=t.length)){e.next=4;break}return e.abrupt("return",this.fetchSlices(t,r));case 4:this.maxRanges>0&&t.length;case 5:return e.abrupt("return",Promise.all(t.map(function(e){return n.fetchSlice(e,r)})));case 6:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchSlices",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n,o,i,a,c,u,s,l,f,h,p,y,d,v=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.request({headers:_objectSpread(_objectSpread({},this.headers),{},{Range:"bytes=".concat(t.map(function(e){var t=e.offset,r=e.length;return"".concat(t,"-").concat(t+r)}).join(","))}),signal:r});case 2:if((n=e.sent).ok){e.next=7;break}throw new Error("Error fetching data.");case 7:if(206!==n.status){e.next=32;break}if(o=(0,httputils_js_1.parseContentType)(n.getHeader("content-type")),i=o.type,a=o.params,"multipart/byteranges"!==i){e.next=18;break}return e.t0=httputils_js_1.parseByteRanges,e.next=13,n.getData();case 13:return e.t1=e.sent,e.t2=a.boundary,c=(0,e.t0)(e.t1,e.t2),this._fileSize=c[0].fileSize||null,e.abrupt("return",c);case 18:return e.next=20,n.getData();case 20:if(u=e.sent,s=(0,httputils_js_1.parseContentRange)(n.getHeader("content-range")),l=s.start,f=s.end,h=s.total,this._fileSize=h||null,p=[{data:u,offset:l,length:f-l}],!(t.length>1)){e.next=29;break}return e.next=27,Promise.all(t.slice(1).map(function(e){return v.fetchSlice(e,r)}));case 27:return y=e.sent,e.abrupt("return",p.concat(y));case 29:return e.abrupt("return",p);case 32:if(this.allowFullFile){e.next=34;break}throw new Error("Server responded with full file");case 34:return e.next=36,n.getData();case 36:return d=e.sent,this._fileSize=d.byteLength,e.abrupt("return",[{data:d,offset:0,length:d.byteLength}]);case 39:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchSlice",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n,o,i,a,c,u,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offset,o=t.length,e.next=3,this.client.request({headers:_objectSpread(_objectSpread({},this.headers),{},{Range:"bytes=".concat(n,"-").concat(n+o)}),signal:r});case 3:if((i=e.sent).ok){e.next=8;break}throw new Error("Error fetching data.");case 8:if(206!==i.status){e.next=17;break}return e.next=11,i.getData();case 11:return a=e.sent,c=(0,httputils_js_1.parseContentRange)(i.getHeader("content-range")),u=c.total,this._fileSize=u||null,e.abrupt("return",{data:a,offset:n,length:o});case 17:if(this.allowFullFile){e.next=19;break}throw new Error("Server responded with full file");case 19:return e.next=21,i.getData();case 21:return s=e.sent,this._fileSize=s.byteLength,e.abrupt("return",{data:s,offset:0,length:s.byteLength});case 24:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"fileSize",get:function(){return this._fileSize}}])}();function maybeWrapInBlockedSource(e,t){var r=t.blockSize,n=t.cacheSize;return null===r?e:new blockedsource_js_1.BlockedSource(e,{blockSize:r,cacheSize:n})}function makeFetchSource(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,o=t.credentials,i=t.maxRanges,a=void 0===i?0:i,c=t.allowFullFile,u=void 0!==c&&c,s=_objectWithoutProperties(t,_excluded),l=new fetch_js_1.FetchClient(e,o);return maybeWrapInBlockedSource(new RemoteSource(l,n,a,u),s)}function makeXHRSource(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,o=t.maxRanges,i=void 0===o?0:o,a=t.allowFullFile,c=void 0!==a&&a,u=_objectWithoutProperties(t,_excluded2),s=new xhr_js_1.XHRClient(e);return maybeWrapInBlockedSource(new RemoteSource(s,n,i,c),u)}function makeHttpSource(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,o=t.maxRanges,i=void 0===o?0:o,a=t.allowFullFile,c=void 0!==a&&a,u=_objectWithoutProperties(t,_excluded3),s=new http_js_1.HttpClient(e);return maybeWrapInBlockedSource(new RemoteSource(s,n,i,c),u)}function makeCustomSource(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,o=t.maxRanges,i=void 0===o?0:o,a=t.allowFullFile,c=void 0!==a&&a,u=_objectWithoutProperties(t,_excluded4);return maybeWrapInBlockedSource(new RemoteSource(e,n,i,c),u)}function makeRemoteSource(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.forceXHR,n=void 0!==r&&r,o=_objectWithoutProperties(t,_excluded5);return"function"!=typeof fetch||n?"undefined"!=typeof XMLHttpRequest?makeXHRSource(e,o):makeHttpSource(e,o):makeFetchSource(e,o)}exports.makeFetchSource=makeFetchSource,exports.makeXHRSource=makeXHRSource,exports.makeHttpSource=makeHttpSource,exports.makeCustomSource=makeCustomSource,exports.makeRemoteSource=makeRemoteSource;

},{"./basesource.js":42,"./blockedsource.js":43,"./client/fetch.js":45,"./client/http.js":46,"./client/xhr.js":47,"./httputils.js":50}],52:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function f(t,r,e,n){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:A(t,e,u)}),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",g={};function d(){}function m(){}function _(){}var w={};s(w,a,function(){return this});var b=Object.getPrototypeOf,x=b&&b(b(R([])));x&&x!==e&&n.call(x,a)&&(w=x);var E=_.prototype=d.prototype=Object.create(w);function O(t){["next","throw","return"].forEach(function(r){s(t,r,function(t){return this._invoke(r,t)})})}function P(t,r){function e(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?r.resolve(f.__await).then(function(t){e("next",t,a,u)},function(t){e("throw",t,a,u)}):r.resolve(f).then(function(t){s.value=t,a(s)},function(t){return e("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r(function(r,o){e(t,n,r,o)})}return i=i?i.then(o,o):o()}})}function A(r,e,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=j(u,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=l(r,e,n);if("normal"===s.type){if(o=n.done?v:h,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=l(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,g):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function L(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function S(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function R(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(_typeof(r)+" is not iterable")}return m.prototype=_,o(E,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:m,configurable:!0}),m.displayName=s(_,c,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},r.awrap=function(t){return{__await:t}},O(P.prototype),s(P.prototype,u,function(){return this}),r.AsyncIterator=P,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new P(f(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},O(E),s(E,c,"Generator"),s(E,a,function(){return this}),s(E,"toString",function(){return"[object Generator]"}),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=R,C.prototype={constructor:C,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return u.type="throw",u.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),g},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),S(e),g}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;S(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:R(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),g}},r}function _defineProperties(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,r,e){return r&&_defineProperties(t.prototype,r),e&&_defineProperties(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var r=_toPrimitive(t,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,r,e){return r=_getPrototypeOf(r),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(r,e||[],_getPrototypeOf(t).constructor):r.apply(t,e))}function _possibleConstructorReturn(t,r){if(r&&("object"==_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_setPrototypeOf(t,r)}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function _construct(t,r,e){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,r);var o=new(t.bind.apply(t,n));return e&&_setPrototypeOf(o,e.prototype),o}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _isNativeFunction(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(r){return"function"==typeof t}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t})(t,r)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function asyncGeneratorStep(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}function assign(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])}function chunk(t,r){for(var e=[],n=t.length,o=0;o<n;o+=r){for(var i=[],a=o;a<o+r;a++)i.push(t[a]);e.push(i)}return e}function endsWith(t,r){return!(t.length<r.length)&&t.substr(t.length-r.length)===r}function forEach(t,r){for(var e=t.length,n=0;n<e;n++)r(t[n],n)}function invert(t){var r={};for(var e in t){if(t.hasOwnProperty(e))r[t[e]]=e}return r}function range(t){for(var r=[],e=0;e<t;e++)r.push(e);return r}function times(t,r){for(var e=[],n=0;n<t;n++)e.push(r(n));return e}function toArray(t){for(var r=[],e=t.length,n=0;n<e;n++)r.push(t[n]);return r}function toArrayRecursively(t){return t.length?toArray(t).map(toArrayRecursively):t}function parseContentRange(t){if(!t)return null;if("string"!=typeof t)throw new Error("invalid argument");var r=function(t){return Number.parseInt(t,10)},e=t.match(/^(\w*) /),n=e&&e[1];return(e=t.match(/(\d+)-(\d+)\/(\d+|\*)/))?{unit:n,first:r(e[1]),last:r(e[2]),length:"*"===e[3]?null:r(e[3])}:(e=t.match(/(\d+|\*)/))?{unit:n,first:null,last:null,length:"*"===e[1]?null:r(e[1])}:null}function wait(t){return _wait.apply(this,arguments)}function _wait(){return(_wait=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){return setTimeout(t,r)}));case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}function zip(t,r){var e=Array.isArray(t)?t:Array.from(t),n=Array.isArray(r)?r:Array.from(r);return e.map(function(t,r){return[t,n[r]]})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AggregateError=exports.CustomAggregateError=exports.AbortError=exports.zip=exports.wait=exports.parseContentRange=exports.toArrayRecursively=exports.toArray=exports.times=exports.range=exports.invert=exports.forEach=exports.endsWith=exports.chunk=exports.assign=void 0,exports.assign=assign,exports.chunk=chunk,exports.endsWith=endsWith,exports.forEach=forEach,exports.invert=invert,exports.range=range,exports.times=times,exports.toArray=toArray,exports.toArrayRecursively=toArrayRecursively,exports.parseContentRange=parseContentRange,exports.wait=wait,exports.zip=zip;var AbortError=function(t){function r(t){var e;return _classCallCheck(this,r),e=_callSuper(this,r,[t]),Error.captureStackTrace&&Error.captureStackTrace(e,r),e.name="AbortError",e}return _inherits(r,_wrapNativeSuper(Error)),_createClass(r)}();exports.AbortError=AbortError;var CustomAggregateError=function(t){function r(t,e){var n;return _classCallCheck(this,r),(n=_callSuper(this,r,[e])).errors=t,n.message=e,n.name="AggregateError",n}return _inherits(r,_wrapNativeSuper(Error)),_createClass(r)}();exports.CustomAggregateError=CustomAggregateError,exports.AggregateError=CustomAggregateError;

},{}],53:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";var __importDefault=function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=void 0;var web_worker_1=__importDefault(require("web-worker"));function create(){var A='function A(A,e,t,i,r,I,g){try{var n=A[I](g),a=n.value}catch(A){return void t(A)}n.done?e(a):Promise.resolve(a).then(i,r)}function e(e){return function(){var t=this,i=arguments;return new Promise((function(r,I){var g=e.apply(t,i);function n(e){A(g,r,I,n,a,"next",e)}function a(e){A(g,r,I,n,a,"throw",e)}n(void 0)}))}}function t(A){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&"function"==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},t(A)}var i={exports:{}};!function(A){var e=function(A){var e,i=Object.prototype,r=i.hasOwnProperty,I="function"==typeof Symbol?Symbol:{},g=I.iterator||"@@iterator",n=I.asyncIterator||"@@asyncIterator",a=I.toStringTag||"@@toStringTag";function o(A,e,t){return Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),A[e]}try{o({},"")}catch(A){o=function(A,e,t){return A[e]=t}}function B(A,e,t,i){var r=e&&e.prototype instanceof h?e:h,I=Object.create(r.prototype),g=new S(i||[]);return I._invoke=function(A,e,t){var i=Q;return function(r,I){if(i===s)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw I;return R()}for(t.method=r,t.arg=I;;){var g=t.delegate;if(g){var n=m(g,t);if(n){if(n===c)continue;return n}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(i===Q)throw i=f,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);i=s;var a=C(A,e,t);if("normal"===a.type){if(i=t.done?f:E,a.arg===c)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(i=f,t.method="throw",t.arg=a.arg)}}}(A,t,g),I}function C(A,e,t){try{return{type:"normal",arg:A.call(e,t)}}catch(A){return{type:"throw",arg:A}}}A.wrap=B;var Q="suspendedStart",E="suspendedYield",s="executing",f="completed",c={};function h(){}function l(){}function u(){}var w={};o(w,g,(function(){return this}));var d=Object.getPrototypeOf,D=d&&d(d(v([])));D&&D!==i&&r.call(D,g)&&(w=D);var y=u.prototype=h.prototype=Object.create(w);function k(A){["next","throw","return"].forEach((function(e){o(A,e,(function(A){return this._invoke(e,A)}))}))}function p(A,e){function i(I,g,n,a){var o=C(A[I],A,g);if("throw"!==o.type){var B=o.arg,Q=B.value;return Q&&"object"===t(Q)&&r.call(Q,"__await")?e.resolve(Q.__await).then((function(A){i("next",A,n,a)}),(function(A){i("throw",A,n,a)})):e.resolve(Q).then((function(A){B.value=A,n(B)}),(function(A){return i("throw",A,n,a)}))}a(o.arg)}var I;this._invoke=function(A,t){function r(){return new e((function(e,r){i(A,t,e,r)}))}return I=I?I.then(r,r):r()}}function m(A,t){var i=A.iterator[t.method];if(i===e){if(t.delegate=null,"throw"===t.method){if(A.iterator.return&&(t.method="return",t.arg=e,m(A,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a \'throw\' method")}return c}var r=C(i,A.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var I=r.arg;return I?I.done?(t[A.resultName]=I.value,t.next=A.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,c):I:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function G(A){var e={tryLoc:A[0]};1 in A&&(e.catchLoc=A[1]),2 in A&&(e.finallyLoc=A[2],e.afterLoc=A[3]),this.tryEntries.push(e)}function F(A){var e=A.completion||{};e.type="normal",delete e.arg,A.completion=e}function S(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(G,this),this.reset(!0)}function v(A){if(A){var t=A[g];if(t)return t.call(A);if("function"==typeof A.next)return A;if(!isNaN(A.length)){var i=-1,I=function t(){for(;++i<A.length;)if(r.call(A,i))return t.value=A[i],t.done=!1,t;return t.value=e,t.done=!0,t};return I.next=I}}return{next:R}}function R(){return{value:e,done:!0}}return l.prototype=u,o(y,"constructor",u),o(u,"constructor",l),l.displayName=o(u,a,"GeneratorFunction"),A.isGeneratorFunction=function(A){var e="function"==typeof A&&A.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},A.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,u):(A.__proto__=u,o(A,a,"GeneratorFunction")),A.prototype=Object.create(y),A},A.awrap=function(A){return{__await:A}},k(p.prototype),o(p.prototype,n,(function(){return this})),A.AsyncIterator=p,A.async=function(e,t,i,r,I){void 0===I&&(I=Promise);var g=new p(B(e,t,i,r),I);return A.isGeneratorFunction(t)?g:g.next().then((function(A){return A.done?A.value:g.next()}))},k(y),o(y,a,"Generator"),o(y,g,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),A.keys=function(A){var e=[];for(var t in A)e.push(t);return e.reverse(),function t(){for(;e.length;){var i=e.pop();if(i in A)return t.value=i,t.done=!1,t}return t.done=!0,t}},A.values=v,S.prototype={constructor:S,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(F),!A)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if("throw"===A.type)throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var t=this;function i(i,r){return n.type="throw",n.arg=A,t.next=i,r&&(t.method="next",t.arg=e),!!r}for(var I=this.tryEntries.length-1;I>=0;--I){var g=this.tryEntries[I],n=g.completion;if("root"===g.tryLoc)return i("end");if(g.tryLoc<=this.prev){var a=r.call(g,"catchLoc"),o=r.call(g,"finallyLoc");if(a&&o){if(this.prev<g.catchLoc)return i(g.catchLoc,!0);if(this.prev<g.finallyLoc)return i(g.finallyLoc)}else if(a){if(this.prev<g.catchLoc)return i(g.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<g.finallyLoc)return i(g.finallyLoc)}}}},abrupt:function(A,e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var I=i;break}}I&&("break"===A||"continue"===A)&&I.tryLoc<=e&&e<=I.finallyLoc&&(I=null);var g=I?I.completion:{};return g.type=A,g.arg=e,I?(this.method="next",this.next=I.finallyLoc,c):this.complete(g)},complete:function(A,e){if("throw"===A.type)throw A.arg;return"break"===A.type||"continue"===A.type?this.next=A.arg:"return"===A.type?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):"normal"===A.type&&e&&(this.next=e),c},finish:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===A)return this.complete(t.completion,t.afterLoc),F(t),c}},catch:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===A){var i=t.completion;if("throw"===i.type){var r=i.arg;F(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(A,t,i){return this.delegate={iterator:v(A),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=e),c}},A}(A.exports);try{regeneratorRuntime=e}catch(A){"object"===("undefined"==typeof globalThis?"undefined":t(globalThis))?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(i);var r=i.exports,I=new Map;function g(A,e){Array.isArray(A)||(A=[A]),A.forEach((function(A){return I.set(A,e)}))}function n(A){return a.apply(this,arguments)}function a(){return(a=e(r.mark((function A(e){var t,i;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(t=I.get(e.Compression)){A.next=3;break}throw new Error("Unknown compression method identifier: ".concat(e.Compression));case 3:return A.next=5,t();case 5:return i=A.sent,A.abrupt("return",new i(e));case 7:case"end":return A.stop()}}),A)})))).apply(this,arguments)}g([void 0,1],(function(){return Promise.resolve().then((function(){return y})).then((function(A){return A.default}))})),g(5,(function(){return Promise.resolve().then((function(){return F})).then((function(A){return A.default}))})),g(6,(function(){throw new Error("old style JPEG compression is not supported.")})),g(7,(function(){return Promise.resolve().then((function(){return N})).then((function(A){return A.default}))})),g([8,32946],(function(){return Promise.resolve().then((function(){return OA})).then((function(A){return A.default}))})),g(32773,(function(){return Promise.resolve().then((function(){return _A})).then((function(A){return A.default}))})),g(34887,(function(){return Promise.resolve().then((function(){return le})).then(function(){var A=e(r.mark((function A(e){return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,e.zstd.init();case 2:return A.abrupt("return",e);case 3:case"end":return A.stop()}}),A)})));return function(e){return A.apply(this,arguments)}}()).then((function(A){return A.default}))})),g(50001,(function(){return Promise.resolve().then((function(){return de})).then((function(A){return A.default}))}));var o=globalThis;function B(A,e){if(!(A instanceof e))throw new TypeError("Cannot call a class as a function")}function C(A,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(A,i.key,i)}}function Q(A,e,t){return e&&C(A.prototype,e),t&&C(A,t),A}function E(A,e){return E=Object.setPrototypeOf||function(A,e){return A.__proto__=e,A},E(A,e)}function s(A,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(e&&e.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),e&&E(A,e)}function f(A,e){if(e&&("object"===t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(void 0===A)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return A}(A)}function c(A){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(A){return A.__proto__||Object.getPrototypeOf(A)},c(A)}function h(A,e){var t=A.length-e,i=0;do{for(var r=e;r>0;r--)A[i+e]+=A[i],i++;t-=e}while(t>0)}function l(A,e,t){for(var i=0,r=A.length,I=r/t;r>e;){for(var g=e;g>0;--g)A[i+e]+=A[i],++i;r-=e}for(var n=A.slice(),a=0;a<I;++a)for(var o=0;o<t;++o)A[t*a+o]=n[(t-o-1)*I+a]}function u(A,e,t,i,r,I){if(!e||1===e)return A;for(var g=0;g<r.length;++g){if(r[g]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(r[g]!==r[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var n=r[0]/8,a=2===I?1:r.length,o=0;o<i&&!(o*a*t*n>=A.byteLength);++o){var B=void 0;if(2===e){switch(r[0]){case 8:B=new Uint8Array(A,o*a*t*n,a*t*n);break;case 16:B=new Uint16Array(A,o*a*t*n,a*t*n/2);break;case 32:B=new Uint32Array(A,o*a*t*n,a*t*n/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(r[0]," bits per sample."))}h(B,a)}else 3===e&&l(B=new Uint8Array(A,o*a*t*n,a*t*n),a,n)}return A}o.addEventListener("message",function(){var A=e(r.mark((function A(e){var t,i,I,g,a,B;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=e.data,i=t.id,I=t.fileDirectory,g=t.buffer,A.next=3,n(I);case 3:return a=A.sent,A.next=6,a.decode(I,g);case 6:B=A.sent,o.postMessage({decoded:B,id:i},[B]);case 8:case"end":return A.stop()}}),A)})));return function(e){return A.apply(this,arguments)}}());var w=function(){function A(){B(this,A)}var t;return Q(A,[{key:"decode",value:(t=e(r.mark((function A(e,t){var i,I,g,n,a;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.decodeBlock(t);case 2:if(i=A.sent,1===(I=e.Predictor||1)){A.next=9;break}return g=!e.StripOffsets,n=g?e.TileWidth:e.ImageWidth,a=g?e.TileLength:e.RowsPerStrip||e.ImageLength,A.abrupt("return",u(i,I,n,a,e.BitsPerSample,e.PlanarConfiguration));case 9:return A.abrupt("return",i);case 10:case"end":return A.stop()}}),A,this)}))),function(A,e){return t.apply(this,arguments)})}]),A}();function d(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var D=function(A){s(t,w);var e=d(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){return A}}]),t}(),y=Object.freeze({__proto__:null,default:D});function k(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}function p(A,e){for(var t=e.length-1;t>=0;t--)A.push(e[t]);return A}function m(A){for(var e=new Uint16Array(4093),t=new Uint8Array(4093),i=0;i<=257;i++)e[i]=4096,t[i]=i;var r=258,I=9,g=0;function n(){r=258,I=9}function a(A){var e=function(A,e,t){var i=e%8,r=Math.floor(e/8),I=8-i,g=e+t-8*(r+1),n=8*(r+2)-(e+t),a=8*(r+2)-e;if(n=Math.max(0,n),r>=A.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;var o=A[r]&Math.pow(2,8-i)-1,B=o<<=t-I;if(r+1<A.length){var C=A[r+1]>>>n;B+=C<<=Math.max(0,t-a)}if(g>8&&r+2<A.length){var Q=8*(r+3)-(e+t);B+=A[r+2]>>>Q}return B}(A,g,I);return g+=I,e}function o(A,i){return t[r]=i,e[r]=A,++r-1}function B(A){for(var i=[],r=A;4096!==r;r=e[r])i.push(t[r]);return i}var C=[];n();for(var Q,E=new Uint8Array(A),s=a(E);257!==s;){if(256===s){for(n(),s=a(E);256===s;)s=a(E);if(257===s)break;if(s>256)throw new Error("corrupted code at scanline ".concat(s));p(C,B(s)),Q=s}else if(s<r){var f=B(s);p(C,f),o(Q,f[f.length-1]),Q=s}else{var c=B(Q);if(!c)throw new Error("Bogus entry. Not in dictionary, ".concat(Q," / ").concat(r,", position: ").concat(g));p(C,c),C.push(c[c.length-1]),o(Q,c[c.length-1]),Q=s}r+1>=Math.pow(2,I)&&(12===I?Q=void 0:I++),s=a(E)}return new Uint8Array(C)}var G=function(A){s(t,w);var e=k(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){return m(A).buffer}}]),t}(),F=Object.freeze({__proto__:null,default:G});function S(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var v=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function R(A,e){for(var t=0,i=[],r=16;r>0&&!A[r-1];)--r;i.push({children:[],index:0});for(var I,g=i[0],n=0;n<r;n++){for(var a=0;a<A[n];a++){for((g=i.pop()).children[g.index]=e[t];g.index>0;)g=i.pop();for(g.index++,i.push(g);i.length<=n;)i.push(I={children:[],index:0}),g.children[g.index]=I.children,g=I;t++}n+1<r&&(i.push(I={children:[],index:0}),g.children[g.index]=I.children,g=I)}return i[0].children}function U(A,e,i,r,I,g,n,a,o){var B=i.mcusPerLine,C=i.progressive,Q=e,E=e,s=0,f=0;function c(){if(f>0)return f--,s>>f&1;if(255===(s=A[E++])){var e=A[E++];if(e)throw new Error("unexpected marker: ".concat((s<<8|e).toString(16)))}return f=7,s>>>7}function h(A){for(var e,i=A;null!==(e=c());){if("number"==typeof(i=i[e]))return i;if("object"!==t(i))throw new Error("invalid huffman sequence")}return null}function l(A){for(var e=A,t=0;e>0;){var i=c();if(null===i)return;t=t<<1|i,--e}return t}function u(A){var e=l(A);return e>=1<<A-1?e:e+(-1<<A)+1}var w=0;var d,D=0;function y(A,e,t,i,r){var I=t%B,g=(t/B|0)*A.v+i,n=I*A.h+r;e(A,A.blocks[g][n])}function k(A,e,t){var i=t/A.blocksPerLine|0,r=t%A.blocksPerLine;e(A,A.blocks[i][r])}var p,m,G,F,S,R,U=r.length;R=C?0===g?0===a?function(A,e){var t=h(A.huffmanTableDC),i=0===t?0:u(t)<<o;A.pred+=i,e[0]=A.pred}:function(A,e){e[0]|=c()<<o}:0===a?function(A,e){if(w>0)w--;else for(var t=g,i=n;t<=i;){var r=h(A.huffmanTableAC),I=15&r,a=r>>4;if(0===I){if(a<15){w=l(a)+(1<<a)-1;break}t+=16}else e[v[t+=a]]=u(I)*(1<<o),t++}}:function(A,e){for(var t=g,i=n,r=0;t<=i;){var I=v[t],a=e[I]<0?-1:1;switch(D){case 0:var B=h(A.huffmanTableAC),C=15&B;if(r=B>>4,0===C)r<15?(w=l(r)+(1<<r),D=4):(r=16,D=1);else{if(1!==C)throw new Error("invalid ACn encoding");d=u(C),D=r?2:3}continue;case 1:case 2:e[I]?e[I]+=(c()<<o)*a:0==--r&&(D=2===D?3:0);break;case 3:e[I]?e[I]+=(c()<<o)*a:(e[I]=d<<o,D=0);break;case 4:e[I]&&(e[I]+=(c()<<o)*a)}t++}4===D&&0==--w&&(D=0)}:function(A,e){var t=h(A.huffmanTableDC),i=0===t?0:u(t);A.pred+=i,e[0]=A.pred;for(var r=1;r<64;){var I=h(A.huffmanTableAC),g=15&I,n=I>>4;if(0===g){if(n<15)break;r+=16}else e[v[r+=n]]=u(g),r++}};var L,b,M=0;b=1===U?r[0].blocksPerLine*r[0].blocksPerColumn:B*i.mcusPerColumn;for(var N=I||b;M<b;){for(m=0;m<U;m++)r[m].pred=0;if(w=0,1===U)for(p=r[0],S=0;S<N;S++)k(p,R,M),M++;else for(S=0;S<N;S++){for(m=0;m<U;m++){var x=p=r[m],J=x.h,q=x.v;for(G=0;G<q;G++)for(F=0;F<J;F++)y(p,R,M,G,F)}if(++M===b)break}if(f=0,(L=A[E]<<8|A[E+1])<65280)throw new Error("marker was not found");if(!(L>=65488&&L<=65495))break;E+=2}return E-Q}function L(A,e){var t=[],i=e.blocksPerLine,r=e.blocksPerColumn,I=i<<3,g=new Int32Array(64),n=new Uint8Array(64);function a(A,t,i){var r,I,g,n,a,o,B,C,Q,E,s=e.quantizationTable,f=i;for(E=0;E<64;E++)f[E]=A[E]*s[E];for(E=0;E<8;++E){var c=8*E;0!==f[1+c]||0!==f[2+c]||0!==f[3+c]||0!==f[4+c]||0!==f[5+c]||0!==f[6+c]||0!==f[7+c]?(r=5793*f[0+c]+128>>8,I=5793*f[4+c]+128>>8,g=f[2+c],n=f[6+c],a=2896*(f[1+c]-f[7+c])+128>>8,C=2896*(f[1+c]+f[7+c])+128>>8,o=f[3+c]<<4,Q=r-I+1>>1,r=r+I+1>>1,I=Q,Q=3784*g+1567*n+128>>8,g=1567*g-3784*n+128>>8,n=Q,Q=a-(B=f[5+c]<<4)+1>>1,a=a+B+1>>1,B=Q,Q=C+o+1>>1,o=C-o+1>>1,C=Q,Q=r-n+1>>1,r=r+n+1>>1,n=Q,Q=I-g+1>>1,I=I+g+1>>1,g=Q,Q=2276*a+3406*C+2048>>12,a=3406*a-2276*C+2048>>12,C=Q,Q=799*o+4017*B+2048>>12,o=4017*o-799*B+2048>>12,B=Q,f[0+c]=r+C,f[7+c]=r-C,f[1+c]=I+B,f[6+c]=I-B,f[2+c]=g+o,f[5+c]=g-o,f[3+c]=n+a,f[4+c]=n-a):(Q=5793*f[0+c]+512>>10,f[0+c]=Q,f[1+c]=Q,f[2+c]=Q,f[3+c]=Q,f[4+c]=Q,f[5+c]=Q,f[6+c]=Q,f[7+c]=Q)}for(E=0;E<8;++E){var h=E;0!==f[8+h]||0!==f[16+h]||0!==f[24+h]||0!==f[32+h]||0!==f[40+h]||0!==f[48+h]||0!==f[56+h]?(r=5793*f[0+h]+2048>>12,I=5793*f[32+h]+2048>>12,g=f[16+h],n=f[48+h],a=2896*(f[8+h]-f[56+h])+2048>>12,C=2896*(f[8+h]+f[56+h])+2048>>12,o=f[24+h],Q=r-I+1>>1,r=r+I+1>>1,I=Q,Q=3784*g+1567*n+2048>>12,g=1567*g-3784*n+2048>>12,n=Q,Q=a-(B=f[40+h])+1>>1,a=a+B+1>>1,B=Q,Q=C+o+1>>1,o=C-o+1>>1,C=Q,Q=r-n+1>>1,r=r+n+1>>1,n=Q,Q=I-g+1>>1,I=I+g+1>>1,g=Q,Q=2276*a+3406*C+2048>>12,a=3406*a-2276*C+2048>>12,C=Q,Q=799*o+4017*B+2048>>12,o=4017*o-799*B+2048>>12,B=Q,f[0+h]=r+C,f[56+h]=r-C,f[8+h]=I+B,f[48+h]=I-B,f[16+h]=g+o,f[40+h]=g-o,f[24+h]=n+a,f[32+h]=n-a):(Q=5793*i[E+0]+8192>>14,f[0+h]=Q,f[8+h]=Q,f[16+h]=Q,f[24+h]=Q,f[32+h]=Q,f[40+h]=Q,f[48+h]=Q,f[56+h]=Q)}for(E=0;E<64;++E){var l=128+(f[E]+8>>4);t[E]=l<0?0:l>255?255:l}}for(var o=0;o<r;o++){for(var B=o<<3,C=0;C<8;C++)t.push(new Uint8Array(I));for(var Q=0;Q<i;Q++){a(e.blocks[o][Q],n,g);for(var E=0,s=Q<<3,f=0;f<8;f++)for(var c=t[B+f],h=0;h<8;h++)c[s+h]=n[E++]}}return t}var b=function(){function A(){B(this,A),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return Q(A,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(A){var e=0;function t(){var t=A[e]<<8|A[e+1];return e+=2,t}function i(A){var e,t,i=0,r=0;for(t in A.components)A.components.hasOwnProperty(t)&&(i<(e=A.components[t]).h&&(i=e.h),r<e.v&&(r=e.v));var I=Math.ceil(A.samplesPerLine/8/i),g=Math.ceil(A.scanLines/8/r);for(t in A.components)if(A.components.hasOwnProperty(t)){e=A.components[t];for(var n=Math.ceil(Math.ceil(A.samplesPerLine/8)*e.h/i),a=Math.ceil(Math.ceil(A.scanLines/8)*e.v/r),o=I*e.h,B=g*e.v,C=[],Q=0;Q<B;Q++){for(var E=[],s=0;s<o;s++)E.push(new Int32Array(64));C.push(E)}e.blocksPerLine=n,e.blocksPerColumn=a,e.blocks=C}A.maxH=i,A.maxV=r,A.mcusPerLine=I,A.mcusPerColumn=g}var r,I,g=t();if(65496!==g)throw new Error("SOI not found");for(g=t();65497!==g;){switch(g){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var n=(r=void 0,I=void 0,r=t(),I=A.subarray(e,e+r-2),e+=I.length,I);65504===g&&74===n[0]&&70===n[1]&&73===n[2]&&70===n[3]&&0===n[4]&&(this.jfif={version:{major:n[5],minor:n[6]},densityUnits:n[7],xDensity:n[8]<<8|n[9],yDensity:n[10]<<8|n[11],thumbWidth:n[12],thumbHeight:n[13],thumbData:n.subarray(14,14+3*n[12]*n[13])}),65518===g&&65===n[0]&&100===n[1]&&111===n[2]&&98===n[3]&&101===n[4]&&0===n[5]&&(this.adobe={version:n[6],flags0:n[7]<<8|n[8],flags1:n[9]<<8|n[10],transformCode:n[11]});break;case 65499:for(var a=t()+e-2;e<a;){var o=A[e++],B=new Int32Array(64);if(o>>4==0)for(var C=0;C<64;C++){B[v[C]]=A[e++]}else{if(o>>4!=1)throw new Error("DQT: invalid table spec");for(var Q=0;Q<64;Q++){B[v[Q]]=t()}}this.quantizationTables[15&o]=B}break;case 65472:case 65473:case 65474:t();for(var E={extended:65473===g,progressive:65474===g,precision:A[e++],scanLines:t(),samplesPerLine:t(),components:{},componentsOrder:[]},s=A[e++],f=void 0,c=0;c<s;c++){f=A[e];var h=A[e+1]>>4,l=15&A[e+1],u=A[e+2];E.componentsOrder.push(f),E.components[f]={h:h,v:l,quantizationIdx:u},e+=3}i(E),this.frames.push(E);break;case 65476:for(var w=t(),d=2;d<w;){for(var D=A[e++],y=new Uint8Array(16),k=0,p=0;p<16;p++,e++)y[p]=A[e],k+=y[p];for(var m=new Uint8Array(k),G=0;G<k;G++,e++)m[G]=A[e];d+=17+k,D>>4==0?this.huffmanTablesDC[15&D]=R(y,m):this.huffmanTablesAC[15&D]=R(y,m)}break;case 65501:t(),this.resetInterval=t();break;case 65498:t();for(var F=A[e++],S=[],L=this.frames[0],b=0;b<F;b++){var M=L.components[A[e++]],N=A[e++];M.huffmanTableDC=this.huffmanTablesDC[N>>4],M.huffmanTableAC=this.huffmanTablesAC[15&N],S.push(M)}var x=A[e++],J=A[e++],q=A[e++],Y=U(A,e,L,S,this.resetInterval,x,J,q>>4,15&q);e+=Y;break;case 65535:255!==A[e]&&e--;break;default:if(255===A[e-3]&&A[e-2]>=192&&A[e-2]<=254){e-=3;break}throw new Error("unknown JPEG marker ".concat(g.toString(16)))}g=t()}}},{key:"getResult",value:function(){var A=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var e=0;e<this.frames.length;e++)for(var t=this.frames[e].components,i=0,r=Object.keys(t);i<r.length;i++){var I=r[i];t[I].quantizationTable=this.quantizationTables[t[I].quantizationIdx],delete t[I].quantizationIdx}for(var g=A[0],n=g.components,a=g.componentsOrder,o=[],B=g.samplesPerLine,C=g.scanLines,Q=0;Q<a.length;Q++){var E=n[a[Q]];o.push({lines:L(0,E),scaleX:E.h/g.maxH,scaleY:E.v/g.maxV})}for(var s=new Uint8Array(B*C*o.length),f=0,c=0;c<C;++c)for(var h=0;h<B;++h)for(var l=0;l<o.length;++l){var u=o[l];s[f]=u.lines[0|c*u.scaleY][0|h*u.scaleX],++f}return s}}]),A}(),M=function(A){s(t,w);var e=S(t);function t(A){var i;return B(this,t),(i=e.call(this)).reader=new b,A.JPEGTables&&i.reader.parse(A.JPEGTables),i}return Q(t,[{key:"decodeBlock",value:function(A){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(A)),this.reader.getResult().buffer}}]),t}(),N=Object.freeze({__proto__:null,default:M});function x(A){for(var e=A.length;--e>=0;)A[e]=0}x(new Array(576)),x(new Array(60)),x(new Array(512)),x(new Array(256)),x(new Array(29)),x(new Array(30));var J=function(A,e,t,i){for(var r=65535&A|0,I=A>>>16&65535|0,g=0;0!==t;){t-=g=t>2e3?2e3:t;do{I=I+(r=r+e[i++]|0)|0}while(--g);r%=65521,I%=65521}return r|I<<16|0},q=new Uint32Array(function(){for(var A,e=[],t=0;t<256;t++){A=t;for(var i=0;i<8;i++)A=1&A?3988292384^A>>>1:A>>>1;e[t]=A}return e}()),Y=function(A,e,t,i){var r=q,I=i+t;A^=-1;for(var g=i;g<I;g++)A=A>>>8^r[255&(A^e[g])];return-1^A},K={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},H={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},O=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},P=function(A){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!==t(i))throw new TypeError(i+"must be non-object");for(var r in i)O(i,r)&&(A[r]=i[r])}}return A},T=function(A){for(var e=0,t=0,i=A.length;t<i;t++)e+=A[t].length;for(var r=new Uint8Array(e),I=0,g=0,n=A.length;I<n;I++){var a=A[I];r.set(a,g),g+=a.length}return r},V=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(A){V=!1}for(var _=new Uint8Array(256),X=0;X<256;X++)_[X]=X>=252?6:X>=248?5:X>=240?4:X>=224?3:X>=192?2:1;_[254]=_[254]=1;var Z=function(A){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(A);var e,t,i,r,I,g=A.length,n=0;for(r=0;r<g;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<g&&56320==(64512&(i=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(i-56320),r++),n+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(n),I=0,r=0;I<n;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<g&&56320==(64512&(i=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(i-56320),r++),t<128?e[I++]=t:t<2048?(e[I++]=192|t>>>6,e[I++]=128|63&t):t<65536?(e[I++]=224|t>>>12,e[I++]=128|t>>>6&63,e[I++]=128|63&t):(e[I++]=240|t>>>18,e[I++]=128|t>>>12&63,e[I++]=128|t>>>6&63,e[I++]=128|63&t);return e},j=function(A,e){var t,i,r=e||A.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(A.subarray(0,e));var I=new Array(2*r);for(i=0,t=0;t<r;){var g=A[t++];if(g<128)I[i++]=g;else{var n=_[g];if(n>4)I[i++]=65533,t+=n-1;else{for(g&=2===n?31:3===n?15:7;n>1&&t<r;)g=g<<6|63&A[t++],n--;n>1?I[i++]=65533:g<65536?I[i++]=g:(g-=65536,I[i++]=55296|g>>10&1023,I[i++]=56320|1023&g)}}}return function(A,e){if(e<65534&&A.subarray&&V)return String.fromCharCode.apply(null,A.length===e?A:A.subarray(0,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(A[i]);return t}(I,i)},W=function(A,e){(e=e||A.length)>A.length&&(e=A.length);for(var t=e-1;t>=0&&128==(192&A[t]);)t--;return t<0||0===t?e:t+_[A[t]]>e?t:e};var z=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},$=function(A,e){var t,i,r,I,g,n,a,o,B,C,Q,E,s,f,c,h,l,u,w,d,D,y,k,p,m=A.state;t=A.next_in,k=A.input,i=t+(A.avail_in-5),r=A.next_out,p=A.output,I=r-(e-A.avail_out),g=r+(A.avail_out-257),n=m.dmax,a=m.wsize,o=m.whave,B=m.wnext,C=m.window,Q=m.hold,E=m.bits,s=m.lencode,f=m.distcode,c=(1<<m.lenbits)-1,h=(1<<m.distbits)-1;A:do{E<15&&(Q+=k[t++]<<E,E+=8,Q+=k[t++]<<E,E+=8),l=s[Q&c];e:for(;;){if(Q>>>=u=l>>>24,E-=u,0===(u=l>>>16&255))p[r++]=65535&l;else{if(!(16&u)){if(0==(64&u)){l=s[(65535&l)+(Q&(1<<u)-1)];continue e}if(32&u){m.mode=12;break A}A.msg="invalid literal/length code",m.mode=30;break A}w=65535&l,(u&=15)&&(E<u&&(Q+=k[t++]<<E,E+=8),w+=Q&(1<<u)-1,Q>>>=u,E-=u),E<15&&(Q+=k[t++]<<E,E+=8,Q+=k[t++]<<E,E+=8),l=f[Q&h];t:for(;;){if(Q>>>=u=l>>>24,E-=u,!(16&(u=l>>>16&255))){if(0==(64&u)){l=f[(65535&l)+(Q&(1<<u)-1)];continue t}A.msg="invalid distance code",m.mode=30;break A}if(d=65535&l,E<(u&=15)&&(Q+=k[t++]<<E,(E+=8)<u&&(Q+=k[t++]<<E,E+=8)),(d+=Q&(1<<u)-1)>n){A.msg="invalid distance too far back",m.mode=30;break A}if(Q>>>=u,E-=u,d>(u=r-I)){if((u=d-u)>o&&m.sane){A.msg="invalid distance too far back",m.mode=30;break A}if(D=0,y=C,0===B){if(D+=a-u,u<w){w-=u;do{p[r++]=C[D++]}while(--u);D=r-d,y=p}}else if(B<u){if(D+=a+B-u,(u-=B)<w){w-=u;do{p[r++]=C[D++]}while(--u);if(D=0,B<w){w-=u=B;do{p[r++]=C[D++]}while(--u);D=r-d,y=p}}}else if(D+=B-u,u<w){w-=u;do{p[r++]=C[D++]}while(--u);D=r-d,y=p}for(;w>2;)p[r++]=y[D++],p[r++]=y[D++],p[r++]=y[D++],w-=3;w&&(p[r++]=y[D++],w>1&&(p[r++]=y[D++]))}else{D=r-d;do{p[r++]=p[D++],p[r++]=p[D++],p[r++]=p[D++],w-=3}while(w>2);w&&(p[r++]=p[D++],w>1&&(p[r++]=p[D++]))}break}}break}}while(t<i&&r<g);t-=w=E>>3,Q&=(1<<(E-=w<<3))-1,A.next_in=t,A.next_out=r,A.avail_in=t<i?i-t+5:5-(t-i),A.avail_out=r<g?g-r+257:257-(r-g),m.hold=Q,m.bits=E},AA=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eA=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tA=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),iA=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),rA=function(A,e,t,i,r,I,g,n){var a,o,B,C,Q,E,s,f,c,h=n.bits,l=0,u=0,w=0,d=0,D=0,y=0,k=0,p=0,m=0,G=0,F=null,S=0,v=new Uint16Array(16),R=new Uint16Array(16),U=null,L=0;for(l=0;l<=15;l++)v[l]=0;for(u=0;u<i;u++)v[e[t+u]]++;for(D=h,d=15;d>=1&&0===v[d];d--);if(D>d&&(D=d),0===d)return r[I++]=20971520,r[I++]=20971520,n.bits=1,0;for(w=1;w<d&&0===v[w];w++);for(D<w&&(D=w),p=1,l=1;l<=15;l++)if(p<<=1,(p-=v[l])<0)return-1;if(p>0&&(0===A||1!==d))return-1;for(R[1]=0,l=1;l<15;l++)R[l+1]=R[l]+v[l];for(u=0;u<i;u++)0!==e[t+u]&&(g[R[e[t+u]]++]=u);if(0===A?(F=U=g,E=19):1===A?(F=AA,S-=257,U=eA,L-=257,E=256):(F=tA,U=iA,E=-1),G=0,u=0,l=w,Q=I,y=D,k=0,B=-1,C=(m=1<<D)-1,1===A&&m>852||2===A&&m>592)return 1;for(;;){s=l-k,g[u]<E?(f=0,c=g[u]):g[u]>E?(f=U[L+g[u]],c=F[S+g[u]]):(f=96,c=0),a=1<<l-k,w=o=1<<y;do{r[Q+(G>>k)+(o-=a)]=s<<24|f<<16|c|0}while(0!==o);for(a=1<<l-1;G&a;)a>>=1;if(0!==a?(G&=a-1,G+=a):G=0,u++,0==--v[l]){if(l===d)break;l=e[t+g[u]]}if(l>D&&(G&C)!==B){for(0===k&&(k=D),Q+=w,p=1<<(y=l-k);y+k<d&&!((p-=v[y+k])<=0);)y++,p<<=1;if(m+=1<<y,1===A&&m>852||2===A&&m>592)return 1;r[B=G&C]=D<<24|y<<16|Q-I|0}}return 0!==G&&(r[Q+G]=l-k<<24|64<<16|0),n.bits=D,0},IA=H.Z_FINISH,gA=H.Z_BLOCK,nA=H.Z_TREES,aA=H.Z_OK,oA=H.Z_STREAM_END,BA=H.Z_NEED_DICT,CA=H.Z_STREAM_ERROR,QA=H.Z_DATA_ERROR,EA=H.Z_MEM_ERROR,sA=H.Z_BUF_ERROR,fA=H.Z_DEFLATED,cA=function(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)};function hA(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var lA,uA,wA=function(A){if(!A||!A.state)return CA;var e=A.state;return A.total_in=A.total_out=e.total=0,A.msg="",e.wrap&&(A.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,aA},dA=function(A){if(!A||!A.state)return CA;var e=A.state;return e.wsize=0,e.whave=0,e.wnext=0,wA(A)},DA=function(A,e){var t;if(!A||!A.state)return CA;var i=A.state;return e<0?(t=0,e=-e):(t=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?CA:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,dA(A))},yA=function(A,e){if(!A)return CA;var t=new hA;A.state=t,t.window=null;var i=DA(A,e);return i!==aA&&(A.state=null),i},kA=!0,pA=function(A){if(kA){lA=new Int32Array(512),uA=new Int32Array(32);for(var e=0;e<144;)A.lens[e++]=8;for(;e<256;)A.lens[e++]=9;for(;e<280;)A.lens[e++]=7;for(;e<288;)A.lens[e++]=8;for(rA(1,A.lens,0,288,lA,0,A.work,{bits:9}),e=0;e<32;)A.lens[e++]=5;rA(2,A.lens,0,32,uA,0,A.work,{bits:5}),kA=!1}A.lencode=lA,A.lenbits=9,A.distcode=uA,A.distbits=5},mA=function(A,e,t,i){var r,I=A.state;return null===I.window&&(I.wsize=1<<I.wbits,I.wnext=0,I.whave=0,I.window=new Uint8Array(I.wsize)),i>=I.wsize?(I.window.set(e.subarray(t-I.wsize,t),0),I.wnext=0,I.whave=I.wsize):((r=I.wsize-I.wnext)>i&&(r=i),I.window.set(e.subarray(t-i,t-i+r),I.wnext),(i-=r)?(I.window.set(e.subarray(t-i,t),0),I.wnext=i,I.whave=I.wsize):(I.wnext+=r,I.wnext===I.wsize&&(I.wnext=0),I.whave<I.wsize&&(I.whave+=r))),0},GA={inflateReset:dA,inflateReset2:DA,inflateResetKeep:wA,inflateInit:function(A){return yA(A,15)},inflateInit2:yA,inflate:function(A,e){var t,i,r,I,g,n,a,o,B,C,Q,E,s,f,c,h,l,u,w,d,D,y,k,p,m=0,G=new Uint8Array(4),F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!A||!A.state||!A.output||!A.input&&0!==A.avail_in)return CA;12===(t=A.state).mode&&(t.mode=13),g=A.next_out,r=A.output,a=A.avail_out,I=A.next_in,i=A.input,n=A.avail_in,o=t.hold,B=t.bits,C=n,Q=a,y=aA;A:for(;;)switch(t.mode){case 1:if(0===t.wrap){t.mode=13;break}for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(2&t.wrap&&35615===o){t.check=0,G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0),o=0,B=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&o)<<8)+(o>>8))%31){A.msg="incorrect header check",t.mode=30;break}if((15&o)!==fA){A.msg="unknown compression method",t.mode=30;break}if(B-=4,D=8+(15&(o>>>=4)),0===t.wbits)t.wbits=D;else if(D>t.wbits){A.msg="invalid window size",t.mode=30;break}t.dmax=1<<t.wbits,A.adler=t.check=1,t.mode=512&o?10:12,o=0,B=0;break;case 2:for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(t.flags=o,(255&t.flags)!==fA){A.msg="unknown compression method",t.mode=30;break}if(57344&t.flags){A.msg="unknown header flags set",t.mode=30;break}t.head&&(t.head.text=o>>8&1),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0)),o=0,B=0,t.mode=3;case 3:for(;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.head&&(t.head.time=o),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,G[2]=o>>>16&255,G[3]=o>>>24&255,t.check=Y(t.check,G,4,0)),o=0,B=0,t.mode=4;case 4:for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.head&&(t.head.xflags=255&o,t.head.os=o>>8),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0)),o=0,B=0,t.mode=5;case 5:if(1024&t.flags){for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.length=o,t.head&&(t.head.extra_len=o),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0)),o=0,B=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&((E=t.length)>n&&(E=n),E&&(t.head&&(D=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(I,I+E),D)),512&t.flags&&(t.check=Y(t.check,i,E,I)),n-=E,I+=E,t.length-=E),t.length))break A;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(0===n)break A;E=0;do{D=i[I+E++],t.head&&D&&t.length<65536&&(t.head.name+=String.fromCharCode(D))}while(D&&E<n);if(512&t.flags&&(t.check=Y(t.check,i,E,I)),n-=E,I+=E,D)break A}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(0===n)break A;E=0;do{D=i[I+E++],t.head&&D&&t.length<65536&&(t.head.comment+=String.fromCharCode(D))}while(D&&E<n);if(512&t.flags&&(t.check=Y(t.check,i,E,I)),n-=E,I+=E,D)break A}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(o!==(65535&t.check)){A.msg="header crc mismatch",t.mode=30;break}o=0,B=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),A.adler=t.check=0,t.mode=12;break;case 10:for(;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}A.adler=t.check=cA(o),o=0,B=0,t.mode=11;case 11:if(0===t.havedict)return A.next_out=g,A.avail_out=a,A.next_in=I,A.avail_in=n,t.hold=o,t.bits=B,BA;A.adler=t.check=1,t.mode=12;case 12:if(e===gA||e===nA)break A;case 13:if(t.last){o>>>=7&B,B-=7&B,t.mode=27;break}for(;B<3;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}switch(t.last=1&o,B-=1,3&(o>>>=1)){case 0:t.mode=14;break;case 1:if(pA(t),t.mode=20,e===nA){o>>>=2,B-=2;break A}break;case 2:t.mode=17;break;case 3:A.msg="invalid block type",t.mode=30}o>>>=2,B-=2;break;case 14:for(o>>>=7&B,B-=7&B;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if((65535&o)!=(o>>>16^65535)){A.msg="invalid stored block lengths",t.mode=30;break}if(t.length=65535&o,o=0,B=0,t.mode=15,e===nA)break A;case 15:t.mode=16;case 16:if(E=t.length){if(E>n&&(E=n),E>a&&(E=a),0===E)break A;r.set(i.subarray(I,I+E),g),n-=E,I+=E,a-=E,g+=E,t.length-=E;break}t.mode=12;break;case 17:for(;B<14;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(t.nlen=257+(31&o),o>>>=5,B-=5,t.ndist=1+(31&o),o>>>=5,B-=5,t.ncode=4+(15&o),o>>>=4,B-=4,t.nlen>286||t.ndist>30){A.msg="too many length or distance symbols",t.mode=30;break}t.have=0,t.mode=18;case 18:for(;t.have<t.ncode;){for(;B<3;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.lens[F[t.have++]]=7&o,o>>>=3,B-=3}for(;t.have<19;)t.lens[F[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,k={bits:t.lenbits},y=rA(0,t.lens,0,19,t.lencode,0,t.work,k),t.lenbits=k.bits,y){A.msg="invalid code lengths set",t.mode=30;break}t.have=0,t.mode=19;case 19:for(;t.have<t.nlen+t.ndist;){for(;h=(m=t.lencode[o&(1<<t.lenbits)-1])>>>16&255,l=65535&m,!((c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(l<16)o>>>=c,B-=c,t.lens[t.have++]=l;else{if(16===l){for(p=c+2;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(o>>>=c,B-=c,0===t.have){A.msg="invalid bit length repeat",t.mode=30;break}D=t.lens[t.have-1],E=3+(3&o),o>>>=2,B-=2}else if(17===l){for(p=c+3;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}B-=c,D=0,E=3+(7&(o>>>=c)),o>>>=3,B-=3}else{for(p=c+7;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}B-=c,D=0,E=11+(127&(o>>>=c)),o>>>=7,B-=7}if(t.have+E>t.nlen+t.ndist){A.msg="invalid bit length repeat",t.mode=30;break}for(;E--;)t.lens[t.have++]=D}}if(30===t.mode)break;if(0===t.lens[256]){A.msg="invalid code -- missing end-of-block",t.mode=30;break}if(t.lenbits=9,k={bits:t.lenbits},y=rA(1,t.lens,0,t.nlen,t.lencode,0,t.work,k),t.lenbits=k.bits,y){A.msg="invalid literal/lengths set",t.mode=30;break}if(t.distbits=6,t.distcode=t.distdyn,k={bits:t.distbits},y=rA(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,k),t.distbits=k.bits,y){A.msg="invalid distances set",t.mode=30;break}if(t.mode=20,e===nA)break A;case 20:t.mode=21;case 21:if(n>=6&&a>=258){A.next_out=g,A.avail_out=a,A.next_in=I,A.avail_in=n,t.hold=o,t.bits=B,$(A,Q),g=A.next_out,r=A.output,a=A.avail_out,I=A.next_in,i=A.input,n=A.avail_in,o=t.hold,B=t.bits,12===t.mode&&(t.back=-1);break}for(t.back=0;h=(m=t.lencode[o&(1<<t.lenbits)-1])>>>16&255,l=65535&m,!((c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(h&&0==(240&h)){for(u=c,w=h,d=l;h=(m=t.lencode[d+((o&(1<<u+w)-1)>>u)])>>>16&255,l=65535&m,!(u+(c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}o>>>=u,B-=u,t.back+=u}if(o>>>=c,B-=c,t.back+=c,t.length=l,0===h){t.mode=26;break}if(32&h){t.back=-1,t.mode=12;break}if(64&h){A.msg="invalid literal/length code",t.mode=30;break}t.extra=15&h,t.mode=22;case 22:if(t.extra){for(p=t.extra;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.length+=o&(1<<t.extra)-1,o>>>=t.extra,B-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=23;case 23:for(;h=(m=t.distcode[o&(1<<t.distbits)-1])>>>16&255,l=65535&m,!((c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(0==(240&h)){for(u=c,w=h,d=l;h=(m=t.distcode[d+((o&(1<<u+w)-1)>>u)])>>>16&255,l=65535&m,!(u+(c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}o>>>=u,B-=u,t.back+=u}if(o>>>=c,B-=c,t.back+=c,64&h){A.msg="invalid distance code",t.mode=30;break}t.offset=l,t.extra=15&h,t.mode=24;case 24:if(t.extra){for(p=t.extra;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.offset+=o&(1<<t.extra)-1,o>>>=t.extra,B-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){A.msg="invalid distance too far back",t.mode=30;break}t.mode=25;case 25:if(0===a)break A;if(E=Q-a,t.offset>E){if((E=t.offset-E)>t.whave&&t.sane){A.msg="invalid distance too far back",t.mode=30;break}E>t.wnext?(E-=t.wnext,s=t.wsize-E):s=t.wnext-E,E>t.length&&(E=t.length),f=t.window}else f=r,s=g-t.offset,E=t.length;E>a&&(E=a),a-=E,t.length-=E;do{r[g++]=f[s++]}while(--E);0===t.length&&(t.mode=21);break;case 26:if(0===a)break A;r[g++]=t.length,a--,t.mode=21;break;case 27:if(t.wrap){for(;B<32;){if(0===n)break A;n--,o|=i[I++]<<B,B+=8}if(Q-=a,A.total_out+=Q,t.total+=Q,Q&&(A.adler=t.check=t.flags?Y(t.check,r,Q,g-Q):J(t.check,r,Q,g-Q)),Q=a,(t.flags?o:cA(o))!==t.check){A.msg="incorrect data check",t.mode=30;break}o=0,B=0}t.mode=28;case 28:if(t.wrap&&t.flags){for(;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(o!==(4294967295&t.total)){A.msg="incorrect length check",t.mode=30;break}o=0,B=0}t.mode=29;case 29:y=oA;break A;case 30:y=QA;break A;case 31:return EA;default:return CA}return A.next_out=g,A.avail_out=a,A.next_in=I,A.avail_in=n,t.hold=o,t.bits=B,(t.wsize||Q!==A.avail_out&&t.mode<30&&(t.mode<27||e!==IA))&&mA(A,A.output,A.next_out,Q-A.avail_out),C-=A.avail_in,Q-=A.avail_out,A.total_in+=C,A.total_out+=Q,t.total+=Q,t.wrap&&Q&&(A.adler=t.check=t.flags?Y(t.check,r,Q,A.next_out-Q):J(t.check,r,Q,A.next_out-Q)),A.data_type=t.bits+(t.last?64:0)+(12===t.mode?128:0)+(20===t.mode||15===t.mode?256:0),(0===C&&0===Q||e===IA)&&y===aA&&(y=sA),y},inflateEnd:function(A){if(!A||!A.state)return CA;var e=A.state;return e.window&&(e.window=null),A.state=null,aA},inflateGetHeader:function(A,e){if(!A||!A.state)return CA;var t=A.state;return 0==(2&t.wrap)?CA:(t.head=e,e.done=!1,aA)},inflateSetDictionary:function(A,e){var t,i=e.length;return A&&A.state?0!==(t=A.state).wrap&&11!==t.mode?CA:11===t.mode&&J(1,e,i,0)!==t.check?QA:mA(A,e,i,i)?(t.mode=31,EA):(t.havedict=1,aA):CA},inflateInfo:"pako inflate (from Nodeca project)"};var FA=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},SA=Object.prototype.toString,vA=H.Z_NO_FLUSH,RA=H.Z_FINISH,UA=H.Z_OK,LA=H.Z_STREAM_END,bA=H.Z_NEED_DICT,MA=H.Z_STREAM_ERROR,NA=H.Z_DATA_ERROR,xA=H.Z_MEM_ERROR;function JA(A){this.options=P({chunkSize:65536,windowBits:15,to:""},A||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||A&&A.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new z,this.strm.avail_out=0;var t=GA.inflateInit2(this.strm,e.windowBits);if(t!==UA)throw new Error(K[t]);if(this.header=new FA,GA.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Z(e.dictionary):"[object ArrayBuffer]"===SA.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=GA.inflateSetDictionary(this.strm,e.dictionary))!==UA))throw new Error(K[t])}function qA(A,e){var t=new JA(e);if(t.push(A),t.err)throw t.msg||K[t.err];return t.result}JA.prototype.push=function(A,e){var t,i,r,I=this.strm,g=this.options.chunkSize,n=this.options.dictionary;if(this.ended)return!1;for(i=e===~~e?e:!0===e?RA:vA,"[object ArrayBuffer]"===SA.call(A)?I.input=new Uint8Array(A):I.input=A,I.next_in=0,I.avail_in=I.input.length;;){for(0===I.avail_out&&(I.output=new Uint8Array(g),I.next_out=0,I.avail_out=g),(t=GA.inflate(I,i))===bA&&n&&((t=GA.inflateSetDictionary(I,n))===UA?t=GA.inflate(I,i):t===NA&&(t=bA));I.avail_in>0&&t===LA&&I.state.wrap>0&&0!==A[I.next_in];)GA.inflateReset(I),t=GA.inflate(I,i);switch(t){case MA:case NA:case bA:case xA:return this.onEnd(t),this.ended=!0,!1}if(r=I.avail_out,I.next_out&&(0===I.avail_out||t===LA))if("string"===this.options.to){var a=W(I.output,I.next_out),o=I.next_out-a,B=j(I.output,a);I.next_out=o,I.avail_out=g-o,o&&I.output.set(I.output.subarray(a,a+o),0),this.onData(B)}else this.onData(I.output.length===I.next_out?I.output:I.output.subarray(0,I.next_out));if(t!==UA||0!==r){if(t===LA)return t=GA.inflateEnd(this.strm),this.onEnd(t),this.ended=!0,!0;if(0===I.avail_in)break}}return!0},JA.prototype.onData=function(A){this.chunks.push(A)},JA.prototype.onEnd=function(A){A===UA&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=T(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};var YA={Inflate:JA,inflate:qA,inflateRaw:function(A,e){return(e=e||{}).raw=!0,qA(A,e)},ungzip:qA,constants:H}.inflate;function KA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var HA=function(A){s(t,w);var e=KA(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){return YA(new Uint8Array(A)).buffer}}]),t}(),OA=Object.freeze({__proto__:null,default:HA});function PA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var TA,VA=function(A){s(t,w);var e=PA(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){for(var e=new DataView(A),t=[],i=0;i<A.byteLength;++i){var r=e.getInt8(i);if(r<0){var I=e.getUint8(i+1);r=-r;for(var g=0;g<=r;++g)t.push(I);i+=1}else{for(var n=0;n<=r;++n)t.push(e.getUint8(i+n+1));i+=r+1}}return new Uint8Array(t).buffer}}]),t}(),_A=Object.freeze({__proto__:null,default:VA}),XA={exports:{}};TA=XA,\n/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */\nfunction(){var A,e,t,i,r,I,g,n,a,o,B,C,Q,E,s,f,c=(A={defaultNoDataValue:-34027999387901484e22,decode:function(I,g){var n=(g=g||{}).encodedMaskData||null===g.encodedMaskData,a=r(I,g.inputOffset||0,n),o=null!==g.noDataValue?g.noDataValue:A.defaultNoDataValue,B=e(a,g.pixelType||Float32Array,g.encodedMaskData,o,g.returnMask),C={width:a.width,height:a.height,pixelData:B.resultPixels,minValue:B.minValue,maxValue:a.pixels.maxValue,noDataValue:o};return B.resultMask&&(C.maskData=B.resultMask),g.returnEncodedMask&&a.mask&&(C.encodedMaskData=a.mask.bitset?a.mask.bitset:null),g.returnFileInfo&&(C.fileInfo=t(a),g.computeUsedBitDepths&&(C.fileInfo.bitDepths=i(a))),C}},e=function(A,e,t,i,r){var g,n,a,o=0,B=A.pixels.numBlocksX,C=A.pixels.numBlocksY,Q=Math.floor(A.width/B),E=Math.floor(A.height/C),s=2*A.maxZError,f=Number.MAX_VALUE;t=t||(A.mask?A.mask.bitset:null),n=new e(A.width*A.height),r&&t&&(a=new Uint8Array(A.width*A.height));for(var c,h,l=new Float32Array(Q*E),u=0;u<=C;u++){var w=u!==C?E:A.height%C;if(0!==w)for(var d=0;d<=B;d++){var D=d!==B?Q:A.width%B;if(0!==D){var y,k,p,m,G=u*A.width*E+d*Q,F=A.width-D,S=A.pixels.blocks[o];if(S.encoding<2?(0===S.encoding?y=S.rawData:(I(S.stuffedData,S.bitsPerPixel,S.numValidPixels,S.offset,s,l,A.pixels.maxValue),y=l),k=0):p=2===S.encoding?0:S.offset,t)for(h=0;h<w;h++){for(7&G&&(m=t[G>>3],m<<=7&G),c=0;c<D;c++)7&G||(m=t[G>>3]),128&m?(a&&(a[G]=1),f=f>(g=S.encoding<2?y[k++]:p)?g:f,n[G++]=g):(a&&(a[G]=0),n[G++]=i),m<<=1;G+=F}else if(S.encoding<2)for(h=0;h<w;h++){for(c=0;c<D;c++)f=f>(g=y[k++])?g:f,n[G++]=g;G+=F}else for(f=f>p?p:f,h=0;h<w;h++){for(c=0;c<D;c++)n[G++]=p;G+=F}if(1===S.encoding&&k!==S.numValidPixels)throw"Block and Mask do not match";o++}}}return{resultPixels:n,resultMask:a,minValue:f}},t=function(A){return{fileIdentifierString:A.fileIdentifierString,fileVersion:A.fileVersion,imageType:A.imageType,height:A.height,width:A.width,maxZError:A.maxZError,eofOffset:A.eofOffset,mask:A.mask?{numBlocksX:A.mask.numBlocksX,numBlocksY:A.mask.numBlocksY,numBytes:A.mask.numBytes,maxValue:A.mask.maxValue}:null,pixels:{numBlocksX:A.pixels.numBlocksX,numBlocksY:A.pixels.numBlocksY,numBytes:A.pixels.numBytes,maxValue:A.pixels.maxValue,noDataValue:A.noDataValue}}},i=function(A){for(var e=A.pixels.numBlocksX*A.pixels.numBlocksY,t={},i=0;i<e;i++){var r=A.pixels.blocks[i];0===r.encoding?t.float32=!0:1===r.encoding?t[r.bitsPerPixel]=!0:t[0]=!0}return Object.keys(t)},r=function(A,e,t){var i={},r=new Uint8Array(A,e,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,r),"CntZImage"!==i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;e+=10;var I=new DataView(A,e,24);if(i.fileVersion=I.getInt32(0,!0),i.imageType=I.getInt32(4,!0),i.height=I.getUint32(8,!0),i.width=I.getUint32(12,!0),i.maxZError=I.getFloat64(16,!0),e+=24,!t)if(I=new DataView(A,e,16),i.mask={},i.mask.numBlocksY=I.getUint32(0,!0),i.mask.numBlocksX=I.getUint32(4,!0),i.mask.numBytes=I.getUint32(8,!0),i.mask.maxValue=I.getFloat32(12,!0),e+=16,i.mask.numBytes>0){var g=new Uint8Array(Math.ceil(i.width*i.height/8)),n=(I=new DataView(A,e,i.mask.numBytes)).getInt16(0,!0),a=2,o=0;do{if(n>0)for(;n--;)g[o++]=I.getUint8(a++);else{var B=I.getUint8(a++);for(n=-n;n--;)g[o++]=B}n=I.getInt16(a,!0),a+=2}while(a<i.mask.numBytes);if(-32768!==n||o<g.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=g,e+=i.mask.numBytes}else 0==(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)&&(i.mask.bitset=new Uint8Array(Math.ceil(i.width*i.height/8)));I=new DataView(A,e,16),i.pixels={},i.pixels.numBlocksY=I.getUint32(0,!0),i.pixels.numBlocksX=I.getUint32(4,!0),i.pixels.numBytes=I.getUint32(8,!0),i.pixels.maxValue=I.getFloat32(12,!0),e+=16;var C=i.pixels.numBlocksX,Q=i.pixels.numBlocksY,E=C+(i.width%C>0?1:0),s=Q+(i.height%Q>0?1:0);i.pixels.blocks=new Array(E*s);for(var f=0,c=0;c<s;c++)for(var h=0;h<E;h++){var l=0,u=A.byteLength-e;I=new DataView(A,e,Math.min(10,u));var w={};i.pixels.blocks[f++]=w;var d=I.getUint8(0);if(l++,w.encoding=63&d,w.encoding>3)throw"Invalid block encoding ("+w.encoding+")";if(2!==w.encoding){if(0!==d&&2!==d){if(d>>=6,w.offsetType=d,2===d)w.offset=I.getInt8(1),l++;else if(1===d)w.offset=I.getInt16(1,!0),l+=2;else{if(0!==d)throw"Invalid block offset type";w.offset=I.getFloat32(1,!0),l+=4}if(1===w.encoding)if(d=I.getUint8(l),l++,w.bitsPerPixel=63&d,d>>=6,w.numValidPixelsType=d,2===d)w.numValidPixels=I.getUint8(l),l++;else if(1===d)w.numValidPixels=I.getUint16(l,!0),l+=2;else{if(0!==d)throw"Invalid valid pixel count type";w.numValidPixels=I.getUint32(l,!0),l+=4}}var D;if(e+=l,3!==w.encoding)if(0===w.encoding){var y=(i.pixels.numBytes-1)/4;if(y!==Math.floor(y))throw"uncompressed block has invalid length";D=new ArrayBuffer(4*y),new Uint8Array(D).set(new Uint8Array(A,e,4*y));var k=new Float32Array(D);w.rawData=k,e+=4*y}else if(1===w.encoding){var p=Math.ceil(w.numValidPixels*w.bitsPerPixel/8),m=Math.ceil(p/4);D=new ArrayBuffer(4*m),new Uint8Array(D).set(new Uint8Array(A,e,p)),w.stuffedData=new Uint32Array(D),e+=p}}else e++}return i.eofOffset=e,i},I=function(A,e,t,i,r,I,g){var n,a,o,B=(1<<e)-1,C=0,Q=0,E=Math.ceil((g-i)/r),s=4*A.length-Math.ceil(e*t/8);for(A[A.length-1]<<=8*s,n=0;n<t;n++){if(0===Q&&(o=A[C++],Q=32),Q>=e)a=o>>>Q-e&B,Q-=e;else{var f=e-Q;a=(o&B)<<f&B,a+=(o=A[C++])>>>(Q=32-f)}I[n]=a<E?i+a*r:g}return I},A),h=(g=function(A,e,t,i,r,I,g,n){var a,o,B,C,Q,E=(1<<t)-1,s=0,f=0,c=4*A.length-Math.ceil(t*i/8);if(A[A.length-1]<<=8*c,r)for(a=0;a<i;a++)0===f&&(B=A[s++],f=32),f>=t?(o=B>>>f-t&E,f-=t):(o=(B&E)<<(C=t-f)&E,o+=(B=A[s++])>>>(f=32-C)),e[a]=r[o];else for(Q=Math.ceil((n-I)/g),a=0;a<i;a++)0===f&&(B=A[s++],f=32),f>=t?(o=B>>>f-t&E,f-=t):(o=(B&E)<<(C=t-f)&E,o+=(B=A[s++])>>>(f=32-C)),e[a]=o<Q?I+o*g:n},n=function(A,e,t,i,r,I){var g,n=(1<<e)-1,a=0,o=0,B=0,C=0,Q=0,E=[],s=4*A.length-Math.ceil(e*t/8);A[A.length-1]<<=8*s;var f=Math.ceil((I-i)/r);for(o=0;o<t;o++)0===C&&(g=A[a++],C=32),C>=e?(Q=g>>>C-e&n,C-=e):(Q=(g&n)<<(B=e-C)&n,Q+=(g=A[a++])>>>(C=32-B)),E[o]=Q<f?i+Q*r:I;return E.unshift(i),E},a=function(A,e,t,i,r,I,g,n){var a,o,B,C,Q=(1<<t)-1,E=0,s=0,f=0;if(r)for(a=0;a<i;a++)0===s&&(B=A[E++],s=32,f=0),s>=t?(o=B>>>f&Q,s-=t,f+=t):(o=B>>>f&Q,s=32-(C=t-s),o|=((B=A[E++])&(1<<C)-1)<<t-C,f=C),e[a]=r[o];else{var c=Math.ceil((n-I)/g);for(a=0;a<i;a++)0===s&&(B=A[E++],s=32,f=0),s>=t?(o=B>>>f&Q,s-=t,f+=t):(o=B>>>f&Q,s=32-(C=t-s),o|=((B=A[E++])&(1<<C)-1)<<t-C,f=C),e[a]=o<c?I+o*g:n}return e},o=function(A,e,t,i,r,I){var g,n=(1<<e)-1,a=0,o=0,B=0,C=0,Q=0,E=0,s=[],f=Math.ceil((I-i)/r);for(o=0;o<t;o++)0===C&&(g=A[a++],C=32,E=0),C>=e?(Q=g>>>E&n,C-=e,E+=e):(Q=g>>>E&n,C=32-(B=e-C),Q|=((g=A[a++])&(1<<B)-1)<<e-B,E=B),s[o]=Q<f?i+Q*r:I;return s.unshift(i),s},B=function(A,e,t,i){var r,I,g,n,a=(1<<t)-1,o=0,B=0,C=4*A.length-Math.ceil(t*i/8);for(A[A.length-1]<<=8*C,r=0;r<i;r++)0===B&&(g=A[o++],B=32),B>=t?(I=g>>>B-t&a,B-=t):(I=(g&a)<<(n=t-B)&a,I+=(g=A[o++])>>>(B=32-n)),e[r]=I;return e},C=function(A,e,t,i){var r,I,g,n,a=(1<<t)-1,o=0,B=0,C=0;for(r=0;r<i;r++)0===B&&(g=A[o++],B=32,C=0),B>=t?(I=g>>>C&a,B-=t,C+=t):(I=g>>>C&a,B=32-(n=t-B),I|=((g=A[o++])&(1<<n)-1)<<t-n,C=n),e[r]=I;return e},Q={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(A){for(var e=65535,t=65535,i=A.length,r=Math.floor(i/2),I=0;r;){var g=r>=359?359:r;r-=g;do{e+=A[I++]<<8,t+=e+=A[I++]}while(--g);e=(65535&e)+(e>>>16),t=(65535&t)+(t>>>16)}return 1&i&&(t+=e+=A[I]<<8),((t=(65535&t)+(t>>>16))<<16|(e=(65535&e)+(e>>>16)))>>>0},readHeaderInfo:function(A,e){var t=e.ptr,i=new Uint8Array(A,t,6),r={};if(r.fileIdentifierString=String.fromCharCode.apply(null,i),0!==r.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+r.fileIdentifierString;t+=6;var I,g=new DataView(A,t,8),n=g.getInt32(0,!0);if(r.fileVersion=n,t+=4,n>=3&&(r.checksum=g.getUint32(4,!0),t+=4),g=new DataView(A,t,12),r.height=g.getUint32(0,!0),r.width=g.getUint32(4,!0),t+=8,n>=4?(r.numDims=g.getUint32(8,!0),t+=4):r.numDims=1,g=new DataView(A,t,40),r.numValidPixel=g.getUint32(0,!0),r.microBlockSize=g.getInt32(4,!0),r.blobSize=g.getInt32(8,!0),r.imageType=g.getInt32(12,!0),r.maxZError=g.getFloat64(16,!0),r.zMin=g.getFloat64(24,!0),r.zMax=g.getFloat64(32,!0),t+=40,e.headerInfo=r,e.ptr=t,n>=3&&(I=n>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(A,t-I,r.blobSize-14))!==r.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(A,e){var t=e.headerInfo,i=this.getDataTypeArray(t.imageType),r=t.numDims*this.getDataTypeSize(t.imageType),I=this.readSubArray(A,e.ptr,i,r),g=this.readSubArray(A,e.ptr+r,i,r);e.ptr+=2*r;var n,a=!0;for(n=0;n<t.numDims;n++)if(I[n]!==g[n]){a=!1;break}return t.minValues=I,t.maxValues=g,a},readSubArray:function(A,e,t,i){var r;if(t===Uint8Array)r=new Uint8Array(A,e,i);else{var I=new ArrayBuffer(i);new Uint8Array(I).set(new Uint8Array(A,e,i)),r=new t(I)}return r},readMask:function(A,e){var t,i,r=e.ptr,I=e.headerInfo,g=I.width*I.height,n=I.numValidPixel,a=new DataView(A,r,4),o={};if(o.numBytes=a.getUint32(0,!0),r+=4,(0===n||g===n)&&0!==o.numBytes)throw"invalid mask";if(0===n)t=new Uint8Array(Math.ceil(g/8)),o.bitset=t,i=new Uint8Array(g),e.pixels.resultMask=i,r+=o.numBytes;else if(o.numBytes>0){t=new Uint8Array(Math.ceil(g/8));var B=(a=new DataView(A,r,o.numBytes)).getInt16(0,!0),C=2,Q=0,E=0;do{if(B>0)for(;B--;)t[Q++]=a.getUint8(C++);else for(E=a.getUint8(C++),B=-B;B--;)t[Q++]=E;B=a.getInt16(C,!0),C+=2}while(C<o.numBytes);if(-32768!==B||Q<t.length)throw"Unexpected end of mask RLE encoding";i=new Uint8Array(g);var s=0,f=0;for(f=0;f<g;f++)7&f?(s=t[f>>3],s<<=7&f):s=t[f>>3],128&s&&(i[f]=1);e.pixels.resultMask=i,o.bitset=t,r+=o.numBytes}return e.ptr=r,e.mask=o,!0},readDataOneSweep:function(A,e,t,i){var r,I=e.ptr,g=e.headerInfo,n=g.numDims,a=g.width*g.height,o=g.imageType,B=g.numValidPixel*Q.getDataTypeSize(o)*n,C=e.pixels.resultMask;if(t===Uint8Array)r=new Uint8Array(A,I,B);else{var E=new ArrayBuffer(B);new Uint8Array(E).set(new Uint8Array(A,I,B)),r=new t(E)}if(r.length===a*n)e.pixels.resultPixels=i?Q.swapDimensionOrder(r,a,n,t,!0):r;else{e.pixels.resultPixels=new t(a*n);var s=0,f=0,c=0,h=0;if(n>1){if(i){for(f=0;f<a;f++)if(C[f])for(h=f,c=0;c<n;c++,h+=a)e.pixels.resultPixels[h]=r[s++]}else for(f=0;f<a;f++)if(C[f])for(h=f*n,c=0;c<n;c++)e.pixels.resultPixels[h+c]=r[s++]}else for(f=0;f<a;f++)C[f]&&(e.pixels.resultPixels[f]=r[s++])}return I+=B,e.ptr=I,!0},readHuffmanTree:function(A,e){var t=this.HUFFMAN_LUT_BITS_MAX,i=new DataView(A,e.ptr,16);if(e.ptr+=16,i.getInt32(0,!0)<2)throw"unsupported Huffman version";var r=i.getInt32(4,!0),I=i.getInt32(8,!0),g=i.getInt32(12,!0);if(I>=g)return!1;var n=new Uint32Array(g-I);Q.decodeBits(A,e,n);var a,o,B,C,s=[];for(a=I;a<g;a++)s[o=a-(a<r?0:r)]={first:n[a-I],second:null};var f=A.byteLength-e.ptr,c=Math.ceil(f/4),h=new ArrayBuffer(4*c);new Uint8Array(h).set(new Uint8Array(A,e.ptr,f));var l,u=new Uint32Array(h),w=0,d=0;for(l=u[0],a=I;a<g;a++)(C=s[o=a-(a<r?0:r)].first)>0&&(s[o].second=l<<w>>>32-C,32-w>=C?32===(w+=C)&&(w=0,l=u[++d]):(w+=C-32,l=u[++d],s[o].second|=l>>>32-w));var D=0,y=0,k=new E;for(a=0;a<s.length;a++)void 0!==s[a]&&(D=Math.max(D,s[a].first));y=D>=t?t:D;var p,m,G,F,S,v=[];for(a=I;a<g;a++)if((C=s[o=a-(a<r?0:r)].first)>0)if(p=[C,o],C<=y)for(m=s[o].second<<y-C,G=1<<y-C,B=0;B<G;B++)v[m|B]=p;else for(m=s[o].second,S=k,F=C-1;F>=0;F--)m>>>F&1?(S.right||(S.right=new E),S=S.right):(S.left||(S.left=new E),S=S.left),0!==F||S.val||(S.val=p[1]);return{decodeLut:v,numBitsLUTQick:y,numBitsLUT:D,tree:k,stuffedData:u,srcPtr:d,bitPos:w}},readHuffman:function(A,e,t,i){var r,I,g,n,a,o,B,C,E,s=e.headerInfo.numDims,f=e.headerInfo.height,c=e.headerInfo.width,h=c*f,l=this.readHuffmanTree(A,e),u=l.decodeLut,w=l.tree,d=l.stuffedData,D=l.srcPtr,y=l.bitPos,k=l.numBitsLUTQick,p=l.numBitsLUT,m=0===e.headerInfo.imageType?128:0,G=e.pixels.resultMask,F=0;y>0&&(D++,y=0);var S,v=d[D],R=1===e.encodeMode,U=new t(h*s),L=U;if(s<2||R){for(S=0;S<s;S++)if(s>1&&(L=new t(U.buffer,h*S,h),F=0),e.headerInfo.numValidPixel===c*f)for(C=0,o=0;o<f;o++)for(B=0;B<c;B++,C++){if(I=0,a=n=v<<y>>>32-k,32-y<k&&(a=n|=d[D+1]>>>64-y-k),u[a])I=u[a][1],y+=u[a][0];else for(a=n=v<<y>>>32-p,32-y<p&&(a=n|=d[D+1]>>>64-y-p),r=w,E=0;E<p;E++)if(!(r=n>>>p-E-1&1?r.right:r.left).left&&!r.right){I=r.val,y=y+E+1;break}y>=32&&(y-=32,v=d[++D]),g=I-m,R?(g+=B>0?F:o>0?L[C-c]:F,g&=255,L[C]=g,F=g):L[C]=g}else for(C=0,o=0;o<f;o++)for(B=0;B<c;B++,C++)if(G[C]){if(I=0,a=n=v<<y>>>32-k,32-y<k&&(a=n|=d[D+1]>>>64-y-k),u[a])I=u[a][1],y+=u[a][0];else for(a=n=v<<y>>>32-p,32-y<p&&(a=n|=d[D+1]>>>64-y-p),r=w,E=0;E<p;E++)if(!(r=n>>>p-E-1&1?r.right:r.left).left&&!r.right){I=r.val,y=y+E+1;break}y>=32&&(y-=32,v=d[++D]),g=I-m,R?(B>0&&G[C-1]?g+=F:o>0&&G[C-c]?g+=L[C-c]:g+=F,g&=255,L[C]=g,F=g):L[C]=g}}else for(C=0,o=0;o<f;o++)for(B=0;B<c;B++)if(C=o*c+B,!G||G[C])for(S=0;S<s;S++,C+=h){if(I=0,a=n=v<<y>>>32-k,32-y<k&&(a=n|=d[D+1]>>>64-y-k),u[a])I=u[a][1],y+=u[a][0];else for(a=n=v<<y>>>32-p,32-y<p&&(a=n|=d[D+1]>>>64-y-p),r=w,E=0;E<p;E++)if(!(r=n>>>p-E-1&1?r.right:r.left).left&&!r.right){I=r.val,y=y+E+1;break}y>=32&&(y-=32,v=d[++D]),g=I-m,L[C]=g}e.ptr=e.ptr+4*(D+1)+(y>0?4:0),e.pixels.resultPixels=U,s>1&&!i&&(e.pixels.resultPixels=Q.swapDimensionOrder(U,h,s,t))},decodeBits:function(A,e,t,i,r){var I=e.headerInfo,Q=I.fileVersion,E=0,s=A.byteLength-e.ptr>=5?5:A.byteLength-e.ptr,f=new DataView(A,e.ptr,s),c=f.getUint8(0);E++;var h=c>>6,l=0===h?4:3-h,u=(32&c)>0,w=31&c,d=0;if(1===l)d=f.getUint8(E),E++;else if(2===l)d=f.getUint16(E,!0),E+=2;else{if(4!==l)throw"Invalid valid pixel count type";d=f.getUint32(E,!0),E+=4}var D,y,k,p,m,G,F,S,v,R=2*I.maxZError,U=I.numDims>1?I.maxValues[r]:I.zMax;if(u){for(e.counter.lut++,S=f.getUint8(E),E++,p=Math.ceil((S-1)*w/8),m=Math.ceil(p/4),y=new ArrayBuffer(4*m),k=new Uint8Array(y),e.ptr+=E,k.set(new Uint8Array(A,e.ptr,p)),F=new Uint32Array(y),e.ptr+=p,v=0;S-1>>>v;)v++;p=Math.ceil(d*v/8),m=Math.ceil(p/4),y=new ArrayBuffer(4*m),(k=new Uint8Array(y)).set(new Uint8Array(A,e.ptr,p)),D=new Uint32Array(y),e.ptr+=p,G=Q>=3?o(F,w,S-1,i,R,U):n(F,w,S-1,i,R,U),Q>=3?a(D,t,v,d,G):g(D,t,v,d,G)}else e.counter.bitstuffer++,v=w,e.ptr+=E,v>0&&(p=Math.ceil(d*v/8),m=Math.ceil(p/4),y=new ArrayBuffer(4*m),(k=new Uint8Array(y)).set(new Uint8Array(A,e.ptr,p)),D=new Uint32Array(y),e.ptr+=p,Q>=3?null==i?C(D,t,v,d):a(D,t,v,d,!1,i,R,U):null==i?B(D,t,v,d):g(D,t,v,d,!1,i,R,U))},readTiles:function(A,e,t,i){var r=e.headerInfo,I=r.width,g=r.height,n=I*g,a=r.microBlockSize,o=r.imageType,B=Q.getDataTypeSize(o),C=Math.ceil(I/a),E=Math.ceil(g/a);e.pixels.numBlocksY=E,e.pixels.numBlocksX=C,e.pixels.ptr=0;var s,f,c,h,l,u,w,d,D,y,k=0,p=0,m=0,G=0,F=0,S=0,v=0,R=0,U=0,L=0,b=0,M=0,N=0,x=0,J=0,q=new t(a*a),Y=g%a||a,K=I%a||a,H=r.numDims,O=e.pixels.resultMask,P=e.pixels.resultPixels,T=r.fileVersion>=5?14:15,V=r.zMax;for(m=0;m<E;m++)for(F=m!==E-1?a:Y,G=0;G<C;G++)for(L=m*I*a+G*a,b=I-(S=G!==C-1?a:K),d=0;d<H;d++){if(H>1?(y=P,L=m*I*a+G*a,P=new t(e.pixels.resultPixels.buffer,n*d*B,n),V=r.maxValues[d]):y=null,v=A.byteLength-e.ptr,f={},J=0,R=(s=new DataView(A,e.ptr,Math.min(10,v))).getUint8(0),J++,D=r.fileVersion>=5?4&R:0,U=R>>6&255,(R>>2&T)!=(G*a>>3&T))throw"integrity issue";if(D&&0===d)throw"integrity issue";if((l=3&R)>3)throw e.ptr+=J,"Invalid block encoding ("+l+")";if(2!==l)if(0===l){if(D)throw"integrity issue";if(e.counter.uncompressed++,e.ptr+=J,M=(M=F*S*B)<(N=A.byteLength-e.ptr)?M:N,c=new ArrayBuffer(M%B==0?M:M+B-M%B),new Uint8Array(c).set(new Uint8Array(A,e.ptr,M)),h=new t(c),x=0,O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=h[x++]),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L++]=h[x++];L+=b}e.ptr+=x*B}else if(u=Q.getDataTypeUsed(D&&o<6?4:o,U),w=Q.getOnePixel(f,J,u,s),J+=Q.getDataTypeSize(u),3===l)if(e.ptr+=J,e.counter.constantoffset++,O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=D?Math.min(V,y[L]+w):w),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L]=D?Math.min(V,y[L]+w):w,L++;L+=b}else if(e.ptr+=J,Q.decodeBits(A,e,q,w,d),J=0,D)if(O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=q[J++]+y[L]),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L]=q[J++]+y[L],L++;L+=b}else if(O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=q[J++]),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L++]=q[J++];L+=b}else{if(D)if(O)for(k=0;k<F;k++)for(p=0;p<S;p++)O[L]&&(P[L]=y[L]),L++;else for(k=0;k<F;k++)for(p=0;p<S;p++)P[L]=y[L],L++;e.counter.constant++,e.ptr+=J}}H>1&&!i&&(e.pixels.resultPixels=Q.swapDimensionOrder(e.pixels.resultPixels,n,H,t))},formatFileInfo:function(A){return{fileIdentifierString:A.headerInfo.fileIdentifierString,fileVersion:A.headerInfo.fileVersion,imageType:A.headerInfo.imageType,height:A.headerInfo.height,width:A.headerInfo.width,numValidPixel:A.headerInfo.numValidPixel,microBlockSize:A.headerInfo.microBlockSize,blobSize:A.headerInfo.blobSize,maxZError:A.headerInfo.maxZError,pixelType:Q.getPixelType(A.headerInfo.imageType),eofOffset:A.eofOffset,mask:A.mask?{numBytes:A.mask.numBytes}:null,pixels:{numBlocksX:A.pixels.numBlocksX,numBlocksY:A.pixels.numBlocksY,maxValue:A.headerInfo.zMax,minValue:A.headerInfo.zMin,noDataValue:A.noDataValue}}},constructConstantSurface:function(A,e){var t=A.headerInfo.zMax,i=A.headerInfo.zMin,r=A.headerInfo.maxValues,I=A.headerInfo.numDims,g=A.headerInfo.height*A.headerInfo.width,n=0,a=0,o=0,B=A.pixels.resultMask,C=A.pixels.resultPixels;if(B)if(I>1){if(e)for(n=0;n<I;n++)for(o=n*g,t=r[n],a=0;a<g;a++)B[a]&&(C[o+a]=t);else for(a=0;a<g;a++)if(B[a])for(o=a*I,n=0;n<I;n++)C[o+I]=r[n]}else for(a=0;a<g;a++)B[a]&&(C[a]=t);else if(I>1&&i!==t)if(e)for(n=0;n<I;n++)for(o=n*g,t=r[n],a=0;a<g;a++)C[o+a]=t;else for(a=0;a<g;a++)for(o=a*I,n=0;n<I;n++)C[o+n]=r[n];else for(a=0;a<g*I;a++)C[a]=t},getDataTypeArray:function(A){var e;switch(A){case 0:e=Int8Array;break;case 1:e=Uint8Array;break;case 2:e=Int16Array;break;case 3:e=Uint16Array;break;case 4:e=Int32Array;break;case 5:e=Uint32Array;break;case 6:default:e=Float32Array;break;case 7:e=Float64Array}return e},getPixelType:function(A){var e;switch(A){case 0:e="S8";break;case 1:e="U8";break;case 2:e="S16";break;case 3:e="U16";break;case 4:e="S32";break;case 5:e="U32";break;case 6:default:e="F32";break;case 7:e="F64"}return e},isValidPixelValue:function(A,e){if(null==e)return!1;var t;switch(A){case 0:t=e>=-128&&e<=127;break;case 1:t=e>=0&&e<=255;break;case 2:t=e>=-32768&&e<=32767;break;case 3:t=e>=0&&e<=65536;break;case 4:t=e>=-2147483648&&e<=2147483647;break;case 5:t=e>=0&&e<=4294967296;break;case 6:t=e>=-34027999387901484e22&&e<=34027999387901484e22;break;case 7:t=e>=-17976931348623157e292&&e<=17976931348623157e292;break;default:t=!1}return t},getDataTypeSize:function(A){var e=0;switch(A){case 0:case 1:e=1;break;case 2:case 3:e=2;break;case 4:case 5:case 6:e=4;break;case 7:e=8;break;default:e=A}return e},getDataTypeUsed:function(A,e){var t=A;switch(A){case 2:case 4:t=A-e;break;case 3:case 5:t=A-2*e;break;case 6:t=0===e?A:1===e?2:1;break;case 7:t=0===e?A:A-2*e+1;break;default:t=A}return t},getOnePixel:function(A,e,t,i){var r=0;switch(t){case 0:r=i.getInt8(e);break;case 1:r=i.getUint8(e);break;case 2:r=i.getInt16(e,!0);break;case 3:r=i.getUint16(e,!0);break;case 4:r=i.getInt32(e,!0);break;case 5:r=i.getUInt32(e,!0);break;case 6:r=i.getFloat32(e,!0);break;case 7:r=i.getFloat64(e,!0);break;default:throw"the decoder does not understand this pixel type"}return r},swapDimensionOrder:function(A,e,t,i,r){var I=0,g=0,n=0,a=0,o=A;if(t>1)if(o=new i(e*t),r)for(I=0;I<e;I++)for(a=I,n=0;n<t;n++,a+=e)o[a]=A[g++];else for(I=0;I<e;I++)for(a=I,n=0;n<t;n++,a+=e)o[g++]=A[a];return o}},E=function(A,e,t){this.val=A,this.left=e,this.right=t},{decode:function(A,e){var t=(e=e||{}).noDataValue,i=0,r={};r.ptr=e.inputOffset||0,r.pixels={},Q.readHeaderInfo(A,r);var I=r.headerInfo,g=I.fileVersion,n=Q.getDataTypeArray(I.imageType);if(g>5)throw"unsupported lerc version 2."+g;Q.readMask(A,r),I.numValidPixel===I.width*I.height||r.pixels.resultMask||(r.pixels.resultMask=e.maskData);var a=I.width*I.height;r.pixels.resultPixels=new n(a*I.numDims),r.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var o,B=!e.returnPixelInterleavedDims;if(0!==I.numValidPixel)if(I.zMax===I.zMin)Q.constructConstantSurface(r,B);else if(g>=4&&Q.checkMinMaxRanges(A,r))Q.constructConstantSurface(r,B);else{var C=new DataView(A,r.ptr,2),E=C.getUint8(0);if(r.ptr++,E)Q.readDataOneSweep(A,r,n,B);else if(g>1&&I.imageType<=1&&Math.abs(I.maxZError-.5)<1e-5){var s=C.getUint8(1);if(r.ptr++,r.encodeMode=s,s>2||g<4&&s>1)throw"Invalid Huffman flag "+s;s?Q.readHuffman(A,r,n,B):Q.readTiles(A,r,n,B)}else Q.readTiles(A,r,n,B)}r.eofOffset=r.ptr,e.inputOffset?(o=r.headerInfo.blobSize+e.inputOffset-r.ptr,Math.abs(o)>=1&&(r.eofOffset=e.inputOffset+r.headerInfo.blobSize)):(o=r.headerInfo.blobSize-r.ptr,Math.abs(o)>=1&&(r.eofOffset=r.headerInfo.blobSize));var f={width:I.width,height:I.height,pixelData:r.pixels.resultPixels,minValue:I.zMin,maxValue:I.zMax,validPixelCount:I.numValidPixel,dimCount:I.numDims,dimStats:{minValues:I.minValues,maxValues:I.maxValues},maskData:r.pixels.resultMask};if(r.pixels.resultMask&&Q.isValidPixelValue(I.imageType,t)){var c=r.pixels.resultMask;for(i=0;i<a;i++)c[i]||(f.pixelData[i]=t);f.noDataValue=t}return r.noDataValue=t,e.returnFileInfo&&(f.fileInfo=Q.formatFileInfo(r)),f},getBandCount:function(A){for(var e=0,t=0,i={ptr:0,pixels:{}};t<A.byteLength-58;)Q.readHeaderInfo(A,i),t+=i.headerInfo.blobSize,e++,i.ptr=t;return e}}),l=(s=new ArrayBuffer(4),f=new Uint8Array(s),new Uint32Array(s)[0]=1,1===f[0]),u={decode:function(A,e){if(!l)throw"Big endian system is not supported.";var t,i,r=(e=e||{}).inputOffset||0,I=new Uint8Array(A,r,10),g=String.fromCharCode.apply(null,I);if("CntZImage"===g.trim())t=c,i=1;else{if("Lerc2"!==g.substring(0,5))throw"Unexpected file identifier string: "+g;t=h,i=2}for(var n,a,o,B,C,Q,E=0,s=A.byteLength-10,f=[],u={width:0,height:0,pixels:[],pixelType:e.pixelType,mask:null,statistics:[]},w=0;r<s;){var d=t.decode(A,{inputOffset:r,encodedMaskData:n,maskData:o,returnMask:0===E,returnEncodedMask:0===E,returnFileInfo:!0,returnPixelInterleavedDims:e.returnPixelInterleavedDims,pixelType:e.pixelType||null,noDataValue:e.noDataValue||null});r=d.fileInfo.eofOffset,o=d.maskData,0===E&&(n=d.encodedMaskData,u.width=d.width,u.height=d.height,u.dimCount=d.dimCount||1,u.pixelType=d.pixelType||d.fileInfo.pixelType,u.mask=o),i>1&&(o&&f.push(o),d.fileInfo.mask&&d.fileInfo.mask.numBytes>0&&w++),E++,u.pixels.push(d.pixelData),u.statistics.push({minValue:d.minValue,maxValue:d.maxValue,noDataValue:d.noDataValue,dimStats:d.dimStats})}if(i>1&&w>1){for(Q=u.width*u.height,u.bandMasks=f,(o=new Uint8Array(Q)).set(f[0]),B=1;B<f.length;B++)for(a=f[B],C=0;C<Q;C++)o[C]=o[C]&a[C];u.maskData=o}return u}};TA.exports?TA.exports=u:this.Lerc=u}();var ZA,jA,WA,zA=XA.exports,$A={env:{emscripten_notify_memory_growth:function(A){WA=new Uint8Array(jA.exports.memory.buffer)}}},Ae=function(){function A(){B(this,A)}return Q(A,[{key:"init",value:function(){return ZA||(ZA="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+ee).then((function(A){return A.arrayBuffer()})).then((function(A){return WebAssembly.instantiate(A,$A)})).then(this._init):WebAssembly.instantiate(Buffer.from(ee,"base64"),$A).then(this._init))}},{key:"_init",value:function(A){jA=A.instance,$A.env.emscripten_notify_memory_growth(0)}},{key:"decode",value:function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!jA)throw new Error("ZSTDDecoder: Await .init() before decoding.");var t=A.byteLength,i=jA.exports.malloc(t);WA.set(A,i),e=e||Number(jA.exports.ZSTD_findDecompressedSize(i,t));var r=jA.exports.malloc(e),I=jA.exports.ZSTD_decompress(r,e,i,t),g=WA.slice(r,r+I);return jA.exports.free(i),jA.exports.free(r),g}}]),A}(),ee="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",te={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},ie={};for(var re in te)te.hasOwnProperty(re)&&(ie[te[re]]=parseInt(re,10));ie.BitsPerSample,ie.ExtraSamples,ie.SampleFormat,ie.StripByteCounts,ie.StripOffsets,ie.StripRowCounts,ie.TileByteCounts,ie.TileOffsets,ie.SubIFDs;var Ie={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},ge={};for(var ne in Ie)Ie.hasOwnProperty(ne)&&(ge[Ie[ne]]=parseInt(ne,10));var ae=1,oe=0,Be=1,Ce=2,Qe={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},Ee={};for(var se in Qe)Qe.hasOwnProperty(se)&&(Ee[Qe[se]]=parseInt(se,10));function fe(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var ce=new Ae,he=function(A){s(t,w);var e=fe(t);function t(A){var i;return B(this,t),(i=e.call(this)).planarConfiguration=void 0!==A.PlanarConfiguration?A.PlanarConfiguration:1,i.samplesPerPixel=void 0!==A.SamplesPerPixel?A.SamplesPerPixel:1,i.addCompression=A.LercParameters[ae],i}return Q(t,[{key:"decodeBlock",value:function(A){switch(this.addCompression){case oe:break;case Be:A=YA(new Uint8Array(A)).buffer;break;case Ce:A=ce.decode(new Uint8Array(A)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return zA.decode(A,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}]),t}(),le=Object.freeze({__proto__:null,zstd:ce,default:he});function ue(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var we=function(A){s(I,w);var t,i=ue(I);function I(){var A;if(B(this,I),A=i.call(this),"undefined"==typeof createImageBitmap)throw new Error("Cannot decode WebImage as `createImageBitmap` is not available");if("undefined"==typeof document&&"undefined"==typeof OffscreenCanvas)throw new Error("Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available");return A}return Q(I,[{key:"decode",value:(t=e(r.mark((function A(e,t){var i,I,g,n;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return i=new Blob([t]),A.next=3,createImageBitmap(i);case 3:return I=A.sent,"undefined"!=typeof document?((g=document.createElement("canvas")).width=I.width,g.height=I.height):g=new OffscreenCanvas(I.width,I.height),(n=g.getContext("2d")).drawImage(I,0,0),A.abrupt("return",n.getImageData(0,0,I.width,I.height).data.buffer);case 8:case"end":return A.stop()}}),A)}))),function(A,e){return t.apply(this,arguments)})}]),I}(),de=Object.freeze({__proto__:null,default:we});';return new web_worker_1.default("undefined"!=typeof Buffer?"data:application/javascript;base64,"+Buffer.from(A,"binary").toString("base64"):URL.createObjectURL(new Blob([A],{type:"application/javascript"})))}exports.create=create;

}).call(this)}).call(this,require("buffer").Buffer)
},{"buffer":9,"web-worker":452}],54:[function(require,module,exports){
"use strict";var _require=require("./lib/deflate"),Deflate=_require.Deflate,deflate=_require.deflate,deflateRaw=_require.deflateRaw,gzip=_require.gzip,_require2=require("./lib/inflate"),Inflate=_require2.Inflate,inflate=_require2.inflate,inflateRaw=_require2.inflateRaw,ungzip=_require2.ungzip,constants=require("./lib/zlib/constants");module.exports.Deflate=Deflate,module.exports.deflate=deflate,module.exports.deflateRaw=deflateRaw,module.exports.gzip=gzip,module.exports.Inflate=Inflate,module.exports.inflate=inflate,module.exports.inflateRaw=inflateRaw,module.exports.ungzip=ungzip,module.exports.constants=constants;

},{"./lib/deflate":55,"./lib/inflate":56,"./lib/zlib/constants":60}],55:[function(require,module,exports){
"use strict";var zlib_deflate=require("./zlib/deflate"),utils=require("./utils/common"),strings=require("./utils/strings"),msg=require("./zlib/messages"),ZStream=require("./zlib/zstream"),toString=Object.prototype.toString,_require=require("./zlib/constants"),Z_NO_FLUSH=_require.Z_NO_FLUSH,Z_SYNC_FLUSH=_require.Z_SYNC_FLUSH,Z_FULL_FLUSH=_require.Z_FULL_FLUSH,Z_FINISH=_require.Z_FINISH,Z_OK=_require.Z_OK,Z_STREAM_END=_require.Z_STREAM_END,Z_DEFAULT_COMPRESSION=_require.Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY=_require.Z_DEFAULT_STRATEGY,Z_DEFLATED=_require.Z_DEFLATED;function Deflate(t){this.options=utils.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var i=zlib_deflate.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==Z_OK)throw new Error(msg[i]);if(e.header&&zlib_deflate.deflateSetHeader(this.strm,e.header),e.dictionary){var r;if(r="string"==typeof e.dictionary?strings.string2buf(e.dictionary):"[object ArrayBuffer]"===toString.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=zlib_deflate.deflateSetDictionary(this.strm,r))!==Z_OK)throw new Error(msg[i]);this._dict_set=!0}}function deflate(t,e){var i=new Deflate(e);if(i.push(t,!0),i.err)throw i.msg||msg[i.err];return i.result}function deflateRaw(t,e){return(e=e||{}).raw=!0,deflate(t,e)}function gzip(t,e){return(e=e||{}).gzip=!0,deflate(t,e)}Deflate.prototype.push=function(t,e){var i,r,s=this.strm,n=this.options.chunkSize;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Z_FINISH:Z_NO_FLUSH,"string"==typeof t?s.input=strings.string2buf(t):"[object ArrayBuffer]"===toString.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(n),s.next_out=0,s.avail_out=n),(r===Z_SYNC_FLUSH||r===Z_FULL_FLUSH)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if((i=zlib_deflate.deflate(s,r))===Z_STREAM_END)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),i=zlib_deflate.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Z_OK;if(0!==s.avail_out){if(r>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},Deflate.prototype.onData=function(t){this.chunks.push(t)},Deflate.prototype.onEnd=function(t){t===Z_OK&&(this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},module.exports.Deflate=Deflate,module.exports.deflate=deflate,module.exports.deflateRaw=deflateRaw,module.exports.gzip=gzip,module.exports.constants=require("./zlib/constants");

},{"./utils/common":57,"./utils/strings":58,"./zlib/constants":60,"./zlib/deflate":62,"./zlib/messages":67,"./zlib/zstream":69}],56:[function(require,module,exports){
"use strict";var zlib_inflate=require("./zlib/inflate"),utils=require("./utils/common"),strings=require("./utils/strings"),msg=require("./zlib/messages"),ZStream=require("./zlib/zstream"),GZheader=require("./zlib/gzheader"),toString=Object.prototype.toString,_require=require("./zlib/constants"),Z_NO_FLUSH=_require.Z_NO_FLUSH,Z_FINISH=_require.Z_FINISH,Z_OK=_require.Z_OK,Z_STREAM_END=_require.Z_STREAM_END,Z_NEED_DICT=_require.Z_NEED_DICT,Z_STREAM_ERROR=_require.Z_STREAM_ERROR,Z_DATA_ERROR=_require.Z_DATA_ERROR,Z_MEM_ERROR=_require.Z_MEM_ERROR;function Inflate(t){this.options=utils.assign({chunkSize:65536,windowBits:15,to:""},t||{});var i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,0===i.windowBits&&(i.windowBits=-15)),!(i.windowBits>=0&&i.windowBits<16)||t&&t.windowBits||(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&0==(15&i.windowBits)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var e=zlib_inflate.inflateInit2(this.strm,i.windowBits);if(e!==Z_OK)throw new Error(msg[e]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),i.dictionary&&("string"==typeof i.dictionary?i.dictionary=strings.string2buf(i.dictionary):"[object ArrayBuffer]"===toString.call(i.dictionary)&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(e=zlib_inflate.inflateSetDictionary(this.strm,i.dictionary))!==Z_OK))throw new Error(msg[e])}function inflate(t,i){var e=new Inflate(i);if(e.push(t),e.err)throw e.msg||msg[e.err];return e.result}function inflateRaw(t,i){return(i=i||{}).raw=!0,inflate(t,i)}Inflate.prototype.push=function(t,i){var e,n,r,s=this.strm,a=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(n=i===~~i?i:!0===i?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===toString.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),(e=zlib_inflate.inflate(s,n))===Z_NEED_DICT&&o&&((e=zlib_inflate.inflateSetDictionary(s,o))===Z_OK?e=zlib_inflate.inflate(s,n):e===Z_DATA_ERROR&&(e=Z_NEED_DICT));s.avail_in>0&&e===Z_STREAM_END&&s.state.wrap>0&&0!==t[s.next_in];)zlib_inflate.inflateReset(s),e=zlib_inflate.inflate(s,n);switch(e){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(e),this.ended=!0,!1}if(r=s.avail_out,s.next_out&&(0===s.avail_out||e===Z_STREAM_END))if("string"===this.options.to){var u=strings.utf8border(s.output,s.next_out),_=s.next_out-u,l=strings.buf2string(s.output,u);s.next_out=_,s.avail_out=a-_,_&&s.output.set(s.output.subarray(u,u+_),0),this.onData(l)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(e!==Z_OK||0!==r){if(e===Z_STREAM_END)return e=zlib_inflate.inflateEnd(this.strm),this.onEnd(e),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},Inflate.prototype.onData=function(t){this.chunks.push(t)},Inflate.prototype.onEnd=function(t){t===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},module.exports.Inflate=Inflate,module.exports.inflate=inflate,module.exports.inflateRaw=inflateRaw,module.exports.ungzip=inflate,module.exports.constants=require("./zlib/constants");

},{"./utils/common":57,"./utils/strings":58,"./zlib/constants":60,"./zlib/gzheader":63,"./zlib/inflate":65,"./zlib/messages":67,"./zlib/zstream":69}],57:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _has=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)};module.exports.assign=function(t){for(var o=Array.prototype.slice.call(arguments,1);o.length;){var r=o.shift();if(r){if("object"!==_typeof(r))throw new TypeError(r+"must be non-object");for(var e in r)_has(r,e)&&(t[e]=r[e])}}return t},module.exports.flattenChunks=function(t){for(var o=0,r=0,e=t.length;r<e;r++)o+=t[r].length;for(var n=new Uint8Array(o),f=0,y=0,l=t.length;f<l;f++){var u=t[f];n.set(u,y),y+=u.length}return n};

},{}],58:[function(require,module,exports){
"use strict";var STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){STR_APPLY_UIA_OK=!1}for(var _utf8len=new Uint8Array(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,module.exports.string2buf=function(r){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(r);var e,t,n,o,f,u=r.length,a=0;for(o=0;o<u;o++)55296==(64512&(t=r.charCodeAt(o)))&&o+1<u&&56320==(64512&(n=r.charCodeAt(o+1)))&&(t=65536+(t-55296<<10)+(n-56320),o++),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),f=0,o=0;f<a;o++)55296==(64512&(t=r.charCodeAt(o)))&&o+1<u&&56320==(64512&(n=r.charCodeAt(o+1)))&&(t=65536+(t-55296<<10)+(n-56320),o++),t<128?e[f++]=t:t<2048?(e[f++]=192|t>>>6,e[f++]=128|63&t):t<65536?(e[f++]=224|t>>>12,e[f++]=128|t>>>6&63,e[f++]=128|63&t):(e[f++]=240|t>>>18,e[f++]=128|t>>>12&63,e[f++]=128|t>>>6&63,e[f++]=128|63&t);return e};var buf2binstring=function(r,e){if(e<65534&&r.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));for(var t="",n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t};module.exports.buf2string=function(r,e){var t,n,o=e||r.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(r.subarray(0,e));var f=new Array(2*o);for(n=0,t=0;t<o;){var u=r[t++];if(u<128)f[n++]=u;else{var a=_utf8len[u];if(a>4)f[n++]=65533,t+=a-1;else{for(u&=2===a?31:3===a?15:7;a>1&&t<o;)u=u<<6|63&r[t++],a--;a>1?f[n++]=65533:u<65536?f[n++]=u:(u-=65536,f[n++]=55296|u>>10&1023,f[n++]=56320|1023&u)}}}return buf2binstring(f,n)},module.exports.utf8border=function(r,e){(e=e||r.length)>r.length&&(e=r.length);for(var t=e-1;t>=0&&128==(192&r[t]);)t--;return t<0?e:0===t?e:t+_utf8len[r[t]]>e?t:e};

},{}],59:[function(require,module,exports){
"use strict";var adler32=function(e,r,o,t){for(var a=65535&e|0,d=e>>>16&65535|0,l=0;0!==o;){o-=l=o>2e3?2e3:o;do{d=d+(a=a+r[t++]|0)|0}while(--l);a%=65521,d%=65521}return a|d<<16|0};module.exports=adler32;

},{}],60:[function(require,module,exports){
"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};

},{}],61:[function(require,module,exports){
"use strict";var makeTable=function(){for(var r,a=[],e=0;e<256;e++){r=e;for(var c=0;c<8;c++)r=1&r?3988292384^r>>>1:r>>>1;a[e]=r}return a},crcTable=new Uint32Array(makeTable()),crc32=function(r,a,e,c){var n=crcTable,t=c+e;r^=-1;for(var o=c;o<t;o++)r=r>>>8^n[255&(r^a[o])];return-1^r};module.exports=crc32;

},{}],62:[function(require,module,exports){
"use strict";var _require=require("./trees"),_tr_init=_require._tr_init,_tr_stored_block=_require._tr_stored_block,_tr_flush_block=_require._tr_flush_block,_tr_tally=_require._tr_tally,_tr_align=_require._tr_align,adler32=require("./adler32"),crc32=require("./crc32"),msg=require("./messages"),_require2=require("./constants"),Z_NO_FLUSH=_require2.Z_NO_FLUSH,Z_PARTIAL_FLUSH=_require2.Z_PARTIAL_FLUSH,Z_FULL_FLUSH=_require2.Z_FULL_FLUSH,Z_FINISH=_require2.Z_FINISH,Z_BLOCK=_require2.Z_BLOCK,Z_OK=_require2.Z_OK,Z_STREAM_END=_require2.Z_STREAM_END,Z_STREAM_ERROR=_require2.Z_STREAM_ERROR,Z_DATA_ERROR=_require2.Z_DATA_ERROR,Z_BUF_ERROR=_require2.Z_BUF_ERROR,Z_DEFAULT_COMPRESSION=_require2.Z_DEFAULT_COMPRESSION,Z_FILTERED=_require2.Z_FILTERED,Z_HUFFMAN_ONLY=_require2.Z_HUFFMAN_ONLY,Z_RLE=_require2.Z_RLE,Z_FIXED=_require2.Z_FIXED,Z_DEFAULT_STRATEGY=_require2.Z_DEFAULT_STRATEGY,Z_UNKNOWN=_require2.Z_UNKNOWN,Z_DEFLATED=_require2.Z_DEFLATED,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=function(t,e){return t.msg=msg[e],e},rank=function(t){return 2*t-(t>4?9:0)},zero=function(t){for(var e=t.length;--e>=0;)t[e]=0},slide_hash=function(t){var e,_,a,r=t.w_size;a=e=t.hash_size;do{_=t.head[--a],t.head[a]=_>=r?_-r:0}while(--e);a=e=r;do{_=t.prev[--a],t.prev[a]=_>=r?_-r:0}while(--e)},HASH_ZLIB=function(t,e,_){return(e<<t.hash_shift^_)&t.hash_mask},HASH=HASH_ZLIB,flush_pending=function(t){var e=t.state,_=e.pending;_>t.avail_out&&(_=t.avail_out),0!==_&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+_),t.next_out),t.next_out+=_,e.pending_out+=_,t.total_out+=_,t.avail_out-=_,e.pending-=_,0===e.pending&&(e.pending_out=0))},flush_block_only=function(t,e){_tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,flush_pending(t.strm)},put_byte=function(t,e){t.pending_buf[t.pending++]=e},putShortMSB=function(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},read_buf=function(t,e,_,a){var r=t.avail_in;return r>a&&(r=a),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),_),1===t.state.wrap?t.adler=adler32(t.adler,e,r,_):2===t.state.wrap&&(t.adler=crc32(t.adler,e,r,_)),t.next_in+=r,t.total_in+=r,r)},longest_match=function(t,e){var _,a,r=t.max_chain_length,s=t.strstart,i=t.prev_length,n=t.nice_match,l=t.strstart>t.w_size-MIN_LOOKAHEAD?t.strstart-(t.w_size-MIN_LOOKAHEAD):0,h=t.window,d=t.w_mask,o=t.prev,u=t.strstart+MAX_MATCH,f=h[s+i-1],E=h[s+i];t.prev_length>=t.good_match&&(r>>=2),n>t.lookahead&&(n=t.lookahead);do{if(h[(_=e)+i]===E&&h[_+i-1]===f&&h[_]===h[s]&&h[++_]===h[s+1]){s+=2,_++;do{}while(h[++s]===h[++_]&&h[++s]===h[++_]&&h[++s]===h[++_]&&h[++s]===h[++_]&&h[++s]===h[++_]&&h[++s]===h[++_]&&h[++s]===h[++_]&&h[++s]===h[++_]&&s<u);if(a=MAX_MATCH-(u-s),s=u-MAX_MATCH,a>i){if(t.match_start=e,i=a,a>=n)break;f=h[s+i-1],E=h[s+i]}}}while((e=o[e&d])>l&&0!=--r);return i<=t.lookahead?i:t.lookahead},fill_window=function(t){var e,_,a,r=t.w_size;do{if(_=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-MIN_LOOKAHEAD)&&(t.window.set(t.window.subarray(r,r+r-_),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),slide_hash(t),_+=r),0===t.strm.avail_in)break;if(e=read_buf(t.strm,t.window,t.strstart+t.lookahead,_),t.lookahead+=e,t.lookahead+t.insert>=MIN_MATCH)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=HASH(t,t.ins_h,t.window[a+1]);t.insert&&(t.ins_h=HASH(t,t.ins_h,t.window[a+MIN_MATCH-1]),t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<MIN_MATCH)););}while(t.lookahead<MIN_LOOKAHEAD&&0!==t.strm.avail_in)},deflate_stored=function(t,e){var _,a,r,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,i=0,n=t.strm.avail_in;do{if(_=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r)break;if(r=t.strm.avail_out-r,_>(a=t.strstart-t.block_start)+t.strm.avail_in&&(_=a+t.strm.avail_in),_>r&&(_=r),_<s&&(0===_&&e!==Z_FINISH||e===Z_NO_FLUSH||_!==a+t.strm.avail_in))break;i=e===Z_FINISH&&_===a+t.strm.avail_in?1:0,_tr_stored_block(t,0,0,i),t.pending_buf[t.pending-4]=_,t.pending_buf[t.pending-3]=_>>8,t.pending_buf[t.pending-2]=~_,t.pending_buf[t.pending-1]=~_>>8,flush_pending(t.strm),a&&(a>_&&(a=_),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+a),t.strm.next_out),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a,t.block_start+=a,_-=a),_&&(read_buf(t.strm,t.strm.output,t.strm.next_out,_),t.strm.next_out+=_,t.strm.avail_out-=_,t.strm.total_out+=_)}while(0===i);return(n-=t.strm.avail_in)&&(n>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=n&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-n,t.strm.next_in),t.strstart),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),i?BS_FINISH_DONE:e!==Z_NO_FLUSH&&e!==Z_FINISH&&0===t.strm.avail_in&&t.strstart===t.block_start?BS_BLOCK_DONE:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(read_buf(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,s=(r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r)>t.w_size?t.w_size:r,((a=t.strstart-t.block_start)>=s||(a||e===Z_FINISH)&&e!==Z_NO_FLUSH&&0===t.strm.avail_in&&a<=r)&&(_=a>r?r:a,i=e===Z_FINISH&&0===t.strm.avail_in&&_===a?1:0,_tr_stored_block(t,t.block_start,_,i),t.block_start+=_,flush_pending(t.strm)),i?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=function(t,e){for(var _,a;;){if(t.lookahead<MIN_LOOKAHEAD){if(fill_window(t),t.lookahead<MIN_LOOKAHEAD&&e===Z_NO_FLUSH)return BS_NEED_MORE;if(0===t.lookahead)break}if(_=0,t.lookahead>=MIN_MATCH&&(t.ins_h=HASH(t,t.ins_h,t.window[t.strstart+MIN_MATCH-1]),_=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==_&&t.strstart-_<=t.w_size-MIN_LOOKAHEAD&&(t.match_length=longest_match(t,_)),t.match_length>=MIN_MATCH)if(a=_tr_tally(t,t.strstart-t.match_start,t.match_length-MIN_MATCH),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=MIN_MATCH){t.match_length--;do{t.strstart++,t.ins_h=HASH(t,t.ins_h,t.window[t.strstart+MIN_MATCH-1]),_=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=HASH(t,t.ins_h,t.window[t.strstart+1]);else a=_tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(a&&(flush_block_only(t,!1),0===t.strm.avail_out))return BS_NEED_MORE}return t.insert=t.strstart<MIN_MATCH-1?t.strstart:MIN_MATCH-1,e===Z_FINISH?(flush_block_only(t,!0),0===t.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):t.sym_next&&(flush_block_only(t,!1),0===t.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=function(t,e){for(var _,a,r;;){if(t.lookahead<MIN_LOOKAHEAD){if(fill_window(t),t.lookahead<MIN_LOOKAHEAD&&e===Z_NO_FLUSH)return BS_NEED_MORE;if(0===t.lookahead)break}if(_=0,t.lookahead>=MIN_MATCH&&(t.ins_h=HASH(t,t.ins_h,t.window[t.strstart+MIN_MATCH-1]),_=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=MIN_MATCH-1,0!==_&&t.prev_length<t.max_lazy_match&&t.strstart-_<=t.w_size-MIN_LOOKAHEAD&&(t.match_length=longest_match(t,_),t.match_length<=5&&(t.strategy===Z_FILTERED||t.match_length===MIN_MATCH&&t.strstart-t.match_start>4096)&&(t.match_length=MIN_MATCH-1)),t.prev_length>=MIN_MATCH&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-MIN_MATCH,a=_tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-MIN_MATCH),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=HASH(t,t.ins_h,t.window[t.strstart+MIN_MATCH-1]),_=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=MIN_MATCH-1,t.strstart++,a&&(flush_block_only(t,!1),0===t.strm.avail_out))return BS_NEED_MORE}else if(t.match_available){if((a=_tr_tally(t,0,t.window[t.strstart-1]))&&flush_block_only(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return BS_NEED_MORE}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(a=_tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<MIN_MATCH-1?t.strstart:MIN_MATCH-1,e===Z_FINISH?(flush_block_only(t,!0),0===t.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):t.sym_next&&(flush_block_only(t,!1),0===t.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=function(t,e){for(var _,a,r,s,i=t.window;;){if(t.lookahead<=MAX_MATCH){if(fill_window(t),t.lookahead<=MAX_MATCH&&e===Z_NO_FLUSH)return BS_NEED_MORE;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=MIN_MATCH&&t.strstart>0&&(a=i[r=t.strstart-1])===i[++r]&&a===i[++r]&&a===i[++r]){s=t.strstart+MAX_MATCH;do{}while(a===i[++r]&&a===i[++r]&&a===i[++r]&&a===i[++r]&&a===i[++r]&&a===i[++r]&&a===i[++r]&&a===i[++r]&&r<s);t.match_length=MAX_MATCH-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=MIN_MATCH?(_=_tr_tally(t,1,t.match_length-MIN_MATCH),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(_=_tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),_&&(flush_block_only(t,!1),0===t.strm.avail_out))return BS_NEED_MORE}return t.insert=0,e===Z_FINISH?(flush_block_only(t,!0),0===t.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):t.sym_next&&(flush_block_only(t,!1),0===t.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=function(t,e){for(var _;;){if(0===t.lookahead&&(fill_window(t),0===t.lookahead)){if(e===Z_NO_FLUSH)return BS_NEED_MORE;break}if(t.match_length=0,_=_tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,_&&(flush_block_only(t,!1),0===t.strm.avail_out))return BS_NEED_MORE}return t.insert=0,e===Z_FINISH?(flush_block_only(t,!0),0===t.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):t.sym_next&&(flush_block_only(t,!1),0===t.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(t,e,_,a,r){this.good_length=t,this.max_lazy=e,this.nice_length=_,this.max_chain=a,this.func=r}var configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=function(t){t.window_size=2*t.w_size,zero(t.head),t.max_lazy_match=configuration_table[t.level].max_lazy,t.good_match=configuration_table[t.level].good_length,t.nice_match=configuration_table[t.level].nice_length,t.max_chain_length=configuration_table[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=MIN_MATCH-1,t.match_available=0,t.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*HEAP_SIZE),this.dyn_dtree=new Uint16Array(2*(2*D_CODES+1)),this.bl_tree=new Uint16Array(2*(2*BL_CODES+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var deflateStateCheck=function(t){if(!t)return 1;var e=t.state;return!e||e.strm!==t||e.status!==INIT_STATE&&e.status!==GZIP_STATE&&e.status!==EXTRA_STATE&&e.status!==NAME_STATE&&e.status!==COMMENT_STATE&&e.status!==HCRC_STATE&&e.status!==BUSY_STATE&&e.status!==FINISH_STATE?1:0},deflateResetKeep=function(t){if(deflateStateCheck(t))return err(t,Z_STREAM_ERROR);t.total_in=t.total_out=0,t.data_type=Z_UNKNOWN;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?GZIP_STATE:e.wrap?INIT_STATE:BUSY_STATE,t.adler=2===e.wrap?0:1,e.last_flush=-2,_tr_init(e),Z_OK},deflateReset=function(t){var e=deflateResetKeep(t);return e===Z_OK&&lm_init(t.state),e},deflateSetHeader=function(t,e){return deflateStateCheck(t)||2!==t.state.wrap?Z_STREAM_ERROR:(t.state.gzhead=e,Z_OK)},deflateInit2=function(t,e,_,a,r,s){if(!t)return Z_STREAM_ERROR;var i=1;if(e===Z_DEFAULT_COMPRESSION&&(e=6),a<0?(i=0,a=-a):a>15&&(i=2,a-=16),r<1||r>MAX_MEM_LEVEL||_!==Z_DEFLATED||a<8||a>15||e<0||e>9||s<0||s>Z_FIXED||8===a&&1!==i)return err(t,Z_STREAM_ERROR);8===a&&(a=9);var n=new DeflateState;return t.state=n,n.strm=t,n.status=INIT_STATE,n.wrap=i,n.gzhead=null,n.w_bits=a,n.w_size=1<<n.w_bits,n.w_mask=n.w_size-1,n.hash_bits=r+7,n.hash_size=1<<n.hash_bits,n.hash_mask=n.hash_size-1,n.hash_shift=~~((n.hash_bits+MIN_MATCH-1)/MIN_MATCH),n.window=new Uint8Array(2*n.w_size),n.head=new Uint16Array(n.hash_size),n.prev=new Uint16Array(n.w_size),n.lit_bufsize=1<<r+6,n.pending_buf_size=4*n.lit_bufsize,n.pending_buf=new Uint8Array(n.pending_buf_size),n.sym_buf=n.lit_bufsize,n.sym_end=3*(n.lit_bufsize-1),n.level=e,n.strategy=s,n.method=_,deflateReset(t)},deflateInit=function(t,e){return deflateInit2(t,e,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)},deflate=function(t,e){if(deflateStateCheck(t)||e>Z_BLOCK||e<0)return t?err(t,Z_STREAM_ERROR):Z_STREAM_ERROR;var _=t.state;if(!t.output||0!==t.avail_in&&!t.input||_.status===FINISH_STATE&&e!==Z_FINISH)return err(t,0===t.avail_out?Z_BUF_ERROR:Z_STREAM_ERROR);var a=_.last_flush;if(_.last_flush=e,0!==_.pending){if(flush_pending(t),0===t.avail_out)return _.last_flush=-1,Z_OK}else if(0===t.avail_in&&rank(e)<=rank(a)&&e!==Z_FINISH)return err(t,Z_BUF_ERROR);if(_.status===FINISH_STATE&&0!==t.avail_in)return err(t,Z_BUF_ERROR);if(_.status===INIT_STATE&&0===_.wrap&&(_.status=BUSY_STATE),_.status===INIT_STATE){var r=Z_DEFLATED+(_.w_bits-8<<4)<<8;if(r|=(_.strategy>=Z_HUFFMAN_ONLY||_.level<2?0:_.level<6?1:6===_.level?2:3)<<6,0!==_.strstart&&(r|=PRESET_DICT),putShortMSB(_,r+=31-r%31),0!==_.strstart&&(putShortMSB(_,t.adler>>>16),putShortMSB(_,65535&t.adler)),t.adler=1,_.status=BUSY_STATE,flush_pending(t),0!==_.pending)return _.last_flush=-1,Z_OK}if(_.status===GZIP_STATE)if(t.adler=0,put_byte(_,31),put_byte(_,139),put_byte(_,8),_.gzhead)put_byte(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),put_byte(_,255&_.gzhead.time),put_byte(_,_.gzhead.time>>8&255),put_byte(_,_.gzhead.time>>16&255),put_byte(_,_.gzhead.time>>24&255),put_byte(_,9===_.level?2:_.strategy>=Z_HUFFMAN_ONLY||_.level<2?4:0),put_byte(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(put_byte(_,255&_.gzhead.extra.length),put_byte(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(t.adler=crc32(t.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=EXTRA_STATE;else if(put_byte(_,0),put_byte(_,0),put_byte(_,0),put_byte(_,0),put_byte(_,0),put_byte(_,9===_.level?2:_.strategy>=Z_HUFFMAN_ONLY||_.level<2?4:0),put_byte(_,OS_CODE),_.status=BUSY_STATE,flush_pending(t),0!==_.pending)return _.last_flush=-1,Z_OK;if(_.status===EXTRA_STATE){if(_.gzhead.extra){for(var s=_.pending,i=(65535&_.gzhead.extra.length)-_.gzindex;_.pending+i>_.pending_buf_size;){var n=_.pending_buf_size-_.pending;if(_.pending_buf.set(_.gzhead.extra.subarray(_.gzindex,_.gzindex+n),_.pending),_.pending=_.pending_buf_size,_.gzhead.hcrc&&_.pending>s&&(t.adler=crc32(t.adler,_.pending_buf,_.pending-s,s)),_.gzindex+=n,flush_pending(t),0!==_.pending)return _.last_flush=-1,Z_OK;s=0,i-=n}var l=new Uint8Array(_.gzhead.extra);_.pending_buf.set(l.subarray(_.gzindex,_.gzindex+i),_.pending),_.pending+=i,_.gzhead.hcrc&&_.pending>s&&(t.adler=crc32(t.adler,_.pending_buf,_.pending-s,s)),_.gzindex=0}_.status=NAME_STATE}if(_.status===NAME_STATE){if(_.gzhead.name){var h,d=_.pending;do{if(_.pending===_.pending_buf_size){if(_.gzhead.hcrc&&_.pending>d&&(t.adler=crc32(t.adler,_.pending_buf,_.pending-d,d)),flush_pending(t),0!==_.pending)return _.last_flush=-1,Z_OK;d=0}h=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,put_byte(_,h)}while(0!==h);_.gzhead.hcrc&&_.pending>d&&(t.adler=crc32(t.adler,_.pending_buf,_.pending-d,d)),_.gzindex=0}_.status=COMMENT_STATE}if(_.status===COMMENT_STATE){if(_.gzhead.comment){var o,u=_.pending;do{if(_.pending===_.pending_buf_size){if(_.gzhead.hcrc&&_.pending>u&&(t.adler=crc32(t.adler,_.pending_buf,_.pending-u,u)),flush_pending(t),0!==_.pending)return _.last_flush=-1,Z_OK;u=0}o=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,put_byte(_,o)}while(0!==o);_.gzhead.hcrc&&_.pending>u&&(t.adler=crc32(t.adler,_.pending_buf,_.pending-u,u))}_.status=HCRC_STATE}if(_.status===HCRC_STATE){if(_.gzhead.hcrc){if(_.pending+2>_.pending_buf_size&&(flush_pending(t),0!==_.pending))return _.last_flush=-1,Z_OK;put_byte(_,255&t.adler),put_byte(_,t.adler>>8&255),t.adler=0}if(_.status=BUSY_STATE,flush_pending(t),0!==_.pending)return _.last_flush=-1,Z_OK}if(0!==t.avail_in||0!==_.lookahead||e!==Z_NO_FLUSH&&_.status!==FINISH_STATE){var f=0===_.level?deflate_stored(_,e):_.strategy===Z_HUFFMAN_ONLY?deflate_huff(_,e):_.strategy===Z_RLE?deflate_rle(_,e):configuration_table[_.level].func(_,e);if(f!==BS_FINISH_STARTED&&f!==BS_FINISH_DONE||(_.status=FINISH_STATE),f===BS_NEED_MORE||f===BS_FINISH_STARTED)return 0===t.avail_out&&(_.last_flush=-1),Z_OK;if(f===BS_BLOCK_DONE&&(e===Z_PARTIAL_FLUSH?_tr_align(_):e!==Z_BLOCK&&(_tr_stored_block(_,0,0,!1),e===Z_FULL_FLUSH&&(zero(_.head),0===_.lookahead&&(_.strstart=0,_.block_start=0,_.insert=0))),flush_pending(t),0===t.avail_out))return _.last_flush=-1,Z_OK}return e!==Z_FINISH?Z_OK:_.wrap<=0?Z_STREAM_END:(2===_.wrap?(put_byte(_,255&t.adler),put_byte(_,t.adler>>8&255),put_byte(_,t.adler>>16&255),put_byte(_,t.adler>>24&255),put_byte(_,255&t.total_in),put_byte(_,t.total_in>>8&255),put_byte(_,t.total_in>>16&255),put_byte(_,t.total_in>>24&255)):(putShortMSB(_,t.adler>>>16),putShortMSB(_,65535&t.adler)),flush_pending(t),_.wrap>0&&(_.wrap=-_.wrap),0!==_.pending?Z_OK:Z_STREAM_END)},deflateEnd=function(t){if(deflateStateCheck(t))return Z_STREAM_ERROR;var e=t.state.status;return t.state=null,e===BUSY_STATE?err(t,Z_DATA_ERROR):Z_OK},deflateSetDictionary=function(t,e){var _=e.length;if(deflateStateCheck(t))return Z_STREAM_ERROR;var a=t.state,r=a.wrap;if(2===r||1===r&&a.status!==INIT_STATE||a.lookahead)return Z_STREAM_ERROR;if(1===r&&(t.adler=adler32(t.adler,e,_,0)),a.wrap=0,_>=a.w_size){0===r&&(zero(a.head),a.strstart=0,a.block_start=0,a.insert=0);var s=new Uint8Array(a.w_size);s.set(e.subarray(_-a.w_size,_),0),e=s,_=a.w_size}var i=t.avail_in,n=t.next_in,l=t.input;for(t.avail_in=_,t.next_in=0,t.input=e,fill_window(a);a.lookahead>=MIN_MATCH;){var h=a.strstart,d=a.lookahead-(MIN_MATCH-1);do{a.ins_h=HASH(a,a.ins_h,a.window[h+MIN_MATCH-1]),a.prev[h&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=h,h++}while(--d);a.strstart=h,a.lookahead=MIN_MATCH-1,fill_window(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=MIN_MATCH-1,a.match_available=0,t.next_in=n,t.input=l,t.avail_in=i,a.wrap=r,Z_OK};module.exports.deflateInit=deflateInit,module.exports.deflateInit2=deflateInit2,module.exports.deflateReset=deflateReset,module.exports.deflateResetKeep=deflateResetKeep,module.exports.deflateSetHeader=deflateSetHeader,module.exports.deflate=deflate,module.exports.deflateEnd=deflateEnd,module.exports.deflateSetDictionary=deflateSetDictionary,module.exports.deflateInfo="pako deflate (from Nodeca project)";

},{"./adler32":59,"./constants":60,"./crc32":61,"./messages":67,"./trees":68}],63:[function(require,module,exports){
"use strict";function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}module.exports=GZheader;

},{}],64:[function(require,module,exports){
"use strict";var BAD=16209,TYPE=16191;module.exports=function(i,e){var o,a,t,d,n,l,s,f,r,b,c,u,v,m,w,h,k,_,x,g,A,B,D,p,E=i.state;o=i.next_in,D=i.input,a=o+(i.avail_in-5),t=i.next_out,p=i.output,d=t-(e-i.avail_out),n=t+(i.avail_out-257),l=E.dmax,s=E.wsize,f=E.whave,r=E.wnext,b=E.window,c=E.hold,u=E.bits,v=E.lencode,m=E.distcode,w=(1<<E.lenbits)-1,h=(1<<E.distbits)-1;i:do{u<15&&(c+=D[o++]<<u,u+=8,c+=D[o++]<<u,u+=8),k=v[c&w];e:for(;;){if(c>>>=_=k>>>24,u-=_,0===(_=k>>>16&255))p[t++]=65535&k;else{if(!(16&_)){if(0==(64&_)){k=v[(65535&k)+(c&(1<<_)-1)];continue e}if(32&_){E.mode=TYPE;break i}i.msg="invalid literal/length code",E.mode=BAD;break i}x=65535&k,(_&=15)&&(u<_&&(c+=D[o++]<<u,u+=8),x+=c&(1<<_)-1,c>>>=_,u-=_),u<15&&(c+=D[o++]<<u,u+=8,c+=D[o++]<<u,u+=8),k=m[c&h];o:for(;;){if(c>>>=_=k>>>24,u-=_,!(16&(_=k>>>16&255))){if(0==(64&_)){k=m[(65535&k)+(c&(1<<_)-1)];continue o}i.msg="invalid distance code",E.mode=BAD;break i}if(g=65535&k,u<(_&=15)&&(c+=D[o++]<<u,(u+=8)<_&&(c+=D[o++]<<u,u+=8)),(g+=c&(1<<_)-1)>l){i.msg="invalid distance too far back",E.mode=BAD;break i}if(c>>>=_,u-=_,g>(_=t-d)){if((_=g-_)>f&&E.sane){i.msg="invalid distance too far back",E.mode=BAD;break i}if(A=0,B=b,0===r){if(A+=s-_,_<x){x-=_;do{p[t++]=b[A++]}while(--_);A=t-g,B=p}}else if(r<_){if(A+=s+r-_,(_-=r)<x){x-=_;do{p[t++]=b[A++]}while(--_);if(A=0,r<x){x-=_=r;do{p[t++]=b[A++]}while(--_);A=t-g,B=p}}}else if(A+=r-_,_<x){x-=_;do{p[t++]=b[A++]}while(--_);A=t-g,B=p}for(;x>2;)p[t++]=B[A++],p[t++]=B[A++],p[t++]=B[A++],x-=3;x&&(p[t++]=B[A++],x>1&&(p[t++]=B[A++]))}else{A=t-g;do{p[t++]=p[A++],p[t++]=p[A++],p[t++]=p[A++],x-=3}while(x>2);x&&(p[t++]=p[A++],x>1&&(p[t++]=p[A++]))}break}}break}}while(o<a&&t<n);o-=x=u>>3,c&=(1<<(u-=x<<3))-1,i.next_in=o,i.next_out=t,i.avail_in=o<a?a-o+5:5-(o-a),i.avail_out=t<n?n-t+257:257-(t-n),E.hold=c,E.bits=u};

},{}],65:[function(require,module,exports){
"use strict";var adler32=require("./adler32"),crc32=require("./crc32"),inflate_fast=require("./inffast"),inflate_table=require("./inftrees"),CODES=0,LENS=1,DISTS=2,_require=require("./constants"),Z_FINISH=_require.Z_FINISH,Z_BLOCK=_require.Z_BLOCK,Z_TREES=_require.Z_TREES,Z_OK=_require.Z_OK,Z_STREAM_END=_require.Z_STREAM_END,Z_NEED_DICT=_require.Z_NEED_DICT,Z_STREAM_ERROR=_require.Z_STREAM_ERROR,Z_DATA_ERROR=_require.Z_DATA_ERROR,Z_MEM_ERROR=_require.Z_MEM_ERROR,Z_BUF_ERROR=_require.Z_BUF_ERROR,Z_DEFLATED=_require.Z_DEFLATED,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var lenfix,distfix,inflateStateCheck=function(e){if(!e)return 1;var t=e.state;return!t||t.strm!==e||t.mode<HEAD||t.mode>SYNC?1:0},inflateResetKeep=function(e){if(inflateStateCheck(e))return Z_STREAM_ERROR;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK},inflateReset=function(e){if(inflateStateCheck(e))return Z_STREAM_ERROR;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)},inflateReset2=function(e,t){var a;if(inflateStateCheck(e))return Z_STREAM_ERROR;var i=e.state;return t<0?(a=0,t=-t):(a=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=a,i.wbits=t,inflateReset(e))},inflateInit2=function(e,t){if(!e)return Z_STREAM_ERROR;var a=new InflateState;e.state=a,a.strm=e,a.window=null,a.mode=HEAD;var i=inflateReset2(e,t);return i!==Z_OK&&(e.state=null),i},inflateInit=function(e){return inflateInit2(e,DEF_WBITS)},virgin=!0,fixedtables=function(e){if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inflate_table(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inflate_table(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=function(e,t,a,i){var n,r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(t.subarray(a-r.wsize,a),0),r.wnext=0,r.whave=r.wsize):((n=r.wsize-r.wnext)>i&&(n=i),r.window.set(t.subarray(a-i,a-i+n),r.wnext),(i-=n)?(r.window.set(t.subarray(a-i,a),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0},inflate=function(e,t){var a,i,n,r,s,l,o,d,f,c,h,E,_,b,k,m,w,u,R,T,D,S,A,g,x=0,v=new Uint8Array(4),O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(e)||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR;(a=e.state).mode===TYPE&&(a.mode=TYPEDO),s=e.next_out,n=e.output,o=e.avail_out,r=e.next_in,i=e.input,l=e.avail_in,d=a.hold,f=a.bits,c=l,h=o,S=Z_OK;e:for(;;)switch(a.mode){case HEAD:if(0===a.wrap){a.mode=TYPEDO;break}for(;f<16;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(2&a.wrap&&35615===d){0===a.wbits&&(a.wbits=15),a.check=0,v[0]=255&d,v[1]=d>>>8&255,a.check=crc32(a.check,v,2,0),d=0,f=0,a.mode=FLAGS;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",a.mode=BAD;break}if((15&d)!==Z_DEFLATED){e.msg="unknown compression method",a.mode=BAD;break}if(f-=4,D=8+(15&(d>>>=4)),0===a.wbits&&(a.wbits=D),D>15||D>a.wbits){e.msg="invalid window size",a.mode=BAD;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=512&d?DICTID:TYPE,d=0,f=0;break;case FLAGS:for(;f<16;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(a.flags=d,(255&a.flags)!==Z_DEFLATED){e.msg="unknown compression method",a.mode=BAD;break}if(57344&a.flags){e.msg="unknown header flags set",a.mode=BAD;break}a.head&&(a.head.text=d>>8&1),512&a.flags&&4&a.wrap&&(v[0]=255&d,v[1]=d>>>8&255,a.check=crc32(a.check,v,2,0)),d=0,f=0,a.mode=TIME;case TIME:for(;f<32;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}a.head&&(a.head.time=d),512&a.flags&&4&a.wrap&&(v[0]=255&d,v[1]=d>>>8&255,v[2]=d>>>16&255,v[3]=d>>>24&255,a.check=crc32(a.check,v,4,0)),d=0,f=0,a.mode=OS;case OS:for(;f<16;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}a.head&&(a.head.xflags=255&d,a.head.os=d>>8),512&a.flags&&4&a.wrap&&(v[0]=255&d,v[1]=d>>>8&255,a.check=crc32(a.check,v,2,0)),d=0,f=0,a.mode=EXLEN;case EXLEN:if(1024&a.flags){for(;f<16;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}a.length=d,a.head&&(a.head.extra_len=d),512&a.flags&&4&a.wrap&&(v[0]=255&d,v[1]=d>>>8&255,a.check=crc32(a.check,v,2,0)),d=0,f=0}else a.head&&(a.head.extra=null);a.mode=EXTRA;case EXTRA:if(1024&a.flags&&((E=a.length)>l&&(E=l),E&&(a.head&&(D=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(i.subarray(r,r+E),D)),512&a.flags&&4&a.wrap&&(a.check=crc32(a.check,i,E,r)),l-=E,r+=E,a.length-=E),a.length))break e;a.length=0,a.mode=NAME;case NAME:if(2048&a.flags){if(0===l)break e;E=0;do{D=i[r+E++],a.head&&D&&a.length<65536&&(a.head.name+=String.fromCharCode(D))}while(D&&E<l);if(512&a.flags&&4&a.wrap&&(a.check=crc32(a.check,i,E,r)),l-=E,r+=E,D)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=COMMENT;case COMMENT:if(4096&a.flags){if(0===l)break e;E=0;do{D=i[r+E++],a.head&&D&&a.length<65536&&(a.head.comment+=String.fromCharCode(D))}while(D&&E<l);if(512&a.flags&&4&a.wrap&&(a.check=crc32(a.check,i,E,r)),l-=E,r+=E,D)break e}else a.head&&(a.head.comment=null);a.mode=HCRC;case HCRC:if(512&a.flags){for(;f<16;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(4&a.wrap&&d!==(65535&a.check)){e.msg="header crc mismatch",a.mode=BAD;break}d=0,f=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=TYPE;break;case DICTID:for(;f<32;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}e.adler=a.check=zswap32(d),d=0,f=0,a.mode=DICT;case DICT:if(0===a.havedict)return e.next_out=s,e.avail_out=o,e.next_in=r,e.avail_in=l,a.hold=d,a.bits=f,Z_NEED_DICT;e.adler=a.check=1,a.mode=TYPE;case TYPE:if(t===Z_BLOCK||t===Z_TREES)break e;case TYPEDO:if(a.last){d>>>=7&f,f-=7&f,a.mode=CHECK;break}for(;f<3;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}switch(a.last=1&d,f-=1,3&(d>>>=1)){case 0:a.mode=STORED;break;case 1:if(fixedtables(a),a.mode=LEN_,t===Z_TREES){d>>>=2,f-=2;break e}break;case 2:a.mode=TABLE;break;case 3:e.msg="invalid block type",a.mode=BAD}d>>>=2,f-=2;break;case STORED:for(d>>>=7&f,f-=7&f;f<32;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",a.mode=BAD;break}if(a.length=65535&d,d=0,f=0,a.mode=COPY_,t===Z_TREES)break e;case COPY_:a.mode=COPY;case COPY:if(E=a.length){if(E>l&&(E=l),E>o&&(E=o),0===E)break e;n.set(i.subarray(r,r+E),s),l-=E,r+=E,o-=E,s+=E,a.length-=E;break}a.mode=TYPE;break;case TABLE:for(;f<14;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(a.nlen=257+(31&d),d>>>=5,f-=5,a.ndist=1+(31&d),d>>>=5,f-=5,a.ncode=4+(15&d),d>>>=4,f-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=BAD;break}a.have=0,a.mode=LENLENS;case LENLENS:for(;a.have<a.ncode;){for(;f<3;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}a.lens[O[a.have++]]=7&d,d>>>=3,f-=3}for(;a.have<19;)a.lens[O[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,A={bits:a.lenbits},S=inflate_table(CODES,a.lens,0,19,a.lencode,0,a.work,A),a.lenbits=A.bits,S){e.msg="invalid code lengths set",a.mode=BAD;break}a.have=0,a.mode=CODELENS;case CODELENS:for(;a.have<a.nlen+a.ndist;){for(;m=(x=a.lencode[d&(1<<a.lenbits)-1])>>>16&255,w=65535&x,!((k=x>>>24)<=f);){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(w<16)d>>>=k,f-=k,a.lens[a.have++]=w;else{if(16===w){for(g=k+2;f<g;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(d>>>=k,f-=k,0===a.have){e.msg="invalid bit length repeat",a.mode=BAD;break}D=a.lens[a.have-1],E=3+(3&d),d>>>=2,f-=2}else if(17===w){for(g=k+3;f<g;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}f-=k,D=0,E=3+(7&(d>>>=k)),d>>>=3,f-=3}else{for(g=k+7;f<g;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}f-=k,D=0,E=11+(127&(d>>>=k)),d>>>=7,f-=7}if(a.have+E>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=BAD;break}for(;E--;)a.lens[a.have++]=D}}if(a.mode===BAD)break;if(0===a.lens[256]){e.msg="invalid code -- missing end-of-block",a.mode=BAD;break}if(a.lenbits=9,A={bits:a.lenbits},S=inflate_table(LENS,a.lens,0,a.nlen,a.lencode,0,a.work,A),a.lenbits=A.bits,S){e.msg="invalid literal/lengths set",a.mode=BAD;break}if(a.distbits=6,a.distcode=a.distdyn,A={bits:a.distbits},S=inflate_table(DISTS,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,A),a.distbits=A.bits,S){e.msg="invalid distances set",a.mode=BAD;break}if(a.mode=LEN_,t===Z_TREES)break e;case LEN_:a.mode=LEN;case LEN:if(l>=6&&o>=258){e.next_out=s,e.avail_out=o,e.next_in=r,e.avail_in=l,a.hold=d,a.bits=f,inflate_fast(e,h),s=e.next_out,n=e.output,o=e.avail_out,r=e.next_in,i=e.input,l=e.avail_in,d=a.hold,f=a.bits,a.mode===TYPE&&(a.back=-1);break}for(a.back=0;m=(x=a.lencode[d&(1<<a.lenbits)-1])>>>16&255,w=65535&x,!((k=x>>>24)<=f);){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(m&&0==(240&m)){for(u=k,R=m,T=w;m=(x=a.lencode[T+((d&(1<<u+R)-1)>>u)])>>>16&255,w=65535&x,!(u+(k=x>>>24)<=f);){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}d>>>=u,f-=u,a.back+=u}if(d>>>=k,f-=k,a.back+=k,a.length=w,0===m){a.mode=LIT;break}if(32&m){a.back=-1,a.mode=TYPE;break}if(64&m){e.msg="invalid literal/length code",a.mode=BAD;break}a.extra=15&m,a.mode=LENEXT;case LENEXT:if(a.extra){for(g=a.extra;f<g;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}a.length+=d&(1<<a.extra)-1,d>>>=a.extra,f-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=DIST;case DIST:for(;m=(x=a.distcode[d&(1<<a.distbits)-1])>>>16&255,w=65535&x,!((k=x>>>24)<=f);){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(0==(240&m)){for(u=k,R=m,T=w;m=(x=a.distcode[T+((d&(1<<u+R)-1)>>u)])>>>16&255,w=65535&x,!(u+(k=x>>>24)<=f);){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}d>>>=u,f-=u,a.back+=u}if(d>>>=k,f-=k,a.back+=k,64&m){e.msg="invalid distance code",a.mode=BAD;break}a.offset=w,a.extra=15&m,a.mode=DISTEXT;case DISTEXT:if(a.extra){for(g=a.extra;f<g;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}a.offset+=d&(1<<a.extra)-1,d>>>=a.extra,f-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=BAD;break}a.mode=MATCH;case MATCH:if(0===o)break e;if(E=h-o,a.offset>E){if((E=a.offset-E)>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=BAD;break}E>a.wnext?(E-=a.wnext,_=a.wsize-E):_=a.wnext-E,E>a.length&&(E=a.length),b=a.window}else b=n,_=s-a.offset,E=a.length;E>o&&(E=o),o-=E,a.length-=E;do{n[s++]=b[_++]}while(--E);0===a.length&&(a.mode=LEN);break;case LIT:if(0===o)break e;n[s++]=a.length,o--,a.mode=LEN;break;case CHECK:if(a.wrap){for(;f<32;){if(0===l)break e;l--,d|=i[r++]<<f,f+=8}if(h-=o,e.total_out+=h,a.total+=h,4&a.wrap&&h&&(e.adler=a.check=a.flags?crc32(a.check,n,h,s-h):adler32(a.check,n,h,s-h)),h=o,4&a.wrap&&(a.flags?d:zswap32(d))!==a.check){e.msg="incorrect data check",a.mode=BAD;break}d=0,f=0}a.mode=LENGTH;case LENGTH:if(a.wrap&&a.flags){for(;f<32;){if(0===l)break e;l--,d+=i[r++]<<f,f+=8}if(4&a.wrap&&d!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=BAD;break}d=0,f=0}a.mode=DONE;case DONE:S=Z_STREAM_END;break e;case BAD:S=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return e.next_out=s,e.avail_out=o,e.next_in=r,e.avail_in=l,a.hold=d,a.bits=f,(a.wsize||h!==e.avail_out&&a.mode<BAD&&(a.mode<CHECK||t!==Z_FINISH))&&updatewindow(e,e.output,e.next_out,h-e.avail_out)?(a.mode=MEM,Z_MEM_ERROR):(c-=e.avail_in,h-=e.avail_out,e.total_in+=c,e.total_out+=h,a.total+=h,4&a.wrap&&h&&(e.adler=a.check=a.flags?crc32(a.check,n,h,e.next_out-h):adler32(a.check,n,h,e.next_out-h)),e.data_type=a.bits+(a.last?64:0)+(a.mode===TYPE?128:0)+(a.mode===LEN_||a.mode===COPY_?256:0),(0===c&&0===h||t===Z_FINISH)&&S===Z_OK&&(S=Z_BUF_ERROR),S)},inflateEnd=function(e){if(inflateStateCheck(e))return Z_STREAM_ERROR;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK},inflateGetHeader=function(e,t){if(inflateStateCheck(e))return Z_STREAM_ERROR;var a=e.state;return 0==(2&a.wrap)?Z_STREAM_ERROR:(a.head=t,t.done=!1,Z_OK)},inflateSetDictionary=function(e,t){var a,i=t.length;return inflateStateCheck(e)?Z_STREAM_ERROR:0!==(a=e.state).wrap&&a.mode!==DICT?Z_STREAM_ERROR:a.mode===DICT&&adler32(1,t,i,0)!==a.check?Z_DATA_ERROR:updatewindow(e,t,i,i)?(a.mode=MEM,Z_MEM_ERROR):(a.havedict=1,Z_OK)};module.exports.inflateReset=inflateReset,module.exports.inflateReset2=inflateReset2,module.exports.inflateResetKeep=inflateResetKeep,module.exports.inflateInit=inflateInit,module.exports.inflateInit2=inflateInit2,module.exports.inflate=inflate,module.exports.inflateEnd=inflateEnd,module.exports.inflateGetHeader=inflateGetHeader,module.exports.inflateSetDictionary=inflateSetDictionary,module.exports.inflateInfo="pako inflate (from Nodeca project)";

},{"./adler32":59,"./constants":60,"./crc32":61,"./inffast":64,"./inftrees":66}],66:[function(require,module,exports){
"use strict";var MAXBITS=15,ENOUGH_LENS=852,ENOUGH_DISTS=592,CODES=0,LENS=1,DISTS=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=function(r,e,S,t,n,i,f,a){var E,l,o,A,I,N,T,U,u,b=a.bits,s=0,D=0,O=0,_=0,w=0,B=0,L=0,M=0,X=0,d=0,y=null,G=new Uint16Array(MAXBITS+1),H=new Uint16Array(MAXBITS+1),x=null;for(s=0;s<=MAXBITS;s++)G[s]=0;for(D=0;D<t;D++)G[e[S+D]]++;for(w=b,_=MAXBITS;_>=1&&0===G[_];_--);if(w>_&&(w=_),0===_)return n[i++]=20971520,n[i++]=20971520,a.bits=1,0;for(O=1;O<_&&0===G[O];O++);for(w<O&&(w=O),M=1,s=1;s<=MAXBITS;s++)if(M<<=1,(M-=G[s])<0)return-1;if(M>0&&(r===CODES||1!==_))return-1;for(H[1]=0,s=1;s<MAXBITS;s++)H[s+1]=H[s]+G[s];for(D=0;D<t;D++)0!==e[S+D]&&(f[H[e[S+D]]++]=D);if(r===CODES?(y=x=f,N=20):r===LENS?(y=lbase,x=lext,N=257):(y=dbase,x=dext,N=0),d=0,D=0,s=O,I=i,B=w,L=0,o=-1,A=(X=1<<w)-1,r===LENS&&X>ENOUGH_LENS||r===DISTS&&X>ENOUGH_DISTS)return 1;for(;;){T=s-L,f[D]+1<N?(U=0,u=f[D]):f[D]>=N?(U=x[f[D]-N],u=y[f[D]-N]):(U=96,u=0),E=1<<s-L,O=l=1<<B;do{n[I+(d>>L)+(l-=E)]=T<<24|U<<16|u|0}while(0!==l);for(E=1<<s-1;d&E;)E>>=1;if(0!==E?(d&=E-1,d+=E):d=0,D++,0==--G[s]){if(s===_)break;s=e[S+f[D]]}if(s>w&&(d&A)!==o){for(0===L&&(L=w),I+=O,M=1<<(B=s-L);B+L<_&&!((M-=G[B+L])<=0);)B++,M<<=1;if(X+=1<<B,r===LENS&&X>ENOUGH_LENS||r===DISTS&&X>ENOUGH_DISTS)return 1;n[o=d&A]=w<<24|B<<16|I-i|0}}return 0!==d&&(n[I+d]=s-L<<24|64<<16|0),a.bits=w,0};module.exports=inflate_table;

},{}],67:[function(require,module,exports){
"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};

},{}],68:[function(require,module,exports){
"use strict";var Z_FIXED=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN=2;function zero(e){for(var _=e.length;--_>=0;)e[_]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES+2));zero(static_ltree);var static_dtree=new Array(2*D_CODES);zero(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero(_dist_code);var _length_code=new Array(MAX_MATCH-MIN_MATCH+1);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var static_l_desc,static_d_desc,static_bl_desc,base_dist=new Array(D_CODES);function StaticTreeDesc(e,_,t,r,n){this.static_tree=e,this.extra_bits=_,this.extra_base=t,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function TreeDesc(e,_){this.dyn_tree=e,this.max_code=0,this.stat_desc=_}zero(base_dist);var d_code=function(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]},put_short=function(e,_){e.pending_buf[e.pending++]=255&_,e.pending_buf[e.pending++]=_>>>8&255},send_bits=function(e,_,t){e.bi_valid>Buf_size-t?(e.bi_buf|=_<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=_>>Buf_size-e.bi_valid,e.bi_valid+=t-Buf_size):(e.bi_buf|=_<<e.bi_valid&65535,e.bi_valid+=t)},send_code=function(e,_,t){send_bits(e,t[2*_],t[2*_+1])},bi_reverse=function(e,_){var t=0;do{t|=1&e,e>>>=1,t<<=1}while(--_>0);return t>>>1},bi_flush=function(e){16===e.bi_valid?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},gen_bitlen=function(e,_){var t,r,n,s,i,d,a=_.dyn_tree,l=_.max_code,c=_.stat_desc.static_tree,o=_.stat_desc.has_stree,b=_.stat_desc.extra_bits,f=_.stat_desc.extra_base,u=_.stat_desc.max_length,p=0;for(s=0;s<=MAX_BITS;s++)e.bl_count[s]=0;for(a[2*e.heap[e.heap_max]+1]=0,t=e.heap_max+1;t<HEAP_SIZE;t++)(s=a[2*a[2*(r=e.heap[t])+1]+1]+1)>u&&(s=u,p++),a[2*r+1]=s,r>l||(e.bl_count[s]++,i=0,r>=f&&(i=b[r-f]),d=a[2*r],e.opt_len+=d*(s+i),o&&(e.static_len+=d*(c[2*r+1]+i)));if(0!==p){do{for(s=u-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[u]--,p-=2}while(p>0);for(s=u;0!==s;s--)for(r=e.bl_count[s];0!==r;)(n=e.heap[--t])>l||(a[2*n+1]!==s&&(e.opt_len+=(s-a[2*n+1])*a[2*n],a[2*n+1]=s),r--)}},gen_codes=function(e,_,t){var r,n,s=new Array(MAX_BITS+1),i=0;for(r=1;r<=MAX_BITS;r++)i=i+t[r-1]<<1,s[r]=i;for(n=0;n<=_;n++){var d=e[2*n+1];0!==d&&(e[2*n]=bi_reverse(s[d]++,d))}},tr_static_init=function(){var e,_,t,r,n,s=new Array(MAX_BITS+1);for(t=0,r=0;r<LENGTH_CODES-1;r++)for(base_length[r]=t,e=0;e<1<<extra_lbits[r];e++)_length_code[t++]=r;for(_length_code[t-1]=r,n=0,r=0;r<16;r++)for(base_dist[r]=n,e=0;e<1<<extra_dbits[r];e++)_dist_code[n++]=r;for(n>>=7;r<D_CODES;r++)for(base_dist[r]=n<<7,e=0;e<1<<extra_dbits[r]-7;e++)_dist_code[256+n++]=r;for(_=0;_<=MAX_BITS;_++)s[_]=0;for(e=0;e<=143;)static_ltree[2*e+1]=8,e++,s[8]++;for(;e<=255;)static_ltree[2*e+1]=9,e++,s[9]++;for(;e<=279;)static_ltree[2*e+1]=7,e++,s[7]++;for(;e<=287;)static_ltree[2*e+1]=8,e++,s[8]++;for(gen_codes(static_ltree,L_CODES+1,s),e=0;e<D_CODES;e++)static_dtree[2*e+1]=5,static_dtree[2*e]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)},init_block=function(e){var _;for(_=0;_<L_CODES;_++)e.dyn_ltree[2*_]=0;for(_=0;_<D_CODES;_++)e.dyn_dtree[2*_]=0;for(_=0;_<BL_CODES;_++)e.bl_tree[2*_]=0;e.dyn_ltree[2*END_BLOCK]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},bi_windup=function(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},smaller=function(e,_,t,r){var n=2*_,s=2*t;return e[n]<e[s]||e[n]===e[s]&&r[_]<=r[t]},pqdownheap=function(e,_,t){for(var r=e.heap[t],n=t<<1;n<=e.heap_len&&(n<e.heap_len&&smaller(_,e.heap[n+1],e.heap[n],e.depth)&&n++,!smaller(_,r,e.heap[n],e.depth));)e.heap[t]=e.heap[n],t=n,n<<=1;e.heap[t]=r},compress_block=function(e,_,t){var r,n,s,i,d=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+d++],r+=(255&e.pending_buf[e.sym_buf+d++])<<8,n=e.pending_buf[e.sym_buf+d++],0===r?send_code(e,n,_):(s=_length_code[n],send_code(e,s+LITERALS+1,_),0!==(i=extra_lbits[s])&&(n-=base_length[s],send_bits(e,n,i)),s=d_code(--r),send_code(e,s,t),0!==(i=extra_dbits[s])&&(r-=base_dist[s],send_bits(e,r,i)))}while(d<e.sym_next);send_code(e,END_BLOCK,_)},build_tree=function(e,_){var t,r,n,s=_.dyn_tree,i=_.stat_desc.static_tree,d=_.stat_desc.has_stree,a=_.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=HEAP_SIZE,t=0;t<a;t++)0!==s[2*t]?(e.heap[++e.heap_len]=l=t,e.depth[t]=0):s[2*t+1]=0;for(;e.heap_len<2;)s[2*(n=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[n]=0,e.opt_len--,d&&(e.static_len-=i[2*n+1]);for(_.max_code=l,t=e.heap_len>>1;t>=1;t--)pqdownheap(e,s,t);n=a;do{t=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,s,1),r=e.heap[1],e.heap[--e.heap_max]=t,e.heap[--e.heap_max]=r,s[2*n]=s[2*t]+s[2*r],e.depth[n]=(e.depth[t]>=e.depth[r]?e.depth[t]:e.depth[r])+1,s[2*t+1]=s[2*r+1]=n,e.heap[1]=n++,pqdownheap(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,_),gen_codes(s,l,e.bl_count)},scan_tree=function(e,_,t){var r,n,s=-1,i=_[1],d=0,a=7,l=4;for(0===i&&(a=138,l=3),_[2*(t+1)+1]=65535,r=0;r<=t;r++)n=i,i=_[2*(r+1)+1],++d<a&&n===i||(d<l?e.bl_tree[2*n]+=d:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[2*REP_3_6]++):d<=10?e.bl_tree[2*REPZ_3_10]++:e.bl_tree[2*REPZ_11_138]++,d=0,s=n,0===i?(a=138,l=3):n===i?(a=6,l=3):(a=7,l=4))},send_tree=function(e,_,t){var r,n,s=-1,i=_[1],d=0,a=7,l=4;for(0===i&&(a=138,l=3),r=0;r<=t;r++)if(n=i,i=_[2*(r+1)+1],!(++d<a&&n===i)){if(d<l)do{send_code(e,n,e.bl_tree)}while(0!=--d);else 0!==n?(n!==s&&(send_code(e,n,e.bl_tree),d--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,d-3,2)):d<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,d-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,d-11,7));d=0,s=n,0===i?(a=138,l=3):n===i?(a=6,l=3):(a=7,l=4)}},build_bl_tree=function(e){var _;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),_=BL_CODES-1;_>=3&&0===e.bl_tree[2*bl_order[_]+1];_--);return e.opt_len+=3*(_+1)+5+5+4,_},send_all_trees=function(e,_,t,r){var n;for(send_bits(e,_-257,5),send_bits(e,t-1,5),send_bits(e,r-4,4),n=0;n<r;n++)send_bits(e,e.bl_tree[2*bl_order[n]+1],3);send_tree(e,e.dyn_ltree,_-1),send_tree(e,e.dyn_dtree,t-1)},detect_data_type=function(e){var _,t=4093624447;for(_=0;_<=31;_++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*_])return Z_BINARY;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Z_TEXT;for(_=32;_<LITERALS;_++)if(0!==e.dyn_ltree[2*_])return Z_TEXT;return Z_BINARY},static_init_done=!1,_tr_init=function(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)},_tr_stored_block=function(e,_,t,r){send_bits(e,(STORED_BLOCK<<1)+(r?1:0),3),bi_windup(e),put_short(e,t),put_short(e,~t),t&&e.pending_buf.set(e.window.subarray(_,_+t),e.pending),e.pending+=t},_tr_align=function(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)},_tr_flush_block=function(e,_,t,r){var n,s,i=0;e.level>0?(e.strm.data_type===Z_UNKNOWN&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),i=build_bl_tree(e),n=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=n&&(n=s)):n=s=t+5,t+4<=n&&-1!==_?_tr_stored_block(e,_,t,r):e.strategy===Z_FIXED||s===n?(send_bits(e,(STATIC_TREES<<1)+(r?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(r?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),r&&bi_windup(e)},_tr_tally=function(e,_,t){return e.pending_buf[e.sym_buf+e.sym_next++]=_,e.pending_buf[e.sym_buf+e.sym_next++]=_>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,0===_?e.dyn_ltree[2*t]++:(e.matches++,_--,e.dyn_ltree[2*(_length_code[t]+LITERALS+1)]++,e.dyn_dtree[2*d_code(_)]++),e.sym_next===e.sym_end};module.exports._tr_init=_tr_init,module.exports._tr_stored_block=_tr_stored_block,module.exports._tr_flush_block=_tr_flush_block,module.exports._tr_tally=_tr_tally,module.exports._tr_align=_tr_align;

},{}],69:[function(require,module,exports){
"use strict";function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}module.exports=ZStream;

},{}],70:[function(require,module,exports){
"use strict";var http=require("http"),url=require("url"),https=module.exports;for(var key in http)http.hasOwnProperty(key)&&(https[key]=http[key]);function validateParams(t){if("string"==typeof t&&(t=url.parse(t)),t.protocol||(t.protocol="https:"),"https:"!==t.protocol)throw new Error('Protocol "'+t.protocol+'" not supported. Expected "https:"');return t}https.request=function(t,r){return t=validateParams(t),http.request.call(this,t,r)},https.get=function(t,r){return t=validateParams(t),http.get.call(this,t,r)};

},{"http":428,"url":449}],71:[function(require,module,exports){
"use strict";exports.read=function(t,a,o,r,h){var M,p,w=8*h-r-1,e=(1<<w)-1,f=e>>1,i=-7,s=o?h-1:0,N=o?-1:1,n=t[a+s];for(s+=N,M=n&(1<<-i)-1,n>>=-i,i+=w;i>0;M=256*M+t[a+s],s+=N,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+t[a+s],s+=N,i-=8);if(0===M)M=1-f;else{if(M===e)return p?NaN:1/0*(n?-1:1);p+=Math.pow(2,r),M-=f}return(n?-1:1)*p*Math.pow(2,M-r)},exports.write=function(t,a,o,r,h,M){var p,w,e,f=8*M-h-1,i=(1<<f)-1,s=i>>1,N=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,n=r?0:M-1,u=r?1:-1,c=a<0||0===a&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(w=isNaN(a)?1:0,p=i):(p=Math.floor(Math.log(a)/Math.LN2),a*(e=Math.pow(2,-p))<1&&(p--,e*=2),(a+=p+s>=1?N/e:N*Math.pow(2,1-s))*e>=2&&(p++,e/=2),p+s>=i?(w=0,p=i):p+s>=1?(w=(a*e-1)*Math.pow(2,h),p+=s):(w=a*Math.pow(2,s-1)*Math.pow(2,h),p=0));h>=8;t[o+n]=255&w,n+=u,w/=256,h-=8);for(p=p<<h|w,f+=h;f>0;t[o+n]=255&p,n+=u,p/=256,f-=8);t[o+n-u]|=128*c};

},{}],72:[function(require,module,exports){
"use strict";"function"==typeof Object.create?module.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}};

},{}],73:[function(require,module,exports){
"use strict";!function(){var e,t,r,i,a,n,s,l,f,o,u,c,d,h,m,p,g=(e={defaultNoDataValue:-3.4027999387901484e38,decode:function(n,s){var l=(s=s||{}).encodedMaskData||null===s.encodedMaskData,f=a(n,s.inputOffset||0,l),o=null!==s.noDataValue?s.noDataValue:e.defaultNoDataValue,u=t(f,s.pixelType||Float32Array,s.encodedMaskData,o,s.returnMask),c={width:f.width,height:f.height,pixelData:u.resultPixels,minValue:u.minValue,maxValue:f.pixels.maxValue,noDataValue:o};return u.resultMask&&(c.maskData=u.resultMask),s.returnEncodedMask&&f.mask&&(c.encodedMaskData=f.mask.bitset?f.mask.bitset:null),s.returnFileInfo&&(c.fileInfo=r(f),s.computeUsedBitDepths&&(c.fileInfo.bitDepths=i(f))),c}},t=function(e,t,r,i,a){var s,l,f,o=0,u=e.pixels.numBlocksX,c=e.pixels.numBlocksY,d=Math.floor(e.width/u),h=Math.floor(e.height/c),m=2*e.maxZError,p=Number.MAX_VALUE;r=r||(e.mask?e.mask.bitset:null),l=new t(e.width*e.height),a&&r&&(f=new Uint8Array(e.width*e.height));for(var g,x,w=new Float32Array(d*h),k=0;k<=c;k++){var y=k!==c?h:e.height%c;if(0!==y)for(var b=0;b<=u;b++){var v=b!==u?d:e.width%u;if(0!==v){var U,I,V,M,D=k*e.width*h+b*d,A=e.width-v,B=e.pixels.blocks[o];if(B.encoding<2?(0===B.encoding?U=B.rawData:(n(B.stuffedData,B.bitsPerPixel,B.numValidPixels,B.offset,m,w,e.pixels.maxValue),U=w),I=0):V=2===B.encoding?0:B.offset,r)for(x=0;x<y;x++){for(7&D&&(M=r[D>>3],M<<=7&D),g=0;g<v;g++)7&D||(M=r[D>>3]),128&M?(f&&(f[D]=1),p=p>(s=B.encoding<2?U[I++]:V)?s:p,l[D++]=s):(f&&(f[D]=0),l[D++]=i),M<<=1;D+=A}else if(B.encoding<2)for(x=0;x<y;x++){for(g=0;g<v;g++)p=p>(s=U[I++])?s:p,l[D++]=s;D+=A}else for(p=p>V?V:p,x=0;x<y;x++){for(g=0;g<v;g++)l[D++]=V;D+=A}if(1===B.encoding&&I!==B.numValidPixels)throw"Block and Mask do not match";o++}}}return{resultPixels:l,resultMask:f,minValue:p}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},i=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},i=0;i<t;i++){var a=e.pixels.blocks[i];0===a.encoding?r.float32=!0:1===a.encoding?r[a.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},a=function(e,t,r){var i={},a=new Uint8Array(e,t,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,a),"CntZImage"!==i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;t+=10;var n=new DataView(e,t,24);if(i.fileVersion=n.getInt32(0,!0),i.imageType=n.getInt32(4,!0),i.height=n.getUint32(8,!0),i.width=n.getUint32(12,!0),i.maxZError=n.getFloat64(16,!0),t+=24,!r)if(n=new DataView(e,t,16),i.mask={},i.mask.numBlocksY=n.getUint32(0,!0),i.mask.numBlocksX=n.getUint32(4,!0),i.mask.numBytes=n.getUint32(8,!0),i.mask.maxValue=n.getFloat32(12,!0),t+=16,i.mask.numBytes>0){var s=new Uint8Array(Math.ceil(i.width*i.height/8)),l=(n=new DataView(e,t,i.mask.numBytes)).getInt16(0,!0),f=2,o=0;do{if(l>0)for(;l--;)s[o++]=n.getUint8(f++);else{var u=n.getUint8(f++);for(l=-l;l--;)s[o++]=u}l=n.getInt16(f,!0),f+=2}while(f<i.mask.numBytes);if(-32768!==l||o<s.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=s,t+=i.mask.numBytes}else 0==(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)&&(i.mask.bitset=new Uint8Array(Math.ceil(i.width*i.height/8)));n=new DataView(e,t,16),i.pixels={},i.pixels.numBlocksY=n.getUint32(0,!0),i.pixels.numBlocksX=n.getUint32(4,!0),i.pixels.numBytes=n.getUint32(8,!0),i.pixels.maxValue=n.getFloat32(12,!0),t+=16;var c=i.pixels.numBlocksX,d=i.pixels.numBlocksY,h=c+(i.width%c>0?1:0),m=d+(i.height%d>0?1:0);i.pixels.blocks=new Array(h*m);for(var p=0,g=0;g<m;g++)for(var x=0;x<h;x++){var w=0,k=e.byteLength-t;n=new DataView(e,t,Math.min(10,k));var y={};i.pixels.blocks[p++]=y;var b=n.getUint8(0);if(w++,y.encoding=63&b,y.encoding>3)throw"Invalid block encoding ("+y.encoding+")";if(2!==y.encoding){if(0!==b&&2!==b){if(b>>=6,y.offsetType=b,2===b)y.offset=n.getInt8(1),w++;else if(1===b)y.offset=n.getInt16(1,!0),w+=2;else{if(0!==b)throw"Invalid block offset type";y.offset=n.getFloat32(1,!0),w+=4}if(1===y.encoding)if(b=n.getUint8(w),w++,y.bitsPerPixel=63&b,b>>=6,y.numValidPixelsType=b,2===b)y.numValidPixels=n.getUint8(w),w++;else if(1===b)y.numValidPixels=n.getUint16(w,!0),w+=2;else{if(0!==b)throw"Invalid valid pixel count type";y.numValidPixels=n.getUint32(w,!0),w+=4}}var v;if(t+=w,3!==y.encoding)if(0===y.encoding){var U=(i.pixels.numBytes-1)/4;if(U!==Math.floor(U))throw"uncompressed block has invalid length";v=new ArrayBuffer(4*U),new Uint8Array(v).set(new Uint8Array(e,t,4*U));var I=new Float32Array(v);y.rawData=I,t+=4*U}else if(1===y.encoding){var V=Math.ceil(y.numValidPixels*y.bitsPerPixel/8),M=Math.ceil(V/4);v=new ArrayBuffer(4*M),new Uint8Array(v).set(new Uint8Array(e,t,V)),y.stuffedData=new Uint32Array(v),t+=V}}else t++}return i.eofOffset=t,i},n=function(e,t,r,i,a,n,s){var l,f,o,u=(1<<t)-1,c=0,d=0,h=Math.ceil((s-i)/a),m=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*m,l=0;l<r;l++){if(0===d&&(o=e[c++],d=32),d>=t)f=o>>>d-t&u,d-=t;else{var p=t-d;f=(o&u)<<p&u,f+=(o=e[c++])>>>(d=32-p)}n[l]=f<h?i+f*a:s}return n},e),x=(s=function(e,t,r,i,a,n,s,l){var f,o,u,c,d,h=(1<<r)-1,m=0,p=0,g=4*e.length-Math.ceil(r*i/8);if(e[e.length-1]<<=8*g,a)for(f=0;f<i;f++)0===p&&(u=e[m++],p=32),p>=r?(o=u>>>p-r&h,p-=r):(o=(u&h)<<(c=r-p)&h,o+=(u=e[m++])>>>(p=32-c)),t[f]=a[o];else for(d=Math.ceil((l-n)/s),f=0;f<i;f++)0===p&&(u=e[m++],p=32),p>=r?(o=u>>>p-r&h,p-=r):(o=(u&h)<<(c=r-p)&h,o+=(u=e[m++])>>>(p=32-c)),t[f]=o<d?n+o*s:l},l=function(e,t,r,i,a,n){var s,l=(1<<t)-1,f=0,o=0,u=0,c=0,d=0,h=[],m=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*m;var p=Math.ceil((n-i)/a);for(o=0;o<r;o++)0===c&&(s=e[f++],c=32),c>=t?(d=s>>>c-t&l,c-=t):(d=(s&l)<<(u=t-c)&l,d+=(s=e[f++])>>>(c=32-u)),h[o]=d<p?i+d*a:n;return h.unshift(i),h},f=function(e,t,r,i,a,n,s,l){var f,o,u,c,d=(1<<r)-1,h=0,m=0,p=0;if(a)for(f=0;f<i;f++)0===m&&(u=e[h++],m=32,p=0),m>=r?(o=u>>>p&d,m-=r,p+=r):(o=u>>>p&d,m=32-(c=r-m),o|=((u=e[h++])&(1<<c)-1)<<r-c,p=c),t[f]=a[o];else{var g=Math.ceil((l-n)/s);for(f=0;f<i;f++)0===m&&(u=e[h++],m=32,p=0),m>=r?(o=u>>>p&d,m-=r,p+=r):(o=u>>>p&d,m=32-(c=r-m),o|=((u=e[h++])&(1<<c)-1)<<r-c,p=c),t[f]=o<g?n+o*s:l}return t},o=function(e,t,r,i,a,n){var s,l=(1<<t)-1,f=0,o=0,u=0,c=0,d=0,h=0,m=[],p=Math.ceil((n-i)/a);for(o=0;o<r;o++)0===c&&(s=e[f++],c=32,h=0),c>=t?(d=s>>>h&l,c-=t,h+=t):(d=s>>>h&l,c=32-(u=t-c),d|=((s=e[f++])&(1<<u)-1)<<t-u,h=u),m[o]=d<p?i+d*a:n;return m.unshift(i),m},u=function(e,t,r,i){var a,n,s,l,f=(1<<r)-1,o=0,u=0,c=4*e.length-Math.ceil(r*i/8);for(e[e.length-1]<<=8*c,a=0;a<i;a++)0===u&&(s=e[o++],u=32),u>=r?(n=s>>>u-r&f,u-=r):(n=(s&f)<<(l=r-u)&f,n+=(s=e[o++])>>>(u=32-l)),t[a]=n;return t},c=function(e,t,r,i){var a,n,s,l,f=(1<<r)-1,o=0,u=0,c=0;for(a=0;a<i;a++)0===u&&(s=e[o++],u=32,c=0),u>=r?(n=s>>>c&f,u-=r,c+=r):(n=s>>>c&f,u=32-(l=r-u),n|=((s=e[o++])&(1<<l)-1)<<r-l,c=l),t[a]=n;return t},d={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,i=e.length,a=Math.floor(i/2),n=0;a;){var s=a>=359?359:a;a-=s;do{t+=e[n++]<<8,r+=t+=e[n++]}while(--s);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&i&&(r+=t+=e[n]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,i=new Uint8Array(e,r,6),a={};if(a.fileIdentifierString=String.fromCharCode.apply(null,i),0!==a.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;r+=6;var n,s=new DataView(e,r,8),l=s.getInt32(0,!0);if(a.fileVersion=l,r+=4,l>=3&&(a.checksum=s.getUint32(4,!0),r+=4),s=new DataView(e,r,12),a.height=s.getUint32(0,!0),a.width=s.getUint32(4,!0),r+=8,l>=4?(a.numDims=s.getUint32(8,!0),r+=4):a.numDims=1,s=new DataView(e,r,40),a.numValidPixel=s.getUint32(0,!0),a.microBlockSize=s.getInt32(4,!0),a.blobSize=s.getInt32(8,!0),a.imageType=s.getInt32(12,!0),a.maxZError=s.getFloat64(16,!0),a.zMin=s.getFloat64(24,!0),a.zMax=s.getFloat64(32,!0),r+=40,t.headerInfo=a,t.ptr=r,l>=3&&(n=l>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-n,a.blobSize-14))!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,i=this.getDataTypeArray(r.imageType),a=r.numDims*this.getDataTypeSize(r.imageType),n=this.readSubArray(e,t.ptr,i,a),s=this.readSubArray(e,t.ptr+a,i,a);t.ptr+=2*a;var l,f=!0;for(l=0;l<r.numDims;l++)if(n[l]!==s[l]){f=!1;break}return r.minValues=n,r.maxValues=s,f},readSubArray:function(e,t,r,i){var a;if(r===Uint8Array)a=new Uint8Array(e,t,i);else{var n=new ArrayBuffer(i);new Uint8Array(n).set(new Uint8Array(e,t,i)),a=new r(n)}return a},readMask:function(e,t){var r,i,a=t.ptr,n=t.headerInfo,s=n.width*n.height,l=n.numValidPixel,f=new DataView(e,a,4),o={};if(o.numBytes=f.getUint32(0,!0),a+=4,(0===l||s===l)&&0!==o.numBytes)throw"invalid mask";if(0===l)r=new Uint8Array(Math.ceil(s/8)),o.bitset=r,i=new Uint8Array(s),t.pixels.resultMask=i,a+=o.numBytes;else if(o.numBytes>0){r=new Uint8Array(Math.ceil(s/8));var u=(f=new DataView(e,a,o.numBytes)).getInt16(0,!0),c=2,d=0,h=0;do{if(u>0)for(;u--;)r[d++]=f.getUint8(c++);else for(h=f.getUint8(c++),u=-u;u--;)r[d++]=h;u=f.getInt16(c,!0),c+=2}while(c<o.numBytes);if(-32768!==u||d<r.length)throw"Unexpected end of mask RLE encoding";i=new Uint8Array(s);var m=0,p=0;for(p=0;p<s;p++)7&p?(m=r[p>>3],m<<=7&p):m=r[p>>3],128&m&&(i[p]=1);t.pixels.resultMask=i,o.bitset=r,a+=o.numBytes}return t.ptr=a,t.mask=o,!0},readDataOneSweep:function(e,t,r,i){var a,n=t.ptr,s=t.headerInfo,l=s.numDims,f=s.width*s.height,o=s.imageType,u=s.numValidPixel*d.getDataTypeSize(o)*l,c=t.pixels.resultMask;if(r===Uint8Array)a=new Uint8Array(e,n,u);else{var h=new ArrayBuffer(u);new Uint8Array(h).set(new Uint8Array(e,n,u)),a=new r(h)}if(a.length===f*l)t.pixels.resultPixels=i?d.swapDimensionOrder(a,f,l,r,!0):a;else{t.pixels.resultPixels=new r(f*l);var m=0,p=0,g=0,x=0;if(l>1){if(i){for(p=0;p<f;p++)if(c[p])for(x=p,g=0;g<l;g++,x+=f)t.pixels.resultPixels[x]=a[m++]}else for(p=0;p<f;p++)if(c[p])for(x=p*l,g=0;g<l;g++)t.pixels.resultPixels[x+g]=a[m++]}else for(p=0;p<f;p++)c[p]&&(t.pixels.resultPixels[p]=a[m++])}return n+=u,t.ptr=n,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,i=new DataView(e,t.ptr,16);if(t.ptr+=16,i.getInt32(0,!0)<2)throw"unsupported Huffman version";var a=i.getInt32(4,!0),n=i.getInt32(8,!0),s=i.getInt32(12,!0);if(n>=s)return!1;var l=new Uint32Array(s-n);d.decodeBits(e,t,l);var f,o,u,c,m=[];for(f=n;f<s;f++)m[o=f-(f<a?0:a)]={first:l[f-n],second:null};var p=e.byteLength-t.ptr,g=Math.ceil(p/4),x=new ArrayBuffer(4*g);new Uint8Array(x).set(new Uint8Array(e,t.ptr,p));var w,k=new Uint32Array(x),y=0,b=0;for(w=k[0],f=n;f<s;f++)(c=m[o=f-(f<a?0:a)].first)>0&&(m[o].second=w<<y>>>32-c,32-y>=c?32===(y+=c)&&(y=0,w=k[++b]):(y+=c-32,w=k[++b],m[o].second|=w>>>32-y));var v=0,U=0,I=new h;for(f=0;f<m.length;f++)void 0!==m[f]&&(v=Math.max(v,m[f].first));U=v>=r?r:v;var V,M,D,A,B,P=[];for(f=n;f<s;f++)if((c=m[o=f-(f<a?0:a)].first)>0)if(V=[c,o],c<=U)for(M=m[o].second<<U-c,D=1<<U-c,u=0;u<D;u++)P[M|u]=V;else for(M=m[o].second,B=I,A=c-1;A>=0;A--)M>>>A&1?(B.right||(B.right=new h),B=B.right):(B.left||(B.left=new h),B=B.left),0!==A||B.val||(B.val=V[1]);return{decodeLut:P,numBitsLUTQick:U,numBitsLUT:v,tree:I,stuffedData:k,srcPtr:b,bitPos:y}},readHuffman:function(e,t,r,i){var a,n,s,l,f,o,u,c,h,m=t.headerInfo.numDims,p=t.headerInfo.height,g=t.headerInfo.width,x=g*p,w=this.readHuffmanTree(e,t),k=w.decodeLut,y=w.tree,b=w.stuffedData,v=w.srcPtr,U=w.bitPos,I=w.numBitsLUTQick,V=w.numBitsLUT,M=0===t.headerInfo.imageType?128:0,D=t.pixels.resultMask,A=0;U>0&&(v++,U=0);var B,P=b[v],T=1===t.encodeMode,S=new r(x*m),z=S;if(m<2||T){for(B=0;B<m;B++)if(m>1&&(z=new r(S.buffer,x*B,x),A=0),t.headerInfo.numValidPixel===g*p)for(c=0,o=0;o<p;o++)for(u=0;u<g;u++,c++){if(n=0,f=l=P<<U>>>32-I,32-U<I&&(f=l|=b[v+1]>>>64-U-I),k[f])n=k[f][1],U+=k[f][0];else for(f=l=P<<U>>>32-V,32-U<V&&(f=l|=b[v+1]>>>64-U-V),a=y,h=0;h<V;h++)if(!(a=l>>>V-h-1&1?a.right:a.left).left&&!a.right){n=a.val,U=U+h+1;break}U>=32&&(U-=32,P=b[++v]),s=n-M,T?(s+=u>0?A:o>0?z[c-g]:A,s&=255,z[c]=s,A=s):z[c]=s}else for(c=0,o=0;o<p;o++)for(u=0;u<g;u++,c++)if(D[c]){if(n=0,f=l=P<<U>>>32-I,32-U<I&&(f=l|=b[v+1]>>>64-U-I),k[f])n=k[f][1],U+=k[f][0];else for(f=l=P<<U>>>32-V,32-U<V&&(f=l|=b[v+1]>>>64-U-V),a=y,h=0;h<V;h++)if(!(a=l>>>V-h-1&1?a.right:a.left).left&&!a.right){n=a.val,U=U+h+1;break}U>=32&&(U-=32,P=b[++v]),s=n-M,T?(u>0&&D[c-1]?s+=A:o>0&&D[c-g]?s+=z[c-g]:s+=A,s&=255,z[c]=s,A=s):z[c]=s}}else for(c=0,o=0;o<p;o++)for(u=0;u<g;u++)if(c=o*g+u,!D||D[c])for(B=0;B<m;B++,c+=x){if(n=0,f=l=P<<U>>>32-I,32-U<I&&(f=l|=b[v+1]>>>64-U-I),k[f])n=k[f][1],U+=k[f][0];else for(f=l=P<<U>>>32-V,32-U<V&&(f=l|=b[v+1]>>>64-U-V),a=y,h=0;h<V;h++)if(!(a=l>>>V-h-1&1?a.right:a.left).left&&!a.right){n=a.val,U=U+h+1;break}U>=32&&(U-=32,P=b[++v]),s=n-M,z[c]=s}t.ptr=t.ptr+4*(v+1)+(U>0?4:0),t.pixels.resultPixels=S,m>1&&!i&&(t.pixels.resultPixels=d.swapDimensionOrder(S,x,m,r))},decodeBits:function(e,t,r,i,a){var n=t.headerInfo,d=n.fileVersion,h=0,m=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,p=new DataView(e,t.ptr,m),g=p.getUint8(0);h++;var x=g>>6,w=0===x?4:3-x,k=(32&g)>0,y=31&g,b=0;if(1===w)b=p.getUint8(h),h++;else if(2===w)b=p.getUint16(h,!0),h+=2;else{if(4!==w)throw"Invalid valid pixel count type";b=p.getUint32(h,!0),h+=4}var v,U,I,V,M,D,A,B,P,T=2*n.maxZError,S=n.numDims>1?n.maxValues[a]:n.zMax;if(k){for(t.counter.lut++,B=p.getUint8(h),y,h++,V=Math.ceil((B-1)*y/8),M=Math.ceil(V/4),U=new ArrayBuffer(4*M),I=new Uint8Array(U),t.ptr+=h,I.set(new Uint8Array(e,t.ptr,V)),A=new Uint32Array(U),t.ptr+=V,P=0;B-1>>>P;)P++;V=Math.ceil(b*P/8),M=Math.ceil(V/4),U=new ArrayBuffer(4*M),(I=new Uint8Array(U)).set(new Uint8Array(e,t.ptr,V)),v=new Uint32Array(U),t.ptr+=V,D=d>=3?o(A,y,B-1,i,T,S):l(A,y,B-1,i,T,S),d>=3?f(v,r,P,b,D):s(v,r,P,b,D)}else t.counter.bitstuffer++,P=y,t.ptr+=h,P>0&&(V=Math.ceil(b*P/8),M=Math.ceil(V/4),U=new ArrayBuffer(4*M),(I=new Uint8Array(U)).set(new Uint8Array(e,t.ptr,V)),v=new Uint32Array(U),t.ptr+=V,d>=3?null==i?c(v,r,P,b):f(v,r,P,b,!1,i,T,S):null==i?u(v,r,P,b):s(v,r,P,b,!1,i,T,S))},readTiles:function(e,t,r,i){var a=t.headerInfo,n=a.width,s=a.height,l=n*s,f=a.microBlockSize,o=a.imageType,u=d.getDataTypeSize(o),c=Math.ceil(n/f),h=Math.ceil(s/f);t.pixels.numBlocksY=h,t.pixels.numBlocksX=c,t.pixels.ptr=0;var m,p,g,x,w,k,y,b,v,U,I=0,V=0,M=0,D=0,A=0,B=0,P=0,T=0,S=0,z=0,F=0,O=0,L=0,C=0,X=0,E=new r(f*f),Y=s%f||f,H=n%f||f,Z=a.numDims,_=t.pixels.resultMask,N=t.pixels.resultPixels,R=a.fileVersion>=5?14:15,Q=a.zMax;for(M=0;M<h;M++)for(A=M!==h-1?f:Y,D=0;D<c;D++)for(z=M*n*f+D*f,F=n-(B=D!==c-1?f:H),b=0;b<Z;b++){if(Z>1?(U=N,z=M*n*f+D*f,N=new r(t.pixels.resultPixels.buffer,l*b*u,l),Q=a.maxValues[b]):U=null,P=e.byteLength-t.ptr,p={},X=0,T=(m=new DataView(e,t.ptr,Math.min(10,P))).getUint8(0),X++,v=a.fileVersion>=5?4&T:0,S=T>>6&255,(T>>2&R)!==(D*f>>3&R))throw"integrity issue";if(v&&0===b)throw"integrity issue";if((w=3&T)>3)throw t.ptr+=X,"Invalid block encoding ("+w+")";if(2!==w)if(0===w){if(v)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=X,O=(O=A*B*u)<(L=e.byteLength-t.ptr)?O:L,g=new ArrayBuffer(O%u==0?O:O+u-O%u),new Uint8Array(g).set(new Uint8Array(e,t.ptr,O)),x=new r(g),C=0,_)for(I=0;I<A;I++){for(V=0;V<B;V++)_[z]&&(N[z]=x[C++]),z++;z+=F}else for(I=0;I<A;I++){for(V=0;V<B;V++)N[z++]=x[C++];z+=F}t.ptr+=C*u}else if(k=d.getDataTypeUsed(v&&o<6?4:o,S),y=d.getOnePixel(p,X,k,m),X+=d.getDataTypeSize(k),3===w)if(t.ptr+=X,t.counter.constantoffset++,_)for(I=0;I<A;I++){for(V=0;V<B;V++)_[z]&&(N[z]=v?Math.min(Q,U[z]+y):y),z++;z+=F}else for(I=0;I<A;I++){for(V=0;V<B;V++)N[z]=v?Math.min(Q,U[z]+y):y,z++;z+=F}else if(t.ptr+=X,d.decodeBits(e,t,E,y,b),X=0,v)if(_)for(I=0;I<A;I++){for(V=0;V<B;V++)_[z]&&(N[z]=E[X++]+U[z]),z++;z+=F}else for(I=0;I<A;I++){for(V=0;V<B;V++)N[z]=E[X++]+U[z],z++;z+=F}else if(_)for(I=0;I<A;I++){for(V=0;V<B;V++)_[z]&&(N[z]=E[X++]),z++;z+=F}else for(I=0;I<A;I++){for(V=0;V<B;V++)N[z++]=E[X++];z+=F}else{if(v)if(_)for(I=0;I<A;I++)for(V=0;V<B;V++)_[z]&&(N[z]=U[z]),z++;else for(I=0;I<A;I++)for(V=0;V<B;V++)N[z]=U[z],z++;t.counter.constant++,t.ptr+=X}}Z>1&&!i&&(t.pixels.resultPixels=d.swapDimensionOrder(t.pixels.resultPixels,l,Z,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:d.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,i=e.headerInfo.zMin,a=e.headerInfo.maxValues,n=e.headerInfo.numDims,s=e.headerInfo.height*e.headerInfo.width,l=0,f=0,o=0,u=e.pixels.resultMask,c=e.pixels.resultPixels;if(u)if(n>1){if(t)for(l=0;l<n;l++)for(o=l*s,r=a[l],f=0;f<s;f++)u[f]&&(c[o+f]=r);else for(f=0;f<s;f++)if(u[f])for(o=f*n,l=0;l<n;l++)c[o+n]=a[l]}else for(f=0;f<s;f++)u[f]&&(c[f]=r);else if(n>1&&i!==r)if(t)for(l=0;l<n;l++)for(o=l*s,r=a[l],f=0;f<s;f++)c[o+f]=r;else for(f=0;f<s;f++)for(o=f*n,l=0;l<n;l++)c[o+l]=a[l];else for(f=0;f<s*n;f++)c[f]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-3.4027999387901484e38&&t<=3.4027999387901484e38;break;case 7:r=t>=-1.7976931348623157e308&&t<=1.7976931348623157e308;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,i){var a=0;switch(r){case 0:a=i.getInt8(t);break;case 1:a=i.getUint8(t);break;case 2:a=i.getInt16(t,!0);break;case 3:a=i.getUint16(t,!0);break;case 4:a=i.getInt32(t,!0);break;case 5:a=i.getUInt32(t,!0);break;case 6:a=i.getFloat32(t,!0);break;case 7:a=i.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return a},swapDimensionOrder:function(e,t,r,i,a){var n=0,s=0,l=0,f=0,o=e;if(r>1)if(o=new i(t*r),a)for(n=0;n<t;n++)for(f=n,l=0;l<r;l++,f+=t)o[f]=e[s++];else for(n=0;n<t;n++)for(f=n,l=0;l<r;l++,f+=t)o[s++]=e[f];return o}},h=function(e,t,r){this.val=e,this.left=t,this.right=r},{decode:function(e,t){var r=(t=t||{}).noDataValue,i=0,a={};if(a.ptr=t.inputOffset||0,a.pixels={},d.readHeaderInfo(e,a)){var n=a.headerInfo,s=n.fileVersion,l=d.getDataTypeArray(n.imageType);if(s>5)throw"unsupported lerc version 2."+s;d.readMask(e,a),n.numValidPixel===n.width*n.height||a.pixels.resultMask||(a.pixels.resultMask=t.maskData);var f=n.width*n.height;a.pixels.resultPixels=new l(f*n.numDims),a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var o,u=!t.returnPixelInterleavedDims;if(0!==n.numValidPixel)if(n.zMax===n.zMin)d.constructConstantSurface(a,u);else if(s>=4&&d.checkMinMaxRanges(e,a))d.constructConstantSurface(a,u);else{var c=new DataView(e,a.ptr,2),h=c.getUint8(0);if(a.ptr++,h)d.readDataOneSweep(e,a,l,u);else if(s>1&&n.imageType<=1&&Math.abs(n.maxZError-.5)<1e-5){var m=c.getUint8(1);if(a.ptr++,a.encodeMode=m,m>2||s<4&&m>1)throw"Invalid Huffman flag "+m;m?d.readHuffman(e,a,l,u):d.readTiles(e,a,l,u)}else d.readTiles(e,a,l,u)}a.eofOffset=a.ptr,t.inputOffset?(o=a.headerInfo.blobSize+t.inputOffset-a.ptr,Math.abs(o)>=1&&(a.eofOffset=t.inputOffset+a.headerInfo.blobSize)):(o=a.headerInfo.blobSize-a.ptr,Math.abs(o)>=1&&(a.eofOffset=a.headerInfo.blobSize));var p={width:n.width,height:n.height,pixelData:a.pixels.resultPixels,minValue:n.zMin,maxValue:n.zMax,validPixelCount:n.numValidPixel,dimCount:n.numDims,dimStats:{minValues:n.minValues,maxValues:n.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&d.isValidPixelValue(n.imageType,r)){var g=a.pixels.resultMask;for(i=0;i<f;i++)g[i]||(p.pixelData[i]=r);p.noDataValue=r}return a.noDataValue=r,t.returnFileInfo&&(p.fileInfo=d.formatFileInfo(a)),p}},getBandCount:function(e){for(var t=0,r=0,i={ptr:0,pixels:{}};r<e.byteLength-58;)d.readHeaderInfo(e,i),r+=i.headerInfo.blobSize,t++,i.ptr=r;return t}}),w=(m=new ArrayBuffer(4),p=new Uint8Array(m),new Uint32Array(m)[0]=1,1===p[0]),k={decode:function(e,t){if(!w)throw"Big endian system is not supported.";var r,i,a=(t=t||{}).inputOffset||0,n=new Uint8Array(e,a,10),s=String.fromCharCode.apply(null,n);if("CntZImage"===s.trim())r=g,i=1;else{if("Lerc2"!==s.substring(0,5))throw"Unexpected file identifier string: "+s;r=x,i=2}for(var l,f,o,u,c,d,h=0,m=e.byteLength-10,p=[],k={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]},y=0;a<m;){var b=r.decode(e,{inputOffset:a,encodedMaskData:l,maskData:o,returnMask:0===h,returnEncodedMask:0===h,returnFileInfo:!0,returnPixelInterleavedDims:t.returnPixelInterleavedDims,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});a=b.fileInfo.eofOffset,o=b.maskData,0===h&&(l=b.encodedMaskData,k.width=b.width,k.height=b.height,k.dimCount=b.dimCount||1,k.pixelType=b.pixelType||b.fileInfo.pixelType,k.mask=o),i>1&&(o&&p.push(o),b.fileInfo.mask&&b.fileInfo.mask.numBytes>0&&y++),h++,k.pixels.push(b.pixelData),k.statistics.push({minValue:b.minValue,maxValue:b.maxValue,noDataValue:b.noDataValue,dimStats:b.dimStats})}if(i>1&&y>1){for(d=k.width*k.height,k.bandMasks=p,(o=new Uint8Array(d)).set(p[0]),u=1;u<p.length;u++)for(f=p[u],c=0;c<d;c++)o[c]=o[c]&f[c];k.maskData=o}return k}};"function"==typeof define&&define.amd?define([],function(){return k}):"undefined"!=typeof module&&module.exports?module.exports=k:this.Lerc=k}();

},{}],74:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control=_interopRequireDefault(require("ol/control/Control.js")),_Observable=require("ol/Observable.js"),_Style=_interopRequireDefault(require("ol/style/Style.js")),_Fill=_interopRequireDefault(require("ol/style/Fill.js")),_Stroke=_interopRequireDefault(require("ol/style/Stroke.js")),_Text=_interopRequireDefault(require("ol/style/Text.js")),_getMapCanvas=_interopRequireDefault(require("../util/getMapCanvas.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ol_control_CanvasBase=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e=e||{}])).setStyle(e.style),r}return _inherits(t,_Control["default"]),_createClass(t,[{key:"setMap",value:function(e){this.getCanvas(e);var r=this.getMap();if(this._listener&&((0,_Observable.unByKey)(this._listener),this._listener=null),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),r)try{r.renderSync()}catch(e){}e&&(this._listener=e.on("postcompose",this._draw.bind(this)))}},{key:"getCanvas",value:function(e){return(0,_getMapCanvas.default)(e)}},{key:"getContext",value:function(e){var t=e.context;if(!t&&this.getMap()){var r=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0];t=r?r.getContext("2d"):null}return t}},{key:"setStyle",value:function(e){this._style=e||new _Style.default({})}},{key:"getStyle",value:function(){return this._style}},{key:"getStroke",value:function(){return this._style.getStroke()||this._style.setStroke(new _Stroke.default({color:"#000",width:1.25})),this._style.getStroke()}},{key:"getFill",value:function(){return this._style.getFill()||this._style.setFill(new _Fill.default({color:"#fff"})),this._style.getFill()}},{key:"getTextStroke",value:function(){var e=this._style.getText();return e||(e=new _Text.default({})),e.getStroke()||e.setStroke(new _Stroke.default({color:"#fff",width:3})),e.getStroke()}},{key:"getTextFill",value:function(){var e=this._style.getText();return e||(e=new _Text.default({})),e.getFill()||e.setFill(new _Fill.default({color:"#fff"})),e.getFill()}},{key:"getTextFont",value:function(){var e=this._style.getText();return e||(e=new _Text.default({})),e.getFont()||e.setFont("12px sans-serif"),e.getFont()}},{key:"_draw",value:function(){console.warn("[CanvasBase] draw function not implemented.")}}])}(),_default=exports.default=ol_control_CanvasBase;

},{"../util/getMapCanvas.js":76,"ol/Observable.js":98,"ol/control/Control.js":118,"ol/style/Fill.js":386,"ol/style/Stroke.js":392,"ol/style/Style.js":393,"ol/style/Text.js":394}],75:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Projection=_interopRequireDefault(require("ol/proj/Projection.js")),_Style=_interopRequireDefault(require("ol/style/Style.js")),_Stroke=_interopRequireDefault(require("ol/style/Stroke.js")),_Fill=_interopRequireDefault(require("ol/style/Fill.js")),_Text=_interopRequireDefault(require("ol/style/Text.js")),_proj=require("ol/proj.js"),_CanvasBase=_interopRequireDefault(require("./CanvasBase.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ol_control_Graticule=function(t){function e(t){var o;_classCallCheck(this,e),t=t||{};var r=document.createElement("div");r.className="ol-graticule ol-unselectable ol-hidden",(o=_callSuper(this,e,[{element:r}])).set("projection",t.projection||"EPSG:4326");var i=new _Projection.default({code:o.get("projection")}).getMetersPerUnit();for(o.fac=1;i/o.fac>10;)o.fac*=10;return o.fac=1e4/o.fac,o.set("maxResolution",t.maxResolution||1/0),o.set("step",t.step||.1),o.set("stepCoord",t.stepCoord||1),o.set("spacing",t.spacing||40),o.set("intervals",t.intervals),o.set("precision",t.precision),o.set("margin",t.margin||0),o.set("borderWidth",t.borderWidth||5),o.set("stroke",!1!==t.stroke),o.formatCoord=t.formatCoord||function(t){return t},t.style instanceof _Style.default?o.setStyle(t.style):o.setStyle(new _Style.default({stroke:new _Stroke.default({color:"#000",width:1}),fill:new _Fill.default({color:"#fff"}),text:new _Text.default({stroke:new _Stroke.default({color:"#fff",width:2}),fill:new _Fill.default({color:"#000"})})})),o}return _inherits(e,_CanvasBase["default"]),_createClass(e,[{key:"setStyle",value:function(t){this._style=t}},{key:"_draw",value:function(t){if(!(this.get("maxResolution")<t.frameState.viewState.resolution)){for(var e,o=this.getContext(t),r=o.canvas,i=t.frameState.pixelRatio,n=r.width/i,l=r.height/i,s=this.get("projection"),a=this.getMap(),f=[a.getCoordinateFromPixel([0,0]),a.getCoordinateFromPixel([n,0]),a.getCoordinateFromPixel([n,l]),a.getCoordinateFromPixel([0,l])],u=-1/0,c=1/0,g=-1/0,p=1/0,h=0;e=f[h];h++)f[h]=(0,_proj.transform)(e,a.getView().getProjection(),s),u=Math.max(u,f[h][0]),c=Math.min(c,f[h][0]),g=Math.max(g,f[h][1]),p=Math.min(p,f[h][1]);var y=this.get("spacing"),d=this.get("step"),_=this.get("stepCoord"),m=this.get("borderWidth"),b=this.get("margin");if((u-c)/d*y>n)(d*=Math.round((u-c)/n*y/d))>this.fac&&(d=Math.round(d/this.fac)*this.fac);var v=this.get("intervals");if(Array.isArray(v)){for(var S=v[0],P=0,x=v.length;P<x&&!(d>=v[P]);++P)S=v[P];d=S}var j=this.get("precision"),C=d;j>0&&d>j&&(C=d/Math.ceil(d/j)),c=Math.floor(c/d)*d-d,p=Math.floor(p/d)*d-d,u=Math.floor(u/d)*d+2*d,g=Math.floor(g/d)*d+2*d;var k=(0,_proj.get)(s).getExtent();k&&(c<k[0]&&(c=k[0]),p<k[1]&&(p=k[1]),u>k[2]&&(u=k[2]+d),g>k[3]&&(g=k[3]+d));var w=this.getStyle().getStroke()&&this.get("stroke"),T=this.getStyle().getText(),M=this.getStyle().getFill();o.save(),o.scale(i,i),o.beginPath(),o.rect(b,b,n-2*b,l-2*b),o.clip(),o.beginPath();var O,R,F,q,W,B={top:[],left:[],bottom:[],right:[]};for(O=c;O<u;O+=d)for(q=(0,_proj.transform)([O,p],s,a.getView().getProjection()),q=a.getPixelFromCoordinate(q),w&&o.moveTo(q[0],q[1]),F=q,R=p+C;R<=g;R+=C)W=(0,_proj.transform)([O,R],s,a.getView().getProjection()),W=a.getPixelFromCoordinate(W),w&&o.lineTo(W[0],W[1]),F[1]>0&&W[1]<0&&B.top.push([O,F]),F[1]>l&&W[1]<l&&B.bottom.push([O,F]),F=W;for(R=p;R<g;R+=d)for(q=(0,_proj.transform)([c,R],s,a.getView().getProjection()),q=a.getPixelFromCoordinate(q),w&&o.moveTo(q[0],q[1]),F=q,O=c+C;O<=u;O+=C)W=(0,_proj.transform)([O,R],s,a.getView().getProjection()),W=a.getPixelFromCoordinate(W),w&&o.lineTo(W[0],W[1]),F[0]<0&&W[0]>0&&B.left.push([R,F]),F[0]<n&&W[0]>n&&B.right.push([R,F]),F=W;if(w&&(o.strokeStyle=this.getStyle().getStroke().getColor(),o.lineWidth=this.getStyle().getStroke().getWidth(),o.stroke()),T){var D,E;o.fillStyle=this.getStyle().getText().getFill().getColor(),o.strokeStyle=this.getStyle().getText().getStroke().getColor(),o.lineWidth=this.getStyle().getText().getStroke().getWidth(),o.font=this.getStyle().getText().getFont(),o.textAlign="center",o.textBaseline="hanging";var A=(M?m:0)+b+2;for(h=0;D=B.top[h];h++)Math.round(D[0]/this.get("step"))%_||(E=this.formatCoord(D[0],"top"),o.strokeText(E,D[1][0],A),o.fillText(E,D[1][0],A));for(o.textBaseline="alphabetic",h=0;D=B.bottom[h];h++)Math.round(D[0]/this.get("step"))%_||(E=this.formatCoord(D[0],"bottom"),o.strokeText(E,D[1][0],l-A),o.fillText(E,D[1][0],l-A));for(o.textBaseline="middle",o.textAlign="left",h=0;D=B.left[h];h++)Math.round(D[0]/this.get("step"))%_||(E=this.formatCoord(D[0],"left"),o.strokeText(E,A,D[1][1]),o.fillText(E,A,D[1][1]));for(o.textAlign="right",h=0;D=B.right[h];h++)Math.round(D[0]/this.get("step"))%_||(E=this.formatCoord(D[0],"right"),o.strokeText(E,n-A,D[1][1]),o.fillText(E,n-A,D[1][1]))}if(M){var N,V,G=this.getStyle().getFill().getColor();for((V=this.getStyle().getStroke())?N=this.getStyle().getStroke().getColor():(N=G,G="#fff"),o.strokeStyle=N,o.lineWidth=V?V.getWidth():1,h=1;h<B.top.length;h++)o.beginPath(),o.rect(B.top[h-1][1][0],b,B.top[h][1][0]-B.top[h-1][1][0],m),o.fillStyle=Math.round(B.top[h][0]/d)%2?N:G,o.fill(),o.stroke();for(h=1;h<B.bottom.length;h++)o.beginPath(),o.rect(B.bottom[h-1][1][0],l-m-b,B.bottom[h][1][0]-B.bottom[h-1][1][0],m),o.fillStyle=Math.round(B.bottom[h][0]/d)%2?N:G,o.fill(),o.stroke();for(h=1;h<B.left.length;h++)o.beginPath(),o.rect(b,B.left[h-1][1][1],m,B.left[h][1][1]-B.left[h-1][1][1]),o.fillStyle=Math.round(B.left[h][0]/d)%2?N:G,o.fill(),o.stroke();for(h=1;h<B.right.length;h++)o.beginPath(),o.rect(n-m-b,B.right[h-1][1][1],m,B.right[h][1][1]-B.right[h-1][1][1]),o.fillStyle=Math.round(B.right[h][0]/d)%2?N:G,o.fill(),o.stroke();o.beginPath(),o.fillStyle=N,o.rect(b,b,m,m),o.rect(b,l-m-b,m,m),o.rect(n-m-b,b,m,m),o.rect(n-m-b,l-m-b,m,m),o.fill()}o.restore()}}}])}(),_default=exports.default=ol_control_Graticule;

},{"./CanvasBase.js":74,"ol/proj.js":283,"ol/proj/Projection.js":284,"ol/style/Fill.js":386,"ol/style/Stroke.js":392,"ol/style/Style.js":393,"ol/style/Text.js":394}],76:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var ol_ext_getMapCanvas=function(e){if(!e)return null;var t=e.getViewport().getElementsByClassName("ol-fixedoverlay")[0];return t||(e.getViewport().querySelector(".ol-layers")?((t=document.createElement("canvas")).className="ol-fixedoverlay",e.getViewport().querySelector(".ol-layers").after(t),e.on("precompose",function(a){t.width=e.getSize()[0]*a.frameState.pixelRatio,t.height=e.getSize()[1]*a.frameState.pixelRatio})):t=e.getViewport().querySelector("canvas")),t},_default=exports.default=ol_ext_getMapCanvas;

},{}],77:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=_superPropBase(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t(require("ol/control/Control"),require("ol/Observable"),require("ol/layer/Group")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/Observable","ol/layer/Group"],t):(void 0).LayerSwitcher=t((void 0).ol.control.Control,(void 0).ol.Observable,(void 0).ol.layer.Group)}(0,function(e,t,n){e="default"in e?e.default:e,n="default"in n?n.default:n;var o="layer-switcher-",i=function(i){function r(e){var t;_classCallCheck(this,r);var n=Object.assign({},e),i=document.createElement("div");return(t=_callSuper(this,r,[{element:i,target:n.target}])).activationMode=n.activationMode||"mouseover",t.startActive=!0===n.startActive,t.label=void 0!==n.label?n.label:"",t.collapseLabel=void 0!==n.collapseLabel?n.collapseLabel:"Â»",t.tipLabel=n.tipLabel?n.tipLabel:"Legend",t.collapseTipLabel=n.collapseTipLabel?n.collapseTipLabel:"Collapse legend",t.groupSelectStyle=r.getGroupSelectStyle(n.groupSelectStyle),t.reverse=!1!==n.reverse,t.mapListeners=[],t.hiddenClassName="ol-unselectable ol-control layer-switcher",r.isTouchDevice_()&&(t.hiddenClassName+=" touch"),t.shownClassName="shown",i.className=t.hiddenClassName,t.button=document.createElement("button"),i.appendChild(t.button),t.panel=document.createElement("div"),t.panel.className="panel",i.appendChild(t.panel),r.enableTouchScroll_(t.panel),i.classList.add(o+"group-select-style-"+t.groupSelectStyle),i.classList.add(o+"activation-mode-"+t.activationMode),"click"===t.activationMode?(i.classList.add("activationModeClick"),t.button.onclick=function(e){var n=e||window.event;t.element.classList.contains(t.shownClassName)?t.hidePanel():t.showPanel(),n.preventDefault()}):(t.button.onmouseover=function(){t.showPanel()},t.button.onclick=function(e){var n=e||window.event;t.showPanel(),n.preventDefault()},t.panel.onmouseout=function(e){t.panel.contains(e.relatedTarget)||t.hidePanel()}),t.updateButton(),t}return _inherits(r,e),_createClass(r,[{key:"setMap",value:function(e){for(var n=this,o=0;o<this.mapListeners.length;o++)t.unByKey(this.mapListeners[o]);this.mapListeners.length=0,_get(_getPrototypeOf(r.prototype),"setMap",this).call(this,e),e&&(this.startActive?this.showPanel():this.renderPanel(),"click"!==this.activationMode&&this.mapListeners.push(e.on("pointerdown",function(){n.hidePanel()})))}},{key:"showPanel",value:function(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.updateButton(),this.renderPanel()),this.dispatchEvent("show")}},{key:"hidePanel",value:function(){this.element.classList.contains(this.shownClassName)&&(this.element.classList.remove(this.shownClassName),this.updateButton()),this.dispatchEvent("hide")}},{key:"updateButton",value:function(){this.element.classList.contains(this.shownClassName)?(this.button.textContent=this.collapseLabel,this.button.setAttribute("title",this.collapseTipLabel),this.button.setAttribute("aria-label",this.collapseTipLabel)):(this.button.textContent=this.label,this.button.setAttribute("title",this.tipLabel),this.button.setAttribute("aria-label",this.tipLabel))}},{key:"renderPanel",value:function(){this.dispatchEvent("render"),r.renderPanel(this.getMap(),this.panel,{groupSelectStyle:this.groupSelectStyle,reverse:this.reverse}),this.dispatchEvent("rendercomplete")}}],[{key:"renderPanel",value:function(e,t,n){var o=new Event("render");for(t.dispatchEvent(o),(n=n||{}).groupSelectStyle=r.getGroupSelectStyle(n.groupSelectStyle),r.ensureTopVisibleBaseLayerShown(e,n.groupSelectStyle);t.firstChild;)t.removeChild(t.firstChild);r.forEachRecursive(e,function(e,t,n){e.set("indeterminate",!1)}),"children"===n.groupSelectStyle||"none"===n.groupSelectStyle?r.setGroupVisibility(e):"group"===n.groupSelectStyle&&r.setChildVisibility(e);var i=document.createElement("ul");t.appendChild(i),r.renderLayers_(e,e,i,n,function(o){r.renderPanel(e,t,n)});var a=new Event("rendercomplete");t.dispatchEvent(a)}},{key:"isBaseGroup",value:function(e){if(e instanceof n){var t=e.getLayers().getArray();return t.length&&"base"===t[0].get("type")}return!1}},{key:"setGroupVisibility",value:function(e){r.getGroupsAndLayers(e,function(e){return e instanceof n&&!e.get("combine")&&!r.isBaseGroup(e)}).reverse().forEach(function(e){var t=e.getLayersArray().map(function(e){return e.getVisible()});t.every(function(e){return!0===e})?(e.setVisible(!0),e.set("indeterminate",!1)):t.every(function(e){return!1===e})?(e.setVisible(!1),e.set("indeterminate",!1)):(e.setVisible(!0),e.set("indeterminate",!0))})}},{key:"setChildVisibility",value:function(e){r.getGroupsAndLayers(e,function(e){return e instanceof n&&!e.get("combine")&&!r.isBaseGroup(e)}).forEach(function(e){var t=e,n=t.getVisible(),o=t.get("indeterminate");t.getLayers().getArray().forEach(function(e){e.set("indeterminate",!1),n&&!o||!e.getVisible()||e.set("indeterminate",!0)})})}},{key:"ensureTopVisibleBaseLayerShown",value:function(e,t){var n;r.forEachRecursive(e,function(e,t,o){"base"===e.get("type")&&e.getVisible()&&(n=e)}),n&&r.setVisible_(e,n,!0,t)}},{key:"getGroupsAndLayers",value:function(e,t){var n=[];return t=t||function(e,t,n){return!0},r.forEachRecursive(e,function(e,o,i){e.get("title")&&t(e,o,i)&&n.push(e)}),n}},{key:"setVisible_",value:function(e,t,o,i){t.setVisible(o),o&&"base"===t.get("type")&&r.forEachRecursive(e,function(e,n,o){e!=t&&"base"===e.get("type")&&e.setVisible(!1)}),t instanceof n&&!t.get("combine")&&"children"===i&&t.getLayers().forEach(function(n){r.setVisible_(e,n,t.getVisible(),i)})}},{key:"renderLayer_",value:function(e,t,i,a,l){var s=document.createElement("li"),c=t.get("title"),u=r.uuid(),p=document.createElement("label");if(t instanceof n&&!t.get("combine")){var d=r.isBaseGroup(t);if(s.classList.add("group"),d&&s.classList.add(o+"base-group"),t.get("fold")){s.classList.add(o+"fold"),s.classList.add(o+t.get("fold"));var f=document.createElement("button");f.onclick=function(e){var n=e||window.event;r.toggleFold_(t,s),n.preventDefault()},s.appendChild(f)}if(!d&&"none"!=a.groupSelectStyle){var h=document.createElement("input");h.type="checkbox",h.id=u,h.checked=t.getVisible(),h.indeterminate=t.get("indeterminate"),h.onchange=function(n){var o=n.target;r.setVisible_(e,t,o.checked,a.groupSelectStyle),l(t)},s.appendChild(h),p.htmlFor=u}p.innerHTML=c,s.appendChild(p);var y=document.createElement("ul");s.appendChild(y),r.renderLayers_(e,t,y,a,l)}else{s.className="layer";var v=document.createElement("input");"base"===t.get("type")?v.type="radio":v.type="checkbox",v.id=u,v.checked=t.get("visible"),v.indeterminate=t.get("indeterminate"),v.onchange=function(n){var o=n.target;r.setVisible_(e,t,o.checked,a.groupSelectStyle),l(t)},s.appendChild(v),p.htmlFor=u,p.innerHTML=c;var b=e.getView().getResolution();if(b>=t.getMaxResolution()||b<t.getMinResolution())p.className+=" disabled";else if(t.getMinZoom&&t.getMaxZoom){var g=e.getView().getZoom();(g<=t.getMinZoom()||g>t.getMaxZoom())&&(p.className+=" disabled")}s.appendChild(p)}return s}},{key:"renderLayers_",value:function(e,t,n,o,i){var a=t.getLayers().getArray().slice();o.reverse&&(a=a.reverse());for(var l,s=0;s<a.length;s++)(l=a[s]).get("title")&&n.appendChild(r.renderLayer_(e,l,s,o,i))}},{key:"forEachRecursive",value:function(e,t){e.getLayers().forEach(function(e,o,i){t(e,o,i),e instanceof n&&r.forEachRecursive(e,t)})}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}},{key:"enableTouchScroll_",value:function(e){if(r.isTouchDevice_()){var t=0;e.addEventListener("touchstart",function(e){t=this.scrollTop+e.touches[0].pageY},!1),e.addEventListener("touchmove",function(e){this.scrollTop=t-e.touches[0].pageY},!1)}}},{key:"isTouchDevice_",value:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}},{key:"toggleFold_",value:function(e,t){t.classList.remove(o+e.get("fold")),e.set("fold","open"===e.get("fold")?"close":"open"),t.classList.add(o+e.get("fold"))}},{key:"getGroupSelectStyle",value:function(e){return["none","children","group"].indexOf(e)>=0?e:"children"}}])}();return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=i),i});

},{"ol/Observable":98,"ol/control/Control":118,"ol/layer/Group":266}],78:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.CollectionEvent=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_CollectionEventType=_interopRequireDefault(require("./CollectionEventType.js")),_Event2=_interopRequireDefault(require("./events/Event.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Property={LENGTH:"length"},CollectionEvent=exports.CollectionEvent=function(e){function t(e,r,n){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).element=r,o.index=n,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),Collection=function(e){function t(e,r){var n;if(_classCallCheck(this,t),(n=_callSuper(this,t)).on,n.once,n.un,r=r||{},n.unique_=!!r.unique,n.array_=e||[],n.unique_)for(var o=0,i=n.array_.length;o<i;++o)n.assertUnique_(n.array_[o],o);return n.updateLength_(),n}return _inherits(t,_Object["default"]),_createClass(t,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(e){for(var t=0,r=e.length;t<r;++t)this.push(e[t]);return this}},{key:"forEach",value:function(e){for(var t=this.array_,r=0,n=t.length;r<n;++r)e(t[r],r,t)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(e){return this.array_[e]}},{key:"getLength",value:function(){return this.get(Property.LENGTH)}},{key:"insertAt",value:function(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.ADD,t,e))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(e){this.unique_&&this.assertUnique_(e);var t=this.getLength();return this.insertAt(t,e),this.getLength()}},{key:"remove",value:function(e){for(var t=this.array_,r=0,n=t.length;r<n;++r)if(t[r]===e)return this.removeAt(r)}},{key:"removeAt",value:function(e){if(!(e<0||e>=this.getLength())){var t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.REMOVE,t,e)),t}}},{key:"setAt",value:function(e,t){if(e>=this.getLength())this.insertAt(e,t);else{if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);var r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.REMOVE,r,e)),this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.ADD,t,e))}}},{key:"updateLength_",value:function(){this.set(Property.LENGTH,this.array_.length)}},{key:"assertUnique_",value:function(e,t){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}])}(),_default=exports.default=Collection;

},{"./CollectionEventType.js":79,"./Object.js":96,"./events/Event.js":133}],79:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ADD:"add",REMOVE:"remove"};

},{}],80:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.asArrayLike=asArrayLike,exports.asImageLike=asImageLike,exports.default=void 0,exports.toArray=toArray;var _Tile2=_interopRequireDefault(require("./Tile.js")),_TileState=_interopRequireDefault(require("./TileState.js")),_dom=require("./dom.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function asImageLike(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}function asArrayLike(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t instanceof DataView?t:null}var sharedContext=null;function toArray(t){sharedContext||(sharedContext=(0,_dom.createCanvasContext2D)(t.width,t.height,void 0,{willReadFrequently:!0}));var e=sharedContext.canvas,r=t.width;e.width!==r&&(e.width=r);var o=t.height;return e.height!==o&&(e.height=o),sharedContext.clearRect(0,0,r,o),sharedContext.drawImage(t,0,0),sharedContext.getImageData(0,0,r,o).data}var defaultSize=[256,256],DataTile=function(t){function e(t){var r;_classCallCheck(this,e);var o=_TileState.default.IDLE;return(r=_callSuper(this,e,[t.tileCoord,o,{transition:t.transition,interpolate:t.interpolate}])).loader_=t.loader,r.data_=null,r.error_=null,r.size_=t.size||null,r}return _inherits(e,_Tile2["default"]),_createClass(e,[{key:"getSize",value:function(){if(this.size_)return this.size_;var t=asImageLike(this.data_);return t?[t.width,t.height]:defaultSize}},{key:"getData",value:function(){return this.data_}},{key:"getError",value:function(){return this.error_}},{key:"load",value:function(){if(this.state===_TileState.default.IDLE||this.state===_TileState.default.ERROR){this.state=_TileState.default.LOADING,this.changed();var t=this;this.loader_().then(function(e){t.data_=e,t.state=_TileState.default.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=_TileState.default.ERROR,t.changed()})}}}])}(),_default=exports.default=DataTile;

},{"./Tile.js":100,"./TileState.js":104,"./dom.js":130}],81:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Disposable=function(){return _createClass(function e(){_classCallCheck(this,e),this.disposed=!1},[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])}(),_default=exports.default=Disposable;

},{}],82:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStyleFunction=createStyleFunction,exports.default=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_asserts=require("./asserts.js"),_events=require("./events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Feature=function(e){function t(e){var r;if(_classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addChangeListener(r.geometryName_,r.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var n=e;r.setGeometry(n)}else{var o=e;r.setProperties(o)}return r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"clone",value:function(){var e=new t(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&e.setGeometry(r.clone());var n=this.getStyle();return n&&e.setStyle(n),e}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&((0,_events.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=(0,_events.listen)(e,_EventType.default.CHANGE,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(e){this.set(this.geometryName_,e)}},{key:"setStyle",value:function(e){this.style_=e,this.styleFunction_=e?createStyleFunction(e):void 0,this.changed()}},{key:"setId",value:function(e){this.id_=e,this.changed()}},{key:"setGeometryName",value:function(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}])}();function createStyleFunction(e){if("function"==typeof e)return e;var t;Array.isArray(e)?t=e:((0,_asserts.assert)("function"==typeof e.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[e]);return function(){return t}}var _default=exports.default=Feature;

},{"./Object.js":96,"./asserts.js":111,"./events.js":132,"./events/EventType.js":134}],83:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.GeolocationError=void 0;var _Event=_interopRequireDefault(require("./events/Event.js")),_Object=_interopRequireDefault(require("./Object.js")),_Polygon=require("./geom/Polygon.js"),_proj=require("./proj.js"),_math=require("./math.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=_superPropBase(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Property={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},GeolocationErrorType={ERROR:"error"},GeolocationError=exports.GeolocationError=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,[GeolocationErrorType.ERROR])).code=t.code,r.message=t.message,r}return _inherits(e,_Event["default"]),_createClass(e)}(),Geolocation=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e)).on,r.once,r.un,t=t||{},r.position_=null,r.transform_=_proj.identityTransform,r.watchId_=void 0,r.addChangeListener(Property.PROJECTION,r.handleProjectionChanged_),r.addChangeListener(Property.TRACKING,r.handleTrackingChanged_),void 0!==t.projection&&r.setProjection(t.projection),void 0!==t.trackingOptions&&r.setTrackingOptions(t.trackingOptions),r.setTracking(void 0!==t.tracking&&t.tracking),r}return _inherits(e,_Object["default"]),_createClass(e,[{key:"disposeInternal",value:function(){this.setTracking(!1),_get(_getPrototypeOf(e.prototype),"disposeInternal",this).call(this)}},{key:"handleProjectionChanged_",value:function(){var t=this.getProjection();t&&(this.transform_=(0,_proj.getTransformFromProjections)((0,_proj.get)("EPSG:4326"),t),this.position_&&this.set(Property.POSITION,this.transform_(this.position_)))}},{key:"handleTrackingChanged_",value:function(){if("geolocation"in navigator){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}},{key:"positionChange_",value:function(t){var e=t.coords;this.set(Property.ACCURACY,e.accuracy),this.set(Property.ALTITUDE,null===e.altitude?void 0:e.altitude),this.set(Property.ALTITUDE_ACCURACY,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(Property.HEADING,null===e.heading?void 0:(0,_math.toRadians)(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];var r=this.transform_(this.position_);this.set(Property.POSITION,r.slice()),this.set(Property.SPEED,null===e.speed?void 0:e.speed);var o=(0,_Polygon.circular)(this.position_,e.accuracy);o.applyTransform(this.transform_),this.set(Property.ACCURACY_GEOMETRY,o),this.changed()}},{key:"positionError_",value:function(t){this.dispatchEvent(new GeolocationError(t))}},{key:"getAccuracy",value:function(){return this.get(Property.ACCURACY)}},{key:"getAccuracyGeometry",value:function(){return this.get(Property.ACCURACY_GEOMETRY)||null}},{key:"getAltitude",value:function(){return this.get(Property.ALTITUDE)}},{key:"getAltitudeAccuracy",value:function(){return this.get(Property.ALTITUDE_ACCURACY)}},{key:"getHeading",value:function(){return this.get(Property.HEADING)}},{key:"getPosition",value:function(){return this.get(Property.POSITION)}},{key:"getProjection",value:function(){return this.get(Property.PROJECTION)}},{key:"getSpeed",value:function(){return this.get(Property.SPEED)}},{key:"getTracking",value:function(){return this.get(Property.TRACKING)}},{key:"getTrackingOptions",value:function(){return this.get(Property.TRACKING_OPTIONS)}},{key:"setProjection",value:function(t){this.set(Property.PROJECTION,(0,_proj.get)(t))}},{key:"setTracking",value:function(t){this.set(Property.TRACKING,t)}},{key:"setTrackingOptions",value:function(t){this.set(Property.TRACKING_OPTIONS,t)}}])}(),_default=exports.default=Geolocation;

},{"./Object.js":96,"./events/Event.js":133,"./geom/Polygon.js":211,"./math.js":279,"./proj.js":283}],84:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.decode=decode,exports.decodeFallback=decodeFallback,exports.default=void 0,exports.listenImage=listenImage,exports.load=load;var _Target=_interopRequireDefault(require("./events/Target.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_ImageState=_interopRequireDefault(require("./ImageState.js")),_has=require("./has.js"),_events=require("./events.js"),_functions=require("./functions.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageWrapper=function(e){function t(e,n,r,o){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).extent=e,i.pixelRatio_=r,i.resolution=n,i.state="function"==typeof o?_ImageState.default.IDLE:o,i.image_=null,i.loader="function"==typeof o?o:null,i}return _inherits(t,_Target["default"]),_createClass(t,[{key:"changed",value:function(){this.dispatchEvent(_EventType.default.CHANGE)}},{key:"getExtent",value:function(){return this.extent}},{key:"getImage",value:function(){return this.image_}},{key:"getPixelRatio",value:function(){return this.pixelRatio_}},{key:"getResolution",value:function(){return this.resolution}},{key:"getState",value:function(){return this.state}},{key:"load",value:function(){var e=this;if(this.state==_ImageState.default.IDLE&&this.loader){this.state=_ImageState.default.LOADING,this.changed();var t=this.getResolution(),n=Array.isArray(t)?t[0]:t;(0,_functions.toPromise)(function(){return e.loader(e.getExtent(),n,e.getPixelRatio())}).then(function(t){"image"in t&&(e.image_=t.image),"extent"in t&&(e.extent=t.extent),"resolution"in t&&(e.resolution=t.resolution),"pixelRatio"in t&&(e.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(e.image_=t),e.state=_ImageState.default.LOADED}).catch(function(t){e.state=_ImageState.default.ERROR,console.error(t)}).finally(function(){return e.changed()})}}},{key:"setImage",value:function(e){this.image_=e}},{key:"setResolution",value:function(e){this.resolution=e}}])}();function listenImage(e,t,n){var r=e,o=!0,i=!1,a=!1,u=[(0,_events.listenOnce)(r,_EventType.default.LOAD,function(){a=!0,i||t()})];return r.src&&_has.IMAGE_DECODE?(i=!0,r.decode().then(function(){o&&t()}).catch(function(e){o&&(a?t():n())})):u.push((0,_events.listenOnce)(r,_EventType.default.ERROR,n)),function(){o=!1,u.forEach(_events.unlistenByKey)}}function load(e,t){return new Promise(function(n,r){function o(){a(),n(e)}function i(){a(),r(new Error("Image load error"))}function a(){e.removeEventListener("load",o),e.removeEventListener("error",i)}e.addEventListener("load",o),e.addEventListener("error",i),t&&(e.src=t)})}function decodeFallback(e,t){return t&&(e.src=t),e.src&&_has.IMAGE_DECODE?new Promise(function(t,n){return e.decode().then(function(){return t(e)}).catch(function(r){return e.complete&&e.width?t(e):n(r)})}):load(e)}function decode(e,t){return t&&(e.src=t),e.src&&_has.IMAGE_DECODE&&_has.CREATE_IMAGE_BITMAP?e.decode().then(function(){return createImageBitmap(e)}).catch(function(t){if(e.complete&&e.width)return e;throw t}):decodeFallback(e)}var _default=exports.default=ImageWrapper;

},{"./ImageState.js":86,"./events.js":132,"./events/EventType.js":134,"./events/Target.js":137,"./functions.js":200,"./has.js":233}],85:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageState=_interopRequireDefault(require("./ImageState.js")),_Image=_interopRequireDefault(require("./Image.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ImageCanvas=function(t){function e(t,r,o,n,i){var a;return _classCallCheck(this,e),(a=_callSuper(this,e,[t,r,o,void 0!==i?_ImageState.default.IDLE:_ImageState.default.LOADED])).loader_=void 0!==i?i:null,a.canvas_=n,a.error_=null,a}return _inherits(e,_Image["default"]),_createClass(e,[{key:"getError",value:function(){return this.error_}},{key:"handleLoad_",value:function(t){t?(this.error_=t,this.state=_ImageState.default.ERROR):this.state=_ImageState.default.LOADED,this.changed()}},{key:"load",value:function(){this.state==_ImageState.default.IDLE&&(this.state=_ImageState.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}},{key:"getImage",value:function(){return this.canvas_}}])}(),_default=exports.default=ImageCanvas;

},{"./Image.js":84,"./ImageState.js":86}],86:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};

},{}],87:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Tile2=_interopRequireDefault(require("./Tile.js")),_TileState=_interopRequireDefault(require("./TileState.js")),_dom=require("./dom.js"),_Image=require("./Image.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageTile=function(e){function t(e,r,i,n,o,a){var s;return _classCallCheck(this,t),(s=_callSuper(this,t,[e,r,a])).crossOrigin_=n,s.src_=i,s.key=i,s.image_=new Image,null!==n&&(s.image_.crossOrigin=n),s.unlisten_=null,s.tileLoadFunction_=o,s}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(e){this.image_=e,this.state=_TileState.default.LOADED,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){this.state=_TileState.default.ERROR,this.unlistenImage_(),this.image_=getBlankImage(),this.changed()}},{key:"handleImageLoad_",value:function(){var e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=_TileState.default.LOADED:this.state=_TileState.default.EMPTY,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state==_TileState.default.ERROR&&(this.state=_TileState.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==_TileState.default.IDLE&&(this.state=_TileState.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,_Image.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])}();function getBlankImage(){var e=(0,_dom.createCanvasContext2D)(1,1);return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas}var _default=exports.default=ImageTile;

},{"./Image.js":84,"./Tile.js":100,"./TileState.js":104,"./dom.js":130}],88:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Kinetic=function(){return _createClass(function t(e,i,n){_classCallCheck(this,t),this.decay_=e,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0},[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var o=this.points_[e]-this.points_[i],r=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(r,o),this.initialVelocity_=Math.sqrt(o*o+r*r)/n,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}])}(),_default=exports.default=Kinetic;

},{}],89:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_Collection=_interopRequireDefault(require("./Collection.js")),_CollectionEventType=_interopRequireDefault(require("./CollectionEventType.js")),_Composite=_interopRequireDefault(require("./renderer/Composite.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_Layer=_interopRequireDefault(require("./layer/Layer.js")),_Group=_interopRequireWildcard(require("./layer/Group.js")),_MapBrowserEvent=_interopRequireDefault(require("./MapBrowserEvent.js")),_MapBrowserEventHandler=_interopRequireDefault(require("./MapBrowserEventHandler.js")),_MapBrowserEventType=_interopRequireDefault(require("./MapBrowserEventType.js")),_MapEvent=_interopRequireDefault(require("./MapEvent.js")),_MapEventType=_interopRequireDefault(require("./MapEventType.js")),_MapProperty=_interopRequireDefault(require("./MapProperty.js")),_ObjectEventType=_interopRequireDefault(require("./ObjectEventType.js")),_EventType2=_interopRequireDefault(require("./pointer/EventType.js")),_EventType3=_interopRequireDefault(require("./render/EventType.js")),_TileQueue=_interopRequireWildcard(require("./TileQueue.js")),_View=_interopRequireDefault(require("./View.js")),_ViewHint=_interopRequireDefault(require("./ViewHint.js")),_has=require("./has.js"),_functions=require("./functions.js"),_transform=require("./transform.js"),_asserts=require("./asserts.js"),_extent=require("./extent.js"),_defaults=require("./control/defaults.js"),_defaults2=require("./interaction/defaults.js"),_array=require("./array.js"),_proj=require("./proj.js"),_util=require("./util.js"),_size=require("./size.js"),_events=require("./events.js"),_dom=require("./dom.js"),_console=require("./console.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function removeLayerMapProperty(e){e instanceof _Layer.default?e.setMapInternal(null):e instanceof _Group.default&&e.getLayers().forEach(removeLayerMapProperty)}function setLayerMapProperty(e,t){if(e instanceof _Layer.default)e.setMapInternal(t);else if(e instanceof _Group.default)for(var r=e.getLayers().getArray(),n=0,i=r.length;n<i;++n)setLayerMapProperty(r[n],t)}var Map=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).on,r.once,r.un;var n=createOptionsInternal(e);r.renderComplete_,r.loaded_=!0,r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r),r.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,r.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:_has.DEVICE_PIXEL_RATIO,r.postRenderTimeoutHandle_,r.animationDelayKey_,r.animationDelay_=r.animationDelay_.bind(r),r.coordinateToPixelTransform_=(0,_transform.create)(),r.pixelToCoordinateTransform_=(0,_transform.create)(),r.frameIndex_=0,r.frameState_=null,r.previousExtent_=null,r.viewPropertyListenerKey_=null,r.viewChangeListenerKey_=null,r.layerGroupPropertyListenerKeys_=null,r.viewport_=document.createElement("div"),r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),r.viewport_.style.position="relative",r.viewport_.style.overflow="hidden",r.viewport_.style.width="100%",r.viewport_.style.height="100%",r.overlayContainer_=document.createElement("div"),r.overlayContainer_.style.position="absolute",r.overlayContainer_.style.zIndex="0",r.overlayContainer_.style.width="100%",r.overlayContainer_.style.height="100%",r.overlayContainer_.style.pointerEvents="none",r.overlayContainer_.className="ol-overlaycontainer",r.viewport_.appendChild(r.overlayContainer_),r.overlayContainerStopEvent_=document.createElement("div"),r.overlayContainerStopEvent_.style.position="absolute",r.overlayContainerStopEvent_.style.zIndex="0",r.overlayContainerStopEvent_.style.width="100%",r.overlayContainerStopEvent_.style.height="100%",r.overlayContainerStopEvent_.style.pointerEvents="none",r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",r.viewport_.appendChild(r.overlayContainerStopEvent_),r.mapBrowserEventHandler_=null,r.moveTolerance_=e.moveTolerance,r.keyboardEventTarget_=n.keyboardEventTarget,r.targetChangeHandlerKeys_=null,r.targetElement_=null,r.resizeObserver_=new ResizeObserver(function(){return r.updateSize()}),r.controls=n.controls||(0,_defaults.defaults)(),r.interactions=n.interactions||(0,_defaults2.defaults)({onFocusOnly:!0}),r.overlays_=n.overlays,r.overlayIdIndex_={},r.renderer_=null,r.postRenderFunctions_=[],r.tileQueue_=new _TileQueue.default(r.getTilePriority.bind(r),r.handleTileChange_.bind(r)),r.addChangeListener(_MapProperty.default.LAYERGROUP,r.handleLayerGroupChanged_),r.addChangeListener(_MapProperty.default.VIEW,r.handleViewChanged_),r.addChangeListener(_MapProperty.default.SIZE,r.handleSizeChanged_),r.addChangeListener(_MapProperty.default.TARGET,r.handleTargetChanged_),r.setProperties(n.values);var i=r;return!e.view||e.view instanceof _View.default||e.view.then(function(e){i.setView(new _View.default(e))}),r.controls.addEventListener(_CollectionEventType.default.ADD,function(e){e.element.setMap(r)}),r.controls.addEventListener(_CollectionEventType.default.REMOVE,function(e){e.element.setMap(null)}),r.interactions.addEventListener(_CollectionEventType.default.ADD,function(e){e.element.setMap(r)}),r.interactions.addEventListener(_CollectionEventType.default.REMOVE,function(e){e.element.setMap(null)}),r.overlays_.addEventListener(_CollectionEventType.default.ADD,function(e){r.addOverlayInternal_(e.element)}),r.overlays_.addEventListener(_CollectionEventType.default.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete r.overlayIdIndex_[t.toString()],e.element.setMap(null)}),r.controls.forEach(function(e){e.setMap(r)}),r.interactions.forEach(function(e){e.setMap(r)}),r.overlays_.forEach(r.addOverlayInternal_.bind(r)),r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"addControl",value:function(e){this.getControls().push(e)}},{key:"addInteraction",value:function(e){this.getInteractions().push(e)}},{key:"addLayer",value:function(e){this.getLayerGroup().getLayers().push(e)}},{key:"handleLayerAdd_",value:function(e){setLayerMapProperty(e.layer,this)}},{key:"addOverlay",value:function(e){this.getOverlays().push(e)}},{key:"addOverlayInternal_",value:function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}},{key:"disposeInternal",value:function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"forEachFeatureAtPixel",value:function(e,t,r){if(this.frameState_&&this.renderer_){var n=this.getCoordinateFromPixelInternal(e),i=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance:0,a=void 0!==r.layerFilter?r.layerFilter:_functions.TRUE,o=!1!==r.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,i,o,t,null,a,null)}}},{key:"getFeaturesAtPixel",value:function(e,t){var r=[];return this.forEachFeatureAtPixel(e,function(e){r.push(e)},t),r}},{key:"getAllLayers",value:function(){var e=[];return function t(r){r.forEach(function(r){r instanceof _Group.default?t(r.getLayers()):e.push(r)})}(this.getLayers()),e}},{key:"hasFeatureAtPixel",value:function(e,t){if(!this.frameState_||!this.renderer_)return!1;var r=this.getCoordinateFromPixelInternal(e),n=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:_functions.TRUE,i=void 0!==t.hitTolerance?t.hitTolerance:0,a=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,i,a,n,null)}},{key:"getEventCoordinate",value:function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}},{key:"getEventCoordinateInternal",value:function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}},{key:"getEventPixel",value:function(e){var t=this.viewport_.getBoundingClientRect(),r=this.getSize(),n=t.width/r[0],i=t.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-t.left)/n,(a.clientY-t.top)/i]}},{key:"getTarget",value:function(){return this.get(_MapProperty.default.TARGET)}},{key:"getTargetElement",value:function(){return this.targetElement_}},{key:"getCoordinateFromPixel",value:function(e){return(0,_proj.toUserCoordinate)(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(e){var t=this.frameState_;return t?(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(_MapProperty.default.LAYERGROUP)}},{key:"setLayers",value:function(e){var t=this.getLayerGroup();if(e instanceof _Collection.default)t.setLayers(e);else{var r=t.getLayers();r.clear(),r.extend(e)}}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var n=e[t];if(n.visible){var i=n.layer.getRenderer();if(i&&!i.ready)return!0;var a=n.layer.getSource();if(a&&a.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(e){var t=(0,_proj.fromUserCoordinate)(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}},{key:"getPixelFromCoordinateInternal",value:function(e){var t=this.frameState_;return t?(0,_transform.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(_MapProperty.default.SIZE)}},{key:"getView",value:function(){return this.get(_MapProperty.default.VIEW)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var e=this.getTargetElement();return e?e.ownerDocument:document}},{key:"getTilePriority",value:function(e,t,r,n){return(0,_TileQueue.getTilePriority)(this.frameState_,e,t,r,n)}},{key:"handleBrowserEvent",value:function(e,t){t=t||e.type;var r=new _MapBrowserEvent.default(t,this,e);this.handleMapBrowserEvent(r)}},{key:"handleMapBrowserEvent",value:function(e){if(this.frameState_){var t=e.originalEvent,r=t.type;if(r===_EventType2.default.POINTERDOWN||r===_EventType.default.WHEEL||r===_EventType.default.KEYDOWN){var n=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():n,a=t.target;if(this.overlayContainerStopEvent_.contains(a)||!(i===n?n.documentElement:i).contains(a))return}if(e.frameState=this.frameState_,!1!==this.dispatchEvent(e))for(var o=this.getInteractions().getArray().slice(),s=o.length-1;s>=0;s--){var l=o[s];if(l.getMap()===this&&l.getActive()&&this.getTargetElement())if(!l.handleEvent(e)||e.propagationStopped)break}}}},{key:"handlePostRender",value:function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var r=this.maxTilesLoading_,n=r;if(e){var i=e.viewHints;if(i[_ViewHint.default.ANIMATING]||i[_ViewHint.default.INTERACTING]){var a=Date.now()-e.time>8;r=a?0:8,n=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,n))}e&&this.renderer_&&!e.animate&&(!0===this.renderComplete_?(this.hasListener(_EventType3.default.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(_EventType3.default.RENDERCOMPLETE,e),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new _MapEvent.default(_MapEventType.default.LOADEND,this,e)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new _MapEvent.default(_MapEventType.default.LOADSTART,this,e))));for(var o=this.postRenderFunctions_,s=0,l=o.length;s<l;++s)o[s](this,e);o.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var e=0,t=this.targetChangeHandlerKeys_.length;e<t;++e)(0,_events.unlistenByKey)(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_EventType.default.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(_EventType.default.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,(0,_dom.removeNode)(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);var r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}var n=this.getTarget(),i="string"==typeof n?document.getElementById(n):n;if(this.targetElement_=i,i){for(var a in i.appendChild(this.viewport_),this.renderer_||(this.renderer_=new _Composite.default(this)),this.mapBrowserEventHandler_=new _MapBrowserEventHandler.default(this,this.moveTolerance_),_MapBrowserEventType.default)this.mapBrowserEventHandler_.addEventListener(_MapBrowserEventType.default[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_EventType.default.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(_EventType.default.WHEEL,this.boundHandleBrowserEvent_,!!_has.PASSIVE_EVENT_LISTENERS&&{passive:!1});var o=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[(0,_events.listen)(o,_EventType.default.KEYDOWN,this.handleBrowserEvent,this),(0,_events.listen)(o,_EventType.default.KEYPRESS,this.handleBrowserEvent,this)];var s=i.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(i)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&((0,_events.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,_events.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=(0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,_events.listen)(e,_EventType.default.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(_events.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.handleLayerAdd_(new _Group.GroupEvent("addlayer",e)),this.layerGroupPropertyListenerKeys_=[(0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.render,this),(0,_events.listen)(e,_EventType.default.CHANGE,this.render,this),(0,_events.listen)(e,"addlayer",this.handleLayerAdd_,this),(0,_events.listen)(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"animationDelay_",value:function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(e){return this.getControls().remove(e)}},{key:"removeInteraction",value:function(e){return this.getInteractions().remove(e)}},{key:"removeLayer",value:function(e){return this.getLayerGroup().getLayers().remove(e)}},{key:"handleLayerRemove_",value:function(e){removeLayerMapProperty(e.layer)}},{key:"removeOverlay",value:function(e){return this.getOverlays().remove(e)}},{key:"renderFrame_",value:function(e){var t=this,r=this.getSize(),n=this.getView(),i=this.frameState_,a=null;if(void 0!==r&&(0,_size.hasArea)(r)&&n&&n.isDef()){var o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=n.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:(0,_extent.getForViewAndSize)(s.center,s.resolution,s.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:s,viewHints:o,wantedTiles:{},mapId:(0,_util.getUid)(this),renderTargets:{}},s.nextCenter&&s.nextResolution){var l=isNaN(s.nextRotation)?s.rotation:s.nextRotation;a.nextExtent=(0,_extent.getForViewAndSize)(s.nextCenter,s.nextResolution,l,r)}}if(this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),i)(!this.previousExtent_||!(0,_extent.isEmpty)(this.previousExtent_)&&!(0,_extent.equals)(a.extent,this.previousExtent_))&&(this.dispatchEvent(new _MapEvent.default(_MapEventType.default.MOVESTART,this,i)),this.previousExtent_=(0,_extent.createOrUpdateEmpty)(this.previousExtent_));this.previousExtent_&&!a.viewHints[_ViewHint.default.ANIMATING]&&!a.viewHints[_ViewHint.default.INTERACTING]&&!(0,_extent.equals)(a.extent,this.previousExtent_)&&(this.dispatchEvent(new _MapEvent.default(_MapEventType.default.MOVEEND,this,a)),(0,_extent.clone)(a.extent,this.previousExtent_))}this.dispatchEvent(new _MapEvent.default(_MapEventType.default.POSTRENDER,this,a)),this.renderComplete_=this.hasListener(_MapEventType.default.LOADSTART)||this.hasListener(_MapEventType.default.LOADEND)||this.hasListener(_EventType3.default.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){t.postRenderTimeoutHandle_=void 0,t.handlePostRender()},0))}},{key:"setLayerGroup",value:function(e){var t=this.getLayerGroup();t&&this.handleLayerRemove_(new _Group.GroupEvent("removelayer",t)),this.set(_MapProperty.default.LAYERGROUP,e)}},{key:"setSize",value:function(e){this.set(_MapProperty.default.SIZE,e)}},{key:"setTarget",value:function(e){this.set(_MapProperty.default.TARGET,e)}},{key:"setView",value:function(e){if(!e||e instanceof _View.default)this.set(_MapProperty.default.VIEW,e);else{this.set(_MapProperty.default.VIEW,new _View.default);var t=this;e.then(function(e){t.setView(new _View.default(e))})}}},{key:"updateSize",value:function(){var e=this.getTargetElement(),t=void 0;if(e){var r=getComputedStyle(e),n=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),i=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);isNaN(n)||isNaN(i)||(t=[n,i],!(0,_size.hasArea)(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(0,_console.warn)("No map visible because the map container's width or height are 0."))}var a=this.getSize();!t||a&&(0,_array.equals)(t,a)||(this.setSize(t),this.updateViewportSize_(t))}},{key:"updateViewportSize_",value:function(e){var t=this.getView();t&&t.setViewportSize(e)}}])}();function createOptionsInternal(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var r,n,i,a={},o=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new _Group.default({layers:e.layers});return a[_MapProperty.default.LAYERGROUP]=o,a[_MapProperty.default.TARGET]=e.target,a[_MapProperty.default.VIEW]=e.view instanceof _View.default?e.view:new _View.default,void 0!==e.controls&&(Array.isArray(e.controls)?r=new _Collection.default(e.controls.slice()):((0,_asserts.assert)("function"==typeof e.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?n=new _Collection.default(e.interactions.slice()):((0,_asserts.assert)("function"==typeof e.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),n=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?i=new _Collection.default(e.overlays.slice()):((0,_asserts.assert)("function"==typeof e.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),i=e.overlays):i=new _Collection.default,{controls:r,interactions:n,keyboardEventTarget:t,overlays:i,values:a}}var _default=exports.default=Map;

},{"./Collection.js":78,"./CollectionEventType.js":79,"./MapBrowserEvent.js":90,"./MapBrowserEventHandler.js":91,"./MapBrowserEventType.js":92,"./MapEvent.js":93,"./MapEventType.js":94,"./MapProperty.js":95,"./Object.js":96,"./ObjectEventType.js":97,"./TileQueue.js":102,"./View.js":107,"./ViewHint.js":108,"./array.js":110,"./asserts.js":111,"./console.js":115,"./control/defaults.js":127,"./dom.js":130,"./events.js":132,"./events/EventType.js":134,"./extent.js":142,"./functions.js":200,"./has.js":233,"./interaction/defaults.js":259,"./layer/Group.js":266,"./layer/Layer.js":269,"./pointer/EventType.js":282,"./proj.js":283,"./render/EventType.js":294,"./renderer/Composite.js":313,"./size.js":337,"./transform.js":402,"./util.js":404}],90:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _MapEvent2=_interopRequireDefault(require("./MapEvent.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=_superPropBase(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MapBrowserEvent=function(t){function e(t,r,o,n,i,u){var a;return _classCallCheck(this,e),(a=_callSuper(this,e,[t,r,i])).originalEvent=o,a.pixel_=null,a.coordinate_=null,a.dragging=void 0!==n&&n,a.activePointers=u,a}return _inherits(e,_MapEvent2["default"]),_createClass(e,[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}},{key:"preventDefault",value:function(){_get(_getPrototypeOf(e.prototype),"preventDefault",this).call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){_get(_getPrototypeOf(e.prototype),"stopPropagation",this).call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}])}(),_default=exports.default=MapBrowserEvent;

},{"./MapEvent.js":93}],91:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("./events/EventType.js")),_MapBrowserEvent=_interopRequireDefault(require("./MapBrowserEvent.js")),_MapBrowserEventType=_interopRequireDefault(require("./MapBrowserEventType.js")),_EventType2=_interopRequireDefault(require("./pointer/EventType.js")),_Target2=_interopRequireDefault(require("./events/Target.js")),_has=require("./has.js"),_events=require("./events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var MapBrowserEventHandler=function(e){function t(e,n){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e])).map_=e,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=void 0===n?1:n,r.down_=null;var i=r.map_.getViewport();return r.activePointers_=[],r.trackedTouches_={},r.element_=i,r.pointerdownListenerKey_=(0,_events.listen)(i,_EventType2.default.POINTERDOWN,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=(0,_events.listen)(i,_EventType2.default.POINTERMOVE,r.relayMoveEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(_EventType.default.TOUCHMOVE,r.boundHandleTouchMove_,!!_has.PASSIVE_EVENT_LISTENERS&&{passive:!1}),r}return _inherits(t,_Target2["default"]),_createClass(t,[{key:"emulateClick_",value:function(e){var t=this,n=new _MapBrowserEvent.default(_MapBrowserEventType.default.CLICK,this.map_,e);this.dispatchEvent(n),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new _MapBrowserEvent.default(_MapBrowserEventType.default.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){t.clickTimeoutId_=void 0;var n=new _MapBrowserEvent.default(_MapBrowserEventType.default.SINGLECLICK,t.map_,e);t.dispatchEvent(n)},250)}},{key:"updateActivePointers_",value:function(e){var t=e,n=t.pointerId;if(t.type==_MapBrowserEventType.default.POINTERUP||t.type==_MapBrowserEventType.default.POINTERCANCEL){for(var r in delete this.trackedTouches_[n],this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else t.type!=_MapBrowserEventType.default.POINTERDOWN&&t.type!=_MapBrowserEventType.default.POINTERMOVE||(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}},{key:"handlePointerUp_",value:function(e){this.updateActivePointers_(e);var t=new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(_events.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(e){return 0===e.button}},{key:"handlePointerDown_",value:function(e){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(e);var t=new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),0===this.dragListenerKeys_.length){var n=this.map_.getOwnerDocument();this.dragListenerKeys_.push((0,_events.listen)(n,_MapBrowserEventType.default.POINTERMOVE,this.handlePointerMove_,this),(0,_events.listen)(n,_MapBrowserEventType.default.POINTERUP,this.handlePointerUp_,this),(0,_events.listen)(this.element_,_MapBrowserEventType.default.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push((0,_events.listen)(this.element_.getRootNode(),_MapBrowserEventType.default.POINTERUP,this.handlePointerUp_,this))}}},{key:"handlePointerMove_",value:function(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;var t=new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}},{key:"relayMoveEvent_",value:function(e){this.originalPointerMoveEvent_=e;var t=!(!this.down_||!this.isMoving_(e));this.dispatchEvent(new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERMOVE,this.map_,e,t))}},{key:"handleTouchMove_",value:function(e){var t=this.originalPointerMoveEvent_;t&&!t.defaultPrevented||"boolean"==typeof e.cancelable&&!0!==e.cancelable||e.preventDefault()}},{key:"isMoving_",value:function(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&((0,_events.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(_EventType.default.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,_events.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(_events.unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}(),_default=exports.default=MapBrowserEventHandler;

},{"./MapBrowserEvent.js":90,"./MapBrowserEventType.js":92,"./events.js":132,"./events/EventType.js":134,"./events/Target.js":137,"./has.js":233,"./pointer/EventType.js":282}],92:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("./events/EventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default={SINGLECLICK:"singleclick",CLICK:_EventType.default.CLICK,DBLCLICK:_EventType.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};

},{"./events/EventType.js":134}],93:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Event2=_interopRequireDefault(require("./events/Event.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MapEvent=function(t){function e(t,r,o){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,[t])).map=r,n.frameState=void 0!==o?o:null,n}return _inherits(e,_Event2["default"]),_createClass(e)}(),_default=exports.default=MapEvent;

},{"./events/Event.js":133}],94:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"};

},{}],95:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};

},{}],96:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ObjectEvent=void 0;var _Event2=_interopRequireDefault(require("./events/Event.js")),_ObjectEventType=_interopRequireDefault(require("./ObjectEventType.js")),_Observable2=_interopRequireDefault(require("./Observable.js")),_util=require("./util.js"),_obj=require("./obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ObjectEvent=exports.ObjectEvent=function(e){function t(e,r,n){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).key=r,o.oldValue=n,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),BaseObject=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,(0,_util.getUid)(r),r.values_=null,void 0!==e&&r.setProperties(e),r}return _inherits(t,_Observable2["default"]),_createClass(t,[{key:"get",value:function(e){var t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Object.assign({},this.values_)||{}}},{key:"getPropertiesInternal",value:function(){return this.values_}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(e,t){var r;r="change:".concat(e),this.hasListener(r)&&this.dispatchEvent(new ObjectEvent(r,e,t)),r=_ObjectEventType.default.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new ObjectEvent(r,e,t))}},{key:"addChangeListener",value:function(e,t){this.addEventListener("change:".concat(e),t)}},{key:"removeChangeListener",value:function(e,t){this.removeEventListener("change:".concat(e),t)}},{key:"set",value:function(e,t,r){var n=this.values_||(this.values_={});if(r)n[e]=t;else{var o=n[e];n[e]=t,o!==t&&this.notify(e,o)}}},{key:"setProperties",value:function(e,t){for(var r in e)this.set(r,e[r],t)}},{key:"applyProperties",value:function(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}},{key:"unset",value:function(e,t){if(this.values_&&e in this.values_){var r=this.values_[e];delete this.values_[e],(0,_obj.isEmpty)(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}])}(),_default=exports.default=BaseObject;

},{"./ObjectEventType.js":97,"./Observable.js":98,"./events/Event.js":133,"./obj.js":281,"./util.js":404}],97:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={PROPERTYCHANGE:"propertychange"};

},{}],98:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.unByKey=unByKey;var _Target=_interopRequireDefault(require("./events/Target.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_events=require("./events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Observable=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).on=e.onInternal,e.once=e.onceInternal,e.un=e.unInternal,e.revision_=0,e}return _inherits(t,_Target["default"]),_createClass(t,[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(_EventType.default.CHANGE)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(e,t){if(Array.isArray(e)){for(var r=e.length,n=new Array(r),o=0;o<r;++o)n[o]=(0,_events.listen)(this,e[o],t);return n}return(0,_events.listen)(this,e,t)}},{key:"onceInternal",value:function(e,t){var r;if(Array.isArray(e)){var n=e.length;r=new Array(n);for(var o=0;o<n;++o)r[o]=(0,_events.listenOnce)(this,e[o],t)}else r=(0,_events.listenOnce)(this,e,t);return t.ol_key=r,r}},{key:"unInternal",value:function(e,t){var r=t.ol_key;if(r)unByKey(r);else if(Array.isArray(e))for(var n=0,o=e.length;n<o;++n)this.removeEventListener(e[n],t);else this.removeEventListener(e,t)}}])}();function unByKey(e){if(Array.isArray(e))for(var t=0,r=e.length;t<r;++t)(0,_events.unlistenByKey)(e[t]);else(0,_events.unlistenByKey)(e)}Observable.prototype.on,Observable.prototype.once,Observable.prototype.un;var _default=exports.default=Observable;

},{"./events.js":132,"./events/EventType.js":134,"./events/Target.js":137}],99:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_MapEventType=_interopRequireDefault(require("./MapEventType.js")),_css=require("./css.js"),_extent=require("./extent.js"),_events=require("./events.js"),_dom=require("./dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Property={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},Overlay=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).on,n.once,n.un,n.options=e,n.id=e.id,n.insertFirst=void 0===e.insertFirst||e.insertFirst,n.stopEvent=void 0===e.stopEvent||e.stopEvent,n.element=document.createElement("div"),n.element.className=void 0!==e.className?e.className:"ol-overlay-container "+_css.CLASS_SELECTABLE,n.element.style.position="absolute",n.element.style.pointerEvents="auto",n.autoPan=!0===e.autoPan?{}:e.autoPan||void 0,n.rendered={transform_:"",visible:!0},n.mapPostrenderListenerKey=null,n.addChangeListener(Property.ELEMENT,n.handleElementChanged),n.addChangeListener(Property.MAP,n.handleMapChanged),n.addChangeListener(Property.OFFSET,n.handleOffsetChanged),n.addChangeListener(Property.POSITION,n.handlePositionChanged),n.addChangeListener(Property.POSITIONING,n.handlePositioningChanged),void 0!==e.element&&n.setElement(e.element),n.setOffset(void 0!==e.offset?e.offset:[0,0]),n.setPositioning(e.positioning||"top-left"),void 0!==e.position&&n.setPosition(e.position),n}return _inherits(t,_Object["default"]),_createClass(t,[{key:"getElement",value:function(){return this.get(Property.ELEMENT)}},{key:"getId",value:function(){return this.id}},{key:"getMap",value:function(){return this.get(Property.MAP)||null}},{key:"getOffset",value:function(){return this.get(Property.OFFSET)}},{key:"getPosition",value:function(){return this.get(Property.POSITION)}},{key:"getPositioning",value:function(){return this.get(Property.POSITIONING)}},{key:"handleElementChanged",value:function(){(0,_dom.removeChildren)(this.element);var e=this.getElement();e&&this.element.appendChild(e)}},{key:"handleMapChanged",value:function(){this.mapPostrenderListenerKey&&((0,_dom.removeNode)(this.element),(0,_events.unlistenByKey)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var e=this.getMap();if(e){this.mapPostrenderListenerKey=(0,_events.listen)(e,_MapEventType.default.POSTRENDER,this.render,this),this.updatePixelPosition();var t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}},{key:"render",value:function(){this.updatePixelPosition()}},{key:"handleOffsetChanged",value:function(){this.updatePixelPosition()}},{key:"handlePositionChanged",value:function(){this.updatePixelPosition(),this.performAutoPan()}},{key:"handlePositioningChanged",value:function(){this.updatePixelPosition()}},{key:"setElement",value:function(e){this.set(Property.ELEMENT,e)}},{key:"setMap",value:function(e){this.set(Property.MAP,e)}},{key:"setOffset",value:function(e){this.set(Property.OFFSET,e)}},{key:"setPosition",value:function(e){this.set(Property.POSITION,e)}},{key:"performAutoPan",value:function(){this.autoPan&&this.panIntoView(this.autoPan)}},{key:"panIntoView",value:function(e){var t=this.getMap();if(t&&t.getTargetElement()&&this.get(Property.POSITION)){var n=this.getRect(t.getTargetElement(),t.getSize()),r=this.getElement(),i=this.getRect(r,[(0,_dom.outerWidth)(r),(0,_dom.outerHeight)(r)]),o=void 0===(e=e||{}).margin?20:e.margin;if(!(0,_extent.containsExtent)(n,i)){var s=i[0]-n[0],a=n[2]-i[2],u=i[1]-n[1],l=n[3]-i[3],f=[0,0];if(s<0?f[0]=s-o:a<0&&(f[0]=Math.abs(a)+o),u<0?f[1]=u-o:l<0&&(f[1]=Math.abs(l)+o),0!==f[0]||0!==f[1]){var c=t.getView().getCenterInternal(),p=t.getPixelFromCoordinateInternal(c);if(!p)return;var d=[p[0]+f[0],p[1]+f[1]],y=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(d),duration:y.duration,easing:y.easing})}}}}},{key:"getRect",value:function(e,t){var n=e.getBoundingClientRect(),r=n.left+window.pageXOffset,i=n.top+window.pageYOffset;return[r,i,r+t[0],i+t[1]]}},{key:"setPositioning",value:function(e){this.set(Property.POSITIONING,e)}},{key:"setVisible",value:function(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}},{key:"updatePixelPosition",value:function(){var e=this.getMap(),t=this.getPosition();if(e&&e.isRendered()&&t){var n=e.getPixelFromCoordinate(t),r=e.getSize();this.updateRenderedPosition(n,r)}else this.setVisible(!1)}},{key:"updateRenderedPosition",value:function(e,t){var n=this.element.style,r=this.getOffset(),i=this.getPositioning();this.setVisible(!0);var o=Math.round(e[0]+r[0])+"px",s=Math.round(e[1]+r[1])+"px",a="0%",u="0%";"bottom-right"==i||"center-right"==i||"top-right"==i?a="-100%":"bottom-center"!=i&&"center-center"!=i&&"top-center"!=i||(a="-50%"),"bottom-left"==i||"bottom-center"==i||"bottom-right"==i?u="-100%":"center-left"!=i&&"center-center"!=i&&"center-right"!=i||(u="-50%");var l="translate(".concat(a,", ").concat(u,") translate(").concat(o,", ").concat(s,")");this.rendered.transform_!=l&&(this.rendered.transform_=l,n.transform=l)}},{key:"getOptions",value:function(){return this.options}}])}(),_default=exports.default=Overlay;

},{"./MapEventType.js":94,"./Object.js":96,"./css.js":129,"./dom.js":130,"./events.js":132,"./extent.js":142}],100:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Target=_interopRequireDefault(require("./events/Target.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_TileState=_interopRequireDefault(require("./TileState.js")),_util=require("./util.js"),_easing=require("./easing.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Tile=function(t){function e(t,r,i){var n;return _classCallCheck(this,e),i=i||{},(n=_callSuper(this,e)).tileCoord=t,n.state=r,n.interimTile=null,n.key="",n.transition_=void 0===i.transition?250:i.transition,n.transitionStarts_={},n.interpolate=!!i.interpolate,n}return _inherits(e,_Target["default"]),_createClass(e,[{key:"changed",value:function(){this.dispatchEvent(_EventType.default.CHANGE)}},{key:"release",value:function(){this.state===_TileState.default.ERROR&&this.setState(_TileState.default.EMPTY)}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){var t=this.interimTile;if(!t)return this;do{if(t.getState()==_TileState.default.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}},{key:"refreshInterimChain",value:function(){var t=this.interimTile;if(t){var e=this;do{if(t.getState()==_TileState.default.LOADED){t.interimTile=null;break}t.getState()==_TileState.default.LOADING?e=t:t.getState()==_TileState.default.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(this.state!==_TileState.default.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){(0,_util.abstract)()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var r=this.transitionStarts_[t];if(r){if(-1===r)return 1}else r=e,this.transitionStarts_[t]=r;var i=e-r+1e3/60;return i>=this.transition_?1:(0,_easing.easeIn)(i/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])}(),_default=exports.default=Tile;

},{"./TileState.js":104,"./easing.js":131,"./events/EventType.js":134,"./events/Target.js":137,"./util.js":404}],101:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _LRUCache2=_interopRequireDefault(require("./structs/LRUCache.js")),_tilecoord=require("./tilecoord.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileCache=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,_LRUCache2["default"]),_createClass(t,[{key:"clear",value:function(){for(;this.getCount()>0;)this.pop().release();_get(_getPrototypeOf(t.prototype),"clear",this).call(this)}},{key:"expireCache",value:function(e){for(;this.canExpireCache();){if(this.peekLast().getKey()in e)break;this.pop().release()}}},{key:"pruneExceptNewestZ",value:function(){var e=this;if(0!==this.getCount()){var t=this.peekFirstKey(),r=(0,_tilecoord.fromKey)(t)[0];this.forEach(function(t){t.tileCoord[0]!==r&&(e.remove((0,_tilecoord.getKey)(t.tileCoord)),t.release())})}}}])}(),_default=exports.default=TileCache;

},{"./structs/LRUCache.js":381,"./tilecoord.js":396}],102:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getTilePriority=getTilePriority;var _EventType=_interopRequireDefault(require("./events/EventType.js")),_PriorityQueue2=_interopRequireWildcard(require("./structs/PriorityQueue.js")),_TileState=_interopRequireDefault(require("./TileState.js"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var u=i?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileQueue=function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[function(t){return e.apply(null,t)},function(e){return e[0].getKey()}])).boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=r,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return _inherits(t,_PriorityQueue2["default"]),_createClass(t,[{key:"enqueue",value:function(e){var r=_get(_getPrototypeOf(t.prototype),"enqueue",this).call(this,e);r&&e[0].addEventListener(_EventType.default.CHANGE,this.boundHandleTileChange_);return r}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(e){var t=e.target,r=t.getState();if(r===_TileState.default.LOADED||r===_TileState.default.ERROR||r===_TileState.default.EMPTY){r!==_TileState.default.ERROR&&t.removeEventListener(_EventType.default.CHANGE,this.boundHandleTileChange_);var n=t.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(e,t){for(var r,n,i=0;this.tilesLoading_<e&&i<t&&this.getCount()>0;)n=(r=this.dequeue()[0]).getKey(),r.getState()!==_TileState.default.IDLE||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++i,r.load())}}])}(),_default=exports.default=TileQueue;function getTilePriority(e,t,r,n,i){if(!(e&&r in e.wantedTiles))return _PriorityQueue2.DROP;if(!e.wantedTiles[r][t.getKey()])return _PriorityQueue2.DROP;var o=e.viewState.center,u=n[0]-o[0],l=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(u*u+l*l)/i}

},{"./TileState.js":104,"./events/EventType.js":134,"./structs/PriorityQueue.js":382}],103:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=createOrUpdate,exports.default=void 0;var TileRange=function(){return _createClass(function t(e,i,n,r){_classCallCheck(this,t),this.minX=e,this.maxX=i,this.minY=n,this.maxY=r},[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])}();function createOrUpdate(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new TileRange(t,e,i,n)}var _default=exports.default=TileRange;

},{}],104:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};

},{}],105:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Tile2=_interopRequireDefault(require("./Tile.js")),_dom=require("./dom.js"),_util=require("./util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var canvasPool=[],VectorRenderTile=function(e){function t(e,r,o,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,r,{transition:0}])).context_={},i.executorGroups={},i.loadingSourceTiles=0,i.hitDetectionImageData={},i.replayState_={},i.sourceTiles=[],i.errorTileKeys={},i.wantedResolution,i.getSourceTiles=n.bind(void 0,i),i.wrappedTileCoord=o,i}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getContext",value:function(e){var t=(0,_util.getUid)(e);return t in this.context_||(this.context_[t]=(0,_dom.createCanvasContext2D)(1,1,canvasPool)),this.context_[t]}},{key:"hasContext",value:function(e){return(0,_util.getUid)(e)in this.context_}},{key:"getImage",value:function(e){return this.hasContext(e)?this.getContext(e).canvas:null}},{key:"getReplayState",value:function(e){var t=(0,_util.getUid)(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}},{key:"load",value:function(){this.getSourceTiles()}},{key:"release",value:function(){for(var e in this.context_){var r=this.context_[e];(0,_dom.releaseCanvas)(r),canvasPool.push(r.canvas),delete this.context_[e]}_get(_getPrototypeOf(t.prototype),"release",this).call(this)}}])}(),_default=exports.default=VectorRenderTile;

},{"./Tile.js":100,"./dom.js":130,"./util.js":404}],106:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Tile2=_interopRequireDefault(require("./Tile.js")),_TileState=_interopRequireDefault(require("./TileState.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var VectorTile=function(t){function e(t,r,o,n,i,u){var l;return _classCallCheck(this,e),(l=_callSuper(this,e,[t,r,u])).extent=null,l.format_=n,l.features_=null,l.loader_,l.projection=null,l.resolution,l.tileLoadFunction_=i,l.url_=o,l.key=o,l}return _inherits(e,_Tile2["default"]),_createClass(e,[{key:"getFormat",value:function(){return this.format_}},{key:"getFeatures",value:function(){return this.features_}},{key:"load",value:function(){this.state==_TileState.default.IDLE&&(this.setState(_TileState.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}},{key:"onLoad",value:function(t,e){this.setFeatures(t)}},{key:"onError",value:function(){this.setState(_TileState.default.ERROR)}},{key:"setFeatures",value:function(t){this.features_=t,this.setState(_TileState.default.LOADED)}},{key:"setLoader",value:function(t){this.loader_=t}}])}(),_default=exports.default=VectorTile;

},{"./Tile.js":100,"./TileState.js":104}],107:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCenterConstraint=createCenterConstraint,exports.createResolutionConstraint=createResolutionConstraint,exports.createRotationConstraint=createRotationConstraint,exports.default=void 0,exports.isNoopAnimation=isNoopAnimation;var _Object=_interopRequireDefault(require("./Object.js")),_ViewHint=_interopRequireDefault(require("./ViewHint.js")),_ViewProperty=_interopRequireDefault(require("./ViewProperty.js")),_common=require("./tilegrid/common.js"),_proj=require("./proj.js"),_functions=require("./functions.js"),_coordinate=require("./coordinate.js"),_asserts=require("./asserts.js"),_centerconstraint=require("./centerconstraint.js"),_math=require("./math.js"),_resolutionconstraint=require("./resolutionconstraint.js"),_rotationconstraint=require("./rotationconstraint.js"),_easing=require("./easing.js"),_extent2=require("./extent.js"),_array=require("./array.js"),_Polygon=require("./geom/Polygon.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,n){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,n||[],_getPrototypeOf(t).constructor):e.apply(t,n))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DEFAULT_MIN_ZOOM=0,View=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_callSuper(this,e)).on,n.once,n.un,t=Object.assign({},t),n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=(0,_proj.createProjection)(t.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,t.projection&&(0,_proj.disableCoordinateWarning)(),t.center&&(t.center=(0,_proj.fromUserCoordinate)(t.center,n.projection_)),t.extent&&(t.extent=(0,_proj.fromUserExtent)(t.extent,n.projection_)),n.applyOptions_(t),n}return _inherits(e,_Object["default"]),_createClass(e,[{key:"applyOptions_",value:function(t){var e=Object.assign({},t);for(var n in _ViewProperty.default)delete e[n];this.setProperties(e,!0);var o=createResolutionConstraint(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=o.minZoom;var i=createCenterConstraint(t),r=o.constraint,a=createRotationConstraint(t);this.constraints_={center:i,resolution:r,rotation:a},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var n=this.getCenterInternal();if(n){var o=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution(),r=i/2*(o[3]-e[3]+e[1]-o[1]),a=i/2*(o[0]-e[0]+e[2]-o[2]);this.setCenterInternal([n[0]+r,n[1]-a])}}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var o=arguments[n];o.center&&((o=Object.assign({},o)).center=(0,_proj.fromUserCoordinate)(o.center,this.getProjection())),o.anchor&&((o=Object.assign({},o)).anchor=(0,_proj.fromUserCoordinate)(o.anchor,this.getProjection())),e[n]=o}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);for(var o=0;o<n&&!this.isDef();++o){var i=arguments[o];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(o!==n){for(var r=Date.now(),a=this.targetCenter_.slice(),s=this.targetResolution_,u=this.targetRotation_,l=[];o<n;++o){var c=arguments[o],h={start:r,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||_easing.inAndOut,callback:e};if(c.center&&(h.sourceCenter=a,h.targetCenter=c.center.slice(),a=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=s,h.targetResolution=this.getResolutionForZoom(c.zoom),s=h.targetResolution):c.resolution&&(h.sourceResolution=s,h.targetResolution=c.resolution,s=h.targetResolution),void 0!==c.rotation){h.sourceRotation=u;var _=(0,_math.modulo)(c.rotation-u+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=u+_,u=h.targetRotation}isNoopAnimation(h)?h.complete=!0:r+=h.duration,l.push(h)}this.animations_.push(l),this.setHint(_ViewHint.default.ANIMATING,1),this.updateAnimations_()}else e&&animationCallback(e,!0)}},{key:"getAnimating",value:function(){return this.hints_[_ViewHint.default.ANIMATING]>0}},{key:"getInteracting",value:function(){return this.hints_[_ViewHint.default.INTERACTING]>0}},{key:"cancelAnimations",value:function(){var t;this.setHint(_ViewHint.default.ANIMATING,-this.hints_[_ViewHint.default.ANIMATING]);for(var e=0,n=this.animations_.length;e<n;++e){var o=this.animations_[e];if(o[0].callback&&animationCallback(o[0].callback,!1),!t)for(var i=0,r=o.length;i<r;++i){var a=o[i];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var o=this.animations_[n],i=!0,r=0,a=o.length;r<a;++r){var s=o[r];if(!s.complete){var u=t-s.start,l=s.duration>0?u/s.duration:1;l>=1?(s.complete=!0,l=1):i=!1;var c=s.easing(l);if(s.sourceCenter){var h=s.sourceCenter[0],_=s.sourceCenter[1],g=s.targetCenter[0],f=s.targetCenter[1];this.nextCenter_=s.targetCenter;var v=h+c*(g-h),p=_+c*(f-_);this.targetCenter_=[v,p]}if(s.sourceResolution&&s.targetResolution){var d=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var m=this.getViewportSize_(this.getRotation()),R=this.constraints_.resolution(d,0,m,!0);this.targetCenter_=this.calculateCenterZoom(R,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var y=1===c?(0,_math.modulo)(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var C=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(C,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(i){this.animations_[n]=null,this.setHint(_ViewHint.default.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var j=o[0].callback;j&&animationCallback(j,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,o=this.getCenterInternal();return void 0!==o&&(n=[o[0]-e[0],o[1]-e[1]],(0,_coordinate.rotate)(n,t-this.getRotation()),(0,_coordinate.add)(n,e)),n}},{key:"calculateCenterZoom",value:function(t,e){var n,o=this.getCenterInternal(),i=this.getResolution();void 0!==o&&void 0!==i&&(n=[e[0]-t*(e[0]-o[0])/i,e[1]-t*(e[1]-o[1])/i]);return n}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var n=e[0],o=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(o*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(o*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?(0,_proj.toUserCoordinate)(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(_ViewProperty.default.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){var e=this.calculateExtentInternal(t);return(0,_proj.toUserExtent)(e,this.getProjection())}},{key:"calculateExtentInternal",value:function(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal();(0,_asserts.assert)(e,"The view center is not defined");var n=this.getResolution();(0,_asserts.assert)(void 0!==n,"The view resolution is not defined");var o=this.getRotation();return(0,_asserts.assert)(void 0!==o,"The view rotation is not defined"),(0,_extent2.getForViewAndSize)(e,n,o,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(_ViewProperty.default.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal((0,_proj.fromUserExtent)(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){e=e||this.getViewportSizeMinusPadding_();var n=(0,_extent2.getWidth)(t)/e[0],o=(0,_extent2.getHeight)(t)/e[1];return Math.max(n,o)}},{key:"getResolutionForValueFunction",value:function(t){t=t||2;var e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,o=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*o)}}},{key:"getRotation",value:function(){return this.get(_ViewProperty.default.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,i=Math.log(n/o)/e;return function(t){return Math.log(n/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){var e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}},{key:"getState",value:function(){var t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),o=this.getCenterInternal(),i=this.padding_;if(i){var r=this.getViewportSizeMinusPadding_();o=calculateCenterOn(o,this.getViewportSize_(),[r[0]/2+i[3],r[1]/2+i[0]],e,n)}return{center:o.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}},{key:"getViewStateAndExtent",value:function(){return{viewState:this.getState(),extent:this.calculateExtent()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,n,o=this.minZoom_||0;if(this.resolutions_){var i=(0,_array.linearFindNearest)(this.resolutions_,t,1);o=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return o+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=(0,_math.clamp)(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,(0,_math.clamp)(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var n;if((0,_asserts.assert)(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){(0,_asserts.assert)(!(0,_extent2.isEmpty)(t),"Cannot fit empty extent provided as `geometry`");var o=(0,_proj.fromUserExtent)(t,this.getProjection());n=(0,_Polygon.fromExtent)(o)}else if("Circle"===t.getType()){var i=(0,_proj.fromUserExtent)(t.getExtent(),this.getProjection());(n=(0,_Polygon.fromExtent)(i)).rotate(this.getRotation(),(0,_extent2.getCenter)(i))}else{var r=(0,_proj.getUserProjection)();n=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(n,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),n=Math.cos(e),o=Math.sin(-e),i=t.getFlatCoordinates(),r=t.getStride(),a=1/0,s=1/0,u=-1/0,l=-1/0,c=0,h=i.length;c<h;c+=r){var _=i[c]*n-i[c+1]*o,g=i[c]*o+i[c+1]*n;a=Math.min(a,_),s=Math.min(s,g),u=Math.max(u,_),l=Math.max(l,g)}return[a,s,u,l]}},{key:"fitInternal",value:function(t,e){var n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());var o,i=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;var a=this.rotatedExtentForGeometry(t),s=this.getResolutionForExtentInternal(a,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);s=isNaN(s)?o:Math.max(s,o),s=this.getConstrainedResolution(s,r?0:1);var u=this.getRotation(),l=Math.sin(u),c=Math.cos(u),h=(0,_extent2.getCenter)(a);h[0]+=(i[1]-i[3])/2*s,h[1]+=(i[0]-i[2])/2*s;var _=h[0]*c-h[1]*l,g=h[1]*c+h[0]*l,f=this.getConstrainedCenter([_,g],s),v=e.callback?e.callback:_functions.VOID;void 0!==e.duration?this.animateInternal({resolution:s,center:f,duration:e.duration,easing:e.easing},v):(this.targetResolution_=s,this.targetCenter_=f,this.applyTargetState_(!1,!0),animationCallback(v,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal((0,_proj.fromUserCoordinate)(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){this.setCenterInternal(calculateCenterOn(t,e,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,n,o){var i,r=this.padding_;if(r&&t){var a=this.getViewportSizeMinusPadding_(-n),s=calculateCenterOn(t,o,[a[0]/2+r[3],a[1]/2+r[0]],e,n);i=[t[0]-s[0],t[1]-s[1]]}return i}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=(0,_proj.toUserCoordinate)(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){e=e&&(0,_proj.fromUserCoordinate)(e,this.getProjection()),this.adjustResolutionInternal(t,e)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),o=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,o,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=(0,_proj.fromUserCoordinate)(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),o=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(o,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t?(0,_proj.fromUserCoordinate)(t,this.getProjection()):t)}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var n=this.getAnimating()||this.getInteracting()||e,o=this.constraints_.rotation(this.targetRotation_,n),i=this.getViewportSize_(o),r=this.constraints_.resolution(this.targetResolution_,0,i,n),a=this.constraints_.center(this.targetCenter_,r,i,n,this.calculateCenterShift(this.targetCenter_,r,o,i));this.get(_ViewProperty.default.ROTATION)!==o&&this.set(_ViewProperty.default.ROTATION,o),this.get(_ViewProperty.default.RESOLUTION)!==r&&(this.set(_ViewProperty.default.RESOLUTION,r),this.set("zoom",this.getZoom(),!0)),a&&this.get(_ViewProperty.default.CENTER)&&(0,_coordinate.equals)(this.get(_ViewProperty.default.CENTER),a)||this.set(_ViewProperty.default.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){t=void 0!==t?t:200;var o=e||0,i=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,o,r),s=this.constraints_.center(this.targetCenter_,a,r,!1,this.calculateCenterShift(this.targetCenter_,a,i,r));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=i,this.targetCenter_=s,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===i&&this.getCenterInternal()&&(0,_coordinate.equals)(this.getCenterInternal(),s)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:s,resolution:a,duration:t,easing:_easing.easeOut,anchor:n}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(_ViewHint.default.INTERACTING,1)}},{key:"endInteraction",value:function(t,e,n){n=n&&(0,_proj.fromUserCoordinate)(n,this.getProjection()),this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,n){this.getInteracting()&&(this.setHint(_ViewHint.default.INTERACTING,-1),this.resolveConstraints(t,e,n))}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}},{key:"getConstrainedResolution",value:function(t,e){e=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}])}();function animationCallback(t,e){setTimeout(function(){t(e)},0)}function createCenterConstraint(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return(0,_centerconstraint.createExtent)(t.extent,t.constrainOnlyCenter,e)}var n=(0,_proj.createProjection)(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var o=n.getExtent().slice();return o[0]=-1/0,o[2]=1/0,(0,_centerconstraint.createExtent)(o,!1,!1)}return _centerconstraint.none}function createResolutionConstraint(t){var e,n,o,i=void 0!==t.minZoom?t.minZoom:DEFAULT_MIN_ZOOM,r=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,s=void 0!==t.multiWorld&&t.multiWorld,u=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,c=(0,_proj.createProjection)(t.projection,"EPSG:3857"),h=c.getExtent(),_=t.constrainOnlyCenter,g=t.extent;if(s||g||!c.isGlobal()||(_=!1,g=h),void 0!==t.resolutions){var f=t.resolutions;n=f[i],o=void 0!==f[r]?f[r]:f[f.length-1],e=t.constrainResolution?(0,_resolutionconstraint.createSnapToResolutions)(f,u,!_&&g,l):(0,_resolutionconstraint.createMinMaxResolution)(n,o,u,!_&&g,l)}else{var v=(h?Math.max((0,_extent2.getWidth)(h),(0,_extent2.getHeight)(h)):360*_proj.METERS_PER_UNIT.degrees/c.getMetersPerUnit())/_common.DEFAULT_TILE_SIZE/Math.pow(2,DEFAULT_MIN_ZOOM),p=v/Math.pow(2,28-DEFAULT_MIN_ZOOM);void 0!==(n=t.maxResolution)?i=0:n=v/Math.pow(a,i),void 0===(o=t.minResolution)&&(o=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,r):v/Math.pow(a,r):p),r=i+Math.floor(Math.log(n/o)/Math.log(a)),o=n/Math.pow(a,r-i),e=t.constrainResolution?(0,_resolutionconstraint.createSnapToPower)(a,n,o,u,!_&&g,l):(0,_resolutionconstraint.createMinMaxResolution)(n,o,u,!_&&g,l)}return{constraint:e,maxResolution:n,minResolution:o,minZoom:i,zoomFactor:a}}function createRotationConstraint(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(0,_rotationconstraint.createSnapToZero)():!1===e?_rotationconstraint.none:"number"==typeof e?(0,_rotationconstraint.createSnapToN)(e):_rotationconstraint.none}return _rotationconstraint.disable}function isNoopAnimation(t){return!(t.sourceCenter&&t.targetCenter&&!(0,_coordinate.equals)(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function calculateCenterOn(t,e,n,o,i){var r=Math.cos(-i),a=Math.sin(-i),s=t[0]*r-t[1]*a,u=t[1]*r+t[0]*a;return[(s+=(e[0]/2-n[0])*o)*r-(u+=(n[1]-e[1]/2)*o)*(a=-a),u*r+s*a]}var _default=exports.default=View;

},{"./Object.js":96,"./ViewHint.js":108,"./ViewProperty.js":109,"./array.js":110,"./asserts.js":111,"./centerconstraint.js":112,"./coordinate.js":128,"./easing.js":131,"./extent.js":142,"./functions.js":200,"./geom/Polygon.js":211,"./math.js":279,"./proj.js":283,"./resolutionconstraint.js":335,"./rotationconstraint.js":336,"./tilegrid/common.js":400}],108:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ANIMATING:0,INTERACTING:1};

},{}],109:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};

},{}],110:[function(require,module,exports){
"use strict";function binarySearch(r,e,n){var t,i;n=n||ascending;for(var a=0,u=r.length,o=!1;a<u;)(i=+n(r[t=a+(u-a>>1)],e))<0?a=t+1:(u=t,o=!i);return o?a:~a}function ascending(r,e){return r>e?1:r<e?-1:0}function descending(r,e){return r<e?1:r>e?-1:0}function linearFindNearest(r,e,n){if(r[0]<=e)return 0;var t=r.length;if(e<=r[t-1])return t-1;if("function"==typeof n){for(var i=1;i<t;++i){var a=r[i];if(a===e)return i;if(a<e)return n(e,r[i-1],a)>0?i-1:i}return t-1}if(n>0){for(var u=1;u<t;++u)if(r[u]<e)return u-1;return t-1}if(n<0){for(var o=1;o<t;++o)if(r[o]<=e)return o;return t-1}for(var f=1;f<t;++f){if(r[f]==e)return f;if(r[f]<e)return r[f-1]-e<e-r[f]?f-1:f}return t-1}function reverseSubArray(r,e,n){for(;e<n;){var t=r[e];r[e]=r[n],r[n]=t,++e,--n}}function extend(r,e){for(var n=Array.isArray(e)?e:[e],t=n.length,i=0;i<t;i++)r[r.length]=n[i]}function remove(r,e){var n=r.indexOf(e),t=n>-1;return t&&r.splice(n,1),t}function equals(r,e){var n=r.length;if(n!==e.length)return!1;for(var t=0;t<n;t++)if(r[t]!==e[t])return!1;return!0}function stableSort(r,e){var n,t=r.length,i=Array(r.length);for(n=0;n<t;n++)i[n]={index:n,value:r[n]};for(i.sort(function(r,n){return e(r.value,n.value)||r.index-n.index}),n=0;n<r.length;n++)r[n]=i[n].value}function isSorted(r,e,n){var t=e||ascending;return r.every(function(e,i){if(0===i)return!0;var a=t(r[i-1],e);return!(a>0||n&&0===a)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ascending=ascending,exports.binarySearch=binarySearch,exports.descending=descending,exports.equals=equals,exports.extend=extend,exports.isSorted=isSorted,exports.linearFindNearest=linearFindNearest,exports.remove=remove,exports.reverseSubArray=reverseSubArray,exports.stableSort=stableSort;

},{}],111:[function(require,module,exports){
"use strict";function assert(e,r){if(!e)throw new Error(r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=assert;

},{}],112:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExtent=createExtent,exports.none=none;var _math=require("./math.js");function createExtent(t,e,a){return function(r,n,o,h,u){if(r){if(!n&&!e)return r;var c=e?0:o[0]*n,m=e?0:o[1]*n,x=u?u[0]:0,i=u?u[1]:0,M=t[0]+c/2+x,l=t[2]-c/2+x,f=t[1]+m/2+i,s=t[3]-m/2+i;M>l&&(l=M=(l+M)/2),f>s&&(s=f=(s+f)/2);var p=(0,_math.clamp)(r[0],M,l),v=(0,_math.clamp)(r[1],f,s);if(h&&a&&n){var _=30*n;p+=-_*Math.log(1+Math.max(0,M-r[0])/_)+_*Math.log(1+Math.max(0,r[0]-l)/_),v+=-_*Math.log(1+Math.max(0,f-r[1])/_)+_*Math.log(1+Math.max(0,r[1]-s)/_)}return[p,v]}}}function none(t){return t}

},{"./math.js":279}],113:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asArray=asArray,exports.asString=asString,exports.fromString=fromString,exports.isStringColor=isStringColor,exports.lchaToRgba=lchaToRgba,exports.normalize=normalize,exports.rgbaToLcha=rgbaToLcha,exports.toString=toString,exports.withAlpha=withAlpha;var _lchuv=_interopRequireDefault(require("color-space/lchuv.js")),_colorRgba=_interopRequireDefault(require("color-rgba")),_rgb=_interopRequireDefault(require("color-space/rgb.js")),_xyz=_interopRequireDefault(require("color-space/xyz.js")),_math=require("./math.js");function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var a=0,o=function(){};return{s:o,n:function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,u=!1;return{s:function(){t=t.call(r)},n:function(){var r=t.next();return i=r.done,r},e:function(r){u=!0,n=r},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw n}}}}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=Array(e);t<e;t++)a[t]=r[t];return a}function asString(r){return"string"==typeof r?r:toString(r)}var MAX_CACHE_SIZE=1024,cache={},cacheSize=0;function withAlpha(r){if(4===r.length)return r;var e=r.slice();return e[3]=1,e}function rgbaToLcha(r){var e=_xyz.default.lchuv(_rgb.default.xyz(r));return e[3]=r[3],e}function lchaToRgba(r){var e=_xyz.default.rgb(_lchuv.default.xyz(r));return e[3]=r[3],e}function fromString(r){if(cache.hasOwnProperty(r))return cache[r];if(cacheSize>=MAX_CACHE_SIZE){var e=0;for(var t in cache)0==(3&e++)&&(delete cache[t],--cacheSize)}var a=(0,_colorRgba.default)(r);if(4!==a.length)throw new Error('Failed to parse "'+r+'" as color');var o,n=_createForOfIteratorHelper(a);try{for(n.s();!(o=n.n()).done;){var i=o.value;if(isNaN(i))throw new Error('Failed to parse "'+r+'" as color')}}catch(r){n.e(r)}finally{n.f()}return normalize(a),cache[r]=a,++cacheSize,a}function asArray(r){return Array.isArray(r)?r:fromString(r)}function normalize(r){return r[0]=(0,_math.clamp)(r[0]+.5|0,0,255),r[1]=(0,_math.clamp)(r[1]+.5|0,0,255),r[2]=(0,_math.clamp)(r[2]+.5|0,0,255),r[3]=(0,_math.clamp)(r[3],0,1),r}function toString(r){var e=r[0];e!=(0|e)&&(e=e+.5|0);var t=r[1];t!=(0|t)&&(t=t+.5|0);var a=r[2];return a!=(0|a)&&(a=a+.5|0),"rgba("+e+","+t+","+a+","+(void 0===r[3]?1:Math.round(1e3*r[3])/1e3)+")"}function isStringColor(r){try{return fromString(r),!0}catch(r){return!1}}

},{"./math.js":279,"color-rgba":13,"color-space/lchuv.js":15,"color-space/rgb.js":17,"color-space/xyz.js":18}],114:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asColorLike=asColorLike;var _ImageState=_interopRequireDefault(require("./ImageState.js")),_dom=require("./dom.js"),_IconImage=require("./style/IconImage.js"),_IconImageCache=require("./style/IconImageCache.js"),_color=require("./color.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asColorLike(e){return e?Array.isArray(e)?(0,_color.toString)(e):"object"===_typeof(e)&&"src"in e?asCanvasPattern(e):e:null}function asCanvasPattern(e){if(!e.offset||!e.size)return _IconImageCache.shared.getPattern(e.src,"anonymous",e.color);var t=e.src+":"+e.offset,o=_IconImageCache.shared.getPattern(t,void 0,e.color);if(o)return o;var r=_IconImageCache.shared.get(e.src,"anonymous",null);if(r.getImageState()!==_ImageState.default.LOADED)return null;var a=(0,_dom.createCanvasContext2D)(e.size[0],e.size[1]);return a.drawImage(r.getImage(1),e.offset[0],e.offset[1],e.size[0],e.size[1],0,0,e.size[0],e.size[1]),(0,_IconImage.get)(a.canvas,t,void 0,_ImageState.default.LOADED,e.color,!0),_IconImageCache.shared.getPattern(t,void 0,e.color)}

},{"./ImageState.js":86,"./color.js":113,"./dom.js":130,"./style/IconImage.js":388,"./style/IconImageCache.js":389}],115:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.error=error,exports.log=log,exports.setLevel=setLevel,exports.warn=warn;var levels={info:1,warn:2,error:3,none:4},level=levels.info;function setLevel(e){level=levels[e]}function log(){var e;level>levels.info||(e=console).log.apply(e,arguments)}function warn(){var e;level>levels.warn||(e=console).warn.apply(e,arguments)}function error(){var e;level>levels.error||(e=console).error.apply(e,arguments)}

},{}],116:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Attribution",{enumerable:!0,get:function(){return _Attribution.default}}),Object.defineProperty(exports,"Control",{enumerable:!0,get:function(){return _Control.default}}),Object.defineProperty(exports,"FullScreen",{enumerable:!0,get:function(){return _FullScreen.default}}),Object.defineProperty(exports,"MousePosition",{enumerable:!0,get:function(){return _MousePosition.default}}),Object.defineProperty(exports,"OverviewMap",{enumerable:!0,get:function(){return _OverviewMap.default}}),Object.defineProperty(exports,"Rotate",{enumerable:!0,get:function(){return _Rotate.default}}),Object.defineProperty(exports,"ScaleLine",{enumerable:!0,get:function(){return _ScaleLine.default}}),Object.defineProperty(exports,"Zoom",{enumerable:!0,get:function(){return _Zoom.default}}),Object.defineProperty(exports,"ZoomSlider",{enumerable:!0,get:function(){return _ZoomSlider.default}}),Object.defineProperty(exports,"ZoomToExtent",{enumerable:!0,get:function(){return _ZoomToExtent.default}}),Object.defineProperty(exports,"defaults",{enumerable:!0,get:function(){return _defaults.defaults}});var _Attribution=_interopRequireDefault(require("./control/Attribution.js")),_Control=_interopRequireDefault(require("./control/Control.js")),_FullScreen=_interopRequireDefault(require("./control/FullScreen.js")),_MousePosition=_interopRequireDefault(require("./control/MousePosition.js")),_OverviewMap=_interopRequireDefault(require("./control/OverviewMap.js")),_Rotate=_interopRequireDefault(require("./control/Rotate.js")),_ScaleLine=_interopRequireDefault(require("./control/ScaleLine.js")),_Zoom=_interopRequireDefault(require("./control/Zoom.js")),_ZoomSlider=_interopRequireDefault(require("./control/ZoomSlider.js")),_ZoomToExtent=_interopRequireDefault(require("./control/ZoomToExtent.js")),_defaults=require("./control/defaults.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./control/Attribution.js":117,"./control/Control.js":118,"./control/FullScreen.js":119,"./control/MousePosition.js":120,"./control/OverviewMap.js":121,"./control/Rotate.js":122,"./control/ScaleLine.js":123,"./control/Zoom.js":124,"./control/ZoomSlider.js":125,"./control/ZoomToExtent.js":126,"./control/defaults.js":127}],117:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_array=require("../array.js"),_dom=require("../dom.js"),_functions=require("../functions.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new k(n||[]);return o(a,"_invoke",{value:x(e,r,l)}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",_={};function v(){}function b(){}function g(){}var m={};c(m,a,function(){return this});var w=Object.getPrototypeOf,L=w&&w(w(A([])));L&&L!==r&&n.call(L,a)&&(m=L);var C=g.prototype=v.prototype=Object.create(m);function E(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function O(e,t){function r(o,i,a,l){var s=p(e[o],e,i);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==_typeof(u)&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,a,l)},function(e){r("throw",e,a,l)}):t.resolve(u).then(function(e){c.value=e,a(c)},function(e){return r("throw",e,a,l)})}l(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t(function(t,o){r(e,n,t,o)})}return i=i?i.then(o,o):o()}})}function x(t,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var l=n.delegate;if(l){var s=P(l,n);if(s){if(s===_)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=p(t,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function P(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=p(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(t)+" is not iterable")}return b.prototype=g,o(C,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},E(O.prototype),c(O.prototype,l,function(){return this}),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(C),c(C,s,"Generator"),c(C,a,function(){return this}),c(C,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function asyncGeneratorStep(e,t,r,n,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep(i,n,o,a,l,"next",e)}function l(e){asyncGeneratorStep(i,n,o,a,l,"throw",e)}a(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Attribution=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t,[{element:document.createElement("div"),render:e.render,target:e.target}])).ulElement_=document.createElement("ul"),r.collapsed_=void 0===e.collapsed||e.collapsed,r.userCollapsed_=r.collapsed_,r.overrideCollapsible_=void 0!==e.collapsible,r.collapsible_=void 0===e.collapsible||e.collapsible,r.collapsible_||(r.collapsed_=!1);var n=void 0!==e.className?e.className:"ol-attribution",o=void 0!==e.tipLabel?e.tipLabel:"Attributions",i=void 0!==e.expandClassName?e.expandClassName:n+"-expand",a=void 0!==e.collapseLabel?e.collapseLabel:"âº",l=void 0!==e.collapseClassName?e.collapseClassName:n+"-collapse";"string"==typeof a?(r.collapseLabel_=document.createElement("span"),r.collapseLabel_.textContent=a,r.collapseLabel_.className=l):r.collapseLabel_=a;var s=void 0!==e.label?e.label:"i";"string"==typeof s?(r.label_=document.createElement("span"),r.label_.textContent=s,r.label_.className=i):r.label_=s;var c=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_;r.toggleButton_=document.createElement("button"),r.toggleButton_.setAttribute("type","button"),r.toggleButton_.setAttribute("aria-expanded",String(!r.collapsed_)),r.toggleButton_.title=o,r.toggleButton_.appendChild(c),r.toggleButton_.addEventListener(_EventType.default.CLICK,r.handleClick_.bind(r),!1);var u=n+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL+(r.collapsed_&&r.collapsible_?" "+_css.CLASS_COLLAPSED:"")+(r.collapsible_?"":" ol-uncollapsible"),p=r.element;return p.className=u,p.appendChild(r.toggleButton_),p.appendChild(r.ulElement_),r.renderedAttributions_=[],r.renderedVisible_=!0,r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"collectSourceAttributions_",value:function(e){var t=Array.from(new Set(this.getMap().getAllLayers().flatMap(function(t){return t.getAttributions(e)}))),r=!this.getMap().getAllLayers().some(function(e){return e.getSource()&&!1===e.getSource().getAttributionsCollapsible()});return this.overrideCollapsible_||this.setCollapsible(r),t}},{key:"updateElement_",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,i,a;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1),e.abrupt("return");case 3:return e.next=5,Promise.all(this.collectSourceAttributions_(t).map(function(e){return(0,_functions.toPromise)(function(){return e})}));case 5:if(r=e.sent,n=r.length>0,this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!(0,_array.equals)(r,this.renderedAttributions_)){e.next=10;break}return e.abrupt("return");case 10:for((0,_dom.removeChildren)(this.ulElement_),o=0,i=r.length;o<i;++o)(a=document.createElement("li")).innerHTML=r[o],this.ulElement_.appendChild(a);this.renderedAttributions_=r;case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleClick_",value:function(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle(_css.CLASS_COLLAPSED),this.collapsed_?(0,_dom.replaceNode)(this.collapseLabel_,this.label_):(0,_dom.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(e){this.userCollapsed_=e,this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(e){this.updateElement_(e.frameState)}}])}(),_default=exports.default=Attribution;

},{"../array.js":110,"../css.js":129,"../dom.js":130,"../events/EventType.js":134,"../functions.js":200,"./Control.js":118}],118:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_MapEventType=_interopRequireDefault(require("../MapEventType.js")),_functions=require("../functions.js"),_events=require("../events.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Control=function(e){function t(e){var r;_classCallCheck(this,t),r=_callSuper(this,t);var n=e.element;return!n||e.target||n.style.pointerEvents||(n.style.pointerEvents="auto"),r.element=n||null,r.target_=null,r.map_=null,r.listenerKeys=[],e.render&&(r.render=e.render),e.target&&r.setTarget(e.target),r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"disposeInternal",value:function(){(0,_dom.removeNode)(this.element),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(e){this.map_&&(0,_dom.removeNode)(this.element);for(var t=0,r=this.listenerKeys.length;t<r;++t)(0,_events.unlistenByKey)(this.listenerKeys[t]);(this.listenerKeys.length=0,this.map_=e,e)&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==_functions.VOID&&this.listenerKeys.push((0,_events.listen)(e,_MapEventType.default.POSTRENDER,this.render,this)),e.render())}},{key:"render",value:function(e){}},{key:"setTarget",value:function(e){this.target_="string"==typeof e?document.getElementById(e):e}}])}(),_default=exports.default=Control;

},{"../MapEventType.js":94,"../Object.js":96,"../dom.js":130,"../events.js":132,"../functions.js":200}],119:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_MapProperty=_interopRequireDefault(require("../MapProperty.js")),_css=require("../css.js"),_events=require("../events.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var l=Object.getOwnPropertyDescriptor(n,t);return l.get?l.get.call(arguments.length<3?e:r):l.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var events=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],FullScreenEventType={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"},FullScreen=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t,[{element:document.createElement("div"),target:e.target}])).on,r.once,r.un,r.keys_=void 0!==e.keys&&e.keys,r.source_=e.source,r.isInFullscreen_=!1,r.boundHandleMapTargetChange_=r.handleMapTargetChange_.bind(r),r.cssClassName_=void 0!==e.className?e.className:"ol-full-screen",r.documentListeners_=[],r.activeClassName_=void 0!==e.activeClassName?e.activeClassName.split(" "):[r.cssClassName_+"-true"],r.inactiveClassName_=void 0!==e.inactiveClassName?e.inactiveClassName.split(" "):[r.cssClassName_+"-false"];var n=void 0!==e.label?e.label:"â¤¢";r.labelNode_="string"==typeof n?document.createTextNode(n):n;var l=void 0!==e.labelActive?e.labelActive:"Ã";r.labelActiveNode_="string"==typeof l?document.createTextNode(l):l;var o=e.tipLabel?e.tipLabel:"Toggle full-screen";return r.button_=document.createElement("button"),r.button_.title=o,r.button_.setAttribute("type","button"),r.button_.appendChild(r.labelNode_),r.button_.addEventListener(_EventType.default.CLICK,r.handleClick_.bind(r),!1),r.setClassName_(r.button_,r.isInFullscreen_),r.element.className="".concat(r.cssClassName_," ").concat(_css.CLASS_UNSELECTABLE," ").concat(_css.CLASS_CONTROL),r.element.appendChild(r.button_),r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleClick_",value:function(e){e.preventDefault(),this.handleFullScreen_()}},{key:"handleFullScreen_",value:function(){var e=this.getMap();if(e){var t,r=e.getOwnerDocument();if(isFullScreenSupported(r))if(isFullScreen(r))exitFullScreen(r);else t=this.source_?"string"==typeof this.source_?r.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_?requestFullScreenWithKeys(t):requestFullScreen(t)}}},{key:"handleFullScreenChange_",value:function(){var e=this.getMap();if(e){var t=this.isInFullscreen_;this.isInFullscreen_=isFullScreen(e.getOwnerDocument()),t!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?((0,_dom.replaceNode)(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(FullScreenEventType.ENTERFULLSCREEN)):((0,_dom.replaceNode)(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(FullScreenEventType.LEAVEFULLSCREEN)),e.updateSize())}}},{key:"setClassName_",value:function(e,t){var r,n,l,o;t?((r=e.classList).remove.apply(r,_toConsumableArray(this.inactiveClassName_)),(n=e.classList).add.apply(n,_toConsumableArray(this.activeClassName_))):((l=e.classList).remove.apply(l,_toConsumableArray(this.activeClassName_)),(o=e.classList).add.apply(o,_toConsumableArray(this.inactiveClassName_)))}},{key:"setMap",value:function(e){var r=this.getMap();r&&r.removeChangeListener(_MapProperty.default.TARGET,this.boundHandleMapTargetChange_),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),this.handleMapTargetChange_(),e&&e.addChangeListener(_MapProperty.default.TARGET,this.boundHandleMapTargetChange_)}},{key:"handleMapTargetChange_",value:function(){for(var e=this.documentListeners_,t=0,r=e.length;t<r;++t)(0,_events.unlistenByKey)(e[t]);e.length=0;var n=this.getMap();if(n){var l=n.getOwnerDocument();isFullScreenSupported(l)?this.element.classList.remove(_css.CLASS_UNSUPPORTED):this.element.classList.add(_css.CLASS_UNSUPPORTED);for(var o=0,s=events.length;o<s;++o)e.push((0,_events.listen)(l,events[o],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}])}();function isFullScreenSupported(e){var t=e.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&e.fullscreenEnabled)}function isFullScreen(e){return!(!e.webkitIsFullScreen&&!e.fullscreenElement)}function requestFullScreen(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function requestFullScreenWithKeys(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():requestFullScreen(e)}function exitFullScreen(e){e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()}var _default=exports.default=FullScreen;

},{"../MapProperty.js":95,"../css.js":129,"../dom.js":130,"../events.js":132,"../events/EventType.js":134,"./Control.js":118}],120:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../pointer/EventType.js")),_proj=require("../proj.js"),_events=require("../events.js"),_coordinate=require("../coordinate.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var PROJECTION="projection",COORDINATE_FORMAT="coordinateFormat",MousePosition=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var o=document.createElement("div");return o.className=void 0!==e.className?e.className:"ol-mouse-position",(r=_callSuper(this,t,[{element:o,render:e.render,target:e.target}])).on,r.once,r.un,r.addChangeListener(PROJECTION,r.handleProjectionChanged_),e.coordinateFormat&&r.setCoordinateFormat(e.coordinateFormat),e.projection&&r.setProjection(e.projection),r.renderOnMouseOut_=void 0!==e.placeholder,r.placeholder_=r.renderOnMouseOut_?e.placeholder:"&#160;",r.renderedHTML_=o.innerHTML,r.mapProjection_=null,r.transform_=null,r.wrapX_=!1!==e.wrapX,r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleProjectionChanged_",value:function(){this.transform_=null}},{key:"getCoordinateFormat",value:function(){return this.get(COORDINATE_FORMAT)}},{key:"getProjection",value:function(){return this.get(PROJECTION)}},{key:"handleMouseMove",value:function(e){var t=this.getMap();this.updateHTML_(t.getEventPixel(e))}},{key:"handleMouseOut",value:function(e){this.updateHTML_(null)}},{key:"setMap",value:function(e){if(_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),e){var r=e.getViewport();this.listenerKeys.push((0,_events.listen)(r,_EventType.default.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,_events.listen)(r,_EventType.default.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}},{key:"setCoordinateFormat",value:function(e){this.set(COORDINATE_FORMAT,e)}},{key:"setProjection",value:function(e){this.set(PROJECTION,(0,_proj.get)(e))}},{key:"updateHTML_",value:function(e){var t=this.placeholder_;if(e&&this.mapProjection_){if(!this.transform_){var r=this.getProjection();this.transform_=r?(0,_proj.getTransformFromProjections)(this.mapProjection_,r):_proj.identityTransform}var o=this.getMap().getCoordinateFromPixelInternal(e);if(o){var n=(0,_proj.getUserProjection)();if(n&&(this.transform_=(0,_proj.getTransformFromProjections)(this.mapProjection_,n)),this.transform_(o,o),this.wrapX_){var i=n||this.getProjection()||this.mapProjection_;(0,_coordinate.wrapX)(o,i)}var a=this.getCoordinateFormat();t=a?a(o):o.toString()}}this.renderedHTML_&&t===this.renderedHTML_||(this.element.innerHTML=t,this.renderedHTML_=t)}},{key:"render",value:function(e){var t=e.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null}}])}(),_default=exports.default=MousePosition;

},{"../coordinate.js":128,"../events.js":132,"../pointer/EventType.js":282,"../proj.js":283,"./Control.js":118}],121:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Map=_interopRequireDefault(require("../Map.js")),_MapEventType=_interopRequireDefault(require("../MapEventType.js")),_MapProperty=_interopRequireDefault(require("../MapProperty.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_Overlay=_interopRequireDefault(require("../Overlay.js")),_View=_interopRequireDefault(require("../View.js")),_ViewProperty=_interopRequireDefault(require("../ViewProperty.js")),_css=require("../css.js"),_extent=require("../extent.js"),_events=require("../events.js"),_Polygon=require("../geom/Polygon.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var MAX_RATIO=.75,MIN_RATIO=.1,OverviewMap=function(e){function t(e){var i;_classCallCheck(this,t),e=e||{},(i=_callSuper(this,t,[{element:document.createElement("div"),render:e.render,target:e.target}])).boundHandleRotationChanged_=i.handleRotationChanged_.bind(i),i.collapsed_=void 0===e.collapsed||e.collapsed,i.collapsible_=void 0===e.collapsible||e.collapsible,i.collapsible_||(i.collapsed_=!1),i.rotateWithView_=void 0!==e.rotateWithView&&e.rotateWithView,i.viewExtent_=void 0;var o=void 0!==e.className?e.className:"ol-overviewmap",n=void 0!==e.tipLabel?e.tipLabel:"Overview map",r=void 0!==e.collapseLabel?e.collapseLabel:"â¹";"string"==typeof r?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=r):i.collapseLabel_=r;var a=void 0!==e.label?e.label:"âº";"string"==typeof a?(i.label_=document.createElement("span"),i.label_.textContent=a):i.label_=a;var l=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,s=document.createElement("button");s.setAttribute("type","button"),s.title=n,s.appendChild(l),s.addEventListener(_EventType.default.CLICK,i.handleClick_.bind(i),!1),i.ovmapDiv_=document.createElement("div"),i.ovmapDiv_.className="ol-overviewmap-map",i.view_=e.view;var u=new _Map.default({view:e.view,controls:new _Collection.default,interactions:new _Collection.default});i.ovmap_=u,e.layers&&e.layers.forEach(function(e){u.addLayer(e)});var p=document.createElement("div");p.className="ol-overviewmap-box",p.style.boxSizing="border-box",i.boxOverlay_=new _Overlay.default({position:[0,0],positioning:"center-center",element:p}),i.ovmap_.addOverlay(i.boxOverlay_);var _=o+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL+(i.collapsed_&&i.collapsible_?" "+_css.CLASS_COLLAPSED:"")+(i.collapsible_?"":" ol-uncollapsible"),c=i.element;c.className=_,c.appendChild(i.ovmapDiv_),c.appendChild(s);var d=i,v=i.boxOverlay_,f=i.boxOverlay_.getElement(),h=function(e){var t,i={clientX:(t=e).clientX,clientY:t.clientY},o=u.getEventCoordinateInternal(i);v.setPosition(o)},y=function e(t){var i=u.getEventCoordinateInternal(t);d.getMap().getView().setCenterInternal(i),window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",e)};return f.addEventListener("mousedown",function(){window.addEventListener("mousemove",h),window.addEventListener("mouseup",y)}),i}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"setMap",value:function(e){var i=this.getMap();if(e!==i){if(i){var o=i.getView();o&&this.unbindView_(o),this.ovmap_.setTarget(null)}if(_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.handleMapPropertyChange_,this));var n=e.getView();n&&(this.bindView_(n),n.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}},{key:"handleMapPropertyChange_",value:function(e){if(e.key===_MapProperty.default.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var i=this.getMap().getView();this.bindView_(i)}else this.ovmap_.isRendered()||e.key!==_MapProperty.default.TARGET&&e.key!==_MapProperty.default.SIZE||this.ovmap_.updateSize()}},{key:"bindView_",value:function(e){if(!this.view_){var t=new _View.default({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(_ViewProperty.default.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}},{key:"unbindView_",value:function(e){e.removeChangeListener(_ViewProperty.default.ROTATION,this.boundHandleRotationChanged_)}},{key:"handleRotationChanged_",value:function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}},{key:"validateExtent_",value:function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var i=e.getSize(),o=e.getView().calculateExtentInternal(i);if(!this.viewExtent_||!(0,_extent.equals)(o,this.viewExtent_)){this.viewExtent_=o;var n=t.getSize(),r=t.getView().calculateExtentInternal(n),a=t.getPixelFromCoordinateInternal((0,_extent.getTopLeft)(o)),l=t.getPixelFromCoordinateInternal((0,_extent.getBottomRight)(o)),s=Math.abs(a[0]-l[0]),u=Math.abs(a[1]-l[1]),p=n[0],_=n[1];s<p*MIN_RATIO||u<_*MIN_RATIO||s>p*MAX_RATIO||u>_*MAX_RATIO?this.resetExtent_():(0,_extent.containsExtent)(r,o)||this.recenter_()}}}},{key:"resetExtent_",value:function(){if(0!==MAX_RATIO&&0!==MIN_RATIO){var e=this.getMap(),t=this.ovmap_,i=e.getSize(),o=e.getView().calculateExtentInternal(i),n=t.getView(),r=Math.log(MAX_RATIO/MIN_RATIO)/Math.LN2,a=1/(Math.pow(2,r/2)*MIN_RATIO);(0,_extent.scaleFromCenter)(o,a),n.fitInternal((0,_Polygon.fromExtent)(o))}}},{key:"recenter_",value:function(){var e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenterInternal(i.getCenterInternal())}},{key:"updateBox_",value:function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var i=e.getSize(),o=e.getView(),n=t.getView(),r=this.rotateWithView_?0:-o.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),s=o.getCenterInternal(),u=o.getResolution(),p=n.getResolution(),_=i[0]*u/p,c=i[1]*u/p;if(a.setPosition(s),l){l.style.width=_+"px",l.style.height=c+"px";var d="rotate("+r+"rad)";l.style.transform=d}}}},{key:"updateBoxAfterOvmapIsRendered_",value:function(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=(0,_events.listenOnce)(this.ovmap_,_MapEventType.default.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}},{key:"handleClick_",value:function(e){e.preventDefault(),this.handleToggle_()}},{key:"handleToggle_",value:function(){this.element.classList.toggle(_css.CLASS_COLLAPSED),this.collapsed_?(0,_dom.replaceNode)(this.collapseLabel_,this.label_):(0,_dom.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;if(!this.collapsed_){if(e.isRendered())return this.viewExtent_=void 0,void e.render();e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"setRotateWithView",value:function(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}},{key:"getOverviewMap",value:function(){return this.ovmap_}},{key:"render",value:function(e){this.validateExtent_(),this.updateBox_()}}])}(),_default=exports.default=OverviewMap;

},{"../Collection.js":78,"../Map.js":89,"../MapEventType.js":94,"../MapProperty.js":95,"../ObjectEventType.js":97,"../Overlay.js":99,"../View.js":107,"../ViewProperty.js":109,"../css.js":129,"../dom.js":130,"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"../geom/Polygon.js":211,"./Control.js":118}],122:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_easing=require("../easing.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Rotate=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},r=_callSuper(this,t,[{element:document.createElement("div"),render:e.render,target:e.target}]);var o=void 0!==e.className?e.className:"ol-rotate",n=void 0!==e.label?e.label:"â§",i=void 0!==e.compassClassName?e.compassClassName:"ol-compass";r.label_=null,"string"==typeof n?(r.label_=document.createElement("span"),r.label_.className=i,r.label_.textContent=n):(r.label_=n,r.label_.classList.add(i));var a=e.tipLabel?e.tipLabel:"Reset rotation",s=document.createElement("button");s.className=o+"-reset",s.setAttribute("type","button"),s.title=a,s.appendChild(r.label_),s.addEventListener(_EventType.default.CLICK,r.handleClick_.bind(r),!1);var l=o+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL,u=r.element;return u.className=l,u.appendChild(s),r.callResetNorth_=e.resetNorth?e.resetNorth:void 0,r.duration_=void 0!==e.duration?e.duration:250,r.autoHide_=void 0===e.autoHide||e.autoHide,r.rotation_=void 0,r.autoHide_&&r.element.classList.add(_css.CLASS_HIDDEN),r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleClick_",value:function(e){e.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var e=this.getMap().getView();if(e){var t=e.getRotation();void 0!==t&&(this.duration_>0&&t%(2*Math.PI)!=0?e.animate({rotation:0,duration:this.duration_,easing:_easing.easeOut}):e.setRotation(0))}}},{key:"render",value:function(e){var t=e.frameState;if(t){var r=t.viewState.rotation;if(r!=this.rotation_){var o="rotate("+r+"rad)";if(this.autoHide_){var n=this.element.classList.contains(_css.CLASS_HIDDEN);n||0!==r?n&&0!==r&&this.element.classList.remove(_css.CLASS_HIDDEN):this.element.classList.add(_css.CLASS_HIDDEN)}this.label_.style.transform=o}this.rotation_=r}}}])}(),_default=exports.default=Rotate;

},{"../css.js":129,"../easing.js":131,"../events/EventType.js":134,"./Control.js":118}],123:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_css=require("../css.js"),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var UNITS_PROP="units",LEADING_DIGITS=[1,2,5],DEFAULT_DPI=25.4/.28,ScaleLine=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var i=document.createElement("div");i.style.pointerEvents="none",(r=_callSuper(this,t,[{element:i,render:e.render,target:e.target}])).on,r.once,r.un;var n=void 0!==e.className?e.className:e.bar?"ol-scale-bar":"ol-scale-line";return r.innerElement_=document.createElement("div"),r.innerElement_.className=n+"-inner",r.element.className=n+" "+_css.CLASS_UNSELECTABLE,r.element.appendChild(r.innerElement_),r.viewState_=null,r.minWidth_=void 0!==e.minWidth?e.minWidth:64,r.maxWidth_=e.maxWidth,r.renderedVisible_=!1,r.renderedWidth_=void 0,r.renderedHTML_="",r.addChangeListener(UNITS_PROP,r.handleUnitsChanged_),r.setUnits(e.units||"metric"),r.scaleBar_=e.bar||!1,r.scaleBarSteps_=e.steps||4,r.scaleBarText_=e.text||!1,r.dpi_=e.dpi||void 0,r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"getUnits",value:function(){return this.get(UNITS_PROP)}},{key:"handleUnitsChanged_",value:function(){this.updateElement_()}},{key:"setUnits",value:function(e){this.set(UNITS_PROP,e)}},{key:"setDpi",value:function(e){this.dpi_=e}},{key:"updateElement_",value:function(){var e=this.viewState_;if(e){var t=e.center,r=e.projection,i=this.getUnits(),n="degrees"==i?"degrees":"m",o=(0,_proj.getPointResolution)(r,e.resolution,t,n),s=this.minWidth_*(this.dpi_||DEFAULT_DPI)/DEFAULT_DPI,a=void 0!==this.maxWidth_?this.maxWidth_*(this.dpi_||DEFAULT_DPI)/DEFAULT_DPI:void 0,l=s*o,c="";if("degrees"==i){var u=_proj.METERS_PER_UNIT.degrees;(l*=u)<u/60?(c="â³",o*=3600):l<u?(c="â²",o*=60):c="Â°"}else if("imperial"==i)l<.9144?(c="in",o/=.0254):l<1609.344?(c="ft",o/=.3048):(c="mi",o/=1609.344);else if("nautical"==i)o/=1852,c="NM";else if("metric"==i)l<1e-6?(c="nm",o*=1e9):l<.001?(c="Î¼m",o*=1e6):l<1?(c="mm",o*=1e3):l<1e3?c="m":(c="km",o/=1e3);else{if("us"!=i)throw new Error("Invalid units");l<.9144?(c="in",o*=39.37):l<1609.344?(c="ft",o/=.30480061):(c="mi",o/=1609.3472)}for(var d,_,f,p,h,v,y=3*Math.floor(Math.log(s*o)/Math.log(10));;){f=Math.floor(y/3);var m=Math.pow(10,f);if(d=LEADING_DIGITS[(y%3+3)%3]*m,_=Math.round(d/o),isNaN(_))return this.element.style.display="none",void(this.renderedVisible_=!1);if(void 0!==a&&_>=a){d=p,_=h,f=v;break}if(_>=s)break;p=d,h=_,v=f,++y}var b=this.scaleBar_?this.createScaleBar(_,d,c):d.toFixed(f<0?-f:0)+" "+c;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=_&&(this.innerElement_.style.width=_+"px",this.renderedWidth_=_),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"createScaleBar",value:function(e,t,r){for(var i=this.getScaleForResolution(),n=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),o=this.scaleBarSteps_,s=e/o,a=[this.createMarker("absolute")],l=0;l<o;++l){var c=l%2==0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";a.push("<div><div "+'class="ol-scale-singlebar '.concat(c,'" ')+'style="width: '.concat(s,'px;"')+"></div>"+this.createMarker("relative")+(l%2==0||2===o?this.createStepText(l,e,!1,t,r):"")+"</div>")}return a.push(this.createStepText(o,e,!0,t,r)),(this.scaleBarText_?'<div class="ol-scale-text" style="width: '.concat(e,'px;">')+n+"</div>":"")+a.join("")}},{key:"createMarker",value:function(e){var t="absolute"===e?3:-10;return'<div class="ol-scale-step-marker" '+'style="position: '.concat(e,"; top: ").concat(t,'px;"')+"></div>"}},{key:"createStepText",value:function(e,t,r,i,n){var o=(0===e?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(0===e?"":" "+n),s=0===e?-3:t/this.scaleBarSteps_*-1,a=0===e?0:t/this.scaleBarSteps_*2;return'<div class="ol-scale-step-text" style="'+"margin-left: ".concat(s,"px;")+"text-align: ".concat(0===e?"left":"center",";")+"min-width: ".concat(a,"px;")+"left: ".concat(r?t+"px":"unset",";")+'">'+o+"</div>"}},{key:"getScaleForResolution",value:function(){return(0,_proj.getPointResolution)(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m")*(1e3/25.4)*(this.dpi_||DEFAULT_DPI)}},{key:"render",value:function(e){var t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}}])}(),_default=exports.default=ScaleLine;

},{"../css.js":129,"../proj.js":283,"./Control.js":118}],124:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_easing=require("../easing.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,o){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,o||[],_getPrototypeOf(e).constructor):t.apply(e,o))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Zoom=function(e){function t(e){var o;_classCallCheck(this,t),e=e||{},o=_callSuper(this,t,[{element:document.createElement("div"),target:e.target}]);var r=void 0!==e.className?e.className:"ol-zoom",n=void 0!==e.delta?e.delta:1,i=void 0!==e.zoomInClassName?e.zoomInClassName:r+"-in",a=void 0!==e.zoomOutClassName?e.zoomOutClassName:r+"-out",u=void 0!==e.zoomInLabel?e.zoomInLabel:"+",l=void 0!==e.zoomOutLabel?e.zoomOutLabel:"â",s=void 0!==e.zoomInTipLabel?e.zoomInTipLabel:"Zoom in",c=void 0!==e.zoomOutTipLabel?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=i,f.setAttribute("type","button"),f.title=s,f.appendChild("string"==typeof u?document.createTextNode(u):u),f.addEventListener(_EventType.default.CLICK,o.handleClick_.bind(o,n),!1);var p=document.createElement("button");p.className=a,p.setAttribute("type","button"),p.title=c,p.appendChild("string"==typeof l?document.createTextNode(l):l),p.addEventListener(_EventType.default.CLICK,o.handleClick_.bind(o,-n),!1);var d=r+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL,_=o.element;return _.className=d,_.appendChild(f),_.appendChild(p),o.duration_=void 0!==e.duration?e.duration:250,o}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleClick_",value:function(e,t){t.preventDefault(),this.zoomByDelta_(e)}},{key:"zoomByDelta_",value:function(e){var t=this.getMap().getView();if(t){var o=t.getZoom();if(void 0!==o){var r=t.getConstrainedZoom(o+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:r,duration:this.duration_,easing:_easing.easeOut})):t.setZoom(r)}}}}])}(),_default=exports.default=Zoom;

},{"../css.js":129,"../easing.js":131,"../events/EventType.js":134,"./Control.js":118}],125:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_EventType2=_interopRequireDefault(require("../pointer/EventType.js")),_css=require("../css.js"),_math=require("../math.js"),_easing=require("../easing.js"),_events=require("../events.js"),_Event=require("../events/Event.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=_superPropBase(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Direction={VERTICAL:0,HORIZONTAL:1},ZoomSlider=function(t){function e(t){var i;_classCallCheck(this,e),(i=_callSuper(this,e,[{target:(t=t||{}).target,element:document.createElement("div"),render:t.render}])).dragListenerKeys_=[],i.currentResolution_=void 0,i.direction_=Direction.VERTICAL,i.dragging_,i.heightLimit_=0,i.widthLimit_=0,i.startX_,i.startY_,i.thumbSize_=null,i.sliderInitialized_=!1,i.duration_=void 0!==t.duration?t.duration:200;var r=void 0!==t.className?t.className:"ol-zoomslider",n=document.createElement("button");n.setAttribute("type","button"),n.className=r+"-thumb "+_css.CLASS_UNSELECTABLE;var o=i.element;return o.className=r+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL,o.appendChild(n),o.addEventListener(_EventType2.default.POINTERDOWN,i.handleDraggerStart_.bind(i),!1),o.addEventListener(_EventType2.default.POINTERMOVE,i.handleDraggerDrag_.bind(i),!1),o.addEventListener(_EventType2.default.POINTERUP,i.handleDraggerEnd_.bind(i),!1),o.addEventListener(_EventType.default.CLICK,i.handleContainerClick_.bind(i),!1),n.addEventListener(_EventType.default.CLICK,_Event.stopPropagation,!1),i}return _inherits(e,_Control2["default"]),_createClass(e,[{key:"setMap",value:function(t){_get(_getPrototypeOf(e.prototype),"setMap",this).call(this,t),t&&t.render()}},{key:"initSlider_",value:function(){var t=this.element,e=t.offsetWidth,i=t.offsetHeight;if(0===e&&0===i)return this.sliderInitialized_=!1;var r=getComputedStyle(t);e-=parseFloat(r.paddingRight)+parseFloat(r.paddingLeft),i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom);var n=t.firstElementChild,o=getComputedStyle(n),s=n.offsetWidth+parseFloat(o.marginRight)+parseFloat(o.marginLeft),a=n.offsetHeight+parseFloat(o.marginTop)+parseFloat(o.marginBottom);return this.thumbSize_=[s,a],e>i?(this.direction_=Direction.HORIZONTAL,this.widthLimit_=e-s):(this.direction_=Direction.VERTICAL,this.heightLimit_=i-a),this.sliderInitialized_=!0}},{key:"handleContainerClick_",value:function(t){var e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i),n=e.getConstrainedZoom(e.getZoomForResolution(r));e.animateInternal({zoom:n,duration:this.duration_,easing:_easing.easeOut})}},{key:"handleDraggerStart_",value:function(t){if(!this.dragging_&&t.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var i=this.handleDraggerDrag_,r=this.handleDraggerEnd_,n=this.getMap().getOwnerDocument();this.dragListenerKeys_.push((0,_events.listen)(n,_EventType2.default.POINTERMOVE,i,this),(0,_events.listen)(n,_EventType2.default.POINTERUP,r,this))}}}},{key:"handleDraggerDrag_",value:function(t){if(this.dragging_){var e=t.clientX-this.startX_,i=t.clientY-this.startY_,r=this.getRelativePosition_(e,i);this.currentResolution_=this.getResolutionForPosition_(r),this.getMap().getView().setResolution(this.currentResolution_)}}},{key:"handleDraggerEnd_",value:function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(_events.unlistenByKey),this.dragListenerKeys_.length=0)}},{key:"setThumbPosition_",value:function(t){var e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==Direction.HORIZONTAL?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"}},{key:"getRelativePosition_",value:function(t,e){var i;return i=this.direction_===Direction.HORIZONTAL?t/this.widthLimit_:e/this.heightLimit_,(0,_math.clamp)(i,0,1)}},{key:"getResolutionForPosition_",value:function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)}},{key:"getPositionForResolution_",value:function(t){var e=this.getMap().getView().getValueForResolutionFunction();return(0,_math.clamp)(1-e(t),0,1)}},{key:"render",value:function(t){if(t.frameState&&(this.sliderInitialized_||this.initSlider_())){var e=t.frameState.viewState.resolution;this.currentResolution_=e,this.setThumbPosition_(e)}}}])}(),_default=exports.default=ZoomSlider;

},{"../css.js":129,"../easing.js":131,"../events.js":132,"../events/Event.js":133,"../events/EventType.js":134,"../math.js":279,"../pointer/EventType.js":282,"./Control.js":118}],126:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_proj=require("../proj.js"),_Polygon=require("../geom/Polygon.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,o){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,o||[],_getPrototypeOf(e).constructor):t.apply(e,o))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ZoomToExtent=function(e){function t(e){var o;_classCallCheck(this,t),e=e||{},(o=_callSuper(this,t,[{element:document.createElement("div"),target:e.target}])).extent=e.extent?e.extent:null;var r=void 0!==e.className?e.className:"ol-zoom-extent",n=void 0!==e.label?e.label:"E",i=void 0!==e.tipLabel?e.tipLabel:"Fit to extent",u=document.createElement("button");u.setAttribute("type","button"),u.title=i,u.appendChild("string"==typeof n?document.createTextNode(n):n),u.addEventListener(_EventType.default.CLICK,o.handleClick_.bind(o),!1);var l=r+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL,c=o.element;return c.className=l,c.appendChild(u),o}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleClick_",value:function(e){e.preventDefault(),this.handleZoomToExtent()}},{key:"handleZoomToExtent",value:function(){var e=this.getMap().getView(),t=this.extent?(0,_proj.fromUserExtent)(this.extent,e.getProjection()):e.getProjection().getExtent();e.fitInternal((0,_Polygon.fromExtent)(t))}}])}(),_default=exports.default=ZoomToExtent;

},{"../css.js":129,"../events/EventType.js":134,"../geom/Polygon.js":211,"../proj.js":283,"./Control.js":118}],127:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=defaults;var _Attribution=_interopRequireDefault(require("./Attribution.js")),_Collection=_interopRequireDefault(require("../Collection.js")),_Rotate=_interopRequireDefault(require("./Rotate.js")),_Zoom=_interopRequireDefault(require("./Zoom.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function defaults(t){t=t||{};var e=new _Collection.default;return(void 0===t.zoom||t.zoom)&&e.push(new _Zoom.default(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new _Rotate.default(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new _Attribution.default(t.attributionOptions)),e}

},{"../Collection.js":78,"./Attribution.js":117,"./Rotate.js":122,"./Zoom.js":124}],128:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=add,exports.closestOnCircle=closestOnCircle,exports.closestOnSegment=closestOnSegment,exports.createStringXY=createStringXY,exports.degreesToStringHDMS=degreesToStringHDMS,exports.distance=distance,exports.equals=equals,exports.format=format,exports.getWorldsAway=getWorldsAway,exports.rotate=rotate,exports.scale=scale,exports.squaredDistance=squaredDistance,exports.squaredDistanceToSegment=squaredDistanceToSegment,exports.toStringHDMS=toStringHDMS,exports.toStringXY=toStringXY,exports.wrapX=wrapX;var _extent=require("./extent.js"),_math=require("./math.js"),_string=require("./string.js");function add(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function closestOnCircle(t,e){var r=e.getRadius(),n=e.getCenter(),o=n[0],a=n[1],s=t[0]-o,i=t[1]-a;0===s&&0===i&&(s=1);var u=Math.sqrt(s*s+i*i);return[o+r*s/u,a+r*i/u]}function closestOnSegment(t,e){var r,n,o=t[0],a=t[1],s=e[0],i=e[1],u=s[0],c=s[1],g=i[0],d=i[1],S=g-u,l=d-c,f=0===S&&0===l?0:(S*(o-u)+l*(a-c))/(S*S+l*l||0);return f<=0?(r=u,n=c):f>=1?(r=g,n=d):(r=u+f*S,n=c+f*l),[r,n]}function createStringXY(t){return function(e){return toStringXY(e,t)}}function degreesToStringHDMS(t,e,r){var n=(0,_math.modulo)(e+180,360)-180,o=Math.abs(3600*n),a=r||0,s=Math.floor(o/3600),i=Math.floor((o-3600*s)/60),u=(0,_math.toFixed)(o-3600*s-60*i,a);u>=60&&(u=0,i+=1),i>=60&&(i=0,s+=1);var c=s+"Â°";return 0===i&&0===u||(c+=" "+(0,_string.padNumber)(i,2)+"â²"),0!==u&&(c+=" "+(0,_string.padNumber)(u,2,a)+"â³"),0!==n&&(c+=" "+t.charAt(n<0?1:0)),c}function format(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function equals(t,e){for(var r=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function rotate(t,e){var r=Math.cos(e),n=Math.sin(e),o=t[0]*r-t[1]*n,a=t[1]*r+t[0]*n;return t[0]=o,t[1]=a,t}function scale(t,e){return t[0]*=e,t[1]*=e,t}function squaredDistance(t,e){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function distance(t,e){return Math.sqrt(squaredDistance(t,e))}function squaredDistanceToSegment(t,e){return squaredDistance(t,closestOnSegment(t,e))}function toStringHDMS(t,e){return t?degreesToStringHDMS("NS",t[1],e)+" "+degreesToStringHDMS("EW",t[0],e):""}function toStringXY(t,e){return format(t,"{x}, {y}",e)}function wrapX(t,e){if(e.canWrapX()){var r=(0,_extent.getWidth)(e.getExtent()),n=getWorldsAway(t,e,r);n&&(t[0]-=n*r)}return t}function getWorldsAway(t,e,r){var n=e.getExtent(),o=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(r=r||(0,_extent.getWidth)(n),o=Math.floor((t[0]-n[0])/r)),o}

},{"./extent.js":142,"./math.js":279,"./string.js":380}],129:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFontParameters=exports.CLASS_UNSUPPORTED=exports.CLASS_UNSELECTABLE=exports.CLASS_SELECTABLE=exports.CLASS_HIDDEN=exports.CLASS_CONTROL=exports.CLASS_COLLAPSED=void 0;var CLASS_HIDDEN=exports.CLASS_HIDDEN="ol-hidden",CLASS_SELECTABLE=exports.CLASS_SELECTABLE="ol-selectable",CLASS_UNSELECTABLE=exports.CLASS_UNSELECTABLE="ol-unselectable",CLASS_UNSUPPORTED=exports.CLASS_UNSUPPORTED="ol-unsupported",CLASS_CONTROL=exports.CLASS_CONTROL="ol-control",CLASS_COLLAPSED=exports.CLASS_COLLAPSED="ol-collapsed",fontRegEx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),fontRegExMatchIndex=["style","variant","weight","size","lineHeight","family"],getFontParameters=exports.getFontParameters=function(e){var t=e.match(fontRegEx);if(!t)return null;for(var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},o=0,S=fontRegExMatchIndex.length;o<S;++o){var s=t[o+1];void 0!==s&&(r[fontRegExMatchIndex[o]]=s)}return r.families=r.family.split(/,\s?/),r};

},{}],130:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCanvasContext2D=createCanvasContext2D,exports.getSharedCanvasContext2D=getSharedCanvasContext2D,exports.outerHeight=outerHeight,exports.outerWidth=outerWidth,exports.releaseCanvas=releaseCanvas,exports.removeChildren=removeChildren,exports.removeNode=removeNode,exports.replaceChildren=replaceChildren,exports.replaceNode=replaceNode;var sharedCanvasContext,_has=require("./has.js");function createCanvasContext2D(e,t,r,a){var n;return n=r&&r.length?r.shift():_has.WORKER_OFFSCREEN_CANVAS?new OffscreenCanvas(e||300,t||300):document.createElement("canvas"),e&&(n.width=e),t&&(n.height=t),n.getContext("2d",a)}function getSharedCanvasContext2D(){return sharedCanvasContext||(sharedCanvasContext=createCanvasContext2D(1,1)),sharedCanvasContext}function releaseCanvas(e){var t=e.canvas;t.width=1,t.height=1,e.clearRect(0,0,1,1)}function outerWidth(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)}function outerHeight(e){var t=e.offsetHeight,r=getComputedStyle(e);return t+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function replaceNode(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)}function removeNode(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function replaceChildren(e,t){for(var r=e.childNodes,a=0;;++a){var n=r[a],o=t[a];if(!n&&!o)break;n!==o&&(n?o?e.insertBefore(o,n):(e.removeChild(n),--a):e.appendChild(o))}}

},{"./has.js":233}],131:[function(require,module,exports){
"use strict";function easeIn(n){return Math.pow(n,3)}function easeOut(n){return 1-easeIn(1-n)}function inAndOut(n){return 3*n*n-2*n*n*n}function linear(n){return n}function upAndDown(n){return n<.5?inAndOut(2*n):1-inAndOut(2*(n-.5))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.easeIn=easeIn,exports.easeOut=easeOut,exports.inAndOut=inAndOut,exports.linear=linear,exports.upAndDown=upAndDown;

},{}],132:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.listen=listen,exports.listenOnce=listenOnce,exports.unlistenByKey=unlistenByKey;var _obj=require("./obj.js");function listen(e,t,n,r,i){if(r&&r!==e&&(n=n.bind(r)),i){var s=n;n=function(){e.removeEventListener(t,n),s.apply(this,arguments)}}var l={target:e,type:t,listener:n};return e.addEventListener(t,n),l}function listenOnce(e,t,n,r){return listen(e,t,n,r,!0)}function unlistenByKey(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),(0,_obj.clear)(e))}

},{"./obj.js":281}],133:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.preventDefault=preventDefault,exports.stopPropagation=stopPropagation;var BaseEvent=function(){return _createClass(function t(e){_classCallCheck(this,t),this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null},[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])}();function stopPropagation(t){t.stopPropagation()}function preventDefault(t){t.preventDefault()}var _default=exports.default=BaseEvent;

},{}],134:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};

},{}],135:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};

},{}],136:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SnapEventType=exports.SnapEvent=void 0;var _Event2=_interopRequireDefault(require("./Event.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var SnapEventType=exports.SnapEventType={SNAP:"snap"},SnapEvent=exports.SnapEvent=function(e){function t(e,r){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).vertex=r.vertex,o.vertexPixel=r.vertexPixel,o.feature=r.feature,o.segment=r.segment,o}return _inherits(t,_Event2["default"]),_createClass(t)}();

},{"./Event.js":133}],137:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_Event=_interopRequireDefault(require("./Event.js")),_functions=require("../functions.js"),_obj=require("../obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Target=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).eventTarget_=e,r.pendingRemovals_=null,r.dispatching_=null,r.listeners_=null,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"addEventListener",value:function(e,t){if(e&&t){var r=this.listeners_||(this.listeners_={}),n=r[e]||(r[e]=[]);n.includes(t)||n.push(t)}}},{key:"dispatchEvent",value:function(e){var t="string"==typeof e,r=t?e:e.type,n=this.listeners_&&this.listeners_[r];if(n){var i=t?new _Event.default(e):e;i.target||(i.target=this.eventTarget_||this);var o,s=this.dispatching_||(this.dispatching_={}),u=this.pendingRemovals_||(this.pendingRemovals_={});r in s||(s[r]=0,u[r]=0),++s[r];for(var l=0,a=n.length;l<a;++l)if(!1===(o="handleEvent"in n[l]?n[l].handleEvent(i):n[l].call(this,i))||i.propagationStopped){o=!1;break}if(0==--s[r]){var f=u[r];for(delete u[r];f--;)this.removeEventListener(r,_functions.VOID);delete s[r]}return o}}},{key:"disposeInternal",value:function(){this.listeners_&&(0,_obj.clear)(this.listeners_)}},{key:"getListeners",value:function(e){return this.listeners_&&this.listeners_[e]||void 0}},{key:"hasListener",value:function(e){return!!this.listeners_&&(e?e in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(e,t){if(this.listeners_){var r=this.listeners_[e];if(r){var n=r.indexOf(t);-1!==n&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[n]=_functions.VOID,++this.pendingRemovals_[e]):(r.splice(n,1),0===r.length&&delete this.listeners_[e]))}}}}])}(),_default=exports.default=Target;

},{"../Disposable.js":81,"../functions.js":200,"../obj.js":281,"./Event.js":133}],138:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=all,exports.touchOnly=exports.targetNotEditable=exports.singleClick=exports.shiftKeyOnly=exports.primaryAction=exports.pointerMove=exports.platformModifierKeyOnly=exports.platformModifierKey=exports.penOnly=exports.noModifierKeys=exports.never=exports.mouseOnly=exports.mouseActionButton=exports.focusWithTabindex=exports.focus=exports.doubleClick=exports.click=exports.always=exports.altShiftKeysOnly=exports.altKeyOnly=void 0;var _MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js")),_functions=require("../functions.js"),_has=require("../has.js"),_asserts=require("../asserts.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function all(e){var t=arguments;return function(e){for(var r=!0,n=0,o=t.length;n<o&&(r=r&&t[n](e));++n);return r}}var altKeyOnly=exports.altKeyOnly=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},altShiftKeysOnly=exports.altShiftKeysOnly=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},focus=exports.focus=function(e){var t=e.map.getTargetElement(),r=e.map.getOwnerDocument().activeElement;return t.contains(r)},focusWithTabindex=exports.focusWithTabindex=function(e){return!e.map.getTargetElement().hasAttribute("tabindex")||focus(e)},always=exports.always=_functions.TRUE,click=exports.click=function(e){return e.type==_MapBrowserEventType.default.CLICK},mouseActionButton=exports.mouseActionButton=function(e){var t=e.originalEvent;return 0==t.button&&!(_has.WEBKIT&&_has.MAC&&t.ctrlKey)},never=exports.never=_functions.FALSE,pointerMove=exports.pointerMove=function(e){return"pointermove"==e.type},singleClick=exports.singleClick=function(e){return e.type==_MapBrowserEventType.default.SINGLECLICK},doubleClick=exports.doubleClick=function(e){return e.type==_MapBrowserEventType.default.DBLCLICK},noModifierKeys=exports.noModifierKeys=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},platformModifierKeyOnly=exports.platformModifierKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&(_has.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},platformModifierKey=exports.platformModifierKey=function(e){var t=e.originalEvent;return _has.MAC?t.metaKey:t.ctrlKey},shiftKeyOnly=exports.shiftKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},targetNotEditable=exports.targetNotEditable=function(e){var t=e.originalEvent,r=t.target.tagName;return"INPUT"!==r&&"SELECT"!==r&&"TEXTAREA"!==r&&!t.target.isContentEditable},mouseOnly=exports.mouseOnly=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"mouse"==t.pointerType},touchOnly=exports.touchOnly=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"touch"===t.pointerType},penOnly=exports.penOnly=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"pen"===t.pointerType},primaryAction=exports.primaryAction=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&0===t.button};

},{"../MapBrowserEventType.js":92,"../asserts.js":111,"../functions.js":200,"../has.js":233}],139:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildExpression=buildExpression,exports.newEvaluationContext=newEvaluationContext;var _expression=require("./expression.js"),_color=require("../color.js");function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(r,e):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,o=Array(e);n<e;n++)o[n]=r[n];return o}function newEvaluationContext(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function buildExpression(r,e,n){var o=(0,_expression.parse)(r,n);if(!(0,_expression.overlapsType)(e,o.type)){var s=(0,_expression.typeName)(e),t=(0,_expression.typeName)(o.type);throw new Error("Expected expression to be of type ".concat(s,", got ").concat(t))}return compileExpression(o,n)}function compileExpression(r,e){if(r instanceof _expression.LiteralExpression){if(r.type===_expression.ColorType&&"string"==typeof r.value){var n=(0,_color.fromString)(r.value);return function(){return n}}return function(){return r.value}}var o=r.operator;switch(o){case _expression.Ops.Number:case _expression.Ops.String:case _expression.Ops.Coalesce:return compileAssertionExpression(r,e);case _expression.Ops.Get:case _expression.Ops.Var:return compileAccessorExpression(r,e);case _expression.Ops.Id:return function(r){return r.featureId};case _expression.Ops.GeometryType:return function(r){return r.geometryType};case _expression.Ops.Concat:var s=r.args.map(function(r){return compileExpression(r,e)});return function(r){var e;return(e="").concat.apply(e,_toConsumableArray(s.map(function(e){return e(r).toString()})))};case _expression.Ops.Resolution:return function(r){return r.resolution};case _expression.Ops.Any:case _expression.Ops.All:case _expression.Ops.Between:case _expression.Ops.In:case _expression.Ops.Not:return compileLogicalExpression(r,e);case _expression.Ops.Equal:case _expression.Ops.NotEqual:case _expression.Ops.LessThan:case _expression.Ops.LessThanOrEqualTo:case _expression.Ops.GreaterThan:case _expression.Ops.GreaterThanOrEqualTo:return compileComparisonExpression(r,e);case _expression.Ops.Multiply:case _expression.Ops.Divide:case _expression.Ops.Add:case _expression.Ops.Subtract:case _expression.Ops.Clamp:case _expression.Ops.Mod:case _expression.Ops.Pow:case _expression.Ops.Abs:case _expression.Ops.Floor:case _expression.Ops.Ceil:case _expression.Ops.Round:case _expression.Ops.Sin:case _expression.Ops.Cos:case _expression.Ops.Atan:case _expression.Ops.Sqrt:return compileNumericExpression(r,e);case _expression.Ops.Case:return compileCaseExpression(r,e);case _expression.Ops.Match:return compileMatchExpression(r,e);case _expression.Ops.Interpolate:return compileInterpolateExpression(r,e);case _expression.Ops.ToString:return compileConvertExpression(r,e);default:throw new Error("Unsupported operator ".concat(o))}}function compileAssertionExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.Coalesce:return function(r){for(var e=0;e<o;++e){var n=s[e](r);if(null!=n)return n}throw new Error("Expected one of the values to be non-null")};case _expression.Ops.Number:case _expression.Ops.String:return function(r){for(var e=0;e<o;++e){var t=s[e](r);if(_typeof(t)===n)return t}throw new Error("Expected one of the values to be a ".concat(n))};default:throw new Error("Unsupported assertion operator ".concat(n))}}function compileAccessorExpression(r,e){var n=r.args[0].value;switch(r.operator){case _expression.Ops.Get:return function(r){return r.properties[n]};case _expression.Ops.Var:return function(r){return r.variables[n]};default:throw new Error("Unsupported accessor operator ".concat(r.operator))}}function compileComparisonExpression(r,e){var n=r.operator,o=compileExpression(r.args[0],e),s=compileExpression(r.args[1],e);switch(n){case _expression.Ops.Equal:return function(r){return o(r)===s(r)};case _expression.Ops.NotEqual:return function(r){return o(r)!==s(r)};case _expression.Ops.LessThan:return function(r){return o(r)<s(r)};case _expression.Ops.LessThanOrEqualTo:return function(r){return o(r)<=s(r)};case _expression.Ops.GreaterThan:return function(r){return o(r)>s(r)};case _expression.Ops.GreaterThanOrEqualTo:return function(r){return o(r)>=s(r)};default:throw new Error("Unsupported comparison operator ".concat(n))}}function compileLogicalExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.Any:return function(r){for(var e=0;e<o;++e)if(s[e](r))return!0;return!1};case _expression.Ops.All:return function(r){for(var e=0;e<o;++e)if(!s[e](r))return!1;return!0};case _expression.Ops.Between:return function(r){var e=s[0](r),n=s[1](r),o=s[2](r);return e>=n&&e<=o};case _expression.Ops.In:return function(r){for(var e=s[0](r),n=1;n<o;++n)if(e===s[n](r))return!0;return!1};case _expression.Ops.Not:return function(r){return!s[0](r)};default:throw new Error("Unsupported logical operator ".concat(n))}}function compileNumericExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.Multiply:return function(r){for(var e=1,n=0;n<o;++n)e*=s[n](r);return e};case _expression.Ops.Divide:return function(r){return s[0](r)/s[1](r)};case _expression.Ops.Add:return function(r){for(var e=0,n=0;n<o;++n)e+=s[n](r);return e};case _expression.Ops.Subtract:return function(r){return s[0](r)-s[1](r)};case _expression.Ops.Clamp:return function(r){var e=s[0](r),n=s[1](r);if(e<n)return n;var o=s[2](r);return e>o?o:e};case _expression.Ops.Mod:return function(r){return s[0](r)%s[1](r)};case _expression.Ops.Pow:return function(r){return Math.pow(s[0](r),s[1](r))};case _expression.Ops.Abs:return function(r){return Math.abs(s[0](r))};case _expression.Ops.Floor:return function(r){return Math.floor(s[0](r))};case _expression.Ops.Ceil:return function(r){return Math.ceil(s[0](r))};case _expression.Ops.Round:return function(r){return Math.round(s[0](r))};case _expression.Ops.Sin:return function(r){return Math.sin(s[0](r))};case _expression.Ops.Cos:return function(r){return Math.cos(s[0](r))};case _expression.Ops.Atan:return 2===o?function(r){return Math.atan2(s[0](r),s[1](r))}:function(r){return Math.atan(s[0](r))};case _expression.Ops.Sqrt:return function(r){return Math.sqrt(s[0](r))};default:throw new Error("Unsupported numeric operator ".concat(n))}}function compileCaseExpression(r,e){for(var n=r.args.length,o=new Array(n),s=0;s<n;++s)o[s]=compileExpression(r.args[s],e);return function(r){for(var e=0;e<n-1;e+=2){if(o[e](r))return o[e+1](r)}return o[n-1](r)}}function compileMatchExpression(r,e){for(var n=r.args.length,o=new Array(n),s=0;s<n;++s)o[s]=compileExpression(r.args[s],e);return function(r){for(var e=o[0](r),s=1;s<n;s+=2)if(e===o[s](r))return o[s+1](r);return o[n-1](r)}}function compileInterpolateExpression(r,e){for(var n=r.args.length,o=new Array(n),s=0;s<n;++s)o[s]=compileExpression(r.args[s],e);return function(r){for(var e,s,t=o[0](r),a=o[1](r),i=2;i<n;i+=2){var p=o[i](r),u=o[i+1](r),c=Array.isArray(u);if(c&&(u=(0,_color.withAlpha)(u)),p>=a)return 2===i?u:c?interpolateColor(t,a,e,s,p,u):interpolateNumber(t,a,e,s,p,u);e=p,s=u}return s}}function compileConvertExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.ToString:return function(e){var n=s[0](e);return r.args[0].type===_expression.ColorType?(0,_color.toString)(n):n.toString()};default:throw new Error("Unsupported convert operator ".concat(n))}}function interpolateNumber(r,e,n,o,s,t){var a=s-n;if(0===a)return o;var i=e-n;return o+(1===r?i/a:(Math.pow(r,i)-1)/(Math.pow(r,a)-1))*(t-o)}function interpolateColor(r,e,n,o,s,t){if(0===s-n)return o;var a=(0,_color.rgbaToLcha)(o),i=(0,_color.rgbaToLcha)(t),p=i[2]-a[2];p>180?p-=360:p<-180&&(p+=360);var u=[interpolateNumber(r,e,n,a[0],s,i[0]),interpolateNumber(r,e,n,a[1],s,i[1]),a[2]+interpolateNumber(r,e,n,0,s,p),interpolateNumber(r,e,n,o[3],s,t[3])];return(0,_color.normalize)((0,_color.lchaToRgba)(u))}

},{"../color.js":113,"./expression.js":140}],140:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringType=exports.SizeType=exports.Ops=exports.NumberType=exports.NumberArrayType=exports.NoneType=exports.LiteralExpression=exports.ColorType=exports.CallExpression=exports.BooleanType=exports.AnyType=void 0,exports.computeGeometryType=computeGeometryType,exports.includesType=includesType,exports.isType=isType,exports.newParsingContext=newParsingContext,exports.overlapsType=overlapsType,exports.parse=parse,exports.typeName=typeName;var _parsers,_array=require("../array.js"),_color=require("../color.js");function _construct(e,r,t){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,r);var n=new(e.bind.apply(e,o));return t&&_setPrototypeOf(n,t.prototype),n}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,n,a,p,s=[],i=!0,y=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;i=!1}else for(;!(i=(o=a.call(t)).done)&&(s.push(o.value),s.length!==r);i=!0);}catch(e){y=!0,n=e}finally{try{if(!i&&null!=t.return&&(p=t.return(),Object(p)!==p))return}finally{if(y)throw n}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _createForOfIteratorHelper(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,p=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return p=e.done,e},e:function(e){s=!0,a=e},f:function(){try{p||null==t.return||t.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var numTypes=0,NoneType=exports.NoneType=0,BooleanType=exports.BooleanType=1<<numTypes++,NumberType=exports.NumberType=1<<numTypes++,StringType=exports.StringType=1<<numTypes++,ColorType=exports.ColorType=1<<numTypes++,NumberArrayType=exports.NumberArrayType=1<<numTypes++,SizeType=exports.SizeType=1<<numTypes++,AnyType=exports.AnyType=Math.pow(2,numTypes)-1,typeNames=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},BooleanType,"boolean"),NumberType,"number"),StringType,"string"),ColorType,"color"),NumberArrayType,"number[]"),SizeType,"size"),namedTypes=Object.keys(typeNames).map(Number).sort(_array.ascending);function typeName(e){var r,t=[],o=_createForOfIteratorHelper(namedTypes);try{for(o.s();!(r=o.n()).done;){var n=r.value;includesType(e,n)&&t.push(typeNames[n])}}catch(e){o.e(e)}finally{o.f()}return 0===t.length?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function includesType(e,r){return(e&r)===r}function overlapsType(e,r){return!!(e&r)}function isType(e,r){return e===r}var LiteralExpression=exports.LiteralExpression=_createClass(function e(r,t){_classCallCheck(this,e),this.type=r,this.value=t}),CallExpression=exports.CallExpression=_createClass(function e(r,t){_classCallCheck(this,e),this.type=r,this.operator=t;for(var o=arguments.length,n=new Array(o>2?o-2:0),a=2;a<o;a++)n[a-2]=arguments[a];this.args=n});function newParsingContext(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function getTypeFromHint(e){switch(e){case"string":return StringType;case"color":return ColorType;case"number":return NumberType;case"boolean":return BooleanType;case"number[]":return NumberArrayType;default:throw new Error("Unrecognized type hint: ".concat(e))}}function parse(e,r,t){switch(_typeof(e)){case"boolean":return new LiteralExpression(BooleanType,e);case"number":return new LiteralExpression(t===SizeType?SizeType:NumberType,e);case"string":var o=StringType;return(0,_color.isStringColor)(e)&&(o|=ColorType),isType(o&t,NoneType)||(o&=t),new LiteralExpression(o,e)}if(!Array.isArray(e))throw new Error("Expression must be an array or a primitive value");if(0===e.length)throw new Error("Empty expression");if("string"==typeof e[0])return parseCallExpression(e,r,t);var n,a=_createForOfIteratorHelper(e);try{for(a.s();!(n=a.n()).done;){if("number"!=typeof n.value)throw new Error("Expected an array of numbers")}}catch(e){a.e(e)}finally{a.f()}var p=NumberArrayType;return 2===e.length?p|=SizeType:3!==e.length&&4!==e.length||(p|=ColorType),t&&(p&=t),new LiteralExpression(p,e)}var Ops=exports.Ops={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},parsers=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers={},Ops.Get,createParser(function(e){var r=_slicedToArray(e,2),t=(r[0],r[1]);return void 0!==t?getTypeFromHint(t.value):AnyType},withArgsCount(1,2),withGetArgs)),Ops.Var,createParser(function(e){return _slicedToArray(e,1)[0].type},withArgsCount(1,1),withVarArgs)),Ops.Id,createParser(NumberType|StringType,withNoArgs,usesFeatureId)),Ops.Concat,createParser(StringType,withArgsCount(2,1/0),parseArgsOfType(AnyType))),Ops.GeometryType,createParser(StringType,withNoArgs,usesGeometryType)),Ops.Resolution,createParser(NumberType,withNoArgs)),Ops.Zoom,createParser(NumberType,withNoArgs)),Ops.Time,createParser(NumberType,withNoArgs)),Ops.Any,createParser(BooleanType,withArgsCount(2,1/0),parseArgsOfType(BooleanType))),Ops.All,createParser(BooleanType,withArgsCount(2,1/0),parseArgsOfType(BooleanType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Not,createParser(BooleanType,withArgsCount(1,1),parseArgsOfType(BooleanType))),Ops.Equal,createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType)),Ops.NotEqual,createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType)),Ops.GreaterThan,createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType)),Ops.GreaterThanOrEqualTo,createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType)),Ops.LessThan,createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType)),Ops.LessThanOrEqualTo,createParser(BooleanType,withArgsCount(2,2),parseArgsOfType(AnyType),narrowArgsType)),Ops.Multiply,createParser(function(e){for(var r=NumberType|ColorType,t=0;t<e.length;t++)r&=e[t].type;return r},withArgsCount(2,1/0),parseArgsOfType(NumberType|ColorType),narrowArgsType)),Ops.Coalesce,createParser(function(e){for(var r=AnyType,t=1;t<e.length;t+=2)r&=e[t].type;return r&=e[e.length-1].type},withArgsCount(2,1/0),parseArgsOfType(AnyType),narrowArgsType)),Ops.Divide,createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Add,createParser(NumberType,withArgsCount(2,1/0),parseArgsOfType(NumberType))),Ops.Subtract,createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType))),Ops.Clamp,createParser(NumberType,withArgsCount(3,3),parseArgsOfType(NumberType))),Ops.Mod,createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType))),Ops.Pow,createParser(NumberType,withArgsCount(2,2),parseArgsOfType(NumberType))),Ops.Abs,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),Ops.Floor,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),Ops.Ceil,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),Ops.Round,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),Ops.Sin,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Cos,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),Ops.Atan,createParser(NumberType,withArgsCount(1,2),parseArgsOfType(NumberType))),Ops.Sqrt,createParser(NumberType,withArgsCount(1,1),parseArgsOfType(NumberType))),Ops.Match,createParser(function(e){for(var r=AnyType,t=2;t<e.length;t+=2)r&=e[t].type;return r&=e[e.length-1].type},withArgsCount(4,1/0),withEvenArgs,parseMatchArgs)),Ops.Between,createParser(BooleanType,withArgsCount(3,3),parseArgsOfType(NumberType))),Ops.Interpolate,createParser(function(e){for(var r=ColorType|NumberType,t=3;t<e.length;t+=2)r&=e[t].type;return r},withArgsCount(6,1/0),withEvenArgs,parseInterpolateArgs)),Ops.Case,createParser(function(e){for(var r=AnyType,t=1;t<e.length;t+=2)r&=e[t].type;return r&=e[e.length-1].type},withArgsCount(3,1/0),withOddArgs,parseCaseArgs)),Ops.In,createParser(BooleanType,withArgsCount(2,2),parseInArgs)),Ops.Number,createParser(NumberType,withArgsCount(1,1/0),parseArgsOfType(AnyType))),Ops.String,createParser(StringType,withArgsCount(1,1/0),parseArgsOfType(AnyType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Array,createParser(function(e){return 2===e.length?NumberArrayType|SizeType:3===e.length||4===e.length?NumberArrayType|ColorType:NumberArrayType},withArgsCount(1,1/0),parseArgsOfType(NumberType))),Ops.Color,createParser(ColorType,withArgsCount(1,4),parseArgsOfType(NumberType))),Ops.Band,createParser(NumberType,withArgsCount(1,3),parseArgsOfType(NumberType))),Ops.Palette,createParser(ColorType,withArgsCount(2,2),parsePaletteArgs)),Ops.ToString,createParser(StringType,withArgsCount(1,1),parseArgsOfType(BooleanType|NumberType|StringType|ColorType))));function withGetArgs(e,r){var t=parse(e[1],r);if(!(t instanceof LiteralExpression))throw new Error("Expected a literal argument for get operation");if("string"!=typeof t.value)throw new Error("Expected a string argument for get operation");return r.properties.add(t.value),3===e.length?[t,parse(e[2],r)]:[t]}function withVarArgs(e,r,t,o){var n=e[1];if("string"!=typeof n)throw new Error("Expected a string argument for var operation");if(r.variables.add(n),!("variables"in r.style)||void 0===r.style.variables[n])return[new LiteralExpression(AnyType,n)];var a=parse(r.style.variables[n],r);if(a.value=n,o&&!overlapsType(o,a.type))throw new Error("The variable ".concat(n," has type ").concat(typeName(a.type)," but the following type was expected: ").concat(typeName(o)));return[a]}function usesFeatureId(e,r){r.featureId=!0}function usesGeometryType(e,r){r.geometryType=!0}function withNoArgs(e,r){var t=e[0];if(1!==e.length)throw new Error("Expected no arguments for ".concat(t," operation"));return[]}function withArgsCount(e,r){return function(t,o){var n=t[0],a=t.length-1;if(e===r){if(a!==e){var p=1===e?"":"s";throw new Error("Expected ".concat(e," argument").concat(p," for ").concat(n,", got ").concat(a))}}else if(a<e||a>r){var s=r===1/0?"".concat(e," or more"):"".concat(e," to ").concat(r);throw new Error("Expected ".concat(s," arguments for ").concat(n,", got ").concat(a))}}}function parseArgsOfType(e){return function(r,t){for(var o=r[0],n=r.length-1,a=new Array(n),p=0;p<n;++p){var s=parse(r[p+1],t);if(!overlapsType(e,s.type)){var i=typeName(e),y=typeName(s.type);throw new Error("Unexpected type for argument ".concat(p," of ").concat(o," operation")+", got ".concat(i," but expected ").concat(y))}s.type&=e,a[p]=s}return a}}function narrowArgsType(e,r,t){for(var o=e[0],n=e.length-1,a=AnyType,p=0;p<t.length;++p)a&=t[p].type;if(a===NoneType)throw new Error("No common type could be found for arguments of ".concat(o," operation"));for(var s=new Array(n),i=0;i<n;++i)s[i]=parse(e[i+1],r,a);return s}function withOddArgs(e,r){var t=e[0],o=e.length-1;if(o%2==0)throw new Error("An odd amount of arguments was expected for operation ".concat(t,", got ").concat(JSON.stringify(o)," instead"))}function withEvenArgs(e,r){var t=e[0],o=e.length-1;if(o%2==1)throw new Error("An even amount of arguments was expected for operation ".concat(t,", got ").concat(JSON.stringify(o)," instead"))}function parseMatchArgs(e,r,t,o){for(var n=e.length-1,a=parse(e[1],r).type,p=parse(e[e.length-1],r),s=void 0!==o?o&p.type:p.type,i=new Array(n-2),y=0;y<n-2;y+=2){var u=parse(e[y+2],r),l=parse(e[y+3],r);a&=u.type,s&=l.type,i[y]=u,i[y+1]=l}var c=StringType|NumberType|BooleanType;if(!overlapsType(c,a))throw new Error("Expected an input of type ".concat(typeName(c)," for the interpolate operation")+", got ".concat(typeName(a)," instead"));if(a&=c,isType(s,NoneType))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(e));for(var f=0;f<n-2;f+=2){var T=parse(e[f+2],r,a),g=parse(e[f+3],r,s);i[f]=T,i[f+1]=g}return[parse(e[1],r,a)].concat(i,[parse(e[e.length-1],r,s)])}function parseInterpolateArgs(e,r,t,o){var n,a=e[1];switch(a[0]){case"linear":n=1;break;case"exponential":if("number"!=typeof(n=a[1]))throw new Error("Expected a number base for exponential interpolation"+", got ".concat(JSON.stringify(n)," instead"));break;default:n=null}if(!n)throw new Error("Invalid interpolation type: ".concat(JSON.stringify(a)));n=parse(n,r);var p=parse(e[2],r);if(!overlapsType(NumberType,p.type))throw new Error("Expected an input of type number for the interpolate operation"+", got ".concat(typeName(p.type)," instead"));p=parse(e[2],r,NumberType);for(var s=new Array(e.length-3),i=0;i<s.length;i+=2){var y=parse(e[i+3],r);if(!overlapsType(NumberType,y.type))throw new Error("Expected all stop input values in the interpolate operation to be of type number"+", got ".concat(typeName(y.type)," at position ").concat(i+2," instead"));var u=parse(e[i+4],r);if(!overlapsType(NumberType|ColorType,u.type))throw new Error("Expected all stop output values in the interpolate operation to be a number or color"+", got ".concat(typeName(u.type)," at position ").concat(i+3," instead"));y=parse(e[i+3],r,NumberType),u=parse(e[i+4],r,NumberType|ColorType),s[i]=y,s[i+1]=u}return[n,p].concat(s)}function parseCaseArgs(e,r,t,o){for(var n=parse(e[e.length-1],r,o),a=void 0!==o?o&n.type:n.type,p=new Array(e.length-1),s=0;s<p.length-1;s+=2){var i=parse(e[s+1],r),y=parse(e[s+2],r,o);if(!overlapsType(BooleanType,i.type))throw new Error("Expected all conditions in the case operation to be of type boolean"+", got ".concat(typeName(i.type)," at position ").concat(s," instead"));a&=y.type,p[s]=i,p[s+1]=y}if(isType(a,NoneType))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(e));for(var u=0;u<p.length-1;u+=2)p[u+1]=parse(e[u+2],r,a);return p[p.length-1]=parse(e[e.length-1],r,a),p}function parseInArgs(e,r){var t=e[2];if(!Array.isArray(t))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof t[0]){if("literal"!==t[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(t[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');t=t[1]}for(var o=StringType|NumberType,n=new Array(t.length),a=0;a<n.length;a++){var p=parse(t[a],r);o&=p.type,n[a]=p}if(isType(o,NoneType))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(e));return[parse(e[1],r,o)].concat(n)}function parsePaletteArgs(e,r){var t=parse(e[1],r,NumberType);if(t.type!==NumberType)throw new Error("The first argument of palette must be an number, got ".concat(typeName(t.type)," instead"));var o=e[2];if(!Array.isArray(o))throw new Error("The second argument of palette must be an array");for(var n=new Array(o.length),a=0;a<n.length;a++){var p=parse(o[a],r,ColorType);if(!(p instanceof LiteralExpression))throw new Error("The palette color at index ".concat(a," must be a literal value"));if(!overlapsType(p.type,ColorType))throw new Error("The palette color at index ".concat(a," should be of type color, got ").concat(typeName(p.type)," instead"));n[a]=p}return[t].concat(n)}function createParser(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),o=1;o<r;o++)t[o-1]=arguments[o];return function(r,o,n){for(var a=r[0],p=[],s=0;s<t.length;s++)p=t[s](r,o,p,n)||p;var i="function"==typeof e?e(p):e;if(void 0!==n){if(!overlapsType(i,n))throw new Error("The following expression was expected to return ".concat(typeName(n),", but returns ").concat(typeName(i)," instead: ").concat(JSON.stringify(r)));i&=n}if(i===NoneType)throw new Error("No matching type was found for the following expression: ".concat(JSON.stringify(r)));return _construct(CallExpression,[i,a].concat(_toConsumableArray(p)))}}function parseCallExpression(e,r,t){var o=e[0],n=parsers[o];if(!n)throw new Error("Unknown operator: ".concat(o));return n(e,r,t)}function computeGeometryType(e){if(!e)return"";var r=e.getType();switch(r){case"Point":case"LineString":case"Polygon":return r;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return r.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return computeGeometryType(e.getGeometries()[0]);default:return""}}

},{"../array.js":110,"../color.js":113}],141:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PALETTE_TEXTURE_ARRAY=void 0,exports.arrayToGlsl=arrayToGlsl,exports.buildExpression=buildExpression,exports.colorToGlsl=colorToGlsl,exports.getStringNumberEquivalent=getStringNumberEquivalent,exports.newCompilationContext=newCompilationContext,exports.numberToGlsl=numberToGlsl,exports.sizeToGlsl=sizeToGlsl,exports.stringToGlsl=stringToGlsl,exports.uniformNameForVariable=uniformNameForVariable;var _compilers,_PaletteTexture=_interopRequireDefault(require("../webgl/PaletteTexture.js")),_expression=require("./expression.js"),_TileLayer=require("../renderer/webgl/TileLayer.js"),_color=require("../color.js"),_size=require("../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,n,a,i,c=[],s=!0,p=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=a.call(t)).done)&&(c.push(o.value),c.length!==r);s=!0);}catch(e){p=!0,n=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(p)throw n}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function computeOperatorFunctionName(e,r){return"operator_".concat(e,"_").concat(Object.keys(r.functions).length)}function numberToGlsl(e){var r=e.toString();return r.includes(".")?r:r+".0"}function arrayToGlsl(e){if(e.length<2||e.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(e.length,"(").concat(e.map(numberToGlsl).join(", "),")")}function colorToGlsl(e){var r=(0,_color.asArray)(e),t=r.length>3?r[3]:1;return arrayToGlsl([r[0]/255*t,r[1]/255*t,r[2]/255*t,t])}function sizeToGlsl(e){return arrayToGlsl((0,_size.toSize)(e))}var stringToFloatMap={},stringToFloatCounter=0;function getStringNumberEquivalent(e){return e in stringToFloatMap||(stringToFloatMap[e]=stringToFloatCounter++),stringToFloatMap[e]}function stringToGlsl(e){return numberToGlsl(getStringNumberEquivalent(e))}function uniformNameForVariable(e){return"u_var_"+e}function newCompilationContext(){return{inFragmentShader:!1,variables:{},properties:{},functions:{},bandCount:0,style:{}}}var GET_BAND_VALUE_FUNC="getBandValue",PALETTE_TEXTURE_ARRAY=exports.PALETTE_TEXTURE_ARRAY="u_paletteTextures";function buildExpression(e,r,t,o){var n=(0,_expression.parse)(e,t,r);if((0,_expression.isType)(n.type,_expression.NoneType))throw new Error("No matching type was found");if(!(0,_expression.overlapsType)(r,n.type)){var a=(0,_expression.typeName)(r),i=(0,_expression.typeName)(n.type);throw new Error("Expected expression to be of type ".concat(a,", got ").concat(i))}return compile(n,r,o)}function createCompiler(e){return function(r,t,o){for(var n=t.args.length,a=new Array(n),i=0;i<n;++i)a[i]=compile(t.args[i],o,r);return e(a,r)}}var compilers=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_compilers={},_expression.Ops.Get,function(e,r){var t=r.args[0].value;return t in e.properties||(e.properties[t]={name:t,type:r.type}),(e.inFragmentShader?"v_prop_":"a_prop_")+t}),_expression.Ops.GeometryType,function(e,r,t){return"geometryType"in e.properties||(e.properties.geometryType={name:"geometryType",type:_expression.StringType,evaluator:function(e){return(0,_expression.computeGeometryType)(e.getGeometry())}}),(e.inFragmentShader?"v_prop_":"a_prop_")+"geometryType"}),_expression.Ops.Var,function(e,r){var t=r.args[0].value;return t in e.variables||(e.variables[t]={name:t,type:r.type}),uniformNameForVariable(t)}),_expression.Ops.Resolution,function(){return"u_resolution"}),_expression.Ops.Zoom,function(){return"u_zoom"}),_expression.Ops.Time,function(){return"u_time"}),_expression.Ops.Any,createCompiler(function(e){return"(".concat(e.join(" || "),")")})),_expression.Ops.All,createCompiler(function(e){return"(".concat(e.join(" && "),")")})),_expression.Ops.Not,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"(!".concat(r,")")})),_expression.Ops.Equal,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," == ").concat(o,")")})),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_compilers,_expression.Ops.NotEqual,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," != ").concat(o,")")})),_expression.Ops.GreaterThan,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," > ").concat(o,")")})),_expression.Ops.GreaterThanOrEqualTo,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," >= ").concat(o,")")})),_expression.Ops.LessThan,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," < ").concat(o,")")})),_expression.Ops.LessThanOrEqualTo,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," <= ").concat(o,")")})),_expression.Ops.Multiply,createCompiler(function(e){return"(".concat(e.join(" * "),")")})),_expression.Ops.Divide,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," / ").concat(o,")")})),_expression.Ops.Add,createCompiler(function(e){return"(".concat(e.join(" + "),")")})),_expression.Ops.Subtract,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"(".concat(t," - ").concat(o,")")})),_expression.Ops.Clamp,createCompiler(function(e){var r=_slicedToArray(e,3),t=r[0],o=r[1],n=r[2];return"clamp(".concat(t,", ").concat(o,", ").concat(n,")")})),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_compilers,_expression.Ops.Mod,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"mod(".concat(t,", ").concat(o,")")})),_expression.Ops.Pow,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return"pow(".concat(t,", ").concat(o,")")})),_expression.Ops.Abs,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"abs(".concat(r,")")})),_expression.Ops.Floor,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"floor(".concat(r,")")})),_expression.Ops.Ceil,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"ceil(".concat(r,")")})),_expression.Ops.Round,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"floor(".concat(r," + 0.5)")})),_expression.Ops.Sin,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"sin(".concat(r,")")})),_expression.Ops.Cos,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"cos(".concat(r,")")})),_expression.Ops.Atan,createCompiler(function(e){var r=_slicedToArray(e,2),t=r[0],o=r[1];return void 0!==o?"atan(".concat(t,", ").concat(o,")"):"atan(".concat(t,")")})),_expression.Ops.Sqrt,createCompiler(function(e){var r=_slicedToArray(e,1)[0];return"sqrt(".concat(r,")")})),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_compilers,_expression.Ops.Match,createCompiler(function(e){for(var r=e[0],t=e[e.length-1],o=null,n=e.length-3;n>=1;n-=2){var a=e[n],i=e[n+1];o="(".concat(r," == ").concat(a," ? ").concat(i," : ").concat(o||t,")")}return o})),_expression.Ops.Between,createCompiler(function(e){var r=_slicedToArray(e,3),t=r[0],o=r[1],n=r[2];return"(".concat(t," >= ").concat(o," && ").concat(t," <= ").concat(n,")")})),_expression.Ops.Interpolate,createCompiler(function(e){for(var r=_toArray(e),t=r[0],o=r[1],n=r.slice(2),a="",i=0;i<n.length-2;i+=2){var c=n[i],s=a||n[i+1],p=n[i+2],l=n[i+3],u=void 0;u=t===numberToGlsl(1)?"(".concat(o," - ").concat(c,") / (").concat(p," - ").concat(c,")"):"(pow(".concat(t,", (").concat(o," - ").concat(c,")) - 1.0) / (pow(").concat(t,", (").concat(p," - ").concat(c,")) - 1.0)"),a="mix(".concat(s,", ").concat(l,", clamp(").concat(u,", 0.0, 1.0))")}return a})),_expression.Ops.Case,createCompiler(function(e){for(var r=e[e.length-1],t=null,o=e.length-3;o>=0;o-=2){var n=e[o],a=e[o+1];t="(".concat(n," ? ").concat(a," : ").concat(t||r,")")}return t})),_expression.Ops.In,createCompiler(function(e,r){for(var t=_toArray(e),o=t[0],n=t.slice(1),a=computeOperatorFunctionName("in",r),i=[],c=0;c<n.length;c+=1)i.push("  if (inputValue == ".concat(n[c],") { return true; }"));return r.functions[a]="bool ".concat(a,"(float inputValue) {\n").concat(i.join("\n"),"\n  return false;\n}"),"".concat(a,"(").concat(o,")")})),_expression.Ops.Array,createCompiler(function(e){return"vec".concat(e.length,"(").concat(e.join(", "),")")})),_expression.Ops.Color,createCompiler(function(e){if(1===e.length)return"vec4(vec3(".concat(e[0]," / 255.0), 1.0)");if(2===e.length)return"(".concat(e[1]," * vec4(vec3(").concat(e[0]," / 255.0), 1.0))");var r=e.slice(0,3).map(function(e){return"".concat(e," / 255.0")});if(3===e.length)return"vec4(".concat(r.join(", "),", 1.0)");var t=e[3];return"(".concat(t," * vec4(").concat(r.join(", "),", 1.0))")})),_expression.Ops.Band,createCompiler(function(e,r){var t=_slicedToArray(e,3),o=t[0],n=t[1],a=t[2];if(!(GET_BAND_VALUE_FUNC in r.functions)){for(var i="",c=r.bandCount||1,s=0;s<c;s++){var p=Math.floor(s/4),l=s%4;s===c-1&&1===l&&(l=3);var u="".concat(_TileLayer.Uniforms.TILE_TEXTURE_ARRAY,"[").concat(p,"]");i+="  if (band == ".concat(s+1,".0) {\n    return texture2D(").concat(u,", v_textureCoord + vec2(dx, dy))[").concat(l,"];\n  }\n")}r.functions[GET_BAND_VALUE_FUNC]="float getBandValue(float band, float xOffset, float yOffset) {\n  float dx = xOffset / ".concat(_TileLayer.Uniforms.TEXTURE_PIXEL_WIDTH,";\n  float dy = yOffset / ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_HEIGHT,";\n").concat(i,"\n}")}return"".concat(GET_BAND_VALUE_FUNC,"(").concat(o,", ").concat(null!=n?n:"0.0",", ").concat(null!=a?a:"0.0",")")})),_expression.Ops.Palette,function(e,r){for(var t=_toArray(r.args),o=t[0],n=t.slice(1),a=n.length,i=new Uint8Array(4*a),c=0;c<n.length;c++){var s=n[c].value,p=(0,_color.asArray)(s),l=4*c;i[l]=p[0],i[l+1]=p[1],i[l+2]=p[2],i[l+3]=255*p[3]}e.paletteTextures||(e.paletteTextures=[]);var u="".concat(PALETTE_TEXTURE_ARRAY,"[").concat(e.paletteTextures.length,"]"),f=new _PaletteTexture.default(u,i);e.paletteTextures.push(f);var _=compile(o,_expression.NumberType,e);return"texture2D(".concat(u,", vec2((").concat(_," + 0.5) / ").concat(a,".0, 0.5))")}));function compile(e,r,t){if(e instanceof _expression.CallExpression){var o=compilers[e.operator];if(void 0===o)throw new Error("No compiler defined for this operator: ".concat(JSON.stringify(e.operator)));return o(t,e,r)}if((e.type&_expression.NumberType)>0)return numberToGlsl(e.value);if((e.type&_expression.BooleanType)>0)return e.value.toString();if((e.type&_expression.StringType)>0)return stringToGlsl(e.value.toString());if((e.type&_expression.ColorType)>0)return colorToGlsl(e.value);if((e.type&_expression.NumberArrayType)>0)return arrayToGlsl(e.value);if((e.type&_expression.SizeType)>0)return sizeToGlsl(e.value);throw new Error("Unexpected expression ".concat(e.value," (expected type ").concat((0,_expression.typeName)(r),")"))}

},{"../color.js":113,"../renderer/webgl/TileLayer.js":325,"../size.js":337,"../webgl/PaletteTexture.js":411,"./expression.js":140}],142:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyTransform=applyTransform,exports.approximatelyEquals=approximatelyEquals,exports.boundingExtent=boundingExtent,exports.buffer=buffer,exports.clone=clone,exports.closestSquaredDistanceXY=closestSquaredDistanceXY,exports.containsCoordinate=containsCoordinate,exports.containsExtent=containsExtent,exports.containsXY=containsXY,exports.coordinateRelationship=coordinateRelationship,exports.createEmpty=createEmpty,exports.createOrUpdate=createOrUpdate,exports.createOrUpdateEmpty=createOrUpdateEmpty,exports.createOrUpdateFromCoordinate=createOrUpdateFromCoordinate,exports.createOrUpdateFromCoordinates=createOrUpdateFromCoordinates,exports.createOrUpdateFromFlatCoordinates=createOrUpdateFromFlatCoordinates,exports.createOrUpdateFromRings=createOrUpdateFromRings,exports.equals=equals,exports.extend=extend,exports.extendCoordinate=extendCoordinate,exports.extendCoordinates=extendCoordinates,exports.extendFlatCoordinates=extendFlatCoordinates,exports.extendRings=extendRings,exports.extendXY=extendXY,exports.forEachCorner=forEachCorner,exports.getArea=getArea,exports.getBottomLeft=getBottomLeft,exports.getBottomRight=getBottomRight,exports.getCenter=getCenter,exports.getCorner=getCorner,exports.getEnlargedArea=getEnlargedArea,exports.getForViewAndSize=getForViewAndSize,exports.getHeight=getHeight,exports.getIntersection=getIntersection,exports.getIntersectionArea=getIntersectionArea,exports.getMargin=getMargin,exports.getRotatedViewport=getRotatedViewport,exports.getSize=getSize,exports.getTopLeft=getTopLeft,exports.getTopRight=getTopRight,exports.getWidth=getWidth,exports.intersects=intersects,exports.intersectsSegment=intersectsSegment,exports.isEmpty=isEmpty,exports.returnOrUpdate=returnOrUpdate,exports.scaleFromCenter=scaleFromCenter,exports.wrapAndSliceX=wrapAndSliceX,exports.wrapX=wrapX;var _Relationship=_interopRequireDefault(require("./extent/Relationship.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,s=[],u=!0,p=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){p=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(p)throw o}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function boundingExtent(t){for(var e=createEmpty(),r=0,n=t.length;r<n;++r)extendCoordinate(e,t[r]);return e}function _boundingExtentXYs(t,e,r){return createOrUpdate(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),r)}function buffer(t,e,r){return r?(r[0]=t[0]-e,r[1]=t[1]-e,r[2]=t[2]+e,r[3]=t[3]+e,r):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function clone(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function closestSquaredDistanceXY(t,e,r){var n,o;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(o=r<t[1]?t[1]-r:t[3]<r?r-t[3]:0)*o}function containsCoordinate(t,e){return containsXY(t,e[0],e[1])}function containsExtent(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function containsXY(t,e,r){return t[0]<=e&&e<=t[2]&&t[1]<=r&&r<=t[3]}function coordinateRelationship(t,e){var r=t[0],n=t[1],o=t[2],a=t[3],i=e[0],s=e[1],u=_Relationship.default.UNKNOWN;return i<r?u|=_Relationship.default.LEFT:i>o&&(u|=_Relationship.default.RIGHT),s<n?u|=_Relationship.default.BELOW:s>a&&(u|=_Relationship.default.ABOVE),u===_Relationship.default.UNKNOWN&&(u=_Relationship.default.INTERSECTING),u}function createEmpty(){return[1/0,1/0,-1/0,-1/0]}function createOrUpdate(t,e,r,n,o){return o?(o[0]=t,o[1]=e,o[2]=r,o[3]=n,o):[t,e,r,n]}function createOrUpdateEmpty(t){return createOrUpdate(1/0,1/0,-1/0,-1/0,t)}function createOrUpdateFromCoordinate(t,e){var r=t[0],n=t[1];return createOrUpdate(r,n,r,n,e)}function createOrUpdateFromCoordinates(t,e){return extendCoordinates(createOrUpdateEmpty(e),t)}function createOrUpdateFromFlatCoordinates(t,e,r,n,o){return extendFlatCoordinates(createOrUpdateEmpty(o),t,e,r,n)}function createOrUpdateFromRings(t,e){return extendRings(createOrUpdateEmpty(e),t)}function equals(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function approximatelyEquals(t,e,r){return Math.abs(t[0]-e[0])<r&&Math.abs(t[2]-e[2])<r&&Math.abs(t[1]-e[1])<r&&Math.abs(t[3]-e[3])<r}function extend(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function extendCoordinate(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function extendCoordinates(t,e){for(var r=0,n=e.length;r<n;++r)extendCoordinate(t,e[r]);return t}function extendFlatCoordinates(t,e,r,n,o){for(;r<n;r+=o)extendXY(t,e[r],e[r+1]);return t}function extendRings(t,e){for(var r=0,n=e.length;r<n;++r)extendCoordinates(t,e[r]);return t}function extendXY(t,e,r){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],r)}function forEachCorner(t,e){var r;return(r=e(getBottomLeft(t)))?r:(r=e(getBottomRight(t)))?r:(r=e(getTopRight(t)))?r:(r=e(getTopLeft(t)))||!1}function getArea(t){var e=0;return isEmpty(t)||(e=getWidth(t)*getHeight(t)),e}function getBottomLeft(t){return[t[0],t[1]]}function getBottomRight(t){return[t[2],t[1]]}function getCenter(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function getCorner(t,e){var r;if("bottom-left"===e)r=getBottomLeft(t);else if("bottom-right"===e)r=getBottomRight(t);else if("top-left"===e)r=getTopLeft(t);else{if("top-right"!==e)throw new Error("Invalid corner");r=getTopRight(t)}return r}function getEnlargedArea(t,e){var r=Math.min(t[0],e[0]),n=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-r)*(Math.max(t[3],e[3])-n)}function getForViewAndSize(t,e,r,n,o){var a=_slicedToArray(getRotatedViewport(t,e,r,n),8),i=a[0],s=a[1],u=a[2],p=a[3],c=a[4],d=a[5],l=a[6],f=a[7];return createOrUpdate(Math.min(i,u,c,l),Math.min(s,p,d,f),Math.max(i,u,c,l),Math.max(s,p,d,f),o)}function getRotatedViewport(t,e,r,n){var o=e*n[0]/2,a=e*n[1]/2,i=Math.cos(r),s=Math.sin(r),u=o*i,p=o*s,c=a*i,d=a*s,l=t[0],f=t[1];return[l-u+d,f-p-c,l-u-d,f-p+c,l+u-d,f+p+c,l+u+d,f+p-c,l-u+d,f-p-c]}function getHeight(t){return t[3]-t[1]}function getIntersectionArea(t,e){return getArea(getIntersection(t,e))}function getIntersection(t,e,r){var n=r||createEmpty();return intersects(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):createOrUpdateEmpty(n),n}function getMargin(t){return getWidth(t)+getHeight(t)}function getSize(t){return[t[2]-t[0],t[3]-t[1]]}function getTopLeft(t){return[t[0],t[3]]}function getTopRight(t){return[t[2],t[3]]}function getWidth(t){return t[2]-t[0]}function intersects(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function isEmpty(t){return t[2]<t[0]||t[3]<t[1]}function returnOrUpdate(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function scaleFromCenter(t,e){var r=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=r,t[2]+=r,t[1]-=n,t[3]+=n}function intersectsSegment(t,e,r){var n=!1,o=coordinateRelationship(t,e),a=coordinateRelationship(t,r);if(o===_Relationship.default.INTERSECTING||a===_Relationship.default.INTERSECTING)n=!0;else{var i,s,u=t[0],p=t[1],c=t[2],d=t[3],l=e[0],f=e[1],g=r[0],x=r[1],h=(x-f)/(g-l);a&_Relationship.default.ABOVE&&!(o&_Relationship.default.ABOVE)&&(n=(i=g-(x-d)/h)>=u&&i<=c),n||!(a&_Relationship.default.RIGHT)||o&_Relationship.default.RIGHT||(n=(s=x-(g-c)*h)>=p&&s<=d),n||!(a&_Relationship.default.BELOW)||o&_Relationship.default.BELOW||(n=(i=g-(x-p)/h)>=u&&i<=c),n||!(a&_Relationship.default.LEFT)||o&_Relationship.default.LEFT||(n=(s=x-(g-u)*h)>=p&&s<=d)}return n}function applyTransform(t,e,r,n){if(isEmpty(t))return createOrUpdateEmpty(r);var o=[];if(n>1)for(var a=t[2]-t[0],i=t[3]-t[1],s=0;s<n;++s)o.push(t[0]+a*s/n,t[1],t[2],t[1]+i*s/n,t[2]-a*s/n,t[3],t[0],t[3]-i*s/n);else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);for(var u=[],p=[],c=0,d=o.length;c<d;c+=2)u.push(o[c]),p.push(o[c+1]);return _boundingExtentXYs(u,p,r)}function wrapX(t,e){var r=e.getExtent(),n=getCenter(t);if(e.canWrapX()&&(n[0]<r[0]||n[0]>=r[2])){var o=getWidth(r),a=Math.floor((n[0]-r[0])/o)*o;t[0]-=a,t[2]-=a}return t}function wrapAndSliceX(t,e,r){if(e.canWrapX()){var n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];wrapX(t,e);var o=getWidth(n);if(getWidth(t)>o&&!r)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+o,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-o,t[3]]]}return[t]}

},{"./extent/Relationship.js":143}],143:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};

},{}],144:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFeaturesXhr=loadFeaturesXhr,exports.setWithCredentials=setWithCredentials,exports.xhr=xhr;var _functions=require("./functions.js"),withCredentials=!1;function loadFeaturesXhr(e,t,r,s,n,a,o){var i=new XMLHttpRequest;i.open("GET","function"==typeof e?e(r,s,n):e,!0),"arraybuffer"==t.getType()&&(i.responseType="arraybuffer"),i.withCredentials=withCredentials,i.onload=function(e){if(!i.status||i.status>=200&&i.status<300){var s=t.getType();try{var u;"text"==s||"json"==s?u=i.responseText:"xml"==s?u=i.responseXML||i.responseText:"arraybuffer"==s&&(u=i.response),u?a(t.readFeatures(u,{extent:r,featureProjection:n}),t.readProjection(u)):o()}catch(e){o()}}else o()},i.onerror=o,i.send()}function xhr(e,t){return function(r,s,n,a,o){var i=this;loadFeaturesXhr(e,t,r,s,n,function(e,t){i.addFeatures(e),void 0!==a&&a(e)},o||_functions.VOID)}}function setWithCredentials(e){withCredentials=e}

},{"./functions.js":200}],145:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"EsriJSON",{enumerable:!0,get:function(){return _EsriJSON.default}}),Object.defineProperty(exports,"GML",{enumerable:!0,get:function(){return _GML.default}}),Object.defineProperty(exports,"GPX",{enumerable:!0,get:function(){return _GPX.default}}),Object.defineProperty(exports,"GeoJSON",{enumerable:!0,get:function(){return _GeoJSON.default}}),Object.defineProperty(exports,"IGC",{enumerable:!0,get:function(){return _IGC.default}}),Object.defineProperty(exports,"IIIFInfo",{enumerable:!0,get:function(){return _IIIFInfo.default}}),Object.defineProperty(exports,"KML",{enumerable:!0,get:function(){return _KML.default}}),Object.defineProperty(exports,"MVT",{enumerable:!0,get:function(){return _MVT.default}}),Object.defineProperty(exports,"OWS",{enumerable:!0,get:function(){return _OWS.default}}),Object.defineProperty(exports,"Polyline",{enumerable:!0,get:function(){return _Polyline.default}}),Object.defineProperty(exports,"TopoJSON",{enumerable:!0,get:function(){return _TopoJSON.default}}),Object.defineProperty(exports,"WFS",{enumerable:!0,get:function(){return _WFS.default}}),Object.defineProperty(exports,"WKB",{enumerable:!0,get:function(){return _WKB.default}}),Object.defineProperty(exports,"WKT",{enumerable:!0,get:function(){return _WKT.default}}),Object.defineProperty(exports,"WMSCapabilities",{enumerable:!0,get:function(){return _WMSCapabilities.default}}),Object.defineProperty(exports,"WMSGetFeatureInfo",{enumerable:!0,get:function(){return _WMSGetFeatureInfo.default}}),Object.defineProperty(exports,"WMTSCapabilities",{enumerable:!0,get:function(){return _WMTSCapabilities.default}});var _EsriJSON=_interopRequireDefault(require("./format/EsriJSON.js")),_GeoJSON=_interopRequireDefault(require("./format/GeoJSON.js")),_GML=_interopRequireDefault(require("./format/GML.js")),_GPX=_interopRequireDefault(require("./format/GPX.js")),_IGC=_interopRequireDefault(require("./format/IGC.js")),_IIIFInfo=_interopRequireDefault(require("./format/IIIFInfo.js")),_KML=_interopRequireDefault(require("./format/KML.js")),_MVT=_interopRequireDefault(require("./format/MVT.js")),_OWS=_interopRequireDefault(require("./format/OWS.js")),_Polyline=_interopRequireDefault(require("./format/Polyline.js")),_TopoJSON=_interopRequireDefault(require("./format/TopoJSON.js")),_WFS=_interopRequireDefault(require("./format/WFS.js")),_WKB=_interopRequireDefault(require("./format/WKB.js")),_WKT=_interopRequireDefault(require("./format/WKT.js")),_WMSCapabilities=_interopRequireDefault(require("./format/WMSCapabilities.js")),_WMSGetFeatureInfo=_interopRequireDefault(require("./format/WMSGetFeatureInfo.js")),_WMTSCapabilities=_interopRequireDefault(require("./format/WMTSCapabilities.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./format/EsriJSON.js":146,"./format/GML.js":148,"./format/GPX.js":153,"./format/GeoJSON.js":154,"./format/IGC.js":155,"./format/IIIFInfo.js":156,"./format/KML.js":158,"./format/MVT.js":159,"./format/OWS.js":160,"./format/Polyline.js":161,"./format/TopoJSON.js":163,"./format/WFS.js":164,"./format/WKB.js":165,"./format/WKT.js":166,"./format/WMSCapabilities.js":167,"./format/WMSGetFeatureInfo.js":168,"./format/WMTSCapabilities.js":169}],146:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_JSONFeature2=_interopRequireDefault(require("./JSONFeature.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_LinearRing=_interopRequireDefault(require("../geom/LinearRing.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_extent=require("../extent.js"),_deflate=require("../geom/flat/deflate.js"),_proj=require("../proj.js"),_obj=require("../obj.js"),_orient=require("../geom/flat/orient.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GEOMETRY_READERS={Point:readPointGeometry,LineString:readLineStringGeometry,Polygon:readPolygonGeometry,MultiPoint:readMultiPointGeometry,MultiLineString:readMultiLineStringGeometry,MultiPolygon:readMultiPolygonGeometry},GEOMETRY_WRITERS={Point:writePointGeometry,LineString:writeLineStringGeometry,Polygon:writePolygonGeometry,MultiPoint:writeMultiPointGeometry,MultiLineString:writeMultiLineStringGeometry,MultiPolygon:writeMultiPolygonGeometry},EsriJSON=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).geometryName_=e.geometryName,r}return _inherits(t,_JSONFeature2["default"]),_createClass(t,[{key:"readFeatureFromObject",value:function(e,t,r){var o=e,n=readGeometry(o.geometry,t),i=new _Feature.default;if(this.geometryName_&&i.setGeometryName(this.geometryName_),i.setGeometry(n),o.attributes){i.setProperties(o.attributes,!0);var u=o.attributes[r];void 0!==u&&i.setId(u)}return i}},{key:"readFeaturesFromObject",value:function(e,t){if(t=t||{},e.features){for(var r=[],o=e.features,n=0,i=o.length;n<i;++n)r.push(this.readFeatureFromObject(o[n],t,e.objectIdFieldName));return r}return[this.readFeatureFromObject(e,t)]}},{key:"readGeometryFromObject",value:function(e,t){return readGeometry(e,t)}},{key:"readProjectionFromObject",value:function(e){if(e.spatialReference&&void 0!==e.spatialReference.wkid){var t=e.spatialReference.wkid;return(0,_proj.get)("EPSG:"+t)}return null}},{key:"writeGeometryObject",value:function(e,t){return writeGeometry(e,this.adaptOptions(t))}},{key:"writeFeatureObject",value:function(e,t){t=this.adaptOptions(t);var r={};if(!e.hasProperties())return r.attributes={},r;var o=e.getProperties(),n=e.getGeometry();if(n){r.geometry=writeGeometry(n,t);var i=t&&(t.dataProjection||t.featureProjection);i&&(r.geometry.spatialReference={wkid:Number((0,_proj.get)(i).getCode().split(":").pop())}),delete o[e.getGeometryName()]}return(0,_obj.isEmpty)(o)?r.attributes={}:r.attributes=o,r}},{key:"writeFeaturesObject",value:function(e,t){t=this.adaptOptions(t);for(var r=[],o=0,n=e.length;o<n;++o)r.push(this.writeFeatureObject(e[o],t));return{features:r}}}])}();function readGeometry(e,t){if(!e)return null;var r;if("number"==typeof e.x&&"number"==typeof e.y)r="Point";else if(e.points)r="MultiPoint";else if(e.paths){r=1===e.paths.length?"LineString":"MultiLineString"}else if(e.rings){var o=e,n=getGeometryLayout(o),i=convertRings(o.rings,n);1===i.length?(r="Polygon",e=Object.assign({},e,_defineProperty({},"rings",i[0]))):(r="MultiPolygon",e=Object.assign({},e,_defineProperty({},"rings",i)))}var u=GEOMETRY_READERS[r];return(0,_Feature2.transformGeometryWithOptions)(u(e),!1,t)}function convertRings(e,t){var r,o,n=[],i=[],u=[];for(r=0,o=e.length;r<o;++r){n.length=0,(0,_deflate.deflateCoordinates)(n,0,e[r],t.length),(0,_orient.linearRingIsClockwise)(n,0,n.length,t.length)?i.push([e[r]]):u.push(e[r])}for(;u.length;){var a=u.shift(),s=!1;for(r=i.length-1;r>=0;r--){var l=i[r][0];if((0,_extent.containsExtent)(new _LinearRing.default(l).getExtent(),new _LinearRing.default(a).getExtent())){i[r].push(a),s=!0;break}}s||i.push([a.reverse()])}return i}function readPointGeometry(e){return void 0!==e.m&&void 0!==e.z?new _Point.default([e.x,e.y,e.z,e.m],"XYZM"):void 0!==e.z?new _Point.default([e.x,e.y,e.z],"XYZ"):void 0!==e.m?new _Point.default([e.x,e.y,e.m],"XYM"):new _Point.default([e.x,e.y])}function readLineStringGeometry(e){var t=getGeometryLayout(e);return new _LineString.default(e.paths[0],t)}function readMultiLineStringGeometry(e){var t=getGeometryLayout(e);return new _MultiLineString.default(e.paths,t)}function getGeometryLayout(e){var t="XY";return!0===e.hasZ&&!0===e.hasM?t="XYZM":!0===e.hasZ?t="XYZ":!0===e.hasM&&(t="XYM"),t}function readMultiPointGeometry(e){var t=getGeometryLayout(e);return new _MultiPoint.default(e.points,t)}function readMultiPolygonGeometry(e){var t=getGeometryLayout(e);return new _MultiPolygon.default(e.rings,t)}function readPolygonGeometry(e){var t=getGeometryLayout(e);return new _Polygon.default(e.rings,t)}function writePointGeometry(e,t){var r,o=e.getCoordinates(),n=e.getLayout();if("XYZ"===n)r={x:o[0],y:o[1],z:o[2]};else if("XYM"===n)r={x:o[0],y:o[1],m:o[2]};else if("XYZM"===n)r={x:o[0],y:o[1],z:o[2],m:o[3]};else{if("XY"!==n)throw new Error("Invalid geometry layout");r={x:o[0],y:o[1]}}return r}function getHasZM(e){var t=e.getLayout();return{hasZ:"XYZ"===t||"XYZM"===t,hasM:"XYM"===t||"XYZM"===t}}function writeLineStringGeometry(e,t){var r=getHasZM(e);return{hasZ:r.hasZ,hasM:r.hasM,paths:[e.getCoordinates()]}}function writePolygonGeometry(e,t){var r=getHasZM(e);return{hasZ:r.hasZ,hasM:r.hasM,rings:e.getCoordinates(!1)}}function writeMultiLineStringGeometry(e,t){var r=getHasZM(e);return{hasZ:r.hasZ,hasM:r.hasM,paths:e.getCoordinates()}}function writeMultiPointGeometry(e,t){var r=getHasZM(e);return{hasZ:r.hasZ,hasM:r.hasM,points:e.getCoordinates()}}function writeMultiPolygonGeometry(e,t){for(var r=getHasZM(e),o=e.getCoordinates(!1),n=[],i=0;i<o.length;i++)for(var u=o[i].length-1;u>=0;u--)n.push(o[i][u]);return{hasZ:r.hasZ,hasM:r.hasM,rings:n}}function writeGeometry(e,t){return(0,GEOMETRY_WRITERS[e.getType()])((0,_Feature2.transformGeometryWithOptions)(e,!0,t),t)}var _default=exports.default=EsriJSON;

},{"../Feature.js":82,"../extent.js":142,"../geom/LineString.js":205,"../geom/LinearRing.js":206,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../geom/flat/deflate.js":217,"../geom/flat/orient.js":226,"../obj.js":281,"../proj.js":283,"./Feature.js":147,"./JSONFeature.js":157}],147:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createGeometry=createGeometry,exports.createRenderFeature=createRenderFeature,exports.default=void 0,exports.transformExtentWithOptions=transformExtentWithOptions,exports.transformGeometryWithOptions=transformGeometryWithOptions;var _Feature=_interopRequireDefault(require("../Feature.js")),_Feature2=_interopRequireDefault(require("../render/Feature.js")),_geom=require("../geom.js"),_util=require("../util.js"),_proj=require("../proj.js"),_orient=require("../geom/flat/orient.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var FeatureFormat=function(){return _createClass(function e(){_classCallCheck(this,e),this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=_Feature.default,this.supportedMediaTypes=null},[{key:"getReadOptions",value:function(e,t){if(t){var r=t.dataProjection?(0,_proj.get)(t.dataProjection):this.readProjection(e);t.extent&&r&&"tile-pixels"===r.getUnits()&&(r=(0,_proj.get)(r)).setWorldExtent(t.extent),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}},{key:"adaptOptions",value:function(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}},{key:"getType",value:function(){return(0,_util.abstract)()}},{key:"readFeature",value:function(e,t){return(0,_util.abstract)()}},{key:"readFeatures",value:function(e,t){return(0,_util.abstract)()}},{key:"readGeometry",value:function(e,t){return(0,_util.abstract)()}},{key:"readProjection",value:function(e){return(0,_util.abstract)()}},{key:"writeFeature",value:function(e,t){return(0,_util.abstract)()}},{key:"writeFeatures",value:function(e,t){return(0,_util.abstract)()}},{key:"writeGeometry",value:function(e,t){return(0,_util.abstract)()}}])}(),_default=exports.default=FeatureFormat;function transformGeometryWithOptions(e,t,r){var o=r?(0,_proj.get)(r.featureProjection):null,n=r?(0,_proj.get)(r.dataProjection):null,i=e;if(o&&n&&!(0,_proj.equivalent)(o,n)){t&&(i=e.clone());var a=t?o:n,u=t?n:o;"tile-pixels"===a.getUnits()?i.transform(a,u):i.applyTransform((0,_proj.getTransform)(a,u))}if(t&&r&&void 0!==r.decimals){var l=Math.pow(10,r.decimals);i===e&&(i=e.clone()),i.applyTransform(function(e){for(var t=0,r=e.length;t<r;++t)e[t]=Math.round(e[t]*l)/l;return e})}return i}function transformExtentWithOptions(e,t){var r=t?(0,_proj.get)(t.featureProjection):null,o=t?(0,_proj.get)(t.dataProjection):null;return r&&o&&!(0,_proj.equivalent)(r,o)?(0,_proj.transformExtent)(e,o,r):e}var GeometryConstructor={Point:_geom.Point,LineString:_geom.LineString,Polygon:_geom.Polygon,MultiPoint:_geom.MultiPoint,MultiLineString:_geom.MultiLineString,MultiPolygon:_geom.MultiPolygon};function orientFlatCoordinates(e,t,r){return Array.isArray(t[0])?((0,_orient.linearRingssAreOriented)(e,0,t,r)||(e=e.slice(),(0,_orient.orientLinearRingsArray)(e,0,t,r)),e):((0,_orient.linearRingsAreOriented)(e,0,t,r)||(e=e.slice(),(0,_orient.orientLinearRings)(e,0,t,r)),e)}function createRenderFeature(e,t){var r,o=e.geometry;if(!o)return[];if(Array.isArray(o))return o.map(function(t){return createRenderFeature(_objectSpread(_objectSpread({},e),{},{geometry:t}))}).flat();var n="MultiPolygon"===o.type?"Polygon":o.type;if("GeometryCollection"===n||"Circle"===n)throw new Error("Unsupported geometry type: "+n);var i=o.layout.length;return transformGeometryWithOptions(new _Feature2.default(n,"Polygon"===n?orientFlatCoordinates(o.flatCoordinates,o.ends,i):o.flatCoordinates,null===(r=o.ends)||void 0===r?void 0:r.flat(),i,e.properties||{},e.id).enableSimplifyTransformed(),!1,t)}function createGeometry(e,t){if(!e)return null;if(Array.isArray(e)){var r=e.map(function(e){return createGeometry(e,t)});return new _geom.GeometryCollection(r)}return transformGeometryWithOptions(new(0,GeometryConstructor[e.type])(e.flatCoordinates,e.layout,e.ends),!1,t)}

},{"../Feature.js":82,"../geom.js":201,"../geom/flat/orient.js":226,"../proj.js":283,"../render/Feature.js":295,"../util.js":404}],148:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _GML=_interopRequireDefault(require("./GML3.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var GML=_GML.default;GML.prototype.writeFeatures,GML.prototype.writeFeaturesNode;var _default=exports.default=GML;

},{"./GML3.js":150}],149:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _GMLBase2=_interopRequireWildcard(require("./GMLBase.js")),_xml=require("../xml.js"),_extent=require("../extent.js"),_proj=require("../proj.js"),_Feature=require("./Feature.js"),_xsd=require("./xsd.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var schemaLocation=_GMLBase2.GMLNS+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",MULTIGEOMETRY_TO_MEMBER_NODENAME={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},GML2=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e=e||{}])).FEATURE_COLLECTION_PARSERS[_GMLBase2.GMLNS].featureMember=(0,_xml.makeArrayPusher)(r.readFeaturesInternal),r.schemaLocation=e.schemaLocation?e.schemaLocation:schemaLocation,r}return _inherits(t,_GMLBase2["default"]),_createClass(t,[{key:"readFlatCoordinates",value:function(e,t){var r=(0,_xml.getAllTextContent)(e,!1).replace(/^\s*|\s*$/g,""),n=t[0].srsName,i="enu";if(n){var o=(0,_proj.get)(n);o&&(i=o.getAxisOrientation())}for(var a=r.trim().split(/\s+/),l=[],s=0,p=a.length;s<p;s++){var u=a[s].split(/,+/),m=parseFloat(u[0]),c=parseFloat(u[1]),_=3===u.length?parseFloat(u[2]):0;"en"===i.substr(0,2)?l.push(m,c,_):l.push(c,m,_)}return l}},{key:"readBox",value:function(e,t){var r=(0,_xml.pushParseAndPop)([null],this.BOX_PARSERS_,e,t,this);return(0,_extent.createOrUpdate)(r[1][0],r[1][1],r[1][3],r[1][4])}},{key:"innerBoundaryIsParser",value:function(e,t){var r=(0,_xml.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);r&&t[t.length-1].push(r)}},{key:"outerBoundaryIsParser",value:function(e,t){var r=(0,_xml.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);r&&(t[t.length-1][0]=r)}},{key:"GEOMETRY_NODE_FACTORY_",value:function(e,t,r){var n=t[t.length-1],i=n.multiSurface,o=n.surface,a=n.multiCurve;return Array.isArray(e)?r="Envelope":"MultiPolygon"===(r=e.getType())&&!0===i?r="MultiSurface":"Polygon"===r&&!0===o?r="Surface":"MultiLineString"===r&&!0===a&&(r="MultiCurve"),(0,_xml.createElementNS)("http://www.opengis.net/gml",r)}},{key:"writeFeatureElement",value:function(e,t,r){var n=t.getId();n&&e.setAttribute("fid",n);var i=r[r.length-1],o=i.featureNS,a=t.getGeometryName();i.serializers||(i.serializers={},i.serializers[o]={});var l=[],s=[];if(t.hasProperties()){var p=t.getProperties();for(var u in p){var m=p[u];null!==m&&(l.push(u),s.push(m),u==a||"function"==typeof m.getSimplifiedGeometry?u in i.serializers[o]||(i.serializers[o][u]=(0,_xml.makeChildAppender)(this.writeGeometryElement,this)):u in i.serializers[o]||(i.serializers[o][u]=(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)))}}var c=Object.assign({},i);c.node=e,(0,_xml.pushSerializeAndPop)(c,i.serializers,(0,_xml.makeSimpleNodeFactory)(void 0,o),s,r,l)}},{key:"writeCurveOrLineString",value:function(e,t,r){var n=r[r.length-1].srsName;if("LineStringSegment"!==e.nodeName&&n&&e.setAttribute("srsName",n),"LineString"===e.nodeName||"LineStringSegment"===e.nodeName){var i=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(i),this.writeCoordinates_(i,t,r)}else if("Curve"===e.nodeName){var o=(0,_xml.createElementNS)(e.namespaceURI,"segments");e.appendChild(o),this.writeCurveSegments_(o,t,r)}}},{key:"writeLineStringOrCurveMember",value:function(e,t,r){var n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,r))}},{key:"writeMultiCurveOrLineString",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,a=n.curve;o&&e.setAttribute("srsName",o);var l=t.getLineStrings();(0,_xml.pushSerializeAndPop)({node:e,hasZ:i,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,r,void 0,this)}},{key:"writeGeometryElement",value:function(e,t,r){var n,i=r[r.length-1],o=Object.assign({},i);o.node=e,n=Array.isArray(t)?(0,_Feature.transformExtentWithOptions)(t,i):(0,_Feature.transformGeometryWithOptions)(t,!0,i),(0,_xml.pushSerializeAndPop)(o,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],r,void 0,this)}},{key:"createCoordinatesNode_",value:function(e){var t=(0,_xml.createElementNS)(e,"coordinates");return t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," "),t}},{key:"writeCoordinates_",value:function(e,t,r){for(var n=r[r.length-1],i=n.hasZ,o=n.srsName,a=t.getCoordinates(),l=a.length,s=new Array(l),p=0;p<l;++p){var u=a[p];s[p]=this.getCoords_(u,o,i)}(0,_xsd.writeStringTextNode)(e,s.join(" "))}},{key:"writeCurveSegments_",value:function(e,t,r){var n=(0,_xml.createElementNS)(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,r)}},{key:"writeSurfaceOrPolygon",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;if("PolygonPatch"!==e.nodeName&&o&&e.setAttribute("srsName",o),"Polygon"===e.nodeName||"PolygonPatch"===e.nodeName){var a=t.getLinearRings();(0,_xml.pushSerializeAndPop)({node:e,hasZ:i,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,r,void 0,this)}else if("Surface"===e.nodeName){var l=(0,_xml.createElementNS)(e.namespaceURI,"patches");e.appendChild(l),this.writeSurfacePatches_(l,t,r)}}},{key:"RING_NODE_FACTORY_",value:function(e,t,r){var n=t[t.length-1],i=n.node,o=n.exteriorWritten;return void 0===o&&(n.exteriorWritten=!0),(0,_xml.createElementNS)(i.namespaceURI,void 0!==o?"innerBoundaryIs":"outerBoundaryIs")}},{key:"writeSurfacePatches_",value:function(e,t,r){var n=(0,_xml.createElementNS)(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r)}},{key:"writeRing",value:function(e,t,r){var n=(0,_xml.createElementNS)(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,r)}},{key:"getCoords_",value:function(e,t,r){var n="enu";t&&(n=(0,_proj.get)(t).getAxisOrientation());var i="en"===n.substr(0,2)?e[0]+","+e[1]:e[1]+","+e[0];r&&(i+=","+(e[2]||0));return i}},{key:"writePoint",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;o&&e.setAttribute("srsName",o);var a=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(a);var l=t.getCoordinates(),s=this.getCoords_(l,o,i);(0,_xsd.writeStringTextNode)(a,s)}},{key:"writeMultiPoint",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;o&&e.setAttribute("srsName",o);var a=t.getPoints();(0,_xml.pushSerializeAndPop)({node:e,hasZ:i,srsName:o},this.POINTMEMBER_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)("pointMember"),a,r,void 0,this)}},{key:"writePointMember",value:function(e,t,r){var n=(0,_xml.createElementNS)(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,r)}},{key:"writeLinearRing",value:function(e,t,r){var n=r[r.length-1].srsName;n&&e.setAttribute("srsName",n);var i=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(i),this.writeCoordinates_(i,t,r)}},{key:"writeMultiSurfaceOrPolygon",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,a=n.surface;o&&e.setAttribute("srsName",o);var l=t.getPolygons();(0,_xml.pushSerializeAndPop)({node:e,hasZ:i,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,r,void 0,this)}},{key:"writeSurfaceOrPolygonMember",value:function(e,t,r){var n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r))}},{key:"writeEnvelope",value:function(e,t,r){var n=r[r.length-1].srsName;n&&e.setAttribute("srsName",n);var i=[t[0]+" "+t[1],t[2]+" "+t[3]];(0,_xml.pushSerializeAndPop)({node:e},this.ENVELOPE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,i,r,["lowerCorner","upperCorner"],this)}},{key:"MULTIGEOMETRY_MEMBER_NODE_FACTORY_",value:function(e,t,r){var n=t[t.length-1].node;return(0,_xml.createElementNS)("http://www.opengis.net/gml",MULTIGEOMETRY_TO_MEMBER_NODENAME[n.nodeName])}}])}();GML2.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:(0,_xml.makeReplacer)(GML2.prototype.readFlatCoordinates)}},GML2.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:GML2.prototype.innerBoundaryIsParser,outerBoundaryIs:GML2.prototype.outerBoundaryIsParser}},GML2.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:(0,_xml.makeArrayPusher)(GML2.prototype.readFlatCoordinates)}},GML2.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readPoint),MultiPoint:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readMultiPoint),LineString:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readLineString),MultiLineString:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readMultiLineString),LinearRing:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readLinearRing),Polygon:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readPolygon),MultiPolygon:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readMultiPolygon),Box:(0,_xml.makeReplacer)(GML2.prototype.readBox)}},GML2.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:(0,_xml.makeChildAppender)(GML2.prototype.writeCurveOrLineString),MultiCurve:(0,_xml.makeChildAppender)(GML2.prototype.writeMultiCurveOrLineString),Point:(0,_xml.makeChildAppender)(GML2.prototype.writePoint),MultiPoint:(0,_xml.makeChildAppender)(GML2.prototype.writeMultiPoint),LineString:(0,_xml.makeChildAppender)(GML2.prototype.writeCurveOrLineString),MultiLineString:(0,_xml.makeChildAppender)(GML2.prototype.writeMultiCurveOrLineString),LinearRing:(0,_xml.makeChildAppender)(GML2.prototype.writeLinearRing),Polygon:(0,_xml.makeChildAppender)(GML2.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,_xml.makeChildAppender)(GML2.prototype.writeMultiSurfaceOrPolygon),Surface:(0,_xml.makeChildAppender)(GML2.prototype.writeSurfaceOrPolygon),MultiSurface:(0,_xml.makeChildAppender)(GML2.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,_xml.makeChildAppender)(GML2.prototype.writeEnvelope)}},GML2.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:(0,_xml.makeChildAppender)(GML2.prototype.writeLineStringOrCurveMember),curveMember:(0,_xml.makeChildAppender)(GML2.prototype.writeLineStringOrCurveMember)}},GML2.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:(0,_xml.makeChildAppender)(GML2.prototype.writeRing),innerBoundaryIs:(0,_xml.makeChildAppender)(GML2.prototype.writeRing)}},GML2.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:(0,_xml.makeChildAppender)(GML2.prototype.writePointMember)}},GML2.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:(0,_xml.makeChildAppender)(GML2.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,_xml.makeChildAppender)(GML2.prototype.writeSurfaceOrPolygonMember)}},GML2.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),upperCorner:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)}};var _default=exports.default=GML2;

},{"../extent.js":142,"../proj.js":283,"../xml.js":418,"./Feature.js":147,"./GMLBase.js":152,"./xsd.js":199}],150:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _GML=_interopRequireDefault(require("./GML2.js")),_GMLBase2=_interopRequireWildcard(require("./GMLBase.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_xml=require("../xml.js"),_extent=require("../extent.js"),_array=require("../array.js"),_proj=require("../proj.js"),_xsd=require("./xsd.js"),_Feature=require("./Feature.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var schemaLocation=_GMLBase2.GMLNS+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",MULTIGEOMETRY_TO_MEMBER_NODENAME={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},GML3=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e=e||{}])).surface_=void 0!==e.surface&&e.surface,r.curve_=void 0!==e.curve&&e.curve,r.multiCurve_=void 0===e.multiCurve||e.multiCurve,r.multiSurface_=void 0===e.multiSurface||e.multiSurface,r.schemaLocation=e.schemaLocation?e.schemaLocation:schemaLocation,r.hasZ=void 0!==e.hasZ&&e.hasZ,r}return _inherits(t,_GMLBase2["default"]),_createClass(t,[{key:"readMultiCurve",value:function(e,t){var r=(0,_xml.pushParseAndPop)([],this.MULTICURVE_PARSERS,e,t,this);if(r)return new _MultiLineString.default(r)}},{key:"readFlatCurveRing",value:function(e,t){for(var r=(0,_xml.pushParseAndPop)([],this.MULTICURVE_PARSERS,e,t,this),i=[],n=0,o=r.length;n<o;++n)(0,_array.extend)(i,r[n].getFlatCoordinates());return i}},{key:"readMultiSurface",value:function(e,t){var r=(0,_xml.pushParseAndPop)([],this.MULTISURFACE_PARSERS,e,t,this);if(r)return new _MultiPolygon.default(r)}},{key:"curveMemberParser",value:function(e,t){(0,_xml.parseNode)(this.CURVEMEMBER_PARSERS,e,t,this)}},{key:"surfaceMemberParser",value:function(e,t){(0,_xml.parseNode)(this.SURFACEMEMBER_PARSERS,e,t,this)}},{key:"readPatch",value:function(e,t){return(0,_xml.pushParseAndPop)([null],this.PATCHES_PARSERS,e,t,this)}},{key:"readSegment",value:function(e,t){return(0,_xml.pushParseAndPop)([],this.SEGMENTS_PARSERS,e,t,this)}},{key:"readPolygonPatch",value:function(e,t){return(0,_xml.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this)}},{key:"readLineStringSegment",value:function(e,t){return(0,_xml.pushParseAndPop)([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}},{key:"interiorParser",value:function(e,t){var r=(0,_xml.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);r&&t[t.length-1].push(r)}},{key:"exteriorParser",value:function(e,t){var r=(0,_xml.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);r&&(t[t.length-1][0]=r)}},{key:"readSurface",value:function(e,t){var r=(0,_xml.pushParseAndPop)([null],this.SURFACE_PARSERS,e,t,this);if(r&&r[0]){var i,n,o=r[0],a=[o.length];for(i=1,n=r.length;i<n;++i)(0,_array.extend)(o,r[i]),a.push(o.length);return new _Polygon.default(o,"XYZ",a)}}},{key:"readCurve",value:function(e,t){var r=(0,_xml.pushParseAndPop)([null],this.CURVE_PARSERS,e,t,this);if(r)return new _LineString.default(r,"XYZ")}},{key:"readEnvelope",value:function(e,t){var r=(0,_xml.pushParseAndPop)([null],this.ENVELOPE_PARSERS,e,t,this);return(0,_extent.createOrUpdate)(r[1][0],r[1][1],r[2][0],r[2][1])}},{key:"readFlatPos",value:function(e,t){for(var r,i=(0,_xml.getAllTextContent)(e,!1),n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,o=[];r=n.exec(i);)o.push(parseFloat(r[1])),i=i.substr(r[0].length);if(""===i){var a,s,l=t[0].srsName,u="enu";if(l)u=(0,_proj.get)(l).getAxisOrientation();if("neu"===u)for(a=0,s=o.length;a<s;a+=3){var p=o[a],m=o[a+1];o[a]=m,o[a+1]=p}var _=o.length;if(2==_&&o.push(0),0!==_)return o}}},{key:"readFlatPosList",value:function(e,t){var r=(0,_xml.getAllTextContent)(e,!1).replace(/^\s*|\s*$/g,""),i=t[0],n=i.srsName,o=i.srsDimension,a="enu";n&&(a=(0,_proj.get)(n).getAxisOrientation());var s,l,u,p=r.split(/\s+/),m=2;e.getAttribute("srsDimension")?m=(0,_xsd.readNonNegativeIntegerString)(e.getAttribute("srsDimension")):e.getAttribute("dimension")?m=(0,_xsd.readNonNegativeIntegerString)(e.getAttribute("dimension")):e.parentNode.getAttribute("srsDimension")?m=(0,_xsd.readNonNegativeIntegerString)(e.parentNode.getAttribute("srsDimension")):o&&(m=(0,_xsd.readNonNegativeIntegerString)(o));for(var _=[],c=0,d=p.length;c<d;c+=m)s=parseFloat(p[c]),l=parseFloat(p[c+1]),u=3===m?parseFloat(p[c+2]):0,"en"===a.substr(0,2)?_.push(s,l,u):_.push(l,s,u);return _}},{key:"writePos_",value:function(e,t,r){var i=r[r.length-1],n=i.hasZ,o=n?"3":"2";e.setAttribute("srsDimension",o);var a=i.srsName,s="enu";a&&(s=(0,_proj.get)(a).getAxisOrientation());var l,u=t.getCoordinates();(l="en"===s.substr(0,2)?u[0]+" "+u[1]:u[1]+" "+u[0],n)&&(l+=" "+(u[2]||0));(0,_xsd.writeStringTextNode)(e,l)}},{key:"getCoords_",value:function(e,t,r){var i="enu";t&&(i=(0,_proj.get)(t).getAxisOrientation());var n="en"===i.substr(0,2)?e[0]+" "+e[1]:e[1]+" "+e[0];r&&(n+=" "+(e[2]||0));return n}},{key:"writePosList_",value:function(e,t,r){var i=r[r.length-1],n=i.hasZ,o=n?"3":"2";e.setAttribute("srsDimension",o);for(var a,s=i.srsName,l=t.getCoordinates(),u=l.length,p=new Array(u),m=0;m<u;++m)a=l[m],p[m]=this.getCoords_(a,s,n);(0,_xsd.writeStringTextNode)(e,p.join(" "))}},{key:"writePoint",value:function(e,t,r){var i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);var n=(0,_xml.createElementNS)(e.namespaceURI,"pos");e.appendChild(n),this.writePos_(n,t,r)}},{key:"writeEnvelope",value:function(e,t,r){var i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);var n=[t[0]+" "+t[1],t[2]+" "+t[3]];(0,_xml.pushSerializeAndPop)({node:e},this.ENVELOPE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,n,r,["lowerCorner","upperCorner"],this)}},{key:"writeLinearRing",value:function(e,t,r){var i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);var n=(0,_xml.createElementNS)(e.namespaceURI,"posList");e.appendChild(n),this.writePosList_(n,t,r)}},{key:"RING_NODE_FACTORY_",value:function(e,t,r){var i=t[t.length-1],n=i.node,o=i.exteriorWritten;return void 0===o&&(i.exteriorWritten=!0),(0,_xml.createElementNS)(n.namespaceURI,void 0!==o?"interior":"exterior")}},{key:"writeSurfaceOrPolygon",value:function(e,t,r){var i=r[r.length-1],n=i.hasZ,o=i.srsName;if("PolygonPatch"!==e.nodeName&&o&&e.setAttribute("srsName",o),"Polygon"===e.nodeName||"PolygonPatch"===e.nodeName){var a=t.getLinearRings();(0,_xml.pushSerializeAndPop)({node:e,hasZ:n,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,r,void 0,this)}else if("Surface"===e.nodeName){var s=(0,_xml.createElementNS)(e.namespaceURI,"patches");e.appendChild(s),this.writeSurfacePatches_(s,t,r)}}},{key:"writeCurveOrLineString",value:function(e,t,r){var i=r[r.length-1].srsName;if("LineStringSegment"!==e.nodeName&&i&&e.setAttribute("srsName",i),"LineString"===e.nodeName||"LineStringSegment"===e.nodeName){var n=(0,_xml.createElementNS)(e.namespaceURI,"posList");e.appendChild(n),this.writePosList_(n,t,r)}else if("Curve"===e.nodeName){var o=(0,_xml.createElementNS)(e.namespaceURI,"segments");e.appendChild(o),this.writeCurveSegments_(o,t,r)}}},{key:"writeMultiSurfaceOrPolygon",value:function(e,t,r){var i=r[r.length-1],n=i.hasZ,o=i.srsName,a=i.surface;o&&e.setAttribute("srsName",o);var s=t.getPolygons();(0,_xml.pushSerializeAndPop)({node:e,hasZ:n,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,s,r,void 0,this)}},{key:"writeMultiPoint",value:function(e,t,r){var i=r[r.length-1],n=i.srsName,o=i.hasZ;n&&e.setAttribute("srsName",n);var a=t.getPoints();(0,_xml.pushSerializeAndPop)({node:e,hasZ:o,srsName:n},this.POINTMEMBER_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)("pointMember"),a,r,void 0,this)}},{key:"writeMultiCurveOrLineString",value:function(e,t,r){var i=r[r.length-1],n=i.hasZ,o=i.srsName,a=i.curve;o&&e.setAttribute("srsName",o);var s=t.getLineStrings();(0,_xml.pushSerializeAndPop)({node:e,hasZ:n,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,s,r,void 0,this)}},{key:"writeRing",value:function(e,t,r){var i=(0,_xml.createElementNS)(e.namespaceURI,"LinearRing");e.appendChild(i),this.writeLinearRing(i,t,r)}},{key:"writeSurfaceOrPolygonMember",value:function(e,t,r){var i=this.GEOMETRY_NODE_FACTORY_(t,r);i&&(e.appendChild(i),this.writeSurfaceOrPolygon(i,t,r))}},{key:"writePointMember",value:function(e,t,r){var i=(0,_xml.createElementNS)(e.namespaceURI,"Point");e.appendChild(i),this.writePoint(i,t,r)}},{key:"writeLineStringOrCurveMember",value:function(e,t,r){var i=this.GEOMETRY_NODE_FACTORY_(t,r);i&&(e.appendChild(i),this.writeCurveOrLineString(i,t,r))}},{key:"writeSurfacePatches_",value:function(e,t,r){var i=(0,_xml.createElementNS)(e.namespaceURI,"PolygonPatch");e.appendChild(i),this.writeSurfaceOrPolygon(i,t,r)}},{key:"writeCurveSegments_",value:function(e,t,r){var i=(0,_xml.createElementNS)(e.namespaceURI,"LineStringSegment");e.appendChild(i),this.writeCurveOrLineString(i,t,r)}},{key:"writeGeometryElement",value:function(e,t,r){var i,n=r[r.length-1],o=Object.assign({},n);o.node=e,i=Array.isArray(t)?(0,_Feature.transformExtentWithOptions)(t,n):(0,_Feature.transformGeometryWithOptions)(t,!0,n),(0,_xml.pushSerializeAndPop)(o,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[i],r,void 0,this)}},{key:"writeFeatureElement",value:function(e,t,r){var i=t.getId();i&&e.setAttribute("fid",i);var n=r[r.length-1],o=n.featureNS,a=t.getGeometryName();n.serializers||(n.serializers={},n.serializers[o]={});var s=[],l=[];if(t.hasProperties()){var u=t.getProperties();for(var p in u){var m=u[p];null!==m&&(s.push(p),l.push(m),p==a||"function"==typeof m.getSimplifiedGeometry?p in n.serializers[o]||(n.serializers[o][p]=(0,_xml.makeChildAppender)(this.writeGeometryElement,this)):p in n.serializers[o]||(n.serializers[o][p]=(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)))}}var _=Object.assign({},n);_.node=e,(0,_xml.pushSerializeAndPop)(_,n.serializers,(0,_xml.makeSimpleNodeFactory)(void 0,o),l,r,s)}},{key:"writeFeatureMembers_",value:function(e,t,r){var i=r[r.length-1],n=i.featureType,o=i.featureNS,a={};a[o]={},a[o][n]=(0,_xml.makeChildAppender)(this.writeFeatureElement,this);var s=Object.assign({},i);s.node=e,(0,_xml.pushSerializeAndPop)(s,a,(0,_xml.makeSimpleNodeFactory)(n,o),t,r)}},{key:"MULTIGEOMETRY_MEMBER_NODE_FACTORY_",value:function(e,t,r){var i=t[t.length-1].node;return(0,_xml.createElementNS)(this.namespace,MULTIGEOMETRY_TO_MEMBER_NODENAME[i.nodeName])}},{key:"GEOMETRY_NODE_FACTORY_",value:function(e,t,r){var i=t[t.length-1],n=i.multiSurface,o=i.surface,a=i.curve,s=i.multiCurve;return Array.isArray(e)?r="Envelope":"MultiPolygon"===(r=e.getType())&&!0===n?r="MultiSurface":"Polygon"===r&&!0===o?r="Surface":"LineString"===r&&!0===a?r="Curve":"MultiLineString"===r&&!0===s&&(r="MultiCurve"),(0,_xml.createElementNS)(this.namespace,r)}},{key:"writeGeometryNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,_xml.createElementNS)(this.namespace,"geom"),i={node:r,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&Object.assign(i,t),this.writeGeometryElement(r,e,[i]),r}},{key:"writeFeaturesNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,_xml.createElementNS)(this.namespace,"featureMembers");r.setAttributeNS(_xml.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation);var i={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return t&&Object.assign(i,t),this.writeFeatureMembers_(r,e,[i]),r}}])}();GML3.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:(0,_xml.makeReplacer)(GML3.prototype.readFlatPos),posList:(0,_xml.makeReplacer)(GML3.prototype.readFlatPosList),coordinates:(0,_xml.makeReplacer)(_GML.default.prototype.readFlatCoordinates)}},GML3.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:GML3.prototype.interiorParser,exterior:GML3.prototype.exteriorParser}},GML3.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readPoint),MultiPoint:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readMultiPoint),LineString:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readLineString),MultiLineString:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readMultiLineString),LinearRing:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readLinearRing),Polygon:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readPolygon),MultiPolygon:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readMultiPolygon),Surface:(0,_xml.makeReplacer)(GML3.prototype.readSurface),MultiSurface:(0,_xml.makeReplacer)(GML3.prototype.readMultiSurface),Curve:(0,_xml.makeReplacer)(GML3.prototype.readCurve),MultiCurve:(0,_xml.makeReplacer)(GML3.prototype.readMultiCurve),Envelope:(0,_xml.makeReplacer)(GML3.prototype.readEnvelope)}},GML3.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:(0,_xml.makeArrayPusher)(GML3.prototype.curveMemberParser),curveMembers:(0,_xml.makeArrayPusher)(GML3.prototype.curveMemberParser)}},GML3.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:(0,_xml.makeArrayPusher)(GML3.prototype.surfaceMemberParser),surfaceMembers:(0,_xml.makeArrayPusher)(GML3.prototype.surfaceMemberParser)}},GML3.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:(0,_xml.makeArrayPusher)(_GMLBase2.default.prototype.readLineString),Curve:(0,_xml.makeArrayPusher)(GML3.prototype.readCurve)}},GML3.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:(0,_xml.makeArrayPusher)(_GMLBase2.default.prototype.readPolygon),Surface:(0,_xml.makeArrayPusher)(GML3.prototype.readSurface)}},GML3.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:(0,_xml.makeReplacer)(GML3.prototype.readPatch)}},GML3.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:(0,_xml.makeReplacer)(GML3.prototype.readSegment)}},GML3.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:(0,_xml.makeArrayPusher)(GML3.prototype.readFlatPosList),upperCorner:(0,_xml.makeArrayPusher)(GML3.prototype.readFlatPosList)}},GML3.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:(0,_xml.makeReplacer)(GML3.prototype.readPolygonPatch)}},GML3.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:(0,_xml.makeArrayExtender)(GML3.prototype.readLineStringSegment)}},_GMLBase2.default.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:(0,_xml.makeReplacer)(_GMLBase2.default.prototype.readFlatLinearRing),Ring:(0,_xml.makeReplacer)(GML3.prototype.readFlatCurveRing)}},GML3.prototype.writeFeatures,GML3.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:(0,_xml.makeChildAppender)(GML3.prototype.writeRing),interior:(0,_xml.makeChildAppender)(GML3.prototype.writeRing)}},GML3.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),upperCorner:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)}},GML3.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:(0,_xml.makeChildAppender)(GML3.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,_xml.makeChildAppender)(GML3.prototype.writeSurfaceOrPolygonMember)}},GML3.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:(0,_xml.makeChildAppender)(GML3.prototype.writePointMember)}},GML3.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:(0,_xml.makeChildAppender)(GML3.prototype.writeLineStringOrCurveMember),curveMember:(0,_xml.makeChildAppender)(GML3.prototype.writeLineStringOrCurveMember)}},GML3.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:(0,_xml.makeChildAppender)(GML3.prototype.writeCurveOrLineString),MultiCurve:(0,_xml.makeChildAppender)(GML3.prototype.writeMultiCurveOrLineString),Point:(0,_xml.makeChildAppender)(GML3.prototype.writePoint),MultiPoint:(0,_xml.makeChildAppender)(GML3.prototype.writeMultiPoint),LineString:(0,_xml.makeChildAppender)(GML3.prototype.writeCurveOrLineString),MultiLineString:(0,_xml.makeChildAppender)(GML3.prototype.writeMultiCurveOrLineString),LinearRing:(0,_xml.makeChildAppender)(GML3.prototype.writeLinearRing),Polygon:(0,_xml.makeChildAppender)(GML3.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,_xml.makeChildAppender)(GML3.prototype.writeMultiSurfaceOrPolygon),Surface:(0,_xml.makeChildAppender)(GML3.prototype.writeSurfaceOrPolygon),MultiSurface:(0,_xml.makeChildAppender)(GML3.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,_xml.makeChildAppender)(GML3.prototype.writeEnvelope)}};var _default=exports.default=GML3;

},{"../array.js":110,"../extent.js":142,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPolygon.js":209,"../geom/Polygon.js":211,"../proj.js":283,"../xml.js":418,"./Feature.js":147,"./GML2.js":149,"./GMLBase.js":152,"./xsd.js":199}],151:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _GML2=_interopRequireDefault(require("./GML2.js")),_GML3=_interopRequireDefault(require("./GML3.js")),_GMLBase=_interopRequireDefault(require("./GMLBase.js")),_xml=require("../xml.js"),_xsd=require("../format/xsd.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var p=Object.getOwnPropertyDescriptor(o,t);return p.get?p.get.call(arguments.length<3?e:r):p.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GML32=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e=e||{}])).schemaLocation=e.schemaLocation?e.schemaLocation:r.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",r}return _inherits(t,_GML3["default"]),_createClass(t,[{key:"writeGeometryElement",value:function(e,r,o){var p=o[o.length-1];o[o.length-1]=Object.assign({multiCurve:!0,multiSurface:!0},p),_get(_getPrototypeOf(t.prototype),"writeGeometryElement",this).call(this,e,r,o)}}])}();GML32.prototype.namespace="http://www.opengis.net/gml/3.2",GML32.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:(0,_xml.makeReplacer)(_GML3.default.prototype.readFlatPos),posList:(0,_xml.makeReplacer)(_GML3.default.prototype.readFlatPosList),coordinates:(0,_xml.makeReplacer)(_GML2.default.prototype.readFlatCoordinates)}},GML32.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:_GML3.default.prototype.interiorParser,exterior:_GML3.default.prototype.exteriorParser}},GML32.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readPoint),MultiPoint:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readMultiPoint),LineString:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readLineString),MultiLineString:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readMultiLineString),LinearRing:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readLinearRing),Polygon:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readPolygon),MultiPolygon:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readMultiPolygon),Surface:(0,_xml.makeReplacer)(GML32.prototype.readSurface),MultiSurface:(0,_xml.makeReplacer)(_GML3.default.prototype.readMultiSurface),Curve:(0,_xml.makeReplacer)(GML32.prototype.readCurve),MultiCurve:(0,_xml.makeReplacer)(_GML3.default.prototype.readMultiCurve),Envelope:(0,_xml.makeReplacer)(GML32.prototype.readEnvelope)}},GML32.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:(0,_xml.makeArrayPusher)(_GML3.default.prototype.curveMemberParser),curveMembers:(0,_xml.makeArrayPusher)(_GML3.default.prototype.curveMemberParser)}},GML32.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:(0,_xml.makeArrayPusher)(_GML3.default.prototype.surfaceMemberParser),surfaceMembers:(0,_xml.makeArrayPusher)(_GML3.default.prototype.surfaceMemberParser)}},GML32.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.readLineString),Curve:(0,_xml.makeArrayPusher)(_GML3.default.prototype.readCurve)}},GML32.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.readPolygon),Surface:(0,_xml.makeArrayPusher)(_GML3.default.prototype.readSurface)}},GML32.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:(0,_xml.makeReplacer)(_GML3.default.prototype.readPatch)}},GML32.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:(0,_xml.makeReplacer)(_GML3.default.prototype.readSegment)}},GML32.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:(0,_xml.makeArrayPusher)(_GML3.default.prototype.readFlatPosList),upperCorner:(0,_xml.makeArrayPusher)(_GML3.default.prototype.readFlatPosList)}},GML32.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:(0,_xml.makeReplacer)(_GML3.default.prototype.readPolygonPatch)}},GML32.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:(0,_xml.makeArrayExtender)(_GML3.default.prototype.readLineStringSegment)}},GML32.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.pointMemberParser),pointMembers:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.pointMemberParser)}},GML32.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.lineStringMemberParser),lineStringMembers:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.lineStringMemberParser)}},GML32.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.polygonMemberParser),polygonMembers:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.polygonMemberParser)}},GML32.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.readFlatCoordinatesFromNode)}},GML32.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.readLineString)}},GML32.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.readPolygon)}},GML32.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:(0,_xml.makeReplacer)(_GMLBase.default.prototype.readFlatLinearRing),Ring:(0,_xml.makeReplacer)(GML32.prototype.readFlatCurveRing)}},GML32.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeRing),interior:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeRing)}},GML32.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),upperCorner:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)}},GML32.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeSurfaceOrPolygonMember)}},GML32.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:(0,_xml.makeChildAppender)(_GML3.default.prototype.writePointMember)}},GML32.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeLineStringOrCurveMember),curveMember:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeLineStringOrCurveMember)}},GML32.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeCurveOrLineString),MultiCurve:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeMultiCurveOrLineString),Point:(0,_xml.makeChildAppender)(GML32.prototype.writePoint),MultiPoint:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeMultiPoint),LineString:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeCurveOrLineString),MultiLineString:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeMultiCurveOrLineString),LinearRing:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeLinearRing),Polygon:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeMultiSurfaceOrPolygon),Surface:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeSurfaceOrPolygon),MultiSurface:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,_xml.makeChildAppender)(_GML3.default.prototype.writeEnvelope)}};var _default=exports.default=GML32;

},{"../format/xsd.js":199,"../xml.js":418,"./GML2.js":149,"./GML3.js":150,"./GMLBase.js":152}],152:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.GMLNS=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_Geometry=_interopRequireDefault(require("../geom/Geometry.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_LinearRing=_interopRequireDefault(require("../geom/LinearRing.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_XMLFeature2=_interopRequireDefault(require("./XMLFeature.js")),_array=require("../array.js"),_xml=require("../xml.js"),_proj=require("../proj.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GMLNS=exports.GMLNS="http://www.opengis.net/gml",ONLY_WHITESPACE_RE=/^\s*$/,GMLBase=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).featureType=e.featureType,r.featureNS=e.featureNS,r.srsName=e.srsName,r.schemaLocation="",r.FEATURE_COLLECTION_PARSERS={},r.FEATURE_COLLECTION_PARSERS[r.namespace]={featureMember:(0,_xml.makeArrayPusher)(r.readFeaturesInternal),featureMembers:(0,_xml.makeReplacer)(r.readFeaturesInternal)},r.supportedMediaTypes=["application/gml+xml"],r}return _inherits(t,_XMLFeature2["default"]),_createClass(t,[{key:"readFeaturesInternal",value:function(e,t){var r=e.localName,n=null;if("FeatureCollection"==r)n=(0,_xml.pushParseAndPop)([],this.FEATURE_COLLECTION_PARSERS,e,t,this);else if("featureMembers"==r||"featureMember"==r||"member"==r){var o=t[0],i=o.featureType,a=o.featureNS;if(!i&&e.childNodes){i=[],a={};for(var u=0,s=e.childNodes.length;u<s;++u){var l=e.childNodes[u];if(1===l.nodeType){var p=l.nodeName.split(":").pop();if(!i.includes(p)){var f="",m=0,_=l.namespaceURI;for(var y in a){if(a[y]===_){f=y;break}++m}f||(a[f="p"+m]=_),i.push(f+":"+p)}}}"featureMember"!=r&&(o.featureType=i,o.featureNS=a)}if("string"==typeof a){var d=a;(a={}).p0=d}var c={},h=Array.isArray(i)?i:[i];for(var P in a){for(var R={},g=0,E=h.length;g<E;++g){(h[g].includes(":")?h[g].split(":")[0]:"p0")===P&&(R[h[g].split(":").pop()]="featureMembers"==r?(0,_xml.makeArrayPusher)(this.readFeatureElement,this):(0,_xml.makeReplacer)(this.readFeatureElement,this))}c[a[P]]=R}n="featureMember"==r||"member"==r?(0,_xml.pushParseAndPop)(void 0,c,e,t):(0,_xml.pushParseAndPop)([],c,e,t)}return null===n&&(n=[]),n}},{key:"readGeometryOrExtent",value:function(e,t){var r=t[0];return r.srsName=e.firstElementChild.getAttribute("srsName"),r.srsDimension=e.firstElementChild.getAttribute("srsDimension"),(0,_xml.pushParseAndPop)(null,this.GEOMETRY_PARSERS,e,t,this)}},{key:"readExtentElement",value:function(e,t){var r=t[0],n=this.readGeometryOrExtent(e,t);return n?(0,_Feature2.transformExtentWithOptions)(n,r):void 0}},{key:"readGeometryElement",value:function(e,t){var r=t[0],n=this.readGeometryOrExtent(e,t);return n?(0,_Feature2.transformGeometryWithOptions)(n,!1,r):void 0}},{key:"readFeatureElementInternal",value:function(e,t,r){for(var n,o={},i=e.firstElementChild;i;i=i.nextElementSibling){var a=void 0,u=i.localName;0===i.childNodes.length||1===i.childNodes.length&&(3===i.firstChild.nodeType||4===i.firstChild.nodeType)?(a=(0,_xml.getAllTextContent)(i,!1),ONLY_WHITESPACE_RE.test(a)&&(a=void 0)):(r&&(a="boundedBy"===u?this.readExtentElement(i,t):this.readGeometryElement(i,t)),a?"boundedBy"!==u&&(n=u):a=this.readFeatureElementInternal(i,t,!1));var s=i.attributes.length;if(s>0&&!(a instanceof _Geometry.default)){a={_content_:a};for(var l=0;l<s;l++){a[i.attributes[l].name]=i.attributes[l].value}}o[u]?(o[u]instanceof Array||(o[u]=[o[u]]),o[u].push(a)):o[u]=a}if(!r)return o;var p=new _Feature.default(o);n&&p.setGeometryName(n);var f=e.getAttribute("fid")||(0,_xml.getAttributeNS)(e,this.namespace,"id");return f&&p.setId(f),p}},{key:"readFeatureElement",value:function(e,t){return this.readFeatureElementInternal(e,t,!0)}},{key:"readPoint",value:function(e,t){var r=this.readFlatCoordinatesFromNode(e,t);if(r)return new _Point.default(r,"XYZ")}},{key:"readMultiPoint",value:function(e,t){var r=(0,_xml.pushParseAndPop)([],this.MULTIPOINT_PARSERS,e,t,this);if(r)return new _MultiPoint.default(r)}},{key:"readMultiLineString",value:function(e,t){var r=(0,_xml.pushParseAndPop)([],this.MULTILINESTRING_PARSERS,e,t,this);if(r)return new _MultiLineString.default(r)}},{key:"readMultiPolygon",value:function(e,t){var r=(0,_xml.pushParseAndPop)([],this.MULTIPOLYGON_PARSERS,e,t,this);if(r)return new _MultiPolygon.default(r)}},{key:"pointMemberParser",value:function(e,t){(0,_xml.parseNode)(this.POINTMEMBER_PARSERS,e,t,this)}},{key:"lineStringMemberParser",value:function(e,t){(0,_xml.parseNode)(this.LINESTRINGMEMBER_PARSERS,e,t,this)}},{key:"polygonMemberParser",value:function(e,t){(0,_xml.parseNode)(this.POLYGONMEMBER_PARSERS,e,t,this)}},{key:"readLineString",value:function(e,t){var r=this.readFlatCoordinatesFromNode(e,t);if(r)return new _LineString.default(r,"XYZ")}},{key:"readFlatLinearRing",value:function(e,t){var r=(0,_xml.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this);if(r)return r}},{key:"readLinearRing",value:function(e,t){var r=this.readFlatCoordinatesFromNode(e,t);if(r)return new _LinearRing.default(r,"XYZ")}},{key:"readPolygon",value:function(e,t){var r=(0,_xml.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this);if(r&&r[0]){var n,o,i=r[0],a=[i.length];for(n=1,o=r.length;n<o;++n)(0,_array.extend)(i,r[n]),a.push(i.length);return new _Polygon.default(i,"XYZ",a)}}},{key:"readFlatCoordinatesFromNode",value:function(e,t){return(0,_xml.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}},{key:"readGeometryFromNode",value:function(e,t){var r=this.readGeometryElement(e,[this.getReadOptions(e,t||{})]);return r||null}},{key:"readFeaturesFromNode",value:function(e,t){var r={featureType:this.featureType,featureNS:this.featureNS};return r&&Object.assign(r,this.getReadOptions(e,t)),this.readFeaturesInternal(e,[r])||[]}},{key:"readProjectionFromNode",value:function(e){return(0,_proj.get)(this.srsName?this.srsName:e.firstElementChild.getAttribute("srsName"))}}])}();GMLBase.prototype.namespace=GMLNS,GMLBase.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},GMLBase.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},GMLBase.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},GMLBase.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:(0,_xml.makeArrayPusher)(GMLBase.prototype.pointMemberParser),pointMembers:(0,_xml.makeArrayPusher)(GMLBase.prototype.pointMemberParser)}},GMLBase.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:(0,_xml.makeArrayPusher)(GMLBase.prototype.lineStringMemberParser),lineStringMembers:(0,_xml.makeArrayPusher)(GMLBase.prototype.lineStringMemberParser)}},GMLBase.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:(0,_xml.makeArrayPusher)(GMLBase.prototype.polygonMemberParser),polygonMembers:(0,_xml.makeArrayPusher)(GMLBase.prototype.polygonMemberParser)}},GMLBase.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:(0,_xml.makeArrayPusher)(GMLBase.prototype.readFlatCoordinatesFromNode)}},GMLBase.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:(0,_xml.makeArrayPusher)(GMLBase.prototype.readLineString)}},GMLBase.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:(0,_xml.makeArrayPusher)(GMLBase.prototype.readPolygon)}},GMLBase.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:(0,_xml.makeReplacer)(GMLBase.prototype.readFlatLinearRing)}};var _default=exports.default=GMLBase;

},{"../Feature.js":82,"../array.js":110,"../geom/Geometry.js":203,"../geom/LineString.js":205,"../geom/LinearRing.js":206,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../proj.js":283,"../xml.js":418,"./Feature.js":147,"./XMLFeature.js":171}],153:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_XMLFeature2=_interopRequireDefault(require("./XMLFeature.js")),_xml=require("../xml.js"),_proj=require("../proj.js"),_xsd=require("./xsd.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var NAMESPACE_URIS=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],SCHEMA_LOCATION="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",FEATURE_READER={rte:readRte,trk:readTrk,wpt:readWpt},GPX_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{rte:(0,_xml.makeArrayPusher)(readRte),trk:(0,_xml.makeArrayPusher)(readTrk),wpt:(0,_xml.makeArrayPusher)(readWpt)}),LINK_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{text:(0,_xml.makeObjectPropertySetter)(_xsd.readString,"linkText"),type:(0,_xml.makeObjectPropertySetter)(_xsd.readString,"linkType")}),AUTHOR_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),email:parseEmail,link:parseLink}),METADATA_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),desc:(0,_xml.makeObjectPropertySetter)(_xsd.readString),author:(0,_xml.makeObjectPropertySetter)(readAuthor),copyright:(0,_xml.makeObjectPropertySetter)(readCopyright),link:parseLink,time:(0,_xml.makeObjectPropertySetter)(_xsd.readDateTime),keywords:(0,_xml.makeObjectPropertySetter)(_xsd.readString),bounds:parseBounds,extensions:parseExtensions}),COPYRIGHT_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{year:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),license:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),GPX_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{rte:(0,_xml.makeChildAppender)(writeRte),trk:(0,_xml.makeChildAppender)(writeTrk),wpt:(0,_xml.makeChildAppender)(writeWpt)}),GPX=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).dataProjection=(0,_proj.get)("EPSG:4326"),r.readExtensions_=e.readExtensions,r}return _inherits(t,_XMLFeature2["default"]),_createClass(t,[{key:"handleReadExtensions_",value:function(e){e||(e=[]);for(var t=0,r=e.length;t<r;++t){var a=e[t];if(this.readExtensions_){var n=a.get("extensionsNode_")||null;this.readExtensions_(a,n)}a.set("extensionsNode_",void 0)}}},{key:"readMetadata",value:function(e){return e?"string"==typeof e?this.readMetadataFromDocument((0,_xml.parse)(e)):(0,_xml.isDocument)(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}},{key:"readMetadataFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){var r=this.readMetadataFromNode(t);if(r)return r}return null}},{key:"readMetadataFromNode",value:function(e){if(!NAMESPACE_URIS.includes(e.namespaceURI))return null;for(var t=e.firstElementChild;t;t=t.nextElementSibling)if(NAMESPACE_URIS.includes(t.namespaceURI)&&"metadata"===t.localName)return(0,_xml.pushParseAndPop)({},METADATA_PARSERS,t,[]);return null}},{key:"readFeatureFromNode",value:function(e,t){if(!NAMESPACE_URIS.includes(e.namespaceURI))return null;var r=FEATURE_READER[e.localName];if(!r)return null;var a=r(e,[this.getReadOptions(e,t)]);return a?(this.handleReadExtensions_([a]),a):null}},{key:"readFeaturesFromNode",value:function(e,t){if(!NAMESPACE_URIS.includes(e.namespaceURI))return[];if("gpx"==e.localName){var r=(0,_xml.pushParseAndPop)([],GPX_PARSERS,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}},{key:"writeFeaturesNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,_xml.createElementNS)("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",_xml.XML_SCHEMA_INSTANCE_URI),r.setAttributeNS(_xml.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",SCHEMA_LOCATION),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),(0,_xml.pushSerializeAndPop)({node:r},GPX_SERIALIZERS,GPX_NODE_FACTORY,e,[t]),r}}])}(),RTE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),cmt:(0,_xml.makeObjectPropertySetter)(_xsd.readString),desc:(0,_xml.makeObjectPropertySetter)(_xsd.readString),src:(0,_xml.makeObjectPropertySetter)(_xsd.readString),link:parseLink,number:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),extensions:parseExtensions,type:(0,_xml.makeObjectPropertySetter)(_xsd.readString),rtept:parseRtePt}),RTEPT_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ele:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),time:(0,_xml.makeObjectPropertySetter)(_xsd.readDateTime)}),TRK_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),cmt:(0,_xml.makeObjectPropertySetter)(_xsd.readString),desc:(0,_xml.makeObjectPropertySetter)(_xsd.readString),src:(0,_xml.makeObjectPropertySetter)(_xsd.readString),link:parseLink,number:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),type:(0,_xml.makeObjectPropertySetter)(_xsd.readString),extensions:parseExtensions,trkseg:parseTrkSeg}),TRKSEG_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{trkpt:parseTrkPt}),TRKPT_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ele:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),time:(0,_xml.makeObjectPropertySetter)(_xsd.readDateTime)}),WPT_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ele:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),time:(0,_xml.makeObjectPropertySetter)(_xsd.readDateTime),magvar:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),geoidheight:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),cmt:(0,_xml.makeObjectPropertySetter)(_xsd.readString),desc:(0,_xml.makeObjectPropertySetter)(_xsd.readString),src:(0,_xml.makeObjectPropertySetter)(_xsd.readString),link:parseLink,sym:(0,_xml.makeObjectPropertySetter)(_xsd.readString),type:(0,_xml.makeObjectPropertySetter)(_xsd.readString),fix:(0,_xml.makeObjectPropertySetter)(_xsd.readString),sat:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),hdop:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),vdop:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),pdop:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),ageofdgpsdata:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),dgpsid:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),extensions:parseExtensions}),LINK_SEQUENCE=["text","type"],LINK_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{text:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),type:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)}),RTE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["name","cmt","desc","src","link","number","type","rtept"]),RTE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{name:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),cmt:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),desc:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),src:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),link:(0,_xml.makeChildAppender)(writeLink),number:(0,_xml.makeChildAppender)(_xsd.writeNonNegativeIntegerTextNode),type:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),rtept:(0,_xml.makeArraySerializer)((0,_xml.makeChildAppender)(writeWptType))}),RTEPT_TYPE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["ele","time"]),TRK_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["name","cmt","desc","src","link","number","type","trkseg"]),TRK_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{name:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),cmt:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),desc:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),src:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),link:(0,_xml.makeChildAppender)(writeLink),number:(0,_xml.makeChildAppender)(_xsd.writeNonNegativeIntegerTextNode),type:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),trkseg:(0,_xml.makeArraySerializer)((0,_xml.makeChildAppender)(writeTrkSeg))}),TRKSEG_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("trkpt"),TRKSEG_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{trkpt:(0,_xml.makeChildAppender)(writeWptType)}),WPT_TYPE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),WPT_TYPE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ele:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),time:(0,_xml.makeChildAppender)(_xsd.writeDateTimeTextNode),magvar:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),geoidheight:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),name:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),cmt:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),desc:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),src:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),link:(0,_xml.makeChildAppender)(writeLink),sym:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),type:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),fix:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),sat:(0,_xml.makeChildAppender)(_xsd.writeNonNegativeIntegerTextNode),hdop:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),vdop:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),pdop:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),ageofdgpsdata:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),dgpsid:(0,_xml.makeChildAppender)(_xsd.writeNonNegativeIntegerTextNode)}),GEOMETRY_TYPE_TO_NODENAME={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function GPX_NODE_FACTORY(e,t,r){var a=e.getGeometry();if(a){var n=GEOMETRY_TYPE_TO_NODENAME[a.getType()];if(n){var i=t[t.length-1].node;return(0,_xml.createElementNS)(i.namespaceURI,n)}}}function appendCoordinate(e,t,r,a){return e.push(parseFloat(r.getAttribute("lon")),parseFloat(r.getAttribute("lat"))),"ele"in a?(e.push(a.ele),delete a.ele,t.hasZ=!0):e.push(0),"time"in a?(e.push(a.time),delete a.time,t.hasM=!0):e.push(0),e}function applyLayoutOptions(e,t,r){var a="XY",n=2;if(e.hasZ&&e.hasM?(a="XYZM",n=4):e.hasZ?(a="XYZ",n=3):e.hasM&&(a="XYM",n=3),4!==n){for(var i=0,o=t.length/4;i<o;i++)t[i*n]=t[4*i],t[i*n+1]=t[4*i+1],e.hasZ&&(t[i*n+2]=t[4*i+2]),e.hasM&&(t[i*n+2]=t[4*i+3]);if(t.length=t.length/4*n,r)for(var l=0,d=r.length;l<d;l++)r[l]=r[l]/4*n}return a}function readAuthor(e,t){var r=(0,_xml.pushParseAndPop)({},AUTHOR_PARSERS,e,t);if(r)return r}function readCopyright(e,t){var r=(0,_xml.pushParseAndPop)({},COPYRIGHT_PARSERS,e,t);if(r){var a=e.getAttribute("author");return null!==a&&(r.author=a),r}}function parseBounds(e,t){var r=t[t.length-1],a=e.getAttribute("minlat"),n=e.getAttribute("minlon"),i=e.getAttribute("maxlat"),o=e.getAttribute("maxlon");null!==n&&null!==a&&null!==o&&null!==i&&(r.bounds=[[parseFloat(n),parseFloat(a)],[parseFloat(o),parseFloat(i)]])}function parseEmail(e,t){var r=t[t.length-1],a=e.getAttribute("id"),n=e.getAttribute("domain");null!==a&&null!==n&&(r.email="".concat(a,"@").concat(n))}function parseLink(e,t){var r=t[t.length-1],a=e.getAttribute("href");null!==a&&(r.link=a),(0,_xml.parseNode)(LINK_PARSERS,e,t)}function parseExtensions(e,t){t[t.length-1].extensionsNode_=e}function parseRtePt(e,t){var r=(0,_xml.pushParseAndPop)({},RTEPT_PARSERS,e,t);if(r){var a=t[t.length-1];appendCoordinate(a.flatCoordinates,a.layoutOptions,e,r)}}function parseTrkPt(e,t){var r=(0,_xml.pushParseAndPop)({},TRKPT_PARSERS,e,t);if(r){var a=t[t.length-1];appendCoordinate(a.flatCoordinates,a.layoutOptions,e,r)}}function parseTrkSeg(e,t){var r=t[t.length-1];(0,_xml.parseNode)(TRKSEG_PARSERS,e,t);var a=r.flatCoordinates;r.ends.push(a.length)}function readRte(e,t){var r=t[0],a=(0,_xml.pushParseAndPop)({flatCoordinates:[],layoutOptions:{}},RTE_PARSERS,e,t);if(a){var n=a.flatCoordinates;delete a.flatCoordinates;var i=a.layoutOptions;delete a.layoutOptions;var o=applyLayoutOptions(i,n),l=new _LineString.default(n,o);(0,_Feature2.transformGeometryWithOptions)(l,!1,r);var d=new _Feature.default(l);return d.setProperties(a,!0),d}}function readTrk(e,t){var r=t[0],a=(0,_xml.pushParseAndPop)({flatCoordinates:[],ends:[],layoutOptions:{}},TRK_PARSERS,e,t);if(a){var n=a.flatCoordinates;delete a.flatCoordinates;var i=a.ends;delete a.ends;var o=a.layoutOptions;delete a.layoutOptions;var l=applyLayoutOptions(o,n,i),d=new _MultiLineString.default(n,l,i);(0,_Feature2.transformGeometryWithOptions)(d,!1,r);var s=new _Feature.default(d);return s.setProperties(a,!0),s}}function readWpt(e,t){var r=t[0],a=(0,_xml.pushParseAndPop)({},WPT_PARSERS,e,t);if(a){var n={},i=appendCoordinate([],n,e,a),o=applyLayoutOptions(n,i),l=new _Point.default(i,o);(0,_Feature2.transformGeometryWithOptions)(l,!1,r);var d=new _Feature.default(l);return d.setProperties(a,!0),d}}function writeLink(e,t,r){e.setAttribute("href",t);var a=r[r.length-1].properties,n=[a.linkText,a.linkType];(0,_xml.pushSerializeAndPop)({node:e},LINK_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,n,r,LINK_SEQUENCE)}function writeWptType(e,t,r){var a=r[r.length-1],n=a.node.namespaceURI,i=a.properties;switch(e.setAttributeNS(null,"lat",String(t[1])),e.setAttributeNS(null,"lon",String(t[0])),a.geometryLayout){case"XYZM":0!==t[3]&&(i.time=t[3]);case"XYZ":0!==t[2]&&(i.ele=t[2]);break;case"XYM":0!==t[2]&&(i.time=t[2])}var o="rtept"==e.nodeName?RTEPT_TYPE_SEQUENCE[n]:WPT_TYPE_SEQUENCE[n],l=(0,_xml.makeSequence)(i,o);(0,_xml.pushSerializeAndPop)({node:e,properties:i},WPT_TYPE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,l,r,o)}function writeRte(e,t,r){var a=r[0],n=t.getProperties(),i={node:e};i.properties=n;var o=t.getGeometry();if("LineString"==o.getType()){var l=(0,_Feature2.transformGeometryWithOptions)(o,!0,a);i.geometryLayout=l.getLayout(),n.rtept=l.getCoordinates()}var d=r[r.length-1].node,s=RTE_SEQUENCE[d.namespaceURI],p=(0,_xml.makeSequence)(n,s);(0,_xml.pushSerializeAndPop)(i,RTE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,p,r,s)}function writeTrk(e,t,r){var a=r[0],n=t.getProperties(),i={node:e};i.properties=n;var o=t.getGeometry();if("MultiLineString"==o.getType()){var l=(0,_Feature2.transformGeometryWithOptions)(o,!0,a);n.trkseg=l.getLineStrings()}var d=r[r.length-1].node,s=TRK_SEQUENCE[d.namespaceURI],p=(0,_xml.makeSequence)(n,s);(0,_xml.pushSerializeAndPop)(i,TRK_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,p,r,s)}function writeTrkSeg(e,t,r){var a={node:e};a.geometryLayout=t.getLayout(),a.properties={},(0,_xml.pushSerializeAndPop)(a,TRKSEG_SERIALIZERS,TRKSEG_NODE_FACTORY,t.getCoordinates(),r)}function writeWpt(e,t,r){var a=r[0],n=r[r.length-1];n.properties=t.getProperties();var i=t.getGeometry();if("Point"==i.getType()){var o=(0,_Feature2.transformGeometryWithOptions)(i,!0,a);n.geometryLayout=o.getLayout(),writeWptType(e,o.getCoordinates(),r)}}var _default=exports.default=GPX;

},{"../Feature.js":82,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/Point.js":210,"../proj.js":283,"../xml.js":418,"./Feature.js":147,"./XMLFeature.js":171,"./xsd.js":199}],154:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_JSONFeature2=_interopRequireDefault(require("./JSONFeature.js")),_Feature2=_interopRequireDefault(require("../render/Feature.js")),_Feature3=require("./Feature.js"),_deflate=require("../geom/flat/deflate.js"),_SimpleGeometry=require("../geom/SimpleGeometry.js"),_proj=require("../proj.js"),_obj=require("../obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GeoJSON=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).dataProjection=(0,_proj.get)(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(r.defaultFeatureProjection=(0,_proj.get)(e.featureProjection)),e.featureClass&&(r.featureClass=e.featureClass),r.geometryName_=e.geometryName,r.extractGeometryName_=e.extractGeometryName,r.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],r}return _inherits(t,_JSONFeature2["default"]),_createClass(t,[{key:"readFeatureFromObject",value:function(e,t){var r=null,o=readGeometryInternal((r="Feature"===e.type?e:{type:"Feature",geometry:e,properties:null}).geometry,t);if(this.featureClass===_Feature2.default)return(0,_Feature3.createRenderFeature)({geometry:o,id:r.id,properties:r.properties},t);var n=new _Feature.default;return this.geometryName_?n.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&n.setGeometryName(r.geometry_name),n.setGeometry((0,_Feature3.createGeometry)(o,t)),"id"in r&&n.setId(r.id),r.properties&&n.setProperties(r.properties,!0),n}},{key:"readFeaturesFromObject",value:function(e,t){var r=null;if("FeatureCollection"===e.type){r=[];for(var o=e.features,n=0,i=o.length;n<i;++n){var a=this.readFeatureFromObject(o[n],t);a&&r.push(a)}}else r=[this.readFeatureFromObject(e,t)];return r.flat()}},{key:"readGeometryFromObject",value:function(e,t){return readGeometry(e,t)}},{key:"readProjectionFromObject",value:function(e){var t,r=e.crs;if(r)if("name"==r.type)t=(0,_proj.get)(r.properties.name);else{if("EPSG"!==r.type)throw new Error("Unknown SRS type");t=(0,_proj.get)("EPSG:"+r.properties.code)}else t=this.dataProjection;return t}},{key:"writeFeatureObject",value:function(e,t){t=this.adaptOptions(t);var r={type:"Feature",geometry:null,properties:null},o=e.getId();if(void 0!==o&&(r.id=o),!e.hasProperties())return r;var n=e.getProperties(),i=e.getGeometry();return i&&(r.geometry=writeGeometry(i,t),delete n[e.getGeometryName()]),(0,_obj.isEmpty)(n)||(r.properties=n),r}},{key:"writeFeaturesObject",value:function(e,t){t=this.adaptOptions(t);for(var r=[],o=0,n=e.length;o<n;++o)r.push(this.writeFeatureObject(e[o],t));return{type:"FeatureCollection",features:r}}},{key:"writeGeometryObject",value:function(e,t){return writeGeometry(e,this.adaptOptions(t))}}])}();function readGeometryInternal(e,t){if(!e)return null;var r;switch(e.type){case"Point":r=readPointGeometry(e);break;case"LineString":r=readLineStringGeometry(e);break;case"Polygon":r=readPolygonGeometry(e);break;case"MultiPoint":r=readMultiPointGeometry(e);break;case"MultiLineString":r=readMultiLineStringGeometry(e);break;case"MultiPolygon":r=readMultiPolygonGeometry(e);break;case"GeometryCollection":r=readGeometryCollectionGeometry(e);break;default:throw new Error("Unsupported GeoJSON type: "+e.type)}return r}function readGeometry(e,t){var r=readGeometryInternal(e,t);return(0,_Feature3.createGeometry)(r,t)}function readGeometryCollectionGeometry(e,t){return e.geometries.map(function(e){return readGeometryInternal(e,t)})}function readPointGeometry(e){var t=e.coordinates;return{type:"Point",flatCoordinates:t,layout:(0,_SimpleGeometry.getLayoutForStride)(t.length)}}function readLineStringGeometry(e){var t,r=e.coordinates,o=r.flat();return{type:"LineString",flatCoordinates:o,ends:[o.length],layout:(0,_SimpleGeometry.getLayoutForStride)((null===(t=r[0])||void 0===t?void 0:t.length)||2)}}function readMultiLineStringGeometry(e){var t,r=e.coordinates,o=(null===(t=r[0])||void 0===t||null===(t=t[0])||void 0===t?void 0:t.length)||2,n=[];return{type:"MultiLineString",flatCoordinates:n,ends:(0,_deflate.deflateCoordinatesArray)(n,0,r,o),layout:(0,_SimpleGeometry.getLayoutForStride)(o)}}function readMultiPointGeometry(e){var t,r=e.coordinates;return{type:"MultiPoint",flatCoordinates:r.flat(),layout:(0,_SimpleGeometry.getLayoutForStride)((null===(t=r[0])||void 0===t?void 0:t.length)||2)}}function readMultiPolygonGeometry(e){var t,r=e.coordinates,o=[],n=(null===(t=r[0])||void 0===t||null===(t=t[0])||void 0===t?void 0:t[0].length)||2;return{type:"MultiPolygon",flatCoordinates:o,ends:(0,_deflate.deflateMultiCoordinatesArray)(o,0,r,n),layout:(0,_SimpleGeometry.getLayoutForStride)(n)}}function readPolygonGeometry(e){var t,r=e.coordinates,o=[],n=null===(t=r[0])||void 0===t||null===(t=t[0])||void 0===t?void 0:t.length;return{type:"Polygon",flatCoordinates:o,ends:(0,_deflate.deflateCoordinatesArray)(o,0,r,n),layout:(0,_SimpleGeometry.getLayoutForStride)(n)}}function writeGeometry(e,t){var r,o=(e=(0,_Feature3.transformGeometryWithOptions)(e,!0,t)).getType();switch(o){case"Point":r=writePointGeometry(e,t);break;case"LineString":r=writeLineStringGeometry(e,t);break;case"Polygon":r=writePolygonGeometry(e,t);break;case"MultiPoint":r=writeMultiPointGeometry(e,t);break;case"MultiLineString":r=writeMultiLineStringGeometry(e,t);break;case"MultiPolygon":r=writeMultiPolygonGeometry(e,t);break;case"GeometryCollection":r=writeGeometryCollectionGeometry(e,t);break;case"Circle":r={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+o)}return r}function writeGeometryCollectionGeometry(e,t){return delete(t=Object.assign({},t)).featureProjection,{type:"GeometryCollection",geometries:e.getGeometriesArray().map(function(e){return writeGeometry(e,t)})}}function writeLineStringGeometry(e,t){return{type:"LineString",coordinates:e.getCoordinates()}}function writeMultiLineStringGeometry(e,t){return{type:"MultiLineString",coordinates:e.getCoordinates()}}function writeMultiPointGeometry(e,t){return{type:"MultiPoint",coordinates:e.getCoordinates()}}function writeMultiPolygonGeometry(e,t){var r;return t&&(r=t.rightHanded),{type:"MultiPolygon",coordinates:e.getCoordinates(r)}}function writePointGeometry(e,t){return{type:"Point",coordinates:e.getCoordinates()}}function writePolygonGeometry(e,t){var r;return t&&(r=t.rightHanded),{type:"Polygon",coordinates:e.getCoordinates(r)}}var _default=exports.default=GeoJSON;

},{"../Feature.js":82,"../geom/SimpleGeometry.js":212,"../geom/flat/deflate.js":217,"../obj.js":281,"../proj.js":283,"../render/Feature.js":295,"./Feature.js":147,"./JSONFeature.js":157}],155:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_TextFeature2=_interopRequireDefault(require("./TextFeature.js")),_proj=require("../proj.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var B_RECORD_RE=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,H_RECORD_RE=/^H.([A-Z]{3}).*?:(.*)/,HFDTE_RECORD_RE=/^HFDTE(\d{2})(\d{2})(\d{2})/,HFDTEDATE_RECORD_RE=/^HFDTEDATE:(\d{2})(\d{2})(\d{2}),(\d{2})/,NEWLINE_RE=/\r\n|\r|\n/,IGC=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).dataProjection=(0,_proj.get)("EPSG:4326"),r.altitudeMode_=e.altitudeMode?e.altitudeMode:"none",r.lad_=!1,r.lod_=!1,r.ladStart_=0,r.ladStop_=0,r.lodStart_=0,r.lodStop_=0,r}return _inherits(t,_TextFeature2["default"]),_createClass(t,[{key:"readFeatureFromText",value:function(e,t){var r,o,n=this.altitudeMode_,i=e.split(NEWLINE_RE),a={},u=[],s=2e3,l=0,p=1,f=-1;for(r=0,o=i.length;r<o;++r){var _=i[r],c=void 0;if("B"==_.charAt(0)){if(c=B_RECORD_RE.exec(_)){var d=parseInt(c[1],10),y=parseInt(c[2],10),h=parseInt(c[3],10),v=parseInt(c[4],10)+parseInt(c[5],10)/6e4;this.lad_&&(v+=parseInt(_.slice(this.ladStart_,this.ladStop_),10)/6e4/Math.pow(10,this.ladStop_-this.ladStart_)),"S"==c[6]&&(v=-v);var b=parseInt(c[7],10)+parseInt(c[8],10)/6e4;if(this.lod_&&(b+=parseInt(_.slice(this.lodStart_,this.lodStop_),10)/6e4/Math.pow(10,this.lodStop_-this.lodStart_)),"W"==c[9]&&(b=-b),u.push(b,v),"none"!=n){var E=void 0;E="gps"==n?parseInt(c[11],10):"barometric"==n?parseInt(c[12],10):0,u.push(E)}var R=Date.UTC(s,l,p,d,y,h);R<f&&(R=Date.UTC(s,l,p+1,d,y,h)),u.push(R/1e3),f=R}}else if("H"==_.charAt(0))(c=HFDTEDATE_RECORD_RE.exec(_))?(p=parseInt(c[1],10),l=parseInt(c[2],10)-1,s=2e3+parseInt(c[3],10)):(c=HFDTE_RECORD_RE.exec(_))?(p=parseInt(c[1],10),l=parseInt(c[2],10)-1,s=2e3+parseInt(c[3],10)):(c=H_RECORD_RE.exec(_))&&(a[c[1]]=c[2].trim());else if("I"==_.charAt(0))for(var O=parseInt(_.slice(1,3),10),S=0;S<O;S++){var m=_.slice(7+7*S,10+7*S);if("LAD"===m||"LOD"===m){var D=parseInt(_.slice(3+7*S,5+7*S),10)-1,P=parseInt(_.slice(5+7*S,7+7*S),10);"LAD"===m?(this.lad_=!0,this.ladStart_=D,this.ladStop_=P):"LOD"===m&&(this.lod_=!0,this.lodStart_=D,this.lodStop_=P)}}}if(0===u.length)return null;var I="none"==n?"XYM":"XYZM",C=new _LineString.default(u,I),j=new _Feature.default((0,_Feature2.transformGeometryWithOptions)(C,!1,t));return j.setProperties(a,!0),j}},{key:"readFeaturesFromText",value:function(e,t){var r=this.readFeatureFromText(e,t);return r?[r]:[]}}])}(),_default=exports.default=IGC;

},{"../Feature.js":82,"../geom/LineString.js":205,"../proj.js":283,"./Feature.js":147,"./TextFeature.js":162}],156:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Versions=void 0;var _asserts=require("../asserts.js");function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,i){for(var o=0;o<i.length;o++){var t=i[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,_toPropertyKey(t.key),t)}}function _createClass(e,i,o){return i&&_defineProperties(e.prototype,i),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var i=_toPrimitive(e,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(e,i){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var t=o.call(e,i||"default");if("object"!=_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,i){if(e){if("string"==typeof e)return _arrayLikeToArray(e,i);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,i):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,i){(null==i||i>e.length)&&(i=e.length);for(var o=0,t=Array(i);o<i;o++)t[o]=e[o];return t}var Versions=exports.Versions={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"},IIIF_PROFILE_VALUES={};IIIF_PROFILE_VALUES[Versions.VERSION1]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},IIIF_PROFILE_VALUES[Versions.VERSION2]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},IIIF_PROFILE_VALUES[Versions.VERSION3]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},IIIF_PROFILE_VALUES.none={none:{supports:[],formats:[],qualities:[]}};var COMPLIANCE_VERSION1=/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/,COMPLIANCE_VERSION2=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,COMPLIANCE_VERSION3=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/;function generateVersion1Options(e){var i=e.getComplianceLevelSupportedFeatures();return void 0===i&&(i=IIIF_PROFILE_VALUES[Versions.VERSION1].level0),{url:void 0===e.imageInfo["@id"]?void 0:e.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:i.supports,formats:[].concat(_toConsumableArray(i.formats),[void 0===e.imageInfo.formats?[]:e.imageInfo.formats]),qualities:[].concat(_toConsumableArray(i.qualities),[void 0===e.imageInfo.qualities?[]:e.imageInfo.qualities]),resolutions:e.imageInfo.scale_factors,tileSize:void 0!==e.imageInfo.tile_width?void 0!==e.imageInfo.tile_height?[e.imageInfo.tile_width,e.imageInfo.tile_height]:[e.imageInfo.tile_width,e.imageInfo.tile_width]:null!=e.imageInfo.tile_height?[e.imageInfo.tile_height,e.imageInfo.tile_height]:void 0}}function generateVersion2Options(e){var i=e.getComplianceLevelSupportedFeatures(),o=Array.isArray(e.imageInfo.profile)&&e.imageInfo.profile.length>1,t=o&&e.imageInfo.profile[1].supports?e.imageInfo.profile[1].supports:[],r=o&&e.imageInfo.profile[1].formats?e.imageInfo.profile[1].formats:[],n=o&&e.imageInfo.profile[1].qualities?e.imageInfo.profile[1].qualities:[];return{url:e.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:void 0===e.imageInfo.sizes?void 0:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===e.imageInfo.tiles?void 0:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return void 0===e.height?e.width:e.height})[0]],resolutions:void 0===e.imageInfo.tiles?void 0:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:[].concat(_toConsumableArray(i.supports),_toConsumableArray(t)),formats:[].concat(_toConsumableArray(i.formats),_toConsumableArray(r)),qualities:[].concat(_toConsumableArray(i.qualities),_toConsumableArray(n))}}function generateVersion3Options(e){var i=e.getComplianceLevelSupportedFeatures(),o=void 0===e.imageInfo.extraFormats?i.formats:[].concat(_toConsumableArray(i.formats),_toConsumableArray(e.imageInfo.extraFormats)),t=void 0!==e.imageInfo.preferredFormats&&Array.isArray(e.imageInfo.preferredFormats)&&e.imageInfo.preferredFormats.length>0?e.imageInfo.preferredFormats.filter(function(e){return["jpg","png","gif"].includes(e)}).reduce(function(e,i){return void 0===e&&o.includes(i)?i:e},void 0):void 0;return{url:e.imageInfo.id,sizes:void 0===e.imageInfo.sizes?void 0:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===e.imageInfo.tiles?void 0:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return e.height})[0]],resolutions:void 0===e.imageInfo.tiles?void 0:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:void 0===e.imageInfo.extraFeatures?i.supports:[].concat(_toConsumableArray(i.supports),_toConsumableArray(e.imageInfo.extraFeatures)),formats:o,qualities:void 0===e.imageInfo.extraQualities?i.qualities:[].concat(_toConsumableArray(i.qualities),_toConsumableArray(e.imageInfo.extraQualities)),preferredFormat:t}}var versionFunctions={};versionFunctions[Versions.VERSION1]=generateVersion1Options,versionFunctions[Versions.VERSION2]=generateVersion2Options,versionFunctions[Versions.VERSION3]=generateVersion3Options;var IIIFInfo=function(){return _createClass(function e(i){_classCallCheck(this,e),this.setImageInfo(i)},[{key:"setImageInfo",value:function(e){this.imageInfo="string"==typeof e?JSON.parse(e):e}},{key:"getImageApiVersion",value:function(){if(void 0!==this.imageInfo){var e=this.imageInfo["@context"]||"ol-no-context";"string"==typeof e&&(e=[e]);for(var i=0;i<e.length;i++)switch(e[i]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return Versions.VERSION1;case"http://iiif.io/api/image/2/context.json":return Versions.VERSION2;case"http://iiif.io/api/image/3/context.json":return Versions.VERSION3;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(Versions.VERSION1)&&this.imageInfo.identifier)return Versions.VERSION1}(0,_asserts.assert)(!1,"Cannot determine IIIF Image API version from provided image information JSON")}}},{key:"getComplianceLevelEntryFromProfile",value:function(e){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===e&&(e=this.getImageApiVersion()),e){case Versions.VERSION1:if(COMPLIANCE_VERSION1.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Versions.VERSION3:if(COMPLIANCE_VERSION3.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Versions.VERSION2:if("string"==typeof this.imageInfo.profile&&COMPLIANCE_VERSION2.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&"string"==typeof this.imageInfo.profile[0]&&COMPLIANCE_VERSION2.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}}},{key:"getComplianceLevelFromProfile",value:function(e){var i=this.getComplianceLevelEntryFromProfile(e);if(void 0!==i){var o=i.match(/level[0-2](?:\.json)?$/g);return Array.isArray(o)?o[0].replace(".json",""):void 0}}},{key:"getComplianceLevelSupportedFeatures",value:function(){if(void 0!==this.imageInfo){var e=this.getImageApiVersion(),i=this.getComplianceLevelFromProfile(e);return void 0===i?IIIF_PROFILE_VALUES.none.none:IIIF_PROFILE_VALUES[e][i]}}},{key:"getTileSourceOptions",value:function(e){var i=e||{},o=this.getImageApiVersion();if(void 0!==o){var t=void 0===o?void 0:versionFunctions[o](this);if(void 0!==t)return{url:t.url,version:o,size:[this.imageInfo.width,this.imageInfo.height],sizes:t.sizes,format:void 0!==i.format&&t.formats.includes(i.format)?i.format:void 0!==t.preferredFormat?t.preferredFormat:"jpg",supports:t.supports,quality:i.quality&&t.qualities.includes(i.quality)?i.quality:t.qualities.includes("native")?"native":"default",resolutions:Array.isArray(t.resolutions)?t.resolutions.sort(function(e,i){return i-e}):void 0,tileSize:t.tileSize}}}}])}(),_default=exports.default=IIIFInfo;

},{"../asserts.js":111}],157:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("./Feature.js")),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var JSONFeature=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t)}return _inherits(t,_Feature["default"]),_createClass(t,[{key:"getType",value:function(){return"json"}},{key:"readFeature",value:function(e,t){return this.readFeatureFromObject(getObject(e),this.getReadOptions(e,t))}},{key:"readFeatures",value:function(e,t){return this.readFeaturesFromObject(getObject(e),this.getReadOptions(e,t))}},{key:"readFeatureFromObject",value:function(e,t){return(0,_util.abstract)()}},{key:"readFeaturesFromObject",value:function(e,t){return(0,_util.abstract)()}},{key:"readGeometry",value:function(e,t){return this.readGeometryFromObject(getObject(e),this.getReadOptions(e,t))}},{key:"readGeometryFromObject",value:function(e,t){return(0,_util.abstract)()}},{key:"readProjection",value:function(e){return this.readProjectionFromObject(getObject(e))}},{key:"readProjectionFromObject",value:function(e){return(0,_util.abstract)()}},{key:"writeFeature",value:function(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}},{key:"writeFeatureObject",value:function(e,t){return(0,_util.abstract)()}},{key:"writeFeatures",value:function(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}},{key:"writeFeaturesObject",value:function(e,t){return(0,_util.abstract)()}},{key:"writeGeometry",value:function(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}},{key:"writeGeometryObject",value:function(e,t){return(0,_util.abstract)()}}])}();function getObject(e){if("string"==typeof e){var t=JSON.parse(e);return t||null}return null!==e?e:null}var _default=exports.default=JSONFeature;

},{"../util.js":404,"./Feature.js":147}],158:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getDefaultFillStyle=getDefaultFillStyle,exports.getDefaultImageStyle=getDefaultImageStyle,exports.getDefaultStrokeStyle=getDefaultStrokeStyle,exports.getDefaultStyle=getDefaultStyle,exports.getDefaultStyleArray=getDefaultStyleArray,exports.getDefaultTextStyle=getDefaultTextStyle,exports.readFlatCoordinates=readFlatCoordinates;var _Feature=_interopRequireDefault(require("../Feature.js")),_Fill=_interopRequireDefault(require("../style/Fill.js")),_GeometryCollection=_interopRequireDefault(require("../geom/GeometryCollection.js")),_Icon=_interopRequireDefault(require("../style/Icon.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_Stroke=_interopRequireDefault(require("../style/Stroke.js")),_Style=_interopRequireDefault(require("../style/Style.js")),_Text=_interopRequireDefault(require("../style/Text.js")),_XMLFeature2=_interopRequireDefault(require("./XMLFeature.js")),_xml=require("../xml.js"),_color=require("../color.js"),_array=require("../array.js"),_proj=require("../proj.js"),_xsd=require("./xsd.js"),_math=require("../math.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DEFAULT_COLOR,DEFAULT_IMAGE_STYLE_ANCHOR,DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,DEFAULT_IMAGE_STYLE_SIZE,DEFAULT_IMAGE_STYLE_SRC,GX_NAMESPACE_URIS=["http://www.google.com/kml/ext/2.2"],NAMESPACE_URIS=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],SCHEMA_LOCATION="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",ICON_ANCHOR_UNITS_MAP={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},PLACEMARK_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ExtendedData:extendedDataParser,Region:regionParser,MultiGeometry:(0,_xml.makeObjectPropertySetter)(readMultiGeometry,"geometry"),LineString:(0,_xml.makeObjectPropertySetter)(readLineString,"geometry"),LinearRing:(0,_xml.makeObjectPropertySetter)(readLinearRing,"geometry"),Point:(0,_xml.makeObjectPropertySetter)(readPoint,"geometry"),Polygon:(0,_xml.makeObjectPropertySetter)(readPolygon,"geometry"),Style:(0,_xml.makeObjectPropertySetter)(readStyle),StyleMap:placemarkStyleMapParser,address:(0,_xml.makeObjectPropertySetter)(_xsd.readString),description:(0,_xml.makeObjectPropertySetter)(_xsd.readString),name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),open:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean),phoneNumber:(0,_xml.makeObjectPropertySetter)(_xsd.readString),styleUrl:(0,_xml.makeObjectPropertySetter)(readStyleURL),visibility:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean)},(0,_xml.makeStructureNS)(GX_NAMESPACE_URIS,{MultiTrack:(0,_xml.makeObjectPropertySetter)(readGxMultiTrack,"geometry"),Track:(0,_xml.makeObjectPropertySetter)(readGxTrack,"geometry")})),NETWORK_LINK_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ExtendedData:extendedDataParser,Region:regionParser,Link:linkParser,address:(0,_xml.makeObjectPropertySetter)(_xsd.readString),description:(0,_xml.makeObjectPropertySetter)(_xsd.readString),name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),open:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean),phoneNumber:(0,_xml.makeObjectPropertySetter)(_xsd.readString),visibility:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean)}),LINK_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{href:(0,_xml.makeObjectPropertySetter)(readURI)}),CAMERA_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Altitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),Longitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),Latitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),Tilt:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),AltitudeMode:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Heading:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),Roll:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal)}),REGION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LatLonAltBox:latLonAltBoxParser,Lod:lodParser}),KML_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["Document","Placemark"]),KML_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Document:(0,_xml.makeChildAppender)(writeDocument),Placemark:(0,_xml.makeChildAppender)(writePlacemark)}),DEFAULT_FILL_STYLE=null;function getDefaultFillStyle(){return DEFAULT_FILL_STYLE}var DEFAULT_NO_IMAGE_STYLE,DEFAULT_IMAGE_STYLE=null;function getDefaultImageStyle(){return DEFAULT_IMAGE_STYLE}var DEFAULT_TEXT_STROKE_STYLE,DEFAULT_STROKE_STYLE=null;function getDefaultStrokeStyle(){return DEFAULT_STROKE_STYLE}var DEFAULT_TEXT_STYLE=null;function getDefaultTextStyle(){return DEFAULT_TEXT_STYLE}var DEFAULT_STYLE=null;function getDefaultStyle(){return DEFAULT_STYLE}var TEXTAREA,DEFAULT_STYLE_ARRAY=null;function getDefaultStyleArray(){return DEFAULT_STYLE_ARRAY}function scaleForSize(e){return 32/Math.min(e[0],e[1])}function createStyleDefaults(){DEFAULT_COLOR=[255,255,255,1],DEFAULT_FILL_STYLE=new _Fill.default({color:DEFAULT_COLOR}),DEFAULT_IMAGE_STYLE_ANCHOR=[20,2],DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS="pixels",DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS="pixels",DEFAULT_IMAGE_STYLE_SIZE=[64,64],DEFAULT_IMAGE_STYLE_SRC="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",DEFAULT_IMAGE_STYLE=new _Icon.default({anchor:DEFAULT_IMAGE_STYLE_ANCHOR,anchorOrigin:"bottom-left",anchorXUnits:DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,anchorYUnits:DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,crossOrigin:"anonymous",rotation:0,scale:scaleForSize(DEFAULT_IMAGE_STYLE_SIZE),size:DEFAULT_IMAGE_STYLE_SIZE,src:DEFAULT_IMAGE_STYLE_SRC}),DEFAULT_NO_IMAGE_STYLE="NO_IMAGE",DEFAULT_STROKE_STYLE=new _Stroke.default({color:DEFAULT_COLOR,width:1}),DEFAULT_TEXT_STROKE_STYLE=new _Stroke.default({color:[51,51,51,1],width:2}),DEFAULT_TEXT_STYLE=new _Text.default({font:"bold 16px Helvetica",fill:DEFAULT_FILL_STYLE,stroke:DEFAULT_TEXT_STROKE_STYLE,scale:.8}),DEFAULT_STYLE=new _Style.default({fill:DEFAULT_FILL_STYLE,image:DEFAULT_IMAGE_STYLE,text:DEFAULT_TEXT_STYLE,stroke:DEFAULT_STROKE_STYLE,zIndex:0}),DEFAULT_STYLE_ARRAY=[DEFAULT_STYLE]}function defaultIconUrlFunction(e){return e}var KML=function(e){function t(e){var r;return _classCallCheck(this,t),r=_callSuper(this,t),e=e||{},DEFAULT_STYLE_ARRAY||createStyleDefaults(),r.dataProjection=(0,_proj.get)("EPSG:4326"),r.defaultStyle_=e.defaultStyle?e.defaultStyle:DEFAULT_STYLE_ARRAY,r.extractStyles_=void 0===e.extractStyles||e.extractStyles,r.writeStyles_=void 0===e.writeStyles||e.writeStyles,r.sharedStyles_={},r.showPointNames_=void 0===e.showPointNames||e.showPointNames,r.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",r.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:defaultIconUrlFunction,r.supportedMediaTypes=["application/vnd.google-earth.kml+xml"],r}return _inherits(t,_XMLFeature2["default"]),_createClass(t,[{key:"readDocumentOrFolder_",value:function(e,t){var r=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Document:(0,_xml.makeArrayExtender)(this.readDocumentOrFolder_,this),Folder:(0,_xml.makeArrayExtender)(this.readDocumentOrFolder_,this),Placemark:(0,_xml.makeArrayPusher)(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),a=(0,_xml.pushParseAndPop)([],r,e,t,this);if(a)return a}},{key:"readPlacemark_",value:function(e,t){var r=(0,_xml.pushParseAndPop)({geometry:null},PLACEMARK_PARSERS,e,t,this);if(r){var a=new _Feature.default,l=e.getAttribute("id");null!==l&&a.setId(l);var n=t[0],o=r.geometry;if(o&&(0,_Feature2.transformGeometryWithOptions)(o,!1,n),a.setGeometry(o),delete r.geometry,this.extractStyles_){var i=createFeatureStyleFunction(r.Style,r.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);a.setStyle(i)}return delete r.Style,a.setProperties(r,!0),a}}},{key:"readSharedStyle_",value:function(e,t){var r=e.getAttribute("id");if(null!==r){var a=readStyle.call(this,e,t);if(a){var l,n=e.baseURI;if(n&&"about:blank"!=n||(n=window.location.href),n)l=new URL("#"+r,n).href;else l="#"+r;this.sharedStyles_[l]=a}}}},{key:"readSharedStyleMap_",value:function(e,t){var r=e.getAttribute("id");if(null!==r){var a=readStyleMapValue.call(this,e,t);if(a){var l,n=e.baseURI;if(n&&"about:blank"!=n||(n=window.location.href),n)l=new URL("#"+r,n).href;else l="#"+r;this.sharedStyles_[l]=a}}}},{key:"readFeatureFromNode",value:function(e,t){if(!NAMESPACE_URIS.includes(e.namespaceURI))return null;var r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}},{key:"readFeaturesFromNode",value:function(e,t){if(!NAMESPACE_URIS.includes(e.namespaceURI))return[];var r,a=e.localName;if("Document"==a||"Folder"==a)return(r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]))||[];if("Placemark"==a){var l=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return l?[l]:[]}if("kml"==a){r=[];for(var n=e.firstElementChild;n;n=n.nextElementSibling){var o=this.readFeaturesFromNode(n,t);o&&(0,_array.extend)(r,o)}return r}return[]}},{key:"readName",value:function(e){if(e){if("string"==typeof e){var t=(0,_xml.parse)(e);return this.readNameFromDocument(t)}return(0,_xml.isDocument)(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}},{key:"readNameFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){var r=this.readNameFromNode(t);if(r)return r}}},{key:"readNameFromNode",value:function(e){for(var t=e.firstElementChild;t;t=t.nextElementSibling)if(NAMESPACE_URIS.includes(t.namespaceURI)&&"name"==t.localName)return(0,_xsd.readString)(t);for(var r=e.firstElementChild;r;r=r.nextElementSibling){var a=r.localName;if(NAMESPACE_URIS.includes(r.namespaceURI)&&("Document"==a||"Folder"==a||"Placemark"==a||"kml"==a)){var l=this.readNameFromNode(r);if(l)return l}}}},{key:"readNetworkLinks",value:function(e){var t=[];if("string"==typeof e){var r=(0,_xml.parse)(e);(0,_array.extend)(t,this.readNetworkLinksFromDocument(r))}else(0,_xml.isDocument)(e)?(0,_array.extend)(t,this.readNetworkLinksFromDocument(e)):(0,_array.extend)(t,this.readNetworkLinksFromNode(e));return t}},{key:"readNetworkLinksFromDocument",value:function(e){for(var t=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&(0,_array.extend)(t,this.readNetworkLinksFromNode(r));return t}},{key:"readNetworkLinksFromNode",value:function(e){for(var t=[],r=e.firstElementChild;r;r=r.nextElementSibling)if(NAMESPACE_URIS.includes(r.namespaceURI)&&"NetworkLink"==r.localName){var a=(0,_xml.pushParseAndPop)({},NETWORK_LINK_PARSERS,r,[]);t.push(a)}for(var l=e.firstElementChild;l;l=l.nextElementSibling){var n=l.localName;!NAMESPACE_URIS.includes(l.namespaceURI)||"Document"!=n&&"Folder"!=n&&"kml"!=n||(0,_array.extend)(t,this.readNetworkLinksFromNode(l))}return t}},{key:"readRegion",value:function(e){var t=[];if("string"==typeof e){var r=(0,_xml.parse)(e);(0,_array.extend)(t,this.readRegionFromDocument(r))}else(0,_xml.isDocument)(e)?(0,_array.extend)(t,this.readRegionFromDocument(e)):(0,_array.extend)(t,this.readRegionFromNode(e));return t}},{key:"readRegionFromDocument",value:function(e){for(var t=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&(0,_array.extend)(t,this.readRegionFromNode(r));return t}},{key:"readRegionFromNode",value:function(e){for(var t=[],r=e.firstElementChild;r;r=r.nextElementSibling)if(NAMESPACE_URIS.includes(r.namespaceURI)&&"Region"==r.localName){var a=(0,_xml.pushParseAndPop)({},REGION_PARSERS,r,[]);t.push(a)}for(var l=e.firstElementChild;l;l=l.nextElementSibling){var n=l.localName;!NAMESPACE_URIS.includes(l.namespaceURI)||"Document"!=n&&"Folder"!=n&&"kml"!=n||(0,_array.extend)(t,this.readRegionFromNode(l))}return t}},{key:"readCamera",value:function(e){var t=[];if("string"==typeof e){var r=(0,_xml.parse)(e);(0,_array.extend)(t,this.readCameraFromDocument(r))}else(0,_xml.isDocument)(e)?(0,_array.extend)(t,this.readCameraFromDocument(e)):(0,_array.extend)(t,this.readCameraFromNode(e));return t}},{key:"readCameraFromDocument",value:function(e){for(var t=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&(0,_array.extend)(t,this.readCameraFromNode(r));return t}},{key:"readCameraFromNode",value:function(e){for(var t=[],r=e.firstElementChild;r;r=r.nextElementSibling)if(NAMESPACE_URIS.includes(r.namespaceURI)&&"Camera"===r.localName){var a=(0,_xml.pushParseAndPop)({},CAMERA_PARSERS,r,[]);t.push(a)}for(var l=e.firstElementChild;l;l=l.nextElementSibling){var n=l.localName;!NAMESPACE_URIS.includes(l.namespaceURI)||"Document"!==n&&"Folder"!==n&&"Placemark"!==n&&"kml"!==n||(0,_array.extend)(t,this.readCameraFromNode(l))}return t}},{key:"writeFeaturesNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,_xml.createElementNS)(NAMESPACE_URIS[4],"kml"),a="http://www.w3.org/2000/xmlns/";r.setAttributeNS(a,"xmlns:gx",GX_NAMESPACE_URIS[0]),r.setAttributeNS(a,"xmlns:xsi",_xml.XML_SCHEMA_INSTANCE_URI),r.setAttributeNS(_xml.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",SCHEMA_LOCATION);var l={node:r},n={};e.length>1?n.Document=e:1==e.length&&(n.Placemark=e[0]);var o=KML_SEQUENCE[r.namespaceURI],i=(0,_xml.makeSequence)(n,o);return(0,_xml.pushSerializeAndPop)(l,KML_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,i,[t],o,this),r}}])}();function createNameStyleFunction(e,t){var r=[0,0],a="start",l=e.getImage();if(l){var n=l.getSize();if(n&&2==n.length){var o=l.getScaleArray(),i=l.getAnchor();r[0]=o[0]*(n[0]-i[0]),r[1]=o[1]*(n[1]/2-i[1]),a="left"}}var _=e.getText();return _?((_=_.clone()).setFont(_.getFont()||DEFAULT_TEXT_STYLE.getFont()),_.setScale(_.getScale()||DEFAULT_TEXT_STYLE.getScale()),_.setFill(_.getFill()||DEFAULT_TEXT_STYLE.getFill()),_.setStroke(_.getStroke()||DEFAULT_TEXT_STROKE_STYLE)):_=DEFAULT_TEXT_STYLE.clone(),_.setText(t),_.setOffsetX(r[0]),_.setOffsetY(r[1]),_.setTextAlign(a),new _Style.default({image:l,text:_})}function createFeatureStyleFunction(e,t,r,a,l){return function(n,o){var i=l,_="",S=[];if(i){var m=n.getGeometry();if(m)if(m instanceof _GeometryCollection.default)i=(S=m.getGeometriesArrayRecursive().filter(function(e){var t=e.getType();return"Point"===t||"MultiPoint"===t})).length>0;else{var u=m.getType();i="Point"===u||"MultiPoint"===u}}i&&(_=n.get("name"),(i=i&&!!_)&&/&[^&]+;/.test(_)&&(TEXTAREA||(TEXTAREA=document.createElement("textarea")),TEXTAREA.innerHTML=_,_=TEXTAREA.value));var s=r;if(e?s=e:t&&(s=findStyle(t,r,a)),i){var d=createNameStyleFunction(s[0],_);return S.length>0?(d.setGeometry(new _GeometryCollection.default(S)),[d,new _Style.default({geometry:s[0].getGeometry(),image:null,fill:s[0].getFill(),stroke:s[0].getStroke(),text:null})].concat(s.slice(1))):d}return s}}function findStyle(e,t,r){return Array.isArray(e)?e:"string"==typeof e?findStyle(r[e],t,r):t}function readColor(e){var t=(0,_xml.getAllTextContent)(e,!1),r=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(t);if(r){var a=r[1];return[parseInt(a.substr(6,2),16),parseInt(a.substr(4,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(0,2),16)/255]}}function readFlatCoordinates(e){var t=(0,_xml.getAllTextContent)(e,!1),r=[];t=t.replace(/\s*,\s*/g,",");for(var a,l=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;a=l.exec(t);){var n=parseFloat(a[1]),o=parseFloat(a[2]),i=a[3]?parseFloat(a[3]):0;r.push(n,o,i),t=t.substr(a[0].length)}if(""===t)return r}function readURI(e){var t=(0,_xml.getAllTextContent)(e,!1).trim(),r=e.baseURI;return r&&"about:blank"!=r||(r=window.location.href),r?new URL(t,r).href:t}function readStyleURL(e){var t=(0,_xml.getAllTextContent)(e,!1).trim().replace(/^(?!.*#)/,"#"),r=e.baseURI;return r&&"about:blank"!=r||(r=window.location.href),r?new URL(t,r).href:t}function readVec2(e){var t,r=e.getAttribute("xunits"),a=e.getAttribute("yunits");return t="insetPixels"!==r?"insetPixels"!==a?"bottom-left":"top-left":"insetPixels"!==a?"bottom-right":"top-right",{x:parseFloat(e.getAttribute("x")),xunits:ICON_ANCHOR_UNITS_MAP[r],y:parseFloat(e.getAttribute("y")),yunits:ICON_ANCHOR_UNITS_MAP[a],origin:t}}function readScale(e){return(0,_xsd.readDecimal)(e)}var STYLE_MAP_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Pair:pairDataParser});function readStyleMapValue(e,t){return(0,_xml.pushParseAndPop)(void 0,STYLE_MAP_PARSERS,e,t,this)}var ICON_STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Icon:(0,_xml.makeObjectPropertySetter)(readIcon),color:(0,_xml.makeObjectPropertySetter)(readColor),heading:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),hotSpot:(0,_xml.makeObjectPropertySetter)(readVec2),scale:(0,_xml.makeObjectPropertySetter)(readScale)});function iconStyleParser(e,t){var r=(0,_xml.pushParseAndPop)({},ICON_STYLE_PARSERS,e,t);if(r){var a,l,n,o,i=t[t.length-1],_="Icon"in r?r.Icon:{},S=!("Icon"in r)||Object.keys(_).length>0,m=_.href;m?a=m:S&&(a=DEFAULT_IMAGE_STYLE_SRC);var u,s="bottom-left",d=r.hotSpot;d?(l=[d.x,d.y],n=d.xunits,o=d.yunits,s=d.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=DEFAULT_IMAGE_STYLE_ANCHOR,n=DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,o=DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS):a.includes("arrow-reverse")?(l=[54,42],n=DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,o=DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS):a.includes("paddle")&&(l=[32,1],n=DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,o=DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS));var E,A=_.x,c=_.y;void 0!==A&&void 0!==c&&(u=[A,c]);var y,p=_.w,x=_.h;void 0!==p&&void 0!==x&&(E=[p,x]);var R=r.heading;void 0!==R&&(y=(0,_math.toRadians)(R));var P=r.scale,f=r.color;if(S){a==DEFAULT_IMAGE_STYLE_SRC&&(E=DEFAULT_IMAGE_STYLE_SIZE);var T=new _Icon.default({anchor:l,anchorOrigin:s,anchorXUnits:n,anchorYUnits:o,crossOrigin:this.crossOrigin_,offset:u,offsetOrigin:"bottom-left",rotation:y,scale:P,size:E,src:this.iconUrlFunction_(a),color:f}),N=T.getScaleArray()[0],g=T.getSize();if(null===g){var L=T.getImageState();if(L===_ImageState.default.IDLE||L===_ImageState.default.LOADING){T.listenImageChange(function e(){var t=T.getImageState();if(t!==_ImageState.default.IDLE&&t!==_ImageState.default.LOADING){var r=T.getSize();if(r&&2==r.length){var a=scaleForSize(r);T.setScale(N*a)}T.unlistenImageChange(e)}}),L===_ImageState.default.IDLE&&T.load()}}else if(2==g.length){var I=scaleForSize(g);T.setScale(N*I)}i.imageStyle=T}else i.imageStyle=DEFAULT_NO_IMAGE_STYLE}}var LABEL_STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{color:(0,_xml.makeObjectPropertySetter)(readColor),scale:(0,_xml.makeObjectPropertySetter)(readScale)});function labelStyleParser(e,t){var r=(0,_xml.pushParseAndPop)({},LABEL_STYLE_PARSERS,e,t);if(r){var a=t[t.length-1],l=new _Text.default({fill:new _Fill.default({color:"color"in r?r.color:DEFAULT_COLOR}),scale:r.scale});a.textStyle=l}}var LINE_STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{color:(0,_xml.makeObjectPropertySetter)(readColor),width:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal)});function lineStyleParser(e,t){var r=(0,_xml.pushParseAndPop)({},LINE_STYLE_PARSERS,e,t);if(r){var a=t[t.length-1],l=new _Stroke.default({color:"color"in r?r.color:DEFAULT_COLOR,width:"width"in r?r.width:1});a.strokeStyle=l}}var POLY_STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{color:(0,_xml.makeObjectPropertySetter)(readColor),fill:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean),outline:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean)});function polyStyleParser(e,t){var r=(0,_xml.pushParseAndPop)({},POLY_STYLE_PARSERS,e,t);if(r){var a=t[t.length-1],l=new _Fill.default({color:"color"in r?r.color:DEFAULT_COLOR});a.fillStyle=l;var n=r.fill;void 0!==n&&(a.fill=n);var o=r.outline;void 0!==o&&(a.outline=o)}}var FLAT_LINEAR_RING_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{coordinates:(0,_xml.makeReplacer)(readFlatCoordinates)});function readFlatLinearRing(e,t){return(0,_xml.pushParseAndPop)(null,FLAT_LINEAR_RING_PARSERS,e,t)}function gxCoordParser(e,t){var r=t[t.length-1].coordinates,a=(0,_xml.getAllTextContent)(e,!1),l=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(a);if(l){var n=parseFloat(l[1]),o=parseFloat(l[2]),i=parseFloat(l[3]);r.push([n,o,i])}else r.push([])}var GX_MULTITRACK_GEOMETRY_PARSERS=(0,_xml.makeStructureNS)(GX_NAMESPACE_URIS,{Track:(0,_xml.makeArrayPusher)(readGxTrack)});function readGxMultiTrack(e,t){var r=(0,_xml.pushParseAndPop)([],GX_MULTITRACK_GEOMETRY_PARSERS,e,t);if(r)return new _MultiLineString.default(r)}var GX_TRACK_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{when:whenParser},(0,_xml.makeStructureNS)(GX_NAMESPACE_URIS,{coord:gxCoordParser}));function readGxTrack(e,t){var r=(0,_xml.pushParseAndPop)({coordinates:[],whens:[]},GX_TRACK_PARSERS,e,t);if(r){for(var a=[],l=r.coordinates,n=r.whens,o=0,i=Math.min(l.length,n.length);o<i;++o)3==l[o].length&&a.push(l[o][0],l[o][1],l[o][2],n[o]);return new _LineString.default(a,"XYZM")}}var ICON_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{href:(0,_xml.makeObjectPropertySetter)(readURI)},(0,_xml.makeStructureNS)(GX_NAMESPACE_URIS,{x:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),y:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),w:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),h:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal)}));function readIcon(e,t){var r=(0,_xml.pushParseAndPop)({},ICON_PARSERS,e,t);return r||null}var GEOMETRY_FLAT_COORDINATES_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{coordinates:(0,_xml.makeReplacer)(readFlatCoordinates)});function readFlatCoordinatesFromNode(e,t){return(0,_xml.pushParseAndPop)(null,GEOMETRY_FLAT_COORDINATES_PARSERS,e,t)}var EXTRUDE_AND_ALTITUDE_MODE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{extrude:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean),tessellate:(0,_xml.makeObjectPropertySetter)(_xsd.readBoolean),altitudeMode:(0,_xml.makeObjectPropertySetter)(_xsd.readString)});function readLineString(e,t){var r=(0,_xml.pushParseAndPop)({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,e,t),a=readFlatCoordinatesFromNode(e,t);if(a){var l=new _LineString.default(a,"XYZ");return l.setProperties(r,!0),l}}function readLinearRing(e,t){var r=(0,_xml.pushParseAndPop)({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,e,t),a=readFlatCoordinatesFromNode(e,t);if(a){var l=new _Polygon.default(a,"XYZ",[a.length]);return l.setProperties(r,!0),l}}var MULTI_GEOMETRY_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LineString:(0,_xml.makeArrayPusher)(readLineString),LinearRing:(0,_xml.makeArrayPusher)(readLinearRing),MultiGeometry:(0,_xml.makeArrayPusher)(readMultiGeometry),Point:(0,_xml.makeArrayPusher)(readPoint),Polygon:(0,_xml.makeArrayPusher)(readPolygon)});function readMultiGeometry(e,t){var r,a=(0,_xml.pushParseAndPop)([],MULTI_GEOMETRY_PARSERS,e,t);if(!a)return null;if(0===a.length)return new _GeometryCollection.default(a);for(var l,n,o,i=!0,_=a[0].getType(),S=1,m=a.length;S<m;++S)if((l=a[S]).getType()!=_){i=!1;break}if(i)if("Point"==_){var u=a[0];n=u.getLayout(),o=u.getFlatCoordinates();for(var s=1,d=a.length;s<d;++s)l=a[s],(0,_array.extend)(o,l.getFlatCoordinates());setCommonGeometryProperties(r=new _MultiPoint.default(o,n),a)}else if("LineString"==_)setCommonGeometryProperties(r=new _MultiLineString.default(a),a);else if("Polygon"==_)setCommonGeometryProperties(r=new _MultiPolygon.default(a),a);else{if("GeometryCollection"!=_)throw new Error("Unknown geometry type found");r=new _GeometryCollection.default(a)}else r=new _GeometryCollection.default(a);return r}function readPoint(e,t){var r=(0,_xml.pushParseAndPop)({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,e,t),a=readFlatCoordinatesFromNode(e,t);if(a){var l=new _Point.default(a,"XYZ");return l.setProperties(r,!0),l}}var FLAT_LINEAR_RINGS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{innerBoundaryIs:innerBoundaryIsParser,outerBoundaryIs:outerBoundaryIsParser});function readPolygon(e,t){var r=(0,_xml.pushParseAndPop)({},EXTRUDE_AND_ALTITUDE_MODE_PARSERS,e,t),a=(0,_xml.pushParseAndPop)([null],FLAT_LINEAR_RINGS_PARSERS,e,t);if(a&&a[0]){for(var l=a[0],n=[l.length],o=1,i=a.length;o<i;++o)(0,_array.extend)(l,a[o]),n.push(l.length);var _=new _Polygon.default(l,"XYZ",n);return _.setProperties(r,!0),_}}var STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{IconStyle:iconStyleParser,LabelStyle:labelStyleParser,LineStyle:lineStyleParser,PolyStyle:polyStyleParser});function readStyle(e,t){var r=(0,_xml.pushParseAndPop)({},STYLE_PARSERS,e,t,this);if(!r)return null;var a,l="fillStyle"in r?r.fillStyle:DEFAULT_FILL_STYLE,n=r.fill;void 0===n||n||(l=null),"imageStyle"in r?r.imageStyle!=DEFAULT_NO_IMAGE_STYLE&&(a=r.imageStyle):a=DEFAULT_IMAGE_STYLE;var o="textStyle"in r?r.textStyle:DEFAULT_TEXT_STYLE,i="strokeStyle"in r?r.strokeStyle:DEFAULT_STROKE_STYLE,_=r.outline;return void 0===_||_?[new _Style.default({fill:l,image:a,stroke:i,text:o,zIndex:void 0})]:[new _Style.default({geometry:function(e){var t=e.getGeometry(),r=t.getType();if("GeometryCollection"===r){var a=t;return new _GeometryCollection.default(a.getGeometriesArrayRecursive().filter(function(e){var t=e.getType();return"Polygon"!==t&&"MultiPolygon"!==t}))}if("Polygon"!==r&&"MultiPolygon"!==r)return t},fill:l,image:a,stroke:i,text:o,zIndex:void 0}),new _Style.default({geometry:function(e){var t=e.getGeometry(),r=t.getType();if("GeometryCollection"===r){var a=t;return new _GeometryCollection.default(a.getGeometriesArrayRecursive().filter(function(e){var t=e.getType();return"Polygon"===t||"MultiPolygon"===t}))}if("Polygon"===r||"MultiPolygon"===r)return t},fill:l,stroke:null,zIndex:void 0})]}function setCommonGeometryProperties(e,t){var r,a,l,n=t.length,o=new Array(t.length),i=new Array(t.length),_=new Array(t.length);r=!1,a=!1,l=!1;for(var S=0;S<n;++S){var m=t[S];o[S]=m.get("extrude"),i[S]=m.get("tessellate"),_[S]=m.get("altitudeMode"),r=r||void 0!==o[S],a=a||void 0!==i[S],l=l||_[S]}r&&e.set("extrude",o),a&&e.set("tessellate",i),l&&e.set("altitudeMode",_)}var DATA_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{displayName:(0,_xml.makeObjectPropertySetter)(_xsd.readString),value:(0,_xml.makeObjectPropertySetter)(_xsd.readString)});function dataParser(e,t){var r=e.getAttribute("name");(0,_xml.parseNode)(DATA_PARSERS,e,t);var a=t[t.length-1];r&&a.displayName?a[r]={value:a.value,displayName:a.displayName,toString:function(){return a.value}}:null!==r?a[r]=a.value:null!==a.displayName&&(a[a.displayName]=a.value),delete a.value}var EXTENDED_DATA_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Data:dataParser,SchemaData:schemaDataParser});function extendedDataParser(e,t){(0,_xml.parseNode)(EXTENDED_DATA_PARSERS,e,t)}function regionParser(e,t){(0,_xml.parseNode)(REGION_PARSERS,e,t)}var PAIR_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Style:(0,_xml.makeObjectPropertySetter)(readStyle),key:(0,_xml.makeObjectPropertySetter)(_xsd.readString),styleUrl:(0,_xml.makeObjectPropertySetter)(readStyleURL)});function pairDataParser(e,t){var r=(0,_xml.pushParseAndPop)({},PAIR_PARSERS,e,t,this);if(r){var a=r.key;if(a&&"normal"==a){var l=r.styleUrl;l&&(t[t.length-1]=l);var n=r.Style;n&&(t[t.length-1]=n)}}}function placemarkStyleMapParser(e,t){var r=readStyleMapValue.call(this,e,t);if(r){var a=t[t.length-1];if(Array.isArray(r))a.Style=r;else{if("string"!=typeof r)throw new Error("`styleMapValue` has an unknown type");a.styleUrl=r}}}var SCHEMA_DATA_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{SimpleData:simpleDataParser});function schemaDataParser(e,t){(0,_xml.parseNode)(SCHEMA_DATA_PARSERS,e,t)}function simpleDataParser(e,t){var r=e.getAttribute("name");if(null!==r){var a=(0,_xsd.readString)(e);t[t.length-1][r]=a}}var LAT_LON_ALT_BOX_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{altitudeMode:(0,_xml.makeObjectPropertySetter)(_xsd.readString),minAltitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),maxAltitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),north:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),south:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),east:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),west:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal)});function latLonAltBoxParser(e,t){var r=(0,_xml.pushParseAndPop)({},LAT_LON_ALT_BOX_PARSERS,e,t);if(r){var a=t[t.length-1],l=[parseFloat(r.west),parseFloat(r.south),parseFloat(r.east),parseFloat(r.north)];a.extent=l,a.altitudeMode=r.altitudeMode,a.minAltitude=parseFloat(r.minAltitude),a.maxAltitude=parseFloat(r.maxAltitude)}}var LOD_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{minLodPixels:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),maxLodPixels:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),minFadeExtent:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),maxFadeExtent:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal)});function lodParser(e,t){var r=(0,_xml.pushParseAndPop)({},LOD_PARSERS,e,t);if(r){var a=t[t.length-1];a.minLodPixels=parseFloat(r.minLodPixels),a.maxLodPixels=parseFloat(r.maxLodPixels),a.minFadeExtent=parseFloat(r.minFadeExtent),a.maxFadeExtent=parseFloat(r.maxFadeExtent)}}var INNER_BOUNDARY_IS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LinearRing:(0,_xml.makeArrayPusher)(readFlatLinearRing)});function innerBoundaryIsParser(e,t){var r=(0,_xml.pushParseAndPop)([],INNER_BOUNDARY_IS_PARSERS,e,t);if(r.length>0){var a=t[t.length-1];a.push.apply(a,_toConsumableArray(r))}}var OUTER_BOUNDARY_IS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LinearRing:(0,_xml.makeReplacer)(readFlatLinearRing)});function outerBoundaryIsParser(e,t){var r=(0,_xml.pushParseAndPop)(void 0,OUTER_BOUNDARY_IS_PARSERS,e,t);r&&(t[t.length-1][0]=r)}function linkParser(e,t){(0,_xml.parseNode)(LINK_PARSERS,e,t)}function whenParser(e,t){var r=t[t.length-1].whens,a=(0,_xml.getAllTextContent)(e,!1),l=Date.parse(a);r.push(isNaN(l)?0:l)}function writeColorTextNode(e,t){for(var r=(0,_color.asArray)(t),a=[255*(4==r.length?r[3]:1),r[2],r[1],r[0]],l=0;l<4;++l){var n=Math.floor(a[l]).toString(16);a[l]=1==n.length?"0"+n:n}(0,_xsd.writeStringTextNode)(e,a.join(""))}function writeCoordinatesTextNode(e,t,r){var a,l=r[r.length-1],n=l.layout,o=l.stride;if("XY"==n||"XYM"==n)a=2;else{if("XYZ"!=n&&"XYZM"!=n)throw new Error("Invalid geometry layout");a=3}var i=t.length,_="";if(i>0){_+=t[0];for(var S=1;S<a;++S)_+=","+t[S];for(var m=o;m<i;m+=o){_+=" "+t[m];for(var u=1;u<a;++u)_+=","+t[m+u]}}(0,_xsd.writeStringTextNode)(e,_)}var EXTENDEDDATA_NODE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Data:(0,_xml.makeChildAppender)(writeDataNode),value:(0,_xml.makeChildAppender)(writeDataNodeValue),displayName:(0,_xml.makeChildAppender)(writeDataNodeName)});function writeDataNode(e,t,r){e.setAttribute("name",t.name);var a={node:e},l=t.value;"object"==_typeof(l)?(null!==l&&l.displayName&&(0,_xml.pushSerializeAndPop)(a,EXTENDEDDATA_NODE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,[l.displayName],r,["displayName"]),null!==l&&l.value&&(0,_xml.pushSerializeAndPop)(a,EXTENDEDDATA_NODE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,[l.value],r,["value"])):(0,_xml.pushSerializeAndPop)(a,EXTENDEDDATA_NODE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,[l],r,["value"])}function writeDataNodeName(e,t){(0,_xsd.writeCDATASection)(e,t)}function writeDataNodeValue(e,t){(0,_xsd.writeStringTextNode)(e,t)}var DOCUMENT_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Placemark:(0,_xml.makeChildAppender)(writePlacemark)}),DOCUMENT_NODE_FACTORY=function(e,t,r){var a=t[t.length-1].node;return(0,_xml.createElementNS)(a.namespaceURI,"Placemark")};function writeDocument(e,t,r){var a={node:e};(0,_xml.pushSerializeAndPop)(a,DOCUMENT_SERIALIZERS,DOCUMENT_NODE_FACTORY,t,r,void 0,this)}var DATA_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("Data");function writeExtendedData(e,t,r){for(var a={node:e},l=t.names,n=t.values,o=l.length,i=0;i<o;i++)(0,_xml.pushSerializeAndPop)(a,EXTENDEDDATA_NODE_SERIALIZERS,DATA_NODE_FACTORY,[{name:l[i],value:n[i]}],r)}var ICON_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["href"],(0,_xml.makeStructureNS)(GX_NAMESPACE_URIS,["x","y","w","h"])),ICON_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{href:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)},(0,_xml.makeStructureNS)(GX_NAMESPACE_URIS,{x:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),y:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),w:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),h:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode)})),GX_NODE_FACTORY=function(e,t,r){return(0,_xml.createElementNS)(GX_NAMESPACE_URIS[0],"gx:"+r)};function writeIcon(e,t,r){var a={node:e},l=r[r.length-1].node,n=ICON_SEQUENCE[l.namespaceURI],o=(0,_xml.makeSequence)(t,n);(0,_xml.pushSerializeAndPop)(a,ICON_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,o,r,n),n=ICON_SEQUENCE[GX_NAMESPACE_URIS[0]],o=(0,_xml.makeSequence)(t,n),(0,_xml.pushSerializeAndPop)(a,ICON_SERIALIZERS,GX_NODE_FACTORY,o,r,n)}var ICON_STYLE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["scale","heading","Icon","color","hotSpot"]),ICON_STYLE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Icon:(0,_xml.makeChildAppender)(writeIcon),color:(0,_xml.makeChildAppender)(writeColorTextNode),heading:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode),hotSpot:(0,_xml.makeChildAppender)(writeVec2),scale:(0,_xml.makeChildAppender)(writeScaleTextNode)});function writeIconStyle(e,t,r){var a={node:e},l={},n=t.getSrc(),o=t.getSize(),i=t.getImageSize(),_={href:n};if(o){_.w=o[0],_.h=o[1];var S=t.getAnchor(),m=t.getOrigin();if(m&&i&&0!==m[0]&&m[1]!==o[1]&&(_.x=m[0],_.y=i[1]-(m[1]+o[1])),S&&(S[0]!==o[0]/2||S[1]!==o[1]/2)){var u={x:S[0],xunits:"pixels",y:o[1]-S[1],yunits:"pixels"};l.hotSpot=u}}l.Icon=_;var s=t.getScaleArray()[0],d=o;(null===d&&(d=DEFAULT_IMAGE_STYLE_SIZE),2==d.length)&&(s/=scaleForSize(d));1!==s&&(l.scale=s);var E=t.getRotation();0!==E&&(l.heading=E);var A=t.getColor();A&&(l.color=A);var c=r[r.length-1].node,y=ICON_STYLE_SEQUENCE[c.namespaceURI],p=(0,_xml.makeSequence)(l,y);(0,_xml.pushSerializeAndPop)(a,ICON_STYLE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,p,r,y)}var LABEL_STYLE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["color","scale"]),LABEL_STYLE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{color:(0,_xml.makeChildAppender)(writeColorTextNode),scale:(0,_xml.makeChildAppender)(writeScaleTextNode)});function writeLabelStyle(e,t,r){var a={node:e},l={},n=t.getFill();n&&(l.color=n.getColor());var o=t.getScale();o&&1!==o&&(l.scale=o);var i=r[r.length-1].node,_=LABEL_STYLE_SEQUENCE[i.namespaceURI],S=(0,_xml.makeSequence)(l,_);(0,_xml.pushSerializeAndPop)(a,LABEL_STYLE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,S,r,_)}var LINE_STYLE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["color","width"]),LINE_STYLE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{color:(0,_xml.makeChildAppender)(writeColorTextNode),width:(0,_xml.makeChildAppender)(_xsd.writeDecimalTextNode)});function writeLineStyle(e,t,r){var a={node:e},l={color:t.getColor(),width:Number(t.getWidth())||1},n=r[r.length-1].node,o=LINE_STYLE_SEQUENCE[n.namespaceURI],i=(0,_xml.makeSequence)(l,o);(0,_xml.pushSerializeAndPop)(a,LINE_STYLE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,i,r,o)}var GEOMETRY_TYPE_TO_NODENAME={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},GEOMETRY_NODE_FACTORY=function(e,t,r){if(e){var a=t[t.length-1].node;return(0,_xml.createElementNS)(a.namespaceURI,GEOMETRY_TYPE_TO_NODENAME[e.getType()])}},POINT_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("Point"),LINE_STRING_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("LineString"),LINEAR_RING_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("LinearRing"),POLYGON_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("Polygon"),MULTI_GEOMETRY_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LineString:(0,_xml.makeChildAppender)(writePrimitiveGeometry),Point:(0,_xml.makeChildAppender)(writePrimitiveGeometry),Polygon:(0,_xml.makeChildAppender)(writePolygon),GeometryCollection:(0,_xml.makeChildAppender)(writeMultiGeometry)});function writeMultiGeometry(e,t,r){var a,l={node:e},n=t.getType(),o=[];if("GeometryCollection"===n)t.getGeometriesArrayRecursive().forEach(function(e){var t=e.getType();if("MultiPoint"===t)o=o.concat(e.getPoints());else if("MultiLineString"===t)o=o.concat(e.getLineStrings());else if("MultiPolygon"===t)o=o.concat(e.getPolygons());else{if("Point"!==t&&"LineString"!==t&&"Polygon"!==t)throw new Error("Unknown geometry type");o.push(e)}}),a=GEOMETRY_NODE_FACTORY;else if("MultiPoint"===n)o=t.getPoints(),a=POINT_NODE_FACTORY;else if("MultiLineString"===n)o=t.getLineStrings(),a=LINE_STRING_NODE_FACTORY;else{if("MultiPolygon"!==n)throw new Error("Unknown geometry type");o=t.getPolygons(),a=POLYGON_NODE_FACTORY}(0,_xml.pushSerializeAndPop)(l,MULTI_GEOMETRY_SERIALIZERS,a,o,r)}var BOUNDARY_IS_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LinearRing:(0,_xml.makeChildAppender)(writePrimitiveGeometry)});function writeBoundaryIs(e,t,r){var a={node:e};(0,_xml.pushSerializeAndPop)(a,BOUNDARY_IS_SERIALIZERS,LINEAR_RING_NODE_FACTORY,[t],r)}var PLACEMARK_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ExtendedData:(0,_xml.makeChildAppender)(writeExtendedData),MultiGeometry:(0,_xml.makeChildAppender)(writeMultiGeometry),LineString:(0,_xml.makeChildAppender)(writePrimitiveGeometry),LinearRing:(0,_xml.makeChildAppender)(writePrimitiveGeometry),Point:(0,_xml.makeChildAppender)(writePrimitiveGeometry),Polygon:(0,_xml.makeChildAppender)(writePolygon),Style:(0,_xml.makeChildAppender)(writeStyle),address:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),description:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),name:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),open:(0,_xml.makeChildAppender)(_xsd.writeBooleanTextNode),phoneNumber:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),styleUrl:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),visibility:(0,_xml.makeChildAppender)(_xsd.writeBooleanTextNode)}),PLACEMARK_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),EXTENDEDDATA_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("ExtendedData");function writePlacemark(e,t,r){var a={node:e};t.getId()&&e.setAttribute("id",t.getId());var l=t.getProperties(),n={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};n[t.getGeometryName()]=1;var o=Object.keys(l||{}).sort().filter(function(e){return!n[e]}),i=t.getStyleFunction();if(i){var _=i(t,0);if(_){var S=Array.isArray(_)?_:[_],m=S;if(t.getGeometry()&&(m=S.filter(function(e){var r=e.getGeometryFunction()(t);if(r){var a=r.getType();return"GeometryCollection"===a?r.getGeometriesArrayRecursive().filter(function(e){var t=e.getType();return"Point"===t||"MultiPoint"===t}).length:"Point"===a||"MultiPoint"===a}})),this.writeStyles_){var u=S,s=S;t.getGeometry()&&(u=S.filter(function(e){var r=e.getGeometryFunction()(t);if(r){var a=r.getType();return"GeometryCollection"===a?r.getGeometriesArrayRecursive().filter(function(e){var t=e.getType();return"LineString"===t||"MultiLineString"===t}).length:"LineString"===a||"MultiLineString"===a}}),s=S.filter(function(e){var r=e.getGeometryFunction()(t);if(r){var a=r.getType();return"GeometryCollection"===a?r.getGeometriesArrayRecursive().filter(function(e){var t=e.getType();return"Polygon"===t||"MultiPolygon"===t}).length:"Polygon"===a||"MultiPolygon"===a}})),l.Style={pointStyles:m,lineStyles:u,polyStyles:s}}if(m.length&&void 0===l.name){var d=m[0].getText();d&&(l.name=d.getText())}}}var E=r[r.length-1].node,A=PLACEMARK_SEQUENCE[E.namespaceURI],c=(0,_xml.makeSequence)(l,A);if((0,_xml.pushSerializeAndPop)(a,PLACEMARK_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,c,r,A),o.length>0){var y={names:o,values:(0,_xml.makeSequence)(l,o)};(0,_xml.pushSerializeAndPop)(a,PLACEMARK_SERIALIZERS,EXTENDEDDATA_NODE_FACTORY,[y],r)}var p=r[0],x=t.getGeometry();x&&(x=(0,_Feature2.transformGeometryWithOptions)(x,!0,p)),(0,_xml.pushSerializeAndPop)(a,PLACEMARK_SERIALIZERS,GEOMETRY_NODE_FACTORY,[x],r)}var PRIMITIVE_GEOMETRY_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["extrude","tessellate","altitudeMode","coordinates"]),PRIMITIVE_GEOMETRY_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{extrude:(0,_xml.makeChildAppender)(_xsd.writeBooleanTextNode),tessellate:(0,_xml.makeChildAppender)(_xsd.writeBooleanTextNode),altitudeMode:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode),coordinates:(0,_xml.makeChildAppender)(writeCoordinatesTextNode)});function writePrimitiveGeometry(e,t,r){var a=t.getFlatCoordinates(),l={node:e};l.layout=t.getLayout(),l.stride=t.getStride();var n=t.getProperties();n.coordinates=a;var o=r[r.length-1].node,i=PRIMITIVE_GEOMETRY_SEQUENCE[o.namespaceURI],_=(0,_xml.makeSequence)(n,i);(0,_xml.pushSerializeAndPop)(l,PRIMITIVE_GEOMETRY_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,_,r,i)}var POLY_STYLE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["color","fill","outline"]),POLYGON_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{outerBoundaryIs:(0,_xml.makeChildAppender)(writeBoundaryIs),innerBoundaryIs:(0,_xml.makeChildAppender)(writeBoundaryIs)}),INNER_BOUNDARY_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("innerBoundaryIs"),OUTER_BOUNDARY_NODE_FACTORY=(0,_xml.makeSimpleNodeFactory)("outerBoundaryIs");function writePolygon(e,t,r){var a=t.getLinearRings(),l=a.shift(),n={node:e};(0,_xml.pushSerializeAndPop)(n,POLYGON_SERIALIZERS,INNER_BOUNDARY_NODE_FACTORY,a,r),(0,_xml.pushSerializeAndPop)(n,POLYGON_SERIALIZERS,OUTER_BOUNDARY_NODE_FACTORY,[l],r)}var POLY_STYLE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{color:(0,_xml.makeChildAppender)(writeColorTextNode),fill:(0,_xml.makeChildAppender)(_xsd.writeBooleanTextNode),outline:(0,_xml.makeChildAppender)(_xsd.writeBooleanTextNode)});function writePolyStyle(e,t,r){var a={node:e},l=t.getFill(),n=t.getStroke(),o={color:l?l.getColor():void 0,fill:!!l&&void 0,outline:!!n&&void 0},i=r[r.length-1].node,_=POLY_STYLE_SEQUENCE[i.namespaceURI],S=(0,_xml.makeSequence)(o,_);(0,_xml.pushSerializeAndPop)(a,POLY_STYLE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,S,r,_)}function writeScaleTextNode(e,t){(0,_xsd.writeDecimalTextNode)(e,Math.round(1e6*t)/1e6)}var STYLE_SEQUENCE=(0,_xml.makeStructureNS)(NAMESPACE_URIS,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),STYLE_SERIALIZERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{IconStyle:(0,_xml.makeChildAppender)(writeIconStyle),LabelStyle:(0,_xml.makeChildAppender)(writeLabelStyle),LineStyle:(0,_xml.makeChildAppender)(writeLineStyle),PolyStyle:(0,_xml.makeChildAppender)(writePolyStyle)});function writeStyle(e,t,r){var a={node:e},l={};if(t.pointStyles.length){var n=t.pointStyles[0].getText();n&&(l.LabelStyle=n);var o=t.pointStyles[0].getImage();o&&"function"==typeof o.getSrc&&(l.IconStyle=o)}if(t.lineStyles.length){var i=t.lineStyles[0].getStroke();i&&(l.LineStyle=i)}if(t.polyStyles.length){var _=t.polyStyles[0].getStroke();_&&!l.LineStyle&&(l.LineStyle=_),l.PolyStyle=t.polyStyles[0]}var S=r[r.length-1].node,m=STYLE_SEQUENCE[S.namespaceURI],u=(0,_xml.makeSequence)(l,m);(0,_xml.pushSerializeAndPop)(a,STYLE_SERIALIZERS,_xml.OBJECT_PROPERTY_NODE_FACTORY,u,r,m)}function writeVec2(e,t){e.setAttribute("x",String(t.x)),e.setAttribute("y",String(t.y)),e.setAttribute("xunits",t.xunits),e.setAttribute("yunits",t.yunits)}var _default=exports.default=KML;

},{"../Feature.js":82,"../ImageState.js":86,"../array.js":110,"../color.js":113,"../geom/GeometryCollection.js":204,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../math.js":279,"../proj.js":283,"../style/Fill.js":386,"../style/Icon.js":387,"../style/Stroke.js":392,"../style/Style.js":393,"../style/Text.js":394,"../xml.js":418,"./Feature.js":147,"./XMLFeature.js":171,"./xsd.js":199}],159:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireWildcard(require("./Feature.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_pbf=_interopRequireDefault(require("pbf")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_Projection=_interopRequireDefault(require("../proj/Projection.js")),_Feature2=_interopRequireDefault(require("../render/Feature.js")),_proj=require("../proj.js"),_orient=require("../geom/flat/orient.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var MVT=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).dataProjection=new _Projection.default({code:"",units:"tile-pixels"}),r.featureClass=e.featureClass?e.featureClass:_Feature2.default,r.geometryName_=e.geometryName,r.layerName_=e.layerName?e.layerName:"layer",r.layers_=e.layers?e.layers:null,r.idProperty_=e.idProperty,r.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"],r}return _inherits(t,_Feature["default"]),_createClass(t,[{key:"readRawGeometry_",value:function(e,t,r,n){e.pos=t.geometry;for(var o=e.readVarint()+e.pos,i=1,a=0,u=0,l=0,s=0,f=0;e.pos<o;){if(!a){var p=e.readVarint();i=7&p,a=p>>3}if(a--,1===i||2===i)u+=e.readSVarint(),l+=e.readSVarint(),1===i&&s>f&&(n.push(s),f=s),r.push(u,l),s+=2;else{if(7!==i)throw new Error("Invalid command found in the PBF");s>f&&(r.push(r[f],r[f+1]),s+=2)}}s>f&&(n.push(s),f=s)}},{key:"createFeature_",value:function(e,t,r){var n,o=t.type;if(0===o)return null;var i,a=t.properties;this.idProperty_?(i=a[this.idProperty_],delete a[this.idProperty_]):i=t.id,a[this.layerName_]=t.layer.name;var u=[],l=[];this.readRawGeometry_(e,t,u,l);var s=getGeometryType(o,l.length);if(this.featureClass===_Feature2.default)(n=new this.featureClass(s,u,l,2,a,i)).transform(r.dataProjection);else{var f;if("Polygon"==s){var p=(0,_orient.inflateEnds)(u,l);f=p.length>1?new _MultiPolygon.default(u,"XY",p):new _Polygon.default(u,"XY",l)}else f="Point"===s?new _Point.default(u,"XY"):"LineString"===s?new _LineString.default(u,"XY"):"MultiPoint"===s?new _MultiPoint.default(u,"XY"):"MultiLineString"===s?new _MultiLineString.default(u,"XY",l):null;n=new(0,this.featureClass),this.geometryName_&&n.setGeometryName(this.geometryName_);var c=(0,_Feature.transformGeometryWithOptions)(f,!1,r);n.setGeometry(c),void 0!==i&&n.setId(i),n.setProperties(a,!0)}return n}},{key:"getType",value:function(){return"arraybuffer"}},{key:"readFeatures",value:function(e,t){var r=this.layers_;t=this.adaptOptions(t);var n=(0,_proj.get)(t.dataProjection);n.setWorldExtent(t.extent),t.dataProjection=n;var o=new _pbf.default(e),i=o.readFields(layersPBFReader,{}),a=[];for(var u in i)if(!r||r.includes(u)){var l=i[u],s=l?[0,0,l.extent,l.extent]:null;n.setExtent(s);for(var f=0,p=l.length;f<p;++f){var c=readRawFeature(o,l,f),y=this.createFeature_(o,c,t);null!==y&&a.push(y)}}return a}},{key:"readProjection",value:function(e){return this.dataProjection}},{key:"setLayers",value:function(e){this.layers_=e}}])}();function layersPBFReader(e,t,r){if(3===e){var n={keys:[],values:[],features:[]},o=r.readVarint()+r.pos;r.readFields(layerPBFReader,n,o),n.length=n.features.length,n.length&&(t[n.name]=n)}}function layerPBFReader(e,t,r){if(15===e)t.version=r.readVarint();else if(1===e)t.name=r.readString();else if(5===e)t.extent=r.readVarint();else if(2===e)t.features.push(r.pos);else if(3===e)t.keys.push(r.readString());else if(4===e){for(var n=null,o=r.readVarint()+r.pos;r.pos<o;)n=1===(e=r.readVarint()>>3)?r.readString():2===e?r.readFloat():3===e?r.readDouble():4===e?r.readVarint64():5===e?r.readVarint():6===e?r.readSVarint():7===e?r.readBoolean():null;t.values.push(n)}}function featurePBFReader(e,t,r){if(1==e)t.id=r.readVarint();else if(2==e)for(var n=r.readVarint()+r.pos;r.pos<n;){var o=t.layer.keys[r.readVarint()],i=t.layer.values[r.readVarint()];t.properties[o]=i}else 3==e?t.type=r.readVarint():4==e&&(t.geometry=r.pos)}function readRawFeature(e,t,r){e.pos=t.features[r];var n=e.readVarint()+e.pos,o={layer:t,type:0,properties:{}};return e.readFields(featurePBFReader,o,n),o}function getGeometryType(e,t){var r;return 1===e?r=1===t?"Point":"MultiPoint":2===e?r=1===t?"LineString":"MultiLineString":3===e&&(r="Polygon"),r}var _default=exports.default=MVT;

},{"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../geom/flat/orient.js":226,"../proj.js":283,"../proj/Projection.js":284,"../render/Feature.js":295,"./Feature.js":147,"pbf":419}],160:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _XML2=_interopRequireDefault(require("./XML.js")),_xml=require("../xml.js"),_xlink=require("./xlink.js"),_xsd=require("./xsd.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var NAMESPACE_URIS=[null,"http://www.opengis.net/ows/1.1"],PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ServiceIdentification:(0,_xml.makeObjectPropertySetter)(readServiceIdentification),ServiceProvider:(0,_xml.makeObjectPropertySetter)(readServiceProvider),OperationsMetadata:(0,_xml.makeObjectPropertySetter)(readOperationsMetadata)}),OWS=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t)}return _inherits(t,_XML2["default"]),_createClass(t,[{key:"readFromNode",value:function(e){var t=(0,_xml.pushParseAndPop)({},PARSERS,e,[]);return t||null}}])}(),ADDRESS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{DeliveryPoint:(0,_xml.makeObjectPropertySetter)(_xsd.readString),City:(0,_xml.makeObjectPropertySetter)(_xsd.readString),AdministrativeArea:(0,_xml.makeObjectPropertySetter)(_xsd.readString),PostalCode:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Country:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ElectronicMailAddress:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),ALLOWED_VALUES_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Value:(0,_xml.makeObjectPropertyPusher)(readValue)}),CONSTRAINT_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{AllowedValues:(0,_xml.makeObjectPropertySetter)(readAllowedValues)}),CONTACT_INFO_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Phone:(0,_xml.makeObjectPropertySetter)(readPhone),Address:(0,_xml.makeObjectPropertySetter)(readAddress)}),DCP_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{HTTP:(0,_xml.makeObjectPropertySetter)(readHttp)}),HTTP_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Get:(0,_xml.makeObjectPropertyPusher)(readGet),Post:void 0}),OPERATION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{DCP:(0,_xml.makeObjectPropertySetter)(readDcp)}),OPERATIONS_METADATA_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Operation:readOperation}),PHONE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Voice:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Facsimile:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),REQUEST_METHOD_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Constraint:(0,_xml.makeObjectPropertyPusher)(readConstraint)}),SERVICE_CONTACT_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{IndividualName:(0,_xml.makeObjectPropertySetter)(_xsd.readString),PositionName:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ContactInfo:(0,_xml.makeObjectPropertySetter)(readContactInfo)}),SERVICE_IDENTIFICATION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Abstract:(0,_xml.makeObjectPropertySetter)(_xsd.readString),AccessConstraints:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Fees:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ServiceTypeVersion:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ServiceType:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),SERVICE_PROVIDER_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ProviderName:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ProviderSite:(0,_xml.makeObjectPropertySetter)(_xlink.readHref),ServiceContact:(0,_xml.makeObjectPropertySetter)(readServiceContact)});function readAddress(e,t){return(0,_xml.pushParseAndPop)({},ADDRESS_PARSERS,e,t)}function readAllowedValues(e,t){return(0,_xml.pushParseAndPop)({},ALLOWED_VALUES_PARSERS,e,t)}function readConstraint(e,t){var r=e.getAttribute("name");if(r)return(0,_xml.pushParseAndPop)({name:r},CONSTRAINT_PARSERS,e,t)}function readContactInfo(e,t){return(0,_xml.pushParseAndPop)({},CONTACT_INFO_PARSERS,e,t)}function readDcp(e,t){return(0,_xml.pushParseAndPop)({},DCP_PARSERS,e,t)}function readGet(e,t){var r=(0,_xlink.readHref)(e);if(r)return(0,_xml.pushParseAndPop)({href:r},REQUEST_METHOD_PARSERS,e,t)}function readHttp(e,t){return(0,_xml.pushParseAndPop)({},HTTP_PARSERS,e,t)}function readOperation(e,t){var r=e.getAttribute("name"),o=(0,_xml.pushParseAndPop)({},OPERATION_PARSERS,e,t);o&&(t[t.length-1][r]=o)}function readOperationsMetadata(e,t){return(0,_xml.pushParseAndPop)({},OPERATIONS_METADATA_PARSERS,e,t)}function readPhone(e,t){return(0,_xml.pushParseAndPop)({},PHONE_PARSERS,e,t)}function readServiceIdentification(e,t){return(0,_xml.pushParseAndPop)({},SERVICE_IDENTIFICATION_PARSERS,e,t)}function readServiceContact(e,t){return(0,_xml.pushParseAndPop)({},SERVICE_CONTACT_PARSERS,e,t)}function readServiceProvider(e,t){return(0,_xml.pushParseAndPop)({},SERVICE_PROVIDER_PARSERS,e,t)}function readValue(e,t){return(0,_xsd.readString)(e)}var _default=exports.default=OWS;

},{"../xml.js":418,"./XML.js":170,"./xlink.js":198,"./xsd.js":199}],161:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeDeltas=decodeDeltas,exports.decodeFloats=decodeFloats,exports.decodeSignedIntegers=decodeSignedIntegers,exports.decodeUnsignedIntegers=decodeUnsignedIntegers,exports.default=void 0,exports.encodeDeltas=encodeDeltas,exports.encodeFloats=encodeFloats,exports.encodeSignedIntegers=encodeSignedIntegers,exports.encodeUnsignedInteger=encodeUnsignedInteger,exports.encodeUnsignedIntegers=encodeUnsignedIntegers;var _Feature=_interopRequireDefault(require("../Feature.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_TextFeature2=_interopRequireDefault(require("./TextFeature.js")),_flip=require("../geom/flat/flip.js"),_proj=require("../proj.js"),_SimpleGeometry=require("../geom/SimpleGeometry.js"),_inflate=require("../geom/flat/inflate.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Polyline=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).dataProjection=(0,_proj.get)("EPSG:4326"),r.factor_=e.factor?e.factor:1e5,r.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY",r}return _inherits(t,_TextFeature2["default"]),_createClass(t,[{key:"readFeatureFromText",value:function(e,t){var r=this.readGeometryFromText(e,t);return new _Feature.default(r)}},{key:"readFeaturesFromText",value:function(e,t){return[this.readFeatureFromText(e,t)]}},{key:"readGeometryFromText",value:function(e,t){var r=(0,_SimpleGeometry.getStrideForLayout)(this.geometryLayout_),o=decodeDeltas(e,r,this.factor_);(0,_flip.flipXY)(o,0,o.length,r,o);var n=(0,_inflate.inflateCoordinates)(o,0,o.length,r),i=new _LineString.default(n,this.geometryLayout_);return(0,_Feature2.transformGeometryWithOptions)(i,!1,this.adaptOptions(t))}},{key:"writeFeatureText",value:function(e,t){var r=e.getGeometry();if(r)return this.writeGeometryText(r,t);throw new Error("Expected `feature` to have a geometry")}},{key:"writeFeaturesText",value:function(e,t){return this.writeFeatureText(e[0],t)}},{key:"writeGeometryText",value:function(e,t){var r=(e=(0,_Feature2.transformGeometryWithOptions)(e,!0,this.adaptOptions(t))).getFlatCoordinates(),o=e.getStride();return(0,_flip.flipXY)(r,0,r.length,o,r),encodeDeltas(r,o,this.factor_)}}])}();function encodeDeltas(e,t,r){var o;r=r||1e5;var n=new Array(t);for(o=0;o<t;++o)n[o]=0;for(var i=0,a=e.length;i<a;)for(o=0;o<t;++o,++i){var u=e[i],s=u-n[o];n[o]=u,e[i]=s}return encodeFloats(e,r)}function decodeDeltas(e,t,r){var o;r=r||1e5;var n=new Array(t);for(o=0;o<t;++o)n[o]=0;for(var i=decodeFloats(e,r),a=0,u=i.length;a<u;)for(o=0;o<t;++o,++a)n[o]+=i[a],i[a]=n[o];return i}function encodeFloats(e,t){t=t||1e5;for(var r=0,o=e.length;r<o;++r)e[r]=Math.round(e[r]*t);return encodeSignedIntegers(e)}function decodeFloats(e,t){t=t||1e5;for(var r=decodeSignedIntegers(e),o=0,n=r.length;o<n;++o)r[o]/=t;return r}function encodeSignedIntegers(e){for(var t=0,r=e.length;t<r;++t){var o=e[t];e[t]=o<0?~(o<<1):o<<1}return encodeUnsignedIntegers(e)}function decodeSignedIntegers(e){for(var t=decodeUnsignedIntegers(e),r=0,o=t.length;r<o;++r){var n=t[r];t[r]=1&n?~(n>>1):n>>1}return t}function encodeUnsignedIntegers(e){for(var t="",r=0,o=e.length;r<o;++r)t+=encodeUnsignedInteger(e[r]);return t}function decodeUnsignedIntegers(e){for(var t=[],r=0,o=0,n=0,i=e.length;n<i;++n){var a=e.charCodeAt(n)-63;r|=(31&a)<<o,a<32?(t.push(r),r=0,o=0):o+=5}return t}function encodeUnsignedInteger(e){for(var t,r="";e>=32;)t=63+(32|31&e),r+=String.fromCharCode(t),e>>=5;return t=e+63,r+=String.fromCharCode(t)}var _default=exports.default=Polyline;

},{"../Feature.js":82,"../geom/LineString.js":205,"../geom/SimpleGeometry.js":212,"../geom/flat/flip.js":218,"../geom/flat/inflate.js":220,"../proj.js":283,"./Feature.js":147,"./TextFeature.js":162}],162:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../format/Feature.js")),_util=require("../util.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var TextFeature=function(t){function e(){return _classCallCheck(this,e),_callSuper(this,e)}return _inherits(e,_Feature["default"]),_createClass(e,[{key:"getType",value:function(){return"text"}},{key:"readFeature",value:function(t,e){return this.readFeatureFromText(getText(t),this.adaptOptions(e))}},{key:"readFeatureFromText",value:function(t,e){return(0,_util.abstract)()}},{key:"readFeatures",value:function(t,e){return this.readFeaturesFromText(getText(t),this.adaptOptions(e))}},{key:"readFeaturesFromText",value:function(t,e){return(0,_util.abstract)()}},{key:"readGeometry",value:function(t,e){return this.readGeometryFromText(getText(t),this.adaptOptions(e))}},{key:"readGeometryFromText",value:function(t,e){return(0,_util.abstract)()}},{key:"readProjection",value:function(t){return this.readProjectionFromText(getText(t))}},{key:"readProjectionFromText",value:function(t){return this.dataProjection}},{key:"writeFeature",value:function(t,e){return this.writeFeatureText(t,this.adaptOptions(e))}},{key:"writeFeatureText",value:function(t,e){return(0,_util.abstract)()}},{key:"writeFeatures",value:function(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))}},{key:"writeFeaturesText",value:function(t,e){return(0,_util.abstract)()}},{key:"writeGeometry",value:function(t,e){return this.writeGeometryText(t,this.adaptOptions(e))}},{key:"writeGeometryText",value:function(t,e){return(0,_util.abstract)()}}])}();function getText(t){return"string"==typeof t?t:""}var _default=exports.default=TextFeature;

},{"../format/Feature.js":147,"../util.js":404}],163:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_JSONFeature2=_interopRequireDefault(require("./JSONFeature.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_proj=require("../proj.js"),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TopoJSON=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).layerName_=e.layerName,r.layers_=e.layers?e.layers:null,r.dataProjection=(0,_proj.get)(e.dataProjection?e.dataProjection:"EPSG:4326"),r}return _inherits(t,_JSONFeature2["default"]),_createClass(t,[{key:"readFeaturesFromObject",value:function(e,t){if("Topology"==e.type){var r,o=e,n=null,i=null;o.transform&&(n=(r=o.transform).scale,i=r.translate);var u=o.arcs;r&&transformArcs(u,n,i);var a,l=[],c=o.objects,f=this.layerName_;for(var s in c)this.layers_&&!this.layers_.includes(s)||("GeometryCollection"===c[s].type?(a=c[s],l.push.apply(l,readFeaturesFromGeometryCollection(a,u,n,i,f,s,t))):(a=c[s],l.push(readFeatureFromGeometry(a,u,n,i,f,s,t))));return l}return[]}},{key:"readProjectionFromObject",value:function(e){return this.dataProjection}}])}(),GEOMETRY_READERS={Point:readPointGeometry,LineString:readLineStringGeometry,Polygon:readPolygonGeometry,MultiPoint:readMultiPointGeometry,MultiLineString:readMultiLineStringGeometry,MultiPolygon:readMultiPolygonGeometry};function concatenateArcs(e,t){for(var r,o=[],n=0,i=e.length;n<i;++n)if(r=e[n],n>0&&o.pop(),r>=0)for(var u=t[r],a=0,l=u.length;a<l;++a)o.push(u[a].slice(0));else for(var c=t[~r],f=c.length-1;f>=0;--f)o.push(c[f].slice(0));return o}function readPointGeometry(e,t,r){var o=e.coordinates;return t&&r&&transformVertex(o,t,r),new _Point.default(o)}function readMultiPointGeometry(e,t,r){var o=e.coordinates;if(t&&r)for(var n=0,i=o.length;n<i;++n)transformVertex(o[n],t,r);return new _MultiPoint.default(o)}function readLineStringGeometry(e,t){var r=concatenateArcs(e.arcs,t);return new _LineString.default(r)}function readMultiLineStringGeometry(e,t){for(var r=[],o=0,n=e.arcs.length;o<n;++o)r[o]=concatenateArcs(e.arcs[o],t);return new _MultiLineString.default(r)}function readPolygonGeometry(e,t){for(var r=[],o=0,n=e.arcs.length;o<n;++o)r[o]=concatenateArcs(e.arcs[o],t);return new _Polygon.default(r)}function readMultiPolygonGeometry(e,t){for(var r=[],o=0,n=e.arcs.length;o<n;++o){for(var i=e.arcs[o],u=[],a=0,l=i.length;a<l;++a)u[a]=concatenateArcs(i[a],t);r[o]=u}return new _MultiPolygon.default(r)}function readFeaturesFromGeometryCollection(e,t,r,o,n,i,u){for(var a=e.geometries,l=[],c=0,f=a.length;c<f;++c)l[c]=readFeatureFromGeometry(a[c],t,r,o,n,i,u);return l}function readFeatureFromGeometry(e,t,r,o,n,i,u){var a=null,l=e.type;if(l){var c=GEOMETRY_READERS[l];a="Point"===l||"MultiPoint"===l?c(e,r,o):c(e,t),a=(0,_Feature2.transformGeometryWithOptions)(a,!1,u)}var f=new _Feature.default({geometry:a});void 0!==e.id&&f.setId(e.id);var s=e.properties;return n&&(s||(s={}),s[n]=i),s&&f.setProperties(s,!0),f}function transformArcs(e,t,r){for(var o=0,n=e.length;o<n;++o)transformArc(e[o],t,r)}function transformArc(e,t,r){for(var o=0,n=0,i=0,u=e.length;i<u;++i){var a=e[i];o+=a[0],n+=a[1],a[0]=o,a[1]=n,transformVertex(a,t,r)}}function transformVertex(e,t,r){e[0]=e[0]*t[0]+r[0],e[1]=e[1]*t[1]+r[1]}var _default=exports.default=TopoJSON;

},{"../Feature.js":82,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../proj.js":283,"./Feature.js":147,"./JSONFeature.js":157}],164:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.writeFilter=writeFilter;var _GML=_interopRequireDefault(require("./GML2.js")),_GML2=_interopRequireDefault(require("./GML3.js")),_GML3=_interopRequireDefault(require("./GML32.js")),_GMLBase=_interopRequireWildcard(require("./GMLBase.js")),_XMLFeature2=_interopRequireDefault(require("./XMLFeature.js")),_xml=require("../xml.js"),_filter=require("./filter.js"),_asserts=require("../asserts.js"),_proj=require("../proj.js"),_xsd=require("./xsd.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var FEATURE_COLLECTION_PARSERS={"http://www.opengis.net/gml":{boundedBy:(0,_xml.makeObjectPropertySetter)(_GMLBase.default.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:(0,_xml.makeArrayPusher)(_GMLBase.default.prototype.readFeaturesInternal)}},TRANSACTION_SUMMARY_PARSERS={"http://www.opengis.net/wfs":{totalInserted:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),totalUpdated:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),totalDeleted:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger)},"http://www.opengis.net/wfs/2.0":{totalInserted:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),totalUpdated:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),totalDeleted:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger)}},TRANSACTION_RESPONSE_PARSERS={"http://www.opengis.net/wfs":{TransactionSummary:(0,_xml.makeObjectPropertySetter)(readTransactionSummary,"transactionSummary"),InsertResults:(0,_xml.makeObjectPropertySetter)(readInsertResults,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:(0,_xml.makeObjectPropertySetter)(readTransactionSummary,"transactionSummary"),InsertResults:(0,_xml.makeObjectPropertySetter)(readInsertResults,"insertIds")}},QUERY_SERIALIZERS={"http://www.opengis.net/wfs":{PropertyName:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)},"http://www.opengis.net/wfs/2.0":{PropertyName:(0,_xml.makeChildAppender)(_xsd.writeStringTextNode)}},TRANSACTION_SERIALIZERS={"http://www.opengis.net/wfs":{Insert:(0,_xml.makeChildAppender)(writeFeature),Update:(0,_xml.makeChildAppender)(writeUpdate),Delete:(0,_xml.makeChildAppender)(writeDelete),Property:(0,_xml.makeChildAppender)(writeProperty),Native:(0,_xml.makeChildAppender)(writeNative)},"http://www.opengis.net/wfs/2.0":{Insert:(0,_xml.makeChildAppender)(writeFeature),Update:(0,_xml.makeChildAppender)(writeUpdate),Delete:(0,_xml.makeChildAppender)(writeDelete),Property:(0,_xml.makeChildAppender)(writeProperty),Native:(0,_xml.makeChildAppender)(writeNative)}},FEATURE_PREFIX="feature",XMLNS="http://www.w3.org/2000/xmlns/",OGCNS={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},WFSNS={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},FESNS={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},SCHEMA_LOCATIONS={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},GML_FORMATS={"2.0.0":_GML3.default,"1.1.0":_GML2.default,"1.0.0":_GML.default},DEFAULT_VERSION="1.1.0",WFS=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).version_=e.version?e.version:DEFAULT_VERSION,r.featureType_=e.featureType,r.featureNS_=e.featureNS,r.gmlFormat_=e.gmlFormat?e.gmlFormat:new GML_FORMATS[r.version_],r.schemaLocation_=e.schemaLocation?e.schemaLocation:SCHEMA_LOCATIONS[r.version_],r}return _inherits(t,_XMLFeature2["default"]),_createClass(t,[{key:"getFeatureType",value:function(){return this.featureType_}},{key:"setFeatureType",value:function(e){this.featureType_=e}},{key:"readFeaturesFromNode",value:function(e,t){var r={node:e};Object.assign(r,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(r,this.getReadOptions(e,t||{}));var i,n=[r];i="2.0.0"===this.version_?FEATURE_COLLECTION_PARSERS:this.gmlFormat_.FEATURE_COLLECTION_PARSERS;var a=(0,_xml.pushParseAndPop)([],i,e,n,this.gmlFormat_);return a||(a=[]),a}},{key:"readTransactionResponse",value:function(e){if(e){if("string"==typeof e){var t=(0,_xml.parse)(e);return this.readTransactionResponseFromDocument(t)}return(0,_xml.isDocument)(e)?this.readTransactionResponseFromDocument(e):this.readTransactionResponseFromNode(e)}}},{key:"readFeatureCollectionMetadata",value:function(e){if(e){if("string"==typeof e){var t=(0,_xml.parse)(e);return this.readFeatureCollectionMetadataFromDocument(t)}return(0,_xml.isDocument)(e)?this.readFeatureCollectionMetadataFromDocument(e):this.readFeatureCollectionMetadataFromNode(e)}}},{key:"readFeatureCollectionMetadataFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)}},{key:"readFeatureCollectionMetadataFromNode",value:function(e){var t={},r=(0,_xsd.readNonNegativeIntegerString)(e.getAttribute("numberOfFeatures"));return t.numberOfFeatures=r,(0,_xml.pushParseAndPop)(t,FEATURE_COLLECTION_PARSERS,e,[],this.gmlFormat_)}},{key:"readTransactionResponseFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)}},{key:"readTransactionResponseFromNode",value:function(e){return(0,_xml.pushParseAndPop)({},TRANSACTION_RESPONSE_PARSERS,e,[])}},{key:"writeGetFeature",value:function(e){var t=this,r=(0,_xml.createElementNS)(WFSNS[this.version_],"GetFeature");r.setAttribute("service","WFS"),r.setAttribute("version",this.version_),e.handle&&r.setAttribute("handle",e.handle),e.outputFormat&&r.setAttribute("outputFormat",e.outputFormat),void 0!==e.maxFeatures&&r.setAttribute("maxFeatures",String(e.maxFeatures)),e.resultType&&r.setAttribute("resultType",e.resultType),void 0!==e.startIndex&&r.setAttribute("startIndex",String(e.startIndex)),void 0!==e.count&&r.setAttribute("count",String(e.count)),void 0!==e.viewParams&&r.setAttribute("viewParams",e.viewParams),r.setAttributeNS(_xml.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation_);var i={node:r};if(Object.assign(i,{version:this.version_,srsName:e.srsName,featureNS:e.featureNS?e.featureNS:this.featureNS_,featurePrefix:e.featurePrefix,propertyNames:e.propertyNames?e.propertyNames:[]}),(0,_asserts.assert)(Array.isArray(e.featureTypes),"`options.featureTypes` must be an Array"),"string"==typeof e.featureTypes[0]){var n=e.filter;e.bbox&&((0,_asserts.assert)(e.geometryName,"`options.geometryName` must also be provided when `options.bbox` is set"),n=this.combineBboxAndFilter(e.geometryName,e.bbox,e.srsName,n)),Object.assign(i,{geometryName:e.geometryName,filter:n}),_writeGetFeature(r,e.featureTypes,[i])}else e.featureTypes.forEach(function(n){var a=t.combineBboxAndFilter(n.geometryName,n.bbox,e.srsName,e.filter);Object.assign(i,{geometryName:n.geometryName,filter:a}),_writeGetFeature(r,[n.name],[i])});return r}},{key:"combineBboxAndFilter",value:function(e,t,r,i){var n=(0,_filter.bbox)(e,t,r);return i?(0,_filter.and)(i,n):n}},{key:"writeTransaction",value:function(e,t,r,i){var n,a=[],o=i.version?i.version:this.version_,s=(0,_xml.createElementNS)(WFSNS[o],"Transaction");s.setAttribute("service","WFS"),s.setAttribute("version",o),i&&(n=i.gmlOptions?i.gmlOptions:{},i.handle&&s.setAttribute("handle",i.handle)),s.setAttributeNS(_xml.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",SCHEMA_LOCATIONS[o]);var l=createTransactionRequest(s,n,o,i);return e&&serializeTransactionRequest("Insert",e,a,l),t&&serializeTransactionRequest("Update",t,a,l),r&&serializeTransactionRequest("Delete",r,a,l),i.nativeElements&&serializeTransactionRequest("Native",i.nativeElements,a,l),s}},{key:"readProjectionFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null}},{key:"readProjectionFromNode",value:function(e){if(e.firstElementChild&&e.firstElementChild.firstElementChild)for(var t=(e=e.firstElementChild.firstElementChild).firstElementChild;t;t=t.nextElementSibling)if(0!==t.childNodes.length&&(1!==t.childNodes.length||3!==t.firstChild.nodeType)){var r=[{}];return this.gmlFormat_.readGeometryElement(t,r),(0,_proj.get)(r.pop().srsName)}return null}}])}();function createTransactionRequest(e,t,r,i){var n,a=i.featurePrefix?i.featurePrefix:FEATURE_PREFIX;return"1.0.0"===r?n=2:"1.1.0"===r?n=3:"2.0.0"===r&&(n=3.2),Object.assign({node:e},{version:r,featureNS:i.featureNS,featureType:i.featureType,featurePrefix:a,gmlVersion:n,hasZ:i.hasZ,srsName:i.srsName},t)}function serializeTransactionRequest(e,t,r,i){(0,_xml.pushSerializeAndPop)(i,TRANSACTION_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)(e),t,r)}function readTransactionSummary(e,t){return(0,_xml.pushParseAndPop)({},TRANSACTION_SUMMARY_PARSERS,e,t)}var OGC_FID_PARSERS={"http://www.opengis.net/ogc":{FeatureId:(0,_xml.makeArrayPusher)(function(e,t){return e.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:(0,_xml.makeArrayPusher)(function(e,t){return e.getAttribute("fid")})}};function fidParser(e,t){(0,_xml.parseNode)(OGC_FID_PARSERS,e,t)}var INSERT_RESULTS_PARSERS={"http://www.opengis.net/wfs":{Feature:fidParser},"http://www.opengis.net/wfs/2.0":{Feature:fidParser}};function readInsertResults(e,t){return(0,_xml.pushParseAndPop)([],INSERT_RESULTS_PARSERS,e,t)}function writeFeature(e,t,r){var i=r[r.length-1],n=i.featureType,a=i.featureNS,o=i.gmlVersion,s=(0,_xml.createElementNS)(a,n);e.appendChild(s),2===o?_GML.default.prototype.writeFeatureElement(s,t,r):3===o?_GML2.default.prototype.writeFeatureElement(s,t,r):_GML3.default.prototype.writeFeatureElement(s,t,r)}function writeOgcFidFilter(e,t,r){var i=r[r.length-1].version,n=OGCNS[i],a=(0,_xml.createElementNS)(n,"Filter"),o=(0,_xml.createElementNS)(n,"FeatureId");a.appendChild(o),o.setAttribute("fid",t),e.appendChild(a)}function getTypeName(e,t){var r=(e=e||FEATURE_PREFIX)+":";return t.startsWith(r)?t:r+t}function writeDelete(e,t,r){var i=r[r.length-1];(0,_asserts.assert)(void 0!==t.getId(),"Features must have an id set");var n=i.featureType,a=i.featurePrefix,o=i.featureNS,s=getTypeName(a,n);e.setAttribute("typeName",s),e.setAttributeNS(XMLNS,"xmlns:"+a,o);var l=t.getId();void 0!==l&&writeOgcFidFilter(e,l,r)}function writeUpdate(e,t,r){var i=r[r.length-1];(0,_asserts.assert)(void 0!==t.getId(),"Features must have an id set");var n=i.version,a=i.featureType,o=i.featurePrefix,s=i.featureNS,l=getTypeName(o,a),p=t.getGeometryName();e.setAttribute("typeName",l),e.setAttributeNS(XMLNS,"xmlns:"+o,s);var u=t.getId();if(void 0!==u){for(var m=t.getKeys(),d=[],c=0,f=m.length;c<f;c++){var _=t.get(m[c]);if(void 0!==_){var w=m[c];_&&"function"==typeof _.getSimplifiedGeometry&&(w=p),d.push({name:w,value:_})}}(0,_xml.pushSerializeAndPop)({version:n,gmlVersion:i.gmlVersion,node:e,hasZ:i.hasZ,srsName:i.srsName},TRANSACTION_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)("Property"),d,r),writeOgcFidFilter(e,u,r)}}function writeProperty(e,t,r){var i=r[r.length-1],n=i.version,a=WFSNS[n],o="2.0.0"===n?"ValueReference":"Name",s=(0,_xml.createElementNS)(a,o),l=i.gmlVersion;if(e.appendChild(s),(0,_xsd.writeStringTextNode)(s,t.name),void 0!==t.value&&null!==t.value){var p=(0,_xml.createElementNS)(a,"Value");e.appendChild(p),t.value&&"function"==typeof t.value.getSimplifiedGeometry?2===l?_GML.default.prototype.writeGeometryElement(p,t.value,r):3===l?_GML2.default.prototype.writeGeometryElement(p,t.value,r):_GML3.default.prototype.writeGeometryElement(p,t.value,r):(0,_xsd.writeStringTextNode)(p,t.value)}}function writeNative(e,t,r){t.vendorId&&e.setAttribute("vendorId",t.vendorId),void 0!==t.safeToIgnore&&e.setAttribute("safeToIgnore",String(t.safeToIgnore)),void 0!==t.value&&(0,_xsd.writeStringTextNode)(e,t.value)}var GETFEATURE_SERIALIZERS={"http://www.opengis.net/wfs":{Query:(0,_xml.makeChildAppender)(writeQuery)},"http://www.opengis.net/wfs/2.0":{Query:(0,_xml.makeChildAppender)(writeQuery)},"http://www.opengis.net/ogc":{During:(0,_xml.makeChildAppender)(writeDuringFilter),And:(0,_xml.makeChildAppender)(writeLogicalFilter),Or:(0,_xml.makeChildAppender)(writeLogicalFilter),Not:(0,_xml.makeChildAppender)(writeNotFilter),BBOX:(0,_xml.makeChildAppender)(writeBboxFilter),Contains:(0,_xml.makeChildAppender)(writeSpatialFilter),Intersects:(0,_xml.makeChildAppender)(writeSpatialFilter),Within:(0,_xml.makeChildAppender)(writeSpatialFilter),DWithin:(0,_xml.makeChildAppender)(writeDWithinFilter),PropertyIsEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsNotEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsLessThan:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsLessThanOrEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsGreaterThan:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsGreaterThanOrEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsNull:(0,_xml.makeChildAppender)(writeIsNullFilter),PropertyIsBetween:(0,_xml.makeChildAppender)(writeIsBetweenFilter),PropertyIsLike:(0,_xml.makeChildAppender)(writeIsLikeFilter)},"http://www.opengis.net/fes/2.0":{During:(0,_xml.makeChildAppender)(writeDuringFilter),And:(0,_xml.makeChildAppender)(writeLogicalFilter),Or:(0,_xml.makeChildAppender)(writeLogicalFilter),Not:(0,_xml.makeChildAppender)(writeNotFilter),BBOX:(0,_xml.makeChildAppender)(writeBboxFilter),Contains:(0,_xml.makeChildAppender)(writeSpatialFilter),Disjoint:(0,_xml.makeChildAppender)(writeSpatialFilter),Intersects:(0,_xml.makeChildAppender)(writeSpatialFilter),ResourceId:(0,_xml.makeChildAppender)(writeResourceIdFilter),Within:(0,_xml.makeChildAppender)(writeSpatialFilter),DWithin:(0,_xml.makeChildAppender)(writeDWithinFilter),PropertyIsEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsNotEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsLessThan:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsLessThanOrEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsGreaterThan:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsGreaterThanOrEqualTo:(0,_xml.makeChildAppender)(writeComparisonFilter),PropertyIsNull:(0,_xml.makeChildAppender)(writeIsNullFilter),PropertyIsBetween:(0,_xml.makeChildAppender)(writeIsBetweenFilter),PropertyIsLike:(0,_xml.makeChildAppender)(writeIsLikeFilter)}};function writeQuery(e,t,r){var i,n,a=r[r.length-1],o=a.version,s=a.featurePrefix,l=a.featureNS,p=a.propertyNames,u=a.srsName;i=s?getTypeName(s,t):t,n="2.0.0"===o?"typeNames":"typeName",e.setAttribute(n,i),u&&e.setAttribute("srsName",u),l&&e.setAttributeNS(XMLNS,"xmlns:"+s,l);var m=Object.assign({},a);m.node=e,(0,_xml.pushSerializeAndPop)(m,QUERY_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)("PropertyName"),p,r);var d=a.filter;if(d){var c=(0,_xml.createElementNS)(getFilterNS(o),"Filter");e.appendChild(c),writeFilterCondition(c,d,r)}}function writeFilterCondition(e,t,r){var i=r[r.length-1],n={node:e};Object.assign(n,{context:i}),(0,_xml.pushSerializeAndPop)(n,GETFEATURE_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)(t.getTagName()),[t],r)}function writeBboxFilter(e,t,r){var i=r[r.length-1],n=i.context.version;i.srsName=t.srsName;var a=GML_FORMATS[n];writePropertyName(n,e,t.geometryName),a.prototype.writeGeometryElement(e,t.extent,r)}function writeResourceIdFilter(e,t,r){e.setAttribute("rid",t.rid)}function writeSpatialFilter(e,t,r){var i=r[r.length-1],n=i.context.version;i.srsName=t.srsName;var a=GML_FORMATS[n];writePropertyName(n,e,t.geometryName),a.prototype.writeGeometryElement(e,t.geometry,r)}function writeDWithinFilter(e,t,r){var i=r[r.length-1].context.version;writeSpatialFilter(e,t,r);var n=(0,_xml.createElementNS)(getFilterNS(i),"Distance");(0,_xsd.writeStringTextNode)(n,t.distance.toString()),"2.0.0"===i?n.setAttribute("uom",t.unit):n.setAttribute("units",t.unit),e.appendChild(n)}function writeDuringFilter(e,t,r){var i=r[r.length-1].context.version;writeExpression(FESNS[i],"ValueReference",e,t.propertyName);var n=(0,_xml.createElementNS)(_GMLBase.GMLNS,"TimePeriod");e.appendChild(n);var a=(0,_xml.createElementNS)(_GMLBase.GMLNS,"begin");n.appendChild(a),writeTimeInstant(a,t.begin);var o=(0,_xml.createElementNS)(_GMLBase.GMLNS,"end");n.appendChild(o),writeTimeInstant(o,t.end)}function writeLogicalFilter(e,t,r){var i=r[r.length-1].context,n={node:e};Object.assign(n,{context:i});for(var a=t.conditions,o=0,s=a.length;o<s;++o){var l=a[o];(0,_xml.pushSerializeAndPop)(n,GETFEATURE_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)(l.getTagName()),[l],r)}}function writeNotFilter(e,t,r){var i=r[r.length-1].context,n={node:e};Object.assign(n,{context:i});var a=t.condition;(0,_xml.pushSerializeAndPop)(n,GETFEATURE_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)(a.getTagName()),[a],r)}function writeComparisonFilter(e,t,r){var i=r[r.length-1].context.version;void 0!==t.matchCase&&e.setAttribute("matchCase",t.matchCase.toString()),writePropertyName(i,e,t.propertyName),writeLiteral(i,e,""+t.expression)}function writeIsNullFilter(e,t,r){writePropertyName(r[r.length-1].context.version,e,t.propertyName)}function writeIsBetweenFilter(e,t,r){var i=r[r.length-1].context.version,n=getFilterNS(i);writePropertyName(i,e,t.propertyName);var a=(0,_xml.createElementNS)(n,"LowerBoundary");e.appendChild(a),writeLiteral(i,a,""+t.lowerBoundary);var o=(0,_xml.createElementNS)(n,"UpperBoundary");e.appendChild(o),writeLiteral(i,o,""+t.upperBoundary)}function writeIsLikeFilter(e,t,r){var i=r[r.length-1].context.version;e.setAttribute("wildCard",t.wildCard),e.setAttribute("singleChar",t.singleChar),e.setAttribute("escapeChar",t.escapeChar),void 0!==t.matchCase&&e.setAttribute("matchCase",t.matchCase.toString()),writePropertyName(i,e,t.propertyName),writeLiteral(i,e,""+t.pattern)}function writeExpression(e,t,r,i){var n=(0,_xml.createElementNS)(e,t);(0,_xsd.writeStringTextNode)(n,i),r.appendChild(n)}function writeLiteral(e,t,r){writeExpression(getFilterNS(e),"Literal",t,r)}function writePropertyName(e,t,r){"2.0.0"===e?writeExpression(FESNS[e],"ValueReference",t,r):writeExpression(OGCNS[e],"PropertyName",t,r)}function writeTimeInstant(e,t){var r=(0,_xml.createElementNS)(_GMLBase.GMLNS,"TimeInstant");e.appendChild(r);var i=(0,_xml.createElementNS)(_GMLBase.GMLNS,"timePosition");r.appendChild(i),(0,_xsd.writeStringTextNode)(i,t)}function writeFilter(e,t){t=t||"1.1.0";var r=(0,_xml.createElementNS)(getFilterNS(t),"Filter"),i={node:r};return Object.assign(i,{version:t,filter:e}),writeFilterCondition(r,e,[i]),r}function _writeGetFeature(e,t,r){var i=r[r.length-1],n=Object.assign({},i);n.node=e,(0,_xml.pushSerializeAndPop)(n,GETFEATURE_SERIALIZERS,(0,_xml.makeSimpleNodeFactory)("Query"),t,r)}function getFilterNS(e){return"2.0.0"===e?FESNS[e]:OGCNS[e]}var _default=exports.default=WFS;

},{"../asserts.js":111,"../proj.js":283,"../xml.js":418,"./GML2.js":149,"./GML3.js":150,"./GML32.js":151,"./GMLBase.js":152,"./XMLFeature.js":171,"./filter.js":172,"./xsd.js":199}],165:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_Feature2=_interopRequireWildcard(require("./Feature.js")),_GeometryCollection=_interopRequireDefault(require("../geom/GeometryCollection.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_proj=require("../proj.js"),_SimpleGeometry=_interopRequireDefault(require("../geom/SimpleGeometry.js"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var WKBGeometryType={POINT:1,LINE_STRING:2,POLYGON:3,MULTI_POINT:4,MULTI_LINE_STRING:5,MULTI_POLYGON:6,GEOMETRY_COLLECTION:7,POLYHEDRAL_SURFACE:15,TIN:16,TRIANGLE:17},WkbReader=function(){return _createClass(function e(t){_classCallCheck(this,e),this.view_=t,this.pos_=0,this.initialized_=!1,this.isLittleEndian_=!1,this.hasZ_=!1,this.hasM_=!1,this.srid_=null,this.layout_="XY"},[{key:"readUint8",value:function(){return this.view_.getUint8(this.pos_++)}},{key:"readUint32",value:function(e){return this.view_.getUint32((this.pos_+=4)-4,void 0!==e?e:this.isLittleEndian_)}},{key:"readDouble",value:function(e){return this.view_.getFloat64((this.pos_+=8)-8,void 0!==e?e:this.isLittleEndian_)}},{key:"readPoint",value:function(){var e=[];return e.push(this.readDouble()),e.push(this.readDouble()),this.hasZ_&&e.push(this.readDouble()),this.hasM_&&e.push(this.readDouble()),e}},{key:"readLineString",value:function(){for(var e=this.readUint32(),t=[],r=0;r<e;r++)t.push(this.readPoint());return t}},{key:"readPolygon",value:function(){for(var e=this.readUint32(),t=[],r=0;r<e;r++)t.push(this.readLineString());return t}},{key:"readWkbHeader",value:function(e){var t=this.readUint8()>0,r=this.readUint32(t),i=Math.floor((268435455&r)/1e3),n=Boolean(2147483648&r)||1===i||3===i,o=Boolean(1073741824&r)||2===i||3===i,a=Boolean(536870912&r),u=(268435455&r)%1e3,l=["XY",n?"Z":"",o?"M":""].join(""),s=a?this.readUint32(t):null;if(void 0!==e&&e!==u)throw new Error("Unexpected WKB geometry type "+u);if(this.initialized_){if(this.isLittleEndian_!==t)throw new Error("Inconsistent endian");if(this.layout_!==l)throw new Error("Inconsistent geometry layout");if(s&&this.srid_!==s)throw new Error("Inconsistent coordinate system (SRID)")}else this.isLittleEndian_=t,this.hasZ_=n,this.hasM_=o,this.layout_=l,this.srid_=s,this.initialized_=!0;return u}},{key:"readWkbPayload",value:function(e){switch(e){case WKBGeometryType.POINT:return this.readPoint();case WKBGeometryType.LINE_STRING:return this.readLineString();case WKBGeometryType.POLYGON:case WKBGeometryType.TRIANGLE:return this.readPolygon();case WKBGeometryType.MULTI_POINT:return this.readMultiPoint();case WKBGeometryType.MULTI_LINE_STRING:return this.readMultiLineString();case WKBGeometryType.MULTI_POLYGON:case WKBGeometryType.POLYHEDRAL_SURFACE:case WKBGeometryType.TIN:return this.readMultiPolygon();case WKBGeometryType.GEOMETRY_COLLECTION:return this.readGeometryCollection();default:throw new Error("Unsupported WKB geometry type "+e+" is found")}}},{key:"readWkbBlock",value:function(e){return this.readWkbPayload(this.readWkbHeader(e))}},{key:"readWkbCollection",value:function(e,t){for(var r=this.readUint32(),i=[],n=0;n<r;n++){var o=e.call(this,t);o&&i.push(o)}return i}},{key:"readMultiPoint",value:function(){return this.readWkbCollection(this.readWkbBlock,WKBGeometryType.POINT)}},{key:"readMultiLineString",value:function(){return this.readWkbCollection(this.readWkbBlock,WKBGeometryType.LINE_STRING)}},{key:"readMultiPolygon",value:function(){return this.readWkbCollection(this.readWkbBlock,WKBGeometryType.POLYGON)}},{key:"readGeometryCollection",value:function(){return this.readWkbCollection(this.readGeometry)}},{key:"readGeometry",value:function(){var e=this.readWkbHeader(),t=this.readWkbPayload(e);switch(e){case WKBGeometryType.POINT:return new _Point.default(t,this.layout_);case WKBGeometryType.LINE_STRING:return new _LineString.default(t,this.layout_);case WKBGeometryType.POLYGON:case WKBGeometryType.TRIANGLE:return new _Polygon.default(t,this.layout_);case WKBGeometryType.MULTI_POINT:return new _MultiPoint.default(t,this.layout_);case WKBGeometryType.MULTI_LINE_STRING:return new _MultiLineString.default(t,this.layout_);case WKBGeometryType.MULTI_POLYGON:case WKBGeometryType.POLYHEDRAL_SURFACE:case WKBGeometryType.TIN:return new _MultiPolygon.default(t,this.layout_);case WKBGeometryType.GEOMETRY_COLLECTION:return new _GeometryCollection.default(t);default:return null}}},{key:"getSrid",value:function(){return this.srid_}}])}(),WkbWriter=function(){return _createClass(function e(t){_classCallCheck(this,e),t=t||{},this.layout_=t.layout,this.isLittleEndian_=!1!==t.littleEndian,this.isEWKB_=!1!==t.ewkb,this.writeQueue_=[],this.nodata_=Object.assign({X:0,Y:0,Z:0,M:0},t.nodata)},[{key:"writeUint8",value:function(e){this.writeQueue_.push([1,e])}},{key:"writeUint32",value:function(e){this.writeQueue_.push([4,e])}},{key:"writeDouble",value:function(e){this.writeQueue_.push([8,e])}},{key:"writePoint",value:function(e,t){var r,i=Object.assign.apply(null,t.split("").map(function(t,r){return _defineProperty({},t,e[r])})),n=_createForOfIteratorHelper(this.layout_);try{for(n.s();!(r=n.n()).done;){var o=r.value;this.writeDouble(o in i?i[o]:this.nodata_[o])}}catch(e){n.e(e)}finally{n.f()}}},{key:"writeLineString",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writePoint(e[r],t)}},{key:"writePolygon",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeLineString(e[r],t)}},{key:"writeWkbHeader",value:function(e,t){e%=1e3,this.layout_.includes("Z")&&(e+=this.isEWKB_?2147483648:1e3),this.layout_.includes("M")&&(e+=this.isEWKB_?1073741824:2e3),this.isEWKB_&&Number.isInteger(t)&&(e|=536870912),this.writeUint8(this.isLittleEndian_?1:0),this.writeUint32(e),this.isEWKB_&&Number.isInteger(t)&&this.writeUint32(t)}},{key:"writeMultiPoint",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeWkbHeader(1),this.writePoint(e[r],t)}},{key:"writeMultiLineString",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeWkbHeader(2),this.writeLineString(e[r],t)}},{key:"writeMultiPolygon",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeWkbHeader(3),this.writePolygon(e[r],t)}},{key:"writeGeometryCollection",value:function(e){this.writeUint32(e.length);for(var t=0;t<e.length;t++)this.writeGeometry(e[t])}},{key:"findMinimumLayout",value:function(e){var t,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"XYZM";if(e instanceof _SimpleGeometry.default)return(t=e.getLayout())===(r=i)?t:"XYZM"===t?r:"XYZM"===r?t:"XY";if(e instanceof _GeometryCollection.default)for(var n=e.getGeometriesArray(),o=0;o<n.length&&"XY"!==i;o++)i=this.findMinimumLayout(n[o],i);return i}},{key:"writeGeometry",value:function(e,t){var r={Point:WKBGeometryType.POINT,LineString:WKBGeometryType.LINE_STRING,Polygon:WKBGeometryType.POLYGON,MultiPoint:WKBGeometryType.MULTI_POINT,MultiLineString:WKBGeometryType.MULTI_LINE_STRING,MultiPolygon:WKBGeometryType.MULTI_POLYGON,GeometryCollection:WKBGeometryType.GEOMETRY_COLLECTION},i=e.getType(),n=r[i];if(!n)throw new Error("GeometryType "+i+" is not supported");(this.layout_||(this.layout_=this.findMinimumLayout(e)),this.writeWkbHeader(n,t),e instanceof _SimpleGeometry.default)?{Point:this.writePoint,LineString:this.writeLineString,Polygon:this.writePolygon,MultiPoint:this.writeMultiPoint,MultiLineString:this.writeMultiLineString,MultiPolygon:this.writeMultiPolygon}[i].call(this,e.getCoordinates(),e.getLayout()):e instanceof _GeometryCollection.default&&this.writeGeometryCollection(e.getGeometriesArray())}},{key:"getBuffer",value:function(){var e=this,t=this.writeQueue_.reduce(function(e,t){return e+t[0]},0),r=new ArrayBuffer(t),i=new DataView(r),n=0;return this.writeQueue_.forEach(function(t){switch(t[0]){case 1:i.setUint8(n,t[1]);break;case 4:i.setUint32(n,t[1],e.isLittleEndian_);break;case 8:i.setFloat64(n,t[1],e.isLittleEndian_)}n+=t[0]}),r}}])}(),WKB=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).splitCollection=Boolean(e.splitCollection),r.viewCache_=null,r.hex_=!1!==e.hex,r.littleEndian_=!1!==e.littleEndian,r.ewkb_=!1!==e.ewkb,r.layout_=e.geometryLayout,r.nodataZ_=e.nodataZ||0,r.nodataM_=e.nodataM||0,r.srid_=e.srid,r}return _inherits(t,_Feature2["default"]),_createClass(t,[{key:"getType",value:function(){return this.hex_?"text":"arraybuffer"}},{key:"readFeature",value:function(e,t){return new _Feature.default({geometry:this.readGeometry(e,t)})}},{key:"readFeatures",value:function(e,t){var r=this.readGeometry(e,t);return(this.splitCollection&&r instanceof _GeometryCollection.default?r.getGeometriesArray():[r]).map(function(e){return new _Feature.default({geometry:e})})}},{key:"readGeometry",value:function(e,t){var r=getDataView(e);if(!r)return null;var i=new WkbReader(r).readGeometry();return this.viewCache_=r,t=this.getReadOptions(e,t),this.viewCache_=null,(0,_Feature2.transformGeometryWithOptions)(i,!1,t)}},{key:"readProjection",value:function(e){var t=this.viewCache_||getDataView(e);if(t){var r=new WkbReader(t);return r.readWkbHeader(),r.getSrid()&&(0,_proj.get)("EPSG:"+r.getSrid())||void 0}}},{key:"writeFeature",value:function(e,t){return this.writeGeometry(e.getGeometry(),t)}},{key:"writeFeatures",value:function(e,t){return this.writeGeometry(new _GeometryCollection.default(e.map(function(e){return e.getGeometry()})),t)}},{key:"writeGeometry",value:function(e,t){t=this.adaptOptions(t);var r=new WkbWriter({layout:this.layout_,littleEndian:this.littleEndian_,ewkb:this.ewkb_,nodata:{Z:this.nodataZ_,M:this.nodataM_}}),i=Number.isInteger(this.srid_)?Number(this.srid_):null;if(!1!==this.srid_&&!Number.isInteger(this.srid_)){var n=t.dataProjection&&(0,_proj.get)(t.dataProjection);if(n){var o=n.getCode();o.startsWith("EPSG:")&&(i=Number(o.substring(5)))}}r.writeGeometry((0,_Feature2.transformGeometryWithOptions)(e,!0,t),i);var a=r.getBuffer();return this.hex_?encodeHexString(a):a}}])}();function encodeHexString(e){var t=new Uint8Array(e);return Array.from(t.values()).map(function(e){return(e<16?"0":"")+Number(e).toString(16).toUpperCase()}).join("")}function decodeHexString(e){for(var t=new Uint8Array(e.length/2),r=0;r<e.length/2;r++)t[r]=parseInt(e.substr(2*r,2),16);return new DataView(t.buffer)}function getDataView(e){return"string"==typeof e?decodeHexString(e):ArrayBuffer.isView(e)?e instanceof DataView?e:new DataView(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new DataView(e):null}var _default=exports.default=WKB;

},{"../Feature.js":82,"../geom/GeometryCollection.js":204,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../geom/SimpleGeometry.js":212,"../proj.js":283,"./Feature.js":147}],166:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../Feature.js")),_GeometryCollection=_interopRequireDefault(require("../geom/GeometryCollection.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js")),_TextFeature2=_interopRequireDefault(require("./TextFeature.js")),_Feature2=require("./Feature.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var GeometryConstructor={POINT:_Point.default,LINESTRING:_LineString.default,POLYGON:_Polygon.default,MULTIPOINT:_MultiPoint.default,MULTILINESTRING:_MultiLineString.default,MULTIPOLYGON:_MultiPolygon.default},EMPTY="EMPTY",Z="Z",M="M",ZM="ZM",TokenType={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},wktTypeLookup={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"},Lexer=function(){return _createClass(function e(t){_classCallCheck(this,e),this.wkt=t,this.index_=-1},[{key:"isAlpha_",value:function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}},{key:"isNumeric_",value:function(e,t){return t=void 0!==t&&t,e>="0"&&e<="9"||"."==e&&!t}},{key:"isWhiteSpace_",value:function(e){return" "==e||"\t"==e||"\r"==e||"\n"==e}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var e,t=this.nextChar_(),r=this.index_,o=t;if("("==t)e=TokenType.LEFT_PAREN;else if(","==t)e=TokenType.COMMA;else if(")"==t)e=TokenType.RIGHT_PAREN;else if(this.isNumeric_(t)||"-"==t)e=TokenType.NUMBER,o=this.readNumber_();else if(this.isAlpha_(t))e=TokenType.TEXT,o=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);e=TokenType.EOF}return{position:r,value:o,type:e}}},{key:"readNumber_",value:function(){var e,t=this.index_,r=!1,o=!1;do{"."==e?r=!0:"e"!=e&&"E"!=e||(o=!0),e=this.nextChar_()}while(this.isNumeric_(e,r)||!o&&("e"==e||"E"==e)||o&&("-"==e||"+"==e));return parseFloat(this.wkt.substring(t,this.index_--))}},{key:"readText_",value:function(){var e,t=this.index_;do{e=this.nextChar_()}while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()}}])}(),Parser=function(){return _createClass(function e(t){_classCallCheck(this,e),this.lexer_=t,this.token_={position:0,type:TokenType.START},this.layout_="XY"},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(e){return this.token_.type==e}},{key:"match",value:function(e){var t=this.isTokenType(e);return t&&this.consume_(),t}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var e="XY",t=this.token_;if(this.isTokenType(TokenType.TEXT)){var r=t.value;r===Z?e="XYZ":r===M?e="XYM":r===ZM&&(e="XYZM"),"XY"!==e&&this.consume_()}return e}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(TokenType.LEFT_PAREN)){var e=[];do{e.push(this.parseGeometry_())}while(this.match(TokenType.COMMA));if(this.match(TokenType.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(TokenType.LEFT_PAREN)){var e=this.parsePoint_();if(this.match(TokenType.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(TokenType.LEFT_PAREN)){var e=this.parsePointList_();if(this.match(TokenType.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(TokenType.LEFT_PAREN)){var e=this.parseLineStringTextList_();if(this.match(TokenType.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var e;if(this.match(TokenType.LEFT_PAREN)&&(e=this.token_.type==TokenType.LEFT_PAREN?this.parsePointTextList_():this.parsePointList_(),this.match(TokenType.RIGHT_PAREN)))return e;throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(TokenType.LEFT_PAREN)){var e=this.parseLineStringTextList_();if(this.match(TokenType.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(TokenType.LEFT_PAREN)){var e=this.parsePolygonTextList_();if(this.match(TokenType.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var e=[],t=this.layout_.length,r=0;r<t;++r){var o=this.token_;if(!this.match(TokenType.NUMBER))break;e.push(o.value)}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var e=[this.parsePoint_()];this.match(TokenType.COMMA);)e.push(this.parsePoint_());return e}},{key:"parsePointTextList_",value:function(){for(var e=[this.parsePointText_()];this.match(TokenType.COMMA);)e.push(this.parsePointText_());return e}},{key:"parseLineStringTextList_",value:function(){for(var e=[this.parseLineStringText_()];this.match(TokenType.COMMA);)e.push(this.parseLineStringText_());return e}},{key:"parsePolygonTextList_",value:function(){for(var e=[this.parsePolygonText_()];this.match(TokenType.COMMA);)e.push(this.parsePolygonText_());return e}},{key:"isEmptyGeometry_",value:function(){var e=this.isTokenType(TokenType.TEXT)&&this.token_.value==EMPTY;return e&&this.consume_(),e}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var e=this.token_;if(this.match(TokenType.TEXT)){var t=e.value;this.layout_=this.parseGeometryLayout_();var r=this.isEmptyGeometry_();if("GEOMETRYCOLLECTION"==t){if(r)return new _GeometryCollection.default([]);var o=this.parseGeometryCollectionText_();return new _GeometryCollection.default(o)}var n,i=GeometryConstructor[t];if(!i)throw new Error("Invalid geometry type: "+t);if(r)n="POINT"==t?[NaN,NaN]:[];else switch(t){case"POINT":n=this.parsePointText_();break;case"LINESTRING":n=this.parseLineStringText_();break;case"POLYGON":n=this.parsePolygonText_();break;case"MULTIPOINT":n=this.parseMultiPointText_();break;case"MULTILINESTRING":n=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":n=this.parseMultiPolygonText_()}return new i(n,this.layout_)}throw new Error(this.formatErrorMessage_())}}])}(),WKT=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).splitCollection_=void 0!==e.splitCollection&&e.splitCollection,r}return _inherits(t,_TextFeature2["default"]),_createClass(t,[{key:"parse_",value:function(e){var t=new Lexer(e);return new Parser(t).parse()}},{key:"readFeatureFromText",value:function(e,t){var r=this.readGeometryFromText(e,t),o=new _Feature.default;return o.setGeometry(r),o}},{key:"readFeaturesFromText",value:function(e,t){for(var r=[],o=this.readGeometryFromText(e,t),n=[],i=0,s=(r=this.splitCollection_&&"GeometryCollection"==o.getType()?o.getGeometriesArray():[o]).length;i<s;++i){var u=new _Feature.default;u.setGeometry(r[i]),n.push(u)}return n}},{key:"readGeometryFromText",value:function(e,t){var r=this.parse_(e);return(0,_Feature2.transformGeometryWithOptions)(r,!1,t)}},{key:"writeFeatureText",value:function(e,t){var r=e.getGeometry();return r?this.writeGeometryText(r,t):""}},{key:"writeFeaturesText",value:function(e,t){if(1==e.length)return this.writeFeatureText(e[0],t);for(var r=[],o=0,n=e.length;o<n;++o)r.push(e[o].getGeometry());var i=new _GeometryCollection.default(r);return this.writeGeometryText(i,t)}},{key:"writeGeometryText",value:function(e,t){return encode((0,_Feature2.transformGeometryWithOptions)(e,!0,t))}}])}();function encodePointGeometry(e){var t=e.getCoordinates();return 0===t.length?"":t.join(" ")}function encodeMultiPointGeometry(e){for(var t=[],r=e.getPoints(),o=0,n=r.length;o<n;++o)t.push("("+encodePointGeometry(r[o])+")");return t.join(",")}function encodeGeometryCollectionGeometry(e){for(var t=[],r=e.getGeometries(),o=0,n=r.length;o<n;++o)t.push(encode(r[o]));return t.join(",")}function encodeLineStringGeometry(e){for(var t=e.getCoordinates(),r=[],o=0,n=t.length;o<n;++o)r.push(t[o].join(" "));return r.join(",")}function encodeMultiLineStringGeometry(e){for(var t=[],r=e.getLineStrings(),o=0,n=r.length;o<n;++o)t.push("("+encodeLineStringGeometry(r[o])+")");return t.join(",")}function encodePolygonGeometry(e){for(var t=[],r=e.getLinearRings(),o=0,n=r.length;o<n;++o)t.push("("+encodeLineStringGeometry(r[o])+")");return t.join(",")}function encodeMultiPolygonGeometry(e){for(var t=[],r=e.getPolygons(),o=0,n=r.length;o<n;++o)t.push("("+encodePolygonGeometry(r[o])+")");return t.join(",")}function encodeGeometryLayout(e){var t=e.getLayout(),r="";return"XYZ"!==t&&"XYZM"!==t||(r+=Z),"XYM"!==t&&"XYZM"!==t||(r+=M),r}var GeometryEncoder={Point:encodePointGeometry,LineString:encodeLineStringGeometry,Polygon:encodePolygonGeometry,MultiPoint:encodeMultiPointGeometry,MultiLineString:encodeMultiLineStringGeometry,MultiPolygon:encodeMultiPolygonGeometry,GeometryCollection:encodeGeometryCollectionGeometry};function encode(e){var t=e.getType(),r=(0,GeometryEncoder[t])(e),o=wktTypeLookup[t];if("function"==typeof e.getFlatCoordinates){var n=encodeGeometryLayout(e);n.length>0&&(o+=" "+n)}return 0===r.length?o+" "+EMPTY:o+"("+r+")"}var _default=exports.default=WKT;

},{"../Feature.js":82,"../geom/GeometryCollection.js":204,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"./Feature.js":147,"./TextFeature.js":162}],167:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _XML2=_interopRequireDefault(require("./XML.js")),_xml=require("../xml.js"),_xsd=require("./xsd.js"),_xlink=require("./xlink.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var NAMESPACE_URIS=[null,"http://www.opengis.net/wms"],PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Service:(0,_xml.makeObjectPropertySetter)(readService),Capability:(0,_xml.makeObjectPropertySetter)(readCapability)}),CAPABILITY_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Request:(0,_xml.makeObjectPropertySetter)(readRequest),Exception:(0,_xml.makeObjectPropertySetter)(readException),Layer:(0,_xml.makeObjectPropertySetter)(readCapabilityLayer)}),WMSCapabilities=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).version=void 0,e}return _inherits(t,_XML2["default"]),_createClass(t,[{key:"readFromNode",value:function(e){this.version=e.getAttribute("version").trim();var t=(0,_xml.pushParseAndPop)({version:this.version},PARSERS,e,[]);return t||null}}])}(),SERVICE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Abstract:(0,_xml.makeObjectPropertySetter)(_xsd.readString),KeywordList:(0,_xml.makeObjectPropertySetter)(readKeywordList),OnlineResource:(0,_xml.makeObjectPropertySetter)(_xlink.readHref),ContactInformation:(0,_xml.makeObjectPropertySetter)(readContactInformation),Fees:(0,_xml.makeObjectPropertySetter)(_xsd.readString),AccessConstraints:(0,_xml.makeObjectPropertySetter)(_xsd.readString),LayerLimit:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MaxWidth:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MaxHeight:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger)}),CONTACT_INFORMATION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ContactPersonPrimary:(0,_xml.makeObjectPropertySetter)(readContactPersonPrimary),ContactPosition:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ContactAddress:(0,_xml.makeObjectPropertySetter)(readContactAddress),ContactVoiceTelephone:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ContactFacsimileTelephone:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ContactElectronicMailAddress:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),CONTACT_PERSON_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{ContactPerson:(0,_xml.makeObjectPropertySetter)(_xsd.readString),ContactOrganization:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),CONTACT_ADDRESS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{AddressType:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Address:(0,_xml.makeObjectPropertySetter)(_xsd.readString),City:(0,_xml.makeObjectPropertySetter)(_xsd.readString),StateOrProvince:(0,_xml.makeObjectPropertySetter)(_xsd.readString),PostCode:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Country:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}),EXCEPTION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Format:(0,_xml.makeArrayPusher)(_xsd.readString)}),LAYER_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Abstract:(0,_xml.makeObjectPropertySetter)(_xsd.readString),KeywordList:(0,_xml.makeObjectPropertySetter)(readKeywordList),CRS:(0,_xml.makeObjectPropertyPusher)(_xsd.readString),EX_GeographicBoundingBox:(0,_xml.makeObjectPropertySetter)(readEXGeographicBoundingBox),BoundingBox:(0,_xml.makeObjectPropertyPusher)(readBoundingBox),Dimension:(0,_xml.makeObjectPropertyPusher)(readDimension),Attribution:(0,_xml.makeObjectPropertySetter)(readAttribution),AuthorityURL:(0,_xml.makeObjectPropertyPusher)(readAuthorityURL),Identifier:(0,_xml.makeObjectPropertyPusher)(_xsd.readString),MetadataURL:(0,_xml.makeObjectPropertyPusher)(readMetadataURL),DataURL:(0,_xml.makeObjectPropertyPusher)(readFormatOnlineresource),FeatureListURL:(0,_xml.makeObjectPropertyPusher)(readFormatOnlineresource),Style:(0,_xml.makeObjectPropertyPusher)(readStyle),MinScaleDenominator:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),MaxScaleDenominator:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),Layer:(0,_xml.makeObjectPropertyPusher)(readLayer)}),ATTRIBUTION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),OnlineResource:(0,_xml.makeObjectPropertySetter)(_xlink.readHref),LogoURL:(0,_xml.makeObjectPropertySetter)(readSizedFormatOnlineresource)}),EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{westBoundLongitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),eastBoundLongitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),southBoundLatitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),northBoundLatitude:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal)}),REQUEST_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{GetCapabilities:(0,_xml.makeObjectPropertySetter)(readOperationType),GetMap:(0,_xml.makeObjectPropertySetter)(readOperationType),GetFeatureInfo:(0,_xml.makeObjectPropertySetter)(readOperationType)}),OPERATIONTYPE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Format:(0,_xml.makeObjectPropertyPusher)(_xsd.readString),DCPType:(0,_xml.makeObjectPropertyPusher)(readDCPType)}),DCPTYPE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{HTTP:(0,_xml.makeObjectPropertySetter)(readHTTP)}),HTTP_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Get:(0,_xml.makeObjectPropertySetter)(readFormatOnlineresource),Post:(0,_xml.makeObjectPropertySetter)(readFormatOnlineresource)}),STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Name:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Abstract:(0,_xml.makeObjectPropertySetter)(_xsd.readString),LegendURL:(0,_xml.makeObjectPropertyPusher)(readSizedFormatOnlineresource),StyleSheetURL:(0,_xml.makeObjectPropertySetter)(readFormatOnlineresource),StyleURL:(0,_xml.makeObjectPropertySetter)(readFormatOnlineresource)}),FORMAT_ONLINERESOURCE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Format:(0,_xml.makeObjectPropertySetter)(_xsd.readString),OnlineResource:(0,_xml.makeObjectPropertySetter)(_xlink.readHref)}),KEYWORDLIST_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Keyword:(0,_xml.makeArrayPusher)(_xsd.readString)});function readAttribution(e,t){return(0,_xml.pushParseAndPop)({},ATTRIBUTION_PARSERS,e,t)}function readBoundingBox(e,t){var r=[(0,_xsd.readDecimalString)(e.getAttribute("minx")),(0,_xsd.readDecimalString)(e.getAttribute("miny")),(0,_xsd.readDecimalString)(e.getAttribute("maxx")),(0,_xsd.readDecimalString)(e.getAttribute("maxy"))],a=[(0,_xsd.readDecimalString)(e.getAttribute("resx")),(0,_xsd.readDecimalString)(e.getAttribute("resy"))];return{crs:e.getAttribute("CRS"),extent:r,res:a}}function readEXGeographicBoundingBox(e,t){var r=(0,_xml.pushParseAndPop)({},EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS,e,t);if(r){var a=r.westBoundLongitude,o=r.southBoundLatitude,n=r.eastBoundLongitude,i=r.northBoundLatitude;if(void 0!==a&&void 0!==o&&void 0!==n&&void 0!==i)return[a,o,n,i]}}function readCapability(e,t){return(0,_xml.pushParseAndPop)({},CAPABILITY_PARSERS,e,t)}function readService(e,t){return(0,_xml.pushParseAndPop)({},SERVICE_PARSERS,e,t)}function readContactInformation(e,t){return(0,_xml.pushParseAndPop)({},CONTACT_INFORMATION_PARSERS,e,t)}function readContactPersonPrimary(e,t){return(0,_xml.pushParseAndPop)({},CONTACT_PERSON_PARSERS,e,t)}function readContactAddress(e,t){return(0,_xml.pushParseAndPop)({},CONTACT_ADDRESS_PARSERS,e,t)}function readException(e,t){return(0,_xml.pushParseAndPop)([],EXCEPTION_PARSERS,e,t)}function readCapabilityLayer(e,t){var r=(0,_xml.pushParseAndPop)({},LAYER_PARSERS,e,t);return void 0===r.Layer?Object.assign(r,readLayer(e,t)):r}function readLayer(e,t){var r=t[t.length-1],a=(0,_xml.pushParseAndPop)({},LAYER_PARSERS,e,t);if(a){var o=(0,_xsd.readBooleanString)(e.getAttribute("queryable"));void 0===o&&(o=r.queryable),a.queryable=void 0!==o&&o;var n=(0,_xsd.readNonNegativeIntegerString)(e.getAttribute("cascaded"));void 0===n&&(n=r.cascaded),a.cascaded=n;var i=(0,_xsd.readBooleanString)(e.getAttribute("opaque"));void 0===i&&(i=r.opaque),a.opaque=void 0!==i&&i;var u=(0,_xsd.readBooleanString)(e.getAttribute("noSubsets"));void 0===u&&(u=r.noSubsets),a.noSubsets=void 0!==u&&u;var d=(0,_xsd.readDecimalString)(e.getAttribute("fixedWidth"));d||(d=r.fixedWidth),a.fixedWidth=d;var S=(0,_xsd.readDecimalString)(e.getAttribute("fixedHeight"));S||(S=r.fixedHeight),a.fixedHeight=S;["Style","CRS","AuthorityURL"].forEach(function(e){if(e in r){var t=a[e]||[];a[e]=t.concat(r[e])}});return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(e){if(!(e in a)){var t=r[e];a[e]=t}}),a}}function readDimension(e,t){return{name:e.getAttribute("name"),units:e.getAttribute("units"),unitSymbol:e.getAttribute("unitSymbol"),default:e.getAttribute("default"),multipleValues:(0,_xsd.readBooleanString)(e.getAttribute("multipleValues")),nearestValue:(0,_xsd.readBooleanString)(e.getAttribute("nearestValue")),current:(0,_xsd.readBooleanString)(e.getAttribute("current")),values:(0,_xsd.readString)(e)}}function readFormatOnlineresource(e,t){return(0,_xml.pushParseAndPop)({},FORMAT_ONLINERESOURCE_PARSERS,e,t)}function readRequest(e,t){return(0,_xml.pushParseAndPop)({},REQUEST_PARSERS,e,t)}function readDCPType(e,t){return(0,_xml.pushParseAndPop)({},DCPTYPE_PARSERS,e,t)}function readHTTP(e,t){return(0,_xml.pushParseAndPop)({},HTTP_PARSERS,e,t)}function readOperationType(e,t){return(0,_xml.pushParseAndPop)({},OPERATIONTYPE_PARSERS,e,t)}function readSizedFormatOnlineresource(e,t){var r=readFormatOnlineresource(e,t);if(r){var a=[(0,_xsd.readNonNegativeIntegerString)(e.getAttribute("width")),(0,_xsd.readNonNegativeIntegerString)(e.getAttribute("height"))];return r.size=a,r}}function readAuthorityURL(e,t){var r=readFormatOnlineresource(e,t);if(r)return r.name=e.getAttribute("name"),r}function readMetadataURL(e,t){var r=readFormatOnlineresource(e,t);if(r)return r.type=e.getAttribute("type"),r}function readStyle(e,t){return(0,_xml.pushParseAndPop)({},STYLE_PARSERS,e,t)}function readKeywordList(e,t){return(0,_xml.pushParseAndPop)([],KEYWORDLIST_PARSERS,e,t)}var _default=exports.default=WMSCapabilities;

},{"../xml.js":418,"./XML.js":170,"./xlink.js":198,"./xsd.js":199}],168:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _GML=_interopRequireDefault(require("./GML2.js")),_XMLFeature2=_interopRequireDefault(require("./XMLFeature.js")),_array=require("../array.js"),_xml=require("../xml.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var featureIdentifier="_feature",layerIdentifier="_layer",WMSGetFeatureInfo=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).featureNS_="http://mapserver.gis.umn.edu/mapserver",r.gmlFormat_=new _GML.default,r.layers_=e.layers?e.layers:null,r}return _inherits(t,_XMLFeature2["default"]),_createClass(t,[{key:"getLayers",value:function(){return this.layers_}},{key:"setLayers",value:function(e){this.layers_=e}},{key:"readFeatures_",value:function(e,t){e.setAttribute("namespaceURI",this.featureNS_);var r=e.localName,o=[];if(0===e.childNodes.length)return o;if("msGMLOutput"==r)for(var n=0,i=e.childNodes.length;n<i;n++){var a=e.childNodes[n];if(a.nodeType===Node.ELEMENT_NODE){var u=a,s=t[0],l=layerIdentifier,f=u.localName.replace(l,"");if(!this.layers_||this.layers_.includes(f)){var c=f+featureIdentifier;s.featureType=c,s.featureNS=this.featureNS_;var p={};p[c]=(0,_xml.makeArrayPusher)(this.gmlFormat_.readFeatureElement,this.gmlFormat_);var _=(0,_xml.makeStructureNS)([s.featureNS,null],p);u.setAttribute("namespaceURI",this.featureNS_);var y=(0,_xml.pushParseAndPop)([],_,u,t,this.gmlFormat_);y&&(0,_array.extend)(o,y)}}}if("FeatureCollection"==r){var d=(0,_xml.pushParseAndPop)([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,e,[{}],this.gmlFormat_);d&&(o=d)}return o}},{key:"readFeaturesFromNode",value:function(e,t){var r={};return t&&Object.assign(r,this.getReadOptions(e,t)),this.readFeatures_(e,[r])}}])}(),_default=exports.default=WMSGetFeatureInfo;

},{"../array.js":110,"../xml.js":418,"./GML2.js":149,"./XMLFeature.js":171}],169:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _OWS=_interopRequireDefault(require("./OWS.js")),_XML2=_interopRequireDefault(require("./XML.js")),_extent=require("../extent.js"),_xml=require("../xml.js"),_xsd=require("./xsd.js"),_xlink=require("./xlink.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var NAMESPACE_URIS=[null,"http://www.opengis.net/wmts/1.0"],OWS_NAMESPACE_URIS=[null,"http://www.opengis.net/ows/1.1"],PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Contents:(0,_xml.makeObjectPropertySetter)(readContents)}),WMTSCapabilities=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).owsParser_=new _OWS.default,e}return _inherits(t,_XML2["default"]),_createClass(t,[{key:"readFromNode",value:function(e){var t=e.getAttribute("version");t&&(t=t.trim());var r=this.owsParser_.readFromNode(e);return r?(r.version=t,(r=(0,_xml.pushParseAndPop)(r,PARSERS,e,[]))||null):null}}])}(),CONTENTS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Layer:(0,_xml.makeObjectPropertyPusher)(readLayer),TileMatrixSet:(0,_xml.makeObjectPropertyPusher)(readTileMatrixSet)}),LAYER_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Style:(0,_xml.makeObjectPropertyPusher)(readStyle),Format:(0,_xml.makeObjectPropertyPusher)(_xsd.readString),TileMatrixSetLink:(0,_xml.makeObjectPropertyPusher)(readTileMatrixSetLink),Dimension:(0,_xml.makeObjectPropertyPusher)(readDimensions),ResourceURL:(0,_xml.makeObjectPropertyPusher)(readResourceUrl)},(0,_xml.makeStructureNS)(OWS_NAMESPACE_URIS,{Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Abstract:(0,_xml.makeObjectPropertySetter)(_xsd.readString),WGS84BoundingBox:(0,_xml.makeObjectPropertySetter)(readBoundingBox),BoundingBox:(0,_xml.makeObjectPropertyPusher)(readBoundingBoxWithCrs),Identifier:(0,_xml.makeObjectPropertySetter)(_xsd.readString)})),STYLE_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{LegendURL:(0,_xml.makeObjectPropertyPusher)(readLegendUrl)},(0,_xml.makeStructureNS)(OWS_NAMESPACE_URIS,{Title:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Identifier:(0,_xml.makeObjectPropertySetter)(_xsd.readString)})),TMS_LINKS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{TileMatrixSet:(0,_xml.makeObjectPropertySetter)(_xsd.readString),TileMatrixSetLimits:(0,_xml.makeObjectPropertySetter)(readTileMatrixLimitsList)}),TMS_LIMITS_LIST_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{TileMatrixLimits:(0,_xml.makeArrayPusher)(readTileMatrixLimits)}),TMS_LIMITS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{TileMatrix:(0,_xml.makeObjectPropertySetter)(_xsd.readString),MinTileRow:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MaxTileRow:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MinTileCol:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MaxTileCol:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger)}),DIMENSION_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{Default:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Value:(0,_xml.makeObjectPropertyPusher)(_xsd.readString)},(0,_xml.makeStructureNS)(OWS_NAMESPACE_URIS,{Identifier:(0,_xml.makeObjectPropertySetter)(_xsd.readString)})),WGS84_BBOX_READERS=(0,_xml.makeStructureNS)(OWS_NAMESPACE_URIS,{LowerCorner:(0,_xml.makeArrayPusher)(readCoordinates),UpperCorner:(0,_xml.makeArrayPusher)(readCoordinates)}),TMS_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{WellKnownScaleSet:(0,_xml.makeObjectPropertySetter)(_xsd.readString),TileMatrix:(0,_xml.makeObjectPropertyPusher)(readTileMatrix)},(0,_xml.makeStructureNS)(OWS_NAMESPACE_URIS,{SupportedCRS:(0,_xml.makeObjectPropertySetter)(_xsd.readString),Identifier:(0,_xml.makeObjectPropertySetter)(_xsd.readString),BoundingBox:(0,_xml.makeObjectPropertySetter)(readBoundingBox)})),TM_PARSERS=(0,_xml.makeStructureNS)(NAMESPACE_URIS,{TopLeftCorner:(0,_xml.makeObjectPropertySetter)(readCoordinates),ScaleDenominator:(0,_xml.makeObjectPropertySetter)(_xsd.readDecimal),TileWidth:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),TileHeight:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MatrixWidth:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger),MatrixHeight:(0,_xml.makeObjectPropertySetter)(_xsd.readPositiveInteger)},(0,_xml.makeStructureNS)(OWS_NAMESPACE_URIS,{Identifier:(0,_xml.makeObjectPropertySetter)(_xsd.readString)}));function readContents(e,t){return(0,_xml.pushParseAndPop)({},CONTENTS_PARSERS,e,t)}function readLayer(e,t){return(0,_xml.pushParseAndPop)({},LAYER_PARSERS,e,t)}function readTileMatrixSet(e,t){return(0,_xml.pushParseAndPop)({},TMS_PARSERS,e,t)}function readStyle(e,t){var r=(0,_xml.pushParseAndPop)({},STYLE_PARSERS,e,t);if(r){var o="true"===e.getAttribute("isDefault");return r.isDefault=o,r}}function readTileMatrixSetLink(e,t){return(0,_xml.pushParseAndPop)({},TMS_LINKS_PARSERS,e,t)}function readDimensions(e,t){return(0,_xml.pushParseAndPop)({},DIMENSION_PARSERS,e,t)}function readResourceUrl(e,t){var r=e.getAttribute("format"),o=e.getAttribute("template"),i=e.getAttribute("resourceType"),n={};return r&&(n.format=r),o&&(n.template=o),i&&(n.resourceType=i),n}function readBoundingBox(e,t){var r=(0,_xml.pushParseAndPop)([],WGS84_BBOX_READERS,e,t);if(2==r.length)return(0,_extent.boundingExtent)(r)}function readBoundingBoxWithCrs(e,t){var r=e.getAttribute("crs"),o=(0,_xml.pushParseAndPop)([],WGS84_BBOX_READERS,e,t);if(2==o.length)return{extent:(0,_extent.boundingExtent)(o),crs:r}}function readLegendUrl(e,t){var r={};return r.format=e.getAttribute("format"),r.href=(0,_xlink.readHref)(e),r}function readCoordinates(e,t){var r=(0,_xsd.readString)(e).split(/\s+/);if(r&&2==r.length){var o=+r[0],i=+r[1];if(!isNaN(o)&&!isNaN(i))return[o,i]}}function readTileMatrix(e,t){return(0,_xml.pushParseAndPop)({},TM_PARSERS,e,t)}function readTileMatrixLimitsList(e,t){return(0,_xml.pushParseAndPop)([],TMS_LIMITS_LIST_PARSERS,e,t)}function readTileMatrixLimits(e,t){return(0,_xml.pushParseAndPop)({},TMS_LIMITS_PARSERS,e,t)}var _default=exports.default=WMTSCapabilities;

},{"../extent.js":142,"../xml.js":418,"./OWS.js":160,"./XML.js":170,"./xlink.js":198,"./xsd.js":199}],170:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _util=require("../util.js"),_xml=require("../xml.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var XML=function(){return _createClass(function e(){_classCallCheck(this,e)},[{key:"read",value:function(e){if(!e)return null;if("string"==typeof e){var t=(0,_xml.parse)(e);return this.readFromDocument(t)}return(0,_xml.isDocument)(e)?this.readFromDocument(e):this.readFromNode(e)}},{key:"readFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null}},{key:"readFromNode",value:function(e){(0,_util.abstract)()}}])}(),_default=exports.default=XML;

},{"../util.js":404,"../xml.js":418}],171:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Feature=_interopRequireDefault(require("../format/Feature.js")),_util=require("../util.js"),_array=require("../array.js"),_xml=require("../xml.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var XMLFeature=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).xmlSerializer_=(0,_xml.getXMLSerializer)(),e}return _inherits(t,_Feature["default"]),_createClass(t,[{key:"getType",value:function(){return"xml"}},{key:"readFeature",value:function(e,t){if(!e)return null;if("string"==typeof e){var r=(0,_xml.parse)(e);return this.readFeatureFromDocument(r,t)}return(0,_xml.isDocument)(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}},{key:"readFeatureFromDocument",value:function(e,t){var r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}},{key:"readFeatureFromNode",value:function(e,t){return null}},{key:"readFeatures",value:function(e,t){if(!e)return[];if("string"==typeof e){var r=(0,_xml.parse)(e);return this.readFeaturesFromDocument(r,t)}return(0,_xml.isDocument)(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}},{key:"readFeaturesFromDocument",value:function(e,t){for(var r=[],o=e.firstChild;o;o=o.nextSibling)o.nodeType==Node.ELEMENT_NODE&&(0,_array.extend)(r,this.readFeaturesFromNode(o,t));return r}},{key:"readFeaturesFromNode",value:function(e,t){return(0,_util.abstract)()}},{key:"readGeometry",value:function(e,t){if(!e)return null;if("string"==typeof e){var r=(0,_xml.parse)(e);return this.readGeometryFromDocument(r,t)}return(0,_xml.isDocument)(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}},{key:"readGeometryFromDocument",value:function(e,t){return null}},{key:"readGeometryFromNode",value:function(e,t){return null}},{key:"readProjection",value:function(e){if(!e)return null;if("string"==typeof e){var t=(0,_xml.parse)(e);return this.readProjectionFromDocument(t)}return(0,_xml.isDocument)(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}},{key:"readProjectionFromDocument",value:function(e){return this.dataProjection}},{key:"readProjectionFromNode",value:function(e){return this.dataProjection}},{key:"writeFeature",value:function(e,t){var r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}},{key:"writeFeatureNode",value:function(e,t){return null}},{key:"writeFeatures",value:function(e,t){var r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}},{key:"writeFeaturesNode",value:function(e,t){return null}},{key:"writeGeometry",value:function(e,t){var r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}},{key:"writeGeometryNode",value:function(e,t){return null}}])}(),_default=exports.default=XMLFeature;

},{"../array.js":110,"../format/Feature.js":147,"../util.js":404,"../xml.js":418}],172:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.and=and,exports.bbox=bbox,exports.between=between,exports.contains=contains,exports.disjoint=disjoint,exports.during=during,exports.dwithin=dwithin,exports.equalTo=equalTo,exports.greaterThan=greaterThan,exports.greaterThanOrEqualTo=greaterThanOrEqualTo,exports.intersects=intersects,exports.isNull=isNull,exports.lessThan=lessThan,exports.lessThanOrEqualTo=lessThanOrEqualTo,exports.like=like,exports.not=not,exports.notEqualTo=notEqualTo,exports.or=or,exports.resourceId=resourceId,exports.within=within;var _And=_interopRequireDefault(require("./filter/And.js")),_Bbox=_interopRequireDefault(require("./filter/Bbox.js")),_Contains=_interopRequireDefault(require("./filter/Contains.js")),_DWithin=_interopRequireDefault(require("./filter/DWithin.js")),_Disjoint=_interopRequireDefault(require("./filter/Disjoint.js")),_During=_interopRequireDefault(require("./filter/During.js")),_EqualTo=_interopRequireDefault(require("./filter/EqualTo.js")),_GreaterThan=_interopRequireDefault(require("./filter/GreaterThan.js")),_GreaterThanOrEqualTo=_interopRequireDefault(require("./filter/GreaterThanOrEqualTo.js")),_Intersects=_interopRequireDefault(require("./filter/Intersects.js")),_IsBetween=_interopRequireDefault(require("./filter/IsBetween.js")),_IsLike=_interopRequireDefault(require("./filter/IsLike.js")),_IsNull=_interopRequireDefault(require("./filter/IsNull.js")),_LessThan=_interopRequireDefault(require("./filter/LessThan.js")),_LessThanOrEqualTo=_interopRequireDefault(require("./filter/LessThanOrEqualTo.js")),_Not=_interopRequireDefault(require("./filter/Not.js")),_NotEqualTo=_interopRequireDefault(require("./filter/NotEqualTo.js")),_Or=_interopRequireDefault(require("./filter/Or.js")),_ResourceId=_interopRequireDefault(require("./filter/ResourceId.js")),_Within=_interopRequireDefault(require("./filter/Within.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function and(e){var r=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(_And.default,r))}function or(e){var r=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(_Or.default,r))}function not(e){return new _Not.default(e)}function bbox(e,r,t){return new _Bbox.default(e,r,t)}function contains(e,r,t){return new _Contains.default(e,r,t)}function intersects(e,r,t){return new _Intersects.default(e,r,t)}function disjoint(e,r,t){return new _Disjoint.default(e,r,t)}function within(e,r,t){return new _Within.default(e,r,t)}function dwithin(e,r,t,n,u){return new _DWithin.default(e,r,t,n,u)}function equalTo(e,r,t){return new _EqualTo.default(e,r,t)}function notEqualTo(e,r,t){return new _NotEqualTo.default(e,r,t)}function lessThan(e,r){return new _LessThan.default(e,r)}function lessThanOrEqualTo(e,r){return new _LessThanOrEqualTo.default(e,r)}function greaterThan(e,r){return new _GreaterThan.default(e,r)}function greaterThanOrEqualTo(e,r){return new _GreaterThanOrEqualTo.default(e,r)}function isNull(e){return new _IsNull.default(e)}function between(e,r,t){return new _IsBetween.default(e,r,t)}function like(e,r,t,n,u,i){return new _IsLike.default(e,r,t,n,u,i)}function during(e,r,t){return new _During.default(e,r,t)}function resourceId(e){return new _ResourceId.default(e)}

},{"./filter/And.js":173,"./filter/Bbox.js":174,"./filter/Contains.js":177,"./filter/DWithin.js":178,"./filter/Disjoint.js":179,"./filter/During.js":180,"./filter/EqualTo.js":181,"./filter/GreaterThan.js":183,"./filter/GreaterThanOrEqualTo.js":184,"./filter/Intersects.js":185,"./filter/IsBetween.js":186,"./filter/IsLike.js":187,"./filter/IsNull.js":188,"./filter/LessThan.js":189,"./filter/LessThanOrEqualTo.js":190,"./filter/Not.js":192,"./filter/NotEqualTo.js":193,"./filter/Or.js":194,"./filter/ResourceId.js":195,"./filter/Within.js":197}],173:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _LogicalNary2=_interopRequireDefault(require("./LogicalNary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var And=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,["And",Array.prototype.slice.call(arguments)])}return _inherits(e,_LogicalNary2["default"]),_createClass(e)}(),_default=exports.default=And;

},{"./LogicalNary.js":191}],174:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Filter2=_interopRequireDefault(require("./Filter.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Bbox=function(t){function e(t,r,o){var n;if(_classCallCheck(this,e),(n=_callSuper(this,e,["BBOX"])).geometryName=t,n.extent=r,4!==r.length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return n.srsName=o,n}return _inherits(e,_Filter2["default"]),_createClass(e)}(),_default=exports.default=Bbox;

},{"./Filter.js":182}],175:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Filter2=_interopRequireDefault(require("./Filter.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Comparison=function(t){function e(t,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e,[t])).propertyName=r,o}return _inherits(e,_Filter2["default"]),_createClass(e)}(),_default=exports.default=Comparison;

},{"./Filter.js":182}],176:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Comparison2=_interopRequireDefault(require("./Comparison.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ComparisonBinary=function(t){function e(t,r,o,n){var i;return _classCallCheck(this,e),(i=_callSuper(this,e,[t,r])).expression=o,i.matchCase=n,i}return _inherits(e,_Comparison2["default"]),_createClass(e)}(),_default=exports.default=ComparisonBinary;

},{"./Comparison.js":175}],177:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Spatial2=_interopRequireDefault(require("./Spatial.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Contains=function(t){function e(t,r,o){return _classCallCheck(this,e),_callSuper(this,e,["Contains",t,r,o])}return _inherits(e,_Spatial2["default"]),_createClass(e)}(),_default=exports.default=Contains;

},{"./Spatial.js":196}],178:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Spatial2=_interopRequireDefault(require("./Spatial.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DWithin=function(t){function e(t,r,o,n,i){var u;return _classCallCheck(this,e),(u=_callSuper(this,e,["DWithin",t,r,i])).distance=o,u.unit=n,u}return _inherits(e,_Spatial2["default"]),_createClass(e)}(),_default=exports.default=DWithin;

},{"./Spatial.js":196}],179:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Spatial2=_interopRequireDefault(require("./Spatial.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Disjoint=function(t){function e(t,r,o){return _classCallCheck(this,e),_callSuper(this,e,["Disjoint",t,r,o])}return _inherits(e,_Spatial2["default"]),_createClass(e)}(),_default=exports.default=Disjoint;

},{"./Spatial.js":196}],180:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Comparison2=_interopRequireDefault(require("./Comparison.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var During=function(t){function e(t,r,o){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,["During",t])).begin=r,n.end=o,n}return _inherits(e,_Comparison2["default"]),_createClass(e)}(),_default=exports.default=During;

},{"./Comparison.js":175}],181:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ComparisonBinary2=_interopRequireDefault(require("./ComparisonBinary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var EqualTo=function(t){function e(t,r,o){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsEqualTo",t,r,o])}return _inherits(e,_ComparisonBinary2["default"]),_createClass(e)}(),_default=exports.default=EqualTo;

},{"./ComparisonBinary.js":176}],182:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Filter=function(){return _createClass(function e(t){_classCallCheck(this,e),this.tagName_=t},[{key:"getTagName",value:function(){return this.tagName_}}])}(),_default=exports.default=Filter;

},{}],183:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ComparisonBinary2=_interopRequireDefault(require("./ComparisonBinary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var GreaterThan=function(t){function e(t,r){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsGreaterThan",t,r])}return _inherits(e,_ComparisonBinary2["default"]),_createClass(e)}(),_default=exports.default=GreaterThan;

},{"./ComparisonBinary.js":176}],184:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ComparisonBinary2=_interopRequireDefault(require("./ComparisonBinary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var GreaterThanOrEqualTo=function(t){function e(t,r){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsGreaterThanOrEqualTo",t,r])}return _inherits(e,_ComparisonBinary2["default"]),_createClass(e)}(),_default=exports.default=GreaterThanOrEqualTo;

},{"./ComparisonBinary.js":176}],185:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Spatial2=_interopRequireDefault(require("./Spatial.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Intersects=function(t){function e(t,r,o){return _classCallCheck(this,e),_callSuper(this,e,["Intersects",t,r,o])}return _inherits(e,_Spatial2["default"]),_createClass(e)}(),_default=exports.default=Intersects;

},{"./Spatial.js":196}],186:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Comparison2=_interopRequireDefault(require("./Comparison.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var IsBetween=function(t){function e(t,r,o){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,["PropertyIsBetween",t])).lowerBoundary=r,n.upperBoundary=o,n}return _inherits(e,_Comparison2["default"]),_createClass(e)}(),_default=exports.default=IsBetween;

},{"./Comparison.js":175}],187:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Comparison2=_interopRequireDefault(require("./Comparison.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var IsLike=function(t){function e(t,r,o,n,i,u){var f;return _classCallCheck(this,e),(f=_callSuper(this,e,["PropertyIsLike",t])).pattern=r,f.wildCard=void 0!==o?o:"*",f.singleChar=void 0!==n?n:".",f.escapeChar=void 0!==i?i:"!",f.matchCase=u,f}return _inherits(e,_Comparison2["default"]),_createClass(e)}(),_default=exports.default=IsLike;

},{"./Comparison.js":175}],188:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Comparison2=_interopRequireDefault(require("./Comparison.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var IsNull=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsNull",t])}return _inherits(e,_Comparison2["default"]),_createClass(e)}(),_default=exports.default=IsNull;

},{"./Comparison.js":175}],189:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ComparisonBinary2=_interopRequireDefault(require("./ComparisonBinary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LessThan=function(t){function e(t,r){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsLessThan",t,r])}return _inherits(e,_ComparisonBinary2["default"]),_createClass(e)}(),_default=exports.default=LessThan;

},{"./ComparisonBinary.js":176}],190:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ComparisonBinary2=_interopRequireDefault(require("./ComparisonBinary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LessThanOrEqualTo=function(t){function e(t,r){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsLessThanOrEqualTo",t,r])}return _inherits(e,_ComparisonBinary2["default"]),_createClass(e)}(),_default=exports.default=LessThanOrEqualTo;

},{"./ComparisonBinary.js":176}],191:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Filter2=_interopRequireDefault(require("./Filter.js")),_asserts=require("../../asserts.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LogicalNary=function(t){function e(t,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e,[t])).conditions=r,(0,_asserts.assert)(o.conditions.length>=2,"At least 2 conditions are required"),o}return _inherits(e,_Filter2["default"]),_createClass(e)}(),_default=exports.default=LogicalNary;

},{"../../asserts.js":111,"./Filter.js":182}],192:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Filter2=_interopRequireDefault(require("./Filter.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Not=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,["Not"])).condition=t,r}return _inherits(e,_Filter2["default"]),_createClass(e)}(),_default=exports.default=Not;

},{"./Filter.js":182}],193:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ComparisonBinary2=_interopRequireDefault(require("./ComparisonBinary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var NotEqualTo=function(t){function e(t,r,o){return _classCallCheck(this,e),_callSuper(this,e,["PropertyIsNotEqualTo",t,r,o])}return _inherits(e,_ComparisonBinary2["default"]),_createClass(e)}(),_default=exports.default=NotEqualTo;

},{"./ComparisonBinary.js":176}],194:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _LogicalNary2=_interopRequireDefault(require("./LogicalNary.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Or=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,["Or",Array.prototype.slice.call(arguments)])}return _inherits(e,_LogicalNary2["default"]),_createClass(e)}(),_default=exports.default=Or;

},{"./LogicalNary.js":191}],195:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Filter2=_interopRequireDefault(require("./Filter.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ResourceId=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,["ResourceId"])).rid=t,r}return _inherits(e,_Filter2["default"]),_createClass(e)}(),_default=exports.default=ResourceId;

},{"./Filter.js":182}],196:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Filter2=_interopRequireDefault(require("./Filter.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Spatial=function(t){function e(t,r,o,n){var i;return _classCallCheck(this,e),(i=_callSuper(this,e,[t])).geometryName=r||"the_geom",i.geometry=o,i.srsName=n,i}return _inherits(e,_Filter2["default"]),_createClass(e)}(),_default=exports.default=Spatial;

},{"./Filter.js":182}],197:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Spatial2=_interopRequireDefault(require("./Spatial.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Within=function(t){function e(t,r,o){return _classCallCheck(this,e),_callSuper(this,e,["Within",t,r,o])}return _inherits(e,_Spatial2["default"]),_createClass(e)}(),_default=exports.default=Within;

},{"./Spatial.js":196}],198:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.readHref=readHref;var NAMESPACE_URI="http://www.w3.org/1999/xlink";function readHref(e){return e.getAttributeNS(NAMESPACE_URI,"href")}

},{}],199:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.readBoolean=readBoolean,exports.readBooleanString=readBooleanString,exports.readDateTime=readDateTime,exports.readDecimal=readDecimal,exports.readDecimalString=readDecimalString,exports.readNonNegativeIntegerString=readNonNegativeIntegerString,exports.readPositiveInteger=readPositiveInteger,exports.readString=readString,exports.writeBooleanTextNode=writeBooleanTextNode,exports.writeCDATASection=writeCDATASection,exports.writeDateTimeTextNode=writeDateTimeTextNode,exports.writeDecimalTextNode=writeDecimalTextNode,exports.writeNonNegativeIntegerTextNode=writeNonNegativeIntegerTextNode,exports.writeStringTextNode=writeStringTextNode;var _xml=require("../xml.js"),_string=require("../string.js");function readBoolean(e){return readBooleanString((0,_xml.getAllTextContent)(e,!1))}function readBooleanString(e){var t=/^\s*(true|1)|(false|0)\s*$/.exec(e);if(t)return void 0!==t[1]||!1}function readDateTime(e){var t=(0,_xml.getAllTextContent)(e,!1),r=Date.parse(t);return isNaN(r)?void 0:r/1e3}function readDecimal(e){return readDecimalString((0,_xml.getAllTextContent)(e,!1))}function readDecimalString(e){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);if(t)return parseFloat(t[1])}function readPositiveInteger(e){return readNonNegativeIntegerString((0,_xml.getAllTextContent)(e,!1))}function readNonNegativeIntegerString(e){var t=/^\s*(\d+)\s*$/.exec(e);if(t)return parseInt(t[1],10)}function readString(e){return(0,_xml.getAllTextContent)(e,!1).trim()}function writeBooleanTextNode(e,t){writeStringTextNode(e,t?"1":"0")}function writeCDATASection(e,t){e.appendChild((0,_xml.getDocument)().createCDATASection(t))}function writeDateTimeTextNode(e,t){var r=new Date(1e3*t),n=r.getUTCFullYear()+"-"+(0,_string.padNumber)(r.getUTCMonth()+1,2)+"-"+(0,_string.padNumber)(r.getUTCDate(),2)+"T"+(0,_string.padNumber)(r.getUTCHours(),2)+":"+(0,_string.padNumber)(r.getUTCMinutes(),2)+":"+(0,_string.padNumber)(r.getUTCSeconds(),2)+"Z";e.appendChild((0,_xml.getDocument)().createTextNode(n))}function writeDecimalTextNode(e,t){var r=t.toPrecision();e.appendChild((0,_xml.getDocument)().createTextNode(r))}function writeNonNegativeIntegerTextNode(e,t){var r=t.toString();e.appendChild((0,_xml.getDocument)().createTextNode(r))}function writeStringTextNode(e,t){e.appendChild((0,_xml.getDocument)().createTextNode(t))}

},{"../string.js":380,"../xml.js":418}],200:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FALSE=FALSE,exports.TRUE=TRUE,exports.VOID=VOID,exports.memoizeOne=memoizeOne,exports.toPromise=toPromise;var _array=require("./array.js");function TRUE(){return!0}function FALSE(){return!1}function VOID(){}function memoizeOne(r){var e,t,o,n=!1;return function(){var i=Array.prototype.slice.call(arguments);return n&&this===o&&(0,_array.equals)(i,t)||(n=!0,o=this,t=i,e=r.apply(this,arguments)),e}}function toPromise(r){return function(){var e;try{e=r()}catch(r){return Promise.reject(r)}return e instanceof Promise?e:Promise.resolve(e)}()}

},{"./array.js":110}],201:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Circle",{enumerable:!0,get:function(){return _Circle.default}}),Object.defineProperty(exports,"Geometry",{enumerable:!0,get:function(){return _Geometry.default}}),Object.defineProperty(exports,"GeometryCollection",{enumerable:!0,get:function(){return _GeometryCollection.default}}),Object.defineProperty(exports,"LineString",{enumerable:!0,get:function(){return _LineString.default}}),Object.defineProperty(exports,"LinearRing",{enumerable:!0,get:function(){return _LinearRing.default}}),Object.defineProperty(exports,"MultiLineString",{enumerable:!0,get:function(){return _MultiLineString.default}}),Object.defineProperty(exports,"MultiPoint",{enumerable:!0,get:function(){return _MultiPoint.default}}),Object.defineProperty(exports,"MultiPolygon",{enumerable:!0,get:function(){return _MultiPolygon.default}}),Object.defineProperty(exports,"Point",{enumerable:!0,get:function(){return _Point.default}}),Object.defineProperty(exports,"Polygon",{enumerable:!0,get:function(){return _Polygon.default}}),Object.defineProperty(exports,"SimpleGeometry",{enumerable:!0,get:function(){return _SimpleGeometry.default}});var _Circle=_interopRequireDefault(require("./geom/Circle.js")),_Geometry=_interopRequireDefault(require("./geom/Geometry.js")),_GeometryCollection=_interopRequireDefault(require("./geom/GeometryCollection.js")),_LinearRing=_interopRequireDefault(require("./geom/LinearRing.js")),_LineString=_interopRequireDefault(require("./geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("./geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("./geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("./geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("./geom/Point.js")),_Polygon=_interopRequireDefault(require("./geom/Polygon.js")),_SimpleGeometry=_interopRequireDefault(require("./geom/SimpleGeometry.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./geom/Circle.js":202,"./geom/Geometry.js":203,"./geom/GeometryCollection.js":204,"./geom/LineString.js":205,"./geom/LinearRing.js":206,"./geom/MultiLineString.js":207,"./geom/MultiPoint.js":208,"./geom/MultiPolygon.js":209,"./geom/Point.js":210,"./geom/Polygon.js":211,"./geom/SimpleGeometry.js":212}],202:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_transform=require("./flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Circle=function(t){function e(t,r,o){var i;return _classCallCheck(this,e),i=_callSuper(this,e),void 0!==o&&void 0===r?i.setFlatCoordinates(o,t):(r=r||0,i.setCenterAndRadius(t,r,o)),i}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,o){var i=this.flatCoordinates,n=t-i[0],s=e-i[1],a=n*n+s*s;if(a<o){if(0===a)for(var u=0;u<this.stride;++u)r[u]=i[u];else{var f=this.getRadius()/Math.sqrt(a);r[0]=i[0]+f*n,r[1]=i[1]+f*s;for(var l=2;l<this.stride;++l)r[l]=i[l]}return r.length=this.stride,a}return o}},{key:"containsXY",value:function(t,e){var r=this.flatCoordinates,o=t-r[0],i=e-r[1];return o*o+i*i<=this.getRadiusSquared_()}},{key:"getCenter",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"computeExtent",value:function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return(0,_extent.createOrUpdate)(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)}},{key:"getRadius",value:function(){return Math.sqrt(this.getRadiusSquared_())}},{key:"getRadiusSquared_",value:function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}},{key:"getType",value:function(){return"Circle"}},{key:"intersectsExtent",value:function(t){var e=this.getExtent();if((0,_extent.intersects)(t,e)){var r=this.getCenter();return t[0]<=r[0]&&t[2]>=r[0]||(t[1]<=r[1]&&t[3]>=r[1]||(0,_extent.forEachCorner)(t,this.intersectsCoordinate.bind(this)))}return!1}},{key:"setCenter",value:function(t){var e=this.stride,r=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+r;for(var i=1;i<e;++i)o[e+i]=t[i];this.setFlatCoordinates(this.layout,o),this.changed()}},{key:"setCenterAndRadius",value:function(t,e,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var o=this.flatCoordinates,i=(0,_deflate.deflateCoordinate)(o,0,t,this.stride);o[i++]=o[0]+e;for(var n=1,s=this.stride;n<s;++n)o[i++]=o[n];o.length=i,this.changed()}},{key:"getCoordinates",value:function(){return null}},{key:"setCoordinates",value:function(t,e){}},{key:"setRadius",value:function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}},{key:"rotate",value:function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter((0,_transform.rotate)(r,0,r.length,o,t,e,r)),this.changed()}}])}();Circle.prototype.transform;var _default=exports.default=Circle;

},{"../extent.js":142,"./SimpleGeometry.js":212,"./flat/deflate.js":217,"./flat/transform.js":232}],203:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_util=require("../util.js"),_transform=require("../transform.js"),_extent2=require("../extent.js"),_proj=require("../proj.js"),_functions=require("../functions.js"),_transform2=require("./flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var tmpTransform=(0,_transform.create)(),Geometry=function(t){function e(){var t;return _classCallCheck(this,e),(t=_callSuper(this,e)).extent_=(0,_extent2.createEmpty)(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(0,_functions.memoizeOne)(function(e,r,n){if(!n)return t.getSimplifiedGeometry(r);var o=t.clone();return o.applyTransform(n),o.getSimplifiedGeometry(r)}),t}return _inherits(e,_Object["default"]),_createClass(e,[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return(0,_util.abstract)()}},{key:"closestPointXY",value:function(t,e,r,n){return(0,_util.abstract)()}},{key:"containsXY",value:function(t,e){var r=this.getClosestPoint([t,e]);return r[0]===t&&r[1]===e}},{key:"getClosestPoint",value:function(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return(0,_util.abstract)()}},{key:"getExtent",value:function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&(0,_extent2.createOrUpdateEmpty)(e),this.extentRevision_=this.getRevision()}return(0,_extent2.returnOrUpdate)(this.extent_,t)}},{key:"rotate",value:function(t,e){(0,_util.abstract)()}},{key:"scale",value:function(t,e,r){(0,_util.abstract)()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return(0,_util.abstract)()}},{key:"getType",value:function(){return(0,_util.abstract)()}},{key:"applyTransform",value:function(t){(0,_util.abstract)()}},{key:"intersectsExtent",value:function(t){return(0,_util.abstract)()}},{key:"translate",value:function(t,e){(0,_util.abstract)()}},{key:"transform",value:function(t,e){var r=(0,_proj.get)(t),n="tile-pixels"==r.getUnits()?function(t,n,o){var i=r.getExtent(),u=r.getWorldExtent(),s=(0,_extent2.getHeight)(u)/(0,_extent2.getHeight)(i);return(0,_transform.compose)(tmpTransform,u[0],u[3],s,-s,0,0,0),(0,_transform2.transform2D)(t,0,t.length,o,tmpTransform,n),(0,_proj.getTransform)(r,e)(t,n,o)}:(0,_proj.getTransform)(r,e);return this.applyTransform(n),this}}])}(),_default=exports.default=Geometry;

},{"../Object.js":96,"../extent.js":142,"../functions.js":200,"../proj.js":283,"../transform.js":402,"../util.js":404,"./flat/transform.js":232}],204:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Geometry2=_interopRequireDefault(require("./Geometry.js")),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GeometryCollection=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).geometries_=e,r.changeEventsKeys_=[],r.listenGeometriesChange_(),r}return _inherits(t,_Geometry2["default"]),_createClass(t,[{key:"unlistenGeometriesChange_",value:function(){this.changeEventsKeys_.forEach(_events.unlistenByKey),this.changeEventsKeys_.length=0}},{key:"listenGeometriesChange_",value:function(){for(var e=this.geometries_,t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push((0,_events.listen)(e[t],_EventType.default.CHANGE,this.changed,this))}},{key:"clone",value:function(){var e=new t(cloneGeometries(this.geometries_));return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){if(n<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),e,t))return n;for(var o=this.geometries_,i=0,s=o.length;i<s;++i)n=o[i].closestPointXY(e,t,r,n);return n}},{key:"containsXY",value:function(e,t){for(var r=this.geometries_,n=0,o=r.length;n<o;++n)if(r[n].containsXY(e,t))return!0;return!1}},{key:"computeExtent",value:function(e){(0,_extent.createOrUpdateEmpty)(e);for(var t=this.geometries_,r=0,n=t.length;r<n;++r)(0,_extent.extend)(e,t[r].getExtent());return e}},{key:"getGeometries",value:function(){return cloneGeometries(this.geometries_)}},{key:"getGeometriesArray",value:function(){return this.geometries_}},{key:"getGeometriesArrayRecursive",value:function(){for(var e=[],t=this.geometries_,r=0,n=t.length;r<n;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}},{key:"getSimplifiedGeometry",value:function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var r=[],n=this.geometries_,o=!1,i=0,s=n.length;i<s;++i){var u=n[i],a=u.getSimplifiedGeometry(e);r.push(a),a!==u&&(o=!0)}return o?new t(r):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}},{key:"getType",value:function(){return"GeometryCollection"}},{key:"intersectsExtent",value:function(e){for(var t=this.geometries_,r=0,n=t.length;r<n;++r)if(t[r].intersectsExtent(e))return!0;return!1}},{key:"isEmpty",value:function(){return 0===this.geometries_.length}},{key:"rotate",value:function(e,t){for(var r=this.geometries_,n=0,o=r.length;n<o;++n)r[n].rotate(e,t);this.changed()}},{key:"scale",value:function(e,t,r){r||(r=(0,_extent.getCenter)(this.getExtent()));for(var n=this.geometries_,o=0,i=n.length;o<i;++o)n[o].scale(e,t,r);this.changed()}},{key:"setGeometries",value:function(e){this.setGeometriesArray(cloneGeometries(e))}},{key:"setGeometriesArray",value:function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}},{key:"applyTransform",value:function(e){for(var t=this.geometries_,r=0,n=t.length;r<n;++r)t[r].applyTransform(e);this.changed()}},{key:"translate",value:function(e,t){for(var r=this.geometries_,n=0,o=r.length;n<o;++n)r[n].translate(e,t);this.changed()}},{key:"disposeInternal",value:function(){this.unlistenGeometriesChange_(),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}();function cloneGeometries(e){return e.map(function(e){return e.clone()})}var _default=exports.default=GeometryCollection;

},{"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"./Geometry.js":203}],205:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_simplify=require("./flat/simplify.js"),_array=require("../array.js"),_segments=require("./flat/segments.js"),_inflate=require("./flat/inflate.js"),_interpolate=require("./flat/interpolate.js"),_intersectsextent=require("./flat/intersectsextent.js"),_length=require("./flat/length.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LineString=function(t){function e(t,i){var r;return _classCallCheck(this,e),(r=_callSuper(this,e)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?r.setCoordinates(t,i):r.setFlatCoordinates(i,t),r}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendCoordinate",value:function(t){(0,_array.extend)(this.flatCoordinates,t),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,i,r){return r<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}},{key:"forEachSegment",value:function(t){return(0,_segments.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinateAtM",value:function(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,(0,_interpolate.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(t,e){return(0,_interpolate.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}},{key:"getLength",value:function(){return(0,_length.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){var t;this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,null!==(t=this.flatMidpoint_)&&void 0!==t?t:void 0),this.flatMidpointRevision_=this.getRevision());return this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(t){var i=[];return i.length=(0,_simplify.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,"XY")}},{key:"getType",value:function(){return"LineString"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=LineString;

},{"../array.js":110,"../extent.js":142,"./SimpleGeometry.js":212,"./flat/closest.js":215,"./flat/deflate.js":217,"./flat/inflate.js":220,"./flat/interpolate.js":222,"./flat/intersectsextent.js":223,"./flat/length.js":224,"./flat/segments.js":228,"./flat/simplify.js":229}],206:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_simplify=require("./flat/simplify.js"),_inflate=require("./flat/inflate.js"),_area=require("./flat/area.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LinearRing=function(t){function e(t,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).maxDelta_=-1,o.maxDeltaRevision_=-1,void 0===r||Array.isArray(t[0])?o.setCoordinates(t,r):o.setFlatCoordinates(r,t),o}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"clone",value:function(){return new e(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,r,o){return o<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,r,o))}},{key:"getArea",value:function(){return(0,_area.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var r=[];return r.length=(0,_simplify.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,"XY")}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=LinearRing;

},{"../extent.js":142,"./SimpleGeometry.js":212,"./flat/area.js":213,"./flat/closest.js":215,"./flat/deflate.js":217,"./flat/inflate.js":220,"./flat/simplify.js":229}],207:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _LineString=_interopRequireDefault(require("./LineString.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_simplify=require("./flat/simplify.js"),_array=require("../array.js"),_inflate=require("./flat/inflate.js"),_interpolate=require("./flat/interpolate.js"),_intersectsextent=require("./flat/intersectsextent.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MultiLineString=function(t){function e(t,r,i){var n;if(_classCallCheck(this,e),(n=_callSuper(this,e)).ends_=[],n.maxDelta_=-1,n.maxDeltaRevision_=-1,Array.isArray(t[0]))n.setCoordinates(t,r);else if(void 0!==r&&i)n.setFlatCoordinates(r,t),n.ends_=i;else{for(var o=t,s=[],a=[],l=0,u=o.length;l<u;++l){var f=o[l];(0,_array.extend)(s,f.getFlatCoordinates()),a.push(s.length)}var c=0===o.length?n.getLayout():o[0].getLayout();n.setFlatCoordinates(c,s),n.ends_=a}return n}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendLineString",value:function(t){(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,i){return i<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,i))}},{key:"getCoordinateAtM",value:function(t,e,r){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,r=void 0!==r&&r,(0,_interpolate.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,t,e,r))}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getLineString",value:function(t){return t<0||this.ends_.length<=t?null:new _LineString.default(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLineStrings",value:function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,i=[],n=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new _LineString.default(t.slice(n,a),r);i.push(l),n=a}return i}},{key:"getFlatMidpoints",value:function(){for(var t=[],e=this.flatCoordinates,r=0,i=this.ends_,n=this.stride,o=0,s=i.length;o<s;++o){var a=i[o],l=(0,_interpolate.interpolatePoint)(e,r,a,n,.5);(0,_array.extend)(t,l),r=a}return t}},{key:"getSimplifiedGeometryInternal",value:function(t){var r=[],i=[];return r.length=(0,_simplify.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,i),new e(r,"XY",i)}},{key:"getType",value:function(){return"MultiLineString"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=(0,_deflate.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()}}])}(),_default=exports.default=MultiLineString;

},{"../array.js":110,"../extent.js":142,"./LineString.js":205,"./SimpleGeometry.js":212,"./flat/closest.js":215,"./flat/deflate.js":217,"./flat/inflate.js":220,"./flat/interpolate.js":222,"./flat/intersectsextent.js":223,"./flat/simplify.js":229}],208:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Point=_interopRequireDefault(require("./Point.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_array=require("../array.js"),_inflate=require("./flat/inflate.js"),_math=require("../math.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MultiPoint=function(t){function e(t,r){var o;return _classCallCheck(this,e),o=_callSuper(this,e),r&&!Array.isArray(t[0])?o.setFlatCoordinates(r,t):o.setCoordinates(t,r),o}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendPoint",value:function(t){(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,o){if(o<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e))return o;for(var n=this.flatCoordinates,i=this.stride,a=0,s=n.length;a<s;a+=i){var u=(0,_math.squaredDistance)(t,e,n[a],n[a+1]);if(u<o){o=u;for(var l=0;l<i;++l)r[l]=n[a+l];r.length=i}}return o}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getPoint",value:function(t){var e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new _Point.default(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}},{key:"getPoints",value:function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,o=[],n=0,i=t.length;n<i;n+=r){var a=new _Point.default(t.slice(n,n+r),e);o.push(a)}return o}},{key:"getType",value:function(){return"MultiPoint"}},{key:"intersectsExtent",value:function(t){for(var e=this.flatCoordinates,r=this.stride,o=0,n=e.length;o<n;o+=r){var i=e[o],a=e[o+1];if((0,_extent.containsXY)(t,i,a))return!0}return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=MultiPoint;

},{"../array.js":110,"../extent.js":142,"../math.js":279,"./Point.js":210,"./SimpleGeometry.js":212,"./flat/deflate.js":217,"./flat/inflate.js":220}],209:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _MultiPoint=_interopRequireDefault(require("./MultiPoint.js")),_Polygon=_interopRequireDefault(require("./Polygon.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_array=require("../array.js"),_interiorpoint=require("./flat/interiorpoint.js"),_inflate=require("./flat/inflate.js"),_intersectsextent=require("./flat/intersectsextent.js"),_orient=require("./flat/orient.js"),_area=require("./flat/area.js"),_center=require("./flat/center.js"),_contains=require("./flat/contains.js"),_simplify=require("./flat/simplify.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MultiPolygon=function(t){function e(t,i,r){var n;if(_classCallCheck(this,e),(n=_callSuper(this,e)).endss_=[],n.flatInteriorPointsRevision_=-1,n.flatInteriorPoints_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var s=t,o=[],a=[],l=0,u=s.length;l<u;++l){for(var f=s[l],d=o.length,h=f.getEnds(),c=0,_=h.length;c<_;++c)h[c]+=d;(0,_array.extend)(o,f.getFlatCoordinates()),a.push(h)}i=0===s.length?n.getLayout():s[0].getLayout(),t=o,r=a}return void 0!==i&&r?(n.setFlatCoordinates(i,t),n.endss_=r):n.setCoordinates(t,i),n}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendPolygon",value:function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,n=(e=t.getEnds().slice()).length;r<n;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}},{key:"clone",value:function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();var n=new e(this.flatCoordinates.slice(),this.layout,i);return n.applyProperties(this),n}},{key:"closestPointXY",value:function(t,e,i,r){return r<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))}},{key:"containsXY",value:function(t,e){return(0,_contains.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}},{key:"getArea",value:function(){return(0,_area.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,_orient.orientLinearRingsArray)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,_inflate.inflateMultiCoordinatesArray)(e,0,this.endss_,this.stride)}},{key:"getEndss",value:function(){return this.endss_}},{key:"getFlatInteriorPoints",value:function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=(0,_center.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,_interiorpoint.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}},{key:"getInteriorPoints",value:function(){return new _MultiPoint.default(this.getFlatInteriorPoints().slice(),"XYM")}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;(0,_orient.linearRingssAreOriented)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,_orient.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var i=[],r=[];return i.length=(0,_simplify.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,"XY",r)}},{key:"getPolygon",value:function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var r=this.endss_[t].slice(),n=r[r.length-1];if(0!==e)for(var s=0,o=r.length;s<o;++s)r[s]-=e;return new _Polygon.default(this.flatCoordinates.slice(e,n),this.layout,r)}},{key:"getPolygons",value:function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[],n=0,s=0,o=i.length;s<o;++s){var a=i[s].slice(),l=a[a.length-1];if(0!==n)for(var u=0,f=a.length;u<f;++u)a[u]-=n;var d=new _Polygon.default(e.slice(n,l),t,a);r.push(d),n=l}return r}},{key:"getType",value:function(){return"MultiPolygon"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,_deflate.deflateMultiCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()}}])}(),_default=exports.default=MultiPolygon;

},{"../array.js":110,"../extent.js":142,"./MultiPoint.js":208,"./Polygon.js":211,"./SimpleGeometry.js":212,"./flat/area.js":213,"./flat/center.js":214,"./flat/closest.js":215,"./flat/contains.js":216,"./flat/deflate.js":217,"./flat/inflate.js":220,"./flat/interiorpoint.js":221,"./flat/intersectsextent.js":223,"./flat/orient.js":226,"./flat/simplify.js":229}],210:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_math=require("../math.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Point=function(t){function e(t,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).setCoordinates(t,r),o}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,o){var n=this.flatCoordinates,i=(0,_math.squaredDistance)(t,e,n[0],n[1]);if(i<o){for(var u=this.stride,a=0;a<u;++a)r[a]=n[a];return r.length=u,i}return o}},{key:"getCoordinates",value:function(){return this.flatCoordinates.slice()}},{key:"computeExtent",value:function(t){return(0,_extent.createOrUpdateFromCoordinate)(this.flatCoordinates,t)}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(t){return(0,_extent.containsXY)(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinate)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=Point;

},{"../extent.js":142,"../math.js":279,"./SimpleGeometry.js":212,"./flat/deflate.js":217}],211:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.circular=circular,exports.default=void 0,exports.fromCircle=fromCircle,exports.fromExtent=fromExtent,exports.makeRegular=makeRegular;var _LinearRing=_interopRequireDefault(require("./LinearRing.js")),_Point=_interopRequireDefault(require("./Point.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_array=require("../array.js"),_interiorpoint=require("./flat/interiorpoint.js"),_inflate=require("./flat/inflate.js"),_intersectsextent=require("./flat/intersectsextent.js"),_orient=require("./flat/orient.js"),_area=require("./flat/area.js"),_contains=require("./flat/contains.js"),_math=require("../math.js"),_simplify=require("./flat/simplify.js"),_sphere=require("../sphere.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Polygon=function(t){function e(t,r,i){var n;return _classCallCheck(this,e),(n=_callSuper(this,e)).ends_=[],n.flatInteriorPointRevision_=-1,n.flatInteriorPoint_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,void 0!==r&&i?(n.setFlatCoordinates(r,t),n.ends_=i):n.setCoordinates(t,r),n}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendLinearRing",value:function(t){this.flatCoordinates?(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,i){return i<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,i))}},{key:"containsXY",value:function(t,e){return(0,_contains.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return(0,_area.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,_orient.orientLinearRings)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,(0,_inflate.inflateCoordinatesArray)(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=(0,_extent.getCenter)(this.getExtent());this.flatInteriorPoint_=(0,_interiorpoint.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new _Point.default(this.getFlatInteriorPoint(),"XYM")}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new _LinearRing.default(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,i=[],n=0,o=0,s=r.length;o<s;++o){var a=r[o],l=new _LinearRing.default(e.slice(n,a),t);i.push(l),n=a}return i}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;(0,_orient.linearRingsAreOriented)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,_orient.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var r=[],i=[];return r.length=(0,_simplify.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new e(r,"XY",i)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=(0,_deflate.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()}}])}(),_default=exports.default=Polygon;function circular(t,e,r,i){r=r||32;for(var n=[],o=0;o<r;++o)(0,_array.extend)(n,(0,_sphere.offset)(t,e,2*Math.PI*o/r,i));return n.push(n[0],n[1]),new Polygon(n,"XY",[n.length])}function fromExtent(t){if((0,_extent.isEmpty)(t))throw new Error("Cannot create polygon from empty extent");var e=t[0],r=t[1],i=t[2],n=t[3],o=[e,r,e,n,i,n,i,r,e,r];return new Polygon(o,"XY",[o.length])}function fromCircle(t,e,r){e=e||32;for(var i=t.getStride(),n=t.getLayout(),o=t.getCenter(),s=i*(e+1),a=new Array(s),l=0;l<s;l+=i){a[l]=0,a[l+1]=0;for(var u=2;u<i;u++)a[l+u]=o[u]}var f=[a.length],c=new Polygon(a,n,f);return makeRegular(c,o,t.getRadius(),r),c}function makeRegular(t,e,r,i){for(var n=t.getFlatCoordinates(),o=t.getStride(),s=n.length/o-1,a=i||0,l=0;l<=s;++l){var u=l*o,f=a+2*(0,_math.modulo)(l,s)*Math.PI/s;n[u]=e[0]+r*Math.cos(f),n[u+1]=e[1]+r*Math.sin(f)}t.changed()}

},{"../array.js":110,"../extent.js":142,"../math.js":279,"../sphere.js":379,"./LinearRing.js":206,"./Point.js":210,"./SimpleGeometry.js":212,"./flat/area.js":213,"./flat/closest.js":215,"./flat/contains.js":216,"./flat/deflate.js":217,"./flat/inflate.js":220,"./flat/interiorpoint.js":221,"./flat/intersectsextent.js":223,"./flat/orient.js":226,"./flat/simplify.js":229}],212:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getLayoutForStride=getLayoutForStride,exports.getStrideForLayout=getStrideForLayout,exports.transformGeom2D=transformGeom2D;var _Geometry2=_interopRequireDefault(require("./Geometry.js")),_util=require("../util.js"),_extent=require("../extent.js"),_transform=require("./flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var SimpleGeometry=function(t){function e(){var t;return _classCallCheck(this,e),(t=_callSuper(this,e)).layout="XY",t.stride=2,t.flatCoordinates,t}return _inherits(e,_Geometry2["default"]),_createClass(e,[{key:"computeExtent",value:function(t){return(0,_extent.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return(0,_util.abstract)()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=getStrideForLayout(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){(0,_util.abstract)()}},{key:"setLayout",value:function(t,e,r){var o;if(t)o=getStrideForLayout(t);else{for(var i=0;i<r;++i){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}t=getLayoutForStride(o=e.length)}this.layout=t,this.stride=o}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();(0,_transform.rotate)(r,0,r.length,o,t,e,r),this.changed()}}},{key:"scale",value:function(t,e,r){void 0===e&&(e=t),r||(r=(0,_extent.getCenter)(this.getExtent()));var o=this.getFlatCoordinates();if(o){var i=this.getStride();(0,_transform.scale)(o,0,o.length,i,t,e,r,o),this.changed()}}},{key:"translate",value:function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();(0,_transform.translate)(r,0,r.length,o,t,e,r),this.changed()}}}])}();function getLayoutForStride(t){var e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function getStrideForLayout(t){var e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}function transformGeom2D(t,e,r){var o=t.getFlatCoordinates();if(!o)return null;var i=t.getStride();return(0,_transform.transform2D)(o,0,o.length,i,e,r)}var _default=exports.default=SimpleGeometry;

},{"../extent.js":142,"../util.js":404,"./Geometry.js":203,"./flat/transform.js":232}],213:[function(require,module,exports){
"use strict";function linearRing(n,r,e,i){for(var a=0,s=n[e-i],t=n[e-i+1];r<e;r+=i){var l=n[r],g=n[r+1];a+=t*l-s*g,s=l,t=g}return a/2}function linearRings(n,r,e,i){for(var a=0,s=0,t=e.length;s<t;++s){var l=e[s];a+=linearRing(n,r,l,i),r=l}return a}function linearRingss(n,r,e,i){for(var a=0,s=0,t=e.length;s<t;++s){var l=e[s];a+=linearRings(n,r,l,i),r=l[l.length-1]}return a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRing=linearRing,exports.linearRings=linearRings,exports.linearRingss=linearRingss;

},{}],214:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingss=linearRingss;var _extent=require("../../extent.js");function linearRingss(e,t,r,n){for(var s=[],a=(0,_extent.createEmpty)(),i=0,o=r.length;i<o;++i){var l=r[i];a=(0,_extent.createOrUpdateFromFlatCoordinates)(e,t,l[0],n),s.push((a[0]+a[2])/2,(a[1]+a[3])/2),t=l[l.length-1]}return s}

},{"../../extent.js":142}],215:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.arrayMaxSquaredDelta=arrayMaxSquaredDelta,exports.assignClosestArrayPoint=assignClosestArrayPoint,exports.assignClosestMultiArrayPoint=assignClosestMultiArrayPoint,exports.assignClosestPoint=assignClosestPoint,exports.maxSquaredDelta=maxSquaredDelta,exports.multiArrayMaxSquaredDelta=multiArrayMaxSquaredDelta;var _math=require("../../math.js");function assignClosest(a,r,t,e,s,n,i){var o,l=a[r],u=a[r+1],f=a[t]-l,g=a[t+1]-u;if(0===f&&0===g)o=r;else{var h=((s-l)*f+(n-u)*g)/(f*f+g*g);if(h>1)o=t;else{if(h>0){for(var v=0;v<e;++v)i[v]=(0,_math.lerp)(a[r+v],a[t+v],h);return void(i.length=e)}o=r}}for(var x=0;x<e;++x)i[x]=a[o+x];i.length=e}function maxSquaredDelta(a,r,t,e,s){var n=a[r],i=a[r+1];for(r+=e;r<t;r+=e){var o=a[r],l=a[r+1],u=(0,_math.squaredDistance)(n,i,o,l);u>s&&(s=u),n=o,i=l}return s}function arrayMaxSquaredDelta(a,r,t,e,s){for(var n=0,i=t.length;n<i;++n){var o=t[n];s=maxSquaredDelta(a,r,o,e,s),r=o}return s}function multiArrayMaxSquaredDelta(a,r,t,e,s){for(var n=0,i=t.length;n<i;++n){var o=t[n];s=arrayMaxSquaredDelta(a,r,o,e,s),r=o[o.length-1]}return s}function assignClosestPoint(a,r,t,e,s,n,i,o,l,u,f){if(r==t)return u;var g,h;if(0===s){if((h=(0,_math.squaredDistance)(i,o,a[r],a[r+1]))<u){for(g=0;g<e;++g)l[g]=a[r+g];return l.length=e,h}return u}f=f||[NaN,NaN];for(var v=r+e;v<t;)if(assignClosest(a,v-e,v,e,i,o,f),(h=(0,_math.squaredDistance)(i,o,f[0],f[1]))<u){for(u=h,g=0;g<e;++g)l[g]=f[g];l.length=e,v+=e}else v+=e*Math.max((Math.sqrt(h)-Math.sqrt(u))/s|0,1);if(n&&(assignClosest(a,t-e,r,e,i,o,f),(h=(0,_math.squaredDistance)(i,o,f[0],f[1]))<u)){for(u=h,g=0;g<e;++g)l[g]=f[g];l.length=e}return u}function assignClosestArrayPoint(a,r,t,e,s,n,i,o,l,u,f){f=f||[NaN,NaN];for(var g=0,h=t.length;g<h;++g){var v=t[g];u=assignClosestPoint(a,r,v,e,s,n,i,o,l,u,f),r=v}return u}function assignClosestMultiArrayPoint(a,r,t,e,s,n,i,o,l,u,f){f=f||[NaN,NaN];for(var g=0,h=t.length;g<h;++g){var v=t[g];u=assignClosestArrayPoint(a,r,v,e,s,n,i,o,l,u,f),r=v[v.length-1]}return u}

},{"../../math.js":279}],216:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingContainsExtent=linearRingContainsExtent,exports.linearRingContainsXY=linearRingContainsXY,exports.linearRingsContainsXY=linearRingsContainsXY,exports.linearRingssContainsXY=linearRingssContainsXY;var _extent=require("../../extent.js");function linearRingContainsExtent(n,i,r,t,e){return!(0,_extent.forEachCorner)(e,function(e){return!linearRingContainsXY(n,i,r,t,e[0],e[1])})}function linearRingContainsXY(n,i,r,t,e,a){for(var s=0,o=n[r-t],l=n[r-t+1];i<r;i+=t){var g=n[i],u=n[i+1];l<=a?u>a&&(g-o)*(a-l)-(e-o)*(u-l)>0&&s++:u<=a&&(g-o)*(a-l)-(e-o)*(u-l)<0&&s--,o=g,l=u}return 0!==s}function linearRingsContainsXY(n,i,r,t,e,a){if(0===r.length)return!1;if(!linearRingContainsXY(n,i,r[0],t,e,a))return!1;for(var s=1,o=r.length;s<o;++s)if(linearRingContainsXY(n,r[s-1],r[s],t,e,a))return!1;return!0}function linearRingssContainsXY(n,i,r,t,e,a){if(0===r.length)return!1;for(var s=0,o=r.length;s<o;++s){var l=r[s];if(linearRingsContainsXY(n,i,l,t,e,a))return!0;i=l[l.length-1]}return!1}

},{"../../extent.js":142}],217:[function(require,module,exports){
"use strict";function deflateCoordinate(e,r,t,o){for(var a=0,n=t.length;a<n;++a)e[r++]=t[a];return r}function deflateCoordinates(e,r,t,o){for(var a=0,n=t.length;a<n;++a)for(var d=t[a],l=0;l<o;++l)e[r++]=d[l];return r}function deflateCoordinatesArray(e,r,t,o,a){a=a||[];for(var n=0,d=0,l=t.length;d<l;++d){var f=deflateCoordinates(e,r,t[d],o);a[n++]=f,r=f}return a.length=n,a}function deflateMultiCoordinatesArray(e,r,t,o,a){a=a||[];for(var n=0,d=0,l=t.length;d<l;++d){var f=deflateCoordinatesArray(e,r,t[d],o,a[n]);0===f.length&&(f[0]=r),a[n++]=f,r=f[f.length-1]}return a.length=n,a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deflateCoordinate=deflateCoordinate,exports.deflateCoordinates=deflateCoordinates,exports.deflateCoordinatesArray=deflateCoordinatesArray,exports.deflateMultiCoordinatesArray=deflateMultiCoordinatesArray;

},{}],218:[function(require,module,exports){
"use strict";function flipXY(e,r,o,t,i,f){void 0!==i?(i=i,f=void 0!==f?f:0):(i=[],f=0);for(var l=r;l<o;){var p=e[l++];i[f++]=e[l++],i[f++]=p;for(var v=2;v<t;++v)i[f++]=e[l++]}return i.length=f,i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.flipXY=flipXY;

},{}],219:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.greatCircleArc=greatCircleArc,exports.meridian=meridian,exports.parallel=parallel;var _proj=require("../../proj.js"),_math=require("../../math.js");function line(t,a,r){for(var e,n,o,i,s,h,p=[],u=t(0),c=t(1),_=a(u),l=a(c),m=[c,u],M=[l,_],g=[1,0],d={},f=1e5;--f>0&&g.length>0;)o=g.pop(),u=m.pop(),_=M.pop(),(h=o.toString())in d||(p.push(_[0],_[1]),d[h]=!0),i=g.pop(),c=m.pop(),l=M.pop(),n=a(e=t(s=(o+i)/2)),(0,_math.squaredSegmentDistance)(n[0],n[1],_[0],_[1],l[0],l[1])<r?(p.push(l[0],l[1]),d[h=i.toString()]=!0):(g.push(i,s,s,o),M.push(l,n,n,_),m.push(c,e,e,u));return p}function greatCircleArc(t,a,r,e,n,o){var i=(0,_proj.get)("EPSG:4326"),s=Math.cos((0,_math.toRadians)(a)),h=Math.sin((0,_math.toRadians)(a)),p=Math.cos((0,_math.toRadians)(e)),u=Math.sin((0,_math.toRadians)(e)),c=Math.cos((0,_math.toRadians)(r-t)),_=Math.sin((0,_math.toRadians)(r-t)),l=h*u+s*p*c;return line(function(a){if(1<=l)return[r,e];var n=a*Math.acos(l),o=Math.cos(n),i=Math.sin(n),m=_*p,M=s*u-h*p*c,g=Math.atan2(m,M),d=Math.asin(h*o+s*i*Math.cos(g)),f=(0,_math.toRadians)(t)+Math.atan2(Math.sin(g)*i*s,o-h*Math.sin(d));return[(0,_math.toDegrees)(f),(0,_math.toDegrees)(d)]},(0,_proj.getTransform)(i,n),o)}function meridian(t,a,r,e,n){var o=(0,_proj.get)("EPSG:4326");return line(function(e){return[t,a+(r-a)*e]},(0,_proj.getTransform)(o,e),n)}function parallel(t,a,r,e,n){var o=(0,_proj.get)("EPSG:4326");return line(function(e){return[a+(r-a)*e,t]},(0,_proj.getTransform)(o,e),n)}

},{"../../math.js":279,"../../proj.js":283}],220:[function(require,module,exports){
"use strict";function inflateCoordinates(r,t,e,n,o){o=void 0!==o?o:[];for(var a=0,i=t;i<e;i+=n)o[a++]=r.slice(i,i+n);return o.length=a,o}function inflateCoordinatesArray(r,t,e,n,o){o=void 0!==o?o:[];for(var a=0,i=0,l=e.length;i<l;++i){var s=e[i];o[a++]=inflateCoordinates(r,t,s,n,o[a]),t=s}return o.length=a,o}function inflateMultiCoordinatesArray(r,t,e,n,o){o=void 0!==o?o:[];for(var a=0,i=0,l=e.length;i<l;++i){var s=e[i];o[a++]=1===s.length&&s[0]===t?[]:inflateCoordinatesArray(r,t,s,n,o[a]),t=s[s.length-1]}return o.length=a,o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateCoordinates=inflateCoordinates,exports.inflateCoordinatesArray=inflateCoordinatesArray,exports.inflateMultiCoordinatesArray=inflateMultiCoordinatesArray;

},{}],221:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getInteriorPointOfArray=getInteriorPointOfArray,exports.getInteriorPointsOfMultiArray=getInteriorPointsOfMultiArray;var _array=require("../../array.js"),_contains=require("./contains.js");function getInteriorPointOfArray(r,t,e,n,a,i,o){for(var s,f,u,g,y,l,c,v=a[i+1],O=[],P=0,h=e.length;P<h;++P){var A=e[P];for(g=r[A-n],l=r[A-n+1],s=t;s<A;s+=n)y=r[s],c=r[s+1],(v<=l&&c<=v||l<=v&&v<=c)&&(u=(v-l)/(c-l)*(y-g)+g,O.push(u)),g=y,l=c}var I=NaN,p=-1/0;for(O.sort(_array.ascending),g=O[0],s=1,f=O.length;s<f;++s){y=O[s];var _=Math.abs(y-g);_>p&&(u=(g+y)/2,(0,_contains.linearRingsContainsXY)(r,t,e,n,u,v)&&(I=u,p=_)),g=y}return isNaN(I)&&(I=a[i]),o?(o.push(I,v,p),o):[I,v,p]}function getInteriorPointsOfMultiArray(r,t,e,n,a){for(var i=[],o=0,s=e.length;o<s;++o){var f=e[o];i=getInteriorPointOfArray(r,t,f,n,a,2*o,i),t=f[f.length-1]}return i}

},{"../../array.js":110,"./contains.js":216}],222:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interpolatePoint=interpolatePoint,exports.lineStringCoordinateAtM=lineStringCoordinateAtM,exports.lineStringsCoordinateAtM=lineStringsCoordinateAtM;var _array=require("../../array.js"),_math=require("../../math.js");function interpolatePoint(r,e,t,n,i,a,l){var o,u,s=(t-e)/n;if(1===s)o=e;else if(2===s)o=e,u=i;else if(0!==s){for(var f=r[e],v=r[e+1],h=0,p=[0],c=e+n;c<t;c+=n){var d=r[c],g=r[c+1];h+=Math.sqrt((d-f)*(d-f)+(g-v)*(g-v)),p.push(h),f=d,v=g}var M=i*h,A=(0,_array.binarySearch)(p,M);A<0?(u=(M-p[-A-2])/(p[-A-1]-p[-A-2]),o=e+(-A-2)*n):o=e+A*n}l=l>1?l:2,a=a||new Array(l);for(var S=0;S<l;++S)a[S]=void 0===o?NaN:void 0===u?r[o+S]:(0,_math.lerp)(r[o+S],r[o+n+S],u);return a}function lineStringCoordinateAtM(r,e,t,n,i,a){if(t==e)return null;var l;if(i<r[e+n-1])return a?((l=r.slice(e,e+n))[n-1]=i,l):null;if(r[t-1]<i)return a?((l=r.slice(t-n,t))[n-1]=i,l):null;if(i==r[e+n-1])return r.slice(e,e+n);for(var o=e/n,u=t/n;o<u;){var s=o+u>>1;i<r[(s+1)*n-1]?u=s:o=s+1}var f=r[o*n-1];if(i==f)return r.slice((o-1)*n,(o-1)*n+n);var v=(i-f)/(r[(o+1)*n-1]-f);l=[];for(var h=0;h<n-1;++h)l.push((0,_math.lerp)(r[(o-1)*n+h],r[o*n+h],v));return l.push(i),l}function lineStringsCoordinateAtM(r,e,t,n,i,a,l){if(l)return lineStringCoordinateAtM(r,e,t[t.length-1],n,i,a);var o;if(i<r[n-1])return a?((o=r.slice(0,n))[n-1]=i,o):null;if(r[r.length-1]<i)return a?((o=r.slice(r.length-n))[n-1]=i,o):null;for(var u=0,s=t.length;u<s;++u){var f=t[u];if(e!=f){if(i<r[e+n-1])return null;if(i<=r[f-1])return lineStringCoordinateAtM(r,e,f,n,i,!1);e=f}}return null}

},{"../../array.js":110,"../../math.js":279}],223:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.intersectsLineString=intersectsLineString,exports.intersectsLineStringArray=intersectsLineStringArray,exports.intersectsLinearRing=intersectsLinearRing,exports.intersectsLinearRingArray=intersectsLinearRingArray,exports.intersectsLinearRingMultiArray=intersectsLinearRingMultiArray;var _extent=require("../../extent.js"),_segments=require("./segments.js"),_contains=require("./contains.js");function intersectsLineString(n,e,t,r,i){var s=(0,_extent.extendFlatCoordinates)((0,_extent.createEmpty)(),n,e,t,r);return!!(0,_extent.intersects)(i,s)&&(!!(0,_extent.containsExtent)(i,s)||(s[0]>=i[0]&&s[2]<=i[2]||(s[1]>=i[1]&&s[3]<=i[3]||(0,_segments.forEach)(n,e,t,r,function(n,e){return(0,_extent.intersectsSegment)(i,n,e)}))))}function intersectsLineStringArray(n,e,t,r,i){for(var s=0,a=t.length;s<a;++s){if(intersectsLineString(n,e,t[s],r,i))return!0;e=t[s]}return!1}function intersectsLinearRing(n,e,t,r,i){return!!intersectsLineString(n,e,t,r,i)||(!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[0],i[1])||(!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[0],i[3])||(!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[2],i[1])||!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[2],i[3]))))}function intersectsLinearRingArray(n,e,t,r,i){if(!intersectsLinearRing(n,e,t[0],r,i))return!1;if(1===t.length)return!0;for(var s=1,a=t.length;s<a;++s)if((0,_contains.linearRingContainsExtent)(n,t[s-1],t[s],r,i)&&!intersectsLineString(n,t[s-1],t[s],r,i))return!1;return!0}function intersectsLinearRingMultiArray(n,e,t,r,i){for(var s=0,a=t.length;s<a;++s){var c=t[s];if(intersectsLinearRingArray(n,e,c,r,i))return!0;e=c[c.length-1]}return!1}

},{"../../extent.js":142,"./contains.js":216,"./segments.js":228}],224:[function(require,module,exports){
"use strict";function lineStringLength(n,e,t,r){for(var i=n[e],g=n[e+1],a=0,h=e+r;h<t;h+=r){var l=n[h],o=n[h+1];a+=Math.sqrt((l-i)*(l-i)+(o-g)*(o-g)),i=l,g=o}return a}function linearRingLength(n,e,t,r){var i=lineStringLength(n,e,t,r),g=n[t-r]-n[e],a=n[t-r+1]-n[e+1];return i+=Math.sqrt(g*g+a*a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineStringLength=lineStringLength,exports.linearRingLength=linearRingLength;

},{}],225:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineChunk=lineChunk;var _math=require("../../math.js");function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=Array(e);t<e;t++)a[t]=r[t];return a}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var a,n,l,o,i=[],u=!0,s=!1;try{if(l=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;u=!1}else for(;!(u=(a=l.call(t)).done)&&(i.push(a.value),i.length!==e);u=!0);}catch(r){s=!0,n=r}finally{try{if(!u&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(s)throw n}}return i}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function lineChunk(r,e,t,a,n){for(var l=[],o=t,i=0,u=e.slice(t,2);i<r&&o+n<a;){var s=_slicedToArray(u.slice(-2),2),y=s[0],c=s[1],f=e[o+n],h=e[o+n+1],p=Math.sqrt((f-y)*(f-y)+(h-c)*(h-c));if((i+=p)>=r){var _=(r-i+p)/p,m=(0,_math.lerp)(y,f,_),b=(0,_math.lerp)(c,h,_);u.push(m,b),l.push(u),u=[m,b],i==r&&(o+=n),i=0}else if(i<r)u.push(e[o+n],e[o+n+1]),o+=n;else{var d=p-i,A=(0,_math.lerp)(y,f,d/p),v=(0,_math.lerp)(c,h,d/p);u.push(A,v),l.push(u),u=[A,v],i=0,o+=n}}return i>0&&l.push(u),l}

},{"../../math.js":279}],226:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateEnds=inflateEnds,exports.linearRingIsClockwise=linearRingIsClockwise,exports.linearRingsAreOriented=linearRingsAreOriented,exports.linearRingssAreOriented=linearRingssAreOriented,exports.orientLinearRings=orientLinearRings,exports.orientLinearRingsArray=orientLinearRingsArray;var _reverse=require("./reverse.js");function linearRingIsClockwise(e,r,n,i){for(var t=0,s=e[n-i],o=e[n-i+1];r<n;r+=i){var a=e[r],l=e[r+1];t+=(a-s)*(l+o),s=a,o=l}return 0===t?void 0:t>0}function linearRingsAreOriented(e,r,n,i,t){t=void 0!==t&&t;for(var s=0,o=n.length;s<o;++s){var a=n[s],l=linearRingIsClockwise(e,r,a,i);if(0===s){if(t&&l||!t&&!l)return!1}else if(t&&!l||!t&&l)return!1;r=a}return!0}function linearRingssAreOriented(e,r,n,i,t){for(var s=0,o=n.length;s<o;++s){var a=n[s];if(!linearRingsAreOriented(e,r,a,i,t))return!1;a.length&&(r=a[a.length-1])}return!0}function orientLinearRings(e,r,n,i,t){t=void 0!==t&&t;for(var s=0,o=n.length;s<o;++s){var a=n[s],l=linearRingIsClockwise(e,r,a,i);(0===s?t&&l||!t&&!l:t&&!l||!t&&l)&&(0,_reverse.coordinates)(e,r,a,i),r=a}return r}function orientLinearRingsArray(e,r,n,i,t){for(var s=0,o=n.length;s<o;++s)r=orientLinearRings(e,r,n[s],i,t);return r}function inflateEnds(e,r){for(var n,i=[],t=0,s=0,o=0,a=r.length;o<a;++o){var l=r[o],g=linearRingIsClockwise(e,t,l,2);if(void 0===n&&(n=g),g===n)i.push(r.slice(s,o+1));else{if(0===i.length)continue;i[i.length-1].push(r[s])}s=o+1,t=l}return i}

},{"./reverse.js":227}],227:[function(require,module,exports){
"use strict";function coordinates(e,o,r,t){for(;o<r-t;){for(var s=0;s<t;++s){var a=e[o+s];e[o+s]=e[r-t+s],e[r-t+s]=a}o+=t,r-=t}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.coordinates=coordinates;

},{}],228:[function(require,module,exports){
"use strict";function forEach(e,r,o,t,c){var f;for(r+=t;r<o;r+=t)if(f=c(e.slice(r-t,r),e.slice(r,r+t)))return f;return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.forEach=forEach;

},{}],229:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.douglasPeucker=douglasPeucker,exports.douglasPeuckerArray=douglasPeuckerArray,exports.douglasPeuckerMultiArray=douglasPeuckerMultiArray,exports.quantize=quantize,exports.quantizeArray=quantizeArray,exports.quantizeMultiArray=quantizeMultiArray,exports.radialDistance=radialDistance,exports.simplifyLineString=simplifyLineString,exports.snap=snap;var _math=require("../../math.js");function simplifyLineString(r,e,a,t,u,n,i){return i=void 0!==i?i:[],n||(a=radialDistance(r,e,a,t,u,i,0),r=i,e=0,t=2),i.length=douglasPeucker(r,e,a,t,u,i,0),i}function douglasPeucker(r,e,a,t,u,n,i){var s=(a-e)/t;if(s<3){for(;e<a;e+=t)n[i++]=r[e],n[i++]=r[e+1];return i}var o=new Array(s);o[0]=1,o[s-1]=1;for(var l=[e,a-t],p=0;l.length>0;){for(var c=l.pop(),f=l.pop(),g=0,d=r[f],v=r[f+1],h=r[c],y=r[c+1],A=f+t;A<c;A+=t){var q=r[A],P=r[A+1],k=(0,_math.squaredSegmentDistance)(q,P,d,v,h,y);k>g&&(p=A,g=k)}g>u&&(o[(p-e)/t]=1,f+t<p&&l.push(f,p),p+t<c&&l.push(p,c))}for(var z=0;z<s;++z)o[z]&&(n[i++]=r[e+z*t],n[i++]=r[e+z*t+1]);return i}function douglasPeuckerArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o];i=douglasPeucker(r,e,p,t,u,n,i),s.push(i),e=p}return i}function douglasPeuckerMultiArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o],c=[];i=douglasPeuckerArray(r,e,p,t,u,n,i,c),s.push(c),e=p[p.length-1]}return i}function radialDistance(r,e,a,t,u,n,i){if(a<=e+t){for(;e<a;e+=t)n[i++]=r[e],n[i++]=r[e+1];return i}var s=r[e],o=r[e+1];n[i++]=s,n[i++]=o;var l=s,p=o;for(e+=t;e<a;e+=t)l=r[e],p=r[e+1],(0,_math.squaredDistance)(s,o,l,p)>u&&(n[i++]=l,n[i++]=p,s=l,o=p);return l==s&&p==o||(n[i++]=l,n[i++]=p),i}function snap(r,e){return e*Math.round(r/e)}function quantize(r,e,a,t,u,n,i){if(e==a)return i;var s,o,l=snap(r[e],u),p=snap(r[e+1],u);e+=t,n[i++]=l,n[i++]=p;do{if(s=snap(r[e],u),o=snap(r[e+1],u),(e+=t)==a)return n[i++]=s,n[i++]=o,i}while(s==l&&o==p);for(;e<a;){var c=snap(r[e],u),f=snap(r[e+1],u);if(e+=t,c!=s||f!=o){var g=s-l,d=o-p,v=c-l,h=f-p;g*h==d*v&&(g<0&&v<g||g==v||g>0&&v>g)&&(d<0&&h<d||d==h||d>0&&h>d)?(s=c,o=f):(n[i++]=s,n[i++]=o,l=s,p=o,s=c,o=f)}}return n[i++]=s,n[i++]=o,i}function quantizeArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o];i=quantize(r,e,p,t,u,n,i),s.push(i),e=p}return i}function quantizeMultiArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o],c=[];i=quantizeArray(r,e,p,t,u,n,i,c),s.push(c),e=p[p.length-1]}return i}

},{"../../math.js":279}],230:[function(require,module,exports){
"use strict";function matchingChunk(t,e,r,n,a){var o,h,i,u,c,s,v,d,f,g=r,k=r,m=0,p=0,C=r;for(o=r;o<n;o+=a){var M=e[o],l=e[o+1];void 0!==u&&(d=M-u,f=l-c,i=Math.sqrt(d*d+f*f),void 0!==s&&(p+=h,Math.acos((s*d+v*f)/(h*i))>t&&(p>m&&(m=p,g=C,k=o),p=0,C=o-a)),h=i,s=d,v=f),u=M,c=l}return(p+=i)>m?[C,o]:[g,k]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.matchingChunk=matchingChunk;

},{}],231:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawTextOnPath=drawTextOnPath;var _math=require("../../math.js"),_transform=require("./transform.js");function drawTextOnPath(r,a,t,e,n,h,s,i,v,f,o,l){var u=r[a],m=r[a+1],p=0,_=0,d=0,M=0;function b(){p=u,_=m,u=r[a+=e],m=r[a+1],M+=d,d=Math.sqrt((u-p)*(u-p)+(m-_)*(m-_))}do{b()}while(a<t-e&&M+d<h);for(var c=0===d?0:(h-M)/d,x=(0,_math.lerp)(p,u,c),P=(0,_math.lerp)(_,m,c),g=a-e,w=M,O=h+i*v(f,n,o);a<t-e&&M+d<O;)b();c=0===d?0:(O-M)/d;var j,q=(0,_math.lerp)(p,u,c),T=(0,_math.lerp)(_,m,c);if(l){var k=[x,P,q,T];(0,_transform.rotate)(k,0,4,2,l,k,k),j=k[0]>k[2]}else j=x>q;var y,I=Math.PI,z=[],A=g+e===a;if(d=0,M=w,u=r[a=g],m=r[a+1],A){b(),y=Math.atan2(m-_,u-p),j&&(y+=y>0?-I:I);var B=(q+x)/2,C=(T+P)/2;return z[0]=[B,C,(O-h)/2,y,n],z}for(var D=0,E=(n=n.replace(/\n/g," ")).length;D<E;){b();var F=Math.atan2(m-_,u-p);if(j&&(F+=F>0?-I:I),void 0!==y){var G=F-y;if(G+=G>I?-2*I:G<-I?2*I:0,Math.abs(G)>s)return null}y=F;for(var H=D,J=0;D<E;++D){var K=i*v(f,n[j?E-D-1:D],o);if(a+e<t&&M+d<h+J+K/2)break;J+=K}if(D!==H){var L=j?n.substring(E-H,E-D):n.substring(H,D);c=0===d?0:(h+J/2-M)/d;var N=(0,_math.lerp)(p,u,c),Q=(0,_math.lerp)(_,m,c);z.push([N,Q,J/2,F,L]),h+=J}}return z}

},{"../../math.js":279,"./transform.js":232}],232:[function(require,module,exports){
"use strict";function transform2D(r,t,e,a,n,o){o=o||[];for(var s=0,l=t;l<e;l+=a){var f=r[l],u=r[l+1];o[s++]=n[0]*f+n[2]*u+n[4],o[s++]=n[1]*f+n[3]*u+n[5]}return o&&o.length!=s&&(o.length=s),o}function rotate(r,t,e,a,n,o,s){s=s||[];for(var l=Math.cos(n),f=Math.sin(n),u=o[0],v=o[1],c=0,h=t;h<e;h+=a){var g=r[h]-u,i=r[h+1]-v;s[c++]=u+g*l-i*f,s[c++]=v+g*f+i*l;for(var p=h+2;p<h+a;++p)s[c++]=r[p]}return s&&s.length!=c&&(s.length=c),s}function scale(r,t,e,a,n,o,s,l){l=l||[];for(var f=s[0],u=s[1],v=0,c=t;c<e;c+=a){var h=r[c]-f,g=r[c+1]-u;l[v++]=f+n*h,l[v++]=u+o*g;for(var i=c+2;i<c+a;++i)l[v++]=r[i]}return l&&l.length!=v&&(l.length=v),l}function translate(r,t,e,a,n,o,s){s=s||[];for(var l=0,f=t;f<e;f+=a){s[l++]=r[f]+n,s[l++]=r[f+1]+o;for(var u=f+2;u<f+a;++u)s[l++]=r[u]}return s&&s.length!=l&&(s.length=l),s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.rotate=rotate,exports.scale=scale,exports.transform2D=transform2D,exports.translate=translate;

},{}],233:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WORKER_OFFSCREEN_CANVAS=exports.WEBKIT=exports.SAFARI_BUG_237906=exports.SAFARI=exports.PASSIVE_EVENT_LISTENERS=exports.MAC=exports.IMAGE_DECODE=exports.FIREFOX=exports.DEVICE_PIXEL_RATIO=exports.CREATE_IMAGE_BITMAP=void 0;var ua="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",FIREFOX=exports.FIREFOX=ua.includes("firefox"),SAFARI=exports.SAFARI=ua.includes("safari")&&!ua.includes("chrom"),SAFARI_BUG_237906=exports.SAFARI_BUG_237906=SAFARI&&(ua.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ua)),WEBKIT=exports.WEBKIT=ua.includes("webkit")&&!ua.includes("edge"),MAC=exports.MAC=ua.includes("macintosh"),DEVICE_PIXEL_RATIO=exports.DEVICE_PIXEL_RATIO="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,WORKER_OFFSCREEN_CANVAS=exports.WORKER_OFFSCREEN_CANVAS="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,IMAGE_DECODE=exports.IMAGE_DECODE="undefined"!=typeof Image&&Image.prototype.decode,CREATE_IMAGE_BITMAP=exports.CREATE_IMAGE_BITMAP="function"==typeof createImageBitmap,PASSIVE_EVENT_LISTENERS=exports.PASSIVE_EVENT_LISTENERS=function(){var e=!1;try{var o=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,o),window.removeEventListener("_",null,o)}catch(e){}return e}();

},{}],234:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Collection",{enumerable:!0,get:function(){return _Collection.default}}),Object.defineProperty(exports,"Disposable",{enumerable:!0,get:function(){return _Disposable.default}}),Object.defineProperty(exports,"Feature",{enumerable:!0,get:function(){return _Feature.default}}),Object.defineProperty(exports,"Geolocation",{enumerable:!0,get:function(){return _Geolocation.default}}),Object.defineProperty(exports,"Graticule",{enumerable:!0,get:function(){return _Graticule.default}}),Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return _Image.default}}),Object.defineProperty(exports,"ImageCanvas",{enumerable:!0,get:function(){return _ImageCanvas.default}}),Object.defineProperty(exports,"ImageTile",{enumerable:!0,get:function(){return _ImageTile.default}}),Object.defineProperty(exports,"ImageWrapper",{enumerable:!0,get:function(){return _Image.default}}),Object.defineProperty(exports,"Kinetic",{enumerable:!0,get:function(){return _Kinetic.default}}),Object.defineProperty(exports,"Map",{enumerable:!0,get:function(){return _Map.default}}),Object.defineProperty(exports,"MapBrowserEvent",{enumerable:!0,get:function(){return _MapBrowserEvent.default}}),Object.defineProperty(exports,"MapBrowserEventHandler",{enumerable:!0,get:function(){return _MapBrowserEventHandler.default}}),Object.defineProperty(exports,"MapEvent",{enumerable:!0,get:function(){return _MapEvent.default}}),Object.defineProperty(exports,"Object",{enumerable:!0,get:function(){return _Object.default}}),Object.defineProperty(exports,"Observable",{enumerable:!0,get:function(){return _Observable.default}}),Object.defineProperty(exports,"Overlay",{enumerable:!0,get:function(){return _Overlay.default}}),Object.defineProperty(exports,"Tile",{enumerable:!0,get:function(){return _Tile.default}}),Object.defineProperty(exports,"TileCache",{enumerable:!0,get:function(){return _TileCache.default}}),Object.defineProperty(exports,"TileQueue",{enumerable:!0,get:function(){return _TileQueue.default}}),Object.defineProperty(exports,"TileRange",{enumerable:!0,get:function(){return _TileRange.default}}),Object.defineProperty(exports,"VERSION",{enumerable:!0,get:function(){return _util.VERSION}}),Object.defineProperty(exports,"VectorRenderTile",{enumerable:!0,get:function(){return _VectorRenderTile.default}}),Object.defineProperty(exports,"VectorTile",{enumerable:!0,get:function(){return _VectorTile.default}}),Object.defineProperty(exports,"View",{enumerable:!0,get:function(){return _View.default}}),Object.defineProperty(exports,"getUid",{enumerable:!0,get:function(){return _util.getUid}});var _Collection=_interopRequireDefault(require("./Collection.js")),_Disposable=_interopRequireDefault(require("./Disposable.js")),_Feature=_interopRequireDefault(require("./Feature.js")),_Geolocation=_interopRequireDefault(require("./Geolocation.js")),_Graticule=_interopRequireDefault(require("./layer/Graticule.js")),_Image=_interopRequireDefault(require("./Image.js")),_ImageCanvas=_interopRequireDefault(require("./ImageCanvas.js")),_ImageTile=_interopRequireDefault(require("./ImageTile.js")),_Kinetic=_interopRequireDefault(require("./Kinetic.js")),_Map=_interopRequireDefault(require("./Map.js")),_MapBrowserEvent=_interopRequireDefault(require("./MapBrowserEvent.js")),_MapBrowserEventHandler=_interopRequireDefault(require("./MapBrowserEventHandler.js")),_MapEvent=_interopRequireDefault(require("./MapEvent.js")),_Object=_interopRequireDefault(require("./Object.js")),_Observable=_interopRequireDefault(require("./Observable.js")),_Overlay=_interopRequireDefault(require("./Overlay.js")),_Tile=_interopRequireDefault(require("./Tile.js")),_TileCache=_interopRequireDefault(require("./TileCache.js")),_TileQueue=_interopRequireDefault(require("./TileQueue.js")),_TileRange=_interopRequireDefault(require("./TileRange.js")),_VectorRenderTile=_interopRequireDefault(require("./VectorRenderTile.js")),_VectorTile=_interopRequireDefault(require("./VectorTile.js")),_View=_interopRequireDefault(require("./View.js")),_util=require("./util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./Collection.js":78,"./Disposable.js":81,"./Feature.js":82,"./Geolocation.js":83,"./Image.js":84,"./ImageCanvas.js":85,"./ImageTile.js":87,"./Kinetic.js":88,"./Map.js":89,"./MapBrowserEvent.js":90,"./MapBrowserEventHandler.js":91,"./MapEvent.js":93,"./Object.js":96,"./Observable.js":98,"./Overlay.js":99,"./Tile.js":100,"./TileCache.js":101,"./TileQueue.js":102,"./TileRange.js":103,"./VectorRenderTile.js":105,"./VectorTile.js":106,"./View.js":107,"./layer/Graticule.js":265,"./util.js":404}],235:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"DblClickDragZoom",{enumerable:!0,get:function(){return _DblClickDragZoom.default}}),Object.defineProperty(exports,"DoubleClickZoom",{enumerable:!0,get:function(){return _DoubleClickZoom.default}}),Object.defineProperty(exports,"DragAndDrop",{enumerable:!0,get:function(){return _DragAndDrop.default}}),Object.defineProperty(exports,"DragBox",{enumerable:!0,get:function(){return _DragBox.default}}),Object.defineProperty(exports,"DragPan",{enumerable:!0,get:function(){return _DragPan.default}}),Object.defineProperty(exports,"DragRotate",{enumerable:!0,get:function(){return _DragRotate.default}}),Object.defineProperty(exports,"DragRotateAndZoom",{enumerable:!0,get:function(){return _DragRotateAndZoom.default}}),Object.defineProperty(exports,"DragZoom",{enumerable:!0,get:function(){return _DragZoom.default}}),Object.defineProperty(exports,"Draw",{enumerable:!0,get:function(){return _Draw.default}}),Object.defineProperty(exports,"Extent",{enumerable:!0,get:function(){return _Extent.default}}),Object.defineProperty(exports,"Interaction",{enumerable:!0,get:function(){return _Interaction.default}}),Object.defineProperty(exports,"KeyboardPan",{enumerable:!0,get:function(){return _KeyboardPan.default}}),Object.defineProperty(exports,"KeyboardZoom",{enumerable:!0,get:function(){return _KeyboardZoom.default}}),Object.defineProperty(exports,"Link",{enumerable:!0,get:function(){return _Link.default}}),Object.defineProperty(exports,"Modify",{enumerable:!0,get:function(){return _Modify.default}}),Object.defineProperty(exports,"MouseWheelZoom",{enumerable:!0,get:function(){return _MouseWheelZoom.default}}),Object.defineProperty(exports,"PinchRotate",{enumerable:!0,get:function(){return _PinchRotate.default}}),Object.defineProperty(exports,"PinchZoom",{enumerable:!0,get:function(){return _PinchZoom.default}}),Object.defineProperty(exports,"Pointer",{enumerable:!0,get:function(){return _Pointer.default}}),Object.defineProperty(exports,"Select",{enumerable:!0,get:function(){return _Select.default}}),Object.defineProperty(exports,"Snap",{enumerable:!0,get:function(){return _Snap.default}}),Object.defineProperty(exports,"Translate",{enumerable:!0,get:function(){return _Translate.default}}),Object.defineProperty(exports,"defaults",{enumerable:!0,get:function(){return _defaults.defaults}});var _DoubleClickZoom=_interopRequireDefault(require("./interaction/DoubleClickZoom.js")),_DblClickDragZoom=_interopRequireDefault(require("./interaction/DblClickDragZoom.js")),_DragAndDrop=_interopRequireDefault(require("./interaction/DragAndDrop.js")),_DragBox=_interopRequireDefault(require("./interaction/DragBox.js")),_DragPan=_interopRequireDefault(require("./interaction/DragPan.js")),_DragRotate=_interopRequireDefault(require("./interaction/DragRotate.js")),_DragRotateAndZoom=_interopRequireDefault(require("./interaction/DragRotateAndZoom.js")),_DragZoom=_interopRequireDefault(require("./interaction/DragZoom.js")),_Draw=_interopRequireDefault(require("./interaction/Draw.js")),_Extent=_interopRequireDefault(require("./interaction/Extent.js")),_Interaction=_interopRequireDefault(require("./interaction/Interaction.js")),_KeyboardPan=_interopRequireDefault(require("./interaction/KeyboardPan.js")),_KeyboardZoom=_interopRequireDefault(require("./interaction/KeyboardZoom.js")),_Link=_interopRequireDefault(require("./interaction/Link.js")),_Modify=_interopRequireDefault(require("./interaction/Modify.js")),_MouseWheelZoom=_interopRequireDefault(require("./interaction/MouseWheelZoom.js")),_PinchRotate=_interopRequireDefault(require("./interaction/PinchRotate.js")),_PinchZoom=_interopRequireDefault(require("./interaction/PinchZoom.js")),_Pointer=_interopRequireDefault(require("./interaction/Pointer.js")),_Select=_interopRequireDefault(require("./interaction/Select.js")),_Snap=_interopRequireDefault(require("./interaction/Snap.js")),_Translate=_interopRequireDefault(require("./interaction/Translate.js")),_defaults=require("./interaction/defaults.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./interaction/DblClickDragZoom.js":236,"./interaction/DoubleClickZoom.js":237,"./interaction/DragAndDrop.js":238,"./interaction/DragBox.js":239,"./interaction/DragPan.js":240,"./interaction/DragRotate.js":241,"./interaction/DragRotateAndZoom.js":242,"./interaction/DragZoom.js":243,"./interaction/Draw.js":244,"./interaction/Extent.js":245,"./interaction/Interaction.js":246,"./interaction/KeyboardPan.js":247,"./interaction/KeyboardZoom.js":248,"./interaction/Link.js":249,"./interaction/Modify.js":250,"./interaction/MouseWheelZoom.js":251,"./interaction/PinchRotate.js":252,"./interaction/PinchZoom.js":253,"./interaction/Pointer.js":254,"./interaction/Select.js":256,"./interaction/Snap.js":257,"./interaction/Translate.js":258,"./interaction/defaults.js":259}],236:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Interaction2=_interopRequireDefault(require("./Interaction.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DblClickDragZoom=function(e){function t(e){var n;_classCallCheck(this,t);var r=e||{};return n=_callSuper(this,t,[r]),r.stopDown&&(n.stopDown=r.stopDown),n.scaleDeltaByPixel_=r.delta?r.delta:.01,n.duration_=void 0!==r.duration?r.duration:250,n.handlingDownUpSequence_=!1,n.handlingDoubleDownSequence_=!1,n.doubleTapTimeoutId_=void 0,n.trackedPointers_={},n.targetPointers=[],n}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){if(!e.originalEvent)return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence_){if(e.type==_MapBrowserEventType.default.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==_MapBrowserEventType.default.POINTERUP){var n=this.handleUpEvent(e);this.handlingDownUpSequence_=n}}else if(e.type==_MapBrowserEventType.default.POINTERDOWN)if(this.handlingDoubleDownSequence_){this.handlingDoubleDownSequence_=!1;var r=this.handleDownEvent(e);this.handlingDownUpSequence_=r,t=this.stopDown(r)}else t=this.stopDown(!1),this.waitForDblTap_();return!t}},{key:"handleDragEvent",value:function(e){var t=1,n=this.targetPointers[0],r=this.down_.originalEvent,o=n.clientY-r.clientY;void 0!==this.lastDistance_&&(t=1-(this.lastDistance_-o)*this.scaleDeltaByPixel_),this.lastDistance_=o,1!=t&&(this.lastScaleDelta_=t);var i=e.map,a=i.getView();i.render(),a.adjustResolutionInternal(t)}},{key:"handleDownEvent",value:function(e){if(1==this.targetPointers.length){var t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.down_=e,this.handlingDownUpSequence_||t.getView().beginInteraction(),!0}return!1}},{key:"handleUpEvent",value:function(e){if(0==this.targetPointers.length){var t=e.map.getView(),n=this.lastScaleDelta_>1?1:-1;return t.endInteraction(this.duration_,n),this.handlingDownUpSequence_=!1,this.handlingDoubleDownSequence_=!1,!1}return!0}},{key:"stopDown",value:function(e){return e}},{key:"updateTrackedPointers_",value:function(e){if(isPointerDraggingEvent(e)){var t=e.originalEvent,n=t.pointerId.toString();e.type==_MapBrowserEventType.default.POINTERUP?delete this.trackedPointers_[n]:e.type==_MapBrowserEventType.default.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=Object.values(this.trackedPointers_)}}},{key:"waitForDblTap_",value:function(){void 0!==this.doubleTapTimeoutId_?(clearTimeout(this.doubleTapTimeoutId_),this.doubleTapTimeoutId_=void 0):(this.handlingDoubleDownSequence_=!0,this.doubleTapTimeoutId_=setTimeout(this.endInteraction_.bind(this),250))}},{key:"endInteraction_",value:function(){this.handlingDoubleDownSequence_=!1,this.doubleTapTimeoutId_=void 0}}])}();function isPointerDraggingEvent(e){var t=e.type;return t===_MapBrowserEventType.default.POINTERDOWN||t===_MapBrowserEventType.default.POINTERDRAG||t===_MapBrowserEventType.default.POINTERUP}var _default=exports.default=DblClickDragZoom;

},{"../MapBrowserEventType.js":92,"./Interaction.js":246}],237:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Interaction2=_interopRequireWildcard(require("./Interaction.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DoubleClickZoom=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).delta_=e.delta?e.delta:1,r.duration_=void 0!==e.duration?e.duration:250,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){var t=!1;if(e.type==_MapBrowserEventType.default.DBLCLICK){var r=e.originalEvent,o=e.map,n=e.coordinate,i=r.shiftKey?-this.delta_:this.delta_,u=o.getView();(0,_Interaction2.zoomByDelta)(u,i,n,this.duration_),r.preventDefault(),t=!0}return!t}}])}(),_default=exports.default=DoubleClickZoom;

},{"../MapBrowserEventType.js":92,"./Interaction.js":246}],238:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DragAndDropEvent=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireDefault(require("./Interaction.js")),_functions=require("../functions.js"),_proj=require("../proj.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DragAndDropEventType={ADD_FEATURES:"addfeatures"},DragAndDropEvent=exports.DragAndDropEvent=function(e){function t(e,r,n,o){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).features=n,i.file=r,i.projection=o,i}return _inherits(t,_Event2["default"]),_createClass(t)}(),DragAndDrop=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t,[{handleEvent:_functions.TRUE}])).on,r.once,r.un,r.readAsBuffer_=!1,r.formats_=[];for(var n=e.formatConstructors?e.formatConstructors:[],o=0,i=n.length;o<i;++o){var s=n[o];"function"==typeof s&&(s=new s),r.formats_.push(s),r.readAsBuffer_=r.readAsBuffer_||"arraybuffer"===s.getType()}return r.projection_=e.projection?(0,_proj.get)(e.projection):null,r.dropListenKeys_=null,r.source_=e.source||null,r.target=e.target?e.target:null,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleResult_",value:function(e,t){var r,n=t.target.result,o=this.getMap(),i=this.projection_;i||((i=(0,_proj.getUserProjection)())||(i=o.getView().getProjection()));for(var s=this.formats_,u=0,a=s.length;u<a;++u){var f=s[u],l=n;this.readAsBuffer_&&"arraybuffer"!==f.getType()&&(void 0===r&&(r=(new TextDecoder).decode(n)),l=r);var c=this.tryReadFeatures_(f,l,{featureProjection:i});if(c&&c.length>0){this.source_&&(this.source_.clear(),this.source_.addFeatures(c)),this.dispatchEvent(new DragAndDropEvent(DragAndDropEventType.ADD_FEATURES,e,c,i));break}}}},{key:"registerListeners_",value:function(){var e=this.getMap();if(e){var t=this.target?this.target:e.getViewport();this.dropListenKeys_=[(0,_events.listen)(t,_EventType.default.DROP,this.handleDrop,this),(0,_events.listen)(t,_EventType.default.DRAGENTER,this.handleStop,this),(0,_events.listen)(t,_EventType.default.DRAGOVER,this.handleStop,this),(0,_events.listen)(t,_EventType.default.DROP,this.handleStop,this)]}}},{key:"setActive",value:function(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),_get(_getPrototypeOf(t.prototype),"setActive",this).call(this,e)}},{key:"setMap",value:function(e){this.unregisterListeners_(),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),this.getActive()&&this.registerListeners_()}},{key:"tryReadFeatures_",value:function(e,t,r){try{return e.readFeatures(t,r)}catch(e){return null}}},{key:"unregisterListeners_",value:function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(_events.unlistenByKey),this.dropListenKeys_=null)}},{key:"handleDrop",value:function(e){for(var t=e.dataTransfer.files,r=0,n=t.length;r<n;++r){var o=t.item(r),i=new FileReader;i.addEventListener(_EventType.default.LOAD,this.handleResult_.bind(this,o)),this.readAsBuffer_?i.readAsArrayBuffer(o):i.readAsText(o)}}},{key:"handleStop",value:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}])}(),_default=exports.default=DragAndDrop;

},{"../events.js":132,"../events/Event.js":133,"../events/EventType.js":134,"../functions.js":200,"../proj.js":283,"./Interaction.js":246}],239:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DragBoxEvent=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_Box=_interopRequireDefault(require("../render/Box.js")),_condition=require("../events/condition.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=_superPropBase(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:o):r.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragBoxEventType={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},DragBoxEvent=exports.DragBoxEvent=function(t){function e(t,o,n){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,[t])).coordinate=o,r.mapBrowserEvent=n,r}return _inherits(e,_Event2["default"]),_createClass(e)}(),DragBox=function(t){function e(t){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).on,o.once,o.un,t=t||{},o.box_=new _Box.default(t.className||"ol-dragbox"),o.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(o.onBoxEnd=t.onBoxEnd),o.startPixel_=null,o.condition_=t.condition?t.condition:_condition.mouseActionButton,o.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:o.defaultBoxEndCondition,o}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"defaultBoxEndCondition",value:function(t,e,o){var n=o[0]-e[0],r=o[1]-e[1];return n*n+r*r>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,t.coordinate,t)))}},{key:"handleUpEvent",value:function(t){if(!this.startPixel_)return!1;this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new DragBoxEvent(e?DragBoxEventType.BOXEND:DragBoxEventType.BOXCANCEL,t.coordinate,t)),!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,t.coordinate,t)),!0)}},{key:"onBoxEnd",value:function(t){}},{key:"setActive",value:function(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),_get(_getPrototypeOf(e.prototype),"setActive",this).call(this,t)}}])}(),_default=exports.default=DragBox;

},{"../events/Event.js":133,"../events/condition.js":138,"../render/Box.js":292,"./Pointer.js":254}],240:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireWildcard(require("./Pointer.js")),_functions=require("../functions.js"),_condition=require("../events/condition.js"),_easing=require("../easing.js"),_coordinate=require("../coordinate.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(e);if(n&&n.has(t))return n.get(t);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var a=r?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=t[o]}return i.default=t,n&&n.set(t,i),i}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,n){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,n||[],_getPrototypeOf(t).constructor):e.apply(t,n))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragPan=function(t){function e(t){var n;_classCallCheck(this,e),t=t||{},(n=_callSuper(this,e,[{stopDown:_functions.FALSE}])).kinetic_=t.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var i=t.condition?t.condition:(0,_condition.all)(_condition.noModifierKeys,_condition.primaryAction);return n.condition_=t.onFocusOnly?(0,_condition.all)(_condition.focusWithTabindex,i):i,n.noKinetic_=!1,n}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){var e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());var n=this.targetPointers,i=e.getEventPixel((0,_Pointer.centroid)(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var r=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=t.map.getView();(0,_coordinate.scale)(r,o.getResolution()),(0,_coordinate.rotate)(r,o.getRotation()),o.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),c=e.getCoordinateFromPixelInternal([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(c),duration:500,easing:_easing.easeOut})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}])}(),_default=exports.default=DragPan;

},{"../coordinate.js":128,"../easing.js":131,"../events/condition.js":138,"../functions.js":200,"./Pointer.js":254}],241:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireDefault(require("./Pointer.js")),_functions=require("../functions.js"),_condition=require("../events/condition.js"),_rotationconstraint=require("../rotationconstraint.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragRotate=function(t){function e(t){var o;return _classCallCheck(this,e),t=t||{},(o=_callSuper(this,e,[{stopDown:_functions.FALSE}])).condition_=t.condition?t.condition:_condition.altShiftKeysOnly,o.lastAngle_=void 0,o.duration_=void 0!==t.duration?t.duration:250,o}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){if((0,_condition.mouseOnly)(t)){var e=t.map,o=e.getView();if(o.getConstraints().rotation!==_rotationconstraint.disable){var n=e.getSize(),r=t.pixel,i=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var u=i-this.lastAngle_;o.adjustRotationInternal(-u)}this.lastAngle_=i}}}},{key:"handleUpEvent",value:function(t){return!(0,_condition.mouseOnly)(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!!(0,_condition.mouseOnly)(t)&&(!(!(0,_condition.mouseActionButton)(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}}])}(),_default=exports.default=DragRotate;

},{"../events/condition.js":138,"../functions.js":200,"../rotationconstraint.js":336,"./Pointer.js":254}],242:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireDefault(require("./Pointer.js")),_condition=require("../events/condition.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragRotateAndZoom=function(t){function e(t){var o;return _classCallCheck(this,e),(o=_callSuper(this,e,[t=t||{}])).condition_=t.condition?t.condition:_condition.shiftKeyOnly,o.lastAngle_=void 0,o.lastMagnitude_=void 0,o.lastScaleDelta_=0,o.duration_=void 0!==t.duration?t.duration:400,o}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){if((0,_condition.mouseOnly)(t)){var e=t.map,o=e.getSize(),n=t.pixel,r=n[0]-o[0]/2,i=o[1]/2-n[1],a=Math.atan2(i,r),u=Math.sqrt(r*r+i*i),l=e.getView();if(void 0!==this.lastAngle_){var s=this.lastAngle_-a;l.adjustRotationInternal(s)}this.lastAngle_=a,void 0!==this.lastMagnitude_&&l.adjustResolutionInternal(this.lastMagnitude_/u),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/u),this.lastMagnitude_=u}}},{key:"handleUpEvent",value:function(t){if(!(0,_condition.mouseOnly)(t))return!0;var e=t.map.getView(),o=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,o),this.lastScaleDelta_=0,!1}},{key:"handleDownEvent",value:function(t){return!!(0,_condition.mouseOnly)(t)&&(!!this.condition_(t)&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))}}])}(),_default=exports.default=DragRotateAndZoom;

},{"../events/condition.js":138,"./Pointer.js":254}],243:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _DragBox2=_interopRequireDefault(require("./DragBox.js")),_easing=require("../easing.js"),_condition=require("../events/condition.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragZoom=function(t){function e(t){var o;return _classCallCheck(this,e),(o=_callSuper(this,e,[{condition:(t=t||{}).condition?t.condition:_condition.shiftKeyOnly,className:t.className||"ol-dragzoom",minArea:t.minArea}])).duration_=void 0!==t.duration?t.duration:200,o.out_=void 0!==t.out&&t.out,o}return _inherits(e,_DragBox2["default"]),_createClass(e,[{key:"onBoxEnd",value:function(t){var e=this.getMap().getView(),o=this.getGeometry();if(this.out_){var r=e.rotatedExtentForGeometry(o),n=e.getResolutionForExtentInternal(r),i=e.getResolution()/n;(o=o.clone()).scale(i*i)}e.fitInternal(o,{duration:this.duration_,easing:_easing.easeOut})}}])}(),_default=exports.default=DragZoom;

},{"../easing.js":131,"../events/condition.js":138,"./DragBox.js":239}],244:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawEvent=void 0,exports.createBox=createBox,exports.createRegularPolygon=createRegularPolygon,exports.default=void 0;var _Circle=_interopRequireDefault(require("../geom/Circle.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_GeometryCollection=_interopRequireDefault(require("../geom/GeometryCollection.js")),_Property=_interopRequireDefault(require("./Property.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_MapBrowserEvent=_interopRequireDefault(require("../MapBrowserEvent.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js")),_MultiLineString=_interopRequireDefault(require("../geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("../geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("../geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_Polygon=_interopRequireWildcard(require("../geom/Polygon.js")),_Vector=_interopRequireDefault(require("../layer/Vector.js")),_Vector2=_interopRequireDefault(require("../source/Vector.js")),_functions=require("../functions.js"),_condition=require("../events/condition.js"),_extent=require("../extent.js"),_math=require("../math.js"),_Style=require("../style/Style.js"),_coordinate=require("../coordinate.js"),_proj=require("../proj.js"),_SimpleGeometry=require("../geom/SimpleGeometry.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DrawEventType={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"},DrawEvent=exports.DrawEvent=function(e){function t(e,r){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).feature=r,i}return _inherits(t,_Event2["default"]),_createClass(t)}();function getTraceTargets(e,t){for(var r=[],i=0;i<t.length;++i){appendGeometryTraceTargets(e,t[i].getGeometry(),r)}return r}function getSquaredDistance(e,t){return(0,_math.squaredDistance)(e[0],e[1],t[0],t[1])}function getCoordinate(e,t){var r=e.length;return t<0?e[t+r]:t>=r?e[t-r]:e[t]}function getCumulativeSquaredDistance(e,t,r){var i,n;t<r?(i=t,n=r):(i=r,n=t);var o=Math.ceil(i),a=Math.floor(n);if(o>a)return getSquaredDistance(interpolateCoordinate(e,i),interpolateCoordinate(e,n));var s=0;i<o&&(s+=getSquaredDistance(interpolateCoordinate(e,i),getCoordinate(e,o)));a<n&&(s+=getSquaredDistance(getCoordinate(e,a),interpolateCoordinate(e,n)));for(var h=o;h<a-1;++h){s+=getSquaredDistance(getCoordinate(e,h),getCoordinate(e,h+1))}return s}function appendGeometryTraceTargets(e,t,r){if(t instanceof _LineString.default)appendTraceTarget(e,t.getCoordinates(),!1,r);else if(t instanceof _MultiLineString.default)for(var i=t.getCoordinates(),n=0,o=i.length;n<o;++n)appendTraceTarget(e,i[n],!1,r);else if(t instanceof _Polygon.default)for(var a=t.getCoordinates(),s=0,h=a.length;s<h;++s)appendTraceTarget(e,a[s],!0,r);else if(t instanceof _MultiPolygon.default)for(var u=t.getCoordinates(),l=0,d=u.length;l<d;++l)for(var c=u[l],_=0,f=c.length;_<f;++_)appendTraceTarget(e,c[_],!0,r);else if(t instanceof _GeometryCollection.default)for(var g=t.getGeometries(),p=0;p<g.length;++p)appendGeometryTraceTargets(e,g[p],r);else;}var sharedUpdateInfo={index:-1,endIndex:NaN};function getTraceTargetUpdate(e,t,r,i){for(var n=e[0],o=e[1],a=1/0,s=-1,h=NaN,u=0;u<t.targets.length;++u){for(var l=t.targets[u],d=l.coordinates,c=1/0,_=void 0,f=0;f<d.length-1;++f){var g=getPointSegmentRelationship(n,o,d[f],d[f+1]);g.squaredDistance<c&&(c=g.squaredDistance,_=f+g.along)}c<a&&(a=c,l.ring&&t.targetIndex===u&&(l.endIndex>l.startIndex?_<l.startIndex&&(_+=d.length):l.endIndex<l.startIndex&&_>l.startIndex&&(_-=d.length)),h=_,s=u)}var p=t.targets[s],y=p.ring;if(t.targetIndex===s&&y){var v=interpolateCoordinate(p.coordinates,h),m=r.getPixelFromCoordinate(v);(0,_coordinate.distance)(m,t.startPx)>i&&(y=!1)}if(y){var C=p.coordinates,P=C.length,k=p.startIndex,T=h;if(k<T){var w=getCumulativeSquaredDistance(C,k,T);getCumulativeSquaredDistance(C,k,T-P)<w&&(h-=P)}else{var D=getCumulativeSquaredDistance(C,k,T);getCumulativeSquaredDistance(C,k,T+P)<D&&(h+=P)}}return sharedUpdateInfo.index=s,sharedUpdateInfo.endIndex=h,sharedUpdateInfo}function appendTraceTarget(e,t,r,i){for(var n=e[0],o=e[1],a=0,s=t.length-1;a<s;++a){var h=getPointSegmentRelationship(n,o,t[a],t[a+1]);if(0===h.squaredDistance){var u=a+h.along;return void i.push({coordinates:t,ring:r,startIndex:u,endIndex:u})}}}var sharedRel={along:0,squaredDistance:0};function getPointSegmentRelationship(e,t,r,i){var n=r[0],o=r[1],a=i[0]-n,s=i[1]-o,h=0,u=n,l=o;return 0===a&&0===s||(u+=a*(h=(0,_math.clamp)(((e-n)*a+(t-o)*s)/(a*a+s*s),0,1)),l+=s*h),sharedRel.along=h,sharedRel.squaredDistance=(0,_math.toFixed)((0,_math.squaredDistance)(e,t,u,l),10),sharedRel}function interpolateCoordinate(e,t){var r=e.length,i=Math.floor(t),n=t-i;i>=r?i-=r:i<0&&(i+=r);var o=i+1;o>=r&&(o-=r);var a=e[i],s=a[0],h=a[1],u=e[o];return[s+(u[0]-s)*n,h+(u[1]-h)*n]}var Draw=function(e){function t(e){var r;_classCallCheck(this,t);var i=e;i.stopDown||(i.stopDown=_functions.FALSE),(r=_callSuper(this,t,[i])).on,r.once,r.un,r.shouldHandle_=!1,r.downPx_=null,r.downTimeout_,r.lastDragTime_,r.pointerType_,r.freehand_=!1,r.source_=e.source?e.source:null,r.features_=e.features?e.features:null,r.snapTolerance_=e.snapTolerance?e.snapTolerance:12,r.type_=e.type,r.mode_=getMode(r.type_),r.stopClick_=!!e.stopClick,r.minPoints_=e.minPoints?e.minPoints:"Polygon"===r.mode_?3:2,r.maxPoints_="Circle"===r.mode_?2:e.maxPoints?e.maxPoints:1/0,r.finishCondition_=e.finishCondition?e.finishCondition:_functions.TRUE,r.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";var n=e.geometryFunction;if(!n){var o,a=r.mode_;if("Circle"===a)n=function(e,t,r){var i=t||new _Circle.default([NaN,NaN]),n=(0,_proj.fromUserCoordinate)(e[0],r),o=(0,_coordinate.squaredDistance)(n,(0,_proj.fromUserCoordinate)(e[e.length-1],r));i.setCenterAndRadius(n,Math.sqrt(o),this.geometryLayout_);var a=(0,_proj.getUserProjection)();return a&&i.transform(r,a),i};else"Point"===a?o=_Point.default:"LineString"===a?o=_LineString.default:"Polygon"===a&&(o=_Polygon.default),n=function(e,t,r){return t?"Polygon"===a?e[0].length?t.setCoordinates([e[0].concat([e[0][0]])],this.geometryLayout_):t.setCoordinates([],this.geometryLayout_):t.setCoordinates(e,this.geometryLayout_):t=new o(e,this.geometryLayout_),t}}return r.geometryFunction_=n,r.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,r.finishCoordinate_=null,r.sketchFeature_=null,r.sketchPoint_=null,r.sketchCoords_=null,r.sketchLine_=null,r.sketchLineCoords_=null,r.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,r.overlay_=new _Vector.default({source:new _Vector2.default({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:getDefaultStyleFunction(),updateWhileInteracting:!0}),r.geometryName_=e.geometryName,r.condition_=e.condition?e.condition:_condition.noModifierKeys,r.freehandCondition_,e.freehand?r.freehandCondition_=_condition.always:r.freehandCondition_=e.freehandCondition?e.freehandCondition:_condition.shiftKeyOnly,r.traceCondition_,r.setTrace(e.trace||!1),r.traceState_={active:!1},r.traceSource_=e.traceSource||e.source||null,r.addChangeListener(_Property.default.ACTIVE,r.updateState_),r}return _inherits(t,_Pointer["default"]),_createClass(t,[{key:"setTrace",value:function(e){var t;t=e?!0===e?_condition.always:e:_condition.never,this.traceCondition_=t}},{key:"setMap",value:function(e){_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),this.updateState_()}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleEvent",value:function(e){e.originalEvent.type===_EventType.default.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);var r=e.type===_MapBrowserEventType.default.POINTERMOVE,i=!0;!this.freehand_&&this.lastDragTime_&&e.type===_MapBrowserEventType.default.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,r=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===_MapBrowserEventType.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===_MapBrowserEventType.default.POINTERDOWN?i=!1:r&&this.getPointerCount()<2?(i=e.type===_MapBrowserEventType.default.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===_MapBrowserEventType.default.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===_MapBrowserEventType.default.DBLCLICK&&(i=!1),_get(_getPrototypeOf(t.prototype),"handleEvent",this).call(this,e)&&i}},{key:"handleDownEvent",value:function(e){var t=this;return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){t.handlePointerMove_(new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}},{key:"deactivateTrace_",value:function(){this.traceState_={active:!1}}},{key:"toggleTraceState_",value:function(e){if(this.traceSource_&&this.traceCondition_(e))if(this.traceState_.active)this.deactivateTrace_();else{var t=this.getMap(),r=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),n=(0,_extent.boundingExtent)([r,i]),o=this.traceSource_.getFeaturesInExtent(n);if(0!==o.length){var a=getTraceTargets(e.coordinate,o);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}}}},{key:"addOrRemoveTracedCoordinates_",value:function(e,t){var r=e.startIndex<=e.endIndex;r===e.startIndex<=t?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}},{key:"removeTracedCoordinates_",value:function(e,t){if(e!==t){var r=0;if(e<t){var i=Math.ceil(e),n=Math.floor(t);n===t&&(n-=1),r=n-i+1}else{var o=Math.floor(e),a=Math.ceil(t);a===t&&(a+=1),r=o-a+1}r>0&&this.removeLastPoints_(r)}}},{key:"addTracedCoordinates_",value:function(e,t,r){if(t!==r){var i=[];if(t<r){var n=Math.ceil(t),o=Math.floor(r);o===r&&(o-=1);for(var a=n;a<=o;++a)i.push(getCoordinate(e.coordinates,a))}else{var s=Math.floor(t),h=Math.ceil(r);h===r&&(h+=1);for(var u=s;u>=h;--u)i.push(getCoordinate(e.coordinates,u))}i.length&&this.appendCoordinates(i)}}},{key:"updateTrace_",value:function(e){var t=this.traceState_;if(t.active&&!(-1===t.targetIndex&&(0,_coordinate.distance)(t.startPx,e.pixel)<this.snapTolerance_)){var r=getTraceTargetUpdate(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==r.index){if(-1!==t.targetIndex){var i=t.targets[t.targetIndex];this.removeTracedCoordinates_(i.startIndex,i.endIndex)}var n=t.targets[r.index];this.addTracedCoordinates_(n,n.startIndex,r.endIndex)}else{var o=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(o,r.endIndex)}t.targetIndex=r.index;var a=t.targets[t.targetIndex];a.endIndex=r.endIndex;var s=interpolateCoordinate(a.coordinates,a.endIndex),h=this.getMap().getPixelFromCoordinate(s);e.coordinate=s,e.pixel=[Math.round(h[0]),Math.round(h[1])]}}},{key:"handleUpEvent",value:function(e){var t=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);var r=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){var i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&"Point"!==this.mode_||(this.atFinish_(e.pixel,r)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}},{key:"handlePointerMove_",value:function(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,r=e.pixel,i=t[0]-r[0],n=t[1]-r[1],o=i*i+n*n;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(e),this.modifyDrawing_(e.coordinate)):this.createOrUpdateSketchPoint_(e.coordinate.slice())}},{key:"atFinish_",value:function(e,t){var r=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_],o=this.mode_;if("Point"===o)r=!0;else if("Circle"===o)r=2===this.sketchCoords_.length;else if("LineString"===o)i=!t&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===o){var a=this.sketchCoords_;i=a[0].length>this.minPoints_,n=[a[0][0],a[0][a[0].length-2]],n=t?[a[0][0]]:[a[0][0],a[0][a[0].length-2]]}if(i)for(var s=this.getMap(),h=0,u=n.length;h<u;h++){var l=n[h],d=s.getPixelFromCoordinate(l),c=e[0]-d[0],_=e[1]-d[1],f=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(c*c+_*_)<=f){this.finishCoordinate_=l;break}}}return r}},{key:"createOrUpdateSketchPoint_",value:function(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new _Feature.default(new _Point.default(e)),this.updateSketchFeatures_())}},{key:"createOrUpdateCustomSketchLine_",value:function(e){this.sketchLine_||(this.sketchLine_=new _Feature.default);var t=e.getLinearRing(0),r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),r.changed()):(r=new _LineString.default(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(r))}},{key:"startDrawing_",value:function(e){for(var t=this.getMap().getView().getProjection(),r=(0,_SimpleGeometry.getStrideForLayout)(this.geometryLayout_);e.length<r;)e.push(0);this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new _Feature.default(new _LineString.default(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new _Feature.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART,this.sketchFeature_))}},{key:"modifyDrawing_",value:function(e){for(var t,r,i=this.getMap(),n=this.sketchFeature_.getGeometry(),o=i.getView().getProjection(),a=(0,_SimpleGeometry.getStrideForLayout)(this.geometryLayout_);e.length<a;)e.push(0);("Point"===this.mode_?r=this.sketchCoords_:"Polygon"===this.mode_?(r=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(i.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):r=(t=this.sketchCoords_)[t.length-1],r[0]=e[0],r[1]=e[1],this.geometryFunction_(this.sketchCoords_,n,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(e);if("Polygon"===n.getType()&&"Polygon"!==this.mode_)this.createOrUpdateCustomSketchLine_(n);else if(this.sketchLineCoords_){this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_)}this.updateSketchFeatures_()}},{key:"addToDrawing_",value:function(e){var t,r,i=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),o=this.mode_;return"LineString"===o||"Circle"===o?(this.finishCoordinate_=e.slice(),(r=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?r.pop():t=!0),r.push(e.slice()),this.geometryFunction_(r,i,n)):"Polygon"===o&&((r=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?r.pop():t=!0),r.push(e.slice()),t&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,i,n)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),t?this.finishDrawing():this.sketchFeature_}},{key:"removeLastPoints_",value:function(e){if(this.sketchFeature_){for(var t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),i=this.mode_,n=0;n<e;++n){var o=void 0;if("LineString"===i||"Circle"===i){if((o=this.sketchCoords_).splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();var a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,t,r),"Polygon"===t.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if("Polygon"===i){(o=this.sketchCoords_[0]).splice(-2,1);var s=this.sketchLine_.getGeometry();if(o.length>=2){var h=o[o.length-2].slice();o[o.length-1]=h,this.createOrUpdateSketchPoint_(h)}s.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,t,r)}if(1===o.length){this.abortDrawing();break}}this.updateSketchFeatures_()}}},{key:"removeLastPoint",value:function(){this.removeLastPoints_(1)}},{key:"finishDrawing",value:function(){var e=this.abortDrawing_();if(!e)return null;var t=this.sketchCoords_,r=e.getGeometry(),i=this.getMap().getView().getProjection();return"LineString"===this.mode_?(t.pop(),this.geometryFunction_(t,r,i)):"Polygon"===this.mode_&&(t[0].pop(),this.geometryFunction_(t,r,i),t=r.getCoordinates()),"MultiPoint"===this.type_?e.setGeometry(new _MultiPoint.default([t])):"MultiLineString"===this.type_?e.setGeometry(new _MultiLineString.default([t])):"MultiPolygon"===this.type_&&e.setGeometry(new _MultiPolygon.default([t])),this.dispatchEvent(new DrawEvent(DrawEventType.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}},{key:"abortDrawing_",value:function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}},{key:"abortDrawing",value:function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new DrawEvent(DrawEventType.DRAWABORT,e))}},{key:"appendCoordinates",value:function(e){var t,r=this.mode_,i=!this.sketchFeature_;if(i&&this.startDrawing_(e[0]),"LineString"===r||"Circle"===r)t=this.sketchCoords_;else{if("Polygon"!==r)return;t=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&t.shift(),t.pop();for(var n=0;n<e.length;n++)this.addToDrawing_(e[n]);var o=e[e.length-1];this.sketchFeature_=this.addToDrawing_(o),this.modifyDrawing_(o)}},{key:"extend",value:function(e){var t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();var r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new _Feature.default(new _Point.default(r)),this.updateSketchFeatures_(),this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART,this.sketchFeature_))}},{key:"updateSketchFeatures_",value:function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}},{key:"updateState_",value:function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)}}])}();function getDefaultStyleFunction(){var e=(0,_Style.createEditingStyle)();return function(t,r){return e[t.getGeometry().getType()]}}function createRegularPolygon(e,t){return function(r,i,n){var o=(0,_proj.fromUserCoordinate)(r[0],n),a=(0,_proj.fromUserCoordinate)(r[r.length-1],n),s=Math.sqrt((0,_coordinate.squaredDistance)(o,a));i=i||(0,_Polygon.fromCircle)(new _Circle.default(o),e);var h=t;if(!t&&0!==t){var u=a[0]-o[0],l=a[1]-o[1];h=Math.atan2(l,u)}(0,_Polygon.makeRegular)(i,o,s,h);var d=(0,_proj.getUserProjection)();return d&&i.transform(n,d),i}}function createBox(){return function(e,t,r){var i=(0,_extent.boundingExtent)([e[0],e[e.length-1]].map(function(e){return(0,_proj.fromUserCoordinate)(e,r)})),n=[[(0,_extent.getBottomLeft)(i),(0,_extent.getBottomRight)(i),(0,_extent.getTopRight)(i),(0,_extent.getTopLeft)(i),(0,_extent.getBottomLeft)(i)]];t?t.setCoordinates(n):t=new _Polygon.default(n);var o=(0,_proj.getUserProjection)();return o&&t.transform(r,o),t}}function getMode(e){switch(e){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+e)}}var _default=exports.default=Draw;

},{"../Feature.js":82,"../MapBrowserEvent.js":90,"../MapBrowserEventType.js":92,"../coordinate.js":128,"../events/Event.js":133,"../events/EventType.js":134,"../events/condition.js":138,"../extent.js":142,"../functions.js":200,"../geom/Circle.js":202,"../geom/GeometryCollection.js":204,"../geom/LineString.js":205,"../geom/MultiLineString.js":207,"../geom/MultiPoint.js":208,"../geom/MultiPolygon.js":209,"../geom/Point.js":210,"../geom/Polygon.js":211,"../geom/SimpleGeometry.js":212,"../layer/Vector.js":273,"../math.js":279,"../proj.js":283,"../source/Vector.js":367,"../style/Style.js":393,"./Pointer.js":254,"./Property.js":255}],245:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ExtentEvent=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_Vector=_interopRequireDefault(require("../layer/Vector.js")),_Vector2=_interopRequireDefault(require("../source/Vector.js")),_condition=require("../events/condition.js"),_extent=require("../extent.js"),_coordinate=require("../coordinate.js"),_Style=require("../style/Style.js"),_Polygon=require("../geom/Polygon.js"),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_superPropBase(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ExtentEventType={EXTENTCHANGED:"extentchanged"},ExtentEvent=exports.ExtentEvent=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[ExtentEventType.EXTENTCHANGED])).extent=e,n}return _inherits(t,_Event2["default"]),_createClass(t)}(),Extent=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e=e||{}])).on,n.once,n.un,n.condition_=e.condition?e.condition:_condition.always,n.extent_=null,n.pointerHandler_=null,n.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,n.snappedToVertex_=!1,n.extentFeature_=null,n.vertexFeature_=null,e||(e={}),n.extentOverlay_=new _Vector.default({source:new _Vector2.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:getDefaultExtentStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),n.vertexOverlay_=new _Vector.default({source:new _Vector2.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:getDefaultPointerStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&n.setExtent(e.extent),n}return _inherits(t,_Pointer["default"]),_createClass(t,[{key:"snapToVertex_",value:function(e,t){var n=t.getCoordinateFromPixelInternal(e),r=this.getExtentInternal();if(r){var o=getSegments(r);o.sort(function(e,t){return(0,_coordinate.squaredDistanceToSegment)(n,e)-(0,_coordinate.squaredDistanceToSegment)(n,t)});var i=o[0],a=(0,_coordinate.closestOnSegment)(n,i),u=t.getPixelFromCoordinateInternal(a);if((0,_coordinate.distance)(e,u)<=this.pixelTolerance_){var l=t.getPixelFromCoordinateInternal(i[0]),s=t.getPixelFromCoordinateInternal(i[1]),c=(0,_coordinate.squaredDistance)(u,l),p=(0,_coordinate.squaredDistance)(u,s),f=Math.sqrt(Math.min(c,p));return this.snappedToVertex_=f<=this.pixelTolerance_,this.snappedToVertex_&&(a=c>p?i[1]:i[0]),a}}return null}},{key:"handlePointerMove_",value:function(e){var t=e.pixel,n=e.map,r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)}},{key:"createOrUpdateExtentFeature_",value:function(e){var t=this.extentFeature_;return t?e?t.setGeometry((0,_Polygon.fromExtent)(e)):t.setGeometry(void 0):(t=e?new _Feature.default((0,_Polygon.fromExtent)(e)):new _Feature.default({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}},{key:"createOrUpdatePointerFeature_",value:function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new _Feature.default(new _Point.default(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t));return t}},{key:"handleEvent",value:function(e){return!e.originalEvent||!this.condition_(e)||(e.type!=_MapBrowserEventType.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),_get(_getPrototypeOf(t.prototype),"handleEvent",this).call(this,e),!1)}},{key:"handleDownEvent",value:function(e){var t=e.pixel,n=e.map,r=this.getExtentInternal(),o=this.snapToVertex_(t,n),i=function(e){var t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(o&&r){var a=o[0]==r[0]||o[0]==r[2]?o[0]:null,u=o[1]==r[1]||o[1]==r[3]?o[1]:null;null!==a&&null!==u?this.pointerHandler_=getPointHandler(i(o)):null!==a?this.pointerHandler_=getEdgeHandler(i([a,r[1]]),i([a,r[3]])):null!==u&&(this.pointerHandler_=getEdgeHandler(i([r[0],u]),i([r[2],u])))}else o=n.getCoordinateFromPixelInternal(t),this.setExtent([o[0],o[1],o[0],o[1]]),this.pointerHandler_=getPointHandler(o);return!0}},{key:"handleDragEvent",value:function(e){if(this.pointerHandler_){var t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}},{key:"handleUpEvent",value:function(e){this.pointerHandler_=null;var t=this.getExtentInternal();return t&&0!==(0,_extent.getArea)(t)||this.setExtent(null),!1}},{key:"setMap",value:function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e)}},{key:"getExtent",value:function(){return(0,_proj.toUserExtent)(this.getExtentInternal(),this.getMap().getView().getProjection())}},{key:"getExtentInternal",value:function(){return this.extent_}},{key:"setExtent",value:function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new ExtentEvent(this.extent_))}}])}();function getDefaultExtentStyleFunction(){var e=(0,_Style.createEditingStyle)();return function(t,n){return e.Polygon}}function getDefaultPointerStyleFunction(){var e=(0,_Style.createEditingStyle)();return function(t,n){return e.Point}}function getPointHandler(e){return function(t){return(0,_extent.boundingExtent)([e,t])}}function getEdgeHandler(e,t){return e[0]==t[0]?function(n){return(0,_extent.boundingExtent)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,_extent.boundingExtent)([e,[t[0],n[1]]])}:null}function getSegments(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}var _default=exports.default=Extent;

},{"../Feature.js":82,"../MapBrowserEventType.js":92,"../coordinate.js":128,"../events/Event.js":133,"../events/condition.js":138,"../extent.js":142,"../geom/Point.js":210,"../geom/Polygon.js":211,"../layer/Vector.js":273,"../proj.js":283,"../source/Vector.js":367,"../style/Style.js":393,"./Pointer.js":254}],246:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.pan=pan,exports.zoomByDelta=zoomByDelta;var _Object=_interopRequireDefault(require("../Object.js")),_Property=_interopRequireDefault(require("./Property.js")),_easing=require("../easing.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Interaction=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,e&&e.handleEvent&&(r.handleEvent=e.handleEvent),r.map_=null,r.setActive(!0),r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"getActive",value:function(){return this.get(_Property.default.ACTIVE)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(e){return!0}},{key:"setActive",value:function(e){this.set(_Property.default.ACTIVE,e)}},{key:"setMap",value:function(e){this.map_=e}}])}();function pan(e,t,r){var o=e.getCenterInternal();if(o){var n=[o[0]+t[0],o[1]+t[1]];e.animateInternal({duration:void 0!==r?r:250,easing:_easing.linear,center:e.getConstrainedCenter(n)})}}function zoomByDelta(e,t,r,o){var n=e.getZoom();if(void 0!==n){var i=e.getConstrainedZoom(n+t),u=e.getResolutionForZoom(i);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:u,anchor:r,duration:void 0!==o?o:250,easing:_easing.easeOut})}}var _default=exports.default=Interaction;

},{"../Object.js":96,"../easing.js":131,"./Property.js":255}],247:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireWildcard(require("./Interaction.js")),_Key=_interopRequireDefault(require("../events/Key.js")),_condition=require("../events/condition.js"),_coordinate=require("../coordinate.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var KeyboardPan=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).defaultCondition_=function(e){return(0,_condition.noModifierKeys)(e)&&(0,_condition.targetNotEditable)(e)},r.condition_=void 0!==e.condition?e.condition:r.defaultCondition_,r.duration_=void 0!==e.duration?e.duration:100,r.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){var t=!1;if(e.type==_EventType.default.KEYDOWN){var r=e.originalEvent,o=r.key;if(this.condition_(e)&&(o==_Key.default.DOWN||o==_Key.default.LEFT||o==_Key.default.RIGHT||o==_Key.default.UP)){var n=e.map.getView(),i=n.getResolution()*this.pixelDelta_,u=0,a=0;o==_Key.default.DOWN?a=-i:o==_Key.default.LEFT?u=-i:o==_Key.default.RIGHT?u=i:a=i;var f=[u,a];(0,_coordinate.rotate)(f,n.getRotation()),(0,_Interaction2.pan)(n,f,this.duration_),r.preventDefault(),t=!0}}return!t}}])}(),_default=exports.default=KeyboardPan;

},{"../coordinate.js":128,"../events/EventType.js":134,"../events/Key.js":135,"../events/condition.js":138,"./Interaction.js":246}],248:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireWildcard(require("./Interaction.js")),_condition=require("../events/condition.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var KeyboardZoom=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).condition_=e.condition?e.condition:function(e){return!(0,_condition.platformModifierKey)(e)&&(0,_condition.targetNotEditable)(e)},r.delta_=e.delta?e.delta:1,r.duration_=void 0!==e.duration?e.duration:100,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){var t=!1;if(e.type==_EventType.default.KEYDOWN||e.type==_EventType.default.KEYPRESS){var r=e.originalEvent,o=r.key;if(this.condition_(e)&&("+"===o||"-"===o)){var n=e.map,i="+"===o?this.delta_:-this.delta_,u=n.getView();(0,_Interaction2.zoomByDelta)(u,i,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}])}(),_default=exports.default=KeyboardZoom;

},{"../events/EventType.js":134,"../events/condition.js":138,"./Interaction.js":246}],249:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireDefault(require("./Interaction.js")),_MapEventType=_interopRequireDefault(require("../MapEventType.js")),_events=require("../events.js"),_math=require("../math.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function to5(e){return(0,_math.toFixed)(e,5)}function readNumber(e){return parseFloat(e)}function writeNumber(e){return to5(e).toString()}function differentNumber(e,t){return!isNaN(e)&&e!==readNumber(writeNumber(t))}function differentArray(e,t){return differentNumber(e[0],t[0])||differentNumber(e[1],t[1])}var Link=function(e){function t(e){var r,i;return _classCallCheck(this,t),r=_callSuper(this,t),i=!0===(e=Object.assign({animate:!0,params:["x","y","z","r","l"],replace:!1,prefix:""},e||{})).animate?{duration:250}:e.animate?e.animate:null,r.animationOptions_=i,r.params_=e.params.reduce(function(e,t){return e[t]=!0,e},{}),r.replace_=e.replace,r.prefix_=e.prefix,r.listenerKeys_=[],r.initial_=!0,r.updateState_=r.updateState_.bind(r),r.trackedCallbacks_={},r.trackedValues_={},r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"getParamName_",value:function(e){return this.prefix_?this.prefix_+e:e}},{key:"get_",value:function(e,t){return e.get(this.getParamName_(t))}},{key:"set_",value:function(e,t,r){t in this.params_&&e.set(this.getParamName_(t),r)}},{key:"delete_",value:function(e,t){t in this.params_&&e.delete(this.getParamName_(t))}},{key:"setMap",value:function(e){var r=this.getMap();_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),e!==r&&(r&&this.unregisterListeners_(r),e&&(this.initial_=!0,this.updateState_(),this.registerListeners_(e)))}},{key:"registerListeners_",value:function(e){this.listenerKeys_.push((0,_events.listen)(e,_MapEventType.default.MOVEEND,this.updateUrl_,this),(0,_events.listen)(e.getLayerGroup(),_EventType.default.CHANGE,this.updateUrl_,this),(0,_events.listen)(e,"change:layergroup",this.handleChangeLayerGroup_,this)),this.replace_||addEventListener("popstate",this.updateState_)}},{key:"unregisterListeners_",value:function(e){for(var t=0,r=this.listenerKeys_.length;t<r;++t)(0,_events.unlistenByKey)(this.listenerKeys_[t]);this.listenerKeys_.length=0,this.replace_||removeEventListener("popstate",this.updateState_);var i=new URL(window.location.href),n=i.searchParams;this.delete_(n,"x"),this.delete_(n,"y"),this.delete_(n,"z"),this.delete_(n,"r"),this.delete_(n,"l"),window.history.replaceState(null,"",i)}},{key:"handleChangeLayerGroup_",value:function(){var e=this.getMap();e&&(this.unregisterListeners_(e),this.registerListeners_(e),this.initial_=!0,this.updateUrl_())}},{key:"updateState_",value:function(){var e=new URL(window.location.href).searchParams;for(var t in this.trackedCallbacks_){var r=e.get(t);t in this.trackedCallbacks_&&r!==this.trackedValues_[t]&&(this.trackedValues_[t]=r,this.trackedCallbacks_[t](r))}var i=this.getMap();if(i){var n=i.getView();if(n){var a=!1,o={},s=readNumber(this.get_(e,"z"));"z"in this.params_&&differentNumber(s,n.getZoom())&&(a=!0,o.zoom=s);var u=readNumber(this.get_(e,"r"));"r"in this.params_&&differentNumber(u,n.getRotation())&&(a=!0,o.rotation=u);var l=[readNumber(this.get_(e,"x")),readNumber(this.get_(e,"y"))];("x"in this.params_||"y"in this.params_)&&differentArray(l,n.getCenter())&&(a=!0,o.center=l),a&&(!this.initial_&&this.animationOptions_?n.animate(Object.assign(o,this.animationOptions_)):(o.center&&n.setCenter(o.center),"zoom"in o&&n.setZoom(o.zoom),"rotation"in o&&n.setRotation(o.rotation)));var c=i.getAllLayers(),f=this.get_(e,"l");if("l"in this.params_&&f&&f.length===c.length)for(var _=0,p=c.length;_<p;++_){var h=parseInt(f[_]);if(!isNaN(h)){var y=Boolean(h),d=c[_];d.getVisible()!==y&&d.setVisible(y)}}}}}},{key:"track",value:function(e,t){this.trackedCallbacks_[e]=t;var r=new URL(window.location.href).searchParams.get(e);return this.trackedValues_[e]=r,r}},{key:"update",value:function(e,t){var r=new URL(window.location.href),i=r.searchParams;null===t?i.delete(e):i.set(e,t),e in this.trackedValues_&&(this.trackedValues_[e]=t),this.updateHistory_(r)}},{key:"updateUrl_",value:function(){var e=this.getMap();if(e){var t=e.getView();if(t){for(var r=t.getCenter(),i=t.getZoom(),n=t.getRotation(),a=e.getAllLayers(),o=new Array(a.length),s=0,u=a.length;s<u;++s)o[s]=a[s].getVisible()?"1":"0";var l=new URL(window.location.href),c=l.searchParams;this.set_(c,"x",writeNumber(r[0])),this.set_(c,"y",writeNumber(r[1])),this.set_(c,"z",writeNumber(i)),this.set_(c,"r",writeNumber(n)),this.set_(c,"l",o.join("")),this.updateHistory_(l),this.initial_=!1}}}},{key:"updateHistory_",value:function(e){e.href!==window.location.href&&(this.initial_||this.replace_?window.history.replaceState(history.state,"",e):window.history.pushState(null,"",e))}}])}(),_default=exports.default=Link;

},{"../MapEventType.js":94,"../events.js":132,"../events/EventType.js":134,"../math.js":279,"./Interaction.js":246}],250:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ModifyEvent=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_RBush=_interopRequireDefault(require("../structs/RBush.js")),_VectorEventType=_interopRequireDefault(require("../source/VectorEventType.js")),_Vector=_interopRequireDefault(require("../layer/Vector.js")),_Vector2=_interopRequireDefault(require("../source/Vector.js")),_condition=require("../events/condition.js"),_extent=require("../extent.js"),_coordinate2=require("../coordinate.js"),_Style=require("../style/Style.js"),_array=require("../array.js"),_Polygon=require("../geom/Polygon.js"),_proj=require("../proj.js"),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CIRCLE_CENTER_INDEX=0,CIRCLE_CIRCUMFERENCE_INDEX=1,tempExtent=[0,0,0,0],tempSegment=[],ModifyEventType={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},ModifyEvent=exports.ModifyEvent=function(e){function t(e,r,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).features=r,i.mapBrowserEvent=n,i}return _inherits(t,_Event2["default"]),_createClass(t)}(),Modify=function(e){function t(e){var r,n;if(_classCallCheck(this,t),(r=_callSuper(this,t,[e])).on,r.once,r.un,r.boundHandleFeatureChange_=r.handleFeatureChange_.bind(r),r.condition_=e.condition?e.condition:_condition.primaryAction,r.defaultDeleteCondition_=function(e){return(0,_condition.altKeyOnly)(e)&&(0,_condition.singleClick)(e)},r.deleteCondition_=e.deleteCondition?e.deleteCondition:r.defaultDeleteCondition_,r.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:_condition.always,r.vertexFeature_=null,r.vertexSegments_=null,r.lastPixel_=[0,0],r.ignoreNextSingleClick_=!1,r.featuresBeingModified_=null,r.rBush_=new _RBush.default,r.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,r.snappedToVertex_=!1,r.changingFeature_=!1,r.dragSegments_=[],r.overlay_=new _Vector.default({source:new _Vector2.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),r.SEGMENT_WRITERS_={Point:r.writePointGeometry_.bind(r),LineString:r.writeLineStringGeometry_.bind(r),LinearRing:r.writeLineStringGeometry_.bind(r),Polygon:r.writePolygonGeometry_.bind(r),MultiPoint:r.writeMultiPointGeometry_.bind(r),MultiLineString:r.writeMultiLineStringGeometry_.bind(r),MultiPolygon:r.writeMultiPolygonGeometry_.bind(r),Circle:r.writeCircleGeometry_.bind(r),GeometryCollection:r.writeGeometryCollectionGeometry_.bind(r)},r.source_=null,r.hitDetection_=null,e.features?n=e.features:e.source&&(r.source_=e.source,n=new _Collection.default(r.source_.getFeatures()),r.source_.addEventListener(_VectorEventType.default.ADDFEATURE,r.handleSourceAdd_.bind(r)),r.source_.addEventListener(_VectorEventType.default.REMOVEFEATURE,r.handleSourceRemove_.bind(r))),!n)throw new Error("The modify interaction requires features, a source or a layer");return e.hitDetection&&(r.hitDetection_=e.hitDetection),r.features_=n,r.features_.forEach(r.addFeature_.bind(r)),r.features_.addEventListener(_CollectionEventType.default.ADD,r.handleFeatureAdd_.bind(r)),r.features_.addEventListener(_CollectionEventType.default.REMOVE,r.handleFeatureRemove_.bind(r)),r.lastPointerEvent_=null,r.delta_=[0,0],r.snapToPointer_=void 0===e.snapToPointer?!r.hitDetection_:e.snapToPointer,r}return _inherits(t,_Pointer["default"]),_createClass(t,[{key:"addFeature_",value:function(e){var t=e.getGeometry();if(t){var r=this.SEGMENT_WRITERS_[t.getType()];r&&r(e,t)}var n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),e.addEventListener(_EventType.default.CHANGE,this.boundHandleFeatureChange_)}},{key:"willModifyFeatures_",value:function(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new _Collection.default;for(var r=this.featuresBeingModified_.getArray(),n=0,i=t.length;n<i;++n)for(var o=t[n],a=0,s=o.length;a<s;++a){var u=o[a].feature;u&&!r.includes(u)&&this.featuresBeingModified_.push(u)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYSTART,this.featuresBeingModified_,e))}}},{key:"removeFeature_",value:function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(_EventType.default.CHANGE,this.boundHandleFeatureChange_)}},{key:"removeFeatureSegmentData_",value:function(e){var t=this.rBush_,r=[];t.forEach(function(t){e===t.feature&&r.push(t)});for(var n=r.length-1;n>=0;--n){for(var i=r[n],o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===i&&this.dragSegments_.splice(o,1);t.remove(i)}}},{key:"setActive",value:function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),_get(_getPrototypeOf(t.prototype),"setActive",this).call(this,e)}},{key:"setMap",value:function(e){this.overlay_.setMap(e),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e)}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleSourceAdd_",value:function(e){e.feature&&this.features_.push(e.feature)}},{key:"handleSourceRemove_",value:function(e){e.feature&&this.features_.remove(e.feature)}},{key:"handleFeatureAdd_",value:function(e){this.addFeature_(e.element)}},{key:"handleFeatureChange_",value:function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}}},{key:"handleFeatureRemove_",value:function(e){this.removeFeature_(e.element)}},{key:"writePointGeometry_",value:function(e,t){var r=t.getCoordinates(),n={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),n)}},{key:"writeMultiPointGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n){var o=r[n],a={feature:e,geometry:t,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(t.getExtent(),a)}}},{key:"writeLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length-1;n<i;++n){var o=r.slice(n,n+2),a={feature:e,geometry:t,index:n,segment:o};this.rBush_.insert((0,_extent.boundingExtent)(o),a)}}},{key:"writeMultiLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length-1;a<s;++a){var u=o.slice(a,a+2),l={feature:e,geometry:t,depth:[n],index:a,segment:u};this.rBush_.insert((0,_extent.boundingExtent)(u),l)}}},{key:"writePolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length-1;a<s;++a){var u=o.slice(a,a+2),l={feature:e,geometry:t,depth:[n],index:a,segment:u};this.rBush_.insert((0,_extent.boundingExtent)(u),l)}}},{key:"writeMultiPolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length;a<s;++a)for(var u=o[a],l=0,d=u.length-1;l<d;++l){var _=u.slice(l,l+2),g={feature:e,geometry:t,depth:[a,n],index:l,segment:_};this.rBush_.insert((0,_extent.boundingExtent)(_),g)}}},{key:"writeCircleGeometry_",value:function(e,t){var r=t.getCenter(),n={feature:e,geometry:t,index:CIRCLE_CENTER_INDEX,segment:[r,r]},i={feature:e,geometry:t,index:CIRCLE_CIRCUMFERENCE_INDEX,segment:[r,r]},o=[n,i];n.featureSegments=o,i.featureSegments=o,this.rBush_.insert((0,_extent.createOrUpdateFromCoordinate)(r),n);var a=t,s=(0,_proj.getUserProjection)();if(s&&this.getMap()){var u=this.getMap().getView().getProjection();a=a.clone().transform(s,u),a=(0,_Polygon.fromCircle)(a).transform(u,s)}this.rBush_.insert(a.getExtent(),i)}},{key:"writeGeometryCollectionGeometry_",value:function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var i=r[n];(0,this.SEGMENT_WRITERS_[i.getType()])(e,i)}}},{key:"createOrUpdateVertexFeature_",value:function(e,t,r){var n=this.vertexFeature_;n?n.getGeometry().setCoordinates(e):(n=new _Feature.default(new _Point.default(e)),this.vertexFeature_=n,this.overlay_.getSource().addFeature(n));return n.set("features",t),n.set("geometries",r),n}},{key:"handleEvent",value:function(e){return!e.originalEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=_MapBrowserEventType.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(r=!(e.type!=_MapBrowserEventType.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==_MapBrowserEventType.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),_get(_getPrototypeOf(t.prototype),"handleEvent",this).call(this,e)&&!r);var r}},{key:"handleDragEvent",value:function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);for(var t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],n=[],i=0,o=this.dragSegments_.length;i<o;++i){var a=this.dragSegments_[i],s=a[0],u=s.feature;r.includes(u)||r.push(u);var l=s.geometry;n.includes(l)||n.push(l);for(var d=s.depth,_=void 0,g=s.segment,c=a[1];t.length<l.getStride();)t.push(g[c][t.length]);switch(l.getType()){case"Point":_=t,g[0]=t,g[1]=t;break;case"MultiPoint":(_=l.getCoordinates())[s.index]=t,g[0]=t,g[1]=t;break;case"LineString":(_=l.getCoordinates())[s.index+c]=t,g[c]=t;break;case"MultiLineString":case"Polygon":(_=l.getCoordinates())[d[0]][s.index+c]=t,g[c]=t;break;case"MultiPolygon":(_=l.getCoordinates())[d[1]][d[0]][s.index+c]=t,g[c]=t;break;case"Circle":if(g[0]=t,g[1]=t,s.index===CIRCLE_CENTER_INDEX)this.changingFeature_=!0,l.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var f=e.map.getView().getProjection(),h=(0,_coordinate2.distance)((0,_proj.fromUserCoordinate)(l.getCenter(),f),(0,_proj.fromUserCoordinate)(t,f)),p=(0,_proj.getUserProjection)();if(p){var v=l.clone().transform(p,f);v.setRadius(h),h=v.transform(f,p).getRadius()}l.setRadius(h),this.changingFeature_=!1}}_&&this.setGeometryCoordinates_(l,_)}this.createOrUpdateVertexFeature_(t,r,n)}},{key:"handleDownEvent",value:function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;var r=this.vertexFeature_;if(r){var n=e.map.getView().getProjection(),i=[],o=r.getGeometry().getCoordinates(),a=(0,_extent.boundingExtent)([o]),s=this.rBush_.getInExtent(a),u={};s.sort(compareIndexes);for(var l=0,d=s.length;l<d;++l){var _=s[l],g=_.segment,c=(0,_util.getUid)(_.geometry),f=_.depth;if(f&&(c+="-"+f.join("-")),u[c]||(u[c]=new Array(2)),"Circle"!==_.geometry.getType()||_.index!==CIRCLE_CIRCUMFERENCE_INDEX)if(!(0,_coordinate2.equals)(g[0],o)||u[c][0])if(!(0,_coordinate2.equals)(g[1],o)||u[c][1])(0,_util.getUid)(g)in this.vertexSegments_&&!u[c][0]&&!u[c][1]&&this.insertVertexCondition_(e)&&i.push(_);else{if(u[c][0]&&0===u[c][0].index){var h=_.geometry.getCoordinates();switch(_.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":h=h[f[1]];case"Polygon":if(_.index!==h[f[0]].length-2)continue}}this.dragSegments_.push([_,1]),u[c][1]=_}else this.dragSegments_.push([_,0]),u[c][0]=_;else{var p=closestOnSegmentData(t,_,n);(0,_coordinate2.equals)(p,o)&&!u[c][0]&&(this.dragSegments_.push([_,0]),u[c][0]=_)}}i.length&&this.willModifyFeatures_(e,[i]);for(var v=i.length-1;v>=0;--v)this.insertVertex_(i[v],o)}return!!this.vertexFeature_}},{key:"handleUpEvent",value:function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var r=this.dragSegments_[t][0],n=r.geometry;if("Circle"===n.getType()){var i=n.getCenter(),o=r.featureSegments[0],a=r.featureSegments[1];o.segment[0]=i,o.segment[1]=i,a.segment[0]=i,a.segment[1]=i,this.rBush_.update((0,_extent.createOrUpdateFromCoordinate)(i),o);var s=n,u=(0,_proj.getUserProjection)();if(u){var l=e.map.getView().getProjection();s=s.clone().transform(u,l),s=(0,_Polygon.fromCircle)(s).transform(l,u)}this.rBush_.update(s.getExtent(),a)}else this.rBush_.update((0,_extent.boundingExtent)(r.segment),r)}return this.featuresBeingModified_&&(this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}},{key:"handlePointerMove_",value:function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}},{key:"handlePointerAtPixel_",value:function(e,t,r){var n,i,o=this,a=r||t.getCoordinateFromPixel(e),s=t.getView().getProjection();if(this.hitDetection_){var u="object"===_typeof(this.hitDetection_)?function(e){return e===o.hitDetection_}:void 0;t.forEachFeatureAtPixel(e,function(e,t,r){r&&"Point"===r.getType()&&(r=new _Point.default((0,_proj.toUserCoordinate)(r.getCoordinates(),s)));var a=r||e.getGeometry();if(e instanceof _Feature.default&&o.features_.getArray().includes(e)){i=a;var u=e.getGeometry().getFlatCoordinates().slice(0,2);n=[{feature:e,geometry:i,segment:[u,u]}]}return!0},{layerFilter:u})}if(!n){var l=(0,_proj.fromUserExtent)((0,_extent.createOrUpdateFromCoordinate)(a,tempExtent),s),d=t.getView().getResolution()*this.pixelTolerance_,_=(0,_proj.toUserExtent)((0,_extent.buffer)(l,d,tempExtent),s);n=this.rBush_.getInExtent(_)}if(n&&n.length>0){var g=n.sort(function(e,t){return projectedDistanceToSegmentDataSquared(a,e,s)-projectedDistanceToSegmentDataSquared(a,t,s)})[0],c=g.segment,f=closestOnSegmentData(a,g,s),h=t.getPixelFromCoordinate(f),p=(0,_coordinate2.distance)(e,h);if(i||p<=this.pixelTolerance_){var v={};if(v[(0,_util.getUid)(c)]=!0,this.snapToPointer_||(this.delta_[0]=f[0]-a[0],this.delta_[1]=f[1]-a[1]),"Circle"===g.geometry.getType()&&g.index===CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(f,[g.feature],[g.geometry]);else{var y=t.getPixelFromCoordinate(c[0]),m=t.getPixelFromCoordinate(c[1]),E=(0,_coordinate2.squaredDistance)(h,y),C=(0,_coordinate2.squaredDistance)(h,m);p=Math.sqrt(Math.min(E,C)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(f=E>C?c[1]:c[0]),this.createOrUpdateVertexFeature_(f,[g.feature],[g.geometry]);var x={};x[(0,_util.getUid)(g.geometry)]=!0;for(var P=1,S=n.length;P<S;++P){var F=n[P].segment;if(!((0,_coordinate2.equals)(c[0],F[0])&&(0,_coordinate2.equals)(c[1],F[1])||(0,_coordinate2.equals)(c[0],F[1])&&(0,_coordinate2.equals)(c[1],F[0])))break;var M=(0,_util.getUid)(n[P].geometry);M in x||(x[M]=!0,v[(0,_util.getUid)(F)]=!0)}}return void(this.vertexSegments_=v)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}},{key:"insertVertex_",value:function(e,t){for(var r,n=e.segment,i=e.feature,o=e.geometry,a=e.depth,s=e.index;t.length<o.getStride();)t.push(0);switch(o.getType()){case"MultiLineString":case"Polygon":(r=o.getCoordinates())[a[0]].splice(s+1,0,t);break;case"MultiPolygon":(r=o.getCoordinates())[a[1]][a[0]].splice(s+1,0,t);break;case"LineString":(r=o.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(o,r);var u=this.rBush_;u.remove(e),this.updateSegmentIndices_(o,s,a,1);var l={segment:[n[0],t],feature:i,geometry:o,depth:a,index:s};u.insert((0,_extent.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);var d={segment:[t,n[1]],feature:i,geometry:o,depth:a,index:s+1};u.insert((0,_extent.boundingExtent)(d.segment),d),this.dragSegments_.push([d,0]),this.ignoreNextSingleClick_=!0}},{key:"removePoint",value:function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=_MapBrowserEventType.default.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);var t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}},{key:"removeVertex_",value:function(){var e,t,r,n,i,o,a,s,u,l,d,_=this.dragSegments_,g={},c=!1;for(i=_.length-1;i>=0;--i)l=(r=_[i])[0],d=(0,_util.getUid)(l.feature),l.depth&&(d+="-"+l.depth.join("-")),d in g||(g[d]={}),0===r[1]?(g[d].right=l,g[d].index=l.index):1==r[1]&&(g[d].left=l,g[d].index=l.index+1);for(d in g){switch(u=g[d].right,a=g[d].left,(s=(o=g[d].index)-1)<0&&(s=0),e=t=(n=(l=void 0!==a?a:u).geometry).getCoordinates(),c=!1,n.getType()){case"MultiLineString":t[l.depth[0]].length>2&&(t[l.depth[0]].splice(o,1),c=!0);break;case"LineString":t.length>2&&(t.splice(o,1),c=!0);break;case"MultiPolygon":e=e[l.depth[1]];case"Polygon":(e=e[l.depth[0]]).length>4&&(o==e.length-1&&(o=0),e.splice(o,1),c=!0,0===o&&(e.pop(),e.push(e[0]),s=e.length-1))}if(c){this.setGeometryCoordinates_(n,t);var f=[];if(void 0!==a&&(this.rBush_.remove(a),f.push(a.segment[0])),void 0!==u&&(this.rBush_.remove(u),f.push(u.segment[1])),void 0!==a&&void 0!==u){var h={depth:l.depth,feature:l.feature,geometry:l.geometry,index:s,segment:f};this.rBush_.insert((0,_extent.boundingExtent)(h.segment),h)}this.updateSegmentIndices_(n,o,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),_.length=0}}return c}},{key:"setGeometryCoordinates_",value:function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}},{key:"updateSegmentIndices_",value:function(e,t,r,n){this.rBush_.forEachInExtent(e.getExtent(),function(i){i.geometry===e&&(void 0===r||void 0===i.depth||(0,_array.equals)(i.depth,r))&&i.index>t&&(i.index+=n)})}}])}();function compareIndexes(e,t){return e.index-t.index}function projectedDistanceToSegmentDataSquared(e,t,r){var n=t.geometry;if("Circle"===n.getType()){var i=n;if(t.index===CIRCLE_CIRCUMFERENCE_INDEX){var o=(0,_proj.getUserProjection)();o&&(i=i.clone().transform(o,r));var a=(0,_coordinate2.squaredDistance)(i.getCenter(),(0,_proj.fromUserCoordinate)(e,r)),s=Math.sqrt(a)-i.getRadius();return s*s}}var u=(0,_proj.fromUserCoordinate)(e,r);return tempSegment[0]=(0,_proj.fromUserCoordinate)(t.segment[0],r),tempSegment[1]=(0,_proj.fromUserCoordinate)(t.segment[1],r),(0,_coordinate2.squaredDistanceToSegment)(u,tempSegment)}function closestOnSegmentData(e,t,r){var n=t.geometry;if("Circle"===n.getType()&&t.index===CIRCLE_CIRCUMFERENCE_INDEX){var i=n,o=(0,_proj.getUserProjection)();return o&&(i=i.clone().transform(o,r)),(0,_proj.toUserCoordinate)(i.getClosestPoint((0,_proj.fromUserCoordinate)(e,r)),r)}var a=(0,_proj.fromUserCoordinate)(e,r);return tempSegment[0]=(0,_proj.fromUserCoordinate)(t.segment[0],r),tempSegment[1]=(0,_proj.fromUserCoordinate)(t.segment[1],r),(0,_proj.toUserCoordinate)((0,_coordinate2.closestOnSegment)(a,tempSegment),r)}function getDefaultStyleFunction(){var e=(0,_Style.createEditingStyle)();return function(t,r){return e.Point}}var _default=exports.default=Modify;

},{"../Collection.js":78,"../CollectionEventType.js":79,"../Feature.js":82,"../MapBrowserEventType.js":92,"../array.js":110,"../coordinate.js":128,"../events/Event.js":133,"../events/EventType.js":134,"../events/condition.js":138,"../extent.js":142,"../geom/Point.js":210,"../geom/Polygon.js":211,"../layer/Vector.js":273,"../proj.js":283,"../source/Vector.js":367,"../source/VectorEventType.js":368,"../structs/RBush.js":383,"../style/Style.js":393,"../util.js":404,"./Pointer.js":254}],251:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireWildcard(require("./Interaction.js")),_has=require("../has.js"),_condition=require("../events/condition.js"),_math=require("../math.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,o=new WeakMap;return(_getRequireWildcardCache=function(t){return t?o:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var o=_getRequireWildcardCache(e);if(o&&o.has(t))return o.get(t);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&{}.hasOwnProperty.call(t,n)){var a=i?Object.getOwnPropertyDescriptor(t,n):null;a&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n]}return r.default=t,o&&o.set(t,r),r}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MouseWheelZoom=function(t){function e(t){var o;_classCallCheck(this,e),(o=_callSuper(this,e,[t=t||{}])).totalDelta_=0,o.lastDelta_=0,o.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,o.duration_=void 0!==t.duration?t.duration:250,o.timeout_=void 0!==t.timeout?t.timeout:80,o.useAnchor_=void 0===t.useAnchor||t.useAnchor,o.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;var r=t.condition?t.condition:_condition.always;return o.condition_=t.onFocusOnly?(0,_condition.all)(_condition.focusWithTabindex,r):r,o.lastAnchor_=null,o.startTime_=void 0,o.timeoutId_,o.mode_=void 0,o.trackpadEventGap_=400,o.trackpadTimeoutId_,o.deltaPerZoom_=300,o}return _inherits(e,_Interaction2["default"]),_createClass(e,[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.condition_(t))return!0;if(t.type!==_EventType.default.WHEEL)return!0;var e,o=t.map,r=t.originalEvent;if(r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==_EventType.default.WHEEL&&(e=r.deltaY,_has.FIREFOX&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=_has.DEVICE_PIXEL_RATIO),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?"trackpad":"wheel");var n=o.getView();if("trackpad"===this.mode_&&!n.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(n.getAnimating()&&n.cancelAnimations(),n.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),n.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),a),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var o=-(0,_math.clamp)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(o=o?o>0?1:-1:0),(0,_Interaction2.zoomByDelta)(e,o,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}])}(),_default=exports.default=MouseWheelZoom;

},{"../events/EventType.js":134,"../events/condition.js":138,"../has.js":233,"../math.js":279,"./Interaction.js":246}],252:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireWildcard(require("./Pointer.js")),_functions=require("../functions.js"),_rotationconstraint=require("../rotationconstraint.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&{}.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var PinchRotate=function(t){function e(t){var r;_classCallCheck(this,e);var n=t=t||{};return n.stopDown||(n.stopDown=_functions.FALSE),(r=_callSuper(this,e,[n])).anchor_=null,r.lastAngle_=void 0,r.rotating_=!1,r.rotationDelta_=0,r.threshold_=void 0!==t.threshold?t.threshold:.3,r.duration_=void 0!==t.duration?t.duration:250,r}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){var e=0,r=this.targetPointers[0],n=this.targetPointers[1],o=Math.atan2(n.clientY-r.clientY,n.clientX-r.clientX);if(void 0!==this.lastAngle_){var i=o-this.lastAngle_;this.rotationDelta_+=i,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=i}this.lastAngle_=o;var a=t.map,u=a.getView();u.getConstraints().rotation!==_rotationconstraint.disable&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel((0,_Pointer.centroid)(this.targetPointers))),this.rotating_&&(a.render(),u.adjustRotationInternal(e,this.anchor_)))}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])}(),_default=exports.default=PinchRotate;

},{"../functions.js":200,"../rotationconstraint.js":336,"./Pointer.js":254}],253:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireWildcard(require("./Pointer.js")),_functions=require("../functions.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&{}.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var PinchZoom=function(t){function e(t){var r;_classCallCheck(this,e);var n=t=t||{};return n.stopDown||(n.stopDown=_functions.FALSE),(r=_callSuper(this,e,[n])).anchor_=null,r.duration_=void 0!==t.duration?t.duration:400,r.lastDistance_=void 0,r.lastScaleDelta_=1,r}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){var e=1,r=this.targetPointers[0],n=this.targetPointers[1],o=r.clientX-n.clientX,i=r.clientY-n.clientY,a=Math.sqrt(o*o+i*i);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var u=t.map,c=u.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel((0,_Pointer.centroid)(this.targetPointers))),u.render(),c.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,r),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])}(),_default=exports.default=PinchZoom;

},{"../functions.js":200,"./Pointer.js":254}],254:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.centroid=centroid,exports.default=void 0;var _Interaction2=_interopRequireDefault(require("./Interaction.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var PointerInteraction=function(e){function t(e){var n;return _classCallCheck(this,t),n=_callSuper(this,t,[e=e||{}]),e.handleDownEvent&&(n.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(n.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(n.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(n.handleUpEvent=e.handleUpEvent),e.stopDown&&(n.stopDown=e.stopDown),n.handlingDownUpSequence=!1,n.targetPointers=[],n}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(e){return!1}},{key:"handleDragEvent",value:function(e){}},{key:"handleEvent",value:function(e){if(!e.originalEvent)return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==_MapBrowserEventType.default.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==_MapBrowserEventType.default.POINTERUP){var n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==_MapBrowserEventType.default.POINTERDOWN){var r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==_MapBrowserEventType.default.POINTERMOVE&&this.handleMoveEvent(e);return!t}},{key:"handleMoveEvent",value:function(e){}},{key:"handleUpEvent",value:function(e){return!1}},{key:"stopDown",value:function(e){return e}},{key:"updateTrackedPointers_",value:function(e){e.activePointers&&(this.targetPointers=e.activePointers)}}])}();function centroid(e){for(var t=e.length,n=0,r=0,o=0;o<t;o++)n+=e[o].clientX,r+=e[o].clientY;return{clientX:n/t,clientY:r/t}}var _default=exports.default=PointerInteraction;

},{"../MapBrowserEventType.js":92,"./Interaction.js":246}],255:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ACTIVE:"active"};

},{}],256:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.SelectEvent=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_Interaction2=_interopRequireDefault(require("./Interaction.js")),_Vector=_interopRequireDefault(require("../layer/Vector.js")),_functions=require("../functions.js"),_obj=require("../obj.js"),_Style=require("../style/Style.js"),_array=require("../array.js"),_util=require("../util.js"),_condition=require("../events/condition.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var SelectEventType={SELECT:"select"},SelectEvent=exports.SelectEvent=function(e){function t(e,r,n,i){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).selected=r,o.deselected=n,o.mapBrowserEvent=i,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),originalFeatureStyles={},Select=function(e){function t(e){var r,n;if(_classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,e=e||{},r.boundAddFeature_=r.addFeature_.bind(r),r.boundRemoveFeature_=r.removeFeature_.bind(r),r.condition_=e.condition?e.condition:_condition.singleClick,r.addCondition_=e.addCondition?e.addCondition:_condition.never,r.removeCondition_=e.removeCondition?e.removeCondition:_condition.never,r.toggleCondition_=e.toggleCondition?e.toggleCondition:_condition.shiftKeyOnly,r.multi_=!!e.multi&&e.multi,r.filter_=e.filter?e.filter:_functions.TRUE,r.hitTolerance_=e.hitTolerance?e.hitTolerance:0,r.style_=void 0!==e.style?e.style:getDefaultStyleFunction(),r.features_=e.features||new _Collection.default,e.layers)if("function"==typeof e.layers)n=e.layers;else{var i=e.layers;n=function(e){return i.includes(e)}}else n=_functions.TRUE;return r.layerFilter_=n,r.featureLayerAssociation_={},r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"addFeatureLayerAssociation_",value:function(e,t){this.featureLayerAssociation_[(0,_util.getUid)(e)]=t}},{key:"getFeatures",value:function(){return this.features_}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"getLayer",value:function(e){return this.featureLayerAssociation_[(0,_util.getUid)(e)]}},{key:"setHitTolerance",value:function(e){this.hitTolerance_=e}},{key:"setMap",value:function(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),e?(this.features_.addEventListener(_CollectionEventType.default.ADD,this.boundAddFeature_),this.features_.addEventListener(_CollectionEventType.default.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(_CollectionEventType.default.ADD,this.boundAddFeature_),this.features_.removeEventListener(_CollectionEventType.default.REMOVE,this.boundRemoveFeature_))}},{key:"addFeature_",value:function(e){var t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){var r=this.getMap().getAllLayers().find(function(e){if(e instanceof _Vector.default&&e.getSource()&&e.getSource().hasFeature(t))return e});r&&this.addFeatureLayerAssociation_(t,r)}}},{key:"removeFeature_",value:function(e){this.style_&&this.restorePreviousStyle_(e.element)}},{key:"getStyle",value:function(){return this.style_}},{key:"applySelectedStyle_",value:function(e){var t=(0,_util.getUid)(e);t in originalFeatureStyles||(originalFeatureStyles[t]=e.getStyle()),e.setStyle(this.style_)}},{key:"restorePreviousStyle_",value:function(e){for(var r=this.getMap().getInteractions().getArray(),n=r.length-1;n>=0;--n){var i=r[n];if(i!==this&&i instanceof t&&i.getStyle()&&-1!==i.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(i.getStyle())}var o=(0,_util.getUid)(e);e.setStyle(originalFeatureStyles[o]),delete originalFeatureStyles[o]}},{key:"removeFeatureLayerAssociation_",value:function(e){delete this.featureLayerAssociation_[(0,_util.getUid)(e)]}},{key:"handleEvent",value:function(e){var t=this;if(!this.condition_(e))return!0;var r=this.addCondition_(e),n=this.removeCondition_(e),i=this.toggleCondition_(e),o=!r&&!n&&!i,l=e.map,a=this.getFeatures(),u=[],s=[];if(o){(0,_obj.clear)(this.featureLayerAssociation_),l.forEachFeatureAtPixel(e.pixel,function(e,r){if(e instanceof _Feature.default&&t.filter_(e,r))return t.addFeatureLayerAssociation_(e,r),s.push(e),!t.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var c=a.getLength()-1;c>=0;--c){var f=a.item(c),_=s.indexOf(f);_>-1?s.splice(_,1):(a.remove(f),u.push(f))}0!==s.length&&a.extend(s)}else{l.forEachFeatureAtPixel(e.pixel,function(e,o){if(e instanceof _Feature.default&&t.filter_(e,o))return!r&&!i||a.getArray().includes(e)?(n||i)&&a.getArray().includes(e)&&(u.push(e),t.removeFeatureLayerAssociation_(e)):(t.addFeatureLayerAssociation_(e,o),s.push(e)),!t.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var y=u.length-1;y>=0;--y)a.remove(u[y]);a.extend(s)}return(s.length>0||u.length>0)&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,s,u,e)),!0}}])}();function getDefaultStyleFunction(){var e=(0,_Style.createEditingStyle)();return(0,_array.extend)(e.Polygon,e.LineString),(0,_array.extend)(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}var _default=exports.default=Select;

},{"../Collection.js":78,"../CollectionEventType.js":79,"../Feature.js":82,"../array.js":110,"../events/Event.js":133,"../events/condition.js":138,"../functions.js":200,"../layer/Vector.js":273,"../obj.js":281,"../style/Style.js":393,"../util.js":404,"./Interaction.js":246}],257:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_RBush=_interopRequireDefault(require("../structs/RBush.js")),_VectorEventType=_interopRequireDefault(require("../source/VectorEventType.js")),_functions=require("../functions.js"),_SnapEvent=require("../events/SnapEvent.js"),_extent=require("../extent.js"),_coordinate=require("../coordinate.js"),_Polygon=require("../geom/Polygon.js"),_proj=require("../proj.js"),_util=require("../util.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function getFeatureFromEvent(e){return e.feature?e.feature:e.element?e.element:null}var tempSegment=[],Snap=function(e){function t(e){var r;_classCallCheck(this,t);var n=e=e||{};return n.handleDownEvent||(n.handleDownEvent=_functions.TRUE),n.stopDown||(n.stopDown=_functions.FALSE),(r=_callSuper(this,t,[n])).on,r.once,r.un,r.source_=e.source?e.source:null,r.vertex_=void 0===e.vertex||e.vertex,r.edge_=void 0===e.edge||e.edge,r.features_=e.features?e.features:null,r.featuresListenerKeys_=[],r.featureChangeListenerKeys_={},r.indexedFeaturesExtents_={},r.pendingFeatures_={},r.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,r.rBush_=new _RBush.default,r.GEOMETRY_SEGMENTERS_={Point:r.segmentPointGeometry_.bind(r),LineString:r.segmentLineStringGeometry_.bind(r),LinearRing:r.segmentLineStringGeometry_.bind(r),Polygon:r.segmentPolygonGeometry_.bind(r),MultiPoint:r.segmentMultiPointGeometry_.bind(r),MultiLineString:r.segmentMultiLineStringGeometry_.bind(r),MultiPolygon:r.segmentMultiPolygonGeometry_.bind(r),GeometryCollection:r.segmentGeometryCollectionGeometry_.bind(r),Circle:r.segmentCircleGeometry_.bind(r)},r}return _inherits(t,_Pointer["default"]),_createClass(t,[{key:"addFeature",value:function(e,t){t=void 0===t||t;var r=(0,_util.getUid)(e),n=e.getGeometry();if(n){var o=this.GEOMETRY_SEGMENTERS_[n.getType()];if(o){this.indexedFeaturesExtents_[r]=n.getExtent((0,_extent.createEmpty)());var i=[];if(o(i,n),1===i.length)this.rBush_.insert((0,_extent.boundingExtent)(i[0]),{feature:e,segment:i[0]});else if(i.length>1){var a=i.map(function(e){return(0,_extent.boundingExtent)(e)}),u=i.map(function(t){return{feature:e,segment:t}});this.rBush_.load(a,u)}}}t&&(this.featureChangeListenerKeys_[r]=(0,_events.listen)(e,_EventType.default.CHANGE,this.handleFeatureChange_,this))}},{key:"getFeatures_",value:function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e}},{key:"handleEvent",value:function(e){var r=this.snapTo(e.pixel,e.coordinate,e.map);return r&&(e.coordinate=r.vertex.slice(0,2),e.pixel=r.vertexPixel,this.dispatchEvent(new _SnapEvent.SnapEvent(_SnapEvent.SnapEventType.SNAP,{vertex:e.coordinate,vertexPixel:e.pixel,feature:r.feature,segment:r.segment}))),_get(_getPrototypeOf(t.prototype),"handleEvent",this).call(this,e)}},{key:"handleFeatureAdd_",value:function(e){var t=getFeatureFromEvent(e);t&&this.addFeature(t)}},{key:"handleFeatureRemove_",value:function(e){var t=getFeatureFromEvent(e);t&&this.removeFeature(t)}},{key:"handleFeatureChange_",value:function(e){var t=e.target;if(this.handlingDownUpSequence){var r=(0,_util.getUid)(t);r in this.pendingFeatures_||(this.pendingFeatures_[r]=t)}else this.updateFeature_(t)}},{key:"handleUpEvent",value:function(e){var t=Object.values(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}},{key:"removeFeature",value:function(e,t){var r=void 0===t||t,n=(0,_util.getUid)(e),o=this.indexedFeaturesExtents_[n];if(o){var i=this.rBush_,a=[];i.forEachInExtent(o,function(t){e===t.feature&&a.push(t)});for(var u=a.length-1;u>=0;--u)i.remove(a[u])}r&&((0,_events.unlistenByKey)(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])}},{key:"setMap",value:function(e){var r=this,n=this.getMap(),o=this.featuresListenerKeys_,i=this.getFeatures_();n&&(o.forEach(_events.unlistenByKey),o.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(_events.unlistenByKey),this.featureChangeListenerKeys_={}),_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),e&&(this.features_?o.push((0,_events.listen)(this.features_,_CollectionEventType.default.ADD,this.handleFeatureAdd_,this),(0,_events.listen)(this.features_,_CollectionEventType.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&o.push((0,_events.listen)(this.source_,_VectorEventType.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,_events.listen)(this.source_,_VectorEventType.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),i.forEach(function(e){return r.addFeature(e)}))}},{key:"snapTo",value:function(e,t,r){var n,o=r.getView().getProjection(),i=(0,_proj.fromUserCoordinate)(t,o),a=(0,_proj.toUserExtent)((0,_extent.buffer)((0,_extent.boundingExtent)([i]),r.getView().getResolution()*this.pixelTolerance_),o),u=this.rBush_.getInExtent(a),s=u.length;if(0===s)return null;var l,f=1/0,c=null,_=this.pixelTolerance_*this.pixelTolerance_,y=function(){if(n){var t=r.getPixelFromCoordinate(n);if((0,_coordinate.squaredDistance)(e,t)<=_)return{vertex:n,vertexPixel:[Math.round(t[0]),Math.round(t[1])],feature:l,segment:c}}return null};if(this.vertex_){for(var p=function(){var e=u[h];"Circle"!==e.feature.getGeometry().getType()&&e.segment.forEach(function(t){var r=(0,_proj.fromUserCoordinate)(t,o),a=(0,_coordinate.squaredDistance)(i,r);a<f&&(n=t,f=a,l=e.feature)})},h=0;h<s;++h)p();var v=y();if(v)return v}if(this.edge_){for(var g=0;g<s;++g){var d=null,m=u[g];if("Circle"===m.feature.getGeometry().getType()){var E=m.feature.getGeometry(),b=(0,_proj.getUserProjection)();b&&(E=E.clone().transform(b,o)),d=(0,_coordinate.closestOnCircle)(i,E)}else{var P=_slicedToArray(m.segment,2),C=P[0],T=P[1];T&&(tempSegment[0]=(0,_proj.fromUserCoordinate)(C,o),tempSegment[1]=(0,_proj.fromUserCoordinate)(T,o),d=(0,_coordinate.closestOnSegment)(i,tempSegment))}if(d){var j=(0,_coordinate.squaredDistance)(i,d);j<f&&(n=(0,_proj.toUserCoordinate)(d,o),c="Circle"===m.feature.getGeometry().getType()?null:m.segment,f=j,l=m.feature)}}var x=y();if(x)return x}return null}},{key:"updateFeature_",value:function(e){this.removeFeature(e,!1),this.addFeature(e,!1)}},{key:"segmentCircleGeometry_",value:function(e,t){var r=this.getMap().getView().getProjection(),n=t,o=(0,_proj.getUserProjection)();o&&(n=n.clone().transform(o,r));var i=(0,_Polygon.fromCircle)(n);o&&i.transform(r,o);for(var a=i.getCoordinates()[0],u=0,s=a.length-1;u<s;++u)e.push(a.slice(u,u+2))}},{key:"segmentGeometryCollectionGeometry_",value:function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var o=this.GEOMETRY_SEGMENTERS_[r[n].getType()];o&&o(e,r[n])}}},{key:"segmentLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length-1;n<o;++n)e.push(r.slice(n,n+2))}},{key:"segmentMultiLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,u=i.length-1;a<u;++a)e.push(i.slice(a,a+2))}},{key:"segmentMultiPointGeometry_",value:function(e,t){t.getCoordinates().forEach(function(t){e.push([t])})}},{key:"segmentMultiPolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,u=i.length;a<u;++a)for(var s=i[a],l=0,f=s.length-1;l<f;++l)e.push(s.slice(l,l+2))}},{key:"segmentPointGeometry_",value:function(e,t){e.push([t.getCoordinates()])}},{key:"segmentPolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,u=i.length-1;a<u;++a)e.push(i.slice(a,a+2))}}])}(),_default=exports.default=Snap;

},{"../CollectionEventType.js":79,"../coordinate.js":128,"../events.js":132,"../events/EventType.js":134,"../events/SnapEvent.js":136,"../extent.js":142,"../functions.js":200,"../geom/Polygon.js":211,"../proj.js":283,"../source/VectorEventType.js":368,"../structs/RBush.js":383,"../util.js":404,"./Pointer.js":254}],258:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TranslateEvent=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_Property=_interopRequireDefault(require("./Property.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_functions=require("../functions.js"),_condition=require("../events/condition.js"),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TranslateEventType={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},TranslateEvent=exports.TranslateEvent=function(e){function t(e,r,n,o,i){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e])).features=r,a.coordinate=n,a.startCoordinate=o,a.mapBrowserEvent=i,a}return _inherits(t,_Event2["default"]),_createClass(t)}(),Translate=function(e){function t(e){var r,n;if(_classCallCheck(this,t),(r=_callSuper(this,t,[e=e||{}])).on,r.once,r.un,r.lastCoordinate_=null,r.startCoordinate_=null,r.features_=void 0!==e.features?e.features:null,e.layers&&!r.features_)if("function"==typeof e.layers)n=e.layers;else{var o=e.layers;n=function(e){return o.includes(e)}}else n=_functions.TRUE;return r.layerFilter_=n,r.filter_=e.filter&&!r.features_?e.filter:_functions.TRUE,r.hitTolerance_=e.hitTolerance?e.hitTolerance:0,r.condition_=e.condition?e.condition:_condition.always,r.lastFeature_=null,r.addChangeListener(_Property.default.ACTIVE,r.handleActiveChanged_),r}return _inherits(t,_Pointer["default"]),_createClass(t,[{key:"handleDownEvent",value:function(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);var t=this.features_||new _Collection.default([this.lastFeature_]);return this.dispatchEvent(new TranslateEvent(TranslateEventType.TRANSLATESTART,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}},{key:"handleUpEvent",value:function(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);var t=this.features_||new _Collection.default([this.lastFeature_]);return this.dispatchEvent(new TranslateEvent(TranslateEventType.TRANSLATEEND,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}},{key:"handleDragEvent",value:function(e){if(this.lastCoordinate_){var t=e.coordinate,r=e.map.getView().getProjection(),n=(0,_proj.fromUserCoordinate)(t,r),o=(0,_proj.fromUserCoordinate)(this.lastCoordinate_,r),i=n[0]-o[0],a=n[1]-o[1],s=this.features_||new _Collection.default([this.lastFeature_]),l=(0,_proj.getUserProjection)();s.forEach(function(e){var t=e.getGeometry();l?(t.transform(l,r),t.translate(i,a),t.transform(r,l)):t.translate(i,a),e.setGeometry(t)}),this.lastCoordinate_=t,this.dispatchEvent(new TranslateEvent(TranslateEventType.TRANSLATING,s,t,this.startCoordinate_,e))}}},{key:"handleMoveEvent",value:function(e){var t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}},{key:"featuresAtPixel_",value:function(e,t){var r=this;return t.forEachFeatureAtPixel(e,function(e,t){if(e instanceof _Feature.default&&r.filter_(e,t)&&(!r.features_||r.features_.getArray().includes(e)))return e},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"setHitTolerance",value:function(e){this.hitTolerance_=e}},{key:"setMap",value:function(e){var r=this.getMap();_get(_getPrototypeOf(t.prototype),"setMap",this).call(this,e),this.updateState_(r)}},{key:"handleActiveChanged_",value:function(){this.updateState_(null)}},{key:"updateState_",value:function(e){var t=this.getMap(),r=this.getActive();t&&r||(t=t||e)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")}}])}(),_default=exports.default=Translate;

},{"../Collection.js":78,"../Feature.js":82,"../events/Event.js":133,"../events/condition.js":138,"../functions.js":200,"../proj.js":283,"./Pointer.js":254,"./Property.js":255}],259:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=defaults;var _Collection=_interopRequireDefault(require("../Collection.js")),_DoubleClickZoom=_interopRequireDefault(require("./DoubleClickZoom.js")),_DragPan=_interopRequireDefault(require("./DragPan.js")),_DragRotate=_interopRequireDefault(require("./DragRotate.js")),_DragZoom=_interopRequireDefault(require("./DragZoom.js")),_KeyboardPan=_interopRequireDefault(require("./KeyboardPan.js")),_KeyboardZoom=_interopRequireDefault(require("./KeyboardZoom.js")),_Kinetic=_interopRequireDefault(require("../Kinetic.js")),_MouseWheelZoom=_interopRequireDefault(require("./MouseWheelZoom.js")),_PinchRotate=_interopRequireDefault(require("./PinchRotate.js")),_PinchZoom=_interopRequireDefault(require("./PinchZoom.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function defaults(e){e=e||{};var o=new _Collection.default,t=new _Kinetic.default(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&o.push(new _DragRotate.default),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&o.push(new _DoubleClickZoom.default({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&o.push(new _DragPan.default({onFocusOnly:e.onFocusOnly,kinetic:t})),(void 0===e.pinchRotate||e.pinchRotate)&&o.push(new _PinchRotate.default),(void 0===e.pinchZoom||e.pinchZoom)&&o.push(new _PinchZoom.default({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(o.push(new _KeyboardPan.default),o.push(new _KeyboardZoom.default({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&o.push(new _MouseWheelZoom.default({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&o.push(new _DragZoom.default({duration:e.zoomDuration})),o}

},{"../Collection.js":78,"../Kinetic.js":88,"./DoubleClickZoom.js":237,"./DragPan.js":240,"./DragRotate.js":241,"./DragZoom.js":243,"./KeyboardPan.js":247,"./KeyboardZoom.js":248,"./MouseWheelZoom.js":251,"./PinchRotate.js":252,"./PinchZoom.js":253}],260:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Graticule",{enumerable:!0,get:function(){return _Graticule.default}}),Object.defineProperty(exports,"Group",{enumerable:!0,get:function(){return _Group.default}}),Object.defineProperty(exports,"Heatmap",{enumerable:!0,get:function(){return _Heatmap.default}}),Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return _Image.default}}),Object.defineProperty(exports,"Layer",{enumerable:!0,get:function(){return _Layer.default}}),Object.defineProperty(exports,"Tile",{enumerable:!0,get:function(){return _Tile.default}}),Object.defineProperty(exports,"Vector",{enumerable:!0,get:function(){return _Vector.default}}),Object.defineProperty(exports,"VectorImage",{enumerable:!0,get:function(){return _VectorImage.default}}),Object.defineProperty(exports,"VectorTile",{enumerable:!0,get:function(){return _VectorTile.default}}),Object.defineProperty(exports,"WebGLPoints",{enumerable:!0,get:function(){return _WebGLPoints.default}}),Object.defineProperty(exports,"WebGLTile",{enumerable:!0,get:function(){return _WebGLTile.default}});var _Graticule=_interopRequireDefault(require("./layer/Graticule.js")),_Group=_interopRequireDefault(require("./layer/Group.js")),_Heatmap=_interopRequireDefault(require("./layer/Heatmap.js")),_Image=_interopRequireDefault(require("./layer/Image.js")),_Layer=_interopRequireDefault(require("./layer/Layer.js")),_Tile=_interopRequireDefault(require("./layer/Tile.js")),_Vector=_interopRequireDefault(require("./layer/Vector.js")),_VectorImage=_interopRequireDefault(require("./layer/VectorImage.js")),_VectorTile=_interopRequireDefault(require("./layer/VectorTile.js")),_WebGLPoints=_interopRequireDefault(require("./layer/WebGLPoints.js")),_WebGLTile=_interopRequireDefault(require("./layer/WebGLTile.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./layer/Graticule.js":265,"./layer/Group.js":266,"./layer/Heatmap.js":267,"./layer/Image.js":268,"./layer/Layer.js":269,"./layer/Tile.js":271,"./layer/Vector.js":273,"./layer/VectorImage.js":274,"./layer/VectorTile.js":275,"./layer/WebGLPoints.js":276,"./layer/WebGLTile.js":277}],261:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_Property=_interopRequireDefault(require("./Property.js")),_util=require("../util.js"),_asserts=require("../asserts.js"),_math=require("../math.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseLayer=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,r.background_=e.background;var o=Object.assign({},e);return"object"===_typeof(e.properties)&&(delete o.properties,Object.assign(o,e.properties)),o[_Property.default.OPACITY]=void 0!==e.opacity?e.opacity:1,(0,_asserts.assert)("number"==typeof o[_Property.default.OPACITY],"Layer opacity must be a number"),o[_Property.default.VISIBLE]=void 0===e.visible||e.visible,o[_Property.default.Z_INDEX]=e.zIndex,o[_Property.default.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,o[_Property.default.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,o[_Property.default.MIN_ZOOM]=void 0!==e.minZoom?e.minZoom:-1/0,o[_Property.default.MAX_ZOOM]=void 0!==e.maxZoom?e.maxZoom:1/0,r.className_=void 0!==o.className?o.className:"ol-layer",delete o.className,r.setProperties(o),r.state_=null,r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(e){var t=this.state_||{layer:this,managed:void 0===e||e},r=this.getZIndex();return t.opacity=(0,_math.clamp)(Math.round(100*this.getOpacity())/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0!==r||t.managed?r:1/0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}},{key:"getLayersArray",value:function(e){return(0,_util.abstract)()}},{key:"getLayerStatesArray",value:function(e){return(0,_util.abstract)()}},{key:"getExtent",value:function(){return this.get(_Property.default.EXTENT)}},{key:"getMaxResolution",value:function(){return this.get(_Property.default.MAX_RESOLUTION)}},{key:"getMinResolution",value:function(){return this.get(_Property.default.MIN_RESOLUTION)}},{key:"getMinZoom",value:function(){return this.get(_Property.default.MIN_ZOOM)}},{key:"getMaxZoom",value:function(){return this.get(_Property.default.MAX_ZOOM)}},{key:"getOpacity",value:function(){return this.get(_Property.default.OPACITY)}},{key:"getSourceState",value:function(){return(0,_util.abstract)()}},{key:"getVisible",value:function(){return this.get(_Property.default.VISIBLE)}},{key:"getZIndex",value:function(){return this.get(_Property.default.Z_INDEX)}},{key:"setBackground",value:function(e){this.background_=e,this.changed()}},{key:"setExtent",value:function(e){this.set(_Property.default.EXTENT,e)}},{key:"setMaxResolution",value:function(e){this.set(_Property.default.MAX_RESOLUTION,e)}},{key:"setMinResolution",value:function(e){this.set(_Property.default.MIN_RESOLUTION,e)}},{key:"setMaxZoom",value:function(e){this.set(_Property.default.MAX_ZOOM,e)}},{key:"setMinZoom",value:function(e){this.set(_Property.default.MIN_ZOOM,e)}},{key:"setOpacity",value:function(e){(0,_asserts.assert)("number"==typeof e,"Layer opacity must be a number"),this.set(_Property.default.OPACITY,e)}},{key:"setVisible",value:function(e){this.set(_Property.default.VISIBLE,e)}},{key:"setZIndex",value:function(e){this.set(_Property.default.Z_INDEX,e)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}(),_default=exports.default=BaseLayer;

},{"../Object.js":96,"../asserts.js":111,"../math.js":279,"../util.js":404,"./Property.js":270}],262:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseImageLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e=e||{}])}return _inherits(t,_Layer2["default"]),_createClass(t)}(),_default=exports.default=BaseImageLayer;

},{"./Layer.js":269}],263:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js")),_TileProperty=_interopRequireDefault(require("./TileProperty.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseTileLayer=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var o=Object.assign({},e);return delete o.preload,delete o.useInterimTilesOnError,(r=_callSuper(this,t,[o])).on,r.once,r.un,r.setPreload(void 0!==e.preload?e.preload:0),r.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),r}return _inherits(t,_Layer2["default"]),_createClass(t,[{key:"getPreload",value:function(){return this.get(_TileProperty.default.PRELOAD)}},{key:"setPreload",value:function(e){this.set(_TileProperty.default.PRELOAD,e)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(_TileProperty.default.USE_INTERIM_TILES_ON_ERROR)}},{key:"setUseInterimTilesOnError",value:function(e){this.set(_TileProperty.default.USE_INTERIM_TILES_ON_ERROR,e)}},{key:"getData",value:function(e){return _get(_getPrototypeOf(t.prototype),"getData",this).call(this,e)}}])}(),_default=exports.default=BaseTileLayer;

},{"./Layer.js":269,"./TileProperty.js":272}],264:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js")),_rbush=_interopRequireDefault(require("rbush")),_Style=_interopRequireWildcard(require("../style/Style.js")),_style=require("../render/canvas/style.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Property={RENDER_ORDER:"renderOrder"},BaseVectorLayer=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var n=Object.assign({},e);return delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,(r=_callSuper(this,t,[n])).declutter_=e.declutter?String(e.declutter):void 0,r.renderBuffer_=void 0!==e.renderBuffer?e.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(e.style),r.updateWhileAnimating_=void 0!==e.updateWhileAnimating&&e.updateWhileAnimating,r.updateWhileInteracting_=void 0!==e.updateWhileInteracting&&e.updateWhileInteracting,r}return _inherits(t,_Layer2["default"]),_createClass(t,[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(e){return _get(_getPrototypeOf(t.prototype),"getFeatures",this).call(this,e)}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(Property.RENDER_ORDER)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(e,t){var r=this.getDeclutter();r in e.declutter==!1&&(e.declutter[r]=new _rbush.default(9)),this.getRenderer().renderDeclutter(e,t)}},{key:"setRenderOrder",value:function(e){this.set(Property.RENDER_ORDER,e)}},{key:"setStyle",value:function(e){this.style_=void 0===e?_Style.createDefaultStyle:e;var t=toStyleLike(e);this.styleFunction_=null===e?void 0:(0,_Style.toFunction)(t),this.changed()}}])}();function toStyleLike(e){if(void 0===e)return _Style.createDefaultStyle;if(!e)return null;if("function"==typeof e)return e;if(e instanceof _Style.default)return e;if(!Array.isArray(e))return(0,_style.flatStylesToStyleFunction)([e]);if(0===e.length)return[];var t=e.length,r=e[0];if(r instanceof _Style.default){for(var n=new Array(t),o=0;o<t;++o){var i=e[o];if(!(i instanceof _Style.default))throw new Error("Expected a list of style instances");n[o]=i}return n}if("style"in r){for(var u=new Array(t),l=0;l<t;++l){var a=e[l];if(!("style"in a))throw new Error("Expected a list of rules with a style property");u[l]=a}return(0,_style.rulesToStyleFunction)(u)}var f=e;return(0,_style.flatStylesToStyleFunction)(f)}var _default=exports.default=BaseVectorLayer;

},{"../render/canvas/style.js":310,"../style/Style.js":393,"./Layer.js":269,"rbush":427}],265:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_EventType=_interopRequireDefault(require("../render/EventType.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_Fill=_interopRequireDefault(require("../style/Fill.js")),_LineString=_interopRequireDefault(require("../geom/LineString.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Stroke=_interopRequireDefault(require("../style/Stroke.js")),_Style=_interopRequireDefault(require("../style/Style.js")),_Text=_interopRequireDefault(require("../style/Text.js")),_Vector=_interopRequireDefault(require("./Vector.js")),_Vector2=_interopRequireDefault(require("../source/Vector.js")),_extent=require("../extent.js"),_math=require("../math.js"),_coordinate=require("../coordinate.js"),_proj=require("../proj.js"),_render=require("../render.js"),_geodesic=require("../geom/flat/geodesic.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,a){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,a||[],_getPrototypeOf(t).constructor):e.apply(t,a))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DEFAULT_STROKE_STYLE=new _Stroke.default({color:"rgba(0,0,0,0.2)"}),INTERVALS=[90,45,30,20,10,5,2,1,.5,20/60,10/60,5/60,2/60,1/60,30/3600,20/3600,10/3600,5/3600,2/3600,1/3600],Graticule=function(t){function e(t){var a;_classCallCheck(this,e),t=t||{};var i=Object.assign({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},t);return delete i.maxLines,delete i.strokeStyle,delete i.targetSize,delete i.showLabels,delete i.lonLabelFormatter,delete i.latLabelFormatter,delete i.lonLabelPosition,delete i.latLabelPosition,delete i.lonLabelStyle,delete i.latLabelStyle,delete i.intervals,(a=_callSuper(this,e,[i])).projection_=null,a.maxLat_=1/0,a.maxLon_=1/0,a.minLat_=-1/0,a.minLon_=-1/0,a.maxX_=1/0,a.maxY_=1/0,a.minX_=-1/0,a.minY_=-1/0,a.targetSize_=void 0!==t.targetSize?t.targetSize:100,a.maxLines_=void 0!==t.maxLines?t.maxLines:100,a.meridians_=[],a.parallels_=[],a.strokeStyle_=void 0!==t.strokeStyle?t.strokeStyle:DEFAULT_STROKE_STYLE,a.fromLonLatTransform_=void 0,a.toLonLatTransform_=void 0,a.projectionCenterLonLat_=null,a.bottomLeft_=null,a.bottomRight_=null,a.topLeft_=null,a.topRight_=null,a.meridiansLabels_=null,a.parallelsLabels_=null,t.showLabels&&(a.lonLabelFormatter_=null==t.lonLabelFormatter?_coordinate.degreesToStringHDMS.bind(a,"EW"):t.lonLabelFormatter,a.latLabelFormatter_=null==t.latLabelFormatter?_coordinate.degreesToStringHDMS.bind(a,"NS"):t.latLabelFormatter,a.lonLabelPosition_=null==t.lonLabelPosition?0:t.lonLabelPosition,a.latLabelPosition_=null==t.latLabelPosition?1:t.latLabelPosition,a.lonLabelStyleBase_=new _Style.default({text:void 0!==t.lonLabelStyle?t.lonLabelStyle.clone():new _Text.default({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new _Fill.default({color:"rgba(0,0,0,1)"}),stroke:new _Stroke.default({color:"rgba(255,255,255,1)",width:3})})}),a.lonLabelStyle_=function(t){var e=t.get("graticule_label");return a.lonLabelStyleBase_.getText().setText(e),a.lonLabelStyleBase_},a.latLabelStyleBase_=new _Style.default({text:void 0!==t.latLabelStyle?t.latLabelStyle.clone():new _Text.default({font:"12px Calibri,sans-serif",textAlign:"right",fill:new _Fill.default({color:"rgba(0,0,0,1)"}),stroke:new _Stroke.default({color:"rgba(255,255,255,1)",width:3})})}),a.latLabelStyle_=function(t){var e=t.get("graticule_label");return a.latLabelStyleBase_.getText().setText(e),a.latLabelStyleBase_},a.meridiansLabels_=[],a.parallelsLabels_=[],a.addEventListener(_EventType.default.POSTRENDER,a.drawLabels_.bind(a))),a.intervals_=void 0!==t.intervals?t.intervals:INTERVALS,a.setSource(new _Vector2.default({loader:a.loaderFunction.bind(a),strategy:a.strategyFunction.bind(a),features:new _Collection.default,overlaps:!1,useSpatialIndex:!1,wrapX:t.wrapX})),a.featurePool_=[],a.lineStyle_=new _Style.default({stroke:a.strokeStyle_}),a.loadedExtent_=null,a.renderedExtent_=null,a.renderedResolution_=null,a.setRenderOrder(null),a}return _inherits(e,_Vector["default"]),_createClass(e,[{key:"strategyFunction",value:function(t,e){var a=t.slice();return this.projection_&&this.getSource().getWrapX()&&(0,_extent.wrapX)(a,this.projection_),this.loadedExtent_&&((0,_extent.approximatelyEquals)(this.loadedExtent_,a,e)?a=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[a]}},{key:"loaderFunction",value:function(t,e,a){this.loadedExtent_=t;var i=this.getSource(),r=this.getExtent()||[-1/0,-1/0,1/0,1/0],n=(0,_extent.getIntersection)(r,t);if(!(this.renderedExtent_&&(0,_extent.equals)(this.renderedExtent_,n)&&this.renderedResolution_===e||(this.renderedExtent_=n,this.renderedResolution_=e,(0,_extent.isEmpty)(n)))){var o=(0,_extent.getCenter)(n),l=e*e/4;(!this.projection_||!(0,_proj.equivalent)(this.projection_,a))&&this.updateProjectionInfo_(a),this.createGraticule_(n,o,e,l);var s,_=this.meridians_.length+this.parallels_.length;for(this.meridiansLabels_&&(_+=this.meridians_.length),this.parallelsLabels_&&(_+=this.parallels_.length);_>this.featurePool_.length;)s=new _Feature.default,this.featurePool_.push(s);var h=i.getFeaturesCollection();h.clear();var u,m,f=0;for(u=0,m=this.meridians_.length;u<m;++u)(s=this.featurePool_[f++]).setGeometry(this.meridians_[u]),s.setStyle(this.lineStyle_),h.push(s);for(u=0,m=this.parallels_.length;u<m;++u)(s=this.featurePool_[f++]).setGeometry(this.parallels_[u]),s.setStyle(this.lineStyle_),h.push(s)}}},{key:"addMeridian_",value:function(t,e,a,i,r,n){var o=this.getMeridian_(t,e,a,i,n);if((0,_extent.intersects)(o.getExtent(),r)){if(this.meridiansLabels_){var l=this.lonLabelFormatter_(t);n in this.meridiansLabels_?this.meridiansLabels_[n].text=l:this.meridiansLabels_[n]={geom:new _Point.default([]),text:l}}this.meridians_[n++]=o}return n}},{key:"addParallel_",value:function(t,e,a,i,r,n){var o=this.getParallel_(t,e,a,i,n);if((0,_extent.intersects)(o.getExtent(),r)){if(this.parallelsLabels_){var l=this.latLabelFormatter_(t);n in this.parallelsLabels_?this.parallelsLabels_[n].text=l:this.parallelsLabels_[n]={geom:new _Point.default([]),text:l}}this.parallels_[n++]=o}return n}},{key:"drawLabels_",value:function(t){var e=t.frameState.viewState.rotation,a=t.frameState.viewState.resolution,i=t.frameState.size,r=t.frameState.extent,n=(0,_extent.getCenter)(r),o=r;if(e){var l=i[0]*a,s=i[1]*a;o=[n[0]-l/2,n[1]-s/2,n[0]+l/2,n[1]+s/2]}var _=0,h=0,u=this.latLabelPosition_<.5,m=this.projection_.getExtent(),f=(0,_extent.getWidth)(m);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,_extent.containsExtent)(m,r)&&(_=Math.floor((r[0]-m[0])/f),h=Math.ceil((r[2]-m[2])/f),u=u!==Math.abs(e)>Math.PI/2);for(var d=(0,_render.getVectorContext)(t),c=_;c<=h;++c){var L=this.meridians_.length+this.parallels_.length,p=void 0,b=void 0,g=void 0,x=void 0;if(this.meridiansLabels_)for(b=0,g=this.meridiansLabels_.length;b<g;++b){var y=this.meridians_[b];if(e||0!==c){var v=y.clone();v.translate(c*f,0),v.rotate(-e,n),(x=this.getMeridianPoint_(v,o,b)).rotate(e,n)}else x=this.getMeridianPoint_(y,r,b);(p=this.featurePool_[L++]).setGeometry(x),p.set("graticule_label",this.meridiansLabels_[b].text),d.drawFeature(p,this.lonLabelStyle_(p))}if(this.parallelsLabels_&&(c===_&&u||c===h&&!u))for(b=0,g=this.parallels_.length;b<g;++b){var S=this.parallels_[b];if(e||0!==c){var P=S.clone();P.translate(c*f,0),P.rotate(-e,n),(x=this.getParallelPoint_(P,o,b)).rotate(e,n)}else x=this.getParallelPoint_(S,r,b);(p=this.featurePool_[L++]).setGeometry(x),p.set("graticule_label",this.parallelsLabels_[b].text),d.drawFeature(p,this.latLabelStyle_(p))}}}},{key:"createGraticule_",value:function(t,e,a,i){var r=this.getInterval_(a);if(-1==r)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var n=!1,o=this.projection_.getExtent(),l=(0,_extent.getWidth)(o);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,_extent.containsExtent)(o,t)&&((0,_extent.getWidth)(t)>=l?(t[0]=o[0],t[2]=o[2]):n=!0);var s=[(0,_math.clamp)(e[0],this.minX_,this.maxX_),(0,_math.clamp)(e[1],this.minY_,this.maxY_)],_=this.toLonLatTransform_(s);isNaN(_[1])&&(_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);var h,u,m,f,d=(0,_math.clamp)(_[0],this.minLon_,this.maxLon_),c=(0,_math.clamp)(_[1],this.minLat_,this.maxLat_),L=this.maxLines_,p=t;n||(p=[(0,_math.clamp)(t[0],this.minX_,this.maxX_),(0,_math.clamp)(t[1],this.minY_,this.maxY_),(0,_math.clamp)(t[2],this.minX_,this.maxX_),(0,_math.clamp)(t[3],this.minY_,this.maxY_)]);var b=(0,_extent.applyTransform)(p,this.toLonLatTransform_,void 0,8),g=b[3],x=b[2],y=b[1],v=b[0];if(n||((0,_extent.containsCoordinate)(p,this.bottomLeft_)&&(v=this.minLon_,y=this.minLat_),(0,_extent.containsCoordinate)(p,this.bottomRight_)&&(x=this.maxLon_,y=this.minLat_),(0,_extent.containsCoordinate)(p,this.topLeft_)&&(v=this.minLon_,g=this.maxLat_),(0,_extent.containsCoordinate)(p,this.topRight_)&&(x=this.maxLon_,g=this.maxLat_),g=(0,_math.clamp)(g,c,this.maxLat_),x=(0,_math.clamp)(x,d,this.maxLon_),y=(0,_math.clamp)(y,this.minLat_,c),v=(0,_math.clamp)(v,this.minLon_,d)),d=Math.floor(d/r)*r,f=(0,_math.clamp)(d,this.minLon_,this.maxLon_),u=this.addMeridian_(f,y,g,i,t,0),h=0,n)for(;(f-=r)>=v&&h++<L;)u=this.addMeridian_(f,y,g,i,t,u);else for(;f!=this.minLon_&&h++<L;)f=Math.max(f-r,this.minLon_),u=this.addMeridian_(f,y,g,i,t,u);if(f=(0,_math.clamp)(d,this.minLon_,this.maxLon_),h=0,n)for(;(f+=r)<=x&&h++<L;)u=this.addMeridian_(f,y,g,i,t,u);else for(;f!=this.maxLon_&&h++<L;)f=Math.min(f+r,this.maxLon_),u=this.addMeridian_(f,y,g,i,t,u);for(this.meridians_.length=u,this.meridiansLabels_&&(this.meridiansLabels_.length=u),c=Math.floor(c/r)*r,m=(0,_math.clamp)(c,this.minLat_,this.maxLat_),u=this.addParallel_(m,v,x,i,t,0),h=0;m!=this.minLat_&&h++<L;)m=Math.max(m-r,this.minLat_),u=this.addParallel_(m,v,x,i,t,u);for(m=(0,_math.clamp)(c,this.minLat_,this.maxLat_),h=0;m!=this.maxLat_&&h++<L;)m=Math.min(m+r,this.maxLat_),u=this.addParallel_(m,v,x,i,t,u);this.parallels_.length=u,this.parallelsLabels_&&(this.parallelsLabels_.length=u)}},{key:"getInterval_",value:function(t){for(var e=this.projectionCenterLonLat_[0],a=this.projectionCenterLonLat_[1],i=-1,r=Math.pow(this.targetSize_*t,2),n=[],o=[],l=0,s=this.intervals_.length;l<s;++l){var _=(0,_math.clamp)(this.intervals_[l]/2,0,90),h=(0,_math.clamp)(a,-90+_,90-_);if(n[0]=e-_,n[1]=h-_,o[0]=e+_,o[1]=h+_,this.fromLonLatTransform_(n,n),this.fromLonLatTransform_(o,o),Math.pow(o[0]-n[0],2)+Math.pow(o[1]-n[1],2)<=r)break;i=this.intervals_[l]}return i}},{key:"getMeridian_",value:function(t,e,a,i,r){var n=(0,_geodesic.meridian)(t,e,a,this.projection_,i),o=this.meridians_[r];return o?(o.setFlatCoordinates("XY",n),o.changed()):(o=new _LineString.default(n,"XY"),this.meridians_[r]=o),o}},{key:"getMeridianPoint_",value:function(t,e,a){var i=t.getFlatCoordinates(),r=1,n=i.length-1;i[r]>i[n]&&(r=n,n=1);var o=Math.max(e[1],i[r]),l=Math.min(e[3],i[n]),s=(0,_math.clamp)(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,o,l),_=[i[r-1]+(i[n-1]-i[r-1])*(s-i[r])/(i[n]-i[r]),s],h=this.meridiansLabels_[a].geom;return h.setCoordinates(_),h}},{key:"getMeridians",value:function(){return this.meridians_}},{key:"getParallel_",value:function(t,e,a,i,r){var n=(0,_geodesic.parallel)(t,e,a,this.projection_,i),o=this.parallels_[r];return o?(o.setFlatCoordinates("XY",n),o.changed()):o=new _LineString.default(n,"XY"),o}},{key:"getParallelPoint_",value:function(t,e,a){var i=t.getFlatCoordinates(),r=0,n=i.length-2;i[r]>i[n]&&(r=n,n=0);var o=Math.max(e[0],i[r]),l=Math.min(e[2],i[n]),s=(0,_math.clamp)(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,o,l),_=[s,i[r+1]+(i[n+1]-i[r+1])*(s-i[r])/(i[n]-i[r])],h=this.parallelsLabels_[a].geom;return h.setCoordinates(_),h}},{key:"getParallels",value:function(){return this.parallels_}},{key:"updateProjectionInfo_",value:function(t){var e=(0,_proj.get)("EPSG:4326"),a=t.getWorldExtent();this.maxLat_=a[3],this.maxLon_=a[2],this.minLat_=a[1],this.minLon_=a[0];var i=(0,_proj.getTransform)(t,e);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=i;else{var r=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(t,e,a){for(var n=i(t,e,a=a||2),o=0,l=n.length;o<l;o+=a)n[o]<r&&(n[o]+=360);return n}}this.fromLonLatTransform_=(0,_proj.getTransform)(e,t);var n=(0,_extent.applyTransform)([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=n[0],this.maxX_=n[2],this.minY_=n[1],this.maxY_=n[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_((0,_extent.getCenter)(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t}}])}(),_default=exports.default=Graticule;

},{"../Collection.js":78,"../Feature.js":82,"../coordinate.js":128,"../extent.js":142,"../geom/LineString.js":205,"../geom/Point.js":210,"../geom/flat/geodesic.js":219,"../math.js":279,"../proj.js":283,"../render.js":291,"../render/EventType.js":294,"../source/Vector.js":367,"../style/Fill.js":386,"../style/Stroke.js":392,"../style/Style.js":393,"../style/Text.js":394,"./Vector.js":273}],266:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.GroupEvent=void 0;var _Base=_interopRequireDefault(require("./Base.js")),_Collection=_interopRequireDefault(require("../Collection.js")),_CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_asserts=require("../asserts.js"),_obj=require("../obj.js"),_extent=require("../extent.js"),_util=require("../util.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GroupEvent=exports.GroupEvent=function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).layer=r,n}return _inherits(t,_Event2["default"]),_createClass(t)}(),Property={LAYERS:"layers"},LayerGroup=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var n=Object.assign({},e);delete n.layers;var o=e.layers;return(r=_callSuper(this,t,[n])).on,r.once,r.un,r.layersListenerKeys_=[],r.listenerKeys_={},r.addChangeListener(Property.LAYERS,r.handleLayersChanged_),o?Array.isArray(o)?o=new _Collection.default(o.slice(),{unique:!0}):(0,_asserts.assert)("function"==typeof o.getArray,"Expected `layers` to be an array or a `Collection`"):o=new _Collection.default(void 0,{unique:!0}),r.setLayers(o),r}return _inherits(t,_Base["default"]),_createClass(t,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(_events.unlistenByKey),this.layersListenerKeys_.length=0;var e=this.getLayers();for(var t in this.layersListenerKeys_.push((0,_events.listen)(e,_CollectionEventType.default.ADD,this.handleLayersAdd_,this),(0,_events.listen)(e,_CollectionEventType.default.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(_events.unlistenByKey);(0,_obj.clear)(this.listenerKeys_);for(var r=e.getArray(),n=0,o=r.length;n<o;n++){var i=r[n];this.registerLayerListeners_(i),this.dispatchEvent(new GroupEvent("addlayer",i))}this.changed()}},{key:"registerLayerListeners_",value:function(e){var r=[(0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,_events.listen)(e,_EventType.default.CHANGE,this.handleLayerChange_,this)];e instanceof t&&r.push((0,_events.listen)(e,"addlayer",this.handleLayerGroupAdd_,this),(0,_events.listen)(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,_util.getUid)(e)]=r}},{key:"handleLayerGroupAdd_",value:function(e){this.dispatchEvent(new GroupEvent("addlayer",e.layer))}},{key:"handleLayerGroupRemove_",value:function(e){this.dispatchEvent(new GroupEvent("removelayer",e.layer))}},{key:"handleLayersAdd_",value:function(e){var t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new GroupEvent("addlayer",t)),this.changed()}},{key:"handleLayersRemove_",value:function(e){var t=e.element,r=(0,_util.getUid)(t);this.listenerKeys_[r].forEach(_events.unlistenByKey),delete this.listenerKeys_[r],this.dispatchEvent(new GroupEvent("removelayer",t)),this.changed()}},{key:"getLayers",value:function(){return this.get(Property.LAYERS)}},{key:"setLayers",value:function(e){var t=this.getLayers();if(t)for(var r=t.getArray(),n=0,o=r.length;n<o;++n)this.dispatchEvent(new GroupEvent("removelayer",r[n]));this.set(Property.LAYERS,e)}},{key:"getLayersArray",value:function(e){return e=void 0!==e?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}},{key:"getLayerStatesArray",value:function(e){var t=void 0!==e?e:[],r=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});var n=this.getLayerState(),o=n.zIndex;e||void 0!==n.zIndex||(o=0);for(var i=r,s=t.length;i<s;i++){var a=t[i];a.opacity*=n.opacity,a.visible=a.visible&&n.visible,a.maxResolution=Math.min(a.maxResolution,n.maxResolution),a.minResolution=Math.max(a.minResolution,n.minResolution),a.minZoom=Math.max(a.minZoom,n.minZoom),a.maxZoom=Math.min(a.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==a.extent?a.extent=(0,_extent.getIntersection)(a.extent,n.extent):a.extent=n.extent),void 0===a.zIndex&&(a.zIndex=o)}return t}},{key:"getSourceState",value:function(){return"ready"}}])}(),_default=exports.default=LayerGroup;

},{"../Collection.js":78,"../CollectionEventType.js":79,"../ObjectEventType.js":97,"../asserts.js":111,"../events.js":132,"../events/Event.js":133,"../events/EventType.js":134,"../extent.js":142,"../obj.js":281,"../util.js":404,"./Base.js":261}],267:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector2=_interopRequireDefault(require("./BaseVector.js")),_PointsLayer=_interopRequireDefault(require("../renderer/webgl/PointsLayer.js")),_ShaderBuilder=require("../webgl/ShaderBuilder.js"),_math=require("../math.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Property={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},DEFAULT_GRADIENT=["#00f","#0ff","#0f0","#ff0","#f00"],Heatmap=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var o=Object.assign({},e);delete o.gradient,delete o.radius,delete o.blur,delete o.weight,(r=_callSuper(this,t,[o])).gradient_=null,r.addChangeListener(Property.GRADIENT,r.handleGradientChanged_),r.setGradient(e.gradient?e.gradient:DEFAULT_GRADIENT),r.setBlur(void 0!==e.blur?e.blur:15),r.setRadius(void 0!==e.radius?e.radius:8);var n=e.weight?e.weight:"weight";return r.weightFunction_="string"==typeof n?function(e){return e.get(n)}:n,r.setRenderOrder(null),r}return _inherits(t,_BaseVector2["default"]),_createClass(t,[{key:"getBlur",value:function(){return this.get(Property.BLUR)}},{key:"getGradient",value:function(){return this.get(Property.GRADIENT)}},{key:"getRadius",value:function(){return this.get(Property.RADIUS)}},{key:"handleGradientChanged_",value:function(){this.gradient_=createGradient(this.getGradient())}},{key:"setBlur",value:function(e){this.set(Property.BLUR,e)}},{key:"setGradient",value:function(e){this.set(Property.GRADIENT,e)}},{key:"setRadius",value:function(e){this.set(Property.RADIUS,e)}},{key:"createRenderer",value:function(){var e=this,t=(new _ShaderBuilder.ShaderBuilder).addAttribute("float a_prop_weight").addVarying("v_prop_weight","float","a_prop_weight").addUniform("float u_size").addUniform("float u_blurSlope").setSymbolSizeExpression("vec2(u_size)").setSymbolColorExpression("vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * u_blurSlope) * v_prop_weight)");return new _PointsLayer.default(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(t){var r=e.weightFunction_(t);return void 0!==r?(0,_math.clamp)(r,0,1):1}}],uniforms:{u_size:function(){return 2*(e.get(Property.RADIUS)+e.get(Property.BLUR))},u_blurSlope:function(){return e.get(Property.RADIUS)/Math.max(1,e.get(Property.BLUR))}},hitDetectionEnabled:!0,vertexShader:t.getSymbolVertexShader(),fragmentShader:t.getSymbolFragmentShader(),postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n            uniform float u_opacity;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a * u_opacity;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return e.gradient_},u_opacity:function(){return e.getOpacity()}}}]})}},{key:"renderDeclutter",value:function(){}}])}();function createGradient(e){for(var t=(0,_dom.createCanvasContext2D)(1,256),r=t.createLinearGradient(0,0,1,256),o=1/(e.length-1),n=0,i=e.length;n<i;++n)r.addColorStop(n*o,e[n]);return t.fillStyle=r,t.fillRect(0,0,1,256),t.canvas}var _default=exports.default=Heatmap;

},{"../dom.js":130,"../math.js":279,"../renderer/webgl/PointsLayer.js":324,"../webgl/ShaderBuilder.js":414,"./BaseVector.js":264}],268:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseImage=_interopRequireDefault(require("./BaseImage.js")),_ImageLayer=_interopRequireDefault(require("../renderer/canvas/ImageLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,_BaseImage["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _ImageLayer.default(this)}},{key:"getData",value:function(e){return _get(_getPrototypeOf(t.prototype),"getData",this).call(this,e)}}])}(),_default=exports.default=ImageLayer;

},{"../renderer/canvas/ImageLayer.js":316,"./BaseImage.js":262}],269:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.inView=inView;var _Base=_interopRequireDefault(require("./Base.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Property=_interopRequireDefault(require("./Property.js")),_EventType2=_interopRequireDefault(require("../render/EventType.js")),_View=_interopRequireDefault(require("../View.js")),_asserts=require("../asserts.js"),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Layer=function(e){function t(e){var r;_classCallCheck(this,t);var n=Object.assign({},e);delete n.source,(r=_callSuper(this,t,[n])).on,r.once,r.un,r.mapPrecomposeKey_=null,r.mapRenderKey_=null,r.sourceChangeKey_=null,r.renderer_=null,r.sourceReady_=!1,r.rendered=!1,e.render&&(r.render=e.render),e.map&&r.setMap(e.map),r.addChangeListener(_Property.default.SOURCE,r.handleSourcePropertyChange_);var o=e.source?e.source:null;return r.setSource(o),r}return _inherits(t,_Base["default"]),_createClass(t,[{key:"getLayersArray",value:function(e){return(e=e||[]).push(this),e}},{key:"getLayerStatesArray",value:function(e){return(e=e||[]).push(this.getLayerState()),e}},{key:"getSource",value:function(){return this.get(_Property.default.SOURCE)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var e=this.getSource();return e?e.getState():"undefined"}},{key:"handleSourceChange_",value:function(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}},{key:"handleSourcePropertyChange_",value:function(){var e=this;this.sourceChangeKey_&&((0,_events.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;var t=this.getSource();t&&(this.sourceChangeKey_=(0,_events.listen)(t,_EventType.default.CHANGE,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout(function(){e.dispatchEvent("sourceready")},0))),this.changed()}},{key:"getFeatures",value:function(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}},{key:"getData",value:function(e){return this.renderer_&&this.rendered?this.renderer_.getData(e):null}},{key:"isVisible",value:function(e){var t,r,n=this,o=this.getMapInternal();!e&&o&&(e=o.getView()),!(t=e instanceof _View.default?{viewState:e.getState(),extent:e.calculateExtent()}:e).layerStatesArray&&o&&(t.layerStatesArray=o.getLayerGroup().getLayerStatesArray()),r=t.layerStatesArray?t.layerStatesArray.find(function(e){return e.layer===n}):this.getLayerState();var i=this.getExtent();return inView(r,t.viewState)&&(!i||(0,_extent.intersects)(i,t.extent))}},{key:"getAttributions",value:function(e){if(!this.isVisible(e))return[];var t,r=this.getSource();if(r&&(t=r.getAttributions()),!t)return[];var n=t(e instanceof _View.default?e.getViewStateAndExtent():e);return Array.isArray(n)||(n=[n]),n}},{key:"render",value:function(e,t){var r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}},{key:"unrender",value:function(){this.rendered=!1}},{key:"getDeclutter",value:function(){}},{key:"renderDeclutter",value:function(e,t){}},{key:"renderDeferred",value:function(e){var t=this.getRenderer();t&&t.renderDeferred(e)}},{key:"setMapInternal",value:function(e){e||this.unrender(),this.set(_Property.default.MAP,e)}},{key:"getMapInternal",value:function(){return this.get(_Property.default.MAP)}},{key:"setMap",value:function(e){this.mapPrecomposeKey_&&((0,_events.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&((0,_events.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=(0,_events.listen)(e,_EventType2.default.PRECOMPOSE,function(e){var t=e.frameState.layerStatesArray,r=this.getLayerState(!1);(0,_asserts.assert)(!t.some(function(e){return e.layer===r.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)},this),this.mapRenderKey_=(0,_events.listen)(this,_EventType.default.CHANGE,e.render,e),this.changed())}},{key:"setSource",value:function(e){this.set(_Property.default.SOURCE,e)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}();function inView(e,t){if(!e.visible)return!1;var r=t.resolution;if(r<e.minResolution||r>=e.maxResolution)return!1;var n=t.zoom;return n>e.minZoom&&n<=e.maxZoom}var _default=exports.default=Layer;

},{"../View.js":107,"../asserts.js":111,"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"../render/EventType.js":294,"./Base.js":261,"./Property.js":270}],270:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};

},{}],271:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseTile=_interopRequireDefault(require("./BaseTile.js")),_TileLayer=_interopRequireDefault(require("../renderer/canvas/TileLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,_BaseTile["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _TileLayer.default(this)}}])}(),_default=exports.default=TileLayer;

},{"../renderer/canvas/TileLayer.js":318,"./BaseTile.js":263}],272:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};

},{}],273:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("./BaseVector.js")),_VectorLayer=_interopRequireDefault(require("../renderer/canvas/VectorLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,_BaseVector["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _VectorLayer.default(this)}}])}(),_default=exports.default=VectorLayer;

},{"../renderer/canvas/VectorLayer.js":320,"./BaseVector.js":264}],274:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("./BaseVector.js")),_VectorImageLayer=_interopRequireDefault(require("../renderer/canvas/VectorImageLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorImageLayer=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var o=Object.assign({},e);return delete o.imageRatio,(r=_callSuper(this,t,[o])).imageRatio_=void 0!==e.imageRatio?e.imageRatio:1,r}return _inherits(t,_BaseVector["default"]),_createClass(t,[{key:"getImageRatio",value:function(){return this.imageRatio_}},{key:"createRenderer",value:function(){return new _VectorImageLayer.default(this)}}])}(),_default=exports.default=VectorImageLayer;

},{"../renderer/canvas/VectorImageLayer.js":319,"./BaseVector.js":264}],275:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("./BaseVector.js")),_VectorTileLayer=_interopRequireDefault(require("../renderer/canvas/VectorTileLayer.js")),_TileProperty=_interopRequireDefault(require("./TileProperty.js")),_asserts=require("../asserts.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorTileLayer=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var o=Object.assign({},e);delete o.preload,delete o.useInterimTilesOnError,(r=_callSuper(this,t,[o])).on,r.once,r.un;var n=e.renderMode||"hybrid";return(0,_asserts.assert)("hybrid"==n||"vector"==n,"`renderMode` must be `'hybrid'` or `'vector'`"),r.renderMode_=n,r.setPreload(e.preload?e.preload:0),r.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),r.getBackground,r.setBackground,r}return _inherits(t,_BaseVector["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _VectorTileLayer.default(this)}},{key:"getFeatures",value:function(e){return _get(_getPrototypeOf(t.prototype),"getFeatures",this).call(this,e)}},{key:"getRenderMode",value:function(){return this.renderMode_}},{key:"getPreload",value:function(){return this.get(_TileProperty.default.PRELOAD)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(_TileProperty.default.USE_INTERIM_TILES_ON_ERROR)}},{key:"setPreload",value:function(e){this.set(_TileProperty.default.PRELOAD,e)}},{key:"setUseInterimTilesOnError",value:function(e){this.set(_TileProperty.default.USE_INTERIM_TILES_ON_ERROR,e)}}])}(),_default=exports.default=VectorTileLayer;

},{"../asserts.js":111,"../renderer/canvas/VectorTileLayer.js":321,"./BaseVector.js":264,"./TileProperty.js":272}],276:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js")),_PointsLayer=_interopRequireDefault(require("../renderer/webgl/PointsLayer.js")),_styleparser=require("../webgl/styleparser.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var WebGLPointsLayer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[Object.assign({},e)])).parseResult_=(0,_styleparser.parseLiteralStyle)(e.style),r.styleVariables_=e.style.variables||{},r.hitDetectionDisabled_=!!e.disableHitDetection,r}return _inherits(t,_Layer2["default"]),_createClass(t,[{key:"createRenderer",value:function(){var e=this,t=Object.keys(this.parseResult_.attributes).map(function(t){return _objectSpread({name:t},e.parseResult_.attributes[t])});return new _PointsLayer.default(this,{vertexShader:this.parseResult_.builder.getSymbolVertexShader(),fragmentShader:this.parseResult_.builder.getSymbolFragmentShader(),hitDetectionEnabled:!this.hitDetectionDisabled_,uniforms:this.parseResult_.uniforms,attributes:t})}},{key:"updateStyleVariables",value:function(e){Object.assign(this.styleVariables_,e),this.changed()}}])}(),_default=exports.default=WebGLPointsLayer;

},{"../renderer/webgl/PointsLayer.js":324,"../webgl/styleparser.js":416,"./Layer.js":269}],277:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseTile=_interopRequireDefault(require("./BaseTile.js")),_Property=_interopRequireDefault(require("../layer/Property.js")),_TileLayer=_interopRequireWildcard(require("../renderer/webgl/TileLayer.js")),_expression=require("../expr/expression.js"),_gpu=require("../expr/gpu.js"),_styleparser=require("../webgl/styleparser.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _callSuper(e,r,t){return r=_getPrototypeOf(r),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(r,t||[],_getPrototypeOf(e).constructor):r.apply(e,t))}function _possibleConstructorReturn(e,r){if(r&&("object"==_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&_setPrototypeOf(e,r)}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}function parseStyle(e,r){var t="\n    attribute vec2 ".concat(_TileLayer.Attributes.TEXTURE_COORD,";\n    uniform mat4 ").concat(_TileLayer.Uniforms.TILE_TRANSFORM,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_RESOLUTION,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_ORIGIN_X,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_ORIGIN_Y,";\n    uniform float ").concat(_TileLayer.Uniforms.DEPTH,";\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ").concat(_TileLayer.Attributes.TEXTURE_COORD,";\n      v_mapCoord = vec2(\n        ").concat(_TileLayer.Uniforms.TEXTURE_ORIGIN_X," + ").concat(_TileLayer.Uniforms.TEXTURE_RESOLUTION," * ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_WIDTH," * v_textureCoord[0],\n        ").concat(_TileLayer.Uniforms.TEXTURE_ORIGIN_Y," - ").concat(_TileLayer.Uniforms.TEXTURE_RESOLUTION," * ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_HEIGHT," * v_textureCoord[1]\n      );\n      gl_Position = ").concat(_TileLayer.Uniforms.TILE_TRANSFORM," * vec4(").concat(_TileLayer.Attributes.TEXTURE_COORD,", ").concat(_TileLayer.Uniforms.DEPTH,", 1.0);\n    }\n  "),n=_objectSpread(_objectSpread({},(0,_gpu.newCompilationContext)()),{},{inFragmentShader:!0,bandCount:r,style:e}),o=[];if(void 0!==e.color){var i=(0,_styleparser.expressionToGlsl)(n,e.color,_expression.ColorType);o.push("color = ".concat(i,";"))}if(void 0!==e.contrast){var a=(0,_styleparser.expressionToGlsl)(n,e.contrast,_expression.NumberType);o.push("color.rgb = clamp((".concat(a," + 1.0) * color.rgb - (").concat(a," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(void 0!==e.exposure){var s=(0,_styleparser.expressionToGlsl)(n,e.exposure,_expression.NumberType);o.push("color.rgb = clamp((".concat(s," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(void 0!==e.saturation){var c=(0,_styleparser.expressionToGlsl)(n,e.saturation,_expression.NumberType);o.push("\n      float saturation = ".concat(c," + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    "))}if(void 0!==e.gamma){var u=(0,_styleparser.expressionToGlsl)(n,e.gamma,_expression.NumberType);o.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(u,"));"))}if(void 0!==e.brightness){var l=(0,_styleparser.expressionToGlsl)(n,e.brightness,_expression.NumberType);o.push("color.rgb = clamp(color.rgb + ".concat(l,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var f={},_=Object.keys(n.variables).length;if(_>1&&!e.variables)throw new Error("Missing variables in style (expected ".concat(n.variables,")"));for(var p=function(){var r=n.variables[Object.keys(n.variables)[y]];if(!(r.name in e.variables))throw new Error("Missing '".concat(r.name,"' in style variables"));var t=(0,_gpu.uniformNameForVariable)(r.name);f[t]=function(){var t=e.variables[r.name];return"string"==typeof t&&(t=(0,_gpu.getStringNumberEquivalent)(t)),void 0!==t?t:-9999999}},y=0;y<_;++y)p();var d=Object.keys(f).map(function(e){return"uniform float ".concat(e,";")}),v=Math.ceil(r/4);d.push("uniform sampler2D ".concat(_TileLayer.Uniforms.TILE_TEXTURE_ARRAY,"[").concat(v,"];")),n.paletteTextures&&d.push("uniform sampler2D ".concat(_gpu.PALETTE_TEXTURE_ARRAY,"[").concat(n.paletteTextures.length,"];"));var T=Object.keys(n.functions).map(function(e){return n.functions[e]});return{vertexShader:t,fragmentShader:"\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ".concat(_TileLayer.Uniforms.RENDER_EXTENT,";\n    uniform float ").concat(_TileLayer.Uniforms.TRANSITION_ALPHA,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(_TileLayer.Uniforms.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(_TileLayer.Uniforms.RESOLUTION,";\n    uniform float ").concat(_TileLayer.Uniforms.ZOOM,";\n\n    ").concat(d.join("\n"),"\n\n    ").concat(T.join("\n"),"\n\n    void main() {\n      if (\n        v_mapCoord[0] < ").concat(_TileLayer.Uniforms.RENDER_EXTENT,"[0] ||\n        v_mapCoord[1] < ").concat(_TileLayer.Uniforms.RENDER_EXTENT,"[1] ||\n        v_mapCoord[0] > ").concat(_TileLayer.Uniforms.RENDER_EXTENT,"[2] ||\n        v_mapCoord[1] > ").concat(_TileLayer.Uniforms.RENDER_EXTENT,"[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(").concat(_TileLayer.Uniforms.TILE_TEXTURE_ARRAY,"[0],  v_textureCoord);\n\n      ").concat(o.join("\n"),"\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ").concat(_TileLayer.Uniforms.TRANSITION_ALPHA,";\n    }"),uniforms:f,paletteTextures:n.paletteTextures}}var WebGLTileLayer=function(e){function r(e){var t;_classCallCheck(this,r);var n=(e=e?Object.assign({},e):{}).style||{};delete e.style;var o=e.cacheSize;return delete e.cacheSize,(t=_callSuper(this,r,[e])).sources_=e.sources,t.renderedSource_=null,t.renderedResolution_=NaN,t.style_=n,t.cacheSize_=o,t.styleVariables_=t.style_.variables||{},t.addChangeListener(_Property.default.SOURCE,t.handleSourceUpdate_),t}return _inherits(r,_BaseTile["default"]),_createClass(r,[{key:"getSources",value:function(e,r){var t=this.getSource();return this.sources_?"function"==typeof this.sources_?this.sources_(e,r):this.sources_:t?[t]:[]}},{key:"getRenderSource",value:function(){return this.renderedSource_||this.getSource()}},{key:"getSourceState",value:function(){var e=this.getRenderSource();return e?e.getState():"undefined"}},{key:"handleSourceUpdate_",value:function(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}},{key:"getSourceBandCount_",value:function(){var e=Number.MAX_SAFE_INTEGER,r=this.getSources([-e,-e,e,e],e);return r&&r.length&&"bandCount"in r[0]?r[0].bandCount:4}},{key:"createRenderer",value:function(){var e=parseStyle(this.style_,this.getSourceBandCount_());return new _TileLayer.default(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})}},{key:"renderSources",value:function(e,r){for(var t,n=this.getRenderer(),o=0,i=r.length;o<i;++o)this.renderedSource_=r[o],n.prepareFrame(e)&&(t=n.renderFrame(e));return t}},{key:"render",value:function(e,r){var t=this;this.rendered=!0;for(var n=e.viewState,o=this.getSources(e.extent,n.resolution),i=!0,a=function(){var e=o[s],r=e.getState();if("loading"==r){e.addEventListener("change",function r(){"ready"==e.getState()&&(e.removeEventListener("change",r),t.changed())})}i=i&&"ready"==r},s=0,c=o.length;s<c;++s)a();var u=this.renderSources(e,o);if(this.getRenderer().renderComplete&&i)return this.renderedResolution_=n.resolution,u;if(this.renderedResolution_>.5*n.resolution){var l=this.getSources(e.extent,this.renderedResolution_).filter(function(e){return!o.includes(e)});if(l.length>0)return this.renderSources(e,l)}return u}},{key:"setStyle",value:function(e){this.styleVariables_=e.variables||{},this.style_=e;var r=parseStyle(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms,paletteTextures:r.paletteTextures}),this.changed()}},{key:"updateStyleVariables",value:function(e){Object.assign(this.styleVariables_,e),this.changed()}}])}();WebGLTileLayer.prototype.dispose;var _default=exports.default=WebGLTileLayer;

},{"../expr/expression.js":140,"../expr/gpu.js":141,"../layer/Property.js":270,"../renderer/webgl/TileLayer.js":325,"../webgl/styleparser.js":416,"./BaseTile.js":263}],278:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=all,exports.bbox=bbox,exports.tile=tile;var _proj=require("./proj.js");function all(e,r){return[[-1/0,-1/0,1/0,1/0]]}function bbox(e,r){return[e]}function tile(e){return function(r,t,o){var n=e.getZForResolution((0,_proj.fromUserResolution)(t,o)),i=e.getTileRangeForExtentAndZ((0,_proj.fromUserExtent)(r,o),n),l=[],u=[n,0,0];for(u[1]=i.minX;u[1]<=i.maxX;++u[1])for(u[2]=i.minY;u[2]<=i.maxY;++u[2])l.push((0,_proj.toUserExtent)(e.getTileCoordExtent(u),o));return l}}

},{"./proj.js":283}],279:[function(require,module,exports){
"use strict";function clamp(r,e,t){return Math.min(Math.max(r,e),t)}function squaredSegmentDistance(r,e,t,o,n,a){var s=n-t,u=a-o;if(0!==s||0!==u){var i=((r-t)*s+(e-o)*u)/(s*s+u*u);i>1?(t=n,o=a):i>0&&(t+=s*i,o+=u*i)}return squaredDistance(r,e,t,o)}function squaredDistance(r,e,t,o){var n=t-r,a=o-e;return n*n+a*a}function solveLinearSystem(r){for(var e=r.length,t=0;t<e;t++){for(var o=t,n=Math.abs(r[t][t]),a=t+1;a<e;a++){var s=Math.abs(r[a][t]);s>n&&(n=s,o=a)}if(0===n)return null;var u=r[o];r[o]=r[t],r[t]=u;for(var i=t+1;i<e;i++)for(var c=-r[i][t]/r[t][t],d=t;d<e+1;d++)t==d?r[i][d]=0:r[i][d]+=c*r[t][d]}for(var f=new Array(e),l=e-1;l>=0;l--){f[l]=r[l][e]/r[l][l];for(var p=l-1;p>=0;p--)r[p][e]-=r[p][l]*f[l]}return f}function toDegrees(r){return 180*r/Math.PI}function toRadians(r){return r*Math.PI/180}function modulo(r,e){var t=r%e;return t*e<0?t+e:t}function lerp(r,e,t){return r+t*(e-r)}function toFixed(r,e){var t=Math.pow(10,e);return Math.round(r*t)/t}function round(r,e){return Math.round(toFixed(r,e))}function floor(r,e){return Math.floor(toFixed(r,e))}function ceil(r,e){return Math.ceil(toFixed(r,e))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ceil=ceil,exports.clamp=clamp,exports.floor=floor,exports.lerp=lerp,exports.modulo=modulo,exports.round=round,exports.solveLinearSystem=solveLinearSystem,exports.squaredDistance=squaredDistance,exports.squaredSegmentDistance=squaredSegmentDistance,exports.toDegrees=toDegrees,exports.toFixed=toFixed,exports.toRadians=toRadians;

},{}],280:[function(require,module,exports){
(function (global){(function (){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResponseError=exports.ClientError=void 0,exports.getJSON=getJSON,exports.jsonp=jsonp,exports.overrideXHR=overrideXHR,exports.resolveUrl=resolveUrl,exports.restoreXHR=restoreXHR;var _util=require("./util.js");function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)})(e)}function _construct(e,t,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,t);var n=new(e.bind.apply(e,o));return r&&_setPrototypeOf(n,r.prototype),n}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jsonp(e,t,r,o){var n=document.createElement("script"),i="olc_"+(0,_util.getUid)(t);function u(){delete window[i],n.parentNode.removeChild(n)}n.async=!0,n.src=e+(e.includes("?")?"&":"?")+(o||"callback")+"="+i;var s=setTimeout(function(){u(),r&&r()},1e4);window[i]=function(e){clearTimeout(s),u(),t(e)},document.head.appendChild(n)}var originalXHR,ResponseError=exports.ResponseError=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,["Unexpected response status: "+e.status])).name="ResponseError",r.response=e,r}return _inherits(t,_wrapNativeSuper(Error)),_createClass(t)}(),ClientError=exports.ClientError=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,["Failed to issue request"])).name="ClientError",r.client=e,r}return _inherits(t,_wrapNativeSuper(Error)),_createClass(t)}();function getJSON(e){return new Promise(function(t,r){var o=new XMLHttpRequest;o.addEventListener("load",function(e){var o=e.target;if(!o.status||o.status>=200&&o.status<300){var n;try{n=JSON.parse(o.responseText)}catch(e){var i="Error parsing response text as JSON: "+e.message;return void r(new Error(i))}t(n)}else r(new ResponseError(o))}),o.addEventListener("error",function(e){r(new ClientError(e.target))}),o.open("GET",e),o.setRequestHeader("Accept","application/json"),o.send()})}function resolveUrl(e,t){return t.includes("://")?t:new URL(t,e).href}function overrideXHR(e){"undefined"!=typeof XMLHttpRequest&&(originalXHR=XMLHttpRequest),global.XMLHttpRequest=e}function restoreXHR(){global.XMLHttpRequest=originalXHR}

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./util.js":404}],281:[function(require,module,exports){
"use strict";function clear(e){for(var r in e)delete e[r]}function isEmpty(e){var r;for(r in e)return!1;return!r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=clear,exports.isEmpty=isEmpty;

},{}],282:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};

},{}],283:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"METERS_PER_UNIT",{enumerable:!0,get:function(){return _Units.METERS_PER_UNIT}}),Object.defineProperty(exports,"Projection",{enumerable:!0,get:function(){return _Projection.default}}),exports.addCommon=addCommon,exports.addCoordinateTransforms=addCoordinateTransforms,exports.addEquivalentProjections=addEquivalentProjections,exports.addEquivalentTransforms=addEquivalentTransforms,exports.addProjection=addProjection,exports.addProjections=addProjections,exports.clearAllProjections=clearAllProjections,exports.clearUserProjection=clearUserProjection,exports.cloneTransform=cloneTransform,exports.createProjection=createProjection,exports.createSafeCoordinateTransform=createSafeCoordinateTransform,exports.createTransformFromCoordinateTransform=createTransformFromCoordinateTransform,exports.disableCoordinateWarning=disableCoordinateWarning,exports.equivalent=equivalent,exports.fromLonLat=fromLonLat,exports.fromUserCoordinate=fromUserCoordinate,exports.fromUserExtent=fromUserExtent,exports.fromUserResolution=fromUserResolution,exports.get=get,exports.getPointResolution=getPointResolution,exports.getTransform=getTransform,exports.getTransformFromProjections=getTransformFromProjections,exports.getUserProjection=getUserProjection,exports.identityTransform=identityTransform,exports.setUserProjection=setUserProjection,exports.toLonLat=toLonLat,exports.toUserCoordinate=toUserCoordinate,exports.toUserExtent=toUserExtent,exports.toUserResolution=toUserResolution,exports.transform=transform,exports.transformExtent=transformExtent,exports.transformWithProjections=transformWithProjections,exports.useGeographic=useGeographic;var _Projection=_interopRequireDefault(require("./proj/Projection.js")),_epsg=require("./proj/epsg3857.js"),_epsg2=require("./proj/epsg4326.js"),_Units=require("./proj/Units.js"),_projections=require("./proj/projections.js"),_transforms=require("./proj/transforms.js"),_extent=require("./extent.js"),_math=require("./math.js"),_coordinate=require("./coordinate.js"),_sphere=require("./sphere.js"),_console=require("./console.js");function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}var showCoordinateWarning=!0;function disableCoordinateWarning(r){showCoordinateWarning=!(void 0===r||r)}function cloneTransform(r,e){if(void 0!==e){for(var o=0,t=r.length;o<t;++o)e[o]=r[o];e=e}else e=r.slice();return e}function identityTransform(r,e){if(void 0!==e&&r!==e){for(var o=0,t=r.length;o<t;++o)e[o]=r[o];r=e}return r}function addProjection(r){(0,_projections.add)(r.getCode(),r),(0,_transforms.add)(r,r,cloneTransform)}function addProjections(r){r.forEach(addProjection)}function get(r){return"string"==typeof r?(0,_projections.get)(r):r||null}function getPointResolution(r,e,o,t){var n,s=(r=get(r)).getPointResolutionFunc();if(s){if(n=s(e,o),t&&t!==r.getUnits()){var i=r.getMetersPerUnit();i&&(n=n*i/_Units.METERS_PER_UNIT[t])}}else{var a=r.getUnits();if("degrees"==a&&!t||"degrees"==t)n=e;else{var c=getTransformFromProjections(r,get("EPSG:4326"));if(c===identityTransform&&"degrees"!==a)n=e*r.getMetersPerUnit();else{var f=[o[0]-e/2,o[1],o[0]+e/2,o[1],o[0],o[1]-e/2,o[0],o[1]+e/2];f=c(f,f,2),n=((0,_sphere.getDistance)(f.slice(0,2),f.slice(2,4))+(0,_sphere.getDistance)(f.slice(4,6),f.slice(6,8)))/2}var u=t?_Units.METERS_PER_UNIT[t]:r.getMetersPerUnit();void 0!==u&&(n/=u)}}return n}function addEquivalentProjections(r){addProjections(r),r.forEach(function(e){r.forEach(function(r){e!==r&&(0,_transforms.add)(e,r,cloneTransform)})})}function addEquivalentTransforms(r,e,o,t){r.forEach(function(r){e.forEach(function(e){(0,_transforms.add)(r,e,o),(0,_transforms.add)(e,r,t)})})}function clearAllProjections(){(0,_projections.clear)(),(0,_transforms.clear)()}function createProjection(r,e){return r?"string"==typeof r?get(r):r:get(e)}function createTransformFromCoordinateTransform(r){return function(e,o,t){var n=e.length;t=void 0!==t?t:2,o=void 0!==o?o:new Array(n);for(var s=0;s<n;s+=t)for(var i=r(e.slice(s,s+t)),a=i.length,c=0,f=t;c<f;++c)o[s+c]=c>=a?e[s+c]:i[c];return o}}function addCoordinateTransforms(r,e,o,t){var n=get(r),s=get(e);(0,_transforms.add)(n,s,createTransformFromCoordinateTransform(o)),(0,_transforms.add)(s,n,createTransformFromCoordinateTransform(t))}function fromLonLat(r,e){return disableCoordinateWarning(),transform(r,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function toLonLat(r,e){var o=transform(r,void 0!==e?e:"EPSG:3857","EPSG:4326"),t=o[0];return(t<-180||t>180)&&(o[0]=(0,_math.modulo)(t+180,360)-180),o}function equivalent(r,e){if(r===e)return!0;var o=r.getUnits()===e.getUnits();return r.getCode()===e.getCode()?o:getTransformFromProjections(r,e)===cloneTransform&&o}function getTransformFromProjections(r,e){var o=r.getCode(),t=e.getCode(),n=(0,_transforms.get)(o,t);return n||(n=identityTransform),n}function getTransform(r,e){return getTransformFromProjections(get(r),get(e))}function transform(r,e,o){return getTransform(e,o)(r,void 0,r.length)}function transformExtent(r,e,o,t){var n=getTransform(e,o);return(0,_extent.applyTransform)(r,n,void 0,t)}function transformWithProjections(r,e,o){return getTransformFromProjections(e,o)(r)}var userProjection=null;function setUserProjection(r){userProjection=get(r)}function clearUserProjection(){userProjection=null}function getUserProjection(){return userProjection}function useGeographic(){setUserProjection("EPSG:4326")}function toUserCoordinate(r,e){return userProjection?transform(r,e,userProjection):r}function fromUserCoordinate(r,e){return userProjection?transform(r,userProjection,e):(showCoordinateWarning&&!(0,_coordinate.equals)(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(showCoordinateWarning=!1,(0,_console.warn)("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r)}function toUserExtent(r,e){return userProjection?transformExtent(r,e,userProjection):r}function fromUserExtent(r,e){return userProjection?transformExtent(r,userProjection,e):r}function toUserResolution(r,e){if(!userProjection)return r;var o=get(e).getMetersPerUnit(),t=userProjection.getMetersPerUnit();return o&&t?r*o/t:r}function fromUserResolution(r,e){if(!userProjection)return r;var o=get(e).getMetersPerUnit(),t=userProjection.getMetersPerUnit();return o&&t?r*t/o:r}function createSafeCoordinateTransform(r,e,o){return function(t){var n,s;if(r.canWrapX()){var i=r.getExtent(),a=(0,_extent.getWidth)(i);t=t.slice(0),(s=(0,_coordinate.getWorldsAway)(t,r,a))&&(t[0]=t[0]-s*a),t[0]=(0,_math.clamp)(t[0],i[0],i[2]),t[1]=(0,_math.clamp)(t[1],i[1],i[3]),n=o(t)}else n=o(t);return s&&e.canWrapX()&&(n[0]+=s*(0,_extent.getWidth)(e.getExtent())),n}}function addCommon(){addEquivalentProjections(_epsg.PROJECTIONS),addEquivalentProjections(_epsg2.PROJECTIONS),addEquivalentTransforms(_epsg2.PROJECTIONS,_epsg.PROJECTIONS,_epsg.fromEPSG4326,_epsg.toEPSG4326)}addCommon();

},{"./console.js":115,"./coordinate.js":128,"./extent.js":142,"./math.js":279,"./proj/Projection.js":284,"./proj/Units.js":285,"./proj/epsg3857.js":286,"./proj/epsg4326.js":287,"./proj/projections.js":289,"./proj/transforms.js":290,"./sphere.js":379}],284:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Units=require("./Units.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Projection=function(){return _createClass(function t(e){_classCallCheck(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit},[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||_Units.METERS_PER_UNIT[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])}(),_default=exports.default=Projection;

},{"./Units.js":285}],285:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.METERS_PER_UNIT=void 0,exports.fromCode=fromCode;var unitByCode={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function fromCode(e){return unitByCode[e]}var METERS_PER_UNIT=exports.METERS_PER_UNIT={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};

},{}],286:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.WORLD_EXTENT=exports.RADIUS=exports.PROJECTIONS=exports.MAX_SAFE_Y=exports.HALF_SIZE=exports.EXTENT=void 0,exports.fromEPSG4326=fromEPSG4326,exports.toEPSG4326=toEPSG4326;var _Projection2=_interopRequireDefault(require("./Projection.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var RADIUS=exports.RADIUS=6378137,HALF_SIZE=exports.HALF_SIZE=Math.PI*RADIUS,EXTENT=exports.EXTENT=[-HALF_SIZE,-HALF_SIZE,HALF_SIZE,HALF_SIZE],WORLD_EXTENT=exports.WORLD_EXTENT=[-180,-85,180,85],MAX_SAFE_Y=exports.MAX_SAFE_Y=RADIUS*Math.log(Math.tan(Math.PI/2)),EPSG3857Projection=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,[{code:t,units:"m",extent:EXTENT,global:!0,worldExtent:WORLD_EXTENT,getPointResolution:function(t,e){return t/Math.cosh(e[1]/RADIUS)}}])}return _inherits(e,_Projection2["default"]),_createClass(e)}(),PROJECTIONS=exports.PROJECTIONS=[new EPSG3857Projection("EPSG:3857"),new EPSG3857Projection("EPSG:102100"),new EPSG3857Projection("EPSG:102113"),new EPSG3857Projection("EPSG:900913"),new EPSG3857Projection("http://www.opengis.net/def/crs/EPSG/0/3857"),new EPSG3857Projection("http://www.opengis.net/gml/srs/epsg.xml#3857")];function fromEPSG4326(t,e,r){var o=t.length;r=r>1?r:2,void 0===e&&(e=r>2?t.slice():new Array(o));for(var n=0;n<o;n+=r){e[n]=HALF_SIZE*t[n]/180;var i=RADIUS*Math.log(Math.tan(Math.PI*(+t[n+1]+90)/360));i>MAX_SAFE_Y?i=MAX_SAFE_Y:i<-MAX_SAFE_Y&&(i=-MAX_SAFE_Y),e[n+1]=i}return e}function toEPSG4326(t,e,r){var o=t.length;r=r>1?r:2,void 0===e&&(e=r>2?t.slice():new Array(o));for(var n=0;n<o;n+=r)e[n]=180*t[n]/HALF_SIZE,e[n+1]=360*Math.atan(Math.exp(t[n+1]/RADIUS))/Math.PI-90;return e}

},{"./Projection.js":284}],287:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.RADIUS=exports.PROJECTIONS=exports.METERS_PER_UNIT=exports.EXTENT=void 0;var _Projection2=_interopRequireDefault(require("./Projection.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var RADIUS=exports.RADIUS=6378137,EXTENT=exports.EXTENT=[-180,-90,180,90],METERS_PER_UNIT=exports.METERS_PER_UNIT=Math.PI*RADIUS/180,EPSG4326Projection=function(e){function t(e,r){return _classCallCheck(this,t),_callSuper(this,t,[{code:e,units:"degrees",extent:EXTENT,axisOrientation:r,global:!0,metersPerUnit:METERS_PER_UNIT,worldExtent:EXTENT}])}return _inherits(t,_Projection2["default"]),_createClass(t)}(),PROJECTIONS=exports.PROJECTIONS=[new EPSG4326Projection("CRS:84"),new EPSG4326Projection("EPSG:4326","neu"),new EPSG4326Projection("urn:ogc:def:crs:OGC:1.3:CRS84"),new EPSG4326Projection("urn:ogc:def:crs:OGC:2:84"),new EPSG4326Projection("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new EPSG4326Projection("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new EPSG4326Projection("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];

},{"./Projection.js":284}],288:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.epsgLookupMapTiler=epsgLookupMapTiler,exports.fromEPSGCode=fromEPSGCode,exports.getEPSGLookup=getEPSGLookup,exports.isRegistered=isRegistered,exports.register=register,exports.setEPSGLookup=setEPSGLookup,exports.unregister=unregister;var _Projection=_interopRequireDefault(require("./Projection.js")),_proj=require("../proj.js"),_transforms=require("./transforms.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function f(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),u=new O(n||[]);return o(a,"_invoke",{value:k(t,e,u)}),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var p="suspendedStart",h="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function w(){}var _={};s(_,a,function(){return this});var x=Object.getPrototypeOf,b=x&&x(x(T([])));b&&b!==e&&n.call(b,a)&&(_=b);var j=w.prototype=g.prototype=Object.create(_);function E(t){["next","throw","return"].forEach(function(r){s(t,r,function(t){return this._invoke(r,t)})})}function L(t,r){function e(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?r.resolve(f.__await).then(function(t){e("next",t,a,u)},function(t){e("throw",t,a,u)}):r.resolve(f).then(function(t){s.value=t,a(s)},function(t){return e("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r(function(r,o){e(t,n,r,o)})}return i=i?i.then(o,o):o()}})}function k(r,e,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=P(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(r,e,n);if("normal"===s.type){if(o=n.done?v:h,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function P(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,P(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=l(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,y;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,y):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function G(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(_typeof(r)+" is not iterable")}return m.prototype=w,o(j,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,c,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},r.awrap=function(t){return{__await:t}},E(L.prototype),s(L.prototype,u,function(){return this}),r.AsyncIterator=L,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new L(f(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(j),s(j,c,"Generator"),s(j,a,function(){return this}),s(j,"toString",function(){return"[object Generator]"}),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return u.type="throw",u.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),G(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;G(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),y}},r}function asyncGeneratorStep(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}var registered=null;function isRegistered(){return!!registered}function unregister(){registered=null}function register(t){registered=t;var r,e,n=Object.keys(t.defs),o=n.length;for(r=0;r<o;++r){var i=n[r];if(!(0,_proj.get)(i)){var a=t.defs(i),u=a.units;u||"longlat"!==a.projName||(u="degrees"),(0,_proj.addProjection)(new _Projection.default({code:i,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:u}))}}for(r=0;r<o;++r){var c=n[r],s=(0,_proj.get)(c);for(e=0;e<o;++e){var f=n[e],l=(0,_proj.get)(f);if(!(0,_transforms.get)(c,f))if(t.defs[c]===t.defs[f])(0,_proj.addEquivalentProjections)([s,l]);else{var p=t(c,f);(0,_proj.addCoordinateTransforms)(s,l,(0,_proj.createSafeCoordinateTransform)(s,l,p.forward),(0,_proj.createSafeCoordinateTransform)(l,s,p.inverse))}}}}var epsgLookup=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://epsg.io/".concat(r,".proj4"));case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Unexpected response from epsg.io: ".concat(e.status));case 5:return t.abrupt("return",e.text());case 6:case"end":return t.stop()}},t)}));return function(r){return t.apply(this,arguments)}}();function setEPSGLookup(t){epsgLookup=t}function getEPSGLookup(){return epsgLookup}function fromEPSGCode(t){return _fromEPSGCode.apply(this,arguments)}function _fromEPSGCode(){return(_fromEPSGCode=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof r&&(r=parseInt(r.split(":").pop(),10)),e=registered){t.next=4;break}throw new Error("Proj4 must be registered first with register(proj4)");case 4:if(n="EPSG:"+r,!e.defs(n)){t.next=7;break}return t.abrupt("return",(0,_proj.get)(n));case 7:return t.t0=e,t.t1=n,t.next=11,epsgLookup(r);case 11:return t.t2=t.sent,t.t0.defs.call(t.t0,t.t1,t.t2),register(e),t.abrupt("return",(0,_proj.get)(n));case 15:case"end":return t.stop()}},t)}))).apply(this,arguments)}function epsgLookupMapTiler(t){return function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function r(e){var n;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("https://api.maptiler.com/coordinates/search/code:".concat(e,".json?transformations=true&exports=true&key=").concat(t));case 2:if((n=r.sent).ok){r.next=5;break}throw new Error("Unexpected response from maptiler.com: ".concat(n.status));case 5:return r.abrupt("return",n.json().then(function(t){var r=t.results;if((null==r?void 0:r.length)>0){var n=r.filter(function(t){var r,n;return"EPSG"===(null===(r=t.id)||void 0===r?void 0:r.authority)&&(null===(n=t.id)||void 0===n?void 0:n.code)===e})[0];if(n){var o,i=n.transformations;if((null==i?void 0:i.length)>0){var a,u,c=n.default_transformation;if(i.filter(function(t){var r,e,n;return(null===(r=t.id)||void 0===r?void 0:r.authority)===(null==c?void 0:c.authority)&&(null===(e=t.id)||void 0===e?void 0:e.code)===(null==c?void 0:c.code)&&0===(null===(n=t.grids)||void 0===n?void 0:n.length)}).length>0)return null===(u=n.exports)||void 0===u?void 0:u.proj4;var s=null===(a=i.filter(function(t){var r,e,n;return 0===(null===(r=t.grids)||void 0===r?void 0:r.length)&&"EPSG"===(null===(e=t.target_crs)||void 0===e?void 0:e.authority)&&4326===(null===(n=t.target_crs)||void 0===n?void 0:n.code)&&!1===t.deprecated&&!0===t.usable}).sort(function(t,r){return t.accuracy-r.accuracy})[0])||void 0===a||null===(a=a.exports)||void 0===a?void 0:a.proj4;if(s)return s}return null===(o=n.exports)||void 0===o?void 0:o.proj4}}}));case 6:case"end":return r.stop()}},r)}));return function(t){return r.apply(this,arguments)}}()}

},{"../proj.js":283,"./Projection.js":284,"./transforms.js":290}],289:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=add,exports.clear=clear,exports.get=get;var cache={};function clear(){cache={}}function get(e){return cache[e]||cache[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function add(e,c){cache[e]=c}

},{}],290:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=add,exports.clear=clear,exports.get=get,exports.remove=remove;var _obj=require("../obj.js"),transforms={};function clear(){transforms={}}function add(r,e,t){var s=r.getCode(),o=e.getCode();s in transforms||(transforms[s]={}),transforms[s][o]=t}function remove(r,e){var t=r.getCode(),s=e.getCode(),o=transforms[t][s];return delete transforms[t][s],(0,_obj.isEmpty)(transforms[t])&&delete transforms[t],o}function get(r,e){var t;return r in transforms&&e in transforms[r]&&(t=transforms[r][e]),t}

},{"../obj.js":281}],291:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRenderPixel=getRenderPixel,exports.getVectorContext=getVectorContext,exports.toContext=toContext;var _Immediate=_interopRequireDefault(require("./render/canvas/Immediate.js")),_has=require("./has.js"),_transform=require("./transform.js"),_vector=require("./renderer/vector.js"),_proj=require("./proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function toContext(e,r){var t=e.canvas,o=(r=r||{}).pixelRatio||_has.DEVICE_PIXEL_RATIO,n=r.size;n&&(t.width=n[0]*o,t.height=n[1]*o,t.style.width=n[0]+"px",t.style.height=n[1]+"px");var i=[0,0,t.width,t.height],a=(0,_transform.scale)((0,_transform.create)(),o,o);return new _Immediate.default(e,o,i,a,0)}function getVectorContext(e){if(!(e.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");var r,t=e.inversePixelTransform[0],o=e.inversePixelTransform[1],n=Math.sqrt(t*t+o*o),i=e.frameState,a=(0,_transform.multiply)(e.inversePixelTransform.slice(),i.coordinateToPixelTransform),s=(0,_vector.getSquaredTolerance)(i.viewState.resolution,n),l=(0,_proj.getUserProjection)();return l&&(r=(0,_proj.getTransformFromProjections)(l,i.viewState.projection)),new _Immediate.default(e.context,n,i.extent,a,i.viewState.rotation,s,r)}function getRenderPixel(e,r){return(0,_transform.apply)(e.inversePixelTransform,r.slice(0))}

},{"./has.js":233,"./proj.js":283,"./render/canvas/Immediate.js":303,"./renderer/vector.js":322,"./transform.js":402}],292:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var RenderBox=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.style.pointerEvents="auto",r.element_.className="ol-box "+e,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var e=this.startPixel_,t=this.endPixel_,r=this.element_.style;r.left=Math.min(e[0],t[0])+"px",r.top=Math.min(e[1],t[1])+"px",r.width=Math.abs(t[0]-e[0])+"px",r.height=Math.abs(t[1]-e[1])+"px"}},{key:"setMap",value:function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){if(this.map_){var e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new _Polygon.default([r])}}},{key:"getGeometry",value:function(){return this.geometry_}}])}(),_default=exports.default=RenderBox;

},{"../Disposable.js":81,"../geom/Polygon.js":211}],293:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var RenderEvent=function(t){function e(t,r,o,n){var i;return _classCallCheck(this,e),(i=_callSuper(this,e,[t])).inversePixelTransform=r,i.frameState=o,i.context=n,i}return _inherits(e,_Event2["default"]),_createClass(e)}(),_default=exports.default=RenderEvent;

},{"../events/Event.js":133}],294:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};

},{}],295:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.toFeature=toFeature,exports.toGeometry=toGeometry;var _Feature=_interopRequireDefault(require("../Feature.js")),_geom=require("../geom.js"),_transform=require("../transform.js"),_extent=require("../extent.js"),_simplify=require("../geom/flat/simplify.js"),_array=require("../array.js"),_interiorpoint=require("../geom/flat/interiorpoint.js"),_proj=require("../proj.js"),_orient=require("../geom/flat/orient.js"),_interpolate=require("../geom/flat/interpolate.js"),_center=require("../geom/flat/center.js"),_functions=require("../functions.js"),_transform2=require("../geom/flat/transform.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var tmpTransform=(0,_transform.create)(),RenderFeature=function(){function e(t,r,i,n,o,s){_classCallCheck(this,e),this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=r,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=o,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}return _createClass(e,[{key:"get",value:function(e){return this.properties_[e]}},{key:"getExtent",value:function(){return this.extent_||(this.extent_="Point"===this.type_?(0,_extent.createOrUpdateFromCoordinate)(this.flatCoordinates_):(0,_extent.createOrUpdateFromFlatCoordinates)(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}},{key:"getFlatInteriorPoint",value:function(){if(!this.flatInteriorPoints_){var e=(0,_extent.getCenter)(this.getExtent());this.flatInteriorPoints_=(0,_interiorpoint.getInteriorPointOfArray)(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}},{key:"getFlatInteriorPoints",value:function(){if(!this.flatInteriorPoints_){var e=(0,_orient.inflateEnds)(this.flatCoordinates_,this.ends_),t=(0,_center.linearRingss)(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=(0,_interiorpoint.getInteriorPointsOfMultiArray)(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}},{key:"getFlatMidpoint",value:function(){return this.flatMidpoints_||(this.flatMidpoints_=(0,_interpolate.interpolatePoint)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}},{key:"getFlatMidpoints",value:function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var e=this.flatCoordinates_,t=0,r=this.ends_,i=0,n=r.length;i<n;++i){var o=r[i],s=(0,_interpolate.interpolatePoint)(e,t,o,2,.5);(0,_array.extend)(this.flatMidpoints_,s),t=o}}return this.flatMidpoints_}},{key:"getId",value:function(){return this.id_}},{key:"getOrientedFlatCoordinates",value:function(){return this.flatCoordinates_}},{key:"getGeometry",value:function(){return this}},{key:"getSimplifiedGeometry",value:function(e){return this}},{key:"simplifyTransformed",value:function(e,t){return this}},{key:"getProperties",value:function(){return this.properties_}},{key:"getPropertiesInternal",value:function(){return this.properties_}},{key:"getStride",value:function(){return this.stride_}},{key:"getStyleFunction",value:function(){return this.styleFunction}},{key:"getType",value:function(){return this.type_}},{key:"transform",value:function(e){var t=(e=(0,_proj.get)(e)).getExtent(),r=e.getWorldExtent();if(t&&r){var i=(0,_extent.getHeight)(r)/(0,_extent.getHeight)(t);(0,_transform.compose)(tmpTransform,r[0],r[3],i,-i,0,0,0),(0,_transform2.transform2D)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,tmpTransform,this.flatCoordinates_)}}},{key:"applyTransform",value:function(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}},{key:"clone",value:function(){var t;return new e(this.type_,this.flatCoordinates_.slice(),null===(t=this.ends_)||void 0===t?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}},{key:"getEnds",value:function(){return this.ends_}},{key:"enableSimplifyTransformed",value:function(){var t=this;return this.simplifyTransformed=(0,_functions.memoizeOne)(function(r,i){if(r===t.squaredTolerance_)return t.simplifiedGeometry_;t.simplifiedGeometry_=t.clone(),i&&t.simplifiedGeometry_.applyTransform(i);var n,o=t.simplifiedGeometry_.getFlatCoordinates();switch(t.type_){case"LineString":o.length=(0,_simplify.douglasPeucker)(o,0,t.simplifiedGeometry_.flatCoordinates_.length,t.simplifiedGeometry_.stride_,r,o,0),n=[o.length];break;case"MultiLineString":n=[],o.length=(0,_simplify.douglasPeuckerArray)(o,0,t.simplifiedGeometry_.ends_,t.simplifiedGeometry_.stride_,r,o,0,n);break;case"Polygon":n=[],o.length=(0,_simplify.quantizeArray)(o,0,t.simplifiedGeometry_.ends_,t.simplifiedGeometry_.stride_,Math.sqrt(r),o,0,n)}return n&&(t.simplifiedGeometry_=new e(t.type_,o,n,2,t.properties_,t.id_)),t.squaredTolerance_=r,t.simplifiedGeometry_}),this}}])}();function toGeometry(e){var t=e.getType();switch(t){case"Point":return new _geom.Point(e.getFlatCoordinates());case"MultiPoint":return new _geom.MultiPoint(e.getFlatCoordinates(),"XY");case"LineString":return new _geom.LineString(e.getFlatCoordinates(),"XY");case"MultiLineString":return new _geom.MultiLineString(e.getFlatCoordinates(),"XY",e.getEnds());case"Polygon":var r=e.getFlatCoordinates(),i=e.getEnds(),n=(0,_orient.inflateEnds)(r,i);return n.length>1?new _geom.MultiPolygon(r,"XY",n):new _geom.Polygon(r,"XY",i);default:throw new Error("Invalid geometry type:"+t)}}function toFeature(e,t){var r=e.getId(),i=toGeometry(e),n=e.getProperties(),o=new _Feature.default;return void 0!==t&&o.setGeometryName(t),o.setGeometry(i),void 0!==r&&o.setId(r),o.setProperties(n,!0),o}RenderFeature.prototype.getFlatCoordinates=RenderFeature.prototype.getOrientedFlatCoordinates;var _default=exports.default=RenderFeature;

},{"../Feature.js":82,"../array.js":110,"../extent.js":142,"../functions.js":200,"../geom.js":201,"../geom/flat/center.js":214,"../geom/flat/interiorpoint.js":221,"../geom/flat/interpolate.js":222,"../geom/flat/orient.js":226,"../geom/flat/simplify.js":229,"../geom/flat/transform.js":232,"../proj.js":283,"../transform.js":402}],296:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var VectorContext=function(){return _createClass(function e(){_classCallCheck(this,e)},[{key:"drawCustom",value:function(e,t,o,n,r){}},{key:"drawGeometry",value:function(e){}},{key:"setStyle",value:function(e){}},{key:"drawCircle",value:function(e,t,o){}},{key:"drawFeature",value:function(e,t,o){}},{key:"drawGeometryCollection",value:function(e,t,o){}},{key:"drawLineString",value:function(e,t,o){}},{key:"drawMultiLineString",value:function(e,t,o){}},{key:"drawMultiPoint",value:function(e,t,o){}},{key:"drawMultiPolygon",value:function(e,t,o){}},{key:"drawPoint",value:function(e,t,o){}},{key:"drawPolygon",value:function(e,t,o){}},{key:"drawText",value:function(e,t,o){}},{key:"setFillStrokeStyle",value:function(e,t){}},{key:"setImageStyle",value:function(e,t){}},{key:"setTextStyle",value:function(e,t){}}])}(),_default=exports.default=VectorContext;

},{}],297:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultTextBaseline=exports.defaultTextAlign=exports.defaultStrokeStyle=exports.defaultPadding=exports.defaultMiterLimit=exports.defaultLineWidth=exports.defaultLineJoin=exports.defaultLineDashOffset=exports.defaultLineDash=exports.defaultLineCap=exports.defaultFont=exports.defaultFillStyle=exports.checkedFonts=void 0,exports.drawImageOrLabel=drawImageOrLabel,exports.getTextDimensions=getTextDimensions,exports.measureAndCacheTextWidth=measureAndCacheTextWidth,exports.measureTextHeight=void 0,exports.measureTextWidth=measureTextWidth,exports.registerFont=void 0,exports.rotateAtOffset=rotateAtOffset,exports.textHeights=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_has=require("../has.js"),_obj=require("../obj.js"),_dom=require("../dom.js"),_css=require("../css.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var measureFont,defaultFont=exports.defaultFont="10px sans-serif",defaultFillStyle=exports.defaultFillStyle="#000",defaultLineCap=exports.defaultLineCap="round",defaultLineDash=exports.defaultLineDash=[],defaultLineDashOffset=exports.defaultLineDashOffset=0,defaultLineJoin=exports.defaultLineJoin="round",defaultMiterLimit=exports.defaultMiterLimit=10,defaultStrokeStyle=exports.defaultStrokeStyle="#000",defaultTextAlign=exports.defaultTextAlign="center",defaultTextBaseline=exports.defaultTextBaseline="middle",defaultPadding=exports.defaultPadding=[0,0,0,0],defaultLineWidth=exports.defaultLineWidth=1,checkedFonts=exports.checkedFonts=new _Object.default,measureContext=null,textHeights=exports.textHeights={},registerFont=exports.registerFont=function(){var e,t,r=100,s="32px ",a=["monospace","serif"],n=a.length,o="wmytzilWMYTZIL@#/&?$%10ï";function i(e,r,i){for(var u=!0,l=0;l<n;++l){var d=a[l];if(t=measureTextWidth(e+" "+r+" "+s+d,o),i!=d){var x=measureTextWidth(e+" "+r+" "+s+i+","+d,o);u=u&&x!=t}}return!!u}function u(){for(var t=!0,s=checkedFonts.getKeys(),a=0,n=s.length;a<n;++a){var o=s[a];checkedFonts.get(o)<r&&(i.apply(this,o.split("\n"))?((0,_obj.clear)(textHeights),measureContext=null,measureFont=void 0,checkedFonts.set(o,r)):(checkedFonts.set(o,checkedFonts.get(o)+1,!0),t=!1))}t&&(clearInterval(e),e=void 0)}return function(t){var s=(0,_css.getFontParameters)(t);if(s)for(var a=s.families,n=0,o=a.length;n<o;++n){var l=a[n],d=s.style+"\n"+s.weight+"\n"+l;void 0===checkedFonts.get(d)&&(checkedFonts.set(d,r,!0),i(s.style,s.weight,l)||(checkedFonts.set(d,0,!0),void 0===e&&(e=setInterval(u,32))))}}}(),measureTextHeight=exports.measureTextHeight=function(){var e;return function(t){var r=textHeights[t];if(null==r){if(_has.WORKER_OFFSCREEN_CANVAS){var s=(0,_css.getFontParameters)(t),a=measureText(t,"Å½g");r=(isNaN(Number(s.lineHeight))?1.2:Number(s.lineHeight))*(a.actualBoundingBoxAscent+a.actualBoundingBoxDescent)}else e||((e=document.createElement("div")).innerHTML="M",e.style.minHeight="0",e.style.maxHeight="none",e.style.height="auto",e.style.padding="0",e.style.border="none",e.style.position="absolute",e.style.display="block",e.style.left="-99999px"),e.style.font=t,document.body.appendChild(e),r=e.offsetHeight,document.body.removeChild(e);textHeights[t]=r}return r}}();function measureText(e,t){return measureContext||(measureContext=(0,_dom.createCanvasContext2D)(1,1)),e!=measureFont&&(measureContext.font=e,measureFont=measureContext.font),measureContext.measureText(t)}function measureTextWidth(e,t){return measureText(e,t).width}function measureAndCacheTextWidth(e,t,r){if(t in r)return r[t];var s=t.split("\n").reduce(function(t,r){return Math.max(t,measureTextWidth(e,r))},0);return r[t]=s,s}function getTextDimensions(e,t){for(var r=[],s=[],a=[],n=0,o=0,i=0,u=0,l=0,d=t.length;l<=d;l+=2){var x=t[l];if("\n"!==x&&l!==d){var f=t[l+1]||e.font,h=measureTextWidth(f,x);r.push(h),o+=h;var c=measureTextHeight(f);s.push(c),u=Math.max(u,c)}else n=Math.max(n,o),a.push(o),o=0,i+=u,u=0}return{width:n,height:i,widths:r,heights:s,lineWidths:a}}function rotateAtOffset(e,t,r,s){0!==t&&(e.translate(r,s),e.rotate(t),e.translate(-r,-s))}function drawImageOrLabel(e,t,r,s,a,n,o,i,u,l,d){e.save(),1!==r&&(void 0===e.globalAlpha?e.globalAlpha=function(e){return e.globalAlpha*=r}:e.globalAlpha*=r),t&&e.transform.apply(e,t),s.contextInstructions?(e.translate(u,l),e.scale(d[0],d[1]),executeLabelInstructions(s,e)):d[0]<0||d[1]<0?(e.translate(u,l),e.scale(d[0],d[1]),e.drawImage(s,a,n,o,i,0,0,o,i)):e.drawImage(s,a,n,o,i,u,l,o*d[0],i*d[1]),e.restore()}function executeLabelInstructions(e,t){for(var r=e.contextInstructions,s=0,a=r.length;s<a;s+=2)Array.isArray(r[s+1])?t[r[s]].apply(t,r[s+1]):t[r[s]]=r[s+1]}

},{"../Object.js":96,"../css.js":129,"../dom.js":130,"../has.js":233,"../obj.js":281}],298:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Instruction=_interopRequireDefault(require("./Instruction.js")),_Relationship=_interopRequireDefault(require("../../extent/Relationship.js")),_VectorContext2=_interopRequireDefault(require("../VectorContext.js")),_colorlike=require("../../colorlike.js"),_extent=require("../../extent.js"),_canvas=require("../canvas.js"),_array=require("../../array.js"),_inflate=require("../../geom/flat/inflate.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasBuilder=function(t){function e(t,i,n,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).tolerance=t,o.maxExtent=i,o.pixelRatio=r,o.maxLineWidth=0,o.resolution=n,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return _inherits(e,_VectorContext2["default"]),_createClass(e,[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}},{key:"appendFlatPointCoordinates",value:function(t,e){for(var i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates,o=r.length,s=0,a=t.length;s<a;s+=e)n[0]=t[s],n[1]=t[s+1],(0,_extent.containsCoordinate)(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}},{key:"appendFlatLineCoordinates",value:function(t,e,i,n,r,o){var s=this.coordinates,a=s.length,u=this.getBufferedMaxExtent();o&&(e+=n);var l,c,f,h=t[e],d=t[e+1],_=this.tmpCoordinate_,p=!0;for(l=e+n;l<i;l+=n)_[0]=t[l],_[1]=t[l+1],(f=(0,_extent.coordinateRelationship)(u,_))!==c?(p&&(s[a++]=h,s[a++]=d,p=!1),s[a++]=_[0],s[a++]=_[1]):f===_Relationship.default.INTERSECTING?(s[a++]=_[0],s[a++]=_[1],p=!1):p=!0,h=_[0],d=_[1],c=f;return(r&&p||l===e+n)&&(s[a++]=h,s[a++]=d),a}},{key:"drawCustomCoordinates_",value:function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],u=this.appendFlatLineCoordinates(t,e,a,n,!1,!1);r.push(u),e=a}return e}},{key:"drawCustom",value:function(t,e,i,n,r){this.beginGeometry(t,e,r);var o,s,a,u,l,c=t.getType(),f=t.getStride(),h=this.coordinates.length;switch(c){case"MultiPolygon":o=t.getOrientedFlatCoordinates(),u=[];var d=t.getEndss();l=0;for(var _=0,p=d.length;_<p;++_){var y=[];l=this.drawCustomCoordinates_(o,l,d[_],f,y),u.push(y)}this.instructions.push([_Instruction.default.CUSTOM,h,u,t,i,_inflate.inflateMultiCoordinatesArray,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,u,t,n||i,_inflate.inflateMultiCoordinatesArray,r]);break;case"Polygon":case"MultiLineString":a=[],o="Polygon"==c?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),l=this.drawCustomCoordinates_(o,0,t.getEnds(),f,a),this.instructions.push([_Instruction.default.CUSTOM,h,a,t,i,_inflate.inflateCoordinatesArray,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,a,t,n||i,_inflate.inflateCoordinatesArray,r]);break;case"LineString":case"Circle":o=t.getFlatCoordinates(),s=this.appendFlatLineCoordinates(o,0,o.length,f,!1,!1),this.instructions.push([_Instruction.default.CUSTOM,h,s,t,i,_inflate.inflateCoordinates,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,s,t,n||i,_inflate.inflateCoordinates,r]);break;case"MultiPoint":o=t.getFlatCoordinates(),(s=this.appendFlatPointCoordinates(o,f))>h&&(this.instructions.push([_Instruction.default.CUSTOM,h,s,t,i,_inflate.inflateCoordinates,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,s,t,n||i,_inflate.inflateCoordinates,r]));break;case"Point":o=t.getFlatCoordinates(),this.coordinates.push(o[0],o[1]),s=this.coordinates.length,this.instructions.push([_Instruction.default.CUSTOM,h,s,t,i,void 0,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,s,t,n||i,void 0,r])}this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e,i){this.beginGeometryInstruction1_=[_Instruction.default.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[_Instruction.default.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==_Instruction.default.END_GEOMETRY?o=t:n==_Instruction.default.BEGIN_GEOMETRY&&(i[2]=t,(0,_array.reverseSubArray)(this.hitDetectionInstructions,o,t),o=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillPatternScale=n&&"object"===_typeof(n)&&"src"in n?this.pixelRatio:1,i.fillStyle=(0,_colorlike.asColorLike)(n||_canvas.defaultFillStyle)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=(0,_colorlike.asColorLike)(r||_canvas.defaultStrokeStyle);var o=e.getLineCap();i.lineCap=void 0!==o?o:_canvas.defaultLineCap;var s=e.getLineDash();i.lineDash=s?s.slice():_canvas.defaultLineDash;var a=e.getLineDashOffset();i.lineDashOffset=a||_canvas.defaultLineDashOffset;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:_canvas.defaultLineJoin;var l=e.getWidth();i.lineWidth=void 0!==l?l:_canvas.defaultLineWidth;var c=e.getMiterLimit();i.miterLimit=void 0!==c?c:_canvas.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,i=[_Instruction.default.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[_Instruction.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}},{key:"updateStrokeStyle",value:function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!(0,_array.equals)(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[_Instruction.default.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,_extent.clone)(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;(0,_extent.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}])}(),_default=exports.default=CanvasBuilder;

},{"../../array.js":110,"../../colorlike.js":114,"../../extent.js":142,"../../extent/Relationship.js":143,"../../geom/flat/inflate.js":220,"../VectorContext.js":296,"../canvas.js":297,"./Instruction.js":304}],299:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_ImageBuilder=_interopRequireDefault(require("./ImageBuilder.js")),_LineStringBuilder=_interopRequireDefault(require("./LineStringBuilder.js")),_PolygonBuilder=_interopRequireDefault(require("./PolygonBuilder.js")),_TextBuilder=_interopRequireDefault(require("./TextBuilder.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var BATCH_CONSTRUCTORS={Circle:_PolygonBuilder.default,Default:_Builder.default,Image:_ImageBuilder.default,LineString:_LineStringBuilder.default,Polygon:_PolygonBuilder.default,Text:_TextBuilder.default},BuilderGroup=function(){return _createClass(function e(r,t,i,o){_classCallCheck(this,e),this.tolerance_=r,this.maxExtent_=t,this.pixelRatio_=o,this.resolution_=i,this.buildersByZIndex_={}},[{key:"finish",value:function(){var e={};for(var r in this.buildersByZIndex_){e[r]=e[r]||{};var t=this.buildersByZIndex_[r];for(var i in t){var o=t[i].finish();e[r][i]=o}}return e}},{key:"getBuilder",value:function(e,r){var t=void 0!==e?e.toString():"0",i=this.buildersByZIndex_[t];void 0===i&&(i={},this.buildersByZIndex_[t]=i);var o=i[r];void 0===o&&(o=new(0,BATCH_CONSTRUCTORS[r])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[r]=o);return o}}])}(),_default=exports.default=BuilderGroup;

},{"./Builder.js":298,"./ImageBuilder.js":302,"./LineStringBuilder.js":305,"./PolygonBuilder.js":306,"./TextBuilder.js":307}],300:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Instruction=_interopRequireDefault(require("./Instruction.js")),_ZIndexContext=_interopRequireDefault(require("../canvas/ZIndexContext.js")),_TextBuilder=require("./TextBuilder.js"),_transform=require("../../transform.js"),_extent=require("../../extent.js"),_canvas=require("../canvas.js"),_textpath=require("../../geom/flat/textpath.js"),_array=require("../../array.js"),_length=require("../../geom/flat/length.js"),_transform2=require("../../geom/flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tmpExtent=(0,_extent.createEmpty)(),p1=[],p2=[],p3=[],p4=[];function getDeclutterBox(t){return t[3].declutterBox}var rtlRegEx=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function horizontalTextAlign(t,e){return"start"===e?e=rtlRegEx.test(t)?"right":"left":"end"===e&&(e=rtlRegEx.test(t)?"left":"right"),_TextBuilder.TEXT_ALIGN[e]}function createTextChunks(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}var Executor=function(){return _createClass(function t(e,i,r,a,n){_classCallCheck(this,t),this.overlaps=r,this.pixelRatio=i,this.resolution=e,this.alignAndScaleFill_,this.instructions=a.instructions,this.coordinates=a.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,_transform.create)(),this.hitDetectionInstructions=a.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=a.fillStates||{},this.strokeStates=a.strokeStates||{},this.textStates=a.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=n?new _ZIndexContext.default:null},[{key:"getZIndexContext",value:function(){return this.zIndexContext_}},{key:"createLabel",value:function(t,e,i,r){var a=t+e+i+r;if(this.labels_[a])return this.labels_[a];var n=r?this.strokeStates[r]:null,s=i?this.fillStates[i]:null,o=this.textStates[e],l=this.pixelRatio,h=[o.scale[0]*l,o.scale[1]*l],u=Array.isArray(t),c=o.justify?_TextBuilder.TEXT_ALIGN[o.justify]:horizontalTextAlign(Array.isArray(t)?t[0]:t,o.textAlign||_canvas.defaultTextAlign),d=r&&n.lineWidth?n.lineWidth:0,p=u?t:t.split("\n").reduce(createTextChunks,[]),f=(0,_canvas.getTextDimensions)(o,p),_=f.width,v=f.height,m=f.widths,x=f.heights,g=f.lineWidths,y=_+d,b=[],I=(y+2)*h[0],T=(v+d)*h[1],S={width:I<0?Math.floor(I):Math.ceil(I),height:T<0?Math.floor(T):Math.ceil(T),contextInstructions:b};1==h[0]&&1==h[1]||b.push("scale",h),r&&(b.push("strokeStyle",n.strokeStyle),b.push("lineWidth",d),b.push("lineCap",n.lineCap),b.push("lineJoin",n.lineJoin),b.push("miterLimit",n.miterLimit),b.push("setLineDash",[n.lineDash]),b.push("lineDashOffset",n.lineDashOffset)),i&&b.push("fillStyle",s.fillStyle),b.push("textBaseline","middle"),b.push("textAlign","center");for(var C,k=.5-c,w=c*y+k*d,E=[],A=[],L=0,M=0,R=0,O=0,P=0,D=p.length;P<D;P+=2){var B=p[P];if("\n"!==B){var j=p[P+1]||o.font;j!==C&&(r&&E.push("font",j),i&&A.push("font",j),C=j),L=Math.max(L,x[R]);var q=[B,w+k*m[R]+c*(m[R]-g[O]),.5*(d+L)+M];w+=m[R],r&&E.push("strokeText",q),i&&A.push("fillText",q),++R}else M+=L,L=0,w=c*y+k*d,++O}return Array.prototype.push.apply(b,E),Array.prototype.push.apply(b,A),this.labels_[a]=S,S}},{key:"replayTextBackground_",value:function(t,e,i,r,a,n,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,a),t.lineTo.apply(t,e),n&&(this.alignAndScaleFill_=n[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(t,e,i,r,a,n,s,o,l,h,u,c,d,p,f,_){var v,m=i-(s*=c[0]),x=r-(o*=c[1]),g=a+l>t?t-l:a,y=n+h>e?e-h:n,b=p[3]+g*c[0]+p[1],I=p[0]+y*c[1]+p[2],T=m-p[3],S=x-p[0];return(f||0!==u)&&(p1[0]=T,p4[0]=T,p1[1]=S,p2[1]=S,p2[0]=T+b,p3[0]=p2[0],p3[1]=S+I,p4[1]=p3[1]),0!==u?(v=(0,_transform.compose)((0,_transform.create)(),i,r,1,1,u,-i,-r),(0,_transform.apply)(v,p1),(0,_transform.apply)(v,p2),(0,_transform.apply)(v,p3),(0,_transform.apply)(v,p4),(0,_extent.createOrUpdate)(Math.min(p1[0],p2[0],p3[0],p4[0]),Math.min(p1[1],p2[1],p3[1],p4[1]),Math.max(p1[0],p2[0],p3[0],p4[0]),Math.max(p1[1],p2[1],p3[1],p4[1]),tmpExtent)):(0,_extent.createOrUpdate)(Math.min(T,T+b),Math.min(S,S+I),Math.max(T,T+b),Math.max(S,S+I),tmpExtent),d&&(m=Math.round(m),x=Math.round(x)),{drawImageX:m,drawImageY:x,drawImageW:g,drawImageH:y,originX:l,originY:h,declutterBox:{minX:tmpExtent[0],minY:tmpExtent[1],maxX:tmpExtent[2],maxY:tmpExtent[3],value:_},canvasTransform:v,scale:c}}},{key:"replayImageOrLabel_",value:function(t,e,i,r,a,n,s){var o=!(!n&&!s),l=r.declutterBox,h=s?s[2]*r.scale[0]/2:0;return l.minX-h<=e[0]&&l.maxX+h>=0&&l.minY-h<=e[1]&&l.maxY+h>=0&&(o&&this.replayTextBackground_(t,p1,p2,p3,p4,n,s),(0,_canvas.drawImageOrLabel)(t,r.canvasTransform,a,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}},{key:"fill_",value:function(t){var e=this.alignAndScaleFill_;if(e){var i=(0,_transform.apply)(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}},{key:"drawLabelWithPointPlacement_",value:function(t,e,i,r){var a=this.textStates[e],n=this.createLabel(t,e,r,i),s=this.strokeStates[i],o=this.pixelRatio,l=horizontalTextAlign(Array.isArray(t)?t[0]:t,a.textAlign||_canvas.defaultTextAlign),h=_TextBuilder.TEXT_ALIGN[a.textBaseline||_canvas.defaultTextBaseline],u=s&&s.lineWidth?s.lineWidth:0;return{label:n,anchorX:l*(n.width/o-2*a.scale[0])+2*(.5-l)*u,anchorY:h*n.height/o+2*(.5-h)*u}}},{key:"execute_",value:function(t,e,i,r,a,n,s,o){var l,h=this.zIndexContext_;this.pixelCoordinates_&&(0,_array.equals)(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=(0,_transform2.transform2D)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,_transform.setFromArray)(this.renderedTransform_,i));for(var u,c,d,p,f,_,v,m,x,g,y,b,I,T,S,C,k,w=0,E=r.length,A=0,L=0,M=0,R=null,O=null,P=this.coordinateCache_,D=this.viewRotation_,B=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,j={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:D},q=this.instructions!=r||this.overlaps?0:200;w<E;){var W=r[w];switch(W[0]){case _Instruction.default.BEGIN_GEOMETRY:T=W[1],k=W[3],T.getGeometry()?void 0===s||(0,_extent.intersects)(s,k.getExtent())?++w:w=W[2]+1:w=W[2],h&&(h.zIndex=W[4]);break;case _Instruction.default.BEGIN_PATH:L>q&&(this.fill_(t),L=0),M>q&&(t.stroke(),M=0),L||M||(t.beginPath(),f=NaN,_=NaN),++w;break;case _Instruction.default.CIRCLE:var Y=l[A=W[1]],X=l[A+1],N=l[A+2]-Y,z=l[A+3]-X,G=Math.sqrt(N*N+z*z);t.moveTo(Y+G,X),t.arc(Y,X,G,0,2*Math.PI,!0),++w;break;case _Instruction.default.CLOSE_PATH:t.closePath(),++w;break;case _Instruction.default.CUSTOM:A=W[1],u=W[2];var F=W[3],H=W[4],K=W[5];j.geometry=F,j.feature=T,w in P||(P[w]=[]);var Z=P[w];K?K(l,A,u,2,Z):(Z[0]=l[A],Z[1]=l[A+1],Z.length=2),h&&(h.zIndex=W[6]),H(Z,j),++w;break;case _Instruction.default.DRAW_IMAGE:A=W[1],u=W[2],x=W[3],c=W[4],d=W[5];var J=W[6],U=W[7],V=W[8],Q=W[9],$=W[10],tt=W[11],et=W[12],it=W[13];p=W[14]||"declutter";var rt=W[15];if(!x&&W.length>=20){g=W[19],y=W[20],b=W[21],I=W[22];var at=this.drawLabelWithPointPlacement_(g,y,b,I);x=at.label,W[3]=x;var nt=W[23];c=(at.anchorX-nt)*this.pixelRatio,W[4]=c;var st=W[24];d=(at.anchorY-st)*this.pixelRatio,W[5]=d,J=x.height,W[6]=J,it=x.width,W[13]=it}var ot=void 0;W.length>25&&(ot=W[25]);var lt=void 0,ht=void 0,ut=void 0;W.length>17?(lt=W[16],ht=W[17],ut=W[18]):(lt=_canvas.defaultPadding,ht=!1,ut=!1),$&&B?tt+=D:$||B||(tt-=D);for(var ct=0;A<u;A+=2)if(!(ot&&ot[ct++]<it/this.pixelRatio)){var dt=this.calculateImageOrLabelDimensions_(x.width,x.height,l[A],l[A+1],it,J,c,d,V,Q,tt,et,a,lt,ht||ut,T),pt=[t,e,x,dt,U,ht?R:null,ut?O:null];if(o){var ft=void 0,_t=void 0,vt=void 0;if(rt){var mt=u-A;if(!rt[mt]){rt[mt]={args:pt,declutterMode:p};continue}var xt=rt[mt];ft=xt.args,_t=xt.declutterMode,delete rt[mt],vt=getDeclutterBox(ft)}var gt=void 0,yt=void 0;if(!ft||"declutter"===_t&&o.collides(vt)||(gt=!0),"declutter"===p&&o.collides(dt.declutterBox)||(yt=!0),"declutter"===_t&&"declutter"===p){var bt=gt&&yt;gt=bt,yt=bt}gt&&("none"!==_t&&o.insert(vt),this.replayImageOrLabel_.apply(this,ft)),yt&&("none"!==p&&o.insert(dt.declutterBox),this.replayImageOrLabel_.apply(this,pt))}else this.replayImageOrLabel_.apply(this,pt)}++w;break;case _Instruction.default.DRAW_CHARS:var It=W[1],Tt=W[2],St=W[3],Ct=W[4];I=W[5];var kt=W[6],wt=W[7],Et=W[8];b=W[9];var At=W[10];g=W[11],y=W[12];var Lt=[W[13],W[13]];p=W[14]||"declutter";var Mt=this.textStates[y],Rt=Mt.font,Ot=[Mt.scale[0]*wt,Mt.scale[1]*wt],Pt=void 0;Rt in this.widths_?Pt=this.widths_[Rt]:(Pt={},this.widths_[Rt]=Pt);var Dt=(0,_length.lineStringLength)(l,It,Tt,2),Bt=Math.abs(Ot[0])*(0,_canvas.measureAndCacheTextWidth)(Rt,g,Pt);if(Ct||Bt<=Dt){var jt=(Dt-Bt)*horizontalTextAlign(g,this.textStates[y].textAlign),qt=(0,_textpath.drawTextOnPath)(l,It,Tt,2,g,jt,kt,Math.abs(Ot[0]),_canvas.measureAndCacheTextWidth,Rt,Pt,B?0:this.viewRotation_);t:if(qt){var Wt=[],Yt=void 0,Xt=void 0,Nt=void 0,zt=void 0,Gt=void 0;if(b)for(Yt=0,Xt=qt.length;Yt<Xt;++Yt){Nt=(Gt=qt[Yt])[4],zt=this.createLabel(Nt,y,"",b),c=Gt[2]+(Ot[0]<0?-At:At),d=St*zt.height+2*(.5-St)*At*Ot[1]/Ot[0]-Et;var Ft=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Gt[0],Gt[1],zt.width,zt.height,c,d,0,0,Gt[3],Lt,!1,_canvas.defaultPadding,!1,T);if(o&&"declutter"===p&&o.collides(Ft.declutterBox))break t;Wt.push([t,e,zt,Ft,1,null,null])}if(I)for(Yt=0,Xt=qt.length;Yt<Xt;++Yt){Nt=(Gt=qt[Yt])[4],zt=this.createLabel(Nt,y,I,""),c=Gt[2],d=St*zt.height-Et;var Ht=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Gt[0],Gt[1],zt.width,zt.height,c,d,0,0,Gt[3],Lt,!1,_canvas.defaultPadding,!1,T);if(o&&"declutter"===p&&o.collides(Ht.declutterBox))break t;Wt.push([t,e,zt,Ht,1,null,null])}o&&"none"!==p&&o.load(Wt.map(getDeclutterBox));for(var Kt=0,Zt=Wt.length;Kt<Zt;++Kt)this.replayImageOrLabel_.apply(this,Wt[Kt])}}++w;break;case _Instruction.default.END_GEOMETRY:if(void 0!==n){var Jt=n(T=W[1],k,p);if(Jt)return Jt}++w;break;case _Instruction.default.FILL:q?L++:this.fill_(t),++w;break;case _Instruction.default.MOVE_TO_LINE_TO:for(A=W[1],u=W[2],S=l[A],C=l[A+1],t.moveTo(S,C),f=S+.5|0,_=C+.5|0,A+=2;A<u;A+=2)v=(S=l[A])+.5|0,m=(C=l[A+1])+.5|0,A!=u-2&&v===f&&m===_||(t.lineTo(S,C),f=v,_=m);++w;break;case _Instruction.default.SET_FILL_STYLE:R=W,this.alignAndScaleFill_=W[2],L&&(this.fill_(t),L=0,M&&(t.stroke(),M=0)),t.fillStyle=W[1],++w;break;case _Instruction.default.SET_STROKE_STYLE:O=W,M&&(t.stroke(),M=0),this.setStrokeStyle_(t,W),++w;break;case _Instruction.default.STROKE:q?M++:t.stroke(),++w;break;default:++w}}L&&this.fill_(t),M&&t.stroke()}},{key:"execute",value:function(t,e,i,r,a,n){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,a,void 0,void 0,n)}},{key:"executeHitDetection",value:function(t,e,i,r,a){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,a)}}])}(),_default=exports.default=Executor;

},{"../../array.js":110,"../../extent.js":142,"../../geom/flat/length.js":224,"../../geom/flat/textpath.js":231,"../../geom/flat/transform.js":232,"../../transform.js":402,"../canvas.js":297,"../canvas/ZIndexContext.js":308,"./Instruction.js":304,"./TextBuilder.js":307}],301:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.NON_DECLUTTER=exports.DECLUTTER=exports.ALL=void 0,exports.getPixelIndexArray=getPixelIndexArray;var _Executor=_interopRequireDefault(require("./Executor.js")),_array=require("../../array.js"),_extent=require("../../extent.js"),_transform=require("../../transform.js"),_dom=require("../../dom.js"),_obj=require("../../obj.js"),_transform2=require("../../geom/flat/transform.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var ALL=exports.ALL=["Polygon","Circle","LineString","Image","Text","Default"],DECLUTTER=exports.DECLUTTER=["Image","Text"],NON_DECLUTTER=exports.NON_DECLUTTER=ALL.filter(function(e){return!DECLUTTER.includes(e)}),ExecutorGroup=function(){return _createClass(function e(r,t,n,o,i,a,u){_classCallCheck(this,e),this.maxExtent_=r,this.overlaps_=o,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,_transform.create)(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(i,u)},[{key:"clip",value:function(e,r){var t=this.getClipCoords(r);e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.clip()}},{key:"createExecutors_",value:function(e,r){for(var t in e){var n=this.executorsByZIndex_[t];void 0===n&&(n={},this.executorsByZIndex_[t]=n);var o=e[t];for(var i in o){var a=o[i];n[i]=new _Executor.default(this.resolution_,this.pixelRatio_,this.overlaps_,a,r)}}}},{key:"hasExecutors",value:function(e){for(var r in this.executorsByZIndex_)for(var t=this.executorsByZIndex_[r],n=0,o=e.length;n<o;++n)if(e[n]in t)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(e,r,t,n,o,i){var a=2*(n=Math.round(n))+1,u=(0,_transform.compose)(this.hitDetectionTransform_,n+.5,n+.5,1/r,-1/r,-t,-e[0],-e[1]),s=!this.hitDetectionContext_;s&&(this.hitDetectionContext_=(0,_dom.createCanvasContext2D)(a,a,void 0,{willReadFrequently:!0}));var l,c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):s||c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(l=(0,_extent.createEmpty)(),(0,_extent.extendCoordinate)(l,e),(0,_extent.buffer)(l,r*(this.renderBuffer_+n),l));var f,d=getPixelIndexArray(n);function x(e,r,t){for(var u=c.getImageData(0,0,a,a).data,s=0,l=d.length;s<l;s++)if(u[d[s]]>0){if(!i||"none"===t||"Image"!==f&&"Text"!==f||i.includes(e)){var x=(d[s]-3)/4,y=n-x%a,_=n-(x/a|0),h=o(e,r,y*y+_*_);if(h)return h}c.clearRect(0,0,a,a);break}}var y,_,h,v,p,m=Object.keys(this.executorsByZIndex_).map(Number);for(m.sort(_array.ascending),y=m.length-1;y>=0;--y){var b=m[y].toString();for(h=this.executorsByZIndex_[b],_=ALL.length-1;_>=0;--_)if(void 0!==(v=h[f=ALL[_]])&&(p=v.executeHitDetection(c,u,t,x,l)))return p}}},{key:"getClipCoords",value:function(e){var r=this.maxExtent_;if(!r)return null;var t=r[0],n=r[1],o=r[2],i=r[3],a=[t,n,t,i,o,i,o,n];return(0,_transform2.transform2D)(a,0,8,2,e,a),a}},{key:"isEmpty",value:function(){return(0,_obj.isEmpty)(this.executorsByZIndex_)}},{key:"execute",value:function(e,r,t,n,o,i,a){var u=this,s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(_array.ascending),i=i||ALL;var l,c,f,d,x,y=ALL.length;for(a&&s.reverse(),l=0,c=s.length;l<c;++l){var _=s[l].toString();x=this.executorsByZIndex_[_];var h=function(){var c=i[f],d=x[c];if(void 0!==d){var _=null===a?void 0:d.getZIndexContext(),h=_?_.getContext():e,v=u.maxExtent_&&"Image"!==c&&"Text"!==c;if(v&&(h.save(),u.clip(h,t)),_&&"Text"!==c&&"Image"!==c?_.pushFunction(function(e){return d.execute(e,r,t,n,o,a)}):d.execute(h,r,t,n,o,a),v&&h.restore(),_){_.offset();var p=s[l]*y+f;u.deferredZIndexContexts_[p]||(u.deferredZIndexContexts_[p]=[]),u.deferredZIndexContexts_[p].push(_)}}};for(f=0,d=i.length;f<d;++f)h()}this.renderedContext_=e}},{key:"getDeferredZIndexContexts",value:function(){return this.deferredZIndexContexts_}},{key:"getRenderedContext",value:function(){return this.renderedContext_}},{key:"renderDeferred",value:function(){for(var e=this,r=this.deferredZIndexContexts_,t=Object.keys(r).map(Number).sort(_array.ascending),n=0,o=t.length;n<o;++n)r[t[n]].forEach(function(r){r.draw(e.renderedContext_),r.clear()}),r[t[n]].length=0}}])}(),circlePixelIndexArrayCache={};function getPixelIndexArray(e){if(void 0!==circlePixelIndexArrayCache[e])return circlePixelIndexArrayCache[e];for(var r=2*e+1,t=e*e,n=new Array(t+1),o=0;o<=e;++o)for(var i=0;i<=e;++i){var a=o*o+i*i;if(a>t)break;var u=n[a];u||(u=[],n[a]=u),u.push(4*((e+o)*r+(e+i))+3),o>0&&u.push(4*((e-o)*r+(e+i))+3),i>0&&(u.push(4*((e+o)*r+(e-i))+3),o>0&&u.push(4*((e-o)*r+(e-i))+3))}for(var s=[],l=0,c=n.length;l<c;++l)n[l]&&s.push.apply(s,_toConsumableArray(n[l]));return circlePixelIndexArrayCache[e]=s,s}var _default=exports.default=ExecutorGroup;

},{"../../array.js":110,"../../dom.js":130,"../../extent.js":142,"../../geom/flat/transform.js":232,"../../obj.js":281,"../../transform.js":402,"./Executor.js":300}],302:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireDefault(require("./Instruction.js")),_extent=require("../../extent.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var o=_superPropBase(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasImageBuilder=function(t){function e(t,i,o,r){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,[t,i,o,r])).hitDetectionImage_=null,n.image_=null,n.imagePixelRatio_=void 0,n.anchorX_=void 0,n.anchorY_=void 0,n.height_=void 0,n.opacity_=void 0,n.originX_=void 0,n.originY_=void 0,n.rotateWithView_=void 0,n.rotation_=void 0,n.scale_=void 0,n.width_=void 0,n.declutterMode_=void 0,n.declutterImageWithText_=void 0,n}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"drawPoint",value:function(t,e,i){if(this.image_&&(!this.maxExtent||(0,_extent.containsCoordinate)(this.maxExtent,t.getFlatCoordinates()))){this.beginGeometry(t,e,i);var o=t.getFlatCoordinates(),r=t.getStride(),n=this.coordinates.length,s=this.appendFlatPointCoordinates(o,r);this.instructions.push([_Instruction.default.DRAW_IMAGE,n,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([_Instruction.default.DRAW_IMAGE,n,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e,i){if(this.image_){this.beginGeometry(t,e,i);for(var o=t.getFlatCoordinates(),r=[],n=0,s=o.length;n<s;n+=t.getStride())this.maxExtent&&!(0,_extent.containsCoordinate)(this.maxExtent,o.slice(n,n+2))||r.push(o[n],o[n+1]);var a=this.coordinates.length,h=this.appendFlatPointCoordinates(r,2);this.instructions.push([_Instruction.default.DRAW_IMAGE,a,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([_Instruction.default.DRAW_IMAGE,a,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,_get(_getPrototypeOf(e.prototype),"finish",this).call(this)}},{key:"setImageStyle",value:function(t,e){var i=t.getAnchor(),o=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=o[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=o[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])}(),_default=exports.default=CanvasImageBuilder;

},{"../../extent.js":142,"./Builder.js":298,"./Instruction.js":304}],303:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _VectorContext2=_interopRequireDefault(require("../VectorContext.js")),_colorlike=require("../../colorlike.js"),_transform=require("../../transform.js"),_canvas=require("../canvas.js"),_array=require("../../array.js"),_extent=require("../../extent.js"),_math=require("../../math.js"),_transform2=require("../../geom/flat/transform.js"),_SimpleGeometry=require("../../geom/SimpleGeometry.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,_toPropertyKey(a.key),a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var a=i.call(t,e||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasImmediateRenderer=function(t){function e(t,i,a,r,s,n,o){var l;return _classCallCheck(this,e),(l=_callSuper(this,e)).context_=t,l.pixelRatio_=i,l.extent_=a,l.transform_=r,l.transformRotation_=r?(0,_math.toFixed)(Math.atan2(r[1],r[0]),10):0,l.viewRotation_=s,l.squaredTolerance_=n,l.userTransform_=o,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=(0,_transform.create)(),l}return _inherits(e,_VectorContext2["default"]),_createClass(e,[{key:"drawImages_",value:function(t,e,i,a){if(this.image_){var r=(0,_transform2.transform2D)(t,e,i,a,this.transform_,this.pixelCoordinates_),s=this.context_,n=this.tmpLocalTransform_,o=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=o*this.imageOpacity_);var l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(var h=0,_=r.length;h<_;h+=2){var f=r[h]-this.imageAnchorX_,c=r[h+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var u=f+this.imageAnchorX_,g=c+this.imageAnchorY_;(0,_transform.compose)(n,u,g,1,1,l,-u,-g),s.save(),s.transform.apply(s,n),s.translate(u,g),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,c,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=o)}}},{key:"drawText_",value:function(t,e,i,a){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=(0,_transform2.transform2D)(t,e,i,a,this.transform_,this.pixelCoordinates_),s=this.context_,n=this.textRotation_;for(0===this.transformRotation_&&(n-=this.viewRotation_),this.textRotateWithView_&&(n+=this.viewRotation_);e<i;e+=a){var o=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;0!==n||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(o-this.textOffsetX_,l-this.textOffsetY_),s.rotate(n),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,o,l),this.textFillState_&&s.fillText(this.text_,o,l))}}}},{key:"moveToLineTo_",value:function(t,e,i,a,r){var s=this.context_,n=(0,_transform2.transform2D)(t,e,i,a,this.transform_,this.pixelCoordinates_);s.moveTo(n[0],n[1]);var o=n.length;r&&(o-=2);for(var l=2;l<o;l+=2)s.lineTo(n[l],n[l+1]);return r&&s.closePath(),i}},{key:"drawRings_",value:function(t,e,i,a){for(var r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],a,!0);return e}},{key:"drawCircle",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=(0,_SimpleGeometry.transformGeom2D)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],a=e[3]-e[1],r=Math.sqrt(i*i+a*a),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),i=0,a=e.length;i<a;++i)this.drawGeometry(e[i])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if((0,_extent.intersects)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,a=t.getFlatCoordinates(),r=0,s=t.getEnds(),n=t.getStride();i.beginPath();for(var o=0,l=s.length;o<l;++o)r=this.moveToLineTo_(a,r,s[o],n,!1);i.stroke()}if(""!==this.text_){var h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),a=0,r=t.getEndss(),s=t.getStride();e.beginPath();for(var n=0,o=r.length;n<o;++n){var l=r[n];a=this.drawRings_(i,a,l,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),(0,_array.equals)(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,i=this.contextTextState_,a=t.textAlign?t.textAlign:_canvas.defaultTextAlign;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=a&&(i.textAlign=a,e.textAlign=a),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=a,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){var i=this;if(t){var a=t.getColor();this.fillState_={fillStyle:(0,_colorlike.asColorLike)(a||_canvas.defaultFillStyle)}}else this.fillState_=null;if(e){var r=e.getColor(),s=e.getLineCap(),n=e.getLineDash(),o=e.getLineDashOffset(),l=e.getLineJoin(),h=e.getWidth(),_=e.getMiterLimit(),f=n||_canvas.defaultLineDash;this.strokeState_={lineCap:void 0!==s?s:_canvas.defaultLineCap,lineDash:1===this.pixelRatio_?f:f.map(function(t){return t*i.pixelRatio_}),lineDashOffset:(o||_canvas.defaultLineDashOffset)*this.pixelRatio_,lineJoin:void 0!==l?l:_canvas.defaultLineJoin,lineWidth:(void 0!==h?h:_canvas.defaultLineWidth)*this.pixelRatio_,miterLimit:void 0!==_?_:_canvas.defaultMiterLimit,strokeStyle:(0,_colorlike.asColorLike)(r||_canvas.defaultStrokeStyle)}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){var e;if(t&&(e=t.getSize())){var i=t.getPixelRatio(this.pixelRatio_),a=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=a[0]*i,this.imageAnchorY_=a[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();var s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}else this.image_=null}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:(0,_colorlike.asColorLike)(i||_canvas.defaultFillStyle)}}else this.textFillState_=null;var a=t.getStroke();if(a){var r=a.getColor(),s=a.getLineCap(),n=a.getLineDash(),o=a.getLineDashOffset(),l=a.getLineJoin(),h=a.getWidth(),_=a.getMiterLimit();this.textStrokeState_={lineCap:void 0!==s?s:_canvas.defaultLineCap,lineDash:n||_canvas.defaultLineDash,lineDashOffset:o||_canvas.defaultLineDashOffset,lineJoin:void 0!==l?l:_canvas.defaultLineJoin,lineWidth:void 0!==h?h:_canvas.defaultLineWidth,miterLimit:void 0!==_?_:_canvas.defaultMiterLimit,strokeStyle:(0,_colorlike.asColorLike)(r||_canvas.defaultStrokeStyle)}}else this.textStrokeState_=null;var f=t.getFont(),c=t.getOffsetX(),u=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation(),x=t.getScaleArray(),d=t.getText(),S=t.getTextAlign(),y=t.getTextBaseline();this.textState_={font:void 0!==f?f:_canvas.defaultFont,textAlign:void 0!==S?S:_canvas.defaultTextAlign,textBaseline:void 0!==y?y:_canvas.defaultTextBaseline},this.text_=void 0!==d?Array.isArray(d)?d.reduce(function(t,e,i){return t+(i%2?" ":e)},""):d:"",this.textOffsetX_=void 0!==c?this.pixelRatio_*c:0,this.textOffsetY_=void 0!==u?this.pixelRatio_*u:0,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0!==m?m:0,this.textScale_=[this.pixelRatio_*x[0],this.pixelRatio_*x[1]]}else this.text_=""}}])}(),_default=exports.default=CanvasImmediateRenderer;

},{"../../array.js":110,"../../colorlike.js":114,"../../extent.js":142,"../../geom/SimpleGeometry.js":212,"../../geom/flat/transform.js":232,"../../math.js":279,"../../transform.js":402,"../VectorContext.js":296,"../canvas.js":297}],304:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.strokeInstruction=exports.fillInstruction=exports.default=exports.closePathInstruction=exports.beginPathInstruction=void 0;var Instruction={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},fillInstruction=exports.fillInstruction=[Instruction.FILL],strokeInstruction=exports.strokeInstruction=[Instruction.STROKE],beginPathInstruction=exports.beginPathInstruction=[Instruction.BEGIN_PATH],closePathInstruction=exports.closePathInstruction=[Instruction.CLOSE_PATH],_default=exports.default=Instruction;

},{}],305:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireWildcard(require("./Instruction.js")),_canvas=require("../canvas.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,r&&r.set(t,n),n}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=_superPropBase(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasLineStringBuilder=function(t){function e(t,r,n,i){return _classCallCheck(this,e),_callSuper(this,e,[t,r,n,i])}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"drawFlatCoordinates_",value:function(t,e,r,n){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,r,n,!1,!1),s=[_Instruction.default.MOVE_TO_LINE_TO,i,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),r}},{key:"drawLineString",value:function(t,e,r){var n=this.state,i=n.strokeStyle,o=n.lineWidth;if(void 0!==i&&void 0!==o){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,r),this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset],_Instruction.beginPathInstruction);var s=t.getFlatCoordinates(),u=t.getStride();this.drawFlatCoordinates_(s,0,s.length,u),this.hitDetectionInstructions.push(_Instruction.strokeInstruction),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e,r){var n=this.state,i=n.strokeStyle,o=n.lineWidth;if(void 0!==i&&void 0!==o){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,r),this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset],_Instruction.beginPathInstruction);for(var s=t.getEnds(),u=t.getFlatCoordinates(),a=t.getStride(),l=0,c=0,f=s.length;c<f;++c)l=this.drawFlatCoordinates_(u,l,s[c],a);this.hitDetectionInstructions.push(_Instruction.strokeInstruction),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(_Instruction.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,_get(_getPrototypeOf(e.prototype),"finish",this).call(this)}},{key:"applyStroke",value:function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(_Instruction.strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,_get(_getPrototypeOf(e.prototype),"applyStroke",this).call(this,t),this.instructions.push(_Instruction.beginPathInstruction)}}])}(),_default=exports.default=CanvasLineStringBuilder;

},{"../canvas.js":297,"./Builder.js":298,"./Instruction.js":304}],306:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireWildcard(require("./Instruction.js")),_canvas=require("../canvas.js"),_simplify=require("../../geom/flat/simplify.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(t){return t?i:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var i=_getRequireWildcardCache(e);if(i&&i.has(t))return i.get(t);var n={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,i&&i.set(t,n),n}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=_superPropBase(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasPolygonBuilder=function(t){function e(t,i,n,r){return _classCallCheck(this,e),_callSuper(this,e,[t,i,n,r])}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"drawFlatCoordinatess_",value:function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=void 0!==r.strokeStyle,u=i.length;this.instructions.push(_Instruction.beginPathInstruction),this.hitDetectionInstructions.push(_Instruction.beginPathInstruction);for(var l=0;l<u;++l){var a=i[l],c=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,a,n,!0,!s),h=[_Instruction.default.MOVE_TO_LINE_TO,c,f];this.instructions.push(h),this.hitDetectionInstructions.push(h),s&&(this.instructions.push(_Instruction.closePathInstruction),this.hitDetectionInstructions.push(_Instruction.closePathInstruction)),e=a}return o&&(this.instructions.push(_Instruction.fillInstruction),this.hitDetectionInstructions.push(_Instruction.fillInstruction)),s&&(this.instructions.push(_Instruction.strokeInstruction),this.hitDetectionInstructions.push(_Instruction.strokeInstruction)),e}},{key:"drawCircle",value:function(t,e,i){var n=this.state,r=n.fillStyle,o=n.strokeStyle;if(void 0!==r||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_FILL_STYLE,_canvas.defaultFillStyle]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset]);var s=t.getFlatCoordinates(),u=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,u,!1,!1);var a=[_Instruction.default.CIRCLE,l];this.instructions.push(_Instruction.beginPathInstruction,a),this.hitDetectionInstructions.push(_Instruction.beginPathInstruction,a),void 0!==n.fillStyle&&(this.instructions.push(_Instruction.fillInstruction),this.hitDetectionInstructions.push(_Instruction.fillInstruction)),void 0!==n.strokeStyle&&(this.instructions.push(_Instruction.strokeInstruction),this.hitDetectionInstructions.push(_Instruction.strokeInstruction)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e,i){var n=this.state,r=n.fillStyle,o=n.strokeStyle;if(void 0!==r||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_FILL_STYLE,_canvas.defaultFillStyle]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset]);var s=t.getEnds(),u=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(u,0,s,l),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e,i){var n=this.state,r=n.fillStyle,o=n.strokeStyle;if(void 0!==r||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_FILL_STYLE,_canvas.defaultFillStyle]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset]);for(var s=t.getEndss(),u=t.getOrientedFlatCoordinates(),l=t.getStride(),a=0,c=0,f=s.length;c<f;++c)a=this.drawFlatCoordinatess_(u,a,s[c],l);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var i=this.coordinates,n=0,r=i.length;n<r;++n)i[n]=(0,_simplify.snap)(i[n],t);return _get(_getPrototypeOf(e.prototype),"finish",this).call(this)}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}])}(),_default=exports.default=CanvasPolygonBuilder;

},{"../../geom/flat/simplify.js":229,"../canvas.js":297,"./Builder.js":298,"./Instruction.js":304}],307:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TEXT_ALIGN=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireDefault(require("./Instruction.js")),_colorlike=require("../../colorlike.js"),_canvas=require("../canvas.js"),_util=require("../../util.js"),_extent=require("../../extent.js"),_linechunk=require("../../geom/flat/linechunk.js"),_straightchunk=require("../../geom/flat/straightchunk.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=_superPropBase(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var TEXT_ALIGN=exports.TEXT_ALIGN={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},CanvasTextBuilder=function(t){function e(t,i,r,n){var l;return _classCallCheck(this,e),(l=_callSuper(this,e,[t,i,r,n])).labels_=null,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=void 0,l.textRotation_=0,l.textFillState_=null,l.fillStates={},l.fillStates[_canvas.defaultFillStyle]={fillStyle:_canvas.defaultFillStyle},l.textStrokeState_=null,l.strokeStates={},l.textState_={},l.textStates={},l.textKey_="",l.fillKey_="",l.strokeKey_="",l.declutterMode_=void 0,l.declutterImageWithText_=void 0,l}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"finish",value:function(){var t=_get(_getPrototypeOf(e.prototype),"finish",this).call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}},{key:"drawText",value:function(t,e,i){var r=this.textFillState_,n=this.textStrokeState_,l=this.textState_;if(""!==this.text_&&l&&(r||n)){var s=this.coordinates,a=s.length,o=t.getType(),u=null,f=t.getStride();if("line"!==l.placement||"LineString"!=o&&"MultiLineString"!=o&&"Polygon"!=o&&"MultiPolygon"!=o){var c=l.overflow?null:[];switch(o){case"Point":case"MultiPoint":u=t.getFlatCoordinates();break;case"LineString":u=t.getFlatMidpoint();break;case"Circle":u=t.getCenter();break;case"MultiLineString":u=t.getFlatMidpoints(),f=2;break;case"Polygon":u=t.getFlatInteriorPoint(),l.overflow||c.push(u[2]/this.resolution),f=3;break;case"MultiPolygon":var h=t.getFlatInteriorPoints();u=[];for(var _=0,d=h.length;_<d;_+=3)l.overflow||c.push(h[_+2]/this.resolution),u.push(h[_],h[_+1]);if(0===u.length)return;f=2}var g=this.appendFlatPointCoordinates(u,f);if(g===a)return;if(c&&(g-a)/2!=u.length/f){var y=a/2;c=c.filter(function(t,e){var i=s[2*(y+e)]===u[e*f]&&s[2*(y+e)+1]===u[e*f+1];return i||--y,i})}this.saveTextStates_(),(l.backgroundFill||l.backgroundStroke)&&(this.setFillStrokeStyle(l.backgroundFill,l.backgroundStroke),l.backgroundFill&&this.updateFillStyle(this.state,this.createFill),l.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);var p=l.padding;if(p!=_canvas.defaultPadding&&(l.scale[0]<0||l.scale[1]<0)){var v=l.padding[0],S=l.padding[1],x=l.padding[2],k=l.padding[3];l.scale[0]<0&&(S=-S,k=-k),l.scale[1]<0&&(v=-v,x=-x),p=[v,S,x,k]}var b=this.pixelRatio;this.instructions.push([_Instruction.default.DRAW_IMAGE,a,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,p==_canvas.defaultPadding?_canvas.defaultPadding:p.map(function(t){return t*b}),!!l.backgroundFill,!!l.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]);var m=1/b,P=this.state.fillStyle;l.backgroundFill&&(this.state.fillStyle=_canvas.defaultFillStyle,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([_Instruction.default.DRAW_IMAGE,a,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[m,m],NaN,this.declutterMode_,this.declutterImageWithText_,p,!!l.backgroundFill,!!l.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?_canvas.defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]),l.backgroundFill&&(this.state.fillStyle=P,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!(0,_extent.intersects)(this.maxExtent,t.getExtent()))return;var O;if(u=t.getFlatCoordinates(),"LineString"==o)O=[u.length];else if("MultiLineString"==o)O=t.getEnds();else if("Polygon"==o)O=t.getEnds().slice(0,1);else if("MultiPolygon"==o){var F=t.getEndss();O=[];for(var C=0,R=F.length;C<R;++C)O.push(F[C][0])}this.beginGeometry(t,e,i);for(var w=l.repeat,T=w?void 0:l.textAlign,j=0,D=0,L=O.length;D<L;++D)for(var A=void 0,I=0,M=(A=w?(0,_linechunk.lineChunk)(w*this.resolution,u,j,O[D],f):[u.slice(j,O[D])]).length;I<M;++I){var N=A[I],K=0,W=N.length;if(null==T){var B=(0,_straightchunk.matchingChunk)(l.maxAngle,N,0,N.length,2);K=B[0],W=B[1]}for(var E=K;E<W;E+=f)s.push(N[E],N[E+1]);var q=s.length;j=O[D],this.drawChars_(a,q),a=q}this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||_canvas.defaultTextAlign,justify:e.justify,textBaseline:e.textBaseline||_canvas.defaultTextBaseline,scale:e.scale});var l=this.fillKey_;i&&(l in this.fillStates||(this.fillStates[l]={fillStyle:i.fillStyle}))}},{key:"drawChars_",value:function(t,e){var i=this.textStrokeState_,r=this.textState_,n=this.strokeKey_,l=this.textKey_,s=this.fillKey_;this.saveTextStates_();var a=this.pixelRatio,o=TEXT_ALIGN[r.textBaseline],u=this.textOffsetY_*a,f=this.text_,c=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([_Instruction.default.DRAW_CHARS,t,e,o,r.overflow,s,r.maxAngle,a,u,n,c*a,f,l,1,this.declutterMode_]),this.hitDetectionInstructions.push([_Instruction.default.DRAW_CHARS,t,e,o,r.overflow,s?_canvas.defaultFillStyle:s,r.maxAngle,a,u,n,c*a,f,l,1/a,this.declutterMode_])}},{key:"setTextStyle",value:function(t,e){var i,r,n;if(t){var l=t.getFill();l?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=(0,_colorlike.asColorLike)(l.getColor()||_canvas.defaultFillStyle)):(r=null,this.textFillState_=r);var s=t.getStroke();if(s){(n=this.textStrokeState_)||(n={},this.textStrokeState_=n);var a=s.getLineDash(),o=s.getLineDashOffset(),u=s.getWidth(),f=s.getMiterLimit();n.lineCap=s.getLineCap()||_canvas.defaultLineCap,n.lineDash=a?a.slice():_canvas.defaultLineDash,n.lineDashOffset=void 0===o?_canvas.defaultLineDashOffset:o,n.lineJoin=s.getLineJoin()||_canvas.defaultLineJoin,n.lineWidth=void 0===u?_canvas.defaultLineWidth:u,n.miterLimit=void 0===f?_canvas.defaultMiterLimit:f,n.strokeStyle=(0,_colorlike.asColorLike)(s.getColor()||_canvas.defaultStrokeStyle)}else n=null,this.textStrokeState_=n;i=this.textState_;var c=t.getFont()||_canvas.defaultFont;(0,_canvas.registerFont)(c);var h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||_canvas.defaultTextBaseline,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||_canvas.defaultPadding,i.scale=void 0===h?[1,1]:h;var _=t.getOffsetX(),d=t.getOffsetY(),g=t.getRotateWithView(),y=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===_?0:_,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===y?0:y,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:(0,_util.getUid)(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?"string"==typeof r.fillStyle?r.fillStyle:"|"+(0,_util.getUid)(r.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])}(),_default=exports.default=CanvasTextBuilder;

},{"../../colorlike.js":114,"../../extent.js":142,"../../geom/flat/linechunk.js":225,"../../geom/flat/straightchunk.js":230,"../../util.js":404,"../canvas.js":297,"./Builder.js":298,"./Instruction.js":304}],308:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _dom=require("../../dom.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ZIndexContext=function(){return _createClass(function t(){var e=this;_classCallCheck(this,t),_defineProperty(this,"pushMethodArgs_",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.instructions_[e.zIndex+e.offset_].push(r),e}),this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy((0,_dom.getSharedCanvasContext2D)(),{get:function(t,r){if("function"==typeof(0,_dom.getSharedCanvasContext2D)()[r])return e.instructions_[e.zIndex+e.offset_]||(e.instructions_[e.zIndex+e.offset_]=[]),e.instructions_[e.zIndex+e.offset_].push(r),e.pushMethodArgs_},set:function(t,r,n){return e.instructions_[e.zIndex+e.offset_]||(e.instructions_[e.zIndex+e.offset_]=[]),e.instructions_[e.zIndex+e.offset_].push(r,n),!0}})},[{key:"pushFunction",value:function(t){this.instructions_[this.zIndex+this.offset_].push(t)}},{key:"getContext",value:function(){return this.context_}},{key:"draw",value:function(t){this.instructions_.forEach(function(e){for(var r=0,n=e.length;r<n;++r){var o=e[r];if("function"!=typeof o){var i=e[++r];if("function"==typeof t[o])t[o].apply(t,_toConsumableArray(i));else{if("function"==typeof i){t[o]=i(t);continue}t[o]=i}}else o(t)}})}},{key:"clear",value:function(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}},{key:"offset",value:function(){this.offset_=this.instructions_.length,this.zIndex=0}}])}(),_default=exports.default=ZIndexContext;

},{"../../dom.js":130}],309:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HIT_DETECT_RESOLUTION=void 0,exports.createHitDetectionImageData=createHitDetectionImageData,exports.hitDetect=hitDetect;var _Immediate=_interopRequireDefault(require("./Immediate.js")),_style=require("../../style.js"),_array=require("../../array.js"),_math=require("../../math.js"),_dom=require("../../dom.js"),_proj=require("../../proj.js"),_extent=require("../../extent.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var HIT_DETECT_RESOLUTION=exports.HIT_DETECT_RESOLUTION=.5;function createHitDetectionImageData(e,t,r,a,o,i,n,l,s){var g=s?(0,_proj.toUserExtent)(o,s):o,c=e[0]*HIT_DETECT_RESOLUTION,h=e[1]*HIT_DETECT_RESOLUTION,_=(0,_dom.createCanvasContext2D)(c,h);_.imageSmoothingEnabled=!1;for(var u=_.canvas,T=new _Immediate.default(_,HIT_DETECT_RESOLUTION,o,null,n,l,s?(0,_proj.getTransformFromProjections)((0,_proj.getUserProjection)(),s):null),m=r.length,v=Math.floor(16777215/m),f={},d=1;d<=m;++d){var p=r[d-1],I=p.getStyleFunction()||a;if(I){var E=I(p,i);if(E){Array.isArray(E)||(E=[E]);for(var D=(d*v).toString(16).padStart(7,"#00000"),y=0,O=E.length;y<O;++y){var S=E[y],j=S.getGeometryFunction()(p);if(j&&(0,_extent.intersects)(g,j.getExtent())){var x=S.clone(),C=x.getFill();C&&C.setColor(D);var R=x.getStroke();R&&(R.setColor(D),R.setLineDash(null)),x.setText(void 0);var U=S.getImage();if(U){var H=U.getImageSize();if(!H)continue;var L=(0,_dom.createCanvasContext2D)(H[0],H[1],void 0,{alpha:!1}),M=L.canvas;L.fillStyle=D,L.fillRect(0,0,M.width,M.height),x.setImage(new _style.Icon({img:M,anchor:U.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:U.getOrigin(),opacity:1,size:U.getSize(),scale:U.getScale(),rotation:U.getRotation(),rotateWithView:U.getRotateWithView()}))}var q=x.getZIndex()||0,w=f[q];w||(w={},f[q]=w,w.Polygon=[],w.Circle=[],w.LineString=[],w.Point=[]);var N=j.getType();if("GeometryCollection"===N)for(var P=j.getGeometriesArrayRecursive(),b=0,A=P.length;b<A;++b){var F=P[b];w[F.getType().replace("Multi","")].push(F,x)}else w[N.replace("Multi","")].push(j,x)}}}}}for(var G=Object.keys(f).map(Number).sort(_array.ascending),z=0,k=G.length;z<k;++z){var V=f[G[z]];for(var W in V)for(var X=V[W],Y=0,Z=X.length;Y<Z;Y+=2){T.setStyle(X[Y+1]);for(var B=0,J=t.length;B<J;++B)T.setTransform(t[B]),T.drawGeometry(X[Y])}}return _.getImageData(0,0,u.width,u.height)}function hitDetect(e,t,r){var a=[];if(r){var o=Math.floor(Math.round(e[0])*HIT_DETECT_RESOLUTION),i=Math.floor(Math.round(e[1])*HIT_DETECT_RESOLUTION),n=4*((0,_math.clamp)(o,0,r.width-1)+(0,_math.clamp)(i,0,r.height-1)*r.width),l=r.data[n],s=r.data[n+1],g=r.data[n+2]+256*(s+256*l),c=Math.floor(16777215/t.length);g&&g%c==0&&a.push(t[g/c-1])}return a}

},{"../../array.js":110,"../../dom.js":130,"../../extent.js":142,"../../math.js":279,"../../proj.js":283,"../../style.js":384,"./Immediate.js":303}],310:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildRuleSet=buildRuleSet,exports.buildStyle=buildStyle,exports.flatStylesToStyleFunction=flatStylesToStyleFunction,exports.rulesToStyleFunction=rulesToStyleFunction;var _Circle=_interopRequireDefault(require("../../style/Circle.js")),_Fill=_interopRequireDefault(require("../../style/Fill.js")),_Icon=_interopRequireDefault(require("../../style/Icon.js")),_RegularShape=_interopRequireDefault(require("../../style/RegularShape.js")),_Stroke=_interopRequireDefault(require("../../style/Stroke.js")),_Style=_interopRequireDefault(require("../../style/Style.js")),_Text=_interopRequireDefault(require("../../style/Text.js")),_expression=require("../../expr/expression.js"),_cpu=require("../../expr/cpu.js"),_obj=require("../../obj.js"),_size=require("../../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _createForOfIteratorHelper(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw i}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function always(e){return!0}function rulesToStyleFunction(e){var r=(0,_expression.newParsingContext)(),t=buildRuleSet(e,r),o=(0,_cpu.newEvaluationContext)();return function(e,n){if(o.properties=e.getPropertiesInternal(),o.resolution=n,r.featureId){var i=e.getId();o.featureId=void 0!==i?i:null}return r.geometryType&&(o.geometryType=(0,_expression.computeGeometryType)(e.getGeometry())),t(o)}}function flatStylesToStyleFunction(e){for(var r=(0,_expression.newParsingContext)(),t=e.length,o=new Array(t),n=0;n<t;++n)o[n]=buildStyle(e[n],r);var i=(0,_cpu.newEvaluationContext)(),a=new Array(t);return function(e,n){if(i.properties=e.getPropertiesInternal(),i.resolution=n,r.featureId){var u=e.getId();i.featureId=void 0!==u?u:null}for(var l=0,s=0;s<t;++s){var c=o[s](i);c&&(a[l]=c,l+=1)}return a.length=l,a}}function buildRuleSet(e,r){for(var t=e.length,o=new Array(t),n=0;n<t;++n){var i=e[n],a="filter"in i?(0,_cpu.buildExpression)(i.filter,_expression.BooleanType,r):always,u=void 0;if(Array.isArray(i.style)){var l=i.style.length;u=new Array(l);for(var s=0;s<l;++s)u[s]=buildStyle(i.style[s],r)}else u=[buildStyle(i.style,r)];o[n]={filter:a,styles:u}}return function(r){for(var n=[],i=!1,a=0;a<t;++a){if((0,o[a].filter)(r)&&(!e[a].else||!i)){i=!0;var u,l=_createForOfIteratorHelper(o[a].styles);try{for(l.s();!(u=l.n()).done;){var s=(0,u.value)(r);s&&n.push(s)}}catch(e){l.e(e)}finally{l.f()}}}return n}}function buildStyle(e,r){var t=buildFill(e,"",r),o=buildStroke(e,"",r),n=buildText(e,r),i=buildImage(e,r),a=numberEvaluator(e,"z-index",r);if(!(t||o||n||i||(0,_obj.isEmpty)(e)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(e));var u=new _Style.default;return function(e){var r=!0;if(t){var l=t(e);l&&(r=!1),u.setFill(l)}if(o){var s=o(e);s&&(r=!1),u.setStroke(s)}if(n){var c=n(e);c&&(r=!1),u.setText(c)}if(i){var f=i(e);f&&(r=!1),u.setImage(f)}return a&&u.setZIndex(a(e)),r?null:u}}function buildFill(e,r,t){var o;if(!(o=r+"fill-pattern-src"in e?patternEvaluator(e,r+"fill-",t):colorLikeEvaluator(e,r+"fill-color",t)))return null;var n=new _Fill.default;return function(e){var r=o(e);return"none"===r?null:(n.setColor(r),n)}}function buildStroke(e,r,t){var o=numberEvaluator(e,r+"stroke-width",t),n=colorLikeEvaluator(e,r+"stroke-color",t);if(!o&&!n)return null;var i=stringEvaluator(e,r+"stroke-line-cap",t),a=stringEvaluator(e,r+"stroke-line-join",t),u=numberArrayEvaluator(e,r+"stroke-line-dash",t),l=numberEvaluator(e,r+"stroke-line-dash-offset",t),s=numberEvaluator(e,r+"stroke-miter-limit",t),c=new _Stroke.default;return function(e){if(n){var r=n(e);if("none"===r)return null;c.setColor(r)}if(o&&c.setWidth(o(e)),i){var t=i(e);if("butt"!==t&&"round"!==t&&"square"!==t)throw new Error("Expected butt, round, or square line cap");c.setLineCap(t)}if(a){var f=a(e);if("bevel"!==f&&"round"!==f&&"miter"!==f)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(f)}return u&&c.setLineDash(u(e)),l&&c.setLineDashOffset(l(e)),s&&c.setMiterLimit(s(e)),c}}function buildText(e,r){var t="text-",o=stringEvaluator(e,"text-value",r);if(!o)return null;var n=buildFill(e,t,r),i=buildFill(e,"text-background-",r),a=buildStroke(e,t,r),u=buildStroke(e,"text-background-",r),l=stringEvaluator(e,"text-font",r),s=numberEvaluator(e,"text-max-angle",r),c=numberEvaluator(e,"text-offset-x",r),f=numberEvaluator(e,"text-offset-y",r),p=booleanEvaluator(e,"text-overflow",r),d=stringEvaluator(e,"text-placement",r),v=numberEvaluator(e,"text-repeat",r),b=sizeLikeEvaluator(e,"text-scale",r),y=booleanEvaluator(e,"text-rotate-with-view",r),E=numberEvaluator(e,"text-rotation",r),h=stringEvaluator(e,"text-align",r),m=stringEvaluator(e,"text-justify",r),x=stringEvaluator(e,"text-baseline",r),g=numberArrayEvaluator(e,"text-padding",r),w=optionalDeclutterMode(e,"text-declutter-mode"),S=new _Text.default({declutterMode:w});return function(e){if(S.setText(o(e)),n&&S.setFill(n(e)),i&&S.setBackgroundFill(i(e)),a&&S.setStroke(a(e)),u&&S.setBackgroundStroke(u(e)),l&&S.setFont(l(e)),s&&S.setMaxAngle(s(e)),c&&S.setOffsetX(c(e)),f&&S.setOffsetY(f(e)),p&&S.setOverflow(p(e)),d){var r=d(e);if("point"!==r&&"line"!==r)throw new Error("Expected point or line for text-placement");S.setPlacement(r)}if(v&&S.setRepeat(v(e)),b&&S.setScale(b(e)),y&&S.setRotateWithView(y(e)),E&&S.setRotation(E(e)),h){var t=h(e);if("left"!==t&&"center"!==t&&"right"!==t&&"end"!==t&&"start"!==t)throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(t)}if(m){var w=m(e);if("left"!==w&&"right"!==w&&"center"!==w)throw new Error("Expected left, right, or center for text-justify");S.setJustify(w)}if(x){var _=x(e);if("bottom"!==_&&"top"!==_&&"middle"!==_&&"alphabetic"!==_&&"hanging"!==_)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(_)}return g&&S.setPadding(g(e)),S}}function buildImage(e,r){return"icon-src"in e?buildIcon(e,r):"shape-points"in e?buildShape(e,r):"circle-radius"in e?buildCircle(e,r):null}function buildIcon(e,r){var t=requireString(e["icon-src"],"icon-src"),o=coordinateEvaluator(e,"icon-anchor",r),n=sizeLikeEvaluator(e,"icon-scale",r),i=numberEvaluator(e,"icon-opacity",r),a=coordinateEvaluator(e,"icon-displacement",r),u=numberEvaluator(e,"icon-rotation",r),l=booleanEvaluator(e,"icon-rotate-with-view",r),s=optionalIconOrigin(e,"icon-anchor-origin"),c=optionalIconAnchorUnits(e,"icon-anchor-x-units"),f=optionalIconAnchorUnits(e,"icon-anchor-y-units"),p=optionalColorLike(e,"icon-color"),d=optionalString(e,"icon-cross-origin"),v=optionalNumberArray(e,"icon-offset"),b=optionalIconOrigin(e,"icon-offset-origin"),y=optionalNumber(e,"icon-width"),E=optionalNumber(e,"icon-height"),h=optionalSize(e,"icon-size"),m=optionalDeclutterMode(e,"icon-declutter-mode"),x=new _Icon.default({src:t,anchorOrigin:s,anchorXUnits:c,anchorYUnits:f,color:p,crossOrigin:d,offset:v,offsetOrigin:b,height:E,width:y,size:h,declutterMode:m});return function(e){return i&&x.setOpacity(i(e)),a&&x.setDisplacement(a(e)),u&&x.setRotation(u(e)),l&&x.setRotateWithView(l(e)),n&&x.setScale(n(e)),o&&x.setAnchor(o(e)),x}}function buildShape(e,r){var t="shape-",o=requireNumber(e["shape-points"],"shape-points"),n=requireNumber(e["shape-radius"],"shape-radius"),i=buildFill(e,t,r),a=buildStroke(e,t,r),u=sizeLikeEvaluator(e,"shape-scale",r),l=coordinateEvaluator(e,"shape-displacement",r),s=numberEvaluator(e,"shape-rotation",r),c=booleanEvaluator(e,"shape-rotate-with-view",r),f=optionalNumber(e,"shape-radius2"),p=optionalNumber(e,"shape-angle"),d=optionalDeclutterMode(e,"shape-declutter-mode"),v=new _RegularShape.default({points:o,radius:n,radius2:f,angle:p,declutterMode:d});return function(e){return i&&v.setFill(i(e)),a&&v.setStroke(a(e)),l&&v.setDisplacement(l(e)),s&&v.setRotation(s(e)),c&&v.setRotateWithView(c(e)),u&&v.setScale(u(e)),v}}function buildCircle(e,r){var t="circle-",o=buildFill(e,t,r),n=buildStroke(e,t,r),i=numberEvaluator(e,"circle-radius",r),a=sizeLikeEvaluator(e,"circle-scale",r),u=coordinateEvaluator(e,"circle-displacement",r),l=numberEvaluator(e,"circle-rotation",r),s=booleanEvaluator(e,"circle-rotate-with-view",r),c=optionalDeclutterMode(e,"circle-declutter-mode"),f=new _Circle.default({radius:5,declutterMode:c});return function(e){return i&&f.setRadius(i(e)),o&&f.setFill(o(e)),n&&f.setStroke(n(e)),u&&f.setDisplacement(u(e)),l&&f.setRotation(l(e)),s&&f.setRotateWithView(s(e)),a&&f.setScale(a(e)),f}}function numberEvaluator(e,r,t){if(r in e){var o=(0,_cpu.buildExpression)(e[r],_expression.NumberType,t);return function(e){return requireNumber(o(e),r)}}}function stringEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.StringType,t);return function(e){return requireString(o(e),r)}}function patternEvaluator(e,r,t){var o=stringEvaluator(e,r+"pattern-src",t),n=sizeEvaluator(e,r+"pattern-offset",t),i=sizeEvaluator(e,r+"pattern-size",t),a=colorLikeEvaluator(e,r+"color",t);return function(e){return{src:o(e),offset:n&&n(e),size:i&&i(e),color:a&&a(e)}}}function booleanEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.BooleanType,t);return function(e){var t=o(e);if("boolean"!=typeof t)throw new Error("Expected a boolean for ".concat(r));return t}}function colorLikeEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.ColorType|_expression.StringType,t);return function(e){return requireColorLike(o(e),r)}}function numberArrayEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType,t);return function(e){return requireNumberArray(o(e),r)}}function coordinateEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType,t);return function(e){var t=requireNumberArray(o(e),r);if(2!==t.length)throw new Error("Expected two numbers for ".concat(r));return t}}function sizeEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType,t);return function(e){return requireSize(o(e),r)}}function sizeLikeEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType|_expression.NumberType,t);return function(e){return requireSizeLike(o(e),r)}}function optionalNumber(e,r){var t=e[r];if(void 0!==t){if("number"!=typeof t)throw new Error("Expected a number for ".concat(r));return t}}function optionalSize(e,r){var t=e[r];if(void 0!==t){if("number"==typeof t)return(0,_size.toSize)(t);if(!Array.isArray(t))throw new Error("Expected a number or size array for ".concat(r));if(2!==t.length||"number"!=typeof t[0]||"number"!=typeof t[1])throw new Error("Expected a number or size array for ".concat(r));return t}}function optionalString(e,r){var t=e[r];if(void 0!==t){if("string"!=typeof t)throw new Error("Expected a string for ".concat(r));return t}}function optionalIconOrigin(e,r){var t=e[r];if(void 0!==t){if("bottom-left"!==t&&"bottom-right"!==t&&"top-left"!==t&&"top-right"!==t)throw new Error("Expected bottom-left, bottom-right, top-left, or top-right for ".concat(r));return t}}function optionalIconAnchorUnits(e,r){var t=e[r];if(void 0!==t){if("pixels"!==t&&"fraction"!==t)throw new Error("Expected pixels or fraction for ".concat(r));return t}}function optionalNumberArray(e,r){var t=e[r];if(void 0!==t)return requireNumberArray(t,r)}function optionalDeclutterMode(e,r){var t=e[r];if(void 0!==t){if("string"!=typeof t)throw new Error("Expected a string for ".concat(r));if("declutter"!==t&&"obstacle"!==t&&"none"!==t)throw new Error("Expected declutter, obstacle, or none for ".concat(r));return t}}function optionalColorLike(e,r){var t=e[r];if(void 0!==t)return requireColorLike(t,r)}function requireNumberArray(e,r){if(!Array.isArray(e))throw new Error("Expected an array for ".concat(r));for(var t=e.length,o=0;o<t;++o)if("number"!=typeof e[o])throw new Error("Expected an array of numbers for ".concat(r));return e}function requireString(e,r){if("string"!=typeof e)throw new Error("Expected a string for ".concat(r));return e}function requireNumber(e,r){if("number"!=typeof e)throw new Error("Expected a number for ".concat(r));return e}function requireColorLike(e,r){if("string"==typeof e)return e;var t=requireNumberArray(e,r),o=t.length;if(o<3||o>4)throw new Error("Expected a color with 3 or 4 values for ".concat(r));return t}function requireSize(e,r){var t=requireNumberArray(e,r);if(2!==t.length)throw new Error("Expected an array of two numbers for ".concat(r));return t}function requireSizeLike(e,r){return"number"==typeof e?e:requireSize(e,r)}

},{"../../expr/cpu.js":139,"../../expr/expression.js":140,"../../obj.js":281,"../../size.js":337,"../../style/Circle.js":385,"../../style/Fill.js":386,"../../style/Icon.js":387,"../../style/RegularShape.js":391,"../../style/Stroke.js":392,"../../style/Style.js":393,"../../style/Text.js":394}],311:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebGLWorkerMessageType=void 0;var WebGLWorkerMessageType=exports.WebGLWorkerMessageType={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};

},{}],312:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LINESTRING_ANGLE_COSINE_CUTOFF=void 0,exports.colorDecodeId=colorDecodeId,exports.colorEncodeId=colorEncodeId,exports.getBlankImageData=getBlankImageData,exports.writeLineSegmentToBuffers=writeLineSegmentToBuffers,exports.writePointFeatureToBuffers=writePointFeatureToBuffers,exports.writePolygonTrianglesToBuffers=writePolygonTrianglesToBuffers;var _earcut=_interopRequireDefault(require("earcut")),_transform=require("../../transform.js"),_math=require("../../math.js");function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,t){if(r){if("string"==typeof r)return _arrayLikeToArray(r,t);var e={}.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,o=Array(t);e<t;e++)o[e]=r[e];return o}var LINESTRING_ANGLE_COSINE_CUTOFF=exports.LINESTRING_ANGLE_COSINE_CUTOFF=.985,tmpArray_=[],bufferPositions_={vertexPosition:0,indexPosition:0};function writePointVertex(r,t,e,o,a){r[t+0]=e,r[t+1]=o,r[t+2]=a}function writePointFeatureToBuffers(r,t,e,o,a,n){var i=3+a,u=r[t+0],s=r[t+1],l=tmpArray_;l.length=a;for(var f=0;f<l.length;f++)l[f]=r[t+2+f];var c=n?n.vertexPosition:0,p=n?n.indexPosition:0,_=c/i;return writePointVertex(e,c,u,s,0),l.length&&e.set(l,c+3),writePointVertex(e,c+=i,u,s,1),l.length&&e.set(l,c+3),writePointVertex(e,c+=i,u,s,2),l.length&&e.set(l,c+3),writePointVertex(e,c+=i,u,s,3),l.length&&e.set(l,c+3),c+=i,o[p++]=_,o[p++]=_+1,o[p++]=_+3,o[p++]=_+1,o[p++]=_+2,o[p++]=_+3,bufferPositions_.vertexPosition=c,bufferPositions_.indexPosition=p,bufferPositions_}function writeLineSegmentToBuffers(r,t,e,o,a,n,i,u,s,l,f){var c=8+u.length,p=n.length/c,_=[r[t+0],r[t+1]],h=[r[e],r[e+1]],y=(0,_transform.apply)(s,[].concat(_)),d=(0,_transform.apply)(s,[].concat(h));function m(r,t,e){var o=Math.sqrt((t[0]-r[0])*(t[0]-r[0])+(t[1]-r[1])*(t[1]-r[1])),a=[(t[0]-r[0])/o,(t[1]-r[1])/o],n=[-a[1],a[0]],i=Math.sqrt((e[0]-r[0])*(e[0]-r[0])+(e[1]-r[1])*(e[1]-r[1])),u=[(e[0]-r[0])/i,(e[1]-r[1])/i],s=0===o||0===i?0:Math.acos((0,_math.clamp)(u[0]*a[0]+u[1]*a[1],-1,1));return u[0]*n[0]+u[1]*n[1]>0?s:2*Math.PI-s}var g=-1,I=-1,T=f,A=null!==a;if(null!==o){var v=[r[o],r[o+1]];g=m(y,d,(0,_transform.apply)(s,[].concat(v))),Math.cos(g)<=LINESTRING_ANGLE_COSINE_CUTOFF&&(T+=Math.tan((g-Math.PI)/2))}if(A){var b=[r[a],r[a+1]];I=m(d,y,(0,_transform.apply)(s,[].concat(b))),Math.cos(I)<=LINESTRING_ANGLE_COSINE_CUTOFF&&(T+=Math.tan((Math.PI-I)/2))}function P(r,t){return 0===t?1e4*r:Math.sign(t)*(1e4*r+Math.abs(t))}return n.push(_[0],_[1],h[0],h[1],g,I,l,P(0,f)),n.push.apply(n,_toConsumableArray(u)),n.push(_[0],_[1],h[0],h[1],g,I,l,P(1,f)),n.push.apply(n,_toConsumableArray(u)),n.push(_[0],_[1],h[0],h[1],g,I,l,P(2,f)),n.push.apply(n,_toConsumableArray(u)),n.push(_[0],_[1],h[0],h[1],g,I,l,P(3,f)),n.push.apply(n,_toConsumableArray(u)),i.push(p,p+1,p+2,p+1,p+3,p+2),{length:l+Math.sqrt((d[0]-y[0])*(d[0]-y[0])+(d[1]-y[1])*(d[1]-y[1])),angle:T}}function writePolygonTrianglesToBuffers(r,t,e,o,a){var n=2+a,i=t,u=r.slice(i,i+a);i+=a;for(var s=r[i++],l=0,f=new Array(s-1),c=0;c<s;c++)l+=r[i++],c<s-1&&(f[c]=l);for(var p=r.slice(i,i+2*l),_=(0,_earcut.default)(p,f,2),h=0;h<_.length;h++)o.push(_[h]+e.length/n);for(var y=0;y<p.length;y+=2)e.push.apply(e,[p[y],p[y+1]].concat(_toConsumableArray(u)));return i+2*l}function getBlankImageData(){var r=document.createElement("canvas").getContext("2d").createImageData(1,1);return r.data[0]=255,r.data[1]=255,r.data[2]=255,r.data[3]=255,r}function colorEncodeId(r,t){return(t=t||[])[0]=Math.floor(r/256/256/256)/255,t[1]=Math.floor(r/256/256)%256/255,t[2]=Math.floor(r/256)%256/255,t[3]=r%256/255,t}function colorDecodeId(r){var t=0;return t+=Math.round(256*r[0]*256*256*255),t+=Math.round(256*r[1]*256*255),t+=Math.round(256*r[2]*255),t+=Math.round(255*r[3])}

},{"../../math.js":279,"../../transform.js":402,"earcut":19}],313:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("../layer/BaseVector.js")),_Map=_interopRequireDefault(require("./Map.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_Event=_interopRequireDefault(require("../render/Event.js")),_EventType=_interopRequireDefault(require("../render/EventType.js")),_css=require("../css.js"),_canvas=require("../render/canvas.js"),_Layer=require("../layer/Layer.js"),_events=require("../events.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CompositeMapRenderer=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e])).fontChangeListenerKey_=(0,_events.listen)(_canvas.checkedFonts,_ObjectEventType.default.PROPERTYCHANGE,e.redrawText.bind(e)),r.element_=document.createElement("div");var n=r.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",r.element_.className=_css.CLASS_UNSELECTABLE+" ol-layers";var o=e.getViewport();return o.insertBefore(r.element_,o.firstChild||null),r.children_=[],r.renderedVisible_=!0,r}return _inherits(t,_Map["default"]),_createClass(t,[{key:"dispatchRenderEvent",value:function(e,t){var r=this.getMap();if(r.hasListener(e)){var n=new _Event.default(e,void 0,t);r.dispatchEvent(n)}}},{key:"disposeInternal",value:function(){(0,_events.unlistenByKey)(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(_EventType.default.PRECOMPOSE,e);var t=e.layerStatesArray.sort(function(e,t){return e.zIndex-t.zIndex});t.some(function(e){return e.layer instanceof _BaseVector.default&&e.layer.getDeclutter()})&&(e.declutter={});var r=e.viewState;this.children_.length=0;for(var n=[],o=null,i=0,s=t.length;i<s;++i){var l=t[i];e.layerIndex=i;var u=l.layer,a=u.getSourceState();if(!(0,_Layer.inView)(l,r)||"ready"!=a&&"undefined"!=a)u.unrender();else{var c=u.render(e,o);c&&(c!==o&&(this.children_.push(c),o=c),n.push(l))}}this.declutter(e,n),(0,_dom.replaceChildren)(this.element_,this.children_),this.dispatchRenderEvent(_EventType.default.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}},{key:"declutter",value:function(e,t){if(e.declutter){for(var r=t.length-1;r>=0;--r){var n=t[r],o=n.layer;o.getDeclutter()&&o.renderDeclutter(e,n)}t.forEach(function(t){return t.layer.renderDeferred(e)})}}}])}(),_default=exports.default=CompositeMapRenderer;

},{"../ObjectEventType.js":97,"../css.js":129,"../dom.js":130,"../events.js":132,"../layer/BaseVector.js":264,"../layer/Layer.js":269,"../render/Event.js":293,"../render/EventType.js":294,"../render/canvas.js":297,"./Map.js":315}],314:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Observable2=_interopRequireDefault(require("../Observable.js")),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var LayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).ready=!0,r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=e,r}return _inherits(t,_Observable2["default"]),_createClass(t,[{key:"getFeatures",value:function(e){return(0,_util.abstract)()}},{key:"getData",value:function(e){return null}},{key:"prepareFrame",value:function(e){return(0,_util.abstract)()}},{key:"renderFrame",value:function(e,t){return(0,_util.abstract)()}},{key:"loadedTileCallback",value:function(e,t,r){e[t]||(e[t]={}),e[t][r.tileCoord.toString()]=r}},{key:"createLoadedTileFinder",value:function(e,t,r){var n=this;return function(o,a){var i=n.loadedTileCallback.bind(n,r,o);return e.forEachLoadedTile(t,o,a,i)}}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,o){}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(e){var t=e.target;t.getState()!==_ImageState.default.LOADED&&t.getState()!==_ImageState.default.ERROR||this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(e){var t=e.getState();return t!=_ImageState.default.LOADED&&t!=_ImageState.default.ERROR&&e.addEventListener(_EventType.default.CHANGE,this.boundHandleImageChange_),t==_ImageState.default.IDLE&&(e.load(),t=e.getState()),t==_ImageState.default.LOADED}},{key:"renderIfReadyAndVisible",value:function(){var e=this.getLayer();e&&e.getVisible()&&"ready"===e.getSourceState()&&e.changed()}},{key:"renderDeferred",value:function(e){}},{key:"disposeInternal",value:function(){delete this.layer_,_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}(),_default=exports.default=LayerRenderer;

},{"../ImageState.js":86,"../Observable.js":98,"../events/EventType.js":134,"../util.js":404}],315:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_functions=require("../functions.js"),_util=require("../util.js"),_transform=require("../transform.js"),_extent=require("../extent.js"),_IconImageCache=require("../style/IconImageCache.js"),_Layer=require("../layer/Layer.js"),_coordinate=require("../coordinate.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var MapRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).map_=e,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"dispatchRenderEvent",value:function(e,t){(0,_util.abstract)()}},{key:"calculateMatrices2D",value:function(e){var t=e.viewState,r=e.coordinateToPixelTransform,o=e.pixelToCoordinateTransform;(0,_transform.compose)(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),(0,_transform.makeInverse)(o,r)}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,o,n,i,a,u){var c,s=t.viewState;function f(e,t,r,o){return n.call(i,t,e?r:null,o)}var l=s.projection,p=(0,_coordinate.wrapX)(e.slice(),l),y=[[0,0]];if(l.canWrapX()&&o){var _=l.getExtent(),d=(0,_extent.getWidth)(_);y.push([-d,0],[d,0])}for(var v=t.layerStatesArray,h=v.length,b=[],m=[],g=0;g<y.length;g++)for(var P=h-1;P>=0;--P){var C=v[P],j=C.layer;if(j.hasRenderer()&&(0,_Layer.inView)(C,s)&&a.call(u,j)){var O=j.getRenderer(),w=j.getSource();if(O&&w){var R=w.getWrapX()?p:e,S=f.bind(null,C.managed);m[0]=R[0]+y[g][0],m[1]=R[1]+y[g][1],c=O.forEachFeatureAtCoordinate(m,t,r,S,b)}if(c)return c}}if(0!==b.length){var x=1/b.length;return b.forEach(function(e,t){return e.distanceSq+=t*x}),b.sort(function(e,t){return e.distanceSq-t.distanceSq}),b.some(function(e){return c=e.callback(e.feature,e.layer,e.geometry)}),c}}},{key:"hasFeatureAtCoordinate",value:function(e,t,r,o,n,i){return void 0!==this.forEachFeatureAtCoordinate(e,t,r,o,_functions.TRUE,this,n,i)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(e){(0,_util.abstract)()}},{key:"scheduleExpireIconCache",value:function(e){_IconImageCache.shared.canExpireCache()&&e.postRenderFunctions.push(expireIconCache)}}])}();function expireIconCache(e,t){_IconImageCache.shared.expire()}var _default=exports.default=MapRenderer;

},{"../Disposable.js":81,"../coordinate.js":128,"../extent.js":142,"../functions.js":200,"../layer/Layer.js":269,"../style/IconImageCache.js":389,"../transform.js":402,"../util.js":404}],316:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer=_interopRequireDefault(require("./Layer.js")),_ImageState=_interopRequireDefault(require("../../ImageState.js")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_transform=require("../../transform.js"),_extent=require("../../extent.js"),_proj=require("../../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CanvasImageLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).image_=null,r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"getImage",value:function(){return this.image_?this.image_.getImage():null}},{key:"prepareFrame",value:function(e){var t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,n=e.viewState,o=n.resolution,i=this.getLayer().getSource(),a=e.viewHints,u=e.extent;if(void 0!==t.extent&&(u=(0,_extent.getIntersection)(u,(0,_proj.fromUserExtent)(t.extent,n.projection))),!a[_ViewHint.default.ANIMATING]&&!a[_ViewHint.default.INTERACTING]&&!(0,_extent.isEmpty)(u))if(i){var l=n.projection,s=i.getImage(u,o,r,l);s&&(this.loadImage(s)?this.image_=s:s.getState()===_ImageState.default.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}},{key:"getData",value:function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),n=(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()),o=r.getExtent();if(o&&!(0,_extent.containsCoordinate)(o,n))return null;var i=this.image_.getExtent(),a=this.image_.getImage(),u=(0,_extent.getWidth)(i),l=Math.floor(a.width*((n[0]-i[0])/u));if(l<0||l>=a.width)return null;var s=(0,_extent.getHeight)(i),f=Math.floor(a.height*((i[3]-n[1])/s));return f<0||f>=a.height?null:this.getImageData(a,l,f)}},{key:"renderFrame",value:function(e,t){var r=this.image_,n=r.getExtent(),o=r.getResolution(),i=_slicedToArray(Array.isArray(o)?o:[o,o],2),a=i[0],u=i[1],l=r.getPixelRatio(),s=e.layerStatesArray[e.layerIndex],f=e.pixelRatio,c=e.viewState,y=c.center,p=c.resolution,_=f*a/(p*l),h=f*u/(p*l);this.prepareContainer(e,t);var g=this.context.canvas.width,m=this.context.canvas.height,d=this.getRenderContext(e),v=!1,b=!0;if(s.extent){var x=(0,_proj.fromUserExtent)(s.extent,c.projection);(v=(b=(0,_extent.intersects)(x,e.extent))&&!(0,_extent.containsExtent)(x,e.extent))&&this.clipUnrotated(d,e,x)}var j=r.getImage(),w=(0,_transform.compose)(this.tempTransform,g/2,m/2,_,h,0,l*(n[0]-y[0])/a,l*(y[1]-n[3])/u);this.renderedResolution=u*f/l;var I=j.width*w[0],S=j.height*w[3];if(this.getLayer().getSource().getInterpolate()||(d.imageSmoothingEnabled=!1),this.preRender(d,e),b&&I>=.5&&S>=.5){var P=w[4],O=w[5],R=s.opacity;1!==R&&(d.save(),d.globalAlpha=R),d.drawImage(j,0,0,+j.width,+j.height,P,O,I,S),1!==R&&d.restore()}return this.postRender(this.context,e),v&&d.restore(),d.imageSmoothingEnabled=!0,this.container}}])}(),_default=exports.default=CanvasImageLayerRenderer;

},{"../../ImageState.js":86,"../../ViewHint.js":108,"../../extent.js":142,"../../proj.js":283,"../../transform.js":402,"./Layer.js":317}],317:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.canvasPool=void 0;var _Layer=_interopRequireDefault(require("../Layer.js")),_Event=_interopRequireDefault(require("../../render/Event.js")),_EventType=_interopRequireDefault(require("../../render/EventType.js")),_ZIndexContext=_interopRequireDefault(require("../../render/canvas/ZIndexContext.js")),_transform=require("../../transform.js"),_color=require("../../color.js"),_dom=require("../../dom.js"),_array=require("../../array.js"),_extent=require("../../extent.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var canvasPool=exports.canvasPool=[],pixelContext=null;function createPixelContext(){pixelContext=(0,_dom.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})}var CanvasLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).container=null,r.renderedResolution,r.tempTransform=(0,_transform.create)(),r.pixelTransform=(0,_transform.create)(),r.inversePixelTransform=(0,_transform.create)(),r.context=null,r.deferredContext_=null,r.containerReused=!1,r.pixelContext_=null,r.frameState=null,r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"getImageData",value:function(e,t,r){var n;pixelContext||createPixelContext(),pixelContext.clearRect(0,0,1,1);try{pixelContext.drawImage(e,t,r,1,1,0,0,1,1),n=pixelContext.getImageData(0,0,1,1).data}catch(e){return pixelContext=null,null}return n}},{key:"getBackground",value:function(e){var t=this.getLayer().getBackground();return"function"==typeof t&&(t=t(e.viewState.resolution)),t||void 0}},{key:"useContainer",value:function(e,t,r){var n,o,a=this.getLayer().getClassName();if(e&&e.className===a&&(!r||e&&e.style.backgroundColor&&(0,_array.equals)((0,_color.asArray)(e.style.backgroundColor),(0,_color.asArray)(r)))){var i=e.firstElementChild;i instanceof HTMLCanvasElement&&(o=i.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(n=document.createElement("div")).className=a;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var l=(o=(0,_dom.createCanvasContext2D)()).canvas;n.appendChild(l),(s=l.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=o}this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)}},{key:"clipUnrotated",value:function(e,t,r){var n=(0,_extent.getTopLeft)(r),o=(0,_extent.getTopRight)(r),a=(0,_extent.getBottomRight)(r),i=(0,_extent.getBottomLeft)(r);(0,_transform.apply)(t.coordinateToPixelTransform,n),(0,_transform.apply)(t.coordinateToPixelTransform,o),(0,_transform.apply)(t.coordinateToPixelTransform,a),(0,_transform.apply)(t.coordinateToPixelTransform,i);var s=this.inversePixelTransform;(0,_transform.apply)(s,n),(0,_transform.apply)(s,o),(0,_transform.apply)(s,a),(0,_transform.apply)(s,i),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.clip()}},{key:"prepareContainer",value:function(e,t){var r=e.extent,n=e.viewState.resolution,o=e.viewState.rotation,a=e.pixelRatio,i=Math.round((0,_extent.getWidth)(r)/n*a),s=Math.round((0,_extent.getHeight)(r)/n*a);(0,_transform.compose)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,o,-i/2,-s/2),(0,_transform.makeInverse)(this.inversePixelTransform,this.pixelTransform);var l=(0,_transform.toString)(this.pixelTransform);if(this.useContainer(t,l,this.getBackground(e)),!this.containerReused){var u=this.context.canvas;u.width!=i||u.height!=s?(u.width=i,u.height=s):this.context.clearRect(0,0,i,s),l!==u.style.transform&&(u.style.transform=l)}}},{key:"dispatchRenderEvent_",value:function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){var o=new _Event.default(e,this.inversePixelTransform,r,t);n.dispatchEvent(o)}}},{key:"preRender",value:function(e,t){this.frameState=t,t.declutter||this.dispatchRenderEvent_(_EventType.default.PRERENDER,e,t)}},{key:"postRender",value:function(e,t){t.declutter||this.dispatchRenderEvent_(_EventType.default.POSTRENDER,e,t)}},{key:"renderDeferredInternal",value:function(e){}},{key:"getRenderContext",value:function(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new _ZIndexContext.default),e.declutter?this.deferredContext_.getContext():this.context}},{key:"renderDeferred",value:function(e){e.declutter&&(this.dispatchRenderEvent_(_EventType.default.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(_EventType.default.POSTRENDER,this.context,e))}},{key:"getRenderTransform",value:function(e,t,r,n,o,a,i){var s=o/2,l=a/2,u=n/t,c=-u,f=-e[0]+i,p=-e[1];return(0,_transform.compose)(this.tempTransform,s,l,u,c,-r,f,p)}},{key:"disposeInternal",value:function(){delete this.frameState,_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}(),_default=exports.default=CanvasLayerRenderer;

},{"../../array.js":110,"../../color.js":113,"../../dom.js":130,"../../extent.js":142,"../../render/Event.js":293,"../../render/EventType.js":294,"../../render/canvas/ZIndexContext.js":308,"../../transform.js":402,"../Layer.js":314}],318:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer=_interopRequireDefault(require("./Layer.js")),_ImageTile=_interopRequireDefault(require("../../ImageTile.js")),_Tile=_interopRequireDefault(require("../../reproj/Tile.js")),_TileRange=_interopRequireDefault(require("../../TileRange.js")),_TileState=_interopRequireDefault(require("../../TileState.js")),_transform=require("../../transform.js"),_array=require("../../array.js"),_extent=require("../../extent.js"),_proj=require("../../proj.js"),_util=require("../../util.js"),_size=require("../../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CanvasTileLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=(0,_extent.createEmpty)(),r.tmpTileRange_=new _TileRange.default(0,0,0,0),r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"isDrawableTile",value:function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==_TileState.default.LOADED||r==_TileState.default.EMPTY||r==_TileState.default.ERROR&&!i}},{key:"getTile",value:function(e,t,r,i){var n=i.pixelRatio,o=i.viewState.projection,a=this.getLayer(),l=a.getSource().getTile(e,t,r,n,o);return l.getState()==_TileState.default.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(l)||(l=l.getInterimTile()),l}},{key:"getData",value:function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),i=(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()),n=r.getExtent();if(n&&!(0,_extent.containsCoordinate)(n,i))return null;for(var o=t.pixelRatio,a=t.viewState.projection,l=t.viewState,s=r.getRenderSource(),u=s.getTileGridForProjection(l.projection),c=s.getTilePixelRatio(t.pixelRatio),f=u.getZForResolution(l.resolution);f>=u.getMinZoom();--f){var d=u.getTileCoordForCoordAndZ(i,f),p=s.getTile(f,d[1],d[2],o,a);if(!(p instanceof _ImageTile.default||p instanceof _Tile.default)||p instanceof _Tile.default&&p.getState()===_TileState.default.EMPTY)return null;if(p.getState()===_TileState.default.LOADED){var g=u.getOrigin(f),_=(0,_size.toSize)(u.getTileSize(f)),h=u.getResolution(f),y=Math.floor(c*((i[0]-g[0])/h-d[1]*_[0])),T=Math.floor(c*((g[1]-i[1])/h-d[2]*_[1])),v=Math.round(c*s.getGutterForProjection(l.projection));return this.getImageData(p.getImage(),y+v,T+v)}}return null}},{key:"loadedTileCallback",value:function(e,r,i){return!!this.isDrawableTile(i)&&_get(_getPrototypeOf(t.prototype),"loadedTileCallback",this).call(this,e,r,i)}},{key:"prepareFrame",value:function(e){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(e,t){var r=e.layerStatesArray[e.layerIndex],i=e.viewState,n=i.projection,o=i.resolution,a=i.center,l=i.rotation,s=e.pixelRatio,u=this.getLayer(),c=u.getSource(),f=c.getRevision(),d=c.getTileGridForProjection(n),p=d.getZForResolution(o,c.zDirection),g=d.getResolution(p),_=e.extent,h=e.viewState.resolution,y=c.getTilePixelRatio(s);this.prepareContainer(e,t);var T=this.context.canvas.width,v=this.context.canvas.height,m=r.extent&&(0,_proj.fromUserExtent)(r.extent,n);m&&(_=(0,_extent.getIntersection)(_,(0,_proj.fromUserExtent)(r.extent,n)));var R=g*T/2/y,x=g*v/2/y,b=[a[0]-R,a[1]-x,a[0]+R,a[1]+x],P=d.getTileRangeForExtentAndZ(_,p),S={};S[p]={};var w=this.createLoadedTileFinder(c,n,S),j=this.tmpExtent,C=this.tmpTileRange_;this.newTiles_=!1;for(var O=l?(0,_extent.getRotatedViewport)(i.center,h,l,e.size):void 0,E=P.minX;E<=P.maxX;++E)for(var I=P.minY;I<=P.maxY;++I)if(!l||d.tileCoordIntersectsViewport([p,E,I],O)){var D=this.getTile(p,E,I,e);if(this.isDrawableTile(D)){var q=(0,_util.getUid)(this);if(D.getState()==_TileState.default.LOADED){S[p][D.tileCoord.toString()]=D;var k=D.inTransition(q);k&&1!==r.opacity&&(D.endTransition(q),k=!1),this.newTiles_||!k&&this.renderedTiles.includes(D)||(this.newTiles_=!0)}if(1===D.getAlpha(q,e.time))continue}var L=d.getTileCoordChildTileRange(D.tileCoord,C,j),A=!1;L&&(A=w(p+1,L)),A||d.forEachTileCoordParentTileRange(D.tileCoord,w,C,j)}var F=g/o*s/y,M=this.getRenderContext(e);(0,_transform.compose)(this.tempTransform,T/2,v/2,F,F,0,-T/2,-v/2),m&&this.clipUnrotated(M,e,m),c.getInterpolate()||(M.imageSmoothingEnabled=!1),this.preRender(M,e),this.renderedTiles.length=0;var U,z,Z,K=Object.keys(S).map(Number);K.sort(_array.ascending),1!==r.opacity||this.containerReused&&!c.getOpaque(e.viewState.projection)?(U=[],z=[]):K=K.reverse();for(var Y=K.length-1;Y>=0;--Y){var N=K[Y],B=c.getTilePixelSize(N,s,n),G=d.getResolution(N)/g,V=B[0]*G*F,X=B[1]*G*F,Q=d.getTileCoordForCoordAndZ((0,_extent.getTopLeft)(b),N),H=d.getTileCoordExtent(Q),J=(0,_transform.apply)(this.tempTransform,[y*(H[0]-b[0])/g,y*(b[3]-H[3])/g]),W=y*c.getGutterForProjection(n),$=S[N];for(var ee in $){var te=$[ee],re=te.tileCoord,ie=Q[1]-re[1],ne=Math.round(J[0]-(ie-1)*V),oe=Q[2]-re[2],ae=Math.round(J[1]-(oe-1)*X),le=Math.round(J[0]-ie*V),se=Math.round(J[1]-oe*X),ue=ne-le,ce=ae-se,fe=p===N,de=fe&&1!==te.getAlpha((0,_util.getUid)(this),e.time),pe=!1;if(!de)if(U){Z=[le,se,le+ue,se,le+ue,se+ce,le,se+ce];for(var ge=0,_e=U.length;ge<_e;++ge)if(p!==N&&N<z[ge]){var he=U[ge];(0,_extent.intersects)([le,se,le+ue,se+ce],[he[0],he[3],he[4],he[7]])&&(pe||(M.save(),pe=!0),M.beginPath(),M.moveTo(Z[0],Z[1]),M.lineTo(Z[2],Z[3]),M.lineTo(Z[4],Z[5]),M.lineTo(Z[6],Z[7]),M.moveTo(he[6],he[7]),M.lineTo(he[4],he[5]),M.lineTo(he[2],he[3]),M.lineTo(he[0],he[1]),M.clip())}U.push(Z),z.push(N)}else M.clearRect(le,se,ue,ce);this.drawTileImage(te,e,le,se,ue,ce,W,fe),U&&!de?(pe&&M.restore(),this.renderedTiles.unshift(te)):this.renderedTiles.push(te),this.updateUsedTiles(e.usedTiles,c,te)}}return this.renderedRevision=f,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!(0,_extent.equals)(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=s,this.renderedProjection=n,this.manageTilePyramid(e,c,d,s,n,_,p,u.getPreload()),this.scheduleExpireCache(e,c),this.postRender(this.context,e),r.extent&&M.restore(),M.imageSmoothingEnabled=!0,this.container}},{key:"drawTileImage",value:function(e,t,r,i,n,o,a,l){var s=this.getTileImage(e);if(s){var u=this.getRenderContext(t),c=(0,_util.getUid)(this),f=t.layerStatesArray[t.layerIndex],d=f.opacity*(l?e.getAlpha(c,t.time):1),p=d!==u.globalAlpha;p&&(u.save(),u.globalAlpha=d),u.drawImage(s,a,a,s.width-2*a,s.height-2*a,r,i,n,o),p&&u.restore(),d!==f.opacity?t.animate=!0:l&&e.endTransition(c)}}},{key:"getImage",value:function(){var e=this.context;return e?e.canvas:null}},{key:"getTileImage",value:function(e){return e.getImage()}},{key:"scheduleExpireCache",value:function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var i=(0,_util.getUid)(e);i in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[i])}.bind(null,t);e.postRenderFunctions.push(r)}}},{key:"updateUsedTiles",value:function(e,t,r){var i=(0,_util.getUid)(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}},{key:"manageTilePyramid",value:function(e,t,r,i,n,o,a,l,s){var u=(0,_util.getUid)(t);u in e.wantedTiles||(e.wantedTiles[u]={});var c,f,d,p,g,_,h=e.wantedTiles[u],y=e.tileQueue,T=r.getMinZoom(),v=e.viewState.rotation,m=v?(0,_extent.getRotatedViewport)(e.viewState.center,e.viewState.resolution,v,e.size):void 0,R=0;for(_=T;_<=a;++_)for(f=r.getTileRangeForExtentAndZ(o,_,f),d=r.getResolution(_),p=f.minX;p<=f.maxX;++p)for(g=f.minY;g<=f.maxY;++g)v&&!r.tileCoordIntersectsViewport([_,p,g],m)||(a-_<=l?(++R,(c=t.getTile(_,p,g,i,n)).getState()==_TileState.default.IDLE&&(h[c.getKey()]=!0,y.isKeyQueued(c.getKey())||y.enqueue([c,u,r.getTileCoordCenter(c.tileCoord),d])),void 0!==s&&s(c)):t.useTile(_,p,g,n));t.updateCacheSize(R,n)}}])}(),_default=exports.default=CanvasTileLayerRenderer;

},{"../../ImageTile.js":87,"../../TileRange.js":103,"../../TileState.js":104,"../../array.js":110,"../../extent.js":142,"../../proj.js":283,"../../reproj/Tile.js":331,"../../size.js":337,"../../transform.js":402,"../../util.js":404,"./Layer.js":317}],319:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageLayer=_interopRequireDefault(require("./ImageLayer.js")),_VectorLayer=_interopRequireDefault(require("./VectorLayer.js")),_EventType=_interopRequireDefault(require("../../events/EventType.js")),_ImageCanvas=_interopRequireDefault(require("../../ImageCanvas.js")),_ImageState=_interopRequireDefault(require("../../ImageState.js")),_rbush=_interopRequireDefault(require("rbush")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_transform=require("../../transform.js"),_resolution=require("../../resolution.js"),_extent=require("../../extent.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CanvasVectorImageLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).vectorRenderer_=new _VectorLayer.default(e),r.layerImageRatio_=e.getImageRatio(),r.coordinateToVectorPixelTransform_=(0,_transform.create)(),r.renderedPixelToCoordinateTransform_=null,r}return _inherits(t,_ImageLayer["default"]),_createClass(t,[{key:"disposeInternal",value:function(){this.vectorRenderer_.dispose(),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"getFeatures",value:function(e){if(!this.vectorRenderer_)return Promise.resolve([]);var t=(0,_transform.apply)(this.coordinateToVectorPixelTransform_,(0,_transform.apply)(this.renderedPixelToCoordinateTransform_,e.slice()));return this.vectorRenderer_.getFeatures(t)}},{key:"handleFontsChanged",value:function(){this.vectorRenderer_.handleFontsChanged()}},{key:"prepareFrame",value:function(e){var t=this,r=e.pixelRatio,o=e.viewState,n=o.resolution,i=e.viewHints,a=this.vectorRenderer_,u=e.extent;1!==this.layerImageRatio_&&(u=u.slice(0),(0,_extent.scaleFromCenter)(u,this.layerImageRatio_));var l=(0,_extent.getWidth)(u)/n,s=(0,_extent.getHeight)(u)/n;if(!i[_ViewHint.default.ANIMATING]&&!i[_ViewHint.default.INTERACTING]&&!(0,_extent.isEmpty)(u)){a.useContainer(null,null);var c=a.context,f=e.layerStatesArray[e.layerIndex],p=Object.assign({},f,{opacity:1}),_=Object.assign({},e,{extent:u,size:[l,s],viewState:Object.assign({},e.viewState,{rotation:0}),layerStatesArray:[p],layerIndex:0,declutter:null}),y=this.getLayer().getDeclutter();y&&(_.declutter=_defineProperty({},y,new _rbush.default(9)));var d=!0,v=new _ImageCanvas.default(u,n,r,c.canvas,function(e){a.prepareFrame(_)&&a.replayGroupChanged&&(a.clipping=!1,a.renderFrame(_,null)&&(a.renderDeclutter(_),a.renderDeferred(_),d=!1),e())});v.addEventListener(_EventType.default.CHANGE,function(){if(v.getState()===_ImageState.default.LOADED){t.image_=d?null:v;var e=v.getPixelRatio(),n=(0,_resolution.fromResolutionLike)(v.getResolution())*r/e;t.renderedResolution=n,t.coordinateToVectorPixelTransform_=(0,_transform.compose)(t.coordinateToVectorPixelTransform_,l/2,s/2,1/n,-1/n,0,-o.center[0],-o.center[1])}}),v.load()}return this.image_&&(this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice()),!!this.image_}},{key:"preRender",value:function(){}},{key:"postRender",value:function(){}},{key:"renderDeclutter",value:function(){}},{key:"forEachFeatureAtCoordinate",value:function(e,r,o,n,i){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,r,o,n,i):_get(_getPrototypeOf(t.prototype),"forEachFeatureAtCoordinate",this).call(this,e,r,o,n,i)}}])}(),_default=exports.default=CanvasVectorImageLayerRenderer;

},{"../../ImageCanvas.js":85,"../../ImageState.js":86,"../../ViewHint.js":108,"../../events/EventType.js":134,"../../extent.js":142,"../../resolution.js":334,"../../transform.js":402,"./ImageLayer.js":316,"./VectorLayer.js":320,"rbush":427}],320:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BuilderGroup=_interopRequireDefault(require("../../render/canvas/BuilderGroup.js")),_Layer=_interopRequireWildcard(require("./Layer.js")),_ExecutorGroup=_interopRequireWildcard(require("../../render/canvas/ExecutorGroup.js")),_EventType=_interopRequireDefault(require("../../render/EventType.js")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_hitdetect=require("../../render/canvas/hitdetect.js"),_extent2=require("../../extent.js"),_dom=require("../../dom.js"),_vector=require("../vector.js"),_array=require("../../array.js"),_proj=require("../../proj.js"),_util=require("../../util.js"),_coordinate=require("../../coordinate.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CanvasVectorLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.hitDetectionImageData_=null,r.clipped_=!1,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=(0,_extent2.createEmpty)(),r.wrappedRenderedExtent_=(0,_extent2.createEmpty)(),r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedPixelRatio_=1,r.renderedRenderOrder_=null,r.renderedFrameDeclutter_,r.replayGroup_=null,r.replayGroupChanged=!0,r.clipping=!0,r.targetContext_=null,r.opacity_=1,r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"renderWorlds",value:function(e,t,r){var n=t.extent,i=t.viewState,o=i.center,a=i.resolution,u=i.projection,s=i.rotation,l=u.getExtent(),c=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),_=t.pixelRatio,p=t.viewHints,h=!(p[_ViewHint.default.ANIMATING]||p[_ViewHint.default.INTERACTING]),f=this.context,y=Math.round((0,_extent2.getWidth)(n)/a*_),g=Math.round((0,_extent2.getHeight)(n)/a*_),v=c.getWrapX()&&u.canWrapX(),x=v?(0,_extent2.getWidth)(l):null,R=v?Math.ceil((n[2]-l[2])/x)+1:1,m=v?Math.floor((n[0]-l[0])/x):0;do{var E=this.getRenderTransform(o,a,0,_,y,g,m*x);t.declutter&&(E=E.slice(0)),e.execute(f,[f.canvas.width,f.canvas.height],E,s,h,void 0===r?_ExecutorGroup.ALL:r?_ExecutorGroup.DECLUTTER:_ExecutorGroup.NON_DECLUTTER,r?d&&t.declutter[d]:void 0)}while(++m<R)}},{key:"setDrawContext_",value:function(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=(0,_dom.createCanvasContext2D)(this.context.canvas.width,this.context.canvas.height,_Layer.canvasPool))}},{key:"resetDrawContext_",value:function(){if(1!==this.opacity_){var e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,(0,_dom.releaseCanvas)(this.context),_Layer.canvasPool.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}},{key:"renderDeclutter",value:function(e){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,e,!0)}},{key:"renderDeferredInternal",value:function(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}},{key:"renderFrame",value:function(e,t){var r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;var n=e.viewState;this.prepareContainer(e,t);var i=this.context,o=this.replayGroup_,a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(_EventType.default.PRERENDER)||this.getLayer().hasListener(_EventType.default.POSTRENDER)))return null;this.setDrawContext_(),this.preRender(i,e);var u=n.projection;if(this.clipped_=!1,a&&r.extent&&this.clipping){var s=(0,_proj.fromUserExtent)(r.extent,u);a=(0,_extent2.intersects)(s,e.extent),this.clipped_=a&&!(0,_extent2.containsExtent)(s,e.extent),this.clipped_&&this.clipUnrotated(i,e,s)}return a&&this.renderWorlds(o,e,!this.getLayer().getDeclutter()&&void 0),!e.declutter&&this.clipped_&&i.restore(),this.postRender(i,e),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}},{key:"getFeatures",value:function(e){var t=this;return new Promise(function(r){if(t.frameState&&!t.hitDetectionImageData_&&!t.animatingOrInteracting_){var n=t.frameState.size.slice(),i=t.renderedCenter_,o=t.renderedResolution_,a=t.renderedRotation_,u=t.renderedProjection_,s=t.wrappedRenderedExtent_,l=t.getLayer(),c=[],d=n[0]*_hitdetect.HIT_DETECT_RESOLUTION,_=n[1]*_hitdetect.HIT_DETECT_RESOLUTION;c.push(t.getRenderTransform(i,o,a,_hitdetect.HIT_DETECT_RESOLUTION,d,_,0).slice());var p=l.getSource(),h=u.getExtent();if(p.getWrapX()&&u.canWrapX()&&!(0,_extent2.containsExtent)(h,s)){for(var f,y=s[0],g=(0,_extent2.getWidth)(h),v=0;y<h[0];)f=g*--v,c.push(t.getRenderTransform(i,o,a,_hitdetect.HIT_DETECT_RESOLUTION,d,_,f).slice()),y+=g;for(v=0,y=s[2];y>h[2];)f=g*++v,c.push(t.getRenderTransform(i,o,a,_hitdetect.HIT_DETECT_RESOLUTION,d,_,f).slice()),y-=g}var x=(0,_proj.getUserProjection)();t.hitDetectionImageData_=(0,_hitdetect.createHitDetectionImageData)(n,c,t.renderedFeatures_,l.getStyleFunction(),s,o,a,(0,_vector.getSquaredTolerance)(o,t.renderedPixelRatio_),x?u:null)}r((0,_hitdetect.hitDetect)(e,t.renderedFeatures_,t.hitDetectionImageData_))})}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i){if(this.replayGroup_){var o,a=t.viewState.resolution,u=t.viewState.rotation,s=this.getLayer(),l={},c=function(e,t,r){var o=(0,_util.getUid)(e),a=l[o];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return l[o]=!0,i.splice(i.lastIndexOf(a),1),n(e,s,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return l[o]=!0,n(e,s,t);i.push(l[o]={feature:e,layer:s,geometry:t,distanceSq:r,callback:n})}},d=[this.replayGroup_],_=this.getLayer().getDeclutter();return d.some(function(n){return o=n.forEachFeatureAtCoordinate(e,a,u,r,c,_&&t.declutter[_]?t.declutter[_].all().map(function(e){return e.value}):null)}),o}}},{key:"handleFontsChanged",value:function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}},{key:"handleStyleImageChange_",value:function(e){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(e){var t=this,r=this.getLayer(),n=r.getSource();if(!n)return!1;var i=e.viewHints[_ViewHint.default.ANIMATING],o=e.viewHints[_ViewHint.default.INTERACTING],a=r.getUpdateWhileAnimating(),u=r.getUpdateWhileInteracting();if(this.ready&&!a&&i||!u&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=e.extent,l=e.viewState,c=l.projection,d=l.resolution,_=e.pixelRatio,p=r.getRevision(),h=r.getRenderBuffer(),f=r.getRenderOrder();void 0===f&&(f=_vector.defaultOrder);var y=l.center.slice(),g=(0,_extent2.buffer)(s,h*d),v=g.slice(),x=[g.slice()],R=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!(0,_extent2.containsExtent)(R,e.extent)){var m=(0,_extent2.getWidth)(R),E=Math.max((0,_extent2.getWidth)(g)/2,m);g[0]=R[0]-E,g[2]=R[2]+E,(0,_coordinate.wrapX)(y,c);var C=(0,_extent2.wrapX)(x[0],c);C[0]<R[0]&&C[2]<R[2]?x.push([C[0]+m,C[1],C[2]+m,C[3]]):C[0]>R[0]&&C[2]>R[2]&&x.push([C[0]-m,C[1],C[2]-m,C[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==p&&this.renderedRenderOrder_==f&&this.renderedFrameDeclutter_===!!e.declutter&&(0,_extent2.containsExtent)(this.wrappedRenderedExtent_,g))return(0,_array.equals)(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=y,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var b,O=new _BuilderGroup.default((0,_vector.getTolerance)(d,_),g,d,_),w=(0,_proj.getUserProjection)();if(w){for(var j=0,D=x.length;j<D;++j){var T=x[j],I=(0,_proj.toUserExtent)(T,c);n.loadFeatures(I,(0,_proj.toUserResolution)(d,c),w)}b=(0,_proj.getTransformFromProjections)(w,c)}else for(var P=0,S=x.length;P<S;++P)n.loadFeatures(x[P],d,c);var L=(0,_vector.getSquaredTolerance)(d,_),q=!0,G=function(e,n){var i,o=e.getStyleFunction()||r.getStyleFunction();if(o&&(i=o(e,d)),i){var a=t.renderFeature(e,L,i,O,b,t.getLayer().getDeclutter(),n);q=q&&!a}},W=(0,_proj.toUserExtent)(g,c),F=n.getFeaturesInExtent(W);f&&F.sort(f);for(var N=0,k=F.length;N<k;++N)G(F[N],N);this.renderedFeatures_=F,this.ready=q;var H=O.finish(),A=new _ExecutorGroup.default(g,d,_,n.getOverlaps(),H,r.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=d,this.renderedRevision_=p,this.renderedRenderOrder_=f,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=v,this.wrappedRenderedExtent_=g,this.renderedCenter_=y,this.renderedProjection_=c,this.renderedPixelRatio_=_,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(e,t,r,n,i,o,a){if(!r)return!1;var u=!1;if(Array.isArray(r))for(var s=0,l=r.length;s<l;++s)u=(0,_vector.renderFeature)(n,e,r[s],t,this.boundHandleStyleImageChange_,i,o,a)||u;else u=(0,_vector.renderFeature)(n,e,r,t,this.boundHandleStyleImageChange_,i,o,a);return u}}])}(),_default=exports.default=CanvasVectorLayerRenderer;

},{"../../ViewHint.js":108,"../../array.js":110,"../../coordinate.js":128,"../../dom.js":130,"../../extent.js":142,"../../proj.js":283,"../../render/EventType.js":294,"../../render/canvas/BuilderGroup.js":299,"../../render/canvas/ExecutorGroup.js":301,"../../render/canvas/hitdetect.js":309,"../../util.js":404,"../vector.js":322,"./Layer.js":317}],321:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BuilderGroup=_interopRequireDefault(require("../../render/canvas/BuilderGroup.js")),_ExecutorGroup=_interopRequireWildcard(require("../../render/canvas/ExecutorGroup.js")),_TileLayer=_interopRequireDefault(require("./TileLayer.js")),_TileState=_interopRequireDefault(require("../../TileState.js")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_ZIndexContext=_interopRequireDefault(require("../../render/canvas/ZIndexContext.js")),_hitdetect=require("../../render/canvas/hitdetect.js"),_transform=require("../../transform.js"),_array=require("../../array.js"),_extent2=require("../../extent.js"),_vector=require("../vector.js"),_util=require("../../util.js"),_size=require("../../size.js"),_coordinate=require("../../coordinate.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var IMAGE_REPLAYS={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},VECTOR_REPLAYS={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},CanvasVectorTileLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.renderedLayerRevision_,r.renderedPixelToCoordinateTransform_=null,r.renderedRotation_,r.renderedOpacity_=1,r.tmpTransform_=(0,_transform.create)(),r.tileClipContexts_=null,r}return _inherits(t,_TileLayer["default"]),_createClass(t,[{key:"prepareTile",value:function(e,t,r){var n,o=e.getState();return o!==_TileState.default.LOADED&&o!==_TileState.default.ERROR||(this.updateExecutorGroup_(e,t,r),this.tileImageNeedsRender_(e)&&(n=!0)),n}},{key:"getTile",value:function(e,r,n,o){var i=o.pixelRatio,a=o.viewState,l=a.resolution,u=a.projection,d=this.getLayer(),s=d.getSource().getTile(e,r,n,i,u),c=o.viewHints,f=!(c[_ViewHint.default.ANIMATING]||c[_ViewHint.default.INTERACTING]);return!f&&s.wantedResolution||(s.wantedResolution=l),this.prepareTile(s,i,u)&&(f||Date.now()-o.time<8)&&"vector"!==d.getRenderMode()&&this.renderTileImage_(s,o),_get(_getPrototypeOf(t.prototype),"getTile",this).call(this,e,r,n,o)}},{key:"isDrawableTile",value:function(e){var r=this.getLayer();return _get(_getPrototypeOf(t.prototype),"isDrawableTile",this).call(this,e)&&("vector"===r.getRenderMode()?(0,_util.getUid)(r)in e.executorGroups:e.hasContext(r))}},{key:"getTileImage",value:function(e){return e.getImage(this.getLayer())}},{key:"prepareFrame",value:function(e){var r=this.getLayer().getRevision();return this.renderedLayerRevision_!==r&&(this.renderedLayerRevision_=r,this.renderedTiles.length=0),_get(_getPrototypeOf(t.prototype),"prepareFrame",this).call(this,e)}},{key:"updateExecutorGroup_",value:function(e,t,r){var n=this,o=this.getLayer(),i=o.getRevision(),a=o.getRenderOrder()||null,l=e.wantedResolution,u=e.getReplayState(o);if(u.dirty||u.renderedResolution!==l||u.renderedRevision!=i||u.renderedRenderOrder!=a){var d=o.getSource(),s=!!o.getDeclutter(),c=d.getTileGrid(),f=d.getTileGridForProjection(r).getTileCoordExtent(e.wrappedTileCoord),g=d.getSourceTiles(t,r,e),p=(0,_util.getUid)(o);delete e.hitDetectionImageData[p],e.executorGroups[p]=[],u.dirty=!1;for(var _=function(){var r=g[v];if(r.getState()!=_TileState.default.LOADED)return 1;var i=r.tileCoord,_=c.getTileCoordExtent(i),y=(0,_extent2.getIntersection)(f,_),h=(0,_extent2.buffer)(y,o.getRenderBuffer()*l,n.tmpExtent),T=(0,_extent2.equals)(_,y)?null:h,R=new _BuilderGroup.default(0,y,l,t),x=(0,_vector.getSquaredTolerance)(l,t),m=function(e,t){var r,n=e.getStyleFunction()||o.getStyleFunction();if(n&&(r=n(e,l)),r){var i=this.renderFeature(e,x,r,R,s,t);u.dirty=u.dirty||i}},C=r.getFeatures();a&&a!==u.renderedRenderOrder&&C.sort(a);for(var b=0,S=C.length;b<S;++b){var w=C[b];T&&!(0,_extent2.intersects)(T,w.getGeometry().getExtent())||m.call(n,w,b)}var E=R.finish(),O="vector"!==o.getRenderMode()&&s&&1===g.length?null:y,P=new _ExecutorGroup.default(O,l,t,d.getOverlaps(),E,o.getRenderBuffer(),!0);e.executorGroups[p].push(P)},v=0,y=g.length;v<y;++v)_();u.renderedRevision=i,u.renderedRenderOrder=a,u.renderedResolution=l}}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,o){var i=t.viewState.resolution,a=t.viewState.rotation;r=null==r?0:r;var l=this.getLayer(),u=l.getSource().getTileGridForProjection(t.viewState.projection),d=(0,_extent2.boundingExtent)([e]);(0,_extent2.buffer)(d,i*r,d);for(var s,c={},f=function(e,t,r){var i=e.getId();void 0===i&&(i=(0,_util.getUid)(e));var a=c[i];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return c[i]=!0,o.splice(o.lastIndexOf(a),1),n(e,l,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return c[i]=!0,n(e,l,t);o.push(c[i]={feature:e,layer:l,geometry:t,distanceSq:r,callback:n})}},g=this.renderedTiles,p=function(){var n=g[_],o=u.getTileCoordExtent(n.wrappedTileCoord);if(!(0,_extent2.intersects)(o,d))return 1;var c=(0,_util.getUid)(l),p=[n.executorGroups[c]],v=l.getDeclutter();p.some(function(n){for(var o=v?t.declutter[v].all().map(function(e){return e.value}):null,l=0,u=n.length;l<u;++l){var d=n[l];if(s=d.forEachFeatureAtCoordinate(e,i,a,r,f,o))return!0}})},_=0,v=g.length;!s&&_<v;++_)p();return s}},{key:"getFeatures",value:function(e){var t=this;return new Promise(function(r,n){for(var o,i=t.getLayer(),a=(0,_util.getUid)(i),l=i.getSource(),u=t.renderedProjection,d=u.getExtent(),s=t.renderedResolution,c=l.getTileGridForProjection(u),f=(0,_transform.apply)(t.renderedPixelToCoordinateTransform_,e.slice()),g=c.getTileCoordForCoordAndResolution(f,s),p=0,_=t.renderedTiles.length;p<_;++p)if(g.toString()===t.renderedTiles[p].tileCoord.toString()){if((o=t.renderedTiles[p]).getState()===_TileState.default.LOADED){var v=c.getTileCoordExtent(o.tileCoord);l.getWrapX()&&u.canWrapX()&&!(0,_extent2.containsExtent)(d,v)&&(0,_coordinate.wrapX)(f,u);break}o=void 0}if(!o||o.loadingSourceTiles>0)r([]);else{var y=c.getTileCoordExtent(o.wrappedTileCoord),h=(0,_extent2.getTopLeft)(y),T=[(f[0]-h[0])/s,(h[1]-f[1])/s],R=o.getSourceTiles().reduce(function(e,t){return e.concat(t.getFeatures())},[]),x=o.hitDetectionImageData[a];if(!x){var m=(0,_size.toSize)(c.getTileSize(c.getZForResolution(s,l.zDirection))),C=t.renderedRotation_,b=[t.getRenderTransform(c.getTileCoordCenter(o.wrappedTileCoord),s,0,_hitdetect.HIT_DETECT_RESOLUTION,m[0]*_hitdetect.HIT_DETECT_RESOLUTION,m[1]*_hitdetect.HIT_DETECT_RESOLUTION,0)];x=(0,_hitdetect.createHitDetectionImageData)(m,b,R,i.getStyleFunction(),c.getTileCoordExtent(o.wrappedTileCoord),o.getReplayState(i).renderedResolution,C),o.hitDetectionImageData[a]=x}r((0,_hitdetect.hitDetect)(T,R,x))}})}},{key:"handleFontsChanged",value:function(){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()}},{key:"handleStyleImageChange_",value:function(e){this.renderIfReadyAndVisible()}},{key:"renderDeclutter",value:function(e,t){var r=this.context,n=r.globalAlpha;r.globalAlpha=t.opacity;for(var o=e.viewHints,i=!(o[_ViewHint.default.ANIMATING]||o[_ViewHint.default.INTERACTING]),a=this.renderedTiles,l=0,u=a.length;l<u;++l){var d=a[l],s=d.executorGroups[(0,_util.getUid)(this.getLayer())],c=this.getLayer().getDeclutter();if(s)for(var f=s.length-1;f>=0;--f)s[f].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(d,e),e.viewState.rotation,i,_ExecutorGroup.DECLUTTER,c?e.declutter[c]:void 0)}r.globalAlpha=n}},{key:"renderDeferredInternal",value:function(e){for(var t=this,r=this.renderedTiles.reduce(function(e,r,n){return r.executorGroups[(0,_util.getUid)(t.getLayer())].forEach(function(t){return e.push({executorGroup:t,index:n})}),e},[]),n=r.map(function(e){return e.executorGroup.getDeferredZIndexContexts()}),o={},i=0,a=r.length;i<a;++i){var l=r[i].executorGroup.getDeferredZIndexContexts();for(var u in l)o[u]=!0}Object.keys(o).sort(_array.ascending).map(Number).forEach(function(e){n.forEach(function(n,o){n[e]&&(n[e].forEach(function(e){var n=r[o],i=n.executorGroup,a=n.index,l=i.getRenderedContext(),u=l.globalAlpha;l.globalAlpha=t.renderedOpacity_;var d=t.tileClipContexts_[a];d&&d.draw(l),e.draw(l),d&&l.restore(),l.globalAlpha=u,e.clear()}),n[e].length=0)})})}},{key:"getTileRenderTransform",value:function(e,t){var r=t.pixelRatio,n=t.viewState,o=n.center,i=n.resolution,a=n.rotation,l=t.size,u=Math.round(l[0]*r),d=Math.round(l[1]*r),s=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),c=e.tileCoord,f=s.getTileCoordExtent(e.wrappedTileCoord),g=s.getTileCoordExtent(c,this.tmpExtent)[0]-f[0];return(0,_transform.multiply)((0,_transform.scale)(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(o,i,a,r,u,d,g))}},{key:"postRender",value:function(e,r){var n=r.viewHints,o=!(n[_ViewHint.default.ANIMATING]||n[_ViewHint.default.INTERACTING]);this.renderedPixelToCoordinateTransform_=r.pixelToCoordinateTransform.slice(),this.renderedRotation_=r.viewState.rotation,this.renderedOpacity_=r.layerStatesArray[r.layerIndex].opacity;var i=this.getLayer(),a=i.getRenderMode(),l=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;for(var u=i.getDeclutter(),d=u?VECTOR_REPLAYS[a].filter(function(e){return!_ExecutorGroup.DECLUTTER.includes(e)}):VECTOR_REPLAYS[a],s=r.viewState,c=s.rotation,f=i.getSource(),g=f.getTileGridForProjection(s.projection).getZForResolution(s.resolution,f.zDirection),p=this.renderedTiles,_=[],v=[],y=[],h=!0,T=p.length-1;T>=0;--T){var R=p[T];h=h&&!R.getReplayState(i).dirty;var x=R.executorGroups[(0,_util.getUid)(i)].filter(function(e){return e.hasExecutors(d)});if(0!==x.length){var m=this.getTileRenderTransform(R,r),C=R.tileCoord[0],b=!1,S=x[0].getClipCoords(m),w=e,E=void 0;if(S){w=(E=new _ZIndexContext.default).getContext();for(var O=0,P=_.length;O<P;++O)if(g!==C&&C<v[O]){var I=_[O];(0,_extent2.intersects)([S[0],S[3],S[4],S[7]],[I[0],I[3],I[4],I[7]])&&(b||(w.save(),b=!0),w.beginPath(),w.moveTo(S[0],S[1]),w.lineTo(S[2],S[3]),w.lineTo(S[4],S[5]),w.lineTo(S[6],S[7]),w.moveTo(I[6],I[7]),w.lineTo(I[4],I[5]),w.lineTo(I[2],I[3]),w.lineTo(I[0],I[1]),w.clip())}_.push(S),v.push(C)}for(var j=0,D=x.length;j<D;++j){var L;x[j].execute(e,[e.canvas.width,e.canvas.height],m,c,o,d,null===(L=r.declutter)||void 0===L?void 0:L[u])}b&&(w===e?w.restore():y[T]=E)}}e.globalAlpha=l,this.ready=h,this.tileClipContexts_=y,r.declutter||this.renderDeferredInternal(r),_get(_getPrototypeOf(t.prototype),"postRender",this).call(this,e,r)}},{key:"renderFeature",value:function(e,t,r,n,o,i){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var l=0,u=r.length;l<u;++l)a=(0,_vector.renderFeature)(n,e,r[l],t,this.boundHandleStyleImageChange_,void 0,o,i)||a;else a=(0,_vector.renderFeature)(n,e,r,t,this.boundHandleStyleImageChange_,void 0,o,i);return a}},{key:"tileImageNeedsRender_",value:function(e){var t=this.getLayer();if("vector"===t.getRenderMode())return!1;var r=e.getReplayState(t),n=t.getRevision(),o=e.wantedResolution;return r.renderedTileResolution!==o||r.renderedTileRevision!==n}},{key:"renderTileImage_",value:function(e,t){var r=this.getLayer(),n=e.getReplayState(r),o=r.getRevision(),i=e.executorGroups[(0,_util.getUid)(r)];n.renderedTileRevision=o;var a=e.wrappedTileCoord,l=a[0],u=r.getSource(),d=t.pixelRatio,s=t.viewState.projection,c=u.getTileGridForProjection(s),f=c.getResolution(e.tileCoord[0]),g=t.pixelRatio/e.wantedResolution*f,p=c.getResolution(l),_=e.getContext(r);d=Math.round(Math.max(d,g/d));var v=u.getTilePixelSize(l,d,s);_.canvas.width=v[0],_.canvas.height=v[1];var y=d/g;if(1!==y){var h=(0,_transform.reset)(this.tmpTransform_);(0,_transform.scale)(h,y,y),_.setTransform.apply(_,h)}var T=c.getTileCoordExtent(a,this.tmpExtent),R=g/p,x=(0,_transform.reset)(this.tmpTransform_);(0,_transform.scale)(x,R,-R),(0,_transform.translate)(x,-T[0],-T[3]);for(var m=0,C=i.length;m<C;++m){i[m].execute(_,[_.canvas.width*y,_.canvas.height*y],x,0,!0,IMAGE_REPLAYS[r.getRenderMode()],null)}n.renderedTileResolution=e.wantedResolution}}])}(),_default=exports.default=CanvasVectorTileLayerRenderer;

},{"../../TileState.js":104,"../../ViewHint.js":108,"../../array.js":110,"../../coordinate.js":128,"../../extent.js":142,"../../render/canvas/BuilderGroup.js":299,"../../render/canvas/ExecutorGroup.js":301,"../../render/canvas/ZIndexContext.js":308,"../../render/canvas/hitdetect.js":309,"../../size.js":337,"../../transform.js":402,"../../util.js":404,"../vector.js":322,"./TileLayer.js":318}],322:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOrder=defaultOrder,exports.getSquaredTolerance=getSquaredTolerance,exports.getTolerance=getTolerance,exports.renderFeature=renderFeature;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var SIMPLIFY_TOLERANCE=.5,GEOMETRY_RENDERERS={Point:renderPointGeometry,LineString:renderLineStringGeometry,Polygon:renderPolygonGeometry,MultiPoint:renderMultiPointGeometry,MultiLineString:renderMultiLineStringGeometry,MultiPolygon:renderMultiPolygonGeometry,GeometryCollection:renderGeometryCollectionGeometry,Circle:renderCircleGeometry};function defaultOrder(e,t){return parseInt((0,_util.getUid)(e),10)-parseInt((0,_util.getUid)(t),10)}function getSquaredTolerance(e,t){var r=getTolerance(e,t);return r*r}function getTolerance(e,t){return SIMPLIFY_TOLERANCE*e/t}function renderCircleGeometry(e,t,r,n,i){var l=r.getFill(),a=r.getStroke();if(l||a){var g=e.getBuilder(r.getZIndex(),"Circle");g.setFillStrokeStyle(l,a),g.drawCircle(t,n,i)}var o=r.getText();if(o&&o.getText()){var d=e.getBuilder(r.getZIndex(),"Text");d.setTextStyle(o),d.drawText(t,n)}}function renderFeature(e,t,r,n,i,l,a,g){var o=[],d=r.getImage();if(d){var u=!0,y=d.getImageState();y==_ImageState.default.LOADED||y==_ImageState.default.ERROR?u=!1:y==_ImageState.default.IDLE&&d.load(),u&&o.push(d.ready())}var x=r.getFill();x&&x.loading()&&o.push(x.ready());var f=o.length>0;return f&&Promise.all(o).then(function(){return i(null)}),renderFeatureInternal(e,t,r,n,l,a,g),f}function renderFeatureInternal(e,t,r,n,i,l,a){var g=r.getGeometryFunction()(t);if(g){var o=g.simplifyTransformed(n,i);if(r.getRenderer())renderGeometry(e,o,r,t,a);else(0,GEOMETRY_RENDERERS[o.getType()])(e,o,r,t,a,l)}}function renderGeometry(e,t,r,n,i){if("GeometryCollection"!=t.getType())e.getBuilder(r.getZIndex(),"Default").drawCustom(t,n,r.getRenderer(),r.getHitDetectionRenderer(),i);else for(var l=t.getGeometries(),a=0,g=l.length;a<g;++a)renderGeometry(e,l[a],r,n,i)}function renderGeometryCollectionGeometry(e,t,r,n,i,l){var a,g,o=t.getGeometriesArray();for(a=0,g=o.length;a<g;++a){(0,GEOMETRY_RENDERERS[o[a].getType()])(e,o[a],r,n,i,l)}}function renderLineStringGeometry(e,t,r,n,i){var l=r.getStroke();if(l){var a=e.getBuilder(r.getZIndex(),"LineString");a.setFillStrokeStyle(null,l),a.drawLineString(t,n,i)}var g=r.getText();if(g&&g.getText()){var o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(g),o.drawText(t,n,i)}}function renderMultiLineStringGeometry(e,t,r,n,i){var l=r.getStroke();if(l){var a=e.getBuilder(r.getZIndex(),"LineString");a.setFillStrokeStyle(null,l),a.drawMultiLineString(t,n,i)}var g=r.getText();if(g&&g.getText()){var o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(g),o.drawText(t,n,i)}}function renderMultiPolygonGeometry(e,t,r,n,i){var l=r.getFill(),a=r.getStroke();if(a||l){var g=e.getBuilder(r.getZIndex(),"Polygon");g.setFillStrokeStyle(l,a),g.drawMultiPolygon(t,n,i)}var o=r.getText();if(o&&o.getText()){var d=e.getBuilder(r.getZIndex(),"Text");d.setTextStyle(o),d.drawText(t,n,i)}}function renderPointGeometry(e,t,r,n,i,l){var a=r.getImage(),g=r.getText(),o=g&&g.getText(),d=l&&a&&o?{}:void 0;if(a){if(a.getImageState()!=_ImageState.default.LOADED)return;var u=e.getBuilder(r.getZIndex(),"Image");u.setImageStyle(a,d),u.drawPoint(t,n,i)}if(o){var y=e.getBuilder(r.getZIndex(),"Text");y.setTextStyle(g,d),y.drawText(t,n,i)}}function renderMultiPointGeometry(e,t,r,n,i,l){var a=r.getImage(),g=a&&0!==a.getOpacity(),o=r.getText(),d=o&&o.getText(),u=l&&g&&d?{}:void 0;if(g){if(a.getImageState()!=_ImageState.default.LOADED)return;var y=e.getBuilder(r.getZIndex(),"Image");y.setImageStyle(a,u),y.drawMultiPoint(t,n,i)}if(d){var x=e.getBuilder(r.getZIndex(),"Text");x.setTextStyle(o,u),x.drawText(t,n,i)}}function renderPolygonGeometry(e,t,r,n,i){var l=r.getFill(),a=r.getStroke();if(l||a){var g=e.getBuilder(r.getZIndex(),"Polygon");g.setFillStrokeStyle(l,a),g.drawPolygon(t,n,i)}var o=r.getText();if(o&&o.getText()){var d=e.getBuilder(r.getZIndex(),"Text");d.setTextStyle(o),d.drawText(t,n,i)}}

},{"../ImageState.js":86,"../util.js":404}],323:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Property=_interopRequireDefault(require("../../layer/Property.js")),_Layer=_interopRequireDefault(require("../Layer.js")),_Event=_interopRequireDefault(require("../../render/Event.js")),_EventType=_interopRequireDefault(require("../../render/EventType.js")),_Helper=_interopRequireDefault(require("../../webgl/Helper.js")),_transform=require("../../transform.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var WebGLLayerRenderer=function(e){function t(e,r){var n;return _classCallCheck(this,t),r=r||{},(n=_callSuper(this,t,[e])).inversePixelTransform_=(0,_transform.create)(),n.pixelContext_=null,n.postProcesses_=r.postProcesses,n.uniforms_=r.uniforms,n.helper,e.addChangeListener(_Property.default.MAP,n.removeHelper.bind(n)),n.dispatchPreComposeEvent=n.dispatchPreComposeEvent.bind(n),n.dispatchPostComposeEvent=n.dispatchPostComposeEvent.bind(n),n}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"dispatchPreComposeEvent",value:function(e,t){var r=this.getLayer();if(r.hasListener(_EventType.default.PRECOMPOSE)){var n=new _Event.default(_EventType.default.PRECOMPOSE,void 0,t,e);r.dispatchEvent(n)}}},{key:"dispatchPostComposeEvent",value:function(e,t){var r=this.getLayer();if(r.hasListener(_EventType.default.POSTCOMPOSE)){var n=new _Event.default(_EventType.default.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(n)}}},{key:"reset",value:function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}},{key:"removeHelper",value:function(){this.helper&&(this.helper.dispose(),delete this.helper)}},{key:"prepareFrame",value:function(e){if(this.getLayer().getRenderSource()){for(var r,n=!0,o=-1,i=0,s=e.layerStatesArray.length;i<s;i++){var a=e.layerStatesArray[i].layer,u=a.getRenderer();if(u instanceof t){var p=a.getClassName();if((n||p!==r)&&(o+=1,n=!1),r=p,u===this)break}else n=!0}var l="map/"+e.mapId+"/group/"+o;this.helper&&this.helper.canvasCacheKeyMatches(l)&&!this.helper.needsToBeRecreated()||(this.removeHelper(),this.helper=new _Helper.default({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:l}),r&&(this.helper.getCanvas().className=r),this.afterHelperCreated())}return this.prepareFrameInternal(e)}},{key:"afterHelperCreated",value:function(){}},{key:"prepareFrameInternal",value:function(e){return!0}},{key:"disposeInternal",value:function(){this.removeHelper(),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"dispatchRenderEvent_",value:function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){(0,_transform.compose)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);var o=new _Event.default(e,this.inversePixelTransform_,r,t);n.dispatchEvent(o)}}},{key:"preRender",value:function(e,t){this.dispatchRenderEvent_(_EventType.default.PRERENDER,e,t)}},{key:"postRender",value:function(e,t){this.dispatchRenderEvent_(_EventType.default.POSTRENDER,e,t)}}])}(),_default=exports.default=WebGLLayerRenderer;

},{"../../layer/Property.js":270,"../../render/Event.js":293,"../../render/EventType.js":294,"../../transform.js":402,"../../webgl/Helper.js":410,"../Layer.js":314}],324:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("../../layer/BaseVector.js")),_VectorEventType=_interopRequireDefault(require("../../source/VectorEventType.js")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_Buffer=_interopRequireDefault(require("../../webgl/Buffer.js")),_Layer=_interopRequireDefault(require("./Layer.js")),_RenderTarget=_interopRequireDefault(require("../../webgl/RenderTarget.js")),_webgl=require("../../webgl.js"),_Helper=require("../../webgl/Helper.js"),_constants=require("../../render/webgl/constants.js"),_transform=require("../../transform.js"),_asserts=require("../../asserts.js"),_extent=require("../../extent.js"),_utils=require("../../render/webgl/utils.js"),_webgl2=require("../../worker/webgl.js"),_proj=require("../../proj.js"),_util=require("../../util.js"),_worldUtil=require("./worldUtil.js"),_events=require("../../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var WebGLPointsLayerRenderer=function(e){function t(e,r){var n,i,o;_classCallCheck(this,t);var a=r.uniforms||{},s=(0,_transform.create)();a[_Helper.DefaultUniform.PROJECTION_MATRIX]=s,(o=_callSuper(this,t,[e,{uniforms:a,postProcesses:r.postProcesses}])).sourceRevision_=-1,o.verticesBuffer_=new _Buffer.default(_webgl.ARRAY_BUFFER,_webgl.DYNAMIC_DRAW),o.indicesBuffer_=new _Buffer.default(_webgl.ELEMENT_ARRAY_BUFFER,_webgl.DYNAMIC_DRAW),o.vertexShader_=r.vertexShader,o.fragmentShader_=r.fragmentShader,o.program_,o.hitDetectionEnabled_=null===(n=r.hitDetectionEnabled)||void 0===n||n;var u=r.attributes?r.attributes.map(function(e){return{name:"a_prop_"+e.name,size:1,type:_Helper.AttributeType.FLOAT}}):[];o.attributes=[{name:"a_position",size:2,type:_Helper.AttributeType.FLOAT},{name:"a_index",size:1,type:_Helper.AttributeType.FLOAT}],o.hitDetectionEnabled_&&(o.attributes.push({name:"a_prop_hitColor",size:4,type:_Helper.AttributeType.FLOAT}),o.attributes.push({name:"a_featureUid",size:1,type:_Helper.AttributeType.FLOAT})),(i=o.attributes).push.apply(i,_toConsumableArray(u)),o.customAttributes=r.attributes?r.attributes:[],o.previousExtent_=(0,_extent.createEmpty)(),o.currentTransform_=s,o.renderTransform_=(0,_transform.create)(),o.invertRenderTransform_=(0,_transform.create)(),o.renderInstructions_=new Float32Array(0),o.hitRenderTarget_,o.lastSentId=0,o.worker_=(0,_webgl2.create)(),o.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===_constants.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS){var r=t.projectionTransform;o.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),o.helper.flushBufferData(o.verticesBuffer_),o.indicesBuffer_.fromArrayBuffer(t.indexBuffer),o.helper.flushBufferData(o.indicesBuffer_),o.renderTransform_=r,(0,_transform.makeInverse)(o.invertRenderTransform_,o.renderTransform_),o.renderInstructions_=new Float32Array(e.data.renderInstructions),t.id===o.lastSentId&&(o.ready=!0),o.getLayer().changed()}}),o.featureCache_={},o.featureCount_=0;var l=o.getLayer().getSource();return o.sourceListenKeys_=[(0,_events.listen)(l,_VectorEventType.default.ADDFEATURE,o.handleSourceFeatureAdded_,o),(0,_events.listen)(l,_VectorEventType.default.CHANGEFEATURE,o.handleSourceFeatureChanged_,o),(0,_events.listen)(l,_VectorEventType.default.REMOVEFEATURE,o.handleSourceFeatureDelete_,o),(0,_events.listen)(l,_VectorEventType.default.CLEAR,o.handleSourceFeatureClear_,o)],l.forEachFeature(function(e){o.featureCache_[(0,_util.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},o.featureCount_++}),o}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"afterHelperCreated",value:function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new _RenderTarget.default(this.helper))}},{key:"handleSourceFeatureAdded_",value:function(e){var t=e.feature;this.featureCache_[(0,_util.getUid)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}},{key:"handleSourceFeatureChanged_",value:function(e){var t=e.feature;this.featureCache_[(0,_util.getUid)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}}},{key:"handleSourceFeatureDelete_",value:function(e){var t=e.feature;delete this.featureCache_[(0,_util.getUid)(t)],this.featureCount_--}},{key:"handleSourceFeatureClear_",value:function(){this.featureCache_={},this.featureCount_=0}},{key:"renderFrame",value:function(e){var t=this.helper.getGL();this.preRender(t,e);var r=_slicedToArray((0,_worldUtil.getWorldParameters)(e,this.getLayer()),3),n=r[0],i=r[1],o=r[2];return this.renderWorlds(e,!1,n,i,o),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent),this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,n,i,o),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),this.helper.getCanvas()}},{key:"prepareFrameInternal",value:function(e){var t=this.getLayer(),r=t.getSource(),n=e.viewState,i=!e.viewHints[_ViewHint.default.ANIMATING]&&!e.viewHints[_ViewHint.default.INTERACTING],o=!(0,_extent.equals)(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),i&&(o||a)){var s=n.projection,u=n.resolution,l=t instanceof _BaseVector.default?t.getRenderBuffer():0,f=(0,_extent.buffer)(e.extent,l*u);r.loadFeatures(f,u,s),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}},{key:"rebuildBuffers_",value:function(e){var t=(0,_transform.create)();this.helper.makeProjectionTransform(e,t);var r,n,i=(0,_proj.getUserProjection)(),o=(this.hitDetectionEnabled_?7:2)+this.customAttributes.length,a=o*this.featureCount_;this.renderInstructions_&&this.renderInstructions_.length===a||(this.renderInstructions_=new Float32Array(a));var s=[],u=[],l=-1;for(var f in this.featureCache_)if((n=(r=this.featureCache_[f]).geometry)&&"Point"===n.getType()){if(i){var c=(0,_proj.fromUserCoordinate)(n.getFlatCoordinates(),e.viewState.projection);s[0]=c[0],s[1]=c[1]}else s[0]=n.getFlatCoordinates()[0],s[1]=n.getFlatCoordinates()[1];if((0,_transform.apply)(t,s),this.renderInstructions_[++l]=s[0],this.renderInstructions_[++l]=s[1],this.hitDetectionEnabled_){var _=(0,_utils.colorEncodeId)(l+5,u);this.renderInstructions_[++l]=_[0],this.renderInstructions_[++l]=_[1],this.renderInstructions_[++l]=_[2],this.renderInstructions_[++l]=_[3],this.renderInstructions_[++l]=Number(f)}for(var p=0;p<this.customAttributes.length;p++){var h=this.customAttributes[p].callback(r.feature,r.properties);this.renderInstructions_[++l]=h}}var d={id:++this.lastSentId,type:_constants.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesSize:o-2};d.projectionTransform=t,this.ready=!1,this.worker_.postMessage(d,[this.renderInstructions_.buffer]),this.renderInstructions_=null}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i){if((0,_asserts.assert)(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),this.renderInstructions_&&this.hitDetectionEnabled_){var o=(0,_transform.apply)(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),s=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],u=(0,_utils.colorDecodeId)(s),l=this.renderInstructions_[u],f=Math.floor(l).toString(),c=this.getLayer().getSource().getFeatureByUid(f);return c?n(c,this.getLayer(),null):void 0}}},{key:"renderWorlds",value:function(e,t,r,n,i){var o=r;this.helper.useProgram(this.program_,e),t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0)),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,_transform.translate)(this.currentTransform_,o*i,0),(0,_transform.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.applyHitDetectionUniform(t);var a=this.indicesBuffer_.getSize();this.helper.drawElements(0,a)}while(++o<n)}},{key:"disposeInternal",value:function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){(0,_events.unlistenByKey)(e)}),this.sourceListenKeys_=null,_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"renderDeclutter",value:function(){}}])}(),_default=exports.default=WebGLPointsLayerRenderer;

},{"../../ViewHint.js":108,"../../asserts.js":111,"../../events.js":132,"../../extent.js":142,"../../layer/BaseVector.js":264,"../../proj.js":283,"../../render/webgl/constants.js":311,"../../render/webgl/utils.js":312,"../../source/VectorEventType.js":368,"../../transform.js":402,"../../util.js":404,"../../webgl.js":406,"../../webgl/Buffer.js":408,"../../webgl/Helper.js":410,"../../webgl/RenderTarget.js":413,"../../worker/webgl.js":417,"./Layer.js":323,"./worldUtil.js":327}],325:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Uniforms=exports.Attributes=void 0;var _DataTile=_interopRequireDefault(require("../../reproj/DataTile.js")),_Tile=_interopRequireDefault(require("../../reproj/Tile.js")),_TileState=_interopRequireDefault(require("../../TileState.js")),_TileTexture=_interopRequireDefault(require("../../webgl/TileTexture.js")),_Buffer=_interopRequireDefault(require("../../webgl/Buffer.js")),_TileLayerBase=_interopRequireWildcard(require("./TileLayerBase.js")),_Helper=require("../../webgl/Helper.js"),_webgl=require("../../webgl.js"),_transform=require("../../transform.js"),_extent=require("../../extent.js"),_proj=require("../../proj.js"),_mat=require("../../vec/mat4.js"),_size=require("../../size.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&{}.hasOwnProperty.call(e,n)){var a=i?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(o,n,a):o[n]=e[n]}return o.default=e,r&&r.set(e,o),o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Uniforms=exports.Uniforms=_objectSpread(_objectSpread({},_TileLayerBase.Uniforms),{},{TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"}),Attributes=exports.Attributes={TEXTURE_COORD:"a_textureCoord"},attributeDescriptions=[{name:Attributes.TEXTURE_COORD,size:2,type:_Helper.AttributeType.FLOAT}],WebGLTileLayerRenderer=function(e){function t(e,r){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e,r])).program_,o.vertexShader_=r.vertexShader,o.fragmentShader_=r.fragmentShader,o.indices_=new _Buffer.default(_webgl.ELEMENT_ARRAY_BUFFER,_webgl.STATIC_DRAW),o.indices_.fromArray([0,1,3,1,2,3]),o.paletteTextures_=r.paletteTextures||[],o}return _inherits(t,_TileLayerBase["default"]),_createClass(t,[{key:"reset",value:function(e){if(_get(_getPrototypeOf(t.prototype),"reset",this).call(this,e),this.helper){var r,o=this.helper.getGL(),i=_createForOfIteratorHelper(this.paletteTextures_);try{for(i.s();!(r=i.n()).done;){r.value.delete(o)}}catch(e){i.e(e)}finally{i.f()}}this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}},{key:"afterHelperCreated",value:function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}},{key:"removeHelper",value:function(){if(this.helper){var e,r=this.helper.getGL(),o=_createForOfIteratorHelper(this.paletteTextures_);try{for(o.s();!(e=o.n()).done;){e.value.delete(r)}}catch(e){o.e(e)}finally{o.f()}}_get(_getPrototypeOf(t.prototype),"removeHelper",this).call(this)}},{key:"createTileRepresentation",value:function(e){return new _TileTexture.default(e)}},{key:"beforeTilesRender",value:function(e,r){_get(_getPrototypeOf(t.prototype),"beforeTilesRender",this).call(this,e,r),this.helper.useProgram(this.program_,e)}},{key:"renderTile",value:function(e,t,r,o,i,n,a,l,u,s,f){var p=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(attributeDescriptions);for(var c=0;c<e.textures.length;){var _="".concat(Uniforms.TILE_TEXTURE_ARRAY,"[").concat(c,"]");this.helper.bindTexture(e.textures[c],c,_),++c}for(var h=0;h<this.paletteTextures_.length;++h){var y=this.paletteTextures_[h],d=y.getTexture(p);this.helper.bindTexture(d,c,y.name),++c}var g=r.viewState,T=n[0]+2*s,b=n[1]+2*s,m=e.tile.tileCoord,v=m[1],O=m[2];this.helper.setUniformMatrixValue(Uniforms.TILE_TRANSFORM,(0,_mat.fromTransform)(this.tempMat4,t)),this.helper.setUniformFloatValue(Uniforms.TRANSITION_ALPHA,f),this.helper.setUniformFloatValue(Uniforms.DEPTH,u);var R=o;s>0&&(R=l,(0,_extent.getIntersection)(R,o,R)),this.helper.setUniformFloatVec4(Uniforms.RENDER_EXTENT,R),this.helper.setUniformFloatValue(Uniforms.RESOLUTION,g.resolution),this.helper.setUniformFloatValue(Uniforms.ZOOM,g.zoom),this.helper.setUniformFloatValue(Uniforms.TEXTURE_PIXEL_WIDTH,T),this.helper.setUniformFloatValue(Uniforms.TEXTURE_PIXEL_HEIGHT,b),this.helper.setUniformFloatValue(Uniforms.TEXTURE_RESOLUTION,i),this.helper.setUniformFloatValue(Uniforms.TEXTURE_ORIGIN_X,a[0]+v*n[0]*i-s*i),this.helper.setUniformFloatValue(Uniforms.TEXTURE_ORIGIN_Y,a[1]-O*n[1]*i+s*i),this.helper.drawElements(0,this.indices_.getSize())}},{key:"getData",value:function(e){if(!this.helper.getGL())return null;var t=this.frameState;if(!t)return null;var r=this.getLayer(),o=(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()),i=t.viewState,n=r.getExtent();if(n&&!(0,_extent.containsCoordinate)((0,_proj.fromUserExtent)(n,i.projection),o))return null;var a,l,u,s=r.getSources((0,_extent.boundingExtent)([o]),i.resolution);for(a=s.length-1;a>=0;--a)if("ready"===(l=s[a]).getState()){if(u=l.getTileGridForProjection(i.projection),l.getWrapX())break;var f=u.getExtent();if(!f||(0,_extent.containsCoordinate)(f,o))break}if(a<0)return null;for(var p=this.tileRepresentationCache,c=u.getZForResolution(i.resolution);c>=u.getMinZoom();--c){var _=u.getTileCoordForCoordAndZ(o,c),h=(0,_TileLayerBase.getCacheKey)(l,_);if(p.containsKey(h)){var y=p.get(h),d=y.tile;if((d instanceof _Tile.default||d instanceof _DataTile.default)&&d.getState()===_TileState.default.EMPTY)return null;if(y.loaded){var g=u.getOrigin(c),T=(0,_size.toSize)(u.getTileSize(c)),b=u.getResolution(c),m=(o[0]-g[0])/b-_[1]*T[0],v=(g[1]-o[1])/b-_[2]*T[1];return y.getPixelData(m,v)}}}return null}},{key:"disposeInternal",value:function(){var e=this.helper;if(e){var r,o=e.getGL(),i=_createForOfIteratorHelper(this.paletteTextures_);try{for(i.s();!(r=i.n()).done;){r.value.delete(o)}}catch(e){i.e(e)}finally{i.f()}this.paletteTextures_.length=0,o.deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)}_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this),delete this.indices_}}])}(),_default=exports.default=WebGLTileLayerRenderer;

},{"../../TileState.js":104,"../../extent.js":142,"../../proj.js":283,"../../reproj/DataTile.js":329,"../../reproj/Tile.js":331,"../../size.js":337,"../../transform.js":402,"../../vec/mat4.js":405,"../../webgl.js":406,"../../webgl/Buffer.js":408,"../../webgl/Helper.js":410,"../../webgl/TileTexture.js":415,"./TileLayerBase.js":326}],326:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Uniforms=void 0,exports.getCacheKey=getCacheKey,exports.newTileRepresentationLookup=newTileRepresentationLookup;var _LRUCache=_interopRequireDefault(require("../../structs/LRUCache.js")),_DataTile=_interopRequireDefault(require("../../reproj/DataTile.js")),_Tile=_interopRequireDefault(require("../../reproj/Tile.js")),_TileRange=_interopRequireDefault(require("../../TileRange.js")),_TileState=_interopRequireDefault(require("../../TileState.js")),_Layer=_interopRequireDefault(require("./Layer.js")),_util=require("../../util.js"),_mat=require("../../vec/mat4.js"),_tilecoord=require("../../tilecoord.js"),_transform=require("../../transform.js"),_array=require("../../array.js"),_proj=require("../../proj.js"),_extent=require("../../extent.js"),_size=require("../../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Uniforms=exports.Uniforms={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"},empty={};function depthForZ(e){return 1/(e+2)}function newTileRepresentationLookup(){return{tileIds:new Set,representationsByZ:{}}}function lookupHasTile(e,t){return e.tileIds.has((0,_util.getUid)(t))}function addTileRepresentationToLookup(e,t,r){var i=e.representationsByZ;r in i||(i[r]=new Set),i[r].add(t),e.tileIds.add((0,_util.getUid)(t.tile))}function getRenderExtent(e,t){var r=e.layerStatesArray[e.layerIndex];r.extent&&(t=(0,_extent.getIntersection)(t,(0,_proj.fromUserExtent)(r.extent,e.viewState.projection)));var i=r.layer.getRenderSource();if(!i.getWrapX()){var o=i.getTileGridForProjection(e.viewState.projection).getExtent();o&&(t=(0,_extent.getIntersection)(t,o))}return t}function getCacheKey(e,t){return"".concat(e.getKey(),",").concat((0,_tilecoord.getKey)(t))}var WebGLBaseTileLayerRenderer=function(e){function t(e,r){var i;_classCallCheck(this,t),(i=_callSuper(this,t,[e,{uniforms:r.uniforms,postProcesses:r.postProcesses}])).renderComplete=!1,i.tileTransform_=(0,_transform.create)(),i.tempMat4=(0,_mat.create)(),i.tempTileRange_=new _TileRange.default(0,0,0,0),i.tempTileCoord_=(0,_tilecoord.createOrUpdate)(0,0,0),i.tempSize_=[0,0];var o=void 0!==r.cacheSize?r.cacheSize:512;return i.tileRepresentationCache=new _LRUCache.default(o),i.frameState=null,i.projection_=void 0,i}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"reset",value:function(e){_get(_getPrototypeOf(t.prototype),"reset",this).call(this,{uniforms:e.uniforms})}},{key:"isDrawableTile_",value:function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==_TileState.default.LOADED||r==_TileState.default.EMPTY||r==_TileState.default.ERROR&&!i}},{key:"prepareFrameInternal",value:function(e){this.projection_?e.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=e.viewState.projection):this.projection_=e.viewState.projection;var t=this.getLayer().getRenderSource();return!!t&&(!(0,_extent.isEmpty)(getRenderExtent(e,e.extent))&&"ready"===t.getState())}},{key:"createTileRepresentation",value:function(e){return(0,_util.abstract)()}},{key:"enqueueTiles",value:function(e,t,r,i,o){var n=e.viewState,a=this.getLayer(),l=a.getRenderSource(),s=l.getTileGridForProjection(n.projection),u=l.getGutterForProjection(n.projection),c=(0,_util.getUid)(l);c in e.wantedTiles||(e.wantedTiles[c]={});for(var f=e.wantedTiles[c],p=this.tileRepresentationCache,_=a.getMapInternal(),d=Math.max(r-o,s.getMinZoom(),s.getZForResolution(Math.min(a.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):s.getResolution(0)),l.zDirection)),y=r;y>=d;--y)for(var h=s.getTileRangeForExtentAndZ(t,y,this.tempTileRange_),g=s.getResolution(y),v=h.minX;v<=h.maxX;++v)for(var T=h.minY;T<=h.maxY;++T){var m=(0,_tilecoord.createOrUpdate)(y,v,T,this.tempTileCoord_),R=getCacheKey(l,m),b=void 0,j=void 0;if(p.containsKey(R)&&(j=(b=p.get(R)).tile),b&&b.tile.key===l.getKey()||(j=l.getTile(y,v,T,e.pixelRatio,n.projection)),!lookupHasTile(i,j)){if(b)if(this.isDrawableTile_(j))b.setTile(j);else{var S=j.getInterimTile();b.setTile(S)}else b=this.createTileRepresentation({tile:j,grid:s,helper:this.helper,gutter:u}),p.set(R,b);addTileRepresentationToLookup(i,b,y);var O=j.getKey();f[O]=!0,j.getState()===_TileState.default.IDLE&&(e.tileQueue.isKeyQueued(O)||e.tileQueue.enqueue([j,c,s.getTileCoordCenter(m),g]))}}}},{key:"beforeTilesRender",value:function(e,t){this.helper.prepareDraw(this.frameState,!t,!0)}},{key:"beforeTilesMaskRender",value:function(e){return!1}},{key:"renderTile",value:function(e,t,r,i,o,n,a,l,s,u,c){}},{key:"renderTileMask",value:function(e,t,r,i){}},{key:"drawTile_",value:function(e,t,r,i,o,n,a){if(t.ready){var l=t.tile.tileCoord,s=(0,_tilecoord.getKey)(l),u=s in n?n[s]:1,c=a.getResolution(r),f=(0,_size.toSize)(a.getTileSize(r),this.tempSize_),p=a.getOrigin(r),_=a.getTileCoordExtent(l),d=u<1?-1:depthForZ(r);u<1&&(e.animate=!0);var y=e.viewState,h=y.center[0],g=y.center[1],v=f[0]+2*i,T=f[1]+2*i,m=v/T,R=(h-p[0])/(f[0]*c),b=(p[1]-g)/(f[1]*c),j=y.resolution/c,S=l[1],O=l[2];(0,_transform.reset)(this.tileTransform_),(0,_transform.scale)(this.tileTransform_,2/(e.size[0]*j/v),-2/(e.size[1]*j/v)),(0,_transform.rotate)(this.tileTransform_,y.rotation),(0,_transform.scale)(this.tileTransform_,1,1/m),(0,_transform.translate)(this.tileTransform_,(f[0]*(S-R)-i)/v,(f[1]*(O-b)-i)/T),this.renderTile(t,this.tileTransform_,e,o,c,f,p,_,d,i,u)}}},{key:"renderFrame",value:function(e){var t=this;this.frameState=e,this.renderComplete=!0;var r=this.helper.getGL();this.preRender(r,e);var i=e.viewState,o=this.getLayer(),n=o.getRenderSource(),a=n.getTileGridForProjection(i.projection),l=n.getGutterForProjection(i.projection),s=getRenderExtent(e,e.extent),u=a.getZForResolution(i.resolution,n.zDirection),c=newTileRepresentationLookup(),f=o.getPreload();if(e.nextExtent){var p=a.getZForResolution(i.nextResolution,n.zDirection),_=getRenderExtent(e,e.nextExtent);this.enqueueTiles(e,_,p,c,f)}this.enqueueTiles(e,s,u,c,0),f>0&&setTimeout(function(){t.enqueueTiles(e,s,u-1,c,f-1)},0);var d,y={},h=(0,_util.getUid)(this),g=e.time,v=!1,T=_createForOfIteratorHelper(c.representationsByZ[u]);try{for(T.s();!(d=T.n()).done;){var m=d.value,R=m.tile;if(!(R instanceof _Tile.default||R instanceof _DataTile.default)||R.getState()!==_TileState.default.EMPTY){var b=R.tileCoord;if(m.ready){var j=R.getAlpha(h,g);if(1===j){R.endTransition(h);continue}v=!0,y[(0,_tilecoord.getKey)(b)]=j}if(this.renderComplete=!1,!this.findAltTiles_(a,b,u+1,c))for(var S=a.getMinZoom(),O=u-1;O>=S;--O){if(this.findAltTiles_(a,b,O,c))break}}}}catch(e){T.e(e)}finally{T.f()}var C=c.representationsByZ,P=Object.keys(C).map(Number).sort(_array.descending);if(this.beforeTilesMaskRender(e))for(var w=0,x=P.length;w<x;++w){var E,k=P[w],L=_createForOfIteratorHelper(C[k]);try{for(L.s();!(E=L.n()).done;){var I=E.value,A=I.tile.tileCoord;if(!((0,_tilecoord.getKey)(A)in y)){var q=a.getTileCoordExtent(A);this.renderTileMask(I,k,q,depthForZ(k))}}}catch(e){L.e(e)}finally{L.f()}}this.beforeTilesRender(e,v);for(var D=0,M=P.length;D<M;++D){var F,z=P[D],K=_createForOfIteratorHelper(C[z]);try{for(K.s();!(F=K.n()).done;){var Z=F.value,U=Z.tile.tileCoord;(0,_tilecoord.getKey)(U)in y||this.drawTile_(e,Z,z,l,s,y,a)}}catch(e){K.e(e)}finally{K.f()}}var N,H=_createForOfIteratorHelper(C[u]);try{for(H.s();!(N=H.n()).done;){var B=N.value,G=B.tile.tileCoord;(0,_tilecoord.getKey)(G)in y&&this.drawTile_(e,B,u,l,s,y,a)}}catch(e){H.e(e)}finally{H.f()}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var X=this.helper.getCanvas(),Y=this.tileRepresentationCache;Y.canExpireCache();){Y.pop().dispose()}return e.postRenderFunctions.push(function(e,t){n.updateCacheSize(.1,t.viewState.projection),n.expireCache(t.viewState.projection,empty)}),this.postRender(r,e),X}},{key:"findAltTiles_",value:function(e,t,r,i){var o=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!o)return!1;for(var n=!0,a=this.tileRepresentationCache,l=this.getLayer().getRenderSource(),s=o.minX;s<=o.maxX;++s)for(var u=o.minY;u<=o.maxY;++u){var c=getCacheKey(l,[r,s,u]),f=!1;if(a.containsKey(c)){var p=a.get(c);p.ready&&!lookupHasTile(i,p.tile)&&(addTileRepresentationToLookup(i,p,r),f=!0)}f||(n=!1)}return n}},{key:"clearCache",value:function(){var e=this.tileRepresentationCache;e.forEach(function(e){return e.dispose()}),e.clear()}},{key:"removeHelper",value:function(){this.helper&&this.clearCache(),_get(_getPrototypeOf(t.prototype),"removeHelper",this).call(this)}},{key:"disposeInternal",value:function(){_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this),delete this.frameState}}])}(),_default=exports.default=WebGLBaseTileLayerRenderer;

},{"../../TileRange.js":103,"../../TileState.js":104,"../../array.js":110,"../../extent.js":142,"../../proj.js":283,"../../reproj/DataTile.js":329,"../../reproj/Tile.js":331,"../../size.js":337,"../../structs/LRUCache.js":381,"../../tilecoord.js":396,"../../transform.js":402,"../../util.js":404,"../../vec/mat4.js":405,"./Layer.js":323}],327:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWorldParameters=getWorldParameters;var _extent=require("../../extent.js");function getWorldParameters(e,t){var r=e.viewState.projection,a=t.getSource().getWrapX()&&r.canWrapX(),o=r.getExtent(),n=e.extent,l=a?(0,_extent.getWidth)(o):null,s=a?Math.ceil((n[2]-o[2])/l)+1:1;return[a?Math.floor((n[0]-o[0])/l):0,s,l]}

},{"../../extent.js":142}],328:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateSourceExtentResolution=calculateSourceExtentResolution,exports.calculateSourceResolution=calculateSourceResolution,exports.canvasPool=void 0,exports.render=render;var brokenDiagonalRendering_,_extent=require("./extent.js"),_dom=require("./dom.js"),_proj=require("./proj.js"),_math=require("./math.js"),canvasPool=exports.canvasPool=[];function drawTestTriangle(e,t,n,a,o){e.beginPath(),e.moveTo(0,0),e.lineTo(t,n),e.lineTo(a,o),e.closePath(),e.save(),e.clip(),e.fillRect(0,0,Math.max(t,a)+1,Math.max(n,o)),e.restore()}function verifyBrokenDiagonalRendering(e,t){return Math.abs(e[4*t]-210)>2||Math.abs(e[4*t+3]-191.25)>2}function isBrokenDiagonalRendering(){if(void 0===brokenDiagonalRendering_){var e=(0,_dom.createCanvasContext2D)(6,6,canvasPool);e.globalCompositeOperation="lighter",e.fillStyle="rgba(210, 0, 0, 0.75)",drawTestTriangle(e,4,5,4,0),drawTestTriangle(e,4,5,0,5);var t=e.getImageData(0,0,3,3).data;brokenDiagonalRendering_=verifyBrokenDiagonalRendering(t,0)||verifyBrokenDiagonalRendering(t,4)||verifyBrokenDiagonalRendering(t,8),(0,_dom.releaseCanvas)(e),canvasPool.push(e.canvas)}return brokenDiagonalRendering_}function calculateSourceResolution(e,t,n,a){var o=(0,_proj.transform)(n,t,e),r=(0,_proj.getPointResolution)(t,a,n),i=t.getMetersPerUnit();void 0!==i&&(r*=i);var l=e.getMetersPerUnit();void 0!==l&&(r/=l);var s=e.getExtent();if(!s||(0,_extent.containsCoordinate)(s,o)){var c=(0,_proj.getPointResolution)(e,r,o)/r;isFinite(c)&&c>0&&(r/=c)}return r}function calculateSourceExtentResolution(e,t,n,a){var o=(0,_extent.getCenter)(n),r=calculateSourceResolution(e,t,o,a);return(!isFinite(r)||r<=0)&&(0,_extent.forEachCorner)(n,function(n){return r=calculateSourceResolution(e,t,n,a),isFinite(r)&&r>0}),r}function render(e,t,n,a,o,r,i,l,s,c,g,u,h,d){var v=(0,_dom.createCanvasContext2D)(Math.round(n*e),Math.round(n*t),canvasPool);if(u||(v.imageSmoothingEnabled=!1),0===s.length)return v.canvas;function x(e){return Math.round(e*n)/n}v.scale(n,n),v.globalCompositeOperation="lighter";var f,m=(0,_extent.createEmpty)();s.forEach(function(e,t,n){(0,_extent.extend)(m,e.extent)});var _=n/a,p=(u?1:1+Math.pow(2,-24))/_;if(!h||1!==s.length||0!==c){if(f=(0,_dom.createCanvasContext2D)(Math.round((0,_extent.getWidth)(m)*_),Math.round((0,_extent.getHeight)(m)*_),canvasPool),u||(f.imageSmoothingEnabled=!1),o&&d){var M=(o[0]-m[0])*_,T=-(o[3]-m[3])*_,R=(0,_extent.getWidth)(o)*_,E=(0,_extent.getHeight)(o)*_;f.rect(M,T,R,E),f.clip()}s.forEach(function(e,t,n){if(e.image.width>0&&e.image.height>0){if(e.clipExtent){f.save();var a=(e.clipExtent[0]-m[0])*_,o=-(e.clipExtent[3]-m[3])*_,r=(0,_extent.getWidth)(e.clipExtent)*_,i=(0,_extent.getHeight)(e.clipExtent)*_;f.rect(u?a:Math.round(a),u?o:Math.round(o),u?r:Math.round(a+r)-Math.round(a),u?i:Math.round(o+i)-Math.round(o)),f.clip()}var l=(e.extent[0]-m[0])*_,s=-(e.extent[3]-m[3])*_,g=(0,_extent.getWidth)(e.extent)*_,h=(0,_extent.getHeight)(e.extent)*_;f.drawImage(e.image,c,c,e.image.width-2*c,e.image.height-2*c,u?l:Math.round(l),u?s:Math.round(s),u?g:Math.round(l+g)-Math.round(l),u?h:Math.round(s+h)-Math.round(s)),e.clipExtent&&f.restore()}})}var P=(0,_extent.getTopLeft)(i);return l.getTriangles().forEach(function(e,t,n){var a=e.source,o=e.target,i=a[0][0],l=a[0][1],c=a[1][0],g=a[1][1],h=a[2][0],d=a[2][1],_=x((o[0][0]-P[0])/r),M=x(-(o[0][1]-P[1])/r),T=x((o[1][0]-P[0])/r),R=x(-(o[1][1]-P[1])/r),E=x((o[2][0]-P[0])/r),b=x(-(o[2][1]-P[1])/r),C=i,D=l;i=0,l=0;var k=[[c-=C,g-=D,0,0,T-_],[h-=C,d-=D,0,0,E-_],[0,0,c,g,R-M],[0,0,h,d,b-M]],S=(0,_math.solveLinearSystem)(k);if(S){if(v.save(),v.beginPath(),isBrokenDiagonalRendering()||!u){v.moveTo(T,R);for(var j=_-T,w=M-R,y=0;y<4;y++)v.lineTo(T+x((y+1)*j/4),R+x(y*w/3)),3!=y&&v.lineTo(T+x((y+1)*j/4),R+x((y+1)*w/3));v.lineTo(E,b)}else v.moveTo(T,R),v.lineTo(_,M),v.lineTo(E,b);var B;if(v.clip(),v.transform(S[0],S[2],S[1],S[3],_,M),v.translate(m[0]-C,m[3]-D),f)B=f.canvas,v.scale(p,-p);else{var W=s[0],H=W.extent;B=W.image,v.scale((0,_extent.getWidth)(H)/B.width,-(0,_extent.getHeight)(H)/B.height)}v.drawImage(B,0,0),v.restore()}}),f&&((0,_dom.releaseCanvas)(f),canvasPool.push(f.canvas)),g&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,l.getTriangles().forEach(function(e,t,n){var a=e.target,o=(a[0][0]-P[0])/r,i=-(a[0][1]-P[1])/r,l=(a[1][0]-P[0])/r,s=-(a[1][1]-P[1])/r,c=(a[2][0]-P[0])/r,g=-(a[2][1]-P[1])/r;v.beginPath(),v.moveTo(l,s),v.lineTo(o,i),v.lineTo(c,g),v.closePath(),v.stroke()}),v.restore()),v.canvas}

},{"./dom.js":130,"./extent.js":142,"./math.js":279,"./proj.js":283}],329:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _common=require("./common.js"),_DataTile2=_interopRequireWildcard(require("../DataTile.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_Triangulation=_interopRequireDefault(require("./Triangulation.js")),_reproj=require("../reproj.js"),_math=require("../math.js"),_dom=require("../dom.js"),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&{}.hasOwnProperty.call(e,n)){var a=o?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=e[n]}return i.default=e,r&&r.set(e,i),i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ReprojDataTile=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{tileCoord:e.tileCoord,loader:function(){return Promise.resolve(new Uint8Array(4))},interpolate:e.interpolate,transition:e.transition}])).pixelRatio_=e.pixelRatio,r.gutter_=e.gutter,r.reprojData_=null,r.reprojError_=null,r.reprojSize_=void 0,r.sourceTileGrid_=e.sourceTileGrid,r.targetTileGrid_=e.targetTileGrid,r.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,r.sourceTiles_=[],r.sourcesListenerKeys_=null,r.sourceZ_=0;var i=e.sourceProj,o=i.getExtent(),n=e.sourceTileGrid.getExtent();r.clipExtent_=i.canWrapX()?n?(0,_extent.getIntersection)(o,n):o:n;var a=r.targetTileGrid_.getTileCoordExtent(r.wrappedTileCoord_),l=r.targetTileGrid_.getExtent(),u=r.sourceTileGrid_.getExtent(),s=l?(0,_extent.getIntersection)(a,l):a;if(0===(0,_extent.getArea)(s))return r.state=_TileState.default.EMPTY,_possibleConstructorReturn(r);o&&(u=u?(0,_extent.getIntersection)(u,o):o);var c=r.targetTileGrid_.getResolution(r.wrappedTileCoord_[0]),_=e.targetProj,f=(0,_reproj.calculateSourceExtentResolution)(i,_,s,c);if(!isFinite(f)||f<=0)return r.state=_TileState.default.EMPTY,_possibleConstructorReturn(r);var p=void 0!==e.errorThreshold?e.errorThreshold:_common.ERROR_THRESHOLD;if(r.triangulation_=new _Triangulation.default(i,_,s,u,f*p,c),0===r.triangulation_.getTriangles().length)return r.state=_TileState.default.EMPTY,_possibleConstructorReturn(r);r.sourceZ_=r.sourceTileGrid_.getZForResolution(f);var d=r.triangulation_.calculateSourceExtent();if(u&&(i.canWrapX()?(d[1]=(0,_math.clamp)(d[1],u[1],u[3]),d[3]=(0,_math.clamp)(d[3],u[1],u[3])):d=(0,_extent.getIntersection)(d,u)),(0,_extent.getArea)(d)){var h=0,y=0;i.canWrapX()&&(h=(0,_extent.getWidth)(o),y=Math.floor((d[0]-o[0])/h)),(0,_extent.wrapAndSliceX)(d.slice(),i,!0).forEach(function(t){for(var i=r.sourceTileGrid_.getTileRangeForExtentAndZ(t,r.sourceZ_),o=e.getTileFunction,n=i.minX;n<=i.maxX;n++)for(var a=i.minY;a<=i.maxY;a++){var l=o(r.sourceZ_,n,a,r.pixelRatio_);if(l){var u=y*h;r.sourceTiles_.push({tile:l,offset:u})}}++y}),0===r.sourceTiles_.length&&(r.state=_TileState.default.EMPTY)}else r.state=_TileState.default.EMPTY;return r}return _inherits(t,_DataTile2["default"]),_createClass(t,[{key:"getSize",value:function(){return this.reprojSize_}},{key:"getData",value:function(){return this.reprojData_}},{key:"getError",value:function(){return this.reprojError_}},{key:"reproject_",value:function(){var e=this,t=[];if(this.sourceTiles_.forEach(function(r){var i,o=r.tile;if(o&&o.getState()===_TileState.default.LOADED){var n,a=o.getSize(),l=e.gutter_,u=(0,_DataTile2.asArrayLike)(o.getData());n=u||(0,_DataTile2.toArray)((0,_DataTile2.asImageLike)(o.getData()));var s=[a[0]+2*l,a[1]+2*l],c=n instanceof Float32Array,_=s[0]*s[1],f=c?Float32Array:Uint8Array,p=new f(n.buffer),d=f.BYTES_PER_ELEMENT,h=d*p.length/_,y=p.byteLength/s[1],g=Math.floor(y/d/s[0]),v=_*g,T=p;if(p.length!==v){T=new f(v);for(var b=0,E=0,j=s[0]*g,m=0;m<s[1];++m){for(var x=0;x<j;++x)T[b++]=p[E+x];E+=y/d}}var R=e.sourceTileGrid_.getTileCoordExtent(o.tileCoord);R[0]+=r.offset,R[2]+=r.offset;var S=null===(i=e.clipExtent_)||void 0===i?void 0:i.slice();S&&(S[0]+=r.offset,S[2]+=r.offset),t.push({extent:R,clipExtent:S,data:new Uint8Array(T.buffer),dataType:f,bytesPerPixel:h,pixelSize:s})}}),this.sourceTiles_.length=0,0===t.length)this.state=_TileState.default.ERROR;else{for(var r,i,o=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(o),a="number"==typeof n?n:n[0],l="number"==typeof n?n:n[1],u=this.targetTileGrid_.getResolution(o),s=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),_=t[0].bytesPerPixel,f=Math.ceil(_/3)-1;f>=0;--f){for(var p=[],d=0,h=t.length;d<h;++d){for(var y=t[d],g=y.data,v=y.pixelSize,T=v[0],b=v[1],E=(0,_dom.createCanvasContext2D)(T,b,_reproj.canvasPool),j=E.createImageData(T,b),m=j.data,x=3*f,R=0,S=m.length;R<S;R+=4)m[R]=g[x],m[R+1]=g[x+1],m[R+2]=g[x+2],m[R+3]=255,x+=_;E.putImageData(j,0,0),p.push({extent:y.extent,clipExtent:y.clipExtent,image:E.canvas})}for(var P=(0,_reproj.render)(a,l,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),u,c,this.triangulation_,p,this.gutter_,!1,!1,!1),O=0,C=p.length;O<C;++O){var D=p[O].image.getContext("2d");(0,_dom.releaseCanvas)(D),_reproj.canvasPool.push(D.canvas)}var w=P.getContext("2d"),G=w.getImageData(0,0,P.width,P.height);(0,_dom.releaseCanvas)(w),_reproj.canvasPool.push(P),r||(i=new Uint8Array(_*G.width*G.height),r=new t[0].dataType(i.buffer));for(var q=G.data,A=3*f,L=0,M=q.length;L<M;L+=4)255===q[L+3]?(i[A]=q[L],i[A+1]=q[L+1],i[A+2]=q[L+2]):(i[A]=0,i[A+1]=0,i[A+2]=0),A+=_}this.reprojData_=r,this.reprojSize_=[Math.round(a*this.pixelRatio_),Math.round(l*this.pixelRatio_)],this.state=_TileState.default.LOADED}this.changed()}},{key:"load",value:function(){var e=this;if(this.state===_TileState.default.IDLE||this.state===_TileState.default.ERROR){this.state=_TileState.default.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(r){var i=r.tile,o=i.getState();if(o===_TileState.default.IDLE||o===_TileState.default.LOADING){t++;var n=(0,_events.listen)(i,_EventType.default.CHANGE,function(){var e=i.getState();e!=_TileState.default.LOADED&&e!=_TileState.default.ERROR&&e!=_TileState.default.EMPTY||((0,_events.unlistenByKey)(n),0===--t&&(this.unlistenSources_(),this.reproject_()))},e);e.sourcesListenerKeys_.push(n)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e){var t=e.tile;t.getState()==_TileState.default.IDLE&&t.load()})}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(_events.unlistenByKey),this.sourcesListenerKeys_=null}}])}(),_default=exports.default=ReprojDataTile;

},{"../DataTile.js":80,"../TileState.js":104,"../dom.js":130,"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"../math.js":279,"../reproj.js":328,"./Triangulation.js":332,"./common.js":333}],330:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _common=require("./common.js"),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("../Image.js")),_Triangulation=_interopRequireDefault(require("./Triangulation.js")),_reproj=require("../reproj.js"),_resolution=require("../resolution.js"),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ReprojImage=function(e){function t(e,r,o,n,i,a,u){var s;_classCallCheck(this,t);var l=e.getExtent();l&&e.canWrapX()&&((l=l.slice())[0]=-1/0,l[2]=1/0);var c=r.getExtent();c&&r.canWrapX()&&((c=c.slice())[0]=-1/0,c[2]=1/0);var _=c?(0,_extent.getIntersection)(o,c):o,f=(0,_extent.getCenter)(_),p=(0,_reproj.calculateSourceResolution)(e,r,f,n),g=_common.ERROR_THRESHOLD,y=new _Triangulation.default(e,r,_,l,p*g,n),h=y.calculateSourceExtent(),m=(0,_extent.isEmpty)(h)?null:a(h,p,i),v=m?_ImageState.default.IDLE:_ImageState.default.EMPTY,d=m?m.getPixelRatio():1;return(s=_callSuper(this,t,[o,n,d,v])).targetProj_=r,s.maxSourceExtent_=l,s.triangulation_=y,s.targetResolution_=n,s.targetExtent_=o,s.sourceImage_=m,s.sourcePixelRatio_=d,s.interpolate_=u,s.canvas_=null,s.sourceListenerKey_=null,s}return _inherits(t,_Image["default"]),_createClass(t,[{key:"disposeInternal",value:function(){this.state==_ImageState.default.LOADING&&this.unlistenSource_(),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}},{key:"getImage",value:function(){return this.canvas_}},{key:"getProjection",value:function(){return this.targetProj_}},{key:"reproject_",value:function(){var e=this.sourceImage_.getState();if(e==_ImageState.default.LOADED){var t=(0,_extent.getWidth)(this.targetExtent_)/this.targetResolution_,r=(0,_extent.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,_reproj.render)(t,r,this.sourcePixelRatio_,(0,_resolution.fromResolutionLike)(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}},{key:"load",value:function(){if(this.state==_ImageState.default.IDLE){this.state=_ImageState.default.LOADING,this.changed();var e=this.sourceImage_.getState();e==_ImageState.default.LOADED||e==_ImageState.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,_events.listen)(this.sourceImage_,_EventType.default.CHANGE,function(e){var t=this.sourceImage_.getState();t!=_ImageState.default.LOADED&&t!=_ImageState.default.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}},{key:"unlistenSource_",value:function(){(0,_events.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null}}])}(),_default=exports.default=ReprojImage;

},{"../Image.js":84,"../ImageState.js":86,"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"../reproj.js":328,"../resolution.js":334,"./Triangulation.js":332,"./common.js":333}],331:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _common=require("./common.js"),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Tile2=_interopRequireDefault(require("../Tile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_Triangulation=_interopRequireDefault(require("./Triangulation.js")),_reproj=require("../reproj.js"),_math=require("../math.js"),_extent=require("../extent.js"),_events=require("../events.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ReprojTile=function(e){function t(e,r,i,o,n,a,s,l,u,c,_,f){var p;_classCallCheck(this,t),(p=_callSuper(this,t,[n,_TileState.default.IDLE,f])).renderEdges_=void 0!==_&&_,p.pixelRatio_=s,p.gutter_=l,p.canvas_=null,p.sourceTileGrid_=r,p.targetTileGrid_=o,p.wrappedTileCoord_=a||n,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0,p.clipExtent_=e.canWrapX()?e.getExtent():void 0;var d=o.getTileCoordExtent(p.wrappedTileCoord_),y=p.targetTileGrid_.getExtent(),h=p.sourceTileGrid_.getExtent(),v=y?(0,_extent.getIntersection)(d,y):d;if(0===(0,_extent.getArea)(v))return p.state=_TileState.default.EMPTY,_possibleConstructorReturn(p);var g=e.getExtent();g&&(h=h?(0,_extent.getIntersection)(h,g):g);var T=o.getResolution(p.wrappedTileCoord_[0]),b=(0,_reproj.calculateSourceExtentResolution)(e,i,v,T);if(!isFinite(b)||b<=0)return p.state=_TileState.default.EMPTY,_possibleConstructorReturn(p);var E=void 0!==c?c:_common.ERROR_THRESHOLD;if(p.triangulation_=new _Triangulation.default(e,i,v,h,b*E,T),0===p.triangulation_.getTriangles().length)return p.state=_TileState.default.EMPTY,_possibleConstructorReturn(p);p.sourceZ_=r.getZForResolution(b);var m=p.triangulation_.calculateSourceExtent();if(h&&(e.canWrapX()?(m[1]=(0,_math.clamp)(m[1],h[1],h[3]),m[3]=(0,_math.clamp)(m[3],h[1],h[3])):m=(0,_extent.getIntersection)(m,h)),(0,_extent.getArea)(m)){var S=0,R=0;e.canWrapX()&&(S=(0,_extent.getWidth)(g),R=Math.floor((m[0]-g[0])/S)),(0,_extent.wrapAndSliceX)(m.slice(),e,!0).forEach(function(e){for(var t=r.getTileRangeForExtentAndZ(e,p.sourceZ_),i=t.minX;i<=t.maxX;i++)for(var o=t.minY;o<=t.maxY;o++){var n=u(p.sourceZ_,i,o,s);if(n){var a=R*S;p.sourceTiles_.push({tile:n,offset:a})}}++R}),0===p.sourceTiles_.length&&(p.state=_TileState.default.EMPTY)}else p.state=_TileState.default.EMPTY;return p}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var e=this,t=[];if(this.sourceTiles_.forEach(function(r){var i=r.tile;if(i&&i.getState()==_TileState.default.LOADED){var o,n=e.sourceTileGrid_.getTileCoordExtent(i.tileCoord);n[0]+=r.offset,n[2]+=r.offset;var a=null===(o=e.clipExtent_)||void 0===o?void 0:o.slice();a&&(a[0]+=r.offset,a[2]+=r.offset),t.push({extent:n,clipExtent:a,image:i.getImage()})}}),this.sourceTiles_.length=0,0===t.length)this.state=_TileState.default.ERROR;else{var r=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(r),o="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],a=this.targetTileGrid_.getResolution(r),s=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,_reproj.render)(o,n,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=_TileState.default.LOADED}this.changed()}},{key:"load",value:function(){var e=this;if(this.state==_TileState.default.IDLE){this.state=_TileState.default.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(r){var i=r.tile,o=i.getState();if(o==_TileState.default.IDLE||o==_TileState.default.LOADING){t++;var n=(0,_events.listen)(i,_EventType.default.CHANGE,function(e){var r=i.getState();r!=_TileState.default.LOADED&&r!=_TileState.default.ERROR&&r!=_TileState.default.EMPTY||((0,_events.unlistenByKey)(n),0===--t&&(this.unlistenSources_(),this.reproject_()))},e);e.sourcesListenerKeys_.push(n)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,t,r){var i=e.tile;i.getState()==_TileState.default.IDLE&&i.load()})}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(_events.unlistenByKey),this.sourcesListenerKeys_=null}},{key:"release",value:function(){this.canvas_&&((0,_dom.releaseCanvas)(this.canvas_.getContext("2d")),_reproj.canvasPool.push(this.canvas_),this.canvas_=null),_get(_getPrototypeOf(t.prototype),"release",this).call(this)}}])}(),_default=exports.default=ReprojTile;

},{"../Tile.js":100,"../TileState.js":104,"../dom.js":130,"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"../math.js":279,"../reproj.js":328,"./Triangulation.js":332,"./common.js":333}],332:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extent=require("../extent.js"),_proj=require("../proj.js"),_math=require("../math.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var MAX_SUBDIVISION=10,MAX_TRIANGLE_WIDTH=.25,Triangulation=function(){return _createClass(function t(e,r,i,o,n,s){var a=this;_classCallCheck(this,t),this.sourceProj_=e,this.targetProj_=r;var u={},_=(0,_proj.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return u[e]||(u[e]=_(t)),u[e]},this.maxSourceExtent_=o,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&(0,_extent.getWidth)(o)>=(0,_extent.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,_extent.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,_extent.getWidth)(this.targetProj_.getExtent()):null;var h=(0,_extent.getTopLeft)(i),c=(0,_extent.getTopRight)(i),d=(0,_extent.getBottomRight)(i),l=(0,_extent.getBottomLeft)(i),f=this.transformInv_(h),g=this.transformInv_(c),m=this.transformInv_(d),v=this.transformInv_(l),p=MAX_SUBDIVISION+(s?Math.max(0,Math.ceil(Math.log2((0,_extent.getArea)(i)/(s*s*256*256)))):0);if(this.addQuad_(h,c,d,l,f,g,m,v,p),this.wrapsXInSource_){var x=1/0;this.triangles_.forEach(function(t,e,r){x=Math.min(x,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-x>a.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-x>a.sourceWorldWidth_/2&&(e[0][0]-=a.sourceWorldWidth_),e[1][0]-x>a.sourceWorldWidth_/2&&(e[1][0]-=a.sourceWorldWidth_),e[2][0]-x>a.sourceWorldWidth_/2&&(e[2][0]-=a.sourceWorldWidth_);var r=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-r<a.sourceWorldWidth_/2&&(t.source=e)}})}u={}},[{key:"addTriangle_",value:function(t,e,r,i,o,n){this.triangles_.push({source:[i,o,n],target:[t,e,r]})}},{key:"addQuad_",value:function(t,e,r,i,o,n,s,a,u){var _=(0,_extent.boundingExtent)([o,n,s,a]),h=this.sourceWorldWidth_?(0,_extent.getWidth)(_)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1,l=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var f=(0,_extent.boundingExtent)([t,e,r,i]);l=(0,_extent.getWidth)(f)/this.targetWorldWidth_>MAX_TRIANGLE_WIDTH||l}!d&&this.sourceProj_.isGlobal()&&h&&(l=h>MAX_TRIANGLE_WIDTH||l)}if(!(!l&&this.maxSourceExtent_&&isFinite(_[0])&&isFinite(_[1])&&isFinite(_[2])&&isFinite(_[3]))||(0,_extent.intersects)(_,this.maxSourceExtent_)){var g=0;if(!(l||isFinite(o[0])&&isFinite(o[1])&&isFinite(n[0])&&isFinite(n[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(u>0)l=!0;else if(1!=(g=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(n[0])&&isFinite(n[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1))&&2!=g&&4!=g&&8!=g)return;if(u>0){if(!l){var m,v=[(t[0]+r[0])/2,(t[1]+r[1])/2],p=this.transformInv_(v);if(d)m=((0,_math.modulo)(o[0],c)+(0,_math.modulo)(s[0],c))/2-(0,_math.modulo)(p[0],c);else m=(o[0]+s[0])/2-p[0];var x=(o[1]+s[1])/2-p[1];l=m*m+x*x>this.errorThresholdSquared_}if(l){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){var W=[(e[0]+r[0])/2,(e[1]+r[1])/2],y=this.transformInv_(W),I=[(i[0]+t[0])/2,(i[1]+t[1])/2],b=this.transformInv_(I);this.addQuad_(t,e,W,I,o,n,y,b,u-1),this.addQuad_(I,W,r,i,b,y,s,a,u-1)}else{var P=[(t[0]+e[0])/2,(t[1]+e[1])/2],j=this.transformInv_(P),S=[(r[0]+i[0])/2,(r[1]+i[1])/2],E=this.transformInv_(S);this.addQuad_(t,P,S,i,o,j,E,a,u-1),this.addQuad_(P,e,r,S,j,n,s,E,u-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&g)&&this.addTriangle_(t,r,i,o,s,a),0==(14&g)&&this.addTriangle_(t,r,e,o,s,n),g&&(0==(13&g)&&this.addTriangle_(e,i,t,n,a,o),0==(7&g)&&this.addTriangle_(e,i,r,n,a,s))}}},{key:"calculateSourceExtent",value:function(){var t=(0,_extent.createEmpty)();return this.triangles_.forEach(function(e,r,i){var o=e.source;(0,_extent.extendCoordinate)(t,o[0]),(0,_extent.extendCoordinate)(t,o[1]),(0,_extent.extendCoordinate)(t,o[2])}),t}},{key:"getTriangles",value:function(){return this.triangles_}}])}(),_default=exports.default=Triangulation;

},{"../extent.js":142,"../math.js":279,"../proj.js":283}],333:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ERROR_THRESHOLD=void 0;var ERROR_THRESHOLD=exports.ERROR_THRESHOLD=.5;

},{}],334:[function(require,module,exports){
"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,o=Array(e);t<e;t++)o[t]=r[t];return o}function fromResolutionLike(r){return Array.isArray(r)?Math.min.apply(Math,_toConsumableArray(r)):r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromResolutionLike=fromResolutionLike;

},{}],335:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMinMaxResolution=createMinMaxResolution,exports.createSnapToPower=createSnapToPower,exports.createSnapToResolutions=createSnapToResolutions;var _math=require("./math.js"),_extent=require("./extent.js"),_array=require("./array.js");function getViewportClampedResolution(t,e,a,o){var r=(0,_extent.getWidth)(e)/a[0],n=(0,_extent.getHeight)(e)/a[1];return o?Math.min(t,Math.max(r,n)):Math.min(t,Math.min(r,n))}function getSmoothClampedResolution(t,e,a){var o=Math.min(t,e);return o*=Math.log(1+50*Math.max(0,t/e-1))/50+1,a&&(o=Math.max(o,a),o/=Math.log(1+50*Math.max(0,a/t-1))/50+1),(0,_math.clamp)(o,a/2,2*e)}function createSnapToResolutions(t,e,a,o){return e=void 0===e||e,function(r,n,i,l){if(void 0!==r){var u=t[0],h=t[t.length-1],m=a?getViewportClampedResolution(u,a,i,o):u;if(l)return e?getSmoothClampedResolution(r,m,h):(0,_math.clamp)(r,h,m);var p=Math.min(m,r),s=Math.floor((0,_array.linearFindNearest)(t,p,n));return t[s]>m&&s<t.length-1?t[s+1]:t[s]}}}function createSnapToPower(t,e,a,o,r,n){return o=void 0===o||o,a=void 0!==a?a:0,function(i,l,u,h){if(void 0!==i){var m=r?getViewportClampedResolution(e,r,u,n):e;if(h)return o?getSmoothClampedResolution(i,m,a):(0,_math.clamp)(i,a,m);var p=Math.ceil(Math.log(e/m)/Math.log(t)-1e-9),s=-l*(.5-1e-9)+.5,M=Math.min(m,i),c=Math.floor(Math.log(e/M)/Math.log(t)+s),d=Math.max(p,c),g=e/Math.pow(t,d);return(0,_math.clamp)(g,a,m)}}}function createMinMaxResolution(t,e,a,o,r){return a=void 0===a||a,function(n,i,l,u){if(void 0!==n){var h=o?getViewportClampedResolution(t,o,l,r):t;return a&&u?getSmoothClampedResolution(n,h,e):(0,_math.clamp)(n,e,h)}}}

},{"./array.js":110,"./extent.js":142,"./math.js":279}],336:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSnapToN=createSnapToN,exports.createSnapToZero=createSnapToZero,exports.disable=disable,exports.none=none;var _math=require("./math.js");function disable(e){if(void 0!==e)return 0}function none(e){if(void 0!==e)return e}function createSnapToN(e){var r=2*Math.PI/e;return function(e,o){return o?e:void 0!==e?e=Math.floor(e/r+.5)*r:void 0}}function createSnapToZero(e){var r=void 0===e?(0,_math.toRadians)(5):e;return function(e,o){return o||void 0===e?e:Math.abs(e)<=r?0:e}}

},{"./math.js":279}],337:[function(require,module,exports){
"use strict";function buffer(e,r,t){return void 0===t&&(t=[0,0]),t[0]=e[0]+2*r,t[1]=e[1]+2*r,t}function hasArea(e){return e[0]>0&&e[1]>0}function scale(e,r,t){return void 0===t&&(t=[0,0]),t[0]=e[0]*r+.5|0,t[1]=e[1]*r+.5|0,t}function toSize(e,r){return Array.isArray(e)?e:(void 0===r?r=[e,e]:(r[0]=e,r[1]=e),r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=buffer,exports.hasArea=hasArea,exports.scale=scale,exports.toSize=toSize;

},{}],338:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"BingMaps",{enumerable:!0,get:function(){return _BingMaps.default}}),Object.defineProperty(exports,"CartoDB",{enumerable:!0,get:function(){return _CartoDB.default}}),Object.defineProperty(exports,"Cluster",{enumerable:!0,get:function(){return _Cluster.default}}),Object.defineProperty(exports,"DataTile",{enumerable:!0,get:function(){return _DataTile.default}}),Object.defineProperty(exports,"GeoTIFF",{enumerable:!0,get:function(){return _GeoTIFF.default}}),Object.defineProperty(exports,"Google",{enumerable:!0,get:function(){return _Google.default}}),Object.defineProperty(exports,"IIIF",{enumerable:!0,get:function(){return _IIIF.default}}),Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return _Image.default}}),Object.defineProperty(exports,"ImageArcGISRest",{enumerable:!0,get:function(){return _ImageArcGISRest.default}}),Object.defineProperty(exports,"ImageCanvas",{enumerable:!0,get:function(){return _ImageCanvas.default}}),Object.defineProperty(exports,"ImageMapGuide",{enumerable:!0,get:function(){return _ImageMapGuide.default}}),Object.defineProperty(exports,"ImageStatic",{enumerable:!0,get:function(){return _ImageStatic.default}}),Object.defineProperty(exports,"ImageWMS",{enumerable:!0,get:function(){return _ImageWMS.default}}),Object.defineProperty(exports,"OGCMapTile",{enumerable:!0,get:function(){return _OGCMapTile.default}}),Object.defineProperty(exports,"OGCVectorTile",{enumerable:!0,get:function(){return _OGCVectorTile.default}}),Object.defineProperty(exports,"OSM",{enumerable:!0,get:function(){return _OSM.default}}),Object.defineProperty(exports,"Raster",{enumerable:!0,get:function(){return _Raster.default}}),Object.defineProperty(exports,"Source",{enumerable:!0,get:function(){return _Source.default}}),Object.defineProperty(exports,"StadiaMaps",{enumerable:!0,get:function(){return _StadiaMaps.default}}),Object.defineProperty(exports,"Tile",{enumerable:!0,get:function(){return _Tile.default}}),Object.defineProperty(exports,"TileArcGISRest",{enumerable:!0,get:function(){return _TileArcGISRest.default}}),Object.defineProperty(exports,"TileDebug",{enumerable:!0,get:function(){return _TileDebug.default}}),Object.defineProperty(exports,"TileImage",{enumerable:!0,get:function(){return _TileImage.default}}),Object.defineProperty(exports,"TileJSON",{enumerable:!0,get:function(){return _TileJSON.default}}),Object.defineProperty(exports,"TileWMS",{enumerable:!0,get:function(){return _TileWMS.default}}),Object.defineProperty(exports,"UTFGrid",{enumerable:!0,get:function(){return _UTFGrid.default}}),Object.defineProperty(exports,"UrlTile",{enumerable:!0,get:function(){return _UrlTile.default}}),Object.defineProperty(exports,"Vector",{enumerable:!0,get:function(){return _Vector.default}}),Object.defineProperty(exports,"VectorTile",{enumerable:!0,get:function(){return _VectorTile.default}}),Object.defineProperty(exports,"WMTS",{enumerable:!0,get:function(){return _WMTS.default}}),Object.defineProperty(exports,"XYZ",{enumerable:!0,get:function(){return _XYZ.default}}),Object.defineProperty(exports,"Zoomify",{enumerable:!0,get:function(){return _Zoomify.default}}),Object.defineProperty(exports,"createArcGISRestLoader",{enumerable:!0,get:function(){return _arcgisRest.createLoader}}),Object.defineProperty(exports,"createMapGuideLoader",{enumerable:!0,get:function(){return _mapguide.createLoader}}),Object.defineProperty(exports,"createStaticLoader",{enumerable:!0,get:function(){return _static.createLoader}}),Object.defineProperty(exports,"createWMSLoader",{enumerable:!0,get:function(){return _wms.createLoader}}),exports.sourcesFromTileGrid=sourcesFromTileGrid;var _LRUCache=_interopRequireDefault(require("./structs/LRUCache.js")),_extent=require("./extent.js"),_BingMaps=_interopRequireDefault(require("./source/BingMaps.js")),_CartoDB=_interopRequireDefault(require("./source/CartoDB.js")),_Cluster=_interopRequireDefault(require("./source/Cluster.js")),_DataTile=_interopRequireDefault(require("./source/DataTile.js")),_GeoTIFF=_interopRequireDefault(require("./source/GeoTIFF.js")),_Google=_interopRequireDefault(require("./source/Google.js")),_IIIF=_interopRequireDefault(require("./source/IIIF.js")),_Image=_interopRequireDefault(require("./source/Image.js")),_ImageArcGISRest=_interopRequireDefault(require("./source/ImageArcGISRest.js")),_ImageCanvas=_interopRequireDefault(require("./source/ImageCanvas.js")),_ImageMapGuide=_interopRequireDefault(require("./source/ImageMapGuide.js")),_ImageStatic=_interopRequireDefault(require("./source/ImageStatic.js")),_ImageWMS=_interopRequireDefault(require("./source/ImageWMS.js")),_OGCMapTile=_interopRequireDefault(require("./source/OGCMapTile.js")),_OGCVectorTile=_interopRequireDefault(require("./source/OGCVectorTile.js")),_OSM=_interopRequireDefault(require("./source/OSM.js")),_Raster=_interopRequireDefault(require("./source/Raster.js")),_Source=_interopRequireDefault(require("./source/Source.js")),_StadiaMaps=_interopRequireDefault(require("./source/StadiaMaps.js")),_Tile=_interopRequireDefault(require("./source/Tile.js")),_TileArcGISRest=_interopRequireDefault(require("./source/TileArcGISRest.js")),_TileDebug=_interopRequireDefault(require("./source/TileDebug.js")),_TileImage=_interopRequireDefault(require("./source/TileImage.js")),_TileJSON=_interopRequireDefault(require("./source/TileJSON.js")),_TileWMS=_interopRequireDefault(require("./source/TileWMS.js")),_UrlTile=_interopRequireDefault(require("./source/UrlTile.js")),_UTFGrid=_interopRequireDefault(require("./source/UTFGrid.js")),_Vector=_interopRequireDefault(require("./source/Vector.js")),_VectorTile=_interopRequireDefault(require("./source/VectorTile.js")),_WMTS=_interopRequireDefault(require("./source/WMTS.js")),_XYZ=_interopRequireDefault(require("./source/XYZ.js")),_Zoomify=_interopRequireDefault(require("./source/Zoomify.js")),_wms=require("./source/wms.js"),_arcgisRest=require("./source/arcgisRest.js"),_static=require("./source/static.js"),_mapguide=require("./source/mapguide.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function sourcesFromTileGrid(e,r){var t=new _LRUCache.default(32),u=e.getExtent();return function(i,o){t.expireCache(),u&&(i=(0,_extent.getIntersection)(u,i));var n=e.getZForResolution(o),a=[];return e.forEachTileCoord(i,n,function(e){var u=e.toString();if(!t.containsKey(u)){var i=r(e);t.set(u,i)}a.push(t.get(u))}),a}}

},{"./extent.js":142,"./source/BingMaps.js":339,"./source/CartoDB.js":340,"./source/Cluster.js":341,"./source/DataTile.js":342,"./source/GeoTIFF.js":343,"./source/Google.js":344,"./source/IIIF.js":345,"./source/Image.js":346,"./source/ImageArcGISRest.js":347,"./source/ImageCanvas.js":348,"./source/ImageMapGuide.js":349,"./source/ImageStatic.js":350,"./source/ImageWMS.js":351,"./source/OGCMapTile.js":352,"./source/OGCVectorTile.js":353,"./source/OSM.js":354,"./source/Raster.js":355,"./source/Source.js":356,"./source/StadiaMaps.js":357,"./source/Tile.js":358,"./source/TileArcGISRest.js":359,"./source/TileDebug.js":360,"./source/TileImage.js":362,"./source/TileJSON.js":363,"./source/TileWMS.js":364,"./source/UTFGrid.js":365,"./source/UrlTile.js":366,"./source/Vector.js":367,"./source/VectorTile.js":369,"./source/WMTS.js":370,"./source/XYZ.js":371,"./source/Zoomify.js":372,"./source/arcgisRest.js":373,"./source/mapguide.js":375,"./source/static.js":377,"./source/wms.js":378,"./structs/LRUCache.js":381}],339:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.quadKey=quadKey;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_extent2=require("../extent.js"),_tileurlfunction=require("../tileurlfunction.js"),_tilecoord=require("../tilecoord.js"),_tilegrid=require("../tilegrid.js"),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function quadKey(e){var t,r,o=e[0],i=new Array(o),n=1<<o-1;for(t=0;t<o;++t)r=48,e[1]&n&&(r+=1),e[2]&n&&(r+=2),i[t]=String.fromCharCode(r),n>>=1;return i.join("")}var TOS_ATTRIBUTION='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>',BingMaps=function(e){function t(e){var r;_classCallCheck(this,t);var o=void 0!==e.hidpi&&e.hidpi;(r=_callSuper(this,t,[{cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,opaque:!0,projection:(0,_proj.get)("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,tilePixelRatio:o?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}])).hidpi_=o,r.culture_=void 0!==e.culture?e.culture:"en-us",r.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1,r.apiKey_=e.key,r.imagerySet_=e.imagerySet,r.placeholderTiles_=e.placeholderTiles;var i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+r.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+r.apiKey_+"&c="+r.culture_;return fetch(i).then(function(e){return e.json()}).then(function(e){return r.handleImageryMetadataResponse(e)}),r}return _inherits(t,_TileImage2["default"]),_createClass(t,[{key:"getApiKey",value:function(){return this.apiKey_}},{key:"getImagerySet",value:function(){return this.imagerySet_}},{key:"handleImageryMetadataResponse",value:function(e){var t=this;if(200==e.statusCode&&"OK"==e.statusDescription&&"ValidCredentials"==e.authenticationResultCode&&1==e.resourceSets.length&&1==e.resourceSets[0].resources.length){var r=e.resourceSets[0].resources[0],o=-1==this.maxZoom_?r.zoomMax:this.maxZoom_,i=this.getProjection(),n=(0,_tilegrid.extentFromProjection)(i),a=this.hidpi_?2:1,u=r.imageWidth==r.imageHeight?r.imageWidth/a:[r.imageWidth/a,r.imageHeight/a],s=(0,_tilegrid.createXYZ)({extent:n,minZoom:r.zoomMin,maxZoom:o,tileSize:u});this.tileGrid=s;var c=this.culture_,l=this.hidpi_,p=this.placeholderTiles_;if(this.tileUrlFunction=(0,_tileurlfunction.createFromTileUrlFunctions)(r.imageUrlSubdomains.map(function(e){var t=[0,0,0],o=r.imageUrl.replace("{subdomain}",e).replace("{culture}",c);return function(e,r,i){if(e){(0,_tilecoord.createOrUpdate)(e[0],e[1],e[2],t);var n=new URL(o.replace("{quadkey}",quadKey(t))),a=n.searchParams;return l&&(a.set("dpi","d1"),a.set("device","mobile")),!0===p?a.delete("n"):!1===p&&a.set("n","z"),n.toString()}}})),r.imageryProviders){var f=(0,_proj.getTransformFromProjections)((0,_proj.get)("EPSG:4326"),this.getProjection());this.setAttributions(function(e){var o=[],i=e.viewState,n=t.getTileGrid(),a=n.getZForResolution(i.resolution,t.zDirection),u=n.getTileCoordForCoordAndZ(i.center,a)[0];return r.imageryProviders.map(function(t){for(var r=!1,i=t.coverageAreas,n=0,a=i.length;n<a;++n){var s=i[n];if(u>=s.zoomMin&&u<=s.zoomMax){var c=s.bbox,l=[c[1],c[0],c[3],c[2]],p=(0,_extent2.applyTransform)(l,f);if((0,_extent2.intersects)(p,e.extent)){r=!0;break}}}r&&o.push(t.attribution)}),o.push(TOS_ATTRIBUTION),o})}this.setState("ready")}else this.setState("error")}}])}(),_default=exports.default=BingMaps;

},{"../extent.js":142,"../proj.js":283,"../tilecoord.js":396,"../tilegrid.js":397,"../tileurlfunction.js":401,"./TileImage.js":362}],340:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _XYZ2=_interopRequireDefault(require("./XYZ.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CartoDB=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,[{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,maxZoom:void 0!==t.maxZoom?t.maxZoom:18,minZoom:t.minZoom,projection:t.projection,transition:t.transition,wrapX:t.wrapX,zDirection:t.zDirection}])).account_=t.account,r.mapId_=t.map||"",r.config_=t.config||{},r.templateCache_={},r.initializeMap_(),r}return _inherits(e,_XYZ2["default"]),_createClass(e,[{key:"getConfig",value:function(){return this.config_}},{key:"updateConfig",value:function(t){Object.assign(this.config_,t),this.initializeMap_()}},{key:"setConfig",value:function(t){this.config_=t||{},this.initializeMap_()}},{key:"initializeMap_",value:function(){var t=JSON.stringify(this.config_);if(this.templateCache_[t])this.applyTemplate_(this.templateCache_[t]);else{var e="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(e+="/named/"+this.mapId_);var r=new XMLHttpRequest;r.addEventListener("load",this.handleInitResponse_.bind(this,t)),r.addEventListener("error",this.handleInitError_.bind(this)),r.open("POST",e),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify(this.config_))}}},{key:"handleInitResponse_",value:function(t,e){var r=e.target;if(!r.status||r.status>=200&&r.status<300){var o;try{o=JSON.parse(r.responseText)}catch(t){return void this.setState("error")}this.applyTemplate_(o),this.templateCache_[t]=o,this.setState("ready")}else this.setState("error")}},{key:"handleInitError_",value:function(t){this.setState("error")}},{key:"applyTemplate_",value:function(t){var e="https://"+t.cdn_url.https+"/"+this.account_+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)}}])}(),_default=exports.default=CartoDB;

},{"./XYZ.js":371}],341:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Feature=_interopRequireDefault(require("../Feature.js")),_Point=_interopRequireDefault(require("../geom/Point.js")),_Vector=_interopRequireDefault(require("./Vector.js")),_coordinate=require("../coordinate.js"),_asserts=require("../asserts.js"),_extent=require("../extent.js"),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Cluster=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:(e=e||{}).attributions,wrapX:e.wrapX}])).resolution=void 0,r.distance=void 0!==e.distance?e.distance:20,r.minDistance=e.minDistance||0,r.interpolationRatio=0,r.features=[],r.geometryFunction=e.geometryFunction||function(e){var t=e.getGeometry();return(0,_asserts.assert)(!t||"Point"===t.getType(),"The default `geometryFunction` can only handle `Point` or null geometries"),t},r.createCustomCluster_=e.createCluster,r.source=null,r.boundRefresh_=r.refresh.bind(r),r.updateDistance(r.distance,r.minDistance),r.setSource(e.source||null),r}return _inherits(t,_Vector["default"]),_createClass(t,[{key:"clear",value:function(e){this.features.length=0,_get(_getPrototypeOf(t.prototype),"clear",this).call(this,e)}},{key:"getDistance",value:function(){return this.distance}},{key:"getSource",value:function(){return this.source}},{key:"loadFeatures",value:function(e,t,r){var n;null===(n=this.source)||void 0===n||n.loadFeatures(e,t,r),t!==this.resolution&&(this.resolution=t,this.refresh())}},{key:"setDistance",value:function(e){this.updateDistance(e,this.minDistance)}},{key:"setMinDistance",value:function(e){this.updateDistance(this.distance,e)}},{key:"getMinDistance",value:function(){return this.minDistance}},{key:"setSource",value:function(e){this.source&&this.source.removeEventListener(_EventType.default.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(_EventType.default.CHANGE,this.boundRefresh_),this.refresh()}},{key:"refresh",value:function(){this.clear(),this.cluster(),this.addFeatures(this.features)}},{key:"updateDistance",value:function(e,t){var r=0===e?0:Math.min(t,e)/e,n=e!==this.distance||this.interpolationRatio!==r;this.distance=e,this.minDistance=t,this.interpolationRatio=r,n&&this.refresh()}},{key:"cluster",value:function(){if(void 0!==this.resolution&&this.source)for(var e=(0,_extent.createEmpty)(),t=this.distance*this.resolution,r=this.source.getFeatures(),n={},o=0,i=r.length;o<i;o++){var u=r[o];if(!((0,_util.getUid)(u)in n)){var s=this.geometryFunction(u);if(s){var a=s.getCoordinates();(0,_extent.createOrUpdateFromCoordinate)(a,e),(0,_extent.buffer)(e,t,e);var c=this.source.getFeaturesInExtent(e).filter(function(e){var t=(0,_util.getUid)(e);return!(t in n)&&(n[t]=!0,!0)});this.features.push(this.createCluster(c,e))}}}}},{key:"createCluster",value:function(e,t){for(var r=[0,0],n=e.length-1;n>=0;--n){var o=this.geometryFunction(e[n]);o?(0,_coordinate.add)(r,o.getCoordinates()):e.splice(n,1)}(0,_coordinate.scale)(r,1/e.length);var i=(0,_extent.getCenter)(t),u=this.interpolationRatio,s=new _Point.default([r[0]*(1-u)+i[0]*u,r[1]*(1-u)+i[1]*u]);return this.createCustomCluster_?this.createCustomCluster_(s,e):new _Feature.default({geometry:s,features:e})}}])}(),_default=exports.default=Cluster;

},{"../Feature.js":82,"../asserts.js":111,"../coordinate.js":128,"../events/EventType.js":134,"../extent.js":142,"../geom/Point.js":210,"../util.js":404,"./Vector.js":367}],342:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _DataTile=_interopRequireDefault(require("../DataTile.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_DataTile2=_interopRequireDefault(require("../reproj/DataTile.js")),_TileCache=_interopRequireDefault(require("../TileCache.js")),_TileEventType=_interopRequireDefault(require("./TileEventType.js")),_Tile=_interopRequireWildcard(require("./Tile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_tilegrid=require("../tilegrid.js"),_proj=require("../proj.js"),_tilecoord=require("../tilecoord.js"),_util=require("../util.js"),_functions=require("../functions.js"),_size=require("../size.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(e){return e?i:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var i=_getRequireWildcardCache(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&{}.hasOwnProperty.call(e,n)){var l=o?Object.getOwnPropertyDescriptor(e,n):null;l&&(l.get||l.set)?Object.defineProperty(r,n,l):r[n]=e[n]}return r.default=e,i&&i.set(e,r),r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=_superPropBase(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:i):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DataTileSource=function(e){function t(e){var i;_classCallCheck(this,t);var r=void 0===e.projection?"EPSG:3857":e.projection,o=e.tileGrid;return void 0===o&&r&&(o=(0,_tilegrid.createXYZ)({extent:(0,_tilegrid.extentFromProjection)(r),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),(i=_callSuper(this,t,[{cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:r,tileGrid:o,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate}])).gutter_=void 0!==e.gutter?e.gutter:0,i.tileSize_=e.tileSize?(0,_size.toSize)(e.tileSize):null,i.tileSizes_=null,i.tileLoadingKeys_={},i.loader_=e.loader,i.handleTileChange_=i.handleTileChange_.bind(i),i.bandCount=void 0===e.bandCount?4:e.bandCount,i.tileGridForProjection_={},i.tileCacheForProjection_={},i}return _inherits(t,_Tile["default"]),_createClass(t,[{key:"setTileSizes",value:function(e){this.tileSizes_=e}},{key:"getTileSize",value:function(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;var t=this.getTileGrid();return t?(0,_size.toSize)(t.getTileSize(e)):[256,256]}},{key:"getGutterForProjection",value:function(e){var t=this.getProjection();return!t||(0,_proj.equivalent)(t,e)?this.gutter_:0}},{key:"setLoader",value:function(e){this.loader_=e}},{key:"getReprojTile_",value:function(e,t,i,r,o){var n=this,l=this.getTileCacheForProjection(r),a=(0,_tilecoord.getKeyZXY)(e,t,i);if(l.containsKey(a)){var u=l.get(a);if(u&&u.key==this.getKey())return u}var c=this.getTileGrid(),s=Math.max.apply(null,c.getResolutions().map(function(e,t){var i=(0,_size.toSize)(c.getTileSize(t)),r=n.getTileSize(t);return Math.max(r[0]/i[0],r[1]/i[1])})),f=this.getTileGridForProjection(o),_=this.getTileGridForProjection(r),p=[e,t,i],d=this.getTileCoordForTileUrlFunction(p,r),h=Object.assign({sourceProj:o,sourceTileGrid:f,targetProj:r,targetTileGrid:_,tileCoord:p,wrappedTileCoord:d,pixelRatio:s,gutter:this.getGutterForProjection(o),getTileFunction:function(e,t,i,r){return n.getTile(e,t,i,r,o)}},this.tileOptions),y=new _DataTile2.default(h);return y.key=this.getKey(),y}},{key:"getTile",value:function(e,t,i,r,o){var n=this.getProjection();if(n&&o&&!(0,_proj.equivalent)(n,o))return this.getReprojTile_(e,t,i,o,n);var l=this.getTileSize(e),a=(0,_tilecoord.getKeyZXY)(e,t,i);if(this.tileCache.containsKey(a))return this.tileCache.get(a);var u=this.loader_;var c=Object.assign({tileCoord:[e,t,i],loader:function(){return(0,_functions.toPromise)(function(){return u(e,t,i)})},size:l},this.tileOptions),s=new _DataTile.default(c);return s.key=this.getKey(),s.addEventListener(_EventType.default.CHANGE,this.handleTileChange_),this.tileCache.set(a,s),s}},{key:"handleTileChange_",value:function(e){var t,i=e.target,r=(0,_util.getUid)(i),o=i.getState();o==_TileState.default.LOADING?(this.tileLoadingKeys_[r]=!0,t=_TileEventType.default.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],t=o==_TileState.default.ERROR?_TileEventType.default.TILELOADERROR:o==_TileState.default.LOADED?_TileEventType.default.TILELOADEND:void 0),t&&this.dispatchEvent(new _Tile.TileSourceEvent(t,i))}},{key:"getTileGridForProjection",value:function(e){var t=this.getProjection();if(this.tileGrid&&(!t||(0,_proj.equivalent)(t,e)))return this.tileGrid;var i=(0,_util.getUid)(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=(0,_tilegrid.getForProjection)(e)),this.tileGridForProjection_[i]}},{key:"setTileGridForProjection",value:function(e,t){var i=(0,_proj.get)(e);if(i){var r=(0,_util.getUid)(i);r in this.tileGridForProjection_||(this.tileGridForProjection_[r]=t)}}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();if(!t||(0,_proj.equivalent)(t,e))return this.tileCache;var i=(0,_util.getUid)(e);return i in this.tileCacheForProjection_||(this.tileCacheForProjection_[i]=new _TileCache.default(.1)),this.tileCacheForProjection_[i]}},{key:"expireCache",value:function(e,t){var i=this.getTileCacheForProjection(e);for(var r in this.tileCache.expireCache(this.tileCache==i?t:{}),this.tileCacheForProjection_){var o=this.tileCacheForProjection_[r];o.expireCache(o==i?t:{})}}},{key:"clear",value:function(){for(var e in _get(_getPrototypeOf(t.prototype),"clear",this).call(this),this.tileCacheForProjection_)this.tileCacheForProjection_[e].clear()}}])}(),_default=exports.default=DataTileSource;

},{"../DataTile.js":80,"../TileCache.js":101,"../TileState.js":104,"../events/EventType.js":134,"../functions.js":200,"../proj.js":283,"../reproj/DataTile.js":329,"../size.js":337,"../tilecoord.js":396,"../tilegrid.js":397,"../util.js":404,"./Tile.js":358,"./TileEventType.js":361}],343:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _DataTile2=_interopRequireDefault(require("./DataTile.js")),_TileGrid=_interopRequireDefault(require("../tilegrid/TileGrid.js")),_geotiff=require("geotiff"),_proj=require("../proj.js"),_math=require("../math.js"),_extent=require("../extent.js"),_console=require("../console.js"),_Units=require("../proj/Units.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function isMask(e){return 4==(4&(e.fileDirectory.NewSubfileType||0))}function readRGB(e,t){if(!e)return!1;if(!0===e)return!0;if(3!==t.getSamplesPerPixel())return!1;var r=t.fileDirectory.PhotometricInterpretation,o=_geotiff.globals.photometricInterpretations;return r===o.CMYK||r===o.YCbCr||r===o.CIELab||r===o.ICCLab}var workerPool,STATISTICS_MAXIMUM="STATISTICS_MAXIMUM",STATISTICS_MINIMUM="STATISTICS_MINIMUM",defaultTileSize=256;function getWorkerPool(){return workerPool||(workerPool=new _geotiff.Pool),workerPool}function getBoundingBox(e){try{return e.getBoundingBox()}catch(t){return[0,0,e.getWidth(),e.getHeight()]}}function getOrigin(e){try{return e.getOrigin().slice(0,2)}catch(t){return[0,e.getHeight()]}}function getResolutions(e,t){try{return e.getResolution(t)}catch(r){return[t.getWidth()/e.getWidth(),t.getHeight()/e.getHeight()]}}function getProjection(e){var t=e.geoKeys;if(!t)return null;if(t.ProjectedCSTypeGeoKey&&32767!==t.ProjectedCSTypeGeoKey){var r="EPSG:"+t.ProjectedCSTypeGeoKey,o=(0,_proj.get)(r);if(!o){var n=(0,_Units.fromCode)(t.ProjLinearUnitsGeoKey);n&&(o=new _proj.Projection({code:r,units:n}))}return o}if(t.GeographicTypeGeoKey&&32767!==t.GeographicTypeGeoKey){var i="EPSG:"+t.GeographicTypeGeoKey,a=(0,_proj.get)(i);if(!a){var s=(0,_Units.fromCode)(t.GeogAngularUnitsGeoKey);s&&(a=new _proj.Projection({code:i,units:s}))}return a}return null}function getImagesForTIFF(e){return e.getImageCount().then(function(t){for(var r=new Array(t),o=0;o<t;++o)r[o]=e.getImage(o);return Promise.all(r)})}function getImagesForSource(e,t){return(e.blob?(0,_geotiff.fromBlob)(e.blob):e.overviews?(0,_geotiff.fromUrls)(e.url,e.overviews,t):(0,_geotiff.fromUrl)(e.url,t)).then(getImagesForTIFF)}function assertEqual(e,t,r,o,n){if(Array.isArray(e)){var i=e.length;if(!Array.isArray(t)||i!=t.length){var a=new Error(o);throw n(a),a}for(var s=0;s<i;++s)assertEqual(e[s],t[s],r,o,n)}else if(t=t,Math.abs(e-t)>r*e)throw new Error(o)}function getMinForDataType(e){return e instanceof Int8Array?-128:e instanceof Int16Array?-32768:e instanceof Int32Array?-2147483648:e instanceof Float32Array?1.2e-38:0}function getMaxForDataType(e){return e instanceof Int8Array?127:e instanceof Uint8Array?255:e instanceof Uint8ClampedArray?255:e instanceof Int16Array?32767:e instanceof Uint16Array?65535:e instanceof Int32Array?2147483647:e instanceof Uint32Array?4294967295:e instanceof Float32Array?3.4e38:255}var GeoTIFFSource=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{state:"loading",tileGrid:null,projection:e.projection||null,opaque:e.opaque,transition:e.transition,interpolate:!1!==e.interpolate,wrapX:e.wrapX}])).sourceInfo_=e.sources;var o=r.sourceInfo_.length;r.sourceOptions_=e.sourceOptions,r.sourceImagery_=new Array(o),r.sourceMasks_=new Array(o),r.resolutionFactors_=new Array(o),r.samplesPerPixel_,r.nodataValues_,r.metadata_,r.normalize_=!1!==e.normalize,r.addAlpha_=!1,r.error_=null,r.convertToRGB_=e.convertToRGB||!1,r.setKey(r.sourceInfo_.map(function(e){return e.url}).join(","));for(var n=r,i=new Array(o),a=0;a<o;++a)i[a]=getImagesForSource(r.sourceInfo_[a],r.sourceOptions_);return Promise.all(i).then(function(e){n.configure_(e)}).catch(function(e){(0,_console.error)(e),n.error_=e,n.setState("error")}),r}return _inherits(t,_DataTile2["default"]),_createClass(t,[{key:"getError",value:function(){return this.error_}},{key:"determineProjection",value:function(e){for(var t=e[0],r=t.length-1;r>=0;--r){var o=getProjection(t[r]);if(o){this.projection=o;break}}}},{key:"configure_",value:function(e){for(var t,r,o,n,i,a=this,s=new Array(e.length),u=new Array(e.length),l=new Array(e.length),c=0,f=e.length,h=function(){var f=[],h=[];e[p].forEach(function(e){isMask(e)?h.push(e):f.push(e)});var _,g,y=f.length;if(h.length>0&&h.length!==y)throw new Error("Expected one mask per image found ".concat(h.length," masks and ").concat(y," images"));var d=new Array(y),v=new Array(y),m=new Array(y);u[p]=new Array(y),l[p]=new Array(y);for(var T=0;T<y;++T){var b=f[T],I=b.getGDALNoData();l[p][T]=b.getGDALMetadata(0),u[p][T]=I;var w=a.sourceInfo_[p].bands;s[p]=w?w.length:b.getSamplesPerPixel();var P=y-(T+1);_||(_=getBoundingBox(b)),g||(g=getOrigin(b));var S=getResolutions(b,f[0]);m[P]=S[0];var A=[b.getTileWidth(),b.getTileHeight()];A[0]!==A[1]&&A[1]<defaultTileSize&&(A[0]=defaultTileSize,A[1]=defaultTileSize),d[P]=A;var j=S[0]/Math.abs(S[1]);v[P]=[A[0],A[1]/j]}if(t?(0,_extent.getIntersection)(t,_,t):t=_,r){var M="Origin mismatch for source ".concat(p,", got [").concat(g,"] but expected [").concat(r,"]");assertEqual(r,g,0,M,a.viewRejector)}else r=g;if(i){i.length-c>m.length&&(c=i.length-m.length);var C=i[i.length-1]/m[m.length-1];a.resolutionFactors_[p]=C;var G=m.map(function(e){return e*C}),O="Resolution mismatch for source ".concat(p,", got [").concat(G,"] but expected [").concat(i,"]");assertEqual(i.slice(c,i.length),G,.02,O,a.viewRejector)}else i=m,a.resolutionFactors_[p]=1;o?assertEqual(o.slice(c,o.length),v,.01,"Tile size mismatch for source ".concat(p),a.viewRejector):o=v,n?assertEqual(n.slice(c,n.length),d,0,"Tile size mismatch for source ".concat(p),a.viewRejector):n=d,a.sourceImagery_[p]=f.reverse(),a.sourceMasks_[p]=h.reverse()},p=0;p<f;++p)h();for(var _=0,g=this.sourceImagery_.length;_<g;++_)for(var y=this.sourceImagery_[_];y.length<i.length;)y.unshift(void 0);this.getProjection()||this.determineProjection(e),this.samplesPerPixel_=s,this.nodataValues_=u,this.metadata_=l;e:for(var d=0;d<f;++d){if(void 0!==this.sourceInfo_[d].nodata){this.addAlpha_=!0;break}if(this.sourceMasks_[d].length){this.addAlpha_=!0;break}var v=u[d],m=this.sourceInfo_[d].bands;if(m){for(var T=0;T<m.length;++T)if(null!==v[m[T]-1]){this.addAlpha_=!0;break e}}else for(var b=0;b<v.length;++b)if(null!==v[b]){this.addAlpha_=!0;break e}}for(var I=this.addAlpha_?1:0,w=0;w<f;++w)I+=s[w];this.bandCount=I;var P=new _TileGrid.default({extent:t,minZoom:c,origin:r,resolutions:i,tileSizes:o});this.tileGrid=P,this.setTileSizes(n),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");2===i.length?i=[i[0],i[1],i[1]/2]:1===i.length&&(i=[2*i[0],i[0],i[0]/2]),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:i,center:(0,_proj.toUserCoordinate)((0,_extent.getCenter)(t),this.projection),extent:(0,_proj.toUserExtent)(t,this.projection),zoom:1})}},{key:"loadTile_",value:function(e,t,r){for(var o=this,n=this.getTileSize(e),i=this.sourceImagery_.length,a=new Array(2*i),s=this.nodataValues_,u=this.sourceInfo_,l=getWorkerPool(),c=function(c){var f,h,p=u[c],_=o.resolutionFactors_[c],g=[Math.round(t*(n[0]*_)),Math.round(r*(n[1]*_)),Math.round((t+1)*(n[0]*_)),Math.round((r+1)*(n[1]*_))],y=o.sourceImagery_[c][e];p.bands&&(f=p.bands.map(function(e){return e-1})),h="nodata"in p&&null!==p.nodata?p.nodata:f?f.map(function(e){return s[c][e]}):s[c];var d={window:g,width:n[0],height:n[1],samples:f,fillValue:h,pool:l,interleave:!1};readRGB(o.convertToRGB_,y)?a[c]=y.readRGB(d):a[c]=y.readRasters(d);var v=i+c,m=o.sourceMasks_[c][e];if(!m)return a[v]=Promise.resolve(null),1;a[v]=m.readRasters({window:g,width:n[0],height:n[1],samples:[0],pool:l,interleave:!1})},f=0;f<i;++f)c(f);return Promise.all(a).then(this.composeTile_.bind(this,n)).catch(function(e){throw(0,_console.error)(e),e})}},{key:"composeTile_",value:function(e,t){var r,o=this.metadata_,n=this.sourceInfo_,i=this.sourceImagery_.length,a=this.bandCount,s=this.samplesPerPixel_,u=this.nodataValues_,l=this.normalize_,c=this.addAlpha_,f=e[0]*e[1],h=f*a;r=l?new Uint8Array(h):new Float32Array(h);for(var p=0,_=0;_<f;++_){for(var g=c,y=0;y<i;++y){var d=n[y],v=d.min,m=d.max,T=void 0,b=void 0;if(l){var I=o[y][0];void 0===v&&(v=I&&STATISTICS_MINIMUM in I?parseFloat(I[STATISTICS_MINIMUM]):getMinForDataType(t[y][0])),void 0===m&&(m=I&&STATISTICS_MAXIMUM in I?parseFloat(I[STATISTICS_MAXIMUM]):getMaxForDataType(t[y][0])),b=-v*(T=255/(m-v))}for(var w=0;w<s[y];++w){var P=t[y][w][_],S=void 0;if(S=l?(0,_math.clamp)(T*P+b,0,255):P,c){var A=d.nodata;if(void 0===A){var j=void 0;j=d.bands?d.bands[w]-1:w,A=u[y][j]}var M=isNaN(A);(!M&&P!==A||M&&!isNaN(P))&&(g=!1,r[p]=S)}else r[p]=S;p++}if(!g){var C=t[i+y];C&&!C[0][_]&&(g=!0)}}c&&(g||(r[p]=255),p++)}return r}}])}();GeoTIFFSource.prototype.getView;var _default=exports.default=GeoTIFFSource;

},{"../console.js":115,"../extent.js":142,"../math.js":279,"../proj.js":283,"../proj/Units.js":285,"../tilegrid/TileGrid.js":398,"./DataTile.js":342,"geotiff":32}],344:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_ViewHint=_interopRequireDefault(require("../ViewHint.js")),_tilegrid=require("../tilegrid.js"),_extent=require("../extent.js"),_proj=require("../proj.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),u=new k(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",_={};function d(){}function g(){}function m(){}var b={};c(b,a,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(R([])));x&&x!==r&&n.call(x,a)&&(b=x);var T=m.prototype=d.prototype=Object.create(b);function j(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function O(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(l).then(function(t){c.value=t,a(c)},function(t){return r("throw",t,a,u)})}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===_)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?v:h,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=v,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function R(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=m,o(T,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:g,configurable:!0}),g.displayName=c(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,s,"GeneratorFunction")),t.prototype=Object.create(T),t},e.awrap=function(t){return{__await:t}},j(O.prototype),c(O.prototype,u,function(){return this}),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},j(T),c(T,s,"Generator"),c(T,a,function(){return this}),c(T,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=R,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=_superPropBase(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var createSessionUrl="https://tile.googleapis.com/v1/createSession",tileUrl="https://tile.googleapis.com/v1/2dtiles",attributionUrl="https://tile.googleapis.com/tile/v1/viewport",maxZoom=22,Google=function(t){function e(t){var r;_classCallCheck(this,e);var n=!!t.highDpi,o=!(!0===t.overlay);(r=_callSuper(this,e,[{attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:o,projection:"EPSG:3857",reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:n?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}])).apiKey_=t.key,r.error_=null;var i={mapType:t.mapType||"roadmap",language:t.language||"en-US",region:t.region||"US"};return t.imageFormat&&(i.imageFormat=t.imageFormat),t.scale&&(i.scale=t.scale),n&&(i.highDpi=!0),t.layerTypes&&(i.layerTypes=t.layerTypes),t.styles&&(i.styles=t.styles),!0===t.overlay&&(i.overlay=!0),r.sessionTokenRequest_=i,r.sessionTokenValue_,r.sessionRefreshId_,r.previousViewportAttribution_,r.previousViewportExtent_,r.createSession_(),r}return _inherits(e,_TileImage2["default"]),_createClass(e,[{key:"getError",value:function(){return this.error_}},{key:"fetchSessionToken",value:function(t,e){return fetch(t,e)}},{key:"createSession_",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,n,o,i,a,u,s,c,l,f,p=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=createSessionUrl+"?key="+this.apiKey_,r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.sessionTokenRequest_)},t.next=4,this.fetchSessionToken(e,r);case 4:if((n=t.sent).ok){t.next=18;break}return t.prev=6,t.next=9,n.json();case 9:o=t.sent,this.error_=new Error(o.error.message),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(6),this.error_=new Error("Error fetching session token");case 16:return this.setState("error"),t.abrupt("return");case 18:return t.next=20,n.json();case 20:i=t.sent,a=this.getTilePixelRatio(1),u=[i.tileWidth/a,i.tileHeight/a],this.tileGrid=(0,_tilegrid.createXYZ)({extent:(0,_tilegrid.extentFromProjection)(this.getProjection()),maxZoom:maxZoom,tileSize:u}),s=i.session,this.sessionTokenValue_=s,c=this.apiKey_,this.tileUrlFunction=function(t,e,r){var n=t[0],o=t[1],i=t[2];return"".concat(tileUrl,"/").concat(n,"/").concat(o,"/").concat(i,"?session=").concat(s,"&key=").concat(c)},l=1e3*parseInt(i.expiry,10),f=Math.max(l-Date.now()-6e4,1),this.sessionRefreshId_=setTimeout(function(){return p.createSession_()},f),this.setAttributions(this.fetchAttributions_.bind(this)),this.setState("ready");case 33:case"end":return t.stop()}},t,this,[[6,13]])}));return function(){return t.apply(this,arguments)}}()},{key:"fetchAttributions_",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,i,a,u,s,c,l,f,p,h,y,v;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.viewHints[_ViewHint.default.ANIMATING]||e.viewHints[_ViewHint.default.INTERACTING]||e.animate)){t.next=2;break}return t.abrupt("return",this.previousViewportAttribution_);case 2:if(r=(0,_proj.toLonLat)((0,_extent.getBottomLeft)(e.extent),e.viewState.projection),n=_slicedToArray(r,2),o=n[0],i=n[1],a=(0,_proj.toLonLat)((0,_extent.getTopRight)(e.extent),e.viewState.projection),u=_slicedToArray(a,2),s=u[0],c=u[1],l=this.getTileGrid(),f=l.getZForResolution(e.viewState.resolution,this.zDirection),p="zoom=".concat(f,"&north=").concat(c,"&south=").concat(i,"&east=").concat(s,"&west=").concat(o),this.previousViewportExtent_!=p){t.next=9;break}return t.abrupt("return",this.previousViewportAttribution_);case 9:return this.previousViewportExtent_=p,h=this.sessionTokenValue_,y=this.apiKey_,v="".concat(attributionUrl,"?session=").concat(h,"&key=").concat(y,"&").concat(p),t.next=15,fetch(v).then(function(t){return t.json()}).then(function(t){return t.copyright});case 15:return this.previousViewportAttribution_=t.sent,t.abrupt("return",this.previousViewportAttribution_);case 17:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"disposeInternal",value:function(){clearTimeout(this.sessionRefreshId_),_get(_getPrototypeOf(e.prototype),"disposeInternal",this).call(this)}}])}(),_default=exports.default=Google;

},{"../ViewHint.js":108,"../extent.js":142,"../proj.js":283,"../tilegrid.js":397,"./TileImage.js":362}],345:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileGrid=_interopRequireDefault(require("../tilegrid/TileGrid.js")),_TileImage2=_interopRequireDefault(require("./TileImage.js")),_Zoomify=require("./Zoomify.js"),_common=require("../tilegrid/common.js"),_IIIFInfo=require("../format/IIIFInfo.js"),_asserts=require("../asserts.js"),_extent=require("../extent.js"),_size=require("../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function formatPercentage(e){return e.toLocaleString("en",{maximumFractionDigits:10})}var IIIF=function(e){function t(e){var r;_classCallCheck(this,t);var o=e||{},i=o.url||"";i+=i.lastIndexOf("/")===i.length-1||""===i?"":"/";var n=o.version||_IIIFInfo.Versions.VERSION2,a=o.sizes||[],l=o.size;(0,_asserts.assert)(null!=l&&Array.isArray(l)&&2==l.length&&!isNaN(l[0])&&l[0]>0&&!isNaN(l[1])&&l[1]>0,"Missing or invalid `size`");var s,u,c,f=l[0],y=l[1],p=o.tileSize,_=o.tilePixelRatio||1,d=o.format||"jpg",m=o.quality||(o.version==_IIIFInfo.Versions.VERSION1?"native":"default"),b=o.resolutions||[],h=o.supports||[],g=o.extent||[0,-y,f,0],I=null!=a&&Array.isArray(a)&&a.length>0,v=void 0!==p&&("number"==typeof p&&Number.isInteger(p)&&p>0||Array.isArray(p)&&p.length>0),P=null!=h&&Array.isArray(h)&&(h.includes("regionByPx")||h.includes("regionByPct"))&&(h.includes("sizeByWh")||h.includes("sizeByH")||h.includes("sizeByW")||h.includes("sizeByPct"));if(b.sort(function(e,t){return t-e}),v||P)if(null!=p&&("number"==typeof p&&Number.isInteger(p)&&p>0?(s=p,u=p):Array.isArray(p)&&p.length>0&&((1==p.length||null==p[1]&&Number.isInteger(p[0]))&&(s=p[0],u=p[0]),2==p.length&&(Number.isInteger(p[0])&&Number.isInteger(p[1])?(s=p[0],u=p[1]):null==p[0]&&Number.isInteger(p[1])&&(s=p[1],u=p[1])))),void 0!==s&&void 0!==u||(s=_common.DEFAULT_TILE_SIZE,u=_common.DEFAULT_TILE_SIZE),0==b.length)for(var O=c=Math.max(Math.ceil(Math.log(f/s)/Math.LN2),Math.ceil(Math.log(y/u)/Math.LN2));O>=0;O--)b.push(Math.pow(2,O));else{var S=Math.max.apply(Math,_toConsumableArray(b));c=Math.round(Math.log(S)/Math.LN2)}else if(s=f,u=y,b=[],I){a.sort(function(e,t){return e[0]-t[0]}),c=-1;for(var j=[],A=0;A<a.length;A++){var T=f/a[A][0];b.length>0&&b[b.length-1]==T?j.push(A):(b.push(T),c++)}if(j.length>0)for(var z=0;z<j.length;z++)a.splice(j[z]-z,1)}else b.push(1),a.push([f,y]),c=0;var N=new _TileGrid.default({tileSize:[s,u],extent:g,origin:(0,_extent.getTopLeft)(g),resolutions:b}),M=_Zoomify.CustomTile.bind(null,(0,_size.toSize)(p||256).map(function(e){return e*_}));return(r=_callSuper(this,t,[{attributions:o.attributions,attributionsCollapsible:o.attributionsCollapsible,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,interpolate:o.interpolate,projection:o.projection,reprojectionErrorThreshold:o.reprojectionErrorThreshold,state:o.state,tileClass:M,tileGrid:N,tilePixelRatio:o.tilePixelRatio,tileUrlFunction:function(e,t,r){var o,l,p=e[0];if(!(p>c)){var _=e[1],g=e[2],O=b[p];if(!(void 0===_||void 0===g||void 0===O||_<0||Math.ceil(f/O/s)<=_||g<0||Math.ceil(y/O/u)<=g)){if(P||v){var S=_*s*O,j=g*u*O,A=s*O,T=u*O,z=s,N=u;S+A>f&&(A=f-S),j+T>y&&(T=y-j),S+s*O>f&&(z=Math.floor((f-S+O-1)/O)),j+u*O>y&&(N=Math.floor((y-j+O-1)/O)),0==S&&A==f&&0==j&&T==y?o="full":!P||h.includes("regionByPx")?o=S+","+j+","+A+","+T:h.includes("regionByPct")&&(o="pct:"+formatPercentage(S/f*100)+","+formatPercentage(j/y*100)+","+formatPercentage(A/f*100)+","+formatPercentage(T/y*100)),n!=_IIIFInfo.Versions.VERSION3||P&&!h.includes("sizeByWh")?!P||h.includes("sizeByW")?l=z+",":h.includes("sizeByH")?l=","+N:h.includes("sizeByWh")?l=z+","+N:h.includes("sizeByPct")&&(l="pct:"+formatPercentage(100/O)):l=z+","+N}else if(o="full",I){var M=a[p][0],x=a[p][1];l=n==_IIIFInfo.Versions.VERSION3?M==f&&x==y?"max":M+","+x:M==f?"full":M+","}else l=n==_IIIFInfo.Versions.VERSION3?"max":"full";return i+o+"/"+l+"/0/"+m+"."+d}}},transition:o.transition}])).zDirection=o.zDirection,r}return _inherits(t,_TileImage2["default"]),_createClass(t)}(),_default=exports.default=IIIF;

},{"../asserts.js":111,"../extent.js":142,"../format/IIIFInfo.js":156,"../size.js":337,"../tilegrid/TileGrid.js":398,"../tilegrid/common.js":400,"./TileImage.js":362,"./Zoomify.js":372}],346:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ImageSourceEventType=exports.ImageSourceEvent=void 0,exports.defaultImageLoadFunction=defaultImageLoadFunction,exports.getRequestExtent=getRequestExtent;var _Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("../Image.js")),_Image2=_interopRequireDefault(require("../reproj/Image.js")),_Source2=_interopRequireDefault(require("./Source.js")),_common=require("./common.js"),_math=require("../math.js"),_extent=require("../extent.js"),_proj=require("../proj.js"),_resolution=require("../resolution.js"),_array=require("../array.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageSourceEventType=exports.ImageSourceEventType={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},ImageSourceEvent=exports.ImageSourceEvent=function(e){function t(e,r){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).image=r,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),ImageSource=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:e.attributions,projection:e.projection,state:e.state,interpolate:void 0===e.interpolate||e.interpolate}])).on,r.once,r.un,r.loader=e.loader||null,r.resolutions_=void 0!==e.resolutions?e.resolutions:null,r.reprojectedImage_=null,r.reprojectedRevision_=0,r.image=null,r.wantedExtent_,r.wantedResolution_,r.static_=!!e.loader&&0===e.loader.length,r.wantedProjection_=null,r}return _inherits(t,_Source2["default"]),_createClass(t,[{key:"getResolutions",value:function(){return this.resolutions_}},{key:"setResolutions",value:function(e){this.resolutions_=e}},{key:"findNearestResolution",value:function(e){var t=this.getResolutions();t&&(e=t[(0,_array.linearFindNearest)(t,e,0)]);return e}},{key:"getImage",value:function(e,t,r,o){var n=this,i=this.getProjection();if(!i||!o||(0,_proj.equivalent)(i,o))return i&&(o=i),this.getImageInternal(e,t,r,o);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,_proj.equivalent)(this.reprojectedImage_.getProjection(),o)&&this.reprojectedImage_.getResolution()==t&&(0,_extent.equals)(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new _Image2.default(i,o,e,t,r,function(e,t,r){return n.getImageInternal(e,t,r,i)},this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}},{key:"getImageInternal",value:function(e,t,r,o){if(this.loader){var n=getRequestExtent(e,t,r,1),i=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===o&&(this.wantedExtent_&&(0,_extent.containsExtent)(this.wantedExtent_,n)||(0,_extent.containsExtent)(this.image.getExtent(),n))&&(this.wantedResolution_&&(0,_resolution.fromResolutionLike)(this.wantedResolution_)===i||(0,_resolution.fromResolutionLike)(this.image.getResolution())===i)))return this.image;this.wantedProjection_=o,this.wantedExtent_=n,this.wantedResolution_=i,this.image=new _Image.default(n,i,r,this.loader),this.image.addEventListener(_EventType.default.CHANGE,this.handleImageChange.bind(this))}return this.image}},{key:"handleImageChange",value:function(e){var t,r=e.target;switch(r.getState()){case _ImageState.default.LOADING:this.loading=!0,t=ImageSourceEventType.IMAGELOADSTART;break;case _ImageState.default.LOADED:this.loading=!1,t=ImageSourceEventType.IMAGELOADEND;break;case _ImageState.default.ERROR:this.loading=!1,t=ImageSourceEventType.IMAGELOADERROR;break;default:return}this.hasListener(t)&&this.dispatchEvent(new ImageSourceEvent(t,r))}}])}();function defaultImageLoadFunction(e,t){e.getImage().src=t}function getRequestExtent(e,t,r,o){var n=t/r,i=(0,_extent.getCenter)(e),a=(0,_math.ceil)((0,_extent.getWidth)(e)/n,_common.DECIMALS),u=(0,_math.ceil)((0,_extent.getHeight)(e)/n,_common.DECIMALS),s=a+2*(0,_math.ceil)((o-1)*a/2,_common.DECIMALS),l=u+2*(0,_math.ceil)((o-1)*u/2,_common.DECIMALS);return(0,_extent.getForViewAndSize)(i,n,0,[s,l])}var _default=exports.default=ImageSource;

},{"../Image.js":84,"../ImageState.js":86,"../array.js":110,"../events/Event.js":133,"../events/EventType.js":134,"../extent.js":142,"../math.js":279,"../proj.js":283,"../reproj/Image.js":330,"../resolution.js":334,"./Source.js":356,"./common.js":374}],347:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Image=_interopRequireWildcard(require("./Image.js")),_arcgisRest=require("./arcgisRest.js"),_Image2=require("../Image.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageArcGISRest=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:(e=e||{}).attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}])).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,r.hidpi_=void 0===e.hidpi||e.hidpi,r.url_=e.url,r.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:_Image.defaultImageLoadFunction,r.params_=Object.assign({},e.params),r.imageSize_=[0,0],r.renderedRevision_=0,r.ratio_=void 0!==e.ratio?e.ratio:1.5,r.loaderProjection_=null,r}return _inherits(t,_Image["default"]),_createClass(t,[{key:"getParams",value:function(){return this.params_}},{key:"getImageInternal",value:function(e,r,o,n){var i=this;return void 0===this.url_?null:(this.loader&&this.loaderProjection_===n||(this.loaderProjection_=n,this.loader=(0,_arcgisRest.createLoader)({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:function(e,t){return i.image.setImage(e),i.imageLoadFunction_(i.image,t),(0,_Image2.decode)(e)}})),_get(_getPrototypeOf(t.prototype),"getImageInternal",this).call(this,e,r,o,n))}},{key:"getImageLoadFunction",value:function(){return this.imageLoadFunction_}},{key:"getUrl",value:function(){return this.url_}},{key:"setImageLoadFunction",value:function(e){this.imageLoadFunction_=e,this.changed()}},{key:"setUrl",value:function(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.changed()}},{key:"changed",value:function(){this.image=null,_get(_getPrototypeOf(t.prototype),"changed",this).call(this)}}])}(),_default=exports.default=ImageArcGISRest;

},{"../Image.js":84,"./Image.js":346,"./arcgisRest.js":373}],348:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageCanvas=_interopRequireDefault(require("../ImageCanvas.js")),_Image=_interopRequireDefault(require("./Image.js")),_extent=require("../extent.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ImageCanvasSource=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,[{attributions:(t=t||{}).attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions,state:t.state}])).canvasFunction_=t.canvasFunction,r.canvas_=null,r.renderedRevision_=0,r.ratio_=void 0!==t.ratio?t.ratio:1.5,r}return _inherits(e,_Image["default"]),_createClass(e,[{key:"getImageInternal",value:function(t,e,r,o){e=this.findNearestResolution(e);var n=this.canvas_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==e&&n.getPixelRatio()==r&&(0,_extent.containsExtent)(n.getExtent(),t))return n;t=t.slice(),(0,_extent.scaleFromCenter)(t,this.ratio_);var i=[(0,_extent.getWidth)(t)/e*r,(0,_extent.getHeight)(t)/e*r],a=this.canvasFunction_.call(this,t,e,r,i,o);return a&&(n=new _ImageCanvas.default(t,e,r,a)),this.canvas_=n,this.renderedRevision_=this.getRevision(),n}}])}(),_default=exports.default=ImageCanvasSource;

},{"../ImageCanvas.js":85,"../extent.js":142,"./Image.js":346}],349:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Image=_interopRequireWildcard(require("./Image.js")),_mapguide=require("./mapguide.js"),_Image2=require("../Image.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&{}.hasOwnProperty.call(e,n)){var a=i?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(o,n,a):o[n]=e[n]}return o.default=e,r&&r.set(e,o),o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageMapGuide=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}])).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,r.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,r.params_=Object.assign({},e.params),r.url_=e.url,r.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:_Image.defaultImageLoadFunction,r.hidpi_=void 0===e.hidpi||e.hidpi,r.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,r.ratio_=void 0!==e.ratio?e.ratio:1,r.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,r.renderedRevision_=0,r.loaderProjection_=null,r}return _inherits(t,_Image["default"]),_createClass(t,[{key:"getParams",value:function(){return this.params_}},{key:"getImageInternal",value:function(e,r,o,i){var n=this;return void 0===this.url_?null:(this.loader&&this.loaderProjection_===i||(this.loaderProjection_=i,this.loader=(0,_mapguide.createLoader)({crossOrigin:this.crossOrigin_,params:this.params_,hidpi:this.hidpi_,metersPerUnit:this.metersPerUnit_,url:this.url_,useOverlay:this.useOverlay_,ratio:this.ratio_,load:function(e,t){return n.image.setImage(e),n.imageLoadFunction_(n.image,t),(0,_Image2.decode)(e)}})),_get(_getPrototypeOf(t.prototype),"getImageInternal",this).call(this,e,r,o,i))}},{key:"getImageLoadFunction",value:function(){return this.imageLoadFunction_}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.changed()}},{key:"setImageLoadFunction",value:function(e){this.imageLoadFunction_=e,this.changed()}},{key:"changed",value:function(){this.image=null,_get(_getPrototypeOf(t.prototype),"changed",this).call(this)}}])}(),_default=exports.default=ImageMapGuide;

},{"../Image.js":84,"./Image.js":346,"./mapguide.js":375}],350:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Image=_interopRequireWildcard(require("./Image.js")),_Image2=_interopRequireWildcard(require("../Image.js")),_static=require("./static.js"),_proj=require("../proj.js"),_extent=require("../extent.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Static=function(e){function t(e){var r;_classCallCheck(this,t);var n=void 0!==e.crossOrigin?e.crossOrigin:null,o=void 0!==e.imageLoadFunction?e.imageLoadFunction:_Image.defaultImageLoadFunction;return(r=_callSuper(this,t,[{attributions:e.attributions,interpolate:e.interpolate,projection:(0,_proj.get)(e.projection)}])).url_=e.url,r.imageExtent_=e.imageExtent,r.image=null,r.image=new _Image2.default(r.imageExtent_,void 0,1,(0,_static.createLoader)({url:e.url,imageExtent:e.imageExtent,crossOrigin:n,load:function(e,t){return r.image.setImage(e),o(r.image,t),(0,_Image2.decode)(e)}})),r.image.addEventListener(_EventType.default.CHANGE,r.handleImageChange.bind(r)),r}return _inherits(t,_Image["default"]),_createClass(t,[{key:"getImageExtent",value:function(){return this.imageExtent_}},{key:"getImageInternal",value:function(e,t,r,n){return(0,_extent.intersects)(e,this.image.getExtent())?this.image:null}},{key:"getUrl",value:function(){return this.url_}}])}(),_default=exports.default=Static;

},{"../Image.js":84,"../events/EventType.js":134,"../extent.js":142,"../proj.js":283,"./Image.js":346,"./static.js":377}],351:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Image=_interopRequireWildcard(require("./Image.js")),_reproj=require("../reproj.js"),_wms=require("./wms.js"),_Image2=require("../Image.js"),_proj=require("../proj.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageWMS=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:(e=e||{}).attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}])).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,r.url_=e.url,r.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:_Image.defaultImageLoadFunction,r.params_=Object.assign({},e.params),r.serverType_=e.serverType,r.hidpi_=void 0===e.hidpi||e.hidpi,r.renderedRevision_=0,r.ratio_=void 0!==e.ratio?e.ratio:1.5,r.loaderProjection_=null,r}return _inherits(t,_Image["default"]),_createClass(t,[{key:"getFeatureInfoUrl",value:function(e,t,r,o){var n=(0,_proj.get)(r),i=this.getProjection();i&&i!==n&&(t=(0,_reproj.calculateSourceResolution)(i,n,e,t),e=(0,_proj.transform)(e,n,i));var a={url:this.url_,params:_objectSpread(_objectSpread({},this.params_),o),projection:i||n};return(0,_wms.getFeatureInfoUrl)(a,e,t)}},{key:"getLegendUrl",value:function(e,t){return(0,_wms.getLegendUrl)({url:this.url_,params:_objectSpread(_objectSpread({},this.params_),t)},e)}},{key:"getParams",value:function(){return this.params_}},{key:"getImageInternal",value:function(e,r,o,n){var i=this;return void 0===this.url_?null:(this.loader&&this.loaderProjection_===n||(this.loaderProjection_=n,this.loader=(0,_wms.createLoader)({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:function(e,t){return i.image.setImage(e),i.imageLoadFunction_(i.image,t),(0,_Image2.decode)(e)}})),_get(_getPrototypeOf(t.prototype),"getImageInternal",this).call(this,e,r,o,n))}},{key:"getImageLoadFunction",value:function(){return this.imageLoadFunction_}},{key:"getUrl",value:function(){return this.url_}},{key:"setImageLoadFunction",value:function(e){this.imageLoadFunction_=e,this.changed()}},{key:"setUrl",value:function(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.changed()}},{key:"changed",value:function(){this.image=null,_get(_getPrototypeOf(t.prototype),"changed",this).call(this)}}])}(),_default=exports.default=ImageWMS;

},{"../Image.js":84,"../proj.js":283,"../reproj.js":328,"./Image.js":346,"./wms.js":378}],352:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_ogcTileUtil=require("./ogcTileUtil.js"),_console=require("../console.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var OGCMapTile=function(e){function t(e){var r;_classCallCheck(this,t),r=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}]);var o={url:e.url,projection:r.getProjection(),mediaType:e.mediaType,context:e.context||null,collections:e.collections};return(0,_ogcTileUtil.getTileSetInfo)(o).then(r.handleTileSetInfo_.bind(r)).catch(r.handleError_.bind(r)),r}return _inherits(t,_TileImage2["default"]),_createClass(t,[{key:"handleTileSetInfo_",value:function(e){this.tileGrid=e.grid,this.setTileUrlFunction(e.urlFunction,e.urlTemplate),this.setState("ready")}},{key:"handleError_",value:function(e){(0,_console.error)(e),this.setState("error")}}])}(),_default=exports.default=OGCMapTile;

},{"../console.js":115,"./TileImage.js":362,"./ogcTileUtil.js":376}],353:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _VectorTile=_interopRequireDefault(require("./VectorTile.js")),_ogcTileUtil=require("./ogcTileUtil.js"),_console=require("../console.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var OGCVectorTile=function(e){function t(e){var r;_classCallCheck(this,t),r=_callSuper(this,t,[{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,format:e.format,overlaps:e.overlaps,projection:e.projection,tileClass:e.tileClass,transition:e.transition,wrapX:e.wrapX,zDirection:e.zDirection,state:"loading"}]);var o={url:e.url,projection:r.getProjection(),mediaType:e.mediaType,supportedMediaTypes:e.format.supportedMediaTypes,context:e.context||null,collections:e.collections};return(0,_ogcTileUtil.getTileSetInfo)(o).then(r.handleTileSetInfo_.bind(r)).catch(r.handleError_.bind(r)),r}return _inherits(t,_VectorTile["default"]),_createClass(t,[{key:"handleTileSetInfo_",value:function(e){this.tileGrid=e.grid,this.setTileUrlFunction(e.urlFunction,e.urlTemplate),this.setState("ready")}},{key:"handleError_",value:function(e){(0,_console.error)(e),this.setState("error")}}])}(),_default=exports.default=OGCVectorTile;

},{"../console.js":115,"./VectorTile.js":369,"./ogcTileUtil.js":376}],354:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ATTRIBUTION=void 0;var _XYZ2=_interopRequireDefault(require("./XYZ.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ATTRIBUTION=exports.ATTRIBUTION='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',OSM=function(t){function e(t){var r;_classCallCheck(this,e),r=void 0!==(t=t||{}).attributions?t.attributions:[ATTRIBUTION];var o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";return _callSuper(this,e,[{attributions:r,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:o,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:n,wrapX:t.wrapX,zDirection:t.zDirection}])}return _inherits(e,_XYZ2["default"]),_createClass(e)}(),_default=exports.default=OSM;

},{"./XYZ.js":371}],355:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.RasterSourceEvent=exports.Processor=void 0,exports.newImageData=newImageData;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageCanvas=_interopRequireDefault(require("../ImageCanvas.js")),_Image=_interopRequireDefault(require("../layer/Image.js")),_Image2=_interopRequireDefault(require("./Image.js")),_Source=_interopRequireDefault(require("./Source.js")),_Tile=_interopRequireDefault(require("../layer/Tile.js")),_TileQueue=_interopRequireDefault(require("../TileQueue.js")),_Tile2=_interopRequireDefault(require("./Tile.js")),_dom=require("../dom.js"),_transform=require("../transform.js"),_extent=require("../extent.js"),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var context,hasImageData=!0;try{new ImageData(10,10)}catch(e){hasImageData=!1}function newImageData(e,t,r){if(hasImageData)return new ImageData(e,t,r);context||(context=document.createElement("canvas").getContext("2d"));var n=context.createImageData(t,r);return n.data.set(e),n}function createMinion(e){var t=!0;try{new ImageData(10,10)}catch(e){t=!1}function r(e,r,n){return t?new ImageData(e,r,n):{data:e,width:r,height:n}}return function(t){var n=t.buffers,a=t.meta,i=t.imageOps,o=t.width,s=t.height,u=n.length,l=n[0].byteLength;if(i){for(var c=new Array(u),f=0;f<u;++f)c[f]=r(new Uint8ClampedArray(n[f]),o,s);return e(c,a).data.buffer}for(var _=new Uint8ClampedArray(l),p=new Array(u),h=new Array(u),d=0;d<u;++d)p[d]=new Uint8ClampedArray(n[d]),h[d]=[0,0,0,0];for(var g=0;g<l;g+=4){for(var v=0;v<u;++v){var y=p[v];h[v][0]=y[g],h[v][1]=y[g+1],h[v][2]=y[g+2],h[v][3]=y[g+3]}var m=e(h,a);_[g]=m[0],_[g+1]=m[1],_[g+2]=m[2],_[g+3]=m[3]}return _.buffer}}function createWorker(e,t){var r=Object.keys(e.lib||{}).map(function(t){return"const "+t+" = "+e.lib[t].toString()+";"}).concat(["const __minion__ = ("+createMinion.toString()+")(",e.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),n=new Worker("undefined"==typeof Blob?"data:text/javascript;base64,"+Buffer.from(r.join("\n"),"binary").toString("base64"):URL.createObjectURL(new Blob(r,{type:"text/javascript"})));return n.addEventListener("message",t),n}function createFauxWorker(e,t){var r=createMinion(e.operation),n=!1;return{postMessage:function(e){setTimeout(function(){n||t({data:{buffer:r(e),meta:e.meta}})},0)},terminate:function(){n=!0}}}var Processor=exports.Processor=function(e){function t(e){var r,n;_classCallCheck(this,t),(r=_callSuper(this,t))._imageOps=!!e.imageOps,n=0===e.threads?0:r._imageOps?1:e.threads||1;var a=new Array(n);if(n)for(var i=0;i<n;++i)a[i]=createWorker(e,r._onWorkerMessage.bind(r,i));else a[0]=createFauxWorker(e,r._onWorkerMessage.bind(r,0));return r._workers=a,r._queue=[],r._maxQueueLength=e.queue||1/0,r._running=0,r._dataLookup={},r._job=null,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"process",value:function(e,t,r){this._enqueue({inputs:e,meta:t,callback:r}),this._dispatch()}},{key:"_enqueue",value:function(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)}},{key:"_dispatch",value:function(){if(!this._running&&0!==this._queue.length){var e=this._queue.shift();this._job=e;var t=e.inputs[0].width,r=e.inputs[0].height,n=e.inputs.map(function(e){return e.data.buffer}),a=this._workers.length;if(this._running=a,1!==a)for(var i=e.inputs[0].data.length,o=4*Math.ceil(i/4/a),s=0;s<a;++s){for(var u=s*o,l=[],c=0,f=n.length;c<f;++c)l.push(n[c].slice(u,u+o));this._workers[s].postMessage({buffers:l,meta:e.meta,imageOps:this._imageOps,width:t,height:r},l)}else this._workers[0].postMessage({buffers:n,meta:e.meta,imageOps:this._imageOps,width:t,height:r},n)}}},{key:"_onWorkerMessage",value:function(e,t){this.disposed||(this._dataLookup[e]=t.data,--this._running,0===this._running&&this._resolveJob())}},{key:"_resolveJob",value:function(){var e,t,r=this._job,n=this._workers.length;if(1===n)e=new Uint8ClampedArray(this._dataLookup[0].buffer),t=this._dataLookup[0].meta;else{var a=r.inputs[0].data.length;e=new Uint8ClampedArray(a),t=new Array(n);for(var i=4*Math.ceil(a/4/n),o=0;o<n;++o){var s=this._dataLookup[o].buffer,u=o*i;e.set(new Uint8ClampedArray(s),u),t[o]=this._dataLookup[o].meta}}this._job=null,this._dataLookup={},r.callback(null,newImageData(e,r.inputs[0].width,r.inputs[0].height),t),this._dispatch()}},{key:"disposeInternal",value:function(){for(var e=0;e<this._workers.length;++e)this._workers[e].terminate();this._workers.length=0}}])}(),RasterEventType={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"},RasterSourceEvent=exports.RasterSourceEvent=function(e){function t(e,r,n){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e])).extent=r.extent,a.resolution=r.viewState.resolution/r.pixelRatio,a.data=n,a}return _inherits(t,_Event2["default"]),_createClass(t)}(),RasterSource=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{projection:null}])).on,r.once,r.un,r.processor_=null,r.operationType_=void 0!==e.operationType?e.operationType:"pixel",r.threads_=void 0!==e.threads?e.threads:1,r.layers_=createLayers(e.sources);for(var n=r.changed.bind(r),a=0,i=r.layers_.length;a<i;++a)r.layers_[a].addEventListener(_EventType.default.CHANGE,n);return r.useResolutions_=null!==e.resolutions,r.tileQueue_=new _TileQueue.default(function(){return 1},r.processSources_.bind(r)),r.requestedFrameState_,r.renderedImageCanvas_=null,r.renderedRevision_,r.frameState_={animate:!1,coordinateToPixelTransform:(0,_transform.create)(),declutter:null,extent:null,index:0,layerIndex:0,layerStatesArray:getLayerStatesArray(r.layers_),pixelRatio:1,pixelToCoordinateTransform:(0,_transform.create)(),postRenderFunctions:[],size:[0,0],tileQueue:r.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:(0,_util.getUid)(r),renderTargets:{}},r.setAttributions(function(t){for(var r=[],n=0,a=e.sources.length;n<a;++n){var i=e.sources[n],o=i instanceof _Source.default?i:i.getSource();if(o){var s=o.getAttributions();if("function"==typeof s){var u=s(t);r.push.apply(r,u)}}}return 0!==r.length?r:null}),void 0!==e.operation&&r.setOperation(e.operation,e.lib),r}return _inherits(t,_Image2["default"]),_createClass(t,[{key:"setOperation",value:function(e,t){this.processor_&&this.processor_.dispose(),this.processor_=new Processor({operation:e,imageOps:"image"===this.operationType_,queue:1,lib:t,threads:this.threads_}),this.changed()}},{key:"updateFrameState_",value:function(e,t,r){var n=Object.assign({},this.frameState_);n.viewState=Object.assign({},n.viewState);var a=(0,_extent.getCenter)(e);n.size[0]=Math.ceil((0,_extent.getWidth)(e)/t),n.size[1]=Math.ceil((0,_extent.getHeight)(e)/t),n.extent=[a[0]-n.size[0]*t/2,a[1]-n.size[1]*t/2,a[0]+n.size[0]*t/2,a[1]+n.size[1]*t/2],n.time=Date.now();var i=n.viewState;return i.center=a,i.projection=r,i.resolution=t,n}},{key:"allSourcesReady_",value:function(){for(var e,t=!0,r=0,n=this.layers_.length;r<n;++r)if(!(e=this.layers_[r].getSource())||"ready"!==e.getState()){t=!1;break}return t}},{key:"getImage",value:function(e,t,r,n){if(!this.allSourcesReady_())return null;this.tileQueue_.loadMoreTiles(16,16),t=this.findNearestResolution(t);var a=this.updateFrameState_(e,t,n);if(this.requestedFrameState_=a,this.renderedImageCanvas_){var i=this.renderedImageCanvas_.getResolution(),o=this.renderedImageCanvas_.getExtent();t===i&&(0,_extent.equals)(a.extent,o)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),a.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}},{key:"processSources_",value:function(){for(var e=this.requestedFrameState_,t=this.layers_.length,r=new Array(t),n=0;n<t;++n){e.layerIndex=n,e.renderTargets={};var a=getImageData(this.layers_[n],e);if(!a)return;r[n]=a}var i={};this.dispatchEvent(new RasterSourceEvent(RasterEventType.BEFOREOPERATIONS,e,i)),this.processor_.process(r,i,this.onWorkerComplete_.bind(this,e))}},{key:"onWorkerComplete_",value:function(e,t,r,n){if(!t&&r){var a=e.extent,i=e.viewState.resolution;if(i===this.requestedFrameState_.viewState.resolution&&(0,_extent.equals)(a,this.requestedFrameState_.extent)){var o;if(this.renderedImageCanvas_)o=this.renderedImageCanvas_.getImage().getContext("2d");else{var s=Math.round((0,_extent.getWidth)(a)/i),u=Math.round((0,_extent.getHeight)(a)/i);o=(0,_dom.createCanvasContext2D)(s,u),this.renderedImageCanvas_=new _ImageCanvas.default(a,i,1,o.canvas)}o.putImageData(r,0,0),e.animate?requestAnimationFrame(this.changed.bind(this)):this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new RasterSourceEvent(RasterEventType.AFTEROPERATIONS,e,n))}}}},{key:"getResolutions",value:function(e){if(!this.useResolutions_)return null;var r=_get(_getPrototypeOf(t.prototype),"getResolutions",this).call(this);if(!r)for(var n=0,a=this.layers_.length;n<a;++n){if(r=this.layers_[n].getSource().getResolutions(e))break}return r}},{key:"disposeInternal",value:function(){this.processor_&&this.processor_.dispose(),_get(_getPrototypeOf(t.prototype),"disposeInternal",this).call(this)}}])}();RasterSource.prototype.dispose;var sharedContext=null;function getImageData(e,t){var r=e.getRenderer();if(!r)throw new Error("Unsupported layer type: "+e);if(!r.prepareFrame(t))return null;var n=t.size[0],a=t.size[1];if(0===n||0===a)return null;var i,o=r.renderFrame(t,null);if(o instanceof HTMLCanvasElement)i=o;else{if(o&&(i=o.firstElementChild),!(i instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+i);if(i.width===n&&i.height===a)return i.getContext("2d").getImageData(0,0,n,a)}if(sharedContext){var s=sharedContext.canvas;s.width!==n||s.height!==a?sharedContext=(0,_dom.createCanvasContext2D)(n,a,void 0,{willReadFrequently:!0}):sharedContext.clearRect(0,0,n,a)}else sharedContext=(0,_dom.createCanvasContext2D)(n,a,void 0,{willReadFrequently:!0});return sharedContext.drawImage(i,0,0,n,a),sharedContext.getImageData(0,0,n,a)}function getLayerStatesArray(e){return e.map(function(e){return e.getLayerState()})}function createLayers(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=createLayer(e[n]);return r}function createLayer(e){var t;return e instanceof _Source.default?e instanceof _Tile2.default?t=new _Tile.default({source:e}):e instanceof _Image2.default&&(t=new _Image.default({source:e})):t=e,t}var _default=exports.default=RasterSource;

}).call(this)}).call(this,require("buffer").Buffer)
},{"../Disposable.js":81,"../ImageCanvas.js":85,"../TileQueue.js":102,"../dom.js":130,"../events/Event.js":133,"../events/EventType.js":134,"../extent.js":142,"../layer/Image.js":268,"../layer/Tile.js":271,"../transform.js":402,"../util.js":404,"./Image.js":346,"./Source.js":356,"./Tile.js":358,"buffer":9}],356:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_proj=require("../proj.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Source=function(t){function e(t){var r;_classCallCheck(this,e),(r=_callSuper(this,e)).projection=(0,_proj.get)(t.projection),r.attributions_=adaptAttributions(t.attributions),r.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,r.loading=!1,r.state_=void 0!==t.state?t.state:"ready",r.wrapX_=void 0!==t.wrapX&&t.wrapX,r.interpolate_=!!t.interpolate,r.viewResolver=null,r.viewRejector=null;var o=r;return r.viewPromise_=new Promise(function(t,e){o.viewResolver=t,o.viewRejector=e}),r}return _inherits(e,_Object["default"]),_createClass(e,[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(t){return null}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=adaptAttributions(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])}();function adaptAttributions(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var _default=exports.default=Source;

},{"../Object.js":96,"../proj.js":283}],357:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _XYZ2=_interopRequireDefault(require("./XYZ.js")),_OSM=require("./OSM.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,o){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,o||[],_getPrototypeOf(e).constructor):t.apply(e,o))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var STADIA_ATTRIBUTION='&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>',OMT_ATTRIBUTION='&copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>',STAMEN_ATTRIBUTION='&copy; <a href="https://stamen.com/" target="_blank">Stamen Design</a>',LayerConfig={stamen_terrain:{extension:"png",opaque:!0},stamen_terrain_background:{extension:"png",opaque:!0},stamen_terrain_labels:{extension:"png",opaque:!1},stamen_terrain_lines:{extension:"png",opaque:!1},stamen_toner_background:{extension:"png",opaque:!0},stamen_toner:{extension:"png",opaque:!0},stamen_toner_labels:{extension:"png",opaque:!1},stamen_toner_lines:{extension:"png",opaque:!1},stamen_toner_lite:{extension:"png",opaque:!0},stamen_watercolor:{extension:"jpg",opaque:!0},alidade_smooth:{extension:"png",opaque:!0},alidade_smooth_dark:{extension:"png",opaque:!0},alidade_satellite:{extension:"png",opaque:!0},outdoors:{extension:"png",opaque:!0},osm_bright:{extension:"png",opaque:!0}},ProviderConfig={stamen_terrain:{minZoom:0,maxZoom:18,retina:!0},stamen_toner:{minZoom:0,maxZoom:20,retina:!0},stamen_watercolor:{minZoom:1,maxZoom:18,retina:!1}},StadiaMaps=function(e){function t(e){_classCallCheck(this,t);var o=e.layer.indexOf("-"),r=-1==o?e.layer:e.layer.slice(0,o),n=ProviderConfig[r]||{minZoom:0,maxZoom:20,retina:!0},i=LayerConfig[e.layer],a=e.apiKey?"?api_key="+e.apiKey:"",s=n.retina&&e.retina?"@2x":"",p=void 0!==e.url?e.url:"https://tiles.stadiamaps.com/tiles/"+e.layer+"/{z}/{x}/{y}"+s+"."+i.extension+a,u=[STADIA_ATTRIBUTION,OMT_ATTRIBUTION,_OSM.ATTRIBUTION];return e.layer.startsWith("stamen_")&&u.splice(1,0,STAMEN_ATTRIBUTION),_callSuper(this,t,[{attributions:u,cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,maxZoom:void 0!==e.maxZoom?e.maxZoom:n.maxZoom,minZoom:void 0!==e.minZoom?e.minZoom:n.minZoom,opaque:i.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:p,tilePixelRatio:s?2:1,wrapX:e.wrapX,zDirection:e.zDirection}])}return _inherits(t,_XYZ2["default"]),_createClass(t)}(),_default=exports.default=StadiaMaps;

},{"./OSM.js":354,"./XYZ.js":371}],358:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TileSourceEvent=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js")),_Source2=_interopRequireDefault(require("./Source.js")),_TileCache=_interopRequireDefault(require("../TileCache.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_util=require("../util.js"),_asserts=require("../asserts.js"),_proj=require("../proj.js"),_tilecoord=require("../tilecoord.js"),_tilegrid=require("../tilegrid.js"),_size=require("../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileSource=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}])).on,r.once,r.un,r.opaque_=void 0!==e.opaque&&e.opaque,r.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,r.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;return r.tileGrid&&(0,_size.toSize)(r.tileGrid.getTileSize(r.tileGrid.getMinZoom()),[256,256]),r.tileCache=new _TileCache.default(e.cacheSize||0),r.tmpSize=[0,0],r.key_=e.key||"",r.tileOptions={transition:e.transition,interpolate:e.interpolate},r.zDirection=e.zDirection?e.zDirection:0,r}return _inherits(t,_Source2["default"]),_createClass(t,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(e,t){var r=this.getTileCacheForProjection(e);r&&r.expireCache(t)}},{key:"forEachLoadedTile",value:function(e,t,r,i){var o=this.getTileCacheForProjection(e);if(!o)return!1;for(var n,l,u,a=!0,c=r.minX;c<=r.maxX;++c)for(var s=r.minY;s<=r.maxY;++s)l=(0,_tilecoord.getKeyZXY)(t,c,s),u=!1,o.containsKey(l)&&(u=(n=o.get(l)).getState()===_TileState.default.LOADED)&&(u=!1!==i(n)),u||(a=!1);return a}},{key:"getGutterForProjection",value:function(e){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(e){this.key_!==e&&(this.key_=e,this.changed())}},{key:"getOpaque",value:function(e){return this.opaque_}},{key:"getResolutions",value:function(e){var t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}},{key:"getTile",value:function(e,t,r,i,o){return(0,_util.abstract)()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(e){return this.tileGrid?this.tileGrid:(0,_tilegrid.getForProjection)(e)}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();return(0,_asserts.assert)(null===t||(0,_proj.equivalent)(t,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}},{key:"getTilePixelRatio",value:function(e){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(e,t,r){var i=this.getTileGridForProjection(r),o=this.getTilePixelRatio(t),n=(0,_size.toSize)(i.getTileSize(e),this.tmpSize);return 1==o?n:(0,_size.scale)(n,o,this.tmpSize)}},{key:"getTileCoordForTileUrlFunction",value:function(e,t){t=void 0!==t?t:this.getProjection();var r=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=(0,_tilegrid.wrapX)(r,e,t)),(0,_tilecoord.withinExtentAndZ)(e,r)?e:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),_get(_getPrototypeOf(t.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(e,t){var r=this.getTileCacheForProjection(t);e>r.highWaterMark&&(r.highWaterMark=e)}},{key:"useTile",value:function(e,t,r,i){}}])}(),TileSourceEvent=exports.TileSourceEvent=function(e){function t(e,r){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).tile=r,i}return _inherits(t,_Event2["default"]),_createClass(t)}(),_default=exports.default=TileSource;

},{"../TileCache.js":101,"../TileState.js":104,"../asserts.js":111,"../events/Event.js":133,"../proj.js":283,"../size.js":337,"../tilecoord.js":396,"../tilegrid.js":397,"../util.js":404,"./Source.js":356}],359:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_extent=require("../extent.js"),_arcgisRest=require("./arcgisRest.js"),_math=require("../math.js"),_size=require("../size.js"),_tilecoord=require("../tilecoord.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileArcGISRest=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:(e=e||{}).attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}])).params_=Object.assign({},e.params),r.hidpi_=void 0===e.hidpi||e.hidpi,r.tmpExtent_=(0,_extent.createEmpty)(),r.setKey(r.getKeyForParams_()),r}return _inherits(t,_TileImage2["default"]),_createClass(t,[{key:"getKeyForParams_",value:function(){var e=0,t=[];for(var r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}},{key:"getParams",value:function(){return this.params_}},{key:"getRequestUrl_",value:function(e,t,r,i,o,n){var s=this.urls;if(s){var a;if(1==s.length)a=s[0];else a=s[(0,_math.modulo)((0,_tilecoord.hash)(e),s.length)];return(0,_arcgisRest.getRequestUrl)(a,r,(this.tileGrid||this.getTileGridForProjection(o)).getResolution(e[0]),i,o,n)}}},{key:"getTilePixelRatio",value:function(e){return this.hidpi_?e:1}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.setKey(this.getKeyForParams_())}},{key:"tileUrlFunction",value:function(e,t,r){var i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),!(i.getResolutions().length<=e[0])){1==t||this.hidpi_||(t=1);var o=i.getTileCoordExtent(e,this.tmpExtent_),n=(0,_size.toSize)(i.getTileSize(e[0]),this.tmpSize);1!=t&&(n=(0,_size.scale)(n,t,this.tmpSize));var s={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(s,this.params_),this.getRequestUrl_(e,n,o,t,r,s)}}}])}(),_default=exports.default=TileArcGISRest;

},{"../extent.js":142,"../math.js":279,"../size.js":337,"../tilecoord.js":396,"./TileImage.js":362,"./arcgisRest.js":373}],360:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _XYZ2=_interopRequireDefault(require("./XYZ.js")),_dom=require("../dom.js"),_size=require("../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileDebug=function(e){function t(e){var r;return _classCallCheck(this,t),r=_callSuper(this,t,[{opaque:!1,projection:(e=e||{}).projection,tileGrid:e.tileGrid,wrapX:void 0===e.wrapX||e.wrapX,zDirection:e.zDirection,url:e.template||"z:{z} x:{x} y:{y}",tileLoadFunction:function(e,t){var o=e.getTileCoord()[0],n=(0,_size.toSize)(r.tileGrid.getTileSize(o)),i=(0,_dom.createCanvasContext2D)(n[0],n[1]);i.strokeStyle="grey",i.strokeRect(.5,.5,n[0]+.5,n[1]+.5),i.fillStyle="grey",i.strokeStyle="white",i.textAlign="center",i.textBaseline="middle",i.font="24px sans-serif",i.lineWidth=4,i.strokeText(t,n[0]/2,n[1]/2,n[0]),i.fillText(t,n[0]/2,n[1]/2,n[0]),e.setImage(i.canvas)}}])}return _inherits(t,_XYZ2["default"]),_createClass(t)}(),_default=exports.default=TileDebug;

},{"../dom.js":130,"../size.js":337,"./XYZ.js":371}],361:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};

},{}],362:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageTile=_interopRequireDefault(require("../ImageTile.js")),_Tile=_interopRequireDefault(require("../reproj/Tile.js")),_TileCache=_interopRequireDefault(require("../TileCache.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_UrlTile2=_interopRequireDefault(require("./UrlTile.js")),_proj=require("../proj.js"),_tilecoord=require("../tilecoord.js"),_tilegrid=require("../tilegrid.js"),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=_superPropBase(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:i):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileImage=function(e){function t(e){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:void 0===e.interpolate||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}])).crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,i.tileClass=void 0!==e.tileClass?e.tileClass:_ImageTile.default,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return _inherits(t,_UrlTile2["default"]),_createClass(t,[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(e,t){var i=this.getTileCacheForProjection(e);for(var r in this.tileCache.expireCache(this.tileCache==i?t:{}),this.tileCacheForProjection){var o=this.tileCacheForProjection[r];o.expireCache(o==i?t:{})}}},{key:"getGutterForProjection",value:function(e){return this.getProjection()&&e&&!(0,_proj.equivalent)(this.getProjection(),e)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var e=_get(_getPrototypeOf(t.prototype),"getKey",this).call(this);return this.getInterpolate()||(e+=":disable-interpolation"),e}},{key:"getOpaque",value:function(e){return!(this.getProjection()&&e&&!(0,_proj.equivalent)(this.getProjection(),e))&&_get(_getPrototypeOf(t.prototype),"getOpaque",this).call(this,e)}},{key:"getTileGridForProjection",value:function(e){var t=this.getProjection();if(this.tileGrid&&(!t||(0,_proj.equivalent)(t,e)))return this.tileGrid;var i=(0,_util.getUid)(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=(0,_tilegrid.getForProjection)(e)),this.tileGridForProjection[i]}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();if(!t||(0,_proj.equivalent)(t,e))return this.tileCache;var i=(0,_util.getUid)(e);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new _TileCache.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}},{key:"createTile_",value:function(e,t,i,r,o,n){var l=[e,t,i],a=this.getTileCoordForTileUrlFunction(l,o),c=a?this.tileUrlFunction(a,r,o):void 0,u=new this.tileClass(l,void 0!==c?_TileState.default.IDLE:_TileState.default.EMPTY,void 0!==c?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=n,u.addEventListener(_EventType.default.CHANGE,this.handleTileChange.bind(this)),u}},{key:"getTile",value:function(e,t,i,r,o){var n=this,l=this.getProjection();if(!l||!o||(0,_proj.equivalent)(l,o))return this.getTileInternal(e,t,i,r,l||o);var a,c=this.getTileCacheForProjection(o),u=[e,t,i],s=(0,_tilecoord.getKey)(u);c.containsKey(s)&&(a=c.get(s));var f=this.getKey();if(a&&a.key==f)return a;var h=this.getTileGridForProjection(l),p=this.getTileGridForProjection(o),_=this.getTileCoordForTileUrlFunction(u,o),y=new _Tile.default(l,h,o,p,u,_,this.getTilePixelRatio(r),this.getGutter(),function(e,t,i,r){return n.getTileInternal(e,t,i,r,l)},this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=f,a?(y.interimTile=a,y.refreshInterimChain(),c.replace(s,y)):c.set(s,y),y}},{key:"getTileInternal",value:function(e,t,i,r,o){var n=null,l=(0,_tilecoord.getKeyZXY)(e,t,i),a=this.getKey();if(this.tileCache.containsKey(l)){if((n=this.tileCache.get(l)).key!=a){var c=n;n=this.createTile_(e,t,i,r,o,a),c.getState()==_TileState.default.IDLE?n.interimTile=c.interimTile:n.interimTile=c,n.refreshInterimChain(),this.tileCache.replace(l,n)}}else n=this.createTile_(e,t,i,r,o,a),this.tileCache.set(l,n);return n}},{key:"setRenderReprojectionEdges",value:function(e){if(this.renderReprojectionEdges_!=e){for(var t in this.renderReprojectionEdges_=e,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(e,t){var i=(0,_proj.get)(e);if(i){var r=(0,_util.getUid)(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}},{key:"clear",value:function(){for(var e in _get(_getPrototypeOf(t.prototype),"clear",this).call(this),this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}])}();function defaultTileLoadFunction(e,t){e.getImage().src=t}var _default=exports.default=TileImage;

},{"../ImageTile.js":87,"../TileCache.js":101,"../TileState.js":104,"../events/EventType.js":134,"../proj.js":283,"../reproj/Tile.js":331,"../tilecoord.js":396,"../tilegrid.js":397,"../util.js":404,"./UrlTile.js":366}],363:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_extent=require("../extent.js"),_tileurlfunction=require("../tileurlfunction.js"),_tilegrid=require("../tilegrid.js"),_proj=require("../proj.js"),_net=require("../net.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileJSON=function(e){function t(e){var r;if(_classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:(0,_proj.get)("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}])).tileJSON_=null,r.tileSize_=e.tileSize,e.url)if(e.jsonp)(0,_net.jsonp)(e.url,r.handleTileJSONResponse.bind(r),r.handleTileJSONError.bind(r));else{var o=new XMLHttpRequest;o.addEventListener("load",r.onXHRLoad_.bind(r)),o.addEventListener("error",r.onXHRError_.bind(r)),o.open("GET",e.url),o.send()}else{if(!e.tileJSON)throw new Error("Either `url` or `tileJSON` options must be provided");r.handleTileJSONResponse(e.tileJSON)}return r}return _inherits(t,_TileImage2["default"]),_createClass(t,[{key:"onXHRLoad_",value:function(e){var t=e.target;if(!t.status||t.status>=200&&t.status<300){var r;try{r=JSON.parse(t.responseText)}catch(e){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}},{key:"onXHRError_",value:function(e){this.handleTileJSONError()}},{key:"getTileJSON",value:function(){return this.tileJSON_}},{key:"handleTileJSONResponse",value:function(e){var t,r=(0,_proj.get)("EPSG:4326"),o=this.getProjection();if(void 0!==e.bounds){var i=(0,_proj.getTransformFromProjections)(r,o);t=(0,_extent.applyTransform)(e.bounds,i)}var n=(0,_tilegrid.extentFromProjection)(o),l=e.minzoom||0,s=e.maxzoom||22,u=(0,_tilegrid.createXYZ)({extent:n,maxZoom:s,minZoom:l,tileSize:this.tileSize_});if(this.tileGrid=u,this.tileUrlFunction=(0,_tileurlfunction.createFromTemplates)(e.tiles,u),e.attribution&&!this.getAttributions()){var a=void 0!==t?t:n;this.setAttributions(function(t){return(0,_extent.intersects)(a,t.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}},{key:"handleTileJSONError",value:function(){this.setState("error")}}])}(),_default=exports.default=TileJSON;

},{"../extent.js":142,"../net.js":280,"../proj.js":283,"../tilegrid.js":397,"../tileurlfunction.js":401,"./TileImage.js":362}],364:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_wms=require("./wms.js"),_uri=require("../uri.js"),_extent=require("../extent.js"),_reproj=require("../reproj.js"),_string=require("../string.js"),_proj=require("../proj.js"),_math=require("../math.js"),_tilecoord=require("../tilecoord.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileWMS=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var i=Object.assign({},e.params),o=!("TRANSPARENT"in i)||i.TRANSPARENT;return(r=_callSuper(this,t,[{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:!o,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}])).gutter_=void 0!==e.gutter?e.gutter:0,r.params_=i,r.v13_=!0,r.serverType_=e.serverType,r.hidpi_=void 0===e.hidpi||e.hidpi,r.tmpExtent_=(0,_extent.createEmpty)(),r.updateV13_(),r.setKey(r.getKeyForParams_()),r}return _inherits(t,_TileImage2["default"]),_createClass(t,[{key:"getFeatureInfoUrl",value:function(e,t,r,i){var o=(0,_proj.get)(r),n=this.getProjection()||o,s=this.getTileGrid();s||(s=this.getTileGridForProjection(n));var a=(0,_proj.transform)(e,o,n),u=(0,_reproj.calculateSourceResolution)(n,o,e,t),l=s.getZForResolution(u,this.zDirection),c=s.getResolution(l),p=s.getTileCoordForCoordAndZ(a,l);if(!(s.getResolutions().length<=p[0])){var f=s.getTileCoordExtent(p,this.tmpExtent_),_=this.gutter_;0!==_&&(f=(0,_extent.buffer)(f,c*_,f));var h={QUERY_LAYERS:this.params_.LAYERS};Object.assign(h,(0,_wms.getRequestParams)(this.params_,"GetFeatureInfo"),i);var y=Math.floor((a[0]-f[0])/c),g=Math.floor((f[3]-a[1])/c);return h[this.v13_?"I":"X"]=y,h[this.v13_?"J":"Y"]=g,this.getRequestUrl_(p,f,1,n||o,h)}}},{key:"getLegendUrl",value:function(e,t){if(void 0!==this.urls[0]){var r={SERVICE:"WMS",VERSION:_wms.DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){var i=this.params_.LAYERS;if(!(!Array.isArray(i)||1===i.length))return;r.LAYER=i}if(void 0!==e){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=e*o/28e-5}return Object.assign(r,t),(0,_uri.appendParams)(this.urls[0],r)}}},{key:"getGutter",value:function(){return this.gutter_}},{key:"getParams",value:function(){return this.params_}},{key:"getRequestUrl_",value:function(e,t,r,i,o){var n=this.urls;if(n){var s;if(1==n.length)s=n[0];else s=n[(0,_math.modulo)((0,_tilecoord.hash)(e),n.length)];return(0,_wms.getImageSrc)(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,s,o,this.serverType_)}}},{key:"getTilePixelRatio",value:function(e){return this.hidpi_&&void 0!==this.serverType_?e:1}},{key:"getKeyForParams_",value:function(){var e=0,t=[];for(var r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())}},{key:"updateV13_",value:function(){var e=this.params_.VERSION||_wms.DEFAULT_VERSION;this.v13_=(0,_string.compareVersions)(e,"1.3")>=0}},{key:"tileUrlFunction",value:function(e,t,r){var i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),!(i.getResolutions().length<=e[0])){1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);var o=i.getResolution(e[0]),n=i.getTileCoordExtent(e,this.tmpExtent_),s=this.gutter_;0!==s&&(n=(0,_extent.buffer)(n,o*s,n));var a=Object.assign({},(0,_wms.getRequestParams)(this.params_,"GetMap"));return this.getRequestUrl_(e,n,t,r,a)}}}])}(),_default=exports.default=TileWMS;

},{"../extent.js":142,"../math.js":279,"../proj.js":283,"../reproj.js":328,"../string.js":380,"../tilecoord.js":396,"../uri.js":403,"./TileImage.js":362,"./wms.js":378}],365:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.CustomTile=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Tile2=_interopRequireDefault(require("../Tile.js")),_Tile3=_interopRequireDefault(require("./Tile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_extent=require("../extent.js"),_tileurlfunction=require("../tileurlfunction.js"),_tilegrid=require("../tilegrid.js"),_tilecoord=require("../tilecoord.js"),_proj=require("../proj.js"),_events=require("../events.js"),_net=require("../net.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CustomTile=exports.CustomTile=function(e){function t(e,r,i,n,o,s){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,r])).src_=i,a.extent_=n,a.preemptive_=o,a.grid_=null,a.keys_=null,a.data_=null,a.jsonp_=s,a}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getImage",value:function(){return null}},{key:"getData",value:function(e){if(!this.grid_||!this.keys_)return null;var t=(e[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),r=(e[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),i=this.grid_[Math.floor((1-r)*this.grid_.length)];if("string"!=typeof i)return null;var n=i.charCodeAt(Math.floor(t*i.length));n>=93&&n--,n>=35&&n--;var o=null;if((n-=32)in this.keys_){var s=this.keys_[n];o=this.data_&&s in this.data_?this.data_[s]:s}return o}},{key:"forDataAtCoordinate",value:function(e,t,r){var i=this;this.state==_TileState.default.EMPTY&&!0===r?(this.state=_TileState.default.IDLE,(0,_events.listenOnce)(this,_EventType.default.CHANGE,function(r){t(this.getData(e))},this),this.loadInternal_()):!0===r?setTimeout(function(){t(i.getData(e))},0):t(this.getData(e))}},{key:"getKey",value:function(){return this.src_}},{key:"handleError_",value:function(){this.state=_TileState.default.ERROR,this.changed()}},{key:"handleLoad_",value:function(e){this.grid_=e.grid,this.keys_=e.keys,this.data_=e.data,this.state=_TileState.default.LOADED,this.changed()}},{key:"loadInternal_",value:function(){if(this.state==_TileState.default.IDLE)if(this.state=_TileState.default.LOADING,this.jsonp_)(0,_net.jsonp)(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",this.src_),e.send()}}},{key:"onXHRLoad_",value:function(e){var t=e.target;if(!t.status||t.status>=200&&t.status<300){var r;try{r=JSON.parse(t.responseText)}catch(e){return void this.handleError_()}this.handleLoad_(r)}else this.handleError_()}},{key:"onXHRError_",value:function(e){this.handleError_()}},{key:"load",value:function(){this.preemptive_?this.loadInternal_():this.setState(_TileState.default.EMPTY)}}])}(),UTFGrid=function(e){function t(e){var r;if(_classCallCheck(this,t),(r=_callSuper(this,t,[{projection:(0,_proj.get)("EPSG:3857"),state:"loading",wrapX:void 0===e.wrapX||e.wrapX,zDirection:e.zDirection}])).preemptive_=void 0===e.preemptive||e.preemptive,r.tileUrlFunction_=_tileurlfunction.nullTileUrlFunction,r.template_=void 0,r.jsonp_=e.jsonp||!1,e.url)if(r.jsonp_)(0,_net.jsonp)(e.url,r.handleTileJSONResponse.bind(r),r.handleTileJSONError.bind(r));else{var i=new XMLHttpRequest;i.addEventListener("load",r.onXHRLoad_.bind(r)),i.addEventListener("error",r.onXHRError_.bind(r)),i.open("GET",e.url),i.send()}else{if(!e.tileJSON)throw new Error("Either `url` or `tileJSON` options must be provided");r.handleTileJSONResponse(e.tileJSON)}return r}return _inherits(t,_Tile3["default"]),_createClass(t,[{key:"onXHRLoad_",value:function(e){var t=e.target;if(!t.status||t.status>=200&&t.status<300){var r;try{r=JSON.parse(t.responseText)}catch(e){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}},{key:"onXHRError_",value:function(e){this.handleTileJSONError()}},{key:"getTemplate",value:function(){return this.template_}},{key:"forDataAtCoordinateAndResolution",value:function(e,t,r,i){if(this.tileGrid){var n=this.tileGrid.getZForResolution(t,this.zDirection),o=this.tileGrid.getTileCoordForCoordAndZ(e,n);this.getTile(o[0],o[1],o[2],1,this.getProjection()).forDataAtCoordinate(e,r,i)}else!0===i?setTimeout(function(){r(null)},0):r(null)}},{key:"handleTileJSONError",value:function(){this.setState("error")}},{key:"handleTileJSONResponse",value:function(e){var t,r=(0,_proj.get)("EPSG:4326"),i=this.getProjection();if(void 0!==e.bounds){var n=(0,_proj.getTransformFromProjections)(r,i);t=(0,_extent.applyTransform)(e.bounds,n)}var o=(0,_tilegrid.extentFromProjection)(i),s=e.minzoom||0,a=e.maxzoom||22,l=(0,_tilegrid.createXYZ)({extent:o,maxZoom:a,minZoom:s});this.tileGrid=l,this.template_=e.template;var u=e.grids;if(u){if(this.tileUrlFunction_=(0,_tileurlfunction.createFromTemplates)(u,l),e.attribution){var c=void 0!==t?t:o;this.setAttributions(function(t){return(0,_extent.intersects)(c,t.extent)?[e.attribution]:null})}this.setState("ready")}else this.setState("error")}},{key:"getTile",value:function(e,t,r,i,n){var o=(0,_tilecoord.getKeyZXY)(e,t,r);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var s=[e,t,r],a=this.getTileCoordForTileUrlFunction(s,n),l=this.tileUrlFunction_(a,i,n),u=new CustomTile(s,void 0!==l?_TileState.default.IDLE:_TileState.default.EMPTY,void 0!==l?l:"",this.tileGrid.getTileCoordExtent(s),this.preemptive_,this.jsonp_);return this.tileCache.set(o,u),u}},{key:"useTile",value:function(e,t,r){var i=(0,_tilecoord.getKeyZXY)(e,t,r);this.tileCache.containsKey(i)&&this.tileCache.get(i)}}])}(),_default=exports.default=UTFGrid;

},{"../Tile.js":100,"../TileState.js":104,"../events.js":132,"../events/EventType.js":134,"../extent.js":142,"../net.js":280,"../proj.js":283,"../tilecoord.js":396,"../tilegrid.js":397,"../tileurlfunction.js":401,"./Tile.js":358}],366:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileEventType=_interopRequireDefault(require("./TileEventType.js")),_Tile=_interopRequireWildcard(require("./Tile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_tileurlfunction=require("../tileurlfunction.js"),_tilecoord=require("../tilecoord.js"),_util=require("../util.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(e){return e?i:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var i=_getRequireWildcardCache(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=n?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,i&&i.set(e,r),r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var UrlTile=function(e){function t(e){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}])).generateTileUrlFunction_=i.tileUrlFunction===t.prototype.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(i.tileUrlFunction=e.tileUrlFunction),i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return _inherits(t,_Tile["default"]),_createClass(t,[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(e){var t,i=e.target,r=(0,_util.getUid)(i),n=i.getState();n==_TileState.default.LOADING?(this.tileLoadingKeys_[r]=!0,t=_TileEventType.default.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],t=n==_TileState.default.ERROR?_TileEventType.default.TILELOADERROR:n==_TileState.default.LOADED?_TileEventType.default.TILELOADEND:void 0),null!=t&&this.dispatchEvent(new _Tile.TileSourceEvent(t,i))}},{key:"setTileLoadFunction",value:function(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}},{key:"setTileUrlFunction",value:function(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),void 0!==t?this.setKey(t):this.changed()}},{key:"setUrl",value:function(e){var t=(0,_tileurlfunction.expandUrl)(e);this.urls=t,this.setUrls(t)}},{key:"setUrls",value:function(e){this.urls=e;var t=e.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction((0,_tileurlfunction.createFromTemplates)(e,this.tileGrid),t):this.setKey(t)}},{key:"tileUrlFunction",value:function(e,t,i){}},{key:"useTile",value:function(e,t,i){var r=(0,_tilecoord.getKeyZXY)(e,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}])}(),_default=exports.default=UrlTile;

},{"../TileState.js":104,"../tilecoord.js":396,"../tileurlfunction.js":401,"../util.js":404,"./Tile.js":358,"./TileEventType.js":361}],367:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.VectorSourceEvent=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_RBush=_interopRequireDefault(require("../structs/RBush.js")),_Feature=_interopRequireDefault(require("../render/Feature.js")),_Source2=_interopRequireDefault(require("./Source.js")),_VectorEventType=_interopRequireDefault(require("./VectorEventType.js")),_functions=require("../functions.js"),_loadingstrategy=require("../loadingstrategy.js"),_asserts=require("../asserts.js"),_extent=require("../extent.js"),_array=require("../array.js"),_util=require("../util.js"),_obj=require("../obj.js"),_events=require("../events.js"),_featureloader=require("../featureloader.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorSourceEvent=exports.VectorSourceEvent=function(e){function t(e,r,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).feature=r,i.features=n,i}return _inherits(t,_Event2["default"]),_createClass(t)}(),VectorSource=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:(e=e||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===e.wrapX||e.wrapX}])).on,r.once,r.un,r.loader_=_functions.VOID,r.format_=e.format,r.overlaps_=void 0===e.overlaps||e.overlaps,r.url_=e.url,void 0!==e.loader?r.loader_=e.loader:void 0!==r.url_&&((0,_asserts.assert)(r.format_,"`format` must be set when `url` is set"),r.loader_=(0,_featureloader.xhr)(r.url_,r.format_)),r.strategy_=void 0!==e.strategy?e.strategy:_loadingstrategy.all;var n,i,a=void 0===e.useSpatialIndex||e.useSpatialIndex;return r.featuresRtree_=a?new _RBush.default:null,r.loadedExtentsRtree_=new _RBush.default,r.loadingExtentsCount_=0,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(e.features)?i=e.features:e.features&&(i=(n=e.features).getArray()),a||void 0!==n||(n=new _Collection.default(i)),void 0!==i&&r.addFeaturesInternal(i),void 0!==n&&r.bindFeaturesCollection_(n),r}return _inherits(t,_Source2["default"]),_createClass(t,[{key:"addFeature",value:function(e){this.addFeatureInternal(e),this.changed()}},{key:"addFeatureInternal",value:function(e){var t=(0,_util.getUid)(e);if(this.addToIndex_(t,e)){this.setupChangeEvents_(t,e);var r=e.getGeometry();if(r){var n=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.ADDFEATURE,e))}else this.featuresCollection_&&this.featuresCollection_.remove(e)}},{key:"setupChangeEvents_",value:function(e,t){t instanceof _Feature.default||(this.featureChangeKeys_[e]=[(0,_events.listen)(t,_EventType.default.CHANGE,this.handleFeatureChange_,this),(0,_events.listen)(t,_ObjectEventType.default.PROPERTYCHANGE,this.handleFeatureChange_,this)])}},{key:"addToIndex_",value:function(e,t){var r=!0;if(void 0!==t.getId()){var n=String(t.getId());if(n in this.idIndex_)if(t instanceof _Feature.default){var i=this.idIndex_[n];i instanceof _Feature.default?Array.isArray(i)?i.push(t):this.idIndex_[n]=[i,t]:r=!1}else r=!1;else this.idIndex_[n]=t}return r&&((0,_asserts.assert)(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}},{key:"addFeatures",value:function(e){this.addFeaturesInternal(e),this.changed()}},{key:"addFeaturesInternal",value:function(e){for(var t=[],r=[],n=[],i=0,a=e.length;i<a;i++){var o=e[i],u=(0,_util.getUid)(o);this.addToIndex_(u,o)&&r.push(o)}for(var s=0,l=r.length;s<l;s++){var f=r[s],c=(0,_util.getUid)(f);this.setupChangeEvents_(c,f);var _=f.getGeometry();if(_){var d=_.getExtent();t.push(d),n.push(f)}else this.nullGeometryFeatures_[c]=f}if(this.featuresRtree_&&this.featuresRtree_.load(t,n),this.hasListener(_VectorEventType.default.ADDFEATURE))for(var h=0,v=r.length;h<v;h++)this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.ADDFEATURE,r[h]))}},{key:"bindFeaturesCollection_",value:function(e){var t=this,r=!1;this.addEventListener(_VectorEventType.default.ADDFEATURE,function(t){r||(r=!0,e.push(t.feature),r=!1)}),this.addEventListener(_VectorEventType.default.REMOVEFEATURE,function(t){r||(r=!0,e.remove(t.feature),r=!1)}),e.addEventListener(_CollectionEventType.default.ADD,function(e){r||(r=!0,t.addFeature(e.element),r=!1)}),e.addEventListener(_CollectionEventType.default.REMOVE,function(e){r||(r=!0,t.removeFeature(e.element),r=!1)}),this.featuresCollection_=e}},{key:"clear",value:function(e){var t=this;if(e){for(var r in this.featureChangeKeys_){this.featureChangeKeys_[r].forEach(_events.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){for(var n in this.featuresRtree_.forEach(function(e){t.removeFeatureInternal(e)}),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var i=new VectorSourceEvent(_VectorEventType.default.CLEAR);this.dispatchEvent(i),this.changed()}},{key:"forEachFeature",value:function(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureAtCoordinateDirect",value:function(e,t){var r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){var n=r.getGeometry();if(n instanceof _Feature.default||n.intersectsCoordinate(e))return t(r)})}},{key:"forEachFeatureInExtent",value:function(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureIntersectingExtent",value:function(e,t){return this.forEachFeatureInExtent(e,function(r){var n=r.getGeometry();if(n instanceof _Feature.default||n.intersectsExtent(e)){var i=t(r);if(i)return i}})}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,_obj.isEmpty)(this.nullGeometryFeatures_)||(0,_array.extend)(e,Object.values(this.nullGeometryFeatures_))),e}},{key:"getFeaturesAtCoordinate",value:function(e){var t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t}},{key:"getFeaturesInExtent",value:function(e,t){var r=this;if(this.featuresRtree_){var n;if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);var i=(0,_extent.wrapAndSliceX)(e,t);return(n=[]).concat.apply(n,_toConsumableArray(i.map(function(e){return r.featuresRtree_.getInExtent(e)})))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(e,t){var r=e[0],n=e[1],i=null,a=[NaN,NaN],o=1/0,u=[-1/0,-1/0,1/0,1/0];return t=t||_functions.TRUE,this.featuresRtree_.forEachInExtent(u,function(e){if(t(e)){var s=e.getGeometry(),l=o;if((o=s instanceof _Feature.default?0:s.closestPointXY(r,n,a,o))<l){i=e;var f=Math.sqrt(o);u[0]=r-f,u[1]=n-f,u[2]=r+f,u[3]=n+f}}}),i}},{key:"getExtent",value:function(e){return this.featuresRtree_.getExtent(e)}},{key:"getFeatureById",value:function(e){var t=this.idIndex_[e.toString()];return void 0!==t?t:null}},{key:"getFeatureByUid",value:function(e){var t=this.uidIndex_[e];return void 0!==t?t:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(e){var t=e.target,r=(0,_util.getUid)(t),n=t.getGeometry();if(n){var i=n.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(i,t)):this.featuresRtree_&&this.featuresRtree_.update(i,t)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);var a=t.getId();if(void 0!==a){var o=a.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.CHANGEFEATURE,t))}},{key:"hasFeature",value:function(e){var t=e.getId();return void 0!==t?t in this.idIndex_:(0,_util.getUid)(e)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,_obj.isEmpty)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(e,t,r){for(var n=this,i=this.loadedExtentsRtree_,a=this.strategy_(e,t,r),o=function(){var e=a[u];i.forEachInExtent(e,function(t){return(0,_extent.containsExtent)(t.extent,e)})||(++n.loadingExtentsCount_,n.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.FEATURESLOADSTART)),n.loader_.call(n,e,t,r,function(e){--n.loadingExtentsCount_,n.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.FEATURESLOADEND,void 0,e))},function(){--n.loadingExtentsCount_,n.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.FEATURESLOADERROR))}),i.insert(e,{extent:e.slice()}))},u=0,s=a.length;u<s;++u)o();this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),_get(_getPrototypeOf(t.prototype),"refresh",this).call(this)}},{key:"removeLoadedExtent",value:function(e){var t,r=this.loadedExtentsRtree_;r.forEachInExtent(e,function(r){if((0,_extent.equals)(r.extent,e))return t=r,!0}),t&&r.remove(t)}},{key:"removeFeatures",value:function(e){for(var t=[],r=0,n=e.length;r<n;++r){var i=e[r],a=this.removeFeatureInternal(i);a&&t.push(a)}t.length>0&&this.changed()}},{key:"removeFeature",value:function(e){e&&(this.removeFeatureInternal(e)&&this.changed())}},{key:"removeFeatureInternal",value:function(e){var t=(0,_util.getUid)(e);if(t in this.uidIndex_){t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);var r=this.featureChangeKeys_[t];null==r||r.forEach(_events.unlistenByKey),delete this.featureChangeKeys_[t];var n=e.getId();if(void 0!==n){var i=n.toString(),a=this.idIndex_[i];a===e?delete this.idIndex_[i]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),1===a.length&&(this.idIndex_[i]=a[0]))}return delete this.uidIndex_[t],this.hasListener(_VectorEventType.default.REMOVEFEATURE)&&this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.REMOVEFEATURE,e)),e}}},{key:"removeFromIdIndex_",value:function(e){var t=!1;for(var r in this.idIndex_){var n=this.idIndex_[r];if(e instanceof _Feature.default&&Array.isArray(n)&&n.includes(e))n.splice(n.indexOf(e),1);else if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}}return t}},{key:"setLoader",value:function(e){this.loader_=e}},{key:"setUrl",value:function(e){(0,_asserts.assert)(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader((0,_featureloader.xhr)(e,this.format_))}}])}(),_default=exports.default=VectorSource;

},{"../Collection.js":78,"../CollectionEventType.js":79,"../ObjectEventType.js":97,"../array.js":110,"../asserts.js":111,"../events.js":132,"../events/Event.js":133,"../events/EventType.js":134,"../extent.js":142,"../featureloader.js":144,"../functions.js":200,"../loadingstrategy.js":278,"../obj.js":281,"../render/Feature.js":295,"../structs/RBush.js":383,"../util.js":404,"./Source.js":356,"./VectorEventType.js":368}],368:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};

},{}],369:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.defaultLoadFunction=defaultLoadFunction;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_VectorTile=_interopRequireDefault(require("../VectorTile.js")),_TileCache=_interopRequireDefault(require("../TileCache.js")),_TileGrid=_interopRequireDefault(require("../tilegrid/TileGrid.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_UrlTile2=_interopRequireDefault(require("./UrlTile.js")),_VectorRenderTile=_interopRequireDefault(require("../VectorRenderTile.js")),_common=require("../tilegrid/common.js"),_extent=require("../extent.js"),_tilegrid=require("../tilegrid.js"),_tilecoord=require("../tilecoord.js"),_obj=require("../obj.js"),_featureloader=require("../featureloader.js"),_size=require("../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorTile=function(e){function t(e){var r;_classCallCheck(this,t);var i=e.projection||"EPSG:3857",o=e.extent||(0,_tilegrid.extentFromProjection)(i),n=e.tileGrid||(0,_tilegrid.createXYZ)({extent:o,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});return(r=_callSuper(this,t,[{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,opaque:!1,projection:i,state:e.state,tileGrid:n,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultLoadFunction,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection}])).format_=e.format?e.format:null,r.sourceTileCache=new _TileCache.default(r.tileCache.highWaterMark),r.overlaps_=null==e.overlaps||e.overlaps,r.tileClass=e.tileClass?e.tileClass:_VectorTile.default,r.tileGrids_={},r}return _inherits(t,_UrlTile2["default"]),_createClass(t,[{key:"getFeaturesInExtent",value:function(e){var t=[],r=this.tileCache;if(0===r.getCount())return t;var i=(0,_tilecoord.fromKey)(r.peekFirstKey())[0],o=this.tileGrid;return r.forEach(function(r){if(r.tileCoord[0]===i&&r.getState()===_TileState.default.LOADED)for(var n=r.getSourceTiles(),l=0,a=n.length;l<a;++l){var u=n[l],s=u.tileCoord;if((0,_extent.intersects)(e,o.getTileCoordExtent(s))){var c=u.getFeatures();if(c)for(var f=0,d=c.length;f<d;++f){var p=c[f],_=p.getGeometry();(0,_extent.intersects)(e,_.getExtent())&&t.push(p)}}}}),t}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"clear",value:function(){this.tileCache.clear(),this.sourceTileCache.clear()}},{key:"expireCache",value:function(e,r){var i=this.getTileCacheForProjection(e),o=Object.keys(r).reduce(function(e,t){var r=(0,_tilecoord.getCacheKeyForTileKey)(t),o=i.peek(r);if(o)for(var n=o.sourceTiles,l=0,a=n.length;l<a;++l)e[n[l].getKey()]=!0;return e},{});_get(_getPrototypeOf(t.prototype),"expireCache",this).call(this,e,r),this.sourceTileCache.expireCache(o)}},{key:"getSourceTiles",value:function(e,t,r){var i=this;if(r.getState()===_TileState.default.IDLE){r.setState(_TileState.default.LOADING);var o=r.wrappedTileCoord,n=this.getTileGridForProjection(t),l=n.getTileCoordExtent(o),a=o[0],u=n.getResolution(a);(0,_extent.buffer)(l,-u,l);var s=this.tileGrid,c=s.getExtent();c&&(0,_extent.getIntersection)(l,c,l);var f=s.getZForResolution(u,this.zDirection);s.forEachTileCoord(l,f,function(o){var n=i.tileUrlFunction(o,e,t),l=i.sourceTileCache.containsKey(n)?i.sourceTileCache.get(n):new i.tileClass(o,n?_TileState.default.IDLE:_TileState.default.EMPTY,n,i.format_,i.tileLoadFunction);r.sourceTiles.push(l);var a=l.getState();if(a<_TileState.default.LOADED){l.addEventListener(_EventType.default.CHANGE,function e(t){i.handleTileChange(t);var o=l.getState();if(o===_TileState.default.LOADED||o===_TileState.default.ERROR){var n=l.getKey();n in r.errorTileKeys?l.getState()===_TileState.default.LOADED&&delete r.errorTileKeys[n]:r.loadingSourceTiles--,o===_TileState.default.ERROR?r.errorTileKeys[n]=!0:l.removeEventListener(_EventType.default.CHANGE,e),0===r.loadingSourceTiles&&r.setState((0,_obj.isEmpty)(r.errorTileKeys)?_TileState.default.LOADED:_TileState.default.ERROR)}}),r.loadingSourceTiles++}a===_TileState.default.IDLE&&(l.extent=s.getTileCoordExtent(o),l.projection=t,l.resolution=s.getResolution(o[0]),i.sourceTileCache.set(n,l),l.load())}),r.loadingSourceTiles||r.setState(r.sourceTiles.some(function(e){return e.getState()===_TileState.default.ERROR})?_TileState.default.ERROR:_TileState.default.LOADED)}return r.sourceTiles}},{key:"getTile",value:function(e,t,r,i,o){var n,l=this,a=(0,_tilecoord.getKeyZXY)(e,t,r),u=this.getKey();if(this.tileCache.containsKey(a)&&(n=this.tileCache.get(a)).key===u)return n;var s=[e,t,r],c=this.getTileCoordForTileUrlFunction(s,o),f=this.getTileGrid().getExtent(),d=this.getTileGridForProjection(o);if(c&&f){var p=d.getTileCoordExtent(c);(0,_extent.buffer)(p,-d.getResolution(e),p),(0,_extent.intersects)(f,p)||(c=null)}var _=!0;if(null!==c){var h=this.tileGrid,y=d.getResolution(e),g=h.getZForResolution(y,1),T=d.getTileCoordExtent(c);(0,_extent.buffer)(T,-y,T),h.forEachTileCoord(T,g,function(e){_=_&&!l.tileUrlFunction(e,i,o)})}var v=new _VectorRenderTile.default(s,_?_TileState.default.EMPTY:_TileState.default.IDLE,c,this.getSourceTiles.bind(this,i,o));return v.key=u,n?(v.interimTile=n,v.refreshInterimChain(),this.tileCache.replace(a,v)):this.tileCache.set(a,v),v}},{key:"getTileGridForProjection",value:function(e){var t=e.getCode(),r=this.tileGrids_[t];if(!r){for(var i=this.tileGrid,o=i.getResolutions().slice(),n=o.map(function(e,t){return i.getOrigin(t)}),l=o.map(function(e,t){return i.getTileSize(t)}),a=_common.DEFAULT_MAX_ZOOM+1,u=o.length;u<a;++u)o.push(o[u-1]/2),n.push(n[u-1]),l.push(l[u-1]);r=new _TileGrid.default({extent:i.getExtent(),origins:n,resolutions:o,tileSizes:l}),this.tileGrids_[t]=r}return r}},{key:"getTilePixelRatio",value:function(e){return e}},{key:"getTilePixelSize",value:function(e,t,r){var i=this.getTileGridForProjection(r),o=(0,_size.toSize)(i.getTileSize(e),this.tmpSize);return[Math.round(o[0]*t),Math.round(o[1]*t)]}},{key:"updateCacheSize",value:function(e,r){_get(_getPrototypeOf(t.prototype),"updateCacheSize",this).call(this,2*e,r),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(r).highWaterMark}}])}(),_default=exports.default=VectorTile;function defaultLoadFunction(e,t){e.setLoader(function(r,i,o){(0,_featureloader.loadFeaturesXhr)(t,e.getFormat(),r,i,o,e.onLoad.bind(e),e.onError.bind(e))})}

},{"../TileCache.js":101,"../TileState.js":104,"../VectorRenderTile.js":105,"../VectorTile.js":106,"../events/EventType.js":134,"../extent.js":142,"../featureloader.js":144,"../obj.js":281,"../size.js":337,"../tilecoord.js":396,"../tilegrid.js":397,"../tilegrid/TileGrid.js":398,"../tilegrid/common.js":400,"./UrlTile.js":366}],370:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.optionsFromCapabilities=optionsFromCapabilities;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_uri=require("../uri.js"),_extent=require("../extent.js"),_WMTS=require("../tilegrid/WMTS.js"),_tileurlfunction=require("../tileurlfunction.js"),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var WMTS=function(e){function t(e){var i;_classCallCheck(this,t);var r=void 0!==e.requestEncoding?e.requestEncoding:"KVP",n=e.tileGrid,o=e.urls;return void 0===o&&void 0!==e.url&&(o=(0,_tileurlfunction.expandUrl)(e.url)),(i=_callSuper(this,t,[{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:o,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection}])).version_=void 0!==e.version?e.version:"1.0.0",i.format_=void 0!==e.format?e.format:"image/jpeg",i.dimensions_=void 0!==e.dimensions?e.dimensions:{},i.layer_=e.layer,i.matrixSet_=e.matrixSet,i.style_=e.style,i.requestEncoding_=r,i.setKey(i.getKeyForDimensions_()),o&&o.length>0&&(i.tileUrlFunction=(0,_tileurlfunction.createFromTileUrlFunctions)(o.map(i.createFromWMTSTemplate.bind(i)))),i}return _inherits(t,_TileImage2["default"]),_createClass(t,[{key:"setUrls",value:function(e){this.urls=e;var t=e.join("\n");this.setTileUrlFunction((0,_tileurlfunction.createFromTileUrlFunctions)(e.map(this.createFromWMTSTemplate.bind(this))),t)}},{key:"getDimensions",value:function(){return this.dimensions_}},{key:"getFormat",value:function(){return this.format_}},{key:"getLayer",value:function(){return this.layer_}},{key:"getMatrixSet",value:function(){return this.matrixSet_}},{key:"getRequestEncoding",value:function(){return this.requestEncoding_}},{key:"getStyle",value:function(){return this.style_}},{key:"getVersion",value:function(){return this.version_}},{key:"getKeyForDimensions_",value:function(){var e=this.urls?this.urls.slice(0):[];for(var t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}},{key:"updateDimensions",value:function(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}},{key:"createFromWMTSTemplate",value:function(e){var t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==t&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e="KVP"==t?(0,_uri.appendParams)(e,i):e.replace(/\{(\w+?)\}/g,function(e,t){return t.toLowerCase()in i?i[t.toLowerCase()]:e});var r=this.tileGrid,n=this.dimensions_;return function(i,o,a){if(i){var s={TileMatrix:r.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(s,n);var l=e;return l="KVP"==t?(0,_uri.appendParams)(l,s):l.replace(/\{(\w+?)\}/g,function(e,t){return s[t]})}}}}])}(),_default=exports.default=WMTS;function optionsFromCapabilities(e,t){var i=e.Contents.Layer,r=null==i?void 0:i.find(function(e){return e.Identifier==t.layer});if(!r)return null;var n,o=e.Contents.TileMatrixSet;(n=r.TileMatrixSetLink.length>1?"projection"in t?r.TileMatrixSetLink.findIndex(function(e){var i=o.find(function(t){return t.Identifier==e.TileMatrixSet}).SupportedCRS,r=(0,_proj.get)(i),n=(0,_proj.get)(t.projection);return r&&n?(0,_proj.equivalent)(r,n):i==t.projection}):r.TileMatrixSetLink.findIndex(function(e){return e.TileMatrixSet==t.matrixSet}):0)<0&&(n=0);var a=r.TileMatrixSetLink[n].TileMatrixSet,s=r.TileMatrixSetLink[n].TileMatrixSetLimits,l=r.Format[0];"format"in t&&(l=t.format),(n=r.Style.findIndex(function(e){return"style"in t?e.Title==t.style:e.isDefault}))<0&&(n=0);var u=r.Style[n].Identifier,c={};"Dimension"in r&&r.Dimension.forEach(function(e,t,i){var r=e.Identifier,n=e.Default;void 0===n&&(n=e.Value[0]),c[r]=n});var f,p=e.Contents.TileMatrixSet.find(function(e){return e.Identifier==a}),d=p.SupportedCRS;if(d&&(f=(0,_proj.get)(d)),"projection"in t){var _=(0,_proj.get)(t.projection);_&&(f&&!(0,_proj.equivalent)(_,f)||(f=_))}var y=!1,v="ne"==f.getAxisOrientation().substr(0,2),m=p.TileMatrix[0],h={MinTileCol:0,MinTileRow:0,MaxTileCol:m.MatrixWidth-1,MaxTileRow:m.MatrixHeight-1};if(s){h=s[s.length-1];var T=p.TileMatrix.find(function(e){return e.Identifier===h.TileMatrix||p.Identifier+":"+e.Identifier===h.TileMatrix});T&&(m=T)}var g=28e-5*m.ScaleDenominator/f.getMetersPerUnit(),b=v?[m.TopLeftCorner[1],m.TopLeftCorner[0]]:m.TopLeftCorner,S=m.TileWidth*g,x=m.TileHeight*g,j=p.BoundingBox;j&&v&&(j=[j[1],j[0],j[3],j[2]]);var M=[b[0]+S*h.MinTileCol,b[1]-x*(1+h.MaxTileRow),b[0]+S*(1+h.MaxTileCol),b[1]-x*h.MinTileRow];if(void 0!==j&&!(0,_extent.containsExtent)(j,M)){var P=r.WGS84BoundingBox,C=(0,_proj.get)("EPSG:4326").getExtent();if(M=j,P)y=P[0]===C[0]&&P[2]===C[2];else{var O=(0,_proj.transformExtent)(j,p.SupportedCRS,"EPSG:4326");y=O[0]-1e-10<=C[0]&&O[2]+1e-10>=C[2]}}var w=(0,_WMTS.createFromCapabilitiesMatrixSet)(p,M,s),R=[],E=t.requestEncoding;if(E=void 0!==E?E:"","OperationsMetadata"in e&&"GetTile"in e.OperationsMetadata)for(var F=e.OperationsMetadata.GetTile.DCP.HTTP.Get,k=0,q=F.length;k<q;++k)if(F[k].Constraint){var I=F[k].Constraint.find(function(e){return"GetEncoding"==e.name}).AllowedValues.Value;if(""===E&&(E=I[0]),"KVP"!==E)break;I.includes("KVP")&&R.push(F[k].href)}else F[k].href&&(E="KVP",R.push(F[k].href));return 0===R.length&&(E="REST",r.ResourceURL.forEach(function(e){"tile"===e.resourceType&&(l=e.format,R.push(e.template))})),{urls:R,layer:t.layer,matrixSet:a,format:l,projection:f,requestEncoding:E,tileGrid:w,style:u,dimensions:c,wrapX:y,crossOrigin:t.crossOrigin}}

},{"../extent.js":142,"../proj.js":283,"../tilegrid/WMTS.js":399,"../tileurlfunction.js":401,"../uri.js":403,"./TileImage.js":362}],371:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_tilegrid=require("../tilegrid.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var XYZ=function(t){function e(t){var r;_classCallCheck(this,e);var o=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:(0,_tilegrid.createXYZ)({extent:(0,_tilegrid.extentFromProjection)(o),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});return(r=_callSuper(this,e,[{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:o,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}])).gutter_=void 0!==t.gutter?t.gutter:0,r}return _inherits(e,_TileImage2["default"]),_createClass(e,[{key:"getGutter",value:function(){return this.gutter_}}])}(),_default=exports.default=XYZ;

},{"../tilegrid.js":397,"./TileImage.js":362}],372:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.CustomTile=void 0;var _common=require("../tilegrid/common.js"),_ImageTile2=_interopRequireDefault(require("../ImageTile.js")),_TileGrid=_interopRequireDefault(require("../tilegrid/TileGrid.js")),_TileImage2=_interopRequireDefault(require("./TileImage.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_dom=require("../dom.js"),_tileurlfunction=require("../tileurlfunction.js"),_extent=require("../extent.js"),_size=require("../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CustomTile=exports.CustomTile=function(e){function t(e,r,i,o,n,u,l){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[r,i,o,n,u,l])).zoomifyImage_=null,a.tileSize_=e,a}return _inherits(t,_ImageTile2["default"]),_createClass(t,[{key:"getImage",value:function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=_get(_getPrototypeOf(t.prototype),"getImage",this).call(this);if(this.state==_TileState.default.LOADED){var r=this.tileSize_;if(e.width==r[0]&&e.height==r[1])return this.zoomifyImage_=e,e;var i=(0,_dom.createCanvasContext2D)(r[0],r[1]);return i.drawImage(e,0,0),this.zoomifyImage_=i.canvas,i.canvas}return e}}])}(),Zoomify=function(e){function t(e){var r;_classCallCheck(this,t);var i=e.size,o=void 0!==e.tierSizeCalculation?e.tierSizeCalculation:"default",n=e.tilePixelRatio||1,u=i[0],l=i[1],a=[],c=e.tileSize||_common.DEFAULT_TILE_SIZE,s=c*n;switch(o){case"default":for(;u>s||l>s;)a.push([Math.ceil(u/s),Math.ceil(l/s)]),s+=s;break;case"truncated":for(var f=u,p=l;f>s||p>s;)a.push([Math.ceil(f/s),Math.ceil(p/s)]),f>>=1,p>>=1;break;default:throw new Error("Unknown `tierSizeCalculation` configured")}a.push([1,1]),a.reverse();for(var _=[n],y=[0],d=1,m=a.length;d<m;d++)_.push(n<<d),y.push(a[d-1][0]*a[d-1][1]+y[d-1]);_.reverse();var h=new _TileGrid.default({tileSize:c,extent:e.extent||[0,-l,u,0],resolutions:_}),g=e.url;!g||g.includes("{TileGroup}")||g.includes("{tileIndex}")||(g+="{TileGroup}/{z}-{x}-{y}.jpg");var v=(0,_tileurlfunction.expandUrl)(g),b=c*n;var P=(0,_tileurlfunction.createFromTileUrlFunctions)(v.map(function(e){return function(t,r,i){if(t){var o=t[0],n=t[1],u=t[2],l=n+u*a[o][0],c={z:o,x:n,y:u,tileIndex:l,TileGroup:"TileGroup"+((l+y[o])/b|0)};return e.replace(/\{(\w+?)\}/g,function(e,t){return c[t]})}}})),T=CustomTile.bind(null,(0,_size.toSize)(c*n));(r=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,tilePixelRatio:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:T,tileGrid:h,tileUrlFunction:P,transition:e.transition}])).zDirection=e.zDirection;var O=P(h.getTileCoordForCoordAndResolution((0,_extent.getCenter)(h.getExtent()),_[_.length-1]),1,null),j=new Image;return j.addEventListener("error",function(){b=c,r.changed()}),j.src=O,r}return _inherits(t,_TileImage2["default"]),_createClass(t)}(),_default=exports.default=Zoomify;

},{"../ImageTile.js":87,"../TileState.js":104,"../dom.js":130,"../extent.js":142,"../size.js":337,"../tilegrid/TileGrid.js":398,"../tilegrid/common.js":400,"../tileurlfunction.js":401,"./TileImage.js":362}],373:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLoader=createLoader,exports.getRequestUrl=getRequestUrl;var _common=require("./common.js"),_uri=require("../uri.js"),_Image=require("../Image.js"),_extent=require("../extent.js"),_proj=require("../proj.js"),_Image2=require("./Image.js"),_math=require("../math.js");function getRequestUrl(e,r,t,a,o,i){var n=o.getCode().split(/:(?=\d+$)/).pop(),u=t/a,s=[(0,_math.round)((0,_extent.getWidth)(r)/u,_common.DECIMALS),(0,_math.round)((0,_extent.getHeight)(r)/u,_common.DECIMALS)];i.SIZE=s[0]+","+s[1],i.BBOX=r.join(","),i.BBOXSR=n,i.IMAGESR=n,i.DPI=Math.round(i.DPI?i.DPI*a:90*a);var g=e.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return(0,_uri.appendParams)(g,i)}function createLoader(e){var r=e.load?e.load:_Image.decode,t=(0,_proj.get)(e.projection||"EPSG:3857");return function(a,o,i){i=e.hidpi?i:1;var n={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(n,e.params),a=(0,_Image2.getRequestExtent)(a,o,i,e.ratio);var u=getRequestUrl(e.url,a,o,i,t,n),s=new Image;return null!==e.crossOrigin&&(s.crossOrigin=e.crossOrigin),r(s,u).then(function(e){var r=(0,_extent.getWidth)(a)/e.width*i;return{image:e,extent:a,resolution:r,pixelRatio:i}})}}

},{"../Image.js":84,"../extent.js":142,"../math.js":279,"../proj.js":283,"../uri.js":403,"./Image.js":346,"./common.js":374}],374:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_WMS_VERSION=exports.DECIMALS=void 0;var DEFAULT_WMS_VERSION=exports.DEFAULT_WMS_VERSION="1.3.0",DECIMALS=exports.DECIMALS=4;

},{}],375:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLoader=createLoader;var _uri=require("../uri.js"),_Image=require("../Image.js"),_extent=require("../extent.js"),_Image2=require("./Image.js");function getScale(e,t,r,a){var n=(0,_extent.getWidth)(e),i=(0,_extent.getHeight)(e),u=t[0],E=t[1],g=.0254/a;return E*n>u*i?n*r/(u*g):i*r/(E*g)}function getUrl(e,t,r,a,n,i,u){var E=getScale(r,a,i,u),g=(0,_extent.getCenter)(r),s={OPERATION:n?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:u,SETDISPLAYWIDTH:Math.round(a[0]),SETDISPLAYHEIGHT:Math.round(a[1]),SETVIEWSCALE:E,SETVIEWCENTERX:g[0],SETVIEWCENTERY:g[1]};return Object.assign(s,t),(0,_uri.appendParams)(e,s)}function createLoader(e){var t=e.load||_Image.decode;return function(r,a,n){var i=new Image;null!==e.crossOrigin&&(i.crossOrigin=e.crossOrigin),r=(0,_Image2.getRequestExtent)(r,a,n,e.ratio);var u=(0,_extent.getWidth)(r)/a,E=(0,_extent.getHeight)(r)/a,g=[u*n,E*n],s=getUrl(e.url,e.params,r,g,e.useOverlay,e.metersPerUnit||1,e.displayDpi||96);return t(i,s).then(function(e){return{image:e,extent:r,pixelRatio:n}})}}

},{"../Image.js":84,"../extent.js":142,"../uri.js":403,"./Image.js":346}],376:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.appendCollectionsQueryParam=appendCollectionsQueryParam,exports.getMapTileUrlTemplate=getMapTileUrlTemplate,exports.getTileSetInfo=getTileSetInfo,exports.getVectorTileUrlTemplate=getVectorTileUrlTemplate;var _TileGrid=_interopRequireDefault(require("../tilegrid/TileGrid.js")),_net=require("../net.js"),_proj=require("../proj.js"),_extent=require("../extent.js"),_console=require("../console.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var knownMapMediaTypes={"image/png":!0,"image/jpeg":!0,"image/gif":!0,"image/webp":!0},knownVectorMediaTypes={"application/vnd.mapbox-vector-tile":!0,"application/geo+json":!0};function appendCollectionsQueryParam(e,t){if(!t.length)return e;var r=new URL(e,"file:/");if(r.pathname.split("/").includes("collections"))return(0,_console.error)('The "collections" query parameter cannot be added to collection endpoints'),e;var i=t.map(function(e){return encodeURIComponent(e)}).join(",");r.searchParams.append("collections",i);var n=e.split("?")[0],o=decodeURIComponent(r.searchParams.toString());return"".concat(n,"?").concat(o)}function getMapTileUrlTemplate(e,t,r){for(var i,n,o=0;o<e.length;++o){var l=e[o];if("item"===l.rel){if(l.type===t){i=l.href;break}knownMapMediaTypes[l.type]?n=l.href:!n&&l.type.startsWith("image/")&&(n=l.href)}}if(!i){if(!n)throw new Error('Could not find "item" link');i=n}return r&&(i=appendCollectionsQueryParam(i,r)),i}function getVectorTileUrlTemplate(e,t,r,i){for(var n,o,l={},a=0;a<e.length;++a){var p=e[a];if(l[p.type]=p.href,"item"===p.rel){if(p.type===t){n=p.href;break}knownVectorMediaTypes[p.type]&&(o=p.href)}}if(!n&&r)for(var c=0;c<r.length;++c){var s=r[c];if(l[s]){n=l[s];break}}if(!n){if(!o)throw new Error('Could not find "item" link');n=o}return i&&(n=appendCollectionsQueryParam(n,i)),n}function parseTileMatrixSet(e,t,r,i){var n=e.projection;if(!n&&!(n=(0,_proj.get)(t.crs)))throw new Error("Unsupported CRS: ".concat(t.crs));for(var o=t.orderedAxes,l="en"!==(o?o.slice(0,2).map(function(e){return e.replace(/E|X|Lon/i,"e").replace(/N|Y|Lat/i,"n")}).join(""):n.getAxisOrientation().substr(0,2)),a=t.tileMatrices,p={},c=0;c<a.length;++c){var s=a[c];p[s.id]=s}var f={},u=[];if(i)for(var d=0;d<i.length;++d){var m=i[d],g=m.tileMatrix;u.push(g),f[g]=m}else for(var T=0;T<a.length;++T){var v=a[T].id;u.push(v)}for(var h=u.length,w=new Array(h),x=new Array(h),y=new Array(h),M=new Array(h),S=[-1/0,-1/0,1/0,1/0],_=0;_<h;++_){var C=u[_],j=p[C],R=j.pointOfOrigin;w[_]=l?[R[1],R[0]]:R,x[_]=j.cellSize,y[_]=[j.matrixWidth,j.matrixHeight],M[_]=[j.tileWidth,j.tileHeight];var U=f[C];if(U){var k=j.cellSize*j.tileWidth,b=w[_][0]+U.minTileCol*k,O=w[_][0]+(U.maxTileCol+1)*k,q=j.cellSize*j.tileHeight,E=void 0,P=void 0;"bottomLeft"===j.cornerOfOrigin?(E=w[_][1]+U.minTileRow*q,P=w[_][1]+(U.maxTileRow+1)*q):(E=w[_][1]-(U.maxTileRow+1)*q,P=w[_][1]-U.minTileRow*q),(0,_extent.getIntersection)(S,[b,E,O,P],S)}}var A=new _TileGrid.default({origins:w,resolutions:x,sizes:y,tileSizes:M,extent:i?S:void 0}),I=e.context,L=e.url;return{grid:A,urlTemplate:r,urlFunction:function(e,t,n){if(e){var o=u[e[0]],l=p[o],a="bottomLeft"===l.cornerOfOrigin,c={tileMatrix:o,tileCol:e[1],tileRow:a?-e[2]-1:e[2]};if(i){var s=f[l.id];if(c.tileCol<s.minTileCol||c.tileCol>s.maxTileCol||c.tileRow<s.minTileRow||c.tileRow>s.maxTileRow)return}Object.assign(c,I);var d=r.replace(/\{(\w+?)\}/g,function(e,t){return c[t]});return(0,_net.resolveUrl)(L,d)}}}}function parseTileSetMetadata(e,t){var r,i=t.tileMatrixSetLimits;if("map"===t.dataType)r=getMapTileUrlTemplate(t.links,e.mediaType,e.collections);else{if("vector"!==t.dataType)throw new Error('Expected tileset data type to be "map" or "vector"');r=getVectorTileUrlTemplate(t.links,e.mediaType,e.supportedMediaTypes,e.collections)}if(t.tileMatrixSet)return parseTileMatrixSet(e,t.tileMatrixSet,r,i);var n=t.links.find(function(e){return"http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"===e.rel});if(!n)throw new Error("Expected http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme link or tileMatrixSet");var o=n.href,l=(0,_net.resolveUrl)(e.url,o);return(0,_net.getJSON)(l).then(function(t){return parseTileMatrixSet(e,t,r,i)})}function getTileSetInfo(e){return(0,_net.getJSON)(e.url).then(function(t){return parseTileSetMetadata(e,t)})}

},{"../console.js":115,"../extent.js":142,"../net.js":280,"../proj.js":283,"../tilegrid/TileGrid.js":398}],377:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLoader=createLoader;var _Image=require("../Image.js"),_extent=require("../extent.js");function createLoader(e){var t=e.load||_Image.decode,r=e.imageExtent,n=new Image;return null!==e.crossOrigin&&(n.crossOrigin=e.crossOrigin),function(){return t(n,e.url).then(function(e){var t=(0,_extent.getWidth)(r)/e.width,n=(0,_extent.getHeight)(r)/e.height;return{image:e,extent:r,resolution:t!==n?[t,n]:n,pixelRatio:1}})}}

},{"../Image.js":84,"../extent.js":142}],378:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_VERSION=void 0,exports.createLoader=createLoader,exports.getFeatureInfoUrl=getFeatureInfoUrl,exports.getImageSrc=getImageSrc,exports.getLegendUrl=getLegendUrl,exports.getRequestParams=getRequestParams,exports.getRequestUrl=getRequestUrl;var _common=require("./common.js"),_uri=require("../uri.js"),_string=require("../string.js"),_Image=require("../Image.js"),_math=require("../math.js"),_extent=require("../extent.js"),_proj=require("../proj.js"),_Image2=require("./Image.js"),DEFAULT_VERSION=exports.DEFAULT_VERSION="1.3.0",GETFEATUREINFO_IMAGE_SIZE=[101,101];function getRequestUrl(e,r,t,a,n){n.WIDTH=t[0],n.HEIGHT=t[1];var s,o=a.getAxisOrientation(),i=(0,_string.compareVersions)(n.VERSION,"1.3")>=0;return n[i?"CRS":"SRS"]=a.getCode(),s=i&&"ne"==o.substr(0,2)?[r[1],r[0],r[3],r[2]]:r,n.BBOX=s.join(","),(0,_uri.appendParams)(e,n)}function getImageSrc(e,r,t,a,n,s,o){s=Object.assign({REQUEST:"GetMap"},s);var i=r/t,g=[(0,_math.round)((0,_extent.getWidth)(e)/i,_common.DECIMALS),(0,_math.round)((0,_extent.getHeight)(e)/i,_common.DECIMALS)];if(1!=t)switch(o){case"geoserver":var E=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+E:s.FORMAT_OPTIONS="dpi:"+E;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return getRequestUrl(n,e,g,a,s)}function getRequestParams(e,r){return Object.assign({REQUEST:r,SERVICE:"WMS",VERSION:DEFAULT_VERSION,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},e)}function createLoader(e){var r=void 0===e.hidpi||e.hidpi,t=(0,_proj.get)(e.projection||"EPSG:3857"),a=e.ratio||1.5,n=e.load||_Image.decode;return function(s,o,i){s=(0,_Image2.getRequestExtent)(s,o,i,a),1==i||r&&void 0!==e.serverType||(i=1);var g=getImageSrc(s,o,i,t,e.url,getRequestParams(e.params,"GetMap"),e.serverType),E=new Image;return null!==e.crossOrigin&&(E.crossOrigin=e.crossOrigin),n(E,g).then(function(e){return{image:e,extent:s,pixelRatio:i}})}}function getFeatureInfoUrl(e,r,t){if(void 0!==e.url){var a=(0,_proj.get)(e.projection||"EPSG:3857"),n=(0,_extent.getForViewAndSize)(r,t,0,GETFEATUREINFO_IMAGE_SIZE),s={QUERY_LAYERS:e.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(s,getRequestParams(e.params,"GetFeatureInfo"),e.params);var o=(0,_math.floor)((r[0]-n[0])/t,_common.DECIMALS),i=(0,_math.floor)((n[3]-r[1])/t,_common.DECIMALS),g=(0,_string.compareVersions)(s.VERSION,"1.3")>=0;return s[g?"I":"X"]=o,s[g?"J":"Y"]=i,getRequestUrl(e.url,n,GETFEATUREINFO_IMAGE_SIZE,a,s)}}function getLegendUrl(e,r){if(void 0!==e.url){var t={SERVICE:"WMS",VERSION:DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e.params||void 0===e.params.LAYER){var a=e.params.LAYERS;if(!(!Array.isArray(a)||1===a.length))return;t.LAYER=a}if(void 0!==r){var n=(0,_proj.get)(e.projection||"EPSG:3857").getMetersPerUnit()||1;t.SCALE=r*n/28e-5}return Object.assign(t,e.params),(0,_uri.appendParams)(e.url,t)}}

},{"../Image.js":84,"../extent.js":142,"../math.js":279,"../proj.js":283,"../string.js":380,"../uri.js":403,"./Image.js":346,"./common.js":374}],379:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_RADIUS=void 0,exports.getArea=getArea,exports.getDistance=getDistance,exports.getLength=getLength,exports.offset=offset;var _math=require("./math.js"),DEFAULT_RADIUS=exports.DEFAULT_RADIUS=6371008.8;function getDistance(t,e,a){a=a||DEFAULT_RADIUS;var n=(0,_math.toRadians)(t[1]),r=(0,_math.toRadians)(e[1]),o=(r-n)/2,s=(0,_math.toRadians)(e[0]-t[0])/2,i=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(n)*Math.cos(r);return 2*a*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function getLengthInternal(t,e){for(var a=0,n=0,r=t.length;n<r-1;++n)a+=getDistance(t[n],t[n+1],e);return a}function getLength(t,e){var a=(e=e||{}).radius||DEFAULT_RADIUS,n=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(n,"EPSG:4326"));var o,s,i,g,h,c,l=0;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":l=getLengthInternal(o=t.getCoordinates(),a);break;case"MultiLineString":case"Polygon":for(i=0,g=(o=t.getCoordinates()).length;i<g;++i)l+=getLengthInternal(o[i],a);break;case"MultiPolygon":for(i=0,g=(o=t.getCoordinates()).length;i<g;++i)for(h=0,c=(s=o[i]).length;h<c;++h)l+=getLengthInternal(s[h],a);break;case"GeometryCollection":var M=t.getGeometries();for(i=0,g=M.length;i<g;++i)l+=getLength(M[i],e);break;default:throw new Error("Unsupported geometry type: "+r)}return l}function getAreaInternal(t,e){for(var a=0,n=t.length,r=t[n-1][0],o=t[n-1][1],s=0;s<n;s++){var i=t[s][0],g=t[s][1];a+=(0,_math.toRadians)(i-r)*(2+Math.sin((0,_math.toRadians)(o))+Math.sin((0,_math.toRadians)(g))),r=i,o=g}return a*e*e/2}function getArea(t,e){var a=(e=e||{}).radius||DEFAULT_RADIUS,n=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(n,"EPSG:4326"));var o,s,i,g,h,c,l=0;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(o=t.getCoordinates(),l=Math.abs(getAreaInternal(o[0],a)),i=1,g=o.length;i<g;++i)l-=Math.abs(getAreaInternal(o[i],a));break;case"MultiPolygon":for(i=0,g=(o=t.getCoordinates()).length;i<g;++i)for(s=o[i],l+=Math.abs(getAreaInternal(s[0],a)),h=1,c=s.length;h<c;++h)l-=Math.abs(getAreaInternal(s[h],a));break;case"GeometryCollection":var M=t.getGeometries();for(i=0,g=M.length;i<g;++i)l+=getArea(M[i],e);break;default:throw new Error("Unsupported geometry type: "+r)}return l}function offset(t,e,a,n){n=n||DEFAULT_RADIUS;var r=(0,_math.toRadians)(t[1]),o=(0,_math.toRadians)(t[0]),s=e/n,i=Math.asin(Math.sin(r)*Math.cos(s)+Math.cos(r)*Math.sin(s)*Math.cos(a)),g=o+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(r),Math.cos(s)-Math.sin(r)*Math.sin(i));return[(0,_math.toDegrees)(g),(0,_math.toDegrees)(i)]}

},{"./math.js":279}],380:[function(require,module,exports){
"use strict";function padNumber(e,r,t){var n=void 0!==t?e.toFixed(t):""+e,o=n.indexOf(".");return(o=-1===o?n.length:o)>r?n:new Array(1+r-o).join("0")+n}function compareVersions(e,r){for(var t=(""+e).split("."),n=(""+r).split("."),o=0;o<Math.max(t.length,n.length);o++){var s=parseInt(t[o]||"0",10),a=parseInt(n[o]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compareVersions=compareVersions,exports.padNumber=padNumber;

},{}],381:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _asserts=require("../asserts.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var LRUCache=function(){return _createClass(function e(t){_classCallCheck(this,e),this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},[{key:"canExpireCache",value:function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(e){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(e){return this.entries_.hasOwnProperty(e)}},{key:"forEach",value:function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer}},{key:"get",value:function(e,t){var r=this.entries_[e];return(0,_asserts.assert)(void 0!==r,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_?r.value_:(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r,r.value_)}},{key:"remove",value:function(e){var t=this.entries_[e];return(0,_asserts.assert)(void 0!==t,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){var e,t=new Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.key_;return t}},{key:"getValues",value:function(){var e,t=new Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.value_;return t}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"peek",value:function(e){var t;return null===(t=this.entries_[e])||void 0===t?void 0:t.value_}},{key:"pop",value:function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}},{key:"replace",value:function(e,t){this.get(e),this.entries_[e].value_=t}},{key:"set",value:function(e,t){(0,_asserts.assert)(!(e in this.entries_),"Tried to set a value for a key that is used already");var r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}},{key:"setSize",value:function(e){this.highWaterMark=e}}])}(),_default=exports.default=LRUCache;

},{"../asserts.js":111}],382:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DROP=void 0;var _asserts=require("../asserts.js"),_obj=require("../obj.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var DROP=exports.DROP=1/0,PriorityQueue=function(){return _createClass(function e(t,i){_classCallCheck(this,e),this.priorityFunction_=t,this.keyFunction_=i,this.elements_=[],this.priorities_=[],this.queuedElements_={}},[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,(0,_obj.clear)(this.queuedElements_)}},{key:"dequeue",value:function(){var e=this.elements_,t=this.priorities_,i=e[0];1==e.length?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i}},{key:"enqueue",value:function(e){(0,_asserts.assert)(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");var t=this.priorityFunction_(e);return t!=DROP&&(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(e){return 2*e+1}},{key:"getRightChildIndex_",value:function(e){return 2*e+2}},{key:"getParentIndex_",value:function(e){return e-1>>1}},{key:"heapify_",value:function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(e){return e in this.queuedElements_}},{key:"isQueued",value:function(e){return this.isKeyQueued(this.keyFunction_(e))}},{key:"siftUp_",value:function(e){for(var t=this.elements_,i=this.priorities_,n=t.length,r=t[e],s=i[e],o=e;e<n>>1;){var u=this.getLeftChildIndex_(e),l=this.getRightChildIndex_(e),a=l<n&&i[l]<i[u]?l:u;t[e]=t[a],i[e]=i[a],e=a}t[e]=r,i[e]=s,this.siftDown_(o,e)}},{key:"siftDown_",value:function(e,t){for(var i=this.elements_,n=this.priorities_,r=i[t],s=n[t];t>e;){var o=this.getParentIndex_(t);if(!(n[o]>s))break;i[t]=i[o],n[t]=n[o],t=o}i[t]=r,n[t]=s}},{key:"reprioritize",value:function(){var e,t,i,n=this.priorityFunction_,r=this.elements_,s=this.priorities_,o=0,u=r.length;for(t=0;t<u;++t)(i=n(e=r[t]))==DROP?delete this.queuedElements_[this.keyFunction_(e)]:(s[o]=i,r[o++]=e);r.length=o,s.length=o,this.heapify_()}}])}(),_default=exports.default=PriorityQueue;

},{"../asserts.js":111,"../obj.js":281}],383:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rbush=_interopRequireDefault(require("rbush")),_extent=require("../extent.js"),_util=require("../util.js"),_obj=require("../obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var RBush=function(){return _createClass(function e(t){_classCallCheck(this,e),this.rbush_=new _rbush.default(t),this.items_={}},[{key:"insert",value:function(e,t){var r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[(0,_util.getUid)(t)]=r}},{key:"load",value:function(e,t){for(var r=new Array(t.length),i=0,n=t.length;i<n;i++){var u=e[i],o=t[i],a={minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:o};r[i]=a,this.items_[(0,_util.getUid)(o)]=a}this.rbush_.load(r)}},{key:"remove",value:function(e){var t=(0,_util.getUid)(e),r=this.items_[t];return delete this.items_[t],null!==this.rbush_.remove(r)}},{key:"update",value:function(e,t){var r=this.items_[(0,_util.getUid)(t)],i=[r.minX,r.minY,r.maxX,r.maxY];(0,_extent.equals)(i,e)||(this.remove(t),this.insert(e,t))}},{key:"getAll",value:function(){return this.rbush_.all().map(function(e){return e.value})}},{key:"getInExtent",value:function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(e){return e.value})}},{key:"forEach",value:function(e){return this.forEach_(this.getAll(),e)}},{key:"forEachInExtent",value:function(e,t){return this.forEach_(this.getInExtent(e),t)}},{key:"forEach_",value:function(e,t){for(var r,i=0,n=e.length;i<n;i++)if(r=t(e[i]))return r;return r}},{key:"isEmpty",value:function(){return(0,_obj.isEmpty)(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(e){var t=this.rbush_.toJSON();return(0,_extent.createOrUpdate)(t.minX,t.minY,t.maxX,t.maxY,e)}},{key:"concat",value:function(e){for(var t in this.rbush_.load(e.rbush_.all()),e.items_)this.items_[t]=e.items_[t]}}])}(),_default=exports.default=RBush;

},{"../extent.js":142,"../obj.js":281,"../util.js":404,"rbush":427}],384:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Circle",{enumerable:!0,get:function(){return _Circle.default}}),Object.defineProperty(exports,"Fill",{enumerable:!0,get:function(){return _Fill.default}}),Object.defineProperty(exports,"Icon",{enumerable:!0,get:function(){return _Icon.default}}),Object.defineProperty(exports,"IconImage",{enumerable:!0,get:function(){return _IconImage.default}}),Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return _Image.default}}),Object.defineProperty(exports,"RegularShape",{enumerable:!0,get:function(){return _RegularShape.default}}),Object.defineProperty(exports,"Stroke",{enumerable:!0,get:function(){return _Stroke.default}}),Object.defineProperty(exports,"Style",{enumerable:!0,get:function(){return _Style.default}}),Object.defineProperty(exports,"Text",{enumerable:!0,get:function(){return _Text.default}});var _Circle=_interopRequireDefault(require("./style/Circle.js")),_Fill=_interopRequireDefault(require("./style/Fill.js")),_Icon=_interopRequireDefault(require("./style/Icon.js")),_IconImage=_interopRequireDefault(require("./style/IconImage.js")),_Image=_interopRequireDefault(require("./style/Image.js")),_RegularShape=_interopRequireDefault(require("./style/RegularShape.js")),_Stroke=_interopRequireDefault(require("./style/Stroke.js")),_Style=_interopRequireDefault(require("./style/Style.js")),_Text=_interopRequireDefault(require("./style/Text.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./style/Circle.js":385,"./style/Fill.js":386,"./style/Icon.js":387,"./style/IconImage.js":388,"./style/Image.js":390,"./style/RegularShape.js":391,"./style/Stroke.js":392,"./style/Style.js":393,"./style/Text.js":394}],385:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _RegularShape2=_interopRequireDefault(require("./RegularShape.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CircleStyle=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,[{points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}])}return _inherits(e,_RegularShape2["default"]),_createClass(e,[{key:"clone",value:function(){var t=this.getScale(),r=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return r.setOpacity(this.getOpacity()),r}},{key:"setRadius",value:function(t){this.radius_=t,this.render()}}])}(),_default=exports.default=CircleStyle;

},{"./RegularShape.js":391}],386:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_IconImage=require("./IconImage.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Fill=function(){function e(t){_classCallCheck(this,e),t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}return _createClass(e,[{key:"clone",value:function(){var t=this.getColor();return new e({color:Array.isArray(t)?t.slice():t||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(e){var t=this;if(null!==e&&"object"===_typeof(e)&&"src"in e){var r=(0,_IconImage.get)(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));r.ready().then(function(){t.patternImage_=null}),r.getImageState()===_ImageState.default.IDLE&&r.load(),r.getImageState()===_ImageState.default.LOADING&&(this.patternImage_=r)}this.color_=e}},{key:"loading",value:function(){return!!this.patternImage_}},{key:"ready",value:function(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}])}(),_default=exports.default=Fill;

},{"../ImageState.js":86,"./IconImage.js":388}],387:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("./Image.js")),_color=require("../color.js"),_asserts=require("../asserts.js"),_IconImage=require("./IconImage.js"),_util=require("../util.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function _iterableToArrayLimit(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,o,n,a,s=[],c=!0,l=!1;try{if(n=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;c=!1}else for(;!(c=(r=n.call(i)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:i):o.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function calculateScale(t,e,i,r){return void 0!==i&&void 0!==r?[i/t,r/e]:void 0!==i?i/t:void 0!==r?r/e:1}var Icon=function(t){function e(t){var i;_classCallCheck(this,e);var r=void 0!==(t=t||{}).opacity?t.opacity:1,o=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,a=void 0!==t.rotateWithView&&t.rotateWithView;(i=_callSuper(this,e,[{opacity:r,rotation:o,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}])).anchor_=void 0!==t.anchor?t.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",i.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",i.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",i.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;var s,c=void 0!==t.img?t.img:null,l=t.src;if((0,_asserts.assert)(!(void 0!==l&&c),"`image` and `src` cannot be provided at the same time"),void 0!==l&&0!==l.length||!c||(l=c.src||(0,_util.getUid)(c)),(0,_asserts.assert)(void 0!==l&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),(0,_asserts.assert)(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?s=_ImageState.default.IDLE:void 0!==c&&(s="complete"in c?c.complete?c.src?_ImageState.default.LOADED:_ImageState.default.IDLE:_ImageState.default.LOADING:_ImageState.default.LOADED),i.color_=void 0!==t.color?(0,_color.asArray)(t.color):null,i.iconImage_=(0,_IconImage.get)(c,l,i.crossOrigin_,s,i.color_),i.offset_=void 0!==t.offset?t.offset:[0,0],i.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",i.origin_=null,i.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){var u,f;if(t.size){var h=_slicedToArray(t.size,2);u=h[0],f=h[1]}else{var _=i.getImage(1);if(_.width&&_.height)u=_.width,f=_.height;else if(_ instanceof HTMLImageElement){i.initialOptions_=t;return i.listenImageChange(function e(){if(i.unlistenImageChange(e),i.initialOptions_){var r=i.iconImage_.getSize();i.setScale(calculateScale(r[0],r[1],t.width,t.height))}}),_possibleConstructorReturn(i)}}void 0!==u&&i.setScale(calculateScale(u,f,t.width,t.height))}return i}return _inherits(e,_Image["default"]),_createClass(e,[{key:"clone",value:function(){var t,i,r;return this.initialOptions_?(i=this.initialOptions_.width,r=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:i,height:r,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getAnchor",value:function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var i=this.getDisplacement(),r=this.getScaleArray();return[t[0]-i[0]/r[0],t[1]+i[1]/r[1]]}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getPixelRatio",value:function(t){return this.iconImage_.getPixelRatio(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_;if("top-left"!=this.offsetOrigin_){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"getWidth",value:function(){var t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==_ImageState.default.LOADED?this.iconImage_.getSize()[0]*t[0]:void 0}},{key:"getHeight",value:function(){var t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==_ImageState.default.LOADED?this.iconImage_.getSize()[1]*t[1]:void 0}},{key:"setScale",value:function(t){delete this.initialOptions_,_get(_getPrototypeOf(e.prototype),"setScale",this).call(this,t)}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(_EventType.default.CHANGE,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(_EventType.default.CHANGE,t)}},{key:"ready",value:function(){return this.iconImage_.ready()}}])}(),_default=exports.default=Icon;

},{"../ImageState.js":86,"../asserts.js":111,"../color.js":113,"../events/EventType.js":134,"../util.js":404,"./IconImage.js":388,"./Image.js":390}],388:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.get=get;var _Target=_interopRequireDefault(require("../events/Target.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_color=require("../color.js"),_dom=require("../dom.js"),_Image=require("../Image.js"),_IconImageCache=require("./IconImageCache.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var taintedTestContext=null,IconImage=function(e){function t(e,i,a,r,n){var o;return _classCallCheck(this,t),(o=_callSuper(this,t)).hitDetectionImage_=null,o.image_=e,o.crossOrigin_=a,o.canvas_={},o.color_=n,o.imageState_=void 0===r?_ImageState.default.IDLE:r,o.size_=e&&e.width&&e.height?[e.width,e.height]:null,o.src_=i,o.tainted_,o.ready_=null,o}return _inherits(t,_Target["default"]),_createClass(t,[{key:"initializeImage_",value:function(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}},{key:"isTainted_",value:function(){if(void 0===this.tainted_&&this.imageState_===_ImageState.default.LOADED){taintedTestContext||(taintedTestContext=(0,_dom.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})),taintedTestContext.drawImage(this.image_,0,0);try{taintedTestContext.getImageData(0,0,1,1),this.tainted_=!1}catch(e){taintedTestContext=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(_EventType.default.CHANGE)}},{key:"handleImageError_",value:function(){this.imageState_=_ImageState.default.ERROR,this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=_ImageState.default.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}},{key:"getImage",value:function(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}},{key:"getPixelRatio",value:function(e){return this.replaceColor_(e),this.canvas_[e]?e:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],t=this.size_[1],i=(0,_dom.createCanvasContext2D)(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){var e=this;if(this.imageState_===_ImageState.default.IDLE){this.image_||this.initializeImage_(),this.imageState_=_ImageState.default.LOADING;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(e){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(0,_Image.decodeFallback)(this.image_,this.src_).then(function(t){e.image_=t,e.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(e){if(this.color_&&!this.canvas_[e]&&this.imageState_===_ImageState.default.LOADED){var t=this.image_,i=document.createElement("canvas");i.width=Math.ceil(t.width*e),i.height=Math.ceil(t.height*e);var a=i.getContext("2d");a.scale(e,e),a.drawImage(t,0,0),a.globalCompositeOperation="multiply",a.fillStyle=(0,_color.asString)(this.color_),a.fillRect(0,0,i.width/e,i.height/e),a.globalCompositeOperation="destination-in",a.drawImage(t,0,0),this.canvas_[e]=i}}},{key:"ready",value:function(){var e=this;return this.ready_||(this.ready_=new Promise(function(t){e.imageState_===_ImageState.default.LOADED||e.imageState_===_ImageState.default.ERROR?t():e.addEventListener(_EventType.default.CHANGE,function e(){this.imageState_!==_ImageState.default.LOADED&&this.imageState_!==_ImageState.default.ERROR||(this.removeEventListener(_EventType.default.CHANGE,e),t())})})),this.ready_}}])}();function get(e,t,i,a,r,n){var o=void 0===t?void 0:_IconImageCache.shared.get(t,i,r);return o||(o=new IconImage(e,e&&"src"in e?e.src||void 0:t,i,a,r),_IconImageCache.shared.set(t,i,r,o,n)),n&&o&&!_IconImageCache.shared.getPattern(t,i,r)&&_IconImageCache.shared.set(t,i,r,o,n),o}var _default=exports.default=IconImage;

},{"../Image.js":84,"../ImageState.js":86,"../color.js":113,"../dom.js":130,"../events/EventType.js":134,"../events/Target.js":137,"./IconImageCache.js":389}],389:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getCacheKey=getCacheKey,exports.shared=void 0;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_color=require("../color.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var IconImageCache=function(){return _createClass(function e(){_classCallCheck(this,e),this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32},[{key:"clear",value:function(){this.cache_={},this.patternCache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var a=this.cache_[t];0!=(3&e++)||a.hasListener()||(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}},{key:"get",value:function(e,t,a){var r=getCacheKey(e,t,a);return r in this.cache_?this.cache_[r]:null}},{key:"getPattern",value:function(e,t,a){var r=getCacheKey(e,t,a);return r in this.patternCache_?this.patternCache_[r]:null}},{key:"set",value:function(e,t,a,r,i){var n=this,o=getCacheKey(e,t,a),c=o in this.cache_;this.cache_[o]=r,i&&(r.getImageState()===_ImageState.default.IDLE&&r.load(),r.getImageState()===_ImageState.default.LOADING?r.ready().then(function(){n.patternCache_[o]=(0,_dom.getSharedCanvasContext2D)().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=(0,_dom.getSharedCanvasContext2D)().createPattern(r.getImage(1),"repeat")),c||++this.cacheSize_}},{key:"setSize",value:function(e){this.maxCacheSize_=e,this.expire()}}])}();function getCacheKey(e,t,a){return t+":"+e+":"+(a?(0,_color.asArray)(a):"null")}var _default=exports.default=IconImageCache,shared=exports.shared=new IconImageCache;

},{"../ImageState.js":86,"../color.js":113,"../dom.js":130}],390:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _util=require("../util.js"),_size=require("../size.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ImageStyle=function(){function t(e){_classCallCheck(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=(0,_size.toSize)(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}return _createClass(t,[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"getAnchor",value:function(){return(0,_util.abstract)()}},{key:"getImage",value:function(t){return(0,_util.abstract)()}},{key:"getHitDetectionImage",value:function(){return(0,_util.abstract)()}},{key:"getPixelRatio",value:function(t){return 1}},{key:"getImageState",value:function(){return(0,_util.abstract)()}},{key:"getImageSize",value:function(){return(0,_util.abstract)()}},{key:"getOrigin",value:function(){return(0,_util.abstract)()}},{key:"getSize",value:function(){return(0,_util.abstract)()}},{key:"setDisplacement",value:function(t){this.displacement_=t}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=(0,_size.toSize)(t)}},{key:"listenImageChange",value:function(t){(0,_util.abstract)()}},{key:"load",value:function(){(0,_util.abstract)()}},{key:"unlistenImageChange",value:function(t){(0,_util.abstract)()}},{key:"ready",value:function(){return Promise.resolve()}}])}(),_default=exports.default=ImageStyle;

},{"../size.js":337,"../util.js":404}],391:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("./Image.js")),_color=require("../color.js"),_colorlike=require("../colorlike.js"),_dom=require("../dom.js"),_canvas=require("../render/canvas.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var RegularShape=function(e){function t(e){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[{opacity:1,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode}])).canvases_,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=e.radius,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.size_,i.renderOptions_,i.imageState_=i.fill_&&i.fill_.loading()?_ImageState.default.LOADING:_ImageState.default.LOADED,i.imageState_===_ImageState.default.LOADING&&i.ready().then(function(){return i.imageState_=_ImageState.default.LOADED}),i.render(),i}return _inherits(t,_Image["default"]),_createClass(t,[{key:"clone",value:function(){var e=this.getScale(),i=new t({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return i.setOpacity(this.getOpacity()),i}},{key:"getAnchor",value:function(){var e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(e){this.fill_=e,this.render()}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}},{key:"getImage",value:function(e){var t=this.canvases_[e];if(!t){var i=this.renderOptions_,r=(0,_dom.createCanvasContext2D)(i.size*e,i.size*e);this.draw_(i,r,e),t=r.canvas,this.canvases_[e]=t}return t}},{key:"getPixelRatio",value:function(e){return e}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius_}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(e){this.stroke_=e,this.render()}},{key:"listenImageChange",value:function(e){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(e){}},{key:"calculateLineJoinSize_",value:function(e,t,i){if(0===t||this.points_===1/0||"bevel"!==e&&"miter"!==e)return t;var r=this.radius_,n=void 0===this.radius2_?r:this.radius2_;if(r<n){var a=r;r=n,n=a}var o=void 0===this.radius2_?this.points_:2*this.points_,s=2*Math.PI/o,l=n*Math.sin(s),u=r-Math.sqrt(n*n-l*l),c=Math.sqrt(l*l+u*u),f=c/l;if("miter"===e&&f<=i)return f*t;var h=t/2/f,_=t/2*(u/c),d=Math.sqrt((r+h)*(r+h)+_*_)-r;if(void 0===this.radius2_||"bevel"===e)return 2*d;var v=r*Math.sin(s),y=n-Math.sqrt(r*r-v*v),p=Math.sqrt(v*v+y*y)/v;if(p<=i){var g=p*t/2-n-r;return 2*Math.max(d,g)}return 2*d}},{key:"createRenderOptions",value:function(){var e,t,i,r,n,a,o,s=_canvas.defaultLineCap,l=_canvas.defaultLineJoin,u=0,c=null,f=0,h=0;this.stroke_&&(e=(0,_colorlike.asColorLike)(null!==(t=this.stroke_.getColor())&&void 0!==t?t:_canvas.defaultStrokeStyle),h=null!==(i=this.stroke_.getWidth())&&void 0!==i?i:_canvas.defaultLineWidth,c=this.stroke_.getLineDash(),f=null!==(r=this.stroke_.getLineDashOffset())&&void 0!==r?r:0,l=null!==(n=this.stroke_.getLineJoin())&&void 0!==n?n:_canvas.defaultLineJoin,s=null!==(a=this.stroke_.getLineCap())&&void 0!==a?a:_canvas.defaultLineCap,u=null!==(o=this.stroke_.getMiterLimit())&&void 0!==o?o:_canvas.defaultMiterLimit);var _=this.calculateLineJoinSize_(l,h,u),d=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:e,strokeWidth:h,size:Math.ceil(2*d+_),lineCap:s,lineDash:c,lineDashOffset:f,lineJoin:l,miterLimit:u}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var e=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[e,e]}},{key:"draw_",value:function(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){var r=this.fill_.getColor();null===r&&(r=_canvas.defaultFillStyle),t.fillStyle=(0,_colorlike.asColorLike)(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}},{key:"createHitDetectionCanvas_",value:function(e){var t;if(this.fill_){var i=this.fill_.getColor(),r=0;"string"==typeof i&&(i=(0,_color.asArray)(i)),null===i?r=1:Array.isArray(i)&&(r=4===i.length?i[3]:1),0===r&&(t=(0,_dom.createCanvasContext2D)(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}},{key:"createPath_",value:function(e){var t=this.points_,i=this.radius_;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{var r=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(t*=2);for(var n=this.angle_-Math.PI/2,a=2*Math.PI/t,o=0;o<t;o++){var s=n+o*a,l=o%2==0?i:r;e.lineTo(l*Math.cos(s),l*Math.sin(s))}e.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=_canvas.defaultFillStyle,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}},{key:"ready",value:function(){return this.fill_?this.fill_.ready():Promise.resolve()}}])}(),_default=exports.default=RegularShape;

},{"../ImageState.js":86,"../color.js":113,"../colorlike.js":114,"../dom.js":130,"../render/canvas.js":297,"./Image.js":390}],392:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Stroke=function(){function e(t){_classCallCheck(this,e),t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return _createClass(e,[{key:"clone",value:function(){var t=this.getColor();return new e({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(e){this.color_=e}},{key:"setLineCap",value:function(e){this.lineCap_=e}},{key:"setLineDash",value:function(e){this.lineDash_=e}},{key:"setLineDashOffset",value:function(e){this.lineDashOffset_=e}},{key:"setLineJoin",value:function(e){this.lineJoin_=e}},{key:"setMiterLimit",value:function(e){this.miterLimit_=e}},{key:"setWidth",value:function(e){this.width_=e}}])}(),_default=exports.default=Stroke;

},{}],393:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDefaultStyle=createDefaultStyle,exports.createEditingStyle=createEditingStyle,exports.default=void 0,exports.toFunction=toFunction;var _Circle=_interopRequireDefault(require("./Circle.js")),_Fill=_interopRequireDefault(require("./Fill.js")),_Stroke=_interopRequireDefault(require("./Stroke.js")),_asserts=require("../asserts.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Style=function(){function e(t){_classCallCheck(this,e),t=t||{},this.geometry_=null,this.geometryFunction_=defaultGeometryFunction,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}return _createClass(e,[{key:"clone",value:function(){var t,r,n=this.getGeometry();return n&&"object"===_typeof(n)&&(n=n.clone()),new e({geometry:null!==(t=n)&&void 0!==t?t:void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:null!==(r=this.getRenderer())&&void 0!==r?r:void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(e){this.renderer_=e}},{key:"setHitDetectionRenderer",value:function(e){this.hitDetectionRenderer_=e}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(e){this.fill_=e}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(e){this.image_=e}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(e){this.stroke_=e}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(e){this.text_=e}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(e){"function"==typeof e?this.geometryFunction_=e:"string"==typeof e?this.geometryFunction_=function(t){return t.get(e)}:e?void 0!==e&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=defaultGeometryFunction,this.geometry_=e}},{key:"setZIndex",value:function(e){this.zIndex_=e}}])}();function toFunction(e){var t;if("function"==typeof e)t=e;else{var r;if(Array.isArray(e))r=e;else(0,_asserts.assert)("function"==typeof e.getZIndex,"Expected an `Style` or an array of `Style`"),r=[e];t=function(){return r}}return t}var defaultStyles=null;function createDefaultStyle(e,t){if(!defaultStyles){var r=new _Fill.default({color:"rgba(255,255,255,0.4)"}),n=new _Stroke.default({color:"#3399CC",width:1.25});defaultStyles=[new Style({image:new _Circle.default({fill:r,stroke:n,radius:5}),fill:r,stroke:n})]}return defaultStyles}function createEditingStyle(){var e={},t=[255,255,255,1],r=[0,153,255,1];return e.Polygon=[new Style({fill:new _Fill.default({color:[255,255,255,.5]})})],e.MultiPolygon=e.Polygon,e.LineString=[new Style({stroke:new _Stroke.default({color:t,width:5})}),new Style({stroke:new _Stroke.default({color:r,width:3})})],e.MultiLineString=e.LineString,e.Circle=e.Polygon.concat(e.LineString),e.Point=[new Style({image:new _Circle.default({radius:6,fill:new _Fill.default({color:r}),stroke:new _Stroke.default({color:t,width:1.5})}),zIndex:1/0})],e.MultiPoint=e.Point,e.GeometryCollection=e.Polygon.concat(e.LineString,e.Point),e}function defaultGeometryFunction(e){return e.getGeometry()}var _default=exports.default=Style;

},{"../asserts.js":111,"./Circle.js":385,"./Fill.js":386,"./Stroke.js":392}],394:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Fill=_interopRequireDefault(require("./Fill.js")),_size=require("../size.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var DEFAULT_FILL_COLOR="#333",Text=function(){function t(e){_classCallCheck(this,t),e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=(0,_size.toSize)(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new _Fill.default({color:DEFAULT_FILL_COLOR}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding,this.declutterMode_=e.declutterMode}return _createClass(t,[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getRepeat",value:function(){return this.repeat_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"setOverflow",value:function(t){this.overflow_=t}},{key:"setFont",value:function(t){this.font_=t}},{key:"setMaxAngle",value:function(t){this.maxAngle_=t}},{key:"setOffsetX",value:function(t){this.offsetX_=t}},{key:"setOffsetY",value:function(t){this.offsetY_=t}},{key:"setPlacement",value:function(t){this.placement_=t}},{key:"setRepeat",value:function(t){this.repeat_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setFill",value:function(t){this.fill_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=(0,_size.toSize)(void 0!==t?t:1)}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"setText",value:function(t){this.text_=t}},{key:"setTextAlign",value:function(t){this.textAlign_=t}},{key:"setJustify",value:function(t){this.justify_=t}},{key:"setTextBaseline",value:function(t){this.textBaseline_=t}},{key:"setBackgroundFill",value:function(t){this.backgroundFill_=t}},{key:"setBackgroundStroke",value:function(t){this.backgroundStroke_=t}},{key:"setPadding",value:function(t){this.padding_=t}}])}(),_default=exports.default=Text;

},{"../size.js":337,"./Fill.js":386}],395:[function(require,module,exports){
"use strict";function createDefaultStyle(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDefaultStyle=createDefaultStyle;

},{}],396:[function(require,module,exports){
"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,o,i,u=[],l=!0,y=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=o.call(t)).done)&&(u.push(n.value),u.length!==r);l=!0);}catch(e){y=!0,a=e}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(y)throw a}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function createOrUpdate(e,r,t,n){return void 0!==n?(n[0]=e,n[1]=r,n[2]=t,n):[e,r,t]}function getKeyZXY(e,r,t){return e+"/"+r+"/"+t}function getKey(e){return getKeyZXY(e[0],e[1],e[2])}function getCacheKeyForTileKey(e){var r=_slicedToArray(e.substring(e.lastIndexOf("/")+1,e.length).split(",").map(Number),3);return getKeyZXY(r[0],r[1],r[2])}function fromKey(e){return e.split("/").map(Number)}function hash(e){return(e[1]<<e[0])+e[2]}function withinExtentAndZ(e,r){var t=e[0],n=e[1],a=e[2];if(r.getMinZoom()>t||t>r.getMaxZoom())return!1;var o=r.getFullTileRange(t);return!o||o.containsXY(n,a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=createOrUpdate,exports.fromKey=fromKey,exports.getCacheKeyForTileKey=getCacheKeyForTileKey,exports.getKey=getKey,exports.getKeyZXY=getKeyZXY,exports.hash=hash,exports.withinExtentAndZ=withinExtentAndZ;

},{}],397:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"TileGrid",{enumerable:!0,get:function(){return _TileGrid.default}}),Object.defineProperty(exports,"WMTS",{enumerable:!0,get:function(){return _WMTS.default}}),exports.createForExtent=createForExtent,exports.createForProjection=createForProjection,exports.createXYZ=createXYZ,exports.extentFromProjection=extentFromProjection,exports.getForProjection=getForProjection,exports.wrapX=wrapX;var _TileGrid=_interopRequireDefault(require("./tilegrid/TileGrid.js")),_common=require("./tilegrid/common.js"),_proj=require("./proj.js"),_extent=require("./extent.js"),_size=require("./size.js"),_WMTS=_interopRequireDefault(require("./tilegrid/WMTS.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function getForProjection(e){var t=e.getDefaultTileGrid();return t||(t=createForProjection(e),e.setDefaultTileGrid(t)),t}function wrapX(e,t,r){var o=t[0],n=e.getTileCoordCenter(t),i=extentFromProjection(r);if(!(0,_extent.containsCoordinate)(i,n)){var u=(0,_extent.getWidth)(i),a=Math.ceil((i[0]-n[0])/u);return n[0]+=u*a,e.getTileCoordForCoordAndZ(n,o)}return t}function createForExtent(e,t,r,o){o=void 0!==o?o:"top-left";var n=resolutionsFromExtent(e,t,r);return new _TileGrid.default({extent:e,origin:(0,_extent.getCorner)(e,o),resolutions:n,tileSize:r})}function createXYZ(e){var t=e||{},r=t.extent||(0,_proj.get)("EPSG:3857").getExtent(),o={extent:r,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:resolutionsFromExtent(r,t.maxZoom,t.tileSize,t.maxResolution)};return new _TileGrid.default(o)}function resolutionsFromExtent(e,t,r,o){t=void 0!==t?t:_common.DEFAULT_MAX_ZOOM,r=(0,_size.toSize)(void 0!==r?r:_common.DEFAULT_TILE_SIZE);var n=(0,_extent.getHeight)(e),i=(0,_extent.getWidth)(e);o=o>0?o:Math.max(i/r[0],n/r[1]);for(var u=t+1,a=new Array(u),c=0;c<u;++c)a[c]=o/Math.pow(2,c);return a}function createForProjection(e,t,r,o){return createForExtent(extentFromProjection(e),t,r,o)}function extentFromProjection(e){var t=(e=(0,_proj.get)(e)).getExtent();if(!t){var r=180*_proj.METERS_PER_UNIT.degrees/e.getMetersPerUnit();t=(0,_extent.createOrUpdate)(-r,-r,r,r)}return t}

},{"./extent.js":142,"./proj.js":283,"./size.js":337,"./tilegrid/TileGrid.js":398,"./tilegrid/WMTS.js":399,"./tilegrid/common.js":400}],398:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileRange=_interopRequireWildcard(require("../TileRange.js")),_common=require("./common.js"),_asserts=require("../asserts.js"),_math=require("../math.js"),_extent=require("../extent.js"),_tilecoord=require("../tilecoord.js"),_intersectsextent=require("../geom/flat/intersectsextent.js"),_array=require("../array.js"),_size=require("../size.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(e){return e?i:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var i=_getRequireWildcardCache(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&{}.hasOwnProperty.call(e,n)){var s=o?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(r,n,s):r[n]=e[n]}return r.default=e,i&&i.set(e,r),r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var tmpTileCoord=[0,0,0],DECIMALS=5,TileGrid=function(){return _createClass(function e(t){var i,r=this;if(_classCallCheck(this,e),this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,(0,_asserts.assert)((0,_array.isSorted)(this.resolutions_,function(e,t){return t-e},!0),"`resolutions` must be sorted in descending order"),!t.origins)for(var o=0,n=this.resolutions_.length-1;o<n;++o)if(i){if(this.resolutions_[o]/this.resolutions_[o+1]!==i){i=void 0;break}}else i=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,(0,_asserts.assert)(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));var s=t.extent;void 0===s||this.origin_||this.origins_||(this.origin_=(0,_extent.getTopLeft)(s)),(0,_asserts.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,(0,_asserts.assert)(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:_common.DEFAULT_TILE_SIZE,(0,_asserts.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==s?s:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(e,t){var i=new _TileRange.default(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));if(s){var o=r.getTileRangeForExtentAndZ(s,t);i.minX=Math.max(o.minX,i.minX),i.maxX=Math.min(o.maxX,i.maxX),i.minY=Math.max(o.minY,i.minY),i.maxY=Math.min(o.maxY,i.maxY)}return i}):s&&this.calculateTileRanges_(s)},[{key:"forEachTileCoord",value:function(e,t,i){for(var r=this.getTileRangeForExtentAndZ(e,t),o=r.minX,n=r.maxX;o<=n;++o)for(var s=r.minY,l=r.maxY;s<=l;++s)i([t,o,s])}},{key:"forEachTileCoordParentTileRange",value:function(e,t,i,r){var o,n,s,l=null,a=e[0]-1;for(2===this.zoomFactor_?(n=e[1],s=e[2]):l=this.getTileCoordExtent(e,r);a>=this.minZoom;){if(void 0!==n&&void 0!==s?(n=Math.floor(n/2),s=Math.floor(s/2),o=(0,_TileRange.createOrUpdate)(n,n,s,s,i)):o=this.getTileRangeForExtentAndZ(l,a,i),t(a,o))return!0;--a}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(e){return this.origin_?this.origin_:this.origins_[e]}},{key:"getResolution",value:function(e){return this.resolutions_[e]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(e,t,i){if(e[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*e[1],o=2*e[2];return(0,_TileRange.createOrUpdate)(r,r+1,o,o+1,t)}var n=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,e[0]+1,t)}return null}},{key:"getTileRangeForTileCoordAndZ",value:function(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;var r=e[0],o=e[1],n=e[2];if(t===r)return(0,_TileRange.createOrUpdate)(o,n,o,n,i);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,t-r),l=Math.floor(o*s),a=Math.floor(n*s);if(t<r)return(0,_TileRange.createOrUpdate)(l,l,a,a,i);var u=Math.floor(s*(o+1))-1,h=Math.floor(s*(n+1))-1;return(0,_TileRange.createOrUpdate)(l,u,a,h,i)}var _=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(_,t,i)}},{key:"getTileRangeForExtentAndZ",value:function(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,tmpTileCoord);var r=tmpTileCoord[1],o=tmpTileCoord[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,tmpTileCoord);var n=tmpTileCoord[1],s=tmpTileCoord[2];return(0,_TileRange.createOrUpdate)(r,n,o,s,i)}},{key:"getTileCoordCenter",value:function(e){var t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=(0,_size.toSize)(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}},{key:"getTileCoordExtent",value:function(e,t){var i=this.getOrigin(e[0]),r=this.getResolution(e[0]),o=(0,_size.toSize)(this.getTileSize(e[0]),this.tmpSize_),n=i[0]+e[1]*o[0]*r,s=i[1]-(e[2]+1)*o[1]*r,l=n+o[0]*r,a=s+o[1]*r;return(0,_extent.createOrUpdate)(n,s,l,a,t)}},{key:"getTileCoordForCoordAndResolution",value:function(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}},{key:"getTileCoordForXYAndResolution_",value:function(e,t,i,r,o){var n=this.getZForResolution(i),s=i/this.getResolution(n),l=this.getOrigin(n),a=(0,_size.toSize)(this.getTileSize(n),this.tmpSize_),u=s*(e-l[0])/i/a[0],h=s*(l[1]-t)/i/a[1];return r?(u=(0,_math.ceil)(u,DECIMALS)-1,h=(0,_math.ceil)(h,DECIMALS)-1):(u=(0,_math.floor)(u,DECIMALS),h=(0,_math.floor)(h,DECIMALS)),(0,_tilecoord.createOrUpdate)(n,u,h,o)}},{key:"getTileCoordForXYAndZ_",value:function(e,t,i,r,o){var n=this.getOrigin(i),s=this.getResolution(i),l=(0,_size.toSize)(this.getTileSize(i),this.tmpSize_),a=(e-n[0])/s/l[0],u=(n[1]-t)/s/l[1];return r?(a=(0,_math.ceil)(a,DECIMALS)-1,u=(0,_math.ceil)(u,DECIMALS)-1):(a=(0,_math.floor)(a,DECIMALS),u=(0,_math.floor)(u,DECIMALS)),(0,_tilecoord.createOrUpdate)(i,a,u,o)}},{key:"getTileCoordForCoordAndZ",value:function(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}},{key:"getTileCoordResolution",value:function(e){return this.resolutions_[e[0]]}},{key:"getTileSize",value:function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}},{key:"getFullTileRange",value:function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}},{key:"getZForResolution",value:function(e,t){var i=(0,_array.linearFindNearest)(this.resolutions_,e,t||0);return(0,_math.clamp)(i,this.minZoom,this.maxZoom)}},{key:"tileCoordIntersectsViewport",value:function(e,t){return(0,_intersectsextent.intersectsLinearRing)(t,0,t.length,2,this.getTileCoordExtent(e))}},{key:"calculateTileRanges_",value:function(e){for(var t=this.resolutions_.length,i=new Array(t),r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}])}(),_default=exports.default=TileGrid;

},{"../TileRange.js":103,"../array.js":110,"../asserts.js":111,"../extent.js":142,"../geom/flat/intersectsextent.js":223,"../math.js":279,"../size.js":337,"../tilecoord.js":396,"./common.js":400}],399:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromCapabilitiesMatrixSet=createFromCapabilitiesMatrixSet,exports.default=void 0;var _TileGrid2=_interopRequireDefault(require("./TileGrid.js")),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var WMTSTileGrid=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}])).matrixIds_=e.matrixIds,r}return _inherits(t,_TileGrid2["default"]),_createClass(t,[{key:"getMatrixId",value:function(e){return this.matrixIds_[e]}},{key:"getMatrixIds",value:function(){return this.matrixIds_}}])}(),_default=exports.default=WMTSTileGrid;function createFromCapabilitiesMatrixSet(e,t,r){var i=[],o=[],n=[],u=[],s=[];r=void 0!==r?r:[];var a=e.SupportedCRS,f=(0,_proj.get)(a),l=f.getMetersPerUnit(),c="ne"==f.getAxisOrientation().substr(0,2);return e.TileMatrix.sort(function(e,t){return t.ScaleDenominator-e.ScaleDenominator}),e.TileMatrix.forEach(function(t){if(!(r.length>0)||r.find(function(r){return t.Identifier==r.TileMatrix||!t.Identifier.includes(":")&&e.Identifier+":"+t.Identifier===r.TileMatrix})){o.push(t.Identifier);var a=28e-5*t.ScaleDenominator/l,f=t.TileWidth,p=t.TileHeight;c?n.push([t.TopLeftCorner[1],t.TopLeftCorner[0]]):n.push(t.TopLeftCorner),i.push(a),u.push(f==p?f:[f,p]),s.push([t.MatrixWidth,t.MatrixHeight])}}),new WMTSTileGrid({extent:t,origins:n,resolutions:i,matrixIds:o,tileSizes:u,sizes:s})}

},{"../proj.js":283,"./TileGrid.js":398}],400:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_TILE_SIZE=exports.DEFAULT_MAX_ZOOM=void 0;var DEFAULT_MAX_ZOOM=exports.DEFAULT_MAX_ZOOM=42,DEFAULT_TILE_SIZE=exports.DEFAULT_TILE_SIZE=256;

},{}],401:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromTemplate=createFromTemplate,exports.createFromTemplates=createFromTemplates,exports.createFromTileUrlFunctions=createFromTileUrlFunctions,exports.expandUrl=expandUrl,exports.nullTileUrlFunction=nullTileUrlFunction;var _math=require("./math.js"),_tilecoord=require("./tilecoord.js");function createFromTemplate(e,r){var t=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,a=/\{-y\}/g;return function(l,i,c){if(l)return e.replace(t,l[0].toString()).replace(n,l[1].toString()).replace(o,l[2].toString()).replace(a,function(){var e=l[0],t=r.getFullTileRange(e);if(!t)throw new Error("The {-y} placeholder requires a tile grid with extent");return(t.getHeight()-l[2]-1).toString()})}}function createFromTemplates(e,r){for(var t=e.length,n=new Array(t),o=0;o<t;++o)n[o]=createFromTemplate(e[o],r);return createFromTileUrlFunctions(n)}function createFromTileUrlFunctions(e){return 1===e.length?e[0]:function(r,t,n){if(r){var o=(0,_tilecoord.hash)(r),a=(0,_math.modulo)(o,e.length);return e[a](r,t,n)}}}function nullTileUrlFunction(e,r,t){}function expandUrl(e){var r=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var n,o=t[1].charCodeAt(0),a=t[2].charCodeAt(0);for(n=o;n<=a;++n)r.push(e.replace(t[0],String.fromCharCode(n)));return r}if(t=/\{(\d+)-(\d+)\}/.exec(e)){for(var l=parseInt(t[2],10),i=parseInt(t[1],10);i<=l;i++)r.push(e.replace(t[0],i.toString()));return r}return r.push(e),r}

},{"./math.js":279,"./tilecoord.js":396}],402:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.apply=apply,exports.compose=compose,exports.composeCssTransform=composeCssTransform,exports.create=create,exports.determinant=determinant,exports.invert=invert,exports.makeInverse=makeInverse,exports.makeScale=makeScale,exports.multiply=multiply,exports.reset=reset,exports.rotate=rotate,exports.scale=scale,exports.set=set,exports.setFromArray=setFromArray,exports.toString=toString,exports.translate=translate;var _asserts=require("./asserts.js"),tmp_=new Array(6);function create(){return[1,0,0,1,0,0]}function reset(t){return set(t,1,0,0,1,0,0)}function multiply(t,e){var r=t[0],n=t[1],s=t[2],o=t[3],a=t[4],i=t[5],u=e[0],c=e[1],p=e[2],m=e[3],l=e[4],f=e[5];return t[0]=r*u+s*c,t[1]=n*u+o*c,t[2]=r*p+s*m,t[3]=n*p+o*m,t[4]=r*l+s*f+a,t[5]=n*l+o*f+i,t}function set(t,e,r,n,s,o,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=o,t[5]=a,t}function setFromArray(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function apply(t,e){var r=e[0],n=e[1];return e[0]=t[0]*r+t[2]*n+t[4],e[1]=t[1]*r+t[3]*n+t[5],e}function rotate(t,e){var r=Math.cos(e),n=Math.sin(e);return multiply(t,set(tmp_,r,n,-n,r,0,0))}function scale(t,e,r){return multiply(t,set(tmp_,e,0,0,r,0,0))}function makeScale(t,e,r){return set(t,e,0,0,r,0,0)}function translate(t,e,r){return multiply(t,set(tmp_,1,0,0,1,e,r))}function compose(t,e,r,n,s,o,a,i){var u=Math.sin(o),c=Math.cos(o);return t[0]=n*c,t[1]=s*u,t[2]=-n*u,t[3]=s*c,t[4]=a*n*c-i*n*u+e,t[5]=a*s*u+i*s*c+r,t}function composeCssTransform(t,e,r,n,s,o,a){return toString(compose(create(),t,e,r,n,s,o,a))}function invert(t){return makeInverse(t,t)}function makeInverse(t,e){var r=determinant(e);(0,_asserts.assert)(0!==r,"Transformation matrix cannot be inverted");var n=e[0],s=e[1],o=e[2],a=e[3],i=e[4],u=e[5];return t[0]=a/r,t[1]=-s/r,t[2]=-o/r,t[3]=n/r,t[4]=(o*u-a*i)/r,t[5]=-(n*u-s*i)/r,t}function determinant(t){return t[0]*t[3]-t[1]*t[2]}var matrixPrecision=[1e6,1e6,1e6,1e6,2,2];function toString(t){return"matrix("+t.map(function(t,e){return Math.round(t*matrixPrecision[e])/matrixPrecision[e]}).join(", ")+")"}

},{"./asserts.js":111}],403:[function(require,module,exports){
"use strict";function appendParams(e,n){var a=[];Object.keys(n).forEach(function(e){null!==n[e]&&void 0!==n[e]&&a.push(e+"="+encodeURIComponent(n[e]))});var r=a.join("&");return e=e.replace(/[?&]$/,""),(e+=e.includes("?")?"&":"?")+r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.appendParams=appendParams;

},{}],404:[function(require,module,exports){
"use strict";function _abstract(){throw new Error("Unimplemented abstract method.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0,exports.abstract=_abstract,exports.getUid=getUid;var uidCounter_=0;function getUid(t){return t.ol_uid||(t.ol_uid=String(++uidCounter_))}var VERSION=exports.VERSION="9.2.4";

},{}],405:[function(require,module,exports){
"use strict";function create(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function fromTransform(r,e){return r[0]=e[0],r[1]=e[1],r[4]=e[2],r[5]=e[3],r[12]=e[4],r[13]=e[5],r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=create,exports.fromTransform=fromTransform;

},{}],406:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UNSIGNED_SHORT=exports.UNSIGNED_INT=exports.UNSIGNED_BYTE=exports.STREAM_DRAW=exports.STATIC_DRAW=exports.FLOAT=exports.ELEMENT_ARRAY_BUFFER=exports.DYNAMIC_DRAW=exports.ARRAY_BUFFER=void 0,exports.getContext=getContext,exports.getSupportedExtensions=getSupportedExtensions;var _has=require("./has.js"),ARRAY_BUFFER=exports.ARRAY_BUFFER=34962,ELEMENT_ARRAY_BUFFER=exports.ELEMENT_ARRAY_BUFFER=34963,STREAM_DRAW=exports.STREAM_DRAW=35040,STATIC_DRAW=exports.STATIC_DRAW=35044,DYNAMIC_DRAW=exports.DYNAMIC_DRAW=35048,UNSIGNED_BYTE=exports.UNSIGNED_BYTE=5121,UNSIGNED_SHORT=exports.UNSIGNED_SHORT=5123,UNSIGNED_INT=exports.UNSIGNED_INT=5125,FLOAT=exports.FLOAT=5126,CONTEXT_IDS=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function getContext(e,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!_has.SAFARI_BUG_237906},t);for(var r=CONTEXT_IDS.length,s=0;s<r;++s)try{var o=e.getContext(CONTEXT_IDS[s],t);if(o)return o}catch(e){}return null}var supportedExtensions=null;function getSupportedExtensions(){if(!supportedExtensions){var e=getContext(document.createElement("canvas"));e&&(supportedExtensions=e.getSupportedExtensions())}return supportedExtensions}

},{"./has.js":233}],407:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Target=_interopRequireDefault(require("../events/Target.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageTile=_interopRequireDefault(require("../ImageTile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseTileRepresentation=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).tile,r.handleTileChange_=r.handleTileChange_.bind(r),r.gutter_=e.gutter||0,r.helper_=e.helper,r.loaded=!1,r.ready=!1,r}return _inherits(t,_Target["default"]),_createClass(t,[{key:"setTile",value:function(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(_EventType.default.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===_TileState.default.LOADED,this.loaded)this.uploadTile();else{if(e instanceof _ImageTile.default){var t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener(_EventType.default.CHANGE,this.handleTileChange_)}}},{key:"uploadTile",value:function(){(0,_util.abstract)()}},{key:"setReady",value:function(){this.ready=!0,this.dispatchEvent(_EventType.default.CHANGE)}},{key:"handleTileChange_",value:function(){this.tile.getState()===_TileState.default.LOADED&&(this.loaded=!0,this.uploadTile())}},{key:"disposeInternal",value:function(){this.tile.removeEventListener(_EventType.default.CHANGE,this.handleTileChange_)}}])}(),_default=exports.default=BaseTileRepresentation;

},{"../ImageTile.js":87,"../TileState.js":104,"../events/EventType.js":134,"../events/Target.js":137,"../util.js":404}],408:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.BufferUsage=void 0,exports.getArrayClassForType=getArrayClassForType;var _webgl=require("../webgl.js"),_asserts=require("../asserts.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var BufferUsage=exports.BufferUsage={STATIC_DRAW:_webgl.STATIC_DRAW,STREAM_DRAW:_webgl.STREAM_DRAW,DYNAMIC_DRAW:_webgl.DYNAMIC_DRAW},WebGLArrayBuffer=function(){return _createClass(function e(r,t){_classCallCheck(this,e),this.array_=null,this.type_=r,(0,_asserts.assert)(r===_webgl.ARRAY_BUFFER||r===_webgl.ELEMENT_ARRAY_BUFFER,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=void 0!==t?t:BufferUsage.STATIC_DRAW},[{key:"ofSize",value:function(e){return this.array_=new(getArrayClassForType(this.type_))(e),this}},{key:"fromArray",value:function(e){return this.array_=getArrayClassForType(this.type_).from(e),this}},{key:"fromArrayBuffer",value:function(e){return this.array_=new(getArrayClassForType(this.type_))(e),this}},{key:"getType",value:function(){return this.type_}},{key:"getArray",value:function(){return this.array_}},{key:"getUsage",value:function(){return this.usage_}},{key:"getSize",value:function(){return this.array_?this.array_.length:0}}])}();function getArrayClassForType(e){switch(e){case _webgl.ARRAY_BUFFER:return Float32Array;case _webgl.ELEMENT_ARRAY_BUFFER:return Uint32Array;default:return Float32Array}}var _default=exports.default=WebGLArrayBuffer;

},{"../asserts.js":111,"../webgl.js":406}],409:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};

},{}],410:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShaderType=exports.DefaultUniform=exports.AttributeType=void 0,exports.computeAttributesStride=computeAttributesStride,exports.default=void 0;var _ContextEventType=_interopRequireDefault(require("../webgl/ContextEventType.js")),_Disposable2=_interopRequireDefault(require("../Disposable.js")),_PostProcessingPass=_interopRequireDefault(require("./PostProcessingPass.js")),_webgl=require("../webgl.js"),_obj=require("../obj.js"),_transform=require("../transform.js"),_mat=require("../vec/mat4.js"),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ShaderType=exports.ShaderType={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633},DefaultUniform=exports.DefaultUniform={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},AttributeType=exports.AttributeType={UNSIGNED_BYTE:_webgl.UNSIGNED_BYTE,UNSIGNED_SHORT:_webgl.UNSIGNED_SHORT,UNSIGNED_INT:_webgl.UNSIGNED_INT,FLOAT:_webgl.FLOAT},canvasCache={};function getSharedCanvasCacheKey(e){return"shared/"+e}var uniqueCanvasCacheKeyCount=0;function getUniqueCanvasCacheKey(){var e="unique/"+uniqueCanvasCacheKeyCount;return uniqueCanvasCacheKeyCount+=1,e}function getOrCreateContext(e){var t=canvasCache[e];if(!t){var r=document.createElement("canvas");r.width=1,r.height=1,r.style.position="absolute",r.style.left="0",t={users:0,context:(0,_webgl.getContext)(r)},canvasCache[e]=t}return t.users+=1,t.context}function releaseCanvas(e){var t=canvasCache[e];if(t&&(t.users-=1,!(t.users>0))){var r=t.context,n=r.getExtension("WEBGL_lose_context");n&&n.loseContext();var a=r.canvas;a.width=1,a.height=1,delete canvasCache[e]}}var WebGLHelper=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvasCacheKey_=e.canvasCacheKey?getSharedCanvasCacheKey(e.canvasCacheKey):getUniqueCanvasCacheKey(),r.gl_=getOrCreateContext(r.canvasCacheKey_),r.bufferCache_={},r.extensionCache_={},r.currentProgram_=null,r.needsToBeRecreated_=!1;var n=r.gl_.canvas;return n.addEventListener(_ContextEventType.default.LOST,r.boundHandleWebGLContextLost_),n.addEventListener(_ContextEventType.default.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=(0,_transform.create)(),r.offsetScaleMatrix_=(0,_transform.create)(),r.tmpMat4_=(0,_mat.create)(),r.uniformLocationsByProgram_={},r.attribLocationsByProgram_={},r.uniforms_=[],e.uniforms&&r.setUniforms(e.uniforms),r.postProcessPasses_=e.postProcesses?e.postProcesses.map(function(e){return new _PostProcessingPass.default({webGlContext:r.gl_,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})}):[new _PostProcessingPass.default({webGlContext:r.gl_})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"setUniforms",value:function(e){this.uniforms_=[],this.addUniforms(e)}},{key:"addUniforms",value:function(e){for(var t in e)this.uniforms_.push({name:t,value:e[t]})}},{key:"canvasCacheKeyMatches",value:function(e){return this.canvasCacheKey_===getSharedCanvasCacheKey(e)}},{key:"getExtension",value:function(e){if(e in this.extensionCache_)return this.extensionCache_[e];var t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}},{key:"bindBuffer",value:function(e){var t=this.gl_,r=(0,_util.getUid)(e),n=this.bufferCache_[r];n||(n={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=n);t.bindBuffer(e.getType(),n.webGlBuffer)}},{key:"flushBufferData",value:function(e){var t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}},{key:"deleteBuffer",value:function(e){var t=this.gl_,r=(0,_util.getUid)(e),n=this.bufferCache_[r];n&&!t.isContextLost()&&t.deleteBuffer(n.webGlBuffer),delete this.bufferCache_[r]}},{key:"disposeInternal",value:function(){var e=this.gl_.canvas;e.removeEventListener(_ContextEventType.default.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(_ContextEventType.default.RESTORED,this.boundHandleWebGLContextRestored_),releaseCanvas(this.canvasCacheKey_),delete this.gl_}},{key:"prepareDraw",value:function(e,t,r){var n=this.gl_,a=this.getCanvas(),o=e.size,i=e.pixelRatio;a.width===o[0]*i&&a.height===o[1]*i||(a.width=o[0]*i,a.height=o[1]*i,a.style.width=o[0]+"px",a.style.height=o[1]+"px");for(var s=this.postProcessPasses_.length-1;s>=0;s--)this.postProcessPasses_[s].init(e);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.depthRange(0,1),n.clearDepth(1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,t?n.ZERO:n.ONE_MINUS_SRC_ALPHA),r?(n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL)):n.disable(n.DEPTH_TEST)}},{key:"bindTexture",value:function(e,t,r){var n=this.gl_;n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,e),n.uniform1i(this.getUniformLocation(r),t)}},{key:"prepareDrawToRenderTarget",value:function(e,t,r,n){var a=this.gl_,o=t.getSize();a.bindFramebuffer(a.FRAMEBUFFER,t.getFramebuffer()),a.bindRenderbuffer(a.RENDERBUFFER,t.getDepthbuffer()),a.viewport(0,0,o[0],o[1]),a.bindTexture(a.TEXTURE_2D,t.getTexture()),a.clearColor(0,0,0,0),a.depthRange(0,1),a.clearDepth(1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.enable(a.BLEND),a.blendFunc(a.ONE,r?a.ZERO:a.ONE_MINUS_SRC_ALPHA),n?(a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST)}},{key:"drawElements",value:function(e,t){var r=this.gl_;this.getExtension("OES_element_index_uint");var n=r.UNSIGNED_INT,a=t-e,o=4*e;r.drawElements(r.TRIANGLES,a,n,o)}},{key:"finalizeDraw",value:function(e,t,r){for(var n=0,a=this.postProcessPasses_.length;n<a;n++)n===a-1?this.postProcessPasses_[n].apply(e,null,t,r):this.postProcessPasses_[n].apply(e,this.postProcessPasses_[n+1])}},{key:"getCanvas",value:function(){return this.gl_.canvas}},{key:"getGL",value:function(){return this.gl_}},{key:"applyFrameState",value:function(e){var t=e.size,r=e.viewState.rotation,n=e.pixelRatio;this.setUniformFloatValue(DefaultUniform.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(DefaultUniform.ZOOM,e.viewState.zoom),this.setUniformFloatValue(DefaultUniform.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(DefaultUniform.PIXEL_RATIO,n),this.setUniformFloatVec2(DefaultUniform.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(DefaultUniform.ROTATION,r)}},{key:"applyHitDetectionUniform",value:function(e){var t=this.getUniformLocation(DefaultUniform.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(DefaultUniform.PIXEL_RATIO,.5)}},{key:"applyUniforms",value:function(e){var t,r=this,n=this.gl_,a=0;this.uniforms_.forEach(function(o){if((t="function"==typeof o.value?o.value(e):o.value)instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof ImageData||t instanceof WebGLTexture){t instanceof WebGLTexture&&!o.texture?(o.prevValue=void 0,o.texture=t):o.texture||(o.prevValue=void 0,o.texture=n.createTexture()),r.bindTexture(o.texture,a,o.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var i=!(t instanceof HTMLImageElement)||t.complete;t instanceof WebGLTexture||!i||o.prevValue===t||(o.prevValue=t,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),a++}else if(Array.isArray(t)&&6===t.length)r.setUniformMatrixValue(o.name,(0,_mat.fromTransform)(r.tmpMat4_,t));else if(Array.isArray(t)&&t.length<=4)switch(t.length){case 2:return void n.uniform2f(r.getUniformLocation(o.name),t[0],t[1]);case 3:return void n.uniform3f(r.getUniformLocation(o.name),t[0],t[1],t[2]);case 4:return void n.uniform4f(r.getUniformLocation(o.name),t[0],t[1],t[2],t[3]);default:return}else"number"==typeof t&&n.uniform1f(r.getUniformLocation(o.name),t)})}},{key:"useProgram",value:function(e,t){this.gl_.useProgram(e),this.currentProgram_=e,this.applyFrameState(t),this.applyUniforms(t)}},{key:"compileShader",value:function(e,t){var r=this.gl_,n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n}},{key:"getProgram",value:function(e,t){var r=this.gl_,n=this.compileShader(e,r.FRAGMENT_SHADER),a=this.compileShader(t,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,n),r.attachShader(o,a),r.linkProgram(o),!r.getShaderParameter(n,r.COMPILE_STATUS)){var i="Fragment shader compilation failed: ".concat(r.getShaderInfoLog(n));throw new Error(i)}if(r.deleteShader(n),!r.getShaderParameter(a,r.COMPILE_STATUS)){var s="Vertex shader compilation failed: ".concat(r.getShaderInfoLog(a));throw new Error(s)}if(r.deleteShader(a),!r.getProgramParameter(o,r.LINK_STATUS)){var u="GL program linking failed: ".concat(r.getProgramInfoLog(o));throw new Error(u)}return o}},{key:"getUniformLocation",value:function(e){var t=(0,_util.getUid)(this.currentProgram_);return void 0===this.uniformLocationsByProgram_[t]&&(this.uniformLocationsByProgram_[t]={}),void 0===this.uniformLocationsByProgram_[t][e]&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}},{key:"getAttributeLocation",value:function(e){var t=(0,_util.getUid)(this.currentProgram_);return void 0===this.attribLocationsByProgram_[t]&&(this.attribLocationsByProgram_[t]={}),void 0===this.attribLocationsByProgram_[t][e]&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}},{key:"makeProjectionTransform",value:function(e,t){var r=e.size,n=e.viewState.rotation,a=e.viewState.resolution,o=e.viewState.center;return(0,_transform.compose)(t,0,0,2/(a*r[0]),2/(a*r[1]),-n,-o[0],-o[1]),t}},{key:"setUniformFloatValue",value:function(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}},{key:"setUniformFloatVec2",value:function(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}},{key:"setUniformFloatVec4",value:function(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}},{key:"setUniformMatrixValue",value:function(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}},{key:"enableAttributeArray_",value:function(e,t,r,n,a){var o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,n,a))}},{key:"enableAttributes",value:function(e){for(var t=computeAttributesStride(e),r=0,n=0;n<e.length;n++){var a=e[n];this.enableAttributeArray_(a.name,a.size,a.type||_webgl.FLOAT,t,r),r+=a.size*getByteSizeFromType(a.type)}}},{key:"handleWebGLContextLost",value:function(e){(0,_obj.clear)(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}},{key:"handleWebGLContextRestored",value:function(){this.needsToBeRecreated_=!0}},{key:"needsToBeRecreated",value:function(){return this.needsToBeRecreated_}},{key:"createTexture",value:function(e,t,r){var n=this.gl_;r=r||n.createTexture();var a=n.RGBA,o=n.RGBA,i=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,r),t?n.texImage2D(n.TEXTURE_2D,0,a,o,i,t):n.texImage2D(n.TEXTURE_2D,0,a,e[0],e[1],0,o,i,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r}}])}();function computeAttributesStride(e){for(var t=0,r=0;r<e.length;r++){var n=e[r];t+=n.size*getByteSizeFromType(n.type)}return t}function getByteSizeFromType(e){switch(e){case AttributeType.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case AttributeType.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case AttributeType.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case AttributeType.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var _default=exports.default=WebGLHelper;

},{"../Disposable.js":81,"../obj.js":281,"../transform.js":402,"../util.js":404,"../vec/mat4.js":405,"../webgl.js":406,"../webgl/ContextEventType.js":409,"./PostProcessingPass.js":412}],411:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var PaletteTexture=function(){return _createClass(function e(t,r){_classCallCheck(this,e),this.name=t,this.data=r,this.texture_=null},[{key:"getTexture",value:function(e){if(!this.texture_){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}},{key:"delete",value:function(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}])}(),_default=exports.default=PaletteTexture;

},{}],412:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _util=require("../util.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var DEFAULT_VERTEX_SHADER="\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n",DEFAULT_FRAGMENT_SHADER="\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n",WebGLPostProcessingPass=function(){return _createClass(function e(r){var t=this;_classCallCheck(this,e),this.gl_=r.webGlContext;var i=this.gl_;this.scaleRatio_=r.scaleRatio||1,this.renderTargetTexture_=i.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=i.createFramebuffer(),this.depthBuffer_=i.createRenderbuffer();var a=i.createShader(i.VERTEX_SHADER);i.shaderSource(a,r.vertexShader||DEFAULT_VERTEX_SHADER),i.compileShader(a);var n=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(n,r.fragmentShader||DEFAULT_FRAGMENT_SHADER),i.compileShader(n),this.renderTargetProgram_=i.createProgram(),i.attachShader(this.renderTargetProgram_,a),i.attachShader(this.renderTargetProgram_,n),i.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),i.bufferData(i.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),i.STATIC_DRAW),this.renderTargetAttribLocation_=i.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=i.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],r.uniforms&&Object.keys(r.uniforms).forEach(function(e){t.uniforms_.push({value:r.uniforms[e],location:i.getUniformLocation(t.renderTargetProgram_,e)})})},[{key:"getGL",value:function(){return this.gl_}},{key:"init",value:function(e){var r=this.getGL(),t=[r.drawingBufferWidth*this.scaleRatio_,r.drawingBufferHeight*this.scaleRatio_];if(r.bindFramebuffer(r.FRAMEBUFFER,this.getFrameBuffer()),r.bindRenderbuffer(r.RENDERBUFFER,this.getDepthBuffer()),r.viewport(0,0,t[0],t[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==t[0]||this.renderTargetTextureSize_[1]!==t[1]){this.renderTargetTextureSize_=t;var i=r.RGBA,a=r.RGBA,n=r.UNSIGNED_BYTE;r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.texImage2D(r.TEXTURE_2D,0,i,t[0],t[1],0,a,n,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.renderTargetTexture_,0),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,t[0],t[1]),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.depthBuffer_)}}},{key:"apply",value:function(e,r,t,i){var a=this.getGL(),n=e.size;if(a.bindFramebuffer(a.FRAMEBUFFER,r?r.getFrameBuffer():null),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.renderTargetTexture_),!r){var o=(0,_util.getUid)(a.canvas);if(!e.renderTargets[o]){var f=a.getContextAttributes();f&&f.preserveDrawingBuffer&&(a.clearColor(0,0,0,0),a.clearDepth(1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)),e.renderTargets[o]=!0}}a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.bindBuffer(a.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),a.useProgram(this.renderTargetProgram_),a.enableVertexAttribArray(this.renderTargetAttribLocation_),a.vertexAttribPointer(this.renderTargetAttribLocation_,2,a.FLOAT,!1,0,0),a.uniform2f(this.renderTargetUniformLocation_,n[0],n[1]),a.uniform1i(this.renderTargetTextureLocation_,0);var u=e.layerStatesArray[e.layerIndex].opacity;a.uniform1f(this.renderTargetOpacityLocation_,u),this.applyUniforms(e),t&&t(a,e),a.drawArrays(a.TRIANGLES,0,6),i&&i(a,e)}},{key:"getFrameBuffer",value:function(){return this.frameBuffer_}},{key:"getDepthBuffer",value:function(){return this.depthBuffer_}},{key:"applyUniforms",value:function(e){var r,t=this.getGL(),i=1;this.uniforms_.forEach(function(a){if((r="function"==typeof a.value?a.value(e):a.value)instanceof HTMLCanvasElement||r instanceof ImageData)a.texture||(a.texture=t.createTexture()),t.activeTexture(t["TEXTURE".concat(i)]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(a.location,i++);else if(Array.isArray(r))switch(r.length){case 2:return void t.uniform2f(a.location,r[0],r[1]);case 3:return void t.uniform3f(a.location,r[0],r[1],r[2]);case 4:return void t.uniform4f(a.location,r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&t.uniform1f(a.location,r)})}}])}(),_default=exports.default=WebGLPostProcessingPass;

},{"../util.js":404}],413:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _array=require("../array.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var tmpArray4=new Uint8Array(4),WebGLRenderTarget=function(){return _createClass(function e(t,r){_classCallCheck(this,e),this.helper_=t;var i=t.getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.depthbuffer_=i.createRenderbuffer(),this.size_=r||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()},[{key:"setSize",value:function(e){(0,_array.equals)(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}},{key:"getSize",value:function(){return this.size_}},{key:"clearCachedData",value:function(){this.dataCacheDirty_=!0}},{key:"readAll",value:function(){if(this.dataCacheDirty_){var e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}},{key:"readPixel",value:function(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return tmpArray4[0]=0,tmpArray4[1]=0,tmpArray4[2]=0,tmpArray4[3]=0,tmpArray4;this.readAll();var r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return tmpArray4[0]=this.data_[4*r],tmpArray4[1]=this.data_[4*r+1],tmpArray4[2]=this.data_[4*r+2],tmpArray4[3]=this.data_[4*r+3],tmpArray4}},{key:"getTexture",value:function(){return this.texture_}},{key:"getFramebuffer",value:function(){return this.framebuffer_}},{key:"getDepthbuffer",value:function(){return this.depthbuffer_}},{key:"updateSize_",value:function(){var e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}])}(),_default=exports.default=WebGLRenderTarget;

},{"../array.js":110}],414:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShaderBuilder=exports.COMMON_HEADER=void 0;var _utils=require("../render/webgl/utils.js"),_gpu=require("../expr/gpu.js"),_flat=require("../style/flat.js");function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,_toPropertyKey(o.key),o)}}function _createClass(n,e,t){return e&&_defineProperties(n.prototype,e),t&&_defineProperties(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function _toPropertyKey(n){var e=_toPrimitive(n,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(n,e){if("object"!=_typeof(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}var COMMON_HEADER=exports.COMMON_HEADER="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_screenToWorldMatrix;\nuniform vec2 u_viewportSizePx;\nuniform float u_pixelRatio;\nuniform float u_globalAlpha;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\nuniform float u_rotation;\nuniform vec4 u_renderExtent;\nuniform vec2 u_patternOrigin;\nuniform float u_depth;\nuniform mediump int u_hitDetection;\n\nconst float PI = 3.141592653589793238;\nconst float TWO_PI = 2.0 * PI;\n\n// this used to produce an alpha-premultiplied color from a texture\nvec4 samplePremultiplied(sampler2D sampler, vec2 texCoord) {\n  vec4 color = texture2D(sampler, texCoord);\n  return vec4(color.rgb * color.a, color.a);\n}\n",DEFAULT_STYLE=(0,_flat.createDefaultStyle)(),ShaderBuilder=exports.ShaderBuilder=function(){return _createClass(function n(){_classCallCheck(this,n),this.uniforms_=[],this.attributes_=[],this.varyings_=[],this.hasSymbol_=!1,this.symbolSizeExpression_="vec2(".concat((0,_gpu.numberToGlsl)(DEFAULT_STYLE["circle-radius"])," + ").concat((0,_gpu.numberToGlsl)(.5*DEFAULT_STYLE["circle-stroke-width"]),")"),this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=(0,_gpu.colorToGlsl)(DEFAULT_STYLE["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=(0,_gpu.numberToGlsl)(DEFAULT_STYLE["stroke-width"]),this.strokeColorExpression_=(0,_gpu.colorToGlsl)(DEFAULT_STYLE["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=(0,_gpu.stringToGlsl)("round"),this.strokeJoinExpression_=(0,_gpu.stringToGlsl)("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=(0,_gpu.colorToGlsl)(DEFAULT_STYLE["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]},[{key:"addUniform",value:function(n){return this.uniforms_.push(n),this}},{key:"addAttribute",value:function(n){return this.attributes_.push(n),this}},{key:"addVarying",value:function(n,e,t){return this.varyings_.push({name:n,type:e,expression:t}),this}},{key:"setSymbolSizeExpression",value:function(n){return this.hasSymbol_=!0,this.symbolSizeExpression_=n,this}},{key:"getSymbolSizeExpression",value:function(){return this.symbolSizeExpression_}},{key:"setSymbolRotationExpression",value:function(n){return this.symbolRotationExpression_=n,this}},{key:"setSymbolOffsetExpression",value:function(n){return this.symbolOffsetExpression_=n,this}},{key:"getSymbolOffsetExpression",value:function(){return this.symbolOffsetExpression_}},{key:"setSymbolColorExpression",value:function(n){return this.hasSymbol_=!0,this.symbolColorExpression_=n,this}},{key:"getSymbolColorExpression",value:function(){return this.symbolColorExpression_}},{key:"setTextureCoordinateExpression",value:function(n){return this.texCoordExpression_=n,this}},{key:"setFragmentDiscardExpression",value:function(n){return this.discardExpression_=n,this}},{key:"getFragmentDiscardExpression",value:function(){return this.discardExpression_}},{key:"setSymbolRotateWithView",value:function(n){return this.symbolRotateWithView_=n,this}},{key:"setStrokeWidthExpression",value:function(n){return this.hasStroke_=!0,this.strokeWidthExpression_=n,this}},{key:"setStrokeColorExpression",value:function(n){return this.hasStroke_=!0,this.strokeColorExpression_=n,this}},{key:"getStrokeColorExpression",value:function(){return this.strokeColorExpression_}},{key:"setStrokeOffsetExpression",value:function(n){return this.strokeOffsetExpression_=n,this}},{key:"setStrokeCapExpression",value:function(n){return this.strokeCapExpression_=n,this}},{key:"setStrokeJoinExpression",value:function(n){return this.strokeJoinExpression_=n,this}},{key:"setStrokeMiterLimitExpression",value:function(n){return this.strokeMiterLimitExpression_=n,this}},{key:"setStrokeDistanceFieldExpression",value:function(n){return this.strokeDistanceFieldExpression_=n,this}},{key:"setFillColorExpression",value:function(n){return this.hasFill_=!0,this.fillColorExpression_=n,this}},{key:"getFillColorExpression",value:function(){return this.fillColorExpression_}},{key:"addVertexShaderFunction",value:function(n){this.vertexShaderFunctions_.includes(n)||this.vertexShaderFunctions_.push(n)}},{key:"addFragmentShaderFunction",value:function(n){this.fragmentShaderFunctions_.includes(n)||this.fragmentShaderFunctions_.push(n)}},{key:"getSymbolVertexShader",value:function(){return this.hasSymbol_?"".concat(COMMON_HEADER,"\n").concat(this.uniforms_.map(function(n){return"uniform "+n+";"}).join("\n"),"\nattribute vec2 a_position;\nattribute float a_index;\nattribute vec4 a_prop_hitColor;\n").concat(this.attributes_.map(function(n){return"attribute "+n+";"}).join("\n"),"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\nvarying vec4 v_prop_hitColor;\nvarying vec2 v_centerPx;\nvarying float v_angle;\nvarying vec2 v_quadSizePx;\n").concat(this.varyings_.map(function(n){return"varying "+n.type+" "+n.name+";"}).join("\n"),"\n").concat(this.vertexShaderFunctions_.join("\n"),"\nvec2 pxToScreen(vec2 coordPx) {\n  vec2 scaled = coordPx / u_viewportSizePx / 0.5;\n  return scaled;\n}\n\nvec2 screenToPx(vec2 coordScreen) {\n  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;\n}\n\nvoid main(void) {\n  v_quadSizePx = ").concat(this.symbolSizeExpression_,";\n  vec2 halfSizePx = v_quadSizePx * 0.5;\n  vec2 centerOffsetPx = ").concat(this.symbolOffsetExpression_,";\n  vec2 offsetPx = centerOffsetPx;\n  if (a_index == 0.0) {\n    offsetPx -= halfSizePx;\n  } else if (a_index == 1.0) {\n    offsetPx += halfSizePx * vec2(1., -1.);\n  } else if (a_index == 2.0) {\n    offsetPx += halfSizePx;\n  } else {\n    offsetPx += halfSizePx * vec2(-1., 1.);\n  }\n  float angle = ").concat(this.symbolRotationExpression_,";\n  ").concat(this.symbolRotateWithView_?"angle += u_rotation;":"","\n  float c = cos(-angle);\n  float s = sin(-angle);\n  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);\n  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);\n  vec4 texCoord = ").concat(this.texCoordExpression_,";\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;\n  v_texCoord = vec2(u, v);\n  v_prop_hitColor = a_prop_hitColor;\n  v_angle = angle;\n  c = cos(-v_angle);\n  s = sin(-v_angle);\n  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y); \n  v_centerPx = screenToPx(center.xy) + centerOffsetPx;\n").concat(this.varyings_.map(function(n){return"  "+n.name+" = "+n.expression+";"}).join("\n"),"\n}"):null}},{key:"getSymbolFragmentShader",value:function(){return this.hasSymbol_?"".concat(COMMON_HEADER,"\n").concat(this.uniforms_.map(function(n){return"uniform "+n+";"}).join("\n"),"\nvarying vec2 v_texCoord;\nvarying vec4 v_prop_hitColor;\nvarying vec2 v_centerPx;\nvarying float v_angle;\nvarying vec2 v_quadSizePx;\n").concat(this.varyings_.map(function(n){return"varying "+n.type+" "+n.name+";"}).join("\n"),"\n").concat(this.fragmentShaderFunctions_.join("\n"),"\n\nvoid main(void) {\n  if (").concat(this.discardExpression_,") { discard; }\n  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center\n  float c = cos(v_angle);\n  float s = sin(v_angle);\n  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);\n  gl_FragColor = ").concat(this.symbolColorExpression_,";\n  if (u_hitDetection > 0) {\n    if (gl_FragColor.a < 0.05) { discard; };\n    gl_FragColor = v_prop_hitColor;\n  }\n}"):null}},{key:"getStrokeVertexShader",value:function(){return this.hasStroke_?"".concat(COMMON_HEADER,"\n").concat(this.uniforms_.map(function(n){return"uniform "+n+";"}).join("\n"),"\nattribute vec2 a_position;\nattribute float a_index;\nattribute vec2 a_segmentStart;\nattribute vec2 a_segmentEnd;\nattribute float a_parameters;\nattribute float a_distance;\nattribute vec2 a_joinAngles;\nattribute vec4 a_prop_hitColor;\n").concat(this.attributes_.map(function(n){return"attribute "+n+";"}).join("\n"),"\nvarying vec2 v_segmentStart;\nvarying vec2 v_segmentEnd;\nvarying float v_angleStart;\nvarying float v_angleEnd;\nvarying float v_width;\nvarying vec4 v_prop_hitColor;\nvarying float v_distanceOffsetPx;\n").concat(this.varyings_.map(function(n){return"varying "+n.type+" "+n.name+";"}).join("\n"),"\n").concat(this.vertexShaderFunctions_.join("\n"),'\nvec2 worldToPx(vec2 worldPos) {\n  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);\n  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;\n}\n\nvec4 pxToScreen(vec2 pxPos) {\n  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;\n  return vec4(screenPos, u_depth, 1.0);\n}\n\nbool isCap(float joinAngle) {\n  return joinAngle < -0.1;\n}\n\nvec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {\n  float halfAngle = joinAngle / 2.0;\n  float c = cos(halfAngle);\n  float s = sin(halfAngle);\n  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);\n  float length = 1.0 / s;\n  return angleBisectorNormal * length;\n}\n\nvec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {\n  // if on a cap or the join angle is too high, offset the line along the segment normal\n  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {\n    return point - normal * offsetPx;\n  }\n  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)\n  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;\n}\n\nvoid main(void) {\n  v_angleStart = a_joinAngles.x;\n  v_angleEnd = a_joinAngles.y;\n  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);\n  // we\'re reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)\n  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);\n\n  float lineWidth = ').concat(this.strokeWidthExpression_,";\n  float lineOffsetPx = ").concat(this.strokeOffsetExpression_,";\n\n  // compute segment start/end in px with offset\n  vec2 segmentStartPx = worldToPx(a_segmentStart);\n  vec2 segmentEndPx = worldToPx(a_segmentEnd);\n  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);\n  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);\n  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),\n  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);\n  \n  // compute current vertex position\n  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;\n  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;\n  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;\n  vec2 joinDirection;\n  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;\n  // if angle is too high, do not make a proper join\n  if (cos(angle) > ").concat(_utils.LINESTRING_ANGLE_COSINE_CUTOFF," || isCap(angle)) {\n    joinDirection = normalPx * normalDir - tangentPx * tangentDir;\n  } else {\n    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);\n  }\n  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing\n  gl_Position = pxToScreen(positionPx);\n\n  v_segmentStart = segmentStartPx;\n  v_segmentEnd = segmentEndPx;\n  v_width = lineWidth;\n  v_prop_hitColor = a_prop_hitColor;\n  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);\n").concat(this.varyings_.map(function(n){return"  "+n.name+" = "+n.expression+";"}).join("\n"),"\n}"):null}},{key:"getStrokeFragmentShader",value:function(){return this.hasStroke_?"".concat(COMMON_HEADER,"\n").concat(this.uniforms_.map(function(n){return"uniform "+n+";"}).join("\n"),"\nvarying vec2 v_segmentStart;\nvarying vec2 v_segmentEnd;\nvarying float v_angleStart;\nvarying float v_angleEnd;\nvarying float v_width;\nvarying vec4 v_prop_hitColor;\nvarying float v_distanceOffsetPx;\n").concat(this.varyings_.map(function(n){return"varying "+n.type+" "+n.name+";"}).join("\n"),"\n").concat(this.fragmentShaderFunctions_.join("\n"),"\n\nvec2 pxToWorld(vec2 pxPos) {\n  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;\n  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;\n}\n\nbool isCap(float joinAngle) {\n  return joinAngle < -0.1;\n}\n\nfloat segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  vec2 tangent = normalize(end - start);\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 startToPoint = point - start;\n  return abs(dot(startToPoint, normal)) - width * 0.5;\n}\n\nfloat buttCapDistanceField(vec2 point, vec2 start, vec2 end) {\n  vec2 startToPoint = point - start;\n  vec2 tangent = normalize(end - start);\n  return dot(startToPoint, -tangent);\n}\n\nfloat squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  return buttCapDistanceField(point, start, end) - width * 0.5;\n}\n\nfloat roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment\n  return length(point - start) - width * 0.5 - onSegment;\n}\n\nfloat roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  return roundCapDistanceField(point, start, end, width);\n}\n\nfloat bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {\n  vec2 startToPoint = point - start;\n  vec2 tangent = normalize(end - start);\n  float c = cos(joinAngle * 0.5);\n  float s = sin(joinAngle * 0.5);\n  float direction = -sign(sin(joinAngle));\n  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);\n  float radius = width * 0.5 * s;\n  return dot(startToPoint, bisector * direction) - radius;\n}\n\nfloat miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {\n  if (cos(joinAngle) > ").concat(_utils.LINESTRING_ANGLE_COSINE_CUTOFF,") { // avoid risking a division by zero\n    return bevelJoinField(point, start, end, width, joinAngle);\n  }\n  float miterLength = 1. / sin(joinAngle * 0.5);\n  float miterLimit = ").concat(this.strokeMiterLimitExpression_,";\n  if (miterLength > miterLimit) {\n    return bevelJoinField(point, start, end, width, joinAngle);\n  }\n  return -1000.;\n}\n\nfloat capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {\n   if (capType == ").concat((0,_gpu.stringToGlsl)("butt"),") {\n    return buttCapDistanceField(point, start, end);\n  } else if (capType == ").concat((0,_gpu.stringToGlsl)("square"),") {\n    return squareCapDistanceField(point, start, end, width);\n  }\n  return roundCapDistanceField(point, start, end, width);\n}\n\nfloat joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {\n  if (joinType == ").concat((0,_gpu.stringToGlsl)("bevel"),") {\n    return bevelJoinField(point, start, end, width, joinAngle);\n  } else if (joinType == ").concat((0,_gpu.stringToGlsl)("miter"),") {\n    return miterJoinDistanceField(point, start, end, width, joinAngle);\n  }\n  return roundJoinDistanceField(point, start, end, width);\n}\n\nfloat computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {\n  if (isCap(joinAngle)) {\n    return capDistanceField(point, start, end, width, capType);\n  }\n  return joinDistanceField(point, start, end, width, joinAngle, joinType);\n}\n\nvoid main(void) {\n  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n  vec2 worldPos = pxToWorld(currentPoint);\n  if (\n    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (\n      worldPos[0] < u_renderExtent[0] ||\n      worldPos[1] < u_renderExtent[1] ||\n      worldPos[0] > u_renderExtent[2] ||\n      worldPos[1] > u_renderExtent[3]\n    )\n  ) {\n    discard;\n  }\n  #endif\n  if (").concat(this.discardExpression_,") { discard; }\n\n  float segmentLength = length(v_segmentEnd - v_segmentStart);\n  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;\n  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);\n  vec2 startToPoint = currentPoint - v_segmentStart;\n  float currentLengthPx = max(0., min(dot(segmentTangent, startToPoint), segmentLength)) + v_distanceOffsetPx; \n  float currentRadiusPx = abs(dot(segmentNormal, startToPoint));\n  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;\n  vec4 color = ").concat(this.strokeColorExpression_," * u_globalAlpha;\n  float capType = ").concat(this.strokeCapExpression_,";\n  float joinType = ").concat(this.strokeJoinExpression_,";\n  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);\n  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);\n  float distance = max(\n    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),\n    max(segmentStartDistance, segmentEndDistance)\n  );\n  distance = max(distance, ").concat(this.strokeDistanceFieldExpression_,");\n  gl_FragColor = color * smoothstep(0.5, -0.5, distance);\n  if (u_hitDetection > 0) {\n    if (gl_FragColor.a < 0.1) { discard; };\n    gl_FragColor = v_prop_hitColor;\n  }\n}"):null}},{key:"getFillVertexShader",value:function(){return this.hasFill_?"".concat(COMMON_HEADER,"\n").concat(this.uniforms_.map(function(n){return"uniform "+n+";"}).join("\n"),"\nattribute vec2 a_position;\nattribute vec4 a_prop_hitColor;\n").concat(this.attributes_.map(function(n){return"attribute "+n+";"}).join("\n"),"\nvarying vec4 v_prop_hitColor;\n").concat(this.varyings_.map(function(n){return"varying "+n.type+" "+n.name+";"}).join("\n"),"\n").concat(this.vertexShaderFunctions_.join("\n"),"\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);\n  v_prop_hitColor = a_prop_hitColor;\n").concat(this.varyings_.map(function(n){return"  "+n.name+" = "+n.expression+";"}).join("\n"),"\n}"):null}},{key:"getFillFragmentShader",value:function(){return this.hasFill_?"".concat(COMMON_HEADER,"\n").concat(this.uniforms_.map(function(n){return"uniform "+n+";"}).join("\n"),"\nvarying vec4 v_prop_hitColor;\n").concat(this.varyings_.map(function(n){return"varying "+n.type+" "+n.name+";"}).join("\n"),"\n").concat(this.fragmentShaderFunctions_.join("\n"),"\nvec2 pxToWorld(vec2 pxPos) {\n  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;\n  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;\n}\n\nvec2 worldToPx(vec2 worldPos) {\n  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);\n  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;\n}\n\nvoid main(void) {\n  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;\n  vec2 pxOrigin = worldToPx(u_patternOrigin);\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n  vec2 worldPos = pxToWorld(pxPos);\n  if (\n    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (\n      worldPos[0] < u_renderExtent[0] ||\n      worldPos[1] < u_renderExtent[1] ||\n      worldPos[0] > u_renderExtent[2] ||\n      worldPos[1] > u_renderExtent[3]\n    )\n  ) {\n    discard;\n  }\n  #endif\n  if (").concat(this.discardExpression_,") { discard; }\n  gl_FragColor = ").concat(this.fillColorExpression_," * u_globalAlpha;\n  if (u_hitDetection > 0) {\n    if (gl_FragColor.a < 0.1) { discard; };\n    gl_FragColor = v_prop_hitColor;\n  }\n}"):null}}])}();

},{"../expr/gpu.js":141,"../render/webgl/utils.js":312,"../style/flat.js":395}],415:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseTileRepresentation=_interopRequireDefault(require("./BaseTileRepresentation.js")),_DataTile=_interopRequireWildcard(require("../DataTile.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageTile=_interopRequireDefault(require("../ImageTile.js")),_Tile=_interopRequireDefault(require("../reproj/Tile.js")),_Buffer=_interopRequireDefault(require("./Buffer.js")),_webgl=require("../webgl.js"),_dom=require("../dom.js"),_size=require("../size.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function bindAndConfigure(e,t,r){var i=r?e.LINEAR:e.NEAREST;e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i)}function uploadImageTexture(e,t,r,i){bindAndConfigure(e,t,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}function uploadDataTexture(e,t,r,i,n,a){var o,u,l=e.getGL();r instanceof Float32Array?(o=l.FLOAT,e.getExtension("OES_texture_float"),u=null!==e.getExtension("OES_texture_float_linear")):(o=l.UNSIGNED_BYTE,u=!0);bindAndConfigure(l,t,a&&u);var s,f=r.byteLength/i[1],c=1;switch(f%8==0?c=8:f%4==0?c=4:f%2==0&&(c=2),n){case 1:s=l.LUMINANCE;break;case 2:s=l.LUMINANCE_ALPHA;break;case 3:s=l.RGB;break;case 4:s=l.RGBA;break;default:throw new Error("Unsupported number of bands: ".concat(n))}var _=l.getParameter(l.UNPACK_ALIGNMENT);l.pixelStorei(l.UNPACK_ALIGNMENT,c),l.texImage2D(l.TEXTURE_2D,0,s,i[0],i[1],0,s,o,r),l.pixelStorei(l.UNPACK_ALIGNMENT,_)}var pixelContext=null;function createPixelContext(){pixelContext=(0,_dom.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})}var TileTexture=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e])).textures=[],r.renderSize_=(0,_size.toSize)(e.grid.getTileSize(e.tile.tileCoord[0])),r.bandCount=NaN;var i=new _Buffer.default(_webgl.ARRAY_BUFFER,_webgl.STATIC_DRAW);return i.fromArray([0,1,1,1,1,0,0,0]),r.helper_.flushBufferData(i),r.coords=i,r.setTile(e.tile),r}return _inherits(t,_BaseTileRepresentation["default"]),_createClass(t,[{key:"uploadTile",value:function(){var e,t=this.helper_,r=t.getGL(),i=this.tile;this.textures.length=0,e=i instanceof _ImageTile.default||i instanceof _Tile.default?i.getImage():i.getData();var n=(0,_DataTile.asImageLike)(e);if(n){var a=r.createTexture();return this.textures.push(a),this.bandCount=4,uploadImageTexture(r,a,n,i.interpolate),void this.setReady()}e=(0,_DataTile.asArrayLike)(e);var o=i.getSize(),u=[o[0]+2*this.gutter_,o[1]+2*this.gutter_],l=e instanceof Float32Array,s=u[0]*u[1],f=l?Float32Array:Uint8Array,c=f.BYTES_PER_ELEMENT,_=e.byteLength/u[1];this.bandCount=Math.floor(_/c/u[0]);var p=Math.ceil(this.bandCount/4);if(1===p){var d=r.createTexture();return this.textures.push(d),uploadDataTexture(t,d,e,u,this.bandCount,i.interpolate),void this.setReady()}for(var h=new Array(p),y=0;y<p;++y){var T=r.createTexture();this.textures.push(T);var g=y<p-1?4:(this.bandCount-1)%4+1;h[y]=new f(s*g)}for(var v=0,b=0,x=u[0]*this.bandCount,E=0;E<u[1];++E){for(var R=0;R<x;++R){var P=e[b+R],C=Math.floor(v/this.bandCount),m=R%this.bandCount,D=h[Math.floor(m/4)];D[C*(D.length/s)+m%4]=P,++v}b+=_/c}for(var A=0;A<p;++A){var w=this.textures[A],O=h[A];uploadDataTexture(t,w,O,u,O.length/s,i.interpolate)}this.setReady()}},{key:"disposeInternal",value:function(){var e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t]);this.tile.removeEventListener(_EventType.default.CHANGE,this.handleTileChange_)}},{key:"getImagePixelData_",value:function(e,t,r){var i=this.gutter_,n=this.renderSize_[0],a=this.renderSize_[1];pixelContext||createPixelContext(),pixelContext.clearRect(0,0,1,1);var o,u=e.width-2*i,l=e.height-2*i,s=i+Math.floor(u*(t/n)),f=i+Math.floor(l*(r/a));try{pixelContext.drawImage(e,s,f,1,1,0,0,1,1),o=pixelContext.getImageData(0,0,1,1).data}catch(e){return pixelContext=null,null}return o}},{key:"getArrayPixelData_",value:function(e,t,r,i){var n=this.gutter_,a=this.renderSize_[0],o=this.renderSize_[1],u=t[0],l=t[1],s=u+2*n,f=l+2*n,c=n+Math.floor(u*(r/a)),_=n+Math.floor(l*(i/o));if(e instanceof DataView){var p=e.byteLength/(s*f),d=p*(_*s+c),h=e.buffer.slice(d,d+p);return new DataView(h)}var y=this.bandCount*(_*s+c);return e.slice(y,y+this.bandCount)}},{key:"getPixelData",value:function(e,t){if(!this.loaded)return null;if(this.tile instanceof _DataTile.default){var r=this.tile.getData(),i=(0,_DataTile.asArrayLike)(r);if(i){var n=this.tile.getSize();return this.getArrayPixelData_(i,n,e,t)}return this.getImagePixelData_((0,_DataTile.asImageLike)(r),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}])}(),_default=exports.default=TileTexture;

},{"../DataTile.js":80,"../ImageTile.js":87,"../dom.js":130,"../events/EventType.js":134,"../reproj/Tile.js":331,"../size.js":337,"../webgl.js":406,"./BaseTileRepresentation.js":407,"./Buffer.js":408}],416:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeHash=computeHash,exports.expressionToGlsl=expressionToGlsl,exports.packColor=packColor,exports.parseLiteralStyle=parseLiteralStyle;var _expression=require("../expr/expression.js"),_ShaderBuilder=require("./ShaderBuilder.js"),_gpu=require("../expr/gpu.js"),_color=require("../color.js");function ownKeys(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);o&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function _objectSpread(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?ownKeys(Object(t),!0).forEach(function(o){_defineProperty(e,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))})}return e}function _defineProperty(e,o,t){return(o=_toPropertyKey(o))in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function _toPropertyKey(e){var o=_toPrimitive(e,"string");return"symbol"==_typeof(o)?o:o+""}function _toPrimitive(e,o){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,o||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,o){if(e){if("string"==typeof e)return _arrayLikeToArray(e,o);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,o):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,r=Array(o);t<o;t++)r[t]=e[t];return r}function expressionToGlsl(e,o,t){var r=(0,_expression.newParsingContext)();return r.style=e.style,(0,_gpu.buildExpression)(o,t,r,e)}function packColor(e){var o=(0,_color.asArray)(e);return[256*o[0]+o[1],256*o[2]+Math.round(255*o[3])]}var UNPACK_COLOR_FN="vec4 unpackColor(vec2 packedColor) {\n  return fract(packedColor[1] / 256.0) * vec4(\n    fract(floor(packedColor[0] / 256.0) / 256.0),\n    fract(packedColor[0] / 256.0),\n    fract(floor(packedColor[1] / 256.0) / 256.0),\n    1.0\n  );\n}";function getGlslSizeFromType(e){return e===_expression.ColorType||e===_expression.SizeType?2:e===_expression.NumberArrayType?4:1}function getGlslTypeFromType(e){var o=getGlslSizeFromType(e);return o>1?"vec".concat(o):"float"}function computeHash(e){return(JSON.stringify(e).split("").reduce(function(e,o){return(e<<5)-e+o.charCodeAt(0)},0)>>>0).toString()}function parseCommonSymbolProperties(e,o,t,r){if("".concat(r,"radius")in e&&"icon-"!==r){var n=expressionToGlsl(t,e["".concat(r,"radius")],_expression.NumberType);if("".concat(r,"radius2")in e){var s=expressionToGlsl(t,e["".concat(r,"radius2")],_expression.NumberType);n="max(".concat(n,", ").concat(s,")")}"".concat(r,"stroke-width")in e&&(n="(".concat(n," + ").concat(expressionToGlsl(t,e["".concat(r,"stroke-width")],_expression.NumberType)," * 0.5)")),o.setSymbolSizeExpression("vec2(".concat(n," * 2. + 0.5)"))}if("".concat(r,"scale")in e){var a=expressionToGlsl(t,e["".concat(r,"scale")],_expression.SizeType);o.setSymbolSizeExpression("".concat(o.getSymbolSizeExpression()," * ").concat(a))}"".concat(r,"displacement")in e&&o.setSymbolOffsetExpression(expressionToGlsl(t,e["".concat(r,"displacement")],_expression.NumberArrayType)),"".concat(r,"rotation")in e&&o.setSymbolRotationExpression(expressionToGlsl(t,e["".concat(r,"rotation")],_expression.NumberType)),"".concat(r,"rotate-with-view")in e&&o.setSymbolRotateWithView(!!e["".concat(r,"rotate-with-view")])}function getColorFromDistanceField(e,o,t,r,n){var s="vec4(0.)";if(null!==o&&(s=o),null!==t&&null!==r){var a="smoothstep(-".concat(r," + 0.63, -").concat(r," - 0.58, ").concat(e,")");s="mix(".concat(t,", ").concat(s,", ").concat(a,")")}var i="(1.0 - smoothstep(-0.63, 0.58, ".concat(e,"))"),c="".concat(s," * ").concat(i);return null!==n&&(c="".concat(c," * ").concat(n)),c}function parseImageProperties(e,o,t,r,n){var s,a=new Image;return a.crossOrigin=void 0===e["".concat(r,"cross-origin")]?"anonymous":e["".concat(r,"cross-origin")],a.src=e["".concat(r,"src")],a.complete&&a.width&&a.height?s=(0,_gpu.arrayToGlsl)([a.width,a.height]):(t["u_texture".concat(n,"_size")]=function(){return a.complete?[a.width,a.height]:[0,0]},o.addUniform("vec2 u_texture".concat(n,"_size")),s="u_texture".concat(n,"_size")),t["u_texture".concat(n)]=a,o.addUniform("sampler2D u_texture".concat(n)),s}function parseImageOffsetProperties(e,o,t,r,n){var s=expressionToGlsl(t,e["".concat(o,"offset")],_expression.NumberArrayType);if("".concat(o,"offset-origin")in e)switch(e["".concat(o,"offset-origin")]){case"top-right":s="vec2(".concat(r,".x, 0.) + ").concat(n," * vec2(-1., 0.) + ").concat(s," * vec2(-1., 1.)");break;case"bottom-left":s="vec2(0., ".concat(r,".y) + ").concat(n," * vec2(0., -1.) + ").concat(s," * vec2(1., -1.)");break;case"bottom-right":s="".concat(r," - ").concat(n," - ").concat(s)}return s}function parseCircleProperties(e,o,t,r,n){n.functions.circleDistanceField="float circleDistanceField(vec2 point, float radius) {\n  return length(point) - radius;\n}",parseCommonSymbolProperties(e,o,r,"circle-");var s=null;"circle-opacity"in e&&(s=expressionToGlsl(n,e["circle-opacity"],_expression.NumberType));var a="coordsPx";if("circle-scale"in e){var i=expressionToGlsl(n,e["circle-scale"],_expression.SizeType);a="coordsPx / ".concat(i)}var c=null;"circle-fill-color"in e&&(c=expressionToGlsl(n,e["circle-fill-color"],_expression.ColorType));var l=null;"circle-stroke-color"in e&&(l=expressionToGlsl(n,e["circle-stroke-color"],_expression.ColorType));var p=expressionToGlsl(n,e["circle-radius"],_expression.NumberType),u=null;"circle-stroke-width"in e&&(u=expressionToGlsl(n,e["circle-stroke-width"],_expression.NumberType),p="(".concat(p," + ").concat(u," * 0.5)"));var f=getColorFromDistanceField("circleDistanceField(".concat(a,", ").concat(p,")"),c,l,u,s);o.setSymbolColorExpression(f)}function parseShapeProperties(e,o,t,r,n){n.functions.round="float round(float v) {\n  return sign(v) * floor(abs(v) + 0.5);\n}",n.functions.starDistanceField="float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {\n  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle\n  float c = cos(startAngle);\n  float s = sin(startAngle);\n  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);\n  float alpha = TWO_PI / numPoints; // the angle of one sector\n  float beta = atan(pointRotated.y, pointRotated.x);\n  float gamma = round(beta / alpha) * alpha; // angle in sector\n  c = cos(-gamma);\n  s = sin(-gamma);\n  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));\n  vec2 tipToPoint = inSector + vec2(-radius, 0.);\n  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);\n  return dot(normalize(edgeNormal), tipToPoint);\n}",n.functions.regularDistanceField="float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {\n  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle\n  float c = cos(startAngle);\n  float s = sin(startAngle);\n  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);\n  float alpha = TWO_PI / numPoints; // the angle of one sector\n  float radiusIn = radius * cos(PI / numPoints);\n  float beta = atan(pointRotated.y, pointRotated.x);\n  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid\n  c = cos(-gamma);\n  s = sin(-gamma);\n  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));\n  return inSector.x - radiusIn;\n}",parseCommonSymbolProperties(e,o,r,"shape-");var s=null;"shape-opacity"in e&&(s=expressionToGlsl(n,e["shape-opacity"],_expression.NumberType));var a="coordsPx";if("shape-scale"in e){var i=expressionToGlsl(n,e["shape-scale"],_expression.SizeType);a="coordsPx / ".concat(i)}var c=null;"shape-fill-color"in e&&(c=expressionToGlsl(n,e["shape-fill-color"],_expression.ColorType));var l=null;"shape-stroke-color"in e&&(l=expressionToGlsl(n,e["shape-stroke-color"],_expression.ColorType));var p=null;"shape-stroke-width"in e&&(p=expressionToGlsl(n,e["shape-stroke-width"],_expression.NumberType));var u,f=expressionToGlsl(n,e["shape-points"],_expression.NumberType),m="0.";"shape-angle"in e&&(m=expressionToGlsl(n,e["shape-angle"],_expression.NumberType));var d=expressionToGlsl(n,e["shape-radius"],_expression.NumberType);if(null!==p&&(d="".concat(d," + ").concat(p," * 0.5")),"shape-radius2"in e){var x=expressionToGlsl(n,e["shape-radius2"],_expression.NumberType);null!==p&&(x="".concat(x," + ").concat(p," * 0.5")),u="starDistanceField(".concat(a,", ").concat(f,", ").concat(d,", ").concat(x,", ").concat(m,")")}else u="regularDistanceField(".concat(a,", ").concat(f,", ").concat(d,", ").concat(m,")");var y=getColorFromDistanceField(u,c,l,p,s);o.setSymbolColorExpression(y)}function parseIconProperties(e,o,t,r,n){var s="vec4(1.0)";"icon-color"in e&&(s=expressionToGlsl(n,e["icon-color"],_expression.ColorType)),"icon-opacity"in e&&(s="".concat(s," * ").concat(expressionToGlsl(n,e["icon-opacity"],_expression.NumberType)));var a=computeHash(e["icon-src"]),i=parseImageProperties(e,o,t,"icon-",a);if(o.setSymbolColorExpression("".concat(s," * samplePremultiplied(u_texture").concat(a,", v_texCoord)")).setSymbolSizeExpression(i),"icon-width"in e&&"icon-height"in e&&o.setSymbolSizeExpression("vec2(".concat(expressionToGlsl(r,e["icon-width"],_expression.NumberType),", ").concat(expressionToGlsl(r,e["icon-height"],_expression.NumberType),")")),"icon-offset"in e&&"icon-size"in e){var c=expressionToGlsl(r,e["icon-size"],_expression.NumberArrayType),l=o.getSymbolSizeExpression();o.setSymbolSizeExpression(c);var p=parseImageOffsetProperties(e,"icon-",r,"v_quadSizePx",c);o.setTextureCoordinateExpression("(vec4((".concat(p,").xyxy) + vec4(0., 0., ").concat(c,")) / (").concat(l,").xyxy"))}if(parseCommonSymbolProperties(e,o,r,"icon-"),"icon-anchor"in e){var u,f=expressionToGlsl(r,e["icon-anchor"],_expression.NumberArrayType),m="1.0";"icon-scale"in e&&(m=expressionToGlsl(r,e["icon-scale"],_expression.SizeType)),u="pixels"===e["icon-anchor-x-units"]&&"pixels"===e["icon-anchor-y-units"]?"".concat(f," * ").concat(m):"pixels"===e["icon-anchor-x-units"]?"".concat(f," * vec2(vec2(").concat(m,").x, v_quadSizePx.y)"):"pixels"===e["icon-anchor-y-units"]?"".concat(f," * vec2(v_quadSizePx.x, vec2(").concat(m,").x)"):"".concat(f," * v_quadSizePx");var d="v_quadSizePx * vec2(0.5, -0.5) + ".concat(u," * vec2(-1., 1.)");if("icon-anchor-origin"in e)switch(e["icon-anchor-origin"]){case"top-right":d="v_quadSizePx * -0.5 + ".concat(u);break;case"bottom-left":d="v_quadSizePx * 0.5 - ".concat(u);break;case"bottom-right":d="v_quadSizePx * vec2(-0.5, 0.5) + ".concat(u," * vec2(1., -1.)")}o.setSymbolOffsetExpression("".concat(o.getSymbolOffsetExpression()," + ").concat(d))}}function parseStrokeProperties(e,o,t,r,n){if("stroke-color"in e&&o.setStrokeColorExpression(expressionToGlsl(n,e["stroke-color"],_expression.ColorType)),"stroke-pattern-src"in e){var s=computeHash(e["stroke-pattern-src"]),a=parseImageProperties(e,o,t,"stroke-pattern-",s),i=a,c="vec2(0.)";"stroke-pattern-offset"in e&&"stroke-pattern-size"in e&&(i=expressionToGlsl(n,e["stroke-pattern-size"],_expression.NumberArrayType),c=parseImageOffsetProperties(e,"stroke-pattern-",n,a,i));var l="0.";"stroke-pattern-spacing"in e&&(l=expressionToGlsl(n,e["stroke-pattern-spacing"],_expression.NumberType)),n.functions.sampleStrokePattern="vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {\n  float currentLengthScaled = currentLengthPx * sampleSize.y / lineWidth;\n  float spacingScaled = spacingPx * sampleSize.y / lineWidth;\n  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));\n  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels\n  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);\n  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;\n  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;\n  return samplePremultiplied(texture, texCoord);\n}";var p="u_texture".concat(s),u="1.";"stroke-color"in e&&(u=o.getStrokeColorExpression()),o.setStrokeColorExpression("".concat(u," * sampleStrokePattern(").concat(p,", ").concat(a,", ").concat(c,", ").concat(i,", ").concat(l,", currentLengthPx, currentRadiusRatio, v_width)"))}if("stroke-width"in e&&o.setStrokeWidthExpression(expressionToGlsl(r,e["stroke-width"],_expression.NumberType)),"stroke-offset"in e&&o.setStrokeOffsetExpression(expressionToGlsl(r,e["stroke-offset"],_expression.NumberType)),"stroke-line-cap"in e&&o.setStrokeCapExpression(expressionToGlsl(r,e["stroke-line-cap"],_expression.StringType)),"stroke-line-join"in e&&o.setStrokeJoinExpression(expressionToGlsl(r,e["stroke-line-join"],_expression.StringType)),"stroke-miter-limit"in e&&o.setStrokeMiterLimitExpression(expressionToGlsl(r,e["stroke-miter-limit"],_expression.NumberType)),"stroke-line-dash"in e){n.functions.getSingleDashDistance="float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType) {\n  float localDistance = mod(distance, dashLengthTotal);\n  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;\n  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);\n  if (capType == ".concat((0,_gpu.stringToGlsl)("square"),") {\n    distanceSegment -= v_width * 0.5;\n  } else if (capType == ").concat((0,_gpu.stringToGlsl)("round"),") {\n    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - v_width * 0.5);\n  }\n  return distanceSegment;\n}");var f=e["stroke-line-dash"].map(function(e){return expressionToGlsl(n,e,_expression.NumberType)});f.length%2==1&&(f=[].concat(_toConsumableArray(f),_toConsumableArray(f)));var m="0.";"stroke-line-dash-offset"in e&&(m=expressionToGlsl(r,e["stroke-line-dash-offset"],_expression.NumberType));for(var d=computeHash(e["stroke-line-dash"]),x="dashDistanceField_".concat(d),y=f.map(function(e,o){return"float dashLength".concat(o," = ").concat(e,";")}),v=f.map(function(e,o){return"dashLength".concat(o)}).join(" + "),h="0.",g="getSingleDashDistance(distance, radius, ".concat(h,", dashLength0, totalDashLength, capType)"),b=2;b<f.length;b+=2)h="".concat(h," + dashLength").concat(b-2," + dashLength").concat(b-1),g="min(".concat(g,", getSingleDashDistance(distance, radius, ").concat(h,", dashLength").concat(b,", totalDashLength, capType))");n.functions[x]="float ".concat(x,"(float distance, float radius, float capType) {\n  ").concat(y.join("\n  "),"\n  float totalDashLength = ").concat(v,";\n  return ").concat(g,";\n}"),o.setStrokeDistanceFieldExpression("".concat(x,"(currentLengthPx + ").concat(m,", currentRadiusPx, capType)"))}}function parseFillProperties(e,o,t,r,n){if("fill-color"in e&&o.setFillColorExpression(expressionToGlsl(n,e["fill-color"],_expression.ColorType)),"fill-pattern-src"in e){var s=computeHash(e["fill-pattern-src"]),a=parseImageProperties(e,o,t,"fill-pattern-",s),i=a,c="vec2(0.)";"fill-pattern-offset"in e&&"fill-pattern-size"in e&&(c=parseImageOffsetProperties(e,"fill-pattern-",n,a,i=expressionToGlsl(n,e["fill-pattern-size"],_expression.NumberArrayType))),n.functions.sampleFillPattern="vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {\n  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);\n  vec2 pxRelativePos = pxPosition - pxOrigin;\n  // rotate the relative position from origin by the current view rotation\n  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));\n  // sample position is computed according to the sample offset & size\n  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);\n  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels\n  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));\n  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright\n  return samplePremultiplied(texture, (samplePos + textureOffset) / textureSize);\n}";var l="u_texture".concat(s),p="1.";"fill-color"in e&&(p=o.getFillColorExpression()),o.setFillColorExpression("".concat(p," * sampleFillPattern(").concat(l,", ").concat(a,", ").concat(c,", ").concat(i,", pxOrigin, pxPos)"))}}function parseLiteralStyle(e){var o={inFragmentShader:!1,properties:{},variables:{},functions:{},style:e},t={inFragmentShader:!0,variables:o.variables,properties:{},functions:{},style:e},r=new _ShaderBuilder.ShaderBuilder,n={};if("icon-src"in e?parseIconProperties(e,r,n,o,t):"shape-points"in e?parseShapeProperties(e,r,n,o,t):"circle-radius"in e&&parseCircleProperties(e,r,n,o,t),parseStrokeProperties(e,r,n,o,t),parseFillProperties(e,r,n,o,t),e.filter){var s=expressionToGlsl(t,e.filter,_expression.BooleanType);r.setFragmentDiscardExpression("!".concat(s))}Object.keys(t.variables).forEach(function(o){var s,a=t.variables[o],i=(0,_gpu.uniformNameForVariable)(a.name);r.addUniform("".concat(getGlslTypeFromType(a.type)," ").concat(i)),s=a.type===_expression.StringType?function(){return(0,_gpu.getStringNumberEquivalent)(e.variables[a.name])}:a.type===_expression.ColorType?function(){return packColor(_toConsumableArray((0,_color.asArray)(e.variables[a.name]||"#eee")))}:a.type===_expression.BooleanType?function(){return e.variables[a.name]?1:0}:function(){return e.variables[a.name]},n[i]=s}),Object.keys(t.properties).forEach(function(e){var n=t.properties[e];o.properties[e]||(o.properties[e]=n);var s=getGlslTypeFromType(n.type),a="a_prop_".concat(n.name);n.type===_expression.ColorType&&(s="vec4",a="unpackColor(".concat(a,")"),r.addVertexShaderFunction(UNPACK_COLOR_FN)),r.addVarying("v_prop_".concat(n.name),s,a)}),Object.keys(o.properties).forEach(function(e){var t=o.properties[e];r.addAttribute("".concat(getGlslTypeFromType(t.type)," a_prop_").concat(t.name))});var a=Object.keys(o.properties).map(function(e){var t,r=o.properties[e];return t=r.evaluator?r.evaluator:r.type===_expression.StringType?function(e){return(0,_gpu.getStringNumberEquivalent)(e.get(r.name))}:r.type===_expression.ColorType?function(e){return packColor(_toConsumableArray((0,_color.asArray)(e.get(r.name)||"#eee")))}:r.type===_expression.BooleanType?function(e){return e.get(r.name)?1:0}:function(e){return e.get(r.name)},{name:r.name,size:getGlslSizeFromType(r.type),callback:t}});for(var i in o.functions)r.addVertexShaderFunction(o.functions[i]);for(var c in t.functions)r.addFragmentShaderFunction(t.functions[c]);return{builder:r,attributes:a.reduce(function(e,o){return _objectSpread(_objectSpread({},e),{},_defineProperty({},o.name,{callback:o.callback,size:o.size}))},{}),uniforms:n}}

},{"../color.js":113,"../expr/expression.js":140,"../expr/gpu.js":141,"./ShaderBuilder.js":414}],417:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";function create(){var e='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS";function r(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function x(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new Error(t)}(0!==n,"Transformation matrix cannot be inverted");const x=t[0],i=t[1],u=t[2],o=t[3],f=t[4],s=t[5];return e[0]=o/n,e[1]=-i/n,e[2]=-u/n,e[3]=x/n,e[4]=(u*s-o*f)/n,e[5]=-(x*s-i*f)/n,e}function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}new Array(6);var u={exports:{}};function o(e,t,n){n=n||2;var r,x,i,u,o,s,l,v=t&&t.length,h=v?t[0]*n:e.length,c=f(e,0,h,n,!0),g=[];if(!c||c.next===c.prev)return g;if(v&&(c=function(e,t,n,r){var x,i,u,o=[];for(x=0,i=t.length;x<i;x++)(u=f(e,t[x]*r,x<i-1?t[x+1]*r:e.length,r,!1))===u.next&&(u.steiner=!0),o.push(d(u));for(o.sort(p),x=0;x<o.length;x++)n=y(o[x],n);return n}(e,t,c,n)),e.length>80*n){r=i=e[0],x=u=e[1];for(var b=n;b<h;b+=n)(o=e[b])<r&&(r=o),(s=e[b+1])<x&&(x=s),o>i&&(i=o),s>u&&(u=s);l=0!==(l=Math.max(i-r,u-x))?32767/l:0}return a(c,g,n,r,x,l,0),g}function f(e,t,n,r,x){var i,u;if(x===O(e,t,n,r)>0)for(i=t;i<n;i+=r)u=P(i,e[i],e[i+1],u);else for(i=n-r;i>=t;i-=r)u=P(i,e[i],e[i+1],u);return u&&m(u,u.next)&&(B(u),u=u.next),u}function s(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(B(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,x,i,u){if(e){!u&&i&&function(e,t,n,r){var x=e;do{0===x.z&&(x.z=b(x.x,x.y,t,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,function(e){var t,n,r,x,i,u,o,f,s=1;do{for(n=e,e=null,i=null,u=0;n;){for(u++,r=n,o=0,t=0;t<s&&(o++,r=r.nextZ);t++);for(f=s;o>0||f>0&&r;)0!==o&&(0===f||!r||n.z<=r.z)?(x=n,n=n.nextZ,o--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;n=r}i.nextZ=null,s*=2}while(u>1)}(x)}(e,r,x,i);for(var o,f,p=e;e.prev!==e.next;)if(o=e.prev,f=e.next,i?v(e,r,x,i):l(e))t.push(o.i/n|0),t.push(e.i/n|0),t.push(f.i/n|0),B(e),e=f.next,p=f.next;else if((e=f)===p){u?1===u?a(e=h(s(e),t,n),t,n,r,x,i,2):2===u&&c(e,t,n,r,x,i):a(s(e),t,n,r,x,i,1);break}}}function l(e){var t=e.prev,n=e,r=e.next;if(w(t,n,r)>=0)return!1;for(var x=t.x,i=n.x,u=r.x,o=t.y,f=n.y,s=r.y,a=x<i?x<u?x:u:i<u?i:u,l=o<f?o<s?o:s:f<s?f:s,v=x>i?x>u?x:u:i>u?i:u,h=o>f?o>s?o:s:f>s?f:s,c=r.next;c!==t;){if(c.x>=a&&c.x<=v&&c.y>=l&&c.y<=h&&M(x,o,i,f,u,s,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function v(e,t,n,r){var x=e.prev,i=e,u=e.next;if(w(x,i,u)>=0)return!1;for(var o=x.x,f=i.x,s=u.x,a=x.y,l=i.y,v=u.y,h=o<f?o<s?o:s:f<s?f:s,c=a<l?a<v?a:v:l<v?l:v,p=o>f?o>s?o:s:f>s?f:s,y=a>l?a>v?a:v:l>v?l:v,g=b(h,c,t,n,r),d=b(p,y,t,n,r),Z=e.prevZ,m=e.nextZ;Z&&Z.z>=g&&m&&m.z<=d;){if(Z.x>=h&&Z.x<=p&&Z.y>=c&&Z.y<=y&&Z!==x&&Z!==u&&M(o,a,f,l,s,v,Z.x,Z.y)&&w(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,m.x>=h&&m.x<=p&&m.y>=c&&m.y<=y&&m!==x&&m!==u&&M(o,a,f,l,s,v,m.x,m.y)&&w(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;Z&&Z.z>=g;){if(Z.x>=h&&Z.x<=p&&Z.y>=c&&Z.y<=y&&Z!==x&&Z!==u&&M(o,a,f,l,s,v,Z.x,Z.y)&&w(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;m&&m.z<=d;){if(m.x>=h&&m.x<=p&&m.y>=c&&m.y<=y&&m!==x&&m!==u&&M(o,a,f,l,s,v,m.x,m.y)&&w(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function h(e,t,n){var r=e;do{var x=r.prev,i=r.next.next;!m(x,i)&&A(x,r,r.next,i)&&z(x,i)&&z(i,x)&&(t.push(x.i/n|0),t.push(r.i/n|0),t.push(i.i/n|0),B(r),B(r.next),r=e=i),r=r.next}while(r!==e);return s(r)}function c(e,t,n,r,x,i){var u=e;do{for(var o=u.next.next;o!==u.prev;){if(u.i!==o.i&&Z(u,o)){var f=F(u,o);return u=s(u,u.next),f=s(f,f.next),a(u,t,n,r,x,i,0),void a(f,t,n,r,x,i,0)}o=o.next}u=u.next}while(u!==e)}function p(e,t){return e.x-t.x}function y(e,t){var n=function(e,t){var n,r=t,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=x&&o>u&&(u=o,n=r.x<r.next.x?r:r.next,o===x))return n}r=r.next}while(r!==t);if(!n)return null;var f,s=n,a=n.x,l=n.y,v=1/0;r=n;do{x>=r.x&&r.x>=a&&x!==r.x&&M(i<l?x:u,i,a,l,i<l?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),z(r,e)&&(f<v||f===v&&(r.x>n.x||r.x===n.x&&g(n,r)))&&(n=r,v=f)),r=r.next}while(r!==s);return n}(e,t);if(!n)return t;var r=F(n,e);return s(r,r.next),s(n,n.next)}function g(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function b(e,t,n,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function M(e,t,n,r,x,i,u,o){return(x-u)*(t-o)>=(e-u)*(i-o)&&(e-u)*(r-o)>=(n-u)*(t-o)&&(n-u)*(i-o)>=(x-u)*(r-o)}function Z(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&A(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(z(e,t)&&z(t,e)&&function(e,t){var n=e,r=!1,x=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&x<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||m(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,n,r){var x=I(w(e,t,n)),i=I(w(e,t,r)),u=I(w(n,r,e)),o=I(w(n,r,t));return x!==i&&u!==o||(!(0!==x||!E(e,n,t))||(!(0!==i||!E(e,r,t))||(!(0!==u||!E(n,e,r))||!(0!==o||!E(n,t,r)))))}function E(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function z(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function F(e,t){var n=new _(e.i,e.x,e.y),r=new _(t.i,t.x,t.y),x=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=x,x.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function P(e,t,n,r){var x=new _(e,t,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function B(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(e,t,n,r){for(var x=0,i=t,u=n-r;i<n;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}u.exports=o,u.exports.default=o,o.deviation=function(e,t,n,r){var x=t&&t.length,i=x?t[0]*n:e.length,u=Math.abs(O(e,0,i,n));if(x)for(var o=0,f=t.length;o<f;o++){var s=t[o]*n,a=o<f-1?t[o+1]*n:e.length;u-=Math.abs(O(e,s,a,n))}var l=0;for(o=0;o<r.length;o+=3){var v=r[o]*n,h=r[o+1]*n,c=r[o+2]*n;l+=Math.abs((e[v]-e[c])*(e[h+1]-e[v+1])-(e[v]-e[h])*(e[c+1]-e[v+1]))}return 0===u&&0===l?0:Math.abs((l-u)/u)},o.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<t;u++)n.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,n.holes.push(r))}return n};var N=i(u.exports);const R=[],S={vertexPosition:0,indexPosition:0};function T(e,t,n,r,x){e[t+0]=n,e[t+1]=r,e[t+2]=x}function U(e,t,n,r,x,i){const u=3+x,o=e[t+0],f=e[t+1],s=R;s.length=x;for(let n=0;n<s.length;n++)s[n]=e[t+2+n];let a=i?i.vertexPosition:0,l=i?i.indexPosition:0;const v=a/u;return T(n,a,o,f,0),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,1),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,2),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,3),s.length&&n.set(s,a+3),a+=u,r[l++]=v,r[l++]=v+1,r[l++]=v+3,r[l++]=v+1,r[l++]=v+2,r[l++]=v+3,S.vertexPosition=a,S.indexPosition=l,S}function k(e,t,n,x,i,u,o,f,s,a,l){const v=8+f.length,h=u.length/v,c=[e[t+0],e[t+1]],p=[e[n],e[n+1]],y=r(s,[...c]),g=r(s,[...p]);function b(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),x=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-x[1],x[0]],u=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),o=[(n[0]-e[0])/u,(n[1]-e[1])/u],f=0===r||0===u?0:Math.acos((s=o[0]*x[0]+o[1]*x[1],a=-1,l=1,Math.min(Math.max(s,a),l)));var s,a,l;return o[0]*i[0]+o[1]*i[1]>0?f:2*Math.PI-f}let d=-1,M=-1,Z=l;const w=null!==i;if(null!==x){d=b(y,g,r(s,[...[e[x],e[x+1]]])),Math.cos(d)<=.985&&(Z+=Math.tan((d-Math.PI)/2))}if(w){M=b(g,y,r(s,[...[e[i],e[i+1]]])),Math.cos(M)<=.985&&(Z+=Math.tan((Math.PI-M)/2))}function m(e,t){return 0===t?1e4*e:Math.sign(t)*(1e4*e+Math.abs(t))}return u.push(c[0],c[1],p[0],p[1],d,M,a,m(0,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(1,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(2,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(3,l)),u.push(...f),o.push(h,h+1,h+2,h+1,h+3,h+2),{length:a+Math.sqrt((g[0]-y[0])*(g[0]-y[0])+(g[1]-y[1])*(g[1]-y[1])),angle:Z}}function G(e,t,n,r,x){const i=2+x;let u=t;const o=e.slice(u,u+x);u+=x;const f=e[u++];let s=0;const a=new Array(f-1);for(let t=0;t<f;t++)s+=e[u++],t<f-1&&(a[t]=s);const l=e.slice(u,u+2*s),v=N(l,a,2);for(let e=0;e<v.length;e++)r.push(v[e]+n.length/i);for(let e=0;e<l.length;e+=2)n.push(l[e],l[e+1],...o);return u+2*s}const j=self;j.onmessage=r=>{const i=r.data;switch(i.type){case t:{const e=3,t=2,n=i.customAttributesSize,r=t+n,x=new Float32Array(i.renderInstructions),u=x.length/r,o=4*u*(n+e),f=new Uint32Array(6*u),s=new Float32Array(o);let a;for(let e=0;e<x.length;e+=r)a=U(x,e,s,f,n,a);const l=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:x.buffer},i);j.postMessage(l,[s.buffer,f.buffer,x.buffer]);break}case n:{const e=[],t=[],n=i.customAttributesSize,r=2,u=new Float32Array(i.renderInstructions);let o=0;const f=[1,0,0,1,0,0];let s,a;for(x(f,i.renderInstructionsTransform);o<u.length;){a=Array.from(u.slice(o,o+n)),o+=n,s=u[o++];const x=o,i=o+(s-1)*r,l=u[x]===u[i]&&u[x+1]===u[i+1];let v=0,h=0;for(let n=0;n<s-1;n++){let c=null;n>0?c=o+(n-1)*r:l&&(c=i-r);let p=null;n<s-2?p=o+(n+2)*r:l&&(p=x+r);const y=k(u,o+n*r,o+(n+1)*r,c,p,e,t,a,f,v,h);v=y.length,h=y.angle}o+=s*r}const l=Uint32Array.from(t),v=Float32Array.from(e),h=Object.assign({vertexBuffer:v.buffer,indexBuffer:l.buffer,renderInstructions:u.buffer},i);j.postMessage(h,[v.buffer,l.buffer,u.buffer]);break}case e:{const e=[],t=[],n=i.customAttributesSize,r=new Float32Array(i.renderInstructions);let x=0;for(;x<r.length;)x=G(r,x,e,t,n);const u=Uint32Array.from(t),o=Float32Array.from(e),f=Object.assign({vertexBuffer:o.buffer,indexBuffer:u.buffer,renderInstructions:r.buffer},i);j.postMessage(f,[o.buffer,u.buffer,r.buffer]);break}}};';return new Worker("undefined"==typeof Blob?"data:application/javascript;base64,"+Buffer.from(e,"binary").toString("base64"):URL.createObjectURL(new Blob([e],{type:"application/javascript"})))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=create;

}).call(this)}).call(this,require("buffer").Buffer)
},{"buffer":9}],418:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XML_SCHEMA_INSTANCE_URI=exports.OBJECT_PROPERTY_NODE_FACTORY=void 0,exports.createElementNS=createElementNS,exports.getAllTextContent=getAllTextContent,exports.getAllTextContent_=getAllTextContent_,exports.getAttributeNS=getAttributeNS,exports.getDocument=getDocument,exports.getXMLSerializer=getXMLSerializer,exports.isDocument=isDocument,exports.makeArrayExtender=makeArrayExtender,exports.makeArrayPusher=makeArrayPusher,exports.makeArraySerializer=makeArraySerializer,exports.makeChildAppender=makeChildAppender,exports.makeObjectPropertyPusher=makeObjectPropertyPusher,exports.makeObjectPropertySetter=makeObjectPropertySetter,exports.makeReplacer=makeReplacer,exports.makeSequence=makeSequence,exports.makeSimpleNodeFactory=makeSimpleNodeFactory,exports.makeStructureNS=makeStructureNS,exports.parse=parse,exports.parseNode=parseNode,exports.pushParseAndPop=pushParseAndPop,exports.pushSerializeAndPop=pushSerializeAndPop,exports.registerDocument=registerDocument,exports.registerXMLSerializer=registerXMLSerializer,exports.serialize=serialize;var _array=require("./array.js"),XML_SCHEMA_INSTANCE_URI=exports.XML_SCHEMA_INSTANCE_URI="http://www.w3.org/2001/XMLSchema-instance";function createElementNS(e,r){return getDocument().createElementNS(e,r)}function getAllTextContent(e,r){return getAllTextContent_(e,r,[]).join("")}function getAllTextContent_(e,r,t){var n;if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)r?t.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(e.nodeValue);else for(n=e.firstChild;n;n=n.nextSibling)getAllTextContent_(n,r,t);return t}function isDocument(e){return"documentElement"in e}function getAttributeNS(e,r,t){return e.getAttributeNS(r,t)||""}function parse(e){return(new DOMParser).parseFromString(e,"application/xml")}function makeArrayExtender(e,r){return function(t,n){var o=e.call(void 0!==r?r:this,t,n);if(void 0!==o){var i=n[n.length-1];(0,_array.extend)(i,o)}}}function makeArrayPusher(e,r){return function(t,n){var o=e.call(void 0!==r?r:this,t,n);void 0!==o&&n[n.length-1].push(o)}}function makeReplacer(e,r){return function(t,n){var o=e.call(void 0!==r?r:this,t,n);void 0!==o&&(n[n.length-1]=o)}}function makeObjectPropertyPusher(e,r,t){return function(n,o){var i=e.call(void 0!==t?t:this,n,o);if(void 0!==i){var a,l=o[o.length-1],u=void 0!==r?r:n.localName;u in l?a=l[u]:(a=[],l[u]=a),a.push(i)}}}function makeObjectPropertySetter(e,r,t){return function(n,o){var i=e.call(void 0!==t?t:this,n,o);void 0!==i&&(o[o.length-1][void 0!==r?r:n.localName]=i)}}function makeChildAppender(e,r){return function(t,n,o){e.call(void 0!==r?r:this,t,n,o),o[o.length-1].node.appendChild(t)}}function makeArraySerializer(e,r){var t,n;return function(r,o,i){if(void 0===t){t={};var a={};a[r.localName]=e,t[r.namespaceURI]=a,n=makeSimpleNodeFactory(r.localName)}serialize(t,n,o,i)}}function makeSimpleNodeFactory(e,r){return function(t,n,o){var i=n[n.length-1].node,a=e;return void 0===a&&(a=o),createElementNS(void 0!==r?r:i.namespaceURI,a)}}var OBJECT_PROPERTY_NODE_FACTORY=exports.OBJECT_PROPERTY_NODE_FACTORY=makeSimpleNodeFactory();function makeSequence(e,r){for(var t=r.length,n=new Array(t),o=0;o<t;++o)n[o]=e[r[o]];return n}function makeStructureNS(e,r,t){var n,o;for(t=void 0!==t?t:{},n=0,o=e.length;n<o;++n)t[e[n]]=r;return t}function parseNode(e,r,t,n){var o;for(o=r.firstElementChild;o;o=o.nextElementSibling){var i=e[o.namespaceURI];if(void 0!==i){var a=i[o.localName];void 0!==a&&a.call(n,o,t)}}}function pushParseAndPop(e,r,t,n,o){return n.push(e),parseNode(r,t,n,o),n.pop()}function serialize(e,r,t,n,o,i){for(var a,l,u=(void 0!==o?o:t).length,c=0;c<u;++c)void 0!==(a=t[c])&&void 0!==(l=r.call(void 0!==i?i:this,a,n,void 0!==o?o[c]:void 0))&&e[l.namespaceURI][l.localName].call(i,l,a,n)}function pushSerializeAndPop(e,r,t,n,o,i,a){return o.push(e),serialize(r,t,n,o,i,a),o.pop()}var xmlSerializer_=void 0;function registerXMLSerializer(e){xmlSerializer_=e}function getXMLSerializer(){return void 0===xmlSerializer_&&"undefined"!=typeof XMLSerializer&&(xmlSerializer_=new XMLSerializer),xmlSerializer_}var document_=void 0;function registerDocument(e){document_=e}function getDocument(){return void 0===document_&&"undefined"!=typeof document&&(document_=document.implementation.createDocument("","",null)),document_}

},{"./array.js":110}],419:[function(require,module,exports){
"use strict";module.exports=Pbf;var ieee754=require("ieee754");function Pbf(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32,TEXT_DECODER_MIN_LENGTH=12,utf8TextDecoder="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function readVarintRemainder(t,i,e){var r,s,n=e.buf;if(r=(112&(s=n[e.pos++]))>>4,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<3,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<10,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<17,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<24,s<128)return toNum(t,r,i);if(r|=(1&(s=n[e.pos++]))<<31,s<128)return toNum(t,r,i);throw new Error("Expected varint not more than 10 bytes")}function readPackedEnd(t){return t.type===Pbf.Bytes?t.readVarint()+t.pos:t.pos+1}function toNum(t,i,e){return e?4294967296*i+(t>>>0):4294967296*(i>>>0)+(t>>>0)}function writeBigVarint(t,i){var e,r;if(t>=0?(e=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(e=~(-t%4294967296))?e=e+1|0:(e=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),writeBigVarintLow(e,r,i),writeBigVarintHigh(r,i)}function writeBigVarintLow(t,i,e){e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos]=127&t}function writeBigVarintHigh(t,i){var e=(7&t)<<4;i.buf[i.pos++]|=e|((t>>>=3)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t)))))}function makeRoomForExtraLength(t,i,e){var r=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));e.realloc(r);for(var s=e.pos-1;s>=t;s--)e.buf[s+r]=e.buf[s]}function _writePackedVarint(t,i){for(var e=0;e<t.length;e++)i.writeVarint(t[e])}function _writePackedSVarint(t,i){for(var e=0;e<t.length;e++)i.writeSVarint(t[e])}function _writePackedFloat(t,i){for(var e=0;e<t.length;e++)i.writeFloat(t[e])}function _writePackedDouble(t,i){for(var e=0;e<t.length;e++)i.writeDouble(t[e])}function _writePackedBoolean(t,i){for(var e=0;e<t.length;e++)i.writeBoolean(t[e])}function _writePackedFixed(t,i){for(var e=0;e<t.length;e++)i.writeFixed32(t[e])}function _writePackedSFixed(t,i){for(var e=0;e<t.length;e++)i.writeSFixed32(t[e])}function _writePackedFixed2(t,i){for(var e=0;e<t.length;e++)i.writeFixed64(t[e])}function _writePackedSFixed2(t,i){for(var e=0;e<t.length;e++)i.writeSFixed64(t[e])}function readUInt32(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+16777216*t[i+3]}function writeInt32(t,i,e){t[e]=i,t[e+1]=i>>>8,t[e+2]=i>>>16,t[e+3]=i>>>24}function readInt32(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+(t[i+3]<<24)}function readUtf8(t,i,e){for(var r="",s=i;s<e;){var n,o,a,h=t[s],u=null,f=h>239?4:h>223?3:h>191?2:1;if(s+f>e)break;1===f?h<128&&(u=h):2===f?128==(192&(n=t[s+1]))&&(u=(31&h)<<6|63&n)<=127&&(u=null):3===f?(n=t[s+1],o=t[s+2],128==(192&n)&&128==(192&o)&&((u=(15&h)<<12|(63&n)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===f&&(n=t[s+1],o=t[s+2],a=t[s+3],128==(192&n)&&128==(192&o)&&128==(192&a)&&((u=(15&h)<<18|(63&n)<<12|(63&o)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,f=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),s+=f}return r}function readUtf8TextDecoder(t,i,e){return utf8TextDecoder.decode(t.subarray(i,e))}function writeUtf8(t,i,e){for(var r,s,n=0;n<i.length;n++){if((r=i.charCodeAt(n))>55295&&r<57344){if(!s){r>56319||n+1===i.length?(t[e++]=239,t[e++]=191,t[e++]=189):s=r;continue}if(r<56320){t[e++]=239,t[e++]=191,t[e++]=189,s=r;continue}r=s-55296<<10|r-56320|65536,s=null}else s&&(t[e++]=239,t[e++]=191,t[e++]=189,s=null);r<128?t[e++]=r:(r<2048?t[e++]=r>>6|192:(r<65536?t[e++]=r>>12|224:(t[e++]=r>>18|240,t[e++]=r>>12&63|128),t[e++]=r>>6&63|128),t[e++]=63&r|128)}return e}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(t,i,e){for(e=e||this.length;this.pos<e;){var r=this.readVarint(),s=r>>3,n=this.pos;this.type=7&r,t(s,i,this),this.pos===n&&this.skip(r)}return i},readMessage:function(t,i){return this.readFields(t,i,this.readVarint()+this.pos)},readFixed32:function(){var t=readUInt32(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=readInt32(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,t},readSFixed64:function(){var t=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,t},readFloat:function(){var t=ieee754.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ieee754.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var i,e,r=this.buf;return i=127&(e=r[this.pos++]),e<128?i:(i|=(127&(e=r[this.pos++]))<<7,e<128?i:(i|=(127&(e=r[this.pos++]))<<14,e<128?i:(i|=(127&(e=r[this.pos++]))<<21,e<128?i:readVarintRemainder(i|=(15&(e=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,i=this.pos;return this.pos=t,t-i>=TEXT_DECODER_MIN_LENGTH&&utf8TextDecoder?readUtf8TextDecoder(this.buf,i,t):readUtf8(this.buf,i,t)},readBytes:function(){var t=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,t);return this.pos=t,i},readPackedVarint:function(t,i){if(this.type!==Pbf.Bytes)return t.push(this.readVarint(i));var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readVarint(i));return t},readPackedSVarint:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readSVarint());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readBoolean());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readFloat());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readDouble());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readFixed32());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readSFixed32());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readFixed64());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Pbf.Bytes)return t.push(this.readSFixed64());var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed64());return t},skip:function(t){var i=7&t;if(i===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(i===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Pbf.Fixed32)this.pos+=4;else{if(i!==Pbf.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(t,i){this.writeVarint(t<<3|i)},realloc:function(t){for(var i=this.length||16;i<this.pos+t;)i*=2;if(i!==this.length){var e=new Uint8Array(i);e.set(this.buf),this.buf=e,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),writeInt32(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),writeInt32(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),writeInt32(this.buf,-1&t,this.pos),writeInt32(this.buf,Math.floor(t*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),writeInt32(this.buf,-1&t,this.pos),writeInt32(this.buf,Math.floor(t*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?writeBigVarint(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var i=this.pos;this.pos=writeUtf8(this.buf,t,this.pos);var e=this.pos-i;e>=128&&makeRoomForExtraLength(i,e,this),this.pos=i-1,this.writeVarint(e),this.pos+=e},writeFloat:function(t){this.realloc(4),ieee754.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ieee754.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var i=t.length;this.writeVarint(i),this.realloc(i);for(var e=0;e<i;e++)this.buf[this.pos++]=t[e]},writeRawMessage:function(t,i){this.pos++;var e=this.pos;t(i,this);var r=this.pos-e;r>=128&&makeRoomForExtraLength(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,i,e){this.writeTag(t,Pbf.Bytes),this.writeRawMessage(i,e)},writePackedVarint:function(t,i){i.length&&this.writeMessage(t,_writePackedVarint,i)},writePackedSVarint:function(t,i){i.length&&this.writeMessage(t,_writePackedSVarint,i)},writePackedBoolean:function(t,i){i.length&&this.writeMessage(t,_writePackedBoolean,i)},writePackedFloat:function(t,i){i.length&&this.writeMessage(t,_writePackedFloat,i)},writePackedDouble:function(t,i){i.length&&this.writeMessage(t,_writePackedDouble,i)},writePackedFixed32:function(t,i){i.length&&this.writeMessage(t,_writePackedFixed,i)},writePackedSFixed32:function(t,i){i.length&&this.writeMessage(t,_writePackedSFixed,i)},writePackedFixed64:function(t,i){i.length&&this.writeMessage(t,_writePackedFixed2,i)},writePackedSFixed64:function(t,i){i.length&&this.writeMessage(t,_writePackedSFixed2,i)},writeBytesField:function(t,i){this.writeTag(t,Pbf.Bytes),this.writeBytes(i)},writeFixed32Field:function(t,i){this.writeTag(t,Pbf.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(t,i){this.writeTag(t,Pbf.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(t,i){this.writeTag(t,Pbf.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(t,i){this.writeTag(t,Pbf.Fixed64),this.writeSFixed64(i)},writeVarintField:function(t,i){this.writeTag(t,Pbf.Varint),this.writeVarint(i)},writeSVarintField:function(t,i){this.writeTag(t,Pbf.Varint),this.writeSVarint(i)},writeStringField:function(t,i){this.writeTag(t,Pbf.Bytes),this.writeString(i)},writeFloatField:function(t,i){this.writeTag(t,Pbf.Fixed32),this.writeFloat(i)},writeDoubleField:function(t,i){this.writeTag(t,Pbf.Fixed64),this.writeDouble(i)},writeBooleanField:function(t,i){this.writeVarintField(t,Boolean(i))}};

},{"ieee754":71}],420:[function(require,module,exports){
"use strict";var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],421:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,s){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(void 0).proj4=s()}(0,function(){var t=1,s=2,i=3,a=4,h=5,e=484813681109536e-20,n=Math.PI/2,r=.16666666666666666,o=.04722222222222222,l=.022156084656084655,u=1e-10,c=.017453292519943295,M=57.29577951308232,f=Math.PI/4,d=2*Math.PI,p=3.14159265359,m={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},_={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},y=/[\s_\-\/\(\)]/g;function x(t,s){if(t[s])return t[s];for(var i,a=Object.keys(t),h=s.toLowerCase().replace(y,""),e=-1;++e<a.length;)if((i=a[e]).toLowerCase().replace(y,"")===h)return t[i]}var g=function(t){var s,i,a,h={},e=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,s){var i=s.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t},{}),n={proj:"projName",datum:"datumCode",rf:function(t){h.rf=parseFloat(t)},lat_0:function(t){h.lat0=t*c},lat_1:function(t){h.lat1=t*c},lat_2:function(t){h.lat2=t*c},lat_ts:function(t){h.lat_ts=t*c},lon_0:function(t){h.long0=t*c},lon_1:function(t){h.long1=t*c},lon_2:function(t){h.long2=t*c},alpha:function(t){h.alpha=parseFloat(t)*c},gamma:function(t){h.rectified_grid_angle=parseFloat(t)},lonc:function(t){h.longc=t*c},x_0:function(t){h.x0=parseFloat(t)},y_0:function(t){h.y0=parseFloat(t)},k_0:function(t){h.k0=parseFloat(t)},k:function(t){h.k0=parseFloat(t)},a:function(t){h.a=parseFloat(t)},b:function(t){h.b=parseFloat(t)},r:function(t){h.a=h.b=parseFloat(t)},r_a:function(){h.R_A=!0},zone:function(t){h.zone=parseInt(t,10)},south:function(){h.utmSouth=!0},towgs84:function(t){h.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){h.to_meter=parseFloat(t)},units:function(t){h.units=t;var s=x(_,t);s&&(h.to_meter=s.to_meter)},from_greenwich:function(t){h.from_greenwich=t*c},pm:function(t){var s=x(m,t);h.from_greenwich=(s||parseFloat(t))*c},nadgrids:function(t){"@null"===t?h.datumCode="none":h.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(h.axis=t)},approx:function(){h.approx=!0}};for(s in e)i=e[s],s in n?"function"==typeof(a=n[s])?a(i):h[a]=i:h[s]=i;return"string"==typeof h.datumCode&&"WGS84"!==h.datumCode&&(h.datumCode=h.datumCode.toLowerCase()),h},v=1,b=/\s/,w=/[A-Za-z]/,N=/[A-Za-z84_]/,E=/[,\]]/,A=/[\d\.E\-\+]/;function C(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=v}function P(t,s,i){Array.isArray(s)&&(i.unshift(s),s=null);var a=s?{}:t,h=i.reduce(function(t,s){return S(s,t),t},a);s&&(t[s]=h)}function S(t,s){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(s[i]={},void S(t[0],s[i])):void(s[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in s||(s[i]=[]),void s[i].push(t);var a;switch(Array.isArray(i)||(s[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return s[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&S(t[2],s[i]));case"SPHEROID":case"ELLIPSOID":return s[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&S(t[3],s[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void P(s,i,t);default:for(a=-1;++a<t.length;)if(!Array.isArray(t[a]))return S(t,s[i]);return P(s,i,t)}}else s[i]=t;else s[i]=!0}else s[t]=!0}C.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;b.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case v:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},C.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(E.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},C.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=v)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=v,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},C.prototype.number=function(t){if(!A.test(t)){if(E.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},C.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},C.prototype.keyword=function(t){if(N.test(t))this.word+=t;else{if("["===t){var s=[];return s.push(this.word),this.level++,null===this.root?this.root=s:this.currentObject.push(s),this.stack.push(this.currentObject),this.currentObject=s,void(this.state=v)}if(!E.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},C.prototype.neutral=function(t){if(w.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(A.test(t))return this.word=t,void(this.state=3);if(!E.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},C.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var I=.017453292519943295;function O(t){return t*I}var k=function(t){var s=new C(t).output(),i=s.shift(),a=s.shift();s.unshift(["name",a]),s.unshift(["type",i]);var h={};return S(s,h),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"===_typeof(t.PROJECTION)?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var s="",i=0,a=t.AXIS.length;i<a;++i){var h=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==h[0].indexOf("north")||("y"===h[0]||"lat"===h[0])&&"north"===h[1]?s+="n":-1!==h[0].indexOf("south")||("y"===h[0]||"lat"===h[0])&&"south"===h[1]?s+="s":-1!==h[0].indexOf("east")||("x"===h[0]||"lon"===h[0])&&"east"===h[1]?s+="e":-1===h[0].indexOf("west")&&("x"!==h[0]&&"lon"!==h[0]||"west"!==h[1])||(s+="w")}2===s.length&&(s+="u"),3===s.length&&(t.axis=s)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var e=t.GEOGCS;function n(s){return s*(t.to_meter||1)}"GEOGCS"===t.type&&(e=t),e&&(e.DATUM?t.datumCode=e.DATUM.name.toLowerCase():t.datumCode=e.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),e.DATUM&&e.DATUM.SPHEROID&&(t.ellps=e.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=e.DATUM.SPHEROID.a,t.rf=parseFloat(e.DATUM.SPHEROID.rf,10)),e.DATUM&&e.DATUM.TOWGS84&&(t.datum_params=e.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",O],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",O],["x0","false_easting",n],["y0","false_northing",n],["long0","central_meridian",O],["lat0","latitude_of_origin",O],["lat0","standard_parallel_1",O],["lat1","standard_parallel_1",O],["lat2","standard_parallel_2",O],["azimuth","Azimuth"],["alpha","azimuth",O],["srsCode","name"]].forEach(function(s){return i=t,h=(a=s)[0],e=a[1],void(!(h in i)&&e in i&&(i[h]=i[e],3===a.length&&(i[h]=a[2](i[h]))));var i,a,h,e}),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName?!t.lat_ts&&t.lat0&&"Polar_Stereographic"===t.projName&&(t.lat_ts=t.lat0,t.lat0=O(t.lat0>0?90:-90)):(t.lat0=O(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(h),h};function q(t){var s=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?q[t]=g(arguments[1]):q[t]=k(arguments[1]):q[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?q.apply(s,t):q(t)});if("string"==typeof t){if(t in q)return q[t]}else"EPSG"in t?q["EPSG:"+t.EPSG]=t:"ESRI"in t?q["ESRI:"+t.ESRI]=t:"IAU2000"in t?q["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(q);var R=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var L=["3857","900913","3785","102113"];function G(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in q}(t))return q[t];if(function(t){return R.some(function(s){return t.indexOf(s)>-1})}(t)){var s=k(t);if(function(t){var s=x(t,"authority");if(s){var i=x(s,"epsg");return i&&L.indexOf(i)>-1}}(s))return q["EPSG:3857"];var i=function(t){var s=x(t,"extension");if(s)return x(s,"proj4")}(s);return i?g(i):s}return function(t){return"+"===t[0]}(t)?g(t):void 0}var T=function(t,s){var i,a;if(t=t||{},!s)return t;for(a in s)void 0!==(i=s[a])&&(t[a]=i);return t},j=function(t,s,i){var a=t*s;return i/Math.sqrt(1-a*a)},B=function(t){return t<0?-1:1},z=function(t){return Math.abs(t)<=p?t:t-B(t)*d},F=function(t,s,i){var a=t*i,h=.5*t;return a=Math.pow((1-a)/(1+a),h),Math.tan(.5*(n-s))/a},D=function(t,s){for(var i,a,h=.5*t,e=n-2*Math.atan(s),r=0;r<=15;r++)if(i=t*Math.sin(e),e+=a=n-2*Math.atan(s*Math.pow((1-i)/(1+i),h))-e,Math.abs(a)<=1e-10)return e;return-9999};function U(t){return t}var Q=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=j(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var s,i,a=t.x,h=t.y;if(h*M>90&&h*M<-90&&a*M>180&&a*M<-180)return null;if(Math.abs(Math.abs(h)-n)<=u)return null;if(this.sphere)s=this.x0+this.a*this.k0*z(a-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(f+.5*h));else{var e=Math.sin(h),r=F(this.e,h,e);s=this.x0+this.a*this.k0*z(a-this.long0),i=this.y0-this.a*this.k0*Math.log(r)}return t.x=s,t.y=i,t},inverse:function(t){var s,i,a=t.x-this.x0,h=t.y-this.y0;if(this.sphere)i=n-2*Math.atan(Math.exp(-h/(this.a*this.k0)));else{var e=Math.exp(-h/(this.a*this.k0));if(-9999===(i=D(this.e,e)))return null}return s=z(this.long0+a/(this.a*this.k0)),t.x=s,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:U,inverse:U,names:["longlat","identity"]}],W={},H=[];function X(t,s){var i=H.length;return t.names?(H[i]=t,t.names.forEach(function(t){W[t.toLowerCase()]=i}),this):(console.log(s),!0)}var K={start:function(){Q.forEach(X)},add:X,get:function(t){if(!t)return!1;var s=t.toLowerCase();return void 0!==W[s]&&H[W[s]]?H[W[s]]:void 0}},J={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},V=J.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};J.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Z={};Z.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Z.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Z.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Z.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Z.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Z.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Z.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Z.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},Z.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},Z.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Z.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Z.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Z.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Z.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Z.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Z.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Z.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Z.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var Y={};function $(t){if(0===t.length)return null;var s="@"===t[0];return s&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!s,grid:null,isNull:!0}:{name:t,mandatory:!s,grid:Y[t]||null,isNull:!1}}function tt(t){return t/3600*Math.PI/180}function st(t,s,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(s,i)))}function it(t){return t.map(function(t){return[tt(t.longitudeShift),tt(t.latitudeShift)]})}function at(t,s,i){return{name:st(t,s+8,s+16).trim(),parent:st(t,s+24,s+24+8).trim(),lowerLatitude:t.getFloat64(s+72,i),upperLatitude:t.getFloat64(s+88,i),lowerLongitude:t.getFloat64(s+104,i),upperLongitude:t.getFloat64(s+120,i),latitudeInterval:t.getFloat64(s+136,i),longitudeInterval:t.getFloat64(s+152,i),gridNodeCount:t.getInt32(s+168,i)}}function ht(t,s,i,a){for(var h=s+176,e=[],n=0;n<i.gridNodeCount;n++){var r={latitudeShift:t.getFloat32(h+16*n,a),longitudeShift:t.getFloat32(h+16*n+4,a),latitudeAccuracy:t.getFloat32(h+16*n+8,a),longitudeAccuracy:t.getFloat32(h+16*n+12,a)};e.push(r)}return e}function et(n,c){if(!(this instanceof et))return new et(n);c=c||function(t){if(t)throw t};var M=G(n);if("object"===_typeof(M)){var f=et.projections.get(M.projName);if(f){if(M.datumCode&&"none"!==M.datumCode){var d=x(Z,M.datumCode);d&&(M.datum_params=M.datum_params||(d.towgs84?d.towgs84.split(","):null),M.ellps=d.ellipse,M.datumName=d.datumName?d.datumName:M.datumCode)}M.k0=M.k0||1,M.axis=M.axis||"enu",M.ellps=M.ellps||"wgs84",M.lat1=M.lat1||M.lat0;var p,m,_,y,g,v,b,w=function(t,s,i,a,h){if(!t){var e=x(J,a);e||(e=V),t=e.a,s=e.b,i=e.rf}return i&&!s&&(s=(1-1/i)*t),(0===i||Math.abs(t-s)<u)&&(h=!0,s=t),{a:t,b:s,rf:i,sphere:h}}(M.a,M.b,M.rf,M.ellps,M.sphere),N=(p=w.a,m=w.b,w.rf,_=M.R_A,v=((y=p*p)-(g=m*m))/y,b=0,_?(y=(p*=1-v*(r+v*(o+v*l)))*p,v=0):b=Math.sqrt(v),{es:v,e:b,ep2:(y-g)/g}),E=function(t){return void 0===t?null:t.split(",").map($)}(M.nadgrids),A=M.datum||function(n,r,o,l,u,c,M){var f={};return f.datum_type=void 0===n||"none"===n?h:a,r&&(f.datum_params=r.map(parseFloat),0===f.datum_params[0]&&0===f.datum_params[1]&&0===f.datum_params[2]||(f.datum_type=t),f.datum_params.length>3&&(0===f.datum_params[3]&&0===f.datum_params[4]&&0===f.datum_params[5]&&0===f.datum_params[6]||(f.datum_type=s,f.datum_params[3]*=e,f.datum_params[4]*=e,f.datum_params[5]*=e,f.datum_params[6]=f.datum_params[6]/1e6+1))),M&&(f.datum_type=i,f.grids=M),f.a=o,f.b=l,f.es=u,f.ep2=c,f}(M.datumCode,M.datum_params,w.a,w.b,N.es,N.ep2,E);T(this,M),T(this,f),this.a=w.a,this.b=w.b,this.rf=w.rf,this.sphere=w.sphere,this.es=N.es,this.e=N.e,this.ep2=N.ep2,this.datum=A,this.init(),c(null,this)}else c(n)}else c(n)}function nt(t,s,i){var a,h,e,r,o=t.x,l=t.y,u=t.z?t.z:0;if(l<-n&&l>-1.001*n)l=-n;else if(l>n&&l<1.001*n)l=n;else{if(l<-n)return{x:-1/0,y:-1/0,z:t.z};if(l>n)return{x:1/0,y:1/0,z:t.z}}return o>Math.PI&&(o-=2*Math.PI),h=Math.sin(l),r=Math.cos(l),e=h*h,{x:((a=i/Math.sqrt(1-s*e))+u)*r*Math.cos(o),y:(a+u)*r*Math.sin(o),z:(a*(1-s)+u)*h}}function rt(t,s,i,a){var h,e,r,o,l,u,c,M,f,d,p,m,_,y,x,g=t.x,v=t.y,b=t.z?t.z:0;if(h=Math.sqrt(g*g+v*v),e=Math.sqrt(g*g+v*v+b*b),h/i<1e-12){if(y=0,e/i<1e-12)return n,x=-a,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(v,g);r=b/e,M=(o=h/e)*(1-s)*(l=1/Math.sqrt(1-s*(2-s)*o*o)),f=r*l,_=0;do{_++,u=s*(c=i/Math.sqrt(1-s*f*f))/(c+(x=h*M+b*f-c*(1-s*f*f))),m=(p=r*(l=1/Math.sqrt(1-u*(2-u)*o*o)))*M-(d=o*(1-u)*l)*f,M=d,f=p}while(m*m>1e-24&&_<30);return{x:y,y:Math.atan(p/Math.abs(d)),z:x}}function ot(i){return i===t||i===s}et.projections=K,et.projections.start();var lt=function(a,e,n){if(function(i,a){return i.datum_type===a.datum_type&&!(i.a!==a.a||Math.abs(i.es-a.es)>5e-11)&&(i.datum_type===t?i.datum_params[0]===a.datum_params[0]&&i.datum_params[1]===a.datum_params[1]&&i.datum_params[2]===a.datum_params[2]:i.datum_type!==s||i.datum_params[0]===a.datum_params[0]&&i.datum_params[1]===a.datum_params[1]&&i.datum_params[2]===a.datum_params[2]&&i.datum_params[3]===a.datum_params[3]&&i.datum_params[4]===a.datum_params[4]&&i.datum_params[5]===a.datum_params[5]&&i.datum_params[6]===a.datum_params[6])}(a,e))return n;if(a.datum_type===h||e.datum_type===h)return n;var r=a.a,o=a.es;if(a.datum_type===i){if(0!==ut(a,!1,n))return;r=6378137,o=.0066943799901413165}var l=e.a,u=e.b,c=e.es;if(e.datum_type===i&&(l=6378137,u=6356752.314,c=.0066943799901413165),o===c&&r===l&&!ot(a.datum_type)&&!ot(e.datum_type))return n;if((n=nt(n,o,r),ot(a.datum_type)&&(n=function(i,a,h){if(a===t)return{x:i.x+h[0],y:i.y+h[1],z:i.z+h[2]};if(a===s){var e=h[0],n=h[1],r=h[2],o=h[3],l=h[4],u=h[5],c=h[6];return{x:c*(i.x-u*i.y+l*i.z)+e,y:c*(u*i.x+i.y-o*i.z)+n,z:c*(-l*i.x+o*i.y+i.z)+r}}}(n,a.datum_type,a.datum_params)),ot(e.datum_type)&&(n=function(i,a,h){if(a===t)return{x:i.x-h[0],y:i.y-h[1],z:i.z-h[2]};if(a===s){var e=h[0],n=h[1],r=h[2],o=h[3],l=h[4],u=h[5],c=h[6],M=(i.x-e)/c,f=(i.y-n)/c,d=(i.z-r)/c;return{x:M+u*f-l*d,y:-u*M+f+o*d,z:l*M-o*f+d}}}(n,e.datum_type,e.datum_params)),n=rt(n,c,l,u),e.datum_type===i)&&0!==ut(e,!0,n))return;return n};function ut(t,s,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;var a={x:-i.x,y:i.y},h={x:Number.NaN,y:Number.NaN},e=[];t:for(var n=0;n<t.grids.length;n++){var r=t.grids[n];if(e.push(r.name),r.isNull){h=a;break}if(null!==r.grid)for(var o=r.grid.subgrids,l=0,u=o.length;l<u;l++){var c=o[l],f=(Math.abs(c.del[1])+Math.abs(c.del[0]))/1e4,d=c.ll[0]-f,p=c.ll[1]-f,m=c.ll[0]+(c.lim[0]-1)*c.del[0]+f,_=c.ll[1]+(c.lim[1]-1)*c.del[1]+f;if(!(p>a.y||d>a.x||_<a.y||m<a.x)&&(h=ct(a,s,c),!isNaN(h.x)))break t}else if(r.mandatory)return console.log("Unable to find mandatory grid '"+r.name+"'"),-1}return isNaN(h.x)?(console.log("Failed to find a grid shift table for location '"+-a.x*M+" "+a.y*M+" tried: '"+e+"'"),-1):(i.x=-h.x,i.y=h.y,0)}function ct(t,s,i){var a={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return a;var h={x:t.x,y:t.y};h.x-=i.ll[0],h.y-=i.ll[1],h.x=z(h.x-Math.PI)+Math.PI;var e=Mt(h,i);if(s){if(isNaN(e.x))return a;e.x=h.x-e.x,e.y=h.y-e.y;var n,r,o=9;do{if(r=Mt(e,i),isNaN(r.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}n={x:h.x-(r.x+e.x),y:h.y-(r.y+e.y)},e.x+=n.x,e.y+=n.y}while(o--&&Math.abs(n.x)>1e-12&&Math.abs(n.y)>1e-12);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),a;a.x=z(e.x+i.ll[0]),a.y=e.y+i.ll[1]}else isNaN(e.x)||(a.x=t.x+e.x,a.y=t.y+e.y);return a}function Mt(t,s){var i,a={x:t.x/s.del[0],y:t.y/s.del[1]},h=Math.floor(a.x),e=Math.floor(a.y),n=a.x-1*h,r=a.y-1*e,o={x:Number.NaN,y:Number.NaN};if(h<0||h>=s.lim[0])return o;if(e<0||e>=s.lim[1])return o;i=e*s.lim[0]+h;var l=s.cvs[i][0],u=s.cvs[i][1];i++;var c=s.cvs[i][0],M=s.cvs[i][1];i+=s.lim[0];var f=s.cvs[i][0],d=s.cvs[i][1];i--;var p=s.cvs[i][0],m=s.cvs[i][1],_=n*r,y=n*(1-r),x=(1-n)*(1-r),g=(1-n)*r;return o.x=x*l+y*c+g*p+_*f,o.y=x*u+y*M+g*m+_*d,o}var ft=function(t,s,i){var a,h,e,n=i.x,r=i.y,o=i.z||0,l={};for(e=0;e<3;e++)if(!s||2!==e||void 0!==i.z)switch(0===e?(a=n,h=-1!=="ew".indexOf(t.axis[e])?"x":"y"):1===e?(a=r,h=-1!=="ns".indexOf(t.axis[e])?"y":"x"):(a=o,h="z"),t.axis[e]){case"e":l[h]=a;break;case"w":l[h]=-a;break;case"n":l[h]=a;break;case"s":l[h]=-a;break;case"u":void 0!==i[h]&&(l.z=a);break;case"d":void 0!==i[h]&&(l.z=-a);break;default:return null}return l},dt=function(t){var s={x:t[0],y:t[1]};return t.length>2&&(s.z=t[2]),t.length>3&&(s.m=t[3]),s},pt=function(t){mt(t.x),mt(t.y)};function mt(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function _t(a,h,e,n){var r,o=void 0!==(e=Array.isArray(e)?dt(e):{x:e.x,y:e.y,z:e.z,m:e.m}).z;if(pt(e),a.datum&&h.datum&&function(a,h){return(a.datum.datum_type===t||a.datum.datum_type===s||a.datum.datum_type===i)&&"WGS84"!==h.datumCode||(h.datum.datum_type===t||h.datum.datum_type===s||h.datum.datum_type===i)&&"WGS84"!==a.datumCode}(a,h)&&(e=_t(a,r=new et("WGS84"),e,n),a=r),n&&"enu"!==a.axis&&(e=ft(a,!1,e)),"longlat"===a.projName)e={x:e.x*c,y:e.y*c,z:e.z||0};else if(a.to_meter&&(e={x:e.x*a.to_meter,y:e.y*a.to_meter,z:e.z||0}),!(e=a.inverse(e)))return;if(a.from_greenwich&&(e.x+=a.from_greenwich),e=lt(a.datum,h.datum,e))return h.from_greenwich&&(e={x:e.x-h.from_greenwich,y:e.y,z:e.z||0}),"longlat"===h.projName?e={x:e.x*M,y:e.y*M,z:e.z||0}:(e=h.forward(e),h.to_meter&&(e={x:e.x/h.to_meter,y:e.y/h.to_meter,z:e.z||0})),n&&"enu"!==h.axis?ft(h,!0,e):(e&&!o&&delete e.z,e)}var yt=et("WGS84");function xt(t,s,i,a){var h,e,n;return Array.isArray(i)?(h=_t(t,s,i,a)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==s.name&&"geocent"===s.name?"number"==typeof h.z?[h.x,h.y,h.z].concat(i.splice(3)):[h.x,h.y,i[2]].concat(i.splice(3)):[h.x,h.y].concat(i.splice(2)):[h.x,h.y]):(e=_t(t,s,i,a),2===(n=Object.keys(i)).length?e:(n.forEach(function(a){if(void 0!==t.name&&"geocent"===t.name||void 0!==s.name&&"geocent"===s.name){if("x"===a||"y"===a||"z"===a)return}else if("x"===a||"y"===a)return;e[a]=i[a]}),e))}function gt(t){return t instanceof et?t:t.oProj?t.oProj:et(t)}function vt(t,s,i){t=gt(t);var a,h=!1;return void 0===s?(s=t,t=yt,h=!0):(void 0!==s.x||Array.isArray(s))&&(i=s,s=t,t=yt,h=!0),s=gt(s),i?xt(t,s,i):(a={forward:function(i,a){return xt(t,s,i,a)},inverse:function(i,a){return xt(s,t,i,a)}},h&&(a.oProj=s),a)}var bt=6,wt="AJSAJS",Nt="AFAFAF",Et=65,At=73,Ct=79,Pt=86,St=90,It={forward:Ot,inverse:function(t){var s=Lt(jt(t.toUpperCase()));if(s.lat&&s.lon)return[s.lon,s.lat,s.lon,s.lat];return[s.left,s.bottom,s.right,s.top]},toPoint:kt};function Ot(t,s){return s=s||5,function(t,s){var i="00000"+t.easting,a="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(f=t.easting,d=t.northing,p=t.zoneNumber,m=Tt(p),_=Math.floor(f/1e5),y=Math.floor(d/1e5)%20,h=_,e=y,n=m,r=n-1,o=wt.charCodeAt(r),l=Nt.charCodeAt(r),u=o+h-1,c=l+e,M=!1,u>St&&(u=u-St+Et-1,M=!0),(u===At||o<At&&u>At||(u>At||o<At)&&M)&&u++,(u===Ct||o<Ct&&u>Ct||(u>Ct||o<Ct)&&M)&&++u===At&&u++,u>St&&(u=u-St+Et-1),c>Pt?(c=c-Pt+Et-1,M=!0):M=!1,(c===At||l<At&&c>At||(c>At||l<At)&&M)&&c++,(c===Ct||l<Ct&&c>Ct||(c>Ct||l<Ct)&&M)&&++c===At&&c++,c>Pt&&(c=c-Pt+Et-1),String.fromCharCode(u)+String.fromCharCode(c))+i.substr(i.length-5,s)+a.substr(a.length-5,s);var h,e,n,r,o,l,u,c,M;var f,d,p,m,_,y}(function(t){var s,i,a,h,e,n,r,o=t.lat,l=t.lon,u=6378137,c=qt(o),M=qt(l);r=Math.floor((l+180)/6)+1,180===l&&(r=60);o>=56&&o<64&&l>=3&&l<12&&(r=32);o>=72&&o<84&&(l>=0&&l<9?r=31:l>=9&&l<21?r=33:l>=21&&l<33?r=35:l>=33&&l<42&&(r=37));n=qt(6*(r-1)-180+3),.006739496752268451,s=u/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),i=Math.tan(c)*Math.tan(c),a=.006739496752268451*Math.cos(c)*Math.cos(c),h=Math.cos(c)*(M-n),e=u*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3.418046101696858e-9*Math.sin(6*c));var f=.9996*s*(h+(1-i+a)*h*h*h/6+(5-18*i+i*i+72*a-.39089081163157013)*h*h*h*h*h/120)+5e5,d=.9996*(e+s*Math.tan(c)*(h*h/2+(5-i+9*a+4*a*a)*h*h*h*h/24+(61-58*i+i*i+600*a-2.2240339282485886)*h*h*h*h*h*h/720));o<0&&(d+=1e7);return{northing:Math.round(d),easting:Math.round(f),zoneNumber:r,zoneLetter:Gt(o)}}({lat:t[1],lon:t[0]}),s)}function kt(t){var s=Lt(jt(t.toUpperCase()));return s.lat&&s.lon?[s.lon,s.lat]:[(s.left+s.right)/2,(s.top+s.bottom)/2]}function qt(t){return t*(Math.PI/180)}function Rt(t){return t/Math.PI*180}function Lt(t){var s=t.northing,i=t.easting,a=t.zoneLetter,h=t.zoneNumber;if(h<0||h>60)return null;var e,n,r,o,l,u,c,M,f=6378137,d=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),p=i-5e5,m=s;a<"N"&&(m-=1e7),u=6*(h-1)-180+3,M=(c=m/.9996/6367449.145945056)+(3*d/2-27*d*d*d/32)*Math.sin(2*c)+(21*d*d/16-55*d*d*d*d/32)*Math.sin(4*c)+151*d*d*d/96*Math.sin(6*c),e=f/Math.sqrt(1-.00669438*Math.sin(M)*Math.sin(M)),n=Math.tan(M)*Math.tan(M),r=.006739496752268451*Math.cos(M)*Math.cos(M),o=.99330562*f/Math.pow(1-.00669438*Math.sin(M)*Math.sin(M),1.5),l=p/(.9996*e);var _=M-e*Math.tan(M)/o*(l*l/2-(5+3*n+10*r-4*r*r-.06065547077041606)*l*l*l*l/24+(61+90*n+298*r+45*n*n-1.6983531815716497-3*r*r)*l*l*l*l*l*l/720);_=Rt(_);var y,x=(l-(1+2*n+r)*l*l*l/6+(5-2*r+28*n-3*r*r+.05391597401814761+24*n*n)*l*l*l*l*l/120)/Math.cos(M);if(x=u+Rt(x),t.accuracy){var g=Lt({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});y={top:g.lat,right:g.lon,bottom:_,left:x}}else y={lat:_,lon:x};return y}function Gt(t){var s="Z";return 84>=t&&t>=72?s="X":72>t&&t>=64?s="W":64>t&&t>=56?s="V":56>t&&t>=48?s="U":48>t&&t>=40?s="T":40>t&&t>=32?s="S":32>t&&t>=24?s="R":24>t&&t>=16?s="Q":16>t&&t>=8?s="P":8>t&&t>=0?s="N":0>t&&t>=-8?s="M":-8>t&&t>=-16?s="L":-16>t&&t>=-24?s="K":-24>t&&t>=-32?s="J":-32>t&&t>=-40?s="H":-40>t&&t>=-48?s="G":-48>t&&t>=-56?s="F":-56>t&&t>=-64?s="E":-64>t&&t>=-72?s="D":-72>t&&t>=-80&&(s="C"),s}function Tt(t){var s=t%bt;return 0===s&&(s=bt),s}function jt(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var s,i=t.length,a=null,h="",e=0;!/[A-Z]/.test(s=t.charAt(e));){if(e>=2)throw"MGRSPoint bad conversion from: "+t;h+=s,e++}var n=parseInt(h,10);if(0===e||e+3>i)throw"MGRSPoint bad conversion from: "+t;var r=t.charAt(e++);if(r<="A"||"B"===r||"Y"===r||r>="Z"||"I"===r||"O"===r)throw"MGRSPoint zone letter "+r+" not handled: "+t;a=t.substring(e,e+=2);for(var o=Tt(n),l=function(t,s){var i=wt.charCodeAt(s-1),a=1e5,h=!1;for(;i!==t.charCodeAt(0);){if(++i===At&&i++,i===Ct&&i++,i>St){if(h)throw"Bad character: "+t;i=Et,h=!0}a+=1e5}return a}(a.charAt(0),o),u=function(t,s){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var i=Nt.charCodeAt(s-1),a=0,h=!1;for(;i!==t.charCodeAt(0);){if(++i===At&&i++,i===Ct&&i++,i>Pt){if(h)throw"Bad character: "+t;i=Et,h=!0}a+=1e5}return a}(a.charAt(1),o);u<Bt(r);)u+=2e6;var c=i-e;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var M,f,d,p=c/2,m=0,_=0;return p>0&&(M=1e5/Math.pow(10,p),f=t.substring(e,e+p),m=parseFloat(f)*M,d=t.substring(e+p),_=parseFloat(d)*M),{easting:m+l,northing:_+u,zoneLetter:r,zoneNumber:n,accuracy:M}}function Bt(t){var s;switch(t){case"C":s=11e5;break;case"D":s=2e6;break;case"E":s=28e5;break;case"F":s=37e5;break;case"G":s=46e5;break;case"H":s=55e5;break;case"J":s=64e5;break;case"K":s=73e5;break;case"L":s=82e5;break;case"M":s=91e5;break;case"N":s=0;break;case"P":s=8e5;break;case"Q":s=17e5;break;case"R":s=26e5;break;case"S":s=35e5;break;case"T":s=44e5;break;case"U":s=53e5;break;case"V":s=62e5;break;case"W":s=7e6;break;case"X":s=79e5;break;default:s=-1}if(s>=0)return s;throw"Invalid zone letter: "+t}function zt(t,s,i){if(!(this instanceof zt))return new zt(t,s,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"===_typeof(t))this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===s){var a=t.split(",");this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0}else this.x=t,this.y=s,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}zt.fromMGRS=function(t){return new zt(kt(t))},zt.prototype.toMGRS=function(t){return Ot([this.x,this.y],t)};var Ft=.01068115234375,Dt=function(t){var s=[];s[0]=1-t*(.25+t*(.046875+t*(.01953125+t*Ft))),s[1]=t*(.75-t*(.046875+t*(.01953125+t*Ft)));var i=t*t;return s[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,s[3]=i*(.3645833333333333-.005696614583333333*t),s[4]=i*t*.3076171875,s},Ut=function(t,s,i,a){return i*=s,s*=s,a[0]*t-i*(a[1]+s*(a[2]+s*(a[3]+s*a[4])))},Qt=function(t,s,i){for(var a=1/(1-s),h=t,e=20;e;--e){var n=Math.sin(h),r=1-s*n*n;if(h-=r=(Ut(h,n,Math.cos(h),i)-t)*(r*Math.sqrt(r))*a,Math.abs(r)<u)return h}return h};var Wt={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Dt(this.es),this.ml0=Ut(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var s,i,a,h=t.x,e=t.y,n=z(h-this.long0),r=Math.sin(e),o=Math.cos(e);if(this.es){var l=o*n,c=Math.pow(l,2),M=this.ep2*Math.pow(o,2),f=Math.pow(M,2),d=Math.abs(o)>u?Math.tan(e):0,p=Math.pow(d,2),m=Math.pow(p,2);s=1-this.es*Math.pow(r,2),l/=Math.sqrt(s);var _=Ut(e,r,o,this.en);i=this.a*(this.k0*l*(1+c/6*(1-p+M+c/20*(5-18*p+m+14*M-58*p*M+c/42*(61+179*m-m*p-479*p)))))+this.x0,a=this.a*(this.k0*(_-this.ml0+r*n*l/2*(1+c/12*(5-p+9*M+4*f+c/30*(61+m-58*p+270*M-330*p*M+c/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var y=o*Math.sin(n);if(Math.abs(Math.abs(y)-1)<u)return 93;if(i=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,a=o*Math.cos(n)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(a))>=1){if(y-1>u)return 93;a=0}else a=Math.acos(a);e<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return t.x=i,t.y=a,t},inverse:function(t){var s,i,a,h,e=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(this.es)if(s=this.ml0+r/this.k0,i=Qt(s,this.es,this.en),Math.abs(i)<n){var o=Math.sin(i),l=Math.cos(i),c=Math.abs(l)>u?Math.tan(i):0,M=this.ep2*Math.pow(l,2),f=Math.pow(M,2),d=Math.pow(c,2),p=Math.pow(d,2);s=1-this.es*Math.pow(o,2);var m=e*Math.sqrt(s)/this.k0,_=Math.pow(m,2);a=i-(s*=c)*_/(1-this.es)*.5*(1-_/12*(5+3*d-9*M*d+M-4*f-_/30*(61+90*d-252*M*d+45*p+46*M-_/56*(1385+3633*d+4095*p+1574*p*d)))),h=z(this.long0+m*(1-_/6*(1+2*d+M-_/20*(5+28*d+24*p+8*M*d+6*M-_/42*(61+662*d+1320*p+720*p*d))))/l)}else a=n*B(r),h=0;else{var y=Math.exp(e/this.k0),x=.5*(y-1/y),g=this.lat0+r/this.k0,v=Math.cos(g);s=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(x,2))),a=Math.asin(s),r<0&&(a=-a),h=0===x&&0===v?0:z(Math.atan2(x,v)+this.long0)}return t.x=h,t.y=a,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]},Ht=function(t){var s=Math.exp(t);return s=(s-1/s)/2},Xt=function(t,s){t=Math.abs(t),s=Math.abs(s);var i=Math.max(t,s),a=Math.min(t,s)/(i||1);return i*Math.sqrt(1+Math.pow(a,2))},Kt=function(t){var s=Math.abs(t);return s=function(t){var s=1+t,i=s-1;return 0===i?t:t*Math.log(s)/i}(s*(1+s/(Xt(1,s)+1))),t<0?-s:s},Jt=function(t,s){for(var i,a=2*Math.cos(2*s),h=t.length-1,e=t[h],n=0;--h>=0;)i=a*e-n+t[h],n=e,e=i;return s+i*Math.sin(2*s)},Vt=function(t,s){for(var i,a=2*Math.cos(s),h=t.length-1,e=t[h],n=0;--h>=0;)i=a*e-n+t[h],n=e,e=i;return Math.sin(s)*i},Zt=function(t,s,i){for(var a,h,e=Math.sin(s),n=Math.cos(s),r=Ht(i),o=function(t){var s=Math.exp(t);return s=(s+1/s)/2}(i),l=2*n*o,u=-2*e*r,c=t.length-1,M=t[c],f=0,d=0,p=0;--c>=0;)a=d,h=f,M=l*(d=M)-a-u*(f=p)+t[c],p=u*d-h+l*f;return[(l=e*o)*M-(u=n*r)*p,l*p+u*M]};var Yt={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Wt.init.apply(this),this.forward=Wt.forward,this.inverse=Wt.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),s=t/(2-t),i=s;this.cgb[0]=s*(2+s*(-2/3+s*(s*(116/45+s*(26/45+s*(-2854/675)))-2))),this.cbg[0]=s*(s*(2/3+s*(4/3+s*(-82/45+s*(32/45+s*(4642/4725)))))-2),i*=s,this.cgb[1]=i*(7/3+s*(s*(-227/45+s*(2704/315+s*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+s*(-16/15+s*(-13/9+s*(904/315+s*(-1522/945))))),i*=s,this.cgb[2]=i*(56/15+s*(-136/35+s*(-1262/105+s*(73814/2835)))),this.cbg[2]=i*(-26/15+s*(34/21+s*(1.6+s*(-12686/2835)))),i*=s,this.cgb[3]=i*(4279/630+s*(-332/35+s*(-399572/14175))),this.cbg[3]=i*(1237/630+s*(s*(-24832/14175)-2.4)),i*=s,this.cgb[4]=i*(4174/315+s*(-144838/6237)),this.cbg[4]=i*(-734/315+s*(109598/31185)),i*=s,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(s,2),this.Qn=this.k0/(1+s)*(1+i*(.25+i*(1/64+i/256))),this.utg[0]=s*(s*(2/3+s*(-37/96+s*(1/360+s*(81/512+s*(-96199/604800)))))-.5),this.gtu[0]=s*(.5+s*(-2/3+s*(5/16+s*(41/180+s*(-127/288+s*(7891/37800)))))),this.utg[1]=i*(-1/48+s*(-1/15+s*(437/1440+s*(-46/105+s*(1118711/3870720))))),this.gtu[1]=i*(13/48+s*(s*(557/1440+s*(281/630+s*(-1983433/1935360)))-.6)),i*=s,this.utg[2]=i*(-17/480+s*(37/840+s*(209/4480+s*(-5569/90720)))),this.gtu[2]=i*(61/240+s*(-103/140+s*(15061/26880+s*(167603/181440)))),i*=s,this.utg[3]=i*(-4397/161280+s*(11/504+s*(830251/7257600))),this.gtu[3]=i*(49561/161280+s*(-179/168+s*(6601661/7257600))),i*=s,this.utg[4]=i*(-4583/161280+s*(108847/3991680)),this.gtu[4]=i*(34729/80640+s*(-3418889/1995840)),i*=s,this.utg[5]=-.03233083094085698*i,this.gtu[5]=.6650675310896665*i;var a=Jt(this.cbg,this.lat0);this.Zb=-this.Qn*(a+Vt(this.gtu,2*a))},forward:function(t){var s=z(t.x-this.long0),i=t.y;i=Jt(this.cbg,i);var a=Math.sin(i),h=Math.cos(i),e=Math.sin(s),n=Math.cos(s);i=Math.atan2(a,n*h),s=Math.atan2(e*h,Xt(a,h*n)),s=Kt(Math.tan(s));var r,o,l=Zt(this.gtu,2*i,2*s);return i+=l[0],s+=l[1],Math.abs(s)<=2.623395162778?(r=this.a*(this.Qn*s)+this.x0,o=this.a*(this.Qn*i+this.Zb)+this.y0):(r=1/0,o=1/0),t.x=r,t.y=o,t},inverse:function(t){var s,i,a=(t.x-this.x0)*(1/this.a),h=(t.y-this.y0)*(1/this.a);if(h=(h-this.Zb)/this.Qn,a/=this.Qn,Math.abs(a)<=2.623395162778){var e=Zt(this.utg,2*h,2*a);h+=e[0],a+=e[1],a=Math.atan(Ht(a));var n=Math.sin(h),r=Math.cos(h),o=Math.sin(a),l=Math.cos(a);h=Math.atan2(n*l,Xt(o,l*r)),a=Math.atan2(o,l*r),s=z(a+this.long0),i=Jt(this.cgb,h)}else s=1/0,i=1/0;return t.x=s,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},$t=function(t,s){if(void 0===t){if((t=Math.floor(30*(z(s)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t};var ts={init:function(){var t=$t(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*c,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Yt.init.apply(this),this.forward=Yt.forward,this.inverse=Yt.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},ss=function(t,s){return Math.pow((1-t)/(1+t),s)},is=20;var as={init:function(){var t=Math.sin(this.lat0),s=Math.cos(this.lat0);s*=s,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*s*s/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+f)/(Math.pow(Math.tan(.5*this.lat0+f),this.C)*ss(this.e*t,this.ratexp))},forward:function(t){var s=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+f),this.C)*ss(this.e*Math.sin(i),this.ratexp))-n,t.x=this.C*s,t},inverse:function(t){for(var s=t.x/this.C,i=t.y,a=Math.pow(Math.tan(.5*i+f)/this.K,1/this.C),h=is;h>0&&(i=2*Math.atan(a*ss(this.e*Math.sin(t.y),-.5*this.e))-n,!(Math.abs(i-t.y)<1e-14));--h)t.y=i;return h?(t.x=s,t.y=i,t):null},names:["gauss"]};var hs={init:function(){as.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var s,i,a,h;return t.x=z(t.x-this.long0),as.forward.apply(this,[t]),s=Math.sin(t.y),i=Math.cos(t.y),a=Math.cos(t.x),h=this.k0*this.R2/(1+this.sinc0*s+this.cosc0*i*a),t.x=h*i*Math.sin(t.x),t.y=h*(this.cosc0*s-this.sinc0*i*a),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var s,i,a,h,e;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,e=Xt(t.x,t.y)){var n=2*Math.atan2(e,this.R2);s=Math.sin(n),i=Math.cos(n),h=Math.asin(i*this.sinc0+t.y*s*this.cosc0/e),a=Math.atan2(t.x*s,e*this.cosc0*i-t.y*this.sinc0*s)}else h=this.phic0,a=0;return t.x=a,t.y=h,as.inverse.apply(this,[t]),t.x=z(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var es={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=u&&(this.k0=.5*(1+B(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=u&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=u&&Math.abs(Math.cos(this.lat_ts))>u&&(this.k0=.5*this.cons*j(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/F(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=j(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-n,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var s,i,a,h,e,r,o=t.x,l=t.y,c=Math.sin(l),M=Math.cos(l),f=z(o-this.long0);return Math.abs(Math.abs(o-this.long0)-Math.PI)<=u&&Math.abs(l+this.lat0)<=u?(t.x=NaN,t.y=NaN,t):this.sphere?(s=2*this.k0/(1+this.sinlat0*c+this.coslat0*M*Math.cos(f)),t.x=this.a*s*M*Math.sin(f)+this.x0,t.y=this.a*s*(this.coslat0*c-this.sinlat0*M*Math.cos(f))+this.y0,t):(i=2*Math.atan(this.ssfn_(l,c,this.e))-n,h=Math.cos(i),a=Math.sin(i),Math.abs(this.coslat0)<=u?(e=F(this.e,l*this.con,this.con*c),r=2*this.a*this.k0*e/this.cons,t.x=this.x0+r*Math.sin(o-this.long0),t.y=this.y0-this.con*r*Math.cos(o-this.long0),t):(Math.abs(this.sinlat0)<u?(s=2*this.a*this.k0/(1+h*Math.cos(f)),t.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*h*Math.cos(f))),t.y=s*(this.cosX0*a-this.sinX0*h*Math.cos(f))+this.y0),t.x=s*h*Math.sin(f)+this.x0,t))},inverse:function(t){var s,i,a,h,e;t.x-=this.x0,t.y-=this.y0;var r=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(r/(2*this.a*this.k0));return s=this.long0,i=this.lat0,r<=u?(t.x=s,t.y=i,t):(i=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/r),s=Math.abs(this.coslat0)<u?this.lat0>0?z(this.long0+Math.atan2(t.x,-1*t.y)):z(this.long0+Math.atan2(t.x,t.y)):z(this.long0+Math.atan2(t.x*Math.sin(o),r*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o))),t.x=s,t.y=i,t)}if(Math.abs(this.coslat0)<=u){if(r<=u)return i=this.lat0,s=this.long0,t.x=s,t.y=i,t;t.x*=this.con,t.y*=this.con,a=r*this.cons/(2*this.a*this.k0),i=this.con*D(this.e,a),s=this.con*z(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else h=2*Math.atan(r*this.cosX0/(2*this.a*this.k0*this.ms1)),s=this.long0,r<=u?e=this.X0:(e=Math.asin(Math.cos(h)*this.sinX0+t.y*Math.sin(h)*this.cosX0/r),s=z(this.long0+Math.atan2(t.x*Math.sin(h),r*this.cosX0*Math.cos(h)-t.y*this.sinX0*Math.sin(h)))),i=-1*D(this.e,Math.tan(.5*(n+e)));return t.x=s,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(t,s,i){return s*=i,Math.tan(.5*(n+t))*Math.pow((1-s)/(1+s),.5*i)}};var ns={init:function(){var t=this.lat0;this.lambda0=this.long0;var s=Math.sin(t),i=this.a,a=1/this.rf,h=2*a-Math.pow(a,2),e=this.e=Math.sqrt(h);this.R=this.k0*i*Math.sqrt(1-h)/(1-h*Math.pow(s,2)),this.alpha=Math.sqrt(1+h/(1-h)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(s/this.alpha);var n=Math.log(Math.tan(Math.PI/4+this.b0/2)),r=Math.log(Math.tan(Math.PI/4+t/2)),o=Math.log((1+e*s)/(1-e*s));this.K=n-this.alpha*r+this.alpha*e/2*o},forward:function(t){var s=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),a=-this.alpha*(s+i)+this.K,h=2*(Math.atan(Math.exp(a))-Math.PI/4),e=this.alpha*(t.x-this.lambda0),n=Math.atan(Math.sin(e)/(Math.sin(this.b0)*Math.tan(h)+Math.cos(this.b0)*Math.cos(e))),r=Math.asin(Math.cos(this.b0)*Math.sin(h)-Math.sin(this.b0)*Math.cos(h)*Math.cos(e));return t.y=this.R/2*Math.log((1+Math.sin(r))/(1-Math.sin(r)))+this.y0,t.x=this.R*n+this.x0,t},inverse:function(t){for(var s=t.x-this.x0,i=t.y-this.y0,a=s/this.R,h=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),e=Math.asin(Math.cos(this.b0)*Math.sin(h)+Math.sin(this.b0)*Math.cos(h)*Math.cos(a)),n=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(h))),r=this.lambda0+n/this.alpha,o=0,l=e,u=-1e3,c=0;Math.abs(l-u)>1e-7;){if(++c>20)return;o=1/this.alpha*(Math.log(Math.tan(Math.PI/4+e/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(o))-Math.PI/2}return t.x=r,t.y=l,t},names:["somerc"]},rs=1e-7;var os={init:function(){var t,s,i,a,h,e,r,o,l,M,p,m,_,y=0,x=0,g=0,v=0,b=0,w=0,N=0;this.no_off=(_="object"===_typeof((m=this).PROJECTION)?Object.keys(m.PROJECTION)[0]:m.PROJECTION,"no_uoff"in m||"no_off"in m||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(_)),this.no_rot="no_rot"in this;var E=!1;"alpha"in this&&(E=!0);var A=!1;if("rectified_grid_angle"in this&&(A=!0),E&&(N=this.alpha),A&&(y=this.rectified_grid_angle*c),E||A)x=this.longc;else if(g=this.long1,b=this.lat1,v=this.long2,w=this.lat2,Math.abs(b-w)<=rs||(t=Math.abs(b))<=rs||Math.abs(t-n)<=rs||Math.abs(Math.abs(this.lat0)-n)<=rs||Math.abs(Math.abs(w)-n)<=rs)throw new Error;var C=1-this.es;s=Math.sqrt(C),Math.abs(this.lat0)>u?(o=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*o*o,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/C),this.A=this.B*this.k0*s/t,(h=(a=this.B*s/(i*Math.sqrt(t)))*a-1)<=0?h=0:(h=Math.sqrt(h),this.lat0<0&&(h=-h)),this.E=h+=a,this.E*=Math.pow(F(this.e,this.lat0,o),this.B)):(this.B=1/s,this.A=this.k0,this.E=a=h=1),E||A?(E?(p=Math.asin(Math.sin(N)/a),A||(y=N)):(p=y,N=Math.asin(a*Math.sin(p))),this.lam0=x-Math.asin(.5*(h-1/h)*Math.tan(p))/this.B):(e=Math.pow(F(this.e,b,Math.sin(b)),this.B),r=Math.pow(F(this.e,w,Math.sin(w)),this.B),h=this.E/e,l=(r-e)/(r+e),M=((M=this.E*this.E)-r*e)/(M+r*e),(t=g-v)<-Math.pi?v-=d:t>Math.pi&&(v+=d),this.lam0=z(.5*(g+v)-Math.atan(M*Math.tan(.5*this.B*(g-v))/l)/this.B),p=Math.atan(2*Math.sin(this.B*z(g-this.lam0))/(h-1/h)),y=N=Math.asin(a*Math.sin(p))),this.singam=Math.sin(p),this.cosgam=Math.cos(p),this.sinrot=Math.sin(y),this.cosrot=Math.cos(y),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(a*a-1)/Math.cos(N))),this.lat0<0&&(this.u_0=-this.u_0)),h=.5*p,this.v_pole_n=this.ArB*Math.log(Math.tan(f-h)),this.v_pole_s=this.ArB*Math.log(Math.tan(f+h))},forward:function(t){var s,i,a,h,e,r,o,l,c={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-n)>u){if(s=.5*((e=this.E/Math.pow(F(this.e,t.y,Math.sin(t.y)),this.B))-(r=1/e)),i=.5*(e+r),h=Math.sin(this.B*t.x),a=(s*this.singam-h*this.cosgam)/i,Math.abs(Math.abs(a)-1)<u)throw new Error;l=.5*this.ArB*Math.log((1-a)/(1+a)),r=Math.cos(this.B*t.x),o=Math.abs(r)<rs?this.A*t.x:this.ArB*Math.atan2(s*this.cosgam+h*this.singam,r)}else l=t.y>0?this.v_pole_n:this.v_pole_s,o=this.ArB*t.y;return this.no_rot?(c.x=o,c.y=l):(o-=this.u_0,c.x=l*this.cosrot+o*this.sinrot,c.y=o*this.cosrot-l*this.sinrot),c.x=this.a*c.x+this.x0,c.y=this.a*c.y+this.y0,c},inverse:function(t){var s,i,a,h,e,r,o,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,s=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,s=t.y*this.cosrot+t.x*this.sinrot+this.u_0),h=.5*((a=Math.exp(-this.BrA*i))-1/a),e=.5*(a+1/a),o=((r=Math.sin(this.BrA*s))*this.cosgam+h*this.singam)/e,Math.abs(Math.abs(o)-1)<u)l.x=0,l.y=o<0?-n:n;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=D(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(h*this.cosgam-r*this.singam,Math.cos(this.BrA*s))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};var ls={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<u)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var s=Math.sin(this.lat1),i=Math.cos(this.lat1),a=j(this.e,s,i),h=F(this.e,this.lat1,s),e=Math.sin(this.lat2),n=Math.cos(this.lat2),r=j(this.e,e,n),o=F(this.e,this.lat2,e),l=F(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>u?this.ns=Math.log(a/r)/Math.log(h/o):this.ns=s,isNaN(this.ns)&&(this.ns=s),this.f0=a/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var s=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=u&&(i=B(i)*(n-2*u));var a,h,e=Math.abs(Math.abs(i)-n);if(e>u)a=F(this.e,i,Math.sin(i)),h=this.a*this.f0*Math.pow(a,this.ns);else{if((e=i*this.ns)<=0)return null;h=0}var r=this.ns*z(s-this.long0);return t.x=this.k0*(h*Math.sin(r))+this.x0,t.y=this.k0*(this.rh-h*Math.cos(r))+this.y0,t},inverse:function(t){var s,i,a,h,e,r=(t.x-this.x0)/this.k0,o=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(s=Math.sqrt(r*r+o*o),i=1):(s=-Math.sqrt(r*r+o*o),i=-1);var l=0;if(0!==s&&(l=Math.atan2(i*r,i*o)),0!==s||this.ns>0){if(i=1/this.ns,a=Math.pow(s/(this.a*this.f0),i),-9999===(h=D(this.e,a)))return null}else h=-n;return e=z(l/this.ns+this.long0),t.x=e,t.y=h,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};var us={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var s,i,a,h,e,n,r,o=t.x,l=t.y,u=z(o-this.long0);return s=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/s)-this.s45),a=-u*this.alfa,h=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(a)),e=Math.asin(Math.cos(i)*Math.sin(a)/Math.cos(h)),n=this.n*e,r=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(h/2+this.s45),this.n),t.y=r*Math.cos(n)/1,t.x=r*Math.sin(n)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var s,i,a,h,e,n,r,o=t.x;t.x=t.y,t.y=o,this.czech||(t.y*=-1,t.x*=-1),e=Math.sqrt(t.x*t.x+t.y*t.y),h=Math.atan2(t.y,t.x)/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/e,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),s=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(h)),i=Math.asin(Math.cos(a)*Math.sin(h)/Math.cos(s)),t.x=this.long0-i/this.alfa,n=s,r=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(s/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(n))/(1-this.e*Math.sin(n)),this.e/2))-this.s45),Math.abs(n-t.y)<1e-10&&(r=1),n=t.y,l+=1}while(0===r&&l<15);return l>=15?null:t},names:["Krovak","krovak"]},cs=function(t,s,i,a,h){return t*h-s*Math.sin(2*h)+i*Math.sin(4*h)-a*Math.sin(6*h)},Ms=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},fs=function(t){return.375*t*(1+.25*t*(1+.46875*t))},ds=function(t){return.05859375*t*t*(1+.75*t)},ps=function(t){return t*t*t*(35/3072)},ms=function(t,s,i){var a=s*i;return t/Math.sqrt(1-a*a)},_s=function(t){return Math.abs(t)<n?t:t-B(t)*Math.PI},ys=function(t,s,i,a,h){var e,n;e=t/s;for(var r=0;r<15;r++)if(e+=n=(t-(s*e-i*Math.sin(2*e)+a*Math.sin(4*e)-h*Math.sin(6*e)))/(s-2*i*Math.cos(2*e)+4*a*Math.cos(4*e)-6*h*Math.cos(6*e)),Math.abs(n)<=1e-10)return e;return NaN};var xs={init:function(){this.sphere||(this.e0=Ms(this.es),this.e1=fs(this.es),this.e2=ds(this.es),this.e3=ps(this.es),this.ml0=this.a*cs(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var s,i,a=t.x,h=t.y;if(a=z(a-this.long0),this.sphere)s=this.a*Math.asin(Math.cos(h)*Math.sin(a)),i=this.a*(Math.atan2(Math.tan(h),Math.cos(a))-this.lat0);else{var e=Math.sin(h),n=Math.cos(h),r=ms(this.a,this.e,e),o=Math.tan(h)*Math.tan(h),l=a*Math.cos(h),u=l*l,c=this.es*n*n/(1-this.es);s=r*l*(1-u*o*(1/6-(8-o+8*c)*u/120)),i=this.a*cs(this.e0,this.e1,this.e2,this.e3,h)-this.ml0+r*e/n*u*(.5+(5-o+6*c)*u/24)}return t.x=s+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var s,i,a=t.x/this.a,h=t.y/this.a;if(this.sphere){var e=h+this.lat0;s=Math.asin(Math.sin(e)*Math.cos(a)),i=Math.atan2(Math.tan(a),Math.cos(e))}else{var r=this.ml0/this.a+h,o=ys(r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-n)<=u)return t.x=this.long0,t.y=n,h<0&&(t.y*=-1),t;var l=ms(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),M=Math.pow(Math.tan(o),2),f=a*this.a/l,d=f*f;s=o-l*Math.tan(o)/c*f*f*(.5-(1+3*M)*f*f/24),i=f*(1-d*(M/3+(1+3*M)*M*d/15))/Math.cos(o)}return t.x=z(i+this.long0),t.y=_s(s),t},names:["Cassini","Cassini_Soldner","cass"]},gs=function(t,s){var i;return t>1e-7?(1-t*t)*(s/(1-(i=t*s)*i)-.5/t*Math.log((1-i)/(1+i))):2*s};var vs=.3333333333333333,bs=.17222222222222222,ws=.10257936507936508,Ns=.06388888888888888,Es=.0664021164021164,As=.016415012942191543;var Cs={init:function(){var t,s=Math.abs(this.lat0);if(Math.abs(s-n)<u?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(s)<u?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=gs(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var s,i=[];return i[0]=t*vs,s=t*t,i[0]+=s*bs,i[1]=s*Ns,s*=t,i[0]+=s*ws,i[1]+=s*Es,i[2]=s*As,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=gs(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var s,i,a,h,e,r,o,l,c,M,d=t.x,p=t.y;if(d=z(d-this.long0),this.sphere){if(e=Math.sin(p),M=Math.cos(p),a=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+M*a:1+this.sinph0*e+this.cosph0*M*a)<=u)return null;s=(i=Math.sqrt(2/i))*M*Math.sin(d),i*=this.mode===this.EQUIT?e:this.cosph0*e-this.sinph0*M*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(p+this.lat0)<u)return null;i=f-.5*p,s=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(d),i*=a}}else{switch(o=0,l=0,c=0,a=Math.cos(d),h=Math.sin(d),e=Math.sin(p),r=gs(this.e,e),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(o=r/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*a;break;case this.EQUIT:c=1+l*a;break;case this.N_POLE:c=n+p,r=this.qp-r;break;case this.S_POLE:c=p-n,r=this.qp+r}if(Math.abs(c)<u)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),i=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*o-this.sinb1*l*a):(c=Math.sqrt(2/(1+l*a)))*o*this.ymf,s=this.xmf*c*l*h;break;case this.N_POLE:case this.S_POLE:r>=0?(s=(c=Math.sqrt(r))*h,i=a*(this.mode===this.S_POLE?c:-c)):s=i=0}}return t.x=this.a*s+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var s,i,a,h,e,r,o,l,c,M,f=t.x/this.a,d=t.y/this.a;if(this.sphere){var p,m=0,_=0;if((i=.5*(p=Math.sqrt(f*f+d*d)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(_=Math.sin(i),m=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(p)<=u?0:Math.asin(d*_/p),f*=_,d=m*p;break;case this.OBLIQ:i=Math.abs(p)<=u?this.lat0:Math.asin(m*this.sinph0+d*_*this.cosph0/p),f*=_*this.cosph0,d=(m-Math.sin(i)*this.sinph0)*p;break;case this.N_POLE:d=-d,i=n-i;break;case this.S_POLE:i-=n}s=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(f,d):0}else{if(o=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(f/=this.dd,d*=this.dd,(r=Math.sqrt(f*f+d*d))<u)return t.x=this.long0,t.y=this.lat0,t;h=2*Math.asin(.5*r/this.rq),a=Math.cos(h),f*=h=Math.sin(h),this.mode===this.OBLIQ?(o=a*this.sinb1+d*h*this.cosb1/r,e=this.qp*o,d=r*this.cosb1*a-d*this.sinb1*h):(o=d*h/r,e=this.qp*o,d=r*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(e=f*f+d*d))return t.x=this.long0,t.y=this.lat0,t;o=1-e/this.qp,this.mode===this.S_POLE&&(o=-o)}s=Math.atan2(f,d),l=Math.asin(o),c=this.apa,M=l+l,i=l+c[0]*Math.sin(M)+c[1]*Math.sin(M+M)+c[2]*Math.sin(M+M+M)}return t.x=z(this.long0+s),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Ps=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)};var Ss={init:function(){Math.abs(this.lat1+this.lat2)<u||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=j(this.e3,this.sin_po,this.cos_po),this.qs1=gs(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=j(this.e3,this.sin_po,this.cos_po),this.qs2=gs(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=gs(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>u?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var s=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var a=gs(this.e3,this.sin_phi),h=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,e=this.ns0*z(s-this.long0),n=h*Math.sin(e)+this.x0,r=this.rh-h*Math.cos(e)+this.y0;return t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h,e,n;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(s=Math.sqrt(t.x*t.x+t.y*t.y),a=1):(s=-Math.sqrt(t.x*t.x+t.y*t.y),a=-1),h=0,0!==s&&(h=Math.atan2(a*t.x,a*t.y)),a=s*this.ns0/this.a,this.sphere?n=Math.asin((this.c-a*a)/(2*this.ns0)):(i=(this.c-a*a)/this.ns0,n=this.phi1z(this.e3,i)),e=z(h/this.ns0+this.long0),t.x=e,t.y=n,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,s){var i,a,h,e,n=Ps(.5*s);if(t<u)return n;for(var r=t*t,o=1;o<=25;o++)if(n+=e=.5*(h=1-(a=t*(i=Math.sin(n)))*a)*h/Math.cos(n)*(s/(1-r)-i/h+.5/t*Math.log((1-a)/(1+a))),Math.abs(e)<=1e-7)return n;return null}};var Is={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var s,i,a,h,e,n,r,o=t.x,l=t.y;return a=z(o-this.long0),s=Math.sin(l),i=Math.cos(l),h=Math.cos(a),(e=this.sin_p14*s+this.cos_p14*i*h)>0||Math.abs(e)<=u?(n=this.x0+1*this.a*i*Math.sin(a)/e,r=this.y0+1*this.a*(this.cos_p14*s-this.sin_p14*i*h)/e):(n=this.x0+this.infinity_dist*i*Math.sin(a),r=this.y0+this.infinity_dist*(this.cos_p14*s-this.sin_p14*i*h)),t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h,e,n;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(s=Math.sqrt(t.x*t.x+t.y*t.y))?(h=Math.atan2(s,this.rc),i=Math.sin(h),a=Math.cos(h),n=Ps(a*this.sin_p14+t.y*i*this.cos_p14/s),e=Math.atan2(t.x*i,s*this.cos_p14*a-t.y*this.sin_p14*i),e=z(this.long0+e)):(n=this.phic0,e=0),t.x=e,t.y=n,t},names:["gnom"]},Os=function(t,s){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(s)-i)<1e-6)return s<0?-1*n:n;for(var a,h,e,r,o=Math.asin(.5*s),l=0;l<30;l++)if(h=Math.sin(o),e=Math.cos(o),r=t*h,o+=a=Math.pow(1-r*r,2)/(2*e)*(s/(1-t*t)-h/(1-r*r)+.5/t*Math.log((1-r)/(1+r))),Math.abs(a)<=1e-10)return o;return NaN};var ks={init:function(){this.sphere||(this.k0=j(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var s,i,a=t.x,h=t.y,e=z(a-this.long0);if(this.sphere)s=this.x0+this.a*e*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(h)/Math.cos(this.lat_ts);else{var n=gs(this.e,Math.sin(h));s=this.x0+this.a*this.k0*e,i=this.y0+this.a*n*.5/this.k0}return t.x=s,t.y=i,t},inverse:function(t){var s,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(s=z(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=Os(this.e,2*t.y*this.k0/this.a),s=z(this.long0+t.x/(this.a*this.k0))),t.x=s,t.y=i,t},names:["cea"]};var qs={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var s=t.x,i=t.y,a=z(s-this.long0),h=_s(i-this.lat0);return t.x=this.x0+this.a*a*this.rc,t.y=this.y0+this.a*h,t},inverse:function(t){var s=t.x,i=t.y;return t.x=z(this.long0+(s-this.x0)/(this.a*this.rc)),t.y=_s(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Rs=20;var Ls={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ms(this.es),this.e1=fs(this.es),this.e2=ds(this.es),this.e3=ps(this.es),this.ml0=this.a*cs(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var s,i,a,h=t.x,e=t.y,n=z(h-this.long0);if(a=n*Math.sin(e),this.sphere)Math.abs(e)<=u?(s=this.a*n,i=-1*this.a*this.lat0):(s=this.a*Math.sin(a)/Math.tan(e),i=this.a*(_s(e-this.lat0)+(1-Math.cos(a))/Math.tan(e)));else if(Math.abs(e)<=u)s=this.a*n,i=-1*this.ml0;else{var r=ms(this.a,this.e,Math.sin(e))/Math.tan(e);s=r*Math.sin(a),i=this.a*cs(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+r*(1-Math.cos(a))}return t.x=s+this.x0,t.y=i+this.y0,t},inverse:function(t){var s,i,a,h,e,n,r,o,l;if(a=t.x-this.x0,h=t.y-this.y0,this.sphere)if(Math.abs(h+this.a*this.lat0)<=u)s=z(a/this.a+this.long0),i=0;else{var c;for(n=this.lat0+h/this.a,r=a*a/this.a/this.a+n*n,o=n,e=Rs;e;--e)if(o+=l=-1*(n*(o*(c=Math.tan(o))+1)-o-.5*(o*o+r)*c)/((o-n)/c-1),Math.abs(l)<=u){i=o;break}s=z(this.long0+Math.asin(a*Math.tan(o)/this.a)/Math.sin(i))}else if(Math.abs(h+this.ml0)<=u)i=0,s=z(this.long0+a/this.a);else{var M,f,d,p,m;for(n=(this.ml0+h)/this.a,r=a*a/this.a/this.a+n*n,o=n,e=Rs;e;--e)if(m=this.e*Math.sin(o),M=Math.sqrt(1-m*m)*Math.tan(o),f=this.a*cs(this.e0,this.e1,this.e2,this.e3,o),d=this.e0-2*this.e1*Math.cos(2*o)+4*this.e2*Math.cos(4*o)-6*this.e3*Math.cos(6*o),o-=l=(n*(M*(p=f/this.a)+1)-p-.5*M*(p*p+r))/(this.es*Math.sin(2*o)*(p*p+r-2*n*p)/(4*M)+(n-p)*(M*d-2/Math.sin(2*o))-d),Math.abs(l)<=u){i=o;break}M=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),s=z(this.long0+Math.asin(a*M/this.a)/Math.sin(i))}return t.x=s,t.y=i,t},names:["Polyconic","poly"]};var Gs={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var s,i=t.x,a=t.y-this.lat0,h=i-this.long0,n=a/e*1e-5,r=h,o=1,l=0;for(s=1;s<=10;s++)o*=n,l+=this.A[s]*o;var u,c=l,M=r,f=1,d=0,p=0,m=0;for(s=1;s<=6;s++)u=d*c+f*M,f=f*c-d*M,d=u,p=p+this.B_re[s]*f-this.B_im[s]*d,m=m+this.B_im[s]*f+this.B_re[s]*d;return t.x=m*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var s,i,a=t.x,h=t.y,n=a-this.x0,r=(h-this.y0)/this.a,o=n/this.a,l=1,u=0,c=0,M=0;for(s=1;s<=6;s++)i=u*r+l*o,l=l*r-u*o,u=i,c=c+this.C_re[s]*l-this.C_im[s]*u,M=M+this.C_im[s]*l+this.C_re[s]*u;for(var f=0;f<this.iterations;f++){var d,p=c,m=M,_=r,y=o;for(s=2;s<=6;s++)d=m*c+p*M,p=p*c-m*M,m=d,_+=(s-1)*(this.B_re[s]*p-this.B_im[s]*m),y+=(s-1)*(this.B_im[s]*p+this.B_re[s]*m);p=1,m=0;var x=this.B_re[1],g=this.B_im[1];for(s=2;s<=6;s++)d=m*c+p*M,p=p*c-m*M,m=d,x+=s*(this.B_re[s]*p-this.B_im[s]*m),g+=s*(this.B_im[s]*p+this.B_re[s]*m);var v=x*x+g*g;c=(_*x+y*g)/v,M=(y*x-_*g)/v}var b=c,w=M,N=1,E=0;for(s=1;s<=9;s++)N*=b,E+=this.D[s]*N;var A=this.lat0+E*e*1e5,C=this.long0+w;return t.x=C,t.y=A,t},names:["New_Zealand_Map_Grid","nzmg"]};var Ts={init:function(){},forward:function(t){var s=t.x,i=t.y,a=z(s-this.long0),h=this.x0+this.a*a,e=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=h,t.y=e,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var s=z(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=s,t.y=i,t},names:["Miller_Cylindrical","mill"]},js=20;var Bs={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Dt(this.es)},forward:function(t){var s,i,a=t.x,h=t.y;if(a=z(a-this.long0),this.sphere){if(this.m)for(var e=this.n*Math.sin(h),n=js;n;--n){var r=(this.m*h+Math.sin(h)-e)/(this.m+Math.cos(h));if(h-=r,Math.abs(r)<u)break}else h=1!==this.n?Math.asin(this.n*Math.sin(h)):h;s=this.a*this.C_x*a*(this.m+Math.cos(h)),i=this.a*this.C_y*h}else{var o=Math.sin(h),l=Math.cos(h);i=this.a*Ut(h,o,l,this.en),s=this.a*a*l/Math.sqrt(1-this.es*o*o)}return t.x=s,t.y=i,t},inverse:function(t){var s,i,a,h;return t.x-=this.x0,a=t.x/this.a,t.y-=this.y0,s=t.y/this.a,this.sphere?(s/=this.C_y,a/=this.C_x*(this.m+Math.cos(s)),this.m?s=Ps((this.m*s+Math.sin(s))/this.n):1!==this.n&&(s=Ps(Math.sin(s)/this.n)),a=z(a+this.long0),s=_s(s)):(s=Qt(t.y/this.a,this.es,this.en),(h=Math.abs(s))<n?(h=Math.sin(s),i=this.long0+t.x*Math.sqrt(1-this.es*h*h)/(this.a*Math.cos(s)),a=z(i)):h-u<n&&(a=this.long0)),t.x=a,t.y=s,t},names:["Sinusoidal","sinu"]};var zs={init:function(){},forward:function(t){for(var s=t.x,i=t.y,a=z(s-this.long0),h=i,e=Math.PI*Math.sin(i);;){var n=-(h+Math.sin(h)-e)/(1+Math.cos(h));if(h+=n,Math.abs(n)<u)break}h/=2,Math.PI/2-Math.abs(i)<u&&(a=0);var r=.900316316158*this.a*a*Math.cos(h)+this.x0,o=1.4142135623731*this.a*Math.sin(h)+this.y0;return t.x=r,t.y=o,t},inverse:function(t){var s,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),s=Math.asin(i);var a=z(this.long0+t.x/(.900316316158*this.a*Math.cos(s)));a<-Math.PI&&(a=-Math.PI),a>Math.PI&&(a=Math.PI),i=(2*s+Math.sin(2*s))/Math.PI,Math.abs(i)>1&&(i=1);var h=Math.asin(i);return t.x=a,t.y=h,t},names:["Mollweide","moll"]};var Fs={init:function(){Math.abs(this.lat1+this.lat2)<u||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ms(this.es),this.e1=fs(this.es),this.e2=ds(this.es),this.e3=ps(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=j(this.e,this.sinphi,this.cosphi),this.ml1=cs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<u?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=j(this.e,this.sinphi,this.cosphi),this.ml2=cs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=cs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var s,i=t.x,a=t.y;if(this.sphere)s=this.a*(this.g-a);else{var h=cs(this.e0,this.e1,this.e2,this.e3,a);s=this.a*(this.g-h)}var e=this.ns*z(i-this.long0),n=this.x0+s*Math.sin(e),r=this.y0+this.rh-s*Math.cos(e);return t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),s=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),s=-1);var e=0;if(0!==i&&(e=Math.atan2(s*t.x,s*t.y)),this.sphere)return h=z(this.long0+e/this.ns),a=_s(this.g-i/this.a),t.x=h,t.y=a,t;var n=this.g-i/this.a;return a=ys(n,this.e0,this.e1,this.e2,this.e3),h=z(this.long0+e/this.ns),t.x=h,t.y=a,t},names:["Equidistant_Conic","eqdc"]};var Ds={init:function(){this.R=this.a},forward:function(t){var s,i,a=t.x,h=t.y,e=z(a-this.long0);Math.abs(h)<=u&&(s=this.x0+this.R*e,i=this.y0);var r=Ps(2*Math.abs(h/Math.PI));(Math.abs(e)<=u||Math.abs(Math.abs(h)-n)<=u)&&(s=this.x0,i=h>=0?this.y0+Math.PI*this.R*Math.tan(.5*r):this.y0+Math.PI*this.R*-Math.tan(.5*r));var o=.5*Math.abs(Math.PI/e-e/Math.PI),l=o*o,c=Math.sin(r),M=Math.cos(r),f=M/(c+M-1),d=f*f,p=f*(2/c-1),m=p*p,_=Math.PI*this.R*(o*(f-m)+Math.sqrt(l*(f-m)*(f-m)-(m+l)*(d-m)))/(m+l);e<0&&(_=-_),s=this.x0+_;var y=l+f;return _=Math.PI*this.R*(p*y-o*Math.sqrt((m+l)*(l+1)-y*y))/(m+l),i=h>=0?this.y0+_:this.y0-_,t.x=s,t.y=i,t},inverse:function(t){var s,i,a,h,e,n,r,o,l,c,M,f;return t.x-=this.x0,t.y-=this.y0,M=Math.PI*this.R,e=(a=t.x/M)*a+(h=t.y/M)*h,M=3*(h*h/(o=-2*(n=-Math.abs(h)*(1+e))+1+2*h*h+e*e)+(2*(r=n-2*h*h+a*a)*r*r/o/o/o-9*n*r/o/o)/27)/(l=(n-r*r/3/o)/o)/(c=2*Math.sqrt(-l/3)),Math.abs(M)>1&&(M=M>=0?1:-1),f=Math.acos(M)/3,i=t.y>=0?(-c*Math.cos(f+Math.PI/3)-r/3/o)*Math.PI:-(-c*Math.cos(f+Math.PI/3)-r/3/o)*Math.PI,s=Math.abs(a)<u?this.long0:z(this.long0+Math.PI*(e-1+Math.sqrt(1+2*(a*a-h*h)+e*e))/2/a),t.x=s,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var Us={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var s,i,a,h,e,r,o,l,c,M,f,d,p,m,_,y,x,g,v,b,w,N,E=t.x,A=t.y,C=Math.sin(t.y),P=Math.cos(t.y),S=z(E-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=u?(t.x=this.x0+this.a*(n-A)*Math.sin(S),t.y=this.y0-this.a*(n-A)*Math.cos(S),t):Math.abs(this.sin_p12+1)<=u?(t.x=this.x0+this.a*(n+A)*Math.sin(S),t.y=this.y0+this.a*(n+A)*Math.cos(S),t):(g=this.sin_p12*C+this.cos_p12*P*Math.cos(S),x=(y=Math.acos(g))?y/Math.sin(y):1,t.x=this.x0+this.a*x*P*Math.sin(S),t.y=this.y0+this.a*x*(this.cos_p12*C-this.sin_p12*P*Math.cos(S)),t):(s=Ms(this.es),i=fs(this.es),a=ds(this.es),h=ps(this.es),Math.abs(this.sin_p12-1)<=u?(e=this.a*cs(s,i,a,h,n),r=this.a*cs(s,i,a,h,A),t.x=this.x0+(e-r)*Math.sin(S),t.y=this.y0-(e-r)*Math.cos(S),t):Math.abs(this.sin_p12+1)<=u?(e=this.a*cs(s,i,a,h,n),r=this.a*cs(s,i,a,h,A),t.x=this.x0+(e+r)*Math.sin(S),t.y=this.y0+(e+r)*Math.cos(S),t):(o=C/P,l=ms(this.a,this.e,this.sin_p12),c=ms(this.a,this.e,C),M=Math.atan((1-this.es)*o+this.es*l*this.sin_p12/(c*P)),v=0===(f=Math.atan2(Math.sin(S),this.cos_p12*Math.tan(M)-this.sin_p12*Math.cos(S)))?Math.asin(this.cos_p12*Math.sin(M)-this.sin_p12*Math.cos(M)):Math.abs(Math.abs(f)-Math.PI)<=u?-Math.asin(this.cos_p12*Math.sin(M)-this.sin_p12*Math.cos(M)):Math.asin(Math.sin(S)*Math.cos(M)/Math.sin(f)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),y=l*v*(1-(b=v*v)*(_=(p=this.e*this.cos_p12*Math.cos(f)/Math.sqrt(1-this.es))*p)*(1-_)/6+(w=b*v)/8*(m=d*p)*(1-2*_)+(N=w*v)/120*(_*(4-7*_)-3*d*d*(1-7*_))-N*v/48*m),t.x=this.x0+y*Math.sin(f),t.y=this.y0+y*Math.cos(f),t))},inverse:function(t){var s,i,a,h,e,r,o,l,c,M,f,d,p,m,_,y,x,g,v,b,w,N,E;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((s=Math.sqrt(t.x*t.x+t.y*t.y))>2*n*this.a)return;return i=s/this.a,a=Math.sin(i),h=Math.cos(i),e=this.long0,Math.abs(s)<=u?r=this.lat0:(r=Ps(h*this.sin_p12+t.y*a*this.cos_p12/s),o=Math.abs(this.lat0)-n,e=Math.abs(o)<=u?this.lat0>=0?z(this.long0+Math.atan2(t.x,-t.y)):z(this.long0-Math.atan2(-t.x,t.y)):z(this.long0+Math.atan2(t.x*a,s*this.cos_p12*h-t.y*this.sin_p12*a))),t.x=e,t.y=r,t}return l=Ms(this.es),c=fs(this.es),M=ds(this.es),f=ps(this.es),Math.abs(this.sin_p12-1)<=u?(d=this.a*cs(l,c,M,f,n),s=Math.sqrt(t.x*t.x+t.y*t.y),r=ys((d-s)/this.a,l,c,M,f),e=z(this.long0+Math.atan2(t.x,-1*t.y)),t.x=e,t.y=r,t):Math.abs(this.sin_p12+1)<=u?(d=this.a*cs(l,c,M,f,n),s=Math.sqrt(t.x*t.x+t.y*t.y),r=ys((s-d)/this.a,l,c,M,f),e=z(this.long0+Math.atan2(t.x,t.y)),t.x=e,t.y=r,t):(s=Math.sqrt(t.x*t.x+t.y*t.y),_=Math.atan2(t.x,t.y),p=ms(this.a,this.e,this.sin_p12),y=Math.cos(_),g=-(x=this.e*this.cos_p12*y)*x/(1-this.es),v=3*this.es*(1-g)*this.sin_p12*this.cos_p12*y/(1-this.es),N=1-g*(w=(b=s/p)-g*(1+g)*Math.pow(b,3)/6-v*(1+3*g)*Math.pow(b,4)/24)*w/2-b*w*w*w/6,m=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*y),e=z(this.long0+Math.asin(Math.sin(_)*Math.sin(w)/Math.cos(m))),E=Math.sin(m),r=Math.atan2((E-this.es*N*this.sin_p12)*Math.tan(m),E*(1-this.es)),t.x=e,t.y=r,t)},names:["Azimuthal_Equidistant","aeqd"]};var Qs={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var s,i,a,h,e,n,r,o=t.x,l=t.y;return a=z(o-this.long0),s=Math.sin(l),i=Math.cos(l),h=Math.cos(a),((e=this.sin_p14*s+this.cos_p14*i*h)>0||Math.abs(e)<=u)&&(n=1*this.a*i*Math.sin(a),r=this.y0+1*this.a*(this.cos_p14*s-this.sin_p14*i*h)),t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h,e,r,o;return t.x-=this.x0,t.y-=this.y0,s=Math.sqrt(t.x*t.x+t.y*t.y),i=Ps(s/this.a),a=Math.sin(i),h=Math.cos(i),r=this.long0,Math.abs(s)<=u?(o=this.lat0,t.x=r,t.y=o,t):(o=Ps(h*this.sin_p14+t.y*a*this.cos_p14/s),e=Math.abs(this.lat0)-n,Math.abs(e)<=u?(r=this.lat0>=0?z(this.long0+Math.atan2(t.x,-t.y)):z(this.long0-Math.atan2(-t.x,t.y)),t.x=r,t.y=o,t):(r=z(this.long0+Math.atan2(t.x*a,s*this.cos_p14*h-t.y*this.sin_p14*a)),t.x=r,t.y=o,t))},names:["ortho"]},Ws={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Hs={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Xs(t,s,i,a){var h;return t<u?(a.value=Hs.AREA_0,h=0):(h=Math.atan2(s,i),Math.abs(h)<=f?a.value=Hs.AREA_0:h>f&&h<=n+f?(a.value=Hs.AREA_1,h-=n):h>n+f||h<=-(n+f)?(a.value=Hs.AREA_2,h=h>=0?h-p:h+p):(a.value=Hs.AREA_3,h+=n)),h}function Ks(t,s){var i=t+s;return i<-p?i+=d:i>+p&&(i-=d),i}var Js={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=n-f/2?this.face=Ws.TOP:this.lat0<=-(n-f/2)?this.face=Ws.BOTTOM:Math.abs(this.long0)<=f?this.face=Ws.FRONT:Math.abs(this.long0)<=n+f?this.face=this.long0>0?Ws.RIGHT:Ws.LEFT:this.face=Ws.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var s,i,a,h,e,r,o={x:0,y:0},l={value:0};if(t.x-=this.long0,s=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,this.face===Ws.TOP)h=n-s,i>=f&&i<=n+f?(l.value=Hs.AREA_0,a=i-n):i>n+f||i<=-(n+f)?(l.value=Hs.AREA_1,a=i>0?i-p:i+p):i>-(n+f)&&i<=-f?(l.value=Hs.AREA_2,a=i+n):(l.value=Hs.AREA_3,a=i);else if(this.face===Ws.BOTTOM)h=n+s,i>=f&&i<=n+f?(l.value=Hs.AREA_0,a=-i+n):i<f&&i>=-f?(l.value=Hs.AREA_1,a=-i):i<-f&&i>=-(n+f)?(l.value=Hs.AREA_2,a=-i-n):(l.value=Hs.AREA_3,a=i>0?-i+p:-i-p);else{var u,c,M,d,m,_;this.face===Ws.RIGHT?i=Ks(i,+n):this.face===Ws.BACK?i=Ks(i,+p):this.face===Ws.LEFT&&(i=Ks(i,-n)),d=Math.sin(s),m=Math.cos(s),_=Math.sin(i),u=m*Math.cos(i),c=m*_,M=d,this.face===Ws.FRONT?a=Xs(h=Math.acos(u),M,c,l):this.face===Ws.RIGHT?a=Xs(h=Math.acos(c),M,-u,l):this.face===Ws.BACK?a=Xs(h=Math.acos(-u),M,-c,l):this.face===Ws.LEFT?a=Xs(h=Math.acos(-c),M,u,l):(h=a=0,l.value=Hs.AREA_0)}return r=Math.atan(12/p*(a+Math.acos(Math.sin(a)*Math.cos(f))-n)),e=Math.sqrt((1-Math.cos(h))/(Math.cos(r)*Math.cos(r))/(1-Math.cos(Math.atan(1/Math.cos(a))))),l.value===Hs.AREA_1?r+=n:l.value===Hs.AREA_2?r+=p:l.value===Hs.AREA_3&&(r+=1.5*p),o.x=e*Math.cos(r),o.y=e*Math.sin(r),o.x=o.x*this.a+this.x0,o.y=o.y*this.a+this.y0,t.x=o.x,t.y=o.y,t},inverse:function(t){var s,i,a,h,e,r,o,l,u,c,M,f,d={lam:0,phi:0},m={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),s=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?m.value=Hs.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(m.value=Hs.AREA_1,s-=n):t.x<0&&-t.x>=Math.abs(t.y)?(m.value=Hs.AREA_2,s=s<0?s+p:s-p):(m.value=Hs.AREA_3,s+=n),u=p/12*Math.tan(s),e=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),r=Math.atan(e),(o=1-(a=Math.cos(s))*a*(h=Math.tan(i))*h*(1-Math.cos(Math.atan(1/Math.cos(r)))))<-1?o=-1:o>1&&(o=1),this.face===Ws.TOP)l=Math.acos(o),d.phi=n-l,m.value===Hs.AREA_0?d.lam=r+n:m.value===Hs.AREA_1?d.lam=r<0?r+p:r-p:m.value===Hs.AREA_2?d.lam=r-n:d.lam=r;else if(this.face===Ws.BOTTOM)l=Math.acos(o),d.phi=l-n,m.value===Hs.AREA_0?d.lam=-r+n:m.value===Hs.AREA_1?d.lam=-r:m.value===Hs.AREA_2?d.lam=-r-n:d.lam=r<0?-r-p:-r+p;else{var _,y,x;u=(_=o)*_,y=(u+=(x=u>=1?0:Math.sqrt(1-u)*Math.sin(r))*x)>=1?0:Math.sqrt(1-u),m.value===Hs.AREA_1?(u=y,y=-x,x=u):m.value===Hs.AREA_2?(y=-y,x=-x):m.value===Hs.AREA_3&&(u=y,y=x,x=-u),this.face===Ws.RIGHT?(u=_,_=-y,y=u):this.face===Ws.BACK?(_=-_,y=-y):this.face===Ws.LEFT&&(u=_,_=y,y=-u),d.phi=Math.acos(-x)-n,d.lam=Math.atan2(y,_),this.face===Ws.RIGHT?d.lam=Ks(d.lam,-n):this.face===Ws.BACK?d.lam=Ks(d.lam,-p):this.face===Ws.LEFT&&(d.lam=Ks(d.lam,+n))}return 0!==this.es&&(c=d.phi<0?1:0,M=Math.tan(d.phi),f=this.b/Math.sqrt(M*M+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-f*f)/(this.one_minus_f*f)),c&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Vs=[[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Zs=[[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ys=.8487,$s=1.3523,ti=M/5,si=1/ti,ii=18,ai=function(t,s){return t[0]+s*(t[1]+s*(t[2]+s*t[3]))},hi=function(t,s){return t[1]+s*(2*t[2]+3*s*t[3])};var ei={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var s=z(t.x-this.long0),i=Math.abs(t.y),a=Math.floor(i*ti);a<0?a=0:a>=ii&&(a=ii-1),i=M*(i-si*a);var h={x:ai(Vs[a],i)*s,y:ai(Zs[a],i)};return t.y<0&&(h.y=-h.y),h.x=h.x*this.a*Ys+this.x0,h.y=h.y*this.a*$s+this.y0,h},inverse:function(t){var s={x:(t.x-this.x0)/(this.a*Ys),y:Math.abs(t.y-this.y0)/(this.a*$s)};if(s.y>=1)s.x/=Vs[ii][0],s.y=t.y<0?-n:n;else{var i=Math.floor(s.y*ii);for(i<0?i=0:i>=ii&&(i=ii-1);;)if(Zs[i][0]>s.y)--i;else{if(!(Zs[i+1][0]<=s.y))break;++i}var a=Zs[i],h=5*(s.y-a[0])/(Zs[i+1][0]-a[0]);h=function(t,s,i,a){for(var h=s;a;--a){var e=t(h);if(h-=e,Math.abs(e)<i)break}return h}(function(t){return(ai(a,t)-s.y)/hi(a,t)},h,u,100),s.x/=ai(Vs[i],h),s.y=(5*i+h)*c,t.y<0&&(s.y=-s.y)}return s.x=z(s.x+this.long0),s},names:["Robinson","robin"]};var ni={init:function(){this.name="geocent"},forward:function(t){return nt(t,this.es,this.a)},inverse:function(t){return rt(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},ri={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},oi={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};var li={init:function(){if(Object.keys(oi).forEach(function(t){if(void 0===this[t])this[t]=oi[t].def;else{if(oi[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);oi[t].num&&(this[t]=parseFloat(this[t]))}oi[t].degrees&&(this[t]=this[t]*c)}.bind(this)),Math.abs(Math.abs(this.lat0)-n)<u?this.mode=this.lat0<0?ri.S_POLE:ri.N_POLE:Math.abs(this.lat0)<u?this.mode=ri.EQUIT:(this.mode=ri.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,s=this.azi;this.cg=Math.cos(s),this.sg=Math.sin(s),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var s,i,a,h,e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x);switch(this.mode){case ri.OBLIQ:i=this.sinph0*e+this.cosph0*n*r;break;case ri.EQUIT:i=n*r;break;case ri.S_POLE:i=-e;break;case ri.N_POLE:i=e}switch(s=(i=this.pn1/(this.p-i))*n*Math.sin(t.x),this.mode){case ri.OBLIQ:i*=this.cosph0*e-this.sinph0*n*r;break;case ri.EQUIT:i*=e;break;case ri.N_POLE:i*=-n*r;break;case ri.S_POLE:i*=n*r}return h=1/((a=i*this.cg+s*this.sg)*this.sw*this.h1+this.cw),s=(s*this.cg-i*this.sg)*this.cw*h,i=a*h,t.x=s*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var s,i,a,h={x:t.x,y:t.y};a=1/(this.pn1-t.y*this.sw),s=this.pn1*t.x*a,i=this.pn1*t.y*this.cw*a,t.x=s*this.cg+i*this.sg,t.y=i*this.cg-s*this.sg;var e=Xt(t.x,t.y);if(Math.abs(e)<u)h.x=0,h.y=t.y;else{var n,r;switch(r=1-e*e*this.pfact,r=(this.p-Math.sqrt(r))/(this.pn1/e+e/this.pn1),n=Math.sqrt(1-r*r),this.mode){case ri.OBLIQ:h.y=Math.asin(n*this.sinph0+t.y*r*this.cosph0/e),t.y=(n-this.sinph0*Math.sin(h.y))*e,t.x*=r*this.cosph0;break;case ri.EQUIT:h.y=Math.asin(t.y*r/e),t.y=n*e,t.x*=r;break;case ri.N_POLE:h.y=Math.asin(n),t.y=-t.y;break;case ri.S_POLE:h.y=-Math.asin(n)}h.x=Math.atan2(t.x,t.y)}return t.x=h.x+this.long0,t.y=h.y,t},names:["Tilted_Perspective","tpers"]};var ui={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,s=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=s,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var s,i,a,h,e=t.x,n=t.y;if(e-=this.long0,"ellipse"===this.shape){n=Math.atan(this.radius_p2*Math.tan(n));var r=this.radius_p/Xt(this.radius_p*Math.cos(n),Math.sin(n));if(i=r*Math.cos(e)*Math.cos(n),a=r*Math.sin(e)*Math.cos(n),h=r*Math.sin(n),(this.radius_g-i)*i-a*a-h*h*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(a/Xt(h,s)),t.y=this.radius_g_1*Math.atan(h/s)):(t.x=this.radius_g_1*Math.atan(a/s),t.y=this.radius_g_1*Math.atan(h/Xt(a,s)))}else"sphere"===this.shape&&(s=Math.cos(n),i=Math.cos(e)*s,a=Math.sin(e)*s,h=Math.sin(n),s=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(a/Xt(h,s)),t.y=this.radius_g_1*Math.atan(h/s)):(t.x=this.radius_g_1*Math.atan(a/s),t.y=this.radius_g_1*Math.atan(h/Xt(a,s))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var s,i,a,h,e=-1,n=0,r=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Xt(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Xt(1,n));var o=r/this.radius_p;if(s=n*n+o*o+e*e,(a=(i=2*this.radius_g*e)*i-4*s*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;h=(-i-Math.sqrt(a))/(2*s),e=this.radius_g+h*e,n*=h,r*=h,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),s=n*n+r*r+e*e,(a=(i=2*this.radius_g*e)*i-4*s*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;h=(-i-Math.sqrt(a))/(2*s),e=this.radius_g+h*e,n*=h,r*=h,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]},ci=1.340264,Mi=-.081106,fi=893e-6,di=.003796,pi=Math.sqrt(3)/2;var mi,_i={init:function(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function(t){var s=z(t.x-this.long0),i=t.y,a=Math.asin(pi*Math.sin(i)),h=a*a,e=h*h*h;return t.x=s*Math.cos(a)/(pi*(ci+3*Mi*h+e*(7*fi+9*di*h))),t.y=a*(ci+Mi*h+e*(fi+di*h)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var s,i,a,h,e=t.y;for(h=0;h<12&&(e-=a=(e*(ci+Mi*(s=e*e)+(i=s*s*s)*(fi+di*s))-t.y)/(ci+3*Mi*s+i*(7*fi+9*di*s)),!(Math.abs(a)<1e-9));++h);return i=(s=e*e)*s*s,t.x=pi*t.x*(ci+3*Mi*s+i*(7*fi+9*di*s))/Math.cos(e),t.y=Math.asin(Math.sin(e)/pi),t.x=z(t.x+this.long0),t},names:["eqearth","Equal Earth","Equal_Earth"]};return vt.defaultDatum="WGS84",vt.Proj=et,vt.WGS84=new vt.Proj("WGS84"),vt.Point=zt,vt.toPoint=dt,vt.defs=q,vt.nadgrid=function(t,s){var i=new DataView(s),a=function(t){var s=t.getInt32(8,!1);return 11!==s&&(11!==(s=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),h=function(t,s){return{nFields:t.getInt32(8,s),nSubgridFields:t.getInt32(24,s),nSubgrids:t.getInt32(40,s),shiftType:st(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,s),fromSemiMinorAxis:t.getFloat64(136,s),toSemiMajorAxis:t.getFloat64(152,s),toSemiMinorAxis:t.getFloat64(168,s)}}(i,a),e={header:h,subgrids:function(t,s,i){for(var a=176,h=[],e=0;e<s.nSubgrids;e++){var n=at(t,a,i),r=ht(t,a,n,i),o=Math.round(1+(n.upperLongitude-n.lowerLongitude)/n.longitudeInterval),l=Math.round(1+(n.upperLatitude-n.lowerLatitude)/n.latitudeInterval);h.push({ll:[tt(n.lowerLongitude),tt(n.lowerLatitude)],del:[tt(n.longitudeInterval),tt(n.latitudeInterval)],lim:[o,l],count:n.gridNodeCount,cvs:it(r)}),a+=176+16*n.gridNodeCount}return h}(i,h,a)};return Y[t]=e,e},vt.transform=_t,vt.mgrs=It,vt.version="2.11.0",(mi=vt).Proj.projections.add(Wt),mi.Proj.projections.add(Yt),mi.Proj.projections.add(ts),mi.Proj.projections.add(hs),mi.Proj.projections.add(es),mi.Proj.projections.add(ns),mi.Proj.projections.add(os),mi.Proj.projections.add(ls),mi.Proj.projections.add(us),mi.Proj.projections.add(xs),mi.Proj.projections.add(Cs),mi.Proj.projections.add(Ss),mi.Proj.projections.add(Is),mi.Proj.projections.add(ks),mi.Proj.projections.add(qs),mi.Proj.projections.add(Ls),mi.Proj.projections.add(Gs),mi.Proj.projections.add(Ts),mi.Proj.projections.add(Bs),mi.Proj.projections.add(zs),mi.Proj.projections.add(Fs),mi.Proj.projections.add(Ds),mi.Proj.projections.add(Us),mi.Proj.projections.add(Qs),mi.Proj.projections.add(Js),mi.Proj.projections.add(ei),mi.Proj.projections.add(ni),mi.Proj.projections.add(li),mi.Proj.projections.add(ui),mi.Proj.projections.add(_i),vt});

},{}],422:[function(require,module,exports){
(function (global){(function (){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){var o="object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,n="object"==("undefined"==typeof module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,t="object"==("undefined"==typeof global?"undefined":_typeof(global))&&global;t.global!==t&&t.window!==t&&t.self!==t||(e=t);var r,f,u=2147483647,i=36,l=1,c=26,d=38,p=700,s=72,a=128,y="-",h=/^xn--/,v=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=i-l,w=Math.floor,x=String.fromCharCode;function C(e){throw new RangeError(g[e])}function j(e,o){for(var n=e.length,t=[];n--;)t[n]=o(e[n]);return t}function S(e,o){var n=e.split("@"),t="";return n.length>1&&(t=n[0]+"@",e=n[1]),t+j((e=e.replace(b,".")).split("."),o).join(".")}function A(e){for(var o,n,t=[],r=0,f=e.length;r<f;)(o=e.charCodeAt(r++))>=55296&&o<=56319&&r<f?56320==(64512&(n=e.charCodeAt(r++)))?t.push(((1023&o)<<10)+(1023&n)+65536):(t.push(o),r--):t.push(o);return t}function _(e){return j(e,function(e){var o="";return e>65535&&(o+=x((e-=65536)>>>10&1023|55296),e=56320|1023&e),o+=x(e)}).join("")}function I(e,o){return e+22+75*(e<26)-((0!=o)<<5)}function E(e,o,n){var t=0;for(e=n?w(e/p):e>>1,e+=w(e/o);e>m*c>>1;t+=i)e=w(e/m);return w(t+(m+1)*e/(e+d))}function F(e){var o,n,t,r,f,d,p,h,v,b,g,m=[],x=e.length,j=0,S=a,A=s;for((n=e.lastIndexOf(y))<0&&(n=0),t=0;t<n;++t)e.charCodeAt(t)>=128&&C("not-basic"),m.push(e.charCodeAt(t));for(r=n>0?n+1:0;r<x;){for(f=j,d=1,p=i;r>=x&&C("invalid-input"),((h=(g=e.charCodeAt(r++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:i)>=i||h>w((u-j)/d))&&C("overflow"),j+=h*d,!(h<(v=p<=A?l:p>=A+c?c:p-A));p+=i)d>w(u/(b=i-v))&&C("overflow"),d*=b;A=E(j-f,o=m.length+1,0==f),w(j/o)>u-S&&C("overflow"),S+=w(j/o),j%=o,m.splice(j++,0,S)}return _(m)}function O(e){var o,n,t,r,f,d,p,h,v,b,g,m,j,S,_,F=[];for(m=(e=A(e)).length,o=a,n=0,f=s,d=0;d<m;++d)(g=e[d])<128&&F.push(x(g));for(t=r=F.length,r&&F.push(y);t<m;){for(p=u,d=0;d<m;++d)(g=e[d])>=o&&g<p&&(p=g);for(p-o>w((u-n)/(j=t+1))&&C("overflow"),n+=(p-o)*j,o=p,d=0;d<m;++d)if((g=e[d])<o&&++n>u&&C("overflow"),g==o){for(h=n,v=i;!(h<(b=v<=f?l:v>=f+c?c:v-f));v+=i)_=h-b,S=i-b,F.push(x(I(b+_%S,0))),h=w(_/S);F.push(x(I(h,0))),f=E(n,j,t==r),n=0,++t}++n,++o}return F.join("")}if(r={version:"1.4.1",ucs2:{decode:A,encode:_},decode:F,encode:O,toASCII:function(e){return S(e,function(e){return v.test(e)?"xn--"+O(e):e})},toUnicode:function(e){return S(e,function(e){return h.test(e)?F(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd)define("punycode",function(){return r});else if(o&&n)if(module.exports==o)n.exports=r;else for(f in r)r.hasOwnProperty(f)&&(o[f]=r[f]);else e.punycode=r}(void 0);

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],423:[function(require,module,exports){
"use strict";function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(r,e,t,n){e=e||"&",t=t||"=";var o={};if("string"!=typeof r||0===r.length)return o;var a=/\+/g;r=r.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var y=0;y<p;++y){var u,c,i,l,f=r[y].replace(a,"%20"),v=f.indexOf(t);v>=0?(u=f.substr(0,v),c=f.substr(v+1)):(u=f,c=""),i=decodeURIComponent(u),l=decodeURIComponent(c),hasOwnProperty(o,i)?isArray(o[i])?o[i].push(l):o[i]=[o[i],l]:o[i]=l}return o};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};

},{}],424:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var stringifyPrimitive=function(t){switch(_typeof(t)){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};module.exports=function(t,r,e,n){return r=r||"&",e=e||"=",null===t&&(t=void 0),"object"===_typeof(t)?map(objectKeys(t),function(n){var o=encodeURIComponent(stringifyPrimitive(n))+e;return isArray(t[n])?map(t[n],function(t){return o+encodeURIComponent(stringifyPrimitive(t))}).join(r):o+encodeURIComponent(stringifyPrimitive(t[n]))}).join(r):n?encodeURIComponent(stringifyPrimitive(n))+e+encodeURIComponent(stringifyPrimitive(t)):""};var isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function map(t,r){if(t.map)return t.map(r);for(var e=[],n=0;n<t.length;n++)e.push(r(t[n],n));return e}var objectKeys=Object.keys||function(t){var r=[];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(e);return r};

},{}],425:[function(require,module,exports){
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");

},{"./decode":423,"./encode":424}],426:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof _?t:_,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:I(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function _(){}function b(){}function m(){}var g={};s(g,a,function(){return this});var x=Object.getPrototypeOf,w=x&&x(x(P([])));w&&w!==r&&n.call(w,a)&&(g=w);var k=m.prototype=_.prototype=Object.create(g);function O(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,a,c)},function(e){r("throw",e,a,c)}):t.resolve(l).then(function(e){s.value=e,a(s)},function(e){return r("throw",e,a,c)})}c(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t(function(t,o){r(e,n,t,o)})}return i=i?i.then(o,o):o()}})}function I(t,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=A(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(t,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(t)+" is not iterable")}return b.prototype=m,o(k,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:b,configurable:!0}),b.displayName=s(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,s(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},O(E.prototype),s(E.prototype,c,function(){return this}),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},O(k),s(k,u,"Generator"),s(k,a,function(){return this}),s(k,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),d}},t}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)})(e)}function _construct(e,t,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&_setPrototypeOf(o,r.prototype),o}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var QuickLRU=exports.default=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,t),e=_callSuper(this,t),!(r.maxSize&&r.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof r.maxAge&&0===r.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");return e.maxSize=r.maxSize,e.maxAge=r.maxAge||Number.POSITIVE_INFINITY,e.onEviction=r.onEviction,e.cache=new Map,e.oldCache=new Map,e._size=0,e}return _inherits(t,_wrapNativeSuper(Map)),_createClass(t,[{key:"_emitEvictions",value:function(e){if("function"==typeof this.onEviction){var t,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var n=_slicedToArray(t.value,2),o=n[0],i=n[1];this.onEviction(o,i.value)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"_deleteIfExpired",value:function(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}},{key:"_getOrDeleteIfExpired",value:function(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}},{key:"_getItemValue",value:function(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}},{key:"_peek",value:function(e,t){var r=t.get(e);return this._getItemValue(e,r)}},{key:"_set",value:function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}},{key:"_moveToRecent",value:function(e,t){this.oldCache.delete(e),this._set(e,t)}},{key:"_entriesAscending",value:_regeneratorRuntime().mark(function e(){var t,r,n,o,i,a,c,u,s,l,f,h;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(this.oldCache),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=13;break}if(n=r.value,o=_slicedToArray(n,2),i=o[0],a=o[1],this.cache.has(i)){e.next=11;break}if(!1!==this._deleteIfExpired(i,a)){e.next=11;break}return e.next=11,n;case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),t.e(e.t0);case 18:return e.prev=18,t.f(),e.finish(18);case 21:c=_createForOfIteratorHelper(this.cache),e.prev=22,c.s();case 24:if((u=c.n()).done){e.next=33;break}if(s=u.value,l=_slicedToArray(s,2),f=l[0],h=l[1],!1!==this._deleteIfExpired(f,h)){e.next=31;break}return e.next=31,s;case 31:e.next=24;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(22),c.e(e.t1);case 38:return e.prev=38,c.f(),e.finish(38);case 41:case"end":return e.stop()}},e,this,[[1,15,18,21],[22,35,38,41]])})},{key:"get",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){var r=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,r))return this._moveToRecent(e,r),r.value}}},{key:"set",value:function(e,t){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).maxAge,n=void 0===r?this.maxAge:r,o="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;return this.cache.has(e)?this.cache.set(e,{value:t,expiry:o}):this._set(e,{value:t,expiry:o}),this}},{key:"has",value:function(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}},{key:"peek",value:function(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"resize",value:function(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");var t=_toConsumableArray(this._entriesAscending()),r=t.length-e;r<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(r>0&&this._emitEvictions(t.slice(0,r)),this.oldCache=new Map(t.slice(r)),this.cache=new Map,this._size=0),this.maxSize=e}},{key:"keys",value:_regeneratorRuntime().mark(function e(){var t,r,n,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=_slicedToArray(r.value,1),o=n[0],e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:"values",value:_regeneratorRuntime().mark(function e(){var t,r,n,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=_slicedToArray(r.value,2),o=n[1],e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:Symbol.iterator,value:_regeneratorRuntime().mark(function(){var e,t,r,n,o,i,a,c,u,s,l,f;return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:e=_createForOfIteratorHelper(this.cache),h.prev=1,e.s();case 3:if((t=e.n()).done){h.next=12;break}if(r=t.value,n=_slicedToArray(r,2),o=n[0],i=n[1],!1!==this._deleteIfExpired(o,i)){h.next=10;break}return h.next=10,[o,i.value];case 10:h.next=3;break;case 12:h.next=17;break;case 14:h.prev=14,h.t0=h.catch(1),e.e(h.t0);case 17:return h.prev=17,e.f(),h.finish(17);case 20:a=_createForOfIteratorHelper(this.oldCache),h.prev=21,a.s();case 23:if((c=a.n()).done){h.next=33;break}if(u=c.value,s=_slicedToArray(u,2),l=s[0],f=s[1],this.cache.has(l)){h.next=31;break}if(!1!==this._deleteIfExpired(l,f)){h.next=31;break}return h.next=31,[l,f.value];case 31:h.next=23;break;case 33:h.next=38;break;case 35:h.prev=35,h.t1=h.catch(21),a.e(h.t1);case 38:return h.prev=38,a.f(),h.finish(38);case 41:case"end":return h.stop()}},i,this,[[1,14,17,20],[21,35,38,41]])})},{key:"entriesDescending",value:_regeneratorRuntime().mark(function e(){var t,r,n,o,i,a,c,u,s,l,f;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=_toConsumableArray(this.cache),r=t.length-1;case 2:if(!(r>=0)){e.next=12;break}if(n=t[r],o=_slicedToArray(n,2),i=o[0],a=o[1],!1!==this._deleteIfExpired(i,a)){e.next=9;break}return e.next=9,[i,a.value];case 9:--r,e.next=2;break;case 12:t=_toConsumableArray(this.oldCache),c=t.length-1;case 14:if(!(c>=0)){e.next=25;break}if(u=t[c],s=_slicedToArray(u,2),l=s[0],f=s[1],this.cache.has(l)){e.next=22;break}if(!1!==this._deleteIfExpired(l,f)){e.next=22;break}return e.next=22,[l,f.value];case 22:--c,e.next=14;break;case 25:case"end":return e.stop()}},e,this)})},{key:"entriesAscending",value:_regeneratorRuntime().mark(function e(){var t,r,n,o,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(this._entriesAscending()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=_slicedToArray(r.value,2),o=n[0],i=n[1],e.next=7,[o,i.value];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])})},{key:"size",get:function(){if(!this._size)return this.oldCache.size;var e,t=0,r=_createForOfIteratorHelper(this.oldCache.keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;this.cache.has(n)||t++}}catch(e){r.e(e)}finally{r.f()}return Math.min(this._size+t,this.maxSize)}},{key:"entries",value:function(){return this.entriesAscending()}},{key:"forEach",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=_createForOfIteratorHelper(this.entriesAscending());try{for(n.s();!(t=n.n()).done;){var o=_slicedToArray(t.value,2),i=o[0],a=o[1];e.call(r,a,i,this)}}catch(e){n.e(e)}finally{n.f()}}},{key:Symbol.toStringTag,get:function(){return JSON.stringify(_toConsumableArray(this.entriesAscending()))}}])}();

},{}],427:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,i){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).RBush=i()}(void 0,function(){function t(t,r,e,o,a){!function t(n,r,e,o,a){for(;o>e;){if(o-e>600){var h=o-e+1,s=r-e+1,l=Math.log(h),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(h-f)/h)*(s-h/2<0?-1:1);t(n,r,Math.max(e,Math.floor(r-s*f/h+u)),Math.min(o,Math.floor(r+(h-s)*f/h+u)),a)}var m=n[r],p=e,c=o;for(i(n,e,r),a(n[o],m)>0&&i(n,e,o);p<c;){for(i(n,p,c),p++,c--;a(n[p],m)<0;)p++;for(;a(n[c],m)>0;)c--}0===a(n[e],m)?i(n,e,c):i(n,++c,o),c<=r&&(e=c+1),r<=c&&(o=c-1)}}(t,r,e||0,o||t.length-1,a||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function o(t,i){a(t,0,t.children.length,i,t)}function a(t,i,n,r,e){e||(e=c(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var o=i;o<n;o++){var a=t.children[o];h(e,t.leaf?r(a):a)}return e}function h(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function p(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function c(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=e)){var h=n+Math.ceil((r-n)/e/2)*e;t(i,h,n,r,o),a.push(n,h,h,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!p(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var o=0;o<i.children.length;o++){var a=i.children[o],h=i.leaf?r(a):a;p(t,h)&&(i.leaf?n.push(a):m(t,h)?this._all(a,n):e.push(a))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!p(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],o=i.leaf?this.toBBox(e):e;if(p(t,o)){if(i.leaf||m(t,o))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=c([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,o,a=this.data,h=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),r=s[s.length-1],n=l.pop(),o=!0),a.leaf){var f=e(t,a.children,i);if(-1!==f)return a.children.splice(f,1),s.push(a),this._condense(s),this}o||a.leaf||!m(a,h)?r?(n++,a=r.children[n],o=!1):a=null:(s.push(a),l.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,a=n-i+1,h=this._maxEntries;if(a<=h)return o(e=c(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(a)/Math.log(h)),h=Math.ceil(a/Math.pow(h,r-1))),(e=c([])).leaf=!1,e.height=r;var s=Math.ceil(a/h),l=s*Math.ceil(Math.sqrt(h));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var m=f;m<=u;m+=s){var p=Math.min(m+s-1,u);e.children.push(this._build(t,m,p,r-1))}}return o(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,o=1/0,a=void 0,h=0;h<i.children.length;h++){var s=i.children[h],l=f(s),u=(m=t,p=s,(Math.max(p.maxX,m.maxX)-Math.min(p.minX,m.minX))*(Math.max(p.maxY,m.maxY)-Math.min(p.minY,m.minY))-l);u<o?(o=u,e=l<e?l:e,a=s):u===o&&l<e&&(e=l,a=s)}i=a||i.children[0]}var m,p;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],o=this._chooseSubtree(r,this.data,i,e);for(o.children.push(t),h(o,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var a=this._chooseSplitIndex(n,e,r),h=c(n.children.splice(a,n.children.length-a));h.height=n.height,h.leaf=n.leaf,o(n,this.toBBox),o(h,this.toBBox),i?t[i-1].children.push(h):this._splitRoot(n,h)},r.prototype._splitRoot=function(t,i){this.data=c([t,i]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,o,h,s,l,u,m=1/0,p=1/0,c=i;c<=n-i;c++){var d=a(t,0,c,this.toBBox),x=a(t,c,n,this.toBBox),v=(e=d,o=x,void 0,void 0,void 0,void 0,h=Math.max(e.minX,o.minX),s=Math.max(e.minY,o.minY),l=Math.min(e.maxX,o.maxX),u=Math.min(e.maxY,o.maxY),Math.max(0,l-h)*Math.max(0,u-s)),y=f(d)+f(x);v<m?(m=v,r=c,p=y<p?y:p):v===m&&y<p&&(p=y,r=c)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,o=a(t,0,i,e),s=a(t,n-i,n,e),l=u(o)+u(s),f=i;f<n-i;f++){var m=t.children[f];h(o,t.leaf?e(m):m),l+=u(o)}for(var p=n-i-1;p>=i;p--){var c=t.children[p];h(s,t.leaf?e(c):c),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)h(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():o(t[i],this.toBBox)},r});

},{}],428:[function(require,module,exports){
(function (global){(function (){
"use strict";var ClientRequest=require("./lib/request"),response=require("./lib/response"),extend=require("xtend"),statusCodes=require("builtin-status-codes"),url=require("url"),http=exports;http.request=function(t,e){t="string"==typeof t?url.parse(t):extend(t);var s=-1===global.location.protocol.search(/^https?:$/)?"http:":"",r=t.protocol||s,n=t.hostname||t.host,o=t.port,p=t.path||"/";n&&-1!==n.indexOf(":")&&(n="["+n+"]"),t.url=(n?r+"//"+n:"")+(o?":"+o:"")+p,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var u=new ClientRequest(t);return e&&u.on("response",e),u},http.get=function(t,e){var s=http.request(t,e);return s.end(),s},http.ClientRequest=ClientRequest,http.IncomingMessage=response.IncomingMessage,http.Agent=function(){},http.Agent.defaultMaxSockets=4,http.globalAgent=new http.Agent,http.STATUS_CODES=statusCodes,http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"];

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./lib/request":430,"./lib/response":431,"builtin-status-codes":10,"url":449,"xtend":459}],429:[function(require,module,exports){
(function (global){(function (){
"use strict";var xhr;function getXHR(){if(void 0!==xhr)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest;try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com")}catch(e){xhr=null}}else xhr=null;return xhr}function checkTypeSupport(e){var r=getXHR();if(!r)return!1;try{return r.responseType=e,r.responseType===e}catch(e){}return!1}function isFunction(e){return"function"==typeof e}exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream),exports.writableStream=isFunction(global.WritableStream),exports.abortController=isFunction(global.AbortController),exports.arraybuffer=exports.fetch||checkTypeSupport("arraybuffer"),exports.msstream=!exports.fetch&&checkTypeSupport("ms-stream"),exports.mozchunkedarraybuffer=!exports.fetch&&checkTypeSupport("moz-chunked-arraybuffer"),exports.overrideMimeType=exports.fetch||!!getXHR()&&isFunction(getXHR().overrideMimeType),xhr=null;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],430:[function(require,module,exports){
(function (process,global,Buffer){(function (){
"use strict";var capability=require("./capability"),inherits=require("inherits"),response=require("./response"),stream=require("readable-stream"),IncomingMessage=response.IncomingMessage,rStates=response.readyStates;function decideMode(e,t){return capability.fetch&&t?"fetch":capability.mozchunkedarraybuffer?"moz-chunked-arraybuffer":capability.msstream?"ms-stream":capability.arraybuffer&&e?"arraybuffer":"text"}var ClientRequest=module.exports=function(e){var t,r=this;stream.Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+Buffer.from(e.auth).toString("base64")),Object.keys(e.headers).forEach(function(t){r.setHeader(t,e.headers[t])});var o=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!capability.abortController)o=!1,t=!0;else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!capability.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}r._mode=decideMode(t,o),r._fetchTimer=null,r.on("finish",function(){r._onFinish()})};function statusValid(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}inherits(ClientRequest,stream.Writable),ClientRequest.prototype.setHeader=function(e,t){var r=e.toLowerCase();-1===unsafeHeaders.indexOf(r)&&(this._headers[r]={name:e,value:t})},ClientRequest.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},ClientRequest.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts,r=e._headers,o=null;"GET"!==t.method&&"HEAD"!==t.method&&(o=new Blob(e._body,{type:(r["content-type"]||{}).value||""}));var n=[];if(Object.keys(r).forEach(function(e){var t=r[e].name,o=r[e].value;Array.isArray(o)?o.forEach(function(e){n.push([t,e])}):n.push([t,o])}),"fetch"===e._mode){var s=null;if(capability.abortController){var i=new AbortController;s=i.signal,e._fetchAbortController=i,"requestTimeout"in t&&0!==t.requestTimeout&&(e._fetchTimer=global.setTimeout(function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()},t.requestTimeout))}global.fetch(e._opts.url,{method:e._opts.method,headers:n,body:o||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:s}).then(function(t){e._fetchResponse=t,e._connect()},function(t){global.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)})}else{var a=e._xhr=new global.XMLHttpRequest;try{a.open(e._opts.method,e._opts.url,!0)}catch(t){return void process.nextTick(function(){e.emit("error",t)})}"responseType"in a&&(a.responseType=e._mode),"withCredentials"in a&&(a.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in a&&a.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in t&&(a.timeout=t.requestTimeout,a.ontimeout=function(){e.emit("requestTimeout")}),n.forEach(function(e){a.setRequestHeader(e[0],e[1])}),e._response=null,a.onreadystatechange=function(){switch(a.readyState){case rStates.LOADING:case rStates.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(a.onprogress=function(){e._onXHRProgress()}),a.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{a.send(o)}catch(t){return void process.nextTick(function(){e.emit("error",t)})}}}},ClientRequest.prototype._onXHRProgress=function(){statusValid(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var e=this;e._destroyed||(e._response=new IncomingMessage(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",function(t){e.emit("error",t)}),e.emit("response",e._response))},ClientRequest.prototype._write=function(e,t,r){this._body.push(e),r()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){this._destroyed=!0,global.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},ClientRequest.prototype.end=function(e,t,r){"function"==typeof e&&(r=e,e=void 0),stream.Writable.prototype.end.call(this,e,t,r)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"];

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"./capability":429,"./response":431,"_process":420,"buffer":9,"inherits":72,"readable-stream":446}],431:[function(require,module,exports){
(function (process,global,Buffer){(function (){
"use strict";var capability=require("./capability"),inherits=require("inherits"),stream=require("readable-stream"),rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},IncomingMessage=exports.IncomingMessage=function(e,r,s,t){var a=this;if(stream.Readable.call(a),a._mode=s,a.headers={},a.rawHeaders=[],a.trailers={},a.rawTrailers=[],a.on("end",function(){process.nextTick(function(){a.emit("close")})}),"fetch"===s){if(a._fetchResponse=r,a.url=r.url,a.statusCode=r.status,a.statusMessage=r.statusText,r.headers.forEach(function(e,r){a.headers[r.toLowerCase()]=e,a.rawHeaders.push(r,e)}),capability.writableStream){var o=new WritableStream({write:function(e){return new Promise(function(r,s){a._destroyed?s():a.push(Buffer.from(e))?r():a._resumeFetch=r})},close:function(){global.clearTimeout(t),a._destroyed||a.push(null)},abort:function(e){a._destroyed||a.emit("error",e)}});try{return void r.body.pipeTo(o).catch(function(e){global.clearTimeout(t),a._destroyed||a.emit("error",e)})}catch(e){}}var n=r.body.getReader();!function e(){n.read().then(function(r){if(!a._destroyed){if(r.done)return global.clearTimeout(t),void a.push(null);a.push(Buffer.from(r.value)),e()}}).catch(function(e){global.clearTimeout(t),a._destroyed||a.emit("error",e)})}()}else{if(a._xhr=e,a._pos=0,a.url=e.responseURL,a.statusCode=e.status,a.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var r=e.match(/^([^:]+):\s*(.*)/);if(r){var s=r[1].toLowerCase();"set-cookie"===s?(void 0===a.headers[s]&&(a.headers[s]=[]),a.headers[s].push(r[2])):void 0!==a.headers[s]?a.headers[s]+=", "+r[2]:a.headers[s]=r[2],a.rawHeaders.push(r[1],r[2])}}),a._charset="x-user-defined",!capability.overrideMimeType){var i=a.rawHeaders["mime-type"];if(i){var u=i.match(/;\s*charset=([^;])(;|$)/);u&&(a._charset=u[1].toLowerCase())}a._charset||(a._charset="utf-8")}}};inherits(IncomingMessage,stream.Readable),IncomingMessage.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},IncomingMessage.prototype._onXHRProgress=function(){var e=this,r=e._xhr,s=null;switch(e._mode){case"text":if((s=r.responseText).length>e._pos){var t=s.substr(e._pos);if("x-user-defined"===e._charset){for(var a=Buffer.alloc(t.length),o=0;o<t.length;o++)a[o]=255&t.charCodeAt(o);e.push(a)}else e.push(t,e._charset);e._pos=s.length}break;case"arraybuffer":if(r.readyState!==rStates.DONE||!r.response)break;s=r.response,e.push(Buffer.from(new Uint8Array(s)));break;case"moz-chunked-arraybuffer":if(s=r.response,r.readyState!==rStates.LOADING||!s)break;e.push(Buffer.from(new Uint8Array(s)));break;case"ms-stream":if(s=r.response,r.readyState!==rStates.LOADING)break;var n=new global.MSStreamReader;n.onprogress=function(){n.result.byteLength>e._pos&&(e.push(Buffer.from(new Uint8Array(n.result.slice(e._pos)))),e._pos=n.result.byteLength)},n.onload=function(){e.push(null)},n.readAsArrayBuffer(s)}e._xhr.readyState===rStates.DONE&&"ms-stream"!==e._mode&&e.push(null)};

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"./capability":429,"_process":420,"buffer":9,"inherits":72,"readable-stream":446}],432:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var codes={};function createErrorType(e,t,r){r||(r=Error);var o=function(e){function r(r,o,n){return e.call(this,function(e,r,o){return"string"==typeof t?t:t(e,r,o)}(r,o,n))||this}return _inheritsLoose(r,e),r}(r);o.prototype.name=r.name,o.prototype.code=e,codes[e]=o}function oneOf(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(e){return String(e)}),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}function startsWith(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function endsWith(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function includes(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}createErrorType("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),createErrorType("ERR_INVALID_ARG_TYPE",function(e,t,r){var o,n;if("string"==typeof t&&startsWith(t,"not ")?(o="must not be",t=t.replace(/^not /,"")):o="must be",endsWith(e," argument"))n="The ".concat(e," ").concat(o," ").concat(oneOf(t,"type"));else{var c=includes(e,".")?"property":"argument";n='The "'.concat(e,'" ').concat(c," ").concat(o," ").concat(oneOf(t,"type"))}return n+=". Received type ".concat(_typeof(r))},TypeError),createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),createErrorType("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close"),createErrorType("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end"),createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),createErrorType("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),module.exports.codes=codes;

},{}],433:[function(require,module,exports){
(function (process){(function (){
"use strict";var objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");require("inherits")(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",onend)))}function onend(){this._writableState.ended||process.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}});

}).call(this)}).call(this,require('_process'))
},{"./_stream_readable":435,"./_stream_writable":437,"_process":420,"inherits":72}],434:[function(require,module,exports){
"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}require("inherits")(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,o){o(null,r)};

},{"./_stream_transform":436,"inherits":72}],435:[function(require,module,exports){
(function (process,global){(function (){
"use strict";var Duplex;module.exports=Readable,Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Stream=require("./internal/streams/stream"),Buffer=require("buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}var debug,debugUtil=require("util");debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,createReadableStreamAsyncIterator,from,BufferList=require("./internal/streams/buffer_list"),destroyImpl=require("./internal/streams/destroy"),_require=require("./internal/streams/state"),getHighWaterMark=_require.getHighWaterMark,_require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_STREAM_PUSH_AFTER_EOF=_require$codes.ERR_STREAM_PUSH_AFTER_EOF,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_UNSHIFT_AFTER_END_EVENT=_require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;require("inherits")(Readable,Stream);var errorOrDestroy=destroyImpl.errorOrDestroy,kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState(e,t,r){Duplex=Duplex||require("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=t instanceof Duplex),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=getHighWaterMark(this,e,"readableHighWaterMark",r),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);var t=this instanceof Duplex;this._readableState=new ReadableState(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),Stream.call(this)}function readableAddChunk(e,t,r,a,n){debug("readableAddChunk",t);var i,d=e._readableState;if(null===t)d.reading=!1,onEofChunk(e,d);else if(n||(i=chunkInvalid(d,t)),i)errorOrDestroy(e,i);else if(d.objectMode||t&&t.length>0)if("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=_uint8ArrayToBuffer(t)),a)d.endEmitted?errorOrDestroy(e,new ERR_STREAM_UNSHIFT_AFTER_END_EVENT):addChunk(e,d,t,!0);else if(d.ended)errorOrDestroy(e,new ERR_STREAM_PUSH_AFTER_EOF);else{if(d.destroyed)return!1;d.reading=!1,d.decoder&&!r?(t=d.decoder.write(t),d.objectMode||0!==t.length?addChunk(e,d,t,!1):maybeReadMore(e,d)):addChunk(e,d,t,!1)}else a||(d.reading=!1,maybeReadMore(e,d));return!d.ended&&(d.length<d.highWaterMark||0===d.length)}function addChunk(e,t,r,a){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,a?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function chunkInvalid(e,t){var r;return _isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer","Uint8Array"],t)),r}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(e,t){t(e)},Readable.prototype.push=function(e,t){var r,a=this._readableState;return a.objectMode?r=!0:"string"==typeof e&&((t=t||a.defaultEncoding)!==a.encoding&&(e=Buffer.from(e,t),t=""),r=!0),readableAddChunk(this,e,t,!1,r)},Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder);var t=new StringDecoder(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,a="";null!==r;)a+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==a&&this._readableState.buffer.push(a),this._readableState.length=a.length,this};var MAX_HWM=1073741824;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk(e,t){if(debug("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?emitReadable(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,emitReadable_(e)))}}function emitReadable(e){var t=e._readableState;debug("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(emitReadable_,e))}function emitReadable_(e){var t=e._readableState;debug("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(debug("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function updateReadableListening(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(resume_,e,t))}function resume_(e,t){debug("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function endReadable(e){var t=e._readableState;debug("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(endReadableNT,t,e))}function endReadableNT(e,t){if(debug("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function indexOf(e,t){for(var r=0,a=e.length;r<a;r++)if(e[r]===t)return r;return-1}Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var a,n=t.needReadable;return debug("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",n=!0),t.ended||t.reading?debug("reading or ended",n=!1):n&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t))),null===(a=e>0?fromList(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==a&&this.emit("data",a),a},Readable.prototype._read=function(e){errorOrDestroy(this,new ERR_METHOD_NOT_IMPLEMENTED("_read()"))},Readable.prototype.pipe=function(e,t){var r=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,debug("pipe count=%d opts=%j",a.pipesCount,t);var n=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:f;function i(t,n){debug("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,debug("cleanup"),e.removeListener("close",b),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",u),e.removeListener("unpipe",i),r.removeListener("end",d),r.removeListener("end",f),r.removeListener("data",l),s=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||o())}function d(){debug("onend"),e.end()}a.endEmitted?process.nextTick(n):r.once("end",n),e.on("unpipe",i);var o=pipeOnDrain(r);e.on("drain",o);var s=!1;function l(t){debug("ondata");var n=e.write(t);debug("dest.write",n),!1===n&&((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==indexOf(a.pipes,e))&&!s&&(debug("false write response, pause",a.awaitDrain),a.awaitDrain++),r.pause())}function u(t){debug("onerror",t),f(),e.removeListener("error",u),0===EElistenerCount(e,"error")&&errorOrDestroy(e,t)}function b(){e.removeListener("finish",p),f()}function p(){debug("onfinish"),e.removeListener("close",b),f()}function f(){debug("unpipe"),r.unpipe(e)}return r.on("data",l),prependListener(e,"error",u),e.once("close",b),e.once("finish",p),e.emit("pipe",r),a.flowing||(debug("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var a=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)a[i].emit("unpipe",this,{hasUnpiped:!1});return this}var d=indexOf(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t),a=this._readableState;return"data"===e?(a.readableListening=this.listenerCount("readable")>0,!1!==a.flowing&&this.resume()):"readable"===e&&(a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.flowing=!1,a.emittedReadable=!1,debug("on readable",a.length,a.reading),a.length?emitReadable(this):a.reading||process.nextTick(nReadingNextTick,this))),r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.removeListener=function(e,t){var r=Stream.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(updateReadableListening,this),r},Readable.prototype.removeAllListeners=function(e){var t=Stream.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(updateReadableListening,this),t},Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!e.readableListening,resume(this,e)),e.paused=!1,this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Readable.prototype.wrap=function(e){var t=this,r=this._readableState,a=!1;for(var n in e.on("end",function(){if(debug("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(n){(debug("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n)||(r.objectMode||n&&n.length)&&(t.push(n)||(a=!0,e.pause()))}),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var i=0;i<kProxyEvents.length;i++)e.on(kProxyEvents[i],this.emit.bind(this,kProxyEvents[i]));return this._read=function(t){debug("wrapped _read",t),a&&(a=!1,e.resume())},this},"function"==typeof Symbol&&(Readable.prototype[Symbol.asyncIterator]=function(){return void 0===createReadableStreamAsyncIterator&&(createReadableStreamAsyncIterator=require("./internal/streams/async_iterator")),createReadableStreamAsyncIterator(this)}),Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),Readable._fromList=fromList,Object.defineProperty(Readable.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(Readable.from=function(e,t){return void 0===from&&(from=require("./internal/streams/from")),from(Readable,e,t)});

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../errors":432,"./_stream_duplex":433,"./internal/streams/async_iterator":438,"./internal/streams/buffer_list":439,"./internal/streams/destroy":440,"./internal/streams/from":442,"./internal/streams/state":444,"./internal/streams/stream":445,"_process":420,"buffer":9,"events":20,"inherits":72,"string_decoder/":447,"util":7}],436:[function(require,module,exports){
"use strict";module.exports=Transform;var _require$codes=require("../errors").codes,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=_require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=_require$codes.ERR_TRANSFORM_WITH_LENGTH_0,Duplex=require("./_stream_duplex");function afterTransform(r,e){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(null===n)return this.emit("error",new ERR_MULTIPLE_CALLBACK);t.writechunk=null,t.writecb=null,null!=e&&this.push(e),n(r);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",prefinish)}function prefinish(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?done(this,null,null):this._flush(function(e,t){done(r,e,t)})}function done(r,e,t){if(e)return r.emit("error",e);if(null!=t&&r.push(t),r._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(r._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return r.push(null)}require("inherits")(Transform,Duplex),Transform.prototype.push=function(r,e){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,e)},Transform.prototype._transform=function(r,e,t){t(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))},Transform.prototype._write=function(r,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=r,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},Transform.prototype._destroy=function(r,e){Duplex.prototype._destroy.call(this,r,function(r){e(r)})};

},{"../errors":432,"./_stream_duplex":433,"inherits":72}],437:[function(require,module,exports){
(function (process,global){(function (){
"use strict";function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(t,e)}}var Duplex;module.exports=Writable,Writable.WritableState=WritableState;var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}var realHasInstance,destroyImpl=require("./internal/streams/destroy"),_require=require("./internal/streams/state"),getHighWaterMark=_require.getHighWaterMark,_require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_STREAM_CANNOT_PIPE=_require$codes.ERR_STREAM_CANNOT_PIPE,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED,ERR_STREAM_NULL_VALUES=_require$codes.ERR_STREAM_NULL_VALUES,ERR_STREAM_WRITE_AFTER_END=_require$codes.ERR_STREAM_WRITE_AFTER_END,ERR_UNKNOWN_ENCODING=_require$codes.ERR_UNKNOWN_ENCODING,errorOrDestroy=destroyImpl.errorOrDestroy;function nop(){}function WritableState(e,t,r){Duplex=Duplex||require("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=t instanceof Duplex),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=getHighWaterMark(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){var t=this instanceof(Duplex=Duplex||require("./_stream_duplex"));if(!t&&!realHasInstance.call(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Stream.call(this)}function writeAfterEnd(e,t){var r=new ERR_STREAM_WRITE_AFTER_END;errorOrDestroy(e,r),process.nextTick(t,r)}function validChunk(e,t,r,i){var n;return null===r?n=new ERR_STREAM_NULL_VALUES:"string"==typeof r||t.objectMode||(n=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],r)),!n||(errorOrDestroy(e,n),process.nextTick(i,n),!1)}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer.from(t,r)),t}function writeOrBuffer(e,t,r,i,n,o){if(!r){var s=decodeChunk(t,i,n);i!==s&&(r=!0,n="buffer",i=s)}var a=t.objectMode?1:i.length;t.length+=a;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var f=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},f?f.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,a,i,n,o);return u}function doWrite(e,t,r,i,n,o,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new ERR_STREAM_DESTROYED("write")):r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?(process.nextTick(n,i),process.nextTick(finishMaybe,e,t),e._writableState.errorEmitted=!0,errorOrDestroy(e,i)):(n(i),e._writableState.errorEmitted=!0,errorOrDestroy(e,i),finishMaybe(e,t))}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if("function"!=typeof n)throw new ERR_MULTIPLE_CALLBACK;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var o=needFinish(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?process.nextTick(afterWrite,e,r,o,n):afterWrite(e,r,o,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)n[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;n.allBuffers=a,doWrite(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,f=r.encoding,l=r.callback;if(doWrite(e,t,!1,t.objectMode?1:u.length,u,f,l),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(function(r){t.pendingcb--,r&&errorOrDestroy(e,r),t.prefinished=!0,e.emit("prefinish"),finishMaybe(e,t)})}function prefinish(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(callFinal,e,t)))}function finishMaybe(e,t){var r=needFinish(t);if(r&&(prefinish(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?process.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree.next=e}require("inherits")(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||this===Writable&&(e&&e._writableState instanceof WritableState)}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){errorOrDestroy(this,new ERR_STREAM_CANNOT_PIPE)},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1,o=!i.objectMode&&_isUint8Array(e);return o&&!Buffer.isBuffer(e)&&(e=_uint8ArrayToBuffer(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ending?writeAfterEnd(this,r):(o||validChunk(this,i,e,r))&&(i.pendingcb++,n=writeOrBuffer(this,i,o,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new ERR_UNKNOWN_ENCODING(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(e,t,r){r(new ERR_METHOD_NOT_IMPLEMENTED("_write()"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||endWritable(this,i,r),this},Object.defineProperty(Writable.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Writable.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(e,t){t(e)};

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../errors":432,"./_stream_duplex":433,"./internal/streams/destroy":440,"./internal/streams/state":444,"./internal/streams/stream":445,"_process":420,"buffer":9,"inherits":72,"util-deprecate":451}],438:[function(require,module,exports){
(function (process){(function (){
"use strict";var _Object$setPrototypeO;function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var finished=require("./end-of-stream"),kLastResolve=Symbol("lastResolve"),kLastReject=Symbol("lastReject"),kError=Symbol("error"),kEnded=Symbol("ended"),kLastPromise=Symbol("lastPromise"),kHandlePromise=Symbol("handlePromise"),kStream=Symbol("stream");function createIterResult(e,t){return{value:e,done:t}}function readAndResolve(e){var t=e[kLastResolve];if(null!==t){var r=e[kStream].read();null!==r&&(e[kLastPromise]=null,e[kLastResolve]=null,e[kLastReject]=null,t(createIterResult(r,!1)))}}function onReadable(e){process.nextTick(readAndResolve,e)}function wrapForNext(e,t){return function(r,o){e.then(function(){t[kEnded]?r(createIterResult(void 0,!0)):t[kHandlePromise](r,o)},o)}}var AsyncIteratorPrototype=Object.getPrototypeOf(function(){}),ReadableStreamAsyncIteratorPrototype=Object.setPrototypeOf((_defineProperty(_Object$setPrototypeO={get stream(){return this[kStream]},next:function(){var e=this,t=this[kError];if(null!==t)return Promise.reject(t);if(this[kEnded])return Promise.resolve(createIterResult(void 0,!0));if(this[kStream].destroyed)return new Promise(function(t,r){process.nextTick(function(){e[kError]?r(e[kError]):t(createIterResult(void 0,!0))})});var r,o=this[kLastPromise];if(o)r=new Promise(wrapForNext(o,this));else{var n=this[kStream].read();if(null!==n)return Promise.resolve(createIterResult(n,!1));r=new Promise(this[kHandlePromise])}return this[kLastPromise]=r,r}},Symbol.asyncIterator,function(){return this}),_defineProperty(_Object$setPrototypeO,"return",function(){var e=this;return new Promise(function(t,r){e[kStream].destroy(null,function(e){e?r(e):t(createIterResult(void 0,!0))})})}),_Object$setPrototypeO),AsyncIteratorPrototype),createReadableStreamAsyncIterator=function(e){var t,r=Object.create(ReadableStreamAsyncIteratorPrototype,(_defineProperty(t={},kStream,{value:e,writable:!0}),_defineProperty(t,kLastResolve,{value:null,writable:!0}),_defineProperty(t,kLastReject,{value:null,writable:!0}),_defineProperty(t,kError,{value:null,writable:!0}),_defineProperty(t,kEnded,{value:e._readableState.endEmitted,writable:!0}),_defineProperty(t,kHandlePromise,{value:function(e,t){var o=r[kStream].read();o?(r[kLastPromise]=null,r[kLastResolve]=null,r[kLastReject]=null,e(createIterResult(o,!1))):(r[kLastResolve]=e,r[kLastReject]=t)},writable:!0}),t));return r[kLastPromise]=null,finished(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[kLastReject];return null!==t&&(r[kLastPromise]=null,r[kLastResolve]=null,r[kLastReject]=null,t(e)),void(r[kError]=e)}var o=r[kLastResolve];null!==o&&(r[kLastPromise]=null,r[kLastResolve]=null,r[kLastReject]=null,o(createIterResult(void 0,!0))),r[kEnded]=!0}),e.on("readable",onReadable.bind(null,r)),r};module.exports=createReadableStreamAsyncIterator;

}).call(this)}).call(this,require('_process'))
},{"./end-of-stream":441,"_process":420}],439:[function(require,module,exports){
"use strict";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var _require=require("buffer"),Buffer=_require.Buffer,_require2=require("util"),inspect=_require2.inspect,custom=inspect&&inspect.custom||"inspect";function copyBuffer(e,t,n){Buffer.prototype.copy.call(e,t,n)}module.exports=function(){function e(){_classCallCheck(this,e),this.head=null,this.tail=null,this.length=0}return _createClass(e,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return Buffer.alloc(0);for(var t=Buffer.allocUnsafe(e>>>0),n=this.head,r=0;n;)copyBuffer(n.data,t,r),r+=n.data.length,n=n.next;return t}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var a=t.data,i=e>a.length?a.length:e;if(i===a.length?r+=a:r+=a.slice(0,e),0===(e-=i)){i===a.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=a.slice(i));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=Buffer.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var a=n.data,i=e>a.length?a.length:e;if(a.copy(t,t.length-e,0,i),0===(e-=i)){i===a.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=a.slice(i));break}++r}return this.length-=r,t}},{key:custom,value:function(e,t){return inspect(this,_objectSpread({},t,{depth:0,customInspect:!1}))}}]),e}();

},{"buffer":9,"util":7}],440:[function(require,module,exports){
(function (process){(function (){
"use strict";function destroy(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return i||a?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(emitErrorNT,this,t)):process.nextTick(emitErrorNT,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?r._writableState?r._writableState.errorEmitted?process.nextTick(emitCloseNT,r):(r._writableState.errorEmitted=!0,process.nextTick(emitErrorAndCloseNT,r,t)):process.nextTick(emitErrorAndCloseNT,r,t):e?(process.nextTick(emitCloseNT,r),e(t)):process.nextTick(emitCloseNT,r)}),this)}function emitErrorAndCloseNT(t,e){emitErrorNT(t,e),emitCloseNT(t)}function emitCloseNT(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}function errorOrDestroy(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}module.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy};

}).call(this)}).call(this,require('_process'))
},{"_process":420}],441:[function(require,module,exports){
"use strict";var ERR_STREAM_PREMATURE_CLOSE=require("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function once(e){var r=!1;return function(){if(!r){r=!0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.apply(this,n)}}}function noop(){}function isRequest(e){return e.setHeader&&"function"==typeof e.abort}function eos(e,r,t){if("function"==typeof r)return eos(e,null,r);r||(r={}),t=once(t||noop);var n=r.readable||!1!==r.readable&&e.readable,o=r.writable||!1!==r.writable&&e.writable,i=function(){e.writable||l()},a=e._writableState&&e._writableState.finished,l=function(){o=!1,a=!0,n||t.call(e)},s=e._readableState&&e._readableState.endEmitted,c=function(){n=!1,s=!0,o||t.call(e)},u=function(r){t.call(e,r)},f=function(){var r;return n&&!s?(e._readableState&&e._readableState.ended||(r=new ERR_STREAM_PREMATURE_CLOSE),t.call(e,r)):o&&!a?(e._writableState&&e._writableState.ended||(r=new ERR_STREAM_PREMATURE_CLOSE),t.call(e,r)):void 0},d=function(){e.req.on("finish",l)};return isRequest(e)?(e.on("complete",l),e.on("abort",f),e.req?d():e.on("request",d)):o&&!e._writableState&&(e.on("end",i),e.on("close",i)),e.on("end",c),e.on("finish",l),!1!==r.error&&e.on("error",u),e.on("close",f),function(){e.removeListener("complete",l),e.removeListener("abort",f),e.removeListener("request",d),e.req&&e.req.removeListener("finish",l),e.removeListener("end",i),e.removeListener("close",i),e.removeListener("finish",l),e.removeListener("end",c),e.removeListener("error",u),e.removeListener("close",f)}}module.exports=eos;

},{"../../../errors":432}],442:[function(require,module,exports){
"use strict";module.exports=function(){throw new Error("Readable.from is not available in the browser")};

},{}],443:[function(require,module,exports){
"use strict";var eos;function once(e){var r=!1;return function(){r||(r=!0,e.apply(void 0,arguments))}}var _require$codes=require("../../../errors").codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop(e){if(e)throw e}function isRequest(e){return e.setHeader&&"function"==typeof e.abort}function destroyer(e,r,n,o){o=once(o);var t=!1;e.on("close",function(){t=!0}),void 0===eos&&(eos=require("./end-of-stream")),eos(e,{readable:r,writable:n},function(e){if(e)return o(e);t=!0,o()});var i=!1;return function(r){if(!t&&!i)return i=!0,isRequest(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(r||new ERR_STREAM_DESTROYED("pipe"))}}function call(e){e()}function pipe(e,r){return e.pipe(r)}function popCallback(e){return e.length?"function"!=typeof e[e.length-1]?noop:e.pop():noop}function pipeline(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var o,t=popCallback(r);if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new ERR_MISSING_ARGS("streams");var i=r.map(function(e,n){var u=n<r.length-1;return destroyer(e,u,n>0,function(e){o||(o=e),e&&i.forEach(call),u||(i.forEach(call),t(o))})});return r.reduce(pipe)}module.exports=pipeline;

},{"../../../errors":432,"./end-of-stream":441}],444:[function(require,module,exports){
"use strict";var ERR_INVALID_OPT_VALUE=require("../../../errors").codes.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(r,e,t){return null!=r.highWaterMark?r.highWaterMark:e?r[t]:null}function getHighWaterMark(r,e,t,a){var i=highWaterMarkFrom(e,a,t);if(null!=i){if(!isFinite(i)||Math.floor(i)!==i||i<0)throw new ERR_INVALID_OPT_VALUE(a?t:"highWaterMark",i);return Math.floor(i)}return r.objectMode?16:16384}module.exports={getHighWaterMark:getHighWaterMark};

},{"../../../errors":432}],445:[function(require,module,exports){
"use strict";module.exports=require("events").EventEmitter;

},{"events":20}],446:[function(require,module,exports){
"use strict";exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),exports.finished=require("./lib/internal/streams/end-of-stream.js"),exports.pipeline=require("./lib/internal/streams/pipeline.js");

},{"./lib/_stream_duplex.js":433,"./lib/_stream_passthrough.js":434,"./lib/_stream_readable.js":435,"./lib/_stream_transform.js":436,"./lib/_stream_writable.js":437,"./lib/internal/streams/end-of-stream.js":441,"./lib/internal/streams/pipeline.js":443}],447:[function(require,module,exports){
"use strict";var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function normalizeEncoding(t){var e=_normalizeEncoding(t);if("string"!=typeof e&&(Buffer.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return e||t}function StringDecoder(t){var e;switch(this.encoding=normalizeEncoding(t),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,e=4;break;case"utf8":this.fillLast=utf8FillLast,e=4;break;case"base64":this.text=base64Text,this.end=base64End,e=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(e)}function utf8CheckByte(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function utf8CheckIncomplete(t,e,s){var i=e.length-1;if(i<s)return 0;var n=utf8CheckByte(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(t.lastNeed=n-2),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}function utf8CheckExtraBytes(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"ï¿½";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"ï¿½";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"ï¿½"}}function utf8FillLast(t){var e=this.lastTotal-this.lastNeed,s=utf8CheckExtraBytes(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function utf8Text(t,e){var s=utf8CheckIncomplete(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function utf8End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"ï¿½":e}function utf16Text(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function utf16End(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function base64Text(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function base64End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};

},{"safe-buffer":448}],448:[function(require,module,exports){
"use strict";var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(f,e){for(var r in f)e[r]=f[r]}function SafeBuffer(f,e,r){return Buffer(f,e,r)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),SafeBuffer.prototype=Object.create(Buffer.prototype),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,e,r){if("number"==typeof f)throw new TypeError("Argument must not be a number");return Buffer(f,e,r)},SafeBuffer.alloc=function(f,e,r){if("number"!=typeof f)throw new TypeError("Argument must be a number");var u=Buffer(f);return void 0!==e?"string"==typeof r?u.fill(e,r):u.fill(e):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(f)};

},{"buffer":9}],449:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var punycode=require("punycode"),util=require("./util");function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");function urlParse(t,s,e){if(t&&util.isObject(t)&&t instanceof Url)return t;var h=new Url;return h.parse(t,s,e),h}function urlFormat(t){return util.isString(t)&&(t=urlParse(t)),t instanceof Url?t.format():Url.prototype.format.call(t)}function urlResolve(t,s){return urlParse(t,!1,!0).resolve(s)}function urlResolveObject(t,s){return t?urlParse(t,!1,!0).resolveObject(s):s}Url.prototype.parse=function(t,s,e){if(!util.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+_typeof(t));var h=t.indexOf("?"),r=-1!==h&&h<t.indexOf("#")?"?":"#",o=t.split(r);o[0]=o[0].replace(/\\/g,"/");var a=t=o.join(r);if(a=a.trim(),!e&&1===t.split("#").length){var n=simplePathPattern.exec(a);if(n)return this.path=a,this.href=a,this.pathname=n[1],n[2]?(this.search=n[2],this.query=s?querystring.parse(this.search.substr(1)):this.search.substr(1)):s&&(this.search="",this.query={}),this}var i=protocolPattern.exec(a);if(i){var l=(i=i[0]).toLowerCase();this.protocol=l,a=a.substr(i.length)}if(e||i||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u="//"===a.substr(0,2);!u||i&&hostlessProtocol[i]||(a=a.substr(2),this.slashes=!0)}if(!hostlessProtocol[i]&&(u||i&&!slashedProtocol[i])){for(var p,c,f=-1,m=0;m<hostEndingChars.length;m++){-1!==(y=a.indexOf(hostEndingChars[m]))&&(-1===f||y<f)&&(f=y)}-1!==(c=-1===f?a.lastIndexOf("@"):a.lastIndexOf("@",f))&&(p=a.slice(0,c),a=a.slice(c+1),this.auth=decodeURIComponent(p)),f=-1;for(m=0;m<nonHostChars.length;m++){var y;-1!==(y=a.indexOf(nonHostChars[m]))&&(-1===f||y<f)&&(f=y)}-1===f&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var g=this.hostname.split(/\./),P=(m=0,g.length);m<P;m++){var d=g[m];if(d&&!d.match(hostnamePartPattern)){for(var b="",q=0,O=d.length;q<O;q++)d.charCodeAt(q)>127?b+="x":b+=d[q];if(!b.match(hostnamePartPattern)){var j=g.slice(0,m),x=g.slice(m+1),U=d.match(hostnamePartStart);U&&(j.push(U[1]),x.unshift(U[2])),x.length&&(a="/"+x.join(".")+a),this.hostname=j.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=punycode.toASCII(this.hostname));var C=this.port?":"+this.port:"",A=this.hostname||"";this.host=A+C,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!unsafeProtocol[l])for(m=0,P=autoEscape.length;m<P;m++){var S=autoEscape[m];if(-1!==a.indexOf(S)){var w=encodeURIComponent(S);w===S&&(w=escape(S)),a=a.split(S).join(w)}}var E=a.indexOf("#");-1!==E&&(this.hash=a.substr(E),a=a.slice(0,E));var I=a.indexOf("?");if(-1!==I?(this.search=a.substr(I),this.query=a.substr(I+1),s&&(this.query=querystring.parse(this.query)),a=a.slice(0,I)):s&&(this.search="",this.query={}),a&&(this.pathname=a),slashedProtocol[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){C=this.pathname||"";var R=this.search||"";this.path=C+R}return this.href=this.format(),this},Url.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var s=this.protocol||"",e=this.pathname||"",h=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(o=querystring.stringify(this.query));var a=this.search||o&&"?"+o||"";return s&&":"!==s.substr(-1)&&(s+=":"),this.slashes||(!s||slashedProtocol[s])&&!1!==r?(r="//"+(r||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):r||(r=""),h&&"#"!==h.charAt(0)&&(h="#"+h),a&&"?"!==a.charAt(0)&&(a="?"+a),s+r+(e=e.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+h},Url.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url.prototype.resolveObject=function(t){if(util.isString(t)){var s=new Url;s.parse(t,!1,!0),t=s}for(var e=new Url,h=Object.keys(this),r=0;r<h.length;r++){var o=h[r];e[o]=this[o]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),n=0;n<a.length;n++){var i=a[n];"protocol"!==i&&(e[i]=t[i])}return slashedProtocol[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!slashedProtocol[t.protocol]){for(var l=Object.keys(t),u=0;u<l.length;u++){var p=l[u];e[p]=t[p]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||hostlessProtocol[t.protocol])e.pathname=t.pathname;else{for(var c=(t.pathname||"").split("/");c.length&&!(t.host=c.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==c[0]&&c.unshift(""),c.length<2&&c.unshift(""),e.pathname=c.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){var f=e.pathname||"",m=e.search||"";e.path=f+m}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var y=e.pathname&&"/"===e.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),g=v||y||e.host&&t.pathname,P=g,d=e.pathname&&e.pathname.split("/")||[],b=(c=t.pathname&&t.pathname.split("/")||[],e.protocol&&!slashedProtocol[e.protocol]);if(b&&(e.hostname="",e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===c[0]?c[0]=t.host:c.unshift(t.host)),t.host=null),g=g&&(""===c[0]||""===d[0])),v)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,d=c;else if(c.length)d||(d=[]),d.pop(),d=d.concat(c),e.search=t.search,e.query=t.query;else if(!util.isNullOrUndefined(t.search)){if(b)e.hostname=e.host=d.shift(),(U=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@"))&&(e.auth=U.shift(),e.host=e.hostname=U.shift());return e.search=t.search,e.query=t.query,util.isNull(e.pathname)&&util.isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!d.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var q=d.slice(-1)[0],O=(e.host||t.host||d.length>1)&&("."===q||".."===q)||""===q,j=0,x=d.length;x>=0;x--)"."===(q=d[x])?d.splice(x,1):".."===q?(d.splice(x,1),j++):j&&(d.splice(x,1),j--);if(!g&&!P)for(;j--;j)d.unshift("..");!g||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),O&&"/"!==d.join("/").substr(-1)&&d.push("");var U,C=""===d[0]||d[0]&&"/"===d[0].charAt(0);b&&(e.hostname=e.host=C?"":d.length?d.shift():"",(U=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@"))&&(e.auth=U.shift(),e.host=e.hostname=U.shift()));return(g=g||e.host&&d.length)&&!C&&d.unshift(""),d.length?e.pathname=d.join("/"):(e.pathname=null,e.path=null),util.isNull(e.pathname)&&util.isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},Url.prototype.parseHost=function(){var t=this.host,s=portPattern.exec(t);s&&(":"!==(s=s[0])&&(this.port=s.substr(1)),t=t.substr(0,t.length-s.length)),t&&(this.hostname=t)};

},{"./util":450,"punycode":422,"querystring":425}],450:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}module.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"===_typeof(t)&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}};

},{}],451:[function(require,module,exports){
(function (global){(function (){
"use strict";function deprecate(r,e){if(config("noDeprecation"))return r;var t=!1;return function(){if(!t){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}}function config(r){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[r];return null!=e&&"true"===String(e).toLowerCase()}module.exports=deprecate;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],452:[function(require,module,exports){
"use strict";module.exports=Worker;

},{}],453:[function(require,module,exports){
"use strict";function countSubstring(t,u){var n=new RegExp(u,"g"),e=t.match(n);return e?e.length:0}module.exports=countSubstring,module.exports.default=countSubstring;

},{}],454:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var indexOfMatch=require("./index-of-match.js"),indexOfMatchEnd=require("./index-of-match-end.js"),countSubstring=require("./count-substring.js");function findTagByName(t,n,e){var o=e&&e.debug||!1,i=!(e&&!1===_typeof(e.nested)),r=e&&e.startIndex||0;o&&console.log("[xml-utils] starting findTagByName with",n," and ",e);var l=indexOfMatch(t,"<".concat(n,"[ \n>/]"),r);if(o&&console.log("[xml-utils] start:",l),-1!==l){var s=t.slice(l+n.length),f=indexOfMatchEnd(s,"^[^<]*[ /]>",0),a=-1!==f&&"/"===s[f-1];if(o&&console.log("[xml-utils] selfClosing:",a),!1===a)if(i)for(var u=0,c=1,d=0;-1!==(f=indexOfMatchEnd(s,"[ /]"+n+">",u));){var y=s.substring(u,f+1);if(c+=countSubstring(y,"<"+n+"[ \n\t>]"),(d+=countSubstring(y,"</"+n+">"))>=c)break;u=f}else f=indexOfMatchEnd(s,"[ /]"+n+">",0);var m=l+n.length+f+1;if(o&&console.log("[xml-utils] end:",m),-1!==m){var g=t.slice(l,m);return{inner:a?null:g.slice(g.indexOf(">")+1,g.lastIndexOf("<")),outer:g,start:l,end:m}}}}module.exports=findTagByName,module.exports.default=findTagByName;

},{"./count-substring.js":453,"./index-of-match-end.js":457,"./index-of-match.js":458}],455:[function(require,module,exports){
"use strict";var findTagByName=require("./find-tag-by-name.js");function findTagsByName(e,a,n){for(var t,d=[],s=n&&n.debug||!1,g=!n||"boolean"!=typeof n.nested||n.nested,o=n&&n.startIndex||0;t=findTagByName(e,a,{debug:s,startIndex:o});)o=g?t.start+1+a.length:t.end,d.push(t);return s&&console.log("findTagsByName found",d.length,"tags"),d}module.exports=findTagsByName,module.exports.default=findTagsByName;

},{"./find-tag-by-name.js":454}],456:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function getAttribute(t,o,e){var n=e&&e.debug||!1;n&&console.log("[xml-utils] getting "+o+" in "+t);for(var r="object"===_typeof(t)?t.outer:t,l=r.slice(0,r.indexOf(">")+1),u=['"',"'"],i=0;i<u.length;i++){var f=u[i],c=o+"\\="+f+"([^"+f+"]*)"+f;n&&console.log("[xml-utils] pattern:",c);var y=new RegExp(c).exec(l);if(n&&console.log("[xml-utils] match:",y),y)return y[1]}}module.exports=getAttribute,module.exports.default=getAttribute;

},{}],457:[function(require,module,exports){
"use strict";function indexOfMatchEnd(e,n,t){var d=new RegExp(n).exec(e.slice(t));return d?t+d.index+d[0].length-1:-1}module.exports=indexOfMatchEnd,module.exports.default=indexOfMatchEnd;

},{}],458:[function(require,module,exports){
"use strict";function indexOfMatch(e,t,n){var x=new RegExp(t).exec(e.slice(n));return x?n+x.index:-1}module.exports=indexOfMatch,module.exports.default=indexOfMatch;

},{}],459:[function(require,module,exports){
"use strict";module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}

},{}],460:[function(require,module,exports){
(function (Buffer){(function (){
"use strict";var _init,instance,heap,IMPORT_OBJECT={env:{emscripten_notify_memory_growth:function(A){heap=new Uint8Array(instance.exports.memory.buffer)}}},ZSTDDecoder=function(){function A(){}var I=A.prototype;return I.init=function(){return _init||(_init="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+wasm).then(function(A){return A.arrayBuffer()}).then(function(A){return WebAssembly.instantiate(A,IMPORT_OBJECT)}).then(this._init):WebAssembly.instantiate(Buffer.from(wasm,"base64"),IMPORT_OBJECT).then(this._init))},I._init=function(A){instance=A.instance,IMPORT_OBJECT.env.emscripten_notify_memory_growth(0)},I.decode=function(A,I){if(void 0===I&&(I=0),!instance)throw new Error("ZSTDDecoder: Await .init() before decoding.");var B=A.byteLength,g=instance.exports.malloc(B);heap.set(A,g),I=I||Number(instance.exports.ZSTD_findDecompressedSize(g,B));var Q=instance.exports.malloc(I),C=instance.exports.ZSTD_decompress(Q,I,g,B),E=heap.slice(Q,Q+C);return instance.exports.free(g),instance.exports.free(Q),E},A}(),wasm="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ";exports.ZSTDDecoder=ZSTDDecoder;

}).call(this)}).call(this,require("buffer").Buffer)
},{"buffer":9}]},{},[2,1,3]);
;/**
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 ClÃ©ment Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */

/**
 * Events triggered by TWCCUi and attached to the body:
 *  - ui.clickconvert (selctor)
 *  - ui.modechanged (mode)
 */

(function ($, ClipboardJS) {
    "use strict";
    /*global window, document */

    if (window.TWCCUi !== undefined) {
        return;
    }

    var instance;

    function init(opts) {
        var _clipboardJsClient,
            _dfd = null,
            _convergenceConvention = true,
            _options = $.extend(true, {}, opts),
            _SHDelay = 250,
            _paletteTimer = {},
            _isLight = !!$('.light').length;

        function _trigger(eventName, data) {
            var $anchor = $('body');
            _options.utils.trigger($anchor, eventName, data);
        }

        function _t() {
            return _options.utils.t.apply(this, arguments);
        }

        function _newDeferred() {
            return _options.utils.newDeferred.apply(this, arguments);
        }

        function _initBeautyTipsUi() {
            var btOptions = {
                trigger: 'none',
                showTip: function (box) {
                    $(box).fadeIn(_SHDelay);
                },
                hideTip: function (box, callback) {
                    $(box).animate({opacity: 0}, _SHDelay, callback);
                },
                shrinkToFit: true,
                padding: '0px',
                windowMargin: '0px',
                fill: 'rgba(0, 0, 0, .9)',
                cornerRadius: 10,
                strokeWidth: 1,
                shadow: true,
                shadowOffsetX: 3,
                shadowOffsetY: 3,
                shadowBlur: 3,
                shadowColor: 'rgba(6,6,6,.5)',
                shadowOverlap: false,
                noShadowOpts: {strokeStyle: '#666', strokeWidth: 1},
                positions: ['left', 'top'],
                cssStyles: {color: '#FFF'},
                closeWhenOthersOpen: true,
                clickAnywhereToClose: false
            }, $crsList = $('.crs-list');
            $.extend($.bt.defaults, btOptions);
            $crsList.first().bt({contentSelector: "$('.help-1')"});
            $crsList.last().bt({contentSelector: "$('.help-2')"});
            $('.source .container').bt({contentSelector: "$('.help-3')"});
            $('.source .convert-button').bt({contentSelector: "$('.help-4')"});
            $('.next_button').button({icons: {secondary: 'ui-icon-seek-next'}});
        }

        function _initConverterUi() {
            $('.previous.history').button({icons: {primary: 'ui-icon-seek-first'}, text: false});
            $('#help').button({icons: {primary: 'ui-icon-help'}, text: false});
            $('.next.history').button({icons: {primary: 'ui-icon-seek-end'}, text: false});
            $('.source .convert-button').button({icons: {primary: 'ui-icon-arrowthick-1-s'}});
            $('.destination .convert-button').button({icons: {primary: 'ui-icon-arrowthick-1-n'}});
            $('#converter').draggable({handle: '.drag-handle'});
            $('input[type="text"]', '#p-research').addClass('ui-corner-all');
            $('#p-new').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('customSystem'),
                width: _isLight ? "95%" : 400,
                autoOpen: false
            });
            $('#p-crs').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('systemDefinition'),
                width: _isLight ? "95%" : 500,
                autoOpen: false
            });
            $('#p-research').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('research'),
                width: _isLight ? "95%" : 400,
                autoOpen: false
            });
            _setHistoryButtons(0, 0);
        }

        function _initOptionsUi() {
            $('.button-set').buttonset();
            $('#auto-zoom-toggle').button({icons: {primary: 'ui-icon-zoomin'}, text: false, disabled: true});
            /*$('#print-map').button({icons: {primary: 'ui-icon-print'}, text: false});*/
            if (!_isLight) {
                $('#full-screen')
                    .button({icons: {primary: 'ui-icon-arrow-4-diag'}, text: false})
                    .closest('p').toggle($(document).fullScreen() !== null);
            }
            $('#o-container').accordion({
                collapsible: true,
                active: false,
                heightStyle: 'content',
                icons: {header: 'ui-icon-gear'}
            });
            $('#p-convention_help').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('conventionTitle'),
                width: _isLight ? "95%" : 840,
                autoOpen: false
            });
        }

        function _initAdsenseUi() {
            var parameters = _options.system.adsense.parameters;
            window.adsbygoogle = window.adsbygoogle || [];
            $('ins.adsbygoogle').each(function () {
                window.adsbygoogle.push({params: $.extend({}, parameters)});
            });
        }

        function _initGeneralUi() {
            var hash = _getAddressBarAnchor(),
                $pDonate = $('#p-donate'),
                $pLoading = $('#p-loading'),
                progressbar = $pLoading.find('.progressbar'),
                progressLabel = $('.progress-label');
            $('.section, .searchbtn').addClass('ui-corner-all');
            $('.view').addClass('ui-corner-br ui-corner-tr');
            $('.search-field').addClass('ui-corner-bl ui-corner-tl');
            $('#p-poll').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('poll'),
                width: _isLight ? "95%" : 500,
                open: function () {
                    _addAnchorToAddressBar('poll');
                },
                close: function () {
                    _removeAnchorFromAddressBar('poll');
                },
                autoOpen: hash == 'poll'
            });
            if (_options.system.raterMasterSw && !_options.context.session.userHasRatedOne) {
                _showPoll(false);
            }
            $('#p-contact').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('contactUs'),
                width: _isLight ? "95%" : 500,
                open: function () {
                    _addAnchorToAddressBar('contact');
                },
                close: function () {
                    _removeAnchorFromAddressBar('contact');
                },
                autoOpen: hash == 'contact'
            });
            $('.contact-button').button({icons: {secondary: 'ui-icon-mail-closed'}});
            $pDonate.find('input.dont-show-again').prop('checked', _getPreferenceCookie('p-donate'));
            $('.help-1').find('input.dont-show-again').prop('checked', _getPreferenceCookie('help-1'));
            $pDonate.dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('donate'),
                width: _isLight ? "95%" : 750,
                open: function () {
                    _addAnchorToAddressBar('donate');
                },
                close: function () {
                    _removeAnchorFromAddressBar('donate');
                },
                autoOpen: hash == 'donate'
            });
            $pDonate.find('.progressbar').progressbar({
                value: _options.donations.total,
                max: _options.donations.max
            });
            progressbar.progressbar({
                value: false,
                change: function () {
                    progressLabel.text(Math.round(progressbar.progressbar('value')) + '%');
                },
                complete: function () {
                    progressLabel.text('Complete!');
                }
            });
            $('#p-about').dialog({
                closeText: _t('close'),
                modal: true,
                title: _t('about'),
                width: _isLight ? "95%" : '70%',
                open: function () {
                    _addAnchorToAddressBar('about');
                },
                close: function () {
                    _removeAnchorFromAddressBar('about');
                },
                autoOpen: hash == 'about'
            });
            $('body').on('history.indexchanged', function (event, response) {
                var history = response.data;
                _setHistoryButtons(history.currentIndex, history.maxIndex);
            });
            $('#p-info').dialog({
                closeText: _t('close'),
                modal: true,
                title: 'Information',
                width: _isLight ? "95%" : 750,
                autoOpen: true
            });
            $('#csvFeatures').hide();
            $('#language')
                .find('>dt>a')
                .button({icons: {secondary: 'ui-icon-triangle-1-s'}});
            if (_options.system.facebookEnabled) {
                window.fbAsyncInit = function () {
                    FB.init({
                        appId: _options.system.facebookAppId,
                        xfbml: true,
                        version: 'v2.2'
                    });
                };
                $.fn.getXDomain({
                    url: 'http://connect.facebook.net/' + _options.context.locale + '/sdk.js'
                });
            }
            /*if (!_options.context.isDevEnv) {
                window.___gcfg = {
                    lang: _options.context.googlePlusLocale,
                    parsetags: 'onload'
                };
                $.fn.getXDomain({
                    url: 'https://apis.google.com/js/plusone.js'
                });
            }*/
            $pLoading.dialog({
                dialogClass: 'no-close',
                modal: true,
                title: _t('loading'),
                autoOpen: true
            });
            $('.ui-widget-overlay').css({
                backgroundImage: 'none',
                opacity: 0.7
            });
        }

        function _getTarget($elt) {
            return $elt.closest('.converter-container').hasClass('source') ? 'source' : 'destination';
        }

        function _bindConverterPanelEvents() {
            var $snipet = $('a.snippet'),
                offset = 16,
                $converter = $('#converter'),
                $body = $('body');
            $snipet.on('mouseenter', function () {
                $('body').append('<div id="Tip" style="z-index:9999;" class="ui-corner-all"><img src="' + this.href + '" alt="' + this.href + '"><\/div>');
            });
            $snipet.on('mousemove', function (event) {
                $('#Tip')
                    .css({'left': event.pageX + offset, 'top': event.pageY + offset})
                    .show();
            });
            $snipet.on('mouseout', function () {
                $('#Tip').remove();
            });
            $snipet.click(function (event) {
                event.preventDefault();
            });
            $('.search-crs').click(function (event) {
                var target = _getTarget($(this));
                event.preventDefault();
                $('#select').val(target);
                $('#p-research').dialog('open');
            });
            $converter.on('converter.info', _showCrsInfo);
            $converter.on('click', '.show-p-new', function (event) {
                var target = _getTarget($(this));
                event.preventDefault();
                $('#new-form input[name="target"]').val(target);
                $('#p-new').dialog('open');
            });
            $body.on('click', '#view-reference', function (event) {
                var url = 'https://spatialreference.org/ref/?search=' + encodeURIComponent($('#find-reference').val());
                event.preventDefault();
                window.open(url);
            });
            $body.on('submit', '#reference-form', function (event) {
                event.preventDefault();
                $('#view-reference').click();
            });
            $('#crsResult').on('change', function (event) {
                _updateConverterWithSelectedSrs($(event.target).val());
            });
            $('#research').click(function (event) {
                event.preventDefault();
                _goResearch();
            });
            _clipboardJsClient = new ClipboardJS('#converter .octicon-clippy', {
                text: function (trigger) {
                    var $target = $(trigger),
                        $container = $target.closest('.converter-container');
                    if ($container.length) {
                        return $container.converter('value').toString();
                    }
                }
            });
            _clipboardJsClient.on('success', function (event) {
                $(event.trigger).animate({opacity: 0.3}, 500, function () {
                    $(this).animate({opacity: 1}, 500);
                });
                _trigger('clipboard.aftercopy');
            });
        }

        function _startHelp() {
            if (!_isLight) {
                $('#help').animate({opacity: 'hide'}, _SHDelay);
                $('.crs-list').first().btOn();
            }
        }

        function _startHelpIfCookieAllowsIt() {
            if (!_getPreferenceCookie('help-1')) {
                _startHelp();
            }
        }

        function _bindBeautyTipsEvents() {
            $('.close_button, .help-4 .next_button').click(function (event) {
                event.preventDefault();
                $('#help').animate({opacity: 'show'}, _SHDelay);
            });
            $('.next_button').click(function (event) {
                event.preventDefault();
            });
            $('.close_button', '.help-1').click(function () {
                $('.crs-list').first().btOff();
            });
            $('.close_button', '.help-2').click(function () {
                $('.crs-list').last().btOff();
            });
            $('.close_button', '.help-3').click(function () {
                $('.source .container').btOff();
            });
            $('.close_button, .next_button', '.help-4').click(function () {
                $('.source .convert-button').btOff();
            });
            $('.next_button', '.help-1').click(function () {
                $('.crs-list').last().btOn();
            });
            $('.next_button', '.help-2').click(function () {
                $('.source .container').btOn();
            });
            $('.next_button', '.help-3').click(function () {
                $('.source .convert-button').btOn();
            });
            $('.help-1').find('input.dont-show-again').on('change', function () {
                _setPreferenceCookie('help-1', $(this)[0].checked);
            });
            $('#help').click(function () {
                event.preventDefault();
                _startHelp();
            });
        }

        function _bindLanguageEvents() {
            var $ul = $('.dropdown dd ul'),
                $a = $('.dropdown dt a');

            $a.click(function (event) {
                event.preventDefault();
                $ul.slideToggle(200);
            });
            $ul.find('li a').click(function (event) {
                var html, value;
                event.preventDefault();
                html = $(this).html();
                value = $(this).parent().find('span.value').text();
                $a.find('span').html(html);
                $ul.hide();
                document.location.href = $(this).prop('href');
            });
            $(document).click(function (event) {
                var $clicked = $(event.target);
                if (!$clicked.parents().hasClass('dropdown')) {
                    $ul.hide();
                }
            });
        }

        function _setCsvMode(isCsv) {
            _setMode(isCsv);
            _trigger('ui.csv_changed', isCsv);
        }

        function _togglePalette(target, palette) {
            if (!_isLight && $(document).fullScreen()) {
                if ($(palette).is(':hidden')) {
                    $(palette).fadeIn();
                } else if ($(target).closest(palette).length) {
                    clearInterval(_paletteTimer[palette]);
                } else {
                    clearInterval(_paletteTimer[palette]);
                    _paletteTimer[palette] = setTimeout(function () {
                        if ($(document).fullScreen()) {
                            $(palette).fadeOut();
                        }
                    }, 1000);
                }
            }
        }

        function _bindOptionsPanelEvents() {
            $('.convention').click(function (event) {
                event.preventDefault();
                $('#p-convention_help').dialog('open');
            });
            /*$('#print-map').click(function(event) {
                event.preventDefault();
                _options.utils.openStaticMap();
            });*/
            $('#full-screen').click(function (event) {
                event.preventDefault();
                _trigger('ui.full_screen');
            });
            $('#auto-zoom-toggle').click(function () {
                _options.utils.enableAutoZoom($(this).is(':checked'));
            });
            $('input[name="csv"]').click(function () {
                var isCsv = !!+$(this).val();
                _setCsvMode(isCsv);
            });
            $('input[name="convention"]').click(function () {
                _setConvergenceConvention(!!+$(this).val());
            });
            $('body').on('converterset.csv_changed main.ready', function (event, obj) {
                var isCsv = obj.data === undefined ? obj.csv : obj.data.csv;
                _setCsvButtonset(isCsv);
                _setMode(isCsv);
            });
        }

        function _bindOtherPanelsEvents() {
            var $body = $('body');
            $('.toggle-next').click(function (event) {
                event.preventDefault();
                $(this).parent().find('.toogle-me').toggle();
            });
            $(document).on('fullscreenchange', function () {
                _hideAll();
                _togglePalettes();
            });
            $(document).on('mousemove', function (event) {
                _togglePalette(event.target, '.trsp-panel, #converter');
            });
            $body.on('click', '.show-p-poll', function (event) {
                event.preventDefault();
                _showPoll();
            });
            $body.on('mousedown', '#view-map, .donate_btn, .about, converter.info, .convert-button, .contact, .search-crs, .show-p-new', function () {
                _hideAll();
            });
            $body.on('map.metrics_changed', function (event, response) {
                _setMetrics(response.data);
            });
            $body.on('map.tiles_loaded', function () {
                _initAdsenseUi();
            });
            $body.on('converter.changed', function (event, response) {
                _setMagneticDeclination(response.data.magneticDeclinationInDegrees);
            });
            $body.on('converter.convergence_changed', function (event, response) {
                _setSourceConvergence(response.data.convergenceInDegrees.source);
                _setDestConvergence(response.data.convergenceInDegrees.destination);
            });
            $('#p-donate').find('input.dont-show-again').on('change', function () {
                _setPreferenceCookie('p-donate', $(this)[0].checked);
            });
            $('.donate_btn').click(function (event) {
                event.preventDefault();
                $('#p-donate').dialog('open');
            });
            $('.about').click(function (event) {
                event.preventDefault();
                $('#p-about').dialog('open');
            });
            $body.one('main.ready', function () {
                setTimeout(_closeLoading, 800);
                if (_isLight) {
                    _initAdsenseUi();
                }
            });
            $body.on('main.start', _displayLoading);
            $body.on('main.failed', {
                message: ': failure! ' + _t('contactUs'),
                className: 'failure'
            }, function () {
                _displayLoading.apply(this, arguments);
                _closeLoading();
            });
            $body.on('main.succeeded', {
                message: ': success.',
                className: 'success'
            }, function () {
                var $progressBar = $('#p-loading').find('.progressbar'),
                    value = $progressBar.progressbar('value') || 0;
                _displayLoading.apply(this, arguments);
                $progressBar.progressbar('value', value + 100 / 5);
            });
            $body.on('click', '.ui-widget-overlay', function () {
                _hideAll();
            });
        }

        function _bindContactUsEvents(openDialogOnly) {
            $('.contact').click(function (event) {
                event.preventDefault();
                $('#p-contact').dialog('open');
            });
            if (!openDialogOnly) {
                $('#contact-form').on('submit', function (event) {
                    event.preventDefault();
                    $('#send-message').click();
                });
                $('#send-message').click(function (event) {
                    event.preventDefault();
                    $('#p-contact').dialog('close');
                    if (!_validateContactForm()) {
                        return;
                    }
                    _sendEmail();
                });
            }
        }

        function _bindKeysEvents() {
            var ESCAPE_KEY = 27,
                F11_KEY = 122;
            $(document).keyup(function (event) {
                switch (event.keyCode) {
                    case ESCAPE_KEY:
                        event.preventDefault();
                        _hideAll();
                        break;
                    case F11_KEY:
                        event.preventDefault();
                        _trigger('ui.full_screen');
                        break;
                }
            });
        }

        function _setupUiAndListeners() {
            _initConverterUi();
            _initOptionsUi();
            _initBeautyTipsUi();
            _initGeneralUi();
            _bindConverterPanelEvents();
            _bindOptionsPanelEvents();
            _bindBeautyTipsEvents();
            _bindOtherPanelsEvents();
            _bindContactUsEvents();
            _bindLanguageEvents();
            _bindKeysEvents();
        }

        function _closeLoading() {
            var $pLoading = $('#p-loading');
            if ($pLoading.find('.failure').length) {
                $pLoading.closest('.no-close').find('.ui-dialog-titlebar-close').show();
            } else {
                $pLoading.dialog('close');
                if (!_getPreferenceCookie('p-donate') && !_options.context.GET.isSetNoDonate) {
                    $('#p-donate').dialog('open');
                }
            }
            $('.ui-widget-overlay').removeAttr('style');
        }

        function _displayLoading(event, response) {
            var $elt,
                responseData = response.data,
                name = responseData.name,
                $loading = $('#p-loading .logs'),
                className = 'loading-' + name.toLowerCase().replace(/\s/ig, '-'),
                data = event.data,
                message = responseData.message ? ': ' + responseData.message : (data ? data.message : undefined);
            if (!$loading.find('.' + className).length) {
                var html = $('<div>', {class: className}).text('Loading ' + name);
                $loading.append(html);
            }
            $elt = $loading.find('.' + className);
            if (data && message && data.className) {
                if ($elt.length && !$elt.hasClass(data.className)) {
                    $elt.addClass(data.className).append(message);
                }
            }
        }

        function _setMetrics(metrics) {
            if (metrics !== undefined) {
                _setLength(metrics.length);
                _setArea(metrics.area);
            }
        }

        function _setLength(length) {
            var unit = _t('unitMeter'),
                precision = 0;
            if (!length || length === undefined) {
                $('#lengthContainer').text('-' + unit);
            } else {
                if (length > 999) {
                    unit = _t('unitKilometer');
                    length /= 1000;
                    precision = 1;
                }
                $('#lengthContainer').text(_options.math.round(length, precision).toString() + unit);
            }
        }

        function _setArea(area) {
            var unit = _t('unitMeter') + '<sup>2</sup>',
                precision = 0;
            if (!area || area === undefined) {
                $('#areaContainer').html('-' + unit);
            } else {
                if (area > 999999) {
                    unit = _t('unitKilometer') + '<sup>2</sup>';
                    area /= 1000000;
                    precision = 1;
                }
                $('#areaContainer').html(_options.math.round(area, precision).toString() + unit);
            }
        }

        function _goResearch() {
            var $crsResult = $('#crsResult');
            $crsResult
                .html('<option value="#" class="disabledoption">' + _t('loading') + '<\/option>')
                .prop('disabled', true);
            $.post(_options.system.httpServer + '/' + _options.system.dirWsIncludes + 'c.php', {
                l: _options.context.languageCode,
                i: $('#crsCountry').val(),
                c: $('#crsCode').val(),
                n: $('#crsName').val(),
                f: ''
            }).done(function (response) {
                $crsResult.html('');
                if (!$(response).length) {
                    $crsResult.append($('<option>', {
                        val: '',
                        text: _t('resultEmpty'),
                        classname: 'disabledoption'
                    }));
                } else {
                    $crsResult.prop('disabled', false);
                    $.each(response, function (country, obj) {
                        $.each(obj, function (srsCode, crs) {
                            _options.utils.addOptionToSelect(country, srsCode, $('#crsResult'), crs.def);
                        });
                    });
                }
            }).fail(function () {
                $crsResult.html('');
                $crsResult.append($('<option>', {val: '', text: _t('resultEmpty'), classname: 'disabledoption'}));
            });
        }

        function _updateConverterWithSelectedSrs(srsCode) {
            var target = $('#select').val();
            if ($('#closeSearch').prop('checked')) {
                $('#p-research').dialog('close');
            }
            App.TWCCConverter.setSelection(target, srsCode);
        }

        function _getLoadingHtml() {
            return '<div class="loading"><img src="' + _options.system.dirWsImages + 'loading.gif" alt="" width="35" height="35">' + _t('loading') + '<\/div>';
        }

        function _showPoll(hideAll) {
            hideAll = hideAll === undefined ? true : hideAll;
            $('#poll-info').html(_getLoadingHtml());
            if (hideAll) _hideAll();
            $('#p-poll').dialog('open');
            _loadPoll();
        }

        function _loadPoll(serializedValues) {
            serializedValues = serializedValues || '';
            $('#poll-info').html(_getLoadingHtml());
            $.post(_options.system.dirWsModules + 'rater/forms.php', 'rater=true&' + serializedValues, _buildPoll);
        }

        function _buildPoll(response) {
            var $pollInfo = $('#poll-info');
            $pollInfo.html(response);
            $pollInfo.find('form').each(function () {
                $(this).on('submit', function (event) {
                    event.preventDefault();
                    _loadPoll($(this).serialize());
                });
                _bindContactUsEvents(true);
            });
        }

        function _showCrsInfo(event, response) {
            var $crsInfo = $('#crs-info');
            $crsInfo.html(_getLoadingHtml());
            $.post(_options.system.dirWsIncludes + 'crs_info.php', {
                c: response.srsCode,
                d: response.definitionString,
                l: _options.context.languageCode
            }, function (response) {
                $crsInfo.html(response);
            });
            $('#p-crs').dialog('open');
        }

        function _removeAnchorFromAddressBar() {
            window.location.hash = '';
        }

        function _addAnchorToAddressBar(anchor) {
            window.location.hash = '#' + anchor;
        }

        function _getAddressBarAnchor() {
            return window.location.hash.replace('#', '');
        }

        function _validateContactForm() {
            if ($('#message').val().length < 1) {
                alert(_t('messageNotSent') + 'empty msg.');
                $('#p-contact').dialog('open');
                return false;
            }
            if ($('#email').val().length < 1) {
                alert(_t('messageWrongEmail'));
                $('#p-contact').dialog('open');
                return false;
            }
            return true;
        }

        function _sendEmail() {
            _options.utils.sendMsg($('#message').val(), $('#email').val(), _manageResponse);
        }

        function _manageResponse(response) {
            switch (response) {
                case '1':
                    alert(_t('messageSent'));
                    break;
                case '-3':
                    alert(_t('messageWrongEmail'));
                    break;
                default: //-1 & -2
                    alert(_t('messageNotSent') + response);
                    break;
            }
            if (response == '1') {
                $('#email').val('');
                $('#message').val('');
            } else {
                $('#p-contact').dialog('open');
            }
        }

        function _hideAll() {
            $('.crs-list, .source .container, .source .convert-button').each(function () {
                $(this).btOff();
            });
            $('#help').animate({opacity: 'show'}, _SHDelay);
            $('#p-new').dialog('close');
            $('#p-contact').dialog('close');
            $('#p-about').dialog('close');
            $('#p-crs').dialog('close');
            $('#p-poll').dialog('close');
            $('#p-info').dialog('close');
            $('#p-donate').dialog('close');
            $('#p-research').dialog('close');
            $('#p-convention_help').dialog('close');
        }

        function _setPreferenceCookie(prefId, prefValue) {
            _options.utils.setPreferenceCookie(prefId, prefValue);
        }

        function _getPreferenceCookie(prefId) {
            return _options.utils.getPreferenceCookie(prefId);
        }

        function _setCsvButtonset(isCsv) {
            if (isCsv !== _getMode()) {
                $('input[name="csv"][value="' + (+isCsv) + '"]').prop('checked', true);
                $('.csv-radio').buttonset('refresh');
            }
        }

        function _setMode(isCsv) {
            isCsv = !!isCsv;
            $('#manualFeatures').toggle(!isCsv);
            $('#csvFeatures').toggle(isCsv);
            if (isCsv) {
                $('#auto-zoom-toggle').button('enable');
                $('.convention-radio').buttonset('disable');
                _setMetrics();
            } else {
                $('#auto-zoom-toggle').button('disable');
                $('.convention-radio').buttonset('enable');
            }
        }

        function _getMode() {
            return !!+$('input[name="csv"]:checked').val();
        }

        function _setDeclination(selector, angle) {
            let $node = $(selector);
            if (angle) {
                $node.show();
                $(selector + ' .angle').text(_options.math.round(angle, 4).toString());
            } else {
                $node.hide();
            }
        }

        function _setMagneticDeclination(angle) {
            _setDeclination('#magneticDeclinationContainer', angle);
        }

        function _setSourceConvergence(angle) {
            _setDeclination('#sourceConvergenceContainer', angle);
        }

        function _setDestConvergence(angle) {
            _setDeclination('#destConvergenceContainer', angle);
        }

        function _setConvergenceConvention(isSurvey) {
            _convergenceConvention = isSurvey;
            _trigger('ui.convergence_changed');
        }

        function _setHistoryButtons(idx, max) {
            var min = 0,
                enableNextButton = idx < max,
                enablePreviousButton = idx > min;
            $('.previous.history').button('option', 'disabled', !enablePreviousButton);
            $('.next.history').button('option', 'disabled', !enableNextButton);
        }

        function _togglePalettes() {
            if (!_isLight && $(document).fullScreen()) {
                $('.trsp-panel, .spare, #converter, #h-container').fadeOut();
            } else {
                $('.trsp-panel, .spare, #converter, #h-container').fadeIn();
            }
        }

        function _adBlockDetected() {
            _dfd.resolve(_t('pleaseDisableYourAdblock')); //please disable your AdBlock.
        }

        function _adBlockNotDetected() {
            _dfd.resolve();
        }

        function _checkAdBlocker() {
            if (!App.system.adsense.bannerAdsEnabled) {
                _adBlockNotDetected();
            } else {
                var a = window.adsbygoogle;
                if (a && a.loaded) {
                    _adBlockNotDetected();
                } else {
                    _adBlockDetected();
                }
            }
        }


        function _initUI() {
            _dfd = _newDeferred('UI');
            _setupUiAndListeners();
            if (_isLight) {
                _dfd.resolve();
            } else {
                $(window).load(_checkAdBlocker);
            }
        }

        _initUI();
        return {
            promise: _dfd.promise(),
            getConvergenceConvention: function () {
                return _convergenceConvention;
            },
            startHelp: _startHelpIfCookieAllowsIt,
            setCsvMode: _setCsvMode
        };
    }

    // exports
    window.TWCCUi = {
        getInstance: function (opts) {
            instance = instance || init(opts);
            return instance;
        }
    };
})(jQuery, ClipboardJS); // jshint ignore:line
;/**
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 ClÃ©ment Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */

/**
 * Events triggered by TWCCConverter and attached to the body:
 *  - converter.success (obj)
 */


(function ($) {
    "use strict";
    /*global document, window, jQuery, console */

    if (window.TWCCConverter !== undefined) {
        return;
    }

    var instance,
        init = function (opts) {
            var _dfd = null,
                _converterWidget = null,
                _defIdx = 0,
                _options = $.extend(true, {}, opts);

            function _t() {
                return _options.utils.t.apply(this, arguments);
            }

            function _newDeferred() {
                return _options.utils.newDeferred.apply(this, arguments);
            }

            function _getErrorMessage(XMLHttpRequest) {
                return _t('errorContactUs').replace('%s', XMLHttpRequest.status.toString());
            }

            function _checkCRS(value, target) {
                var msg = '',
                    reg = new RegExp("\\+title=[^\\+]+", "i");
                if (value === '') return '';
                value = value.toString().replace(reg, "");
                $.each(_converterWidget.options.definitions, function (country, crs) {
                    $.each(crs, function (srsCode, definition) {
                        var definitionString = definition.def || "";
                        if (srsCode.toUpperCase() == value.toUpperCase() || definitionString.toUpperCase().replace(reg, "") == value.toUpperCase()) {
                            msg = _t('crsAlreadyExists') + country + " > " + (definitionString ? _options.utils.getTitleFromDefinitionString(definitionString, srsCode) : srsCode);
                            _selection(target, srsCode);
                            return false;
                        }
                    });
                    if (msg !== '') return false;
                });
                return msg;
            }

            function _addSystem(definitionString, srsCode) {
                var promise,
                    definition = {'*[UD]': {}};
                definition['*[UD]'][srsCode] = {
                    def: definitionString,
                    isConnector: false
                };
                promise = _converterWidget.mergeDefinitions(definition);
                return promise;
            }

            function _alertPNew(checkMsg, failed) {
                alert(checkMsg);
                $('#loadingxtra').hide();
                $('#new-form').show();
                if (!failed) {
                    $('#p-new').dialog("close");
                    $('#find-reference').val('');
                    $('#add-reference').val('');
                } else {
                    _defIdx--;
                }
            }

            function _getThirdPartyUrl(srsCode, baseUrl, toUpperCase) {
                var params = srsCode.split(':');
                toUpperCase = toUpperCase || false;
                return baseUrl.replace(/\$\{\d\}/ig, function (index) {
                    index = index.match(/\d+/)[0];
                    var value = params[index] || index;
                    return toUpperCase ? value.toUpperCase() : value.toLowerCase();
                });
            }

            function _loadProj4jsFormat(srsCode, method, options) {
                method(options).done(function (def) {
                    _addNewReference(def);
                }).fail(function (jqXHR) {
                    _alertPNew(_getErrorMessage(jqXHR), true);
                });
            }

            function _addSpatialReferenceDefinition(srsCode) {
                var url = _getThirdPartyUrl(srsCode, 'https://spatialreference.org/ref/${0}/${1}/proj4.txt');
                window.Proj4js = {defs: {}};
                _loadProj4jsFormat(srsCode, $.fn.getXDomain, {
                    url: url,
                    dataType: 'text'
                });
            }

            function _addLocalDefinition(srsCode) {
                var url = _getThirdPartyUrl(srsCode, '/js/data/defs/${0}${1}.js', true);
                _loadProj4jsFormat(srsCode, $.ajax, {
                    url: url,
                    cache: true,
                    dataType: 'script'
                });
            }

            function _addNewReference(defData) {
                var title, srsCode, defMatch, checkMsg, newTitle,
                    target = $("#new-form input[name='target']").val(),
                    DEFDATA = defData.toUpperCase(),
                    isEpsg = DEFDATA.indexOf("EPSG:") === 0,
                    isEsri = DEFDATA.indexOf("ESRI:") === 0,
                    isIau = DEFDATA.indexOf("IAU2000:") === 0,
                    isSrOrg = DEFDATA.indexOf("SR-ORG:") === 0,
                    isIgnf = DEFDATA.indexOf("IGNF:") === 0;
                $('#new-form').hide();
                $('#loadingxtra').show();
                checkMsg = _checkCRS(defData, target);
                if (checkMsg) {
                    _alertPNew(checkMsg);
                    return;
                }
                if (isEpsg || isEsri || isIau || isSrOrg) {
                    srsCode = DEFDATA;
                    _addSpatialReferenceDefinition(srsCode);
                } else if (isIgnf) {
                    srsCode = DEFDATA;
                    _addLocalDefinition(srsCode);
                } else {
                    defMatch = defData.match(new RegExp("^[^\\[]+\\[\"([^\\]]+)\"\\][\\s=]+\"([^\"]+)\";$", "i"));
                    if (defMatch !== null) {
                        defData = defMatch[2];
                    }
                    title = _options.utils.getTitleFromDefinitionString(defData, '');
                    _defIdx++;
                    srsCode = 'UD' + _defIdx;
                    if (title === undefined) {
                        title = _t('undefinedTitle');
                        defData = '+title=' + title + ' ' + defData;
                    }
                    newTitle = srsCode + ' ' + title;
                    defData = defData.replace('+title=' + title, '+title=' + newTitle);
                    checkMsg = _checkCRS(srsCode, target);
                    if (!checkMsg) {
                        checkMsg = _checkCRS(defData, target);
                    }
                    if (checkMsg) {
                        _alertPNew(checkMsg);
                        return;
                    }
                    _addSystem(defData, srsCode).done(function () {
                        $('#loadingxtra').hide();
                        $('#new-form').show();
                        var currentSelection = _selection(target);
                        try {
                            _selection(target, srsCode);
                            alert(_t('newSystemAdded') + '"' + newTitle + '".');
                            $('#p-new').dialog("close");
                            $('#find-reference').val('');
                            $('#add-reference').val('');
                            _options.utils.sendMsg('New user-defined system:\n\r' + srsCode + ' = "' + defData + '"');
                        } catch (e) {
                            _defIdx--;
                            _selection(target, currentSelection);
                            _unload(srsCode);
                            if (defData === '') {
                                alert((_t('errorContactUs')).replace('%s', '-2 (NotFound)'));
                            } else {
                                alert((_t('errorContactUs')).replace('%s', '-1 (WrongFormat:' + defData + ')'));
                            }
                        }
                    });
                }
            }

            function _unload(srsCode) {
                _converterWidget.unloadCRS(srsCode);
            }

            function _selection(target, srsCode) {
                target = target.toLowerCase();
                var pushPull = 'pushPull' + target.charAt(0).toUpperCase() + target.slice(1);
                return _converterWidget[pushPull]('selection', srsCode);
            }

            function _initConverter() {
                var converterContext = _options.context.converter,
                    sourceSrsCode = converterContext.defaultSourceSrs,
                    destinationSrsCode = converterContext.defaultDestSrs,
                    wgs84 = converterContext.defaultWgs84,
                    wgs84IsValid = !(wgs84 === '' || wgs84.x === '' || wgs84.y === ''),
                    $converter = $('#converter'),
                    $body = $('body'),
                    converterOptions = {
                        units: {
                            dms: {D: _t('unitDegree'), M: _t('unitMinute'), S: _t('unitSecond')},
                            dd: {x: {DD: _t('unitDegreeEast')}, y: {DD: _t('unitDegreeNorth')}},
                            cartesian: {
                                XY: {m: _t('unitMeter'), km: _t('unitKilometer'), 'us-ft': _t('unitFeet')},
                                CONVERGENCE: _t('unitDegree')
                            }
                        },
                        labels: {
                            spherical: {x: _t('labelLng'), y: _t('labelLat'), convergence: _t('labelConvergence')},
                            cartesian: {
                                x: _t('labelX'),
                                y: _t('labelY'),
                                z: _t('labelZone'),
                                h: _t('labelHemi'),
                                convergence: _t('labelConvergence')
                            },
                            csv: {csv: _t('labelCsv'), l: _t('labelFormat')}
                        },
                        options: {
                            x: {E: _t('optionE'), W: _t('optionW')},
                            y: {N: _t('optionN'), S: _t('optionS')},
                            o: {_DMS: _t('optionDMS'), _DM: _t('optionDM'), _DD: _t('optionDD')},
                            h: {n: _t('optionNorth'), s: _t('optionSouth')},
                            u: {_M: _t('optionM'), _KM: _t('optionKM'), _F: _t('optionF')}
                        }
                    };

                if (converterContext.fromUrl && !wgs84IsValid) {
                    alert('Invalid URL');
                }
                wgs84 = (converterContext.fromUrl && wgs84IsValid) ? [wgs84] : converterContext.fromRss ? [{
                    x: 10,
                    y: 10
                }] : null;
                _options.context.converter.fromUrl = false;
                _options.context.converter.fromRss = false;
                _dfd = _newDeferred('Converter');
                _converterWidget = $converter.converterSet({
                    units: converterOptions.units,
                    labels: converterOptions.labels,
                    options: converterOptions.options,
                    wgs84: wgs84,
                    defaultWgs84: [_options.utils.getRandomCityLocation()],
                    value: {x: 0, y: 0},
                    selections: {
                        source: sourceSrsCode,
                        destination: destinationSrsCode
                    },
                    url: _options.system.httpServer + '/' + _options.system.dirWsIncludes + 'c.php'
                }).data('twccConverterSet');
                $converter.one('converterset.done', function (event, data) {
                    _dfd.resolve(data);
                });
                $converter.on('converterset.fail', function (event, data) {
                    var errorMessage = _getErrorMessage.call(null, data);
                    alert(errorMessage);
                });
                $body.on('click', '#new-reference', function (event) {
                    event.preventDefault();
                    var defData = $('#add-reference').val();
                    _addNewReference(defData);
                });
                $body.on('submit', '#new-form', function (event) {
                    event.preventDefault();
                    $('#new-reference').click();
                });
                $body.on('ui.convergence_changed', function () {
                    _converterWidget.setConvergence();
                });
                $body.on('ui.csv_changed', function (evt, response) {
                    _converterWidget.csv(response.data);
                });
                $('.to-remove').remove();
            }

            _initConverter();
            return {
                promise: _dfd.promise(),
                converterWidget: _converterWidget,
                setSelection: _selection
            };
        };

    // exports
    window.TWCCConverter = {
        getInstance: function (opts) {
            instance = instance || init(opts);
            return instance;
        }
    };
})(jQuery);;/**
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 ClÃ©ment Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */
(function(window, document, $, App) {
    "use strict";
    /*global ga */

    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments);
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-17790812-2', 'auto');
    ga('send', 'pageview');

    $(document).ready(function() {

        function trackEvent(category, action, opt_label, opt_quantity) {
            try {
                ga('send', 'event', category, action, opt_label, opt_quantity);
            } catch (err) {
            }
            }

        function trackTiming(category, variable, timeMs, opt_label) {
            try {
                ga('send', 'timing', category, variable, timeMs, opt_label);
            } catch (err) {
            }
        }

        function trackMainFailure(evt, obj) {
            trackEvent('main', 'fails', obj.data.name);
        }

        function trackXhrFailure(evt, obj) {
            trackEvent('xhr', 'fails', obj.data);
        }

        function trackMapLayerChange(evt, obj) {
            trackEvent('layer', 'change', obj.data);
        }

        function trackSelect(evt) {
            var $select = $(evt.target),
                crs = $select.find('option:selected').text();
            trackEvent('select', 'change', crs);
        }

        function trackDynamicRadio(evt) {
            var $radio = $(evt.target),
                value = $radio.val();
            trackEvent('radio', 'click', value);
        }

        function trackStaticRadio(evt) {
            var $radio = $(evt.target),
                name = $radio.prop('name');
            trackEvent('radio', 'click', name);
        }

        function trackClipboardClick() {
            trackEvent('clipboard', 'click');
        }

        function trackClipboardSuccess() {
            trackEvent('clipboard', 'success');
        }

        function trackConverterChanged() {
            trackEvent('converter', 'changed');
        }

        function trackLoadingTime() {
            var endTime = new Date().getTime(),
                timeSpent = endTime - App.context.startTime;
            trackTiming('TWCC', 'Render infowindow', timeSpent);
            trackEvent('infowindow', 'opened');
        }

        function init() {
            var $body = $('body');
            $body.on('change', '.crs-list', trackSelect);
            $body.on('click', '#converter input[type="radio"]', trackDynamicRadio);
            $body.on('click', '#o-container input[type="radio"]', trackStaticRadio);
            $body.on('click', '.octicon-clippy', trackClipboardClick);
            $body.on('clipboard.aftercopy', trackClipboardSuccess);
            $body.on('converter.changed', trackConverterChanged);
            $body.on('xhr.failed', trackXhrFailure);
            $body.on('map.layer.change', trackMapLayerChange);
            $body.one('infowindow.dom_ready', trackLoadingTime);
            $body.one('main.failed', trackMainFailure);
            $body.one('main.ready', function (event, obj) {
                var isCsv = obj.data === undefined ? obj.csv : obj.data.csv;
                if (isCsv) {
                    $body.off('infowindow.dom_ready', trackLoadingTime);
                }
            });
        }

        init();
    });
})(window, document, jQuery, App); // jshint ignore:line