/*!  * TWCC - Version 2.2.0
 * The World Coordinate Converter
 * Author: Clément Ronzon - clem.rz@gmail.com
 * Build date: 2020-05-27 22:10:18
 * Copyright (c) 2020 
 * Released under the AGPL-3.0 license
 *
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 Clément Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */
function d(a){var b,c;return this.length?(b=this[0],b.ownerDocument?c=b.ownerDocument:(c=b,b=c.documentElement),null==a?c.cancelFullScreen||c.webkitCancelFullScreen||c.mozCancelFullScreen?(a=!!c.fullScreen||!!c.webkitIsFullScreen||!!c.mozFullScreen,a?c.fullScreenElement||c.webkitCurrentFullScreenElement||c.mozFullScreenElement||a:a):null:(a?(a=b.requestFullScreen||b.webkitRequestFullScreen||b.mozRequestFullScreen)&&a.call(b,Element.ALLOW_KEYBOARD_INPUT):(a=c.cancelFullScreen||c.webkitCancelFullScreen||c.mozCancelFullScreen)&&a.call(c),this)):this}function cof2Obj(a){"use strict";var b,c,d,e,f,g=a.split("\n"),h=[];for(b in g)g.hasOwnProperty(b)&&(c=g[b].replace(/^\s+|\s+$/g,"").split(/\s+/),3===c.length?(d=parseFloat(c[0]),e=c[1],f=c[2]):6===c.length&&h.push({n:parseInt(c[0],10),m:parseInt(c[1],10),gnm:parseFloat(c[2]),hnm:parseFloat(c[3]),dgnm:parseFloat(c[4]),dhnm:parseFloat(c[5])}));return{epoch:d,model:e,modelDate:f,wmm:h}}function geoMagFactory(a){"use strict";function b(a){return a*(180/Math.PI)}function c(a){return a*(Math.PI/180)}var d,e,f,g,h,i,j,k=a.epoch,l=[0,0,0,0,0,0,0,0,0,0,0,0,0],m=12,n=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],o=l.slice(),p=l.slice(),q=l.slice(),r=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],s=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],t=6378.137,u=6356.7523142,v=6371.2,w=t*t,x=u*u,y=w-x,z=w*w,A=x*x,B=z-A,C=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],D=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],E=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],F=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice(),l.slice()],G=[0,2,3,4,5,6,7,8,9,10,11,12,13],H=[0,1,2,3,4,5,6,7,8,9,10,11,12];n[0][0]=0,o[0]=0,p[0]=1,q[0]=1,r[0][0]=1,e=a.wmm;for(d in e)e.hasOwnProperty(d)&&e[d].m<=e[d].n&&(C[e[d].m][e[d].n]=e[d].gnm,D[e[d].m][e[d].n]=e[d].dgnm,0!==e[d].m&&(C[e[d].n][e[d].m-1]=e[d].hnm,D[e[d].n][e[d].m-1]=e[d].dhnm));for(a=null,e=null,E[0][0]=1,f=1;f<=m;f++)for(E[0][f]=E[0][f-1]*(2*f-1)/f,h=2,g=0,j=f-g+1;j>0;j--,g++)F[g][f]=((f-1)*(f-1)-g*g)/((2*f-1)*(2*f-3)),g>0&&(i=(f-g+1)*h/(f+g),E[g][f]=E[g-1][f]*Math.sqrt(i),h=1,C[f][g-1]=E[g][f]*C[f][g-1],D[f][g-1]=E[g][f]*D[f][g-1]),C[g][f]=E[g][f]*C[g][f],D[g][f]=E[g][f]*D[g][f];return F[1][1]=0,function(a,d,e,h){function i(a){a=a||new Date;var b=a.getFullYear(),c=365+(b%400==0||b%4==0&&b%100>0?1:0),d=24*c*60*60*1e3;return a.getFullYear()+(a.valueOf()-new Date(b,0).valueOf())/d}var j,l,t,u,A,E,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=e/3280.8399||0,aa=i(h),ba=aa-k,ca=c(a),da=c(d),ea=Math.sin(da),fa=Math.sin(ca),ga=Math.cos(da),ha=Math.cos(ca),ia=fa*fa,ja=ha*ha,ka=0,la=0,ma=0,na=0;for(o[1]=ea,p[1]=ga,j=Math.sqrt(w-y*ia),l=_*j,t=(l+w)/(l+x)*((l+w)/(l+x)),u=fa/Math.sqrt(t*ja+ia),A=Math.sqrt(1-u*u),E=_*_+2*l+(z-B*ia)/(j*j),I=Math.sqrt(E),J=Math.sqrt(w*ja+x*ia),K=(_+J)/I,L=y*ha*fa/(I*J),g=2;g<=m;g++)o[g]=o[1]*p[g-1]+p[1]*o[g-1],p[g]=p[1]*p[g-1]-o[1]*o[g-1];for(M=v/I,N=M*M,f=1;f<=m;f++)for(N*=M,g=0,S=f+g+1;S>0;S--,g++)f===g?(r[g][f]=A*r[g-1][f-1],s[g][f]=A*s[g-1][f-1]+u*r[g-1][f-1]):1===f&&0===g?(r[g][f]=u*r[g][f-1],s[g][f]=u*s[g][f-1]-A*r[g][f-1]):f>1&&f!==g&&(g>f-2&&(r[g][f-2]=0),g>f-2&&(s[g][f-2]=0),r[g][f]=u*r[g][f-1]-F[g][f]*r[g][f-2],s[g][f]=u*s[g][f-1]-A*r[g][f-1]-F[g][f]*s[g][f-2]),n[g][f]=C[g][f]+ba*D[g][f],0!==g&&(n[f][g-1]=C[f][g-1]+ba*D[f][g-1]),O=N*r[g][f],0===g?(P=n[g][f]*p[g],Q=n[g][f]*o[g]):(P=n[g][f]*p[g]+n[f][g-1]*o[g],Q=n[g][f]*o[g]-n[f][g-1]*p[g]),la-=N*P*s[g][f],ma+=H[g]*Q*O,ka+=G[f]*P*O,0===A&&1===g&&(q[f]=1===f?q[f-1]:u*q[f-1]-F[g][f]*q[f-2],R=N*q[f],na+=H[g]*Q*R);return ma=0===A?na:ma/A,T=-la*K-ka*L,U=ma,V=la*L-ka*K,W=Math.sqrt(T*T+U*U),X=Math.sqrt(W*W+V*V),Y=b(Math.atan2(U,T)),Z=b(Math.atan2(V,W)),Math.abs(a)>=55&&(a>0&&d>=0?$=Y-d:a>0&&d<0?$=Y+Math.abs(d):a<0&&d>=0?$=Y+d:a<0&&d<0&&($=Y-Math.abs(d)),$>180?$-=360:$<-180&&($+=360)),{dec:Y,dip:Z,ti:X,bh:W,bx:T,by:U,bz:V,lat:a,lon:d,gv:$,epoch:k}}}!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.ClipboardJS=b():a.ClipboardJS=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.i=function(a){return a},b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=3)}([function(a,b,c){var d,e,f;!function(g,h){e=[a,c(7)],d=h,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)}(0,function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(a){return a&&a.__esModule?a:{default:a}}(b),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(){function a(b){c(this,a),this.resolveOptions(b),this.initSelection()}return f(a,[{key:"resolveOptions",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=a.action,this.container=a.container,this.emitter=a.emitter,this.target=a.target,this.text=a.text,this.trigger=a.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var a=this,b="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return a.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[b?"right":"left"]="-9999px";var c=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=c+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,d.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,d.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var a=void 0;try{a=document.execCommand(this.action)}catch(b){a=!1}this.handleResult(a)}},{key:"handleResult",value:function(a){this.emitter.emit(a?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=a,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(a){if(void 0!==a){if(!a||"object"!==(void 0===a?"undefined":e(a))||1!==a.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&a.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(a.hasAttribute("readonly")||a.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=a}},get:function(){return this._target}}]),a}();a.exports=g})},function(a,b,c){function d(a,b,c){if(!a&&!b&&!c)throw new Error("Missing required arguments");if(!h.string(b))throw new TypeError("Second argument must be a String");if(!h.fn(c))throw new TypeError("Third argument must be a Function");if(h.node(a))return e(a,b,c);if(h.nodeList(a))return f(a,b,c);if(h.string(a))return g(a,b,c);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function e(a,b,c){return a.addEventListener(b,c),{destroy:function(){a.removeEventListener(b,c)}}}function f(a,b,c){return Array.prototype.forEach.call(a,function(a){a.addEventListener(b,c)}),{destroy:function(){Array.prototype.forEach.call(a,function(a){a.removeEventListener(b,c)})}}}function g(a,b,c){return i(document.body,a,b,c)}var h=c(6),i=c(5);a.exports=d},function(a,b){function c(){}c.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){function d(){e.off(a,d),b.apply(c,arguments)}var e=this;return d._=b,this.on(a,d,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;f<g;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}},a.exports=c},function(a,b,c){var d,e,f;!function(g,h){e=[a,c(0),c(2),c(1)],d=h,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)}(0,function(a,b,c,d){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function i(a,b){var c="data-clipboard-"+a;if(b.hasAttribute(c))return b.getAttribute(c)}var j=e(b),k=e(c),l=e(d),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),o=function(a){function b(a,c){f(this,b);var d=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.resolveOptions(c),d.listenClick(a),d}return h(b,a),n(b,[{key:"resolveOptions",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof a.action?a.action:this.defaultAction,this.target="function"==typeof a.target?a.target:this.defaultTarget,this.text="function"==typeof a.text?a.text:this.defaultText,this.container="object"===m(a.container)?a.container:document.body}},{key:"listenClick",value:function(a){var b=this;this.listener=(0,l.default)(a,"click",function(a){return b.onClick(a)})}},{key:"onClick",value:function(a){var b=a.delegateTarget||a.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new j.default({action:this.action(b),target:this.target(b),text:this.text(b),container:this.container,trigger:b,emitter:this})}},{key:"defaultAction",value:function(a){return i("action",a)}},{key:"defaultTarget",value:function(a){var b=i("target",a);if(b)return document.querySelector(b)}},{key:"defaultText",value:function(a){return i("text",a)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],b="string"==typeof a?[a]:a,c=!!document.queryCommandSupported;return b.forEach(function(a){c=c&&!!document.queryCommandSupported(a)}),c}}]),b}(k.default);a.exports=o})},function(a,b){function c(a,b){for(;a&&a.nodeType!==d;){if("function"==typeof a.matches&&a.matches(b))return a;a=a.parentNode}}var d=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}a.exports=c},function(a,b,c){function d(a,b,c,d,e){var g=f.apply(this,arguments);return a.addEventListener(c,g,e),{destroy:function(){a.removeEventListener(c,g,e)}}}function e(a,b,c,e,f){return"function"==typeof a.addEventListener?d.apply(null,arguments):"function"==typeof c?d.bind(null,document).apply(null,arguments):("string"==typeof a&&(a=document.querySelectorAll(a)),Array.prototype.map.call(a,function(a){return d(a,b,c,e,f)}))}function f(a,b,c,d){return function(c){c.delegateTarget=g(c.target,b),c.delegateTarget&&d.call(a,c)}}var g=c(4);a.exports=e},function(a,b){b.node=function(a){return void 0!==a&&a instanceof HTMLElement&&1===a.nodeType},b.nodeList=function(a){var c=Object.prototype.toString.call(a);return void 0!==a&&("[object NodeList]"===c||"[object HTMLCollection]"===c)&&"length"in a&&(0===a.length||b.node(a[0]))},b.string=function(a){return"string"==typeof a||a instanceof String},b.fn=function(a){return"[object Function]"===Object.prototype.toString.call(a)}},function(a,b){function c(a){var b;if("SELECT"===a.nodeName)a.focus(),b=a.value;else if("INPUT"===a.nodeName||"TEXTAREA"===a.nodeName){var c=a.hasAttribute("readonly");c||a.setAttribute("readonly",""),a.select(),a.setSelectionRange(0,a.value.length),c||a.removeAttribute("readonly"),b=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var d=window.getSelection(),e=document.createRange();e.selectNodeContents(a),d.removeAllRanges(),d.addRange(e),b=d.toString()}return b}a.exports=c}])}),function(a){"use strict";if(void 0===window.TWCCHistory){var b,c=function(b){function c(a){var b,d;if(null===a||"object"!=typeof a)return a;b=a.constructor();for(d in a)a.hasOwnProperty(d)&&(b[d]=c(a[d]));return b}function d(){u=w.utils.getCookieContent(y),a.isEmptyObject(u)&&(u=[]),j(i())}function e(){return u}function f(){w.utils.setCookieContent(y,e())}function g(a){u=a}function h(a){x=a}function i(){return e().length-1}function j(b){v=Math.min(Math.abs(b),A),w.utils.trigger(a("body"),"history.indexchanged",{currentIndex:b,maxIndex:i(),currentValue:l()})}function k(){j(i())}function l(){return e()[v]}function m(a){u.push(a)}function n(a){return j(a),l()}function o(){g(e().slice(z,v+1))}function p(){g(e().slice(-A))}function q(a){x&&a&&(a.wgs84=c(a.wgs84),JSON.stringify(a)!==JSON.stringify(l())&&(o(),m(a),p(),k(),f()))}function r(){return v>z?n(v-1):l()}function s(){return v<i()?n(v+1):l()}function t(){d()}var u,v,w=a.extend(!0,{},b),x=!0,y=w.system.historyCookie,z=0,A=w.system.historyLimit;return t(),{toggle:h,isEnabled:function(){return x},add:q,moveToPrevious:r,moveToNext:s,getCurrentValue:l}};window.TWCCHistory={getInstance:function(a){return b=b||c(a)}}}}(jQuery),function(a,b){"use strict";function c(c,e,g){var h=new a.Deferred(function(){f(a("body"),"main.start",{name:c})});return e=e||b.system.timeout,g=g||0,setTimeout(function a(){g>0?(g--,h.notify("retry"),setTimeout(a,e)):h.reject(c+" timed out")},e),setTimeout(function a(){"pending"===h.state()&&(h.notify(c+" pending"),setTimeout(a,500))},1),d(h,c),h}function d(b,c){a.when(b).then(function(){f(a("body"),"main.succeeded",{name:c})},function(b){f(a("body"),"main.failed",{name:c,message:b})},function(b){f(a("body"),"main.progress",{name:c,message:b})})}function e(a){return b.translations.hasOwnProperty(a)?b.translations[a]:a}function f(a,b,c){a.trigger(b,{data:c})}function g(c,d,f){var g,h;return d=d||b.system.applicationNoreply,h=b.system.httpServer+"/"+b.system.dirWsIncludes+"s.php",g=a.ajax({type:"POST",url:h,async:!1,cache:!1,data:"ff=g"}).responseText,g.length<10?(alert(e("messageNotSent")+g),!1):(i(b.system.tokenName,g),a.post(h,{ff:"d",f:d,b:c,l:b.context.languageCode},function(a){"function"==typeof f&&f(a)}),!0)}function h(b){return a.cookie(b)}function i(b,c,d){d=d||30,a.cookie(b,c,{expires:d})}function j(a,b,c){i(a,JSON.stringify(b),c)}function k(b){return h(b)?a.parseJSON(h(b)):{}}function l(a,b,c,d){var e=k(a);e[b]=c,j(a,e,d)}function m(a,b){return k(a)[b]}function n(a,c){l(b.system.preferencesCookie,a,c,7)}function o(a){return m(b.system.preferencesCookie,a)}function p(b,c,d,e){var f=proj4.defs(c),g=f?f.title||c:r(e,c),h='optgroup[label="'+b+'"]';d.find(h).length||d.append(a("<optgroup>",{label:b})),d.find(h).append(a("<option>",{val:c,text:g}))}function q(){var b=a("#map");b.on("linestring.edit_end",function(a,b){u(b.data)}),b.on("map.click",function(a,b){v(b.data)}),b.on("marker.drag_end",function(a,b){v(b.data)}),b.on("linestring.add_vertice",function(a,b){if(y()){var c=t();c.push(x(b.data)),w(c)}}),b.on("linestring.remove_vertice",function(a,b){if(y()){var c=x(b.data);w(t().filter(function(a){return!(a.x===c.x&&a.y===c.y)}))}}),b.on("place.changed",function(a,b){v(b.data)}),b.on("map.layer.change",function(a,b){var c=b.data.split(" "),d=o("layers")||{};c.indexOf("on")>-1||c.indexOf("off")>-1?(d.hasOwnProperty("opt")||(d.opt={}),d.opt[c[1]]="on"===c[2]):(d.base={},d.base[c[0]]=c[1]),n("layers",d)})}function r(a,b){var c=/\+title=/gi,d=/.*\+title=([^\+]+).*/gi;return c.test(a)?a.replace(d,"$1"):b}function s(){var a=b.math.getRandomInteger(0,J.length-1);return{x:J[a].lng,y:J[a].lat}}function t(){return H.wgs84().slice()}function u(a){y()||b.TWCCUi.setCsvMode(!0),w(a.map(x))}function v(a){w([x(a)])}function w(a){H.transform({wgs84:a})}function x(a){return{x:a[0],y:a[1]}}function y(){return H.csv()}function z(){return b.TWCCUi.getConvergenceConvention()}function A(a){b.TWCCMap.model.setBoolean("autoZoom",a)}function B(){return I}function C(b){var c;switch(a.type(b)){case"object":c={},a.each(b,function(b,d){if(d&&"number"!==a.type(d))throw"Wrong data type";c[b]=C(d)});break;case"number":c="number"===a.type(b)?b*Math.PI/180:void 0}return c}function D(b){return"number"===a.type(b)?180*b/Math.PI:void 0}function E(){var c="*GPS (WGS84) (deg)",d={title:c,defData:"+title="+c+" +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees",isConnector:!1};"function"!==a.type(Math.sinh)&&(Math.sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2}),a.ajax({url:"/js/data/WMM.COF",cache:!0,dataType:"text"}).done(function(a){I=geoMagFactory(cof2Obj(a))}).fail(function(){I=function(){return{}}}),a.extend(proj4.WGS84,d),a.extend(proj4.defs("WGS84"),d),b.initialisers.initializeUi().done(F)}function F(){b.initialisers.initializeMap().done(G)}function G(){b.initialisers.initializeConverter().done(function(c){b.context.GET.isSetGraticule&&b.TWCCMap.setGraticule(),b.TWCCUi.startHelp(),f(a("body"),"main.ready",c)})}var H,I,J=b.locations.capitals;a.fn.extend({sort:function(){return this.pushStack([].sort.apply(this,arguments),[])},sortOptions:function(a){return jQuery("option",this).sort(a).appendTo(this),this},sortGroups:function(a){return jQuery("optgroup",this).sort(a).appendTo(this),this},sortOptionsByText:function(){return this.sortOptions(function(a,b){var c=jQuery(a).text().toUpperCase(),d=jQuery(b).text().toUpperCase();return c<d?-1:c>d?1:0})},sortOptgroupsByLabel:function(){return this.sortGroups(function(a,b){var c=jQuery(a).prop("label").toUpperCase(),d=jQuery(b).prop("label").toUpperCase();return c<d?-1:c>d?1:0})},sortGrpsNOptionsByText:function(){var b=this;return a("optgroup",this).each(function(c){a("optgroup:eq("+c+")",b).sortOptionsByText()}),this.sortOptgroupsByLabel()},getXDomain:function(c){var d=b.system.httpServer+"/"+b.system.dirWsIncludes+"proxy.php",e=c.data?"?"+a.param(c.data,!0):"";return a.ajax(a.extend({dataType:"script"},c,{url:d,cache:!0,data:{u:c.url+e}}))}}),a.extend(b,{utils:{addOptionToSelect:p,degToRad:C,enableAutoZoom:A,getConvergenceConvention:z,getCookieContent:k,getPreferenceCookie:o,getRandomCityLocation:s,getTitleFromDefinitionString:r,getWMM:B,newDeferred:c,radToDeg:D,sendMsg:g,setCookie:i,setCookieContent:j,setPreferenceCookie:n,t:e,trigger:f}}),a.extend(b,{constants:{keyboard:{RETURN:13}}}),a.extend(b,{Class:function(a){var b=function(){this.initialize.apply(this,arguments)};for(var c in a)a.hasOwnProperty(c)&&(b.prototype[c]=a[c]);return b.prototype.initialize=b.prototype.initialize||function(){},b}}),a.extend(b,{initialisers:{initializeMap:function(){var c=a.extend(!0,{},b,b.TWCCMapOptions);return delete c.TWCCMapOptions,b.TWCCMap=window.TWCCMap.getInstance(c),b.map=b.TWCCMap.getMap(),q(),b.TWCCMap.promise},initializeUi:function(){var c=a.extend(!0,{},b);return b.TWCCUi=window.TWCCUi.getInstance(c),b.TWCCUi.promise},initializeConverter:function(){var c=a.extend(!0,{},b,b.TWCCConverterOptions);return delete c.TWCCConverterOptions,b.TWCCConverter=window.TWCCConverter.getInstance(c),H=b.TWCCConverter.converterWidget,b.TWCCConverter.promise}}}),a(document).ready(E)}(jQuery,App),function(a,b){"use strict";function c(a,b){var c,d,e;return c=b-a,d=a,e=Math.random()*c+d,Math.round(e)}function d(a,b){var c;return b=void 0===b?0:b,c=a.toString(),""===c||"NaN"==c?"":Math.round(e(a)*Math.pow(10,e(b)))/Math.pow(10,e(b))}function e(a){return a=a.toString().replace(/,/gi,"."),isNaN(a)&&(a=0),parseFloat(a)}a.extend(b,{math:{getRandomInteger:c,round:d,parseFloat:e}})}(jQuery,App),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(a){return a&&a.constructor===Number?a+"px":a}a.fn.bgiframe=function(c){if(c=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;",conditional:/MSIE 6\.0/.test(navigator.userAgent)},c),!a.isFunction(c.conditional)){var d=c.conditional;c.conditional=function(){return d}}var e=a('<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+c.src+'"style="display:block;position:absolute;z-index:-1;"/>');return this.each(function(){var d=a(this);if(!1!==c.conditional(this)){var f=d.children("iframe.bgiframe"),g=0===f.length?e.clone():f;g.css({top:"auto"==c.top?-1*(parseInt(d.css("borderTopWidth"),10)||0)+"px":b(c.top),left:"auto"==c.left?-1*(parseInt(d.css("borderLeftWidth"),10)||0)+"px":b(c.left),width:"auto"==c.width?this.offsetWidth+"px":b(c.width),height:"auto"==c.height?this.offsetHeight+"px":b(c.height),opacity:!0===c.opacity?0:void 0}),0===f.length&&d.prepend(g)}})},a.fn.bgIframe=a.fn.bgiframe}),jQuery.bt={version:"0.9.5-rc1"},function($){jQuery.fn.bt=function(content,options){function drawIt(a,b){for(this.moveTo(a[0].x,a[0].y),i=1;i<a.length;i++)"arcStart"==a[i-1].type?(this.quadraticCurveTo(round5(a[i].x,b),round5(a[i].y,b),round5(a[(i+1)%a.length].x,b),round5(a[(i+1)%a.length].y,b)),i++):this.lineTo(round5(a[i].x,b),round5(a[i].y,b))}function round5(a,b){return b=numb(b),b%2?a:Math.round(a-.5)+.5}function numb(a){return parseInt(a)||0}function arrayRemove(a,b){var c,d=new Array;for(c in a)a[c]!=b&&d.push(a[c]);return d}function canvasSupport(){var a=!1;try{a=!!document.createElement("canvas").getContext("2d")}catch(b){a=!!document.createElement("canvas").getContext}return a}function shadowSupport(){try{var a=navigator.userAgent.toLowerCase();if(/webkit/.test(a))return!0;if(/gecko|mozilla/.test(a)&&parseFloat(a.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1)return!0}catch(a){}return!1}function betweenPoint(a,b,c){var d,e;return a.x==b.x?(d=a.y<b.y?a.y+c:a.y-c,{x:a.x,y:d}):a.y==b.y?(e=a.x<b.x?a.x+c:a.x-c,{x:e,y:a.y}):void 0}function centerPoint(a,b,c){var d,e,f=b.x==a.x?c.x:a.x,g=b.y==a.y?c.y:a.y;return a.x<c.x?a.y>c.y?(d=Math.PI/180*180,e=Math.PI/180*90):(d=Math.PI/180*90,e=0):a.y>c.y?(d=Math.PI/180*270,e=Math.PI/180*180):(d=0,e=Math.PI/180*270),{x:f,y:g,type:"center",startAngle:d,endAngle:e}}function findIntersect(a,b,c,d,e,f,g,h){if(e==g)return findIntersectY(a,b,c,d,e);if(f==h)return findIntersectX(a,b,c,d,f);var i=(b-d)/(a-c),j=b-i*a,k=(f-h)/(e-g),l=f-k*e,m=(l-j)/(i-k);return{x:m,y:i*m+j}}function findIntersectY(a,b,c,d,e){if(b==d)return{x:e,y:b};var f=(b-d)/(a-c);return{x:e,y:f*e+(b-f*a)}}function findIntersectX(a,b,c,d,e){if(a==c)return{x:a,y:e};var f=(b-d)/(a-c);return{x:(e-(b-f*a))/f,y:e}}if("string"!=typeof content){var contentSelect=!0;options=content,content=!1}else var contentSelect=!1;return jQuery.fn.hoverIntent&&"hover"==jQuery.bt.defaults.trigger&&(jQuery.bt.defaults.trigger="hoverIntent"),this.each(function(index){var opts=jQuery.extend(!1,jQuery.bt.defaults,jQuery.bt.options,options);opts.spikeLength=numb(opts.spikeLength),opts.spikeGirth=numb(opts.spikeGirth),opts.overlap=numb(opts.overlap);var ajaxTimeout=!1;if(opts.killTitle&&$(this).find("[title]").addBack().each(function(){$(this).prop("bt-xTitle")||$(this).prop("bt-xTitle",$(this).prop("title")).prop("title","")}),"string"==typeof opts.tpropigger&&(opts.trigger=[opts.trigger]),"hoverIntent"==opts.trigger[0]){var hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn()},out:function(){this.btOff()}});$(this).hoverIntent(hoverOpts)}else"hover"==opts.trigger[0]?$(this).hover(function(){this.btOn()},function(){this.btOff()}):"now"==opts.trigger[0]?$(this).hasClass("bt-active")?this.btOff():this.btOn():"none"==opts.trigger[0]||(opts.trigger.length>1&&opts.trigger[0]!=opts.trigger[1]?$(this).bind(opts.trigger[0],function(){this.btOn()}).bind(opts.trigger[1],function(){this.btOff()}):$(this).bind(opts.trigger[0],function(){$(this).hasClass("bt-active")?this.btOff():this.btOn()}));this.btOn=function(){if("object"==typeof $(this).data("bt-box")&&this.btOff(),opts.preBuild.apply(this),$(jQuery.bt.vars.closeWhenOpenStack).btOff(),$(this).addClass("bt-active "+opts.activeClass),contentSelect&&null==opts.ajaxPath&&(opts.killTitle&&$(this).prop("title",$(this).prop("bt-xTitle")),content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector),opts.killTitle&&$(this).prop("title","")),null!=opts.ajaxPath&&0==content){if("object"==typeof opts.ajaxPath){var url=eval(opts.ajaxPath[0]);url+=opts.ajaxPath[1]?" "+opts.ajaxPath[1]:""}else var url=opts.ajaxPath;var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var cacheData=opts.ajaxCache?$(document.body).data("btCache-"+url.replace(/\./g,"")):null;if("string"==typeof cacheData)content=selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData;else{var target=this,ajaxOpts=jQuery.extend(!1,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(a,b){"success"==b||"notmodified"==b?(opts.ajaxCache&&$(document.body).data("btCache-"+url.replace(/\./g,""),a.responseText),ajaxTimeout=!1,content=selector?$("<div/>").append(a.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):a.responseText):("timeout"==b&&(ajaxTimeout=!0),content=opts.ajaxError.replace(/%error/g,a.statusText)),$(target).hasClass("bt-active")&&target.btOn()}},opts.ajaxOpts);jQuery.ajax(ajaxOpts),content=opts.ajaxLoading}}var shadowMarginX=0,shadowMarginY=0,shadowShiftX=0,shadowShiftY=0;if(opts.shadow&&!shadowSupport()&&(opts.shadow=!1,jQuery.extend(opts,opts.noShadowOpts)),opts.shadow&&(shadowMarginX=opts.shadowBlur>Math.abs(opts.shadowOffsetX)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetX),shadowShiftX=opts.shadowBlur-opts.shadowOffsetX>0?opts.shadowBlur-opts.shadowOffsetX:0,shadowMarginY=opts.shadowBlur>Math.abs(opts.shadowOffsetY)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetY),shadowShiftY=opts.shadowBlur-opts.shadowOffsetY>0?opts.shadowBlur-opts.shadowOffsetY:0),opts.offsetParent)var offsetParent=$(opts.offsetParent),offsetParentPos=offsetParent.offset(),pos=$(this).offset(),top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css("margin-top"))-shadowShiftY,left=numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css("margin-left"))-shadowShiftX;else var offsetParent="absolute"==$(this).css("position")?$(this).parents().eq(0).offsetParent():$(this).offsetParent(),pos=$(this).btPosition(),top=numb(pos.top)+numb($(this).css("margin-top"))-shadowShiftY,left=numb(pos.left)+numb($(this).css("margin-left"))-shadowShiftX;var width=$(this).btOuterWidth(),height=$(this).outerHeight();if("object"==typeof content){if(null==content)return;var original=content,clone=$(original).clone(!0).show(),origClones=$(original).data("bt-clones")||[];origClones.push(clone),$(original).data("bt-clones",origClones),$(clone).data("bt-orig",original),$(this).data("bt-content-orig",{original:original,clone:clone}),content=clone}if("null"!=typeof content&&""!=content){var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:"absolute",width:opts.shrinkToFit?"auto":opts.width,zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles),$box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:"absolute",width:opts.width,zIndex:opts.wrapperzIndex,visibility:"hidden"}).appendTo(offsetParent);jQuery.fn.bgiframe&&($text.bgiframe(),$box.bgiframe()),$(this).data("bt-box",$box);var scrollTop=numb($(document).scrollTop()),scrollLeft=numb($(document).scrollLeft()),docWidth=numb($(window).width()),docHeight=numb($(window).height()),winRight=scrollLeft+docWidth,winBottom=scrollTop+docHeight,space=new Object,thisOffset=$(this).offset();space.top=thisOffset.top-scrollTop,space.bottom=docHeight-(thisOffset+height-scrollTop),space.left=thisOffset.left-scrollLeft,space.right=docWidth-(thisOffset.left+width-scrollLeft);var textOutHeight=numb($text.outerHeight()),textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String&&(opts.positions=opts.positions.replace(/ /,"").split(",")),"most"==opts.positions[0]){var position="top";for(var pig in space)position=space[pig]>space[position]?pig:position}else for(var x in opts.positions){var position=opts.positions[x];if(("left"==position||"right"==position)&&space[position]>textOutWidth+opts.spikeLength)break;if(("top"==position||"bottom"==position)&&space[position]>textOutHeight+opts.spikeLength)break}var horiz=left+.5*(width-textOutWidth),vert=top+.5*(height-textOutHeight),points=new Array,textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(position){case"top":$text.css("margin-bottom",opts.spikeLength+"px"),$box.css({top:top-$text.outerHeight(!0)+opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;textRightSpace<0&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),textLeftSpace<0&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),
textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:.5*(textRight-textLeft)+xShift,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.CornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]=spikePoint;break;case"left":$text.css("margin-right",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left-$text.btOuterWidth(!0)+opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;textBottomSpace<0&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),textTopSpace<0&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint;break;case"bottom":$text.css("margin-top",opts.spikeLength+"px"),$box.css({top:top+height-opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;textRightSpace<0&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),textLeftSpace<0&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:.5*(textRight-textLeft)+xShift,y:shadowShiftY,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.cornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]=spikePoint;break;case"right":$text.css("margin-left",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left+width-opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;textBottomSpace<0&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),textTopSpace<0&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:shadowShiftX,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint}var canvas=document.createElement("canvas");if($(canvas).prop("width",numb($text.btOuterWidth(!0))+2*opts.strokeWidth+shadowMarginX).prop("height",numb($text.outerHeight(!0))+2*opts.strokeWidth+shadowMarginY).appendTo($box).css({position:"absolute",zIndex:opts.boxzIndex}),"undefined"!=typeof G_vmlCanvasManager&&(canvas=G_vmlCanvasManager.initElement(canvas)),opts.cornerRadius>0){for(var newPoints=new Array,newPoint,i=0;i<points.length;i++)"corner"==points[i].type?(newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius),newPoint.type="arcStart",newPoints[newPoints.length]=newPoint,newPoints[newPoints.length]=points[i],newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius),newPoint.type="arcEnd",newPoints[newPoints.length]=newPoint):newPoints[newPoints.length]=points[i];points=newPoints}var ctx=canvas.getContext("2d");if(opts.shadow&&!0!==opts.shadowOverlap){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case"top":opts.shadowOffsetX+opts.shadowBlur-shadowOverlap>0&&$box.css("top",numb($box.css("top"))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap));break;case"right":shadowShiftX-shadowOverlap>0&&$box.css("left",numb($box.css("left"))+shadowShiftX-shadowOverlap);break;case"bottom":shadowShiftY-shadowOverlap>0&&$box.css("top",numb($box.css("top"))+shadowShiftY-shadowOverlap);break;case"left":opts.shadowOffsetY+opts.shadowBlur-shadowOverlap>0&&$box.css("left",numb($box.css("left"))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap))}}if(drawIt.apply(ctx,[points],opts.strokeWidth),ctx.fillStyle=opts.fill,opts.shadow&&(ctx.shadowOffsetX=opts.shadowOffsetX,ctx.shadowOffsetY=opts.shadowOffsetY,ctx.shadowBlur=opts.shadowBlur,ctx.shadowColor=opts.shadowColor),ctx.closePath(),ctx.fill(),opts.strokeWidth>0&&(ctx.shadowColor="rgba(0, 0, 0, 0)",ctx.lineWidth=opts.strokeWidth,ctx.strokeStyle=opts.strokeStyle,ctx.beginPath(),drawIt.apply(ctx,[points],opts.strokeWidth),ctx.closePath(),ctx.stroke()),opts.preShow.apply(this,[$box[0]]),$box.css({display:"none",visibility:"visible"}),opts.showTip.apply(this,[$box[0]]),opts.overlay){var overlay=$('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:top,left:left,width:width,height:height,opacity:".2"}).appendTo(offsetParent);$(this).data("overlay",overlay)}(null!=opts.ajaxPath&&0==opts.ajaxCache||ajaxTimeout)&&(content=!1),opts.clickAnywhereToClose&&(jQuery.bt.vars.clickAnywhereStack.push(this),$(document).click(jQuery.bt.docClick)),opts.closeWhenOthersOpen&&jQuery.bt.vars.closeWhenOpenStack.push(this),opts.postShow.apply(this,[$box[0]])}},this.btOff=function(){var a=$(this).data("bt-box");if(void 0!==a){opts.preHide.apply(this,[a]);var b=this;b.btCleanup=function(){var a=$(b).data("bt-box"),c=$(b).data("bt-content-orig"),d=$(b).data("bt-overlay");if("object"==typeof a&&($(a).remove(),$(b).removeData("bt-box")),"object"==typeof c){var e=$(c.original).data("bt-clones");$(c).data("bt-clones",arrayRemove(e,c.clone))}"object"==typeof d&&($(d).remove(),$(b).removeData("bt-overlay")),jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,b),jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,b),$(b).removeClass("bt-active "+opts.activeClass),opts.postHide.apply(b)},opts.hideTip.apply(this,[a,b.btCleanup])}};var refresh=this.btRefresh=function(){this.btOff(),this.btOn()}})},jQuery.fn.btPosition=function(){function a(a,b){return a[0]&&parseInt(jQuery.css(a[0],b,!0),10)||0}var b;if(this[0]){var c=this.offsetParent(),d=this.offset(),e=/^body|html$/i.test(c[0].tagName)?{top:0,left:0}:c.offset();d.top-=a(this,"marginTop"),d.left-=a(this,"marginLeft"),e.top+=a(c,"borderTopWidth"),e.left+=a(c,"borderLeftWidth"),b={top:d.top-e.top,left:d.left-e.left}}return b},jQuery.fn.btOuterWidth=function(a){function b(a,b){return a[0]&&parseInt(jQuery.css(a[0],b,!0),10)||0}return this.innerWidth()+b(this,"borderLeftWidth")+b(this,"borderRightWidth")+(a?b(this,"marginLeft")+b(this,"marginRight"):0)},jQuery.fn.btOn=function(){return this.each(function(a){jQuery.isFunction(this.btOn)&&this.btOn()})},jQuery.fn.btOff=function(){return this.each(function(a){jQuery.isFunction(this.btOff)&&this.btOff()})},jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]},jQuery.bt.docClick=function(a){if(!a)var a=window.event;!$(a.target).parents().addBack().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length&&($(jQuery.bt.vars.clickAnywhereStack).btOff(),$(document).unbind("click",jQuery.bt.docClick))},jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:!0,closeWhenOthersOpen:!1,shrinkToFit:!1,width:"200px",padding:"10px",spikeGirth:10,spikeLength:15,overlap:0,overlay:!1,killTitle:!0,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:.5,centerPointY:.5,shadow:!1,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",contentSelector:"$(this).prop('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:!0,ajaxOpts:{},preBuild:function(){},preShow:function(a){},showTip:function(a){$(a).show()},postShow:function(a){},preHide:function(a){},hideTip:function(a,b){$(a).hide(),b()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}},jQuery.bt.options={}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,d){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,!(!b.href||!f||"map"!==e.nodeName.toLowerCase())&&(!!(g=a("img[usemap='#"+f+"']")[0])&&c(g))):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||d:d)&&c(b)}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}function d(a){for(var b,c;a.length&&a[0]!==document;){if(("absolute"===(b=a.css("position"))||"relative"===b||"fixed"===b)&&(c=parseInt(a.css("zIndex"),10),!isNaN(c)&&0!==c))return c;a=a.parent()}return 0}function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},a.extend(this._defaults,this.regional[""]),this.regional.en=a.extend(!0,{},this.regional[""]),this.regional["en-US"]=a.extend(!0,{},this.regional.en),this.dpDiv=f(a("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function f(b){var c="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return b.delegate(c,"mouseout",function(){a(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate(c,"mouseover",g)}function g(){a.datepicker._isDisabledDatepicker(r.inline?r.dpDiv.parent()[0]:r.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))}function h(b,c){a.extend(b,c);for(var d in c)null==c[d]&&(b[d]=c[d]);return b}function i(a){return function(){var b=this.element.val();a.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("change")}}a.ui=a.ui||{},a.extend(a.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({scrollParent:function(b){var c=this.css("position"),d="absolute"===c,e=b?/(auto|scroll|hidden)/:/(auto|scroll)/,f=this.parents().filter(function(){var b=a(this);return(!d||"static"!==b.css("position"))&&e.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&f.length?f:a(this[0].ownerDocument||document)},uniqueId:function(){var a=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(c){return b(c,!isNaN(a.attr(c,"tabindex")))},tabbable:function(c){var d=a.attr(c,"tabindex"),e=isNaN(d);return(e||d>=0)&&b(c,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(b,c){function d(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),f&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var e="Width"===c?["Left","Right"]:["Top","Bottom"],f=c.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(b){return void 0===b?g["inner"+c].call(this):this.each(function(){a(this).css(f,d(this,b)+"px")})},a.fn["outer"+c]=function(b,e){return"number"!=typeof b?g["outer"+c].call(this,b):this.each(function(){a(this).css(f,d(this,b,!0,e)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(b){if(void 0!==b)return this.css("zIndex",b);if(this.length)for(var c,d,e=a(this[0]);e.length&&e[0]!==document;){if(("absolute"===(c=e.css("position"))||"relative"===c||"fixed"===c)&&(d=parseInt(e.css("zIndex"),10),!isNaN(d)&&0!==d))return d;e=e.parent()}return 0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;f.length>e;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}};var j=0,k=Array.prototype.slice;a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{(d=a._data(e,"events"))&&d.remove&&a(e).triggerHandler("remove")}catch(a){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(b){for(var c,d,e=k.call(arguments,1),f=0,g=e.length;g>f;f++)for(c in e[f])d=e[f][c],e[f].hasOwnProperty(c)&&void 0!==d&&(b[c]=a.isPlainObject(d)?a.isPlainObject(b[c])?a.widget.extend({},b[c],d):a.widget.extend({},d):d);return b},a.widget.bridge=function(b,c){var d=c.prototype.widgetFullName||b;a.fn[b]=function(e){var f="string"==typeof e,g=k.call(arguments,1),h=this;return e=!f&&g.length?a.widget.extend.apply(null,[e].concat(g)):e,f?this.each(function(){var c,f=a.data(this,d);return"instance"===e?(h=f,!1):f?a.isFunction(f[e])&&"_"!==e.charAt(0)?(c=f[e].apply(f,g),c!==f&&void 0!==c?(h=c&&c.jquery?h.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+e+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+e+"'")}):this.each(function(){var b=a.data(this,d);b?(b.option(e||{}),b._init&&b._init()):a.data(this,d,new c(e,this))}),h}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.uuid=j++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===c&&this.destroy()}}),this.document=a(c.style?c.ownerDocument:c.document||c),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;d.length-1>f;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),b&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||!0!==f.options.disabled&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.unbind(c).undelegate(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?!0===e||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.widget;var l=!1;a(document).mouseup(function(){l=!1}),a.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!l){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var c=this,d=1===b.which,e=!("string"!=typeof this.options.cancel||!b.target.nodeName)&&a(b.target).closest(this.options.cancel).length;return!(d&&!e&&this._mouseCapture(b))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(b),!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return c._mouseMove(a)},this._mouseUpDelegate=function(a){return c._mouseUp(a)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),l=!0,!0))}},_mouseMove:function(b){if(this._mouseMoved){if(a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button)return this._mouseUp(b);if(!b.which)return this._mouseUp(b)}return(b.which||b.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),l=!1,!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function b(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function c(b,c){return parseInt(a.css(b,c),10)||0}function d(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var e,f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(void 0!==e)return e;var b,c,d=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),f=d.children()[0];return a("body").append(d),b=f.offsetWidth,d.css("overflow","scroll"),c=f.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),e=b-c},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth;return{width:"scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d||e?c.width():c.outerWidth(),height:d||e?c.height():c.outerHeight()}}},a.fn.position=function(e){if(!e||!e.of)return o.apply(this,arguments);e=a.extend({},e);var n,p,q,r,s,t,u=a(e.of),v=a.position.getWithinInfo(e.within),w=a.position.getScrollInfo(v),x=(e.collision||"flip").split(" "),y={};return t=d(u),u[0].preventDefault&&(e.at="left top"),p=t.width,q=t.height,r=t.offset,s=a.extend({},r),a.each(["my","at"],function(){var a,b,c=(e[this]||"").split(" ");1===c.length&&(c=j.test(c[0])?c.concat(["center"]):k.test(c[0])?["center"].concat(c):["center","center"]),c[0]=j.test(c[0])?c[0]:"center",c[1]=k.test(c[1])?c[1]:"center",a=l.exec(c[0]),b=l.exec(c[1]),y[this]=[a?a[0]:0,b?b[0]:0],e[this]=[m.exec(c[0])[0],m.exec(c[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?s.left+=p:"center"===e.at[0]&&(s.left+=p/2),"bottom"===e.at[1]?s.top+=q:"center"===e.at[1]&&(s.top+=q/2),n=b(y.at,p,q),s.left+=n[0],s.top+=n[1],this.each(function(){var d,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=c(this,"marginLeft"),t=c(this,"marginTop"),z=l+o+c(this,"marginRight")+w.width,A=m+t+c(this,"marginBottom")+w.height,B=a.extend({},s),C=b(y.my,k.outerWidth(),k.outerHeight());"right"===e.my[0]?B.left-=l:"center"===e.my[0]&&(B.left-=l/2),"bottom"===e.my[1]?B.top-=m:"center"===e.my[1]&&(B.top-=m/2),B.left+=C[0],B.top+=C[1],f||(B.left=i(B.left),B.top=i(B.top)),d={marginLeft:o,marginTop:t},a.each(["left","top"],function(b,c){a.ui.position[x[b]]&&a.ui.position[x[b]][c](B,{targetWidth:p,targetHeight:q,elemWidth:l,elemHeight:m,collisionPosition:d,collisionWidth:z,collisionHeight:A,offset:[n[0]+C[0],n[1]+C[1]],my:e.my,at:e.at,within:v,elem:k})}),e.using&&(j=function(a){var b=r.left-B.left,c=b+p-l,d=r.top-B.top,f=d+q-m,i={target:{element:u,left:r.left,top:r.top,width:p,height:q},element:{element:k,left:B.left,top:B.top,width:l,height:m},horizontal:0>c?"left":b>0?"right":"center",vertical:0>f?"top":d>0?"bottom":"middle"}
;l>p&&p>h(b+c)&&(i.horizontal="center"),m>q&&q>h(d+f)&&(i.vertical="middle"),i.important=g(h(b),h(c))>g(h(d),h(f))?"horizontal":"vertical",e.using.call(this,a,i)}),k.offset(a.extend(B,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(0>(c=a.left+m+n+o+b.collisionWidth-g-f)||h(k)>c)&&(a.left+=m+n+o):l>0&&((d=a.left-b.collisionPosition.marginLeft+m+n+o-i)>0||l>h(d))&&(a.left+=m+n+o)},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||h(k)>d)&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||l>h(c))&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,g,h=document.getElementsByTagName("body")[0],i=document.createElement("div");b=document.createElement(h?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},h&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(g in d)b.style[g]=d[g];b.appendChild(i),c=h||document.documentElement,c.insertBefore(b,c.firstChild),i.style.cssText="position: absolute; left: 10.7432222px;",e=a(i).offset().left,f=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(),a.ui.position,a.widget("ui.draggable",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(a,b){this._super(a,b),"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(b){var c=this.options;return this._blurActiveElement(b),!(this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(b),!!this.handle&&(this._blockFrames(!0===c.iframeFix?"iframe":c.iframeFix),!0))},_blockFrames:function(b){this.iframeBlocks=this.document.find(b).map(function(){var b=a(this);return a("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(b){var c=this.document[0];if(this.handleElement.is(b.target))try{c.activeElement&&"body"!==c.activeElement.nodeName.toLowerCase()&&a(c.activeElement).blur()}catch(a){}},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===a(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(b),this.originalPosition=this.position=this._generatePosition(b,!1),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),!1===this._trigger("start",b)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._normalizeRightBottom(),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_refreshOffsets:function(a){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:a.pageX-this.offset.left,top:a.pageY-this.offset.top}},_mouseDrag:function(b,c){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b,!0),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(!1===this._trigger("drag",b,d))return this._mouseUp({}),!1;this.position=d.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==c._trigger("stop",b)&&c._clear()}):!1!==this._trigger("stop",b)&&this._clear(),!1},_mouseUp:function(b){return this._unblockFrames(),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),this.handleElement.is(b.target)&&this.element.focus(),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return!this.options.handle||!!a(b.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper),e=d?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var b=this.offsetParent.offset(),c=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==c&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options,f=this.document[0];return this.relativeContainer=null,e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(f).width()-this.helperProportions.width-this.margins.left,(a(f).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),void((d=c[0])&&(b=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*c}},_generatePosition:function(a,b){var c,d,e,f,g=this.options,h=this._isRootNode(this.scrollParent[0]),i=a.pageX,j=a.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(d=this.relativeContainer.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,a.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),a.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),a.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),a.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f),"y"===g.axis&&(i=this.originalPageX),"x"===g.axis&&(j=this.originalPageY)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d,this],!0),/^(drag|start|stop)/.test(b)&&(this.positionAbs=this._convertPositionTo("absolute"),d.offset=this.positionAbs),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c,d){var e=a.extend({},c,{item:d.element});d.sortables=[],a(d.options.connectToSortable).each(function(){var c=a(this).sortable("instance");c&&!c.options.disabled&&(d.sortables.push(c),c.refreshPositions(),c._trigger("activate",b,e))})},stop:function(b,c,d){var e=a.extend({},c,{item:d.element});d.cancelHelperRemoval=!1,a.each(d.sortables,function(){var a=this;a.isOver?(a.isOver=0,d.cancelHelperRemoval=!0,a.cancelHelperRemoval=!1,a._storedCSS={position:a.placeholder.css("position"),top:a.placeholder.css("top"),left:a.placeholder.css("left")},a._mouseStop(b),a.options.helper=a.options._helper):(a.cancelHelperRemoval=!0,a._trigger("deactivate",b,e))})},drag:function(b,c,d){a.each(d.sortables,function(){var e=!1,f=this;f.positionAbs=d.positionAbs,f.helperProportions=d.helperProportions,f.offset.click=d.offset.click,f._intersectsWith(f.containerCache)&&(e=!0,a.each(d.sortables,function(){return this.positionAbs=d.positionAbs,this.helperProportions=d.helperProportions,this.offset.click=d.offset.click,this!==f&&this._intersectsWith(this.containerCache)&&a.contains(f.element[0],this.element[0])&&(e=!1),e})),e?(f.isOver||(f.isOver=1,f.currentItem=c.helper.appendTo(f.element).data("ui-sortable-item",!0),f.options._helper=f.options.helper,f.options.helper=function(){return c.helper[0]},b.target=f.currentItem[0],f._mouseCapture(b,!0),f._mouseStart(b,!0,!0),f.offset.click.top=d.offset.click.top,f.offset.click.left=d.offset.click.left,f.offset.parent.left-=d.offset.parent.left-f.offset.parent.left,f.offset.parent.top-=d.offset.parent.top-f.offset.parent.top,d._trigger("toSortable",b),d.dropped=f.element,a.each(d.sortables,function(){this.refreshPositions()}),d.currentItem=d.element,f.fromOutside=d),f.currentItem&&(f._mouseDrag(b),c.position=f.position)):f.isOver&&(f.isOver=0,f.cancelHelperRemoval=!0,f.options._revert=f.options.revert,f.options.revert=!1,f._trigger("out",b,f._uiHash(f)),f._mouseStop(b,!0),f.options.revert=f.options._revert,f.options.helper=f.options._helper,f.placeholder&&f.placeholder.remove(),d._refreshOffsets(b),c.position=d._generatePosition(b,!0),d._trigger("fromSortable",b),d.dropped=!1,a.each(d.sortables,function(){this.refreshPositions()}))})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c,d){var e=a("body"),f=d.options;e.css("cursor")&&(f._cursor=e.css("cursor")),e.css("cursor",f.cursor)},stop:function(b,c,d){var e=d.options;e._cursor&&a("body").css("cursor",e._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("opacity")&&(f._opacity=e.css("opacity")),e.css("opacity",f.opacity)},stop:function(b,c,d){var e=d.options;e._opacity&&a(c.helper).css("opacity",e._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1)),c.scrollParentNotHidden[0]!==c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(b,c,d){var e=d.options,f=!1,g=d.scrollParentNotHidden[0],h=d.document[0];g!==h&&"HTML"!==g.tagName?(e.axis&&"x"===e.axis||(d.overflowOffset.top+g.offsetHeight-b.pageY<e.scrollSensitivity?g.scrollTop=f=g.scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(g.scrollTop=f=g.scrollTop-e.scrollSpeed)),e.axis&&"y"===e.axis||(d.overflowOffset.left+g.offsetWidth-b.pageX<e.scrollSensitivity?g.scrollLeft=f=g.scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(g.scrollLeft=f=g.scrollLeft-e.scrollSpeed))):(e.axis&&"x"===e.axis||(b.pageY-a(h).scrollTop()<e.scrollSensitivity?f=a(h).scrollTop(a(h).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(h).scrollTop())<e.scrollSensitivity&&(f=a(h).scrollTop(a(h).scrollTop()+e.scrollSpeed))),e.axis&&"y"===e.axis||(b.pageX-a(h).scrollLeft()<e.scrollSensitivity?f=a(h).scrollLeft(a(h).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(h).scrollLeft())<e.scrollSensitivity&&(f=a(h).scrollLeft(a(h).scrollLeft()+e.scrollSpeed)))),!1!==f&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c,d){var e=d.options;d.snapElements=[],a(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!==d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=d.options,p=o.snapTolerance,q=c.offset.left,r=q+d.helperProportions.width,s=c.offset.top,t=s+d.helperProportions.height;for(m=d.snapElements.length-1;m>=0;m--)i=d.snapElements[m].left-d.margins.left,j=i+d.snapElements[m].width,k=d.snapElements[m].top-d.margins.top,l=k+d.snapElements[m].height,i-p>r||q>j+p||k-p>t||s>l+p||!a.contains(d.snapElements[m].item.ownerDocument,d.snapElements[m].item)?(d.snapElements[m].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=!1):("inner"!==o.snapMode&&(e=p>=Math.abs(k-t),f=p>=Math.abs(l-s),g=p>=Math.abs(i-r),h=p>=Math.abs(j-q),e&&(c.position.top=d._convertPositionTo("relative",{top:k-d.helperProportions.height,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i-d.helperProportions.width}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j}).left)),n=e||f||g||h,"outer"!==o.snapMode&&(e=p>=Math.abs(k-s),f=p>=Math.abs(l-t),g=p>=Math.abs(i-q),h=p>=Math.abs(j-r),e&&(c.position.top=d._convertPositionTo("relative",{top:k,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l-d.helperProportions.height,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j-d.helperProportions.width}).left)),!d.snapElements[m].snapping&&(e||f||g||h||n)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=e||f||g||h||n)}}),a.ui.plugin.add("draggable","stack",{start:function(b,c,d){var e,f=d.options,g=a.makeArray(a(f.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});g.length&&(e=parseInt(a(g[0]).css("zIndex"),10)||0,a(g).each(function(b){a(this).css("zIndex",e+b)}),this.css("zIndex",e+g.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("zIndex")&&(f._zIndex=e.css("zIndex")),e.css("zIndex",f.zIndex)},stop:function(b,c,d){var e=d.options;e._zIndex&&a(c.helper).css("zIndex",e._zIndex)}}),a.ui.draggable,a.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b,c=this.options,d=c.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(d)?d:function(a){return a.is(d)},this.proportions=function(){return arguments.length?void(b=arguments[0]):b||(b={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(c.scope),c.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(b){a.ui.ddmanager.droppables[b]=a.ui.ddmanager.droppables[b]||[],a.ui.ddmanager.droppables[b].push(this)},_splice:function(a){for(var b=0;a.length>b;b++)a[b]===this&&a.splice(b,1)},_destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];this._splice(b),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){if("accept"===b)this.accept=a.isFunction(c)?c:function(a){return a.is(c)};else if("scope"===b){var d=a.ui.ddmanager.droppables[this.options.scope];this._splice(d),this._addToManager(c)}this._super(b,c)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return!(!d||(d.currentItem||d.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var c=a(this).droppable("instance");return c.options.greedy&&!c.options.disabled&&c.options.scope===d.options.scope&&c.accept.call(c.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(c,{offset:c.element.offset()}),c.options.tolerance,b)?(e=!0,!1):void 0}),!e&&(!!this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element)))},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(){function a(a,b,c){return a>=b&&b+c>a}return function(b,c,d,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left+b.margins.left,g=(b.positionAbs||b.position.absolute).top+b.margins.top,h=f+b.helperProportions.width,i=g+b.helperProportions.height,j=c.offset.left,k=c.offset.top,l=j+c.proportions().width,m=k+c.proportions().height;switch(d){case"fit":return f>=j&&l>=h&&g>=k&&m>=i;case"intersect":return f+b.helperProportions.width/2>j&&l>h-b.helperProportions.width/2&&g+b.helperProportions.height/2>k&&m>i-b.helperProportions.height/2;case"pointer":return a(e.pageY,k,c.proportions().height)&&a(e.pageX,j,c.proportions().width);case"touch":return(g>=k&&m>=g||i>=k&&m>=i||k>g&&i>m)&&(f>=j&&l>=f||h>=j&&l>=h||j>f&&h>l);default:return!1}}}(),a.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;f.length>d;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;h.length>e;e++)if(h[e]===f[d].element[0]){f[d].proportions().height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions({width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight}))}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance,c)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance,c),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===e}),f.length&&(d=a(f[0]).droppable("instance"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}},a.ui.droppable,a.widget("ui.resizable",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(a){return parseInt(a,10)||0},_isNumber:function(a){return!isNaN(parseInt(a,10))},_hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0||(b[d]=1,e=b[d]>0,b[d]=0,e)},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;b.length>c;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=this.element.children(this.handles[c]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)((d=a(this.handles[c])[0])===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(b){var c,d,e,f=this.options,g=this.element;return this.resizing=!0,this._renderProxy(),c=this._num(this.helper.css("left")),d=this._num(this.helper.css("top")),f.containment&&(c+=a(f.containment).scrollLeft()||0,d+=a(f.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:c,top:d},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{
width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalPosition={left:c,top:d},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio="number"==typeof f.aspectRatio?f.aspectRatio:this.originalSize.width/this.originalSize.height||1,e=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===e?this.axis+"-resize":e),g.addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c,d,e=this.originalMousePosition,f=this.axis,g=b.pageX-e.left||0,h=b.pageY-e.top||0,i=this._change[f];return this._updatePrevProperties(),!!i&&(c=i.apply(this,[b,g,h]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),d=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(d)||(this._updatePrevProperties(),this._trigger("resize",b,this.ui()),this._applyChanges()),!1)},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&this._hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var a={};return this.position.top!==this.prevPosition.top&&(a.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(a.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(a.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(a.height=this.size.height+"px"),this.helper.css(a),a},_updateVirtualBoundaries:function(a){var b,c,d,e,f,g=this.options;f={minWidth:this._isNumber(g.minWidth)?g.minWidth:0,maxWidth:this._isNumber(g.maxWidth)?g.maxWidth:1/0,minHeight:this._isNumber(g.minHeight)?g.minHeight:0,maxHeight:this._isNumber(g.maxHeight)?g.maxHeight:1/0},(this._aspectRatio||a)&&(b=f.minHeight*this.aspectRatio,d=f.minWidth/this.aspectRatio,c=f.maxHeight*this.aspectRatio,e=f.maxWidth/this.aspectRatio,b>f.minWidth&&(f.minWidth=b),d>f.minHeight&&(f.minHeight=d),f.maxWidth>c&&(f.maxWidth=c),f.maxHeight>e&&(f.maxHeight=e)),this._vBoundaries=f},_updateCache:function(a){this.offset=this.helper.offset(),this._isNumber(a.left)&&(this.position.left=a.left),this._isNumber(a.top)&&(this.position.top=a.top),this._isNumber(a.height)&&(this.size.height=a.height),this._isNumber(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,c=this.size,d=this.axis;return this._isNumber(a.height)?a.width=a.height*this.aspectRatio:this._isNumber(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===d&&(a.left=b.left+(c.width-a.width),a.top=null),"nw"===d&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,c=this.axis,d=this._isNumber(a.width)&&b.maxWidth&&b.maxWidth<a.width,e=this._isNumber(a.height)&&b.maxHeight&&b.maxHeight<a.height,f=this._isNumber(a.width)&&b.minWidth&&b.minWidth>a.width,g=this._isNumber(a.height)&&b.minHeight&&b.minHeight>a.height,h=this.originalPosition.left+this.originalSize.width,i=this.position.top+this.size.height,j=/sw|nw|w/.test(c),k=/nw|ne|n/.test(c);return f&&(a.width=b.minWidth),g&&(a.height=b.minHeight),d&&(a.width=b.maxWidth),e&&(a.height=b.maxHeight),f&&j&&(a.left=h-b.minWidth),d&&j&&(a.left=h-b.maxWidth),g&&k&&(a.top=i-b.minHeight),e&&k&&(a.top=i-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_getPaddingPlusBorderDimensions:function(a){for(var b=0,c=[],d=[a.css("borderTopWidth"),a.css("borderRightWidth"),a.css("borderBottomWidth"),a.css("borderLeftWidth")],e=[a.css("paddingTop"),a.css("paddingRight"),a.css("paddingBottom"),a.css("paddingLeft")];4>b;b++)c[b]=parseInt(d[b],10)||0,c[b]+=parseInt(e[b],10)||0;return{height:c[0]+c[2],width:c[1]+c[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a,b=0,c=this.helper||this.element;this._proportionallyResizeElements.length>b;b++)a=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(a)),a.css({height:c.height()-this.outerDimensions.height||0,width:c.width()-this.outerDimensions.width||0})},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize;return{left:this.originalPosition.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize;return{top:this.originalPosition.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).resizable("instance"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&c._hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var b,c,d,e,f,g,h,i=a(this).resizable("instance"),j=i.options,k=i.element,l=j.containment,m=l instanceof a?l.get(0):/parent/.test(l)?k.parent().get(0):l;m&&(i.containerElement=a(m),/document/.test(l)||l===document?(i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(b=a(m),c=[],a(["Top","Right","Left","Bottom"]).each(function(a,d){c[a]=i._num(b.css("padding"+d))}),i.containerOffset=b.offset(),i.containerPosition=b.position(),i.containerSize={height:b.innerHeight()-c[3],width:b.innerWidth()-c[1]},d=i.containerOffset,e=i.containerSize.height,f=i.containerSize.width,g=i._hasScroll(m,"left")?m.scrollWidth:f,h=i._hasScroll(m)?m.scrollHeight:e,i.parentData={element:m,left:d.left,top:d.top,width:g,height:h}))},resize:function(b){var c,d,e,f,g=a(this).resizable("instance"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement,n=!0;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio,n=!1),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio,n=!1),g.position.top=g._helper?i.top:0),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f?(g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top):(g.offset.left=g.element.offset().left,g.offset.top=g.element.offset().top),c=Math.abs(g.sizeDiff.width+(g._helper?g.offset.left-l.left:g.offset.left-i.left)),d=Math.abs(g.sizeDiff.height+(g._helper?g.offset.top-l.top:g.offset.top-i.top)),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio,n=!1)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio,n=!1)),n||(g.position.left=g.prevPosition.left,g.position.top=g.prevPosition.top,g.size.width=g.prevSize.width,g.size.height=g.prevSize.height)},stop:function(){var b=a(this).resizable("instance"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).resizable("instance"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).resizable("instance"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).resizable("instance"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).resizable("instance");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).resizable("instance");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b,c=a(this).resizable("instance"),d=c.options,e=c.size,f=c.originalSize,g=c.originalPosition,h=c.axis,i="number"==typeof d.grid?[d.grid,d.grid]:d.grid,j=i[0]||1,k=i[1]||1,l=Math.round((e.width-f.width)/j)*j,m=Math.round((e.height-f.height)/k)*k,n=f.width+l,o=f.height+m,p=d.maxWidth&&n>d.maxWidth,q=d.maxHeight&&o>d.maxHeight,r=d.minWidth&&d.minWidth>n,s=d.minHeight&&d.minHeight>o;d.grid=i,r&&(n+=j),s&&(o+=k),p&&(n-=j),q&&(o-=k),/^(se|s|e)$/.test(h)?(c.size.width=n,c.size.height=o):/^(ne)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.top=g.top-m):/^(sw)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.left=g.left-l):((0>=o-k||0>=n-j)&&(b=c._getPaddingPlusBorderDimensions(this)),o-k>0?(c.size.height=o,c.position.top=g.top-m):(o=k-b.height,c.size.height=o,c.position.top=g.top+f.height-o),n-j>0?(c.size.width=n,c.position.left=g.left-l):(n=k-b.height,c.size.width=n,c.position.left=g.left+f.width-n))}}),a.ui.resizable,a.widget("ui.selectable",a.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var b,c=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){b=a(c.options.filter,c.element[0]),b.addClass("ui-selectee"),b.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=b.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(b){var c=this,d=this.options;this.opos=[b.pageX,b.pageY],this.options.disabled||(this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.pageX,top:b.pageY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||b.ctrlKey||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().addBack().each(function(){var d,e=a.data(this,"selectable-item");return e?(d=!b.metaKey&&!b.ctrlKey||!e.$element.hasClass("ui-selected"),e.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting"),e.unselecting=!d,e.selecting=d,e.selected=d,d?c._trigger("selecting",b,{selecting:e.element}):c._trigger("unselecting",b,{unselecting:e.element}),!1):void 0}))},_mouseDrag:function(b){if(this.dragged=!0,!this.options.disabled){var c,d=this,e=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;return f>h&&(c=h,h=f,f=c),g>i&&(c=i,i=g,g=c),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var c=a.data(this,"selectable-item"),j=!1;c&&c.element!==d.element[0]&&("touch"===e.tolerance?j=!(c.left>h||f>c.right||c.top>i||g>c.bottom):"fit"===e.tolerance&&(j=c.left>f&&h>c.right&&c.top>g&&i>c.bottom),j?(c.selected&&(c.$element.removeClass("ui-selected"),c.selected=!1),c.unselecting&&(c.$element.removeClass("ui-unselecting"),c.unselecting=!1),c.selecting||(c.$element.addClass("ui-selecting"),c.selecting=!0,d._trigger("selecting",b,{selecting:c.element}))):(c.selecting&&((b.metaKey||b.ctrlKey)&&c.startselected?(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.$element.addClass("ui-selected"),c.selected=!0):(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.startselected&&(c.$element.addClass("ui-unselecting"),c.unselecting=!0),d._trigger("unselecting",b,{unselecting:c.element}))),c.selected&&(b.metaKey||b.ctrlKey||c.startselected||(c.$element.removeClass("ui-selected"),c.selected=!1,c.$element.addClass("ui-unselecting"),c.unselecting=!0,d._trigger("unselecting",b,{unselecting:c.element})))))}),!1}},_mouseStop:function(b){var c=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}}),a.widget("ui.sortable",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(a,b,c){return a>=b&&b+c>a},_isFloating:function(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===a.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(a,b){this._super(a,b),"handle"===a&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),a.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),!!d&&(!(this.options.handle&&!c&&(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),!e))&&(this.currentItem=d,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),!1!==h&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],(f=this._intersectsWithPointer(d))&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"!==this.options.type||!a.contains(this.element[0],e))){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:b+this.helperProportions.width/2>f&&g>c-this.helperProportions.width/2&&d+this.helperProportions.height/2>h&&i>e-this.helperProportions.height/2},_intersectsWithPointer:function(a){var b="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),c="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),d=b&&c,e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return!!d&&(this.floating?f&&"right"===f||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(a){var b=this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),c=this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"===e&&c||"left"===e&&!c:d&&("down"===d&&b||"up"===d&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d]),e=f.length-1;e>=0;e--)(g=a.data(f[e],this.widgetFullName))&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;b.length>c;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)(f=a.data(e[d],this.widgetFullName))&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){var c,d,e,f,g,h,i,j,k,l,m=null,n=null;for(c=this.containers.length-1;c>=0;c--)if(!a.contains(this.currentItem[0],this.containers[c].element[0]))if(this._intersectsWith(this.containers[c].containerCache)){if(m&&a.contains(this.containers[c].element[0],m.element[0]))continue;m=this.containers[c],n=c}else this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",b,this._uiHash(this)),this.containers[c].containerCache.over=0);if(m)if(1===this.containers.length)this.containers[n].containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1);else{for(e=1e4,f=null,k=m.floating||this._isFloating(this.currentItem),g=k?"left":"top",h=k?"width":"height",l=k?"clientX":"clientY",
d=this.items.length-1;d>=0;d--)a.contains(this.containers[n].element[0],this.items[d].item[0])&&this.items[d].item[0]!==this.currentItem[0]&&(i=this.items[d].item.offset()[g],j=!1,b[l]-i>this.items[d][h]/2&&(j=!0),e>Math.abs(b[l]-i)&&(e=Math.abs(b[l]-i),f=this.items[d],this.direction=j?"up":"down"));if(!f&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[n])return void(this.currentContainer.containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash()),this.currentContainer.containerCache.over=1));f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[n].element,!0),this._trigger("change",b,this._uiHash()),this.containers[n]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[n],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!b){for(d=0;e.length>d;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var b=this.options;this.prevShow=this.prevHide=a(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),b.collapsible||!1!==b.active&&null!=b.active||(b.active=0),this._processPanels(),0>b.active&&(b.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():a()}},_createIcons:function(){var b=this.options.icons;b&&(a("<span>").addClass("ui-accordion-header-icon ui-icon "+b.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(b.header).addClass(b.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),a=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){return"active"===a?void this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b||!1!==this.options.active||this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),void("disabled"===a&&(this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!b))))},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._eventHandler(b);break;case c.HOME:f=this.headers[0];break;case c.END:f=this.headers[d-1]}f&&(a(b.target).attr("tabIndex",-1),a(f).attr("tabIndex",0),f.focus(),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().focus()},refresh:function(){var b=this.options;this._processPanels(),!1===b.active&&!0===b.collapsible||!this.headers.length?(b.active=!1,this.active=a()):!1===b.active?this._activate(0):this.active.length&&!a.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(b.active=!1,this.active=a()):this._activate(Math.max(0,b.active-1)):b.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var a=this.headers,b=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),b&&(this._off(a.not(this.headers)),this._off(b.not(this.panels)))},_refresh:function(){var b,c=this.options,d=c.heightStyle,e=this.element.parent();this.active=this._findActive(c.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var b=a(this),c=b.uniqueId().attr("id"),d=b.next(),e=d.uniqueId().attr("id");b.attr("aria-controls",e),d.attr("aria-labelledby",c)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(c.event),"fill"===d?(b=e.height(),this.element.siblings(":visible").each(function(){var c=a(this),d=c.css("position");"absolute"!==d&&"fixed"!==d&&(b-=c.outerHeight(!0))}),this.headers.each(function(){b-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,b-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===d&&(b=0,this.headers.next().each(function(){b=Math.max(b,a(this).css("height","").height())}).height(b))},_activate:function(b){var c=this._findActive(b)[0];c!==this.active[0]&&(c=c||this.active[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return"number"==typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var c={keydown:"_keydown"};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,c),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e[0]===d[0],g=f&&c.collapsible,h=g?a():e.next(),i=d.next(),j={oldHeader:d,oldPanel:i,newHeader:g?a():e,newPanel:h};b.preventDefault(),f&&!c.collapsible||!1===this._trigger("beforeActivate",b,j)||(c.active=!g&&this.headers.index(e),this.active=f?a():e,this._toggle(j),d.removeClass("ui-accordion-header-active ui-state-active"),c.icons&&d.children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),f||(e.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),c.icons&&e.children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),e.next().addClass("ui-accordion-content-active")))},_toggle:function(b){var c=b.newPanel,d=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=c,this.prevHide=d,this.options.animate?this._animate(c,d,b):(d.hide(),c.show(),this._toggleComplete(b)),d.attr({"aria-hidden":"true"}),d.prev().attr("aria-selected","false"),c.length&&d.length?d.prev().attr({tabIndex:-1,"aria-expanded":"false"}):c.length&&this.headers.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),c.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(a,b,c){var d,e,f,g=this,h=0,i=a.length&&(!b.length||a.index()<b.index()),j=this.options.animate||{},k=i&&j.down||j,l=function(){g._toggleComplete(c)};return"number"==typeof k&&(f=k),"string"==typeof k&&(e=k),e=e||k.easing||j.easing,f=f||k.duration||j.duration,b.length?a.length?(d=a.show().outerHeight(),b.animate(this.hideProps,{duration:f,easing:e,step:function(a,b){b.now=Math.round(a)}}),void a.hide().animate(this.showProps,{duration:f,easing:e,complete:l,step:function(a,c){c.now=Math.round(a),"height"!==c.prop?h+=c.now:"content"!==g.options.heightStyle&&(c.now=Math.round(d-b.outerHeight()-h),h=0)}})):b.animate(this.hideProps,f,e,l):a.animate(this.showProps,f,e,l)},_toggleComplete:function(a){var b=a.oldPanel;b.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,a)}}),a.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(a){a.preventDefault()},"click .ui-menu-item":function(b){var c=a(b.target);!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.select(b),b.isPropagationStopped()||(this.mouseHandled=!0),c.has(".ui-menu").length?this.expand(b):!this.element.is(":focus")&&a(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){if(!this.previousFilter){var c=a(b.currentTarget);c.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.find(this.options.items).eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&this.collapseAll(a),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){var c,d,e,f,g=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:g=!1,d=this.previousFilter||"",e=String.fromCharCode(b.keyCode),f=!1,clearTimeout(this.filterTimer),e===d?f=!0:e=d+e,c=this._filterMenuItems(e),c=f&&-1!==c.index(this.active.next())?this.active.nextAll(".ui-menu-item"):c,c.length||(e=String.fromCharCode(b.keyCode),c=this._filterMenuItems(e)),c.length?(this.focus(b,c),this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}g&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(a):this.select(a))},refresh:function(){var b,c,d=this,e=this.options.icons.submenu,f=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),f.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),c=b.parent(),d=a("<span>").addClass("ui-menu-icon ui-icon "+e).data("ui-menu-submenu-carat",!0);c.attr("aria-haspopup","true").prepend(d),b.attr("aria-labelledby",c.attr("id"))}),b=f.add(this.element),c=b.find(this.options.items),c.not(".ui-menu-item").each(function(){var b=a(this);d._isDivider(b)&&b.addClass("ui-widget-content ui-menu-divider")}),c.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),c.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),"disabled"===a&&this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.outerHeight(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(b){return!a(b.target).closest(".ui-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.find(this.options.items)[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),0>c.offset().top-d-e}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items).first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)},_filterMenuItems:function(b){var c=b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),d=RegExp("^"+c,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return d.test(a.trim(a(this).text()))})}}),a.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=!!f||!g&&this.element.prop("isContentEditable"),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,void(c=!0);b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault());if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),void this._change(a))}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(d){d.target===b.element[0]||d.target===c||a.contains(c,d.target)||b.close()})})},menufocus:function(b,c){var d,e;return this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)})):(e=c.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",b,{item:e})&&b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(e.value),void((d=c.item.attr("aria-label")||e.value)&&a.trim(d).length&&(this.liveRegion.children().hide(),a("<div>").text(d).appendTo(this.liveRegion))))},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item"),d=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d,this.selectedItem=c})),!1!==this._trigger("select",a,{item:c})&&this._value(c.value),this.term=this._value(),this.close(a),this.selectedItem=c}}),this.liveRegion=a("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b&&b[0]||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){var b=this.term===this._value(),c=this.menu.element.is(":visible"),d=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;(!b||b&&!c&&!d)&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):!1!==this._trigger("search",b)?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a
},this._response())},_response:function(){var b=++this.requestIndex;return a.proxy(function(a){b===this.requestIndex&&this.__response(a),--this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({},b,{label:b.label||b.value,value:b.value||b.label})})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").text(c.label).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(b){var c;this._superApply(arguments),this.options.disabled||this.cancelSearch||(c=b&&b.length?this.options.messages.results(b.length):this.options.messages.noResults,this.liveRegion.children().hide(),a("<div>").text(c).appendTo(this.liveRegion))}}),a.ui.autocomplete;var m,n="ui-button ui-widget ui-state-default ui-corner-all",o="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",p=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},q=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"'][type=radio]"):a("[name='"+c+"'][type=radio]",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,p),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,c=this.options,d="checkbox"===this.type||"radio"===this.type,e=d?"":"ui-state-active";null===c.label&&(c.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(n).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){c.disabled||this===m&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){c.disabled||a(this).removeClass(e)}).bind("click"+this.eventNamespace,function(a){c.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),d&&this.element.bind("change"+this.eventNamespace,function(){b.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!c.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(c.disabled)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var d=b.element[0];q(d).not(d).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!c.disabled&&(a(this).addClass("ui-state-active"),m=this,void b.document.one("mouseup",function(){m=null}))}).bind("mouseup"+this.eventNamespace,function(){return!c.disabled&&void a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){return!c.disabled&&void((b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",c.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(n+" ui-state-active "+o).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(this.widget().toggleClass("ui-state-disabled",!!b),this.element.prop("disabled",!!b),void(b&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?q(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var b=this.buttonElement.removeClass(o),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction"),c=this.element.find(this.options.items),d=c.filter(":ui-button");c.not(":ui-button").button(),d.button("refresh"),this.buttons=c.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),a.ui.button,a.extend(a.ui,{datepicker:{version:"1.11.2"}});var r;a.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return h(this._defaults,a||{}),this},_attachDatepicker:function(b,c){var d,e,f;d=b.nodeName.toLowerCase(),e="div"===d||"span"===d,b.id||(this.uuid+=1,b.id="dp"+this.uuid),f=this._newInst(a(b),e),f.settings=a.extend({},c||{}),"input"===d?this._connectDatepicker(b,f):e&&this._inlineDatepicker(b,f)},_newInst:function(b,c){return{id:b[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:c?f(a("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(b,c){var d=a(b);c.append=a([]),c.trigger=a([]),d.hasClass(this.markerClassName)||(this._attachments(d,c),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(c),a.data(b,"datepicker",c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var d,e,f,g=this._get(c,"appendText"),h=this._get(c,"isRTL");c.append&&c.append.remove(),g&&(c.append=a("<span class='"+this._appendClass+"'>"+g+"</span>"),b[h?"before":"after"](c.append)),b.unbind("focus",this._showDatepicker),c.trigger&&c.trigger.remove(),d=this._get(c,"showOn"),("focus"===d||"both"===d)&&b.focus(this._showDatepicker),("button"===d||"both"===d)&&(e=this._get(c,"buttonText"),f=this._get(c,"buttonImage"),c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:f,alt:e,title:e}):a("<button type='button'></button>").addClass(this._triggerClass).html(f?a("<img/>").attr({src:f,alt:e,title:e}):e)),b[h?"before":"after"](c.trigger),c.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput===b[0]?a.datepicker._hideDatepicker():a.datepicker._datepickerShowing&&a.datepicker._lastInput!==b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1}))},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=this._get(a,"dateFormat");g.match(/[DM]/)&&(b=function(a){for(c=0,d=0,e=0;a.length>e;e++)a[e].length>c&&(c=a[e].length,d=e);return d},f.setMonth(b(this._get(a,g.match(/MM/)?"monthNames":"monthNamesShort"))),f.setDate(b(this._get(a,g.match(/DD/)?"dayNames":"dayNamesShort"))+20-f.getDay())),a.input.attr("size",this._formatDate(a,f).length)}},_inlineDatepicker:function(b,c){var d=a(b);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(c.dpDiv),a.data(b,"datepicker",c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&this._disableDatepicker(b),c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,d,e,f){var g,i,j,k,l,m=this._dialogInst;return m||(this.uuid+=1,g="dp"+this.uuid,this._dialogInput=a("<input type='text' id='"+g+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),m=this._dialogInst=this._newInst(this._dialogInput,!1),m.settings={},a.data(this._dialogInput[0],"datepicker",m)),h(m.settings,e||{}),c=c&&c.constructor===Date?this._formatDate(m,c):c,this._dialogInput.val(c),this._pos=f?f.length?f:[f.pageX,f.pageY]:null,this._pos||(i=document.documentElement.clientWidth,j=document.documentElement.clientHeight,k=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[i/2-100+k,j/2-150+l]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),m.settings.onSelect=d,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],"datepicker",m),this},_destroyDatepicker:function(b){var c,d=a(b),e=a.data(b,"datepicker");d.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),a.removeData(b,"datepicker"),"input"===c?(e.append.remove(),e.trigger.remove(),d.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===c||"span"===c)&&d.removeClass(this.markerClassName).empty())},_enableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,"datepicker");e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!1,f.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().removeClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}))},_disableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,"datepicker");e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!0,f.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().addClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}),this._disabledInputs[this._disabledInputs.length]=b)},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;this._disabledInputs.length>b;b++)if(this._disabledInputs[b]===a)return!0;return!1},_getInst:function(b){try{return a.data(b,"datepicker")}catch(a){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(b,c,d){var e,f,g,i,j=this._getInst(b);return 2===arguments.length&&"string"==typeof c?"defaults"===c?a.extend({},a.datepicker._defaults):j?"all"===c?a.extend({},j.settings):this._get(j,c):null:(e=c||{},"string"==typeof c&&(e={},e[c]=d),void(j&&(this._curInst===j&&this._hideDatepicker(),f=this._getDateDatepicker(b,!0),g=this._getMinMaxDate(j,"min"),i=this._getMinMaxDate(j,"max"),h(j.settings,e),null!==g&&void 0!==e.dateFormat&&void 0===e.minDate&&(j.settings.minDate=this._formatDate(j,g)),null!==i&&void 0!==e.dateFormat&&void 0===e.maxDate&&(j.settings.maxDate=this._formatDate(j,i)),"disabled"in e&&(e.disabled?this._disableDatepicker(b):this._enableDatepicker(b)),this._attachments(a(b),j),this._autoSize(j),this._setDate(j,f),this._updateAlternate(j),this._updateDatepicker(j))))},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(b){var c,d,e,f=a.datepicker._getInst(b.target),g=!0,h=f.dpDiv.is(".ui-datepicker-rtl");if(f._keyEvent=!0,a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker(),g=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",f.dpDiv),e[0]&&a.datepicker._selectDay(b.target,f.selectedMonth,f.selectedYear,e[0]),c=a.datepicker._get(f,"onSelect"),c?(d=a.datepicker._formatDate(f),c.apply(f.input?f.input[0]:null,[d,f])):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target),g=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target),g=b.ctrlKey||b.metaKey;break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?1:-1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D"),g=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?-1:1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D"),g=b.ctrlKey||b.metaKey;break;default:g=!1}else 36===b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):g=!1;g&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(b){var c,d,e=a.datepicker._getInst(b.target);return a.datepicker._get(e,"constrainInput")?(c=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),d=String.fromCharCode(null==b.charCode?b.keyCode:b.charCode),b.ctrlKey||b.metaKey||" ">d||!c||c.indexOf(d)>-1):void 0},_doKeyUp:function(b){var c=a.datepicker._getInst(b.target);if(c.input.val()!==c.lastVal)try{a.datepicker.parseDate(a.datepicker._get(c,"dateFormat"),c.input?c.input.val():null,a.datepicker._getFormatConfig(c))&&(a.datepicker._setDateFromField(c),a.datepicker._updateAlternate(c),a.datepicker._updateDatepicker(c))}catch(a){}return!0},_showDatepicker:function(b){if(b=b.target||b,"input"!==b.nodeName.toLowerCase()&&(b=a("input",b.parentNode)[0]),!a.datepicker._isDisabledDatepicker(b)&&a.datepicker._lastInput!==b){var c,e,f,g,i,j,k;c=a.datepicker._getInst(b),a.datepicker._curInst&&a.datepicker._curInst!==c&&(a.datepicker._curInst.dpDiv.stop(!0,!0),c&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0])),e=a.datepicker._get(c,"beforeShow"),!1!==(f=e?e.apply(b,[b,c]):{})&&(h(c.settings,f),c.lastVal=null,a.datepicker._lastInput=b,a.datepicker._setDateFromField(c),a.datepicker._inDialog&&(b.value=""),a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight),g=!1,a(b).parents().each(function(){return!(g|="fixed"===a(this).css("position"))}),i={left:a.datepicker._pos[0],top:a.datepicker._pos[1]},a.datepicker._pos=null,c.dpDiv.empty(),c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),a.datepicker._updateDatepicker(c),i=a.datepicker._checkOffset(c,i,g),c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":g?"fixed":"absolute",display:"none",left:i.left+"px",top:i.top+"px"}),c.inline||(j=a.datepicker._get(c,"showAnim"),k=a.datepicker._get(c,"duration"),c.dpDiv.css("z-index",d(a(b))+1),a.datepicker._datepickerShowing=!0,a.effects&&a.effects.effect[j]?c.dpDiv.show(j,a.datepicker._get(c,"showOptions"),k):c.dpDiv[j||"show"](j?k:null),a.datepicker._shouldFocusInput(c)&&c.input.focus(),a.datepicker._curInst=c))}},_updateDatepicker:function(b){this.maxRows=4,r=b,b.dpDiv.empty().append(this._generateHTML(b)),this._attachHandlers(b);var c,d=this._getNumberOfMonths(b),e=d[1],f=b.dpDiv.find("."+this._dayOverClass+" a");f.length>0&&g.apply(f.get(0)),b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),e>1&&b.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",17*e+"em"),b.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),b===a.datepicker._curInst&&a.datepicker._datepickerShowing&&a.datepicker._shouldFocusInput(b)&&b.input.focus(),b.yearshtml&&(c=b.yearshtml,setTimeout(function(){c===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml),c=b.yearshtml=null},0))},_shouldFocusInput:function(a){return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(b,c,d){var e=b.dpDiv.outerWidth(),f=b.dpDiv.outerHeight(),g=b.input?b.input.outerWidth():0,h=b.input?b.input.outerHeight():0,i=document.documentElement.clientWidth+(d?0:a(document).scrollLeft()),j=document.documentElement.clientHeight+(d?0:a(document).scrollTop());return c.left-=this._get(b,"isRTL")?e-g:0,c.left-=d&&c.left===b.input.offset().left?a(document).scrollLeft():0,c.top-=d&&c.top===b.input.offset().top+h?a(document).scrollTop():0,c.left-=Math.min(c.left,c.left+e>i&&i>e?Math.abs(c.left+e-i):0),c.top-=Math.min(c.top,c.top+f>j&&j>f?Math.abs(f+h):0),c},_findPos:function(b){for(var c,d=this._getInst(b),e=this._get(d,"isRTL");b&&("hidden"===b.type||1!==b.nodeType||a.expr.filters.hidden(b));)b=b[e?"previousSibling":"nextSibling"];return c=a(b).offset(),[c.left,c.top]},_hideDatepicker:function(b){var c,d,e,f,g=this._curInst;!g||b&&g!==a.data(b,"datepicker")||this._datepickerShowing&&(c=this._get(g,"showAnim"),d=this._get(g,"duration"),e=function(){a.datepicker._tidyDialog(g)},a.effects&&(a.effects.effect[c]||a.effects[c])?g.dpDiv.hide(c,a.datepicker._get(g,"showOptions"),d,e):g.dpDiv["slideDown"===c?"slideUp":"fadeIn"===c?"fadeOut":"hide"](c?d:null,e),c||e(),this._datepickerShowing=!1,f=this._get(g,"onClose"),f&&f.apply(g.input?g.input[0]:null,[g.input?g.input.val():"",g]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){var c=a(b.target),d=a.datepicker._getInst(c[0]);(c[0].id!==a.datepicker._mainDivId&&0===c.parents("#"+a.datepicker._mainDivId).length&&!c.hasClass(a.datepicker.markerClassName)&&!c.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||c.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!==d)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,d){var e=a(b),f=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(f,c+("M"===d?this._get(f,"showCurrentAtPos"):0),d),this._updateDatepicker(f))},_gotoToday:function(b){var c,d=a(b),e=this._getInst(d[0]);this._get(e,"gotoCurrent")&&e.currentDay?(e.selectedDay=e.currentDay,e.drawMonth=e.selectedMonth=e.currentMonth,e.drawYear=e.selectedYear=e.currentYear):(c=new Date,e.selectedDay=c.getDate(),e.drawMonth=e.selectedMonth=c.getMonth(),e.drawYear=e.selectedYear=c.getFullYear()),this._notifyChange(e),this._adjustDate(d)},_selectMonthYear:function(b,c,d){var e=a(b),f=this._getInst(e[0]);f["selected"+("M"===d?"Month":"Year")]=f["draw"+("M"===d?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10),this._notifyChange(f),this._adjustDate(e)},_selectDay:function(b,c,d,e){var f,g=a(b);a(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(g[0])||(f=this._getInst(g[0]),f.selectedDay=f.currentDay=a("a",e).html(),f.selectedMonth=f.currentMonth=c,f.selectedYear=f.currentYear=d,this._selectDate(b,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(b){var c=a(b);this._selectDate(c,"")},_selectDate:function(b,c){var d,e=a(b),f=this._getInst(e[0]);c=null!=c?c:this._formatDate(f),f.input&&f.input.val(c),this._updateAlternate(f),d=this._get(f,"onSelect"),d?d.apply(f.input?f.input[0]:null,[c,f]):f.input&&f.input.trigger("change"),f.inline?this._updateDatepicker(f):(this._hideDatepicker(),this._lastInput=f.input[0],"object"!=typeof f.input[0]&&f.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c,d,e,f=this._get(b,"altField");f&&(c=this._get(b,"altFormat")||this._get(b,"dateFormat"),d=this._getDate(b),e=this.formatDate(c,d,this._getFormatConfig(b)),a(f).each(function(){a(this).val(e)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},iso8601Week:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},parseDate:function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(""===(c="object"==typeof c?""+c:c+""))return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=-1,q=-1,r=-1,s=-1,t=!1,u=function(a){var c=b.length>e+1&&b.charAt(e+1)===a;return c&&e++,c},v=function(a){var b=u(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e="y"===a?d:1,f=RegExp("^\\d{"+e+","+d+"}"),g=c.substring(i).match(f);if(!g)throw"Missing number at position "+i;return i+=g[0].length,parseInt(g[0],10)},w=function(b,d,e){var f=-1,g=a.map(u(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];return c.substr(i,d.length).toLowerCase()===d.toLowerCase()?(f=b[0],i+=d.length,!1):void 0}),-1!==f)return f+1;throw"Unknown name at position "+i},x=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;b.length>e;e++)if(t)"'"!==b.charAt(e)||u("'")?x():t=!1;else switch(b.charAt(e)){case"d":r=v("d");break;case"D":w("D",l,m);break;case"o":s=v("o");break;case"m":q=v("m");break;case"M":q=w("M",n,o);break;case"y":p=v("y");break;case"@":h=new Date(v("@")),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"!":h=new Date((v("!")-this._ticksTo1970)/1e4),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"'":u("'")?x():t=!0;break;default:x()}if(c.length>i&&(g=c.substr(i),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===p?p=(new Date).getFullYear():100>p&&(p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(k>=p?0:-100)),s>-1)for(q=1,r=s;!((f=this._getDaysInMonth(p,q-1))>=r);)q++,r-=f;if(h=this._daylightSavingAdjust(new Date(p,q-1,r)),h.getFullYear()!==p||h.getMonth()+1!==q||h.getDate()!==r)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d,e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=function(b){var c=a.length>d+1&&a.charAt(d+1)===b;return c&&d++,c},j=function(a,b,c){var d=""+b;if(i(a))for(;c>d.length;)d="0"+d;return d},k=function(a,b,c,d){return i(a)?d[b]:c[b]},l="",m=!1;if(b)for(d=0;a.length>d;d++)if(m)"'"!==a.charAt(d)||i("'")?l+=a.charAt(d):m=!1;else switch(a.charAt(d)){case"d":l+=j("d",b.getDate(),2);break;case"D":l+=k("D",b.getDay(),e,f);break;case"o":l+=j("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);break;case"m":l+=j("m",b.getMonth()+1,2);break;case"M":l+=k("M",b.getMonth(),g,h);break;case"y":l+=i("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case"@":l+=b.getTime();break;case"!":l+=1e4*b.getTime()+this._ticksTo1970;break;case"'":i("'")?l+="'":m=!0;break;default:l+=a.charAt(d)}return l},_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=a.length>b+1&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;a.length>b;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":c+="0123456789";break;case"D":case"M":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_get:function(a,b){return void 0!==a.settings[b]?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!==a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e=this._getDefaultDate(a),f=e,g=this._getFormatConfig(a);try{f=this.parseDate(c,d,g)||e}catch(a){d=b?"":d}a.selectedDay=f.getDate(),a.drawMonth=a.selectedMonth=f.getMonth(),a.drawYear=a.selectedYear=f.getFullYear(),a.currentDay=d?f.getDate():0,a.currentMonth=d?f.getMonth():0,a.currentYear=d?f.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,d){var e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(c){try{return a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),c,a.datepicker._getFormatConfig(b))}catch(a){}for(var d=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(c);i;){switch(i[2]||"d"){case"d":case"D":g+=parseInt(i[1],10);break;case"w":case"W":g+=7*parseInt(i[1],10);break;case"m":case"M":f+=parseInt(i[1],10),g=Math.min(g,a.datepicker._getDaysInMonth(e,f));break;case"y":case"Y":e+=parseInt(i[1],10),g=Math.min(g,a.datepicker._getDaysInMonth(e,f))}i=h.exec(c)}return new Date(e,f,g)},g=null==c||""===c?d:"string"==typeof c?f(c):"number"==typeof c?isNaN(c)?d:e(c):new Date(c.getTime());return g=g&&"Invalid Date"==""+g?d:g,g&&(g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),this._daylightSavingAdjust(g)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),e===a.selectedMonth&&f===a.selectedYear||c||this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""===a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},
_attachHandlers:function(b){var c=this._get(b,"stepMonths"),d="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){var b={prev:function(){a.datepicker._adjustDate(d,-c,"M")},next:function(){a.datepicker._adjustDate(d,+c,"M")},hide:function(){a.datepicker._hideDatepicker()},today:function(){a.datepicker._gotoToday(d)},selectDay:function(){return a.datepicker._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return a.datepicker._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a.datepicker._selectMonthYear(d,this,"Y"),!1}};a(this).bind(this.getAttribute("data-event"),b[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=new Date,P=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth(),O.getDate())),Q=this._get(a,"isRTL"),R=this._get(a,"showButtonPanel"),S=this._get(a,"hideIfNoPrevNext"),T=this._get(a,"navigationAsDateFormat"),U=this._getNumberOfMonths(a),V=this._get(a,"showCurrentAtPos"),W=this._get(a,"stepMonths"),X=1!==U[0]||1!==U[1],Y=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(a,"min"),$=this._getMinMaxDate(a,"max"),_=a.drawMonth-V,aa=a.drawYear;if(0>_&&(_+=12,aa--),$)for(b=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-U[0]*U[1]+1,$.getDate())),b=Z&&Z>b?Z:b;this._daylightSavingAdjust(new Date(aa,_,1))>b;)0>--_&&(_=11,aa--);for(a.drawMonth=_,a.drawYear=aa,c=this._get(a,"prevText"),c=T?this.formatDate(c,this._daylightSavingAdjust(new Date(aa,_-W,1)),this._getFormatConfig(a)):c,d=this._canAdjustMonth(a,-1,aa,_)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>":S?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>",e=this._get(a,"nextText"),e=T?this.formatDate(e,this._daylightSavingAdjust(new Date(aa,_+W,1)),this._getFormatConfig(a)):e,f=this._canAdjustMonth(a,1,aa,_)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>":S?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>",g=this._get(a,"currentText"),h=this._get(a,"gotoCurrent")&&a.currentDay?Y:P,g=T?this.formatDate(g,h,this._getFormatConfig(a)):g,i=a.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(a,"closeText")+"</button>",j=R?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Q?i:"")+(this._isInRange(a,h)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+g+"</button>":"")+(Q?"":i)+"</div>":"",k=parseInt(this._get(a,"firstDay"),10),k=isNaN(k)?0:k,l=this._get(a,"showWeek"),m=this._get(a,"dayNames"),n=this._get(a,"dayNamesMin"),o=this._get(a,"monthNames"),p=this._get(a,"monthNamesShort"),q=this._get(a,"beforeShowDay"),r=this._get(a,"showOtherMonths"),s=this._get(a,"selectOtherMonths"),t=this._getDefaultDate(a),u="",w=0;U[0]>w;w++){for(x="",this.maxRows=4,y=0;U[1]>y;y++){if(z=this._daylightSavingAdjust(new Date(aa,_,a.selectedDay)),A=" ui-corner-all",B="",X){if(B+="<div class='ui-datepicker-group",U[1]>1)switch(y){case 0:B+=" ui-datepicker-group-first",A=" ui-corner-"+(Q?"right":"left");break;case U[1]-1:B+=" ui-datepicker-group-last",A=" ui-corner-"+(Q?"left":"right");break;default:B+=" ui-datepicker-group-middle",A=""}B+="'>"}for(B+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?Q?f:d:"")+(/all|right/.test(A)&&0===w?Q?d:f:"")+this._generateMonthYearHeader(a,_,aa,Z,$,w>0||y>0,o,p)+"</div><table class='ui-datepicker-calendar'><thead><tr>",C=l?"<th class='ui-datepicker-week-col'>"+this._get(a,"weekHeader")+"</th>":"",v=0;7>v;v++)D=(v+k)%7,C+="<th scope='col'"+((v+k+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+m[D]+"'>"+n[D]+"</span></th>";for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(aa,_),aa===a.selectedYear&&_===a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,E)),F=(this._getFirstDayOfMonth(aa,_)-k+7)%7,G=Math.ceil((F+E)/7),H=X&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=this._daylightSavingAdjust(new Date(aa,_,1-F)),J=0;H>J;J++){for(B+="<tr>",K=l?"<td class='ui-datepicker-week-col'>"+this._get(a,"calculateWeek")(I)+"</td>":"",v=0;7>v;v++)L=q?q.apply(a.input?a.input[0]:null,[I]):[!0,""],M=I.getMonth()!==_,N=M&&!s||!L[0]||Z&&Z>I||$&&I>$,K+="<td class='"+((v+k+6)%7>=5?" ui-datepicker-week-end":"")+(M?" ui-datepicker-other-month":"")+(I.getTime()===z.getTime()&&_===a.selectedMonth&&a._keyEvent||t.getTime()===I.getTime()&&t.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" ui-state-disabled":"")+(M&&!r?"":" "+L[1]+(I.getTime()===Y.getTime()?" "+this._currentClass:"")+(I.getTime()===P.getTime()?" ui-datepicker-today":""))+"'"+(M&&!r||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='click' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!r?"&#xa0;":N?"<span class='ui-state-default'>"+I.getDate()+"</span>":"<a class='ui-state-default"+(I.getTime()===P.getTime()?" ui-state-highlight":"")+(I.getTime()===Y.getTime()?" ui-state-active":"")+(M?" ui-priority-secondary":"")+"' href='#'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I);B+=K+"</tr>"}_++,_>11&&(_=0,aa++),B+="</tbody></table>"+(X?"</div>"+(U[0]>0&&y===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=B}u+=x}return u+=j,a._keyEvent=!1,u},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this._get(a,"changeMonth"),r=this._get(a,"changeYear"),s=this._get(a,"showMonthAfterYear"),t="<div class='ui-datepicker-title'>",u="";if(f||!q)u+="<span class='ui-datepicker-month'>"+g[b]+"</span>";else{for(i=d&&d.getFullYear()===c,j=e&&e.getFullYear()===c,u+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=d.getMonth())&&(!j||e.getMonth()>=k)&&(u+="<option value='"+k+"'"+(k===b?" selected='selected'":"")+">"+h[k]+"</option>");u+="</select>"}if(s||(t+=u+(!f&&q&&r?"":"&#xa0;")),!a.yearshtml)if(a.yearshtml="",f||!r)t+="<span class='ui-datepicker-year'>"+c+"</span>";else{for(l=this._get(a,"yearRange").split(":"),m=(new Date).getFullYear(),n=function(a){var b=a.match(/c[+\-].*/)?c+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(b)?m:b},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=d?Math.max(o,d.getFullYear()):o,p=e?Math.min(p,e.getFullYear()):p,a.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)a.yearshtml+="<option value='"+o+"'"+(o===c?" selected='selected'":"")+">"+o+"</option>";a.yearshtml+="</select>",t+=a.yearshtml,a.yearshtml=null}return t+=this._get(a,"yearSuffix"),s&&(t+=(!f&&q&&r?"":"&#xa0;")+u),t+="</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"===c?b:0),e=a.drawMonth+("M"===c?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+("D"===c?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),("M"===c||"Y"===c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&c>b?c:b;return d&&e>d?d:e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(0>b?b:e[0]*e[1]),1));return 0>b&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c,d,e=this._getMinMaxDate(a,"min"),f=this._getMinMaxDate(a,"max"),g=null,h=null,i=this._get(a,"yearRange");return i&&(c=i.split(":"),d=(new Date).getFullYear(),g=parseInt(c[0],10),h=parseInt(c[1],10),c[0].match(/[+\-].*/)&&(g+=d),c[1].match(/[+\-].*/)&&(h+=d)),(!e||b.getTime()>=e.getTime())&&(!f||b.getTime()<=f.getTime())&&(!g||b.getFullYear()>=g)&&(!h||h>=b.getFullYear())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick),a.datepicker.initialized=!0),0===a("#"+a.datepicker._mainDivId).length&&a("body").append(a.datepicker.dpDiv);var c=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!==b&&"getDate"!==b&&"widget"!==b?"option"===b&&2===arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c))},a.datepicker=new e,a.datepicker.initialized=!1,a.datepicker.uuid=(new Date).getTime(),a.datepicker.version="1.11.2",a.datepicker,a.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c,d=this;if(this._isOpen&&!1!==this._trigger("beforeClose",b)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(c=this.document[0].activeElement)&&"body"!==c.nodeName.toLowerCase()&&a(c).blur()}catch(a){}this._hide(this.uiDialog,this.options.hide,function(){d._trigger("close",b)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(b,c){var d=!1,e=this.uiDialog.siblings(".ui-front:visible").map(function(){return+a(this).css("z-index")}).get(),f=Math.max.apply(null,e);return f>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",f+1),d=!0),d&&!c&&this._trigger("focus",b),d},open:function(){var b=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var a=this._focusedElement;a||(a=this.element.find("[autofocus]")),a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement;this.uiDialog[0]===b||a.contains(this.uiDialog[0],b)||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),void this.close(b);if(b.keyCode===a.ui.keyCode.TAB&&!b.isDefaultPrevented()){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(this._delay(function(){e.focus()}),b.preventDefault()):(this._delay(function(){d.focus()}),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){var g=f.offset.left-c.document.scrollLeft(),h=f.offset.top-c.document.scrollTop();d.position={my:"left top",at:"left"+(g>=0?"+":"")+g+" top"+(h>=0?"+":"")+h,of:c.window},a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){var g=c.uiDialog.offset(),h=g.left-c.document.scrollLeft(),i=g.top-c.document.scrollTop();d.height=c.uiDialog.height(),d.width=c.uiDialog.width(),d.position={my:"left top",at:"left"+(h>=0?"+":"")+h+" top"+(i>=0?"+":"")+i,of:c.window},a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_trackFocus:function(){this._on(this.widget(),{focusin:function(b){this._makeFocusTarget(),this._focusedElement=a(b.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var b=this._trackingInstances(),c=a.inArray(this,b);-1!==c&&b.splice(c,1)},_trackingInstances:function(){var a=this.document.data("ui-dialog-instances");return a||(a=[],this.document.data("ui-dialog-instances",a)),a},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(b){var c=this,d=!1,e={};a.each(b,function(a,b){c._setOption(a,b),a in c.sizeRelatedOptions&&(d=!0),a in c.resizableRelatedOptions&&(e[a]=b)}),d&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",e)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||!1===b||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return!!a(b.target).closest(".ui-dialog").length||!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=!0;this._delay(function(){b=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(a){b||this._allowInteraction(a)||(a.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var a=this.document.data("ui-dialog-overlays")-1;a?this.document.data("ui-dialog-overlays",a):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),a.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(a){return void 0===a?this.options.value:(this.options.value=this._constrainedValue(a),void this._refreshValue())},_constrainedValue:function(a){return void 0===a&&(a=this.options.value),this.indeterminate=!1===a,"number"!=typeof a&&(a=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,a))},_setOptions:function(a){var b=a.value;delete a.value,this._super(a),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(a,b){"max"===a&&(b=Math.max(this.min,b)),"disabled"===a&&this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var b=this.options.value,c=this._percentage();this.valueDiv.toggle(this.indeterminate||b>this.min).toggleClass("ui-corner-right",b===this.options.max).width(c.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=a("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":b}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==b&&(this.oldValue=b,this._trigger("change")),b===this.options.max&&this._trigger("complete")}}),a.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var a=this.element.uniqueId().attr("id");this.ids={element:a,button:a+"-button",menu:a+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var b=this,c=this.element.attr("tabindex");this.label=a("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(a){this.button.focus(),a.preventDefault()}}),this.element.hide(),this.button=a("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:c||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),a("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=a("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){b.menuItems||b._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var b=this;this.menu=a("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=a("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(a,c){a.preventDefault(),b._setSelection(),b._select(c.item.data("ui-selectmenu-item"),a)},focus:function(a,c){var d=c.item.data("ui-selectmenu-item");null!=b.focusIndex&&d.index!==b.focusIndex&&(b._trigger("focus",a,{item:d}),b.isOpen||b._select(d,a)),b.focusIndex=d.index,b.button.attr("aria-activedescendant",b.menuItems.eq(d.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var a,b=this.element.find("option");b.length&&(this._parseOptions(b),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),a=this._getSelectedItem(),this.menuInstance.focus(null,a),this._setAria(a.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(a){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",a))},_position:function(){this.menuWrap.position(a.extend({of:this.button},this.options.position))},close:function(a){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",a))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(b,c){var d=this,e="";a.each(c,function(c,f){f.optgroup!==e&&(a("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(f.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:f.optgroup}).appendTo(b),e=f.optgroup),d._renderItemData(b,f)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-selectmenu-item",b)},_renderItem:function(b,c){var d=a("<li>");return c.disabled&&d.addClass("ui-state-disabled"),this._setText(d,c.label),d.appendTo(b)},_setText:function(a,b){b?a.text(b):a.html("&#160;")},_move:function(a,b){var c,d,e=".ui-menu-item";this.isOpen?c=this.menuItems.eq(this.focusIndex):(c=this.menuItems.eq(this.element[0].selectedIndex),e+=":not(.ui-state-disabled)"),d="first"===a||"last"===a?c["first"===a?"prevAll":"nextAll"](e).eq(-1):c[a+"All"](e).eq(0),d.length&&this.menuInstance.focus(b,d)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(a){this[this.isOpen?"close":"open"](a)},_setSelection:function(){var a;this.range&&(window.getSelection?(a=window.getSelection(),a.removeAllRanges(),a.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(b){this.isOpen&&(a(b.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(b))}},_buttonEvents:{mousedown:function(){var a;window.getSelection?(a=window.getSelection(),a.rangeCount&&(this.range=a.getRangeAt(0))):this.range=document.selection.createRange()},click:function(a){this._setSelection(),this._toggle(a)},keydown:function(b){var c=!0;switch(b.keyCode){case a.ui.keyCode.TAB:case a.ui.keyCode.ESCAPE:this.close(b),c=!1;break;case a.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(b);break;case a.ui.keyCode.UP:b.altKey?this._toggle(b):this._move("prev",b);break;case a.ui.keyCode.DOWN:b.altKey?this._toggle(b):this._move("next",b);break;case a.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(b):this._toggle(b);break;case a.ui.keyCode.LEFT:this._move("prev",b);break;case a.ui.keyCode.RIGHT:this._move("next",b);break;case a.ui.keyCode.HOME:case a.ui.keyCode.PAGE_UP:this._move("first",b);break;case a.ui.keyCode.END:case a.ui.keyCode.PAGE_DOWN:this._move("last",b);break;default:this.menu.trigger(b),c=!1}c&&b.preventDefault()}},_selectFocusedItem:function(a){var b=this.menuItems.eq(this.focusIndex);b.hasClass("ui-state-disabled")||this._select(b.data("ui-selectmenu-item"),a)},_select:function(a,b){var c=this.element[0].selectedIndex;this.element[0].selectedIndex=a.index,this._setText(this.buttonText,a.label),this._setAria(a),this._trigger("select",b,{item:a}),a.index!==c&&this._trigger("change",b,{item:a}),this.close(b)},_setAria:function(a){var b=this.menuItems.eq(a.index).attr("id");this.button.attr({"aria-labelledby":b,"aria-activedescendant":b}),this.menu.attr("aria-activedescendant",b)},_setOption:function(a,b){"icons"===a&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(b.button),this._super(a,b),"appendTo"===a&&this.menuWrap.appendTo(this._appendTo()),"disabled"===a&&(this.menuInstance.option("disabled",b),this.button.toggleClass("ui-state-disabled",b).attr("aria-disabled",b),this.element.prop("disabled",b),b?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===a&&this._resizeButton()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b&&b[0]||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var a=this.options.width;a||(a=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(a)},_resizeMenu:function(){
this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(b){var c=[];b.each(function(b,d){var e=a(d),f=e.parent("optgroup");c.push({element:e,index:b,value:e.attr("value"),label:e.text(),optgroup:f.attr("label")||"",disabled:f.prop("disabled")||e.prop("disabled")})}),this.items=c},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),a.widget("ui.slider",a.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)f.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=e.add(a(f.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(!0===b.range&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j=this,k=this.options;return!k.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-j.values(b));(e>c||e===c&&(b===j._lastChangedValue||j.values(b)===k.min))&&(e=c,f=a(this),g=b)}),!1!==this._start(b,g)&&(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),h=f.offset(),i=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=i?{left:0,top:0}:{left:b.pageX-h.left-f.width()/2,top:b.pageY-h.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&!0===this.options.range&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),!1!==f&&this.values(b,c))):c!==this.value()&&!1!==(f=this._trigger("slide",a,{handle:this.handles[b],value:c}))&&this.value(c)},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;d.length>f;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&!0===this.options.range&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),"disabled"===b&&this.element.toggleClass("ui-state-disabled",!!c),this._super(b,c),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===c?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_calculateNewMax:function(){var a=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-a},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=!this._animateOff&&h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),!0===i.options.range&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(b){var c,d,e,f=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),!1===this._start(b,f)))return}switch(e=this.options.step,c=d=this.options.values&&this.options.values.length?this.values(f):this.value(),b.keyCode){case a.ui.keyCode.HOME:d=this._valueMin();break;case a.ui.keyCode.END:d=this._valueMax();break;case a.ui.keyCode.PAGE_UP:d=this._trimAlignValue(c+(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.PAGE_DOWN:d=this._trimAlignValue(c-(this._valueMax()-this._valueMin())/this.numPages);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(c===this._valueMax())return;d=this._trimAlignValue(c+e);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c===this._valueMin())return;d=this._trimAlignValue(c-e)}this._slide(b,f,d)},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}}),a.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var b={},c=this.element;return a.each(["min","max","step"],function(a,d){var e=c.attr(d);void 0!==e&&e.length&&(b[d]=e)}),b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",a)))},mousewheel:function(a,b){if(b){if(!this.spinning&&!this._start(a))return!1;this._spin((b>0?1:-1)*this.options.step,a),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100),a.preventDefault()}},"mousedown .ui-spinner-button":function(b){function c(){this.element[0]===this.document[0].activeElement||(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d}))}var d;d=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),b.preventDefault(),c.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,c.call(this)}),!1!==this._start(b)&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){return a(b.currentTarget).hasClass("ui-state-active")?!1!==this._start(b)&&void this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*a.height())&&a.height()>0&&a.height(a.height()),this.options.disabled&&this.disable()},_keydown:function(b){var c=this.options,d=a.ui.keyCode;switch(b.keyCode){case d.UP:return this._repeat(null,1,b),!0;case d.DOWN:return this._repeat(null,-1,b),!0;case d.PAGE_UP:return this._repeat(null,c.page,b),!0;case d.PAGE_DOWN:return this._repeat(null,-c.page,b),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){return!(!this.spinning&&!1===this._trigger("start",a))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(a,b,c){a=a||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,c)},a),this._spin(b*this.options.step,c)},_spin:function(a,b){var c=this.value()||0;this.counter||(this.counter=1),c=this._adjustValue(c+a*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",b,{value:c})||(this._value(c),this.counter++)},_increment:function(b){var c=this.options.incremental;return c?a.isFunction(c)?c(b):Math.floor(b*b*b/5e4-b*b/500+17*b/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){var b=""+a,c=b.indexOf(".");return-1===c?0:b.length-c-1},_adjustValue:function(a){var b,c,d=this.options;return b=null!==d.min?d.min:0,c=a-b,c=Math.round(c/d.step)*d.step,a=b+c,a=parseFloat(a.toFixed(this._precision())),null!==d.max&&a>d.max?d.max:null!==d.min&&d.min>a?d.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,b){if("culture"===a||"numberFormat"===a){var c=this._parse(this.element.val());return this.options[a]=b,void this.element.val(this._format(c))}("max"===a||"min"===a||"step"===a)&&"string"==typeof b&&(b=this._parse(b)),"icons"===a&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(b.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(b.down)),this._super(a,b),"disabled"===a&&(this.widget().toggleClass("ui-state-disabled",!!b),this.element.prop("disabled",!!b),this.buttons.button(b?"disable":"enable"))},_setOptions:i(function(a){this._super(a)}),_parse:function(a){return"string"==typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a),""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var a=this.value();return null!==a&&a===this._adjustValue(a)},_value:function(a,b){var c;""!==a&&null!==(c=this._parse(a))&&(b||(c=this._adjustValue(c)),a=this._format(c)),this.element.val(a),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:i(function(a){this._stepUp(a)}),_stepUp:function(a){this._start()&&(this._spin((a||1)*this.options.step),this._stop())},stepDown:i(function(a){this._stepDown(a)}),_stepDown:function(a){this._start()&&(this._spin((a||1)*-this.options.step),this._stop())},pageUp:i(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:i(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){return arguments.length?void i(this._value).call(this,a):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),a.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var a=/#.*$/;return function(b){var c,d;b=b.cloneNode(!1),c=b.href.replace(a,""),d=location.href.replace(a,"");try{c=decodeURIComponent(c)}catch(a){}try{d=decodeURIComponent(d)}catch(a){}return b.hash.length>1&&c===d}}(),_create:function(){var b=this,c=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",c.collapsible),this._processTabs(),c.active=this._initialActive(),a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(c.active):a(),this._refresh(),this.active.length&&this.load(c.active)},_initialActive:function(){var b=this.options.active,c=this.options.collapsible,d=location.hash.substring(1);return null===b&&(d&&this.tabs.each(function(c,e){return a(e).attr("aria-controls")===d?(b=c,!1):void 0}),null===b&&(b=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===b||-1===b)&&(b=!!this.tabs.length&&0)),!1!==b&&-1===(b=this.tabs.index(this.tabs.eq(b)))&&(b=!c&&0),!c&&!1===b&&this.anchors.length&&(b=0),b},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var c=a(this.document[0].activeElement).closest("li"),d=this.tabs.index(c),e=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:d++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:e=!1,d--;break;case a.ui.keyCode.END:d=this.anchors.length-1;break;case a.ui.keyCode.HOME:d=0;break;case a.ui.keyCode.SPACE:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d);case a.ui.keyCode.ENTER:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d!==this.options.active&&d);default:return}b.preventDefault(),clearTimeout(this.activating),d=this._focusNextTab(d,e),b.ctrlKey||(c.attr("aria-selected","false"),this.tabs.eq(d).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",d)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},_handlePageNav:function(b){return b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(b,c){function d(){return b>e&&(b=0),0>b&&(b=e),b}for(var e=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,b){return"active"===a?void this._activate(b):"disabled"===a?void this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),b||!1!==this.options.active||this._activate(0)),"event"===a&&this._setupEvents(b),void("heightStyle"===a&&this._setupHeightStyle(b)))},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)}),this._processTabs(),!1!==b.active&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this,c=this.tabs,d=this.anchors,e=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=a(),this.anchors.each(function(c,d){var e,f,g,h=a(d).uniqueId().attr("id"),i=a(d).closest("li"),j=i.attr("aria-controls");b._isLocal(d)?(e=d.hash,g=e.substring(1),f=b.element.find(b._sanitizeSelector(e))):(g=i.attr("aria-controls")||a({}).uniqueId()[0].id,e="#"+g,f=b.element.find(e),f.length||(f=b._createPanel(g),f.insertAfter(b.panels[c-1]||b.tablist)),f.attr("aria-live","polite")),f.length&&(b.panels=b.panels.add(f)),j&&i.data("ui-tabs-aria-controls",j),i.attr({"aria-controls":g,"aria-labelledby":h}),f.attr("aria-labelledby",h)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),c&&(this._off(c.not(this.tabs)),this._off(d.not(this.anchors)),this._off(e.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c,d=0;c=this.tabs[d];d++)!0===b||-1!==a.inArray(d,b)?a(c).addClass("ui-state-disabled").attr("aria-disabled","true"):a(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var c={};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(a){a.preventDefault()}}),this._on(this.anchors,c),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,d=this.element.parent();"fill"===b?(c=d.height(),c-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e.closest("li"),g=f[0]===d[0],h=g&&c.collapsible,i=h?a():this._getPanelForTab(f),j=d.length?this._getPanelForTab(d):a(),k={oldTab:d,oldPanel:j,newTab:h?a():f,newPanel:i};b.preventDefault(),f.hasClass("ui-state-disabled")||f.hasClass("ui-tabs-loading")||this.running||g&&!c.collapsible||!1===this._trigger("beforeActivate",b,k)||(c.active=!h&&this.tabs.index(f),this.active=g?a():f,this.xhr&&this.xhr.abort(),j.length||i.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),i.length&&this.load(this.tabs.index(f),b),this._toggle(b,k))},_toggle:function(b,c){function d(){f.running=!1,f._trigger("activate",b,c)}function e(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),g.length&&f.options.show?f._show(g,f.options.show,d):(g.show(),d())}var f=this,g=c.newPanel,h=c.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),e()),h.attr("aria-hidden","true"),c.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),g.attr("aria-hidden","false"),c.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(b){var c,d=this._findActive(b);d[0]!==this.active[0]&&(d.length||(d=this.active),c=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return!1===b?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(b){var c=this.options.disabled;!1!==c&&(void 0===b?c=!1:(b=this._getIndex(b),c=a.isArray(c)?a.map(c,function(a){return a!==b?a:null}):a.map(this.tabs,function(a,c){return c!==b?c:null})),this._setupDisabled(c))},disable:function(b){var c=this.options.disabled;if(!0!==c){if(void 0===b)c=!0;else{if(b=this._getIndex(b),-1!==a.inArray(b,c))return;c=a.isArray(c)?a.merge([b],c).sort():[b]}this._setupDisabled(c)}},load:function(b,c){b=this._getIndex(b);var d=this,e=this.tabs.eq(b),f=e.find(".ui-tabs-anchor"),g=this._getPanelForTab(e),h={tab:e,panel:g};this._isLocal(f[0])||(this.xhr=a.ajax(this._ajaxSettings(f,c,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(e.addClass("ui-tabs-loading"),g.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){g.html(a),d._trigger("load",c,h)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&d.panels.stop(!1,!0),e.removeClass("ui-tabs-loading"),g.removeAttr("aria-busy"),a===d.xhr&&delete d.xhr},1)})))},_ajaxSettings:function(b,c,d){var e=this;return{url:b.attr("href"),beforeSend:function(b,f){return e._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},d))}}},_getPanelForTab:function(b){var c=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+c))}}),a.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var b=a(this).attr("title")||"";return a("<a>").text(b).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(b,c){var d=(b.attr("aria-describedby")||"").split(/\s+/);d.push(c),b.data("ui-tooltip-id",c).attr("aria-describedby",a.trim(d.join(" ")))},_removeDescribedBy:function(b){var c=b.data("ui-tooltip-id"),d=(b.attr("aria-describedby")||"").split(/\s+/),e=a.inArray(c,d);-1!==e&&d.splice(e,1),b.removeData("ui-tooltip-id"),d=a.trim(d.join(" ")),d?b.attr("aria-describedby",d):b.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=a("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(b,c){var d=this;return"disabled"===b?(this[c?"_disable":"_enable"](),void(this.options[b]=c)):(this._super(b,c),void("content"===b&&a.each(this.tooltips,function(a,b){d._updateContent(b.element)})))},_disable:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d.element[0],b.close(e,!0)}),this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},open:function(b){var c=this,d=a(b?b.target:this.element).closest(this.options.items);d.length&&!d.data("ui-tooltip-id")&&(d.attr("title")&&d.data("ui-tooltip-title",d.attr("title")),d.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&d.parents().each(function(){var b,d=a(this);d.data("ui-tooltip-open")&&(b=a.Event("blur"),b.target=b.currentTarget=this,c.close(b,!0)),d.attr("title")&&(d.uniqueId(),c.parents[this.id]={element:this,title:d.attr("title")},d.attr("title",""))}),this._updateContent(d,b))},_updateContent:function(a,b){var c,d=this.options.content,e=this,f=b?b.type:null;return"string"==typeof d?this._open(b,a,d):void((c=d.call(a[0],function(c){a.data("ui-tooltip-open")&&e._delay(function(){b&&(b.type=f),this._open(b,a,c)})}))&&this._open(b,a,c))},_open:function(b,c,d){function e(a){k.of=a,g.is(":hidden")||g.position(k)}var f,g,h,i,j,k=a.extend({},this.options.position);if(d){if(f=this._find(c))return void f.tooltip.find(".ui-tooltip-content").html(d);c.is("[title]")&&(b&&"mouseover"===b.type?c.attr("title",""):c.removeAttr("title")),f=this._tooltip(c),
g=f.tooltip,this._addDescribedBy(c,g.attr("id")),g.find(".ui-tooltip-content").html(d),this.liveRegion.children().hide(),d.clone?(j=d.clone(),j.removeAttr("id").find("[id]").removeAttr("id")):j=d,a("<div>").html(j).appendTo(this.liveRegion),this.options.track&&b&&/^mouse/.test(b.type)?(this._on(this.document,{mousemove:e}),e(b)):g.position(a.extend({of:c},this.options.position)),g.hide(),this._show(g,this.options.show),this.options.show&&this.options.show.delay&&(i=this.delayedShow=setInterval(function(){g.is(":visible")&&(e(k.of),clearInterval(i))},a.fx.interval)),this._trigger("open",b,{tooltip:g}),h={keyup:function(b){if(b.keyCode===a.ui.keyCode.ESCAPE){var d=a.Event(b);d.currentTarget=c[0],this.close(d,!0)}}},c[0]!==this.element[0]&&(h.remove=function(){this._removeTooltip(g)}),b&&"mouseover"!==b.type||(h.mouseleave="close"),b&&"focusin"!==b.type||(h.focusout="close"),this._on(!0,c,h)}},close:function(b){var c,d=this,e=a(b?b.currentTarget:this.element),f=this._find(e);f&&(c=f.tooltip,f.closing||(clearInterval(this.delayedShow),e.data("ui-tooltip-title")&&!e.attr("title")&&e.attr("title",e.data("ui-tooltip-title")),this._removeDescribedBy(e),f.hiding=!0,c.stop(!0),this._hide(c,this.options.hide,function(){d._removeTooltip(a(this))}),e.removeData("ui-tooltip-open"),this._off(e,"mouseleave focusout keyup"),e[0]!==this.element[0]&&this._off(e,"remove"),this._off(this.document,"mousemove"),b&&"mouseleave"===b.type&&a.each(this.parents,function(b,c){a(c.element).attr("title",c.title),delete d.parents[b]}),f.closing=!0,this._trigger("close",b,{tooltip:c}),f.hiding||(f.closing=!1)))},_tooltip:function(b){var c=a("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),d=c.uniqueId().attr("id");return a("<div>").addClass("ui-tooltip-content").appendTo(c),c.appendTo(this.document[0].body),this.tooltips[d]={element:b,tooltip:c}},_find:function(a){var b=a.data("ui-tooltip-id");return b?this.tooltips[b]:null},_removeTooltip:function(a){a.remove(),delete this.tooltips[a.attr("id")]},_destroy:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur"),f=d.element;e.target=e.currentTarget=f[0],b.close(e,!0),a("#"+c).remove(),f.data("ui-tooltip-title")&&(f.attr("title")||f.attr("title",f.data("ui-tooltip-title")),f.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var s="ui-effects-",t=a;a.effects={effect:{}},function(a,b){function c(a,b,c){var d=k[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:a>d.max?d.max:a)}function d(c){var d=i(),e=d._rgba=[];return c=c.toLowerCase(),n(h,function(a,f){var g,h=f.re.exec(c),i=h&&f.parse(h),k=f.space||"rgba";return i?(g=d[k](i),d[j[k].cache]=g[j[k].cache],e=d._rgba=g._rgba,!1):b}),e.length?("0,0,0,0"===e.join()&&a.extend(e,f.transparent),d):f[c]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var f,g=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],i=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},j={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},k={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=i.support={},m=a("<p>")[0],n=a.each;m.style.cssText="background-color:rgba(1,1,1,.5)",l.rgba=m.style.backgroundColor.indexOf("rgba")>-1,n(j,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),i.fn=a.extend(i.prototype,{parse:function(e,g,h,k){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(g),g=b);var l=this,m=a.type(e),o=this._rgba=[];return g!==b&&(e=[e,g,h,k],m="array"),"string"===m?this.parse(d(e)||f._default):"array"===m?(n(j.rgba.props,function(a,b){o[b.idx]=c(e[b.idx],b)}),this):"object"===m?(e instanceof i?n(j,function(a,b){e[b.cache]&&(l[b.cache]=e[b.cache].slice())}):n(j,function(b,d){var f=d.cache;n(d.props,function(a,b){if(!l[f]&&d.to){if("alpha"===a||null==e[a])return;l[f]=d.to(l._rgba)}l[f][b.idx]=c(e[a],b,!0)}),l[f]&&0>a.inArray(null,l[f].slice(0,3))&&(l[f][3]=1,d.from&&(l._rgba=d.from(l[f])))}),this):b},is:function(a){var c=i(a),d=!0,e=this;return n(j,function(a,f){var g,h=c[f.cache];return h&&(g=e[f.cache]||f.to&&f.to(e._rgba)||[],n(f.props,function(a,c){return null!=h[c.idx]?d=h[c.idx]===g[c.idx]:b})),d}),d},_space:function(){var a=[],b=this;return n(j,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=i(a),e=d._space(),f=j[e],g=0===this.alpha()?i("transparent"):this,h=g[f.cache]||f.to(g._rgba),l=h.slice();return d=d[f.cache],n(f.props,function(a,e){var f=e.idx,g=h[f],i=d[f],j=k[e.type]||{};null!==i&&(null===g?l[f]=i:(j.mod&&(i-g>j.mod/2?g+=j.mod:g-i>j.mod/2&&(g-=j.mod)),l[f]=c((i-g)*b+g,e)))}),this[e](l)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=i(b)._rgba;return i(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),i.fn.parse.prototype=i.fn,j.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===j?0:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},j.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},n(j,function(d,e){var f=e.props,h=e.cache,j=e.to,k=e.from;i.fn[d]=function(d){if(j&&!this[h]&&(this[h]=j(this._rgba)),d===b)return this[h].slice();var e,g=a.type(d),l="array"===g||"object"===g?d:arguments,m=this[h].slice();return n(f,function(a,b){var d=l["object"===g?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=i(k(m)),e[h]=m,e):i(m)},n(f,function(b,c){i.fn[b]||(i.fn[b]=function(e){var f,h=a.type(e),i="alpha"===b?this._hsla?"hsla":"rgba":d,j=this[i](),k=j[c.idx];return"undefined"===h?k:("function"===h&&(e=e.call(this,k),h=a.type(e)),null==e&&c.empty?this:("string"===h&&(f=g.exec(e))&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1)),j[c.idx]=e,this[i](j)))})})}),i.hook=function(b){var c=b.split(" ");n(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=i(f||e),!l.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(a){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(a){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=i(b.elem,c),b.end=i(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},i.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),a.cssHooks.borderColor={expand:function(a){var b={};return n(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},f=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(t),function(){function b(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]])for(d=e.length;d--;)c=e[d],"string"==typeof e[c]&&(f[a.camelCase(c)]=e[c]);else for(c in e)"string"==typeof e[c]&&(f[c]=e[c]);return f}function c(b,c){var d,f,g={};for(d in c)f=c[d],b[d]!==f&&(e[d]||(a.fx.step[d]||!isNaN(parseFloat(f)))&&(g[d]=f));return g}var d=["add","remove","toggle"],e={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(t.style(a.elem,c,a.end),a.setAttr=!0)}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(e,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").addBack():g;j=j.map(function(){return{el:a(this),start:b(this)}}),f=function(){a.each(d,function(a,b){e[b]&&g[b+"Class"](e[b])})},f(),j=j.map(function(){return this.end=b(this.el[0]),this.diff=c(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(b){return function(c,d,e,f,g){return"boolean"==typeof d||void 0===d?e?a.effects.animateClass.call(this,d?{add:c}:{remove:c},e,f,g):b.apply(this,arguments):a.effects.animateClass.call(this,{toggle:c},d,e,f)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function b(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function c(b){return!(b&&"number"!=typeof b&&!a.fx.speeds[b])||("string"==typeof b&&!a.effects.effect[b]||(!!a.isFunction(b)||"object"==typeof b&&!b.effect))}a.extend(a.effects,{version:"1.11.2",save:function(a,b){for(var c=0;b.length>c;c++)null!==b[c]&&a.data(s+b[c],a[0].style[b[c]])},restore:function(a,b){var c,d;for(d=0;b.length>d;d++)null!==b[d]&&(c=a.data(s+b[d]),void 0===c&&(c=""),a.css(b[d],c))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),float:b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(a){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function c(b){function c(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=d.complete,h=d.mode;(e.is(":hidden")?"hide"===h:"show"===h)?(e[h](),c()):g.call(e[0],d,c)}var d=b.apply(this,arguments),e=d.mode,f=d.queue,g=a.effects.effect[d.effect];return a.fx.off||!g?e?this[e](d.duration,d.complete):this.each(function(){d.complete&&d.complete.call(this)}):!1===f?this.each(c):this.queue(f||"fx",c)},show:function(a){return function(d){if(c(d))return a.apply(this,arguments);var e=b.apply(this,arguments);return e.mode="show",this.effect.call(this,e)}}(a.fn.show),hide:function(a){return function(d){if(c(d))return a.apply(this,arguments);var e=b.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)}}(a.fn.hide),toggle:function(a){return function(d){if(c(d)||"boolean"==typeof d)return a.apply(this,arguments);var e=b.apply(this,arguments);return e.mode="toggle",this.effect.call(this,e)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;((b=Math.pow(2,--c))-1)/11>a;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}(),a.effects,a.effects.effect.blind=function(b,c){var d,e,f,g=a(this),h=/up|down|vertical/,i=/up|left|vertical|horizontal/,j=["position","top","bottom","left","right","height","width"],k=a.effects.setMode(g,b.mode||"hide"),l=b.direction||"up",m=h.test(l),n=m?"height":"width",o=m?"top":"left",p=i.test(l),q={},r="show"===k;g.parent().is(".ui-effects-wrapper")?a.effects.save(g.parent(),j):a.effects.save(g,j),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e=d[n](),f=parseFloat(d.css(o))||0,q[n]=r?e:0,p||(g.css(m?"bottom":"right",0).css(m?"top":"left","auto").css({position:"absolute"}),q[o]=r?f:e+f),r&&(d.css(n,0),p||d.css(o,f+e)),d.animate(q,{duration:b.duration,easing:b.easing,queue:!1,complete:function(){"hide"===k&&g.hide(),a.effects.restore(g,j),a.effects.removeWrapper(g),c()}})},a.effects.effect.bounce=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"effect"),j="hide"===i,k="show"===i,l=b.direction||"up",m=b.distance,n=b.times||5,o=2*n+(k||j?1:0),p=b.duration/o,q=b.easing,r="up"===l||"down"===l?"top":"left",s="up"===l||"left"===l,t=g.queue(),u=t.length;for((k||j)&&h.push("opacity"),a.effects.save(g,h),g.show(),a.effects.createWrapper(g),m||(m=g["top"===r?"outerHeight":"outerWidth"]()/3),k&&(f={opacity:1},f[r]=0,g.css("opacity",0).css(r,s?2*-m:2*m).animate(f,p,q)),j&&(m/=Math.pow(2,n-1)),f={},f[r]=0,d=0;n>d;d++)e={},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q).animate(f,p,q),m=j?2*m:m/2;j&&(e={opacity:0},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q)),g.queue(function(){j&&g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}),u>1&&t.splice.apply(t,[1,0].concat(t.splice(u,o+1))),g.dequeue()},a.effects.effect.clip=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"hide"),j="show"===i,k=b.direction||"vertical",l="vertical"===k,m=l?"height":"width",n=l?"top":"left",o={};a.effects.save(g,h),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e="IMG"===g[0].tagName?d:g,f=e[m](),j&&(e.css(m,0),e.css(n,f/2)),o[m]=j?f:0,o[n]=j?0:f/2,e.animate(o,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){j||g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}})},a.effects.effect.drop=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","opacity","height","width"],g=a.effects.setMode(e,b.mode||"hide"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i?"pos":"neg",l={opacity:h?1:0};a.effects.save(e,f),e.show(),a.effects.createWrapper(e),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0)/2,h&&e.css("opacity",0).css(j,"pos"===k?-d:d),l[j]=(h?"pos"===k?"+=":"-=":"pos"===k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})},a.effects.effect.explode=function(b,c){function d(){t.push(this),t.length===l*m&&e()}function e(){n.css({visibility:"visible"}),a(t).remove(),p||n.hide(),c()}var f,g,h,i,j,k,l=b.pieces?Math.round(Math.sqrt(b.pieces)):3,m=l,n=a(this),o=a.effects.setMode(n,b.mode||"hide"),p="show"===o,q=n.show().css("visibility","hidden").offset(),r=Math.ceil(n.outerWidth()/m),s=Math.ceil(n.outerHeight()/l),t=[];for(f=0;l>f;f++)for(i=q.top+f*s,k=f-(l-1)/2,g=0;m>g;g++)h=q.left+g*r,j=g-(m-1)/2,n.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*r,top:-f*s}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:r,height:s,left:h+(p?j*r:0),top:i+(p?k*s:0),opacity:p?0:1}).animate({left:h+(p?0:j*r),top:i+(p?0:k*s),opacity:p?1:0},b.duration||500,b.easing,d)},a.effects.effect.fade=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"toggle");d.animate({opacity:e},{queue:!1,duration:b.duration,easing:b.easing,complete:c})},a.effects.effect.fold=function(b,c){var d,e,f=a(this),g=["position","top","bottom","left","right","height","width"],h=a.effects.setMode(f,b.mode||"hide"),i="show"===h,j="hide"===h,k=b.size||15,l=/([0-9]+)%/.exec(k),m=!!b.horizFirst,n=i!==m,o=n?["width","height"]:["height","width"],p=b.duration/2,q={},r={};a.effects.save(f,g),f.show(),d=a.effects.createWrapper(f).css({overflow:"hidden"}),e=n?[d.width(),d.height()]:[d.height(),d.width()],l&&(k=parseInt(l[1],10)/100*e[j?0:1]),i&&d.css(m?{height:0,width:k}:{height:k,width:0}),q[o[0]]=i?e[0]:k,r[o[1]]=i?e[1]:0,d.animate(q,p,b.easing).animate(r,p,b.easing,function(){j&&f.hide(),a.effects.restore(f,g),a.effects.removeWrapper(f),c()})},a.effects.effect.highlight=function(b,c){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,b.mode||"show"),g={backgroundColor:d.css("backgroundColor")};"hide"===f&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&d.hide(),a.effects.restore(d,e),c()}})},a.effects.effect.size=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","width","height","overflow","opacity"],i=["position","top","bottom","left","right","overflow","opacity"],j=["width","height","overflow"],k=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],m=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=a.effects.setMode(g,b.mode||"effect"),o=b.restore||"effect"!==n,p=b.scale||"both",q=b.origin||["middle","center"],r=g.css("position"),s=o?h:i,t={height:0,width:0,outerHeight:0,outerWidth:0};"show"===n&&g.show(),d={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()},"toggle"===b.mode&&"show"===n?(g.from=b.to||t,g.to=b.from||d):(g.from=b.from||("show"===n?t:d),g.to=b.to||("hide"===n?t:d)),f={from:{y:g.from.height/d.height,x:g.from.width/d.width},to:{y:g.to.height/d.height,x:g.to.width/d.width}},("box"===p||"both"===p)&&(f.from.y!==f.to.y&&(s=s.concat(l),g.from=a.effects.setTransition(g,l,f.from.y,g.from),g.to=a.effects.setTransition(g,l,f.to.y,g.to)),f.from.x!==f.to.x&&(s=s.concat(m),g.from=a.effects.setTransition(g,m,f.from.x,g.from),g.to=a.effects.setTransition(g,m,f.to.x,g.to))),("content"===p||"both"===p)&&f.from.y!==f.to.y&&(s=s.concat(k).concat(j),g.from=a.effects.setTransition(g,k,f.from.y,g.from),g.to=a.effects.setTransition(g,k,f.to.y,g.to)),a.effects.save(g,s),g.show(),a.effects.createWrapper(g),g.css("overflow","hidden").css(g.from),q&&(e=a.effects.getBaseline(q,d),g.from.top=(d.outerHeight-g.outerHeight())*e.y,g.from.left=(d.outerWidth-g.outerWidth())*e.x,g.to.top=(d.outerHeight-g.to.outerHeight)*e.y,g.to.left=(d.outerWidth-g.to.outerWidth)*e.x),g.css(g.from),("content"===p||"both"===p)&&(l=l.concat(["marginTop","marginBottom"]).concat(k),m=m.concat(["marginLeft","marginRight"]),j=h.concat(l).concat(m),g.find("*[width]").each(function(){var c=a(this),d={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()};o&&a.effects.save(c,j),c.from={height:d.height*f.from.y,width:d.width*f.from.x,outerHeight:d.outerHeight*f.from.y,outerWidth:d.outerWidth*f.from.x},c.to={height:d.height*f.to.y,width:d.width*f.to.x,outerHeight:d.height*f.to.y,outerWidth:d.width*f.to.x},f.from.y!==f.to.y&&(c.from=a.effects.setTransition(c,l,f.from.y,c.from),c.to=a.effects.setTransition(c,l,f.to.y,c.to)),f.from.x!==f.to.x&&(c.from=a.effects.setTransition(c,m,f.from.x,c.from),c.to=a.effects.setTransition(c,m,f.to.x,c.to)),c.css(c.from),c.animate(c.to,b.duration,b.easing,function(){o&&a.effects.restore(c,j)})})),g.animate(g.to,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){0===g.to.opacity&&g.css("opacity",g.from.opacity),"hide"===n&&g.hide(),a.effects.restore(g,s),o||("static"===r?g.css({position:"relative",top:g.to.top,left:g.to.left}):a.each(["top","left"],function(a,b){g.css(b,function(b,c){var d=parseInt(c,10),e=a?g.to.left:g.to.top;return"auto"===c?e+"px":d+e+"px"})})),a.effects.removeWrapper(g),c()}})},a.effects.effect.scale=function(b,c){var d=a(this),e=a.extend(!0,{},b),f=a.effects.setMode(d,b.mode||"effect"),g=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===f?0:100),h=b.direction||"both",i=b.origin,j={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()},k={y:"horizontal"!==h?g/100:1,x:"vertical"!==h?g/100:1};e.effect="size",e.queue=!1,e.complete=c,"effect"!==f&&(e.origin=i||["middle","center"],e.restore=!0),e.from=b.from||("show"===f?{height:0,width:0,outerHeight:0,outerWidth:0}:j),e.to={height:j.height*k.y,width:j.width*k.x,outerHeight:j.outerHeight*k.y,outerWidth:j.outerWidth*k.x},e.fade&&("show"===f&&(e.from.opacity=0,e.to.opacity=1),"hide"===f&&(e.from.opacity=1,e.to.opacity=0)),d.effect(e)},a.effects.effect.puff=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"hide"),f="hide"===e,g=parseInt(b.percent,10)||150,h=g/100,i={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:e,complete:c,percent:f?g:100,from:f?i:{height:i.height*h,width:i.width*h,outerHeight:i.outerHeight*h,outerWidth:i.outerWidth*h}}),d.effect(b)},a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()},a.effects.effect.shake=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(e,b.mode||"effect"),h=b.direction||"left",i=b.distance||20,j=b.times||3,k=2*j+1,l=Math.round(b.duration/k),m="up"===h||"down"===h?"top":"left",n="up"===h||"left"===h,o={},p={},q={},r=e.queue(),s=r.length;for(a.effects.save(e,f),e.show(),a.effects.createWrapper(e),o[m]=(n?"-=":"+=")+i,p[m]=(n?"+=":"-=")+2*i,q[m]=(n?"-=":"+=")+2*i,e.animate(o,l,b.easing),d=1;j>d;d++)e.animate(p,l,b.easing).animate(q,l,b.easing);e.animate(p,l,b.easing).animate(o,l/2,b.easing).queue(function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}),s>1&&r.splice.apply(r,[1,0].concat(r.splice(s,k+1))),e.dequeue()},a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})},a.effects.effect.transfer=function(b,c){var d=a(this),e=a(b.to),f="fixed"===e.css("position"),g=a("body"),h=f?g.scrollTop():0,i=f?g.scrollLeft():0,j=e.offset(),k={top:j.top-h,left:j.left-i,height:e.innerHeight(),width:e.innerWidth()},l=d.offset(),m=a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(b.className).css({top:l.top-h,left:l.left-i,height:d.innerHeight(),width:d.innerWidth(),position:f?"fixed":"absolute"}).animate(k,b.duration,b.easing,function(){m.remove(),c()})}}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(a){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;n<o;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)&&(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),jQuery.fn.fullScreen=d,jQuery.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))};var e,f,g;e=document,e.webkitCancelFullScreen?(f="webkitfullscreenchange",g="webkitfullscreenerror"):e.mozCancelFullScreen?(f="mozfullscreenchange",g="mozfullscreenerror"):(f="fullscreenchange",g="fullscreenerror"),jQuery(document).bind(f,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))}),jQuery(document).bind(g,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))});var cookieScripts=document.getElementsByTagName("script"),cookieScriptSrc=cookieScripts[cookieScripts.length-1].src,cookieQuery=null,cookieScriptPosition="bottom",cookieScriptSide="right",cookieScriptSource="cookie-script.com",cookieScriptDomain="",cookieScriptReadMore="/policies/cookie_"+App.context.languageCode+".html",cookieId="6a00eb3cf69b00d1af83ec32b891828a",cookieScriptDebug=0,cookieScriptCurrentUrl=window.location.href,cookieScriptTitle='<h4 id="cookiescript_header">'+App.translations.weUseCookies+"</h4>",cookieScriptDesc=App.translations.weUseCookiesDescription,cookieScriptAccept="×",cookieScriptMore=App.translations.readMore,cookieScriptCopyrights="",cookieScriptLoadJavaScript=function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=a,void 0!=b&&(d.onload=d.onreadystatechange=function(){d.readyState&&!/loaded|complete/.test(d.readyState)||(d.onload=d.onreadystatechange=null,c&&d.parentNode&&c.removeChild(d),d=void 0,b())}),c.insertBefore(d,c.firstChild)},InjectCookieScript=function(){function a(){cookieQuery('iframe[data-cookiescript="accepted"]').not(":has([src])").each(function(){var a=this,a=a.contentWindow?a.contentWindow:a.contentDocument.document?a.contentDocument.document:a.contentDocument;a.document.open(),a.document.write(cookieQuery(this).attr("alt")),a.document.close()})}function b(a){"show"==a?(cookieQuery("#cookiescript_overlay",cookieScriptWindow).show(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).show()):"hide"==a&&(cookieQuery("#cookiescript_overlay",cookieScriptWindow).hide(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).hide())}function c(){cookieQuery('img[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('script[type="text/plain"][data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src")?cookieQuery(this).after('<script type="text/javascript" src="'+cookieQuery(this).attr("src")+'"><\/script>'):cookieQuery(this).after('<script type="text/javascript">'+cookieQuery(this).html()+"<\/script>"),cookieQuery(this).empty()}),cookieQuery('iframe[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('embed[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))[0].outerHTML)}),cookieQuery('object[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("data",cookieQuery(this).attr("data-data"))[0].outerHTML)}),cookieQuery('link[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("href",cookieQuery(this).attr("data-href"))})}cookieScriptDropfromFlag=0,cookieScriptDroptoFlag=0,cookieScriptCreateCookie=function(a,b,c){var d,e="";c&&(d=new Date,d.setTime(d.getTime()+864e5*c),e="; expires="+d.toGMTString()),c="",""!=cookieScriptDomain&&(c="; domain="+cookieScriptDomain),document.cookie=a+"="+b+e+c+"; path=/"},cookieScriptReadCookie=function(a){a+="=";for(var b,c=document.cookie.split(";"),d=0;d<c.length;d++){for(b=c[d];" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(a))return b.substring(a.length,b.length)}return null},cookieQuery(function(){if(cookieScriptWindow=window.document,cookieQuery("#cookiescript_injected",cookieScriptWindow).remove(),
cookieQuery("#cookiescript_overlay",cookieScriptWindow).remove(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).remove(),cookieScriptCurrentValue=cookieScriptReadCookie("cookiescriptaccept"),"visit"==cookieScriptCurrentValue)return!1;if(cookieScriptCurrentValue){if("firstvisit"==cookieScriptCurrentValue.substring(0,10)&&cookieScriptCurrentValue!="firstvisit-"+cookieScriptCurrentUrl)return cookieScriptCreateCookie("cookiescriptaccept","visit",30),c(),!1}else cookieScriptCreateCookie("cookiescriptaccept","firstvisit-"+cookieScriptCurrentUrl,30);cookieQuery("body",cookieScriptWindow).append('<div id="cookiescript_injected">'+cookieScriptTitle+cookieScriptDesc+' <span id="cookiescript_readmore">'+cookieScriptMore+'</span><div id="cookiescript_accept">'+cookieScriptAccept+'</div><div style="clear:both"></div>'),cookieQuery("#cookiescript_injected",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,opacity:1,position:"fixed",padding:"15px",width:"300px","font-size":"13px","font-weight":"normal","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"none","line-height":"15px","letter-spacing":"normal","-moz-box-shadow":"0px 0px 8px #000000","-webkit-box-shadow":"0px 0px 8px #000000","box-shadow":"0px 0px 8px #000000"}),"top"==cookieScriptPosition?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("top",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("bottom",0),"left"==cookieScriptSide?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("left",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("right",0),cookieQuery("#cookiescript_injected h4#cookiescript_header",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,padding:"0 0 7px 0","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"block","font-size":"15px","font-weight":"bold","line-height":"normal","letter-spacing":"normal","font-style":"normal",margin:"0"}),cookieQuery("#cookiescript_injected a",cookieScriptWindow).css({"text-decoration":"underline",color:"#FFFFFF"}),cookieQuery("#cookiescript_injected a#cookiescript_link",cookieScriptWindow).css({"text-decoration":"none",color:"#FFFFFF",float:"right","font-size":"90%","text-decoration":"none","margin-top":"8px"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({border:0,padding:"0","text-decoration":"underline",cursor:"pointer",margin:"0","white-space":"nowrap"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"-webkit-border-radius":"10px","-khtml-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",border:0,padding:"0",cursor:"pointer",margin:"0","-webkit-transition":"0.25s","-moz-transition":"0.25s",transition:"0.25s",width:"20px",height:"20px",position:"absolute",top:"12px",right:"17px","border-radius":"10px","text-align":"center","font-weight":"bold","line-height":"21px","font-size":"20px"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"background-color":"#5BB75B",color:"#FFFFFF",float:"left"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({}),cookieQuery("#cookiescript_injected div#cookiescript_pixel",cookieScriptWindow).css({width:"1px",height:"1px",float:"left"}),cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeIn(1e3),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).click(function(){"undefined"==typeof cookieScriptScrollfired&&(cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeOut(200),cookieScriptCreateCookie("cookiescriptaccept","visit",30),b("hide"),c())}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).click(function(){return window.open(cookieScriptReadMore,"_blank"),!1}),cookieQuery("#cookiescript_overlay",cookieScriptWindow).click(function(){b("hide")}),cookieQuery("#cookiescript_info_close",cookieScriptWindow).click(function(){b("hide")}),document.onkeydown=function(a){a=a||window.event,27==a.keyCode&&b("hide")},a()}),"visit"!=cookieScriptReadCookie("cookiescriptaccept")&&"shown"!=cookieScriptReadCookie("cookiescriptaccept")||c()};window.jQuery&&jQuery.fn&&/^(1\.[8-9]|2\.[0-9])/.test(jQuery.fn.jquery)?(cookieScriptDebug&&window.console&&console.log("Using existing jQuery version "+jQuery.fn.jquery),cookieQuery=window.jQuery,InjectCookieScript()):(cookieScriptDebug&&window.console&&console.log("Loading jQuery 1.8.1 from ajax.googleapis.com"),cookieScriptLoadJavaScript(("https:"==document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js",function(){cookieQuery=jQuery.noConflict(!0),InjectCookieScript()})),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b(require("wkt-parser")):"function"==typeof define&&define.amd?define(["wkt-parser"],b):a.proj4=b(a.wkt)}(this,function(a){"use strict";function b(a,b){if(a[b])return a[b];for(var c,d=Object.keys(a),e=b.toLowerCase().replace(ma,""),f=-1;++f<d.length;)if(c=d[f],c.toLowerCase().replace(ma,"")===e)return a[c]}function c(b){var d=this;if(2===arguments.length){var e=arguments[1];"string"==typeof e?"+"===e.charAt(0)?c[b]=na(arguments[1]):c[b]=a(arguments[1]):c[b]=e}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(a){Array.isArray(a)?c.apply(d,a):c(a)});if("string"==typeof b){if(b in c)return c[b]}else"EPSG"in b?c["EPSG:"+b.EPSG]=b:"ESRI"in b?c["ESRI:"+b.ESRI]=b:"IAU2000"in b?c["IAU2000:"+b.IAU2000]=b:console.log(b);return}}function d(a){return"string"==typeof a}function e(a){return a in c}function f(a){return oa.some(function(b){return a.indexOf(b)>-1})}function g(a){var c=b(a,"authority");if(c){var d=b(c,"epsg");return d&&pa.indexOf(d)>-1}}function h(a){var c=b(a,"extension");if(c)return b(c,"proj4")}function i(a){return"+"===a[0]}function j(b){if(!d(b))return b;if(e(b))return c[b];if(f(b)){var j=a(b);if(g(j))return c["EPSG:3857"];var k=h(j);return k?na(k):j}return i(b)?na(b):void 0}function k(a){return a}function l(a,b){var c=ya.length;return a.names?(ya[c]=a,a.names.forEach(function(a){xa[a.toLowerCase()]=c}),this):(console.log(b),!0)}function m(a,b,c,d){var e=a*a,f=b*b,g=(e-f)/e,h=0;return d?(e=(a*=1-g*(ba+g*(ca+g*da)))*a,g=0):h=Math.sqrt(g),{es:g,e:h,ep2:(e-f)/f}}function n(a,c,d,e,f){if(!a){var g=b(Aa,e);g||(g=Ba),a=g.a,c=g.b,d=g.rf}return d&&!c&&(c=(1-1/d)*a),(0===d||Math.abs(a-c)<ea)&&(f=!0,c=a),{a:a,b:c,rf:d,sphere:f}}function o(a,b,c,d,e,f){var g={};return g.datum_type=void 0===a||"none"===a?$:Z,b&&(g.datum_params=b.map(parseFloat),0===g.datum_params[0]&&0===g.datum_params[1]&&0===g.datum_params[2]||(g.datum_type=X),g.datum_params.length>3&&(0===g.datum_params[3]&&0===g.datum_params[4]&&0===g.datum_params[5]&&0===g.datum_params[6]||(g.datum_type=Y,g.datum_params[3]*=_,g.datum_params[4]*=_,g.datum_params[5]*=_,g.datum_params[6]=g.datum_params[6]/1e6+1))),g.a=c,g.b=d,g.es=e,g.ep2=f,g}function p(a,c){if(!(this instanceof p))return new p(a);c=c||function(a){if(a)throw a};var d=j(a);if("object"==typeof d){var e=p.projections.get(d.projName);if(e){if(d.datumCode&&"none"!==d.datumCode){var f=b(Ca,d.datumCode);f&&(d.datum_params=f.towgs84?f.towgs84.split(","):null,d.ellps=f.ellipse,d.datumName=f.datumName?f.datumName:d.datumCode)}d.k0=d.k0||1,d.axis=d.axis||"enu",d.ellps=d.ellps||"wgs84";var g=n(d.a,d.b,d.rf,d.ellps,d.sphere),h=m(g.a,g.b,g.rf,d.R_A),i=d.datum||o(d.datumCode,d.datum_params,g.a,g.b,h.es,h.ep2);qa(this,d),qa(this,e),this.a=g.a,this.b=g.b,this.rf=g.rf,this.sphere=g.sphere,this.es=h.es,this.e=h.e,this.ep2=h.ep2,this.datum=i,this.init(),c(null,this)}else c(a)}else c(a)}function q(a,b){return a.datum_type===b.datum_type&&!(a.a!==b.a||Math.abs(a.es-b.es)>5e-11)&&(a.datum_type===X?a.datum_params[0]===b.datum_params[0]&&a.datum_params[1]===b.datum_params[1]&&a.datum_params[2]===b.datum_params[2]:a.datum_type!==Y||a.datum_params[0]===b.datum_params[0]&&a.datum_params[1]===b.datum_params[1]&&a.datum_params[2]===b.datum_params[2]&&a.datum_params[3]===b.datum_params[3]&&a.datum_params[4]===b.datum_params[4]&&a.datum_params[5]===b.datum_params[5]&&a.datum_params[6]===b.datum_params[6])}function r(a,b,c){var d,e,f,g,h=a.x,i=a.y,j=a.z?a.z:0;if(i<-aa&&i>-1.001*aa)i=-aa;else if(i>aa&&i<1.001*aa)i=aa;else{if(i<-aa)return{x:-1/0,y:-1/0,z:a.z};if(i>aa)return{x:1/0,y:1/0,z:a.z}}return h>Math.PI&&(h-=2*Math.PI),e=Math.sin(i),g=Math.cos(i),f=e*e,d=c/Math.sqrt(1-b*f),{x:(d+j)*g*Math.cos(h),y:(d+j)*g*Math.sin(h),z:(d*(1-b)+j)*e}}function s(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=a.x,v=a.y,w=a.z?a.z:0;if(e=Math.sqrt(u*u+v*v),f=Math.sqrt(u*u+v*v+w*w),e/c<1e-12){if(r=0,f/c<1e-12)return s=aa,t=-d,{x:a.x,y:a.y,z:a.z}}else r=Math.atan2(v,u);g=w/f,l=(h=e/f)*(1-b)*(i=1/Math.sqrt(1-b*(2-b)*h*h)),m=g*i,q=0;do{q++,j=b*(k=c/Math.sqrt(1-b*m*m))/(k+(t=e*l+w*m-k*(1-b*m*m))),p=(o=g*(i=1/Math.sqrt(1-j*(2-j)*h*h)))*l-(n=h*(1-j)*i)*m,l=n,m=o}while(p*p>1e-24&&q<30);return s=Math.atan(o/Math.abs(n)),{x:r,y:s,z:t}}function t(a,b,c){if(b===X)return{x:a.x+c[0],y:a.y+c[1],z:a.z+c[2]};if(b===Y){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6];return{x:j*(a.x-i*a.y+h*a.z)+d,y:j*(i*a.x+a.y-g*a.z)+e,z:j*(-h*a.x+g*a.y+a.z)+f}}}function u(a,b,c){if(b===X)return{x:a.x-c[0],y:a.y-c[1],z:a.z-c[2]};if(b===Y){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=(a.x-d)/j,l=(a.y-e)/j,m=(a.z-f)/j;return{x:k+i*l-h*m,y:-i*k+l+g*m,z:h*k-g*l+m}}}function v(a){return a===X||a===Y}function w(a){if("function"==typeof Number.isFinite){if(Number.isFinite(a))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof a||a!==a||!isFinite(a))throw new TypeError("coordinates must be finite numbers")}function x(a,b){return(a.datum.datum_type===X||a.datum.datum_type===Y)&&"WGS84"!==b.datumCode||(b.datum.datum_type===X||b.datum.datum_type===Y)&&"WGS84"!==a.datumCode}function y(a,b,c){var d;if(Array.isArray(c)&&(c=Fa(c)),Ga(c),a.datum&&b.datum&&x(a,b)&&(c=y(a,d=new p("WGS84"),c),a=d),"enu"!==a.axis&&(c=Ea(a,!1,c)),"longlat"===a.projName)c={x:c.x*fa,y:c.y*fa,z:c.z||0};else if(a.to_meter&&(c={x:c.x*a.to_meter,y:c.y*a.to_meter,z:c.z||0}),!(c=a.inverse(c)))return;return a.from_greenwich&&(c.x+=a.from_greenwich),c=Da(a.datum,b.datum,c),b.from_greenwich&&(c={x:c.x-b.from_greenwich,y:c.y,z:c.z||0}),"longlat"===b.projName?c={x:c.x*ga,y:c.y*ga,z:c.z||0}:(c=b.forward(c),b.to_meter&&(c={x:c.x/b.to_meter,y:c.y/b.to_meter,z:c.z||0})),"enu"!==b.axis?Ea(b,!0,c):c}function z(a,b,c){var d,e,f;return Array.isArray(c)?(d=y(a,b,c)||{x:NaN,y:NaN},c.length>2?void 0!==a.name&&"geocent"===a.name||void 0!==b.name&&"geocent"===b.name?"number"==typeof d.z?[d.x,d.y,d.z].concat(c.splice(3)):[d.x,d.y,c[2]].concat(c.splice(3)):[d.x,d.y].concat(c.splice(2)):[d.x,d.y]):(e=y(a,b,c),2===(f=Object.keys(c)).length?e:(f.forEach(function(d){if(void 0!==a.name&&"geocent"===a.name||void 0!==b.name&&"geocent"===b.name){if("x"===d||"y"===d||"z"===d)return}else if("x"===d||"y"===d)return;e[d]=c[d]}),e))}function A(a){return a instanceof p?a:a.oProj?a.oProj:p(a)}function B(a,b,c){a=A(a);var d,e=!1;return void 0===b?(b=a,a=Ha,e=!0):(void 0!==b.x||Array.isArray(b))&&(c=b,b=a,a=Ha,e=!0),b=A(b),c?z(a,b,c):(d={forward:function(c){return z(a,b,c)},inverse:function(c){return z(b,a,c)}},e&&(d.oProj=b),d)}function C(a,b){return b=b||5,J(G({lat:a[1],lon:a[0]}),b)}function D(a){var b=H(N(a.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}function E(a){return a*(Math.PI/180)}function F(a){return a/Math.PI*180}function G(a){var b,c,d,e,f,g,h,i=a.lat,j=a.lon,k=6378137,l=E(i),m=E(j);h=Math.floor((j+180)/6)+1,180===j&&(h=60),i>=56&&i<64&&j>=3&&j<12&&(h=32),i>=72&&i<84&&(j>=0&&j<9?h=31:j>=9&&j<21?h=33:j>=21&&j<33?h=35:j>=33&&j<42&&(h=37)),g=E(6*(h-1)-180+3),b=k/Math.sqrt(1-.00669438*Math.sin(l)*Math.sin(l)),c=Math.tan(l)*Math.tan(l),d=.006739496752268451*Math.cos(l)*Math.cos(l);var n=.9996*b*((e=Math.cos(l)*(m-g))+(1-c+d)*e*e*e/6+(5-18*c+c*c+72*d-.39089081163157013)*e*e*e*e*e/120)+5e5,o=.9996*((f=k*(.9983242984503243*l-.002514607064228144*Math.sin(2*l)+2639046602129982e-21*Math.sin(4*l)-3.418046101696858e-9*Math.sin(6*l)))+b*Math.tan(l)*(e*e/2+(5-c+9*d+4*d*d)*e*e*e*e/24+(61-58*c+c*c+600*d-2.2240339282485886)*e*e*e*e*e*e/720));return i<0&&(o+=1e7),{northing:Math.round(o),easting:Math.round(n),zoneNumber:h,zoneLetter:I(i)}}function H(a){var b=a.northing,c=a.easting,d=a.zoneLetter,e=a.zoneNumber;if(e<0||e>60)return null;var f,g,h,i,j,k,l,m,n=6378137,o=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),p=c-5e5,q=b;d<"N"&&(q-=1e7),k=6*(e-1)-180+3,m=(l=q/.9996/6367449.145945056)+(3*o/2-27*o*o*o/32)*Math.sin(2*l)+(21*o*o/16-55*o*o*o*o/32)*Math.sin(4*l)+151*o*o*o/96*Math.sin(6*l),f=n/Math.sqrt(1-.00669438*Math.sin(m)*Math.sin(m)),g=Math.tan(m)*Math.tan(m),h=.006739496752268451*Math.cos(m)*Math.cos(m),i=.99330562*n/Math.pow(1-.00669438*Math.sin(m)*Math.sin(m),1.5),j=p/(.9996*f);var r=m-f*Math.tan(m)/i*(j*j/2-(5+3*g+10*h-4*h*h-.06065547077041606)*j*j*j*j/24+(61+90*g+298*h+45*g*g-1.6983531815716497-3*h*h)*j*j*j*j*j*j/720);r=F(r);var s=(j-(1+2*g+h)*j*j*j/6+(5-2*h+28*g-3*h*h+.05391597401814761+24*g*g)*j*j*j*j*j/120)/Math.cos(m);s=k+F(s);var t;if(a.accuracy){var u=H({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});t={top:u.lat,right:u.lon,bottom:r,left:s}}else t={lat:r,lon:s};return t}function I(a){var b="Z";return 84>=a&&a>=72?b="X":72>a&&a>=64?b="W":64>a&&a>=56?b="V":56>a&&a>=48?b="U":48>a&&a>=40?b="T":40>a&&a>=32?b="S":32>a&&a>=24?b="R":24>a&&a>=16?b="Q":16>a&&a>=8?b="P":8>a&&a>=0?b="N":0>a&&a>=-8?b="M":-8>a&&a>=-16?b="L":-16>a&&a>=-24?b="K":-24>a&&a>=-32?b="J":-32>a&&a>=-40?b="H":-40>a&&a>=-48?b="G":-48>a&&a>=-56?b="F":-56>a&&a>=-64?b="E":-64>a&&a>=-72?b="D":-72>a&&a>=-80&&(b="C"),b}function J(a,b){var c="00000"+a.easting,d="00000"+a.northing;return a.zoneNumber+a.zoneLetter+K(a.easting,a.northing,a.zoneNumber)+c.substr(c.length-5,b)+d.substr(d.length-5,b)}function K(a,b,c){var d=L(c);return M(Math.floor(a/1e5),Math.floor(b/1e5)%20,d)}function L(a){var b=a%Ia;return 0===b&&(b=Ia),b}function M(a,b,c){var d=c-1,e=Ja.charCodeAt(d),f=Ka.charCodeAt(d),g=e+a-1,h=f+b,i=!1;return g>Pa&&(g=g-Pa+La-1,i=!0),(g===Ma||e<Ma&&g>Ma||(g>Ma||e<Ma)&&i)&&g++,(g===Na||e<Na&&g>Na||(g>Na||e<Na)&&i)&&++g===Ma&&g++,g>Pa&&(g=g-Pa+La-1),h>Oa?(h=h-Oa+La-1,i=!0):i=!1,(h===Ma||f<Ma&&h>Ma||(h>Ma||f<Ma)&&i)&&h++,(h===Na||f<Na&&h>Na||(h>Na||f<Na)&&i)&&++h===Ma&&h++,h>Oa&&(h=h-Oa+La-1),String.fromCharCode(g)+String.fromCharCode(h)}function N(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b,c=a.length,d=null,e="",f=0;!/[A-Z]/.test(b=a.charAt(f));){if(f>=2)throw"MGRSPoint bad conversion from: "+a;e+=b,f++}var g=parseInt(e,10);if(0===f||f+3>c)throw"MGRSPoint bad conversion from: "+a;var h=a.charAt(f++);if(h<="A"||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;d=a.substring(f,f+=2);for(var i=L(g),j=O(d.charAt(0),i),k=P(d.charAt(1),i);k<Q(h);)k+=2e6;var l=c-f;if(l%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var m,n,o,p,q,r=l/2,s=0,t=0;return r>0&&(m=1e5/Math.pow(10,r),n=a.substring(f,f+r),s=parseFloat(n)*m,o=a.substring(f+r),t=parseFloat(o)*m),p=s+j,q=t+k,{easting:p,northing:q,zoneLetter:h,zoneNumber:g,accuracy:m}}function O(a,b){for(var c=Ja.charCodeAt(b-1),d=1e5,e=!1;c!==a.charCodeAt(0);){if(++c===Ma&&c++,c===Na&&c++,c>Pa){if(e)throw"Bad character: "+a;c=La,e=!0}d+=1e5}return d}function P(a,b){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var c=Ka.charCodeAt(b-1),d=0,e=!1;c!==a.charCodeAt(0);){if(++c===Ma&&c++,c===Na&&c++,c>Oa){if(e)throw"Bad character: "+a;c=La,e=!0}d+=1e5}return d}function Q(a){var b;switch(a){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+a}function R(a,b,c){if(!(this instanceof R))return new R(a,b,c);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if("object"==typeof a)this.x=a.x,this.y=a.y,this.z=a.z||0;else if("string"==typeof a&&void 0===b){var d=a.split(",");this.x=parseFloat(d[0],10),this.y=parseFloat(d[1],10),this.z=parseFloat(d[2],10)||0}else this.x=a,this.y=b,this.z=c||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function S(a){var b,c=[];return c[0]=a*yb,b=a*a,c[0]+=b*zb,c[1]=b*Bb,b*=a,c[0]+=b*Ab,c[1]+=b*Cb,c[2]=b*Db,c}function T(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)}function U(a,b,c,d){var e;return a<ea?(d.value=Xb.AREA_0,e=0):(e=Math.atan2(b,c),Math.abs(e)<=ha?d.value=Xb.AREA_0:e>ha&&e<=aa+ha?(d.value=Xb.AREA_1,e-=aa):e>aa+ha||e<=-(aa+ha)?(d.value=Xb.AREA_2,e=e>=0?e-ja:e+ja):(d.value=Xb.AREA_3,e+=aa)),e}function V(a,b){var c=a+b;return c<-ja?c+=ia:c>+ja&&(c-=ia),c}function W(a,b,c,d){for(var e=b;d;--d){var f=a(e);if(e-=f,Math.abs(f)<c)break}return e}a=a&&a.hasOwnProperty("default")?a.default:a;var X=1,Y=2,Z=4,$=5,_=484813681109536e-20,aa=Math.PI/2,ba=.16666666666666666,ca=.04722222222222222,da=.022156084656084655,ea=1e-10,fa=.017453292519943295,ga=57.29577951308232,ha=Math.PI/4,ia=2*Math.PI,ja=3.14159265359,ka={};ka.greenwich=0,ka.lisbon=-9.131906111111,ka.paris=2.337229166667,ka.bogota=-74.080916666667,ka.madrid=-3.687938888889,ka.rome=12.452333333333,ka.bern=7.439583333333,ka.jakarta=106.807719444444,ka.ferro=-17.666666666667,ka.brussels=4.367975,ka.stockholm=18.058277777778,ka.athens=23.7163375,ka.oslo=10.722916666667;var la={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},ma=/[\s_\-\/\(\)]/g,na=function(a){var c,d,e,f={},g=a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,b){var c=b.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),h={proj:"projName",datum:"datumCode",rf:function(a){f.rf=parseFloat(a)},lat_0:function(a){f.lat0=a*fa},lat_1:function(a){f.lat1=a*fa},lat_2:function(a){f.lat2=a*fa},lat_ts:function(a){f.lat_ts=a*fa},lon_0:function(a){f.long0=a*fa},lon_1:function(a){f.long1=a*fa},lon_2:function(a){f.long2=a*fa},alpha:function(a){f.alpha=parseFloat(a)*fa},lonc:function(a){f.longc=a*fa},x_0:function(a){f.x0=parseFloat(a)},y_0:function(a){f.y0=parseFloat(a)},k_0:function(a){f.k0=parseFloat(a)},k:function(a){f.k0=parseFloat(a)},a:function(a){f.a=parseFloat(a)},b:function(a){f.b=parseFloat(a)},r_a:function(){f.R_A=!0},zone:function(a){f.zone=parseInt(a,10)},south:function(){f.utmSouth=!0},towgs84:function(a){f.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){f.to_meter=parseFloat(a)},units:function(a){f.units=a;var c=b(la,a);c&&(f.to_meter=c.to_meter)},from_greenwich:function(a){f.from_greenwich=a*fa},pm:function(a){var c=b(ka,a);f.from_greenwich=(c||parseFloat(a))*fa},nadgrids:function(a){"@null"===a?f.datumCode="none":f.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(f.axis=a)}};for(c in g)d=g[c],c in h?"function"==typeof(e=h[c])?e(d):f[e]=d:f[c]=d;return"string"==typeof f.datumCode&&"WGS84"!==f.datumCode&&(f.datumCode=f.datumCode.toLowerCase()),f};!function(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a.WGS84=a["EPSG:4326"],a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]}(c);var oa=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],pa=["3857","900913","3785","102113"],qa=function(a,b){a=a||{};var c,d;if(!b)return a;for(d in b)void 0!==(c=b[d])&&(a[d]=c);return a},ra=function(a,b,c){var d=a*b;return c/Math.sqrt(1-d*d)},sa=function(a){return a<0?-1:1},ta=function(a){return Math.abs(a)<=ja?a:a-sa(a)*ia},ua=function(a,b,c){var d=a*c,e=.5*a;return d=Math.pow((1-d)/(1+d),e),Math.tan(.5*(aa-b))/d},va=function(a,b){for(var c,d,e=.5*a,f=aa-2*Math.atan(b),g=0;g<=15;g++)if(c=a*Math.sin(f),d=aa-2*Math.atan(b*Math.pow((1-c)/(1+c),e))-f,f+=d,Math.abs(d)<=1e-10)return f;return-9999},wa=[{init:function(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ra(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(a){var b=a.x,c=a.y;if(c*ga>90&&c*ga<-90&&b*ga>180&&b*ga<-180)return null;var d,e;if(Math.abs(Math.abs(c)-aa)<=ea)return null;if(this.sphere)d=this.x0+this.a*this.k0*ta(b-this.long0),e=this.y0+this.a*this.k0*Math.log(Math.tan(ha+.5*c));else{var f=Math.sin(c),g=ua(this.e,c,f);d=this.x0+this.a*this.k0*ta(b-this.long0),e=this.y0-this.a*this.k0*Math.log(g)}return a.x=d,a.y=e,a},inverse:function(a){var b,c,d=a.x-this.x0,e=a.y-this.y0;if(this.sphere)c=aa-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var f=Math.exp(-e/(this.a*this.k0));if(-9999===(c=va(this.e,f)))return null}return b=ta(this.long0+d/(this.a*this.k0)),a.x=b,a.y=c,a},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:k,inverse:k,names:["longlat","identity"]}],xa={},ya=[],za={start:function(){wa.forEach(l)},add:l,get:function(a){if(!a)return!1;var b=a.toLowerCase();return void 0!==xa[b]&&ya[xa[b]]?ya[xa[b]]:void 0}},Aa={};Aa.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},Aa.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},Aa.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},Aa.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},Aa.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},Aa.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},Aa.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},Aa.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},Aa.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},Aa.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},Aa.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},Aa.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},Aa.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},Aa.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},Aa.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},Aa.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},Aa.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},Aa.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},Aa.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},Aa.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},Aa.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},Aa.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},Aa.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},Aa.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},Aa.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},Aa.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},Aa.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},Aa.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},Aa.hough={a:6378270,rf:297,ellipseName:"Hough"},Aa.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},Aa.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},Aa.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},Aa.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},Aa.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},Aa.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},Aa.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},Aa.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},Aa.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},Aa.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},Aa.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},Aa.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Ba=Aa.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Aa.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Ca={};Ca.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Ca.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Ca.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Ca.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Ca.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Ca.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Ca.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Ca.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},Ca.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Ca.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Ca.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Ca.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Ca.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Ca.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Ca.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Ca.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Ca.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},p.projections=za,p.projections.start();var Da=function(a,b,c){return q(a,b)?c:a.datum_type===$||b.datum_type===$?c:a.es!==b.es||a.a!==b.a||v(a.datum_type)||v(b.datum_type)?(c=r(c,a.es,a.a),v(a.datum_type)&&(c=t(c,a.datum_type,a.datum_params)),v(b.datum_type)&&(c=u(c,b.datum_type,b.datum_params)),s(c,b.es,b.a,b.b)):c},Ea=function(a,b,c){var d,e,f,g=c.x,h=c.y,i=c.z||0,j={};for(f=0;f<3;f++)if(!b||2!==f||void 0!==c.z)switch(0===f?(d=g,e=-1!=="ew".indexOf(a.axis[f])?"x":"y"):1===f?(d=h,e=-1!=="ns".indexOf(a.axis[f])?"y":"x"):(d=i,e="z"),a.axis[f]){case"e":case"w":case"n":case"s":j[e]=d;break;case"u":void 0!==c[e]&&(j.z=d);break;case"d":void 0!==c[e]&&(j.z=-d);break;default:return null}return j},Fa=function(a){var b={x:a[0],y:a[1]};return a.length>2&&(b.z=a[2]),a.length>3&&(b.m=a[3]),b},Ga=function(a){w(a.x),w(a.y)},Ha=p("WGS84"),Ia=6,Ja="AJSAJS",Ka="AFAFAF",La=65,Ma=73,Na=79,Oa=86,Pa=90,Qa={forward:C,inverse:function(a){var b=H(N(a.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]},toPoint:D};R.fromMGRS=function(a){return new R(D(a))},R.prototype.toMGRS=function(a){return C([this.x,this.y],a)};var Ra=.01068115234375,Sa=function(a){var b=[];b[0]=1-a*(.25+a*(.046875+a*(.01953125+a*Ra))),b[1]=a*(.75-a*(.046875+a*(.01953125+a*Ra)));var c=a*a;return b[2]=c*(.46875-a*(.013020833333333334+.007120768229166667*a)),c*=a,b[3]=c*(.3645833333333333-.005696614583333333*a),b[4]=c*a*.3076171875,b},Ta=function(a,b,c,d){return c*=b,b*=b,d[0]*a-c*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))},Ua=function(a,b,c){for(var d=1/(1-b),e=a,f=20;f;--f){var g=Math.sin(e),h=1-b*g*g;if(h=(Ta(e,g,Math.cos(e),c)-a)*(h*Math.sqrt(h))*d,e-=h,Math.abs(h)<ea)return e}return e},Va={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Sa(this.es),this.ml0=Ta(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(a){var b,c,d,e=a.x,f=a.y,g=ta(e-this.long0),h=Math.sin(f),i=Math.cos(f);if(this.es){var j=i*g,k=Math.pow(j,2),l=this.ep2*Math.pow(i,2),m=Math.pow(l,2),n=Math.abs(i)>ea?Math.tan(f):0,o=Math.pow(n,2),p=Math.pow(o,2);b=1-this.es*Math.pow(h,2),j/=Math.sqrt(b);var q=Ta(f,h,i,this.en);c=this.a*(this.k0*j*(1+k/6*(1-o+l+k/20*(5-18*o+p+14*l-58*o*l+k/42*(61+179*p-p*o-479*o)))))+this.x0,d=this.a*(this.k0*(q-this.ml0+h*g*j/2*(1+k/12*(5-o+9*l+4*m+k/30*(61+p-58*o+270*l-330*o*l+k/56*(1385+543*p-p*o-3111*o))))))+this.y0}else{var r=i*Math.sin(g);if(Math.abs(Math.abs(r)-1)<ea)return 93;if(c=.5*this.a*this.k0*Math.log((1+r)/(1-r))+this.x0,d=i*Math.cos(g)/Math.sqrt(1-Math.pow(r,2)),(r=Math.abs(d))>=1){if(r-1>ea)return 93;d=0}else d=Math.acos(d);f<0&&(d=-d),d=this.a*this.k0*(d-this.lat0)+this.y0}return a.x=c,a.y=d,a},inverse:function(a){var b,c,d,e,f=(a.x-this.x0)*(1/this.a),g=(a.y-this.y0)*(1/this.a);if(this.es)if(b=this.ml0+g/this.k0,c=Ua(b,this.es,this.en),Math.abs(c)<aa){var h=Math.sin(c),i=Math.cos(c),j=Math.abs(i)>ea?Math.tan(c):0,k=this.ep2*Math.pow(i,2),l=Math.pow(k,2),m=Math.pow(j,2),n=Math.pow(m,2);b=1-this.es*Math.pow(h,2);var o=f*Math.sqrt(b)/this.k0,p=Math.pow(o,2);d=c-(b*=j)*p/(1-this.es)*.5*(1-p/12*(5+3*m-9*k*m+k-4*l-p/30*(61+90*m-252*k*m+45*n+46*k-p/56*(1385+3633*m+4095*n+1574*n*m)))),e=ta(this.long0+o*(1-p/6*(1+2*m+k-p/20*(5+28*m+24*n+8*k*m+6*k-p/42*(61+662*m+1320*n+720*n*m))))/i)}else d=aa*sa(g),e=0;else{var q=Math.exp(f/this.k0),r=.5*(q-1/q),s=this.lat0+g/this.k0,t=Math.cos(s);b=Math.sqrt((1-Math.pow(t,2))/(1+Math.pow(r,2))),d=Math.asin(b),g<0&&(d=-d),e=0===r&&0===t?0:ta(Math.atan2(r,t)+this.long0)}return a.x=e,a.y=d,a},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Wa=function(a){var b=Math.exp(a);return b=(b-1/b)/2},Xa=function(a,b){a=Math.abs(a),b=Math.abs(b);var c=Math.max(a,b),d=Math.min(a,b)/(c||1);return c*Math.sqrt(1+Math.pow(d,2))},Ya=function(a){var b=1+a,c=b-1;return 0===c?a:a*Math.log(b)/c},Za=function(a){var b=Math.abs(a);return b=Ya(b*(1+b/(Xa(1,b)+1))),a<0?-b:b},$a=function(a,b){for(var c,d=2*Math.cos(2*b),e=a.length-1,f=a[e],g=0;--e>=0;)c=d*f-g+a[e],g=f,f=c;return b+c*Math.sin(2*b)},_a=function(a,b){for(var c,d=2*Math.cos(b),e=a.length-1,f=a[e],g=0;--e>=0;)c=d*f-g+a[e],g=f,f=c;return Math.sin(b)*c},ab=function(a){var b=Math.exp(a);return b=(b+1/b)/2},bb=function(a,b,c){for(var d,e,f=Math.sin(b),g=Math.cos(b),h=Wa(c),i=ab(c),j=2*g*i,k=-2*f*h,l=a.length-1,m=a[l],n=0,o=0,p=0;--l>=0;)d=o,e=n,m=j*(o=m)-d-k*(n=p)+a[l],p=k*o-e+j*n;return j=f*i,k=g*h,[j*m-k*p,j*p+k*m]},cb={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var a=this.es/(1+Math.sqrt(1-this.es)),b=a/(2-a),c=b;this.cgb[0]=b*(2+b*(-2/3+b*(b*(116/45+b*(26/45+b*(-2854/675)))-2))),this.cbg[0]=b*(b*(2/3+b*(4/3+b*(-82/45+b*(32/45+b*(4642/4725)))))-2),c*=b,this.cgb[1]=c*(7/3+b*(b*(-227/45+b*(2704/315+b*(2323/945)))-1.6)),this.cbg[1]=c*(5/3+b*(-16/15+b*(-13/9+b*(904/315+b*(-1522/945))))),c*=b,this.cgb[2]=c*(56/15+b*(-136/35+b*(-1262/105+b*(73814/2835)))),this.cbg[2]=c*(-26/15+b*(34/21+b*(1.6+b*(-12686/2835)))),c*=b,this.cgb[3]=c*(4279/630+b*(-332/35+b*(-399572/14175))),
this.cbg[3]=c*(1237/630+b*(b*(-24832/14175)-2.4)),c*=b,this.cgb[4]=c*(4174/315+b*(-144838/6237)),this.cbg[4]=c*(-734/315+b*(109598/31185)),c*=b,this.cgb[5]=c*(601676/22275),this.cbg[5]=c*(444337/155925),c=Math.pow(b,2),this.Qn=this.k0/(1+b)*(1+c*(.25+c*(1/64+c/256))),this.utg[0]=b*(b*(2/3+b*(-37/96+b*(1/360+b*(81/512+b*(-96199/604800)))))-.5),this.gtu[0]=b*(.5+b*(-2/3+b*(5/16+b*(41/180+b*(-127/288+b*(7891/37800)))))),this.utg[1]=c*(-1/48+b*(-1/15+b*(437/1440+b*(-46/105+b*(1118711/3870720))))),this.gtu[1]=c*(13/48+b*(b*(557/1440+b*(281/630+b*(-1983433/1935360)))-.6)),c*=b,this.utg[2]=c*(-17/480+b*(37/840+b*(209/4480+b*(-5569/90720)))),this.gtu[2]=c*(61/240+b*(-103/140+b*(15061/26880+b*(167603/181440)))),c*=b,this.utg[3]=c*(-4397/161280+b*(11/504+b*(830251/7257600))),this.gtu[3]=c*(49561/161280+b*(-179/168+b*(6601661/7257600))),c*=b,this.utg[4]=c*(-4583/161280+b*(108847/3991680)),this.gtu[4]=c*(34729/80640+b*(-3418889/1995840)),c*=b,this.utg[5]=-.03233083094085698*c,this.gtu[5]=.6650675310896665*c;var d=$a(this.cbg,this.lat0);this.Zb=-this.Qn*(d+_a(this.gtu,2*d))},forward:function(a){var b=ta(a.x-this.long0),c=a.y;c=$a(this.cbg,c);var d=Math.sin(c),e=Math.cos(c),f=Math.sin(b),g=Math.cos(b);c=Math.atan2(d,g*e),b=Math.atan2(f*e,Xa(d,e*g)),b=Za(Math.tan(b));var h=bb(this.gtu,2*c,2*b);c+=h[0],b+=h[1];var i,j;return Math.abs(b)<=2.623395162778?(i=this.a*(this.Qn*b)+this.x0,j=this.a*(this.Qn*c+this.Zb)+this.y0):(i=1/0,j=1/0),a.x=i,a.y=j,a},inverse:function(a){var b=(a.x-this.x0)*(1/this.a),c=(a.y-this.y0)*(1/this.a);c=(c-this.Zb)/this.Qn,b/=this.Qn;var d,e;if(Math.abs(b)<=2.623395162778){var f=bb(this.utg,2*c,2*b);c+=f[0],b+=f[1],b=Math.atan(Wa(b));var g=Math.sin(c),h=Math.cos(c),i=Math.sin(b),j=Math.cos(b);c=Math.atan2(g*j,Xa(i,j*h)),b=Math.atan2(i,j*h),d=ta(b+this.long0),e=$a(this.cgb,c)}else d=1/0,e=1/0;return a.x=d,a.y=e,a},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},db=function(a,b){if(void 0===a){if((a=Math.floor(30*(ta(b)+Math.PI)/Math.PI)+1)<0)return 0;if(a>60)return 60}return a},eb={init:function(){var a=db(this.zone,this.long0);if(void 0===a)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(a)-183)*fa,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,cb.init.apply(this),this.forward=cb.forward,this.inverse=cb.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},fb=function(a,b){return Math.pow((1-a)/(1+a),b)},gb=20,hb={init:function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ha)/(Math.pow(Math.tan(.5*this.lat0+ha),this.C)*fb(this.e*a,this.ratexp))},forward:function(a){var b=a.x,c=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+ha),this.C)*fb(this.e*Math.sin(c),this.ratexp))-aa,a.x=this.C*b,a},inverse:function(a){for(var b=a.x/this.C,c=a.y,d=Math.pow(Math.tan(.5*c+ha)/this.K,1/this.C),e=gb;e>0&&(c=2*Math.atan(d*fb(this.e*Math.sin(a.y),-.5*this.e))-aa,!(Math.abs(c-a.y)<1e-14));--e)a.y=c;return e?(a.x=b,a.y=c,a):null},names:["gauss"]},ib={init:function(){hb.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(a){var b,c,d,e;return a.x=ta(a.x-this.long0),hb.forward.apply(this,[a]),b=Math.sin(a.y),c=Math.cos(a.y),d=Math.cos(a.x),e=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*c*d),a.x=e*c*Math.sin(a.x),a.y=e*(this.cosc0*b-this.sinc0*c*d),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},inverse:function(a){var b,c,d,e,f;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,f=Math.sqrt(a.x*a.x+a.y*a.y)){var g=2*Math.atan2(f,this.R2);b=Math.sin(g),c=Math.cos(g),e=Math.asin(c*this.sinc0+a.y*b*this.cosc0/f),d=Math.atan2(a.x*b,f*this.cosc0*c-a.y*this.sinc0*b)}else e=this.phic0,d=0;return a.x=d,a.y=e,hb.inverse.apply(this,[a]),a.x=ta(a.x+this.long0),a},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},jb={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ea&&(this.k0=.5*(1+sa(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ea&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ea&&(this.k0=.5*this.cons*ra(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ua(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ra(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-aa,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(a){var b,c,d,e,f,g,h=a.x,i=a.y,j=Math.sin(i),k=Math.cos(i),l=ta(h-this.long0);return Math.abs(Math.abs(h-this.long0)-Math.PI)<=ea&&Math.abs(i+this.lat0)<=ea?(a.x=NaN,a.y=NaN,a):this.sphere?(b=2*this.k0/(1+this.sinlat0*j+this.coslat0*k*Math.cos(l)),a.x=this.a*b*k*Math.sin(l)+this.x0,a.y=this.a*b*(this.coslat0*j-this.sinlat0*k*Math.cos(l))+this.y0,a):(c=2*Math.atan(this.ssfn_(i,j,this.e))-aa,e=Math.cos(c),d=Math.sin(c),Math.abs(this.coslat0)<=ea?(f=ua(this.e,i*this.con,this.con*j),g=2*this.a*this.k0*f/this.cons,a.x=this.x0+g*Math.sin(h-this.long0),a.y=this.y0-this.con*g*Math.cos(h-this.long0),a):(Math.abs(this.sinlat0)<ea?(b=2*this.a*this.k0/(1+e*Math.cos(l)),a.y=b*d):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*d+this.cosX0*e*Math.cos(l))),a.y=b*(this.cosX0*d-this.sinX0*e*Math.cos(l))+this.y0),a.x=b*e*Math.sin(l)+this.x0,a))},inverse:function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d,e,f,g=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var h=2*Math.atan(g/(2*this.a*this.k0));return b=this.long0,c=this.lat0,g<=ea?(a.x=b,a.y=c,a):(c=Math.asin(Math.cos(h)*this.sinlat0+a.y*Math.sin(h)*this.coslat0/g),b=ta(Math.abs(this.coslat0)<ea?this.lat0>0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(h),g*this.coslat0*Math.cos(h)-a.y*this.sinlat0*Math.sin(h))),a.x=b,a.y=c,a)}if(Math.abs(this.coslat0)<=ea){if(g<=ea)return c=this.lat0,b=this.long0,a.x=b,a.y=c,a;a.x*=this.con,a.y*=this.con,d=g*this.cons/(2*this.a*this.k0),c=this.con*va(this.e,d),b=this.con*ta(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else e=2*Math.atan(g*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,g<=ea?f=this.X0:(f=Math.asin(Math.cos(e)*this.sinX0+a.y*Math.sin(e)*this.cosX0/g),b=ta(this.long0+Math.atan2(a.x*Math.sin(e),g*this.cosX0*Math.cos(e)-a.y*this.sinX0*Math.sin(e)))),c=-1*va(this.e,Math.tan(.5*(aa+f)));return a.x=b,a.y=c,a},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(a,b,c){return b*=c,Math.tan(.5*(aa+a))*Math.pow((1-b)/(1+b),.5*c)}},kb={init:function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,d=1/this.rf,e=2*d-Math.pow(d,2),f=this.e=Math.sqrt(e);this.R=this.k0*c*Math.sqrt(1-e)/(1-e*Math.pow(b,2)),this.alpha=Math.sqrt(1+e/(1-e)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(b/this.alpha);var g=Math.log(Math.tan(Math.PI/4+this.b0/2)),h=Math.log(Math.tan(Math.PI/4+a/2)),i=Math.log((1+f*b)/(1-f*b));this.K=g-this.alpha*h+this.alpha*f/2*i},forward:function(a){var b=Math.log(Math.tan(Math.PI/4-a.y/2)),c=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),d=-this.alpha*(b+c)+this.K,e=2*(Math.atan(Math.exp(d))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),g=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(f))),h=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(h))/(1-Math.sin(h)))+this.y0,a.x=this.R*g+this.x0,a},inverse:function(a){for(var b=a.x-this.x0,c=a.y-this.y0,d=b/this.R,e=2*(Math.atan(Math.exp(c/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(d)),g=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(e))),h=this.lambda0+g/this.alpha,i=0,j=f,k=-1e3,l=0;Math.abs(j-k)>1e-7;){if(++l>20)return;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(j))/2)),k=j,j=2*Math.atan(Math.exp(i))-Math.PI/2}return a.x=h,a.y=j,a},names:["somerc"]},lb={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-c*c);var d=ua(this.e,this.lat0,a),e=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));e*e<1&&(e=1);var f,g;if(isNaN(this.longc)){var h=ua(this.e,this.lat1,Math.sin(this.lat1)),i=ua(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(e+Math.sqrt(e*e-1))*Math.pow(d,this.bl):this.el=(e-Math.sqrt(e*e-1))*Math.pow(d,this.bl);var j=Math.pow(h,this.bl),k=Math.pow(i,this.bl);g=.5*((f=this.el/j)-1/f);var l=(this.el*this.el-k*j)/(this.el*this.el+k*j),m=(k-j)/(k+j),n=ta(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(l*Math.tan(.5*this.bl*n)/m)/this.bl,this.long0=ta(this.long0);var o=ta(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*o)/g),this.alpha=Math.asin(e*Math.sin(this.gamma0))}else f=this.lat0>=0?e+Math.sqrt(e*e-1):e-Math.sqrt(e*e-1),this.el=f*Math.pow(d,this.bl),g=.5*(f-1/f),this.gamma0=Math.asin(Math.sin(this.alpha)/e),this.long0=this.longc-Math.asin(g*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(e*e-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(e*e-1),Math.cos(this.alpha))},forward:function(a){var b,c,d,e=a.x,f=a.y,g=ta(e-this.long0);if(Math.abs(Math.abs(f)-aa)<=ea)d=f>0?-1:1,c=this.al/this.bl*Math.log(Math.tan(ha+d*this.gamma0*.5)),b=-1*d*aa*this.al/this.bl;else{var h=ua(this.e,f,Math.sin(f)),i=this.el/Math.pow(h,this.bl),j=.5*(i-1/i),k=.5*(i+1/i),l=Math.sin(this.bl*g),m=(j*Math.sin(this.gamma0)-l*Math.cos(this.gamma0))/k;c=Math.abs(Math.abs(m)-1)<=ea?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-m)/(1+m))/this.bl,b=Math.abs(Math.cos(this.bl*g))<=ea?this.al*this.bl*g:this.al*Math.atan2(j*Math.cos(this.gamma0)+l*Math.sin(this.gamma0),Math.cos(this.bl*g))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a},inverse:function(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var d=Math.exp(-1*this.bl*c/this.al),e=.5*(d-1/d),f=.5*(d+1/d),g=Math.sin(this.bl*b/this.al),h=(g*Math.cos(this.gamma0)+e*Math.sin(this.gamma0))/f,i=Math.pow(this.el/Math.sqrt((1+h)/(1-h)),1/this.bl);return Math.abs(h-1)<ea?(a.x=this.long0,a.y=aa):Math.abs(h+1)<ea?(a.x=this.long0,a.y=-1*aa):(a.y=va(this.e,i),a.x=ta(this.long0-Math.atan2(e*Math.cos(this.gamma0)-g*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},mb={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ea)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),d=ra(this.e,b,c),e=ua(this.e,this.lat1,b),f=Math.sin(this.lat2),g=Math.cos(this.lat2),h=ra(this.e,f,g),i=ua(this.e,this.lat2,f),j=ua(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ea?this.ns=Math.log(d/h)/Math.log(e/i):this.ns=b,isNaN(this.ns)&&(this.ns=b),this.f0=d/(this.ns*Math.pow(e,this.ns)),this.rh=this.a*this.f0*Math.pow(j,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=ea&&(c=sa(c)*(aa-2*ea));var d,e,f=Math.abs(Math.abs(c)-aa);if(f>ea)d=ua(this.e,c,Math.sin(c)),e=this.a*this.f0*Math.pow(d,this.ns);else{if((f=c*this.ns)<=0)return null;e=0}var g=this.ns*ta(b-this.long0);return a.x=this.k0*(e*Math.sin(g))+this.x0,a.y=this.k0*(this.rh-e*Math.cos(g))+this.y0,a},inverse:function(a){var b,c,d,e,f,g=(a.x-this.x0)/this.k0,h=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(g*g+h*h),c=1):(b=-Math.sqrt(g*g+h*h),c=-1);var i=0;if(0!==b&&(i=Math.atan2(c*g,c*h)),0!==b||this.ns>0){if(c=1/this.ns,d=Math.pow(b/(this.a*this.f0),c),-9999===(e=va(this.e,d)))return null}else e=-aa;return f=ta(i/this.ns+this.long0),a.x=f,a.y=e,a},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},nb={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(a){var b,c,d,e,f,g,h,i=a.x,j=a.y,k=ta(i-this.long0);return b=Math.pow((1+this.e*Math.sin(j))/(1-this.e*Math.sin(j)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(j/2+this.s45),this.alfa)/b)-this.s45),d=-k*this.alfa,e=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(d)),f=Math.asin(Math.cos(c)*Math.sin(d)/Math.cos(e)),g=this.n*f,h=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(e/2+this.s45),this.n),a.y=h*Math.cos(g)/1,a.x=h*Math.sin(g)/1,this.czech||(a.y*=-1,a.x*=-1),a},inverse:function(a){var b,c,d,e,f,g,h,i=a.x;a.x=a.y,a.y=i,this.czech||(a.y*=-1,a.x*=-1),f=Math.sqrt(a.x*a.x+a.y*a.y),e=Math.atan2(a.y,a.x)/Math.sin(this.s0),d=2*(Math.atan(Math.pow(this.ro0/f,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(e)),c=Math.asin(Math.cos(d)*Math.sin(e)/Math.cos(b)),a.x=this.long0-c/this.alfa,g=b,h=0;var j=0;do{a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.e/2))-this.s45),Math.abs(g-a.y)<1e-10&&(h=1),g=a.y,j+=1}while(0===h&&j<15);return j>=15?null:a},names:["Krovak","krovak"]},ob=function(a,b,c,d,e){return a*e-b*Math.sin(2*e)+c*Math.sin(4*e)-d*Math.sin(6*e)},pb=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))},qb=function(a){return.375*a*(1+.25*a*(1+.46875*a))},rb=function(a){return.05859375*a*a*(1+.75*a)},sb=function(a){return a*a*a*(35/3072)},tb=function(a,b,c){var d=b*c;return a/Math.sqrt(1-d*d)},ub=function(a){return Math.abs(a)<aa?a:a-sa(a)*Math.PI},vb=function(a,b,c,d,e){var f,g;f=a/b;for(var h=0;h<15;h++)if(g=(a-(b*f-c*Math.sin(2*f)+d*Math.sin(4*f)-e*Math.sin(6*f)))/(b-2*c*Math.cos(2*f)+4*d*Math.cos(4*f)-6*e*Math.cos(6*f)),f+=g,Math.abs(g)<=1e-10)return f;return NaN},wb={init:function(){this.sphere||(this.e0=pb(this.es),this.e1=qb(this.es),this.e2=rb(this.es),this.e3=sb(this.es),this.ml0=this.a*ob(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(a){var b,c,d=a.x,e=a.y;if(d=ta(d-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(e)*Math.sin(d)),c=this.a*(Math.atan2(Math.tan(e),Math.cos(d))-this.lat0);else{var f=Math.sin(e),g=Math.cos(e),h=tb(this.a,this.e,f),i=Math.tan(e)*Math.tan(e),j=d*Math.cos(e),k=j*j,l=this.es*g*g/(1-this.es);b=h*j*(1-k*i*(1/6-(8-i+8*l)*k/120)),c=this.a*ob(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+h*f/g*k*(.5+(5-i+6*l)*k/24)}return a.x=b+this.x0,a.y=c+this.y0,a},inverse:function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d=a.x/this.a,e=a.y/this.a;if(this.sphere){var f=e+this.lat0;b=Math.asin(Math.sin(f)*Math.cos(d)),c=Math.atan2(Math.tan(d),Math.cos(f))}else{var g=this.ml0/this.a+e,h=vb(g,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(h)-aa)<=ea)return a.x=this.long0,a.y=aa,e<0&&(a.y*=-1),a;var i=tb(this.a,this.e,Math.sin(h)),j=i*i*i/this.a/this.a*(1-this.es),k=Math.pow(Math.tan(h),2),l=d*this.a/i,m=l*l;b=h-i*Math.tan(h)/j*l*l*(.5-(1+3*k)*l*l/24),c=l*(1-m*(k/3+(1+3*k)*k*m/15))/Math.cos(h)}return a.x=ta(c+this.long0),a.y=ub(b),a},names:["Cassini","Cassini_Soldner","cass"]},xb=function(a,b){var c;return a>1e-7?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b},yb=.3333333333333333,zb=.17222222222222222,Ab=.10257936507936508,Bb=.06388888888888888,Cb=.0664021164021164,Db=.016415012942191543,Eb={init:function(){var a=Math.abs(this.lat0);if(Math.abs(a-aa)<ea?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<ea?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var b;switch(this.qp=xb(this.e,1),this.mmf=.5/(1-this.es),this.apa=S(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=xb(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(a){var b,c,d,e,f,g,h,i,j,k,l=a.x,m=a.y;if(l=ta(l-this.long0),this.sphere){if(f=Math.sin(m),k=Math.cos(m),d=Math.cos(l),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((c=this.mode===this.EQUIT?1+k*d:1+this.sinph0*f+this.cosph0*k*d)<=ea)return null;b=(c=Math.sqrt(2/c))*k*Math.sin(l),c*=this.mode===this.EQUIT?f:this.cosph0*f-this.sinph0*k*d}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),Math.abs(m+this.lat0)<ea)return null;c=ha-.5*m,b=(c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)))*Math.sin(l),c*=d}}else{switch(h=0,i=0,j=0,d=Math.cos(l),e=Math.sin(l),f=Math.sin(m),g=xb(this.e,f),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(h=g/this.qp,i=Math.sqrt(1-h*h)),this.mode){case this.OBLIQ:j=1+this.sinb1*h+this.cosb1*i*d;break;case this.EQUIT:j=1+i*d;break;case this.N_POLE:j=aa+m,g=this.qp-g;break;case this.S_POLE:j=m-aa,g=this.qp+g}if(Math.abs(j)<ea)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:j=Math.sqrt(2/j),c=this.mode===this.OBLIQ?this.ymf*j*(this.cosb1*h-this.sinb1*i*d):(j=Math.sqrt(2/(1+i*d)))*h*this.ymf,b=this.xmf*j*i*e;break;case this.N_POLE:case this.S_POLE:g>=0?(b=(j=Math.sqrt(g))*e,c=d*(this.mode===this.S_POLE?j:-j)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a},inverse:function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d,e,f,g,h,i=a.x/this.a,j=a.y/this.a;if(this.sphere){var k,l=0,m=0;if(k=Math.sqrt(i*i+j*j),(c=.5*k)>1)return null;switch(c=2*Math.asin(c),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=Math.sin(c),l=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(k)<=ea?0:Math.asin(j*m/k),i*=m,j=l*k;break;case this.OBLIQ:c=Math.abs(k)<=ea?this.lat0:Math.asin(l*this.sinph0+j*m*this.cosph0/k),i*=m*this.cosph0,j=(l-Math.sin(c)*this.sinph0)*k;break;case this.N_POLE:j=-j,c=aa-c;break;case this.S_POLE:c-=aa}b=0!==j||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(i,j):0}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i/=this.dd,j*=this.dd,(g=Math.sqrt(i*i+j*j))<ea)return a.x=this.long0,a.y=this.lat0,a;e=2*Math.asin(.5*g/this.rq),d=Math.cos(e),i*=e=Math.sin(e),this.mode===this.OBLIQ?(h=d*this.sinb1+j*e*this.cosb1/g,f=this.qp*h,j=g*this.cosb1*d-j*this.sinb1*e):(h=j*e/g,f=this.qp*h,j=g*d)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(j=-j),!(f=i*i+j*j))return a.x=this.long0,a.y=this.lat0,a;h=1-f/this.qp,this.mode===this.S_POLE&&(h=-h)}b=Math.atan2(i,j),c=T(Math.asin(h),this.apa)}return a.x=ta(this.long0+b),a.y=c,a},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Fb=function(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)},Gb={init:function(){Math.abs(this.lat1+this.lat2)<ea||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ra(this.e3,this.sin_po,this.cos_po),this.qs1=xb(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ra(this.e3,this.sin_po,this.cos_po),this.qs2=xb(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=xb(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>ea?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c),this.cos_phi=Math.cos(c);var d=xb(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,f=this.ns0*ta(b-this.long0),g=e*Math.sin(f)+this.x0,h=this.rh-e*Math.cos(f)+this.y0;return a.x=g,a.y=h,a},inverse:function(a){var b,c,d,e,f,g;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),e=0,0!==b&&(e=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?g=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,g=this.phi1z(this.e3,c)),f=ta(e/this.ns0+this.long0),a.x=f,a.y=g,a},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(a,b){var c,d,e,f,g,h=Fb(.5*b);if(a<ea)return h;for(var i=a*a,j=1;j<=25;j++)if(c=Math.sin(h),d=Math.cos(h),e=a*c,f=1-e*e,g=.5*f*f/d*(b/(1-i)-c/f+.5/a*Math.log((1-e)/(1+e))),h+=g,Math.abs(g)<=1e-7)return h;return null}},Hb={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(a){var b,c,d,e,f,g,h,i=a.x,j=a.y;return d=ta(i-this.long0),b=Math.sin(j),c=Math.cos(j),e=Math.cos(d),(f=this.sin_p14*b+this.cos_p14*c*e)>0||Math.abs(f)<=ea?(g=this.x0+1*this.a*c*Math.sin(d)/f,h=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*c*e)/f):(g=this.x0+this.infinity_dist*c*Math.sin(d),h=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*e)),a.x=g,a.y=h,a},inverse:function(a){var b,c,d,e,f,g;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(e=Math.atan2(b,this.rc),c=Math.sin(e),d=Math.cos(e),g=Fb(d*this.sin_p14+a.y*c*this.cos_p14/b),f=Math.atan2(a.x*c,b*this.cos_p14*d-a.y*this.sin_p14*c),f=ta(this.long0+f)):(g=this.phic0,f=0),a.x=f,a.y=g,a},names:["gnom"]},Ib=function(a,b){var c=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(b)-c)<1e-6)return b<0?-1*aa:aa;for(var d,e,f,g,h=Math.asin(.5*b),i=0;i<30;i++)if(e=Math.sin(h),f=Math.cos(h),g=a*e,d=Math.pow(1-g*g,2)/(2*f)*(b/(1-a*a)-e/(1-g*g)+.5/a*Math.log((1-g)/(1+g))),h+=d,Math.abs(d)<=1e-10)return h;return NaN},Jb={init:function(){this.sphere||(this.k0=ra(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(a){var b,c,d=a.x,e=a.y,f=ta(d-this.long0);if(this.sphere)b=this.x0+this.a*f*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var g=xb(this.e,Math.sin(e));b=this.x0+this.a*this.k0*f,c=this.y0+this.a*g*.5/this.k0}return a.x=b,a.y=c,a},inverse:function(a){a.x-=this.x0,a.y-=this.y0;var b,c;return this.sphere?(b=ta(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=Ib(this.e,2*a.y*this.k0/this.a),b=ta(this.long0+a.x/(this.a*this.k0))),a.x=b,a.y=c,a},names:["cea"]},Kb={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(a){var b=a.x,c=a.y,d=ta(b-this.long0),e=ub(c-this.lat0);return a.x=this.x0+this.a*d*this.rc,a.y=this.y0+this.a*e,a},inverse:function(a){var b=a.x,c=a.y;return a.x=ta(this.long0+(b-this.x0)/(this.a*this.rc)),a.y=ub(this.lat0+(c-this.y0)/this.a),a},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Lb=20,Mb={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=pb(this.es),this.e1=qb(this.es),this.e2=rb(this.es),this.e3=sb(this.es),this.ml0=this.a*ob(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(a){var b,c,d,e=a.x,f=a.y,g=ta(e-this.long0);if(d=g*Math.sin(f),this.sphere)Math.abs(f)<=ea?(b=this.a*g,c=-1*this.a*this.lat0):(b=this.a*Math.sin(d)/Math.tan(f),c=this.a*(ub(f-this.lat0)+(1-Math.cos(d))/Math.tan(f)));else if(Math.abs(f)<=ea)b=this.a*g,c=-1*this.ml0;else{var h=tb(this.a,this.e,Math.sin(f))/Math.tan(f);b=h*Math.sin(d),c=this.a*ob(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+h*(1-Math.cos(d))}return a.x=b+this.x0,a.y=c+this.y0,a},inverse:function(a){var b,c,d,e,f,g,h,i,j;if(d=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=ea)b=ta(d/this.a+this.long0),c=0;else{g=this.lat0+e/this.a,h=d*d/this.a/this.a+g*g,i=g;var k;for(f=Lb;f;--f)if(k=Math.tan(i),j=-1*(g*(i*k+1)-i-.5*(i*i+h)*k)/((i-g)/k-1),i+=j,Math.abs(j)<=ea){c=i;break}b=ta(this.long0+Math.asin(d*Math.tan(i)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=ea)c=0,b=ta(this.long0+d/this.a);else{g=(this.ml0+e)/this.a,h=d*d/this.a/this.a+g*g,i=g;var l,m,n,o,p;for(f=Lb;f;--f)if(p=this.e*Math.sin(i),l=Math.sqrt(1-p*p)*Math.tan(i),m=this.a*ob(this.e0,this.e1,this.e2,this.e3,i),n=this.e0-2*this.e1*Math.cos(2*i)+4*this.e2*Math.cos(4*i)-6*this.e3*Math.cos(6*i),o=m/this.a,j=(g*(l*o+1)-o-.5*l*(o*o+h))/(this.es*Math.sin(2*i)*(o*o+h-2*g*o)/(4*l)+(g-o)*(l*n-2/Math.sin(2*i))-n),i-=j,Math.abs(j)<=ea){c=i;break}l=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c),b=ta(this.long0+Math.asin(d*l/this.a)/Math.sin(c))}return a.x=b,a.y=c,a},names:["Polyconic","poly"]},Nb={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(a){var b,c=a.x,d=a.y-this.lat0,e=c-this.long0,f=d/_*1e-5,g=e,h=1,i=0;for(b=1;b<=10;b++)h*=f,i+=this.A[b]*h;var j,k=i,l=g,m=1,n=0,o=0,p=0;for(b=1;b<=6;b++)j=n*k+m*l,m=m*k-n*l,n=j,o=o+this.B_re[b]*m-this.B_im[b]*n,p=p+this.B_im[b]*m+this.B_re[b]*n;return a.x=p*this.a+this.x0,a.y=o*this.a+this.y0,a},inverse:function(a){var b,c,d=a.x,e=a.y,f=d-this.x0,g=(e-this.y0)/this.a,h=f/this.a,i=1,j=0,k=0,l=0;for(b=1;b<=6;b++)c=j*g+i*h,i=i*g-j*h,j=c,k=k+this.C_re[b]*i-this.C_im[b]*j,l=l+this.C_im[b]*i+this.C_re[b]*j;for(var m=0;m<this.iterations;m++){var n,o=k,p=l,q=g,r=h;for(b=2;b<=6;b++)n=p*k+o*l,o=o*k-p*l,p=n,q+=(b-1)*(this.B_re[b]*o-this.B_im[b]*p),r+=(b-1)*(this.B_im[b]*o+this.B_re[b]*p);o=1,p=0;var s=this.B_re[1],t=this.B_im[1];for(b=2;b<=6;b++)n=p*k+o*l,o=o*k-p*l,p=n,s+=b*(this.B_re[b]*o-this.B_im[b]*p),t+=b*(this.B_im[b]*o+this.B_re[b]*p);var u=s*s+t*t;k=(q*s+r*t)/u,l=(r*s-q*t)/u}var v=k,w=l,x=1,y=0;for(b=1;b<=9;b++)x*=v,y+=this.D[b]*x;var z=this.lat0+y*_*1e5,A=this.long0+w;return a.x=A,a.y=z,a},names:["New_Zealand_Map_Grid","nzmg"]},Ob={init:function(){},forward:function(a){var b=a.x,c=a.y,d=ta(b-this.long0),e=this.x0+this.a*d,f=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return a.x=e,a.y=f,a},inverse:function(a){a.x-=this.x0,a.y-=this.y0;var b=ta(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a},names:["Miller_Cylindrical","mill"]},Pb=20,Qb={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Sa(this.es)},forward:function(a){var b,c,d=a.x,e=a.y;if(d=ta(d-this.long0),this.sphere){if(this.m)for(var f=this.n*Math.sin(e),g=Pb;g;--g){var h=(this.m*e+Math.sin(e)-f)/(this.m+Math.cos(e));if(e-=h,Math.abs(h)<ea)break}else e=1!==this.n?Math.asin(this.n*Math.sin(e)):e;b=this.a*this.C_x*d*(this.m+Math.cos(e)),c=this.a*this.C_y*e}else{var i=Math.sin(e),j=Math.cos(e);c=this.a*Ta(e,i,j,this.en),b=this.a*d*j/Math.sqrt(1-this.es*i*i)}return a.x=b,a.y=c,a},inverse:function(a){var b,c,d,e;return a.x-=this.x0,d=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,d/=this.C_x*(this.m+Math.cos(b)),this.m?b=Fb((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=Fb(Math.sin(b)/this.n)),d=ta(d+this.long0),b=ub(b)):(b=Ua(a.y/this.a,this.es,this.en),(e=Math.abs(b))<aa?(e=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*e*e)/(this.a*Math.cos(b)),d=ta(c)):e-ea<aa&&(d=this.long0)),a.x=d,a.y=b,a},names:["Sinusoidal","sinu"]},Rb={init:function(){},forward:function(a){for(var b=a.x,c=a.y,d=ta(b-this.long0),e=c,f=Math.PI*Math.sin(c);;){var g=-(e+Math.sin(e)-f)/(1+Math.cos(e));if(e+=g,Math.abs(g)<ea)break}e/=2,Math.PI/2-Math.abs(c)<ea&&(d=0);var h=.900316316158*this.a*d*Math.cos(e)+this.x0,i=1.4142135623731*this.a*Math.sin(e)+this.y0;return a.x=h,a.y=i,a},inverse:function(a){var b,c;a.x-=this.x0,a.y-=this.y0,c=a.y/(1.4142135623731*this.a),Math.abs(c)>.999999999999&&(c=.999999999999),b=Math.asin(c);var d=ta(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));d<-Math.PI&&(d=-Math.PI),d>Math.PI&&(d=Math.PI),c=(2*b+Math.sin(2*b))/Math.PI,Math.abs(c)>1&&(c=1);var e=Math.asin(c);return a.x=d,a.y=e,a},names:["Mollweide","moll"]},Sb={init:function(){Math.abs(this.lat1+this.lat2)<ea||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=pb(this.es),this.e1=qb(this.es),this.e2=rb(this.es),this.e3=sb(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=ra(this.e,this.sinphi,this.cosphi),this.ml1=ob(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ea?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=ra(this.e,this.sinphi,this.cosphi),this.ml2=ob(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ob(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(a){var b,c=a.x,d=a.y;if(this.sphere)b=this.a*(this.g-d);else{var e=ob(this.e0,this.e1,this.e2,this.e3,d);b=this.a*(this.g-e)}var f=this.ns*ta(c-this.long0),g=this.x0+b*Math.sin(f),h=this.y0+this.rh-b*Math.cos(f);return a.x=g,a.y=h,a},inverse:function(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var b,c,d,e
;this.ns>=0?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var f=0;if(0!==c&&(f=Math.atan2(b*a.x,b*a.y)),this.sphere)return e=ta(this.long0+f/this.ns),d=ub(this.g-c/this.a),a.x=e,a.y=d,a;var g=this.g-c/this.a;return d=vb(g,this.e0,this.e1,this.e2,this.e3),e=ta(this.long0+f/this.ns),a.x=e,a.y=d,a},names:["Equidistant_Conic","eqdc"]},Tb={init:function(){this.R=this.a},forward:function(a){var b,c,d=a.x,e=a.y,f=ta(d-this.long0);Math.abs(e)<=ea&&(b=this.x0+this.R*f,c=this.y0);var g=Fb(2*Math.abs(e/Math.PI));(Math.abs(f)<=ea||Math.abs(Math.abs(e)-aa)<=ea)&&(b=this.x0,c=e>=0?this.y0+Math.PI*this.R*Math.tan(.5*g):this.y0+Math.PI*this.R*-Math.tan(.5*g));var h=.5*Math.abs(Math.PI/f-f/Math.PI),i=h*h,j=Math.sin(g),k=Math.cos(g),l=k/(j+k-1),m=l*l,n=l*(2/j-1),o=n*n,p=Math.PI*this.R*(h*(l-o)+Math.sqrt(i*(l-o)*(l-o)-(o+i)*(m-o)))/(o+i);f<0&&(p=-p),b=this.x0+p;var q=i+l;return p=Math.PI*this.R*(n*q-h*Math.sqrt((o+i)*(i+1)-q*q))/(o+i),c=e>=0?this.y0+p:this.y0-p,a.x=b,a.y=c,a},inverse:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return a.x-=this.x0,a.y-=this.y0,l=Math.PI*this.R,d=a.x/l,e=a.y/l,f=d*d+e*e,g=-Math.abs(e)*(1+f),h=g-2*e*e+d*d,i=-2*g+1+2*e*e+f*f,n=e*e/i+(2*h*h*h/i/i/i-9*g*h/i/i)/27,j=(g-h*h/3/i)/i,k=2*Math.sqrt(-j/3),l=3*n/j/k,Math.abs(l)>1&&(l=l>=0?1:-1),m=Math.acos(l)/3,c=a.y>=0?(-k*Math.cos(m+Math.PI/3)-h/3/i)*Math.PI:-(-k*Math.cos(m+Math.PI/3)-h/3/i)*Math.PI,b=Math.abs(d)<ea?this.long0:ta(this.long0+Math.PI*(f-1+Math.sqrt(1+2*(d*d-e*e)+f*f))/2/d),a.x=b,a.y=c,a},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Ub={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=a.x,z=a.y,A=Math.sin(a.y),B=Math.cos(a.y),C=ta(y-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=ea?(a.x=this.x0+this.a*(aa-z)*Math.sin(C),a.y=this.y0-this.a*(aa-z)*Math.cos(C),a):Math.abs(this.sin_p12+1)<=ea?(a.x=this.x0+this.a*(aa+z)*Math.sin(C),a.y=this.y0+this.a*(aa+z)*Math.cos(C),a):(s=this.sin_p12*A+this.cos_p12*B*Math.cos(C),q=Math.acos(s),r=q?q/Math.sin(q):1,a.x=this.x0+this.a*r*B*Math.sin(C),a.y=this.y0+this.a*r*(this.cos_p12*A-this.sin_p12*B*Math.cos(C)),a):(b=pb(this.es),c=qb(this.es),d=rb(this.es),e=sb(this.es),Math.abs(this.sin_p12-1)<=ea?(f=this.a*ob(b,c,d,e,aa),g=this.a*ob(b,c,d,e,z),a.x=this.x0+(f-g)*Math.sin(C),a.y=this.y0-(f-g)*Math.cos(C),a):Math.abs(this.sin_p12+1)<=ea?(f=this.a*ob(b,c,d,e,aa),g=this.a*ob(b,c,d,e,z),a.x=this.x0+(f+g)*Math.sin(C),a.y=this.y0+(f+g)*Math.cos(C),a):(h=A/B,i=tb(this.a,this.e,this.sin_p12),j=tb(this.a,this.e,A),k=Math.atan((1-this.es)*h+this.es*i*this.sin_p12/(j*B)),l=Math.atan2(Math.sin(C),this.cos_p12*Math.tan(k)-this.sin_p12*Math.cos(C)),t=0===l?Math.asin(this.cos_p12*Math.sin(k)-this.sin_p12*Math.cos(k)):Math.abs(Math.abs(l)-Math.PI)<=ea?-Math.asin(this.cos_p12*Math.sin(k)-this.sin_p12*Math.cos(k)):Math.asin(Math.sin(C)*Math.cos(k)/Math.sin(l)),m=this.e*this.sin_p12/Math.sqrt(1-this.es),n=this.e*this.cos_p12*Math.cos(l)/Math.sqrt(1-this.es),o=m*n,p=n*n,u=t*t,v=u*t,w=v*t,x=w*t,q=i*t*(1-u*p*(1-p)/6+v/8*o*(1-2*p)+w/120*(p*(4-7*p)-3*m*m*(1-7*p))-x/48*o),a.x=this.x0+q*Math.sin(l),a.y=this.y0+q*Math.cos(l),a))},inverse:function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(this.sphere){if((b=Math.sqrt(a.x*a.x+a.y*a.y))>2*aa*this.a)return;return c=b/this.a,d=Math.sin(c),e=Math.cos(c),f=this.long0,Math.abs(b)<=ea?g=this.lat0:(g=Fb(e*this.sin_p12+a.y*d*this.cos_p12/b),h=Math.abs(this.lat0)-aa,f=ta(Math.abs(h)<=ea?this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*d,b*this.cos_p12*e-a.y*this.sin_p12*d))),a.x=f,a.y=g,a}return i=pb(this.es),j=qb(this.es),k=rb(this.es),l=sb(this.es),Math.abs(this.sin_p12-1)<=ea?(m=this.a*ob(i,j,k,l,aa),b=Math.sqrt(a.x*a.x+a.y*a.y),n=m-b,g=vb(n/this.a,i,j,k,l),f=ta(this.long0+Math.atan2(a.x,-1*a.y)),a.x=f,a.y=g,a):Math.abs(this.sin_p12+1)<=ea?(m=this.a*ob(i,j,k,l,aa),b=Math.sqrt(a.x*a.x+a.y*a.y),n=b-m,g=vb(n/this.a,i,j,k,l),f=ta(this.long0+Math.atan2(a.x,a.y)),a.x=f,a.y=g,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),q=Math.atan2(a.x,a.y),o=tb(this.a,this.e,this.sin_p12),r=Math.cos(q),s=this.e*this.cos_p12*r,t=-s*s/(1-this.es),u=3*this.es*(1-t)*this.sin_p12*this.cos_p12*r/(1-this.es),v=b/o,w=v-t*(1+t)*Math.pow(v,3)/6-u*(1+3*t)*Math.pow(v,4)/24,x=1-t*w*w/2-v*w*w*w/6,p=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*r),f=ta(this.long0+Math.asin(Math.sin(q)*Math.sin(w)/Math.cos(p))),y=Math.sin(p),g=Math.atan2((y-this.es*x*this.sin_p12)*Math.tan(p),y*(1-this.es)),a.x=f,a.y=g,a)},names:["Azimuthal_Equidistant","aeqd"]},Vb={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(a){var b,c,d,e,f,g,h,i=a.x,j=a.y;return d=ta(i-this.long0),b=Math.sin(j),c=Math.cos(j),e=Math.cos(d),((f=this.sin_p14*b+this.cos_p14*c*e)>0||Math.abs(f)<=ea)&&(g=1*this.a*c*Math.sin(d),h=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*c*e)),a.x=g,a.y=h,a},inverse:function(a){var b,c,d,e,f,g,h;return a.x-=this.x0,a.y-=this.y0,b=Math.sqrt(a.x*a.x+a.y*a.y),c=Fb(b/this.a),d=Math.sin(c),e=Math.cos(c),g=this.long0,Math.abs(b)<=ea?(h=this.lat0,a.x=g,a.y=h,a):(h=Fb(e*this.sin_p14+a.y*d*this.cos_p14/b),f=Math.abs(this.lat0)-aa,Math.abs(f)<=ea?(g=ta(this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y)),a.x=g,a.y=h,a):(g=ta(this.long0+Math.atan2(a.x*d,b*this.cos_p14*e-a.y*this.sin_p14*d)),a.x=g,a.y=h,a))},names:["ortho"]},Wb={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Xb={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},Yb={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=aa-ha/2?this.face=Wb.TOP:this.lat0<=-(aa-ha/2)?this.face=Wb.BOTTOM:Math.abs(this.long0)<=ha?this.face=Wb.FRONT:Math.abs(this.long0)<=aa+ha?this.face=this.long0>0?Wb.RIGHT:Wb.LEFT:this.face=Wb.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(a){var b,c,d,e,f,g,h={x:0,y:0},i={value:0};if(a.x-=this.long0,b=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(a.y)):a.y,c=a.x,this.face===Wb.TOP)e=aa-b,c>=ha&&c<=aa+ha?(i.value=Xb.AREA_0,d=c-aa):c>aa+ha||c<=-(aa+ha)?(i.value=Xb.AREA_1,d=c>0?c-ja:c+ja):c>-(aa+ha)&&c<=-ha?(i.value=Xb.AREA_2,d=c+aa):(i.value=Xb.AREA_3,d=c);else if(this.face===Wb.BOTTOM)e=aa+b,c>=ha&&c<=aa+ha?(i.value=Xb.AREA_0,d=-c+aa):c<ha&&c>=-ha?(i.value=Xb.AREA_1,d=-c):c<-ha&&c>=-(aa+ha)?(i.value=Xb.AREA_2,d=-c-aa):(i.value=Xb.AREA_3,d=c>0?-c+ja:-c-ja);else{var j,k,l,m,n,o;this.face===Wb.RIGHT?c=V(c,+aa):this.face===Wb.BACK?c=V(c,+ja):this.face===Wb.LEFT&&(c=V(c,-aa)),m=Math.sin(b),n=Math.cos(b),o=Math.sin(c),j=n*Math.cos(c),k=n*o,l=m,this.face===Wb.FRONT?d=U(e=Math.acos(j),l,k,i):this.face===Wb.RIGHT?d=U(e=Math.acos(k),l,-j,i):this.face===Wb.BACK?d=U(e=Math.acos(-j),l,-k,i):this.face===Wb.LEFT?d=U(e=Math.acos(-k),l,j,i):(e=d=0,i.value=Xb.AREA_0)}return g=Math.atan(12/ja*(d+Math.acos(Math.sin(d)*Math.cos(ha))-aa)),f=Math.sqrt((1-Math.cos(e))/(Math.cos(g)*Math.cos(g))/(1-Math.cos(Math.atan(1/Math.cos(d))))),i.value===Xb.AREA_1?g+=aa:i.value===Xb.AREA_2?g+=ja:i.value===Xb.AREA_3&&(g+=1.5*ja),h.x=f*Math.cos(g),h.y=f*Math.sin(g),h.x=h.x*this.a+this.x0,h.y=h.y*this.a+this.y0,a.x=h.x,a.y=h.y,a},inverse:function(a){var b,c,d,e,f,g,h,i,j,k={lam:0,phi:0},l={value:0};if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,c=Math.atan(Math.sqrt(a.x*a.x+a.y*a.y)),b=Math.atan2(a.y,a.x),a.x>=0&&a.x>=Math.abs(a.y)?l.value=Xb.AREA_0:a.y>=0&&a.y>=Math.abs(a.x)?(l.value=Xb.AREA_1,b-=aa):a.x<0&&-a.x>=Math.abs(a.y)?(l.value=Xb.AREA_2,b=b<0?b+ja:b-ja):(l.value=Xb.AREA_3,b+=aa),j=ja/12*Math.tan(b),f=Math.sin(j)/(Math.cos(j)-1/Math.sqrt(2)),g=Math.atan(f),d=Math.cos(b),e=Math.tan(c),(h=1-d*d*e*e*(1-Math.cos(Math.atan(1/Math.cos(g)))))<-1?h=-1:h>1&&(h=1),this.face===Wb.TOP)i=Math.acos(h),k.phi=aa-i,l.value===Xb.AREA_0?k.lam=g+aa:l.value===Xb.AREA_1?k.lam=g<0?g+ja:g-ja:l.value===Xb.AREA_2?k.lam=g-aa:k.lam=g;else if(this.face===Wb.BOTTOM)i=Math.acos(h),k.phi=i-aa,l.value===Xb.AREA_0?k.lam=-g+aa:l.value===Xb.AREA_1?k.lam=-g:l.value===Xb.AREA_2?k.lam=-g-aa:k.lam=g<0?-g-ja:-g+ja;else{var m,n,o;j=(m=h)*m,n=(j+=(o=j>=1?0:Math.sqrt(1-j)*Math.sin(g))*o)>=1?0:Math.sqrt(1-j),l.value===Xb.AREA_1?(j=n,n=-o,o=j):l.value===Xb.AREA_2?(n=-n,o=-o):l.value===Xb.AREA_3&&(j=n,n=o,o=-j),this.face===Wb.RIGHT?(j=m,m=-n,n=j):this.face===Wb.BACK?(m=-m,n=-n):this.face===Wb.LEFT&&(j=m,m=n,n=-j),k.phi=Math.acos(-o)-aa,k.lam=Math.atan2(n,m),this.face===Wb.RIGHT?k.lam=V(k.lam,-aa):this.face===Wb.BACK?k.lam=V(k.lam,-ja):this.face===Wb.LEFT&&(k.lam=V(k.lam,+aa))}if(0!==this.es){var p,q,r;p=k.phi<0?1:0,q=Math.tan(k.phi),r=this.b/Math.sqrt(q*q+this.one_minus_f_squared),k.phi=Math.atan(Math.sqrt(this.a*this.a-r*r)/(this.one_minus_f*r)),p&&(k.phi=-k.phi)}return k.lam+=this.long0,a.x=k.lam,a.y=k.phi,a},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Zb=[[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],$b=[[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],_b=.8487,ac=1.3523,bc=ga/5,cc=1/bc,dc=18,ec=function(a,b){return a[0]+b*(a[1]+b*(a[2]+b*a[3]))},fc=function(a,b){return a[1]+b*(2*a[2]+3*b*a[3])},gc={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(a){var b=ta(a.x-this.long0),c=Math.abs(a.y),d=Math.floor(c*bc);d<0?d=0:d>=dc&&(d=dc-1),c=ga*(c-cc*d);var e={x:ec(Zb[d],c)*b,y:ec($b[d],c)};return a.y<0&&(e.y=-e.y),e.x=e.x*this.a*_b+this.x0,e.y=e.y*this.a*ac+this.y0,e},inverse:function(a){var b={x:(a.x-this.x0)/(this.a*_b),y:Math.abs(a.y-this.y0)/(this.a*ac)};if(b.y>=1)b.x/=Zb[dc][0],b.y=a.y<0?-aa:aa;else{var c=Math.floor(b.y*dc);for(c<0?c=0:c>=dc&&(c=dc-1);;)if($b[c][0]>b.y)--c;else{if(!($b[c+1][0]<=b.y))break;++c}var d=$b[c],e=5*(b.y-d[0])/($b[c+1][0]-d[0]);e=W(function(a){return(ec(d,a)-b.y)/fc(d,a)},e,ea,100),b.x/=ec(Zb[c],e),b.y=(5*c+e)*fa,a.y<0&&(b.y=-b.y)}return b.x=ta(b.x+this.long0),b},names:["Robinson","robin"]},hc={init:function(){this.name="geocent"},forward:function(a){return r(a,this.es,this.a)},inverse:function(a){return s(a,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};return B.defaultDatum="WGS84",B.Proj=p,B.WGS84=new B.Proj("WGS84"),B.Point=R,B.toPoint=Fa,B.defs=c,B.transform=y,B.mgrs=Qa,B.version="2.6.2",function(a){a.Proj.projections.add(Va),a.Proj.projections.add(cb),a.Proj.projections.add(eb),a.Proj.projections.add(ib),a.Proj.projections.add(jb),a.Proj.projections.add(kb),a.Proj.projections.add(lb),a.Proj.projections.add(mb),a.Proj.projections.add(nb),a.Proj.projections.add(wb),a.Proj.projections.add(Eb),a.Proj.projections.add(Gb),a.Proj.projections.add(Hb),a.Proj.projections.add(Jb),a.Proj.projections.add(Kb),a.Proj.projections.add(Mb),a.Proj.projections.add(Nb),a.Proj.projections.add(Ob),a.Proj.projections.add(Qb),a.Proj.projections.add(Rb),a.Proj.projections.add(Sb),a.Proj.projections.add(Tb),a.Proj.projections.add(Ub),a.Proj.projections.add(Vb),a.Proj.projections.add(Yb),a.Proj.projections.add(gc),a.Proj.projections.add(hc)}(B),B}),function(a,b,c,d){"use strict";function e(a){return a=+a.toString().replace(/\,/gi,"."),isNaN(a)?0:a}function f(){return d.utils.newDeferred.apply(this,arguments)}function g(a){return a.charAt(0).toUpperCase()+a.substring(1)}function h(a){return d.utils.getWMM()(a[0].y,a[0].x).dec}function i(a){return a>=0?Math.floor((a+180)/6)+1:Math.floor(a/6)+31}function j(a){return a>=0?"n":"s"}function k(a){return a.keyCode?a.keyCode:a.which}function l(a){var b,c,d;return void 0!==a&&(b=Math.abs(e(a.D)),b+=Math.abs(e(a.M))/60,b+=Math.abs(e(a.S))/3600,c=e(a.D)>=0?1:-1,c*="N"==a.C||"E"==a.C?1:-1,d=c*b),d}function m(a){var b,c,d;return void 0!==a&&(b=Math.abs(e(a.D)),b+=Math.abs(e(a.M))/60,c=e(a.D)>=0?1:-1,c*="N"==a.C||"E"==a.C?1:-1,d=c*b),d}function n(b,c){var d,e,f,g,h;return"number"!==a.type(+b)||isNaN(b)?(d=0,f=0,g=0,c&&(h=c.N?"N":"E")):(c&&(h=b>=0?c.N?"N":"E":c.S?"S":"W"),b=Math.abs(b),d=Math.floor(b),e=60*(b-d),f=Math.floor(e),g=60*(e-f)),{C:h,D:d.toString(),M:f.toString(),S:g.toString()}}function o(b,c){var d,e,f;return"number"!==a.type(+b)||isNaN(b)?(d=0,e=0,c&&(f=c.N?"N":"E")):(c&&(f=b>=0?c.N?"N":"E":c.S?"S":"W"),b=Math.abs(b),d=Math.floor(b),e=60*(b-d)),{C:f,D:d.toString(),M:e.toString()}}function p(b,c){var d="";return a.each(c,function(a,c){return!c.hasOwnProperty(b)||(d=c[b].def,!1)}),d}function q(a,b,c,e){var f=d.utils.getConvergenceConvention(),g=c||d.utils.degToRad(6*i(e.x)-183),h=d.utils.degToRad(e.y),j=d.utils.degToRad(e.x),k=(a-b)/a,l=k*Math.pow(Math.cos(h),2)/(1-k),m=j-g,n=Math.sin(h),o=(1+3*l+2*Math.pow(l,2))*Math.sin(h)*Math.pow(Math.cos(h),2)/3,p=(2-Math.pow(Math.tan(h),2))*Math.sin(h)*Math.pow(Math.cos(h),4)/15,q=m*n+Math.pow(m,3)*o+Math.pow(m,5)*p;return q*=f?-1:1,d.utils.radToDeg(q)}function r(a){var b;switch(a){case"m":b=1;break;case"km":b=1e3;break;case"us-ft":b=.304800609601219;break;default:b=1e3}return b}function s(a,b){return e(a)*r(b)}function t(a,b){return e(a)/r(b)}var u="INPUT ERROR ON LINE ";a.widget("twcc.converterSet",{options:{units:{dms:{D:"°",M:"'",S:"''"},dd:{x:{DD:"°E"},y:{DD:"°N"}},cartesian:{XY:{m:"m",km:"km","us-ft":"ft"},CONVERGENCE:"°"}},labels:{spherical:{x:"Lng = ",y:"Lat = ",convergence:"Conv. = "},cartesian:{x:"X = ",y:"Y = ",z:"Zone = ",h:"Hemisphere = ",convergence:"Conv. = "},csv:{csv:"CSV : ",l:"Format : "}},options:{x:{E:"East",W:"West"},y:{N:"North",S:"South"},o:{_DMS:"Deg. min. sec.",_DM:"Deg. min.",_DD:"Decimal deg."},h:{n:"North",s:"South"},u:{_M:"Meters",_KM:"Kilometers",_F:"Feet"}},value:{x:0,y:0},wgs84:[],defaultWgs84:[{x:0,y:0}],selections:{},definitions:{},url:"",$containers:[],masterLoadingToggleSwitch:!1,csv:!1},_create:function(){var b,e=this;if(this._bindEvents(),this._historyManager=c.getInstance(d),b=this._historyManager.getCurrentValue(),!this.options.wgs84)if(b){var f=/UD\d+/gi;if(b.wgs84.length>1)this.options.wgs84=b.wgs84,e.options.csv=!0;else{if("array"!==a.type(b.wgs84))throw"Wrong data type";this.options.wgs84=b.wgs84}this.options.selections.source=f.test(b.sc)?"WGS84":b.sc,this.options.selections.destination=f.test(b.dc)?"WGS84":b.dc}else this.options.wgs84=this.options.defaultWgs84;this.options.$containers=this.element.find(".converter-container"),this.options.$containers.each(function(b){a(this).converter({units:e.options.units,labels:e.options.labels,options:e.options.options,csv:e.options.csv,target:b?"dest":"source",selection:e.options.selections[b?"destination":"source"],value:e.options.value,wgs84:e.options.wgs84})}),this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this._reload().progress(function(a){e._trigger(".notify",null,a)}).done(function(){e._reloadSucceeded.apply(e,arguments),e._trigger(".done",null,{wgs84:e.wgs84(),csv:e.csv(),selections:e.options.selections}),e.setConvergence()}).fail(function(){e._reloadFailed.apply(e,arguments)})},_bindEvents:function(){var b=this;this.element.on("converter.transform",function(a,c){b.transform(c)}),this.element.on("converter.source.wgs84_changed converterset.done ",function(a,c){var d={wgs84:c.wgs84,convergenceInDegrees:b._convergence(),srsCode:b._selection(),magneticDeclinationInDegrees:h(c.wgs84)};b._addToHistory(d),b._triggerWgs84Changed(a,d)}),this.element.on("converter.source.selection_changed converter.dest.selection_changed ",function(a,c){var d={wgs84:c.wgs84,srsCode:b._selection()};b._addToHistory(d),b._triggerConvergenceChange()}),this.element.on("converter.source.convergence_changed converter.dest.convergence_changed ",function(){b._triggerConvergenceChange()}),this.element.find(".history").click(function(){a(this).hasClass("next")?b._historyManager.moveToNext():b._historyManager.moveToPrevious(),b._restoreFromHistory()})},_triggerWgs84Changed:function(a,b){this._trigger(".wgs84_changed",a,b)},_triggerConvergenceChange:function(){this._trigger(".convergence_changed",null,{convergenceInDegrees:this._convergence()})},_reloadSucceeded:function(){this._loadDefinitionsObject(),this.options.masterLoadingToggleSwitch=!1,this._toggleLoading()},_reloadFailed:function(a){this._trigger(".fail",null,a)},_reload:function(){var b=this,c=f("Reload");return this._toggleLoading(!0),this._loadDefinitions().always(function(){b._toggleLoading(!1)}).done(function(){var d={};b.options.definitions.WGS84&&(b.options.definitions={"*World":b.options.definitions}),a.each(b.options.definitions,function(b,c){a.extend(d,c)}),c.resolve()}).fail(function(a,b){c.reject(b)}),c.promise()},_loadDefinitions:function(){var b=this,c=f("Load definitions");return"object"!==a.type(this.options.definitions)?c.reject("Wrong definitions type"):a.isEmptyObject(this.options.definitions)?a.ajax({url:this.options.url,data:{u:"u"},type:"POST",cache:!1,dataType:"json"}).done(function(a,d,e){void 0!==a.error?c.reject("Server Error",[e,d,a]):(b.options.definitions=a,c.resolve())}).fail(function(a,b,d){c.reject("Server Error",arguments)}):c.resolve(),c.promise()},_loadDefinitionsObject:function(){this._pushPullAll("loadDefinitionsObject",this.options.definitions)},_toggleLoading:function(a){a=this.options.masterLoadingToggleSwitch||!!a,this._pushPullAll("toggleLoading",a)},_addToHistory:function(a){this._historyManager.isEnabled()&&this._historyManager.add({wgs84:a.wgs84,sc:a.srsCode.source,dc:a.srsCode.destination})},_restoreFromHistory:function(){var a=this,b=this._historyManager.getCurrentValue();this._underTheRadar(function(){var c=b.wgs84.length>1;a.csv()!==c&&a.csv(c),a.transform(b),a.pushPullSource("selection",b.sc),a.pushPullDestination("selection",b.dc)})},_underTheRadar:function(b){if("function"!==a.type(b))throw"Invalid function";this._historyManager.toggle(!1),b(),this._historyManager.toggle(!0)},_pushPullWithCriterion:function(b,c,d,e){var f=null,g=this;return this.options.$containers.each(function(){a(this).converter("option",d)===e&&(f=g._pushPullOne(b,c,a(this)))}),f},_pushPullOne:function(a,b,c){var d=void 0===b?c.converter(a):c.converter(a,b);return this.options.hasOwnProperty(a)&&(this.options[a]=d),d},pushPullSource:function(a,b){return this._pushPullWithCriterion(a,b,"target","source")},pushPullDestination:function(a,b){return this._pushPullWithCriterion(a,b,"target","dest")},_pushPullAll:function(b,c){var d=this;return this.options.$containers.each(function(){d._pushPullOne(b,c,a(this))}),this.options[b]},_pullAll:function(a){return{source:this.pushPullSource(a),destination:this.pushPullDestination(a)}},wgs84:function(a){return this._pushPullAll("wgs84",a)},toggle:function(a){return this._pushPullAll("toggle",a)},_getFirstWgs84:function(){var b=null,c=this.wgs84();return a.each(c,function(){return!!this.error||(b=this,!1)}),b||{x:0,y:0}},_convergence:function(){return this._pullAll("convergence")},_selection:function(){return this.options.selections=this._pullAll("selection"),this.options.selections},setConvergence:function(){this._pushPullAll("setConvergence")},readOnly:function(){return this.options.readOnly},csv:function(a){if(a!=this.options.csv&&void 0!==a){if(!a){var b=[this._getFirstWgs84()];JSON.stringify(b[0])===JSON.stringify(this.wgs84()[0])?this.wgs84(b):this.transform({wgs84:b})}this._trigger(".csv_changed",null,{csv:a})}return this._pushPullAll("csv",a)},unloadCRS:function(a){this._pushPullAll("unloadCRS",a)},removeEmptyOptgroups:function(){this._pushPullAll("removeEmptyOptgroups")},mergeDefinitions:function(b){var c=this,d=new a.Deferred;return this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this.options.definitions="object"!==a.type(this.options.definitions)?{}:this.options.definitions,a.extend(!0,this.options.definitions,b),this._reload().progress(function(){d.notify("Reloading")}).done(function(){c._reloadSucceeded.apply(c,arguments),d.resolve()}).fail(function(){c._reloadFailed.apply(c,arguments),d.reject.apply(null,arguments)}),d.promise()},transform:function(b){var c=b.hasOwnProperty("wgs84");if(!(c&&"array"===a.type(b.wgs84)||b.hasOwnProperty("target")))throw"Wrong data format";if(c)this._pushPullAll("transform",b);else{var d;"source"===b.target?(d=this.pushPullSource("transform",{input:null}),this.pushPullDestination("transform",{wgs84:d})):(d=this.pushPullDestination("transform",{input:null}),this.pushPullSource("transform",{wgs84:d}))}},_setOption:function(a,b){return this._superApply(arguments)},_destroy:function(){return this._toggleLoading(!0),this._pushPullAll("destroy"),this._super()}}),a.widget("twcc.converter",{options:{readOnly:!1,wrapper:{fieldSet:["<div>"],title:["<h3>"],info:["<a>",{name:"info",href:"#"}]},projections:{},units:{},labels:{},options:{},angleUnit:"dd",lengthUnit:"m",convergence:null,hint:"",wgs84:[{x:0,y:0}],value:{x:0,y:0},selection:null,mapping:{aea:"cartesian",aeqd:"cartesian",cass:"cartesian",cea:"cartesian",csv:"csv",eqc:"cartesian",eqdc:"cartesian",equi:"cartesian",gauss:"cartesian",geocent:"cartesian",gnom:"cartesian",gstmerc:"cartesian",laea:"cartesian",lcc:"cartesian",longlat:"spherical",merc:"cartesian",mill:"cartesian",moll:"cartesian",nzmg:"cartesian",omerc:"cartesian",ortho:"cartesian",poly:"cartesian",sinu:"cartesian",somerc:"cartesian",stere:"cartesian",sterea:"cartesian",tmerc:"cartesian",utm:"utm",vandg:"spherical",connector:"connector"},$select:null,$container:null,csv:!1},_widget:void 0,_create:function(){a.extend(this.options,{$select:this.element.find("select.crs-list"),$container:this.element.find(".container")}),this._bindEvents(),this._unload()},_triggerTransform:function(a){a.preventDefault(),this._trigger(".transform",a,{target:this.options.target})},_bindEvents:function(){var a=this;this.options.$select.on("change",function(){a.selection()}),this.element.on("angleswitchgeofield.update_display",function(b,c){a.options.angleUnit=c.value,a.value(),a.updateContainer()}),this.element.find(".convert-button").click(function(b){a._triggerTransform(b)}),this.element.on("keyup","input, select",function(b){k(b)==d.constants.keyboard.RETURN&&a._triggerTransform(b)})},_getFieldSetUnit:function(a){var b=this._getWidgetPrefix(a),c=this._getFieldSetUnitName(b);if(c)return this.options.units[c];var d=b.match(/([A-Z]?[a-z]*)/g);return(c=this._getFieldSetUnitName(d[1]))?this.options.units[c]:void 0},_getFieldSetUnitName:function(a){var b;switch(a){case"utm":b="cartesian";break;case"Dm":b="dms";break;case"csv":case"connector":break;default:b=a.toLowerCase()}if(b&&this.options.units.hasOwnProperty(b))return b},_getFieldSetLabel:function(a){var b=this._getWidgetPrefix(a),c=this._getFieldSetLabelName(b);if(c)return this.options.labels[c];var d=b.match(/([A-Z]?[a-z]*)/g);return(c=this._getFieldSetLabelName(d[0]))?this.options.labels[c]:void 0},_getFieldSetLabelName:function(a){var b;switch(a){case"utm":b="cartesian";break;case"connector":break;default:b=a.toLowerCase()}if(b&&this.options.labels.hasOwnProperty(b))return b},_getWidgetMidfix:function(a){var b="";return"spherical"===a&&(b=this.options.angleUnit,b=b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()),b},_getWidgetPrefix:function(a){var b;return a=this.options.projections[this.options.selection].isConnector&&"csv"!==a?"connector":a,this.options.mapping.hasOwnProperty(a)?b=this.options.mapping[a]:(console.error("Projection not found: "+a),b="cartesian"),b+this._getWidgetMidfix(b)},_getWidgetName:function(a){return this._getWidgetPrefix(a)+"FieldSet"},_unload:function(){this.element.find("select.crs-list, .container").empty(),this.projections={}},toggleLoading:function(a){this.element.find(".container").toggle(!a),this.element.find(".loading").toggle(!!a)},removeEmptyOptgroups:function(){this.options.$select.find("optgroup:empty").remove()},loadDefinitionsObject:function(b){var c,e=this,f=this.options.$select;if(this.options.definitions=b,this.removeEmptyOptgroups(),c=!1,a.each(this.options.definitions,function(b,f){a.each(f,function(a,f){e.options.$select.has('optgroup[label="'+b+'"] option[value="'+a+'"]').length||(d.utils.addOptionToSelect(b,a,e.options.$select,f.def),c=!0)})}),c){f.sortGrpsNOptionsByText();try{this.selection(this.options.selection||f.find("option:first").val())}catch(a){this.selection(f.find("option:first").val())}}},unloadCRS:function(c){var d=this;if(this.selection()===c){var e=this._widget.options.srsCode;this.selection(e)}this.options.$select.find('option[value="'+c.toString()+'"]').remove(),b.defs(c,void 0),delete this.options.projections[c],a.each(this.options.definitions,function(a,b){return!b.hasOwnProperty(c)||(delete d.options.definitions[a][c],!1)}),this.removeEmptyOptgroups()},updateContainer:function(){var b=this,c=this.selection();if(this.options.value=this.options.csv||"array"!==a.type(this.options.value)?this.options.value:this.options.value[0],this.options.value=this.options.csv&&"array"!==a.type(this.options.value)?[this.options.value]:this.options.value,c){this.options.projections.hasOwnProperty(c)||this._registerProjection(c);var d,e,f=this._getProjection(c),h=f.projName,i=this._getFieldSetUnit(h)||"",j=this._getFieldSetLabel(h)||"",k={srsCode:c,target:this.options.target,convergence:this.options.convergence,wgs84:this.options.wgs84,value:this.options.value,units:i,labels:j,lengthUnit:this.options.lengthUnit,options:this.options.options,readOnly:this.options.readOnly},l=f.title||c,m=this._getWidgetName(this.options.csv?"csv":f.projName),n=a.apply(null,this.options.wrapper.fieldSet);if(this.options.$container.empty(),d=a.apply(null,this.options.wrapper.title),d.append(l),e=a.apply(null,this.options.wrapper.info),e.click(function(a){b._trigger(".info",a,{srsCode:c,definitionString:f.defData})}),e.text(" [?]"),d.append(e),n.append(d),"csvFieldSet"==m){i=i.D?this.options.units.dd:i;var o=(("utm"===h?j.h+","+j.z+",":"")+(j.x?j.x+(i.x?"("+i.x.DD+")":"("+i.XY.m+")"):"")+(j.y?","+j.y+(i.y?"("+i.y.DD+")":"("+i.XY.m+")"):"")).replace(/[\s]*=[\s]*/gi,"");a.extend(k,{originalProjection:f.isConnector?"connector":h,hint:o,units:null,labels:this.options.labels.csv})}this._widget=n[m](k).data("twcc"+g(m)),this.options.$container.append(n)}},_registerProjection:function(c){var d;if(!b.defs(c)){var e=c.indexOf("Connector")>=0,f=p(c,this.options.definitions),g={defData:f,isConnector:e};b.defs(c,f),a.extend(b.defs(c),g)}d=a.extend({},b.defs(c)),this._setProjection(c,d)},_getProjection:function(a){if(!this.options.projections.hasOwnProperty(a))throw"Unknown srsCode";return this.options.projections[a]},_setProjection:function(a,b){this.options.projections[a]=b},selection:function(a){var b=this.options.$select,c=!1,d=this,e=this.options.selection;if(void 0!==a){this.options.selection=a;try{b.val(this.options.selection)}catch(a){}c=!0}else b.val()&&b.val()!=this.options.selection&&(this.options.selection=b.val(),c=!0);if(c){this.updateContainer();var f=d.options.selection,g=d.wgs84();d.transform({wgs84:g}),d.setConvergence(),e!==f&&d._trigger("."+d.options.target+".selection_changed",null,{wgs84:g,srsCode:f})}return this.options.selection},projection:function(){return this._getProjection(this.selection())},_pushPull:function(a,b){var c;return this._widget?(c=this._widget[a](b),this.options.hasOwnProperty(a)&&(this.options[a]=c),c):null},value:function(b){if(void 0!==b&&(!this.options.csv&&"object"!==a.type(b)||this.options.csv&&"array"!==a.type(b)))throw"Invalid type";return this._pushPull("value",b)},wgs84:function(a){return void 0!==a&&JSON.stringify(this.options.wgs84)!==JSON.stringify(a)&&(this._pushPull("wgs84",a),this._trigger("."+this.options.target+".wgs84_changed",null,{wgs84:a}),this.setConvergence()),this.options.wgs84},convergence:function(a){var b=this.options.convergence;if(this._pushPull("convergence",a),void 0!==a&&b!==this.options.convergence){var c=this.wgs84();this._trigger("."+this.options.target+".convergence_changed",null,{wgs84:c})}return this.options.convergence},setConvergence:function(){if(this._widget&&"null"!==a.type(this._widget.convergence())){var c,d=this.wgs84()[0],e=new b.Proj(this.projection().defData),f=this._widget.zone?null:e.long0||null;c=q(e.a,e.b,f,d),this.convergence(c)}},csv:function(a){return void 0!==a&&(this.value(),this.options.csv=!!a,this.updateContainer()),this.options.csv},hint:function(a){return this._pushPull("hint",a)},toggle:function(a){return this._pushPull("toggle",a)},readOnly:function(){return this.options.readOnly},_formatCoordinates:function(b){var c=["array","object"];if(a.inArray(a.type(b),c)<0)throw"Wrong data type";return"array"===a.type(b)?b:[b]},_setupInputProjection:function(a,c,d,e){var f=d?{z:i(c.x),h:j(c.y)}:e,g=a.defData;return g=g.replace(/\+zone=[^\s]+/gi,"+zone="+f.z),g=g.replace("+south",""),g+="s"===f.h?" +south":"",new b.Proj(g)},_isValidPoint:function(b,c){var d=1;return d&="object"===a.type(b),d&=b.hasOwnProperty("x"),c?d&=b.x.indexOf(u)<0:(d&=b.hasOwnProperty("y"),d&="number"===a.type(b.x)&&!isNaN(b.x),d&="number"===a.type(b.y)&&!isNaN(b.y)),!!d},_getConnector:function(){var b=this.selection();return window.hasOwnProperty(b)||a.ajax({url:"/js/connectors/"+b+".js",async:!1,cache:!0,dataType:"script"}),window[b].getInstance(d.context)},transform:function(c){var d,e,f,g,h=this,i=[],j=[],k=c.hasOwnProperty("wgs84"),l=this.value(),m=b.WGS84,n=this.projection(),o=n.defData.indexOf("+proj=utm")>-1,p=function(){return a.extend({isConnector:m.isConnector},new b.Proj(m.defData))},q=function(){return o?h._setupInputProjection.apply(h,arguments):a.extend({isConnector:n.isConnector},new b.Proj(n.defData))},r={type:"pivot",getProjection:p},s={type:"input",getProjection:q};if(!k&&!c.hasOwnProperty("input"))throw"Wrong data format";this.toggleLoading(!0);var t=k?c.wgs84:c.input;return k&&t&&this.wgs84(t),k?(d=t||this.wgs84(),g={A:r,B:s}):(d=t||l,g={A:s,B:r},f=this._widget.options.originalProjection),e=this._formatCoordinates(d),a.each(e,function(c,d){var e={},m=h.wgs84()[c],o="array"===a.type(l)?l[c]:l,p=g.A.getProjection(n,m,k,o),q=g.B.getProjection(n,m,k,o),r="connector"===f||!k&&p.isConnector,s=k&&q.isConnector,t=r||s;if(!h._isValidPoint(d,r)||k&&m.error)j.push({x:0,y:0,error:!0}),i.push(u+(c+1));else{var v;t&&(v=h._getConnector()),t&&k?e[g.B.type]=v.forward(d):(t&&(d=v.inverse(d)),e[g.B.type]=b(p,q,a.extend({},d))),e[g.A.type]=a.extend({},d),j.push({x:e.pivot.x,y:e.pivot.y}),i.push({x:e.input.x,y:e.input.y})}}),this.csv()||(i=i[0]),k?this.value(i):this.wgs84(j),this.toggleLoading(!1),this.wgs84()},_setOption:function(a,b){return this._superApply(arguments)},_destroy:function(){return this._unload(),this._super()}}),a.widget("twcc.fieldSet",{
options:{srsCode:null,value:{},units:{},target:null,wrapper:{set:["<div>",{class:"table"}],geoField:["<div>",{class:"row"}],geoCaption:["<div>",{class:"caption"}]},readOnly:!1,geoFields:{},geoFieldsIndex:0,wgs84:null},_create:function(){var b,c=a.apply(null,this.options.wrapper.set);b=this._getGeoFieldsOptions(),this._setDefaultsGeoFieldsOptions(b),this._buildGeoFields(c,b),this._setFieldsHandlers(),this.element.append(c)},_setFieldsHandlers:function(){},_setDefaultsGeoFieldsOptions:function(b){var c=this;a.each(b,function(d,e){var f={name:c.options.srsCode+"_"+c.options.target,readOnly:c.options.readOnly,unit:c.options.units,target:c.options.target,value:c.options.value[e.options.axis]};b[d].options=a.extend(f,b[d].options)})},_buildGeoField:function(b,c,d,e){var f,g=this.options.geoFieldsIndex++;f=d.indexOf("Switch")>=0||d.indexOf("connector")>=0?a.apply(null,this.options.wrapper.geoCaption):a.apply(null,this.options.wrapper.geoField),this.options.geoFields[g]=f[d](e),b.append(f)},_buildGeoFields:function(b,c){var d=this;a.each(c,function(a,c){d._buildGeoField(b,a,c.type,c.options)})},_getGeoFieldsOptions:function(){return{}},_getConvergenceIcon:function(){return'<img src="'+d.system.dirWsImages+"GN_"+this.options.target+'.png" alt="">'},convergence:function(){return null},hint:function(){return null},wgs84:function(a){return void 0===a?this._getWgs84():this._setWgs84(a)},_getWgs84:function(){return this.options.wgs84},_setWgs84:function(a){return this.options.wgs84=a,this.options.wgs84},value:function(a){return this.options.value=void 0===a?this._getValue():this._setValue(a),this._setToStringMethod(),this.options.value},_getValue:function(){return this.options.value},_setValue:function(a){this.options.value=a},_setToStringMethod:function(){var a=this;this.options.value.toString=function(){return a._getStringValue()}},_getStringValue:function(){return""},toggle:function(a){return a=void 0===a?this.options.readOnly:!!a,this.options.readOnly=this._toggle(a),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(a){return!a},_setOption:function(a,b){return this._superApply(arguments)},_destroy:function(){return this.element.empty(),this._super()}}),a.widget("twcc.connectorFieldSet",a.twcc.fieldSet,{options:{options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"connectorGeoField",options:{axis:"x"}}]},_getValue:function(){return{x:this.options.geoFields[0].connectorGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[0].connectorGeoField("value",a.x)}},_toggle:function(a){return this.options.geoFields[0].connectorGeoField("toggle",a)},_getStringValue:function(){return this.options.geoFields[0].connectorGeoField("value")}}),a.widget("twcc.csvFieldSet",a.twcc.fieldSet,{options:{labels:{},units:{},options:{},geoFields:{},value:[],hint:"",wgs84:[],originalProjection:null},_getGeoFieldsOptions:function(){return[{type:"csvGeoField",options:{value:this._toString(this.options.value),label:this.options.labels.csv}},{type:"labelGeoField",options:{value:this.options.hint,label:this.options.labels.l}}]},_getValue:function(){return this._fromString(this.options.geoFields[0].csvGeoField("value"))},_setValue:function(a){return this._fromString(this.options.geoFields[0].csvGeoField("value",this._toString(a)))},_fromString:function(b){var c=b.split("\n"),d=this;return a.each(c,function(a,b){var e=b.split(",");switch(d.options.originalProjection){case"utm":c[a]={h:e[0],z:+e[1],x:+e[2],y:+e[3]};break;case"connector":c[a]={x:e[0],y:e[1]};break;default:c[a]={x:+e[0],y:+e[1]}}}),c},_toString:function(b){var c=[],d=this;if("array"!==a.type(b))throw"Invalid type";return a.each(b,function(a,b){var e=d.wgs84()[a];if(e.error)c.push(b.toString());else if("utm"==d.options.originalProjection){var f=b.h||j(e.y),g=b.z||i(e.x);c.push(f+","+g+","+b.x+","+b.y)}else c.push(b.x+","+b.y)}),c.join("\n")},originalProjection:function(a){if(void 0===a)return this.options.originalProjection;this.options.originalProjection=a},hint:function(a){if(void 0===a)return this.options.hint=this.options.geoFields[1].labelGeoField("value"),this.options.hint;this.options.hint=a,this.options.geoFields[1].labelGeoField("value",this.options.hint)},_toggle:function(a){return this.options.geoFields[0].csvGeoField("toggle",a),this.options.geoFields[1].labelGeoField("toggle",a)},_getStringValue:function(){return this.options.hint+"\n"+this.options.geoFields[0].csvGeoField("value")}}),a.widget("twcc.utmFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0,wgs84:[]},_getGeoFieldsOptions:function(){return[{type:"hemisphereGeoField",options:{label:this.options.labels.h,options:this.options.options.h,axis:"h"}},{type:"zoneGeoField",options:{label:this.options.labels.z,options:this.options.options.z,axis:"z"}},{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var a=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(b,c){a.options.lengthUnit=a.unit(c.value)})},_getValue:function(){return{h:this.hemisphere(),z:this.zone(),x:this.options.geoFields[2].xyGeoField("value"),y:this.options.geoFields[3].xyGeoField("value")}},_setValue:function(b){var c=this._getWgs84()[0];return b.h&&b.z||a.extend(b,{y:Math.abs(b.y),h:j(c.y),z:i(c.x)}),{h:this.hemisphere(b.h),z:this.zone(b.z),x:this.options.geoFields[2].xyGeoField("value",b.x),y:this.options.geoFields[3].xyGeoField("value",b.y)}},unit:function(a){return void 0===a?this.options.lengthUnit=this.options.geoFields[2].xyGeoField("unit"):(this.options.geoFields[2].xyGeoField("unit",a),this.options.geoFields[3].xyGeoField("unit",a),this.options.lengthUnit=this.options.geoFields[5].lengthSwitchGeoField("value",a)),this.options.lengthUnit},convergence:function(a){return this.options.convergence=void 0===a?this.options.geoFields[4].convergenceGeoField("value"):this.options.geoFields[4].convergenceGeoField("value",a),this.options.convergence},zone:function(a){return this.options.value.z=void 0===a?this.options.geoFields[1].zoneGeoField("value"):this.options.geoFields[1].zoneGeoField("value",a),this.options.value.z},hemisphere:function(a){return this.options.value.h=void 0===a?this.options.geoFields[0].hemisphereGeoField("value"):this.options.geoFields[0].hemisphereGeoField("value",a),this.options.value.h},_toggle:function(a){return this.options.geoFields[0].hemisphereGeoField("toggle",a),this.options.geoFields[1].zoneGeoField("toggle",a),this.options.geoFields[2].xyGeoField("toggle",a),this.options.geoFields[3].xyGeoField("toggle",a),this.options.geoFields[5].lengthSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[2].xyGeoField("getStringValue")+", "+a[3].xyGeoField("getStringValue")+" "+a[1].zoneGeoField("value")+a[0].hemisphereGeoField("value")}}),a.widget("twcc.cartesianFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0},_getGeoFieldsOptions:function(){return[{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var a=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(b,c){a.options.lengthUnit=a.unit(c.value)})},_getValue:function(){return{x:this.options.geoFields[0].xyGeoField("value"),y:this.options.geoFields[1].xyGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[0].xyGeoField("value",a.x),y:this.options.geoFields[1].xyGeoField("value",a.y)}},unit:function(a){return void 0===a?this.options.lengthUnit=this.options.geoFields[0].xyGeoField("unit"):(this.options.geoFields[0].xyGeoField("unit",a),this.options.geoFields[1].xyGeoField("unit",a),this.options.lengthUnit=this.options.geoFields[3].lengthSwitchGeoField("value",a)),this.options.lengthUnit},convergence:function(a){return this.options.convergence=void 0===a?this.options.geoFields[2].convergenceGeoField("value"):this.options.geoFields[2].convergenceGeoField("value",a),this.options.convergence},_toggle:function(a){return this.options.geoFields[0].xyGeoField("toggle",a),this.options.geoFields[1].xyGeoField("toggle",a),this.options.geoFields[3].lengthSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].xyGeoField("getStringValue")+", "+a[1].xyGeoField("getStringValue")}}),a.widget("twcc.sphericalDdFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"ddGeoField",options:{unit:this.options.units.y,label:this.options.labels.y,axis:"y"}},{type:"ddGeoField",options:{unit:this.options.units.x,label:this.options.labels.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dd",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].ddGeoField("value"),y:this.options.geoFields[0].ddGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[1].ddGeoField("value",a.x),y:this.options.geoFields[0].ddGeoField("value",a.y)}},_toggle:function(a){return this.options.geoFields[0].ddGeoField("toggle",a),this.options.geoFields[1].ddGeoField("toggle",a),this.options.geoFields[2].angleSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].ddGeoField("getStringValue")+", "+a[1].ddGeoField("getStringValue")}}),a.widget("twcc.sphericalDmFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dm",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmGeoField("value"),y:this.options.geoFields[0].dmGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[1].dmGeoField("value",a.x),y:this.options.geoFields[0].dmGeoField("value",a.y)}},_toggle:function(a){return this.options.geoFields[0].dmGeoField("toggle",a),this.options.geoFields[1].dmGeoField("toggle",a),this.options.geoFields[2].angleSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].dmGeoField("getStringValue")+", "+a[1].dmGeoField("getStringValue")}}),a.widget("twcc.sphericalDmsFieldSet",a.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmsGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmsGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dms",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmsGeoField("value"),y:this.options.geoFields[0].dmsGeoField("value")}},_setValue:function(a){return{x:this.options.geoFields[1].dmsGeoField("value",a.x),y:this.options.geoFields[0].dmsGeoField("value",a.y)}},_toggle:function(a){return this.options.geoFields[0].dmsGeoField("toggle",a),this.options.geoFields[1].dmsGeoField("toggle",a),this.options.geoFields[2].angleSwitchGeoField("toggle",a)},_getStringValue:function(){var a=this.options.geoFields;return a[0].dmsGeoField("getStringValue")+", "+a[1].dmsGeoField("getStringValue")}}),a.widget("twcc.geoField",{options:{name:null,unit:null,label:null,readOnly:!1,lengthUnit:"m",glue:"_",wrapper:{field:["<span>"],fields:["<div>",{class:"cell fields"}],label:["<div>",{class:"cell label"}],options:["<div>",{class:"fields"}]},attributes:{},fields:{},icon:""},_create:function(){var b,c,d=this;a.each(this.options.attributes,function(b){var c={disabled:d.options.readOnly,readonly:d.options.readOnly};d.options.attributes[b]=a.extend(c,d.options.attributes[b])}),b=this._getEmptyFieldCell(),c=this._getFieldsOptions(),this._setDefaultsFieldsOptions(c),a.each(c,function(a,c){var e=d._buildField(a,c);d._setFieldHandlers(e),e.append(d._getFieldSetUnit(a)),e.append("&nbsp;"),b.append(e)}),this._appendLabelCell(),this.element.append(b)},_getFieldSetUnit:function(a){return this.options.unit[a]},_setFieldHandlers:function(){},_clean:function(a,b){return this._superClean(a,b)},_superClean:function(a,b){return isNaN(a)||null===a?"":d.math.round(a,b||0)},_buildField:function(b,c){return this.options.fields[b]=a.apply(null,this.options.wrapper.field).field(c),this.options.fields[b]},_appendLabelCell:function(){var b,c,d=this._getForId();b=d?a("<label>",{for:d}).html(this.options.icon+this.options.label):this.options.icon+this.options.label,c=a.apply(null,this.options.wrapper.label).append(b),this.element.append(c)},_getForId:function(){},_getEmptyFieldCell:function(){return a.apply(null,this.options.wrapper.fields)},_getFieldsOptions:function(){return{}},_setDefaultsFieldsOptions:function(b){var c=this;a.each(b,function(d){var e={name:c.options.name+c.options.glue+d,attributes:c.options.attributes[d],value:c._clean(c.options.value)};b[d]=a.extend(e,b[d])})},value:function(a){return this.options.value=void 0===a?this._constraint(this._getRawValue()):this._setValue(this._clean(a)),this.options.value},toggle:function(a){return a=void 0===a?this.options.readOnly:!!a,this.options.readOnly=this._toggle(a),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(b){var c=this;return a.each(this.options.fields,function(a,d){var e=c._getFieldsOptions()[a];c._toggleField(d,b,e)}),!b},_toggleField:function(a,b){a.field("toggle",b)},_getRawValue:function(){return this.options.value},getStringValue:function(){return this.options.value},_constraint:function(a){return a},_setValue:function(a){this.options.value=a},_setOption:function(a,b){this.options[a]=b,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),a.widget("twcc.ddGeoField",a.twcc.geoField,{options:{value:0,attributes:{DD:{size:"20",class:"width_5"}}},_getFieldsOptions:function(){return{DD:{type:"text"}}},_getForId:function(){return this.options.fields.DD.field("id")},_getRawValue:function(){return d.math.parseFloat(this.options.fields.DD.field("value"))},getStringValue:function(){return this.options.value+this._getFieldSetUnit("DD")},_setValue:function(a){return this.options.fields.DD.field("value",a)},_constraint:function(a){var b="y"===this.options.axis?180*Math.atan(Math.sinh(Math.PI))/Math.PI:180,c=-b;return a=Math.max(a,c),a=Math.min(a,b)},_clean:function(a){return this._constraint(this._super(a,15))}}),a.widget("twcc.dmGeoField",a.twcc.ddGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"6",class:"width_3"}}},_buildField:function(b,c){return"option"===c.type?(this.options.fields[b]=a.apply(null,this.options.wrapper.field).optionField(c),this.options.fields[b]):this._superApply(arguments)},_getFieldsOptions:function(){var a=this._clean(this.options.value);return{C:{type:"option",value:a.C||"",options:this.options.options},D:{type:"text",value:this._superClean(a.D)},M:{type:"text",value:this._superClean(a.M,12)}}},_getForId:function(){return this.options.fields.D.field("id")},_getFieldSetUnit:function(a){return"C"!=a?this._superApply(arguments):""},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:d.math.parseFloat(this.options.fields.D.field("value")),M:d.math.parseFloat(this.options.fields.M.field("value"))}},value:function(a){return void 0===a?this._clean(m(this._getObjectValue())):(a=this._clean(a),this.options.fields.C.optionField("value",a.C||""),this.options.fields.D.field("value",this._superClean(a.D)),this.options.fields.M.field("value",this._superClean(a.M,12))),this.options.value},getStringValue:function(){var a=this._getObjectValue();return a.D+this._getFieldSetUnit("D")+a.M+this._getFieldSetUnit("M")+a.C},_clean:function(a){return this.options.value=this._constraint(a),o(this.options.value,this.options.options)},_toggleField:function(a,b,c){return"option"===c.type?a.optionField("toggle",b):this._superApply(arguments)}}),a.widget("twcc.dmsGeoField",a.twcc.dmGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"4",class:"width_1"},S:{size:"6",class:"width_3"}}},_getFieldsOptions:function(){var a=this._clean(this.options.value);return{C:{type:"option",value:a.C||"",options:this.options.options},D:{type:"text",value:this._superClean(a.D)},M:{type:"text",value:this._superClean(a.M)},S:{type:"text",value:this._superClean(a.S,12)}}},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:d.math.parseFloat(this.options.fields.D.field("value")),M:d.math.parseFloat(this.options.fields.M.field("value")),S:d.math.parseFloat(this.options.fields.S.field("value"))}},value:function(a){return void 0===a?this._clean(l(this._getObjectValue())):(a=this._clean(a),this.options.fields.C.optionField("value",a.C||""),this.options.fields.D.field("value",this._superClean(a.D)),this.options.fields.M.field("value",this._superClean(a.M)),this.options.fields.S.field("value",this._superClean(a.S,12))),this.options.value},getStringValue:function(){var a=this._getObjectValue();return a.D+this._getFieldSetUnit("D")+a.M+this._getFieldSetUnit("M")+a.S+this._getFieldSetUnit("S")+a.C},_clean:function(a){return this.options.value=this._constraint(a),n(this.options.value,this.options.options)}}),a.widget("twcc.switchGeoField",a.twcc.geoField,{_clean:function(a){return this._constraint(a)},_setFieldHandlers:function(a){var b=this;a.find(":first-child").click(function(a){b._trigger(".update_display",a,{value:b.value()})})},_appendLabelCell:function(){},_getEmptyFieldCell:function(){return a.apply(null,this.options.wrapper.options)},_setDefaultsFieldsOptions:function(){},_getRawValue:function(){return a("input:radio:checked",this.element).val()},_setValue:function(a){return this.element.find('input:radio[value="'+a+'"]').prop("checked",!0),a},_getForId:function(a){return this.options.fields[a].field("id")},_getFieldSetUnit:function(b){var c=this._superApply(arguments),d=this._getForId(b);return a("<label>",{for:d}).append(c)}}),a.widget("twcc.angleSwitchGeoField",a.twcc.switchGeoField,{options:{value:"dd"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var a=this.options.name+"_DMS_DM_DD",b=this.options.value,c="dd"===b,d="dm"===b;return{_DMS:{name:a,type:"radio",value:"dms",attributes:{checked:!c&&!d}},_DM:{name:a,type:"radio",value:"dm",attributes:{checked:d}},_DD:{name:a,type:"radio",value:"dd",attributes:{checked:c}}}},_constraint:function(b){return a.inArray(b,["dms","dm","dd"])<0?"dms":b}}),a.widget("twcc.lengthSwitchGeoField",a.twcc.switchGeoField,{options:{value:"m"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var a=this.options.name+"_M_KM_F",b=this.options.value,c="km"===b,d="us-ft"===b;return{_M:{name:a,type:"radio",value:"m",attributes:{checked:!c&&!d}},_KM:{name:a,type:"radio",value:"km",attributes:{checked:c}},_F:{name:a,type:"radio",value:"us-ft",attributes:{checked:d}}}},_constraint:function(b){return a.inArray(b,["m","km","us-ft"])<0?"m":b}}),a.widget("twcc.xyGeoField",a.twcc.geoField,{options:{value:0,attributes:{XY:{size:"20",class:"width_4"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XY:{type:"text"}}},_getForId:function(){return this.options.fields.XY.field("id")},_getFieldSetUnit:function(){return this.options.unit.XY[this.options.lengthUnit]},_getRawValue:function(){return s(this.options.fields.XY.field("value"),this.options.lengthUnit)},getStringValue:function(){return this.options.fields.XY.field("value")+this.options.lengthUnit},_setValue:function(a){return s(this.options.fields.XY.field("value",a),this.options.lengthUnit)},_clean:function(a){return this._super(t(a,this.options.lengthUnit),"m"==this.options.lengthUnit?3:5)},unit:function(a){return void 0!==a&&(this.value(),this.options.lengthUnit=this._cleanUnit(a),this._update()),this.options.lengthUnit},_cleanUnit:function(b){return a.inArray(b,["m","km","us-ft"])<0?"m":b}}),a.widget("twcc.zoneGeoField",a.twcc.geoField,{options:{value:31,attributes:{Z:{size:"5",class:"width_2"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{Z:{type:"text"}}},_getForId:function(){return this.options.fields.Z.field("id")},_getRawValue:function(){return parseInt(this.options.fields.Z.field("value"))},_setValue:function(a){return this.options.fields.Z.field("value",a)},_constraint:function(a){return a=Math.max(a,0)},_clean:function(a){return this._constraint(this._super(a))}}),a.widget("twcc.hemisphereGeoField",a.twcc.geoField,{options:{value:"n",attributes:{E:{size:"1"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{E:{type:"option",options:this.options.options}}},_getForId:function(){return this.options.fields.E.optionField("id")},_getFieldSetUnit:function(){},_buildField:function(b,c){return this.options.fields[b]=a.apply(null,this.options.wrapper.field).optionField(c),this.options.fields[b]},_clean:function(a){return this._constraint(a||"n")},_getRawValue:function(){return this.options.fields.E.optionField("value")},_constraint:function(b){return a.inArray(b,["n","s"])<0?"n":b},_setValue:function(a){return this.options.fields.E.optionField("value",a)},_toggleField:function(a,b){return a.optionField("toggle",b)}}),a.widget("twcc.csvGeoField",a.twcc.geoField,{options:{value:"",attributes:{CSV:{rows:"5",wrap:"off"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CSV:{type:"textarea"}}},_getFieldSetUnit:function(){return""},_getForId:function(){return this.options.fields.CSV.textareaField("id")},_buildField:function(b,c){return this.options.fields[b]=a.apply(null,this.options.wrapper.field).textareaField(c),this.options.fields[b]},_clean:function(a){return this._constraint(a||"")},_getRawValue:function(){return this.options.fields.CSV.textareaField("value")},_setValue:function(a){return this.options.fields.CSV.textareaField("value",a)},_toggleField:function(a,b){return a.textareaField("toggle",b)}}),a.widget("twcc.convergenceGeoField",a.twcc.geoField,{options:{value:0,attributes:{CONVERGENCE:{size:"10",class:"width_4",readonly:!0}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CONVERGENCE:{type:"text"}}},_getForId:function(){return this.options.fields.CONVERGENCE.field("id")},_getRawValue:function(){return this.options.fields.CONVERGENCE.field("value")},_constraint:function(a){var b=360,c=-b;return a=Math.max(a,c),a=Math.min(a,b)},_setValue:function(a){return this.options.fields.CONVERGENCE.field("value",a)},_clean:function(a){return this._constraint(this._super(a,4))}}),a.widget("twcc.connectorGeoField",a.twcc.geoField,{options:{value:""},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XX:{type:"text"}}},_appendLabelCell:function(){},_getRawValue:function(){return this.options.fields.XX.field("value")},_setValue:function(a){return this.options.fields.XX.field("value",a)},_constraint:function(a){return a},_clean:function(a){return this._constraint(a)}}),a.widget("twcc.labelGeoField",a.twcc.geoField,{options:{value:""},_create:function(){this._super(),this.options.fields.L.text(this.options.value)},_buildField:function(a,b){return this.options.fields[a]=b,this.options.fields[a]},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{L:a("<span>")}},_getFieldSetUnit:function(){return""},_getRawValue:function(){return this.options.fields.L.text()},_constraint:function(a){return a},_setValue:function(a){return this.options.fields.L.text(a),a},_clean:function(a){return this._constraint(a)},_toggleField:function(){return this.options.readonly}}),a.widget("twcc.field",{options:{type:null,value:null,name:null,glue:"_id_",attributes:{},readOnly:!1},_create:function(){this.options.attributes=a.extend({val:this.options.value,id:this.options.name+this.options.glue+Math.floor(10001*Math.random()),name:this.options.name,disabled:this.options.readOnly,readonly:this.options.readOnly},this.options.attributes),this._setTag()},_setTag:function(){a.extend(this.options.attributes,{type:this.options.type}),this.element.tag({name:"input",attributes:this.options.attributes})},value:function(a){return this.options.value=void 0===a?this.element.tag("value"):this.element.tag("value",a),this.options.value},toggle:function(a){return a=void 0===a?this.options.readOnly:!!a,this.options.readOnly=this._toggle(a),this.options.readOnly},_toggle:function(a){return this.element.tag("toggle",a)},readOnly:function(){return this.options.readOnly},id:function(){return this.options.attributes.id},_setOption:function(a,b){this.options[a]=b,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),a.widget("twcc.textareaField",a.twcc.field,{options:{type:"textarea"},_setTag:function(){this.element.tag({name:"textarea",attributes:this.options.attributes})}}),a.widget("twcc.optionField",a.twcc.field,{options:{type:"option",options:{}},_setTag:function(){this.element.selectTag({attributes:this.options.attributes,options:this.options.options})},value:function(a){return this.options.value=void 0===a?this.element.selectTag("value"):this.element.selectTag("value",a),this.options.value},_toggle:function(a){return this.element.selectTag("toggle",a)}}),a.widget("twcc.tag",{options:{name:null,attributes:{},readOnly:!1},_$elt:null,_create:function(){var b;this.options.attributes.val&&(this.options.attributes.val=this._clean(this.options.attributes.val)),this.options.attributes.hasOwnProperty("checked")&&(b=this.options.attributes.checked,delete this.options.attributes.checked),this._$elt=a("<"+this.options.name+">",this.options.attributes),void 0!==b&&this._$elt.prop("checked",b),this._appendChildren(),this.value(this.options.attributes.val),this.element.append(this._$elt)},value:function(a){return void 0===a?this.options.attributes.val=this._$elt.val():(this.options.attributes.val=this._clean(a),this._$elt.val(this.options.attributes.val)),this.options.attributes.val},toggle:function(a){var b=void 0===a?this.options.readOnly:!a;return this.options.readOnly=this._toggle(b),this.options.readOnly},_toggle:function(a){return this._$elt.prop("disabled",a).prop("readonly",a),a},readOnly:function(){return this.options.readOnly},_clean:function(a){return"number"==typeof a&&a.toString().split("e").length>1&&(a=d.math.round(a)),a},_appendChildren:function(){},_setOption:function(a,b){this.options[a]=b,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this._$elt.remove(),this._super()}}),a.widget("twcc.selectTag",a.twcc.tag,{options:{name:"select",options:{}},_$elt:null,_appendChildren:function(){var b=this;a.each(this.options.options,function(c,d){b._$elt.append(a("<option>",{value:c,text:d}))})}})}(jQuery,proj4,TWCCHistory,App),function(a){var b=function(b){this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.1",bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},void 0!==b&&this.setOption(b);var c=this,d=function(){setTimeout(function(){!0===c._options.checkOnLoad&&(!0===c._options.debug&&c._log("onload->eventCallback","A check loading is launched"),null===c._var.bait&&c._creatBait(),setTimeout(function(){c.check()},1))},1)};void 0!==a.addEventListener?a.addEventListener("load",d,!1):a.attachEvent("onload",d)};b.prototype._options=null,b.prototype._var=null,b.prototype._bait=null,b.prototype._log=function(a,b){console.log("[BlockAdBlock]["+a+"] "+b)},b.prototype.setOption=function(a,b){if(void 0!==b){var c=a;a={},a[c]=b}for(var d in a)this._options[d]=a[d],!0===this._options.debug&&this._log("setOption",'The option "'+d+'" he was assigned to "'+a[d]+'"');return this},b.prototype._creatBait=function(){var b=document.createElement("div");b.setAttribute("class",this._options.baitClass),b.setAttribute("style",this._options.baitStyle),this._var.bait=a.document.body.appendChild(b),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,!0===this._options.debug&&this._log("_creatBait","Bait has been created")},b.prototype._destroyBait=function(){a.document.body.removeChild(this._var.bait),this._var.bait=null,!0===this._options.debug&&this._log("_destroyBait","Bait has been removed")},b.prototype.check=function(a){if(void 0===a&&(a=!0),!0===this._options.debug&&this._log("check","An audit was requested "+(!0===a?"with a":"without")+" loop"),!0===this._var.checking)return!0===this._options.debug&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var b=this;return this._var.loopNumber=0,!0===a&&(this._var.loop=setInterval(function(){b._checkBait(a)},this._options.loopCheckTime)),setTimeout(function(){b._checkBait(a)},1),!0===this._options.debug&&this._log("check","A check is in progress ..."),!0},b.prototype._checkBait=function(b){var c=!1;if(null===this._var.bait&&this._creatBait(),null===a.document.body.getAttribute("abp")&&null!==this._var.bait.offsetParent&&0!=this._var.bait.offsetHeight&&0!=this._var.bait.offsetLeft&&0!=this._var.bait.offsetTop&&0!=this._var.bait.offsetWidth&&0!=this._var.bait.clientHeight&&0!=this._var.bait.clientWidth||(c=!0),void 0!==a.getComputedStyle){var d=a.getComputedStyle(this._var.bait,null);!d||"none"!=d.getPropertyValue("display")&&"hidden"!=d.getPropertyValue("visibility")||(c=!0)}!0===this._options.debug&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(!0===c?"positive":"negative")),!0===b&&++this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop(),!0===c?(this._stopLoop(),this._destroyBait(),this.emitEvent(!0),!0===b&&(this._var.checking=!1)):null!==this._var.loop&&!1!==b||(this._destroyBait(),this.emitEvent(!1),!0===b&&(this._var.checking=!1))},b.prototype._stopLoop=function(a){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,!0===this._options.debug&&this._log("_stopLoop","A loop has been stopped")},b.prototype.emitEvent=function(a){!0===this._options.debug&&this._log("emitEvent","An event with a "+(!0===a?"positive":"negative")+" detection was called");var b=this._var.event[!0===a?"detected":"notDetected"];for(var c in b)!0===this._options.debug&&this._log("emitEvent","Call function "+(parseInt(c)+1)+"/"+b.length),b.hasOwnProperty(c)&&b[c]();return!0===this._options.resetOnEnd&&this.clearEvent(),this},b.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],
!0===this._options.debug&&this._log("clearEvent","The event list has been cleared")},b.prototype.on=function(a,b){return this._var.event[!0===a?"detected":"notDetected"].push(b),!0===this._options.debug&&this._log("on",'A type of event "'+(!0===a?"detected":"notDetected")+'" was added'),this},b.prototype.onDetected=function(a){return this.on(!0,a)},b.prototype.onNotDetected=function(a){return this.on(!1,a)},a.BlockAdBlock=b,void 0===a.blockAdBlock&&(a.blockAdBlock=new b({checkOnLoad:!0,resetOnEnd:!0}))}(window),function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){return e(b[g][1][a]||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=a("ol"),f=a("ol/proj/proj4.js"),g=a("ol/layer.js"),h=a("ol/source"),i=d(a("ol/source/Vector")),j=a("ol/geom"),k=d(a("ol/geom/GeometryType.js")),l=a("ol/style.js"),m=a("ol/control.js"),n=a("ol/control/ScaleLine"),o=a("ol/format.js"),p=a("ol/interaction.js"),q=a("ol/proj.js"),r=a("ol/coordinate.js"),s=d(a("ol-geocoder")),t=d(a("ol/layer/Group")),u=a("ol/sphere"),v=d(a("ol-layerswitcher"));d(a("ol-ext/control/Graticule"));!function(a,b){if(void 0===window.TWCCMap){var c,d=function(c){function d(a){this._array=a,this._index=0;var b=this;this.get=function(){var a=b._array[b._index];return++b._index,b._index===b._array.length&&(b._index=0),a}}function w(){return ya.utils.t.apply(this,arguments)}function x(){return ya.utils.newDeferred.apply(this,arguments)}function y(b,c){ya.utils.trigger(a(ya.mapContainerElt),b,c)}function z(a){return ya.utils.getPreferenceCookie(a)}function A(a){return(0,q.fromLonLat)(a,la.getProjection())}function B(a){return(0,q.toLonLat)(a,la.getProjection())}function C(a){return A([a.x,a.y])}function D(a,b){ja.setMetrics("length",a),ja.setMetrics("area",b),y("map.metrics_changed",{length:a,area:b})}function E(){var a=ra.getFeatures()[0];if(a){var b=a.getGeometry(),c=b.getCoordinates();c.push(c[0]);var d=new j.Polygon([c]);D((0,u.getLength)(b),(0,u.getArea)(d))}}function F(){va.setPosition(void 0)}function G(a){qa.getFeatures().forEach(function(b){b.getGeometry().setCoordinates(a||b.getGeometry().getCoordinates());var c=b.get("name"),d=ja.getAngleInRadians(c)||0,e="true"===c||d?ya.mapOptions.azimuthOpacity:0,f=b.get("style").getImage();f.setRotation(d),f.setOpacity(e)})}function H(a){return"data:image/svg+xml,"+escape('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'+a)}function I(b){var c=H('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/><rect style="fill:#fff;stroke:#fff;stroke-width:1;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;" width="8.779562" height="8.2131386" x="3.610219" y="4.5313869"/></svg>'),d={true:{src:H('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><polygon style="fill:#fff;stroke:#fff;stroke-width:37.61520004;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10" stroke-miterlimit="10" points="374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 259.216,29.942 330.27,173.919 489.16,197.007 " transform="matrix(0.03217603,0,0,0.03217603,-0.33683664,-0.35833699)"/><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/></svg>')},magneticDeclination:{src:H('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16 97" xml:space="preserve" width="16" height="97"><g transform="matrix(0.07106223,0,0,0.07106223,-0.43846047,1.8741008e-6)"><path style="fill:#fff" d="m 7.954,226.53 c -2.23,4.623 -2.295,8.072 -0.609,9.915 3.911,4.275 15.926,-3.905 23.323,-9.051 l 58.416,-40.662 c 7.397,-5.145 20.402,-11.835 29.414,-11.993 0.897,-0.016 1.8,-0.011 2.703,0.011 9.007,0.218 21.958,7.016 29.3,12.238 l 56.403,40.151 c 7.343,5.221 19.303,13.473 23.301,9.219 1.74,-1.849 1.751,-5.33 -0.381,-9.997 L 129.648,7.047 c -4.264,-9.333 -11.335,-9.404 -15.79,-0.163 L 7.954,226.53 Z"/><path style="stroke:#fff;stroke-width:28.14434624;" d="m 118.74748,174.45383 0,1190.45957"/></g></svg>'),rotation:ja.getAngleInRadians("magneticDeclination")},srcConvergence:{src:c,color:"#f00",rotation:ja.getAngleInRadians("srcConvergence")},dstConvergence:{src:c,rotation:ja.getAngleInRadians("dstConvergence")}};for(var f in d)if(d.hasOwnProperty(f)){var g=d[f];qa.addFeature(new e.Feature({geometry:new j.Point(b),name:f,style:new l.Style({image:new l.Icon(a.extend({anchor:[.5,1],rotateWithView:!0,opacity:"true"===f||g.rotation?ya.mapOptions.azimuthOpacity:0,scale:.75,color:"#000"},g))})}))}}function J(){qa.clear()}function K(b){var c=[];return a.each(b,function(){if(void 0===this.lat&&void 0===this.x||this.error)return!0;c.push(this)}),c}function L(b){var c=[new l.Style({stroke:new l.Stroke({color:"rgba(0,0,0,0.5)",width:2})})],d=0,e=b.getGeometry(),f=e.getCoordinates().length-1,g={font:"10px Arial",stroke:new l.Stroke({color:"#fff",width:2}),fill:new l.Fill({color:"#000"})};return e.forEachSegment(function(b,e){++d,c.push(new l.Style({geometry:new j.Point(b),text:new l.Text(a.extend(g,{text:d.toString()}))})),d===f&&c.push(new l.Style({geometry:new j.Point(e),text:new l.Text(a.extend(g,{text:(d+1).toString()}))}))}),c}function M(a){return a.map(C)}function N(a){sa.getFeatures().forEach(function(b){b.getGeometry().setCoordinates(a)})}function O(a){ra.getFeatures()[0].getGeometry().setCoordinates(a)}function P(a){sa.addFeature(new e.Feature({geometry:new j.Point(a),style:new l.Style({image:new l.Icon({src:ya.system.dirWsImages+"twcc_icon_with_shadow.png",anchor:[19,1],anchorXUnits:"pixels"})})}))}function Q(a){ra.addFeature(new e.Feature({geometry:new j.LineString(a)}))}function R(){sa.clear(),ka.removeInteraction(na)}function S(){ra.clear(),ka.removeInteraction(oa)}function T(){!0===ja.getBoolean("autoZoom")&&ka.getView().fit(ra.getExtent(),{duration:200,padding:[0,270,36,204]})}function U(b){var c=new a.Deferred;return la.animate({center:b,duration:200},c.resolve),c.promise()}function V(b){var c=new a.Deferred;return la.animate({zoom:b,duration:200},c.resolve),c.promise()}function W(){a("#zoom-btn").button("option","disabled",!0);var b=sa.getFeatures()[0].getGeometry().getCoordinates();a.when(U(b),V(10)).done(function(){a("#zoom-btn").button("option","disabled",!1)})}function X(a){if(ra){var b=M(a);ra.getFeatures().length?O(b):(Q(b),ka.addInteraction(oa)),E(),T()}}function Y(b){var c,d,e,f,g="",h="",i="",j=B(b),k={key:ya.mapOptions.timezonedbKey,format:"json",by:"position",lng:j[0],lat:j[1],fields:"abbreviation,gmtOffset"},l=(0,r.degreesToStringHDMS)("NS",j[1]),m=(0,r.degreesToStringHDMS)("EW",j[0]);c=a.get("https://elevation-api.io/api/elevation",{points:j[1]+","+j[0]}).done(function(a){if(a.elevations){var b=a.elevations[0].elevation.toString();"-9999"!==b&&(g='<p><img src="'+ya.system.dirWsImages+'elevation_icon.png" alt="'+w("elevation")+'" title="'+w("elevation")+'" width="38" height="30"> '+b+w("unitMeter")+"</p>")}}).fail(function(){y("xhr.failed","Elevation API")}),d=a.get("https://api.timezonedb.com/v2.1/get-time-zone",k).done(function(a){if("OK"===a.status){var b=a.gmtOffset/3600;i="<p>"+a.abbreviation+" (GMT",b>0&&(i+="+"),0!==b&&(i+=b),i+=")</p>"}}).fail(function(){y("xhr.failed","Timezonedb API")}),e=a.get("https://nominatim.openstreetmap.org/reverse",{format:"json",lat:j[1],lon:j[0],"accept-language":ya.context.languageCode}).done(function(a){if(a&&!a.error){var b=a.address.country_code.toUpperCase();h='<img src="'+ya.system.dirWsImages+'address_icon.png" alt="'+w("address")+'" title="'+w("address")+'" width="38" height="30"><p>'+a.display_name+'   <img src="'+ya.system.dirWsImages+"flags/"+b+'.png" alt="'+b+'" width="22" height="15"></p>'}}).fail(function(){y("xhr.failed","Nominatim API")}),F(),a.when(e,c,d).always(function(){f='<div id="popup" class="ol-popup">   <a href="#" id="popup-closer" class="ol-popup-closer"></a>   <div class="popup-content">       <h3>'+w("dragMe")+"</h3>       <div>"+h+'           <a id="zoom-btn" href="#" title="'+w("zoom")+'">'+w("zoom")+'</a>       </div>       <div>           <img src="'+ya.system.dirWsImages+'gps_icon.png" alt="GPS (WGS84)" title="GPS (WGS84)" width="38" height="30">           <p>'+l+"<br>"+m+"</p>"+i+g+"       </div>   </div></div>",ua.innerHTML=f,a("#zoom-btn").button({icons:{primary:"ui-icon-zoomin"},text:!1}).click(function(){W()}),a("#popup-closer").click(function(a){return F(),this.blur(),a.stopPropagation(),a.preventDefault(),!1}),y("infowindow.dom_ready"),va.setPosition(b)})}function Z(a){if(sa){var b=C(a);sa.getFeatures().length?N(b):(P(b),ka.addInteraction(na)),qa.getFeatures().length?G(b):I(b),U(b),Y(b),D()}}function $(a){1===a.length?(S(),Z(a[0])):(F(),R(),J(),X(a))}function _(){new GridOverlay(ka).setMap(ka)}function aa(a,b){return a.reduce(function(a,c){return a.concat(b(c))},[])}function ba(a){return aa(a,function(a){return a})}function ca(a){return ba(ba(a))}function da(a){switch(a.getType()){case k.default.POINT:return[a.getCoordinates()];case k.default.LINE_STRING:case k.default.LINEAR_RING:case k.default.MULTI_POINT:return a.getCoordinates();case k.default.POLYGON:case k.default.MULTI_LINE_STRING:return ba(a.getCoordinates());case k.default.MULTI_POLYGON:return ca(a.getCoordinates());case k.default.GEOMETRY_COLLECTION:return aa(a.getGeometries(),function(a){return da(a)});case k.default.CIRCLE:return[a.getCenter()];default:return[]}}function ea(a){return new g.Tile({title:a.title,type:"base",visible:!1,preload:1/0,source:new h.XYZ({attributions:'© Google <a href="https://developers.google.com/maps/terms" target="_blank">Terms of Use.</a>',url:"http://mt0.google.com/vt/lyrs="+a.lyrs+"&hl=en&x={x}&y={y}&z={z}&s=Ga"})})}function fa(){var b=z("layers");if(b){var c=b.opt;if(c)for(var d in c)if(c.hasOwnProperty(d)){var e=a(".ol-control.layer-switcher label:contains('"+d+"')").closest("li").children("input[type=checkbox]");e.length&&e[0].checked!==c[d]&&e.click()}var f=b.base;if(f)for(var g in f)if(f.hasOwnProperty(g)){var h=a(".ol-control.layer-switcher label:contains('"+g+"')").closest("li").find("label:contains('"+f[g]+"')").closest("li").children("input[type=radio]");h.length&&h.click()}}}function ga(b){if(b.features){var c;if(a.isFunction(b.features.getArray))c=b.features.getArray();else{if(!a.isArray(b.features))return;c=b.features}y("linestring.edit_end",aa(c,function(a){return da(a.getGeometry())}).map(B)),E()}}function ha(){var b=a("body");ma.once("tileloadend",function(){fa(),y("map.tiles_loaded"),a(".ol-control.layer-switcher").on("change","input",function(b){var c=a(b.target),d=c.closest("li.group").children("label").text();d+=" "+c.closest("li.layer").children("label").text(),"checkbox"===c.attr("type")&&(d+=" ",d+=this.checked?"on":"off"),y("map.layer.change",d)}),xa.resolve()}),ma.on("tileloaderror",xa.reject),ka.on("singleclick",function(a){var b=ka.forEachFeatureAtPixel(ka.getEventPixel(a.originalEvent),function(a){return a});b?Y(b.getGeometry().getCoordinates()):(F(),y("map.click",B(a.coordinate)))}),ta.on("addresschosen",function(a){y("place.changed",B(a.coordinate))}),na.on("modifystart",function(){F(),J(),y("marker.drag_start")}),na.on("modifyend",function(a){y("marker.drag_end",B(a.features.getArray()[0].getGeometry().getCoordinates()))}),oa.on("modifyend",ga),pa.on("addfeatures",ga),ka.getViewport().addEventListener("contextmenu",function(a){var b=ka.forEachFeatureAtPixel(ka.getEventPixel(a),function(a){return a});b?y("linestring.remove_vertice",B(b.getGeometry().getCoordinates())):y("linestring.add_vertice",B(ka.getEventCoordinate(a))),E(),a.stopPropagation(),a.preventDefault()}),b.on("converter.source.selection_changed converterset.done",function(a,b){}),b.on("converterset.wgs84_changed",function(a,b){var c=ya.utils.degToRad(b.convergenceInDegrees);b.wgs84=K(b.wgs84),ja.setAngleInDegrees("magneticDeclination",b.magneticDeclinationInDegrees),ja.setAngleInRadians("srcConvergence",c.source),ja.setAngleInRadians("dstConvergence",c.destination),$(b.wgs84),y("converter.changed",b)}),b.on("converterset.convergence_changed",function(a,b){if(qa.getFeatures().length){var c=ya.utils.degToRad(b.convergenceInDegrees);ja.setAngleInRadians("srcConvergence",c.source),ja.setAngleInRadians("dstConvergence",c.destination),G()}}),b.on("ui.full_screen",function(){a(".ol-full-screen button").trigger("click")});var c=new d(Object.values(n.Units));a(".ol-scale-line").click(function(){wa.setUnits(c.get())})}function ia(){xa=x("Map"),(0,f.register)(b);var c=new l.Style({image:new l.Circle({radius:6,fill:null,stroke:new l.Stroke({color:"rgba(0,0,0,0.6)",width:3})})});ua=a("<div>")[0],wa=new m.ScaleLine,qa=new i.default,sa=new i.default,ra=new i.default,na=new p.Modify({source:sa,style:c,pixelTolerance:30}),oa=new p.Modify({source:ra,style:c}),pa=new p.DragAndDrop({formatConstructors:[o.GPX,o.GeoJSON,o.IGC,o.KML,o.TopoJSON]}),ma=new h.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),la=new e.View({zoom:ya.mapOptions.zoom}),ta=new s.default("nominatim",{autoComplete:!0,autoCompleteMinLength:2,placeholder:w("searchByAddress"),targetType:"glass-button",lang:ya.context.languageCode,limit:5,keepOpen:!1,preventDefault:!0,debug:!1}),va=new e.Overlay({element:ua,autoPan:!0,autoPanAnimation:{duration:200}});var d=A(ya.mapOptions.center);la.setCenter(d),ka=new e.Map({controls:(0,m.defaults)().extend([new m.FullScreen({source:"map-container"}),new v.default,ta,wa]),interactions:(0,p.defaults)().extend([new p.DragRotateAndZoom,pa]),target:ya.mapContainerElt,loadTilesWhileAnimating:!0,overlays:[va],layers:[new t.default({title:"Maps",layers:[new t.default({title:"ArcGIS",layers:[new g.Tile({title:"Satellite",type:"base",visible:!1,preload:1/0,source:new h.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer">ArcGIS</a>',url:"http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg"})}),new g.Tile({title:"Terrain",type:"base",preload:1/0,source:ma})]}),new t.default({title:"OSM",layers:[new g.Tile({title:"Stamen toner",type:"base",visible:!1,preload:1/0,source:new h.Stamen({layer:"toner"})}),new g.Tile({title:"Stamen terrain",type:"base",visible:!1,preload:1/0,source:new h.Stamen({layer:"terrain"})}),new g.Tile({title:"Open Street Map",type:"base",visible:!1,preload:1/0,source:new h.OSM})]}),new t.default({title:"Google",layers:[ea(za.HYBRID),ea(za.SATELLITE),ea(za.TERRAIN),ea(za.ROAD)]})]}),new t.default({title:"Features",layers:[new g.Vector({title:"Azimuths",style:function(a){return a.get("style")},source:qa})]}),new g.Vector({style:function(a){return a.get("style")},source:sa}),new g.Vector({style:L,source:ra})],view:la}),ha()}var ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa=null,ya={mapOptions:{zoom:2,center:[0,0],azimuthOpacity:.7},mapContainerElt:a("#map")[0],context:{languageCode:"en"}},za={HYBRID:{title:"Hybrid",lyrs:"y"},SATELLITE:{title:"Satellite",lyrs:"s"},TERRAIN:{title:"Terrain",lyrs:"p"},ROAD:{title:"Road",lyrs:"m"}};return a.extend(!0,ya,c),ja={anglesInRadians:{},booleans:{autoZoom:!0},metrics:{},setAngleInRadians:function(a,b){ja.anglesInRadians[a]=b},setAngleInDegrees:function(a,b){ja.setAngleInRadians(a,ya.utils.degToRad(b))},getAngleInRadians:function(a){return ja.anglesInRadians[a]},setBoolean:function(a,b){ja.booleans[a]=!!b},getBoolean:function(a){return ja.booleans[a]},setMetrics:function(a,b){ja.metrics[a]=b},getMetrics:function(a){return ja.metrics[a]}},ia(),{promise:xa.promise(),setGraticule:_,model:{setAngleInRadians:ja.setAngleInRadians,setAngleInDegrees:ja.setAngleInDegrees,getMetrics:ja.getMetrics,setBoolean:ja.setBoolean},getMap:function(){return ka}}};window.TWCCMap={getInstance:function(a){return c=c||d(a)}}}}(jQuery,proj4)},{ol:162,"ol-ext/control/Graticule":3,"ol-geocoder":4,"ol-layerswitcher":5,"ol/control.js":51,"ol/control/ScaleLine":57,"ol/coordinate.js":62,"ol/format.js":76,"ol/geom":127,"ol/geom/GeometryType.js":132,"ol/interaction.js":163,"ol/layer.js":185,"ol/layer/Group":187,"ol/proj.js":210,"ol/proj/proj4.js":215,"ol/source":280,"ol/source/Vector":304,"ol/sphere":312,"ol/style.js":318}],2:[function(a,b,c){"use strict";c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("ol"),f=a("ol/Observable"),g=d(a("ol/control/Control")),h=d(a("ol/proj/Projection")),i=d(a("ol/style/Style")),j=d(a("ol/style/Stroke")),k=d(a("ol/style/Fill")),l=d(a("ol/style/Text")),m=a("ol/proj"),n=a("ol/proj.js"),o=function(a){a||(a={});var b=document.createElement("div");b.className="ol-graticule ol-unselectable ol-hidden",g.default.call(this,{element:b}),this.set("projection",a.projection||"EPSG:4326");var c=new h.default({code:this.get("projection")}),d=c.getMetersPerUnit();for(this.fac=1;d/this.fac>10;)this.fac*=10;this.fac=1e4/this.fac,this.set("maxResolution",a.maxResolution||1/0),this.set("step",a.step||.1),this.set("stepCoord",a.stepCoord||1),this.set("spacing",a.spacing||40),this.set("margin",a.margin||0),this.set("borderWidth",a.borderWidth||5),this.set("stroke",!1!==a.stroke),this.formatCoordX=a.formatCoordX||function(a){return a},this.formatCoordY=a.formatCoordY||function(a){return a},a.style instanceof i.default?this.style=a.style:this.style=new i.default({stroke:new j.default({color:"#000",width:1}),fill:new k.default({color:"#fff"}),text:new l.default({stroke:new j.default({color:"#fff",width:2}),fill:new k.default({color:"#000"})})})};(0,e.inherits)(o,g.default),o.prototype.setMap=function(a){var b=this.getMap();this._listener&&(0,f.unByKey)(this._listener),this._listener=null,g.default.prototype.setMap.call(this,a),b&&b.renderSync(),a&&(this._listener=a.on("postcompose",this.drawGraticule_.bind(this)))},o.prototype.setStyle=function(a){this.style=a},o.prototype.getStyle=function(a){return a},o.prototype.drawGraticule_=function(a){if(!(this.get("maxResolution")<a.frameState.viewState.resolution)){for(var b,c=a.context,d=c.canvas,e=a.frameState.pixelRatio,f=d.width/e,g=d.height/e,h=this.get("projection"),i=this.getMap(),j=[i.getCoordinateFromPixel([0,0]),i.getCoordinateFromPixel([f,0]),i.getCoordinateFromPixel([f,g]),i.getCoordinateFromPixel([0,g])],k=-1/0,l=1/0,o=-1/0,p=1/0,q=0;b=j[q];q++)j[q]=(0,m.transform)(b,i.getView().getProjection(),h),k=Math.max(k,j[q][0]),l=Math.min(l,j[q][0]),o=Math.max(o,j[q][1]),p=Math.min(p,j[q][1]);var r=this.get("spacing"),s=this.get("step"),t=this.get("stepCoord"),u=this.get("borderWidth"),v=this.get("margin");if((k-l)/s*r>f){s*=Math.round((k-l)/f*r/s),s>this.fac&&(s=Math.round(s/this.fac)*this.fac)}l=Math.floor(l/s)*s-s,p=Math.floor(p/s)*s-s,k=Math.floor(k/s)*s+2*s,o=Math.floor(o/s)*s+2*s;var w=(0,n.get)(h).getExtent();w&&(l<w[0]&&(l=w[0]),p<w[1]&&(p=w[1]),k>w[2]&&(k=w[2]+s),o>w[3]&&(o=w[3]+s));var x=this.style.getStroke()&&this.get("stroke"),y=this.style.getText(),z=this.style.getFill();c.save(),c.scale(e,e),c.beginPath(),c.rect(v,v,f-2*v,g-2*v),c.clip(),c.beginPath();for(var A={top:[],left:[],bottom:[],right:[]},B=l;B<k;B+=s){var C=(0,m.transform)([B,p],h,i.getView().getProjection());C=i.getPixelFromCoordinate(C),x&&c.moveTo(C[0],C[1]);for(var D=C,E=p+s;E<=o;E+=s){var F=(0,m.transform)([B,E],h,i.getView().getProjection());F=i.getPixelFromCoordinate(F),x&&c.lineTo(F[0],F[1]),D[1]>0&&F[1]<0&&A.top.push([B,D]),D[1]>g&&F[1]<g&&A.bottom.push([B,D]),D=F}}for(var E=p;E<o;E+=s){var C=(0,m.transform)([l,E],h,i.getView().getProjection());C=i.getPixelFromCoordinate(C),x&&c.moveTo(C[0],C[1]);for(var D=C,B=l+s;B<=k;B+=s){var F=(0,m.transform)([B,E],h,i.getView().getProjection());F=i.getPixelFromCoordinate(F),x&&c.lineTo(F[0],F[1]),D[0]<0&&F[0]>0&&A.left.push([E,D]),D[0]<f&&F[0]>f&&A.right.push([E,D]),D=F}}if(x&&(c.strokeStyle=this.style.getStroke().getColor(),c.lineWidth=this.style.getStroke().getWidth(),c.stroke()),y){c.fillStyle=this.style.getText().getFill().getColor(),c.strokeStyle=this.style.getText().getStroke().getColor(),c.lineWidth=this.style.getText().getStroke().getWidth(),c.textAlign="center",c.textBaseline="hanging";for(var G,H,I=(z?u:0)+v+2,q=0;H=A.top[q];q++)Math.round(H[0]/this.get("step"))%t||(G=this.formatCoordX(H[0]),c.strokeText(G,H[1][0],I),c.fillText(G,H[1][0],I));c.textBaseline="alphabetic";for(var H,q=0;H=A.bottom[q];q++)Math.round(H[0]/this.get("step"))%t||(G=this.formatCoordX(H[0]),c.strokeText(G,H[1][0],g-I),c.fillText(G,H[1][0],g-I));c.textBaseline="middle",c.textAlign="left";for(var H,q=0;H=A.left[q];q++)Math.round(H[0]/this.get("step"))%t||(G=this.formatCoordY(H[0]),c.strokeText(G,I,H[1][1]),c.fillText(G,I,H[1][1]));c.textAlign="right";for(var H,q=0;H=A.right[q];q++)Math.round(H[0]/this.get("step"))%t||(G=this.formatCoordY(H[0]),c.strokeText(G,f-I,H[1][1]),c.fillText(G,f-I,H[1][1]))}if(z){var J,K,L=this.style.getFill().getColor();(K=this.style.getStroke())?J=this.style.getStroke().getColor():(J=L,L="#fff"),c.strokeStyle=J,c.lineWidth=K?K.getWidth():1;for(var q=1;q<A.top.length;q++)c.beginPath(),c.rect(A.top[q-1][1][0],v,A.top[q][1][0]-A.top[q-1][1][0],u),c.fillStyle=Math.round(A.top[q][0]/s)%2?J:L,c.fill(),c.stroke();for(var q=1;q<A.bottom.length;q++)c.beginPath(),c.rect(A.bottom[q-1][1][0],g-u-v,A.bottom[q][1][0]-A.bottom[q-1][1][0],u),c.fillStyle=Math.round(A.bottom[q][0]/s)%2?J:L,c.fill(),c.stroke();for(var q=1;q<A.left.length;q++)c.beginPath(),c.rect(v,A.left[q-1][1][1],u,A.left[q][1][1]-A.left[q-1][1][1]),c.fillStyle=Math.round(A.left[q][0]/s)%2?J:L,c.fill(),c.stroke();for(var q=1;q<A.right.length;q++)c.beginPath(),c.rect(f-u-v,A.right[q-1][1][1],u,A.right[q][1][1]-A.right[q-1][1][1]),c.fillStyle=Math.round(A.right[q][0]/s)%2?J:L,c.fill(),c.stroke();c.beginPath(),c.fillStyle=J,c.rect(v,v,u,u),c.rect(v,g-u-v,u,u),c.rect(f-u-v,v,u,u),c.rect(f-u-v,g-u-v,u,u),c.fill()}c.restore()}};var p=o;c.default=p},{ol:162,"ol/Observable":31,"ol/control/Control":53,"ol/proj":210,"ol/proj.js":210,"ol/proj/Projection":211,"ol/style/Fill":322,"ol/style/Stroke":330,"ol/style/Style":331,"ol/style/Text":332}],4:[function(a,b,c){"use strict";function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(e,f){"object"==(void 0===c?"undefined":d(c))&&void 0!==b?b.exports=f(a("ol/layer/Vector"),a("ol/source/Vector"),a("ol/geom/Point"),a("ol/Feature"),a("ol/proj"),a("ol/control/Control"),a("ol/style/Style"),a("ol/style/Icon")):"function"==typeof define&&define.amd?define(["ol/layer/Vector","ol/source/Vector","ol/geom/Point","ol/Feature","ol/proj","ol/control/Control","ol/style/Style","ol/style/Icon"],f):e.Geocoder=f(e.ol.layer.Vector,e.ol.source.Vector,e.ol.geom.Point,e.ol.Feature,e.ol.proj,e.ol.control.Control,e.ol.style.Style,e.ol.style.Icon)}(void 0,function(a,b,c,e,f,g,h,i){function j(a,b){if(void 0===b&&(b="Assertion failed"),!a){if("undefined"!=typeof Error)throw new Error(b);throw b}}function k(a){var b=function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-a}}return window.performance.now()}().toString(36);return a?a+b:b}function l(a){return/^\d+$/.test(a)}function m(a,b,c){if(Array.isArray(a))return void a.forEach(function(a){return m(a,b)});for(var d=Array.isArray(b)?b:b.split(/\s+/),e=d.length;e--;)o(a,d[e])||t(a,d[e],c)}function n(a,b,c){if(Array.isArray(a))return void a.forEach(function(a){return n(a,b,c)});for(var d=Array.isArray(b)?b:b.split(/\s+/),e=d.length;e--;)o(a,d[e])&&u(a,d[e],c)}function o(a,b){return a.classList?a.classList.contains(b):s(b).test(a.className)}function p(a,b,c){void 0===b&&(b=window.document);var d=/\./g,e=Array.prototype.slice,f=[];if(/^(#?[\w-]+|\.[\w-.]+)$/.test(a))switch(a[0]){case"#":f=[(g=a.substr(1),g="#"===g[0]?g.substr(1,g.length):g,document.getElementById(g))];break;case".":f=e.call(b.getElementsByClassName(a.substr(1).replace(d," ")));break;default:f=e.call(b.getElementsByTagName(a))}else f=e.call(b.querySelectorAll(a));var g;return c?f:f[0]}function q(a,b){return a.replace(/\{ *([\w_-]+) *\}/g,function(a,c){var d=void 0===b[c]?"":b[c];return String(d).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")})}function r(a,b){var c;if(Array.isArray(a)){if(c=document.createElement(a[0]),a[1].id&&(c.id=a[1].id),a[1].classname&&(c.className=a[1].classname),a[1].attr){var d=a[1].attr;if(Array.isArray(d))for(var e=-1;++e<d.length;)c.setAttribute(d[e].name,d[e].value);else c.setAttribute(d.name,d.value)}}else c=document.createElement(a);c.innerHTML=b;for(var f=document.createDocumentFragment();c.childNodes[0];)f.appendChild(c.childNodes[0]);return c.appendChild(f),c}function s(a){return new RegExp("(^|\\s+) "+a+" (\\s+|$)")}function t(a,b,c){a.classList?a.classList.add(b):a.className=(a.className+" "+b).trim(),c&&l(c)&&window.setTimeout(function(){return u(a,b)},c)}function u(a,b,c){a.classList?a.classList.remove(b):a.className=a.className.replace(s(b)," ").trim(),c&&l(c)&&window.setTimeout(function(){return t(a,b)},c)}function v(a){return new Promise(function(b,c){var e=function(a,b){return b&&"object"==d(b)&&(a+=(/\?/.test(a)?"&":"?")+function a(b){return Object.keys(b).reduce(function(c,e){return c.push("object"==d(b[e])?a(b[e]):encodeURIComponent(e)+"="+encodeURIComponent(b[e])),c},[]).join("&")}(b)),a}(a.url,a.data),f={method:"GET",mode:"cors",credentials:"same-origin"};a.jsonp?function(a,b,c){var d=document.head,e=document.createElement("script"),f="f"+Math.round(Math.random()*Date.now());e.setAttribute("src",a+(a.indexOf("?")>0?"&":"?")+b+"="+f),window[f]=function(a){window[f]=void 0,setTimeout(function(){return d.removeChild(e)},0),c(a)},d.appendChild(e)}(e,a.callbackName,b):fetch(e,f).then(function(a){return a.json()}).then(b).catch(c)})}a=a&&a.hasOwnProperty("default")?a.default:a,b=b&&b.hasOwnProperty("default")?b.default:b,c=c&&c.hasOwnProperty("default")?c.default:c,e=e&&e.hasOwnProperty("default")?e.default:e,f=f&&f.hasOwnProperty("default")?f.default:f,g=g&&g.hasOwnProperty("default")?g.default:g,h=h&&h.hasOwnProperty("default")?h.default:h,i=i&&i.hasOwnProperty("default")?i.default:i;var w={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},x={containerId:"gcd-container",buttonControlId:"gcd-button-control",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",cssClasses:w},y=Object.freeze({containerId:"gcd-container",buttonControlId:"gcd-button-control",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",cssClasses:w,default:x}),z="addresschosen",A={NOMINATIM:"nominatim",REVERSE:"reverse"},B="glass-button",C="//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png",D="osm",E="mapquest",F="photon",G="bing",H="opencage",I="pelias",J={provider:D,placeholder:"Search for an address",featureStyle:null,targetType:B,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,debug:!1},K=y.cssClasses,L=function(a){this.options=a.options,this.els=this.createControl()};L.prototype.createControl=function(){var a,b,c;return"text-input"===this.options.targetType?(b=K.namespace+" "+K.inputText.container,c={container:a=r(["div",{id:y.containerId,classname:b}],L.input),control:p("."+K.inputText.control,a),input:p("."+K.inputText.input,a),reset:p("."+K.inputText.reset,a),result:p("."+K.inputText.result,a)}):(b=K.namespace+" "+K.glass.container,c={container:a=r(["div",{id:y.containerId,classname:b}],L.glass),control:p("."+K.glass.control,a),button:p("."+K.glass.button,a),input:p("."+K.glass.input,a),reset:p("."+K.glass.reset,a),result:p("."+K.glass.result,a)}),c.input.placeholder=this.options.placeholder,c},L.glass=['<div class="',K.glass.control," ",K.olControl,'">','<button type="button"',' id="',y.buttonControlId,'"',' class="',K.glass.button,'"></button>','<input type="text"',' id="',y.inputQueryId,'"',' class="',K.glass.input,'"',' autocomplete="off" placeholder="Search ...">',"<a",' id="',y.inputResetId,'"',' class="',K.glass.reset," ",K.hidden,'"',"></a>","</div>",'<ul class="',K.glass.result,'"></ul>'].join(""),L.input=['<div class="',K.inputText.control,'">','<input type="text"',' id="',y.inputQueryId,'"',' class="',K.inputText.input,'"',' autocomplete="off" placeholder="Search ...">','<span class="',K.inputText.icon,'"></span>','<button type="button"',' id="',y.inputResetId,'"',' class="',K.inputText.reset," ",K.hidden,'"',"></button>","</div>",'<ul class="',K.inputText.result,'"></ul>'].join("");var M=function(){this.settings={url:"https://photon.komoot.de/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}};M.prototype.getParameters=function(a){return a.lang=a.lang.toLowerCase(),{url:this.settings.url,params:{q:a.query,limit:a.limit||this.settings.params.limit,lang:this.settings.langs.indexOf(a.lang)>-1?a.lang:this.settings.params.lang}}},M.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.geometry.coordinates[0],lat:a.geometry.coordinates[1],address:{name:a.properties.name,postcode:a.properties.postcode,city:a.properties.city,state:a.properties.state,country:a.properties.country},original:{formatted:a.properties.name,details:a.properties}}})};var N=function(){this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}};N.prototype.getParameters=function(a){return{url:this.settings.url,params:{q:a.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:a.limit||this.settings.params.limit,countrycodes:a.countrycodes||this.settings.params.countrycodes,"accept-language":a.lang||this.settings.params["accept-language"]}}},
N.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.lon,lat:a.lat,address:{name:a.display_name,road:a.address.road||"",houseNumber:a.address.house_number||"",postcode:a.address.postcode,city:a.address.city||a.address.town,state:a.address.state,country:a.address.country},original:{formatted:a.display_name,details:a.address}}})};var O=function(){this.settings={url:"http://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}};O.prototype.getParameters=function(a){return{url:this.settings.url,params:{q:a.query,key:a.key,format:"json",addressdetails:1,limit:a.limit||this.settings.params.limit,countrycodes:a.countrycodes||this.settings.params.countrycodes,"accept-language":a.lang||this.settings.params["accept-language"]}}},O.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.lon,lat:a.lat,address:{name:a.address.neighbourhood||"",road:a.address.road||"",postcode:a.address.postcode,city:a.address.city||a.address.town,state:a.address.state,country:a.address.country},original:{formatted:a.display_name,details:a.address}}})};var P=function(){this.settings={url:"http://search.mapzen.com/v1/search",params:{size:10}}};P.prototype.getParameters=function(a){return{url:this.settings.url,params:{text:a.query,api_key:a.key,size:a.limit||this.settings.params.size}}},P.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.geometry.coordinates[0],lat:a.geometry.coordinates[1],address:{name:a.properties.name,house_number:a.properties.housenumber,postcode:a.properties.postalcode,road:a.properties.street,city:a.properties.city,state:a.properties.region,country:a.properties.country},original:{formatted:a.properties.label,details:a.properties}}})};var Q=function(){this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}};Q.prototype.getParameters=function(a){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:a.query,key:a.key,includeNeighborhood:a.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:a.maxResults||this.settings.params.maxResults}}},Q.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.point.coordinates[1],lat:a.point.coordinates[0],address:{name:a.name},original:{formatted:a.address.formattedAddress,details:a.address}}})};var R=function(){this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}};R.prototype.getParameters=function(a){return{url:this.settings.url,params:{q:a.query,key:a.key,limit:a.limit||this.settings.params.limit,countrycode:a.countrycodes||this.settings.params.countrycodes}}},R.prototype.handleResponse=function(a){return a.map(function(a){return{lon:a.geometry.lng,lat:a.geometry.lat,address:{name:a.components.house_number||"",road:a.components.road||"",postcode:a.components.postcode,city:a.components.city||a.components.town,state:a.components.state,country:a.components.country},original:{formatted:a.formatted,details:a.components}}})};var S=y.cssClasses,T=function(c,d){this.Base=c,this.layerName=k("geocoder-layer-"),this.layer=new a({name:this.layerName,source:new b}),this.options=c.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.els=d,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners(),this.Photon=new M,this.OpenStreet=new N,this.MapQuest=new O,this.Pelias=new P,this.Bing=new Q,this.OpenCage=new R};return T.prototype.setListeners=function(){var a,b,c=this,d=function(){o(c.els.control,S.glass.expanded)?c.collapse():c.expand()};this.els.input.addEventListener("keypress",function(a){var b=a.target.value.trim();(a.key?"Enter"===a.key:a.which?13===a.which:a.keyCode&&13===a.keyCode)&&(a.preventDefault(),c.query(b))},!1),this.els.input.addEventListener("input",function(d){var e=d.target.value.trim();e.length?n(c.els.reset,S.hidden):m(c.els.reset,S.hidden),c.options.autoComplete&&e!==b&&(b=e,a&&clearTimeout(a),a=setTimeout(function(){e.length>=c.options.autoCompleteMinLength&&c.query(e)},200))},!1),this.els.reset.addEventListener("click",function(a){c.els.input.focus(),c.els.input.value="",c.lastQuery="",m(c.els.reset,S.hidden),c.clearResults()},!1),this.options.targetType===B&&this.els.button.addEventListener("click",d,!1)},T.prototype.query=function(a){var b=this,c=this.getProvider({query:a,provider:this.options.provider,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});if(this.lastQuery!==a||!this.els.result.firstChild){this.lastQuery=a,this.clearResults(),m(this.els.reset,S.spin);var d={url:c.url,data:c.params};c.callbackName&&(d.jsonp=!0,d.callbackName=c.callbackName),v(d).then(function(a){var c;switch(b.options.debug&&console.info(a),n(b.els.reset,S.spin),b.options.provider){case D:c=a.length?b.OpenStreet.handleResponse(a):void 0;break;case E:c=a.length?b.MapQuest.handleResponse(a):void 0;break;case I:c=a.features.length?b.Pelias.handleResponse(a.features):void 0;break;case F:c=a.features.length?b.Photon.handleResponse(a.features):void 0;break;case G:c=a.resourceSets[0].resources.length?b.Bing.handleResponse(a.resourceSets[0].resources):void 0;break;case H:c=a.results.length?b.OpenCage.handleResponse(a.results):void 0;break;default:c=b.options.provider.handleResponse(a)}c&&(b.createList(c),b.listenMapClick())}).catch(function(a){n(b.els.reset,S.spin);var c=r("li","<h5>Error! No internet connection?</h5>");b.els.result.appendChild(c)})}},T.prototype.createList=function(a){var b=this,c=this.els.result;a.forEach(function(a){var d;switch(b.options.provider){case D:d='<span class="'+S.road+'">'+a.address.name+"</span>";break;default:d=b.addressTemplate(a.address)}var e=r("li",'<a href="#">'+d+"</a>");e.addEventListener("click",function(c){c.preventDefault(),b.chosen(a,d,a.address,a.original)},!1),c.appendChild(e)})},T.prototype.chosen=function(a,b,c,d){var e=this.Base.getMap(),g=[parseFloat(a.lon),parseFloat(a.lat)],h=e.getView().getProjection(),i=f.transform(g,"EPSG:4326",h),j=a.bbox;j&&(j=f.transformExtent(j,"EPSG:4326",h));var k={formatted:b,details:c,original:d};if(!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault)this.Base.dispatchEvent({type:z,address:k,coordinate:i,bbox:j});else{j?e.getView().fit(j,{duration:500}):function(a,b,c,d){d=d||2.388657133911758,c=c||500,a.getView().animate({duration:c,resolution:d},{duration:c,center:b})}(e,i);var l=this.createFeature(i,k);this.Base.dispatchEvent({type:z,address:k,feature:l,coordinate:i,bbox:j})}},T.prototype.createFeature=function(a){var b=new e(new c(a));return this.addLayer(),b.setStyle(this.options.featureStyle),b.setId(k("geocoder-ft-")),this.getSource().addFeature(b),b},T.prototype.addressTemplate=function(a){var b=[];return a.name&&b.push(['<span class="',S.road,'">{name}</span>'].join("")),(a.road||a.building||a.house_number)&&b.push(['<span class="',S.road,'">{building} {road} {house_number}</span>'].join("")),(a.city||a.town||a.village)&&b.push(['<span class="',S.city,'">{postcode} {city} {town} {village}</span>'].join("")),(a.state||a.country)&&b.push(['<span class="',S.country,'">{state} {country}</span>'].join("")),q(b.join("<br>"),a)},T.prototype.getProvider=function(a){var b;switch(a.provider){case D:b=this.OpenStreet.getParameters(a);break;case E:b=this.MapQuest.getParameters(a);break;case F:b=this.Photon.getParameters(a);break;case I:b=this.Pelias.getParameters(a);break;case G:b=this.Bing.getParameters(a);break;case H:b=this.OpenCage.getParameters(a);break;default:b=a.provider.getParameters(a)}return b},T.prototype.expand=function(){var a=this;n(this.els.input,S.spin),m(this.els.control,S.glass.expanded),window.setTimeout(function(){return a.els.input.focus()},100),this.listenMapClick()},T.prototype.collapse=function(){this.els.input.value="",this.els.input.blur(),m(this.els.reset,S.hidden),n(this.els.control,S.glass.expanded),this.clearResults()},T.prototype.listenMapClick=function(){if(!this.registeredListeners.mapClick){var a=this,b=this.Base.getMap().getTargetElement();this.registeredListeners.mapClick=!0,b.addEventListener("click",{handleEvent:function(c){a.clearResults(!0),b.removeEventListener(c.type,this,!1),a.registeredListeners.mapClick=!1}},!1)}},T.prototype.clearResults=function(a){a&&this.options.targetType===B?this.collapse():function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}(this.els.result)},T.prototype.getSource=function(){return this.layer.getSource()},T.prototype.addLayer=function(){var a=this,b=!1,c=this.Base.getMap();c.getLayers().forEach(function(c){c===a.layer&&(b=!0)}),b||c.addLayer(this.layer)},function(a){function b(c,e){if(void 0===c&&(c=A.NOMINATIM),void 0===e&&(e={}),!(this instanceof b))return new b;var f;j("string"==typeof c,"@param `type` should be string!"),j(c===A.NOMINATIM||c===A.REVERSE,"@param 'type' should be '"+A.NOMINATIM+"'\n        or '"+A.REVERSE+"'!"),j("object"==d(e),"@param `options` should be object!"),J.featureStyle=[new h({image:new i({scale:.7,src:C})})],this.options=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}(J,e),this.container=void 0;var g=new L(this);c===A.NOMINATIM&&(this.container=g.els.container,f=new T(this,g.els),this.layer=f.layer),a.call(this,{element:this.container})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getLayer=function(){return this.layer},b.prototype.getSource=function(){return this.getLayer().getSource()},b.prototype.setProvider=function(a){this.options.provider=a},b.prototype.setProviderKey=function(a){this.options.key=a},b}(g)})},{"ol/Feature":10,"ol/control/Control":53,"ol/geom/Point":138,"ol/layer/Vector":194,"ol/proj":210,"ol/source/Vector":304,"ol/style/Icon":323,"ol/style/Style":331}],5:[function(a,b,c){"use strict";function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(e,f){"object"===(void 0===c?"undefined":d(c))&&void 0!==b?b.exports=f(a("ol/control/Control"),a("ol/Observable")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/Observable"],f):e.LayerSwitcher=f(e.ol.control.Control,e.ol.Observable)}(void 0,function(a,b){a="default"in a?a.default:a,b="default"in b?b.default:b;var c=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},g=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+d(b));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},h=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==d(b)&&"function"!=typeof b?a:b},i=function(a){function d(a){c(this,d);var b=a||{},e=b.tipLabel?b.tipLabel:"Legend",f=document.createElement("div"),g=h(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,{element:f,target:b.target}));g.mapListeners=[],g.hiddenClassName="ol-unselectable ol-control layer-switcher",d.isTouchDevice_()&&(g.hiddenClassName+=" touch"),g.shownClassName="shown",f.className=g.hiddenClassName;var i=document.createElement("button");i.setAttribute("title",e),f.appendChild(i),g.panel=document.createElement("div"),g.panel.className="panel",f.appendChild(g.panel),d.enableTouchScroll_(g.panel);var j=g;return i.onmouseover=function(a){j.showPanel()},i.onclick=function(a){a=a||window.event,j.showPanel(),a.preventDefault()},j.panel.onmouseout=function(a){a=a||window.event,j.panel.contains(a.toElement||a.relatedTarget)||j.hidePanel()},g}return g(d,a),e(d,[{key:"setMap",value:function(a){for(var c=0;c<this.mapListeners.length;c++)b.unByKey(this.mapListeners[c]);if(this.mapListeners.length=0,f(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"setMap",this).call(this,a),a){var e=this;this.mapListeners.push(a.on("pointerdown",function(){e.hidePanel()})),this.renderPanel()}}},{key:"showPanel",value:function(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.renderPanel())}},{key:"hidePanel",value:function(){this.element.classList.contains(this.shownClassName)&&this.element.classList.remove(this.shownClassName)}},{key:"renderPanel",value:function(){d.renderPanel(this.getMap(),this.panel)}}],[{key:"renderPanel",value:function(a,b){for(d.ensureTopVisibleBaseLayerShown_(a);b.firstChild;)b.removeChild(b.firstChild);var c=document.createElement("ul");b.appendChild(c),d.renderLayers_(a,a,c)}},{key:"ensureTopVisibleBaseLayerShown_",value:function(a){var b;d.forEachRecursive(a,function(a,c,d){"base"===a.get("type")&&a.getVisible()&&(b=a)}),b&&d.setVisible_(a,b,!0)}},{key:"setVisible_",value:function(a,b,c){b.setVisible(c),c&&"base"===b.get("type")&&d.forEachRecursive(a,function(a,c,d){a!=b&&"base"===a.get("type")&&a.setVisible(!1)})}},{key:"renderLayer_",value:function(a,b,c){var e=document.createElement("li"),f=b.get("title"),g=d.uuid(),h=document.createElement("label");if(b.getLayers&&!b.get("combine")){e.className="group",h.innerHTML=f,e.appendChild(h);var i=document.createElement("ul");e.appendChild(i),d.renderLayers_(a,b,i)}else{e.className="layer";var j=document.createElement("input");"base"===b.get("type")?(j.type="radio",j.name="base"):j.type="checkbox",j.id=g,j.checked=b.get("visible"),j.onchange=function(c){d.setVisible_(a,b,c.target.checked)},e.appendChild(j),h.htmlFor=g,h.innerHTML=f;var k=a.getView().getResolution();(k>b.getMaxResolution()||k<b.getMinResolution())&&(h.className+=" disabled"),e.appendChild(h)}return e}},{key:"renderLayers_",value:function(a,b,c){for(var e,f=b.getLayers().getArray().slice().reverse(),g=0;g<f.length;g++)e=f[g],e.get("title")&&c.appendChild(d.renderLayer_(a,e,g))}},{key:"forEachRecursive",value:function(a,b){a.getLayers().forEach(function(a,c,e){b(a,c,e),a.getLayers&&d.forEachRecursive(a,b)})}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:3&b|8).toString(16)})}},{key:"enableTouchScroll_",value:function(a){if(d.isTouchDevice_()){var b=0;a.addEventListener("touchstart",function(a){b=this.scrollTop+a.touches[0].pageY},!1),a.addEventListener("touchmove",function(a){this.scrollTop=b-a.touches[0].pageY},!1)}}},{key:"isTouchDevice_",value:function(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}}}]),d}(a);return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=i),i})},{"ol/Observable":31,"ol/control/Control":53}],6:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("./util.js"),e=function(a){function b(b){var c=d.VERSION.split("-")[0],e="Assertion failed. See https://openlayers.org/en/"+c+"/doc/errors/#"+b+" for details.";a.call(this,e),this.code=b,this.name="AssertionError",this.message=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Error),f=e;c.default=f},{"./util.js":342}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.CollectionEvent=void 0;var e=d(a("./AssertionError.js")),f=d(a("./CollectionEventType.js")),g=d(a("./Object.js")),h=d(a("./events/Event.js")),i={LENGTH:"length"},j=function(a){function b(b,c){a.call(this,b),this.element=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default);c.CollectionEvent=j;var k=function(a){function b(b,c){var d=this;a.call(this);var e=c||{};if(this.unique_=!!e.unique,this.array_=b||[],this.unique_)for(var f=0,g=this.array_.length;f<g;++f)d.assertUnique_(d.array_[f],f);this.updateLength_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clear=function(){for(var a=this;this.getLength()>0;)a.pop()},b.prototype.extend=function(a){for(var b=this,c=0,d=a.length;c<d;++c)b.push(a[c]);return this},b.prototype.forEach=function(a){for(var b=this.array_,c=0,d=b.length;c<d;++c)a(b[c],c,b)},b.prototype.getArray=function(){return this.array_},b.prototype.item=function(a){return this.array_[a]},b.prototype.getLength=function(){return this.get(i.LENGTH)},b.prototype.insertAt=function(a,b){this.unique_&&this.assertUnique_(b),this.array_.splice(a,0,b),this.updateLength_(),this.dispatchEvent(new j(f.default.ADD,b))},b.prototype.pop=function(){return this.removeAt(this.getLength()-1)},b.prototype.push=function(a){this.unique_&&this.assertUnique_(a);var b=this.getLength();return this.insertAt(b,a),this.getLength()},b.prototype.remove=function(a){for(var b=this,c=this.array_,d=0,e=c.length;d<e;++d)if(c[d]===a)return b.removeAt(d)},b.prototype.removeAt=function(a){var b=this.array_[a];return this.array_.splice(a,1),this.updateLength_(),this.dispatchEvent(new j(f.default.REMOVE,b)),b},b.prototype.setAt=function(a,b){var c=this,d=this.getLength();if(a<d){this.unique_&&this.assertUnique_(b,a);var e=this.array_[a];this.array_[a]=b,this.dispatchEvent(new j(f.default.REMOVE,e)),this.dispatchEvent(new j(f.default.ADD,b))}else{for(var g=d;g<a;++g)c.insertAt(g,void 0);this.insertAt(a,b)}},b.prototype.updateLength_=function(){this.set(i.LENGTH,this.array_.length)},b.prototype.assertUnique_=function(a,b){for(var c=this,d=0,f=this.array_.length;d<f;++d)if(c.array_[d]===a&&d!==b)throw new e.default(58)},b}(g.default),l=k;c.default=l},{"./AssertionError.js":6,"./CollectionEventType.js":8,"./Object.js":29,"./events/Event.js":67}],8:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ADD:"add",REMOVE:"remove"};c.default=d},{}],9:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){this.disposed_=!1};d.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},d.prototype.disposeInternal=function(){};var e=d;c.default=e},{}],10:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){if("function"==typeof a)return a;var b;return Array.isArray(a)?b=a:((0,g.assert)(a instanceof l.default,41),b=[a]),function(){return b}}Object.defineProperty(c,"__esModule",{value:!0}),c.createStyleFunction=f,c.default=void 0;var g=a("./asserts.js"),h=a("./events.js"),i=e(a("./events/EventType.js")),j=d(a("./Object.js")),k=e(a("./geom/Geometry.js")),l=e(a("./style/Style.js")),m=function(a){function b(b){if(a.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,(0,h.listen)(this,(0,j.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),void 0!==b)if(b instanceof k.default||!b){var c=b;this.setGeometry(c)}else{var d=b;this.setProperties(d)}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){var a=new b(this.getProperties());a.setGeometryName(this.getGeometryName());var c=this.getGeometry();c&&a.setGeometry(c.clone());var d=this.getStyle();return d&&a.setStyle(d),a},b.prototype.getGeometry=function(){return this.get(this.geometryName_)},b.prototype.getId=function(){return this.id_},b.prototype.getGeometryName=function(){return this.geometryName_},b.prototype.getStyle=function(){return this.style_},b.prototype.getStyleFunction=function(){return this.styleFunction_},b.prototype.handleGeometryChange_=function(){this.changed()},b.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&((0,h.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);var a=this.getGeometry();a&&(this.geometryChangeKey_=(0,h.listen)(a,i.default.CHANGE,this.handleGeometryChange_,this)),this.changed()},b.prototype.setGeometry=function(a){this.set(this.geometryName_,a)},b.prototype.setStyle=function(a){this.style_=a,this.styleFunction_=a?f(a):void 0,this.changed()},b.prototype.setId=function(a){this.id_=a,this.changed()},b.prototype.setGeometryName=function(a){(0,h.unlisten)(this,(0,j.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=a,(0,h.listen)(this,(0,j.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},b}(j.default),n=m;c.default=n},{"./Object.js":29,"./asserts.js":47,"./events.js":66,"./events/EventType.js":68,"./geom/Geometry.js":129,"./style/Style.js":331}],11:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("./GeolocationProperty.js")),g=d(a("./Object.js")),h=a("./events.js"),i=e(a("./events/EventType.js")),j=a("./geom/Polygon.js"),k=a("./has.js"),l=a("./math.js"),m=a("./proj.js"),n=function(a){function b(b){a.call(this);var c=b||{};this.position_=null,this.transform_=m.identityTransform,this.watchId_=void 0,(0,h.listen)(this,(0,g.getChangeEventType)(f.default.PROJECTION),this.handleProjectionChanged_,this),(0,h.listen)(this,(0,g.getChangeEventType)(f.default.TRACKING),this.handleTrackingChanged_,this),void 0!==c.projection&&this.setProjection(c.projection),void 0!==c.trackingOptions&&this.setTrackingOptions(c.trackingOptions),this.setTracking(void 0!==c.tracking&&c.tracking)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.setTracking(!1),a.prototype.disposeInternal.call(this)},b.prototype.handleProjectionChanged_=function(){var a=this.getProjection();a&&(this.transform_=(0,m.getTransformFromProjections)((0,m.get)("EPSG:4326"),a),this.position_&&this.set(f.default.POSITION,this.transform_(this.position_)))},b.prototype.handleTrackingChanged_=function(){if(k.GEOLOCATION){var a=this.getTracking();a&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):a||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},b.prototype.positionChange_=function(a){var b=a.coords;this.set(f.default.ACCURACY,b.accuracy),this.set(f.default.ALTITUDE,null===b.altitude?void 0:b.altitude),this.set(f.default.ALTITUDE_ACCURACY,null===b.altitudeAccuracy?void 0:b.altitudeAccuracy),this.set(f.default.HEADING,null===b.heading?void 0:(0,l.toRadians)(b.heading)),this.position_?(this.position_[0]=b.longitude,this.position_[1]=b.latitude):this.position_=[b.longitude,b.latitude];var c=this.transform_(this.position_);this.set(f.default.POSITION,c),this.set(f.default.SPEED,null===b.speed?void 0:b.speed);var d=(0,j.circular)(this.position_,b.accuracy);d.applyTransform(this.transform_),this.set(f.default.ACCURACY_GEOMETRY,d),this.changed()},b.prototype.positionError_=function(a){a.type=i.default.ERROR,this.setTracking(!1),this.dispatchEvent(a)},b.prototype.getAccuracy=function(){return this.get(f.default.ACCURACY)},b.prototype.getAccuracyGeometry=function(){return this.get(f.default.ACCURACY_GEOMETRY)||null},b.prototype.getAltitude=function(){return this.get(f.default.ALTITUDE)},b.prototype.getAltitudeAccuracy=function(){return this.get(f.default.ALTITUDE_ACCURACY)},b.prototype.getHeading=function(){return this.get(f.default.HEADING)},b.prototype.getPosition=function(){return this.get(f.default.POSITION)},b.prototype.getProjection=function(){return this.get(f.default.PROJECTION)},b.prototype.getSpeed=function(){return this.get(f.default.SPEED)},b.prototype.getTracking=function(){return this.get(f.default.TRACKING)},b.prototype.getTrackingOptions=function(){return this.get(f.default.TRACKING_OPTIONS)},b.prototype.setProjection=function(a){this.set(f.default.PROJECTION,(0,m.get)(a))},b.prototype.setTracking=function(a){this.set(f.default.TRACKING,a)},b.prototype.setTrackingOptions=function(a){this.set(f.default.TRACKING_OPTIONS,a)},b}(g.default),o=n;c.default=o},{"./GeolocationProperty.js":12,"./Object.js":29,"./events.js":66,"./events/EventType.js":68,"./geom/Polygon.js":139,"./has.js":161,"./math.js":199,"./proj.js":210}],12:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"};c.default=d},{}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./coordinate.js"),f=a("./events.js"),g=a("./extent.js"),h=d(a("./geom/GeometryLayout.js")),i=d(a("./geom/LineString.js")),j=d(a("./geom/Point.js")),k=a("./geom/flat/geodesic.js"),l=a("./math.js"),m=a("./proj.js"),n=d(a("./render/EventType.js")),o=d(a("./style/Fill.js")),p=d(a("./style/Stroke.js")),q=d(a("./style/Text.js")),r=new p.default({color:"rgba(0,0,0,0.2)"}),s=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],t=function(a){var b=a||{};this.map_=null,this.postcomposeListenerKey_=null,this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxLatP_=1/0,this.maxLonP_=1/0,this.minLatP_=-1/0,this.minLonP_=-1/0,this.targetSize_=void 0!==b.targetSize?b.targetSize:100,this.maxLines_=void 0!==b.maxLines?b.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=void 0!==b.strokeStyle?b.strokeStyle:r,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,1==b.showLabels&&(this.lonLabelFormatter_=void 0==b.lonLabelFormatter?e.degreesToStringHDMS.bind(this,"EW"):b.lonLabelFormatter,this.latLabelFormatter_=void 0==b.latLabelFormatter?e.degreesToStringHDMS.bind(this,"NS"):b.latLabelFormatter,this.lonLabelPosition_=void 0==b.lonLabelPosition?0:b.lonLabelPosition,this.latLabelPosition_=void 0==b.latLabelPosition?1:b.latLabelPosition,this.lonLabelStyle_=void 0!==b.lonLabelStyle?b.lonLabelStyle:new q.default({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new o.default({color:"rgba(0,0,0,1)"}),stroke:new p.default({color:"rgba(255,255,255,1)",width:3})}),this.latLabelStyle_=void 0!==b.latLabelStyle?b.latLabelStyle:new q.default({font:"12px Calibri,sans-serif",textAlign:"end",fill:new o.default({color:"rgba(0,0,0,1)"}),stroke:new p.default({color:"rgba(255,255,255,1)",width:3})}),this.meridiansLabels_=[],this.parallelsLabels_=[]),this.setMap(void 0!==b.map?b.map:null)};t.prototype.addMeridian_=function(a,b,c,d,e,f){var h=this.getMeridian_(a,b,c,d,f);if((0,g.intersects)(h.getExtent(),e)){if(this.meridiansLabels_){var i=this.getMeridianPoint_(h,e,f);this.meridiansLabels_[f]={geom:i,text:this.lonLabelFormatter_(a)}}this.meridians_[f++]=h}return f},t.prototype.getMeridianPoint_=function(a,b,c){var d,e=a.getFlatCoordinates(),f=Math.max(b[1],e[1]),g=Math.min(b[3],e[e.length-1]),h=(0,l.clamp)(b[1]+Math.abs(b[1]-b[3])*this.lonLabelPosition_,f,g),i=[e[0],h];return c in this.meridiansLabels_?(d=this.meridiansLabels_[c].geom,d.setCoordinates(i)):d=new j.default(i),d},t.prototype.addParallel_=function(a,b,c,d,e,f){var h=this.getParallel_(a,b,c,d,f);if((0,g.intersects)(h.getExtent(),e)){if(this.parallelsLabels_){var i=this.getParallelPoint_(h,e,f);this.parallelsLabels_[f]={geom:i,text:this.latLabelFormatter_(a)}}this.parallels_[f++]=h}return f},t.prototype.getParallelPoint_=function(a,b,c){var d,e=a.getFlatCoordinates(),f=Math.max(b[0],e[0]),g=Math.min(b[2],e[e.length-2]),h=(0,l.clamp)(b[0]+Math.abs(b[0]-b[2])*this.latLabelPosition_,f,g),i=[h,e[1]];return c in this.parallelsLabels_?(d=this.parallelsLabels_[c].geom,d.setCoordinates(i)):d=new j.default(i),d},t.prototype.createGraticule_=function(a,b,c,d){var e=this,f=this.getInterval_(c);if(-1==f)return this.meridians_.length=this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var g,h,i,j,k=this.toLonLatTransform_(b),n=k[0],o=k[1],p=this.maxLines_,q=[Math.max(a[0],this.minLonP_),Math.max(a[1],this.minLatP_),Math.min(a[2],this.maxLonP_),Math.min(a[3],this.maxLatP_)];q=(0,m.transformExtent)(q,this.projection_,"EPSG:4326");var r=q[3],s=q[2],t=q[1],u=q[0];for(n=Math.floor(n/f)*f,j=(0,l.clamp)(n,this.minLon_,this.maxLon_),h=this.addMeridian_(j,t,r,d,a,0),g=0;j!=this.minLon_&&g++<p;)j=Math.max(j-f,e.minLon_),h=e.addMeridian_(j,t,r,d,a,h);for(j=(0,l.clamp)(n,this.minLon_,this.maxLon_),g=0;j!=this.maxLon_&&g++<p;)j=Math.min(j+f,e.maxLon_),h=e.addMeridian_(j,t,r,d,a,h);for(this.meridians_.length=h,this.meridiansLabels_&&(this.meridiansLabels_.length=h),o=Math.floor(o/f)*f,i=(0,l.clamp)(o,this.minLat_,this.maxLat_),h=this.addParallel_(i,u,s,d,a,0),g=0;i!=this.minLat_&&g++<p;)i=Math.max(i-f,e.minLat_),h=e.addParallel_(i,u,s,d,a,h);for(i=(0,l.clamp)(o,this.minLat_,this.maxLat_),g=0;i!=this.maxLat_&&g++<p;)i=Math.min(i+f,e.maxLat_),h=e.addParallel_(i,u,s,d,a,h);this.parallels_.length=h,this.parallelsLabels_&&(this.parallelsLabels_.length=h)},t.prototype.getInterval_=function(a){for(var b=this,c=this.projectionCenterLonLat_[0],d=this.projectionCenterLonLat_[1],e=-1,f=Math.pow(this.targetSize_*a,2),g=[],h=[],i=0,j=s.length;i<j;++i){var k=s[i]/2;g[0]=c-k,g[1]=d-k,h[0]=c+k,h[1]=d+k,b.fromLonLatTransform_(g,g),b.fromLonLatTransform_(h,h);if(Math.pow(h[0]-g[0],2)+Math.pow(h[1]-g[1],2)<=f)break;e=s[i]}return e},t.prototype.getMap=function(){return this.map_},t.prototype.getMeridian_=function(a,b,c,d,e){var f=(0,k.meridian)(a,b,c,this.projection_,d),g=this.meridians_[e];return g?(g.setFlatCoordinates(h.default.XY,f),g.changed()):g=this.meridians_[e]=new i.default(f,h.default.XY),g},t.prototype.getMeridians=function(){return this.meridians_},t.prototype.getParallel_=function(a,b,c,d,e){var f=(0,k.parallel)(a,b,c,this.projection_,d),g=this.parallels_[e];return g?(g.setFlatCoordinates(h.default.XY,f),g.changed()):g=new i.default(f,h.default.XY),g},t.prototype.getParallels=function(){return this.parallels_},t.prototype.handlePostCompose_=function(a){var b=this,c=a.vectorContext,d=a.frameState,e=d.extent,f=d.viewState,g=f.center,h=f.projection,i=f.resolution,j=d.pixelRatio,k=i*i/(4*j*j);(!this.projection_||!(0,m.equivalent)(this.projection_,h))&&this.updateProjectionInfo_(h),this.createGraticule_(e,g,i,k),c.setFillStrokeStyle(null,this.strokeStyle_);var l,n,o
;for(l=0,n=this.meridians_.length;l<n;++l)o=b.meridians_[l],c.drawGeometry(o);for(l=0,n=this.parallels_.length;l<n;++l)o=b.parallels_[l],c.drawGeometry(o);var p;if(this.meridiansLabels_)for(l=0,n=this.meridiansLabels_.length;l<n;++l)p=b.meridiansLabels_[l],b.lonLabelStyle_.setText(p.text),c.setTextStyle(b.lonLabelStyle_),c.drawGeometry(p.geom);if(this.parallelsLabels_)for(l=0,n=this.parallelsLabels_.length;l<n;++l)p=b.parallelsLabels_[l],b.latLabelStyle_.setText(p.text),c.setTextStyle(b.latLabelStyle_),c.drawGeometry(p.geom)},t.prototype.updateProjectionInfo_=function(a){var b=(0,m.get)("EPSG:4326"),c=a.getWorldExtent(),d=(0,m.transformExtent)(c,b,a);this.maxLat_=c[3],this.maxLon_=c[2],this.minLat_=c[1],this.minLon_=c[0],this.maxLatP_=d[3],this.maxLonP_=d[2],this.minLatP_=d[1],this.minLonP_=d[0],this.fromLonLatTransform_=(0,m.getTransform)(b,a),this.toLonLatTransform_=(0,m.getTransform)(a,b),this.projectionCenterLonLat_=this.toLonLatTransform_((0,g.getCenter)(a.getExtent())),this.projection_=a},t.prototype.setMap=function(a){this.map_&&((0,f.unlistenByKey)(this.postcomposeListenerKey_),this.postcomposeListenerKey_=null,this.map_.render()),a&&(this.postcomposeListenerKey_=(0,f.listen)(a,n.default.POSTCOMPOSE,this.handlePostCompose_,this),a.render()),this.map_=a};var u=t;c.default=u},{"./coordinate.js":62,"./events.js":66,"./extent.js":72,"./geom/GeometryLayout.js":131,"./geom/LineString.js":133,"./geom/Point.js":138,"./geom/flat/geodesic.js":147,"./math.js":199,"./proj.js":210,"./render/EventType.js":220,"./style/Fill.js":322,"./style/Stroke.js":330,"./style/Text.js":332}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./ImageBase.js")),f=d(a("./ImageState.js")),g=a("./events.js"),h=d(a("./events/EventType.js")),i=a("./extent.js"),j=function(a){function b(b,c,d,e,g,h){a.call(this,b,c,d,f.default.IDLE),this.src_=e,this.image_=new Image,null!==g&&(this.image_.crossOrigin=g),this.imageListenerKeys_=null,this.state=f.default.IDLE,this.imageLoadFunction_=h}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){return this.image_},b.prototype.handleImageError_=function(){this.state=f.default.ERROR,this.unlistenImage_(),this.changed()},b.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=(0,i.getHeight)(this.extent)/this.image_.height),this.state=f.default.LOADED,this.unlistenImage_(),this.changed()},b.prototype.load=function(){this.state!=f.default.IDLE&&this.state!=f.default.ERROR||(this.state=f.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,g.listenOnce)(this.image_,h.default.ERROR,this.handleImageError_,this),(0,g.listenOnce)(this.image_,h.default.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},b.prototype.setImage=function(a){this.image_=a},b.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(g.unlistenByKey),this.imageListenerKeys_=null},b}(e.default),k=j;c.default=k},{"./ImageBase.js":15,"./ImageState.js":17,"./events.js":66,"./events/EventType.js":68,"./extent.js":72}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./events/Target.js")),f=d(a("./events/EventType.js")),g=function(a){function b(b,c,d,e){a.call(this),this.extent=b,this.pixelRatio_=d,this.resolution=c,this.state=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.changed=function(){this.dispatchEvent(f.default.CHANGE)},b.prototype.getExtent=function(){return this.extent},b.prototype.getImage=function(){},b.prototype.getPixelRatio=function(){return this.pixelRatio_},b.prototype.getResolution=function(){return this.resolution},b.prototype.getState=function(){return this.state},b.prototype.load=function(){},b}(e.default),h=g;c.default=h},{"./events/EventType.js":68,"./events/Target.js":70}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./ImageBase.js")),f=d(a("./ImageState.js")),g=function(a){function b(b,c,d,e,g){var h=void 0!==g?f.default.IDLE:f.default.LOADED;a.call(this,b,c,d,h),this.loader_=void 0!==g?g:null,this.canvas_=e,this.error_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getError=function(){return this.error_},b.prototype.handleLoad_=function(a){a?(this.error_=a,this.state=f.default.ERROR):this.state=f.default.LOADED,this.changed()},b.prototype.load=function(){this.state==f.default.IDLE&&(this.state=f.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},b.prototype.getImage=function(){return this.canvas_},b}(e.default),h=g;c.default=h},{"./ImageBase.js":15,"./ImageState.js":17}],17:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IDLE:0,LOADING:1,LOADED:2,ERROR:3};c.default=d},{}],18:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){var a=(0,h.createCanvasContext2D)(1,1);return a.fillStyle="rgba(0,0,0,0)",a.fillRect(0,0,1,1),a.canvas}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a("./Tile.js")),g=d(a("./TileState.js")),h=a("./dom.js"),i=a("./events.js"),j=d(a("./events/EventType.js")),k=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,g),this.crossOrigin_=e,this.src_=d,this.image_=new Image,null!==e&&(this.image_.crossOrigin=e),this.imageListenerKeys_=null,this.tileLoadFunction_=f}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.state==g.default.LOADING&&(this.unlistenImage_(),this.image_=e()),this.interimTile&&this.interimTile.dispose(),this.state=g.default.ABORT,this.changed(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.image_},b.prototype.getKey=function(){return this.src_},b.prototype.handleImageError_=function(){this.state=g.default.ERROR,this.unlistenImage_(),this.image_=e(),this.changed()},b.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=g.default.LOADED:this.state=g.default.EMPTY,this.unlistenImage_(),this.changed()},b.prototype.load=function(){this.state==g.default.ERROR&&(this.state=g.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==g.default.IDLE&&(this.state=g.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,i.listenOnce)(this.image_,j.default.ERROR,this.handleImageError_,this),(0,i.listenOnce)(this.image_,j.default.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},b.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(i.unlistenByKey),this.imageListenerKeys_=null},b}(f.default),l=k;c.default=l},{"./Tile.js":35,"./TileState.js":39,"./dom.js":64,"./events.js":66,"./events/EventType.js":68}],19:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a,b,c){this.decay_=a,this.minVelocity_=b,this.delay_=c,this.points_=[],this.angle_=0,this.initialVelocity_=0};d.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},d.prototype.update=function(a,b){this.points_.push(a,b,Date.now())},d.prototype.end=function(){if(this.points_.length<6)return!1;var a=Date.now()-this.delay_,b=this.points_.length-3;if(this.points_[b+2]<a)return!1;for(var c=b-3;c>0&&this.points_[c+2]>a;)c-=3;var d=this.points_[b+2]-this.points_[c+2];if(d<1e3/60)return!1;var e=this.points_[b]-this.points_[c],f=this.points_[b+1]-this.points_[c+1];return this.angle_=Math.atan2(f,e),this.initialVelocity_=Math.sqrt(e*e+f*f)/d,this.initialVelocity_>this.minVelocity_},d.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},d.prototype.getAngle=function(){return this.angle_};var e=d;c.default=e},{}],20:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};c.default=d},{}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./PluggableMap.js")),f=a("./control/util.js"),g=a("./interaction.js"),h=a("./obj.js"),i=d(a("./renderer/canvas/ImageLayer.js")),j=d(a("./renderer/canvas/Map.js")),k=d(a("./renderer/canvas/TileLayer.js")),l=d(a("./renderer/canvas/VectorLayer.js")),m=d(a("./renderer/canvas/VectorTileLayer.js")),n=function(a){function b(b){b=(0,h.assign)({},b),b.controls||(b.controls=(0,f.defaults)()),b.interactions||(b.interactions=(0,g.defaults)()),a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createRenderer=function(){var a=new j.default(this);return a.registerLayerRenderers([i.default,k.default,l.default,m.default]),a},b}(e.default),o=n;c.default=o},{"./PluggableMap.js":34,"./control/util.js":61,"./interaction.js":163,"./obj.js":201,"./renderer/canvas/ImageLayer.js":255,"./renderer/canvas/Map.js":258,"./renderer/canvas/TileLayer.js":259,"./renderer/canvas/VectorLayer.js":260,"./renderer/canvas/VectorTileLayer.js":261}],22:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./MapEvent.js")),f=function(a){function b(b,c,d,e,f){a.call(this,b,c,f),this.originalEvent=d,this.pixel=c.getEventPixel(d),this.coordinate=c.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==e&&e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.preventDefault=function(){a.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},b.prototype.stopPropagation=function(){a.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},b}(e.default),g=f;c.default=g},{"./MapEvent.js":26}],23:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./has.js"),f=d(a("./MapBrowserEventType.js")),g=d(a("./MapBrowserPointerEvent.js")),h=a("./events.js"),i=d(a("./events/Target.js")),j=d(a("./pointer/EventType.js")),k=d(a("./pointer/PointerEventHandler.js")),l=function(a){function b(b,c){a.call(this),this.map_=b,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=c?c*e.DEVICE_PIXEL_RATIO:e.DEVICE_PIXEL_RATIO,this.down_=null;var d=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new k.default(d),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=(0,h.listen)(this.pointerEventHandler_,j.default.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=(0,h.listen)(this.pointerEventHandler_,j.default.POINTERMOVE,this.relayEvent_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.emulateClick_=function(a){var b=new g.default(f.default.CLICK,this.map_,a);this.dispatchEvent(b),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,b=new g.default(f.default.DBLCLICK,this.map_,a),this.dispatchEvent(b)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var b=new g.default(f.default.SINGLECLICK,this.map_,a);this.dispatchEvent(b)}.bind(this),250)},b.prototype.updateActivePointers_=function(a){var b=a;b.type==f.default.POINTERUP||b.type==f.default.POINTERCANCEL?delete this.trackedTouches_[b.pointerId]:b.type==f.default.POINTERDOWN&&(this.trackedTouches_[b.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},b.prototype.handlePointerUp_=function(a){this.updateActivePointers_(a);var b=new g.default(f.default.POINTERUP,this.map_,a);this.dispatchEvent(b),b.propagationStopped||this.dragging_||!this.isMouseActionButton_(a)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(h.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},b.prototype.isMouseActionButton_=function(a){return 0===a.button},b.prototype.handlePointerDown_=function(a){this.updateActivePointers_(a);var b=new g.default(f.default.POINTERDOWN,this.map_,a);this.dispatchEvent(b),this.down_=a,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new k.default(document),this.dragListenerKeys_.push((0,h.listen)(this.documentPointerEventHandler_,f.default.POINTERMOVE,this.handlePointerMove_,this),(0,h.listen)(this.documentPointerEventHandler_,f.default.POINTERUP,this.handlePointerUp_,this),(0,h.listen)(this.pointerEventHandler_,f.default.POINTERCANCEL,this.handlePointerUp_,this)))},b.prototype.handlePointerMove_=function(a){if(this.isMoving_(a)){this.dragging_=!0;var b=new g.default(f.default.POINTERDRAG,this.map_,a,this.dragging_);this.dispatchEvent(b)}a.preventDefault()},b.prototype.relayEvent_=function(a){var b=!(!this.down_||!this.isMoving_(a));this.dispatchEvent(new g.default(a.type,this.map_,a,b))},b.prototype.isMoving_=function(a){return this.dragging_||Math.abs(a.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(a.clientY-this.down_.clientY)>this.moveTolerance_},b.prototype.disposeInternal=function(){this.relayedListenerKey_&&((0,h.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&((0,h.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(h.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),a.prototype.disposeInternal.call(this)},b}(i.default),m=l;c.default=m},{"./MapBrowserEventType.js":24,"./MapBrowserPointerEvent.js":25,"./events.js":66,"./events/Target.js":70,"./has.js":161,"./pointer/EventType.js":203,"./pointer/PointerEventHandler.js":208}],24:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./events/EventType.js")),f={SINGLECLICK:"singleclick",CLICK:e.default.CLICK,DBLCLICK:e.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};c.default=f},{"./events/EventType.js":68}],25:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./MapBrowserEvent.js")),f=function(a){function b(b,c,d,e,f){a.call(this,b,c,d.originalEvent,e,f),this.pointerEvent=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"./MapBrowserEvent.js":22}],26:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./events/Event.js")),f=function(a){function b(b,c,d){a.call(this,b),this.map=c,this.frameState=void 0!==d?d:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"./events/Event.js":67}],27:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};c.default=d},{}],28:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};c.default=d},{}],29:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return m.hasOwnProperty(a)?m[a]:m[a]="change:"+a}Object.defineProperty(c,"__esModule",{value:!0}),c.getChangeEventType=e,c.default=void 0;var f=a("./util.js"),g=d(a("./ObjectEventType.js")),h=d(a("./Observable.js")),i=d(a("./events/Event.js")),j=a("./obj.js"),k=function(a){function b(b,c,d){a.call(this,b),this.key=c,this.oldValue=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),l=function(a){function b(b){a.call(this),(0,f.getUid)(this),this.values_={},void 0!==b&&this.setProperties(b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){var b;return this.values_.hasOwnProperty(a)&&(b=this.values_[a]),b},b.prototype.getKeys=function(){return Object.keys(this.values_)},b.prototype.getProperties=function(){return(0,j.assign)({},this.values_)},b.prototype.notify=function(a,b){var c;c=e(a),this.dispatchEvent(new k(c,a,b)),c=g.default.PROPERTYCHANGE,this.dispatchEvent(new k(c,a,b))},b.prototype.set=function(a,b,c){if(c)this.values_[a]=b;else{var d=this.values_[a];this.values_[a]=b,d!==b&&this.notify(a,d)}},b.prototype.setProperties=function(a,b){var c=this;for(var d in a)c.set(d,a[d],b)},b.prototype.unset=function(a,b){if(a in this.values_){var c=this.values_[a];delete this.values_[a],b||this.notify(a,c)}},b}(h.default),m={},n=l;c.default=n},{"./ObjectEventType.js":30,"./Observable.js":31,"./events/Event.js":67,"./obj.js":201,"./util.js":342}],30:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={PROPERTYCHANGE:"propertychange"};c.default=d},{}],31:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(Array.isArray(a))for(var b=0,c=a.length;b<c;++b)(0,f.unlistenByKey)(a[b]);else(0,f.unlistenByKey)(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.unByKey=e,c.default=void 0;var f=a("./events.js"),g=d(a("./events/Target.js")),h=d(a("./events/EventType.js")),i=function(a){function b(){a.call(this),this.revision_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.changed=function(){++this.revision_,this.dispatchEvent(h.default.CHANGE)},b.prototype.getRevision=function(){return this.revision_},b.prototype.on=function(a,b){var c=this;if(Array.isArray(a)){for(var d=a.length,e=new Array(d),g=0;g<d;++g)e[g]=(0,f.listen)(c,a[g],b);return e}return(0,f.listen)(this,a,b)},b.prototype.once=function(a,b){var c=this;if(Array.isArray(a)){for(var d=a.length,e=new Array(d),g=0;g<d;++g)e[g]=(0,f.listenOnce)(c,a[g],b);return e}return(0,f.listenOnce)(this,a,b)},b.prototype.un=function(a,b){var c=this;if(Array.isArray(a))for(var d=0,e=a.length;d<e;++d)(0,f.unlisten)(c,a[d],b);else(0,f.unlisten)(this,a,b)},b}(g.default),j=i;c.default=j},{"./events.js":66,"./events/EventType.js":68,"./events/Target.js":70}],32:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("./MapEventType.js")),g=d(a("./Object.js")),h=e(a("./OverlayPositioning.js")),i=a("./css.js"),j=a("./dom.js"),k=a("./events.js"),l=a("./extent.js"),m={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},n=function(a){function b(b){a.call(this),this.options=b,this.id=b.id,this.insertFirst=void 0===b.insertFirst||b.insertFirst,this.stopEvent=void 0===b.stopEvent||b.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==b.className?b.className:"ol-overlay-container "+i.CLASS_SELECTABLE,this.element.style.position="absolute",this.autoPan=void 0!==b.autoPan&&b.autoPan,this.autoPanAnimation=b.autoPanAnimation||{},this.autoPanMargin=void 0!==b.autoPanMargin?b.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,(0,k.listen)(this,(0,g.getChangeEventType)(m.ELEMENT),this.handleElementChanged,this),(0,k.listen)(this,(0,g.getChangeEventType)(m.MAP),this.handleMapChanged,this),(0,k.listen)(this,(0,g.getChangeEventType)(m.OFFSET),this.handleOffsetChanged,this),(0,k.listen)(this,(0,g.getChangeEventType)(m.POSITION),this.handlePositionChanged,this),(0,k.listen)(this,(0,g.getChangeEventType)(m.POSITIONING),this.handlePositioningChanged,this),void 0!==b.element&&this.setElement(b.element),this.setOffset(void 0!==b.offset?b.offset:[0,0]),this.setPositioning(void 0!==b.positioning?b.positioning:h.default.TOP_LEFT),void 0!==b.position&&this.setPosition(b.position)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getElement=function(){return this.get(m.ELEMENT)},b.prototype.getId=function(){return this.id},b.prototype.getMap=function(){return this.get(m.MAP)},b.prototype.getOffset=function(){return this.get(m.OFFSET)},b.prototype.getPosition=function(){return this.get(m.POSITION)},b.prototype.getPositioning=function(){return this.get(m.POSITIONING)},b.prototype.handleElementChanged=function(){(0,j.removeChildren)(this.element);var a=this.getElement();a&&this.element.appendChild(a)},b.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&((0,j.removeNode)(this.element),(0,k.unlistenByKey)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var a=this.getMap();if(a){this.mapPostrenderListenerKey=(0,k.listen)(a,f.default.POSTRENDER,this.render,this),this.updatePixelPosition();var b=this.stopEvent?a.getOverlayContainerStopEvent():a.getOverlayContainer();this.insertFirst?b.insertBefore(this.element,b.childNodes[0]||null):b.appendChild(this.element)}},b.prototype.render=function(){this.updatePixelPosition()},b.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},b.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(m.POSITION)&&this.autoPan&&this.panIntoView()},b.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},b.prototype.setElement=function(a){this.set(m.ELEMENT,a)},b.prototype.setMap=function(a){this.set(m.MAP,a)},b.prototype.setOffset=function(a){this.set(m.OFFSET,a)},b.prototype.setPosition=function(a){this.set(m.POSITION,a)},b.prototype.panIntoView=function(){var a=this.getMap();if(a&&a.getTargetElement()){var b=this.getRect(a.getTargetElement(),a.getSize()),c=this.getElement(),d=this.getRect(c,[(0,j.outerWidth)(c),(0,j.outerHeight)(c)]),e=this.autoPanMargin;if(!(0,l.containsExtent)(b,d)){var f=d[0]-b[0],g=b[2]-d[2],h=d[1]-b[1],i=b[3]-d[3],k=[0,0];if(f<0?k[0]=f-e:g<0&&(k[0]=Math.abs(g)+e),h<0?k[1]=h-e:i<0&&(k[1]=Math.abs(i)+e),0!==k[0]||0!==k[1]){var m=a.getView().getCenter(),n=a.getPixelFromCoordinate(m),o=[n[0]+k[0],n[1]+k[1]];a.getView().animate({center:a.getCoordinateFromPixel(o),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},b.prototype.getRect=function(a,b){var c=a.getBoundingClientRect(),d=c.left+window.pageXOffset,e=c.top+window.pageYOffset;return[d,e,d+b[0],e+b[1]]},b.prototype.setPositioning=function(a){this.set(m.POSITIONING,a)},b.prototype.setVisible=function(a){this.rendered.visible!==a&&(this.element.style.display=a?"":"none",this.rendered.visible=a)},b.prototype.updatePixelPosition=function(){var a=this.getMap(),b=this.getPosition();if(!a||!a.isRendered()||!b)return void this.setVisible(!1);var c=a.getPixelFromCoordinate(b),d=a.getSize();this.updateRenderedPosition(c,d)},b.prototype.updateRenderedPosition=function(a,b){var c=this.element.style,d=this.getOffset(),e=this.getPositioning();this.setVisible(!0);var f=d[0],g=d[1];if(e==h.default.BOTTOM_RIGHT||e==h.default.CENTER_RIGHT||e==h.default.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=c.left="");var i=Math.round(b[0]-a[0]-f)+"px";this.rendered.right_!=i&&(this.rendered.right_=c.right=i)}else{""!==this.rendered.right_&&(this.rendered.right_=c.right=""),e!=h.default.BOTTOM_CENTER&&e!=h.default.CENTER_CENTER&&e!=h.default.TOP_CENTER||(f-=this.element.offsetWidth/2);var j=Math.round(a[0]+f)+"px";this.rendered.left_!=j&&(this.rendered.left_=c.left=j)}if(e==h.default.BOTTOM_LEFT||e==h.default.BOTTOM_CENTER||e==h.default.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=c.top="");var k=Math.round(b[1]-a[1]-g)+"px";this.rendered.bottom_!=k&&(this.rendered.bottom_=c.bottom=k)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=c.bottom=""),e!=h.default.CENTER_LEFT&&e!=h.default.CENTER_CENTER&&e!=h.default.CENTER_RIGHT||(g-=this.element.offsetHeight/2);var l=Math.round(a[1]+g)+"px";this.rendered.top_!=l&&(this.rendered.top_=c.top=l)}},b.prototype.getOptions=function(){return this.options},b}(g.default),o=n;c.default=o},{"./MapEventType.js":27,"./Object.js":29,"./OverlayPositioning.js":33,"./css.js":63,"./dom.js":64,"./events.js":66,"./extent.js":72}],33:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};c.default=d},{}],34:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=null;void 0!==a.keyboardEventTarget&&(b="string"==typeof a.keyboardEventTarget?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);var c={},d=a.layers instanceof E.default?a.layers:new E.default({layers:a.layers});c[p.default.LAYERGROUP]=d,c[p.default.TARGET]=a.target,c[p.default.VIEW]=void 0!==a.view?a.view:new u.default;var e;void 0!==a.controls&&(Array.isArray(a.controls)?e=new i.default(a.controls.slice()):((0,w.assert)(a.controls instanceof i.default,47),e=a.controls));var f;void 0!==a.interactions&&(Array.isArray(a.interactions)?f=new i.default(a.interactions.slice()):((0,w.assert)(a.interactions instanceof i.default,48),f=a.interactions));var g;return void 0!==a.overlays?Array.isArray(a.overlays)?g=new i.default(a.overlays.slice()):((0,w.assert)(a.overlays instanceof i.default,49),g=a.overlays):g=new i.default,{controls:e,interactions:f,keyboardEventTarget:b,overlays:g,values:c}}function g(a){for(var b=0,c=a.length;b<c;++b){var d=a[b];if(d instanceof E.default)return g(d.getLayers().getArray());var e=a[b].getSource();if(e&&e.loading)return!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=a("./util.js"),i=e(a("./Collection.js")),j=e(a("./CollectionEventType.js")),k=e(a("./MapBrowserEvent.js")),l=e(a("./MapBrowserEventHandler.js")),m=e(a("./MapBrowserEventType.js")),n=e(a("./MapEvent.js")),o=e(a("./MapEventType.js")),p=e(a("./MapProperty.js")),q=e(a("./render/EventType.js")),r=d(a("./Object.js")),s=e(a("./ObjectEventType.js")),t=e(a("./TileQueue.js")),u=e(a("./View.js")),v=e(a("./ViewHint.js")),w=a("./asserts.js"),x=a("./dom.js"),y=a("./events.js"),z=a("./events/Event.js"),A=e(a("./events/EventType.js")),B=a("./extent.js"),C=a("./functions.js"),D=a("./has.js"),E=e(a("./layer/Group.js")),F=a("./size.js"),G=a("./structs/PriorityQueue.js"),H=a("./transform.js"),I=function(a){function b(b){var c=this;a.call(this);var d=f(b);this.maxTilesLoading_=void 0!==b.maxTilesLoading?b.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==b.loadTilesWhileAnimating&&b.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==b.loadTilesWhileInteracting&&b.loadTilesWhileInteracting,this.pixelRatio_=void 0!==b.pixelRatio?b.pixelRatio:D.DEVICE_PIXEL_RATIO,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=(0,H.create)(),this.pixelToCoordinateTransform_=(0,H.create)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+(D.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var e=[A.default.CLICK,A.default.DBLCLICK,A.default.MOUSEDOWN,A.default.TOUCHSTART,A.default.MSPOINTERDOWN,m.default.POINTERDOWN,A.default.MOUSEWHEEL,A.default.WHEEL],g=0,h=e.length;g<h;++g)(0,y.listen)(c.overlayContainerStopEvent_,e[g],z.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new l.default(this,b.moveTolerance);for(var k in m.default)(0,y.listen)(c.mapBrowserEventHandler_,m.default[k],c.handleMapBrowserEvent,c);this.keyboardEventTarget_=d.keyboardEventTarget,this.keyHandlerKeys_=null,(0,y.listen)(this.viewport_,A.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,y.listen)(this.viewport_,A.default.WHEEL,this.handleBrowserEvent,this),(0,y.listen)(this.viewport_,A.default.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=d.controls||new i.default,this.interactions=d.interactions||new i.default,this.overlays_=d.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new t.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},(0,y.listen)(this,(0,r.getChangeEventType)(p.default.LAYERGROUP),this.handleLayerGroupChanged_,this),(0,y.listen)(this,(0,r.getChangeEventType)(p.default.VIEW),this.handleViewChanged_,this),(0,y.listen)(this,(0,r.getChangeEventType)(p.default.SIZE),this.handleSizeChanged_,this),(0,y.listen)(this,(0,r.getChangeEventType)(p.default.TARGET),this.handleTargetChanged_,this),this.setProperties(d.values),this.controls.forEach(function(a){a.setMap(this)}.bind(this)),(0,y.listen)(this.controls,j.default.ADD,function(a){a.element.setMap(this)},this),(0,y.listen)(this.controls,j.default.REMOVE,function(a){a.element.setMap(null)},this),this.interactions.forEach(function(a){a.setMap(this)}.bind(this)),(0,y.listen)(this.interactions,j.default.ADD,function(a){a.element.setMap(this)},this),(0,y.listen)(this.interactions,j.default.REMOVE,function(a){a.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),(0,y.listen)(this.overlays_,j.default.ADD,function(a){this.addOverlayInternal_(a.element)},this),(0,y.listen)(this.overlays_,j.default.REMOVE,function(a){var b=a.element,c=b.getId();void 0!==c&&delete this.overlayIdIndex_[c.toString()],a.element.setMap(null)},this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createRenderer=function(){
throw new Error("Use a map type that has a createRenderer method")},b.prototype.addControl=function(a){this.getControls().push(a)},b.prototype.addInteraction=function(a){this.getInteractions().push(a)},b.prototype.addLayer=function(a){this.getLayerGroup().getLayers().push(a)},b.prototype.addOverlay=function(a){this.getOverlays().push(a)},b.prototype.addOverlayInternal_=function(a){var b=a.getId();void 0!==b&&(this.overlayIdIndex_[b.toString()]=a),a.setMap(this)},b.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),(0,y.unlisten)(this.viewport_,A.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,y.unlisten)(this.viewport_,A.default.WHEEL,this.handleBrowserEvent,this),(0,y.unlisten)(this.viewport_,A.default.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(A.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),a.prototype.disposeInternal.call(this)},b.prototype.forEachFeatureAtPixel=function(a,b,c){if(this.frameState_){var d=this.getCoordinateFromPixel(a);c=void 0!==c?c:{};var e=void 0!==c.hitTolerance?c.hitTolerance*this.frameState_.pixelRatio:0,f=void 0!==c.layerFilter?c.layerFilter:C.TRUE;return this.renderer_.forEachFeatureAtCoordinate(d,this.frameState_,e,b,null,f,null)}},b.prototype.getFeaturesAtPixel=function(a,b){var c=null;return this.forEachFeatureAtPixel(a,function(a){c||(c=[]),c.push(a)},b),c},b.prototype.forEachLayerAtPixel=function(a,b,c){if(this.frameState_){var d=c||{},e=void 0!==d.hitTolerance?c.hitTolerance*this.frameState_.pixelRatio:0,f=d.layerFilter||C.TRUE;return this.renderer_.forEachLayerAtPixel(a,this.frameState_,e,b,null,f,null)}},b.prototype.hasFeatureAtPixel=function(a,b){if(!this.frameState_)return!1;var c=this.getCoordinateFromPixel(a);b=void 0!==b?b:{};var d=void 0!==b.layerFilter?b.layerFilter:C.TRUE,e=void 0!==b.hitTolerance?b.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(c,this.frameState_,e,d,null)},b.prototype.getEventCoordinate=function(a){return this.getCoordinateFromPixel(this.getEventPixel(a))},b.prototype.getEventPixel=function(a){var b=this.viewport_.getBoundingClientRect(),c=a.changedTouches?a.changedTouches[0]:a;return[c.clientX-b.left,c.clientY-b.top]},b.prototype.getTarget=function(){return this.get(p.default.TARGET)},b.prototype.getTargetElement=function(){var a=this.getTarget();return void 0!==a?"string"==typeof a?document.getElementById(a):a:null},b.prototype.getCoordinateFromPixel=function(a){var b=this.frameState_;return b?(0,H.apply)(b.pixelToCoordinateTransform,a.slice()):null},b.prototype.getControls=function(){return this.controls},b.prototype.getOverlays=function(){return this.overlays_},b.prototype.getOverlayById=function(a){var b=this.overlayIdIndex_[a.toString()];return void 0!==b?b:null},b.prototype.getInteractions=function(){return this.interactions},b.prototype.getLayerGroup=function(){return this.get(p.default.LAYERGROUP)},b.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},b.prototype.getPixelFromCoordinate=function(a){var b=this.frameState_;return b?(0,H.apply)(b.coordinateToPixelTransform,a.slice(0,2)):null},b.prototype.getRenderer=function(){return this.renderer_},b.prototype.getSize=function(){return this.get(p.default.SIZE)},b.prototype.getView=function(){return this.get(p.default.VIEW)},b.prototype.getViewport=function(){return this.viewport_},b.prototype.getOverlayContainer=function(){return this.overlayContainer_},b.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},b.prototype.getTilePriority=function(a,b,c,d){var e=this.frameState_;if(!(e&&b in e.wantedTiles))return G.DROP;if(!e.wantedTiles[b][a.getKey()])return G.DROP;var f=c[0]-e.focus[0],g=c[1]-e.focus[1];return 65536*Math.log(d)+Math.sqrt(f*f+g*g)/d},b.prototype.handleBrowserEvent=function(a,b){var c=b||a.type,d=new k.default(c,this,a);this.handleMapBrowserEvent(d)},b.prototype.handleMapBrowserEvent=function(a){if(this.frameState_){this.focus_=a.coordinate,a.frameState=this.frameState_;var b=this.getInteractions().getArray();if(!1!==this.dispatchEvent(a))for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.getActive()){var e=d.handleEvent(a);if(!e)break}}}},b.prototype.handlePostRender=function(){var a=this,b=this.frameState_,c=this.tileQueue_;if(!c.isEmpty()){var d=this.maxTilesLoading_,e=d;if(b){var f=b.viewHints;f[v.default.ANIMATING]&&(d=this.loadTilesWhileAnimating_?8:0,e=2),f[v.default.INTERACTING]&&(d=this.loadTilesWhileInteracting_?8:0,e=2)}c.getTilesLoading()<d&&(c.reprioritize(),c.loadMoreTiles(d,e))}!b||!this.hasListener(o.default.RENDERCOMPLETE)||b.animate||this.tileQueue_.getTilesLoading()||g(this.getLayers().getArray())||this.renderer_.dispatchRenderEvent(q.default.RENDERCOMPLETE,b);for(var h=this.postRenderFunctions_,i=0,j=h.length;i<j;++i)h[i](a,b);h.length=0},b.prototype.handleSizeChanged_=function(){this.render()},b.prototype.handleTargetChanged_=function(){var a,b=this;if(this.getTarget()&&(a=this.getTargetElement()),this.keyHandlerKeys_){for(var c=0,d=this.keyHandlerKeys_.length;c<d;++c)(0,y.unlistenByKey)(b.keyHandlerKeys_[c]);this.keyHandlerKeys_=null}if(a){a.appendChild(this.viewport_);var e=this.keyboardEventTarget_?this.keyboardEventTarget_:a;this.keyHandlerKeys_=[(0,y.listen)(e,A.default.KEYDOWN,this.handleBrowserEvent,this),(0,y.listen)(e,A.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(A.default.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),(0,x.removeNode)(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(A.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},b.prototype.handleTileChange_=function(){this.render()},b.prototype.handleViewPropertyChanged_=function(){this.render()},b.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&((0,y.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,y.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var a=this.getView();a&&(this.viewport_.setAttribute("data-view",(0,h.getUid)(a)),this.viewPropertyListenerKey_=(0,y.listen)(a,s.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,y.listen)(a,A.default.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},b.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(y.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var a=this.getLayerGroup();a&&(this.layerGroupPropertyListenerKeys_=[(0,y.listen)(a,s.default.PROPERTYCHANGE,this.render,this),(0,y.listen)(a,A.default.CHANGE,this.render,this)]),this.render()},b.prototype.isRendered=function(){return!!this.frameState_},b.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},b.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},b.prototype.removeControl=function(a){return this.getControls().remove(a)},b.prototype.removeInteraction=function(a){return this.getInteractions().remove(a)},b.prototype.removeLayer=function(a){return this.getLayerGroup().getLayers().remove(a)},b.prototype.removeOverlay=function(a){return this.getOverlays().remove(a)},b.prototype.renderFrame_=function(a){var b,c=this.getSize(),d=this.getView(),e=(0,B.createEmpty)(),f=this.frameState_,g=null;if(void 0!==c&&(0,F.hasArea)(c)&&d&&d.isDef()){for(var i=d.getHints(this.frameState_?this.frameState_.viewHints:void 0),j=this.getLayerGroup().getLayerStatesArray(),k={},l=0,m=j.length;l<m;++l)k[(0,h.getUid)(j[l].layer)]=j[l];b=d.getState(this.pixelRatio_),g={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:e,focus:this.focus_?this.focus_:b.center,index:this.frameIndex_++,layerStates:k,layerStatesArray:j,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:c,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:a,usedTiles:{},viewState:b,viewHints:i,wantedTiles:{}}}if(g&&(g.extent=(0,B.getForViewAndSize)(b.center,b.resolution,b.rotation,g.size,e)),this.frameState_=g,this.renderer_.renderFrame(g),g){if(g.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,g.postRenderFunctions),f){(!this.previousExtent_||!(0,B.isEmpty)(this.previousExtent_)&&!(0,B.equals)(g.extent,this.previousExtent_))&&(this.dispatchEvent(new n.default(o.default.MOVESTART,this,f)),this.previousExtent_=(0,B.createOrUpdateEmpty)(this.previousExtent_))}this.previousExtent_&&!g.viewHints[v.default.ANIMATING]&&!g.viewHints[v.default.INTERACTING]&&!(0,B.equals)(g.extent,this.previousExtent_)&&(this.dispatchEvent(new n.default(o.default.MOVEEND,this,g)),(0,B.clone)(g.extent,this.previousExtent_))}this.dispatchEvent(new n.default(o.default.POSTRENDER,this,g)),setTimeout(this.handlePostRender.bind(this),0)},b.prototype.setLayerGroup=function(a){this.set(p.default.LAYERGROUP,a)},b.prototype.setSize=function(a){this.set(p.default.SIZE,a)},b.prototype.setTarget=function(a){this.set(p.default.TARGET,a)},b.prototype.setView=function(a){this.set(p.default.VIEW,a)},b.prototype.skipFeature=function(a){var b=(0,h.getUid)(a).toString();this.skippedFeatureUids_[b]=!0,this.render()},b.prototype.updateSize=function(){var a=this.getTargetElement();if(a){var b=getComputedStyle(a);this.setSize([a.offsetWidth-parseFloat(b.borderLeftWidth)-parseFloat(b.paddingLeft)-parseFloat(b.paddingRight)-parseFloat(b.borderRightWidth),a.offsetHeight-parseFloat(b.borderTopWidth)-parseFloat(b.paddingTop)-parseFloat(b.paddingBottom)-parseFloat(b.borderBottomWidth)])}else this.setSize(void 0)},b.prototype.unskipFeature=function(a){var b=(0,h.getUid)(a).toString();delete this.skippedFeatureUids_[b],this.render()},b}(r.default),J=I;c.default=J},{"./Collection.js":7,"./CollectionEventType.js":8,"./MapBrowserEvent.js":22,"./MapBrowserEventHandler.js":23,"./MapBrowserEventType.js":24,"./MapEvent.js":26,"./MapEventType.js":27,"./MapProperty.js":28,"./Object.js":29,"./ObjectEventType.js":30,"./TileQueue.js":37,"./View.js":42,"./ViewHint.js":43,"./asserts.js":47,"./dom.js":64,"./events.js":66,"./events/Event.js":67,"./events/EventType.js":68,"./extent.js":72,"./functions.js":126,"./has.js":161,"./layer/Group.js":187,"./render/EventType.js":220,"./size.js":279,"./structs/PriorityQueue.js":316,"./transform.js":340,"./util.js":342}],35:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./TileState.js")),f=a("./easing.js"),g=d(a("./events/Target.js")),h=d(a("./events/EventType.js")),i=function(a){function b(b,c,d){a.call(this);var e=d||{};this.tileCoord=b,this.state=c,this.interimTile=null,this.key="",this.transition_=void 0===e.transition?250:e.transition,this.transitionStarts_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.changed=function(){this.dispatchEvent(h.default.CHANGE)},b.prototype.getKey=function(){return this.key+"/"+this.tileCoord},b.prototype.getInterimTile=function(){if(!this.interimTile)return this;var a=this.interimTile;do{if(a.getState()==e.default.LOADED)return a;a=a.interimTile}while(a);return this},b.prototype.refreshInterimChain=function(){if(this.interimTile){var a=this.interimTile,b=this;do{if(a.getState()==e.default.LOADED){a.interimTile=null;break}a.getState()==e.default.LOADING?b=a:a.getState()==e.default.IDLE?b.interimTile=a.interimTile:b=a,a=b.interimTile}while(a)}},b.prototype.getTileCoord=function(){return this.tileCoord},b.prototype.getState=function(){return this.state},b.prototype.setState=function(a){this.state=a,this.changed()},b.prototype.load=function(){},b.prototype.getAlpha=function(a,b){if(!this.transition_)return 1;var c=this.transitionStarts_[a];if(c){if(-1===c)return 1}else c=b,this.transitionStarts_[a]=c;var d=b-c+1e3/60;return d>=this.transition_?1:(0,f.easeIn)(d/this.transition_)},b.prototype.inTransition=function(a){return!!this.transition_&&-1!==this.transitionStarts_[a]},b.prototype.endTransition=function(a){this.transition_&&(this.transitionStarts_[a]=-1)},b}(g.default),j=i;c.default=j},{"./TileState.js":39,"./easing.js":65,"./events/EventType.js":68,"./events/Target.js":70}],36:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./structs/LRUCache.js")),f=a("./tilecoord.js"),g=function(a){function b(b){a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.expireCache=function(a){for(var b=this;this.canExpireCache();){var c=b.peekLast(),d=c.tileCoord[0].toString();if(d in a&&a[d].contains(c.tileCoord))break;b.pop().dispose()}},b.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var a=this.peekFirstKey(),b=(0,f.fromKey)(a),c=b[0];this.forEach(function(a){a.tileCoord[0]!==c&&(this.remove((0,f.getKey)(a.tileCoord)),a.dispose())},this)}},b}(e.default),h=g;c.default=h},{"./structs/LRUCache.js":314,"./tilecoord.js":334}],37:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./TileState.js")),f=a("./events.js"),g=d(a("./events/EventType.js")),h=d(a("./structs/PriorityQueue.js")),i=function(a){function b(b,c){a.call(this,function(a){return b.apply(null,a)},function(a){return a[0].getKey()}),this.tileChangeCallback_=c,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.enqueue=function(b){var c=a.prototype.enqueue.call(this,b);if(c){var d=b[0];(0,f.listen)(d,g.default.CHANGE,this.handleTileChange,this)}return c},b.prototype.getTilesLoading=function(){return this.tilesLoading_},b.prototype.handleTileChange=function(a){var b=a.target,c=b.getState();if(c===e.default.LOADED||c===e.default.ERROR||c===e.default.EMPTY||c===e.default.ABORT){(0,f.unlisten)(b,g.default.CHANGE,this.handleTileChange,this);var d=b.getKey();d in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[d],--this.tilesLoading_),this.tileChangeCallback_()}},b.prototype.loadMoreTiles=function(a,b){for(var c,d,f,g=this,h=0,i=!1;this.tilesLoading_<a&&h<b&&this.getCount()>0;)d=g.dequeue()[0],f=d.getKey(),c=d.getState(),c===e.default.ABORT?i=!0:c!==e.default.IDLE||f in g.tilesLoadingKeys_||(g.tilesLoadingKeys_[f]=!0,++g.tilesLoading_,++h,d.load());0===h&&i&&this.tileChangeCallback_()},b}(h.default),j=i;c.default=j},{"./TileState.js":39,"./events.js":66,"./events/EventType.js":68,"./structs/PriorityQueue.js":316}],38:[function(a,b,c){"use strict";function d(a,b,c,d,f){return void 0!==f?(f.minX=a,f.maxX=b,f.minY=c,f.maxY=d,f):new e(a,b,c,d)}Object.defineProperty(c,"__esModule",{value:!0}),c.createOrUpdate=d,c.default=void 0;var e=function(a,b,c,d){this.minX=a,this.maxX=b,this.minY=c,this.maxY=d};e.prototype.contains=function(a){return this.containsXY(a[1],a[2])},e.prototype.containsTileRange=function(a){return this.minX<=a.minX&&a.maxX<=this.maxX&&this.minY<=a.minY&&a.maxY<=this.maxY},e.prototype.containsXY=function(a,b){return this.minX<=a&&a<=this.maxX&&this.minY<=b&&b<=this.maxY},e.prototype.equals=function(a){return this.minX==a.minX&&this.minY==a.minY&&this.maxX==a.maxX&&this.maxY==a.maxY},e.prototype.extend=function(a){a.minX<this.minX&&(this.minX=a.minX),a.maxX>this.maxX&&(this.maxX=a.maxX),a.minY<this.minY&&(this.minY=a.minY),a.maxY>this.maxY&&(this.maxY=a.maxY)},e.prototype.getHeight=function(){return this.maxY-this.minY+1},e.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},e.prototype.getWidth=function(){return this.maxX-this.minX+1},e.prototype.intersects=function(a){return this.minX<=a.maxX&&this.maxX>=a.minX&&this.minY<=a.maxY&&this.maxY>=a.minY};var f=e;c.default=f},{}],39:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};c.default=d},{}],40:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){var c=(0,m.loadFeaturesXhr)(b,a.getFormat(),a.onLoad.bind(a),a.onError.bind(a));a.setLoader(c)}Object.defineProperty(c,"__esModule",{value:!0}),c.defaultLoadFunction=e,c.default=void 0;var f=a("./util.js"),g=d(a("./Tile.js")),h=d(a("./TileState.js")),i=a("./dom.js"),j=a("./events.js"),k=a("./extent.js"),l=d(a("./events/EventType.js")),m=a("./featureloader.js"),n=a("./functions.js"),o=function(a){function b(c,d,e,f,g,i,m,o,p,q,r,s,t,u,v){var w=this;if(a.call(this,c,d,{transition:0}),this.context_={},this.loader_,this.replayState_={},this.sourceTiles_=q,this.tileKeys=[],this.extent=null,this.sourceRevision_=e,this.wrappedTileCoord=i,this.loadListenerKeys_=[],this.sourceTileListenerKeys_=[],i){var x=this.extent=p.getTileCoordExtent(i),y=p.getResolution(v),z=o.getZForResolution(y),A=v!=c[0],B=0;if(o.forEachTileCoord(x,z,function(a){var b=(0,k.getIntersection)(x,o.getTileCoordExtent(a)),c=o.getExtent();if(c&&(b=(0,k.getIntersection)(b,c,b)),(0,k.getWidth)(b)/y>=.5&&(0,k.getHeight)(b)/y>=.5){++B;var d=a.toString(),e=q[d];if(!e&&!A){var i=m(a,r,s);e=q[d]=new t(a,void 0==i?h.default.EMPTY:h.default.IDLE,void 0==i?"":i,f,g),this.sourceTileListenerKeys_.push((0,j.listen)(e,l.default.CHANGE,u))}!e||A&&e.getState()!=h.default.LOADED||(e.consumers++,this.tileKeys.push(d))}}.bind(this)),A&&B==this.tileKeys.length&&this.finishLoading_(),v<=c[0]&&this.state!=h.default.LOADED)for(;v>p.getMinZoom();){var C=new b(c,d,e,f,g,i,m,o,p,q,r,s,t,n.VOID,--v);if(C.state==h.default.LOADED){w.interimTile=C;break}}}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){var b=this;this.state=h.default.ABORT,this.changed(),this.interimTile&&this.interimTile.dispose();for(var c=0,d=this.tileKeys.length;c<d;++c){var e=b.tileKeys[c],f=b.getTile(e);f.consumers--,0==f.consumers&&(delete b.sourceTiles_[e],f.dispose())}this.tileKeys.length=0,this.sourceTiles_=null,this.loadListenerKeys_.forEach(j.unlistenByKey),this.loadListenerKeys_.length=0,this.sourceTileListenerKeys_.forEach(j.unlistenByKey),this.sourceTileListenerKeys_.length=0,a.prototype.disposeInternal.call(this)},b.prototype.getContext=function(a){var b=(0,f.getUid)(a).toString();return b in this.context_||(this.context_[b]=(0,i.createCanvasContext2D)()),this.context_[b]},b.prototype.getImage=function(a){return-1==this.getReplayState(a).renderedTileRevision?null:this.getContext(a).canvas},b.prototype.getReplayState=function(a){var b=(0,f.getUid)(a).toString();return b in this.replayState_||(this.replayState_[b]={dirty:!1,renderedRenderOrder:null,renderedRevision:-1,renderedTileRevision:-1}),this.replayState_[b]},b.prototype.getKey=function(){return this.tileKeys.join("/")+"-"+this.sourceRevision_},b.prototype.getTile=function(a){return this.sourceTiles_[a]},b.prototype.load=function(){var a=0,b={};this.state==h.default.IDLE&&this.setState(h.default.LOADING),this.state==h.default.LOADING&&this.tileKeys.forEach(function(c){var d=this.getTile(c);if(d.state==h.default.IDLE&&(d.setLoader(this.loader_),d.load()),d.state==h.default.LOADING){var e=(0,j.listen)(d,l.default.CHANGE,function(c){var e=d.getState();if(e==h.default.LOADED||e==h.default.ERROR){var g=(0,f.getUid)(d);e==h.default.ERROR?b[g]=!0:(--a,delete b[g]),a-Object.keys(b).length==0&&this.finishLoading_()}}.bind(this));this.loadListenerKeys_.push(e),++a}}.bind(this)),a-Object.keys(b).length==0&&setTimeout(this.finishLoading_.bind(this),0)},b.prototype.finishLoading_=function(){for(var a=this,b=this.tileKeys.length,c=0,d=b-1;d>=0;--d){var e=a.getTile(a.tileKeys[d]).getState();e!=h.default.LOADED&&--b,e==h.default.EMPTY&&++c}b==this.tileKeys.length?(this.loadListenerKeys_.forEach(j.unlistenByKey),this.loadListenerKeys_.length=0,this.setState(h.default.LOADED)):this.setState(c==this.tileKeys.length?h.default.EMPTY:h.default.ERROR)},b}(g.default),p=o;c.default=p},{"./Tile.js":35,"./TileState.js":39,"./dom.js":64,"./events.js":66,"./events/EventType.js":68,"./extent.js":72,"./featureloader.js":75,"./functions.js":126,"./util.js":342}],41:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./util.js"),f=d(a("./Tile.js")),g=d(a("./TileState.js")),h=[0,0,4096,4096],i=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,g),this.consumers=0,this.extent_=null,this.format_=e,this.features_=null,this.loader_,this.projection_=null,this.replayGroups_={},this.tileLoadFunction_=f,this.url_=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.features_=null,this.replayGroups_={},this.state=g.default.ABORT,this.changed(),a.prototype.disposeInternal.call(this)},b.prototype.getExtent=function(){return this.extent_||h},b.prototype.getFormat=function(){return this.format_},b.prototype.getFeatures=function(){return this.features_},b.prototype.getKey=function(){return this.url_},b.prototype.getProjection=function(){return this.projection_},b.prototype.getReplayGroup=function(a,b){return this.replayGroups_[(0,e.getUid)(a)+","+b]},b.prototype.load=function(){this.state==g.default.IDLE&&(this.setState(g.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(null,NaN,null))},b.prototype.onLoad=function(a,b,c){this.setProjection(b),this.setFeatures(a),this.setExtent(c)},b.prototype.onError=function(){this.setState(g.default.ERROR)},b.prototype.setExtent=function(a){this.extent_=a},b.prototype.setFeatures=function(a){this.features_=a,this.setState(g.default.LOADED)},b.prototype.setProjection=function(a){this.projection_=a},b.prototype.setReplayGroup=function(a,b,c){this.replayGroups_[(0,e.getUid)(a)+","+b]=c},b.prototype.setLoader=function(a){this.loader_=a},b}(f.default),j=i;c.default=j},{"./Tile.js":35,"./TileState.js":39,"./util.js":342}],42:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){setTimeout(function(){a(b)},0)}function f(a){return void 0!==a.extent?(0,m.createExtent)(a.extent):m.none}function g(a){var b,c,d,e=28,f=2,g=void 0!==a.minZoom?a.minZoom:E,h=void 0!==a.maxZoom?a.maxZoom:e,i=void 0!==a.zoomFactor?a.zoomFactor:f;if(void 0!==a.resolutions){var k=a.resolutions;c=k[g],d=void 0!==k[h]?k[h]:k[k.length-1],b=(0,o.createSnapToResolutions)(k)}else{var l=(0,C.createProjection)(a.projection,"EPSG:3857"),m=l.getExtent(),n=m?Math.max((0,w.getWidth)(m),(0,w.getHeight)(m)):360*C.METERS_PER_UNIT[D.default.DEGREES]/l.getMetersPerUnit(),p=n/j.DEFAULT_TILE_SIZE/Math.pow(f,E),q=p/Math.pow(f,e-E);c=a.maxResolution,void 0!==c?g=0:c=p/Math.pow(i,g),d=a.minResolution,void 0===d&&(d=void 0!==a.maxZoom?void 0!==a.maxResolution?c/Math.pow(i,h):p/Math.pow(i,h):q),h=g+Math.floor(Math.log(c/d)/Math.log(i)),d=c/Math.pow(i,h-g),b=(0,o.createSnapToPower)(i,c,h-g)}return{constraint:b,maxResolution:c,minResolution:d,minZoom:g,zoomFactor:i}}function h(a){if(void 0===a.enableRotation||a.enableRotation){var b=a.constrainRotation;return void 0===b||!0===b?(0,p.createSnapToZero)():!1===b?p.none:"number"==typeof b?(0,p.createSnapToN)(b):p.none}return p.disable}function i(a){return!(a.sourceCenter&&a.targetCenter&&!(0,u.equals)(a.sourceCenter,a.targetCenter))&&(a.sourceResolution===a.targetResolution&&a.sourceRotation===a.targetRotation)}Object.defineProperty(c,"__esModule",{value:!0}),c.createCenterConstraint=f,c.createResolutionConstraint=g,c.createRotationConstraint=h,c.isNoopAnimation=i,c.default=void 0;var j=a("./tilegrid/common.js"),k=a("./util.js"),l=a("./functions.js"),m=a("./centerconstraint.js"),n=d(a("./Object.js")),o=a("./resolutionconstraint.js"),p=a("./rotationconstraint.js"),q=d(a("./ViewHint.js")),r=d(a("./ViewProperty.js")),s=a("./array.js"),t=a("./asserts.js"),u=a("./coordinate.js"),v=a("./easing.js"),w=a("./extent.js"),x=d(a("./geom/GeometryType.js")),y=a("./geom/Polygon.js"),z=d(a("./geom/SimpleGeometry.js")),A=a("./math.js"),B=a("./obj.js"),C=a("./proj.js"),D=d(a("./proj/Units.js")),E=0,F=function(a){function b(b){a.call(this);var c=(0,B.assign)({},b);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=(0,C.createProjection)(c.projection,"EPSG:3857"),this.applyOptions_(c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.applyOptions_=function(a){var b={};b[r.default.CENTER]=void 0!==a.center?a.center:null;var c=g(a);this.maxResolution_=c.maxResolution,this.minResolution_=c.minResolution,this.zoomFactor_=c.zoomFactor,this.resolutions_=a.resolutions,this.minZoom_=c.minZoom;var d=f(a),e=c.constraint,i=h(a);this.constraints_={center:d,resolution:e,rotation:i},void 0!==a.resolution?b[r.default.RESOLUTION]=a.resolution:void 0!==a.zoom&&(b[r.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,a.zoom-this.minZoom_),this.resolutions_&&(b[r.default.RESOLUTION]=(0,A.clamp)(Number(this.getResolution()||b[r.default.RESOLUTION]),this.minResolution_,this.maxResolution_))),b[r.default.ROTATION]=void 0!==a.rotation?a.rotation:0,this.setProperties(b),this.options_=a},b.prototype.getUpdatedOptions_=function(a){var b=(0,B.assign)({},this.options_);return void 0!==b.resolution?b.resolution=this.getResolution():b.zoom=this.getZoom(),b.center=this.getCenter(),b.rotation=this.getRotation(),(0,B.assign)({},b,a)},b.prototype.animate=function(a){var b,c=arguments,d=this,f=arguments.length;if(f>1&&"function"==typeof arguments[f-1]&&(b=arguments[f-1],--f),!this.isDef()){var g=arguments[f-1];return g.center&&this.setCenter(g.center),void 0!==g.zoom&&this.setZoom(g.zoom),void 0!==g.rotation&&this.setRotation(g.rotation),void(b&&e(b,!0))}for(var h=Date.now(),j=this.getCenter().slice(),k=this.getResolution(),l=this.getRotation(),m=[],n=0;n<f;++n){var o=c[n],p={start:h,complete:!1,anchor:o.anchor,duration:void 0!==o.duration?o.duration:1e3,easing:o.easing||v.inAndOut};if(o.center&&(p.sourceCenter=j,p.targetCenter=o.center,j=p.targetCenter),void 0!==o.zoom?(p.sourceResolution=k,p.targetResolution=d.constrainResolution(d.maxResolution_,o.zoom-d.minZoom_,0),k=p.targetResolution):o.resolution&&(p.sourceResolution=k,p.targetResolution=o.resolution,k=p.targetResolution),void 0!==o.rotation){p.sourceRotation=l;var r=(0,A.modulo)(o.rotation-l+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=l+r,l=p.targetRotation}p.callback=b,i(p)?p.complete=!0:h+=p.duration,m.push(p)}this.animations_.push(m),this.setHint(q.default.ANIMATING,1),this.updateAnimations_()},b.prototype.getAnimating=function(){return this.hints_[q.default.ANIMATING]>0},b.prototype.getInteracting=function(){return this.hints_[q.default.INTERACTING]>0},b.prototype.cancelAnimations=function(){var a=this;this.setHint(q.default.ANIMATING,-this.hints_[q.default.ANIMATING]);for(var b=0,c=this.animations_.length;b<c;++b){var d=a.animations_[b];d[0].callback&&e(d[0].callback,!1)}this.animations_.length=0},b.prototype.updateAnimations_=function(){var a=this;if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var b=Date.now(),c=!1,d=this.animations_.length-1;d>=0;--d){for(var f=a.animations_[d],g=!0,h=0,i=f.length;h<i;++h){var j=f[h];if(!j.complete){var k=b-j.start,l=j.duration>0?k/j.duration:1;l>=1?(j.complete=!0,l=1):g=!1;var m=j.easing(l);if(j.sourceCenter){var n=j.sourceCenter[0],o=j.sourceCenter[1],p=j.targetCenter[0],s=j.targetCenter[1],t=n+m*(p-n),u=o+m*(s-o);a.set(r.default.CENTER,[t,u])}if(j.sourceResolution&&j.targetResolution){var v=1===m?j.targetResolution:j.sourceResolution+m*(j.targetResolution-j.sourceResolution);j.anchor&&a.set(r.default.CENTER,a.calculateCenterZoom(v,j.anchor)),a.set(r.default.RESOLUTION,v)}if(void 0!==j.sourceRotation&&void 0!==j.targetRotation){var w=1===m?(0,A.modulo)(j.targetRotation+Math.PI,2*Math.PI)-Math.PI:j.sourceRotation+m*(j.targetRotation-j.sourceRotation);j.anchor&&a.set(r.default.CENTER,a.calculateCenterRotate(w,j.anchor)),a.set(r.default.ROTATION,w)}if(c=!0,!j.complete)break}}if(g){a.animations_[d]=null,a.setHint(q.default.ANIMATING,-1);var x=f[0].callback;x&&e(x,!0)}}this.animations_=this.animations_.filter(Boolean),c&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},b.prototype.calculateCenterRotate=function(a,b){var c,d=this.getCenter();return void 0!==d&&(c=[d[0]-b[0],d[1]-b[1]],(0,u.rotate)(c,a-this.getRotation()),(0,u.add)(c,b)),c},b.prototype.calculateCenterZoom=function(a,b){var c,d=this.getCenter(),e=this.getResolution();if(void 0!==d&&void 0!==e){c=[b[0]-a*(b[0]-d[0])/e,b[1]-a*(b[1]-d[1])/e]}return c},b.prototype.getSizeFromViewport_=function(){var a=[100,100],b='.ol-viewport[data-view="'+(0,k.getUid)(this)+'"]',c=document.querySelector(b);if(c){var d=getComputedStyle(c);a[0]=parseInt(d.width,10),a[1]=parseInt(d.height,10)}return a},b.prototype.constrainCenter=function(a){return this.constraints_.center(a)},b.prototype.constrainResolution=function(a,b,c){var d=b||0,e=c||0;return this.constraints_.resolution(a,d,e)},b.prototype.constrainRotation=function(a,b){var c=b||0;return this.constraints_.rotation(a,c)},b.prototype.getCenter=function(){return this.get(r.default.CENTER)},b.prototype.getConstraints=function(){return this.constraints_},b.prototype.getHints=function(a){return void 0!==a?(a[0]=this.hints_[0],a[1]=this.hints_[1],a):this.hints_.slice()},b.prototype.calculateExtent=function(a){var b=a||this.getSizeFromViewport_(),c=this.getCenter();(0,t.assert)(c,1);var d=this.getResolution();(0,t.assert)(void 0!==d,2);var e=this.getRotation();return(0,t.assert)(void 0!==e,3),(0,w.getForViewAndSize)(c,d,e,b)},b.prototype.getMaxResolution=function(){return this.maxResolution_},b.prototype.getMinResolution=function(){return this.minResolution_},b.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},b.prototype.setMaxZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({maxZoom:a}))},b.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},b.prototype.setMinZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({minZoom:a}))},b.prototype.getProjection=function(){return this.projection_},b.prototype.getResolution=function(){return this.get(r.default.RESOLUTION)},b.prototype.getResolutions=function(){return this.resolutions_},b.prototype.getResolutionForExtent=function(a,b){var c=b||this.getSizeFromViewport_(),d=(0,w.getWidth)(a)/c[0],e=(0,w.getHeight)(a)/c[1];return Math.max(d,e)},b.prototype.getResolutionForValueFunction=function(a){var b=a||2,c=this.maxResolution_,d=this.minResolution_,e=Math.log(c/d)/Math.log(b);return function(a){return c/Math.pow(b,a*e)}},b.prototype.getRotation=function(){return this.get(r.default.ROTATION)},b.prototype.getValueForResolutionFunction=function(a){var b=a||2,c=this.maxResolution_,d=this.minResolution_,e=Math.log(c/d)/Math.log(b);return function(a){return Math.log(c/a)/Math.log(b)/e}},b.prototype.getState=function(a){var b=this.getCenter(),c=this.getProjection(),d=this.getResolution(),e=d/a,f=this.getRotation();return{center:[Math.round(b[0]/e)*e,Math.round(b[1]/e)*e],projection:void 0!==c?c:null,resolution:d,rotation:f,zoom:this.getZoom()}},b.prototype.getZoom=function(){var a,b=this.getResolution();return void 0!==b&&(a=this.getZoomForResolution(b)),a},
b.prototype.getZoomForResolution=function(a){var b,c,d=this.minZoom_||0;if(this.resolutions_){var e=(0,s.linearFindNearest)(this.resolutions_,a,1);d=e,b=this.resolutions_[e],c=e==this.resolutions_.length-1?2:b/this.resolutions_[e+1]}else b=this.maxResolution_,c=this.zoomFactor_;return d+Math.log(b/a)/Math.log(c)},b.prototype.getResolutionForZoom=function(a){return this.constrainResolution(this.maxResolution_,a-this.minZoom_,0)},b.prototype.fit=function(a,b){var c=b||{},d=c.size;d||(d=this.getSizeFromViewport_());var f;a instanceof z.default?a.getType()===x.default.CIRCLE?(a=a.getExtent(),f=(0,y.fromExtent)(a),f.rotate(this.getRotation(),(0,w.getCenter)(a))):f=a:((0,t.assert)(Array.isArray(a),24),(0,t.assert)(!(0,w.isEmpty)(a),25),f=(0,y.fromExtent)(a));var g,h=void 0!==c.padding?c.padding:[0,0,0,0],i=void 0===c.constrainResolution||c.constrainResolution,j=void 0!==c.nearest&&c.nearest;g=void 0!==c.minResolution?c.minResolution:void 0!==c.maxZoom?this.constrainResolution(this.maxResolution_,c.maxZoom-this.minZoom_,0):0;for(var k=f.getFlatCoordinates(),m=this.getRotation(),n=Math.cos(-m),o=Math.sin(-m),p=1/0,q=1/0,r=-1/0,s=-1/0,u=f.getStride(),v=0,A=k.length;v<A;v+=u){var B=k[v]*n-k[v+1]*o,C=k[v]*o+k[v+1]*n;p=Math.min(p,B),q=Math.min(q,C),r=Math.max(r,B),s=Math.max(s,C)}var D=this.getResolutionForExtent([p,q,r,s],[d[0]-h[1]-h[3],d[1]-h[0]-h[2]]);if(D=isNaN(D)?g:Math.max(D,g),i){var E=this.constrainResolution(D,0,0);!j&&E<D&&(E=this.constrainResolution(E,-1,0)),D=E}o=-o;var F=(p+r)/2,G=(q+s)/2;F+=(h[1]-h[3])/2*D,G+=(h[0]-h[2])/2*D;var H=F*n-G*o,I=G*n+F*o,J=[H,I],K=c.callback?c.callback:l.VOID;void 0!==c.duration?this.animate({resolution:D,center:J,duration:c.duration,easing:c.easing},K):(this.setResolution(D),this.setCenter(J),e(K,!0))},b.prototype.centerOn=function(a,b,c){var d=this.getRotation(),e=Math.cos(-d),f=Math.sin(-d),g=a[0]*e-a[1]*f,h=a[1]*e+a[0]*f,i=this.getResolution();g+=(b[0]/2-c[0])*i,h+=(c[1]-b[1]/2)*i,f=-f;var j=g*e-h*f,k=h*e+g*f;this.setCenter([j,k])},b.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},b.prototype.rotate=function(a,b){if(void 0!==b){var c=this.calculateCenterRotate(a,b);this.setCenter(c)}this.setRotation(a)},b.prototype.setCenter=function(a){this.set(r.default.CENTER,a),this.getAnimating()&&this.cancelAnimations()},b.prototype.setHint=function(a,b){return this.hints_[a]+=b,this.changed(),this.hints_[a]},b.prototype.setResolution=function(a){this.set(r.default.RESOLUTION,a),this.getAnimating()&&this.cancelAnimations()},b.prototype.setRotation=function(a){this.set(r.default.ROTATION,a),this.getAnimating()&&this.cancelAnimations()},b.prototype.setZoom=function(a){this.setResolution(this.getResolutionForZoom(a))},b}(n.default),G=F;c.default=G},{"./Object.js":29,"./ViewHint.js":43,"./ViewProperty.js":44,"./array.js":46,"./asserts.js":47,"./centerconstraint.js":48,"./coordinate.js":62,"./easing.js":65,"./extent.js":72,"./functions.js":126,"./geom/GeometryType.js":132,"./geom/Polygon.js":139,"./geom/SimpleGeometry.js":140,"./math.js":199,"./obj.js":201,"./proj.js":210,"./proj/Units.js":212,"./resolutionconstraint.js":277,"./rotationconstraint.js":278,"./tilegrid/common.js":338,"./util.js":342}],43:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ANIMATING:0,INTERACTING:1};c.default=d},{}],44:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};c.default=d},{}],45:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("./PluggableMap.js")),f=a("./control.js"),g=a("./interaction.js"),h=a("./obj.js"),i=d(a("./renderer/webgl/ImageLayer.js")),j=d(a("./renderer/webgl/Map.js")),k=d(a("./renderer/webgl/TileLayer.js")),l=d(a("./renderer/webgl/VectorLayer.js")),m=function(a){function b(b){b=(0,h.assign)({},b),b.controls||(b.controls=(0,f.defaults)()),b.interactions||(b.interactions=(0,g.defaults)()),a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createRenderer=function(){var a=new j.default(this);return a.registerLayerRenderers([i.default,k.default,l.default]),a},b}(e.default),n=m;c.default=n},{"./PluggableMap.js":34,"./control.js":51,"./interaction.js":163,"./obj.js":201,"./renderer/webgl/ImageLayer.js":263,"./renderer/webgl/Map.js":265,"./renderer/webgl/TileLayer.js":266,"./renderer/webgl/VectorLayer.js":267}],46:[function(a,b,c){"use strict";function d(a,b,c){for(var d,f,g=c||e,h=0,i=a.length,j=!1;h<i;)d=h+(i-h>>1),f=+g(a[d],b),f<0?h=d+1:(i=d,j=!f);return j?h:~h}function e(a,b){return a>b?1:a<b?-1:0}function f(a,b){return a.indexOf(b)>=0}function g(a,b,c){var d=a.length;if(a[0]<=b)return 0;if(b<=a[d-1])return d-1;var e;if(c>0){for(e=1;e<d;++e)if(a[e]<b)return e-1}else if(c<0){for(e=1;e<d;++e)if(a[e]<=b)return e}else for(e=1;e<d;++e){if(a[e]==b)return e;if(a[e]<b)return a[e-1]-b<b-a[e]?e-1:e}return d-1}function h(a,b,c){for(;b<c;){var d=a[b];a[b]=a[c],a[c]=d,++b,--c}}function i(a,b){for(var c=Array.isArray(b)?b:[b],d=c.length,e=0;e<d;e++)a[a.length]=c[e]}function j(a,b){var c=a.indexOf(b),d=c>-1;return d&&a.splice(c,1),d}function k(a,b){for(var c,d=a.length>>>0,e=0;e<d;e++)if(c=a[e],b(c,e,a))return c;return null}function l(a,b){var c=a.length;if(c!==b.length)return!1;for(var d=0;d<c;d++)if(a[d]!==b[d])return!1;return!0}function m(a,b){var c,d=a.length,e=Array(a.length);for(c=0;c<d;c++)e[c]={index:c,value:a[c]};for(e.sort(function(a,c){return b(a.value,c.value)||a.index-c.index}),c=0;c<a.length;c++)a[c]=e[c].value}function n(a,b){var c;return a.every(function(d,e){return c=e,!b(d,e,a)})?-1:c}function o(a,b,c){var d=b||e;return a.every(function(b,e){if(0===e)return!0;var f=d(a[e-1],b);return!(f>0||c&&0===f)})}Object.defineProperty(c,"__esModule",{value:!0}),c.binarySearch=d,c.numberSafeCompareFunction=e,c.includes=f,c.linearFindNearest=g,c.reverseSubArray=h,c.extend=i,c.remove=j,c.find=k,c.equals=l,c.stableSort=m,c.findIndex=n,c.isSorted=o},{}],47:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!a)throw new f.default(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.assert=e;var f=d(a("./AssertionError.js"))},{"./AssertionError.js":6}],48:[function(a,b,c){"use strict";function d(a){return function(b){return b?[(0,f.clamp)(b[0],a[0],a[2]),(0,f.clamp)(b[1],a[1],a[3])]:void 0}}function e(a){return a}Object.defineProperty(c,"__esModule",{value:!0}),c.createExtent=d,c.none=e;var f=a("./math.js")},{"./math.js":199}],49:[function(a,b,c){"use strict";function d(a){return"string"==typeof a?a:i(a)}function e(a){var b=document.createElement("div");if(b.style.color=a,""!==b.style.color){document.body.appendChild(b);var c=getComputedStyle(b).color;return document.body.removeChild(b),c}return""}function f(a){return Array.isArray(a)?a:n(a)}function g(a){var b,c,d,f,g;if(m.exec(a)&&(a=e(a)),l.exec(a)){var i,k=a.length-1;i=k<=4?1:2;var n=4===k||8===k;b=parseInt(a.substr(1+0*i,i),16),c=parseInt(a.substr(1+1*i,i),16),d=parseInt(a.substr(1+2*i,i),16),f=n?parseInt(a.substr(1+3*i,i),16):255,1==i&&(b=(b<<4)+b,c=(c<<4)+c,d=(d<<4)+d,n&&(f=(f<<4)+f)),g=[b,c,d,f/255]}else 0==a.indexOf("rgba(")?(g=a.slice(5,-1).split(",").map(Number),h(g)):0==a.indexOf("rgb(")?(g=a.slice(4,-1).split(",").map(Number),g.push(1),h(g)):(0,j.assert)(!1,14);return g}function h(a){return a[0]=(0,k.clamp)(a[0]+.5|0,0,255),a[1]=(0,k.clamp)(a[1]+.5|0,0,255),a[2]=(0,k.clamp)(a[2]+.5|0,0,255),a[3]=(0,k.clamp)(a[3],0,1),a}function i(a){var b=a[0];b!=(0|b)&&(b=b+.5|0);var c=a[1];c!=(0|c)&&(c=c+.5|0);var d=a[2];return d!=(0|d)&&(d=d+.5|0),"rgba("+b+","+c+","+d+","+(void 0===a[3]?1:a[3])+")"}Object.defineProperty(c,"__esModule",{value:!0}),c.asString=d,c.asArray=f,c.normalize=h,c.toString=i,c.fromString=void 0;var j=a("./asserts.js"),k=a("./math.js"),l=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,m=/^([a-z]*)$/i,n=function(){var a={},b=0;return function(c){var d;if(a.hasOwnProperty(c))d=a[c];else{if(b>=1024){var e=0;for(var f in a)0==(3&e++)&&(delete a[f],--b)}d=g(c),a[c]=d,++b}return d}}();c.fromString=n},{"./asserts.js":47,"./math.js":199}],50:[function(a,b,c){"use strict";function d(a){return e(a)?a:(0,f.toString)(a)}function e(a){return"string"==typeof a||a instanceof CanvasPattern||a instanceof CanvasGradient}Object.defineProperty(c,"__esModule",{value:!0}),c.asColorLike=d,c.isColorLike=e;var f=a("./color.js")},{"./color.js":49}],51:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Attribution",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Control",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"FullScreen",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"OverviewMap",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Rotate",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"ScaleLine",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Zoom",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"ZoomSlider",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"ZoomToExtent",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"defaults",{enumerable:!0,get:function(){return n.defaults}});var e=d(a("./control/Attribution.js")),f=d(a("./control/Control.js")),g=d(a("./control/FullScreen.js")),h=d(a("./control/OverviewMap.js")),i=d(a("./control/Rotate.js")),j=d(a("./control/ScaleLine.js")),k=d(a("./control/Zoom.js")),l=d(a("./control/ZoomSlider.js")),m=d(a("./control/ZoomToExtent.js")),n=a("./control/util.js")},{"./control/Attribution.js":52,"./control/Control.js":53,"./control/FullScreen.js":54,"./control/OverviewMap.js":55,"./control/Rotate.js":56,"./control/ScaleLine.js":57,"./control/Zoom.js":58,"./control/ZoomSlider.js":59,"./control/ZoomToExtent.js":60,"./control/util.js":61}],52:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){this.updateElement_(a.frameState)}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=a("../array.js"),g=d(a("../control/Control.js")),h=a("../css.js"),i=a("../dom.js"),j=a("../events.js"),k=d(a("../events/EventType.js")),l=a("../layer/Layer.js"),m=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===c.collapsed||c.collapsed,this.collapsible_=void 0===c.collapsible||c.collapsible,this.collapsible_||(this.collapsed_=!1);var d=void 0!==c.className?c.className:"ol-attribution",f=void 0!==c.tipLabel?c.tipLabel:"Attributions",g=void 0!==c.collapseLabel?c.collapseLabel:"»";"string"==typeof g?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=g):this.collapseLabel_=g;var i=void 0!==c.label?c.label:"i";"string"==typeof i?(this.label_=document.createElement("span"),this.label_.textContent=i):this.label_=i;var l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,m=document.createElement("button");m.setAttribute("type","button"),m.title=f,m.appendChild(l),(0,j.listen)(m,k.default.CLICK,this.handleClick_,this);var n=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+h.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),o=this.element;o.className=n,o.appendChild(this.ulElement_),o.appendChild(m),this.renderedAttributions_=[],this.renderedVisible_=!0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getSourceAttributions_=function(a){for(var b={},c=[],d=a.layerStatesArray,e=a.viewState.resolution,f=0,g=d.length;f<g;++f){var h=d[f];if((0,l.visibleAtResolution)(h,e)){var i=h.layer.getSource();if(i){var j=i.getAttributions();if(j){var k=j(a);if(k)if(Array.isArray(k))for(var m=0,n=k.length;m<n;++m)k[m]in b||(c.push(k[m]),b[k[m]]=!0);else k in b||(c.push(k),b[k]=!0)}}}}return c},b.prototype.updateElement_=function(a){var b=this;if(!a)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));var c=this.getSourceAttributions_(a),d=c.length>0;if(this.renderedVisible_!=d&&(this.element.style.display=d?"":"none",this.renderedVisible_=d),!(0,f.equals)(c,this.renderedAttributions_)){(0,i.removeChildren)(this.ulElement_);for(var e=0,g=c.length;e<g;++e){var h=document.createElement("li");h.innerHTML=c[e],b.ulElement_.appendChild(h)}this.renderedAttributions_=c}},b.prototype.handleClick_=function(a){a.preventDefault(),this.handleToggle_()},b.prototype.handleToggle_=function(){this.element.classList.toggle(h.CLASS_COLLAPSED),this.collapsed_?(0,i.replaceNode)(this.collapseLabel_,this.label_):(0,i.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},b.prototype.getCollapsible=function(){return this.collapsible_},b.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())},b.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()},b.prototype.getCollapsed=function(){return this.collapsed_},b}(g.default),n=m;c.default=n},{"../array.js":46,"../control/Control.js":53,"../css.js":63,"../dom.js":64,"../events.js":66,"../events/EventType.js":68,"../layer/Layer.js":190}],53:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../functions.js"),f=d(a("../MapEventType.js")),g=d(a("../Object.js")),h=a("../dom.js"),i=a("../events.js"),j=function(a){function b(b){a.call(this),this.element=b.element?b.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=b.render?b.render:e.VOID,b.target&&this.setTarget(b.target)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){(0,h.removeNode)(this.element),a.prototype.disposeInternal.call(this)},b.prototype.getMap=function(){return this.map_},b.prototype.setMap=function(a){var b=this;this.map_&&(0,h.removeNode)(this.element);for(var c=0,d=this.listenerKeys.length;c<d;++c)(0,i.unlistenByKey)(b.listenerKeys[c]);if(this.listenerKeys.length=0,this.map_=a,this.map_){(this.target_?this.target_:a.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==e.VOID&&this.listenerKeys.push((0,i.listen)(a,f.default.POSTRENDER,this.render,this)),a.render()}},b.prototype.setTarget=function(a){this.target_="string"==typeof a?document.getElementById(a):a},b}(g.default),k=j;c.default=k},{"../MapEventType.js":27,"../Object.js":29,"../dom.js":64,"../events.js":66,"../functions.js":126}],54:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){var a=document.body;return!!(a.webkitRequestFullscreen||a.mozRequestFullScreen&&document.mozFullScreenEnabled||a.msRequestFullscreen&&document.msFullscreenEnabled||a.requestFullscreen&&document.fullscreenEnabled)}function f(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}function g(a){a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}function h(a){a.mozRequestFullScreenWithKeys?a.mozRequestFullScreenWithKeys():a.webkitRequestFullscreen?a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):g(a)}function i(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var j=d(a("../control/Control.js")),k=a("../css.js"),l=a("../dom.js"),m=a("../events.js"),n=d(a("../events/EventType.js")),o=function(){var a;return function(){if(!a){var b=document.body;b.webkitRequestFullscreen?a="webkitfullscreenchange":b.mozRequestFullScreen?a="mozfullscreenchange":b.msRequestFullscreen?a="MSFullscreenChange":b.requestFullscreen&&(a="fullscreenchange")}return a}}(),p=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),target:c.target}),this.cssClassName_=void 0!==c.className?c.className:"ol-full-screen";var d=void 0!==c.label?c.label:"⤢";this.labelNode_="string"==typeof d?document.createTextNode(d):d;var g=void 0!==c.labelActive?c.labelActive:"×";this.labelActiveNode_="string"==typeof g?document.createTextNode(g):g;var h=c.tipLabel?c.tipLabel:"Toggle full-screen",i=document.createElement("button");i.className=this.cssClassName_+"-"+f(),i.setAttribute("type","button"),i.title=h,i.appendChild(this.labelNode_),(0,m.listen)(i,n.default.CLICK,this.handleClick_,this);var j=this.cssClassName_+" "+k.CLASS_UNSELECTABLE+" "+k.CLASS_CONTROL+" "+(e()?"":k.CLASS_UNSUPPORTED),l=this.element;l.className=j,l.appendChild(i),this.keys_=void 0!==c.keys&&c.keys,this.source_=c.source}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a){a.preventDefault(),this.handleFullScreen_()},b.prototype.handleFullScreen_=function(){if(e()){var a=this.getMap();if(a)if(f())i();else{var b;b=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:a.getTargetElement(),this.keys_?h(b):g(b)}}},b.prototype.handleFullScreenChange_=function(){var a=this.element.firstElementChild,b=this.getMap();f()?(a.className=this.cssClassName_+"-true",(0,l.replaceNode)(this.labelActiveNode_,this.labelNode_)):(a.className=this.cssClassName_+"-false",(0,l.replaceNode)(this.labelNode_,this.labelActiveNode_)),b&&b.updateSize()},b.prototype.setMap=function(b){a.prototype.setMap.call(this,b),b&&this.listenerKeys.push((0,m.listen)(document,o(),this.handleFullScreenChange_,this))},b}(j.default),q=p;c.default=q},{"../control/Control.js":53,"../css.js":63,"../dom.js":64,"../events.js":66,"../events/EventType.js":68}],55:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){this.validateExtent_(),this.updateBox_()}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=d(a("../Collection.js")),g=d(a("../Map.js")),h=d(a("../MapEventType.js")),i=d(a("../MapProperty.js")),j=a("../Object.js"),k=d(a("../ObjectEventType.js")),l=d(a("../Overlay.js")),m=d(a("../OverlayPositioning.js")),n=d(a("../ViewProperty.js")),o=d(a("../control/Control.js")),p=a("../coordinate.js"),q=a("../css.js"),r=a("../dom.js"),s=a("../events.js"),t=d(a("../events/EventType.js")),u=a("../extent.js"),v=.75,w=.1,x=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target}),this.collapsed_=void 0===c.collapsed||c.collapsed,this.collapsible_=void 0===c.collapsible||c.collapsible,this.collapsible_||(this.collapsed_=!1);var d=void 0!==c.className?c.className:"ol-overviewmap",h=void 0!==c.tipLabel?c.tipLabel:"Overview map",i=void 0!==c.collapseLabel?c.collapseLabel:"«";"string"==typeof i?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=i):this.collapseLabel_=i;var j=void 0!==c.label?c.label:"»";"string"==typeof j?(this.label_=document.createElement("span"),this.label_.textContent=j):this.label_=j;var k=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,n=document.createElement("button");n.setAttribute("type","button"),n.title=h,n.appendChild(k),(0,s.listen)(n,t.default.CLICK,this.handleClick_,this),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.ovmap_=new g.default({controls:new f.default,interactions:new f.default,view:c.view});var o=this.ovmap_;c.layers&&c.layers.forEach(function(a){o.addLayer(a)}.bind(this));var p=document.createElement("div");p.className="ol-overviewmap-box",p.style.boxSizing="border-box",this.boxOverlay_=new l.default({position:[0,0],positioning:m.default.BOTTOM_LEFT,element:p}),this.ovmap_.addOverlay(this.boxOverlay_);var r=d+" "+q.CLASS_UNSELECTABLE+" "+q.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+q.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=r,u.appendChild(this.ovmapDiv_),u.appendChild(n);var v=this,w=this.boxOverlay_,x=this.boxOverlay_.getElement(),y=function(a){return{clientX:a.clientX-x.offsetWidth/2,clientY:a.clientY+x.offsetHeight/2}},z=function(a){var b=o.getEventCoordinate(y(a));w.setPosition(b)},A=function a(b){var c=o.getEventCoordinate(b);v.getMap().getView().setCenter(c),window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",a)};x.addEventListener("mousedown",function(){window.addEventListener("mousemove",z),window.addEventListener("mouseup",A)})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setMap=function(b){var c=this.getMap();if(b!==c){if(c){var d=c.getView();d&&this.unbindView_(d),this.ovmap_.setTarget(null)}if(a.prototype.setMap.call(this,b),b){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,s.listen)(b,k.default.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(b.getLayerGroup());var e=b.getView();e&&(this.bindView_(e),e.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},b.prototype.handleMapPropertyChange_=function(a){if(a.key===i.default.VIEW){var b=a.oldValue;b&&this.unbindView_(b);var c=this.getMap().getView();this.bindView_(c)}},b.prototype.bindView_=function(a){(0,s.listen)(a,(0,j.getChangeEventType)(n.default.ROTATION),this.handleRotationChanged_,this)},b.prototype.unbindView_=function(a){(0,s.unlisten)(a,(0,j.getChangeEventType)(n.default.ROTATION),this.handleRotationChanged_,this)},b.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},b.prototype.validateExtent_=function(){var a=this.getMap(),b=this.ovmap_;if(a.isRendered()&&b.isRendered()){var c=a.getSize(),d=a.getView(),e=d.calculateExtent(c),f=b.getSize(),g=b.getView(),h=g.calculateExtent(f),i=b.getPixelFromCoordinate((0,u.getTopLeft)(e)),j=b.getPixelFromCoordinate((0,u.getBottomRight)(e)),k=Math.abs(i[0]-j[0]),l=Math.abs(i[1]-j[1]),m=f[0],n=f[1];k<m*w||l<n*w||k>m*v||l>n*v?this.resetExtent_():(0,u.containsExtent)(h,e)||this.recenter_()}},b.prototype.resetExtent_=function(){if(0!==v&&0!==w){var a=this.getMap(),b=this.ovmap_,c=a.getSize(),d=a.getView(),e=d.calculateExtent(c),f=b.getView(),g=Math.log(v/w)/Math.LN2,h=1/(Math.pow(2,g/2)*w);(0,u.scaleFromCenter)(e,h),f.fit(e)}},b.prototype.recenter_=function(){var a=this.getMap(),b=this.ovmap_,c=a.getView();b.getView().setCenter(c.getCenter())},b.prototype.updateBox_=function(){var a=this.getMap(),b=this.ovmap_;if(a.isRendered()&&b.isRendered()){var c=a.getSize(),d=a.getView(),e=b.getView(),f=d.getRotation(),g=this.boxOverlay_,h=this.boxOverlay_.getElement(),i=d.calculateExtent(c),j=e.getResolution(),k=(0,u.getBottomLeft)(i),l=(0,u.getTopRight)(i),m=this.calculateCoordinateRotate_(f,k);g.setPosition(m),h&&(h.style.width=Math.abs((k[0]-l[0])/j)+"px",h.style.height=Math.abs((l[1]-k[1])/j)+"px")}},b.prototype.calculateCoordinateRotate_=function(a,b){var c,d=this.getMap(),e=d.getView(),f=e.getCenter();return f&&(c=[b[0]-f[0],b[1]-f[1]],(0,p.rotate)(c,a),(0,p.add)(c,f)),c},b.prototype.handleClick_=function(a){a.preventDefault(),this.handleToggle_()},b.prototype.handleToggle_=function(){this.element.classList.toggle(q.CLASS_COLLAPSED),this.collapsed_?(0,r.replaceNode)(this.collapseLabel_,this.label_):(0,r.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var a=this.ovmap_;this.collapsed_||a.isRendered()||(a.updateSize(),this.resetExtent_(),(0,s.listenOnce)(a,h.default.POSTRENDER,function(a){this.updateBox_()},this))},b.prototype.getCollapsible=function(){return this.collapsible_},b.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())},b.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()},b.prototype.getCollapsed=function(){return this.collapsed_},b.prototype.getOverviewMap=function(){return this.ovmap_},b}(o.default),y=x;c.default=y},{"../Collection.js":7,"../Map.js":21,"../MapEventType.js":27,"../MapProperty.js":28,"../Object.js":29,"../ObjectEventType.js":30,"../Overlay.js":32,"../OverlayPositioning.js":33,"../ViewProperty.js":44,"../control/Control.js":53,"../coordinate.js":62,"../css.js":63,"../dom.js":64,"../events.js":66,"../events/EventType.js":68,"../extent.js":72}],56:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=a.frameState;if(b){var c=b.viewState.rotation;if(c!=this.rotation_){var d="rotate("+c+"rad)";if(this.autoHide_){var e=this.element.classList.contains(g.CLASS_HIDDEN);e||0!==c?e&&0!==c&&this.element.classList.remove(g.CLASS_HIDDEN):this.element.classList.add(g.CLASS_HIDDEN)}this.label_.style.msTransform=d,this.label_.style.webkitTransform=d,this.label_.style.transform=d}this.rotation_=c}}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=d(a("../control/Control.js")),g=a("../css.js"),h=a("../easing.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target});var d=void 0!==c.className?c.className:"ol-rotate",f=void 0!==c.label?c.label:"⇧";this.label_=null,"string"==typeof f?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=f):(this.label_=f,this.label_.classList.add("ol-compass"));var h=c.tipLabel?c.tipLabel:"Reset rotation",k=document.createElement("button");k.className=d+"-reset",k.setAttribute("type","button"),k.title=h,k.appendChild(this.label_),(0,i.listen)(k,j.default.CLICK,this.handleClick_,this);var l=d+" "+g.CLASS_UNSELECTABLE+" "+g.CLASS_CONTROL,m=this.element;m.className=l,m.appendChild(k),this.callResetNorth_=c.resetNorth?c.resetNorth:void 0,this.duration_=void 0!==c.duration?c.duration:250,this.autoHide_=void 0===c.autoHide||c.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(g.CLASS_HIDDEN)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a){a.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},b.prototype.resetNorth_=function(){var a=this.getMap(),b=a.getView();b&&void 0!==b.getRotation()&&(this.duration_>0?b.animate({rotation:0,duration:this.duration_,easing:h.easeOut}):b.setRotation(0))},b}(f.default),l=k;c.default=l},{"../control/Control.js":53,"../css.js":63,"../easing.js":65,"../events.js":66,"../events/EventType.js":68}],57:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=a.frameState;this.viewState_=b?b.viewState:null,this.updateElement_()}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=c.Units=void 0;var f=a("../Object.js"),g=a("../asserts.js"),h=d(a("../control/Control.js")),i=a("../css.js"),j=a("../events.js"),k=a("../proj.js"),l=d(a("../proj/Units.js")),m="units",n={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};c.Units=n;var o=[1,2,5],p=function(a){function b(b){var c=b||{},d=void 0!==c.className?c.className:"ol-scale-line";a.call(this,{element:document.createElement("div"),render:c.render||e,target:c.target}),this.innerElement_=document.createElement("div"),this.innerElement_.className=d+"-inner",this.element.className=d+" "+i.CLASS_UNSELECTABLE,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==c.minWidth?c.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",(0,j.listen)(this,(0,f.getChangeEventType)(m),this.handleUnitsChanged_,this),this.setUnits(c.units||n.METRIC)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getUnits=function(){return this.get(m)},b.prototype.handleUnitsChanged_=function(){this.updateElement_()},b.prototype.setUnits=function(a){this.set(m,a)},b.prototype.updateElement_=function(){var a=this,b=this.viewState_;if(!b)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));var c=b.center,d=b.projection,e=this.getUnits(),f=e==n.DEGREES?l.default.DEGREES:l.default.METERS,h=(0,k.getPointResolution)(d,b.resolution,c,f);d.getUnits()!=l.default.DEGREES&&d.getMetersPerUnit()&&f==l.default.METERS&&(h*=d.getMetersPerUnit());var i=this.minWidth_*h,j="";if(e==n.DEGREES){var m=k.METERS_PER_UNIT[l.default.DEGREES];d.getUnits()==l.default.DEGREES?i*=m:h/=m,i<m/60?(j="″",h*=3600):i<m?(j="′",h*=60):j="°"}else e==n.IMPERIAL?i<.9144?(j="in",h/=.0254):i<1609.344?(j="ft",h/=.3048):(j="mi",h/=1609.344):e==n.NAUTICAL?(h/=1852,j="nm"):e==n.METRIC?i<.001?(j="μm",h*=1e6):i<1?(j="mm",h*=1e3):i<1e3?j="m":(j="km",h/=1e3):e==n.US?i<.9144?(j="in",h*=39.37):i<1609.344?(j="ft",h/=.30480061):(j="mi",h/=1609.3472):(0,g.assert)(!1,33);for(var p,q,r=3*Math.floor(Math.log(this.minWidth_*h)/Math.log(10));;){if(p=o[(r%3+3)%3]*Math.pow(10,Math.floor(r/3)),q=Math.round(p/h),isNaN(q))return a.element.style.display="none",void(a.renderedVisible_=!1);if(q>=a.minWidth_)break;++r}var s=p+" "+j;this.renderedHTML_!=s&&(this.innerElement_.innerHTML=s,this.renderedHTML_=s),this.renderedWidth_!=q&&(this.innerElement_.style.width=q+"px",this.renderedWidth_=q),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)},b}(h.default),q=p;c.default=q},{"../Object.js":29,"../asserts.js":47,"../control/Control.js":53,"../css.js":63,"../events.js":66,"../proj.js":210,"../proj/Units.js":212}],58:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../events.js"),f=d(a("../events/EventType.js")),g=d(a("../control/Control.js")),h=a("../css.js"),i=a("../easing.js"),j=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),target:c.target});var d=void 0!==c.className?c.className:"ol-zoom",g=void 0!==c.delta?c.delta:1,i=void 0!==c.zoomInLabel?c.zoomInLabel:"+",j=void 0!==c.zoomOutLabel?c.zoomOutLabel:"−",k=void 0!==c.zoomInTipLabel?c.zoomInTipLabel:"Zoom in",l=void 0!==c.zoomOutTipLabel?c.zoomOutTipLabel:"Zoom out",m=document.createElement("button");m.className=d+"-in",m.setAttribute("type","button"),m.title=k,m.appendChild("string"==typeof i?document.createTextNode(i):i),(0,e.listen)(m,f.default.CLICK,this.handleClick_.bind(this,g));var n=document.createElement("button");n.className=d+"-out",n.setAttribute("type","button"),n.title=l,n.appendChild("string"==typeof j?document.createTextNode(j):j),(0,e.listen)(n,f.default.CLICK,this.handleClick_.bind(this,-g));var o=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,p=this.element;p.className=o,p.appendChild(m),p.appendChild(n),this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a,b){b.preventDefault(),this.zoomByDelta_(a)},b.prototype.zoomByDelta_=function(a){var b=this.getMap(),c=b.getView();if(c){var d=c.getResolution();if(d){var e=c.constrainResolution(d,a)
;this.duration_>0?(c.getAnimating()&&c.cancelAnimations(),c.animate({resolution:e,duration:this.duration_,easing:i.easeOut})):c.setResolution(e)}}},b}(g.default),k=j;c.default=k},{"../control/Control.js":53,"../css.js":63,"../easing.js":65,"../events.js":66,"../events/EventType.js":68}],59:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a.frameState){this.sliderInitialized_||this.initSlider_();var b=a.frameState.viewState.resolution;b!==this.currentResolution_&&(this.currentResolution_=b,this.setThumbPosition_(b))}}Object.defineProperty(c,"__esModule",{value:!0}),c.render=e,c.default=void 0;var f=d(a("../ViewHint.js")),g=d(a("../control/Control.js")),h=a("../css.js"),i=a("../easing.js"),j=a("../events.js"),k=a("../events/Event.js"),l=d(a("../events/EventType.js")),m=a("../math.js"),n=d(a("../pointer/EventType.js")),o=d(a("../pointer/PointerEventHandler.js")),p={VERTICAL:0,HORIZONTAL:1},q=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),render:c.render||e}),this.currentResolution_=void 0,this.direction_=p.VERTICAL,this.dragging_,this.heightLimit_=0,this.widthLimit_=0,this.previousX_,this.previousY_,this.thumbSize_=null,this.sliderInitialized_=!1,this.duration_=void 0!==c.duration?c.duration:200;var d=void 0!==c.className?c.className:"ol-zoomslider",f=document.createElement("button");f.setAttribute("type","button"),f.className=d+"-thumb "+h.CLASS_UNSELECTABLE;var g=this.element;g.className=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,g.appendChild(f),this.dragger_=new o.default(g),(0,j.listen)(this.dragger_,n.default.POINTERDOWN,this.handleDraggerStart_,this),(0,j.listen)(this.dragger_,n.default.POINTERMOVE,this.handleDraggerDrag_,this),(0,j.listen)(this.dragger_,n.default.POINTERUP,this.handleDraggerEnd_,this),(0,j.listen)(g,l.default.CLICK,this.handleContainerClick_,this),(0,j.listen)(f,l.default.CLICK,k.stopPropagation)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.dragger_.dispose(),a.prototype.disposeInternal.call(this)},b.prototype.setMap=function(b){a.prototype.setMap.call(this,b),b&&b.render()},b.prototype.initSlider_=function(){var a=this.element,b={width:a.offsetWidth,height:a.offsetHeight},c=a.firstElementChild,d=getComputedStyle(c),e=c.offsetWidth+parseFloat(d.marginRight)+parseFloat(d.marginLeft),f=c.offsetHeight+parseFloat(d.marginTop)+parseFloat(d.marginBottom);this.thumbSize_=[e,f],b.width>b.height?(this.direction_=p.HORIZONTAL,this.widthLimit_=b.width-e):(this.direction_=p.VERTICAL,this.heightLimit_=b.height-f),this.sliderInitialized_=!0},b.prototype.handleContainerClick_=function(a){var b=this.getMap().getView(),c=this.getRelativePosition_(a.offsetX-this.thumbSize_[0]/2,a.offsetY-this.thumbSize_[1]/2),d=this.getResolutionForPosition_(c);b.animate({resolution:b.constrainResolution(d),duration:this.duration_,easing:i.easeOut})},b.prototype.handleDraggerStart_=function(a){this.dragging_||a.originalEvent.target!==this.element.firstElementChild||(this.getMap().getView().setHint(f.default.INTERACTING,1),this.previousX_=a.clientX,this.previousY_=a.clientY,this.dragging_=!0)},b.prototype.handleDraggerDrag_=function(a){if(this.dragging_){var b=this.element.firstElementChild,c=a.clientX-this.previousX_+parseInt(b.style.left,10),d=a.clientY-this.previousY_+parseInt(b.style.top,10),e=this.getRelativePosition_(c,d);this.currentResolution_=this.getResolutionForPosition_(e),this.getMap().getView().setResolution(this.currentResolution_),this.setThumbPosition_(this.currentResolution_),this.previousX_=a.clientX,this.previousY_=a.clientY}},b.prototype.handleDraggerEnd_=function(a){if(this.dragging_){var b=this.getMap().getView();b.setHint(f.default.INTERACTING,-1),b.animate({resolution:b.constrainResolution(this.currentResolution_),duration:this.duration_,easing:i.easeOut}),this.dragging_=!1,this.previousX_=void 0,this.previousY_=void 0}},b.prototype.setThumbPosition_=function(a){var b=this.getPositionForResolution_(a),c=this.element.firstElementChild;this.direction_==p.HORIZONTAL?c.style.left=this.widthLimit_*b+"px":c.style.top=this.heightLimit_*b+"px"},b.prototype.getRelativePosition_=function(a,b){var c;return c=this.direction_===p.HORIZONTAL?a/this.widthLimit_:b/this.heightLimit_,(0,m.clamp)(c,0,1)},b.prototype.getResolutionForPosition_=function(a){return this.getMap().getView().getResolutionForValueFunction()(1-a)},b.prototype.getPositionForResolution_=function(a){return 1-this.getMap().getView().getValueForResolutionFunction()(a)},b}(g.default),r=q;c.default=r},{"../ViewHint.js":43,"../control/Control.js":53,"../css.js":63,"../easing.js":65,"../events.js":66,"../events/Event.js":67,"../events/EventType.js":68,"../math.js":199,"../pointer/EventType.js":203,"../pointer/PointerEventHandler.js":208}],60:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../events.js"),f=d(a("../events/EventType.js")),g=d(a("../control/Control.js")),h=a("../css.js"),i=function(a){function b(b){var c=b||{};a.call(this,{element:document.createElement("div"),target:c.target}),this.extent=c.extent?c.extent:null;var d=void 0!==c.className?c.className:"ol-zoom-extent",g=void 0!==c.label?c.label:"E",i=void 0!==c.tipLabel?c.tipLabel:"Fit to extent",j=document.createElement("button");j.setAttribute("type","button"),j.title=i,j.appendChild("string"==typeof g?document.createTextNode(g):g),(0,e.listen)(j,f.default.CLICK,this.handleClick_,this);var k=d+" "+h.CLASS_UNSELECTABLE+" "+h.CLASS_CONTROL,l=this.element;l.className=k,l.appendChild(j)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleClick_=function(a){a.preventDefault(),this.handleZoomToExtent()},b.prototype.handleZoomToExtent=function(){var a=this.getMap(),b=a.getView(),c=this.extent?this.extent:b.getProjection().getExtent();b.fit(c)},b}(g.default),j=i;c.default=j},{"../control/Control.js":53,"../css.js":63,"../events.js":66,"../events/EventType.js":68}],61:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=a||{},c=new f.default;return(void 0===b.zoom||b.zoom)&&c.push(new i.default(b.zoomOptions)),(void 0===b.rotate||b.rotate)&&c.push(new h.default(b.rotateOptions)),(void 0===b.attribution||b.attribution)&&c.push(new g.default(b.attributionOptions)),c}Object.defineProperty(c,"__esModule",{value:!0}),c.defaults=e;var f=d(a("../Collection.js")),g=d(a("./Attribution.js")),h=d(a("./Rotate.js")),i=d(a("./Zoom.js"))},{"../Collection.js":7,"./Attribution.js":52,"./Rotate.js":56,"./Zoom.js":58}],62:[function(a,b,c){"use strict";function d(a,b){return a[0]+=b[0],a[1]+=b[1],a}function e(a,b){var c=b.getRadius(),d=b.getCenter(),e=d[0],f=d[1],g=a[0],h=a[1],i=g-e,j=h-f;0===i&&0===j&&(i=1);var k=Math.sqrt(i*i+j*j);return[e+c*i/k,f+c*j/k]}function f(a,b){var c,d,e=a[0],f=a[1],g=b[0],h=b[1],i=g[0],j=g[1],k=h[0],l=h[1],m=k-i,n=l-j,o=0===m&&0===n?0:(m*(e-i)+n*(f-j))/(m*m+n*n||0);return o<=0?(c=i,d=j):o>=1?(c=k,d=l):(c=i+o*m,d=j+o*n),[c,d]}function g(a){return function(b){return q(b,a)}}function h(a,b,c){var d=(0,r.modulo)(b+180,360)-180,e=Math.abs(3600*d),f=c||0,g=Math.pow(10,f),h=Math.floor(e/3600),i=Math.floor((e-3600*h)/60),j=e-3600*h-60*i;return j=Math.ceil(j*g)/g,j>=60&&(j=0,i+=1),i>=60&&(i=0,h+=1),h+"° "+(0,s.padNumber)(i,2)+"′ "+(0,s.padNumber)(j,2,f)+"″"+(0==d?"":" "+a.charAt(d<0?1:0))}function i(a,b,c){return a?b.replace("{x}",a[0].toFixed(c)).replace("{y}",a[1].toFixed(c)):""}function j(a,b){for(var c=!0,d=a.length-1;d>=0;--d)if(a[d]!=b[d]){c=!1;break}return c}function k(a,b){var c=Math.cos(b),d=Math.sin(b),e=a[0]*c-a[1]*d,f=a[1]*c+a[0]*d;return a[0]=e,a[1]=f,a}function l(a,b){return a[0]*=b,a[1]*=b,a}function m(a,b){var c=a[0]-b[0],d=a[1]-b[1];return c*c+d*d}function n(a,b){return Math.sqrt(m(a,b))}function o(a,b){return m(a,f(a,b))}function p(a,b){return a?h("NS",a[1],b)+" "+h("EW",a[0],b):""}function q(a,b){return i(a,"{x}, {y}",b)}Object.defineProperty(c,"__esModule",{value:!0}),c.add=d,c.closestOnCircle=e,c.closestOnSegment=f,c.createStringXY=g,c.degreesToStringHDMS=h,c.format=i,c.equals=j,c.rotate=k,c.scale=l,c.squaredDistance=m,c.distance=n,c.squaredDistanceToSegment=o,c.toStringHDMS=p,c.toStringXY=q;var r=a("./math.js"),s=a("./string.js")},{"./math.js":199,"./string.js":313}],63:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getFontFamilies=c.CLASS_COLLAPSED=c.CLASS_CONTROL=c.CLASS_UNSUPPORTED=c.CLASS_UNSELECTABLE=c.CLASS_SELECTABLE=c.CLASS_HIDDEN=void 0,c.CLASS_HIDDEN="ol-hidden",c.CLASS_SELECTABLE="ol-selectable",c.CLASS_UNSELECTABLE="ol-unselectable",c.CLASS_UNSUPPORTED="ol-unsupported",c.CLASS_CONTROL="ol-control",c.CLASS_COLLAPSED="ol-collapsed";var d=function(){var a,b={};return function(c){if(a||(a=document.createElement("div").style),!(c in b)){a.font=c;var d=a.fontFamily;if(a.font="",!d)return null;b[c]=d.split(/,\s?/)}return b[c]}}();c.getFontFamilies=d},{}],64:[function(a,b,c){"use strict";function d(a,b){var c=document.createElement("canvas");return a&&(c.width=a),b&&(c.height=b),c.getContext("2d")}function e(a){var b=a.offsetWidth,c=getComputedStyle(a);return b+=parseInt(c.marginLeft,10)+parseInt(c.marginRight,10)}function f(a){var b=a.offsetHeight,c=getComputedStyle(a);return b+=parseInt(c.marginTop,10)+parseInt(c.marginBottom,10)}function g(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)}function h(a){return a&&a.parentNode?a.parentNode.removeChild(a):null}function i(a){for(;a.lastChild;)a.removeChild(a.lastChild)}Object.defineProperty(c,"__esModule",{value:!0}),c.createCanvasContext2D=d,c.outerWidth=e,c.outerHeight=f,c.replaceNode=g,c.removeNode=h,c.removeChildren=i},{}],65:[function(a,b,c){"use strict";function d(a){return Math.pow(a,3)}function e(a){return 1-d(1-a)}function f(a){return 3*a*a-2*a*a*a}function g(a){return a}function h(a){return a<.5?f(2*a):1-f(2*(a-.5))}Object.defineProperty(c,"__esModule",{value:!0}),c.easeIn=d,c.easeOut=e,c.inAndOut=f,c.linear=g,c.upAndDown=h},{}],66:[function(a,b,c){"use strict";function d(a){var b=function(b){var c=a.listener,d=a.bindTo||a.target;return a.callOnce&&l(a),c.call(d,b)};return a.boundListener=b,b}function e(a,b,c,d){for(var e,f=0,g=a.length;f<g;++f)if(e=a[f],e.listener===b&&e.bindTo===c)return d&&(e.deleteIndex=f),e}function f(a,b){var c=a.ol_lm;return c?c[b]:void 0}function g(a){var b=a.ol_lm;return b||(b=a.ol_lm={}),b}function h(a,b){var c=f(a,b);if(c){for(var d=0,e=c.length;d<e;++d)a.removeEventListener(b,c[d].boundListener),(0,n.clear)(c[d]);c.length=0;var g=a.ol_lm;g&&(delete g[b],0===Object.keys(g).length&&delete a.ol_lm)}}function i(a,b,c,f,h){var i=g(a),j=i[b];j||(j=i[b]=[]);var k=e(j,c,f,!1);return k?h||(k.callOnce=!1):(k={bindTo:f,callOnce:!!h,listener:c,target:a,type:b},a.addEventListener(b,d(k)),j.push(k)),k}function j(a,b,c,d){return i(a,b,c,d,!0)}function k(a,b,c,d){var g=f(a,b);if(g){var h=e(g,c,d,!0);h&&l(h)}}function l(a){if(a&&a.target){a.target.removeEventListener(a.type,a.boundListener);var b=f(a.target,a.type);if(b){var c="deleteIndex"in a?a.deleteIndex:b.indexOf(a);-1!==c&&b.splice(c,1),0===b.length&&h(a.target,a.type)}(0,n.clear)(a)}}function m(a){var b=g(a);for(var c in b)h(a,c)}Object.defineProperty(c,"__esModule",{value:!0}),c.bindListener=d,c.findListener=e,c.getListeners=f,c.listen=i,c.listenOnce=j,c.unlisten=k,c.unlistenByKey=l,c.unlistenAll=m;var n=a("./obj.js")},{"./obj.js":201}],67:[function(a,b,c){"use strict";function d(a){a.stopPropagation()}function e(a){a.preventDefault()}Object.defineProperty(c,"__esModule",{value:!0}),c.stopPropagation=d,c.preventDefault=e,c.default=void 0;var f=function(a){this.propagationStopped,this.type=a,this.target=null};f.prototype.preventDefault=function(){this.propagationStopped=!0},f.prototype.stopPropagation=function(){this.propagationStopped=!0};var g=f;c.default=g},{}],68:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};c.default=d},{}],69:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={LEFT:37,UP:38,RIGHT:39,DOWN:40};c.default=d},{}],70:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Disposable.js")),f=a("../events.js"),g=a("../functions.js"),h=d(a("../events/Event.js")),i=function(a){function b(){a.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addEventListener=function(a,b){var c=this.listeners_[a];c||(c=this.listeners_[a]=[]),-1===c.indexOf(b)&&c.push(b)},b.prototype.dispatchEvent=function(a){var b=this,c="string"==typeof a?new h.default(a):a,d=c.type;c.target=this;var e,f=this.listeners_[d];if(f){d in this.dispatching_||(this.dispatching_[d]=0,this.pendingRemovals_[d]=0),++this.dispatching_[d];for(var i=0,j=f.length;i<j;++i)if(!1===f[i].call(b,c)||c.propagationStopped){e=!1;break}if(0===--this.dispatching_[d]){var k=this.pendingRemovals_[d];for(delete this.pendingRemovals_[d];k--;)b.removeEventListener(d,g.VOID);delete this.dispatching_[d]}return e}},b.prototype.disposeInternal=function(){(0,f.unlistenAll)(this)},b.prototype.getListeners=function(a){return this.listeners_[a]},b.prototype.hasListener=function(a){return a?a in this.listeners_:Object.keys(this.listeners_).length>0},b.prototype.removeEventListener=function(a,b){var c=this.listeners_[a];if(c){var d=c.indexOf(b);a in this.pendingRemovals_?(c[d]=g.VOID,++this.pendingRemovals_[a]):(c.splice(d,1),0===c.length&&delete this.listeners_[a])}},b}(e.default),j=i;c.default=j},{"../Disposable.js":9,"../events.js":66,"../events/Event.js":67,"../functions.js":126}],71:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.primaryAction=c.mouseOnly=c.targetNotEditable=c.shiftKeyOnly=c.platformModifierKeyOnly=c.noModifierKeys=c.doubleClick=c.singleClick=c.pointerMove=c.never=c.mouseActionButton=c.click=c.always=c.focus=c.altShiftKeysOnly=c.altKeyOnly=void 0;var e=d(a("../MapBrowserEventType.js")),f=a("../asserts.js"),g=a("../functions.js"),h=a("../has.js"),i=function(a){var b=a.originalEvent;return b.altKey&&!(b.metaKey||b.ctrlKey)&&!b.shiftKey};c.altKeyOnly=i;var j=function(a){var b=a.originalEvent;return b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey};c.altShiftKeysOnly=j;var k=function(a){return a.target.getTargetElement()===document.activeElement};c.focus=k;var l=g.TRUE;c.always=l;var m=function(a){return a.type==e.default.CLICK};c.click=m;var n=function(a){var b=a.originalEvent;return 0==b.button&&!(h.WEBKIT&&h.MAC&&b.ctrlKey)};c.mouseActionButton=n;var o=g.FALSE;c.never=o;var p=function(a){return"pointermove"==a.type};c.pointerMove=p;var q=function(a){return a.type==e.default.SINGLECLICK};c.singleClick=q;var r=function(a){return a.type==e.default.DBLCLICK};c.doubleClick=r;var s=function(a){var b=a.originalEvent;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&!b.shiftKey};c.noModifierKeys=s;var t=function(a){var b=a.originalEvent;return!b.altKey&&(h.MAC?b.metaKey:b.ctrlKey)&&!b.shiftKey};c.platformModifierKeyOnly=t;var u=function(a){var b=a.originalEvent;return!b.altKey&&!(b.metaKey||b.ctrlKey)&&b.shiftKey};c.shiftKeyOnly=u;var v=function(a){var b=a.originalEvent.target,c=b.tagName;return"INPUT"!==c&&"SELECT"!==c&&"TEXTAREA"!==c};c.targetNotEditable=v;var w=function(a){return(0,f.assert)(a.pointerEvent,56),"mouse"==a.pointerEvent.pointerType};c.mouseOnly=w;var x=function(a){var b=a.pointerEvent;return b.isPrimary&&0===b.button};c.primaryAction=x},{"../MapBrowserEventType.js":24,"../asserts.js":47,"../functions.js":126,"../has.js":161}],72:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){for(var b=n(),c=0,d=a.length;c<d;++c)w(b,a[c]);return b}function f(a,b,c){return o(Math.min.apply(null,a),Math.min.apply(null,b),Math.max.apply(null,a),Math.max.apply(null,b),c)}function g(a,b,c){return c?(c[0]=a[0]-b,c[1]=a[1]-b,c[2]=a[2]+b,c[3]=a[3]+b,c):[a[0]-b,a[1]-b,a[2]+b,a[3]+b]}function h(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a.slice()}function i(a,b,c){var d,e;return d=b<a[0]?a[0]-b:a[2]<b?b-a[2]:0,e=c<a[1]?a[1]-c:a[3]<c?c-a[3]:0,d*d+e*e}function j(a,b){return l(a,b[0],b[1])}function k(a,b){return a[0]<=b[0]&&b[2]<=a[2]&&a[1]<=b[1]&&b[3]<=a[3]}function l(a,b,c){return a[0]<=b&&b<=a[2]&&a[1]<=c&&c<=a[3]}function m(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=b[0],h=b[1],i=Z.default.UNKNOWN;return g<c?i|=Z.default.LEFT:g>e&&(i|=Z.default.RIGHT),h<d?i|=Z.default.BELOW:h>f&&(i|=Z.default.ABOVE),i===Z.default.UNKNOWN&&(i=Z.default.INTERSECTING),i}function n(){return[1/0,1/0,-1/0,-1/0]}function o(a,b,c,d,e){return e?(e[0]=a,e[1]=b,e[2]=c,e[3]=d,e):[a,b,c,d]}function p(a){return o(1/0,1/0,-1/0,-1/0,a)}function q(a,b){var c=a[0],d=a[1];return o(c,d,c,d,b)}function r(a,b){return x(p(b),a)}function s(a,b,c,d,e){return y(p(e),a,b,c,d)}function t(a,b){return z(p(b),a)}function u(a,b){return a[0]==b[0]&&a[2]==b[2]&&a[1]==b[1]&&a[3]==b[3]}function v(a,b){return b[0]<a[0]&&(a[0]=b[0]),b[2]>a[2]&&(a[2]=b[2]),b[1]<a[1]&&(a[1]=b[1]),b[3]>a[3]&&(a[3]=b[3]),a}function w(a,b){b[0]<a[0]&&(a[0]=b[0]),b[0]>a[2]&&(a[2]=b[0]),b[1]<a[1]&&(a[1]=b[1]),b[1]>a[3]&&(a[3]=b[1])}function x(a,b){for(var c=0,d=b.length;c<d;++c)w(a,b[c]);return a}function y(a,b,c,d,e){for(;c<d;c+=e)A(a,b[c],b[c+1]);return a}function z(a,b){for(var c=0,d=b.length;c<d;++c)x(a,b[c]);return a}function A(a,b,c){a[0]=Math.min(a[0],b),a[1]=Math.min(a[1],c),a[2]=Math.max(a[2],b),a[3]=Math.max(a[3],c)}function B(a,b,c){var d;return(d=b.call(c,D(a)))?d:(d=b.call(c,E(a)))?d:(d=b.call(c,P(a)))?d:(d=b.call(c,O(a)))||!1}function C(a){var b=0;return S(a)||(b=Q(a)*J(a)),b}function D(a){return[a[0],a[1]]}function E(a){return[a[2],a[1]]}function F(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]}function G(a,b){var c;return b===Y.default.BOTTOM_LEFT?c=D(a):b===Y.default.BOTTOM_RIGHT?c=E(a):b===Y.default.TOP_LEFT?c=O(a):b===Y.default.TOP_RIGHT?c=P(a):(0,X.assert)(!1,13),c}function H(a,b){var c=Math.min(a[0],b[0]),d=Math.min(a[1],b[1]);return(Math.max(a[2],b[2])-c)*(Math.max(a[3],b[3])-d)}function I(a,b,c,d,e){var f=b*d[0]/2,g=b*d[1]/2,h=Math.cos(c),i=Math.sin(c),j=f*h,k=f*i,l=g*h,m=g*i,n=a[0],p=a[1],q=n-j+m,r=n-j-m,s=n+j-m,t=n+j+m,u=p-k-l,v=p-k+l,w=p+k+l,x=p+k-l;return o(Math.min(q,r,s,t),Math.min(u,v,w,x),Math.max(q,r,s,t),Math.max(u,v,w,x),e)}function J(a){return a[3]-a[1]}function K(a,b){return C(L(a,b))}function L(a,b,c){var d=c||n();return R(a,b)?(a[0]>b[0]?d[0]=a[0]:d[0]=b[0],a[1]>b[1]?d[1]=a[1]:d[1]=b[1],a[2]<b[2]?d[2]=a[2]:d[2]=b[2],a[3]<b[3]?d[3]=a[3]:d[3]=b[3]):p(d),d}function M(a){return Q(a)+J(a)}function N(a){return[a[2]-a[0],a[3]-a[1]]}function O(a){return[a[0],a[3]]}function P(a){return[a[2],a[3]]}function Q(a){return a[2]-a[0]}function R(a,b){return a[0]<=b[2]&&a[2]>=b[0]&&a[1]<=b[3]&&a[3]>=b[1]}function S(a){return a[2]<a[0]||a[3]<a[1]}function T(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a}function U(a,b){var c=(a[2]-a[0])/2*(b-1),d=(a[3]-a[1])/2*(b-1);a[0]-=c,a[2]+=c,a[1]-=d,a[3]+=d}function V(a,b,c){var d=!1,e=m(a,b),f=m(a,c);if(e===Z.default.INTERSECTING||f===Z.default.INTERSECTING)d=!0;else{var g,h,i=a[0],j=a[1],k=a[2],l=a[3],n=b[0],o=b[1],p=c[0],q=c[1],r=(q-o)/(p-n);f&Z.default.ABOVE&&!(e&Z.default.ABOVE)&&(g=p-(q-l)/r,d=g>=i&&g<=k),d||!(f&Z.default.RIGHT)||e&Z.default.RIGHT||(h=q-(p-k)*r,d=h>=j&&h<=l),d||!(f&Z.default.BELOW)||e&Z.default.BELOW||(g=p-(q-j)/r,d=g>=i&&g<=k),d||!(f&Z.default.LEFT)||e&Z.default.LEFT||(h=q-(p-i)*r,d=h>=j&&h<=l)}return d}function W(a,b,c){var d=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]];return b(d,d,2),f([d[0],d[2],d[4],d[6]],[d[1],d[3],d[5],d[7]],c)}Object.defineProperty(c,"__esModule",{value:!0}),c.boundingExtent=e,c.buffer=g,c.clone=h,c.closestSquaredDistanceXY=i,c.containsCoordinate=j,c.containsExtent=k,c.containsXY=l,c.coordinateRelationship=m,c.createEmpty=n,c.createOrUpdate=o,c.createOrUpdateEmpty=p,c.createOrUpdateFromCoordinate=q,c.createOrUpdateFromCoordinates=r,c.createOrUpdateFromFlatCoordinates=s,c.createOrUpdateFromRings=t,c.equals=u,c.extend=v,c.extendCoordinate=w,c.extendCoordinates=x,c.extendFlatCoordinates=y,c.extendRings=z,c.extendXY=A,c.forEachCorner=B,c.getArea=C,c.getBottomLeft=D,c.getBottomRight=E,c.getCenter=F,c.getCorner=G,c.getEnlargedArea=H,c.getForViewAndSize=I,c.getHeight=J,c.getIntersectionArea=K,c.getIntersection=L,c.getMargin=M,c.getSize=N,c.getTopLeft=O,c.getTopRight=P,c.getWidth=Q,c.intersects=R,c.isEmpty=S,c.returnOrUpdate=T,c.scaleFromCenter=U,c.intersectsSegment=V,c.applyTransform=W;var X=a("./asserts.js"),Y=d(a("./extent/Corner.js")),Z=d(a("./extent/Relationship.js"))},{"./asserts.js":47,"./extent/Corner.js":73,"./extent/Relationship.js":74}],73:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};c.default=d},{}],74:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};c.default=d},{}],75:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c,d){return function(e,f,g){var i=new XMLHttpRequest;i.open("GET","function"==typeof a?a(e,f,g):a,!0),b.getType()==h.default.ARRAY_BUFFER&&(i.responseType="arraybuffer"),i.onload=function(a){if(!i.status||i.status>=200&&i.status<300){var e,f=b.getType();f==h.default.JSON||f==h.default.TEXT?e=i.responseText:f==h.default.XML?(e=i.responseXML)||(e=(new DOMParser).parseFromString(i.responseText,"application/xml")):f==h.default.ARRAY_BUFFER&&(e=i.response),e?c.call(this,b.readFeatures(e,{featureProjection:g}),b.readProjection(e),b.getLastExtent()):d.call(this)}else d.call(this)}.bind(this),i.onerror=function(){d.call(this)}.bind(this),i.send()}}function f(a,b){return e(a,b,function(a,b){this.addFeatures(a)},g.VOID)}Object.defineProperty(c,"__esModule",{value:!0}),c.loadFeaturesXhr=e,c.xhr=f;var g=a("./functions.js"),h=d(a("./format/FormatType.js"))},{"./format/FormatType.js":79,"./functions.js":126}],76:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"EsriJSON",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"GeoJSON",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"GML",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"GPX",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"IGC",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"KML",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"MVT",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"OWS",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"Polyline",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"TopoJSON",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"WFS",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"WKT",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"WMSCapabilities",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(c,"WMSGetFeatureInfo",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"WMTSCapabilities",{enumerable:!0,get:function(){return s.default}});var e=d(a("./format/EsriJSON.js")),f=d(a("./format/GeoJSON.js")),g=d(a("./format/GML.js")),h=d(a("./format/GPX.js")),i=d(a("./format/IGC.js")),j=d(a("./format/KML.js")),k=d(a("./format/MVT.js")),l=d(a("./format/OWS.js")),m=d(a("./format/Polyline.js")),n=d(a("./format/TopoJSON.js")),o=d(a("./format/WFS.js")),p=d(a("./format/WKT.js")),q=d(a("./format/WMSCapabilities.js")),r=d(a("./format/WMSGetFeatureInfo.js")),s=d(a("./format/WMTSCapabilities.js"))},{"./format/EsriJSON.js":77,"./format/GML.js":80,"./format/GPX.js":84,"./format/GeoJSON.js":85,"./format/IGC.js":86,"./format/KML.js":88,"./format/MVT.js":89,"./format/OWS.js":90,"./format/Polyline.js":91,"./format/TopoJSON.js":93,"./format/WFS.js":94,"./format/WKT.js":95,"./format/WMSCapabilities.js":96,"./format/WMSGetFeatureInfo.js":97,"./format/WMTSCapabilities.js":98}],77:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!a)return null;var c;if("number"==typeof a.x&&"number"==typeof a.y)c=B.default.POINT;else if(a.points)c=B.default.MULTI_POINT;else if(a.paths)c=1===a.paths.length?B.default.LINE_STRING:B.default.MULTI_LINE_STRING;else if(a.rings){var d=j(a),e=f(a.rings,d);a=(0,L.assign)({},a),1===e.length?(c=B.default.POLYGON,a.rings=e[0]):(c=B.default.MULTI_POLYGON,a.rings=e)}var g=N[c];return(0,y.transformWithOptions)(g(a),!1,b)}function f(a,b){var c,d,e=[],f=[],g=[];for(c=0,d=a.length;c<d;++c){e.length=0,(0,J.deflateCoordinates)(e,0,a[c],b.length);(0,K.linearRingIsClockwise)(e,0,e.length,b.length)?f.push([a[c]]):g.push(a[c])}for(;g.length;){var h=g.shift(),i=!1;for(c=f.length-1;c>=0;c--){var j=f[c][0];if((0,x.containsExtent)(new D.default(j).getExtent(),new D.default(h).getExtent())){f[c].push(h),i=!0;break}}i||f.push([h.reverse()])}return f}function g(a){return void 0!==a.m&&void 0!==a.z?new H.default([a.x,a.y,a.z,a.m],A.default.XYZM):void 0!==a.z?new H.default([a.x,a.y,a.z],A.default.XYZ):void 0!==a.m?new H.default([a.x,a.y,a.m],A.default.XYM):new H.default([a.x,a.y])}function h(a){var b=j(a);return new C.default(a.paths[0],b)}function i(a){var b=j(a);return new E.default(a.paths,b)}function j(a){var b=A.default.XY;return!0===a.hasZ&&!0===a.hasM?b=A.default.XYZM:!0===a.hasZ?b=A.default.XYZ:!0===a.hasM&&(b=A.default.XYM),b}function k(a){var b=j(a);return new F.default(a.points,b)}function l(a){var b=j(a);return new G.default(a.rings,b)}function m(a){var b=j(a);return new I.default(a.rings,b)}function n(a,b){var c,d=a.getCoordinates(),e=a.getLayout();return e===A.default.XYZ?c={x:d[0],y:d[1],z:d[2]}:e===A.default.XYM?c={x:d[0],y:d[1],m:d[2]}:e===A.default.XYZM?c={x:d[0],y:d[1],z:d[2],m:d[3]}:e===A.default.XY?c={x:d[0],y:d[1]}:(0,w.assert)(!1,34),c}function o(a){var b=a.getLayout();return{hasZ:b===A.default.XYZ||b===A.default.XYZM,hasM:b===A.default.XYM||b===A.default.XYZM}}function p(a,b){var c=o(a);return{hasZ:c.hasZ,hasM:c.hasM,paths:[a.getCoordinates()]}}function q(a,b){var c=o(a);return{hasZ:c.hasZ,hasM:c.hasM,rings:a.getCoordinates(!1)}}function r(a,b){var c=o(a);return{hasZ:c.hasZ,hasM:c.hasM,paths:a.getCoordinates()}}function s(a,b){var c=o(a);return{hasZ:c.hasZ,hasM:c.hasM,points:a.getCoordinates()}}function t(a,b){for(var c=o(a),d=a.getCoordinates(!1),e=[],f=0;f<d.length;f++)for(var g=d[f].length-1;g>=0;g--)e.push(d[f][g]);return{hasZ:c.hasZ,hasM:c.hasM,rings:e}}function u(a,b){return(0,O[a.getType()])((0,y.transformWithOptions)(a,!0,b),b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var v=d(a("../Feature.js")),w=a("../asserts.js"),x=a("../extent.js"),y=a("../format/Feature.js"),z=d(a("../format/JSONFeature.js")),A=d(a("../geom/GeometryLayout.js")),B=d(a("../geom/GeometryType.js")),C=d(a("../geom/LineString.js")),D=d(a("../geom/LinearRing.js")),E=d(a("../geom/MultiLineString.js")),F=d(a("../geom/MultiPoint.js")),G=d(a("../geom/MultiPolygon.js")),H=d(a("../geom/Point.js")),I=d(a("../geom/Polygon.js")),J=a("../geom/flat/deflate.js"),K=a("../geom/flat/orient.js"),L=a("../obj.js"),M=a("../proj.js"),N={};N[B.default.POINT]=g,N[B.default.LINE_STRING]=h,N[B.default.POLYGON]=m,N[B.default.MULTI_POINT]=k,N[B.default.MULTI_LINE_STRING]=i,N[B.default.MULTI_POLYGON]=l;var O={};O[B.default.POINT]=n,O[B.default.LINE_STRING]=p,O[B.default.POLYGON]=q,O[B.default.MULTI_POINT]=s,O[B.default.MULTI_LINE_STRING]=r,O[B.default.MULTI_POLYGON]=t;var P=function(a){function b(b){var c=b||{};a.call(this),this.geometryName_=c.geometryName}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFeatureFromObject=function(a,b){var c=a,d=e(c.geometry,b),f=new v.default;return this.geometryName_&&f.setGeometryName(this.geometryName_),f.setGeometry(d),b&&b.idField&&c.attributes[b.idField]&&f.setId(c.attributes[b.idField]),c.attributes&&f.setProperties(c.attributes),f},b.prototype.readFeaturesFromObject=function(a,b){var c=this,d=a,e=b||{};if(d.features){var f=a,g=[],h=f.features;e.idField=a.objectIdFieldName;for(var i=0,j=h.length;i<j;++i)g.push(c.readFeatureFromObject(h[i],e));return g}return[this.readFeatureFromObject(a,e)]},b.prototype.readGeometryFromObject=function(a,b){return e(a,b)},b.prototype.readProjectionFromObject=function(a){var b=a;if(b.spatialReference&&b.spatialReference.wkid){var c=b.spatialReference.wkid;return(0,M.get)("EPSG:"+c)}return null},b.prototype.writeGeometryObject=function(a,b){return u(a,this.adaptOptions(b))},b.prototype.writeFeatureObject=function(a,b){b=this.adaptOptions(b);var c={},d=a.getGeometry();d&&(c.geometry=u(d,b),b&&b.featureProjection&&(c.geometry.spatialReference={wkid:(0,M.get)(b.featureProjection).getCode().split(":").pop()}));var e=a.getProperties();return delete e[a.getGeometryName()],(0,L.isEmpty)(e)?c.attributes={}:c.attributes=e,c},b.prototype.writeFeaturesObject=function(a,b){var c=this;b=this.adaptOptions(b);for(var d=[],e=0,f=a.length;e<f;++e)d.push(c.writeFeatureObject(a[e],b));return{features:d}},b}(z.default),Q=P;c.default=Q},{"../Feature.js":10,"../asserts.js":47,"../extent.js":72,"../format/Feature.js":78,"../format/JSONFeature.js":87,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/LineString.js":133,"../geom/LinearRing.js":134,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../geom/flat/deflate.js":145,"../geom/flat/orient.js":153,"../obj.js":201,"../proj.js":210}],78:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d,e=c?(0,h.get)(c.featureProjection):null,g=c?(0,h.get)(c.dataProjection):null;if(d=e&&g&&!(0,h.equivalent)(e,g)?a instanceof f.default?(b?a.clone():a).transform(b?e:g,b?g:e):(0,h.transformExtent)(a,g,e):a,b&&c&&void 0!==c.decimals){var i=Math.pow(10,c.decimals),j=function(a){for(var b=0,c=a.length;b<c;++b)a[b]=Math.round(a[b]*i)/i;return a};d===a&&(d=d.clone()),d.applyTransform(j)}return d}Object.defineProperty(c,"__esModule",{value:!0}),c.transformWithOptions=e,c.default=void 0;var f=d(a("../geom/Geometry.js")),g=a("../obj.js"),h=a("../proj.js"),i=function(){this.dataProjection=null,this.defaultFeatureProjection=null};i.prototype.getReadOptions=function(a,b){var c;return b&&(c={dataProjection:b.dataProjection?b.dataProjection:this.readProjection(a),featureProjection:b.featureProjection}),this.adaptOptions(c)},i.prototype.adaptOptions=function(a){return(0,g.assign)({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},a)},i.prototype.getLastExtent=function(){return null},i.prototype.getType=function(){},i.prototype.readFeature=function(a,b){},i.prototype.readFeatures=function(a,b){},i.prototype.readGeometry=function(a,b){},i.prototype.readProjection=function(a){},i.prototype.writeFeature=function(a,b){},
i.prototype.writeFeatures=function(a,b){},i.prototype.writeGeometry=function(a,b){};var j=i;c.default=j},{"../geom/Geometry.js":129,"../obj.js":201,"../proj.js":210}],79:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};c.default=d},{}],80:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../format/GML3.js")),f=e.default;f.prototype.writeFeatures,f.prototype.writeFeaturesNode;var g=f;c.default=g},{"../format/GML3.js":82}],81:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../extent.js"),g=a("../format/Feature.js"),h=e(a("../format/GMLBase.js")),i=a("../format/xsd.js"),j=d(a("../geom/Geometry.js")),k=a("../obj.js"),l=a("../proj.js"),m=a("../xml.js"),n=h.GMLNS+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",o={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},p=function(a){function b(b){var c=b||{};a.call(this,c),this.FEATURE_COLLECTION_PARSERS[h.GMLNS].featureMember=(0,m.makeArrayPusher)(this.readFeaturesInternal),this.schemaLocation=c.schemaLocation?c.schemaLocation:n}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFlatCoordinates_=function(a,b){var c=(0,m.getAllTextContent)(a,!1).replace(/^\s*|\s*$/g,""),d=b[0],e=d.srsName,f="enu";if(e){var g=(0,l.get)(e);g&&(f=g.getAxisOrientation())}for(var h=c.trim().split(/\s+/),i=[],j=0,k=h.length;j<k;j++){var n=h[j].split(/,+/),o=parseFloat(n[0]),p=parseFloat(n[1]),q=3===n.length?parseFloat(n[2]):0;"en"===f.substr(0,2)?i.push(o,p,q):i.push(p,o,q)}return i},b.prototype.readBox_=function(a,b){var c=(0,m.pushParseAndPop)([null],this.BOX_PARSERS_,a,b,this);return(0,f.createOrUpdate)(c[1][0],c[1][1],c[1][3],c[1][4])},b.prototype.innerBoundaryIsParser_=function(a,b){var c=(0,m.pushParseAndPop)(void 0,this.RING_PARSERS,a,b,this);if(c){b[b.length-1].push(c)}},b.prototype.outerBoundaryIsParser_=function(a,b){var c=(0,m.pushParseAndPop)(void 0,this.RING_PARSERS,a,b,this);if(c){b[b.length-1][0]=c}},b.prototype.GEOMETRY_NODE_FACTORY_=function(a,b,c){var d,e=b[b.length-1],f=e.multiSurface,g=e.surface,h=e.multiCurve;return Array.isArray(a)?d="Envelope":(d=a.getType(),"MultiPolygon"===d&&!0===f?d="MultiSurface":"Polygon"===d&&!0===g?d="Surface":"MultiLineString"===d&&!0===h&&(d="MultiCurve")),(0,m.createElementNS)("http://www.opengis.net/gml",d)},b.prototype.writeFeatureElement=function(a,b,c){var d=this,e=b.getId();e&&a.setAttribute("fid",e);var f=c[c.length-1],g=f.featureNS,h=b.getGeometryName();f.serializers||(f.serializers={},f.serializers[g]={});var l=b.getProperties(),n=[],o=[];for(var p in l){var q=l[p];null!==q&&(n.push(p),o.push(q),p==h||q instanceof j.default?p in f.serializers[g]||(f.serializers[g][p]=(0,m.makeChildAppender)(d.writeGeometryElement,d)):p in f.serializers[g]||(f.serializers[g][p]=(0,m.makeChildAppender)(i.writeStringTextNode)))}var r=(0,k.assign)({},f);r.node=a,(0,m.pushSerializeAndPop)(r,f.serializers,(0,m.makeSimpleNodeFactory)(void 0,g),o,c,n)},b.prototype.writeCurveOrLineString_=function(a,b,c){var d=c[c.length-1],e=d.srsName;if("LineStringSegment"!==a.nodeName&&e&&a.setAttribute("srsName",e),"LineString"===a.nodeName||"LineStringSegment"===a.nodeName){var f=this.createCoordinatesNode_(a.namespaceURI);a.appendChild(f),this.writeCoordinates_(f,b,c)}else if("Curve"===a.nodeName){var g=(0,m.createElementNS)(a.namespaceURI,"segments");a.appendChild(g),this.writeCurveSegments_(g,b,c)}},b.prototype.writeLineStringOrCurveMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeCurveOrLineString_(d,b,c))},b.prototype.writeMultiCurveOrLineString_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName,g=d.curve;f&&a.setAttribute("srsName",f);var h=b.getLineStrings();(0,m.pushSerializeAndPop)({node:a,hasZ:e,srsName:f,curve:g},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,h,c,void 0,this)},b.prototype.writeGeometryElement=function(a,b,c){var d=c[c.length-1],e=(0,k.assign)({},d);e.node=a;var f;f=Array.isArray(b)?d.dataProjection?(0,l.transformExtent)(b,d.featureProjection,d.dataProjection):b:(0,g.transformWithOptions)(b,!0,d),(0,m.pushSerializeAndPop)(e,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[f],c,void 0,this)},b.prototype.createCoordinatesNode_=function(a){var b=(0,m.createElementNS)(a,"coordinates");return b.setAttribute("decimal","."),b.setAttribute("cs",","),b.setAttribute("ts"," "),b},b.prototype.writeCoordinates_=function(a,b,c){for(var d=this,e=c[c.length-1],f=e.hasZ,g=e.srsName,h=b.getCoordinates(),j=h.length,k=new Array(j),l=0;l<j;++l){var m=h[l];k[l]=d.getCoords_(m,g,f)}(0,i.writeStringTextNode)(a,k.join(" "))},b.prototype.writeCurveSegments_=function(a,b,c){var d=(0,m.createElementNS)(a.namespaceURI,"LineStringSegment");a.appendChild(d),this.writeCurveOrLineString_(d,b,c)},b.prototype.writeSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;if("PolygonPatch"!==a.nodeName&&f&&a.setAttribute("srsName",f),"Polygon"===a.nodeName||"PolygonPatch"===a.nodeName){var g=b.getLinearRings();(0,m.pushSerializeAndPop)({node:a,hasZ:e,srsName:f},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,g,c,void 0,this)}else if("Surface"===a.nodeName){var h=(0,m.createElementNS)(a.namespaceURI,"patches");a.appendChild(h),this.writeSurfacePatches_(h,b,c)}},b.prototype.RING_NODE_FACTORY_=function(a,b,c){var d=b[b.length-1],e=d.node,f=d.exteriorWritten;return void 0===f&&(d.exteriorWritten=!0),(0,m.createElementNS)(e.namespaceURI,void 0!==f?"innerBoundaryIs":"outerBoundaryIs")},b.prototype.writeSurfacePatches_=function(a,b,c){var d=(0,m.createElementNS)(a.namespaceURI,"PolygonPatch");a.appendChild(d),this.writeSurfaceOrPolygon_(d,b,c)},b.prototype.writeRing_=function(a,b,c){var d=(0,m.createElementNS)(a.namespaceURI,"LinearRing");a.appendChild(d),this.writeLinearRing_(d,b,c)},b.prototype.getCoords_=function(a,b,c){var d="enu";b&&(d=(0,l.get)(b).getAxisOrientation());var e="en"===d.substr(0,2)?a[0]+","+a[1]:a[1]+","+a[0];if(c){e+=","+(a[2]||0)}return e},b.prototype.writePoint_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;f&&a.setAttribute("srsName",f);var g=this.createCoordinatesNode_(a.namespaceURI);a.appendChild(g);var h=b.getCoordinates(),j=this.getCoords_(h,f,e);(0,i.writeStringTextNode)(g,j)},b.prototype.writeMultiPoint_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;f&&a.setAttribute("srsName",f);var g=b.getPoints();(0,m.pushSerializeAndPop)({node:a,hasZ:e,srsName:f},this.POINTMEMBER_SERIALIZERS_,(0,m.makeSimpleNodeFactory)("pointMember"),g,c,void 0,this)},b.prototype.writePointMember_=function(a,b,c){var d=(0,m.createElementNS)(a.namespaceURI,"Point");a.appendChild(d),this.writePoint_(d,b,c)},b.prototype.writeLinearRing_=function(a,b,c){var d=c[c.length-1],e=d.srsName;e&&a.setAttribute("srsName",e);var f=this.createCoordinatesNode_(a.namespaceURI);a.appendChild(f),this.writeCoordinates_(f,b,c)},b.prototype.writeMultiSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName,g=d.surface;f&&a.setAttribute("srsName",f);var h=b.getPolygons();(0,m.pushSerializeAndPop)({node:a,hasZ:e,srsName:f,surface:g},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,h,c,void 0,this)},b.prototype.writeSurfaceOrPolygonMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeSurfaceOrPolygon_(d,b,c))},b.prototype.writeEnvelope=function(a,b,c){var d=c[c.length-1],e=d.srsName;e&&a.setAttribute("srsName",e);var f=["lowerCorner","upperCorner"],g=[b[0]+" "+b[1],b[2]+" "+b[3]];(0,m.pushSerializeAndPop)({node:a},this.ENVELOPE_SERIALIZERS_,m.OBJECT_PROPERTY_NODE_FACTORY,g,c,f,this)},b.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(a,b,c){var d=b[b.length-1].node;return(0,m.createElementNS)("http://www.opengis.net/gml",o[d.nodeName])},b}(h.default);p.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_={"http://www.opengis.net/gml":{coordinates:(0,m.makeReplacer)(p.prototype.readFlatCoordinates_)}},p.prototype.FLAT_LINEAR_RINGS_PARSERS_={"http://www.opengis.net/gml":{innerBoundaryIs:p.prototype.innerBoundaryIsParser_,outerBoundaryIs:p.prototype.outerBoundaryIsParser_}},p.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:(0,m.makeArrayPusher)(p.prototype.readFlatCoordinates_)}},p.prototype.GEOMETRY_PARSERS_={"http://www.opengis.net/gml":{Point:(0,m.makeReplacer)(h.default.prototype.readPoint),MultiPoint:(0,m.makeReplacer)(h.default.prototype.readMultiPoint),LineString:(0,m.makeReplacer)(h.default.prototype.readLineString),MultiLineString:(0,m.makeReplacer)(h.default.prototype.readMultiLineString),LinearRing:(0,m.makeReplacer)(h.default.prototype.readLinearRing),Polygon:(0,m.makeReplacer)(h.default.prototype.readPolygon),MultiPolygon:(0,m.makeReplacer)(h.default.prototype.readMultiPolygon),Box:(0,m.makeReplacer)(p.prototype.readBox_)}},p.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:(0,m.makeChildAppender)(p.prototype.writeCurveOrLineString_),MultiCurve:(0,m.makeChildAppender)(p.prototype.writeMultiCurveOrLineString_),Point:(0,m.makeChildAppender)(p.prototype.writePoint_),MultiPoint:(0,m.makeChildAppender)(p.prototype.writeMultiPoint_),LineString:(0,m.makeChildAppender)(p.prototype.writeCurveOrLineString_),MultiLineString:(0,m.makeChildAppender)(p.prototype.writeMultiCurveOrLineString_),LinearRing:(0,m.makeChildAppender)(p.prototype.writeLinearRing_),Polygon:(0,m.makeChildAppender)(p.prototype.writeSurfaceOrPolygon_),MultiPolygon:(0,m.makeChildAppender)(p.prototype.writeMultiSurfaceOrPolygon_),Surface:(0,m.makeChildAppender)(p.prototype.writeSurfaceOrPolygon_),MultiSurface:(0,m.makeChildAppender)(p.prototype.writeMultiSurfaceOrPolygon_),Envelope:(0,m.makeChildAppender)(p.prototype.writeEnvelope)}},p.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:(0,m.makeChildAppender)(p.prototype.writeLineStringOrCurveMember_),curveMember:(0,m.makeChildAppender)(p.prototype.writeLineStringOrCurveMember_)}},p.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{outerBoundaryIs:(0,m.makeChildAppender)(p.prototype.writeRing_),innerBoundaryIs:(0,m.makeChildAppender)(p.prototype.writeRing_)}},p.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:(0,m.makeChildAppender)(p.prototype.writePointMember_)}},p.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:(0,m.makeChildAppender)(p.prototype.writeSurfaceOrPolygonMember_),polygonMember:(0,m.makeChildAppender)(p.prototype.writeSurfaceOrPolygonMember_)}},p.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:(0,m.makeChildAppender)(i.writeStringTextNode),upperCorner:(0,m.makeChildAppender)(i.writeStringTextNode)}};var q=p;c.default=q},{"../extent.js":72,"../format/Feature.js":78,"../format/GMLBase.js":83,"../format/xsd.js":125,"../geom/Geometry.js":129,"../obj.js":201,"../proj.js":210,"../xml.js":351}],82:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../array.js"),g=a("../extent.js"),h=a("../format/Feature.js"),i=e(a("../format/GMLBase.js")),j=a("../format/xsd.js"),k=d(a("../geom/Geometry.js")),l=d(a("../geom/GeometryLayout.js")),m=d(a("../geom/LineString.js")),n=d(a("../geom/MultiLineString.js")),o=d(a("../geom/MultiPolygon.js")),p=d(a("../geom/Polygon.js")),q=a("../obj.js"),r=a("../proj.js"),s=a("../xml.js"),t=i.GMLNS+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",u={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},v=function(a){function b(b){var c=b||{};a.call(this,c),this.surface_=void 0!==c.surface&&c.surface,this.curve_=void 0!==c.curve&&c.curve,this.multiCurve_=void 0===c.multiCurve||c.multiCurve,this.multiSurface_=void 0===c.multiSurface||c.multiSurface,this.schemaLocation=c.schemaLocation?c.schemaLocation:t,this.hasZ=void 0!==c.hasZ&&c.hasZ}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readMultiCurve_=function(a,b){var c=(0,s.pushParseAndPop)([],this.MULTICURVE_PARSERS_,a,b,this);if(c){return new n.default(c)}},b.prototype.readMultiSurface_=function(a,b){var c=(0,s.pushParseAndPop)([],this.MULTISURFACE_PARSERS_,a,b,this);if(c)return new o.default(c)},b.prototype.curveMemberParser_=function(a,b){(0,s.parseNode)(this.CURVEMEMBER_PARSERS_,a,b,this)},b.prototype.surfaceMemberParser_=function(a,b){(0,s.parseNode)(this.SURFACEMEMBER_PARSERS_,a,b,this)},b.prototype.readPatch_=function(a,b){return(0,s.pushParseAndPop)([null],this.PATCHES_PARSERS_,a,b,this)},b.prototype.readSegment_=function(a,b){return(0,s.pushParseAndPop)([null],this.SEGMENTS_PARSERS_,a,b,this)},b.prototype.readPolygonPatch_=function(a,b){return(0,s.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS_,a,b,this)},b.prototype.readLineStringSegment_=function(a,b){return(0,s.pushParseAndPop)([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b,this)},b.prototype.interiorParser_=function(a,b){var c=(0,s.pushParseAndPop)(void 0,this.RING_PARSERS,a,b,this);if(c){b[b.length-1].push(c)}},b.prototype.exteriorParser_=function(a,b){var c=(0,s.pushParseAndPop)(void 0,this.RING_PARSERS,a,b,this);if(c){b[b.length-1][0]=c}},b.prototype.readSurface_=function(a,b){var c=(0,s.pushParseAndPop)([null],this.SURFACE_PARSERS_,a,b,this);if(c&&c[0]){var d,e,g=c[0],h=[g.length];for(d=1,e=c.length;d<e;++d)(0,f.extend)(g,c[d]),h.push(g.length);return new p.default(g,l.default.XYZ,h)}},b.prototype.readCurve_=function(a,b){var c=(0,s.pushParseAndPop)([null],this.CURVE_PARSERS_,a,b,this);if(c){return new m.default(c,l.default.XYZ)}},b.prototype.readEnvelope_=function(a,b){var c=(0,s.pushParseAndPop)([null],this.ENVELOPE_PARSERS_,a,b,this);return(0,g.createOrUpdate)(c[1][0],c[1][1],c[2][0],c[2][1])},b.prototype.readFlatPos_=function(a,b){for(var c,d=(0,s.getAllTextContent)(a,!1),e=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,f=[];c=e.exec(d);)f.push(parseFloat(c[1])),d=d.substr(c[0].length);if(""===d){var g=b[0],h=g.srsName,i="enu";if(h){i=(0,r.get)(h).getAxisOrientation()}if("neu"===i){var j,k;for(j=0,k=f.length;j<k;j+=3){var l=f[j],m=f[j+1];f[j]=m,f[j+1]=l}}var n=f.length;if(2==n&&f.push(0),0!==n)return f}},b.prototype.readFlatPosList_=function(a,b){var c=(0,s.getAllTextContent)(a,!1).replace(/^\s*|\s*$/g,""),d=b[0],e=d.srsName,f=d.srsDimension,g="enu";if(e){g=(0,r.get)(e).getAxisOrientation()}var h=c.split(/\s+/),i=2;a.getAttribute("srsDimension")?i=(0,j.readNonNegativeIntegerString)(a.getAttribute("srsDimension")):a.getAttribute("dimension")?i=(0,j.readNonNegativeIntegerString)(a.getAttribute("dimension")):a.parentNode.getAttribute("srsDimension")?i=(0,j.readNonNegativeIntegerString)(a.parentNode.getAttribute("srsDimension")):f&&(i=(0,j.readNonNegativeIntegerString)(f));for(var k,l,m,n=[],o=0,p=h.length;o<p;o+=i)k=parseFloat(h[o]),l=parseFloat(h[o+1]),m=3===i?parseFloat(h[o+2]):0,"en"===g.substr(0,2)?n.push(k,l,m):n.push(l,k,m);return n},b.prototype.writePos_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=e?3:2;a.setAttribute("srsDimension",f);var g=d.srsName,h="enu";g&&(h=(0,r.get)(g).getAxisOrientation());var i,k=b.getCoordinates();if(i="en"===h.substr(0,2)?k[0]+" "+k[1]:k[1]+" "+k[0],e){i+=" "+(k[2]||0)}(0,j.writeStringTextNode)(a,i)},b.prototype.getCoords_=function(a,b,c){var d="enu";b&&(d=(0,r.get)(b).getAxisOrientation());var e="en"===d.substr(0,2)?a[0]+" "+a[1]:a[1]+" "+a[0];if(c){e+=" "+(a[2]||0)}return e},b.prototype.writePosList_=function(a,b,c){var d=this,e=c[c.length-1],f=e.hasZ,g=f?3:2;a.setAttribute("srsDimension",g);for(var h,i=e.srsName,k=b.getCoordinates(),l=k.length,m=new Array(l),n=0;n<l;++n)h=k[n],m[n]=d.getCoords_(h,i,f);(0,j.writeStringTextNode)(a,m.join(" "))},b.prototype.writePoint_=function(a,b,c){var d=c[c.length-1],e=d.srsName;e&&a.setAttribute("srsName",e);var f=(0,s.createElementNS)(a.namespaceURI,"pos");a.appendChild(f),this.writePos_(f,b,c)},b.prototype.writeEnvelope=function(a,b,c){var d=c[c.length-1],e=d.srsName;e&&a.setAttribute("srsName",e);var f=["lowerCorner","upperCorner"],g=[b[0]+" "+b[1],b[2]+" "+b[3]];(0,s.pushSerializeAndPop)({node:a},this.ENVELOPE_SERIALIZERS_,s.OBJECT_PROPERTY_NODE_FACTORY,g,c,f,this)},b.prototype.writeLinearRing_=function(a,b,c){var d=c[c.length-1],e=d.srsName;e&&a.setAttribute("srsName",e);var f=(0,s.createElementNS)(a.namespaceURI,"posList");a.appendChild(f),this.writePosList_(f,b,c)},b.prototype.RING_NODE_FACTORY_=function(a,b,c){var d=b[b.length-1],e=d.node,f=d.exteriorWritten;return void 0===f&&(d.exteriorWritten=!0),(0,s.createElementNS)(e.namespaceURI,void 0!==f?"interior":"exterior")},b.prototype.writeSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;if("PolygonPatch"!==a.nodeName&&f&&a.setAttribute("srsName",f),"Polygon"===a.nodeName||"PolygonPatch"===a.nodeName){var g=b.getLinearRings();(0,s.pushSerializeAndPop)({node:a,hasZ:e,srsName:f},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,g,c,void 0,this)}else if("Surface"===a.nodeName){var h=(0,s.createElementNS)(a.namespaceURI,"patches");a.appendChild(h),this.writeSurfacePatches_(h,b,c)}},b.prototype.writeCurveOrLineString_=function(a,b,c){var d=c[c.length-1],e=d.srsName;if("LineStringSegment"!==a.nodeName&&e&&a.setAttribute("srsName",e),"LineString"===a.nodeName||"LineStringSegment"===a.nodeName){var f=(0,s.createElementNS)(a.namespaceURI,"posList");a.appendChild(f),this.writePosList_(f,b,c)}else if("Curve"===a.nodeName){var g=(0,s.createElementNS)(a.namespaceURI,"segments");a.appendChild(g),this.writeCurveSegments_(g,b,c)}},b.prototype.writeMultiSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName,g=d.surface;f&&a.setAttribute("srsName",f);var h=b.getPolygons();(0,s.pushSerializeAndPop)({node:a,hasZ:e,srsName:f,surface:g},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,h,c,void 0,this)},b.prototype.writeMultiPoint_=function(a,b,c){var d=c[c.length-1],e=d.srsName,f=d.hasZ;e&&a.setAttribute("srsName",e);var g=b.getPoints();(0,s.pushSerializeAndPop)({node:a,hasZ:f,srsName:e},this.POINTMEMBER_SERIALIZERS_,(0,s.makeSimpleNodeFactory)("pointMember"),g,c,void 0,this)},b.prototype.writeMultiCurveOrLineString_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName,g=d.curve;f&&a.setAttribute("srsName",f);var h=b.getLineStrings();(0,s.pushSerializeAndPop)({node:a,hasZ:e,srsName:f,curve:g},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,h,c,void 0,this)},b.prototype.writeRing_=function(a,b,c){var d=(0,s.createElementNS)(a.namespaceURI,"LinearRing");a.appendChild(d),this.writeLinearRing_(d,b,c)},b.prototype.writeSurfaceOrPolygonMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeSurfaceOrPolygon_(d,b,c))},b.prototype.writePointMember_=function(a,b,c){var d=(0,s.createElementNS)(a.namespaceURI,"Point");a.appendChild(d),this.writePoint_(d,b,c)},b.prototype.writeLineStringOrCurveMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeCurveOrLineString_(d,b,c))},b.prototype.writeSurfacePatches_=function(a,b,c){var d=(0,s.createElementNS)(a.namespaceURI,"PolygonPatch");a.appendChild(d),this.writeSurfaceOrPolygon_(d,b,c)},b.prototype.writeCurveSegments_=function(a,b,c){var d=(0,s.createElementNS)(a.namespaceURI,"LineStringSegment");a.appendChild(d),this.writeCurveOrLineString_(d,b,c)},b.prototype.writeGeometryElement=function(a,b,c){var d=c[c.length-1],e=(0,q.assign)({},d);e.node=a;var f;f=Array.isArray(b)?d.dataProjection?(0,r.transformExtent)(b,d.featureProjection,d.dataProjection):b:(0,h.transformWithOptions)(b,!0,d),(0,s.pushSerializeAndPop)(e,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[f],c,void 0,this)},b.prototype.writeFeatureElement=function(a,b,c){var d=this,e=b.getId();e&&a.setAttribute("fid",e);var f=c[c.length-1],g=f.featureNS,h=b.getGeometryName();f.serializers||(f.serializers={},f.serializers[g]={});var i=b.getProperties(),l=[],m=[];for(var n in i){var o=i[n];null!==o&&(l.push(n),m.push(o),n==h||o instanceof k.default?n in f.serializers[g]||(f.serializers[g][n]=(0,s.makeChildAppender)(d.writeGeometryElement,d)):n in f.serializers[g]||(f.serializers[g][n]=(0,s.makeChildAppender)(j.writeStringTextNode)))}var p=(0,q.assign)({},f);p.node=a,(0,s.pushSerializeAndPop)(p,f.serializers,(0,s.makeSimpleNodeFactory)(void 0,g),m,c,l)},b.prototype.writeFeatureMembers_=function(a,b,c){var d=c[c.length-1],e=d.featureType,f=d.featureNS,g={};g[f]={},g[f][e]=(0,s.makeChildAppender)(this.writeFeatureElement,this);var h=(0,q.assign)({},d);h.node=a,(0,s.pushSerializeAndPop)(h,g,(0,s.makeSimpleNodeFactory)(e,f),b,c)},b.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(a,b,c){var d=b[b.length-1].node;return(0,s.createElementNS)("http://www.opengis.net/gml",u[d.nodeName])},b.prototype.GEOMETRY_NODE_FACTORY_=function(a,b,c){var d,e=b[b.length-1],f=e.multiSurface,g=e.surface,h=e.curve,i=e.multiCurve;return Array.isArray(a)?d="Envelope":(d=a.getType(),"MultiPolygon"===d&&!0===f?d="MultiSurface":"Polygon"===d&&!0===g?d="Surface":"LineString"===d&&!0===h?d="Curve":"MultiLineString"===d&&!0===i&&(d="MultiCurve")),(0,s.createElementNS)("http://www.opengis.net/gml",d)},b.prototype.writeGeometryNode=function(a,b){b=this.adaptOptions(b);var c=(0,s.createElementNS)("http://www.opengis.net/gml","geom"),d={node:c,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return b&&(0,q.assign)(d,b),this.writeGeometryElement(c,a,[d]),c},b.prototype.writeFeaturesNode=function(a,b){b=this.adaptOptions(b);var c=(0,s.createElementNS)("http://www.opengis.net/gml","featureMembers");c.setAttributeNS(s.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation);var d={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return b&&(0,q.assign)(d,b),this.writeFeatureMembers_(c,a,[d]),c},b}(i.default);v.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_={"http://www.opengis.net/gml":{pos:(0,s.makeReplacer)(v.prototype.readFlatPos_),posList:(0,s.makeReplacer)(v.prototype.readFlatPosList_)}},v.prototype.FLAT_LINEAR_RINGS_PARSERS_={"http://www.opengis.net/gml":{interior:v.prototype.interiorParser_,exterior:v.prototype.exteriorParser_}},v.prototype.GEOMETRY_PARSERS_={"http://www.opengis.net/gml":{Point:(0,s.makeReplacer)(i.default.prototype.readPoint),MultiPoint:(0,s.makeReplacer)(i.default.prototype.readMultiPoint),LineString:(0,s.makeReplacer)(i.default.prototype.readLineString),MultiLineString:(0,s.makeReplacer)(i.default.prototype.readMultiLineString),LinearRing:(0,s.makeReplacer)(i.default.prototype.readLinearRing),Polygon:(0,s.makeReplacer)(i.default.prototype.readPolygon),MultiPolygon:(0,s.makeReplacer)(i.default.prototype.readMultiPolygon),Surface:(0,s.makeReplacer)(v.prototype.readSurface_),MultiSurface:(0,s.makeReplacer)(v.prototype.readMultiSurface_),Curve:(0,s.makeReplacer)(v.prototype.readCurve_),MultiCurve:(0,s.makeReplacer)(v.prototype.readMultiCurve_),Envelope:(0,s.makeReplacer)(v.prototype.readEnvelope_)}},v.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml":{curveMember:(0,s.makeArrayPusher)(v.prototype.curveMemberParser_),curveMembers:(0,s.makeArrayPusher)(v.prototype.curveMemberParser_)}},v.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml":{surfaceMember:(0,s.makeArrayPusher)(v.prototype.surfaceMemberParser_),surfaceMembers:(0,s.makeArrayPusher)(v.prototype.surfaceMemberParser_)}},v.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:(0,s.makeArrayPusher)(i.default.prototype.readLineString),Curve:(0,s.makeArrayPusher)(v.prototype.readCurve_)}},v.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:(0,s.makeArrayPusher)(i.default.prototype.readPolygon),Surface:(0,s.makeArrayPusher)(v.prototype.readSurface_)}},v.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml":{patches:(0,s.makeReplacer)(v.prototype.readPatch_)}},v.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml":{segments:(0,s.makeReplacer)(v.prototype.readSegment_)}},v.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml":{lowerCorner:(0,s.makeArrayPusher)(v.prototype.readFlatPosList_),upperCorner:(0,s.makeArrayPusher)(v.prototype.readFlatPosList_)}},v.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml":{PolygonPatch:(0,s.makeReplacer)(v.prototype.readPolygonPatch_)}},v.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml":{LineStringSegment:(0,s.makeReplacer)(v.prototype.readLineStringSegment_)}},v.prototype.writeFeatures,v.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{exterior:(0,s.makeChildAppender)(v.prototype.writeRing_),interior:(0,s.makeChildAppender)(v.prototype.writeRing_)}},v.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:(0,s.makeChildAppender)(j.writeStringTextNode),upperCorner:(0,s.makeChildAppender)(j.writeStringTextNode)}},v.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:(0,s.makeChildAppender)(v.prototype.writeSurfaceOrPolygonMember_),polygonMember:(0,s.makeChildAppender)(v.prototype.writeSurfaceOrPolygonMember_)}},v.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:(0,s.makeChildAppender)(v.prototype.writePointMember_)}},v.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:(0,s.makeChildAppender)(v.prototype.writeLineStringOrCurveMember_),curveMember:(0,s.makeChildAppender)(v.prototype.writeLineStringOrCurveMember_)}},v.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:(0,s.makeChildAppender)(v.prototype.writeCurveOrLineString_),MultiCurve:(0,s.makeChildAppender)(v.prototype.writeMultiCurveOrLineString_),Point:(0,s.makeChildAppender)(v.prototype.writePoint_),MultiPoint:(0,s.makeChildAppender)(v.prototype.writeMultiPoint_),LineString:(0,s.makeChildAppender)(v.prototype.writeCurveOrLineString_),MultiLineString:(0,s.makeChildAppender)(v.prototype.writeMultiCurveOrLineString_),LinearRing:(0,s.makeChildAppender)(v.prototype.writeLinearRing_),Polygon:(0,s.makeChildAppender)(v.prototype.writeSurfaceOrPolygon_),MultiPolygon:(0,s.makeChildAppender)(v.prototype.writeMultiSurfaceOrPolygon_),Surface:(0,s.makeChildAppender)(v.prototype.writeSurfaceOrPolygon_),MultiSurface:(0,s.makeChildAppender)(v.prototype.writeMultiSurfaceOrPolygon_),Envelope:(0,s.makeChildAppender)(v.prototype.writeEnvelope)}};var w=v;c.default=w},{"../array.js":46,"../extent.js":72,"../format/Feature.js":78,"../format/GMLBase.js":83,"../format/xsd.js":125,"../geom/Geometry.js":129,"../geom/GeometryLayout.js":131,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPolygon.js":137,"../geom/Polygon.js":139,"../obj.js":201,"../proj.js":210,"../xml.js":351}],83:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.GMLNS=void 0;var e=a("../array.js"),f=d(a("../Feature.js")),g=a("../format/Feature.js"),h=d(a("../format/XMLFeature.js")),i=d(a("../geom/GeometryLayout.js")),j=d(a("../geom/LineString.js")),k=d(a("../geom/LinearRing.js")),l=d(a("../geom/MultiLineString.js")),m=d(a("../geom/MultiPoint.js")),n=d(a("../geom/MultiPolygon.js")),o=d(a("../geom/Point.js")),p=d(a("../geom/Polygon.js")),q=a("../obj.js"),r=a("../proj.js"),s=a("../xml.js"),t="http://www.opengis.net/gml";c.GMLNS=t;var u=/^[\s\xa0]*$/,v=function(a){function b(b){a.call(this);var c=b||{};this.featureType=c.featureType,this.featureNS=c.featureNS,this.srsName=c.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[t]={featureMember:(0,s.makeReplacer)(this.readFeaturesInternal),featureMembers:(0,s.makeReplacer)(this.readFeaturesInternal)}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFeaturesInternal=function(a,b){var c=this,d=a.localName,e=null;if("FeatureCollection"==d)e="http://www.opengis.net/wfs"===a.namespaceURI?(0,s.pushParseAndPop)([],this.FEATURE_COLLECTION_PARSERS,a,b,this):(0,s.pushParseAndPop)(null,this.FEATURE_COLLECTION_PARSERS,a,b,this);else if("featureMembers"==d||"featureMember"==d){var f=b[0],g=f.featureType,h=f.featureNS,i="p",j="p0";if(!g&&a.childNodes){g=[],h={};for(var k=0,l=a.childNodes.length;k<l;++k){var m=a.childNodes[k];if(1===m.nodeType){var n=m.nodeName.split(":").pop();if(-1===g.indexOf(n)){var o="",p=0,q=m.namespaceURI;for(var r in h){if(h[r]===q){o=r;break}++p}o||(o=i+p,h[o]=q),g.push(o+":"+n)}}}"featureMember"!=d&&(f.featureType=g,f.featureNS=h)}if("string"==typeof h){var t=h;h={},h[j]=t}var u={},v=Array.isArray(g)?g:[g];for(var w in h){for(var x={},y=0,z=v.length;y<z;++y){var A=-1===v[y].indexOf(":")?j:v[y].split(":")[0];A===w&&(x[v[y].split(":").pop()]="featureMembers"==d?(0,s.makeArrayPusher)(c.readFeatureElement,c):(0,s.makeReplacer)(c.readFeatureElement,c))}u[h[w]]=x}e="featureMember"==d?(0,s.pushParseAndPop)(void 0,u,a,b):(0,s.pushParseAndPop)([],u,a,b)}return null===e&&(e=[]),e},b.prototype.readGeometryElement=function(a,b){var c=b[0];c.srsName=a.firstElementChild.getAttribute("srsName"),c.srsDimension=a.firstElementChild.getAttribute("srsDimension");var d=(0,s.pushParseAndPop)(null,this.GEOMETRY_PARSERS_,a,b,this);return d?(0,g.transformWithOptions)(d,!1,c):void 0},b.prototype.readFeatureElement=function(a,b){var c,d,e=this,g=a.getAttribute("fid")||(0,s.getAttributeNS)(a,t,"id"),h={};for(c=a.firstElementChild;c;c=c.nextElementSibling){var i=c.localName;if(0===c.childNodes.length||1===c.childNodes.length&&(3===c.firstChild.nodeType||4===c.firstChild.nodeType)){var j=(0,s.getAllTextContent)(c,!1);u.test(j)&&(j=void 0),h[i]=j}else"boundedBy"!==i&&(d=i),h[i]=e.readGeometryElement(c,b)}var k=new f.default(h);return d&&k.setGeometryName(d),g&&k.setId(g),k},b.prototype.readPoint=function(a,b){var c=this.readFlatCoordinatesFromNode_(a,b);if(c)return new o.default(c,i.default.XYZ)},b.prototype.readMultiPoint=function(a,b){var c=(0,s.pushParseAndPop)([],this.MULTIPOINT_PARSERS_,a,b,this);return c?new m.default(c):void 0},b.prototype.readMultiLineString=function(a,b){var c=(0,s.pushParseAndPop)([],this.MULTILINESTRING_PARSERS_,a,b,this);if(c)return new l.default(c)},b.prototype.readMultiPolygon=function(a,b){var c=(0,s.pushParseAndPop)([],this.MULTIPOLYGON_PARSERS_,a,b,this);if(c)return new n.default(c)},b.prototype.pointMemberParser_=function(a,b){(0,s.parseNode)(this.POINTMEMBER_PARSERS_,a,b,this)},b.prototype.lineStringMemberParser_=function(a,b){(0,s.parseNode)(this.LINESTRINGMEMBER_PARSERS_,a,b,this)},b.prototype.polygonMemberParser_=function(a,b){(0,s.parseNode)(this.POLYGONMEMBER_PARSERS_,a,b,this)},b.prototype.readLineString=function(a,b){var c=this.readFlatCoordinatesFromNode_(a,b);if(c){return new j.default(c,i.default.XYZ)}
},b.prototype.readFlatLinearRing_=function(a,b){var c=(0,s.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b,this);return c||void 0},b.prototype.readLinearRing=function(a,b){var c=this.readFlatCoordinatesFromNode_(a,b);if(c)return new k.default(c,i.default.XYZ)},b.prototype.readPolygon=function(a,b){var c=(0,s.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS_,a,b,this);if(c&&c[0]){var d,f,g=c[0],h=[g.length];for(d=1,f=c.length;d<f;++d)(0,e.extend)(g,c[d]),h.push(g.length);return new p.default(g,i.default.XYZ,h)}},b.prototype.readFlatCoordinatesFromNode_=function(a,b){return(0,s.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b,this)},b.prototype.readGeometryFromNode=function(a,b){var c=this.readGeometryElement(a,[this.getReadOptions(a,b||{})]);return c||null},b.prototype.readFeaturesFromNode=function(a,b){var c={featureType:this.featureType,featureNS:this.featureNS};return b&&(0,q.assign)(c,this.getReadOptions(a,b)),this.readFeaturesInternal(a,[c])||[]},b.prototype.readProjectionFromNode=function(a){return(0,r.get)(this.srsName?this.srsName:a.firstElementChild.getAttribute("srsName"))},b}(h.default);v.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml":{pointMember:(0,s.makeArrayPusher)(v.prototype.pointMemberParser_),pointMembers:(0,s.makeArrayPusher)(v.prototype.pointMemberParser_)}},v.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml":{lineStringMember:(0,s.makeArrayPusher)(v.prototype.lineStringMemberParser_),lineStringMembers:(0,s.makeArrayPusher)(v.prototype.lineStringMemberParser_)}},v.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml":{polygonMember:(0,s.makeArrayPusher)(v.prototype.polygonMemberParser_),polygonMembers:(0,s.makeArrayPusher)(v.prototype.polygonMemberParser_)}},v.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml":{Point:(0,s.makeArrayPusher)(v.prototype.readFlatCoordinatesFromNode_)}},v.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:(0,s.makeArrayPusher)(v.prototype.readLineString)}},v.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:(0,s.makeArrayPusher)(v.prototype.readPolygon)}},v.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:(0,s.makeReplacer)(v.prototype.readFlatLinearRing_)}};var w=v;c.default=w},{"../Feature.js":10,"../array.js":46,"../format/Feature.js":78,"../format/XMLFeature.js":101,"../geom/GeometryLayout.js":131,"../geom/LineString.js":133,"../geom/LinearRing.js":134,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../obj.js":201,"../proj.js":210,"../xml.js":351}],84:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=a.getGeometry();if(d){var e=ca[d.getType()];if(e){var f=b[b.length-1].node;return(0,F.createElementNS)(f.namespaceURI,e)}}}function f(a,b,c,d){return a.push(parseFloat(c.getAttribute("lon")),parseFloat(c.getAttribute("lat"))),"ele"in d?(a.push(d.ele),delete d.ele,b.hasZ=!0):a.push(0),"time"in d?(a.push(d.time),delete d.time,b.hasM=!0):a.push(0),a}function g(a,b,c){var d=A.default.XY,e=2;if(a.hasZ&&a.hasM?(d=A.default.XYZM,e=4):a.hasZ?(d=A.default.XYZ,e=3):a.hasM&&(d=A.default.XYM,e=3),4!==e){for(var f=0,g=b.length/4;f<g;f++)b[f*e]=b[4*f],b[f*e+1]=b[4*f+1],a.hasZ&&(b[f*e+2]=b[4*f+2]),a.hasM&&(b[f*e+2]=b[4*f+3]);if(b.length=b.length/4*e,c)for(var h=0,i=c.length;h<i;h++)c[h]=c[h]/4*e}return d}function h(a,b){var c=b[b.length-1],d=a.getAttribute("href");null!==d&&(c.link=d),(0,F.parseNode)(K,a,b)}function i(a,b){b[b.length-1].extensionsNode_=a}function j(a,b){var c=(0,F.pushParseAndPop)({},O,a,b);if(c){var d=b[b.length-1];f(d.flatCoordinates,d.layoutOptions,a,c)}}function k(a,b){var c=(0,F.pushParseAndPop)({},R,a,b);if(c){var d=b[b.length-1];f(d.flatCoordinates,d.layoutOptions,a,c)}}function l(a,b){var c=b[b.length-1];(0,F.parseNode)(Q,a,b);var d=c.flatCoordinates;c.ends.push(d.length)}function m(a,b){var c=b[0],d=(0,F.pushParseAndPop)({flatCoordinates:[],layoutOptions:{}},N,a,b);if(d){var e=d.flatCoordinates;delete d.flatCoordinates;var f=d.layoutOptions;delete d.layoutOptions;var h=g(f,e),i=new B.default(e,h);(0,x.transformWithOptions)(i,!1,c);var j=new v.default(i);return j.setProperties(d),j}}function n(a,b){var c=b[0],d=(0,F.pushParseAndPop)({flatCoordinates:[],ends:[],layoutOptions:{}},P,a,b);if(d){var e=d.flatCoordinates;delete d.flatCoordinates;var f=d.ends;delete d.ends;var h=d.layoutOptions;delete d.layoutOptions;var i=g(h,e,f),j=new C.default(e,i,f);(0,x.transformWithOptions)(j,!1,c);var k=new v.default(j);return k.setProperties(d),k}}function o(a,b){var c=b[0],d=(0,F.pushParseAndPop)({},S,a,b);if(d){var e={},h=f([],e,a,d),i=g(e,h),j=new D.default(h,i);(0,x.transformWithOptions)(j,!1,c);var k=new v.default(j);return k.setProperties(d),k}}function p(a,b,c){a.setAttribute("href",b);var d=c[c.length-1],e=d.properties,f=[e.linkText,e.linkType];(0,F.pushSerializeAndPop)({node:a},U,F.OBJECT_PROPERTY_NODE_FACTORY,f,c,T)}function q(a,b,c){var d=c[c.length-1],e=d.node,f=e.namespaceURI,g=d.properties;switch(a.setAttributeNS(null,"lat",b[1]),a.setAttributeNS(null,"lon",b[0]),d.geometryLayout){case A.default.XYZM:0!==b[3]&&(g.time=b[3]);case A.default.XYZ:0!==b[2]&&(g.ele=b[2]);break;case A.default.XYM:0!==b[2]&&(g.time=b[2])}var h="rtept"==a.nodeName?X[f]:aa[f],i=(0,F.makeSequence)(g,h);(0,F.pushSerializeAndPop)({node:a,properties:g},ba,F.OBJECT_PROPERTY_NODE_FACTORY,i,c,h)}function r(a,b,c){var d=c[0],e=b.getProperties(),f={node:a,properties:e},g=b.getGeometry();g&&(g=(0,x.transformWithOptions)(g,!0,d),f.geometryLayout=g.getLayout(),e.rtept=g.getCoordinates());var h=c[c.length-1].node,i=V[h.namespaceURI],j=(0,F.makeSequence)(e,i);(0,F.pushSerializeAndPop)(f,W,F.OBJECT_PROPERTY_NODE_FACTORY,j,c,i)}function s(a,b,c){var d=c[0],e=b.getProperties(),f={node:a,properties:e},g=b.getGeometry();g&&(g=(0,x.transformWithOptions)(g,!0,d),e.trkseg=g.getLineStrings());var h=c[c.length-1].node,i=Y[h.namespaceURI],j=(0,F.makeSequence)(e,i);(0,F.pushSerializeAndPop)(f,Z,F.OBJECT_PROPERTY_NODE_FACTORY,j,c,i)}function t(a,b,c){var d={node:a,geometryLayout:b.getLayout(),properties:{}};(0,F.pushSerializeAndPop)(d,_,$,b.getCoordinates(),c)}function u(a,b,c){var d=c[0],e=c[c.length-1];e.properties=b.getProperties();var f=b.getGeometry();f&&(f=(0,x.transformWithOptions)(f,!0,d),e.geometryLayout=f.getLayout(),q(a,f.getCoordinates(),c))}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var v=d(a("../Feature.js")),w=a("../array.js"),x=a("../format/Feature.js"),y=d(a("../format/XMLFeature.js")),z=a("../format/xsd.js"),A=d(a("../geom/GeometryLayout.js")),B=d(a("../geom/LineString.js")),C=d(a("../geom/MultiLineString.js")),D=d(a("../geom/Point.js")),E=a("../proj.js"),F=a("../xml.js"),G=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],H="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",I={rte:m,trk:n,wpt:o},J=(0,F.makeStructureNS)(G,{rte:(0,F.makeArrayPusher)(m),trk:(0,F.makeArrayPusher)(n),wpt:(0,F.makeArrayPusher)(o)}),K=(0,F.makeStructureNS)(G,{text:(0,F.makeObjectPropertySetter)(z.readString,"linkText"),type:(0,F.makeObjectPropertySetter)(z.readString,"linkType")}),L=(0,F.makeStructureNS)(G,{rte:(0,F.makeChildAppender)(r),trk:(0,F.makeChildAppender)(s),wpt:(0,F.makeChildAppender)(u)}),M=function(a){function b(b){a.call(this);var c=b||{};this.dataProjection=(0,E.get)("EPSG:4326"),this.readExtensions_=c.readExtensions}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleReadExtensions_=function(a){var b=this;a||(a=[]);for(var c=0,d=a.length;c<d;++c){var e=a[c];if(b.readExtensions_){var f=e.get("extensionsNode_")||null;b.readExtensions_(e,f)}e.set("extensionsNode_",void 0)}},b.prototype.readFeatureFromNode=function(a,b){if(!(0,w.includes)(G,a.namespaceURI))return null;var c=I[a.localName];if(!c)return null;var d=c(a,[this.getReadOptions(a,b)]);return d?(this.handleReadExtensions_([d]),d):null},b.prototype.readFeaturesFromNode=function(a,b){if(!(0,w.includes)(G,a.namespaceURI))return[];if("gpx"==a.localName){var c=(0,F.pushParseAndPop)([],J,a,[this.getReadOptions(a,b)]);return c?(this.handleReadExtensions_(c),c):[]}return[]},b.prototype.writeFeaturesNode=function(a,b){b=this.adaptOptions(b);var c=(0,F.createElementNS)("http://www.topografix.com/GPX/1/1","gpx");return c.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",F.XML_SCHEMA_INSTANCE_URI),c.setAttributeNS(F.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",H),c.setAttribute("version","1.1"),c.setAttribute("creator","OpenLayers"),(0,F.pushSerializeAndPop)({node:c},L,e,a,[b]),c},b}(y.default),N=(0,F.makeStructureNS)(G,{name:(0,F.makeObjectPropertySetter)(z.readString),cmt:(0,F.makeObjectPropertySetter)(z.readString),desc:(0,F.makeObjectPropertySetter)(z.readString),src:(0,F.makeObjectPropertySetter)(z.readString),link:h,number:(0,F.makeObjectPropertySetter)(z.readNonNegativeInteger),extensions:i,type:(0,F.makeObjectPropertySetter)(z.readString),rtept:j}),O=(0,F.makeStructureNS)(G,{ele:(0,F.makeObjectPropertySetter)(z.readDecimal),time:(0,F.makeObjectPropertySetter)(z.readDateTime)}),P=(0,F.makeStructureNS)(G,{name:(0,F.makeObjectPropertySetter)(z.readString),cmt:(0,F.makeObjectPropertySetter)(z.readString),desc:(0,F.makeObjectPropertySetter)(z.readString),src:(0,F.makeObjectPropertySetter)(z.readString),link:h,number:(0,F.makeObjectPropertySetter)(z.readNonNegativeInteger),type:(0,F.makeObjectPropertySetter)(z.readString),extensions:i,trkseg:l}),Q=(0,F.makeStructureNS)(G,{trkpt:k}),R=(0,F.makeStructureNS)(G,{ele:(0,F.makeObjectPropertySetter)(z.readDecimal),time:(0,F.makeObjectPropertySetter)(z.readDateTime)}),S=(0,F.makeStructureNS)(G,{ele:(0,F.makeObjectPropertySetter)(z.readDecimal),time:(0,F.makeObjectPropertySetter)(z.readDateTime),magvar:(0,F.makeObjectPropertySetter)(z.readDecimal),geoidheight:(0,F.makeObjectPropertySetter)(z.readDecimal),name:(0,F.makeObjectPropertySetter)(z.readString),cmt:(0,F.makeObjectPropertySetter)(z.readString),desc:(0,F.makeObjectPropertySetter)(z.readString),src:(0,F.makeObjectPropertySetter)(z.readString),link:h,sym:(0,F.makeObjectPropertySetter)(z.readString),type:(0,F.makeObjectPropertySetter)(z.readString),fix:(0,F.makeObjectPropertySetter)(z.readString),sat:(0,F.makeObjectPropertySetter)(z.readNonNegativeInteger),hdop:(0,F.makeObjectPropertySetter)(z.readDecimal),vdop:(0,F.makeObjectPropertySetter)(z.readDecimal),pdop:(0,F.makeObjectPropertySetter)(z.readDecimal),ageofdgpsdata:(0,F.makeObjectPropertySetter)(z.readDecimal),dgpsid:(0,F.makeObjectPropertySetter)(z.readNonNegativeInteger),extensions:i}),T=["text","type"],U=(0,F.makeStructureNS)(G,{text:(0,F.makeChildAppender)(z.writeStringTextNode),type:(0,F.makeChildAppender)(z.writeStringTextNode)}),V=(0,F.makeStructureNS)(G,["name","cmt","desc","src","link","number","type","rtept"]),W=(0,F.makeStructureNS)(G,{name:(0,F.makeChildAppender)(z.writeStringTextNode),cmt:(0,F.makeChildAppender)(z.writeStringTextNode),desc:(0,F.makeChildAppender)(z.writeStringTextNode),src:(0,F.makeChildAppender)(z.writeStringTextNode),link:(0,F.makeChildAppender)(p),number:(0,F.makeChildAppender)(z.writeNonNegativeIntegerTextNode),type:(0,F.makeChildAppender)(z.writeStringTextNode),rtept:(0,F.makeArraySerializer)((0,F.makeChildAppender)(q))}),X=(0,F.makeStructureNS)(G,["ele","time"]),Y=(0,F.makeStructureNS)(G,["name","cmt","desc","src","link","number","type","trkseg"]),Z=(0,F.makeStructureNS)(G,{name:(0,F.makeChildAppender)(z.writeStringTextNode),cmt:(0,F.makeChildAppender)(z.writeStringTextNode),desc:(0,F.makeChildAppender)(z.writeStringTextNode),src:(0,F.makeChildAppender)(z.writeStringTextNode),link:(0,F.makeChildAppender)(p),number:(0,F.makeChildAppender)(z.writeNonNegativeIntegerTextNode),type:(0,F.makeChildAppender)(z.writeStringTextNode),trkseg:(0,F.makeArraySerializer)((0,F.makeChildAppender)(t))}),$=(0,F.makeSimpleNodeFactory)("trkpt"),_=(0,F.makeStructureNS)(G,{trkpt:(0,F.makeChildAppender)(q)}),aa=(0,F.makeStructureNS)(G,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),ba=(0,F.makeStructureNS)(G,{ele:(0,F.makeChildAppender)(z.writeDecimalTextNode),time:(0,F.makeChildAppender)(z.writeDateTimeTextNode),magvar:(0,F.makeChildAppender)(z.writeDecimalTextNode),geoidheight:(0,F.makeChildAppender)(z.writeDecimalTextNode),name:(0,F.makeChildAppender)(z.writeStringTextNode),cmt:(0,F.makeChildAppender)(z.writeStringTextNode),desc:(0,F.makeChildAppender)(z.writeStringTextNode),src:(0,F.makeChildAppender)(z.writeStringTextNode),link:(0,F.makeChildAppender)(p),sym:(0,F.makeChildAppender)(z.writeStringTextNode),type:(0,F.makeChildAppender)(z.writeStringTextNode),fix:(0,F.makeChildAppender)(z.writeStringTextNode),sat:(0,F.makeChildAppender)(z.writeNonNegativeIntegerTextNode),hdop:(0,F.makeChildAppender)(z.writeDecimalTextNode),vdop:(0,F.makeChildAppender)(z.writeDecimalTextNode),pdop:(0,F.makeChildAppender)(z.writeDecimalTextNode),ageofdgpsdata:(0,F.makeChildAppender)(z.writeDecimalTextNode),dgpsid:(0,F.makeChildAppender)(z.writeNonNegativeIntegerTextNode)}),ca={Point:"wpt",LineString:"rte",MultiLineString:"trk"},da=M;c.default=da},{"../Feature.js":10,"../array.js":46,"../format/Feature.js":78,"../format/XMLFeature.js":101,"../format/xsd.js":125,"../geom/GeometryLayout.js":131,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/Point.js":138,"../proj.js":210,"../xml.js":351}],85:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!a)return null;var c=J[a.type];return(0,x.transformWithOptions)(c(a),!1,b)}function f(a,b){var c=a.geometries.map(function(a){return e(a,b)});return new z.default(c)}function g(a){return new E.default(a.coordinates)}function h(a){return new A.default(a.coordinates)}function i(a){return new B.default(a.coordinates)}function j(a){return new C.default(a.coordinates)}function k(a){return new D.default(a.coordinates)}function l(a){return new F.default(a.coordinates)}function m(a,b){return(0,K[a.getType()])((0,x.transformWithOptions)(a,!0,b),b)}function n(a){return{type:"GeometryCollection",geometries:[]}}function o(a,b){return{type:"GeometryCollection",geometries:a.getGeometriesArray().map(function(a){var c=(0,G.assign)({},b);return delete c.featureProjection,m(a,c)})}}function p(a,b){return{type:"LineString",coordinates:a.getCoordinates()}}function q(a,b){return{type:"MultiLineString",coordinates:a.getCoordinates()}}function r(a,b){return{type:"MultiPoint",coordinates:a.getCoordinates()}}function s(a,b){var c;return b&&(c=b.rightHanded),{type:"MultiPolygon",coordinates:a.getCoordinates(c)}}function t(a,b){return{type:"Point",coordinates:a.getCoordinates()}}function u(a,b){var c;return b&&(c=b.rightHanded),{type:"Polygon",coordinates:a.getCoordinates(c)}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var v=a("../asserts.js"),w=d(a("../Feature.js")),x=a("../format/Feature.js"),y=d(a("../format/JSONFeature.js")),z=d(a("../geom/GeometryCollection.js")),A=d(a("../geom/LineString.js")),B=d(a("../geom/MultiLineString.js")),C=d(a("../geom/MultiPoint.js")),D=d(a("../geom/MultiPolygon.js")),E=d(a("../geom/Point.js")),F=d(a("../geom/Polygon.js")),G=a("../obj.js"),H=a("../proj.js"),I=function(a){function b(b){var c=b||{};a.call(this),this.dataProjection=(0,H.get)(c.dataProjection?c.dataProjection:"EPSG:4326"),c.featureProjection&&(this.defaultFeatureProjection=(0,H.get)(c.featureProjection)),this.geometryName_=c.geometryName,this.extractGeometryName_=c.extractGeometryName}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFeatureFromObject=function(a,b){var c=null;c="Feature"===a.type?a:{type:"Feature",geometry:a};var d=e(c.geometry,b),f=new w.default;return this.geometryName_?f.setGeometryName(this.geometryName_):this.extractGeometryName_&&void 0!==c.geometry_name&&f.setGeometryName(c.geometry_name),f.setGeometry(d),void 0!==c.id&&f.setId(c.id),c.properties&&f.setProperties(c.properties),f},b.prototype.readFeaturesFromObject=function(a,b){var c=this,d=a,e=null;if("FeatureCollection"===d.type){var f=a;e=[];for(var g=f.features,h=0,i=g.length;h<i;++h)e.push(c.readFeatureFromObject(g[h],b))}else e=[this.readFeatureFromObject(a,b)];return e},b.prototype.readGeometryFromObject=function(a,b){return e(a,b)},b.prototype.readProjectionFromObject=function(a){var b,c=a,d=c.crs;return d?"name"==d.type?b=(0,H.get)(d.properties.name):(0,v.assert)(!1,36):b=this.dataProjection,b},b.prototype.writeFeatureObject=function(a,b){b=this.adaptOptions(b);var c={type:"Feature"},d=a.getId();void 0!==d&&(c.id=d);var e=a.getGeometry();c.geometry=e?m(e,b):null;var f=a.getProperties();return delete f[a.getGeometryName()],(0,G.isEmpty)(f)?c.properties=null:c.properties=f,c},b.prototype.writeFeaturesObject=function(a,b){var c=this;b=this.adaptOptions(b);for(var d=[],e=0,f=a.length;e<f;++e)d.push(c.writeFeatureObject(a[e],b));return{type:"FeatureCollection",features:d}},b.prototype.writeGeometryObject=function(a,b){return m(a,this.adaptOptions(b))},b}(y.default),J={Point:g,LineString:h,Polygon:l,MultiPoint:j,MultiLineString:i,MultiPolygon:k,GeometryCollection:f},K={Point:t,LineString:p,Polygon:u,MultiPoint:r,MultiLineString:q,MultiPolygon:s,GeometryCollection:o,Circle:n},L=I;c.default=L},{"../Feature.js":10,"../asserts.js":47,"../format/Feature.js":78,"../format/JSONFeature.js":87,"../geom/GeometryCollection.js":130,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../obj.js":201,"../proj.js":210}],86:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Feature.js")),f=a("../format/Feature.js"),g=d(a("../format/TextFeature.js")),h=d(a("../geom/GeometryLayout.js")),i=d(a("../geom/LineString.js")),j=a("../proj.js"),k={BAROMETRIC:"barometric",GPS:"gps",NONE:"none"},l=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,m=/^H.([A-Z]{3}).*?:(.*)/,n=/^HFDTE(\d{2})(\d{2})(\d{2})/,o=/\r\n|\r|\n/,p=function(a){function b(b){a.call(this);var c=b||{};this.dataProjection=(0,j.get)("EPSG:4326"),this.altitudeMode_=c.altitudeMode?c.altitudeMode:k.NONE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFeatureFromText=function(a,b){var c,d,g=this.altitudeMode_,j=a.split(o),p={},q=[],r=2e3,s=0,t=1,u=-1;for(c=0,d=j.length;c<d;++c){var v=j[c],w=void 0;if("B"==v.charAt(0)){if(w=l.exec(v)){var x=parseInt(w[1],10),y=parseInt(w[2],10),z=parseInt(w[3],10),A=parseInt(w[4],10)+parseInt(w[5],10)/6e4;"S"==w[6]&&(A=-A);var B=parseInt(w[7],10)+parseInt(w[8],10)/6e4;if("W"==w[9]&&(B=-B),q.push(B,A),g!=k.NONE){var C=void 0;C=g==k.GPS?parseInt(w[11],10):g==k.BAROMETRIC?parseInt(w[12],10):0,q.push(C)}var D=Date.UTC(r,s,t,x,y,z);D<u&&(D=Date.UTC(r,s,t+1,x,y,z)),q.push(D/1e3),u=D}}else"H"==v.charAt(0)&&(w=n.exec(v),w?(t=parseInt(w[1],10),s=parseInt(w[2],10)-1,r=2e3+parseInt(w[3],10)):(w=m.exec(v))&&(p[w[1]]=w[2].trim()))}if(0===q.length)return null;var E=g==k.NONE?h.default.XYM:h.default.XYZM,F=new i.default(q,E),G=new e.default((0,f.transformWithOptions)(F,!1,b));return G.setProperties(p),G},b.prototype.readFeaturesFromText=function(a,b){var c=this.readFeatureFromText(a,b);return c?[c]:[]},b}(g.default),q=p;c.default=q},{"../Feature.js":10,"../format/Feature.js":78,"../format/TextFeature.js":92,"../geom/GeometryLayout.js":131,"../geom/LineString.js":133,"../proj.js":210}],87:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if("string"==typeof a){var b=JSON.parse(a);return b||null}return null!==a?a:null}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a("../format/Feature.js")),g=d(a("../format/FormatType.js")),h=function(a){function b(){a.call(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return g.default.JSON},b.prototype.readFeature=function(a,b){return this.readFeatureFromObject(e(a),this.getReadOptions(a,b))},b.prototype.readFeatures=function(a,b){return this.readFeaturesFromObject(e(a),this.getReadOptions(a,b))},b.prototype.readFeatureFromObject=function(a,b){},b.prototype.readFeaturesFromObject=function(a,b){},b.prototype.readGeometry=function(a,b){return this.readGeometryFromObject(e(a),this.getReadOptions(a,b))},b.prototype.readGeometryFromObject=function(a,b){},b.prototype.readProjection=function(a){return this.readProjectionFromObject(e(a))},b.prototype.readProjectionFromObject=function(a){},b.prototype.writeFeature=function(a,b){return JSON.stringify(this.writeFeatureObject(a,b))},b.prototype.writeFeatureObject=function(a,b){},b.prototype.writeFeatures=function(a,b){return JSON.stringify(this.writeFeaturesObject(a,b))},b.prototype.writeFeaturesObject=function(a,b){},b.prototype.writeGeometry=function(a,b){return JSON.stringify(this.writeGeometryObject(a,b))},b.prototype.writeGeometryObject=function(a,b){},b}(f.default),i=h;c.default=i},{"../format/Feature.js":78,"../format/FormatType.js":79}],88:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(){return ib}function g(){return jb}function h(){return kb}function i(){return lb}function j(){return mb}function k(){return nb}function l(){ra=[255,255,255,1],ib=new Sa.default({color:ra}),sa=[20,2],ta=Ua.default.PIXELS,ua=Ua.default.PIXELS,va=[64,64],wa="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",xa=.5,jb=new Ta.default({anchor:sa,anchorOrigin:Va.default.BOTTOM_LEFT,anchorXUnits:ta,anchorYUnits:ua,crossOrigin:"anonymous",rotation:0,scale:xa,size:va,src:wa}),ya="NO_IMAGE",kb=new Wa.default({color:ra,width:1}),za=new Wa.default({color:[51,51,51,1],width:2}),lb=new Ya.default({font:"bold 16px Helvetica",fill:ib,stroke:za,scale:.8}),mb=new Xa.default({fill:ib,image:jb,text:lb,stroke:kb,zIndex:0}),nb=[mb]}function m(a,b){var c=null,d=[0,0],e="start";if(a.getImage()){var f=a.getImage().getImageSize();if(null===f&&(f=va),2==f.length){var g=a.getImage().getScale();d[0]=g*f[0]/2,d[1]=-g*f[1]/2,e="left"}}if(null!==a.getText()){var h=a.getText();c=h.clone(),c.setFont(h.getFont()||lb.getFont()),c.setScale(h.getScale()||lb.getScale()),c.setFill(h.getFill()||lb.getFill()),c.setStroke(h.getStroke()||za)}else c=lb.clone();return c.setText(b),c.setOffsetX(d[0]),c.setOffsetY(d[1]),c.setTextAlign(e),new Xa.default({text:c})}function n(a,b,c,d,e){return function(f,g){var h,i=e,j="";if(i){var k=f.getGeometry();k&&(i=k.getType()===Ja.default.POINT)}if(i&&(j=f.get("name"),i=i&&j),a)return i?(h=m(a[0],j),a.concat(h)):a;if(b){var l=o(b,c,d);return i?(h=m(l[0],j),l.concat(h)):l}return i?(h=m(c[0],j),c.concat(h)):c}}function o(a,b,c){return Array.isArray(a)?a:"string"==typeof a?(!(a in c)&&"#"+a in c&&(a="#"+a),o(c[a],b,c)):b}function p(a){var b=(0,Za.getAllTextContent)(a,!1),c=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(b);if(c){var d=c[1];return[parseInt(d.substr(6,2),16),parseInt(d.substr(4,2),16),parseInt(d.substr(2,2),16),parseInt(d.substr(0,2),16)/255]}}function q(a){for(var b,c=(0,Za.getAllTextContent)(a,!1),d=[],e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;b=e.exec(c);){var f=parseFloat(b[1]),g=parseFloat(b[2]),h=b[3]?parseFloat(b[3]):0;d.push(f,g,h),c=c.substr(b[0].length)}if(""===c)return d}function r(a){var b=(0,Za.getAllTextContent)(a,!1).trim(),c=a.baseURI;if(c&&"about:blank"!=c||(c=window.location.href),c){return new URL(b,c).href}return b}function s(a){var b,c=a.getAttribute("xunits"),d=a.getAttribute("yunits");return b="insetPixels"!==c?"insetPixels"!==d?Va.default.BOTTOM_LEFT:Va.default.TOP_LEFT:"insetPixels"!==d?Va.default.BOTTOM_RIGHT:Va.default.TOP_RIGHT,{x:parseFloat(a.getAttribute("x")),xunits:bb[c],y:parseFloat(a.getAttribute("y")),yunits:bb[d],origin:b}}function t(a){return(0,Ga.readDecimal)(a)}function u(a,b){return(0,Za.pushParseAndPop)(void 0,pb,a,b)}function v(a,b){var c=(0,Za.pushParseAndPop)({},qb,a,b);if(c){var d,e=b[b.length-1],f="Icon"in c?c.Icon:{},g=!("Icon"in c)||Object.keys(f).length>0,h=f.href;h?d=h:g&&(d=wa);var i,j,k,l=Va.default.BOTTOM_LEFT,m=c.hotSpot;m?(i=[m.x,m.y],j=m.xunits,k=m.yunits,l=m.origin):d===wa?(i=sa,j=ta,k=ua):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(d)&&(i=[.5,0],j=Ua.default.FRACTION,k=Ua.default.FRACTION);var n,o=f.x,p=f.y;void 0!==o&&void 0!==p&&(n=[o,p]);var q,r=f.w,s=f.h;void 0!==r&&void 0!==s&&(q=[r,s]);var t,u=c.heading;void 0!==u&&(t=(0,Qa.toRadians)(u));var v=c.scale;if(g){d==wa&&(q=va,void 0===v&&(v=xa));var w=new Ta.default({anchor:i,anchorOrigin:l,anchorXUnits:j,anchorYUnits:k,crossOrigin:"anonymous",offset:n,offsetOrigin:Va.default.BOTTOM_LEFT,rotation:t,scale:v,size:q,src:d});e.imageStyle=w}else e.imageStyle=ya}}function w(a,b){var c=(0,Za.pushParseAndPop)({},rb,a,b);if(c){var d=b[b.length-1],e=new Ya.default({fill:new Sa.default({color:"color"in c?c.color:ra}),scale:c.scale});d.textStyle=e}}function x(a,b){var c=(0,Za.pushParseAndPop)({},sb,a,b);if(c){var d=b[b.length-1],e=new Wa.default({color:"color"in c?c.color:ra,width:"width"in c?c.width:1});d.strokeStyle=e}}function y(a,b){var c=(0,Za.pushParseAndPop)({},tb,a,b);if(c){var d=b[b.length-1],e=new Sa.default({color:"color"in c?c.color:ra});d.fillStyle=e;var f=c.fill;void 0!==f&&(d.fill=f);var g=c.outline;void 0!==g&&(d.outline=g)}}function z(a,b){return(0,Za.pushParseAndPop)(null,ub,a,b)}function A(a,b){var c=b[b.length-1],d=c.flatCoordinates,e=(0,Za.getAllTextContent)(a,!1),f=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i,g=f.exec(e);if(g){var h=parseFloat(g[1]),i=parseFloat(g[2]),j=parseFloat(g[3]);d.push(h,i,j,0)}else d.push(0,0,0,0)}function B(a,b){var c=(0,Za.pushParseAndPop)([],vb,a,b);if(c)return new La.default(c)}function C(a,b){var c=(0,Za.pushParseAndPop)({flatCoordinates:[],whens:[]},wb,a,b);if(c){for(var d=c.flatCoordinates,e=c.whens,f=0,g=Math.min(d.length,e.length);f<g;++f)d[4*f+3]=e[f];return new Ka.default(d,Ia.default.XYZM)}}function D(a,b){var c=(0,Za.pushParseAndPop)({},xb,a,b);return c||null}function E(a,b){return(0,Za.pushParseAndPop)(null,yb,a,b)}function F(a,b){var c=(0,Za.pushParseAndPop)({},zb,a,b),d=E(a,b);if(d){var e=new Ka.default(d,Ia.default.XYZ);return e.setProperties(c),e}}function G(a,b){var c=(0,Za.pushParseAndPop)({},zb,a,b),d=E(a,b);if(d){var e=new Pa.default(d,Ia.default.XYZ,[d.length]);return e.setProperties(c),e}}function H(a,b){var c=(0,Za.pushParseAndPop)([],Ab,a,b);if(!c)return null;if(0===c.length)return new Ha.default(c);for(var d,e,f=!0,g=c[0].getType(),h=1,i=c.length;h<i;++h)if(e=c[h],e.getType()!=g){f=!1;break}if(f){var j,k;if(g==Ja.default.POINT){var l=c[0];j=l.getLayout(),k=l.getFlatCoordinates();for(var m=1,n=c.length;m<n;++m)e=c[m],(0,Ba.extend)(k,e.getFlatCoordinates());d=new Ma.default(k,j),L(d,c)}else g==Ja.default.LINE_STRING?(d=new La.default(c),L(d,c)):g==Ja.default.POLYGON?(d=new Na.default(c),L(d,c)):g==Ja.default.GEOMETRY_COLLECTION?d=new Ha.default(c):(0,Ca.assert)(!1,37)}else d=new Ha.default(c);return d}function I(a,b){var c=(0,Za.pushParseAndPop)({},zb,a,b),d=E(a,b);if(d){var e=new Oa.default(d,Ia.default.XYZ);return e.setProperties(c),e}}function J(a,b){var c=(0,Za.pushParseAndPop)({},zb,a,b),d=(0,Za.pushParseAndPop)([null],Bb,a,b);if(d&&d[0]){for(var e=d[0],f=[e.length],g=1,h=d.length;g<h;++g)(0,Ba.extend)(e,d[g]),f.push(e.length);var i=new Pa.default(e,Ia.default.XYZ,f);return i.setProperties(c),i}}function K(a,b){var c=(0,Za.pushParseAndPop)({},Cb,a,b);if(!c)return null;var d="fillStyle"in c?c.fillStyle:ib,e=c.fill;void 0===e||e||(d=null);var f="imageStyle"in c?c.imageStyle:jb;f==ya&&(f=void 0);var g="textStyle"in c?c.textStyle:lb,h="strokeStyle"in c?c.strokeStyle:kb,i=c.outline;return void 0===i||i||(h=null),[new Xa.default({fill:d,image:f,stroke:h,text:g,zIndex:void 0})]}function L(a,b){var c,d,e,f=b.length,g=new Array(b.length),h=new Array(b.length),i=new Array(b.length);c=d=e=!1;for(var j=0;j<f;++j){var k=b[j];g[j]=k.get("extrude"),h[j]=k.get("tessellate"),i[j]=k.get("altitudeMode"),c=c||void 0!==g[j],d=d||void 0!==h[j],e=e||i[j]}c&&a.set("extrude",g),d&&a.set("tessellate",h),e&&a.set("altitudeMode",i)}function M(a,b){var c=a.getAttribute("name");(0,Za.parseNode)(Db,a,b);var d=b[b.length-1];null!==c?d[c]=d.value:null!==d.displayName&&(d[d.displayName]=d.value),delete d.value}function N(a,b){(0,Za.parseNode)(Eb,a,b)}function O(a,b){(0,Za.parseNode)(fb,a,b)}function P(a,b){var c=(0,Za.pushParseAndPop)({},Fb,a,b);if(c){var d=c.key;if(d&&"normal"==d){var e=c.styleUrl;e&&(b[b.length-1]=e);var f=c.Style;f&&(b[b.length-1]=f)}}}function Q(a,b){var c=u(a,b);if(c){var d=b[b.length-1];Array.isArray(c)?d.Style=c:"string"==typeof c?d.styleUrl=c:(0,Ca.assert)(!1,38)}}function R(a,b){(0,Za.parseNode)(Gb,a,b)}function S(a,b){var c=a.getAttribute("name");if(null!==c){var d=(0,Ga.readString)(a);b[b.length-1][c]=d}}function T(a,b){var c=(0,Za.pushParseAndPop)({},Hb,a,b);if(c){var d=b[b.length-1],e=[parseFloat(c.west),parseFloat(c.south),parseFloat(c.east),parseFloat(c.north)];d.extent=e,d.altitudeMode=c.altitudeMode,d.minAltitude=parseFloat(c.minAltitude),d.maxAltitude=parseFloat(c.maxAltitude)}}function U(a,b){var c=(0,Za.pushParseAndPop)({},Ib,a,b);if(c){var d=b[b.length-1];d.minLodPixels=parseFloat(c.minLodPixels),d.maxLodPixels=parseFloat(c.maxLodPixels),d.minFadeExtent=parseFloat(c.minFadeExtent),d.maxFadeExtent=parseFloat(c.maxFadeExtent)}}function V(a,b){var c=(0,Za.pushParseAndPop)(void 0,Jb,a,b);if(c){b[b.length-1].push(c)}}function W(a,b){var c=(0,Za.pushParseAndPop)(void 0,Kb,a,b);if(c){b[b.length-1][0]=c}}function X(a,b){(0,Za.parseNode)(eb,a,b)}function Y(a,b){var c=b[b.length-1],d=c.whens,e=(0,Za.getAllTextContent)(a,!1),f=Date.parse(e);d.push(isNaN(f)?0:f)}function Z(a,b){for(var c=(0,Da.asArray)(b),d=4==c.length?c[3]:1,e=[255*d,c[2],c[1],c[0]],f=0;f<4;++f){var g=parseInt(e[f],10).toString(16);e[f]=1==g.length?"0"+g:g}(0,Ga.writeStringTextNode)(a,e.join(""))}function $(a,b,c){var d,e=c[c.length-1],f=e.layout,g=e.stride;f==Ia.default.XY||f==Ia.default.XYM?d=2:f==Ia.default.XYZ||f==Ia.default.XYZM?d=3:(0,Ca.assert)(!1,34);var h=b.length,i="";if(h>0){i+=b[0];for(var j=1;j<d;++j)i+=","+b[j];for(var k=g;k<h;k+=g){i+=" "+b[k];for(var l=1;l<d;++l)i+=","+b[k+l]}}(0,Ga.writeStringTextNode)(a,i)}function _(a,b,c){a.setAttribute("name",b.name);var d={node:a},f=b.value;"object"==e(f)?(null!==f&&f.displayName&&(0,Za.pushSerializeAndPop)(d,Lb,Za.OBJECT_PROPERTY_NODE_FACTORY,[f.displayName],c,["displayName"]),null!==f&&f.value&&(0,Za.pushSerializeAndPop)(d,Lb,Za.OBJECT_PROPERTY_NODE_FACTORY,[f.value],c,["value"])):(0,Za.pushSerializeAndPop)(d,Lb,Za.OBJECT_PROPERTY_NODE_FACTORY,[f],c,["value"])}function aa(a,b){(0,Ga.writeCDATASection)(a,b)}function ba(a,b){(0,Ga.writeStringTextNode)(a,b)}function ca(a,b,c){var d={node:a};(0,Za.pushSerializeAndPop)(d,Mb,Nb,b,c,void 0,this)}function da(a,b,c){for(var d={node:a},e=b.names,f=b.values,g=e.length,h=0;h<g;h++)(0,Za.pushSerializeAndPop)(d,Lb,Ob,[{name:e[h],value:f[h]}],c)}function ea(a,b,c){var d={node:a},e=c[c.length-1].node,f=Pb[e.namespaceURI],g=(0,Za.makeSequence)(b,f);(0,Za.pushSerializeAndPop)(d,Qb,Za.OBJECT_PROPERTY_NODE_FACTORY,g,c,f),f=Pb[$a[0]],g=(0,Za.makeSequence)(b,f),(0,Za.pushSerializeAndPop)(d,Qb,Rb,g,c,f)}function fa(a,b,c){var d={node:a
},e={},f=b.getSrc(),g=b.getSize(),h=b.getImageSize(),i={href:f};if(g){i.w=g[0],i.h=g[1];var j=b.getAnchor(),k=b.getOrigin();if(k&&h&&0!==k[0]&&k[1]!==g[1]&&(i.x=k[0],i.y=h[1]-(k[1]+g[1])),j&&(j[0]!==g[0]/2||j[1]!==g[1]/2)){var l={x:j[0],xunits:Ua.default.PIXELS,y:g[1]-j[1],yunits:Ua.default.PIXELS};e.hotSpot=l}}e.Icon=i;var m=b.getScale();1!==m&&(e.scale=m);var n=b.getRotation();0!==n&&(e.heading=n);var o=c[c.length-1].node,p=Sb[o.namespaceURI],q=(0,Za.makeSequence)(e,p);(0,Za.pushSerializeAndPop)(d,Tb,Za.OBJECT_PROPERTY_NODE_FACTORY,q,c,p)}function ga(a,b,c){var d={node:a},e={},f=b.getFill();f&&(e.color=f.getColor());var g=b.getScale();g&&1!==g&&(e.scale=g);var h=c[c.length-1].node,i=Ub[h.namespaceURI],j=(0,Za.makeSequence)(e,i);(0,Za.pushSerializeAndPop)(d,Vb,Za.OBJECT_PROPERTY_NODE_FACTORY,j,c,i)}function ha(a,b,c){var d={node:a},e={color:b.getColor(),width:b.getWidth()},f=c[c.length-1].node,g=Wb[f.namespaceURI],h=(0,Za.makeSequence)(e,g);(0,Za.pushSerializeAndPop)(d,Xb,Za.OBJECT_PROPERTY_NODE_FACTORY,h,c,g)}function ia(a,b,c){var d,e,f={node:a},g=b.getType();g==Ja.default.GEOMETRY_COLLECTION?(d=b.getGeometries(),e=Zb):g==Ja.default.MULTI_POINT?(d=b.getPoints(),e=$b):g==Ja.default.MULTI_LINE_STRING?(d=b.getLineStrings(),e=_b):g==Ja.default.MULTI_POLYGON?(d=b.getPolygons(),e=bc):(0,Ca.assert)(!1,39),(0,Za.pushSerializeAndPop)(f,cc,e,d,c)}function ja(a,b,c){var d={node:a};(0,Za.pushSerializeAndPop)(d,dc,ac,[b],c)}function ka(a,b,c){var d={node:a};b.getId()&&a.setAttribute("id",b.getId());var e=b.getProperties(),f={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};f[b.getGeometryName()]=1;var g=Object.keys(e||{}).sort().filter(function(a){return!f[a]});if(g.length>0){var h=(0,Za.makeSequence)(e,g),i={names:g,values:h};(0,Za.pushSerializeAndPop)(d,ec,gc,[i],c)}var j=b.getStyleFunction();if(j){var k=j(b,0);if(k){var l=Array.isArray(k)?k[0]:k;this.writeStyles_&&(e.Style=l);var m=l.getText();m&&(e.name=m.getText())}}var n=c[c.length-1].node,o=fc[n.namespaceURI],p=(0,Za.makeSequence)(e,o);(0,Za.pushSerializeAndPop)(d,ec,Za.OBJECT_PROPERTY_NODE_FACTORY,p,c,o);var q=c[0],r=b.getGeometry();r&&(r=(0,Ea.transformWithOptions)(r,!0,q)),(0,Za.pushSerializeAndPop)(d,ec,Zb,[r],c)}function la(a,b,c){var d=b.getFlatCoordinates(),e={node:a};e.layout=b.getLayout(),e.stride=b.getStride();var f=b.getProperties();f.coordinates=d;var g=c[c.length-1].node,h=hc[g.namespaceURI],i=(0,Za.makeSequence)(f,h);(0,Za.pushSerializeAndPop)(e,ic,Za.OBJECT_PROPERTY_NODE_FACTORY,i,c,h)}function ma(a,b,c){var d=b.getLinearRings(),e=d.shift(),f={node:a};(0,Za.pushSerializeAndPop)(f,jc,kc,d,c),(0,Za.pushSerializeAndPop)(f,jc,lc,[e],c)}function na(a,b,c){var d={node:a};(0,Za.pushSerializeAndPop)(d,mc,nc,[b.getColor()],c)}function oa(a,b){(0,Ga.writeDecimalTextNode)(a,Math.round(1e6*b)/1e6)}function pa(a,b,c){var d={node:a},e={},f=b.getFill(),g=b.getStroke(),h=b.getImage(),i=b.getText();h instanceof Ta.default&&(e.IconStyle=h),i&&(e.LabelStyle=i),g&&(e.LineStyle=g),f&&(e.PolyStyle=f);var j=c[c.length-1].node,k=oc[j.namespaceURI],l=(0,Za.makeSequence)(e,k);(0,Za.pushSerializeAndPop)(d,pc,Za.OBJECT_PROPERTY_NODE_FACTORY,l,c,k)}function qa(a,b){a.setAttribute("x",b.x),a.setAttribute("y",b.y),a.setAttribute("xunits",b.xunits),a.setAttribute("yunits",b.yunits)}Object.defineProperty(c,"__esModule",{value:!0}),c.getDefaultFillStyle=f,c.getDefaultImageStyle=g,c.getDefaultStrokeStyle=h,c.getDefaultTextStyle=i,c.getDefaultStyle=j,c.getDefaultStyleArray=k,c.readFlatCoordinates=q,c.default=void 0;var ra,sa,ta,ua,va,wa,xa,ya,za,Aa=d(a("../Feature.js")),Ba=a("../array.js"),Ca=a("../asserts.js"),Da=a("../color.js"),Ea=a("../format/Feature.js"),Fa=d(a("../format/XMLFeature.js")),Ga=a("../format/xsd.js"),Ha=d(a("../geom/GeometryCollection.js")),Ia=d(a("../geom/GeometryLayout.js")),Ja=d(a("../geom/GeometryType.js")),Ka=d(a("../geom/LineString.js")),La=d(a("../geom/MultiLineString.js")),Ma=d(a("../geom/MultiPoint.js")),Na=d(a("../geom/MultiPolygon.js")),Oa=d(a("../geom/Point.js")),Pa=d(a("../geom/Polygon.js")),Qa=a("../math.js"),Ra=a("../proj.js"),Sa=d(a("../style/Fill.js")),Ta=d(a("../style/Icon.js")),Ua=d(a("../style/IconAnchorUnits.js")),Va=d(a("../style/IconOrigin.js")),Wa=d(a("../style/Stroke.js")),Xa=d(a("../style/Style.js")),Ya=d(a("../style/Text.js")),Za=a("../xml.js"),$a=["http://www.google.com/kml/ext/2.2"],_a=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],ab="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",bb={fraction:Ua.default.FRACTION,pixels:Ua.default.PIXELS,insetPixels:Ua.default.PIXELS},cb=(0,Za.makeStructureNS)(_a,{ExtendedData:N,Region:O,MultiGeometry:(0,Za.makeObjectPropertySetter)(H,"geometry"),LineString:(0,Za.makeObjectPropertySetter)(F,"geometry"),LinearRing:(0,Za.makeObjectPropertySetter)(G,"geometry"),Point:(0,Za.makeObjectPropertySetter)(I,"geometry"),Polygon:(0,Za.makeObjectPropertySetter)(J,"geometry"),Style:(0,Za.makeObjectPropertySetter)(K),StyleMap:Q,address:(0,Za.makeObjectPropertySetter)(Ga.readString),description:(0,Za.makeObjectPropertySetter)(Ga.readString),name:(0,Za.makeObjectPropertySetter)(Ga.readString),open:(0,Za.makeObjectPropertySetter)(Ga.readBoolean),phoneNumber:(0,Za.makeObjectPropertySetter)(Ga.readString),styleUrl:(0,Za.makeObjectPropertySetter)(r),visibility:(0,Za.makeObjectPropertySetter)(Ga.readBoolean)},(0,Za.makeStructureNS)($a,{MultiTrack:(0,Za.makeObjectPropertySetter)(B,"geometry"),Track:(0,Za.makeObjectPropertySetter)(C,"geometry")})),db=(0,Za.makeStructureNS)(_a,{ExtendedData:N,Region:O,Link:X,address:(0,Za.makeObjectPropertySetter)(Ga.readString),description:(0,Za.makeObjectPropertySetter)(Ga.readString),name:(0,Za.makeObjectPropertySetter)(Ga.readString),open:(0,Za.makeObjectPropertySetter)(Ga.readBoolean),phoneNumber:(0,Za.makeObjectPropertySetter)(Ga.readString),visibility:(0,Za.makeObjectPropertySetter)(Ga.readBoolean)}),eb=(0,Za.makeStructureNS)(_a,{href:(0,Za.makeObjectPropertySetter)(r)}),fb=(0,Za.makeStructureNS)(_a,{LatLonAltBox:T,Lod:U}),gb=(0,Za.makeStructureNS)(_a,["Document","Placemark"]),hb=(0,Za.makeStructureNS)(_a,{Document:(0,Za.makeChildAppender)(ca),Placemark:(0,Za.makeChildAppender)(ka)}),ib=null,jb=null,kb=null,lb=null,mb=null,nb=null,ob=function(a){function b(b){a.call(this);var c=b||{};nb||l(),this.dataProjection=(0,Ra.get)("EPSG:4326"),this.defaultStyle_=c.defaultStyle?c.defaultStyle:nb,this.extractStyles_=void 0===c.extractStyles||c.extractStyles,this.writeStyles_=void 0===c.writeStyles||c.writeStyles,this.sharedStyles_={},this.showPointNames_=void 0===c.showPointNames||c.showPointNames}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readDocumentOrFolder_=function(a,b){var c=(0,Za.makeStructureNS)(_a,{Document:(0,Za.makeArrayExtender)(this.readDocumentOrFolder_,this),Folder:(0,Za.makeArrayExtender)(this.readDocumentOrFolder_,this),Placemark:(0,Za.makeArrayPusher)(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),d=(0,Za.pushParseAndPop)([],c,a,b,this);return d||void 0},b.prototype.readPlacemark_=function(a,b){var c=(0,Za.pushParseAndPop)({geometry:null},cb,a,b);if(c){var d=new Aa.default,e=a.getAttribute("id");null!==e&&d.setId(e);var f=b[0],g=c.geometry;if(g&&(0,Ea.transformWithOptions)(g,!1,f),d.setGeometry(g),delete c.geometry,this.extractStyles_){var h=c.Style,i=c.styleUrl,j=n(h,i,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);d.setStyle(j)}return delete c.Style,d.setProperties(c),d}},b.prototype.readSharedStyle_=function(a,b){var c=a.getAttribute("id");if(null!==c){var d=K(a,b);if(d){var e,f=a.baseURI;if(f&&"about:blank"!=f||(f=window.location.href),f){e=new URL("#"+c,f).href}else e="#"+c;this.sharedStyles_[e]=d}}},b.prototype.readSharedStyleMap_=function(a,b){var c=a.getAttribute("id");if(null!==c){var d=u(a,b);if(d){var e,f=a.baseURI;if(f&&"about:blank"!=f||(f=window.location.href),f){e=new URL("#"+c,f).href}else e="#"+c;this.sharedStyles_[e]=d}}},b.prototype.readFeatureFromNode=function(a,b){if(!(0,Ba.includes)(_a,a.namespaceURI))return null;var c=this.readPlacemark_(a,[this.getReadOptions(a,b)]);return c||null},b.prototype.readFeaturesFromNode=function(a,b){var c=this;if(!(0,Ba.includes)(_a,a.namespaceURI))return[];var d,e=a.localName;if("Document"==e||"Folder"==e)return(d=this.readDocumentOrFolder_(a,[this.getReadOptions(a,b)]))||[];if("Placemark"==e){var f=this.readPlacemark_(a,[this.getReadOptions(a,b)]);return f?[f]:[]}if("kml"==e){d=[];for(var g=a.firstElementChild;g;g=g.nextElementSibling){var h=c.readFeaturesFromNode(g,b);h&&(0,Ba.extend)(d,h)}return d}return[]},b.prototype.readName=function(a){if((0,Za.isDocument)(a))return this.readNameFromDocument(a);if((0,Za.isNode)(a))return this.readNameFromNode(a);if("string"==typeof a){var b=(0,Za.parse)(a);return this.readNameFromDocument(b)}},b.prototype.readNameFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE){var d=b.readNameFromNode(c);if(d)return d}},b.prototype.readNameFromNode=function(a){for(var b=this,c=a.firstElementChild;c;c=c.nextElementSibling)if((0,Ba.includes)(_a,c.namespaceURI)&&"name"==c.localName)return(0,Ga.readString)(c);for(var d=a.firstElementChild;d;d=d.nextElementSibling){var e=d.localName;if((0,Ba.includes)(_a,d.namespaceURI)&&("Document"==e||"Folder"==e||"Placemark"==e||"kml"==e)){var f=b.readNameFromNode(d);if(f)return f}}},b.prototype.readNetworkLinks=function(a){var b=[];if((0,Za.isDocument)(a))(0,Ba.extend)(b,this.readNetworkLinksFromDocument(a));else if((0,Za.isNode)(a))(0,Ba.extend)(b,this.readNetworkLinksFromNode(a));else if("string"==typeof a){var c=(0,Za.parse)(a);(0,Ba.extend)(b,this.readNetworkLinksFromDocument(c))}return b},b.prototype.readNetworkLinksFromDocument=function(a){for(var b=this,c=[],d=a.firstChild;d;d=d.nextSibling)d.nodeType==Node.ELEMENT_NODE&&(0,Ba.extend)(c,b.readNetworkLinksFromNode(d));return c},b.prototype.readNetworkLinksFromNode=function(a){for(var b=this,c=[],d=a.firstElementChild;d;d=d.nextElementSibling)if((0,Ba.includes)(_a,d.namespaceURI)&&"NetworkLink"==d.localName){var e=(0,Za.pushParseAndPop)({},db,d,[]);c.push(e)}for(var f=a.firstElementChild;f;f=f.nextElementSibling){var g=f.localName;!(0,Ba.includes)(_a,f.namespaceURI)||"Document"!=g&&"Folder"!=g&&"kml"!=g||(0,Ba.extend)(c,b.readNetworkLinksFromNode(f))}return c},b.prototype.readRegion=function(a){var b=[];if((0,Za.isDocument)(a))(0,Ba.extend)(b,this.readRegionFromDocument(a));else if((0,Za.isNode)(a))(0,Ba.extend)(b,this.readRegionFromNode(a));else if("string"==typeof a){var c=(0,Za.parse)(a);(0,Ba.extend)(b,this.readRegionFromDocument(c))}return b},b.prototype.readRegionFromDocument=function(a){for(var b=this,c=[],d=a.firstChild;d;d=d.nextSibling)d.nodeType==Node.ELEMENT_NODE&&(0,Ba.extend)(c,b.readRegionFromNode(d));return c},b.prototype.readRegionFromNode=function(a){for(var b=this,c=[],d=a.firstElementChild;d;d=d.nextElementSibling)if((0,Ba.includes)(_a,d.namespaceURI)&&"Region"==d.localName){var e=(0,Za.pushParseAndPop)({},fb,d,[]);c.push(e)}for(var f=a.firstElementChild;f;f=f.nextElementSibling){var g=f.localName;!(0,Ba.includes)(_a,f.namespaceURI)||"Document"!=g&&"Folder"!=g&&"kml"!=g||(0,Ba.extend)(c,b.readRegionFromNode(f))}return c},b.prototype.writeFeaturesNode=function(a,b){b=this.adaptOptions(b);var c=(0,Za.createElementNS)(_a[4],"kml"),d="http://www.w3.org/2000/xmlns/";c.setAttributeNS(d,"xmlns:gx",$a[0]),c.setAttributeNS(d,"xmlns:xsi",Za.XML_SCHEMA_INSTANCE_URI),c.setAttributeNS(Za.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",ab);var e={node:c},f={};a.length>1?f.Document=a:1==a.length&&(f.Placemark=a[0]);var g=gb[c.namespaceURI],h=(0,Za.makeSequence)(f,g);return(0,Za.pushSerializeAndPop)(e,hb,Za.OBJECT_PROPERTY_NODE_FACTORY,h,[b],g,this),c},b}(Fa.default),pb=(0,Za.makeStructureNS)(_a,{Pair:P}),qb=(0,Za.makeStructureNS)(_a,{Icon:(0,Za.makeObjectPropertySetter)(D),heading:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),hotSpot:(0,Za.makeObjectPropertySetter)(s),scale:(0,Za.makeObjectPropertySetter)(t)}),rb=(0,Za.makeStructureNS)(_a,{color:(0,Za.makeObjectPropertySetter)(p),scale:(0,Za.makeObjectPropertySetter)(t)}),sb=(0,Za.makeStructureNS)(_a,{color:(0,Za.makeObjectPropertySetter)(p),width:(0,Za.makeObjectPropertySetter)(Ga.readDecimal)}),tb=(0,Za.makeStructureNS)(_a,{color:(0,Za.makeObjectPropertySetter)(p),fill:(0,Za.makeObjectPropertySetter)(Ga.readBoolean),outline:(0,Za.makeObjectPropertySetter)(Ga.readBoolean)}),ub=(0,Za.makeStructureNS)(_a,{coordinates:(0,Za.makeReplacer)(q)}),vb=(0,Za.makeStructureNS)($a,{Track:(0,Za.makeArrayPusher)(C)}),wb=(0,Za.makeStructureNS)(_a,{when:Y},(0,Za.makeStructureNS)($a,{coord:A})),xb=(0,Za.makeStructureNS)(_a,{href:(0,Za.makeObjectPropertySetter)(r)},(0,Za.makeStructureNS)($a,{x:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),y:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),w:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),h:(0,Za.makeObjectPropertySetter)(Ga.readDecimal)})),yb=(0,Za.makeStructureNS)(_a,{coordinates:(0,Za.makeReplacer)(q)}),zb=(0,Za.makeStructureNS)(_a,{extrude:(0,Za.makeObjectPropertySetter)(Ga.readBoolean),tessellate:(0,Za.makeObjectPropertySetter)(Ga.readBoolean),altitudeMode:(0,Za.makeObjectPropertySetter)(Ga.readString)}),Ab=(0,Za.makeStructureNS)(_a,{LineString:(0,Za.makeArrayPusher)(F),LinearRing:(0,Za.makeArrayPusher)(G),MultiGeometry:(0,Za.makeArrayPusher)(H),Point:(0,Za.makeArrayPusher)(I),Polygon:(0,Za.makeArrayPusher)(J)}),Bb=(0,Za.makeStructureNS)(_a,{innerBoundaryIs:V,outerBoundaryIs:W}),Cb=(0,Za.makeStructureNS)(_a,{IconStyle:v,LabelStyle:w,LineStyle:x,PolyStyle:y}),Db=(0,Za.makeStructureNS)(_a,{displayName:(0,Za.makeObjectPropertySetter)(Ga.readString),value:(0,Za.makeObjectPropertySetter)(Ga.readString)}),Eb=(0,Za.makeStructureNS)(_a,{Data:M,SchemaData:R}),Fb=(0,Za.makeStructureNS)(_a,{Style:(0,Za.makeObjectPropertySetter)(K),key:(0,Za.makeObjectPropertySetter)(Ga.readString),styleUrl:(0,Za.makeObjectPropertySetter)(r)}),Gb=(0,Za.makeStructureNS)(_a,{SimpleData:S}),Hb=(0,Za.makeStructureNS)(_a,{altitudeMode:(0,Za.makeObjectPropertySetter)(Ga.readString),minAltitude:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),maxAltitude:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),north:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),south:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),east:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),west:(0,Za.makeObjectPropertySetter)(Ga.readDecimal)}),Ib=(0,Za.makeStructureNS)(_a,{minLodPixels:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),maxLodPixels:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),minFadeExtent:(0,Za.makeObjectPropertySetter)(Ga.readDecimal),maxFadeExtent:(0,Za.makeObjectPropertySetter)(Ga.readDecimal)}),Jb=(0,Za.makeStructureNS)(_a,{LinearRing:(0,Za.makeReplacer)(z)}),Kb=(0,Za.makeStructureNS)(_a,{LinearRing:(0,Za.makeReplacer)(z)}),Lb=(0,Za.makeStructureNS)(_a,{Data:(0,Za.makeChildAppender)(_),value:(0,Za.makeChildAppender)(ba),displayName:(0,Za.makeChildAppender)(aa)}),Mb=(0,Za.makeStructureNS)(_a,{Placemark:(0,Za.makeChildAppender)(ka)}),Nb=function(a,b,c){var d=b[b.length-1].node;return(0,Za.createElementNS)(d.namespaceURI,"Placemark")},Ob=(0,Za.makeSimpleNodeFactory)("Data"),Pb=(0,Za.makeStructureNS)(_a,["href"],(0,Za.makeStructureNS)($a,["x","y","w","h"])),Qb=(0,Za.makeStructureNS)(_a,{href:(0,Za.makeChildAppender)(Ga.writeStringTextNode)},(0,Za.makeStructureNS)($a,{x:(0,Za.makeChildAppender)(Ga.writeDecimalTextNode),y:(0,Za.makeChildAppender)(Ga.writeDecimalTextNode),w:(0,Za.makeChildAppender)(Ga.writeDecimalTextNode),h:(0,Za.makeChildAppender)(Ga.writeDecimalTextNode)})),Rb=function(a,b,c){return(0,Za.createElementNS)($a[0],"gx:"+c)},Sb=(0,Za.makeStructureNS)(_a,["scale","heading","Icon","hotSpot"]),Tb=(0,Za.makeStructureNS)(_a,{Icon:(0,Za.makeChildAppender)(ea),heading:(0,Za.makeChildAppender)(Ga.writeDecimalTextNode),hotSpot:(0,Za.makeChildAppender)(qa),scale:(0,Za.makeChildAppender)(oa)}),Ub=(0,Za.makeStructureNS)(_a,["color","scale"]),Vb=(0,Za.makeStructureNS)(_a,{color:(0,Za.makeChildAppender)(Z),scale:(0,Za.makeChildAppender)(oa)}),Wb=(0,Za.makeStructureNS)(_a,["color","width"]),Xb=(0,Za.makeStructureNS)(_a,{color:(0,Za.makeChildAppender)(Z),width:(0,Za.makeChildAppender)(Ga.writeDecimalTextNode)}),Yb={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},Zb=function(a,b,c){if(a){var d=b[b.length-1].node;return(0,Za.createElementNS)(d.namespaceURI,Yb[a.getType()])}},$b=(0,Za.makeSimpleNodeFactory)("Point"),_b=(0,Za.makeSimpleNodeFactory)("LineString"),ac=(0,Za.makeSimpleNodeFactory)("LinearRing"),bc=(0,Za.makeSimpleNodeFactory)("Polygon"),cc=(0,Za.makeStructureNS)(_a,{LineString:(0,Za.makeChildAppender)(la),Point:(0,Za.makeChildAppender)(la),Polygon:(0,Za.makeChildAppender)(ma),GeometryCollection:(0,Za.makeChildAppender)(ia)}),dc=(0,Za.makeStructureNS)(_a,{LinearRing:(0,Za.makeChildAppender)(la)}),ec=(0,Za.makeStructureNS)(_a,{ExtendedData:(0,Za.makeChildAppender)(da),MultiGeometry:(0,Za.makeChildAppender)(ia),LineString:(0,Za.makeChildAppender)(la),LinearRing:(0,Za.makeChildAppender)(la),Point:(0,Za.makeChildAppender)(la),Polygon:(0,Za.makeChildAppender)(ma),Style:(0,Za.makeChildAppender)(pa),address:(0,Za.makeChildAppender)(Ga.writeStringTextNode),description:(0,Za.makeChildAppender)(Ga.writeStringTextNode),name:(0,Za.makeChildAppender)(Ga.writeStringTextNode),open:(0,Za.makeChildAppender)(Ga.writeBooleanTextNode),phoneNumber:(0,Za.makeChildAppender)(Ga.writeStringTextNode),styleUrl:(0,Za.makeChildAppender)(Ga.writeStringTextNode),visibility:(0,Za.makeChildAppender)(Ga.writeBooleanTextNode)}),fc=(0,Za.makeStructureNS)(_a,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),gc=(0,Za.makeSimpleNodeFactory)("ExtendedData"),hc=(0,Za.makeStructureNS)(_a,["extrude","tessellate","altitudeMode","coordinates"]),ic=(0,Za.makeStructureNS)(_a,{extrude:(0,Za.makeChildAppender)(Ga.writeBooleanTextNode),tessellate:(0,Za.makeChildAppender)(Ga.writeBooleanTextNode),altitudeMode:(0,Za.makeChildAppender)(Ga.writeStringTextNode),coordinates:(0,Za.makeChildAppender)($)}),jc=(0,Za.makeStructureNS)(_a,{outerBoundaryIs:(0,Za.makeChildAppender)(ja),innerBoundaryIs:(0,Za.makeChildAppender)(ja)}),kc=(0,Za.makeSimpleNodeFactory)("innerBoundaryIs"),lc=(0,Za.makeSimpleNodeFactory)("outerBoundaryIs"),mc=(0,Za.makeStructureNS)(_a,{color:(0,Za.makeChildAppender)(Z)}),nc=(0,Za.makeSimpleNodeFactory)("color"),oc=(0,Za.makeStructureNS)(_a,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),pc=(0,Za.makeStructureNS)(_a,{IconStyle:(0,Za.makeChildAppender)(fa),LabelStyle:(0,Za.makeChildAppender)(ga),LineStyle:(0,Za.makeChildAppender)(ha),PolyStyle:(0,Za.makeChildAppender)(na)}),qc=ob;c.default=qc},{"../Feature.js":10,"../array.js":46,"../asserts.js":47,"../color.js":49,"../format/Feature.js":78,"../format/XMLFeature.js":101,"../format/xsd.js":125,"../geom/GeometryCollection.js":130,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../math.js":199,"../proj.js":210,"../style/Fill.js":322,"../style/Icon.js":323,"../style/IconAnchorUnits.js":324,"../style/IconOrigin.js":327,"../style/Stroke.js":330,"../style/Style.js":331,"../style/Text.js":332,"../xml.js":351}],89:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b,c){if(3===a){var d={keys:[],values:[],features:[]},e=c.readVarint()+c.pos;c.readFields(g,d,e),d.length=d.features.length,d.length&&(b[d.name]=d)}}function g(a,b,c){if(15===a)b.version=c.readVarint();else if(1===a)b.name=c.readString();else if(5===a)b.extent=c.readVarint();else if(2===a)b.features.push(c.pos);else if(3===a)b.keys.push(c.readString());else if(4===a){for(var d=null,e=c.readVarint()+c.pos;c.pos<e;)a=c.readVarint()>>3,d=1===a?c.readString():2===a?c.readFloat():3===a?c.readDouble():4===a?c.readVarint64():5===a?c.readVarint():6===a?c.readSVarint():7===a?c.readBoolean():null;b.values.push(d)}}function h(a,b,c){if(1==a)b.id=c.readVarint();else if(2==a)for(var d=c.readVarint()+c.pos;c.pos<d;){var e=b.layer.keys[c.readVarint()],f=b.layer.values[c.readVarint()];b.properties[e]=f}else 3==a?b.type=c.readVarint():4==a&&(b.geometry=c.pos)}function i(a,b,c){a.pos=b.features[c];var d=a.readVarint()+a.pos,e={layer:b,type:0,properties:{}};return a.readFields(h,e,d),e}function j(a,b){var c;return 1===a?c=1===b?p.default.POINT:p.default.MULTI_POINT:2===a?c=1===b?p.default.LINE_STRING:p.default.MULTI_LINE_STRING:3===a&&(c=p.default.POLYGON),c}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var k=a("../asserts.js"),l=e(a("pbf")),m=d(a("../format/Feature.js")),n=e(a("../format/FormatType.js")),o=e(a("../geom/GeometryLayout.js")),p=e(a("../geom/GeometryType.js")),q=e(a("../geom/LineString.js")),r=e(a("../geom/MultiLineString.js")),s=e(a("../geom/MultiPoint.js")),t=e(a("../geom/MultiPolygon.js")),u=e(a("../geom/Point.js")),v=e(a("../geom/Polygon.js")),w=a("../geom/flat/orient.js"),x=e(a("../proj/Projection.js")),y=e(a("../proj/Units.js")),z=e(a("../render/Feature.js")),A=function(a){function b(b){a.call(this);var c=b||{};this.dataProjection=new x.default({code:"",units:y.default.TILE_PIXELS}),this.featureClass_=c.featureClass?c.featureClass:z.default,this.geometryName_=c.geometryName,this.layerName_=c.layerName?c.layerName:"layer",this.layers_=c.layers?c.layers:null,this.extent_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readRawGeometry_=function(a,b,c,d){a.pos=b.geometry;for(var e=a.readVarint()+a.pos,f=1,g=0,h=0,i=0,j=0,l=0;a.pos<e;){if(!g){var m=a.readVarint();f=7&m,g=m>>3}g--,1===f||2===f?(h+=a.readSVarint(),i+=a.readSVarint(),1===f&&j>l&&(d.push(j),l=j),c.push(h,i),j+=2):7===f?j>l&&(c.push(c[l],c[l+1]),j+=2):(0,k.assert)(!1,59)}j>l&&(d.push(j),l=j)},b.prototype.createFeature_=function(a,b,c){var d=b.type;if(0===d)return null;var e,f=b.id,g=b.properties;g[this.layerName_]=b.layer.name;var h=[],i=[];this.readRawGeometry_(a,b,h,i);var k=j(d,i.length);if(this.featureClass_===z.default)e=new this.featureClass_(k,h,i,g,f);else{var l;if(k==p.default.POLYGON){for(var n=[],x=0,y=0,A=0,B=i.length;A<B;++A){var C=i[A];(0,w.linearRingIsClockwise)(h,x,C,2)||(n.push(i.slice(y,A)),y=A),x=C}l=n.length>1?new t.default(h,o.default.XY,n):new v.default(h,o.default.XY,i)}else l=k===p.default.POINT?new u.default(h,o.default.XY):k===p.default.LINE_STRING?new q.default(h,o.default.XY):k===p.default.POLYGON?new v.default(h,o.default.XY,i):k===p.default.MULTI_POINT?new s.default(h,o.default.XY):k===p.default.MULTI_LINE_STRING?new r.default(h,o.default.XY,i):null;e=new this.featureClass_,this.geometryName_&&e.setGeometryName(this.geometryName_);var D=(0,m.transformWithOptions)(l,!1,this.adaptOptions(c));e.setGeometry(D),e.setId(f),e.setProperties(g)}return e},b.prototype.getLastExtent=function(){return this.extent_},b.prototype.getType=function(){return n.default.ARRAY_BUFFER},b.prototype.readFeatures=function(a,b){var c=this,d=this.layers_,e=new l.default(a),g=e.readFields(f,{}),h=[];for(var j in g)if(!d||-1!=d.indexOf(j)){for(var k=g[j],m=0,n=k.length;m<n;++m){var o=i(e,k,m);h.push(c.createFeature_(e,o))}c.extent_=k?[0,0,k.extent,k.extent]:null}return h},b.prototype.readProjection=function(a){return this.dataProjection},b.prototype.setLayers=function(a){this.layers_=a},b}(m.default),B=A;c.default=B},{"../asserts.js":47,"../format/Feature.js":78,"../format/FormatType.js":79,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../geom/flat/orient.js":153,"../proj/Projection.js":211,"../proj/Units.js":212,"../render/Feature.js":221,pbf:352}],90:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return(0,v.pushParseAndPop)({},z,a,b)}function f(a,b){return(0,v.pushParseAndPop)({},A,a,b)}function g(a,b){var c=a.getAttribute("name");if(c)return(0,v.pushParseAndPop)({name:c},B,a,b)}function h(a,b){return(0,v.pushParseAndPop)({},C,a,b)}function i(a,b){return(0,v.pushParseAndPop)({},D,a,b)}function j(a,b){var c=(0,s.readHref)(a);if(c)return(0,v.pushParseAndPop)({href:c},I,a,b)}function k(a,b){return(0,v.pushParseAndPop)({},E,a,b)}function l(a,b){var c=a.getAttribute("name"),d=(0,v.pushParseAndPop)({},F,a,b);if(d){b[b.length-1][c]=d}}function m(a,b){return(0,v.pushParseAndPop)({},G,a,b)}function n(a,b){return(0,v.pushParseAndPop)({},H,a,b)}function o(a,b){return(0,v.pushParseAndPop)({},K,a,b)}function p(a,b){return(0,v.pushParseAndPop)({},J,a,b)}function q(a,b){return(0,v.pushParseAndPop)({},L,a,b)}function r(a,b){return(0,u.readString)(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var s=a("../format/XLink.js"),t=d(a("../format/XML.js")),u=a("../format/xsd.js"),v=a("../xml.js"),w=[null,"http://www.opengis.net/ows/1.1"],x=(0,v.makeStructureNS)(w,{ServiceIdentification:(0,v.makeObjectPropertySetter)(o),ServiceProvider:(0,v.makeObjectPropertySetter)(q),OperationsMetadata:(0,v.makeObjectPropertySetter)(m)}),y=function(a){function b(){a.call(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE)return b.readFromNode(c);return null},b.prototype.readFromNode=function(a){var b=(0,v.pushParseAndPop)({},x,a,[]);return b||null},b}(t.default),z=(0,v.makeStructureNS)(w,{DeliveryPoint:(0,v.makeObjectPropertySetter)(u.readString),City:(0,v.makeObjectPropertySetter)(u.readString),AdministrativeArea:(0,v.makeObjectPropertySetter)(u.readString),PostalCode:(0,v.makeObjectPropertySetter)(u.readString),Country:(0,v.makeObjectPropertySetter)(u.readString),ElectronicMailAddress:(0,v.makeObjectPropertySetter)(u.readString)}),A=(0,v.makeStructureNS)(w,{Value:(0,v.makeObjectPropertyPusher)(r)}),B=(0,v.makeStructureNS)(w,{AllowedValues:(0,v.makeObjectPropertySetter)(f)}),C=(0,v.makeStructureNS)(w,{Phone:(0,v.makeObjectPropertySetter)(n),Address:(0,v.makeObjectPropertySetter)(e)}),D=(0,v.makeStructureNS)(w,{HTTP:(0,v.makeObjectPropertySetter)(k)}),E=(0,v.makeStructureNS)(w,{Get:(0,v.makeObjectPropertyPusher)(j),Post:void 0}),F=(0,v.makeStructureNS)(w,{DCP:(0,v.makeObjectPropertySetter)(i)}),G=(0,v.makeStructureNS)(w,{Operation:l}),H=(0,v.makeStructureNS)(w,{Voice:(0,v.makeObjectPropertySetter)(u.readString),Facsimile:(0,v.makeObjectPropertySetter)(u.readString)}),I=(0,v.makeStructureNS)(w,{Constraint:(0,v.makeObjectPropertyPusher)(g)}),J=(0,v.makeStructureNS)(w,{IndividualName:(0,v.makeObjectPropertySetter)(u.readString),PositionName:(0,v.makeObjectPropertySetter)(u.readString),ContactInfo:(0,v.makeObjectPropertySetter)(h)}),K=(0,v.makeStructureNS)(w,{Abstract:(0,v.makeObjectPropertySetter)(u.readString),AccessConstraints:(0,v.makeObjectPropertySetter)(u.readString),Fees:(0,v.makeObjectPropertySetter)(u.readString),Title:(0,v.makeObjectPropertySetter)(u.readString),ServiceTypeVersion:(0,v.makeObjectPropertySetter)(u.readString),ServiceType:(0,v.makeObjectPropertySetter)(u.readString)}),L=(0,v.makeStructureNS)(w,{ProviderName:(0,v.makeObjectPropertySetter)(u.readString),ProviderSite:(0,v.makeObjectPropertySetter)(s.readHref),ServiceContact:(0,v.makeObjectPropertySetter)(p)}),M=y;c.default=M},{"../format/XLink.js":99,"../format/XML.js":100,"../format/xsd.js":125,"../xml.js":351}],91:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d,e=c||1e5,f=new Array(b);for(d=0;d<b;++d)f[d]=0;for(var h=0,i=a.length;h<i;)for(d=0;d<b;++d,++h){var j=a[h],k=j-f[d];f[d]=j,a[h]=k}return g(a,e)}function f(a,b,c){var d,e=c||1e5,f=new Array(b);for(d=0;d<b;++d)f[d]=0;for(var g=h(a,e),i=0,j=g.length;i<j;)for(d=0;d<b;++d,++i)f[d]+=g[i],g[i]=f[d];return g}function g(a,b){for(var c=b||1e5,d=0,e=a.length;d<e;++d)a[d]=Math.round(a[d]*c);return i(a)}function h(a,b){for(var c=b||1e5,d=j(a),e=0,f=d.length;e<f;++e)d[e]/=c;return d}function i(a){for(var b=0,c=a.length;b<c;++b){var d=a[b];a[b]=d<0?~(d<<1):d<<1}return k(a)}function j(a){for(var b=l(a),c=0,d=b.length;c<d;++c){var e=b[c];b[c]=1&e?~(e>>1):e>>1}return b}function k(a){for(var b="",c=0,d=a.length;c<d;++c)b+=m(a[c]);return b}function l(a){for(var b=[],c=0,d=0,e=0,f=a.length;e<f;++e){var g=a.charCodeAt(e)-63;c|=(31&g)<<d,g<32?(b.push(c),c=0,d=0):d+=5}return b}function m(a){for(var b,c="";a>=32;)b=63+(32|31&a),c+=String.fromCharCode(b),a>>=5;return b=a+63,c+=String.fromCharCode(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.encodeDeltas=e,c.decodeDeltas=f,c.encodeFloats=g,c.decodeFloats=h,c.encodeSignedIntegers=i,c.decodeSignedIntegers=j,c.encodeUnsignedIntegers=k,c.decodeUnsignedIntegers=l,c.encodeUnsignedInteger=m,c.default=void 0;var n=a("../asserts.js"),o=d(a("../Feature.js")),p=a("../format/Feature.js"),q=d(a("../format/TextFeature.js")),r=d(a("../geom/GeometryLayout.js")),s=d(a("../geom/LineString.js")),t=a("../geom/SimpleGeometry.js"),u=a("../geom/flat/flip.js"),v=a("../geom/flat/inflate.js"),w=a("../proj.js"),x=function(a){function b(b){a.call(this);var c=b||{};this.dataProjection=(0,w.get)("EPSG:4326"),this.factor_=c.factor?c.factor:1e5,this.geometryLayout_=c.geometryLayout?c.geometryLayout:r.default.XY}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFeatureFromText=function(a,b){var c=this.readGeometryFromText(a,b);return new o.default(c)},b.prototype.readFeaturesFromText=function(a,b){return[this.readFeatureFromText(a,b)]},b.prototype.readGeometryFromText=function(a,b){var c=(0,t.getStrideForLayout)(this.geometryLayout_),d=f(a,c,this.factor_);(0,u.flipXY)(d,0,d.length,c,d);var e=(0,v.inflateCoordinates)(d,0,d.length,c);return(0,p.transformWithOptions)(new s.default(e,this.geometryLayout_),!1,this.adaptOptions(b))},b.prototype.writeFeatureText=function(a,b){var c=a.getGeometry();return c?this.writeGeometryText(c,b):((0,n.assert)(!1,40),"")},b.prototype.writeFeaturesText=function(a,b){return this.writeFeatureText(a[0],b)},b.prototype.writeGeometryText=function(a,b){a=(0,p.transformWithOptions)(a,!0,this.adaptOptions(b));var c=a.getFlatCoordinates(),d=a.getStride();return(0,u.flipXY)(c,0,c.length,d,c),e(c,d,this.factor_)},b}(q.default),y=x;c.default=y},{"../Feature.js":10,"../asserts.js":47,"../format/Feature.js":78,"../format/TextFeature.js":92,"../geom/GeometryLayout.js":131,"../geom/LineString.js":133,"../geom/SimpleGeometry.js":140,"../geom/flat/flip.js":146,"../geom/flat/inflate.js":148,"../proj.js":210}],92:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return"string"==typeof a?a:""}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a("../format/Feature.js")),g=d(a("../format/FormatType.js")),h=function(a){function b(){a.call(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return g.default.TEXT},b.prototype.readFeature=function(a,b){return this.readFeatureFromText(e(a),this.adaptOptions(b))},b.prototype.readFeatureFromText=function(a,b){},b.prototype.readFeatures=function(a,b){
return this.readFeaturesFromText(e(a),this.adaptOptions(b))},b.prototype.readFeaturesFromText=function(a,b){},b.prototype.readGeometry=function(a,b){return this.readGeometryFromText(e(a),this.adaptOptions(b))},b.prototype.readGeometryFromText=function(a,b){},b.prototype.readProjection=function(a){return this.readProjectionFromText(e(a))},b.prototype.readProjectionFromText=function(a){return this.dataProjection},b.prototype.writeFeature=function(a,b){return this.writeFeatureText(a,this.adaptOptions(b))},b.prototype.writeFeatureText=function(a,b){},b.prototype.writeFeatures=function(a,b){return this.writeFeaturesText(a,this.adaptOptions(b))},b.prototype.writeFeaturesText=function(a,b){},b.prototype.writeGeometry=function(a,b){return this.writeGeometryText(a,this.adaptOptions(b))},b.prototype.writeGeometryText=function(a,b){},b}(f.default),i=h;c.default=i},{"../format/Feature.js":78,"../format/FormatType.js":79}],93:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;++f)c=a[f],f>0&&e.pop(),d=c>=0?b[c]:b[~c].slice().reverse(),e.push.apply(e,d);for(var h=0,i=e.length;h<i;++h)e[h]=e[h].slice();return e}function f(a,b,c){var d=a.coordinates;return b&&c&&p(d,b,c),new x.default(d)}function g(a,b,c){var d=a.coordinates;if(b&&c)for(var e=0,f=d.length;e<f;++e)p(d[e],b,c);return new v.default(d)}function h(a,b){var c=e(a.arcs,b);return new t.default(c)}function i(a,b){for(var c=[],d=0,f=a.arcs.length;d<f;++d)c[d]=e(a.arcs[d],b);return new u.default(c)}function j(a,b){for(var c=[],d=0,f=a.arcs.length;d<f;++d)c[d]=e(a.arcs[d],b);return new y.default(c)}function k(a,b){for(var c=[],d=0,f=a.arcs.length;d<f;++d){for(var g=a.arcs[d],h=[],i=0,j=g.length;i<j;++i)h[i]=e(g[i],b);c[d]=h}return new w.default(c)}function l(a,b,c,d,e,f,g){for(var h=a.geometries,i=[],j=0,k=h.length;j<k;++j)i[j]=m(h[j],b,c,d,e,f,g);return i}function m(a,b,c,d,e,f,g){var h,i=a.type,j=B[i];h="Point"===i||"MultiPoint"===i?j(a,c,d):j(a,b);var k=new q.default;k.setGeometry((0,r.transformWithOptions)(h,!1,g)),void 0!==a.id&&k.setId(a.id);var l=a.properties;return e&&(l||(l={}),l[e]=f),l&&k.setProperties(l),k}function n(a,b,c){for(var d=0,e=a.length;d<e;++d)o(a[d],b,c)}function o(a,b,c){for(var d=0,e=0,f=0,g=a.length;f<g;++f){var h=a[f];d+=h[0],e+=h[1],h[0]=d,h[1]=e,p(h,b,c)}}function p(a,b,c){a[0]=a[0]*b[0]+c[0],a[1]=a[1]*b[1]+c[1]}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var q=d(a("../Feature.js")),r=a("../format/Feature.js"),s=d(a("../format/JSONFeature.js")),t=d(a("../geom/LineString.js")),u=d(a("../geom/MultiLineString.js")),v=d(a("../geom/MultiPoint.js")),w=d(a("../geom/MultiPolygon.js")),x=d(a("../geom/Point.js")),y=d(a("../geom/Polygon.js")),z=a("../proj.js"),A=function(a){function b(b){a.call(this);var c=b||{};this.layerName_=c.layerName,this.layers_=c.layers?c.layers:null,this.dataProjection=(0,z.get)(c.dataProjection?c.dataProjection:"EPSG:4326")}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFeaturesFromObject=function(a,b){var c=this;if("Topology"==a.type){var d,e=a,f=null,g=null;e.transform&&(d=e.transform,f=d.scale,g=d.translate);var h=e.arcs;d&&n(h,f,g);var i,j=[],k=e.objects,o=this.layerName_;for(var p in k)c.layers_&&-1==c.layers_.indexOf(p)||("GeometryCollection"===k[p].type?(i=k[p],j.push.apply(j,l(i,h,f,g,o,p,b))):(i=k[p],j.push(m(i,h,f,g,o,p,b))));return j}return[]},b.prototype.readProjectionFromObject=function(a){return this.dataProjection},b}(s.default),B={Point:f,LineString:h,Polygon:j,MultiPoint:g,MultiLineString:i,MultiPolygon:k},C=A;c.default=C},{"../Feature.js":10,"../format/Feature.js":78,"../format/JSONFeature.js":87,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../proj.js":210}],94:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){return(0,S.pushParseAndPop)({},U,a,b)}function g(a,b){(0,S.parseNode)(ea,a,b)}function h(a,b){return(0,S.pushParseAndPop)([],fa,a,b)}function i(a,b,c){var d=c[c.length-1],e=d.featureType,f=d.featureNS,g=d.gmlVersion,h=(0,S.createElementNS)(f,e);a.appendChild(h),2===g?J.default.prototype.writeFeatureElement(h,b,c):K.default.prototype.writeFeatureElement(h,b,c)}function j(a,b,c){var d=(0,S.createElementNS)($,"Filter"),e=(0,S.createElementNS)($,"FeatureId");d.appendChild(e),e.setAttribute("fid",b),a.appendChild(d)}function k(a,b){a=a||Y;var c=a+":";return 0===b.indexOf(c)?b:c+b}function l(a,b,c){var d=c[c.length-1];(0,I.assert)(void 0!==b.getId(),26);var e=d.featureType,f=d.featurePrefix,g=d.featureNS,h=k(f,e);a.setAttribute("typeName",h),a.setAttributeNS(Z,"xmlns:"+f,g);var i=b.getId();void 0!==i&&j(a,i,c)}function m(a,b,c){var d=c[c.length-1];(0,I.assert)(void 0!==b.getId(),27);var e=d.featureType,f=d.featurePrefix,g=d.featureNS,h=k(f,e),i=b.getGeometryName();a.setAttribute("typeName",h),a.setAttributeNS(Z,"xmlns:"+f,g);var l=b.getId();if(void 0!==l){for(var m=b.getKeys(),n=[],o=0,p=m.length;o<p;o++){var q=b.get(m[o]);if(void 0!==q){var r=m[o];q instanceof P.default&&(r=i),n.push({name:r,value:q})}}(0,S.pushSerializeAndPop)({gmlVersion:d.gmlVersion,node:a,hasZ:d.hasZ,srsName:d.srsName},X,(0,S.makeSimpleNodeFactory)("Property"),n,c),j(a,l,c)}}function n(a,b,c){var d=(0,S.createElementNS)(_,"Name"),e=c[c.length-1],f=e.gmlVersion;if(a.appendChild(d),(0,O.writeStringTextNode)(d,b.name),void 0!==b.value&&null!==b.value){var g=(0,S.createElementNS)(_,"Value");a.appendChild(g),b.value instanceof P.default?2===f?J.default.prototype.writeGeometryElement(g,b.value,c):K.default.prototype.writeGeometryElement(g,b.value,c):(0,O.writeStringTextNode)(g,b.value)}}function o(a,b,c){b.vendorId&&a.setAttribute("vendorId",b.vendorId),void 0!==b.safeToIgnore&&a.setAttribute("safeToIgnore",b.safeToIgnore),void 0!==b.value&&(0,O.writeStringTextNode)(a,b.value)}function p(a,b,c){var d,e=c[c.length-1],f=e.featurePrefix,g=e.featureNS,h=e.propertyNames,i=e.srsName;d=f?k(f,b):b,a.setAttribute("typeName",d),i&&a.setAttribute("srsName",i),g&&a.setAttributeNS(Z,"xmlns:"+f,g);var j=(0,Q.assign)({},e);j.node=a,(0,S.pushSerializeAndPop)(j,W,(0,S.makeSimpleNodeFactory)("PropertyName"),h,c);var l=e.filter;if(l){var m=(0,S.createElementNS)($,"Filter");a.appendChild(m),q(m,l,c)}}function q(a,b,c){var d={node:a};(0,S.pushSerializeAndPop)(d,ga,(0,S.makeSimpleNodeFactory)(b.getTagName()),[b],c)}function r(a,b,c){c[c.length-1].srsName=b.srsName,D(a,b.geometryName),K.default.prototype.writeGeometryElement(a,b.extent,c)}function s(a,b,c){c[c.length-1].srsName=b.srsName,D(a,b.geometryName),K.default.prototype.writeGeometryElement(a,b.geometry,c)}function t(a,b,c){c[c.length-1].srsName=b.srsName,D(a,b.geometryName),K.default.prototype.writeGeometryElement(a,b.geometry,c)}function u(a,b,c){c[c.length-1].srsName=b.srsName,D(a,b.geometryName),K.default.prototype.writeGeometryElement(a,b.geometry,c)}function v(a,b,c){var d=(0,S.createElementNS)(aa,"ValueReference");(0,O.writeStringTextNode)(d,b.propertyName),a.appendChild(d);var e=(0,S.createElementNS)(L.GMLNS,"TimePeriod");a.appendChild(e);var f=(0,S.createElementNS)(L.GMLNS,"begin");e.appendChild(f),F(f,b.begin);var g=(0,S.createElementNS)(L.GMLNS,"end");e.appendChild(g),F(g,b.end)}function w(a,b,c){for(var d={node:a},e=b.conditions,f=0,g=e.length;f<g;++f){var h=e[f];(0,S.pushSerializeAndPop)(d,ga,(0,S.makeSimpleNodeFactory)(h.getTagName()),[h],c)}}function x(a,b,c){var d={node:a},e=b.condition;(0,S.pushSerializeAndPop)(d,ga,(0,S.makeSimpleNodeFactory)(e.getTagName()),[e],c)}function y(a,b,c){void 0!==b.matchCase&&a.setAttribute("matchCase",b.matchCase.toString()),D(a,b.propertyName),E(a,""+b.expression)}function z(a,b,c){D(a,b.propertyName)}function A(a,b,c){D(a,b.propertyName);var d=(0,S.createElementNS)($,"LowerBoundary");a.appendChild(d),E(d,""+b.lowerBoundary);var e=(0,S.createElementNS)($,"UpperBoundary");a.appendChild(e),E(e,""+b.upperBoundary)}function B(a,b,c){a.setAttribute("wildCard",b.wildCard),a.setAttribute("singleChar",b.singleChar),a.setAttribute("escapeChar",b.escapeChar),void 0!==b.matchCase&&a.setAttribute("matchCase",b.matchCase.toString()),D(a,b.propertyName),E(a,""+b.pattern)}function C(a,b,c){var d=(0,S.createElementNS)($,a);(0,O.writeStringTextNode)(d,c),b.appendChild(d)}function D(a,b){C("PropertyName",a,b)}function E(a,b){C("Literal",a,b)}function F(a,b){var c=(0,S.createElementNS)(L.GMLNS,"TimeInstant");a.appendChild(c);var d=(0,S.createElementNS)(L.GMLNS,"timePosition");c.appendChild(d),(0,O.writeStringTextNode)(d,b)}function G(a){var b=(0,S.createElementNS)($,"Filter");return q(b,a,[]),b}function H(a,b,c){var d=c[c.length-1],e=(0,Q.assign)({},d);e.node=a,(0,S.pushSerializeAndPop)(e,ga,(0,S.makeSimpleNodeFactory)("Query"),b,c)}Object.defineProperty(c,"__esModule",{value:!0}),c.writeFilter=G,c.default=void 0;var I=a("../asserts.js"),J=e(a("../format/GML2.js")),K=e(a("../format/GML3.js")),L=d(a("../format/GMLBase.js")),M=a("../format/filter.js"),N=e(a("../format/XMLFeature.js")),O=a("../format/xsd.js"),P=e(a("../geom/Geometry.js")),Q=a("../obj.js"),R=a("../proj.js"),S=a("../xml.js"),T={"http://www.opengis.net/gml":{boundedBy:(0,S.makeObjectPropertySetter)(L.default.prototype.readGeometryElement,"bounds")}},U={"http://www.opengis.net/wfs":{totalInserted:(0,S.makeObjectPropertySetter)(O.readNonNegativeInteger),totalUpdated:(0,S.makeObjectPropertySetter)(O.readNonNegativeInteger),totalDeleted:(0,S.makeObjectPropertySetter)(O.readNonNegativeInteger)}},V={"http://www.opengis.net/wfs":{TransactionSummary:(0,S.makeObjectPropertySetter)(f,"transactionSummary"),InsertResults:(0,S.makeObjectPropertySetter)(h,"insertIds")}},W={"http://www.opengis.net/wfs":{PropertyName:(0,S.makeChildAppender)(O.writeStringTextNode)}},X={"http://www.opengis.net/wfs":{Insert:(0,S.makeChildAppender)(i),Update:(0,S.makeChildAppender)(m),Delete:(0,S.makeChildAppender)(l),Property:(0,S.makeChildAppender)(n),Native:(0,S.makeChildAppender)(o)}},Y="feature",Z="http://www.w3.org/2000/xmlns/",$="http://www.opengis.net/ogc",_="http://www.opengis.net/wfs",aa="http://www.opengis.net/fes",ba={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},ca="1.1.0",da=function(a){function b(b){a.call(this);var c=b||{};this.featureType_=c.featureType,this.featureNS_=c.featureNS,this.gmlFormat_=c.gmlFormat?c.gmlFormat:new K.default,this.schemaLocation_=c.schemaLocation?c.schemaLocation:ba[ca]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getFeatureType=function(){return this.featureType_},b.prototype.setFeatureType=function(a){this.featureType_=a},b.prototype.readFeaturesFromNode=function(a,b){var c={featureType:this.featureType_,featureNS:this.featureNS_};(0,Q.assign)(c,this.getReadOptions(a,b||{}));var d=[c];this.gmlFormat_.FEATURE_COLLECTION_PARSERS[L.GMLNS].featureMember=(0,S.makeArrayPusher)(L.default.prototype.readFeaturesInternal);var e=(0,S.pushParseAndPop)([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,a,d,this.gmlFormat_);return e||(e=[]),e},b.prototype.readTransactionResponse=function(a){if((0,S.isDocument)(a))return this.readTransactionResponseFromDocument(a);if((0,S.isNode)(a))return this.readTransactionResponseFromNode(a);if("string"==typeof a){var b=(0,S.parse)(a);return this.readTransactionResponseFromDocument(b)}},b.prototype.readFeatureCollectionMetadata=function(a){if((0,S.isDocument)(a))return this.readFeatureCollectionMetadataFromDocument(a);if((0,S.isNode)(a))return this.readFeatureCollectionMetadataFromNode(a);if("string"==typeof a){var b=(0,S.parse)(a);return this.readFeatureCollectionMetadataFromDocument(b)}},b.prototype.readFeatureCollectionMetadataFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE)return b.readFeatureCollectionMetadataFromNode(c)},b.prototype.readFeatureCollectionMetadataFromNode=function(a){var b={},c=(0,O.readNonNegativeIntegerString)(a.getAttribute("numberOfFeatures"));return b.numberOfFeatures=c,(0,S.pushParseAndPop)(b,T,a,[],this.gmlFormat_)},b.prototype.readTransactionResponseFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE)return b.readTransactionResponseFromNode(c)},b.prototype.readTransactionResponseFromNode=function(a){return(0,S.pushParseAndPop)({},V,a,[])},b.prototype.writeGetFeature=function(a){var b=(0,S.createElementNS)(_,"GetFeature");b.setAttribute("service","WFS"),b.setAttribute("version","1.1.0");var c;if(a&&(a.handle&&b.setAttribute("handle",a.handle),a.outputFormat&&b.setAttribute("outputFormat",a.outputFormat),void 0!==a.maxFeatures&&b.setAttribute("maxFeatures",a.maxFeatures),a.resultType&&b.setAttribute("resultType",a.resultType),void 0!==a.startIndex&&b.setAttribute("startIndex",a.startIndex),void 0!==a.count&&b.setAttribute("count",a.count),c=a.filter,a.bbox)){(0,I.assert)(a.geometryName,12);var d=(0,M.bbox)(a.geometryName,a.bbox,a.srsName);c=c?(0,M.and)(c,d):d}b.setAttributeNS(S.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation_);var e={node:b,srsName:a.srsName,featureNS:a.featureNS?a.featureNS:this.featureNS_,featurePrefix:a.featurePrefix,geometryName:a.geometryName,filter:c,propertyNames:a.propertyNames?a.propertyNames:[]};return(0,I.assert)(Array.isArray(a.featureTypes),11),H(b,a.featureTypes,[e]),b},b.prototype.writeTransaction=function(a,b,c,d){var e=[],f=(0,S.createElementNS)(_,"Transaction"),g=d.version?d.version:ca,h="1.0.0"===g?2:3;f.setAttribute("service","WFS"),f.setAttribute("version",g);var i,j;d&&(i=d.gmlOptions?d.gmlOptions:{},d.handle&&f.setAttribute("handle",d.handle));var k=ba[g];f.setAttributeNS(S.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",k);var l=d.featurePrefix?d.featurePrefix:Y;return a&&(j={node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,hasZ:d.hasZ,srsName:d.srsName},(0,Q.assign)(j,i),(0,S.pushSerializeAndPop)(j,X,(0,S.makeSimpleNodeFactory)("Insert"),a,e)),b&&(j={node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,hasZ:d.hasZ,srsName:d.srsName},(0,Q.assign)(j,i),(0,S.pushSerializeAndPop)(j,X,(0,S.makeSimpleNodeFactory)("Update"),b,e)),c&&(0,S.pushSerializeAndPop)({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,srsName:d.srsName},X,(0,S.makeSimpleNodeFactory)("Delete"),c,e),d.nativeElements&&(0,S.pushSerializeAndPop)({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,srsName:d.srsName},X,(0,S.makeSimpleNodeFactory)("Native"),d.nativeElements,e),f},b.prototype.readProjectionFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE)return b.readProjectionFromNode(c);return null},b.prototype.readProjectionFromNode=function(a){var b=this;if(a.firstElementChild&&a.firstElementChild.firstElementChild){a=a.firstElementChild.firstElementChild;for(var c=a.firstElementChild;c;c=c.nextElementSibling)if(0!==c.childNodes.length&&(1!==c.childNodes.length||3!==c.firstChild.nodeType)){var d=[{}];return b.gmlFormat_.readGeometryElement(c,d),(0,R.get)(d.pop().srsName)}}return null},b}(N.default),ea={"http://www.opengis.net/ogc":{FeatureId:(0,S.makeArrayPusher)(function(a,b){return a.getAttribute("fid")})}},fa={"http://www.opengis.net/wfs":{Feature:g}},ga={"http://www.opengis.net/wfs":{Query:(0,S.makeChildAppender)(p)},"http://www.opengis.net/ogc":{During:(0,S.makeChildAppender)(v),And:(0,S.makeChildAppender)(w),Or:(0,S.makeChildAppender)(w),Not:(0,S.makeChildAppender)(x),BBOX:(0,S.makeChildAppender)(r),Contains:(0,S.makeChildAppender)(s),Intersects:(0,S.makeChildAppender)(t),Within:(0,S.makeChildAppender)(u),PropertyIsEqualTo:(0,S.makeChildAppender)(y),PropertyIsNotEqualTo:(0,S.makeChildAppender)(y),PropertyIsLessThan:(0,S.makeChildAppender)(y),PropertyIsLessThanOrEqualTo:(0,S.makeChildAppender)(y),PropertyIsGreaterThan:(0,S.makeChildAppender)(y),PropertyIsGreaterThanOrEqualTo:(0,S.makeChildAppender)(y),PropertyIsNull:(0,S.makeChildAppender)(z),PropertyIsBetween:(0,S.makeChildAppender)(A),PropertyIsLike:(0,S.makeChildAppender)(B)}},ha=da;c.default=ha},{"../asserts.js":47,"../format/GML2.js":81,"../format/GML3.js":82,"../format/GMLBase.js":83,"../format/XMLFeature.js":101,"../format/filter.js":102,"../format/xsd.js":125,"../geom/Geometry.js":129,"../obj.js":201,"../proj.js":210,"../xml.js":351}],95:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=a.getCoordinates();return 0===b.length?"":b.join(" ")}function f(a){for(var b=[],c=a.getPoints(),d=0,f=c.length;d<f;++d)b.push("("+e(c[d])+")");return b.join(",")}function g(a){for(var b=[],c=a.getGeometries(),d=0,e=c.length;d<e;++d)b.push(m(c[d]));return b.join(",")}function h(a){for(var b=a.getCoordinates(),c=[],d=0,e=b.length;d<e;++d)c.push(b[d].join(" "));return c.join(",")}function i(a){for(var b=[],c=a.getLineStrings(),d=0,e=c.length;d<e;++d)b.push("("+h(c[d])+")");return b.join(",")}function j(a){for(var b=[],c=a.getLinearRings(),d=0,e=c.length;d<e;++d)b.push("("+h(c[d])+")");return b.join(",")}function k(a){for(var b=[],c=a.getPolygons(),d=0,e=c.length;d<e;++d)b.push("("+j(c[d])+")");return b.join(",")}function l(a){var b=a.getLayout(),c="";return b!==s.default.XYZ&&b!==s.default.XYZM||(c+=C),b!==s.default.XYM&&b!==s.default.XYZM||(c+=D),c}function m(a){var b=a.getType(),c=L[b],d=c(a);if(b=b.toUpperCase(),a instanceof z.default){var e=l(a);e.length>0&&(b+=" "+e)}return 0===d.length?b+" "+B:b+"("+d+")"}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n=d(a("../Feature.js")),o=a("../format/Feature.js"),p=d(a("../format/TextFeature.js")),q=d(a("../geom/GeometryCollection.js")),r=d(a("../geom/GeometryType.js")),s=d(a("../geom/GeometryLayout.js")),t=d(a("../geom/LineString.js")),u=d(a("../geom/MultiLineString.js")),v=d(a("../geom/MultiPoint.js")),w=d(a("../geom/MultiPolygon.js")),x=d(a("../geom/Point.js")),y=d(a("../geom/Polygon.js")),z=d(a("../geom/SimpleGeometry.js")),A={POINT:x.default,LINESTRING:t.default,POLYGON:y.default,MULTIPOINT:v.default,MULTILINESTRING:u.default,MULTIPOLYGON:w.default},B="EMPTY",C="Z",D="M",E="ZM",F={TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},G={};for(var H in r.default)G[H]=r.default[H].toUpperCase();var I=function(a){this.wkt=a,this.index_=-1};I.prototype.isAlpha_=function(a){return a>="a"&&a<="z"||a>="A"&&a<="Z"},I.prototype.isNumeric_=function(a,b){var c=void 0!==b&&b;return a>="0"&&a<="9"||"."==a&&!c},I.prototype.isWhiteSpace_=function(a){return" "==a||"\t"==a||"\r"==a||"\n"==a},I.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},I.prototype.nextToken=function(){var a=this.nextChar_(),b={position:this.index_,value:a};if("("==a)b.type=F.LEFT_PAREN;else if(","==a)b.type=F.COMMA;else if(")"==a)b.type=F.RIGHT_PAREN;else if(this.isNumeric_(a)||"-"==a)b.type=F.NUMBER,b.value=this.readNumber_();else if(this.isAlpha_(a))b.type=F.TEXT,b.value=this.readText_();else{if(this.isWhiteSpace_(a))return this.nextToken();if(""!==a)throw new Error("Unexpected character: "+a);b.type=F.EOF}return b},I.prototype.readNumber_=function(){var a,b=this,c=this.index_,d=!1,e=!1;do{"."==a?d=!0:"e"!=a&&"E"!=a||(e=!0),a=b.nextChar_()}while(this.isNumeric_(a,d)||!e&&("e"==a||"E"==a)||e&&("-"==a||"+"==a));return parseFloat(this.wkt.substring(c,this.index_--))},I.prototype.readText_=function(){var a,b=this,c=this.index_;do{a=b.nextChar_()}while(this.isAlpha_(a));return this.wkt.substring(c,this.index_--).toUpperCase()};var J=function(a){this.lexer_=a,this.token_,this.layout_=s.default.XY};J.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},J.prototype.isTokenType=function(a){return this.token_.type==a},J.prototype.match=function(a){var b=this.isTokenType(a);return b&&this.consume_(),b},J.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},J.prototype.parseGeometryLayout_=function(){var a=s.default.XY,b=this.token_;if(this.isTokenType(F.TEXT)){var c=b.value;c===C?a=s.default.XYZ:c===D?a=s.default.XYM:c===E&&(a=s.default.XYZM),a!==s.default.XY&&this.consume_()}return a},J.prototype.parseGeometryCollectionText_=function(){var a=this;if(this.match(F.LEFT_PAREN)){var b=[];do{b.push(a.parseGeometry_())}while(this.match(F.COMMA));if(this.match(F.RIGHT_PAREN))return b}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},J.prototype.parsePointText_=function(){if(this.match(F.LEFT_PAREN)){var a=this.parsePoint_();if(this.match(F.RIGHT_PAREN))return a}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())},J.prototype.parseLineStringText_=function(){if(this.match(F.LEFT_PAREN)){var a=this.parsePointList_();if(this.match(F.RIGHT_PAREN))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},J.prototype.parsePolygonText_=function(){if(this.match(F.LEFT_PAREN)){var a=this.parseLineStringTextList_();if(this.match(F.RIGHT_PAREN))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},J.prototype.parseMultiPointText_=function(){if(this.match(F.LEFT_PAREN)){var a;if(a=this.token_.type==F.LEFT_PAREN?this.parsePointTextList_():this.parsePointList_(),this.match(F.RIGHT_PAREN))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},J.prototype.parseMultiLineStringText_=function(){if(this.match(F.LEFT_PAREN)){var a=this.parseLineStringTextList_();if(this.match(F.RIGHT_PAREN))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},J.prototype.parseMultiPolygonText_=function(){if(this.match(F.LEFT_PAREN)){var a=this.parsePolygonTextList_();if(this.match(F.RIGHT_PAREN))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},J.prototype.parsePoint_=function(){for(var a=this,b=[],c=this.layout_.length,d=0;d<c;++d){var e=a.token_;if(!a.match(F.NUMBER))break;b.push(e.value)}if(b.length==c)return b;throw new Error(this.formatErrorMessage_())},J.prototype.parsePointList_=function(){for(var a=this,b=[this.parsePoint_()];this.match(F.COMMA);)b.push(a.parsePoint_());return b},J.prototype.parsePointTextList_=function(){for(var a=this,b=[this.parsePointText_()];this.match(F.COMMA);)b.push(a.parsePointText_());return b},J.prototype.parseLineStringTextList_=function(){for(var a=this,b=[this.parseLineStringText_()];this.match(F.COMMA);)b.push(a.parseLineStringText_());return b},J.prototype.parsePolygonTextList_=function(){for(var a=this,b=[this.parsePolygonText_()];this.match(F.COMMA);)b.push(a.parsePolygonText_());return b},J.prototype.isEmptyGeometry_=function(){var a=this.isTokenType(F.TEXT)&&this.token_.value==B;return a&&this.consume_(),a},J.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},J.prototype.parseGeometry_=function(){var a=this.token_;if(this.match(F.TEXT)){var b=a.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==b){var c=this.parseGeometryCollectionText_();return new q.default(c)}var d=A[b];if(!d)throw new Error("Invalid geometry type: "+b);var e;switch(b){case"POINT":e=this.parsePointText_();break;case"LINESTRING":e=this.parseLineStringText_();break;case"POLYGON":e=this.parsePolygonText_();break;case"MULTIPOINT":e=this.parseMultiPointText_();break;case"MULTILINESTRING":e=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":e=this.parseMultiPolygonText_();break;default:throw new Error("Invalid geometry type: "+b)}return e||(e=d===A.POINT?[NaN,NaN]:[]),new d(e,this.layout_)}throw new Error(this.formatErrorMessage_())};var K=function(a){function b(b){a.call(this);var c=b||{};this.splitCollection_=void 0!==c.splitCollection&&c.splitCollection}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.parse_=function(a){var b=new I(a);return new J(b).parse()},b.prototype.readFeatureFromText=function(a,b){var c=this.readGeometryFromText(a,b);if(c){var d=new n.default;return d.setGeometry(c),d}return null},b.prototype.readFeaturesFromText=function(a,b){var c=[],d=this.readGeometryFromText(a,b);c=this.splitCollection_&&d.getType()==r.default.GEOMETRY_COLLECTION?d.getGeometriesArray():[d];for(var e=[],f=0,g=c.length;f<g;++f){var h=new n.default;h.setGeometry(c[f]),e.push(h)}return e},b.prototype.readGeometryFromText=function(a,b){var c=this.parse_(a);return c?(0,o.transformWithOptions)(c,!1,b):null},b.prototype.writeFeatureText=function(a,b){var c=a.getGeometry();return c?this.writeGeometryText(c,b):""},b.prototype.writeFeaturesText=function(a,b){if(1==a.length)return this.writeFeatureText(a[0],b);for(var c=[],d=0,e=a.length;d<e;++d)c.push(a[d].getGeometry());var f=new q.default(c);return this.writeGeometryText(f,b)},b.prototype.writeGeometryText=function(a,b){return m((0,o.transformWithOptions)(a,!0,b))},b}(p.default),L={Point:e,LineString:h,Polygon:j,MultiPoint:f,MultiLineString:i,MultiPolygon:k,GeometryCollection:g},M=K;c.default=M},{"../Feature.js":10,"../format/Feature.js":78,"../format/TextFeature.js":92,"../geom/GeometryCollection.js":130,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../geom/SimpleGeometry.js":140}],96:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return(0,D.pushParseAndPop)({},O,a,b)}function f(a,b){var c=[(0,C.readDecimalString)(a.getAttribute("minx")),(0,C.readDecimalString)(a.getAttribute("miny")),(0,C.readDecimalString)(a.getAttribute("maxx")),(0,C.readDecimalString)(a.getAttribute("maxy"))],d=[(0,C.readDecimalString)(a.getAttribute("resx")),(0,C.readDecimalString)(a.getAttribute("resy"))];return{crs:a.getAttribute("CRS"),extent:c,res:d}}function g(a,b){var c=(0,D.pushParseAndPop)({},P,a,b);if(c){var d=c.westBoundLongitude,e=c.southBoundLatitude,f=c.eastBoundLongitude,g=c.northBoundLatitude;if(void 0!==d&&void 0!==e&&void 0!==f&&void 0!==g)return[d,e,f,g]}}function h(a,b){return(0,D.pushParseAndPop)({},G,a,b)}function i(a,b){return(0,D.pushParseAndPop)({},I,a,b)}function j(a,b){return(0,D.pushParseAndPop)({},J,a,b)}function k(a,b){return(0,D.pushParseAndPop)({},K,a,b)}function l(a,b){return(0,D.pushParseAndPop)({},L,a,b)}function m(a,b){return(0,D.pushParseAndPop)([],M,a,b)}function n(a,b){return(0,D.pushParseAndPop)({},N,a,b)}function o(a,b){var c=b[b.length-1],d=(0,D.pushParseAndPop)({},N,a,b);if(d){var e=(0,C.readBooleanString)(a.getAttribute("queryable"));void 0===e&&(e=c.queryable),d.queryable=void 0!==e&&e;var f=(0,C.readNonNegativeIntegerString)(a.getAttribute("cascaded"));void 0===f&&(f=c.cascaded),d.cascaded=f;var g=(0,C.readBooleanString)(a.getAttribute("opaque"));void 0===g&&(g=c.opaque),d.opaque=void 0!==g&&g;var h=(0,C.readBooleanString)(a.getAttribute("noSubsets"));void 0===h&&(h=c.noSubsets),d.noSubsets=void 0!==h&&h;var i=(0,C.readDecimalString)(a.getAttribute("fixedWidth"));i||(i=c.fixedWidth),d.fixedWidth=i;var j=(0,C.readDecimalString)(a.getAttribute("fixedHeight"));j||(j=c.fixedHeight),d.fixedHeight=j;["Style","CRS","AuthorityURL"].forEach(function(a){if(a in c){var b=d[a]||[];d[a]=b.concat(c[a])}});return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(a){if(!(a in d)){var b=c[a];d[a]=b}}),d}}function p(a,b){return{name:a.getAttribute("name"),units:a.getAttribute("units"),unitSymbol:a.getAttribute("unitSymbol"),default:a.getAttribute("default"),multipleValues:(0,C.readBooleanString)(a.getAttribute("multipleValues")),nearestValue:(0,C.readBooleanString)(a.getAttribute("nearestValue")),current:(0,C.readBooleanString)(a.getAttribute("current")),values:(0,C.readString)(a)}}function q(a,b){return(0,D.pushParseAndPop)({},V,a,b)}function r(a,b){return(0,D.pushParseAndPop)({},Q,a,b)}function s(a,b){return(0,D.pushParseAndPop)({},S,a,b)}function t(a,b){return(0,D.pushParseAndPop)({},T,a,b)}function u(a,b){return(0,D.pushParseAndPop)({},R,a,b)}function v(a,b){var c=q(a,b);if(c){var d=[(0,C.readNonNegativeIntegerString)(a.getAttribute("width")),(0,C.readNonNegativeIntegerString)(a.getAttribute("height"))];return c.size=d,c}}function w(a,b){var c=q(a,b);if(c)return c.name=a.getAttribute("name"),c}function x(a,b){var c=q(a,b);if(c)return c.type=a.getAttribute("type"),c}function y(a,b){return(0,D.pushParseAndPop)({},U,a,b)}function z(a,b){return(0,D.pushParseAndPop)([],W,a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var A=a("../format/XLink.js"),B=d(a("../format/XML.js")),C=a("../format/xsd.js"),D=a("../xml.js"),E=[null,"http://www.opengis.net/wms"],F=(0,D.makeStructureNS)(E,{Service:(0,D.makeObjectPropertySetter)(i),Capability:(0,D.makeObjectPropertySetter)(h)}),G=(0,D.makeStructureNS)(E,{Request:(0,D.makeObjectPropertySetter)(r),Exception:(0,D.makeObjectPropertySetter)(m),Layer:(0,D.makeObjectPropertySetter)(n)}),H=function(a){function b(){a.call(this),this.version=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE)return b.readFromNode(c);return null},b.prototype.readFromNode=function(a){this.version=a.getAttribute("version").trim();var b=(0,D.pushParseAndPop)({version:this.version},F,a,[]);return b||null},b}(B.default),I=(0,D.makeStructureNS)(E,{Name:(0,D.makeObjectPropertySetter)(C.readString),Title:(0,D.makeObjectPropertySetter)(C.readString),Abstract:(0,D.makeObjectPropertySetter)(C.readString),KeywordList:(0,D.makeObjectPropertySetter)(z),OnlineResource:(0,D.makeObjectPropertySetter)(A.readHref),ContactInformation:(0,D.makeObjectPropertySetter)(j),Fees:(0,D.makeObjectPropertySetter)(C.readString),AccessConstraints:(0,D.makeObjectPropertySetter)(C.readString),LayerLimit:(0,D.makeObjectPropertySetter)(C.readNonNegativeInteger),MaxWidth:(0,D.makeObjectPropertySetter)(C.readNonNegativeInteger),MaxHeight:(0,D.makeObjectPropertySetter)(C.readNonNegativeInteger)}),J=(0,D.makeStructureNS)(E,{ContactPersonPrimary:(0,D.makeObjectPropertySetter)(k),ContactPosition:(0,D.makeObjectPropertySetter)(C.readString),ContactAddress:(0,D.makeObjectPropertySetter)(l),ContactVoiceTelephone:(0,D.makeObjectPropertySetter)(C.readString),ContactFacsimileTelephone:(0,D.makeObjectPropertySetter)(C.readString),ContactElectronicMailAddress:(0,D.makeObjectPropertySetter)(C.readString)}),K=(0,D.makeStructureNS)(E,{ContactPerson:(0,D.makeObjectPropertySetter)(C.readString),ContactOrganization:(0,D.makeObjectPropertySetter)(C.readString)}),L=(0,D.makeStructureNS)(E,{AddressType:(0,D.makeObjectPropertySetter)(C.readString),Address:(0,D.makeObjectPropertySetter)(C.readString),City:(0,D.makeObjectPropertySetter)(C.readString),StateOrProvince:(0,D.makeObjectPropertySetter)(C.readString),PostCode:(0,D.makeObjectPropertySetter)(C.readString),Country:(0,D.makeObjectPropertySetter)(C.readString)}),M=(0,D.makeStructureNS)(E,{Format:(0,D.makeArrayPusher)(C.readString)}),N=(0,D.makeStructureNS)(E,{Name:(0,D.makeObjectPropertySetter)(C.readString),Title:(0,D.makeObjectPropertySetter)(C.readString),Abstract:(0,D.makeObjectPropertySetter)(C.readString),KeywordList:(0,D.makeObjectPropertySetter)(z),CRS:(0,
D.makeObjectPropertyPusher)(C.readString),EX_GeographicBoundingBox:(0,D.makeObjectPropertySetter)(g),BoundingBox:(0,D.makeObjectPropertyPusher)(f),Dimension:(0,D.makeObjectPropertyPusher)(p),Attribution:(0,D.makeObjectPropertySetter)(e),AuthorityURL:(0,D.makeObjectPropertyPusher)(w),Identifier:(0,D.makeObjectPropertyPusher)(C.readString),MetadataURL:(0,D.makeObjectPropertyPusher)(x),DataURL:(0,D.makeObjectPropertyPusher)(q),FeatureListURL:(0,D.makeObjectPropertyPusher)(q),Style:(0,D.makeObjectPropertyPusher)(y),MinScaleDenominator:(0,D.makeObjectPropertySetter)(C.readDecimal),MaxScaleDenominator:(0,D.makeObjectPropertySetter)(C.readDecimal),Layer:(0,D.makeObjectPropertyPusher)(o)}),O=(0,D.makeStructureNS)(E,{Title:(0,D.makeObjectPropertySetter)(C.readString),OnlineResource:(0,D.makeObjectPropertySetter)(A.readHref),LogoURL:(0,D.makeObjectPropertySetter)(v)}),P=(0,D.makeStructureNS)(E,{westBoundLongitude:(0,D.makeObjectPropertySetter)(C.readDecimal),eastBoundLongitude:(0,D.makeObjectPropertySetter)(C.readDecimal),southBoundLatitude:(0,D.makeObjectPropertySetter)(C.readDecimal),northBoundLatitude:(0,D.makeObjectPropertySetter)(C.readDecimal)}),Q=(0,D.makeStructureNS)(E,{GetCapabilities:(0,D.makeObjectPropertySetter)(u),GetMap:(0,D.makeObjectPropertySetter)(u),GetFeatureInfo:(0,D.makeObjectPropertySetter)(u)}),R=(0,D.makeStructureNS)(E,{Format:(0,D.makeObjectPropertyPusher)(C.readString),DCPType:(0,D.makeObjectPropertyPusher)(s)}),S=(0,D.makeStructureNS)(E,{HTTP:(0,D.makeObjectPropertySetter)(t)}),T=(0,D.makeStructureNS)(E,{Get:(0,D.makeObjectPropertySetter)(q),Post:(0,D.makeObjectPropertySetter)(q)}),U=(0,D.makeStructureNS)(E,{Name:(0,D.makeObjectPropertySetter)(C.readString),Title:(0,D.makeObjectPropertySetter)(C.readString),Abstract:(0,D.makeObjectPropertySetter)(C.readString),LegendURL:(0,D.makeObjectPropertyPusher)(v),StyleSheetURL:(0,D.makeObjectPropertySetter)(q),StyleURL:(0,D.makeObjectPropertySetter)(q)}),V=(0,D.makeStructureNS)(E,{Format:(0,D.makeObjectPropertySetter)(C.readString),OnlineResource:(0,D.makeObjectPropertySetter)(A.readHref)}),W=(0,D.makeStructureNS)(E,{Keyword:(0,D.makeArrayPusher)(C.readString)}),X=H;c.default=X},{"../format/XLink.js":99,"../format/XML.js":100,"../format/xsd.js":125,"../xml.js":351}],97:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=d(a("../format/GML2.js")),g=d(a("../format/XMLFeature.js")),h=a("../obj.js"),i=a("../xml.js"),j="_feature",k="_layer",l=function(a){function b(b){a.call(this);var c=b||{};this.featureNS_="http://mapserver.gis.umn.edu/mapserver",this.gmlFormat_=new f.default,this.layers_=c.layers?c.layers:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getLayers=function(){return this.layers_},b.prototype.setLayers=function(a){this.layers_=a},b.prototype.readFeatures_=function(a,b){var c=this;a.setAttribute("namespaceURI",this.featureNS_);var d=a.localName,f=[];if(0===a.childNodes.length)return f;if("msGMLOutput"==d)for(var g=0,h=a.childNodes.length;g<h;g++){var l=a.childNodes[g];if(l.nodeType===Node.ELEMENT_NODE){var m=b[0],n=k,o=l.localName.replace(n,"");if(!c.layers_||(0,e.includes)(c.layers_,o)){var p=o+j;m.featureType=p,m.featureNS=c.featureNS_;var q={};q[p]=(0,i.makeArrayPusher)(c.gmlFormat_.readFeatureElement,c.gmlFormat_);var r=(0,i.makeStructureNS)([m.featureNS,null],q);l.setAttribute("namespaceURI",c.featureNS_);var s=(0,i.pushParseAndPop)([],r,l,b,c.gmlFormat_);s&&(0,e.extend)(f,s)}}}if("FeatureCollection"==d){var t=(0,i.pushParseAndPop)([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,a,[{}],this.gmlFormat_);t&&(f=t)}return f},b.prototype.readFeaturesFromNode=function(a,b){var c={};return b&&(0,h.assign)(c,this.getReadOptions(a,b)),this.readFeatures_(a,[c])},b}(g.default),m=l;c.default=m},{"../array.js":46,"../format/GML2.js":81,"../format/XMLFeature.js":101,"../obj.js":201,"../xml.js":351}],98:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return(0,w.pushParseAndPop)({},B,a,b)}function f(a,b){return(0,w.pushParseAndPop)({},C,a,b)}function g(a,b){return(0,w.pushParseAndPop)({},J,a,b)}function h(a,b){var c=(0,w.pushParseAndPop)({},D,a,b);if(c){var d="true"===a.getAttribute("isDefault");return c.isDefault=d,c}}function i(a,b){return(0,w.pushParseAndPop)({},E,a,b)}function j(a,b){return(0,w.pushParseAndPop)({},H,a,b)}function k(a,b){var c=a.getAttribute("format"),d=a.getAttribute("template"),e=a.getAttribute("resourceType"),f={};return c&&(f.format=c),d&&(f.template=d),e&&(f.resourceType=e),f}function l(a,b){var c=(0,w.pushParseAndPop)([],I,a,b);if(2==c.length)return(0,r.boundingExtent)(c)}function m(a,b){var c={};return c.format=a.getAttribute("format"),c.href=(0,t.readHref)(a),c}function n(a,b){var c=(0,v.readString)(a).split(/\s+/);if(c&&2==c.length){var d=+c[0],e=+c[1];if(!isNaN(d)&&!isNaN(e))return[d,e]}}function o(a,b){return(0,w.pushParseAndPop)({},K,a,b)}function p(a,b){return(0,w.pushParseAndPop)([],F,a,b)}function q(a,b){return(0,w.pushParseAndPop)({},G,a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var r=a("../extent.js"),s=d(a("../format/OWS.js")),t=a("../format/XLink.js"),u=d(a("../format/XML.js")),v=a("../format/xsd.js"),w=a("../xml.js"),x=[null,"http://www.opengis.net/wmts/1.0"],y=[null,"http://www.opengis.net/ows/1.1"],z=(0,w.makeStructureNS)(x,{Contents:(0,w.makeObjectPropertySetter)(e)}),A=function(a){function b(){a.call(this),this.owsParser_=new s.default}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.readFromDocument=function(a){for(var b=this,c=a.firstChild;c;c=c.nextSibling)if(c.nodeType==Node.ELEMENT_NODE)return b.readFromNode(c);return null},b.prototype.readFromNode=function(a){var b=a.getAttribute("version").trim(),c=this.owsParser_.readFromNode(a);return c?(c.version=b,(c=(0,w.pushParseAndPop)(c,z,a,[]))||null):null},b}(u.default),B=(0,w.makeStructureNS)(x,{Layer:(0,w.makeObjectPropertyPusher)(f),TileMatrixSet:(0,w.makeObjectPropertyPusher)(g)}),C=(0,w.makeStructureNS)(x,{Style:(0,w.makeObjectPropertyPusher)(h),Format:(0,w.makeObjectPropertyPusher)(v.readString),TileMatrixSetLink:(0,w.makeObjectPropertyPusher)(i),Dimension:(0,w.makeObjectPropertyPusher)(j),ResourceURL:(0,w.makeObjectPropertyPusher)(k)},(0,w.makeStructureNS)(y,{Title:(0,w.makeObjectPropertySetter)(v.readString),Abstract:(0,w.makeObjectPropertySetter)(v.readString),WGS84BoundingBox:(0,w.makeObjectPropertySetter)(l),Identifier:(0,w.makeObjectPropertySetter)(v.readString)})),D=(0,w.makeStructureNS)(x,{LegendURL:(0,w.makeObjectPropertyPusher)(m)},(0,w.makeStructureNS)(y,{Title:(0,w.makeObjectPropertySetter)(v.readString),Identifier:(0,w.makeObjectPropertySetter)(v.readString)})),E=(0,w.makeStructureNS)(x,{TileMatrixSet:(0,w.makeObjectPropertySetter)(v.readString),TileMatrixSetLimits:(0,w.makeObjectPropertySetter)(p)}),F=(0,w.makeStructureNS)(x,{TileMatrixLimits:(0,w.makeArrayPusher)(q)}),G=(0,w.makeStructureNS)(x,{TileMatrix:(0,w.makeObjectPropertySetter)(v.readString),MinTileRow:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger),MaxTileRow:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger),MinTileCol:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger),MaxTileCol:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger)}),H=(0,w.makeStructureNS)(x,{Default:(0,w.makeObjectPropertySetter)(v.readString),Value:(0,w.makeObjectPropertyPusher)(v.readString)},(0,w.makeStructureNS)(y,{Identifier:(0,w.makeObjectPropertySetter)(v.readString)})),I=(0,w.makeStructureNS)(y,{LowerCorner:(0,w.makeArrayPusher)(n),UpperCorner:(0,w.makeArrayPusher)(n)}),J=(0,w.makeStructureNS)(x,{WellKnownScaleSet:(0,w.makeObjectPropertySetter)(v.readString),TileMatrix:(0,w.makeObjectPropertyPusher)(o)},(0,w.makeStructureNS)(y,{SupportedCRS:(0,w.makeObjectPropertySetter)(v.readString),Identifier:(0,w.makeObjectPropertySetter)(v.readString)})),K=(0,w.makeStructureNS)(x,{TopLeftCorner:(0,w.makeObjectPropertySetter)(n),ScaleDenominator:(0,w.makeObjectPropertySetter)(v.readDecimal),TileWidth:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger),TileHeight:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger),MatrixWidth:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger),MatrixHeight:(0,w.makeObjectPropertySetter)(v.readNonNegativeInteger)},(0,w.makeStructureNS)(y,{Identifier:(0,w.makeObjectPropertySetter)(v.readString)})),L=A;c.default=L},{"../extent.js":72,"../format/OWS.js":90,"../format/XLink.js":99,"../format/XML.js":100,"../format/xsd.js":125,"../xml.js":351}],99:[function(a,b,c){"use strict";function d(a){return a.getAttributeNS(e,"href")}Object.defineProperty(c,"__esModule",{value:!0}),c.readHref=d;var e="http://www.w3.org/1999/xlink"},{}],100:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../xml.js"),e=function(){};e.prototype.read=function(a){if((0,d.isDocument)(a))return this.readFromDocument(a);if((0,d.isNode)(a))return this.readFromNode(a);if("string"==typeof a){var b=(0,d.parse)(a);return this.readFromDocument(b)}return null},e.prototype.readFromDocument=function(a){},e.prototype.readFromNode=function(a){};var f=e;c.default=f},{"../xml.js":351}],101:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=d(a("../format/Feature.js")),g=d(a("../format/FormatType.js")),h=a("../xml.js"),i=function(a){function b(){a.call(this),this.xmlSerializer_=new XMLSerializer}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return g.default.XML},b.prototype.readFeature=function(a,b){if((0,h.isDocument)(a))return this.readFeatureFromDocument(a,b);if((0,h.isNode)(a))return this.readFeatureFromNode(a,b);if("string"==typeof a){var c=(0,h.parse)(a);return this.readFeatureFromDocument(c,b)}return null},b.prototype.readFeatureFromDocument=function(a,b){var c=this.readFeaturesFromDocument(a,b);return c.length>0?c[0]:null},b.prototype.readFeatureFromNode=function(a,b){return null},b.prototype.readFeatures=function(a,b){if((0,h.isDocument)(a))return this.readFeaturesFromDocument(a,b);if((0,h.isNode)(a))return this.readFeaturesFromNode(a,b);if("string"==typeof a){var c=(0,h.parse)(a);return this.readFeaturesFromDocument(c,b)}return[]},b.prototype.readFeaturesFromDocument=function(a,b){for(var c=this,d=[],f=a.firstChild;f;f=f.nextSibling)f.nodeType==Node.ELEMENT_NODE&&(0,e.extend)(d,c.readFeaturesFromNode(f,b));return d},b.prototype.readFeaturesFromNode=function(a,b){},b.prototype.readGeometry=function(a,b){if((0,h.isDocument)(a))return this.readGeometryFromDocument(a,b);if((0,h.isNode)(a))return this.readGeometryFromNode(a,b);if("string"==typeof a){var c=(0,h.parse)(a);return this.readGeometryFromDocument(c,b)}return null},b.prototype.readGeometryFromDocument=function(a,b){return null},b.prototype.readGeometryFromNode=function(a,b){return null},b.prototype.readProjection=function(a){if((0,h.isDocument)(a))return this.readProjectionFromDocument(a);if((0,h.isNode)(a))return this.readProjectionFromNode(a);if("string"==typeof a){var b=(0,h.parse)(a);return this.readProjectionFromDocument(b)}return null},b.prototype.readProjectionFromDocument=function(a){return this.dataProjection},b.prototype.readProjectionFromNode=function(a){return this.dataProjection},b.prototype.writeFeature=function(a,b){var c=this.writeFeatureNode(a,b);return this.xmlSerializer_.serializeToString(c)},b.prototype.writeFeatureNode=function(a,b){return null},b.prototype.writeFeatures=function(a,b){var c=this.writeFeaturesNode(a,b);return this.xmlSerializer_.serializeToString(c)},b.prototype.writeFeaturesNode=function(a,b){return null},b.prototype.writeGeometry=function(a,b){var c=this.writeGeometryNode(a,b);return this.xmlSerializer_.serializeToString(c)},b.prototype.writeGeometryNode=function(a,b){return null},b}(f.default),j=i;c.default=j},{"../array.js":46,"../format/Feature.js":78,"../format/FormatType.js":79,"../xml.js":351}],102:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(v.default,b))}function f(a){var b=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(K.default,b))}function g(a){return new I.default(a)}function h(a,b,c){return new w.default(a,b,c)}function i(a,b,c){return new x.default(a,b,c)}function j(a,b,c){return new C.default(a,b,c)}function k(a,b,c){return new L.default(a,b,c)}function l(a,b,c){return new z.default(a,b,c)}function m(a,b,c){return new J.default(a,b,c)}function n(a,b){return new G.default(a,b)}function o(a,b){return new H.default(a,b)}function p(a,b){return new A.default(a,b)}function q(a,b){return new B.default(a,b)}function r(a){return new F.default(a)}function s(a,b,c){return new D.default(a,b,c)}function t(a,b,c,d,e,f){return new E.default(a,b,c,d,e,f)}function u(a,b,c){return new y.default(a,b,c)}Object.defineProperty(c,"__esModule",{value:!0}),c.and=e,c.or=f,c.not=g,c.bbox=h,c.contains=i,c.intersects=j,c.within=k,c.equalTo=l,c.notEqualTo=m,c.lessThan=n,c.lessThanOrEqualTo=o,c.greaterThan=p,c.greaterThanOrEqualTo=q,c.isNull=r,c.between=s,c.like=t,c.during=u;var v=d(a("../format/filter/And.js")),w=d(a("../format/filter/Bbox.js")),x=d(a("../format/filter/Contains.js")),y=d(a("../format/filter/During.js")),z=d(a("../format/filter/EqualTo.js")),A=d(a("../format/filter/GreaterThan.js")),B=d(a("../format/filter/GreaterThanOrEqualTo.js")),C=d(a("../format/filter/Intersects.js")),D=d(a("../format/filter/IsBetween.js")),E=d(a("../format/filter/IsLike.js")),F=d(a("../format/filter/IsNull.js")),G=d(a("../format/filter/LessThan.js")),H=d(a("../format/filter/LessThanOrEqualTo.js")),I=d(a("../format/filter/Not.js")),J=d(a("../format/filter/NotEqualTo.js")),K=d(a("../format/filter/Or.js")),L=d(a("../format/filter/Within.js"))},{"../format/filter/And.js":103,"../format/filter/Bbox.js":104,"../format/filter/Contains.js":107,"../format/filter/During.js":108,"../format/filter/EqualTo.js":109,"../format/filter/GreaterThan.js":111,"../format/filter/GreaterThanOrEqualTo.js":112,"../format/filter/Intersects.js":113,"../format/filter/IsBetween.js":114,"../format/filter/IsLike.js":115,"../format/filter/IsNull.js":116,"../format/filter/LessThan.js":117,"../format/filter/LessThanOrEqualTo.js":118,"../format/filter/Not.js":120,"../format/filter/NotEqualTo.js":121,"../format/filter/Or.js":122,"../format/filter/Within.js":124}],103:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/LogicalNary.js")),f=function(a){function b(b){var c=["And"].concat(Array.prototype.slice.call(arguments));a.apply(this,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/LogicalNary.js":119}],104:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Filter.js")),f=function(a){function b(b,c,d){a.call(this,"BBOX"),this.geometryName=b,this.extent=c,this.srsName=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Filter.js":110}],105:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Filter.js")),f=function(a){function b(b,c){a.call(this,b),this.propertyName=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Filter.js":110}],106:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Comparison.js")),f=function(a){function b(b,c,d,e){a.call(this,b,c),this.expression=d,this.matchCase=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Comparison.js":105}],107:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Spatial.js")),f=function(a){function b(b,c,d){a.call(this,"Contains",b,c,d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Spatial.js":123}],108:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Comparison.js")),f=function(a){function b(b,c,d){a.call(this,"During",b),this.begin=c,this.end=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Comparison.js":105}],109:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/ComparisonBinary.js")),f=function(a){function b(b,c,d){a.call(this,"PropertyIsEqualTo",b,c,d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/ComparisonBinary.js":106}],110:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a){this.tagName_=a};d.prototype.getTagName=function(){return this.tagName_};var e=d;c.default=e},{}],111:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/ComparisonBinary.js")),f=function(a){function b(b,c){a.call(this,"PropertyIsGreaterThan",b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/ComparisonBinary.js":106}],112:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/ComparisonBinary.js")),f=function(a){function b(b,c){a.call(this,"PropertyIsGreaterThanOrEqualTo",b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/ComparisonBinary.js":106}],113:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Spatial.js")),f=function(a){function b(b,c,d){a.call(this,"Intersects",b,c,d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Spatial.js":123}],114:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Comparison.js")),f=function(a){function b(b,c,d){a.call(this,"PropertyIsBetween",b),this.lowerBoundary=c,this.upperBoundary=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Comparison.js":105}],115:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Comparison.js")),f=function(a){function b(b,c,d,e,f,g){a.call(this,"PropertyIsLike",b),this.pattern=c,this.wildCard=void 0!==d?d:"*",this.singleChar=void 0!==e?e:".",this.escapeChar=void 0!==f?f:"!",this.matchCase=g}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Comparison.js":105}],116:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Comparison.js")),f=function(a){function b(b){a.call(this,"PropertyIsNull",b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Comparison.js":105}],117:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/ComparisonBinary.js")),f=function(a){function b(b,c){a.call(this,"PropertyIsLessThan",b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/ComparisonBinary.js":106}],118:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/ComparisonBinary.js")),f=function(a){function b(b,c){a.call(this,"PropertyIsLessThanOrEqualTo",b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/ComparisonBinary.js":106}],119:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../asserts.js"),f=d(a("../filter/Filter.js")),g=function(a){function b(b,c){a.call(this,b),this.conditions=Array.prototype.slice.call(arguments,1),(0,e.assert)(this.conditions.length>=2,57)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(f.default),h=g;c.default=h},{"../../asserts.js":47,"../filter/Filter.js":110}],120:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Filter.js")),f=function(a){function b(b){a.call(this,"Not"),this.condition=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Filter.js":110}],121:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/ComparisonBinary.js")),f=function(a){function b(b,c,d){a.call(this,"PropertyIsNotEqualTo",b,c,d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/ComparisonBinary.js":106}],122:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/LogicalNary.js")),f=function(a){function b(b){var c=["Or"].concat(Array.prototype.slice.call(arguments));a.apply(this,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/LogicalNary.js":119}],123:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Filter.js")),f=function(a){function b(b,c,d,e){a.call(this,b),this.geometryName=c||"the_geom",this.geometry=d,this.srsName=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Filter.js":110}],124:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../filter/Spatial.js")),f=function(a){function b(b,c,d){a.call(this,"Within",b,c,d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../filter/Spatial.js":123}],125:[function(a,b,c){"use strict";function d(a){return e((0,r.getAllTextContent)(a,!1))}function e(a){var b=/^\s*(true|1)|(false|0)\s*$/.exec(a);return b?void 0!==b[1]||!1:void 0}function f(a){var b=(0,r.getAllTextContent)(a,!1),c=Date.parse(b);return isNaN(c)?void 0:c/1e3}function g(a){return h((0,r.getAllTextContent)(a,!1))}function h(a){var b=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a);return b?parseFloat(b[1]):void 0}function i(a){return j((0,r.getAllTextContent)(a,!1))}function j(a){var b=/^\s*(\d+)\s*$/.exec(a);return b?parseInt(b[1],10):void 0}function k(a){return(0,r.getAllTextContent)(a,!1).trim()}function l(a,b){q(a,b?"1":"0")}function m(a,b){a.appendChild(r.DOCUMENT.createCDATASection(b))}function n(a,b){var c=new Date(1e3*b),d=c.getUTCFullYear()+"-"+(0,s.padNumber)(c.getUTCMonth()+1,2)+"-"+(0,s.padNumber)(c.getUTCDate(),2)+"T"+(0,s.padNumber)(c.getUTCHours(),2)+":"+(0,s.padNumber)(c.getUTCMinutes(),2)+":"+(0,s.padNumber)(c.getUTCSeconds(),2)+"Z";a.appendChild(r.DOCUMENT.createTextNode(d))}function o(a,b){var c=b.toPrecision();a.appendChild(r.DOCUMENT.createTextNode(c))}function p(a,b){var c=b.toString();a.appendChild(r.DOCUMENT.createTextNode(c))}function q(a,b){a.appendChild(r.DOCUMENT.createTextNode(b))}Object.defineProperty(c,"__esModule",{value:!0}),c.readBoolean=d,c.readBooleanString=e,c.readDateTime=f,c.readDecimal=g,c.readDecimalString=h,c.readNonNegativeInteger=i,c.readNonNegativeIntegerString=j,c.readString=k,c.writeBooleanTextNode=l,c.writeCDATASection=m,c.writeDateTimeTextNode=n,c.writeDecimalTextNode=o,c.writeNonNegativeIntegerTextNode=p,c.writeStringTextNode=q;var r=a("../xml.js"),s=a("../string.js")},{"../string.js":313,"../xml.js":351}],126:[function(a,b,c){"use strict";function d(){return!0}function e(){return!1}function f(){}Object.defineProperty(c,"__esModule",{value:!0}),c.TRUE=d,c.FALSE=e,c.VOID=f},{}],127:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Circle",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Geometry",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"LineString",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"MultiLineString",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"MultiPoint",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"MultiPolygon",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Point",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"Polygon",{enumerable:!0,get:function(){return l.default}});var e=d(a("./geom/Circle.js")),f=d(a("./geom/Geometry.js")),g=d(a("./geom/LineString.js")),h=d(a("./geom/MultiLineString.js")),i=d(a("./geom/MultiPoint.js")),j=d(a("./geom/MultiPolygon.js")),k=d(a("./geom/Point.js")),l=d(a("./geom/Polygon.js"))},{"./geom/Circle.js":128,"./geom/Geometry.js":129,"./geom/LineString.js":133,"./geom/MultiLineString.js":135,"./geom/MultiPoint.js":136,"./geom/MultiPolygon.js":137,"./geom/Point.js":138,"./geom/Polygon.js":139}],128:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=d(a("../geom/GeometryType.js")),g=d(a("../geom/SimpleGeometry.js")),h=a("../geom/flat/deflate.js"),i=function(a){function b(b,c,d){if(a.call(this),void 0!==d&&void 0===c)this.setFlatCoordinates(d,b);else{var e=c||0;this.setCenterAndRadius(b,e,d)}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),void 0,this.layout)},b.prototype.closestPointXY=function(a,b,c,d){var e=this.flatCoordinates,f=a-e[0],g=b-e[1],h=f*f+g*g;if(h<d){if(0===h)for(var i=0;i<this.stride;++i)c[i]=e[i];else{var j=this.getRadius()/Math.sqrt(h);c[0]=e[0]+j*f,c[1]=e[1]+j*g;for(var k=2;k<this.stride;++k)c[k]=e[k]}return c.length=this.stride,h}return d},b.prototype.containsXY=function(a,b){var c=this.flatCoordinates,d=a-c[0],e=b-c[1];return d*d+e*e<=this.getRadiusSquared_()},b.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},b.prototype.computeExtent=function(a){var b=this.flatCoordinates,c=b[this.stride]-b[0];return(0,e.createOrUpdate)(b[0]-c,b[1]-c,b[0]+c,b[1]+c,a)},b.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},b.prototype.getRadiusSquared_=function(){var a=this.flatCoordinates[this.stride]-this.flatCoordinates[0],b=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return a*a+b*b},b.prototype.getType=function(){return f.default.CIRCLE},b.prototype.intersectsExtent=function(a){var b=this.getExtent();if((0,e.intersects)(a,b)){var c=this.getCenter();return a[0]<=c[0]&&a[2]>=c[0]||(a[1]<=c[1]&&a[3]>=c[1]||(0,e.forEachCorner)(a,this.intersectsCoordinate,this))}return!1},b.prototype.setCenter=function(a){var b=this.stride,c=this.flatCoordinates[b]-this.flatCoordinates[0],d=a.slice();d[b]=d[0]+c;for(var e=1;e<b;++e)d[b+e]=a[e];this.setFlatCoordinates(this.layout,d),this.changed()},b.prototype.setCenterAndRadius=function(a,b,c){this.setLayout(c,a,0),this.flatCoordinates||(this.flatCoordinates=[]);var d=this.flatCoordinates,e=(0,h.deflateCoordinate)(d,0,a,this.stride);d[e++]=d[0]+b;for(var f=1,g=this.stride;f<g;++f)d[e++]=d[f];d.length=e,this.changed()},b.prototype.getCoordinates=function(){},b.prototype.setCoordinates=function(a,b){},b.prototype.setRadius=function(a){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+a,this.changed()},b}(g.default);i.prototype.transform;var j=i;c.default=j},{"../extent.js":72,"../geom/GeometryType.js":132,"../geom/SimpleGeometry.js":140,"../geom/flat/deflate.js":145}],129:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Object.js")),f=a("../extent.js"),g=a("../functions.js"),h=a("../geom/flat/transform.js"),i=a("../proj.js"),j=d(a("../proj/Units.js")),k=a("../transform.js"),l=(0,k.create)(),m=function(a){function b(){a.call(this),this.extent_=(0,f.createEmpty)(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){},b.prototype.closestPointXY=function(a,b,c,d){},b.prototype.getClosestPoint=function(a,b){var c=b||[NaN,NaN];return this.closestPointXY(a[0],a[1],c,1/0),c},b.prototype.intersectsCoordinate=function(a){return this.containsXY(a[0],a[1])},b.prototype.computeExtent=function(a){},b.prototype.getExtent=function(a){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),(0,f.returnOrUpdate)(this.extent_,a)},b.prototype.rotate=function(a,b){},b.prototype.scale=function(a,b,c){},b.prototype.simplify=function(a){return this.getSimplifiedGeometry(a*a)},b.prototype.getSimplifiedGeometry=function(a){},b.prototype.getType=function(){},b.prototype.applyTransform=function(a){},b.prototype.intersectsExtent=function(a){},b.prototype.translate=function(a,b){},b.prototype.transform=function(a,b){a=(0,i.get)(a);var c=a.getUnits()==j.default.TILE_PIXELS?function(c,d,e){var g=a.getExtent(),j=a.getWorldExtent(),m=(0,f.getHeight)(j)/(0,f.getHeight)(g);return(0,k.compose)(l,j[0],j[3],m,-m,0,0,0),(0,h.transform2D)(c,0,c.length,e,l,d),(0,i.getTransform)(a,b)(c,d,e)}:(0,i.getTransform)(a,b);return this.applyTransform(c),this},b}(e.default);m.prototype.containsXY=g.FALSE;var n=m;c.default=n},{"../Object.js":29,"../extent.js":72,"../functions.js":126,
"../geom/flat/transform.js":160,"../proj.js":210,"../proj/Units.js":212,"../transform.js":340}],130:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){for(var b=[],c=0,d=a.length;c<d;++c)b.push(a[c].clone());return b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../events.js"),g=d(a("../events/EventType.js")),h=a("../extent.js"),i=d(a("../geom/Geometry.js")),j=d(a("../geom/GeometryType.js")),k=a("../obj.js"),l=function(a){function b(b){a.call(this),this.geometries_=b||null,this.listenGeometriesChange_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.unlistenGeometriesChange_=function(){var a=this;if(this.geometries_)for(var b=0,c=this.geometries_.length;b<c;++b)(0,f.unlisten)(a.geometries_[b],g.default.CHANGE,a.changed,a)},b.prototype.listenGeometriesChange_=function(){var a=this;if(this.geometries_)for(var b=0,c=this.geometries_.length;b<c;++b)(0,f.listen)(a.geometries_[b],g.default.CHANGE,a.changed,a)},b.prototype.clone=function(){var a=new b(null);return a.setGeometries(this.geometries_),a},b.prototype.closestPointXY=function(a,b,c,d){if(d<(0,h.closestSquaredDistanceXY)(this.getExtent(),a,b))return d;for(var e=this.geometries_,f=0,g=e.length;f<g;++f)d=e[f].closestPointXY(a,b,c,d);return d},b.prototype.containsXY=function(a,b){for(var c=this.geometries_,d=0,e=c.length;d<e;++d)if(c[d].containsXY(a,b))return!0;return!1},b.prototype.computeExtent=function(a){(0,h.createOrUpdateEmpty)(a);for(var b=this.geometries_,c=0,d=b.length;c<d;++c)(0,h.extend)(a,b[c].getExtent());return a},b.prototype.getGeometries=function(){return e(this.geometries_)},b.prototype.getGeometriesArray=function(){return this.geometries_},b.prototype.getSimplifiedGeometry=function(a){if(this.simplifiedGeometryRevision!=this.getRevision()&&((0,k.clear)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),a<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<this.simplifiedGeometryMaxMinSquaredTolerance)return this;var c=a.toString();if(this.simplifiedGeometryCache.hasOwnProperty(c))return this.simplifiedGeometryCache[c];for(var d=[],e=this.geometries_,f=!1,g=0,h=e.length;g<h;++g){var i=e[g],j=i.getSimplifiedGeometry(a);d.push(j),j!==i&&(f=!0)}if(f){var l=new b(null);return l.setGeometriesArray(d),this.simplifiedGeometryCache[c]=l,l}return this.simplifiedGeometryMaxMinSquaredTolerance=a,this},b.prototype.getType=function(){return j.default.GEOMETRY_COLLECTION},b.prototype.intersectsExtent=function(a){for(var b=this.geometries_,c=0,d=b.length;c<d;++c)if(b[c].intersectsExtent(a))return!0;return!1},b.prototype.isEmpty=function(){return 0===this.geometries_.length},b.prototype.rotate=function(a,b){for(var c=this.geometries_,d=0,e=c.length;d<e;++d)c[d].rotate(a,b);this.changed()},b.prototype.scale=function(a,b,c){var d=c;d||(d=(0,h.getCenter)(this.getExtent()));for(var e=this.geometries_,f=0,g=e.length;f<g;++f)e[f].scale(a,b,d);this.changed()},b.prototype.setGeometries=function(a){this.setGeometriesArray(e(a))},b.prototype.setGeometriesArray=function(a){this.unlistenGeometriesChange_(),this.geometries_=a,this.listenGeometriesChange_(),this.changed()},b.prototype.applyTransform=function(a){for(var b=this.geometries_,c=0,d=b.length;c<d;++c)b[c].applyTransform(a);this.changed()},b.prototype.translate=function(a,b){for(var c=this.geometries_,d=0,e=c.length;d<e;++d)c[d].translate(a,b);this.changed()},b.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),a.prototype.disposeInternal.call(this)},b}(i.default),m=l;c.default=m},{"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../geom/Geometry.js":129,"../geom/GeometryType.js":132,"../obj.js":201}],131:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};c.default=d},{}],132:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};c.default=d},{}],133:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryLayout.js")),h=d(a("../geom/GeometryType.js")),i=d(a("../geom/SimpleGeometry.js")),j=a("../geom/flat/closest.js"),k=a("../geom/flat/deflate.js"),l=a("../geom/flat/inflate.js"),m=a("../geom/flat/interpolate.js"),n=a("../geom/flat/intersectsextent.js"),o=a("../geom/flat/length.js"),p=a("../geom/flat/segments.js"),q=a("../geom/flat/simplify.js"),r=function(a){function b(b,c){a.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===c||Array.isArray(b[0])?this.setCoordinates(b,c):this.setFlatCoordinates(c,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendCoordinate=function(a){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,a):this.flatCoordinates=a.slice(),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout)},b.prototype.closestPointXY=function(a,b,c,d){return d<(0,f.closestSquaredDistanceXY)(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,j.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,j.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,a,b,c,d))},b.prototype.forEachSegment=function(a){return(0,p.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)},b.prototype.getCoordinateAtM=function(a,b){if(this.layout!=g.default.XYM&&this.layout!=g.default.XYZM)return null;var c=void 0!==b&&b;return(0,m.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,c)},b.prototype.getCoordinates=function(){return(0,l.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getCoordinateAt=function(a,b){return(0,m.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b)},b.prototype.getLength=function(){return(0,o.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[];return c.length=(0,q.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,c,0),new b(c,g.default.XY)},b.prototype.getType=function(){return h.default.LINE_STRING},b.prototype.intersectsExtent=function(a){return(0,n.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,k.deflateCoordinates)(this.flatCoordinates,0,a,this.stride),this.changed()},b}(i.default),s=r;c.default=s},{"../array.js":46,"../extent.js":72,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/SimpleGeometry.js":140,"../geom/flat/closest.js":143,"../geom/flat/deflate.js":145,"../geom/flat/inflate.js":148,"../geom/flat/interpolate.js":150,"../geom/flat/intersectsextent.js":151,"../geom/flat/length.js":152,"../geom/flat/segments.js":155,"../geom/flat/simplify.js":156}],134:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=d(a("../geom/GeometryLayout.js")),g=d(a("../geom/GeometryType.js")),h=d(a("../geom/SimpleGeometry.js")),i=a("../geom/flat/area.js"),j=a("../geom/flat/closest.js"),k=a("../geom/flat/deflate.js"),l=a("../geom/flat/inflate.js"),m=a("../geom/flat/simplify.js"),n=function(a){function b(b,c){a.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===c||Array.isArray(b[0])?this.setCoordinates(b,c):this.setFlatCoordinates(c,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout)},b.prototype.closestPointXY=function(a,b,c,d){return d<(0,e.closestSquaredDistanceXY)(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,j.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,j.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,a,b,c,d))},b.prototype.getArea=function(){return(0,i.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getCoordinates=function(){return(0,l.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[];return c.length=(0,m.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,c,0),new b(c,f.default.XY)},b.prototype.getType=function(){return g.default.LINEAR_RING},b.prototype.intersectsExtent=function(a){},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,k.deflateCoordinates)(this.flatCoordinates,0,a,this.stride),this.changed()},b}(h.default),o=n;c.default=o},{"../extent.js":72,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/SimpleGeometry.js":140,"../geom/flat/area.js":141,"../geom/flat/closest.js":143,"../geom/flat/deflate.js":145,"../geom/flat/inflate.js":148,"../geom/flat/simplify.js":156}],135:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryLayout.js")),h=d(a("../geom/GeometryType.js")),i=d(a("../geom/LineString.js")),j=d(a("../geom/SimpleGeometry.js")),k=a("../geom/flat/closest.js"),l=a("../geom/flat/deflate.js"),m=a("../geom/flat/inflate.js"),n=a("../geom/flat/interpolate.js"),o=a("../geom/flat/intersectsextent.js"),p=a("../geom/flat/simplify.js"),q=function(a){function b(b,c,d){if(a.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(b[0]))this.setCoordinates(b,c);else if(void 0!==c&&d)this.setFlatCoordinates(c,b),this.ends_=d;else{for(var f=this.getLayout(),g=[],h=[],i=0,j=b.length;i<j;++i){var k=b[i];0===i&&(f=k.getLayout()),(0,e.extend)(g,k.getFlatCoordinates()),h.push(g.length)}this.setFlatCoordinates(f,g),this.ends_=h}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendLineString=function(a){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,a.getFlatCoordinates().slice()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},b.prototype.closestPointXY=function(a,b,c,d){return d<(0,f.closestSquaredDistanceXY)(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,k.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,k.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,a,b,c,d))},b.prototype.getCoordinateAtM=function(a,b,c){if(this.layout!=g.default.XYM&&this.layout!=g.default.XYZM||0===this.flatCoordinates.length)return null;var d=void 0!==b&&b,e=void 0!==c&&c;return(0,n.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,a,d,e)},b.prototype.getCoordinates=function(){return(0,m.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)},b.prototype.getEnds=function(){return this.ends_},b.prototype.getLineString=function(a){return a<0||this.ends_.length<=a?null:new i.default(this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]),this.layout)},b.prototype.getLineStrings=function(){for(var a=this.flatCoordinates,b=this.ends_,c=this.layout,d=[],e=0,f=0,g=b.length;f<g;++f){var h=b[f],j=new i.default(a.slice(e,h),c);d.push(j),e=h}return d},b.prototype.getFlatMidpoints=function(){for(var a=[],b=this.flatCoordinates,c=0,d=this.ends_,f=this.stride,g=0,h=d.length;g<h;++g){var i=d[g],j=(0,n.interpolatePoint)(b,c,i,f,.5);(0,e.extend)(a,j),c=i}return a},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[],d=[];return c.length=(0,p.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,a,c,0,d),new b(c,g.default.XY,d)},b.prototype.getType=function(){return h.default.MULTI_LINE_STRING},b.prototype.intersectsExtent=function(a){return(0,o.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]);var c=(0,l.deflateCoordinatesArray)(this.flatCoordinates,0,a,this.stride,this.ends_);this.flatCoordinates.length=0===c.length?0:c[c.length-1],this.changed()},b}(j.default),r=q;c.default=r},{"../array.js":46,"../extent.js":72,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/LineString.js":133,"../geom/SimpleGeometry.js":140,"../geom/flat/closest.js":143,"../geom/flat/deflate.js":145,"../geom/flat/inflate.js":148,"../geom/flat/interpolate.js":150,"../geom/flat/intersectsextent.js":151,"../geom/flat/simplify.js":156}],136:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryType.js")),h=d(a("../geom/Point.js")),i=d(a("../geom/SimpleGeometry.js")),j=a("../geom/flat/deflate.js"),k=a("../geom/flat/inflate.js"),l=a("../math.js"),m=function(a){function b(b,c){a.call(this),c&&!Array.isArray(b[0])?this.setFlatCoordinates(c,b):this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendPoint=function(a){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout)},b.prototype.closestPointXY=function(a,b,c,d){if(d<(0,f.closestSquaredDistanceXY)(this.getExtent(),a,b))return d;for(var e=this.flatCoordinates,g=this.stride,h=0,i=e.length;h<i;h+=g){var j=(0,l.squaredDistance)(a,b,e[h],e[h+1]);if(j<d){d=j;for(var k=0;k<g;++k)c[k]=e[h+k];c.length=g}}return d},b.prototype.getCoordinates=function(){return(0,k.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},b.prototype.getPoint=function(a){var b=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return a<0||b<=a?null:new h.default(this.flatCoordinates.slice(a*this.stride,(a+1)*this.stride),this.layout)},b.prototype.getPoints=function(){for(var a=this.flatCoordinates,b=this.layout,c=this.stride,d=[],e=0,f=a.length;e<f;e+=c){var g=new h.default(a.slice(e,e+c),b);d.push(g)}return d},b.prototype.getType=function(){return g.default.MULTI_POINT},b.prototype.intersectsExtent=function(a){for(var b=this.flatCoordinates,c=this.stride,d=0,e=b.length;d<e;d+=c){var g=b[d],h=b[d+1];if((0,f.containsXY)(a,g,h))return!0}return!1},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,j.deflateCoordinates)(this.flatCoordinates,0,a,this.stride),this.changed()},b}(i.default),n=m;c.default=n},{"../array.js":46,"../extent.js":72,"../geom/GeometryType.js":132,"../geom/Point.js":138,"../geom/SimpleGeometry.js":140,"../geom/flat/deflate.js":145,"../geom/flat/inflate.js":148,"../math.js":199}],137:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../array.js"),f=a("../extent.js"),g=d(a("../geom/GeometryLayout.js")),h=d(a("../geom/GeometryType.js")),i=d(a("../geom/MultiPoint.js")),j=d(a("../geom/Polygon.js")),k=d(a("../geom/SimpleGeometry.js")),l=a("../geom/flat/area.js"),m=a("../geom/flat/center.js"),n=a("../geom/flat/closest.js"),o=a("../geom/flat/contains.js"),p=a("../geom/flat/deflate.js"),q=a("../geom/flat/inflate.js"),r=a("../geom/flat/interiorpoint.js"),s=a("../geom/flat/intersectsextent.js"),t=a("../geom/flat/orient.js"),u=a("../geom/flat/simplify.js"),v=function(a){function b(b,c,d){if(a.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!d&&!Array.isArray(b[0])){for(var f=this.getLayout(),g=[],h=[],i=0,j=b.length;i<j;++i){var k=b[i];0===i&&(f=k.getLayout());for(var l=g.length,m=k.getEnds(),n=0,o=m.length;n<o;++n)m[n]+=l;(0,e.extend)(g,k.getFlatCoordinates()),h.push(m)}c=f,b=g,d=h}void 0!==c&&d?(this.setFlatCoordinates(c,b),this.endss_=d):this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendPolygon=function(a){var b;if(this.flatCoordinates){var c=this.flatCoordinates.length;(0,e.extend)(this.flatCoordinates,a.getFlatCoordinates()),b=a.getEnds().slice();for(var d=0,f=b.length;d<f;++d)b[d]+=c}else this.flatCoordinates=a.getFlatCoordinates().slice(),b=a.getEnds().slice(),this.endss_.push();this.endss_.push(b),this.changed()},b.prototype.clone=function(){for(var a=this,c=this.endss_.length,d=new Array(c),e=0;e<c;++e)d[e]=a.endss_[e].slice();return new b(this.flatCoordinates.slice(),this.layout,d)},b.prototype.closestPointXY=function(a,b,c,d){return d<(0,f.closestSquaredDistanceXY)(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,n.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,n.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,a,b,c,d))},b.prototype.containsXY=function(a,b){return(0,o.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a,b)},b.prototype.getArea=function(){return(0,l.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},b.prototype.getCoordinates=function(a){var b;return void 0!==a?(b=this.getOrientedFlatCoordinates().slice(),(0,t.orientLinearRingsArray)(b,0,this.endss_,this.stride,a)):b=this.flatCoordinates,(0,q.inflateMultiCoordinatesArray)(b,0,this.endss_,this.stride)},b.prototype.getEndss=function(){return this.endss_},b.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var a=(0,m.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,r.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},b.prototype.getInteriorPoints=function(){return new i.default(this.getFlatInteriorPoints().slice(),g.default.XYM)},b.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;(0,t.linearRingsAreOriented)(a,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=(0,t.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[],d=[];return c.length=(0,u.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(a),c,0,d),new b(c,g.default.XY,d)},b.prototype.getPolygon=function(a){if(a<0||this.endss_.length<=a)return null;var b;if(0===a)b=0;else{var c=this.endss_[a-1];b=c[c.length-1]}var d=this.endss_[a].slice(),e=d[d.length-1];if(0!==b)for(var f=0,g=d.length;f<g;++f)d[f]-=b;return new j.default(this.flatCoordinates.slice(b,e),this.layout,d)},b.prototype.getPolygons=function(){for(var a=this.layout,b=this.flatCoordinates,c=this.endss_,d=[],e=0,f=0,g=c.length;f<g;++f){var h=c[f].slice(),i=h[h.length-1];if(0!==e)for(var k=0,l=h.length;k<l;++k)h[k]-=e;var m=new j.default(b.slice(e,i),a,h);d.push(m),e=i}return d},b.prototype.getType=function(){return h.default.MULTI_POLYGON},b.prototype.intersectsExtent=function(a){return(0,s.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,3),this.flatCoordinates||(this.flatCoordinates=[]);var c=(0,p.deflateMultiCoordinatesArray)(this.flatCoordinates,0,a,this.stride,this.endss_);if(0===c.length)this.flatCoordinates.length=0;else{var d=c[c.length-1];this.flatCoordinates.length=0===d.length?0:d[d.length-1]}this.changed()},b}(k.default),w=v;c.default=w},{"../array.js":46,"../extent.js":72,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/MultiPoint.js":136,"../geom/Polygon.js":139,"../geom/SimpleGeometry.js":140,"../geom/flat/area.js":141,"../geom/flat/center.js":142,"../geom/flat/closest.js":143,"../geom/flat/contains.js":144,"../geom/flat/deflate.js":145,"../geom/flat/inflate.js":148,"../geom/flat/interiorpoint.js":149,"../geom/flat/intersectsextent.js":151,"../geom/flat/orient.js":153,"../geom/flat/simplify.js":156}],138:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=d(a("../geom/GeometryType.js")),g=d(a("../geom/SimpleGeometry.js")),h=a("../geom/flat/deflate.js"),i=a("../math.js"),j=function(a){function b(b,c){a.call(this),this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout)},b.prototype.closestPointXY=function(a,b,c,d){var e=this.flatCoordinates,f=(0,i.squaredDistance)(a,b,e[0],e[1]);if(f<d){for(var g=this.stride,h=0;h<g;++h)c[h]=e[h];return c.length=g,f}return d},b.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},b.prototype.computeExtent=function(a){return(0,e.createOrUpdateFromCoordinate)(this.flatCoordinates,a)},b.prototype.getType=function(){return f.default.POINT},b.prototype.intersectsExtent=function(a){return(0,e.containsXY)(a,this.flatCoordinates[0],this.flatCoordinates[1])},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,h.deflateCoordinate)(this.flatCoordinates,0,a,this.stride),this.changed()},b}(g.default),k=j;c.default=k},{"../extent.js":72,"../geom/GeometryType.js":132,"../geom/SimpleGeometry.js":140,"../geom/flat/deflate.js":145,"../math.js":199}],139:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c,d){for(var e=c||32,f=[],g=0;g<e;++g)(0,i.extend)(f,(0,p.offset)(a,b,2*Math.PI*g/e,d));return f.push(f[0],f[1]),new A(f,k.default.XY,[f.length])}function f(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=[b,c,b,e,d,e,d,c,b,c];return new A(f,k.default.XY,[f.length])}function g(a,b,c){for(var d=b||32,e=a.getStride(),f=a.getLayout(),g=a.getCenter(),i=e*(d+1),j=new Array(i),k=0;k<i;k+=e){j[k]=0,j[k+1]=0;for(var l=2;l<e;l++)j[k+l]=g[l]}var m=[j.length],n=new A(j,f,m);return h(n,g,a.getRadius(),c),n}function h(a,b,c,d){for(var e=a.getFlatCoordinates(),f=a.getStride(),g=e.length/f-1,h=d||0,i=0;i<=g;++i){var j=i*f,k=h+2*(0,z.modulo)(i,g)*Math.PI/g;e[j]=b[0]+c*Math.cos(k),e[j+1]=b[1]+c*Math.sin(k)}a.changed()}Object.defineProperty(c,"__esModule",{value:!0}),c.circular=e,c.fromExtent=f,c.fromCircle=g,c.makeRegular=h,c.default=void 0;var i=a("../array.js"),j=a("../extent.js"),k=d(a("../geom/GeometryLayout.js")),l=d(a("../geom/GeometryType.js")),m=d(a("../geom/LinearRing.js")),n=d(a("../geom/Point.js")),o=d(a("../geom/SimpleGeometry.js")),p=a("../sphere.js"),q=a("../geom/flat/area.js"),r=a("../geom/flat/closest.js"),s=a("../geom/flat/contains.js"),t=a("../geom/flat/deflate.js"),u=a("../geom/flat/inflate.js"),v=a("../geom/flat/interiorpoint.js"),w=a("../geom/flat/intersectsextent.js"),x=a("../geom/flat/orient.js"),y=a("../geom/flat/simplify.js"),z=a("../math.js"),A=function(a){function b(b,c,d){a.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==c&&d?(this.setFlatCoordinates(c,b),this.ends_=d):this.setCoordinates(b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.appendLinearRing=function(a){this.flatCoordinates?(0,i.extend)(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},b.prototype.clone=function(){return new b(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},b.prototype.closestPointXY=function(a,b,c,d){return d<(0,j.closestSquaredDistanceXY)(this.getExtent(),a,b)?d:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,r.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,r.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,a,b,c,d))},b.prototype.containsXY=function(a,b){return(0,s.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,b)},b.prototype.getArea=function(){return(0,q.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},b.prototype.getCoordinates=function(a){var b;return void 0!==a?(b=this.getOrientedFlatCoordinates().slice(),(0,x.orientLinearRings)(b,0,this.ends_,this.stride,a)):b=this.flatCoordinates,(0,u.inflateCoordinatesArray)(b,0,this.ends_,this.stride)},b.prototype.getEnds=function(){return this.ends_},b.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var a=(0,j.getCenter)(this.getExtent());this.flatInteriorPoint_=(0,v.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},b.prototype.getInteriorPoint=function(){return new n.default(this.getFlatInteriorPoint(),k.default.XYM)},b.prototype.getLinearRingCount=function(){return this.ends_.length},b.prototype.getLinearRing=function(a){return a<0||this.ends_.length<=a?null:new m.default(this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]),this.layout)},b.prototype.getLinearRings=function(){for(var a=this.layout,b=this.flatCoordinates,c=this.ends_,d=[],e=0,f=0,g=c.length;f<g;++f){var h=c[f],i=new m.default(b.slice(e,h),a);d.push(i),e=h}return d},b.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;(0,x.linearRingIsOriented)(a,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=(0,x.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},b.prototype.getSimplifiedGeometryInternal=function(a){var c=[],d=[];return c.length=(0,y.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(a),c,0,d),new b(c,k.default.XY,d)},b.prototype.getType=function(){return l.default.POLYGON},b.prototype.intersectsExtent=function(a){return(0,w.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a)},b.prototype.setCoordinates=function(a,b){this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]);var c=(0,t.deflateCoordinatesArray)(this.flatCoordinates,0,a,this.stride,this.ends_);this.flatCoordinates.length=0===c.length?0:c[c.length-1],this.changed()},b}(o.default),B=A;c.default=B},{"../array.js":46,"../extent.js":72,"../geom/GeometryLayout.js":131,"../geom/GeometryType.js":132,"../geom/LinearRing.js":134,"../geom/Point.js":138,"../geom/SimpleGeometry.js":140,"../geom/flat/area.js":141,"../geom/flat/closest.js":143,"../geom/flat/contains.js":144,"../geom/flat/deflate.js":145,"../geom/flat/inflate.js":148,"../geom/flat/interiorpoint.js":149,"../geom/flat/intersectsextent.js":151,"../geom/flat/orient.js":153,"../geom/flat/simplify.js":156,"../math.js":199,"../sphere.js":312}],140:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b;return 2==a?b=k.default.XY:3==a?b=k.default.XYZ:4==a&&(b=k.default.XYZM),b}function f(a){var b;return a==k.default.XY?b=2:a==k.default.XYZ||a==k.default.XYM?b=3:a==k.default.XYZM&&(b=4),b}function g(a,b,c){var d=a.getFlatCoordinates();if(d){var e=a.getStride();return(0,l.transform2D)(d,0,d.length,e,b,c)}return null}Object.defineProperty(c,"__esModule",{value:!0}),c.getStrideForLayout=f,c.transformGeom2D=g,c.default=void 0;var h=a("../functions.js"),i=a("../extent.js"),j=d(a("../geom/Geometry.js")),k=d(a("../geom/GeometryLayout.js")),l=a("../geom/flat/transform.js"),m=a("../obj.js"),n=function(a){function b(){a.call(this),this.layout=k.default.XY,this.stride=2,this.flatCoordinates=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.computeExtent=function(a){return(0,i.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)},b.prototype.getCoordinates=function(){},b.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},b.prototype.getFlatCoordinates=function(){return this.flatCoordinates},b.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},b.prototype.getLayout=function(){return this.layout},b.prototype.getSimplifiedGeometry=function(a){if(this.simplifiedGeometryRevision!=this.getRevision()&&((0,m.clear)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),a<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var b=a.toString();if(this.simplifiedGeometryCache.hasOwnProperty(b))return this.simplifiedGeometryCache[b];var c=this.getSimplifiedGeometryInternal(a);return c.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[b]=c,c):(this.simplifiedGeometryMaxMinSquaredTolerance=a,this)},b.prototype.getSimplifiedGeometryInternal=function(a){return this},b.prototype.getStride=function(){return this.stride},b.prototype.setFlatCoordinates=function(a,b){this.stride=f(a),this.layout=a,this.flatCoordinates=b},b.prototype.setCoordinates=function(a,b){},b.prototype.setLayout=function(a,b,c){var d,g=this;if(a)d=f(a);else{for(var h=0;h<c;++h){if(0===b.length)return g.layout=k.default.XY,void(g.stride=2);b=b[0]}d=b.length,a=e(d)}this.layout=a,this.stride=d},b.prototype.applyTransform=function(a){this.flatCoordinates&&(a(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},b.prototype.rotate=function(a,b){
var c=this.getFlatCoordinates();if(c){var d=this.getStride();(0,l.rotate)(c,0,c.length,d,a,b,c),this.changed()}},b.prototype.scale=function(a,b,c){var d=b;void 0===d&&(d=a);var e=c;e||(e=(0,i.getCenter)(this.getExtent()));var f=this.getFlatCoordinates();if(f){var g=this.getStride();(0,l.scale)(f,0,f.length,g,a,d,e,f),this.changed()}},b.prototype.translate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();(0,l.translate)(c,0,c.length,d,a,b,c),this.changed()}},b}(j.default);n.prototype.containsXY=h.FALSE;var o=n;c.default=o},{"../extent.js":72,"../functions.js":126,"../geom/Geometry.js":129,"../geom/GeometryLayout.js":131,"../geom/flat/transform.js":160,"../obj.js":201}],141:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];b<c;b+=d){var h=a[b],i=a[b+1];e+=g*h-f*i,f=h,g=i}return e/2}function e(a,b,c,e){for(var f=0,g=0,h=c.length;g<h;++g){var i=c[g];f+=d(a,b,i,e),b=i}return f}function f(a,b,c,d){for(var f=0,g=0,h=c.length;g<h;++g){var i=c[g];f+=e(a,b,i,d),b=i[i.length-1]}return f}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRing=d,c.linearRings=e,c.linearRingss=f},{}],142:[function(a,b,c){"use strict";function d(a,b,c,d){for(var f=[],g=(0,e.createEmpty)(),h=0,i=c.length;h<i;++h){var j=c[h];g=(0,e.createOrUpdateFromFlatCoordinates)(a,b,j[0],d),f.push((g[0]+g[2])/2,(g[1]+g[3])/2),b=j[j.length-1]}return f}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRingss=d;var e=a("../../extent.js")},{"../../extent.js":72}],143:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){var h,i=a[b],j=a[b+1],l=a[c]-i,m=a[c+1]-j;if(0===l&&0===m)h=b;else{var n=((e-i)*l+(f-j)*m)/(l*l+m*m);if(n>1)h=c;else{if(n>0){for(var o=0;o<d;++o)g[o]=(0,k.lerp)(a[b+o],a[c+o],n);return void(g.length=d)}h=b}}for(var p=0;p<d;++p)g[p]=a[h+p];g.length=d}function e(a,b,c,d,e){var f=a[b],g=a[b+1];for(b+=d;b<c;b+=d){var h=a[b],i=a[b+1],j=(0,k.squaredDistance)(f,g,h,i);j>e&&(e=j),f=h,g=i}return e}function f(a,b,c,d,f){for(var g=0,h=c.length;g<h;++g){var i=c[g];f=e(a,b,i,d,f),b=i}return f}function g(a,b,c,d,e){for(var g=0,h=c.length;g<h;++g){var i=c[g];e=f(a,b,i,d,e),b=i[i.length-1]}return e}function h(a,b,c,e,f,g,h,i,j,l,m){if(b==c)return l;var n,o;if(0===f){if((o=(0,k.squaredDistance)(h,i,a[b],a[b+1]))<l){for(n=0;n<e;++n)j[n]=a[b+n];return j.length=e,o}return l}for(var p=m||[NaN,NaN],q=b+e;q<c;)if(d(a,q-e,q,e,h,i,p),(o=(0,k.squaredDistance)(h,i,p[0],p[1]))<l){for(l=o,n=0;n<e;++n)j[n]=p[n];j.length=e,q+=e}else q+=e*Math.max((Math.sqrt(o)-Math.sqrt(l))/f|0,1);if(g&&(d(a,c-e,b,e,h,i,p),(o=(0,k.squaredDistance)(h,i,p[0],p[1]))<l)){for(l=o,n=0;n<e;++n)j[n]=p[n];j.length=e}return l}function i(a,b,c,d,e,f,g,i,j,k,l){for(var m=l||[NaN,NaN],n=0,o=c.length;n<o;++n){var p=c[n];k=h(a,b,p,d,e,f,g,i,j,k,m),b=p}return k}function j(a,b,c,d,e,f,g,h,j,k,l){for(var m=l||[NaN,NaN],n=0,o=c.length;n<o;++n){var p=c[n];k=i(a,b,p,d,e,f,g,h,j,k,m),b=p[p.length-1]}return k}Object.defineProperty(c,"__esModule",{value:!0}),c.maxSquaredDelta=e,c.arrayMaxSquaredDelta=f,c.multiArrayMaxSquaredDelta=g,c.assignClosestPoint=h,c.assignClosestArrayPoint=i,c.assignClosestMultiArrayPoint=j;var k=a("../../math.js")},{"../../math.js":199}],144:[function(a,b,c){"use strict";function d(a,b,c,d,f){return!(0,h.forEachCorner)(f,function(f){return!e(a,b,c,d,f[0],f[1])})}function e(a,b,c,d,e,f){for(var g=0,h=a[c-d],i=a[c-d+1];b<c;b+=d){var j=a[b],k=a[b+1];i<=f?k>f&&(j-h)*(f-i)-(e-h)*(k-i)>0&&g++:k<=f&&(j-h)*(f-i)-(e-h)*(k-i)<0&&g--,h=j,i=k}return 0!==g}function f(a,b,c,d,f,g){if(0===c.length)return!1;if(!e(a,b,c[0],d,f,g))return!1;for(var h=1,i=c.length;h<i;++h)if(e(a,c[h-1],c[h],d,f,g))return!1;return!0}function g(a,b,c,d,e,g){if(0===c.length)return!1;for(var h=0,i=c.length;h<i;++h){var j=c[h];if(f(a,b,j,d,e,g))return!0;b=j[j.length-1]}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRingContainsExtent=d,c.linearRingContainsXY=e,c.linearRingsContainsXY=f,c.linearRingssContainsXY=g;var h=a("../../extent.js")},{"../../extent.js":72}],145:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=0,f=c.length;e<f;++e)a[b++]=c[e];return b}function e(a,b,c,d){for(var e=0,f=c.length;e<f;++e)for(var g=c[e],h=0;h<d;++h)a[b++]=g[h];return b}function f(a,b,c,d,f){for(var g=f||[],h=0,i=0,j=c.length;i<j;++i){var k=e(a,b,c[i],d);g[h++]=k,b=k}return g.length=h,g}function g(a,b,c,d,e){for(var g=e||[],h=0,i=0,j=c.length;i<j;++i){var k=f(a,b,c[i],d,g[h]);g[h++]=k,b=k[k.length-1]}return g.length=h,g}Object.defineProperty(c,"__esModule",{value:!0}),c.deflateCoordinate=d,c.deflateCoordinates=e,c.deflateCoordinatesArray=f,c.deflateMultiCoordinatesArray=g},{}],146:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){var g,h;void 0!==e?(g=e,h=void 0!==f?f:0):(g=[],h=0);for(var i=b;i<c;){var j=a[i++];g[h++]=a[i++],g[h++]=j;for(var k=2;k<d;++k)g[h++]=a[i++]}return g.length=h,g}Object.defineProperty(c,"__esModule",{value:!0}),c.flipXY=d},{}],147:[function(a,b,c){"use strict";function d(a,b,c){for(var d,e,f,g,i,j,k=[],l=a(0),m=a(1),n=b(l),o=b(m),p=[m,l],q=[o,n],r=[1,0],s={},t=1e5;--t>0&&r.length>0;)f=r.pop(),l=p.pop(),n=q.pop(),j=f.toString(),j in s||(k.push(n[0],n[1]),s[j]=!0),g=r.pop(),m=p.pop(),o=q.pop(),i=(f+g)/2,d=a(i),e=b(d),(0,h.squaredSegmentDistance)(e[0],e[1],n[0],n[1],o[0],o[1])<c?(k.push(o[0],o[1]),j=g.toString(),s[j]=!0):(r.push(g,i,i,f),q.push(o,e,e,n),p.push(m,d,d,l));return k}function e(a,b,c,e,f,g){var j=(0,i.get)("EPSG:4326"),k=Math.cos((0,h.toRadians)(b)),l=Math.sin((0,h.toRadians)(b)),m=Math.cos((0,h.toRadians)(e)),n=Math.sin((0,h.toRadians)(e)),o=Math.cos((0,h.toRadians)(c-a)),p=Math.sin((0,h.toRadians)(c-a)),q=l*n+k*m*o;return d(function(b){if(1<=q)return[c,e];var d=b*Math.acos(q),f=Math.cos(d),g=Math.sin(d),i=p*m,j=k*n-l*m*o,r=Math.atan2(i,j),s=Math.asin(l*f+k*g*Math.cos(r)),t=(0,h.toRadians)(a)+Math.atan2(Math.sin(r)*g*k,f-l*Math.sin(s));return[(0,h.toDegrees)(t),(0,h.toDegrees)(s)]},(0,i.getTransform)(j,f),g)}function f(a,b,c,e,f){var g=(0,i.get)("EPSG:4326");return d(function(d){return[a,b+(c-b)*d]},(0,i.getTransform)(g,e),f)}function g(a,b,c,e,f){var g=(0,i.get)("EPSG:4326");return d(function(d){return[b+(c-b)*d,a]},(0,i.getTransform)(g,e),f)}Object.defineProperty(c,"__esModule",{value:!0}),c.greatCircleArc=e,c.meridian=f,c.parallel=g;var h=a("../../math.js"),i=a("../../proj.js")},{"../../math.js":199,"../../proj.js":210}],148:[function(a,b,c){"use strict";function d(a,b,c,d,e){for(var f=void 0!==e?e:[],g=0,h=b;h<c;h+=d)f[g++]=a.slice(h,h+d);return f.length=g,f}function e(a,b,c,e,f){for(var g=void 0!==f?f:[],h=0,i=0,j=c.length;i<j;++i){var k=c[i];g[h++]=d(a,b,k,e,g[h]),b=k}return g.length=h,g}function f(a,b,c,d,f){for(var g=void 0!==f?f:[],h=0,i=0,j=c.length;i<j;++i){var k=c[i];g[h++]=e(a,b,k,d,g[h]),b=k[k.length-1]}return g.length=h,g}Object.defineProperty(c,"__esModule",{value:!0}),c.inflateCoordinates=d,c.inflateCoordinatesArray=e,c.inflateMultiCoordinatesArray=f},{}],149:[function(a,b,c){"use strict";function d(a,b,c,d,e,h,i){for(var j,k,l,m,n,o,p,q=e[h+1],r=[],s=0,t=c.length;s<t;++s){var u=c[s];for(m=a[u-d],o=a[u-d+1],j=b;j<u;j+=d)n=a[j],p=a[j+1],(q<=o&&p<=q||o<=q&&q<=p)&&(l=(q-o)/(p-o)*(n-m)+m,r.push(l)),m=n,o=p}var v=NaN,w=-1/0;for(r.sort(f.numberSafeCompareFunction),m=r[0],j=1,k=r.length;j<k;++j){n=r[j];var x=Math.abs(n-m);x>w&&(l=(m+n)/2,(0,g.linearRingsContainsXY)(a,b,c,d,l,q)&&(v=l,w=x)),m=n}return isNaN(v)&&(v=e[h]),i?(i.push(v,q,w),i):[v,q,w]}function e(a,b,c,e,f){for(var g=[],h=0,i=c.length;h<i;++h){var j=c[h];g=d(a,b,j,e,f,2*h,g),b=j[j.length-1]}return g}Object.defineProperty(c,"__esModule",{value:!0}),c.getInteriorPointOfArray=d,c.getInteriorPointsOfMultiArray=e;var f=a("../../array.js"),g=a("../flat/contains.js")},{"../../array.js":46,"../flat/contains.js":144}],150:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){var i=NaN,j=NaN,k=(c-b)/d;if(1===k)i=a[b],j=a[b+1];else if(2==k)i=(1-e)*a[b]+e*a[b+d],j=(1-e)*a[b+1]+e*a[b+d+1];else if(0!==k){for(var l=a[b],m=a[b+1],n=0,o=[0],p=b+d;p<c;p+=d){var q=a[p],r=a[p+1];n+=Math.sqrt((q-l)*(q-l)+(r-m)*(r-m)),o.push(n),l=q,m=r}var s=e*n,t=(0,g.binarySearch)(o,s);if(t<0){var u=(s-o[-t-2])/(o[-t-1]-o[-t-2]),v=b+(-t-2)*d;i=(0,h.lerp)(a[v],a[v+d],u),j=(0,h.lerp)(a[v+1],a[v+d+1],u)}else i=a[b+t*d],j=a[b+t*d+1]}return f?(f[0]=i,f[1]=j,f):[i,j]}function e(a,b,c,d,e,f){if(c==b)return null;var g;if(e<a[b+d-1])return f?(g=a.slice(b,b+d),g[d-1]=e,g):null;if(a[c-1]<e)return f?(g=a.slice(c-d,c),g[d-1]=e,g):null;if(e==a[b+d-1])return a.slice(b,b+d);for(var i=b/d,j=c/d;i<j;){var k=i+j>>1;e<a[(k+1)*d-1]?j=k:i=k+1}var l=a[i*d-1];if(e==l)return a.slice((i-1)*d,(i-1)*d+d);var m=a[(i+1)*d-1],n=(e-l)/(m-l);g=[];for(var o=0;o<d-1;++o)g.push((0,h.lerp)(a[(i-1)*d+o],a[i*d+o],n));return g.push(e),g}function f(a,b,c,d,f,g,h){if(h)return e(a,b,c[c.length-1],d,f,g);var i;if(f<a[d-1])return g?(i=a.slice(0,d),i[d-1]=f,i):null;if(a[a.length-1]<f)return g?(i=a.slice(a.length-d),i[d-1]=f,i):null;for(var j=0,k=c.length;j<k;++j){var l=c[j];if(b!=l){if(f<a[b+d-1])return null;if(f<=a[l-1])return e(a,b,l,d,f,!1);b=l}}return null}Object.defineProperty(c,"__esModule",{value:!0}),c.interpolatePoint=d,c.lineStringCoordinateAtM=e,c.lineStringsCoordinateAtM=f;var g=a("../../array.js"),h=a("../../math.js")},{"../../array.js":46,"../../math.js":199}],151:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=(0,i.extendFlatCoordinates)((0,i.createEmpty)(),a,b,c,d);return!!(0,i.intersects)(e,f)&&(!!(0,i.containsExtent)(e,f)||(f[0]>=e[0]&&f[2]<=e[2]||(f[1]>=e[1]&&f[3]<=e[3]||(0,k.forEach)(a,b,c,d,function(a,b){return(0,i.intersectsSegment)(e,a,b)}))))}function e(a,b,c,e,f){for(var g=0,h=c.length;g<h;++g){if(d(a,b,c[g],e,f))return!0;b=c[g]}return!1}function f(a,b,c,e,f){return!!d(a,b,c,e,f)||(!!(0,j.linearRingContainsXY)(a,b,c,e,f[0],f[1])||(!!(0,j.linearRingContainsXY)(a,b,c,e,f[0],f[3])||(!!(0,j.linearRingContainsXY)(a,b,c,e,f[2],f[1])||!!(0,j.linearRingContainsXY)(a,b,c,e,f[2],f[3]))))}function g(a,b,c,d,e){if(!f(a,b,c[0],d,e))return!1;if(1===c.length)return!0;for(var g=1,h=c.length;g<h;++g)if((0,j.linearRingContainsExtent)(a,c[g-1],c[g],d,e))return!1;return!0}function h(a,b,c,d,e){for(var f=0,h=c.length;f<h;++f){var i=c[f];if(g(a,b,i,d,e))return!0;b=i[i.length-1]}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.intersectsLineString=d,c.intersectsLineStringArray=e,c.intersectsLinearRing=f,c.intersectsLinearRingArray=g,c.intersectsLinearRingMultiArray=h;var i=a("../../extent.js"),j=a("../flat/contains.js"),k=a("../flat/segments.js")},{"../../extent.js":72,"../flat/contains.js":144,"../flat/segments.js":155}],152:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=a[b],f=a[b+1],g=0,h=b+d;h<c;h+=d){var i=a[h],j=a[h+1];g+=Math.sqrt((i-e)*(i-e)+(j-f)*(j-f)),e=i,f=j}return g}function e(a,b,c,e){var f=d(a,b,c,e),g=a[c-e]-a[b],h=a[c-e+1]-a[b+1];return f+=Math.sqrt(g*g+h*h)}Object.defineProperty(c,"__esModule",{value:!0}),c.lineStringLength=d,c.linearRingLength=e},{}],153:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];b<c;b+=d){var h=a[b],i=a[b+1];e+=(h-f)*(i+g),f=h,g=i}return e>0}function e(a,b,c,e,f){for(var g=void 0!==f&&f,h=0,i=c.length;h<i;++h){var j=c[h],k=d(a,b,j,e);if(0===h){if(g&&k||!g&&!k)return!1}else if(g&&!k||!g&&k)return!1;b=j}return!0}function f(a,b,c,d,f){for(var g=0,h=c.length;g<h;++g)if(!e(a,b,c[g],d,f))return!1;return!0}function g(a,b,c,e,f){for(var g=void 0!==f&&f,h=0,j=c.length;h<j;++h){var k=c[h],l=d(a,b,k,e);(0===h?g&&l||!g&&!l:g&&!l||!g&&l)&&(0,i.coordinates)(a,b,k,e),b=k}return b}function h(a,b,c,d,e){for(var f=0,h=c.length;f<h;++f)b=g(a,b,c[f],d,e);return b}Object.defineProperty(c,"__esModule",{value:!0}),c.linearRingIsClockwise=d,c.linearRingIsOriented=e,c.linearRingsAreOriented=f,c.orientLinearRings=g,c.orientLinearRingsArray=h;var i=a("../flat/reverse.js")},{"../flat/reverse.js":154}],154:[function(a,b,c){"use strict";function d(a,b,c,d){for(;b<c-d;){for(var e=0;e<d;++e){var f=a[b+e];a[b+e]=a[c-d+e],a[c-d+e]=f}b+=d,c-=d}}Object.defineProperty(c,"__esModule",{value:!0}),c.coordinates=d},{}],155:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){for(var g,h=[a[b],a[b+1]],i=[];b+d<c;b+=d){if(i[0]=a[b+d],i[1]=a[b+d+1],g=e.call(f,h,i))return g;h[0]=i[0],h[1]=i[1]}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.forEach=d},{}],156:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,i){var j=void 0!==i?i:[];return g||(c=h(a,b,c,d,f,j,0),a=j,b=0,d=2),j.length=e(a,b,c,d,f,j,0),j}function e(a,b,c,d,e,f,g){var h=(c-b)/d;if(h<3){for(;b<c;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var i=new Array(h);i[0]=1,i[h-1]=1;for(var j=[b,c-d],k=0;j.length>0;){for(var l=j.pop(),n=j.pop(),o=0,p=a[n],q=a[n+1],r=a[l],s=a[l+1],t=n+d;t<l;t+=d){var u=a[t],v=a[t+1],w=(0,m.squaredSegmentDistance)(u,v,p,q,r,s);w>o&&(k=t,o=w)}o>e&&(i[(k-b)/d]=1,n+d<k&&j.push(n,k),k+d<l&&j.push(k,l))}for(var x=0;x<h;++x)i[x]&&(f[g++]=a[b+x*d],f[g++]=a[b+x*d+1]);return g}function f(a,b,c,d,f,g,h,i){for(var j=0,k=c.length;j<k;++j){var l=c[j];h=e(a,b,l,d,f,g,h),i.push(h),b=l}return h}function g(a,b,c,d,e,g,h,i){for(var j=0,k=c.length;j<k;++j){var l=c[j],m=[];h=f(a,b,l,d,e,g,h,m),i.push(m),b=l[l.length-1]}return h}function h(a,b,c,d,e,f,g){if(c<=b+d){for(;b<c;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var h=a[b],i=a[b+1];f[g++]=h,f[g++]=i;var j=h,k=i;for(b+=d;b<c;b+=d)j=a[b],k=a[b+1],(0,m.squaredDistance)(h,i,j,k)>e&&(f[g++]=j,f[g++]=k,h=j,i=k);return j==h&&k==i||(f[g++]=j,f[g++]=k),g}function i(a,b){return b*Math.round(a/b)}function j(a,b,c,d,e,f,g){if(b==c)return g;var h=i(a[b],e),j=i(a[b+1],e);b+=d,f[g++]=h,f[g++]=j;var k,l;do{if(k=i(a[b],e),l=i(a[b+1],e),(b+=d)==c)return f[g++]=k,f[g++]=l,g}while(k==h&&l==j);for(;b<c;){var m=i(a[b],e),n=i(a[b+1],e);if(b+=d,m!=k||n!=l){var o=k-h,p=l-j,q=m-h,r=n-j;o*r==p*q&&(o<0&&q<o||o==q||o>0&&q>o)&&(p<0&&r<p||p==r||p>0&&r>p)?(k=m,l=n):(f[g++]=k,f[g++]=l,h=k,j=l,k=m,l=n)}}return f[g++]=k,f[g++]=l,g}function k(a,b,c,d,e,f,g,h){for(var i=0,k=c.length;i<k;++i){var l=c[i];g=j(a,b,l,d,e,f,g),h.push(g),b=l}return g}function l(a,b,c,d,e,f,g,h){for(var i=0,j=c.length;i<j;++i){var l=c[i],m=[];g=k(a,b,l,d,e,f,g,m),h.push(m),b=l[l.length-1]}return g}Object.defineProperty(c,"__esModule",{value:!0}),c.simplifyLineString=d,c.douglasPeucker=e,c.douglasPeuckerArray=f,c.douglasPeuckerMultiArray=g,c.radialDistance=h,c.snap=i,c.quantize=j,c.quantizeArray=k,c.quantizeMultiArray=l;var m=a("../../math.js")},{"../../math.js":199}],157:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=c,p=c,q=0,r=0,s=c;for(f=c;f<d;f+=e){var t=b[f],u=b[f+1];void 0!==i&&(m=t-i,n=u-j,h=Math.sqrt(m*m+n*n),void 0!==k&&(r+=g,Math.acos((k*m+l*n)/(g*h))>a&&(r>q&&(q=r,o=s,p=f),r=0,s=f-e)),g=h,k=m,l=n),i=t,j=u}return r+=h,r>q?[s,f]:[o,p]}Object.defineProperty(c,"__esModule",{value:!0}),c.matchingChunk=d},{}],158:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i){var j=[],k=a[b]>a[c-d],l=f.length,m=a[b],n=a[b+1];b+=d;for(var o,p,q,r=a[b],s=a[b+1],t=0,u=Math.sqrt(Math.pow(r-m,2)+Math.pow(s-n,2)),v="",w=0,x=0;x<l;++x){p=k?l-x-1:x;var y=f.charAt(p);v=k?y+v:v+y;var z=g(v)-w;w+=z;for(var A=h+z/2;b<c-d&&t+u<A;)m=r,n=s,b+=d,r=a[b],s=a[b+1],t+=u,u=Math.sqrt(Math.pow(r-m,2)+Math.pow(s-n,2));var B=A-t,C=Math.atan2(s-n,r-m);if(k&&(C+=C>0?-Math.PI:Math.PI),void 0!==q){var D=C-q;if(D+=D>Math.PI?-2*Math.PI:D<-Math.PI?2*Math.PI:0,Math.abs(D)>i)return null}var E=B/u,F=(0,e.lerp)(m,r,E),G=(0,e.lerp)(n,s,E);q==C?(k&&(o[0]=F,o[1]=G,o[2]=z/2),o[4]=v):(v=y,w=z,o=[F,G,z/2,C,v],k?j.unshift(o):j.push(o),q=C),h+=z}return j}Object.defineProperty(c,"__esModule",{value:!0}),c.drawTextOnPath=d;var e=a("../../math.js")},{"../../math.js":199}],159:[function(a,b,c){"use strict";function d(a,b,c,d){var f=c-d;return a[b]===a[f]&&a[b+1]===a[f+1]&&(c-b)/d>3&&!!(0,e.linearRing)(a,b,c,d)}Object.defineProperty(c,"__esModule",{value:!0}),c.lineStringIsClosed=d;var e=a("../flat/area.js")},{"../flat/area.js":141}],160:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){for(var g=f||[],h=0,i=b;i<c;i+=d){var j=a[i],k=a[i+1];g[h++]=e[0]*j+e[2]*k+e[4],g[h++]=e[1]*j+e[3]*k+e[5]}return f&&g.length!=h&&(g.length=h),g}function e(a,b,c,d,e,f,g){for(var h=g||[],i=Math.cos(e),j=Math.sin(e),k=f[0],l=f[1],m=0,n=b;n<c;n+=d){var o=a[n]-k,p=a[n+1]-l;h[m++]=k+o*i-p*j,h[m++]=l+o*j+p*i;for(var q=n+2;q<n+d;++q)h[m++]=a[q]}return g&&h.length!=m&&(h.length=m),h}function f(a,b,c,d,e,f,g,h){for(var i=h||[],j=g[0],k=g[1],l=0,m=b;m<c;m+=d){var n=a[m]-j,o=a[m+1]-k;i[l++]=j+e*n,i[l++]=k+f*o;for(var p=m+2;p<m+d;++p)i[l++]=a[p]}return h&&i.length!=l&&(i.length=l),i}function g(a,b,c,d,e,f,g){for(var h=g||[],i=0,j=b;j<c;j+=d){h[i++]=a[j]+e,h[i++]=a[j+1]+f;for(var k=j+2;k<j+d;++k)h[i++]=a[k]}return g&&h.length!=i&&(h.length=i),h}Object.defineProperty(c,"__esModule",{value:!0}),c.transform2D=d,c.rotate=e,c.scale=f,c.translate=g},{}],161:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"WEBGL",{enumerable:!0,get:function(){return d.HAS}}),c.MSPOINTER=c.POINTER=c.TOUCH=c.GEOLOCATION=c.CANVAS_LINE_DASH=c.DEVICE_PIXEL_RATIO=c.MAC=c.WEBKIT=c.SAFARI=c.FIREFOX=void 0;var d=a("./webgl.js"),e="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",f=-1!==e.indexOf("firefox");c.FIREFOX=f;var g=-1!==e.indexOf("safari")&&-1==e.indexOf("chrom");c.SAFARI=g;var h=-1!==e.indexOf("webkit")&&-1==e.indexOf("edge");c.WEBKIT=h;var i=-1!==e.indexOf("macintosh");c.MAC=i;var j=window.devicePixelRatio||1;c.DEVICE_PIXEL_RATIO=j;var k=function(){var a=!1;try{a=!!document.createElement("canvas").getContext("2d").setLineDash}catch(a){}return a}();c.CANVAS_LINE_DASH=k;var l="geolocation"in navigator;c.GEOLOCATION=l;var m="ontouchstart"in window;c.TOUCH=m;var n="PointerEvent"in window;c.POINTER=n;var o=!!navigator.msPointerEnabled;c.MSPOINTER=o},{"./webgl.js":344}],162:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"AssertionError",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Collection",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Disposable",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Feature",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Geolocation",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"Graticule",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"ImageBase",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"ImageCanvas",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"ImageTile",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"Kinetic",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"Map",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"MapBrowserEvent",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(c,"MapBrowserEventHandler",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"MapBrowserPointerEvent",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"MapEvent",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(c,"Object",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(c,"Observable",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(c,"Overlay",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(c,"PluggableMap",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(c,"Tile",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(c,"TileCache",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(c,"TileQueue",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(c,"TileRange",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(c,"VectorImageTile",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(c,"VectorTile",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(c,"View",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(c,"WebGLMap",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(c,"getUid",{enumerable:!0,get:function(){return G.getUid}}),Object.defineProperty(c,"inherits",{enumerable:!0,get:function(){return G.inherits}}),Object.defineProperty(c,"VERSION",{enumerable:!0,get:function(){return G.VERSION}});var e=d(a("./AssertionError.js")),f=d(a("./Collection.js")),g=d(a("./Disposable.js")),h=d(a("./Feature.js")),i=d(a("./Geolocation.js")),j=d(a("./Graticule.js")),k=d(a("./Image.js")),l=d(a("./ImageBase.js")),m=d(a("./ImageCanvas.js")),n=d(a("./ImageTile.js")),o=d(a("./Kinetic.js")),p=d(a("./Map.js")),q=d(a("./MapBrowserEvent.js")),r=d(a("./MapBrowserEventHandler.js")),s=d(a("./MapBrowserPointerEvent.js")),t=d(a("./MapEvent.js")),u=d(a("./Object.js")),v=d(a("./Observable.js")),w=d(a("./Overlay.js")),x=d(a("./PluggableMap.js")),y=d(a("./Tile.js")),z=d(a("./TileCache.js")),A=d(a("./TileQueue.js")),B=d(a("./TileRange.js")),C=d(a("./VectorImageTile.js")),D=d(a("./VectorTile.js")),E=d(a("./View.js")),F=d(a("./WebGLMap.js")),G=a("./util.js")},{"./AssertionError.js":6,"./Collection.js":7,"./Disposable.js":9,"./Feature.js":10,"./Geolocation.js":11,"./Graticule.js":13,"./Image.js":14,"./ImageBase.js":15,"./ImageCanvas.js":16,"./ImageTile.js":18,"./Kinetic.js":19,"./Map.js":21,"./MapBrowserEvent.js":22,"./MapBrowserEventHandler.js":23,"./MapBrowserPointerEvent.js":25,"./MapEvent.js":26,"./Object.js":29,"./Observable.js":31,"./Overlay.js":32,"./PluggableMap.js":34,"./Tile.js":35,"./TileCache.js":36,"./TileQueue.js":37,"./TileRange.js":38,"./VectorImageTile.js":40,"./VectorTile.js":41,"./View.js":42,"./WebGLMap.js":45,"./util.js":342}],163:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=a||{},c=new f.default,d=new g.default(-.005,.05,100);return(void 0===b.altShiftDragRotate||b.altShiftDragRotate)&&c.push(new j.default),(void 0===b.doubleClickZoom||b.doubleClickZoom)&&c.push(new h.default({delta:b.zoomDelta,duration:b.zoomDuration})),(void 0===b.dragPan||b.dragPan)&&c.push(new i.default({condition:b.onFocusOnly?q.focus:void 0,kinetic:d})),(void 0===b.pinchRotate||b.pinchRotate)&&c.push(new o.default),(void 0===b.pinchZoom||b.pinchZoom)&&c.push(new p.default({constrainResolution:b.constrainResolution,duration:b.zoomDuration})),(void 0===b.keyboard||b.keyboard)&&(c.push(new l.default),c.push(new m.default({delta:b.zoomDelta,duration:b.zoomDuration}))),(void 0===b.mouseWheelZoom||b.mouseWheelZoom)&&c.push(new n.default({condition:b.onFocusOnly?q.focus:void 0,constrainResolution:b.constrainResolution,duration:b.zoomDuration})),(void 0===b.shiftDragZoom||b.shiftDragZoom)&&c.push(new k.default({duration:b.zoomDuration})),c}Object.defineProperty(c,"__esModule",{value:!0}),c.defaults=e,Object.defineProperty(c,"DoubleClickZoom",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"DragPan",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"DragRotate",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"DragZoom",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"KeyboardPan",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"KeyboardZoom",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"MouseWheelZoom",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"PinchRotate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"PinchZoom",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"DragAndDrop",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"DragBox",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"DragRotateAndZoom",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(c,"Draw",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(c,"Extent",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(c,"Interaction",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(c,"Modify",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(c,"Pointer",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(c,"Select",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(c,"Snap",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(c,"Translate",{enumerable:!0,get:function(){return B.default}});var f=d(a("./Collection.js")),g=d(a("./Kinetic.js")),h=d(a("./interaction/DoubleClickZoom.js")),i=d(a("./interaction/DragPan.js")),j=d(a("./interaction/DragRotate.js")),k=d(a("./interaction/DragZoom.js")),l=d(a("./interaction/KeyboardPan.js")),m=d(a("./interaction/KeyboardZoom.js")),n=d(a("./interaction/MouseWheelZoom.js")),o=d(a("./interaction/PinchRotate.js")),p=d(a("./interaction/PinchZoom.js")),q=a("./events/condition.js"),r=d(a("./interaction/DragAndDrop.js")),s=d(a("./interaction/DragBox.js")),t=d(a("./interaction/DragRotateAndZoom.js")),u=d(a("./interaction/Draw.js")),v=d(a("./interaction/Extent.js")),w=d(a("./interaction/Interaction.js")),x=d(a("./interaction/Modify.js")),y=d(a("./interaction/Pointer.js")),z=d(a("./interaction/Select.js")),A=d(a("./interaction/Snap.js")),B=d(a("./interaction/Translate.js"))},{"./Collection.js":7,"./Kinetic.js":19,"./events/condition.js":71,"./interaction/DoubleClickZoom.js":164,"./interaction/DragAndDrop.js":165,"./interaction/DragBox.js":166,"./interaction/DragPan.js":167,"./interaction/DragRotate.js":168,"./interaction/DragRotateAndZoom.js":169,"./interaction/DragZoom.js":170,"./interaction/Draw.js":171,"./interaction/Extent.js":172,"./interaction/Interaction.js":173,"./interaction/KeyboardPan.js":174,"./interaction/KeyboardZoom.js":175,"./interaction/Modify.js":176,"./interaction/MouseWheelZoom.js":177,"./interaction/PinchRotate.js":178,"./interaction/PinchZoom.js":179,"./interaction/Pointer.js":180,"./interaction/Select.js":182,"./interaction/Snap.js":183,"./interaction/Translate.js":184}],164:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=!1,c=a.originalEvent;if(a.type==g.default.DBLCLICK){var d=a.map,e=a.coordinate,f=c.shiftKey?-this.delta_:this.delta_,i=d.getView();(0,h.zoomByDelta)(i,f,e,this.duration_),a.preventDefault(),b=!0}return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=e(a("../MapBrowserEventType.js")),h=d(a("../interaction/Interaction.js")),i=function(a){function b(b){a.call(this,{handleEvent:f});var c=b||{};this.delta_=c.delta?c.delta:1,this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default),j=i;c.default=j},{"../MapBrowserEventType.js":24,"../interaction/Interaction.js":173}],165:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){for(var b=this,c=a.dataTransfer.files,d=0,e=c.length;d<e;++d){var f=c.item(d),g=new FileReader;g.addEventListener(j.default.LOAD,b.handleResult_.bind(b,f)),g.readAsText(f)}}function f(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=a("../functions.js"),h=a("../events.js"),i=d(a("../events/Event.js")),j=d(a("../events/EventType.js")),k=d(a("../interaction/Interaction.js")),l=a("../proj.js"),m={ADD_FEATURES:"addfeatures"},n=function(a){function b(b,c,d,e){a.call(this,b),this.features=d,this.file=c,this.projection=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),o=function(a){function b(b){var c=b||{};a.call(this,{handleEvent:g.TRUE}),this.formatConstructors_=c.formatConstructors?c.formatConstructors:[],this.projection_=c.projection?(0,l.get)(c.projection):null,this.dropListenKeys_=null,this.source_=c.source||null,this.target=c.target?c.target:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleResult_=function(a,b){var c=this,d=b.target.result,e=this.getMap(),f=this.projection_;if(!f){f=e.getView().getProjection()}for(var g=this.formatConstructors_,h=[],i=0,j=g.length;i<j;++i){var k=g[i],l=new k;if((h=c.tryReadFeatures_(l,d,{featureProjection:f}))&&h.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(h)),this.dispatchEvent(new n(m.ADD_FEATURES,a,h,f))},b.prototype.registerListeners_=function(){var a=this.getMap();if(a){var b=this.target?this.target:a.getViewport();this.dropListenKeys_=[(0,h.listen)(b,j.default.DROP,e,this),(0,h.listen)(b,j.default.DRAGENTER,f,this),(0,h.listen)(b,j.default.DRAGOVER,f,this),(0,h.listen)(b,j.default.DROP,f,this)]}},b.prototype.setActive=function(b){a.prototype.setActive.call(this,b),b?this.registerListeners_():this.unregisterListeners_()},b.prototype.setMap=function(b){this.unregisterListeners_(),a.prototype.setMap.call(this,b),this.getActive()&&this.registerListeners_()},b.prototype.tryReadFeatures_=function(a,b,c){try{return a.readFeatures(b,c)}catch(a){return null}},b.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(h.unlistenByKey),this.dropListenKeys_=null)},b}(k.default),p=o;c.default=p},{"../events.js":66,"../events/Event.js":67,"../events/EventType.js":68,"../functions.js":126,"../interaction/Interaction.js":173,"../proj.js":210}],166:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=c[0]-b[0],e=c[1]-b[1];return d*d+e*e>=this.minArea_}function f(a){(0,j.mouseOnly)(a)&&(this.box_.setPixels(this.startPixel_,a.pixel),this.dispatchEvent(new o(n.BOXDRAG,a.coordinate,a)))}function g(a){return!(0,j.mouseOnly)(a)||(this.box_.setMap(null),this.boxEndCondition_(a,this.startPixel_,a.pixel)&&(this.onBoxEnd_(a),this.dispatchEvent(new o(n.BOXEND,a.coordinate,a))),!1)}function h(a){return!!(0,j.mouseOnly)(a)&&(!(!(0,j.mouseActionButton)(a)||!this.condition_(a))&&(this.startPixel_=a.pixel,this.box_.setMap(a.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new o(n.BOXSTART,a.coordinate,a)),!0))}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=d(a("../events/Event.js")),j=a("../events/condition.js"),k=a("../functions.js"),l=d(a("../interaction/Pointer.js")),m=d(a("../render/Box.js")),n={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},o=function(a){function b(b,c,d){a.call(this,b),this.coordinate=c,this.mapBrowserEvent=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),p=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g});var c=b||{};this.box_=new m.default(c.className||"ol-dragbox"),this.minArea_=void 0!==c.minArea?c.minArea:64,this.onBoxEnd_=c.onBoxEnd?c.onBoxEnd:k.VOID,this.startPixel_=null,this.condition_=c.condition?c.condition:j.always,this.boxEndCondition_=c.boxEndCondition?c.boxEndCondition:e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getGeometry=function(){return this.box_.getGeometry()},b}(l.default),q=p;c.default=q},{"../events/Event.js":67,"../events/condition.js":71,"../functions.js":126,"../interaction/Pointer.js":180,"../render/Box.js":218}],167:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={}
;if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){this.panning_||(this.panning_=!0,this.getMap().getView().setHint(i.default.INTERACTING,1));var b=this.targetPointers,c=(0,n.centroid)(b);if(b.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(c[0],c[1]),this.lastCentroid){var d=this.lastCentroid[0]-c[0],e=c[1]-this.lastCentroid[1],f=a.map,g=f.getView(),h=[d,e];(0,j.scale)(h,g.getResolution()),(0,j.rotate)(h,g.getRotation()),(0,j.add)(h,g.getCenter()),h=g.constrainCenter(h),g.setCenter(h)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=c,this.lastPointersCount_=b.length}function g(a){var b=a.map,c=b.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var d=this.kinetic_.getDistance(),e=this.kinetic_.getAngle(),f=c.getCenter(),g=b.getPixelFromCoordinate(f),h=b.getCoordinateFromPixel([g[0]-d*Math.cos(e),g[1]-d*Math.sin(e)]);c.animate({center:c.constrainCenter(h),duration:500,easing:k.easeOut})}return this.panning_&&(this.panning_=!1,c.setHint(i.default.INTERACTING,-1)),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function h(a){if(this.targetPointers.length>0&&this.condition_(a)){var b=a.map,c=b.getView();return this.lastCentroid=null,c.getAnimating()&&c.setCenter(a.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=e(a("../ViewHint.js")),j=a("../coordinate.js"),k=a("../easing.js"),l=a("../events/condition.js"),m=a("../functions.js"),n=d(a("../interaction/Pointer.js")),o=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g,stopDown:m.FALSE});var c=b||{};this.kinetic_=c.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1,this.condition_=c.condition?c.condition:l.noModifierKeys,this.noKinetic_=!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(n.default),p=o;c.default=p},{"../ViewHint.js":43,"../coordinate.js":62,"../easing.js":65,"../events/condition.js":71,"../functions.js":126,"../interaction/Pointer.js":180}],168:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if((0,j.mouseOnly)(a)){var b=a.map,c=b.getView();if(c.getConstraints().rotation!==h.disable){var d=b.getSize(),e=a.pixel,f=Math.atan2(d[1]/2-e[1],e[0]-d[0]/2);if(void 0!==this.lastAngle_){var g=f-this.lastAngle_,i=c.getRotation();(0,l.rotateWithoutConstraints)(c,i-g)}this.lastAngle_=f}}}function f(a){if(!(0,j.mouseOnly)(a))return!0;var b=a.map,c=b.getView();c.setHint(i.default.INTERACTING,-1);var d=c.getRotation();return(0,l.rotate)(c,d,void 0,this.duration_),!1}function g(a){if(!(0,j.mouseOnly)(a))return!1;if((0,j.mouseActionButton)(a)&&this.condition_(a)){return a.map.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=a("../rotationconstraint.js"),i=d(a("../ViewHint.js")),j=a("../events/condition.js"),k=a("../functions.js"),l=a("../interaction/Interaction.js"),m=d(a("../interaction/Pointer.js")),n=function(a){function b(b){var c=b||{};a.call(this,{handleDownEvent:g,handleDragEvent:e,handleUpEvent:f,stopDown:k.FALSE}),this.condition_=c.condition?c.condition:j.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m.default),o=n;c.default=o},{"../ViewHint.js":43,"../events/condition.js":71,"../functions.js":126,"../interaction/Interaction.js":173,"../interaction/Pointer.js":180,"../rotationconstraint.js":278}],169:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if((0,j.mouseOnly)(a)){var b=a.map,c=b.getSize(),d=a.pixel,e=d[0]-c[0]/2,f=c[1]/2-d[1],g=Math.atan2(f,e),i=Math.sqrt(e*e+f*f),l=b.getView();if(l.getConstraints().rotation!==h.disable&&void 0!==this.lastAngle_){var m=g-this.lastAngle_;(0,k.rotateWithoutConstraints)(l,l.getRotation()-m)}if(this.lastAngle_=g,void 0!==this.lastMagnitude_){var n=this.lastMagnitude_*(l.getResolution()/i);(0,k.zoomWithoutConstraints)(l,n)}void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/i),this.lastMagnitude_=i}}function f(a){if(!(0,j.mouseOnly)(a))return!0;var b=a.map,c=b.getView();c.setHint(i.default.INTERACTING,-1);var d=this.lastScaleDelta_-1;return(0,k.rotate)(c,c.getRotation()),(0,k.zoom)(c,c.getResolution(),void 0,this.duration_,d),this.lastScaleDelta_=0,!1}function g(a){return!!(0,j.mouseOnly)(a)&&(!!this.condition_(a)&&(a.map.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=a("../rotationconstraint.js"),i=d(a("../ViewHint.js")),j=a("../events/condition.js"),k=a("../interaction/Interaction.js"),l=d(a("../interaction/Pointer.js")),m=function(a){function b(b){var c=b||{};a.call(this,{handleDownEvent:g,handleDragEvent:e,handleUpEvent:f}),this.condition_=c.condition?c.condition:j.shiftKeyOnly,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=void 0!==c.duration?c.duration:400}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default),n=m;c.default=n},{"../ViewHint.js":43,"../events/condition.js":71,"../interaction/Interaction.js":173,"../interaction/Pointer.js":180,"../rotationconstraint.js":278}],170:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){var a=this.getMap(),b=a.getView(),c=a.getSize(),d=this.getGeometry().getExtent();if(this.out_){var e=b.calculateExtent(c),g=(0,h.createOrUpdateFromCoordinates)([a.getPixelFromCoordinate((0,h.getBottomLeft)(d)),a.getPixelFromCoordinate((0,h.getTopRight)(d))]),i=b.getResolutionForExtent(g,c);(0,h.scaleFromCenter)(e,1/i),d=e}var j=b.constrainResolution(b.getResolutionForExtent(d,c)),k=(0,h.getCenter)(d);k=b.constrainCenter(k),b.animate({resolution:j,center:k,duration:this.duration_,easing:f.easeOut})}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../easing.js"),g=a("../events/condition.js"),h=a("../extent.js"),i=d(a("../interaction/DragBox.js")),j=function(a){function b(b){var c=b||{},d=c.condition?c.condition:g.shiftKeyOnly;a.call(this,{condition:d,className:c.className||"ol-dragzoom",onBoxEnd:e}),this.duration_=void 0!==c.duration?c.duration:200,this.out_=void 0!==c.out&&c.out}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),k=j;c.default=k},{"../easing.js":65,"../events/condition.js":71,"../extent.js":72,"../interaction/DragBox.js":166}],171:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(){var a=(0,K.createEditingStyle)();return function(b,c){return a[b.getGeometry().getType()]}}function g(a){a.originalEvent.type===m.default.CONTEXTMENU&&a.preventDefault(),this.freehand_=this.mode_!==L.POINT&&this.freehandCondition_(a);var b=a.type===o.default.POINTERMOVE,c=!0;if(this.lastDragTime_&&a.type===o.default.POINTERDRAG){Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=a.pixel,this.shouldHandle_=!this.freehand_,b=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&a.type===o.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(a),c=!1):this.freehand_&&a.type===o.default.POINTERDOWN?c=!1:b?(c=a.type===o.default.POINTERMOVE,c&&this.freehand_?c=this.handlePointerMove_(a):(a.pointerEvent.pointerType==D.POINTER_TYPE||a.type===o.default.POINTERDRAG&&!this.downTimeout_)&&this.handlePointerMove_(a)):a.type===o.default.DBLCLICK&&(c=!1),G.handleEvent.call(this,a)&&c}function h(a){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=a.pixel,this.finishCoordinate_||this.startDrawing_(a),!0):!!this.condition_(a)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new p.default(o.default.POINTERMOVE,a.map,a.pointerEvent,a.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=a.pixel,!0)}function i(a){var b=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(a);var c=this.mode_===L.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||c?this.finishDrawing():this.atFinish_(a)?this.finishCondition_(a)&&this.finishDrawing():this.addToDrawing_(a):(this.startDrawing_(a),this.mode_===L.POINT&&this.finishDrawing()),b=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!b&&this.stopClick_&&a.stopPropagation(),b}function j(a,b){return function(c,d){var e=c[0],f=c[1],g=Math.sqrt((0,r.squaredDistance)(e,f)),h=d||(0,F.fromCircle)(new x.default(e),a),i=b;if(!b){var j=f[0]-e[0],k=f[1]-e[1];i=Math.atan(k/j)-(j<0?Math.PI:0)}return(0,F.makeRegular)(h,e,g,i),h}}function k(){return function(a,b){var c=(0,v.boundingExtent)(a),d=[[(0,v.getBottomLeft)(c),(0,v.getBottomRight)(c),(0,v.getTopRight)(c),(0,v.getTopLeft)(c),(0,v.getBottomLeft)(c)]],e=b;return e?e.setCoordinates(d):e=new F.default(d),e}}function l(a){var b;return a===y.default.POINT||a===y.default.MULTI_POINT?b=L.POINT:a===y.default.LINE_STRING||a===y.default.MULTI_LINE_STRING?b=L.LINE_STRING:a===y.default.POLYGON||a===y.default.MULTI_POLYGON?b=L.POLYGON:a===y.default.CIRCLE&&(b=L.CIRCLE),b}Object.defineProperty(c,"__esModule",{value:!0}),c.handleEvent=g,c.createRegularPolygon=j,c.createBox=k,c.default=void 0;var m=e(a("../events/EventType.js")),n=e(a("../Feature.js")),o=e(a("../MapBrowserEventType.js")),p=e(a("../MapBrowserPointerEvent.js")),q=a("../Object.js"),r=a("../coordinate.js"),s=a("../events.js"),t=e(a("../events/Event.js")),u=a("../events/condition.js"),v=a("../extent.js"),w=a("../functions.js"),x=e(a("../geom/Circle.js")),y=e(a("../geom/GeometryType.js")),z=e(a("../geom/LineString.js")),A=e(a("../geom/MultiLineString.js")),B=e(a("../geom/MultiPoint.js")),C=e(a("../geom/MultiPolygon.js")),D=a("../pointer/MouseSource.js"),E=e(a("../geom/Point.js")),F=d(a("../geom/Polygon.js")),G=d(a("../interaction/Pointer.js")),H=e(a("../interaction/Property.js")),I=e(a("../layer/Vector.js")),J=e(a("../source/Vector.js")),K=a("../style/Style.js"),L={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},M={DRAWSTART:"drawstart",DRAWEND:"drawend"},N=function(a){function b(b,c){a.call(this,b),this.feature=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(t.default),O=function(a){function b(b){a.call(this,{handleDownEvent:h,handleEvent:g,handleUpEvent:i,stopDown:w.FALSE}),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=b.source?b.source:null,this.features_=b.features?b.features:null,this.snapTolerance_=b.snapTolerance?b.snapTolerance:12,this.type_=b.type,this.mode_=l(this.type_),this.stopClick_=!!b.stopClick,this.minPoints_=b.minPoints?b.minPoints:this.mode_===L.POLYGON?3:2,this.maxPoints_=b.maxPoints?b.maxPoints:1/0,this.finishCondition_=b.finishCondition?b.finishCondition:w.TRUE;var c=b.geometryFunction;if(!c)if(this.type_===y.default.CIRCLE)c=function(a,b){var c=b||new x.default([NaN,NaN]),d=(0,r.squaredDistance)(a[0],a[1]);return c.setCenterAndRadius(a[0],Math.sqrt(d)),c};else{var d,e=this.mode_;e===L.POINT?d=E.default:e===L.LINE_STRING?d=z.default:e===L.POLYGON&&(d=F.default),c=function(a,b){var c=b;return c?e===L.POLYGON?a[0].length?c.setCoordinates([a[0].concat([a[0][0]])]):c.setCoordinates([]):c.setCoordinates(a):c=new d(a),c}}this.geometryFunction_=c,this.dragVertexDelay_=void 0!==b.dragVertexDelay?b.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=b.clickTolerance?b.clickTolerance*b.clickTolerance:36,this.overlay_=new I.default({source:new J.default({useSpatialIndex:!1,wrapX:!!b.wrapX&&b.wrapX}),style:b.style?b.style:f(),updateWhileInteracting:!0}),this.geometryName_=b.geometryName,this.condition_=b.condition?b.condition:u.noModifierKeys,this.freehandCondition_,b.freehand?this.freehandCondition_=u.always:this.freehandCondition_=b.freehandCondition?b.freehandCondition:u.shiftKeyOnly,(0,s.listen)(this,(0,q.getChangeEventType)(H.default.ACTIVE),this.updateState_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setMap=function(b){a.prototype.setMap.call(this,b),this.updateState_()},b.prototype.getOverlay=function(){return this.overlay_},b.prototype.handlePointerMove_=function(a){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var b=this.downPx_,c=a.pixel,d=b[0]-c[0],e=b[1]-c[1],f=d*d+e*e;if(this.shouldHandle_=this.freehand_?f>this.squaredClickTolerance_:f<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(a):this.createOrUpdateSketchPoint_(a),!0},b.prototype.atFinish_=function(a){var b=this,c=!1;if(this.sketchFeature_){var d=!1,e=[this.finishCoordinate_];if(this.mode_===L.LINE_STRING?d=this.sketchCoords_.length>this.minPoints_:this.mode_===L.POLYGON&&(d=this.sketchCoords_[0].length>this.minPoints_,e=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]),d)for(var f=a.map,g=0,h=e.length;g<h;g++){var i=e[g],j=f.getPixelFromCoordinate(i),k=a.pixel,l=k[0]-j[0],m=k[1]-j[1],n=b.freehand_?1:b.snapTolerance_;if(c=Math.sqrt(l*l+m*m)<=n){b.finishCoordinate_=i;break}}}return c},b.prototype.createOrUpdateSketchPoint_=function(a){var b=a.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(b)}else this.sketchPoint_=new n.default(new E.default(b)),this.updateSketchFeatures_()},b.prototype.startDrawing_=function(a){var b=a.coordinate;this.finishCoordinate_=b,this.mode_===L.POINT?this.sketchCoords_=b.slice():this.mode_===L.POLYGON?(this.sketchCoords_=[[b.slice(),b.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[b.slice(),b.slice()],this.sketchLineCoords_&&(this.sketchLine_=new n.default(new z.default(this.sketchLineCoords_)));var c=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new n.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(c),this.updateSketchFeatures_(),this.dispatchEvent(new N(M.DRAWSTART,this.sketchFeature_))},b.prototype.modifyDrawing_=function(a){var b,c,d=a.coordinate,e=this.sketchFeature_.getGeometry();if(this.mode_===L.POINT?c=this.sketchCoords_:this.mode_===L.POLYGON?(b=this.sketchCoords_[0],c=b[b.length-1],this.atFinish_(a)&&(d=this.finishCoordinate_.slice())):(b=this.sketchCoords_,c=b[b.length-1]),c[0]=d[0],c[1]=d[1],this.geometryFunction_(this.sketchCoords_,e),this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(d)}var f;if(e instanceof F.default&&this.mode_!==L.POLYGON){this.sketchLine_||(this.sketchLine_=new n.default);var g=e.getLinearRing(0);f=this.sketchLine_.getGeometry(),f?(f.setFlatCoordinates(g.getLayout(),g.getFlatCoordinates()),f.changed()):(f=new z.default(g.getFlatCoordinates(),g.getLayout()),this.sketchLine_.setGeometry(f))}else this.sketchLineCoords_&&(f=this.sketchLine_.getGeometry(),f.setCoordinates(this.sketchLineCoords_));this.updateSketchFeatures_()},b.prototype.addToDrawing_=function(a){var b,c,d=a.coordinate,e=this.sketchFeature_.getGeometry();this.mode_===L.LINE_STRING?(this.finishCoordinate_=d.slice(),c=this.sketchCoords_,c.length>=this.maxPoints_&&(this.freehand_?c.pop():b=!0),c.push(d.slice()),this.geometryFunction_(c,e)):this.mode_===L.POLYGON&&(c=this.sketchCoords_[0],c.length>=this.maxPoints_&&(this.freehand_?c.pop():b=!0),c.push(d.slice()),b&&(this.finishCoordinate_=c[0]),this.geometryFunction_(this.sketchCoords_,e)),this.updateSketchFeatures_(),b&&this.finishDrawing()},b.prototype.removeLastPoint=function(){if(this.sketchFeature_){var a,b,c=this.sketchFeature_.getGeometry();this.mode_===L.LINE_STRING?(a=this.sketchCoords_,a.splice(-2,1),this.geometryFunction_(a,c),a.length>=2&&(this.finishCoordinate_=a[a.length-2].slice())):this.mode_===L.POLYGON&&(a=this.sketchCoords_[0],a.splice(-2,1),b=this.sketchLine_.getGeometry(),b.setCoordinates(a),this.geometryFunction_(this.sketchCoords_,c)),0===a.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},b.prototype.finishDrawing=function(){var a=this.abortDrawing_();if(a){var b=this.sketchCoords_,c=a.getGeometry();this.mode_===L.LINE_STRING?(b.pop(),this.geometryFunction_(b,c)):this.mode_===L.POLYGON&&(b[0].pop(),this.geometryFunction_(b,c),b=c.getCoordinates()),this.type_===y.default.MULTI_POINT?a.setGeometry(new B.default([b])):this.type_===y.default.MULTI_LINE_STRING?a.setGeometry(new A.default([b])):this.type_===y.default.MULTI_POLYGON&&a.setGeometry(new C.default([b])),this.dispatchEvent(new N(M.DRAWEND,a)),this.features_&&this.features_.push(a),this.source_&&this.source_.addFeature(a)}},b.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var a=this.sketchFeature_;return a&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),a},b.prototype.extend=function(a){var b=a.getGeometry(),c=b;this.sketchFeature_=a,this.sketchCoords_=c.getCoordinates();var d=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=d.slice(),this.sketchCoords_.push(d.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new N(M.DRAWSTART,this.sketchFeature_))},b.prototype.updateSketchFeatures_=function(){var a=[];this.sketchFeature_&&a.push(this.sketchFeature_),this.sketchLine_&&a.push(this.sketchLine_),this.sketchPoint_&&a.push(this.sketchPoint_);var b=this.overlay_.getSource();b.clear(!0),b.addFeatures(a)},b.prototype.updateState_=function(){var a=this.getMap(),b=this.getActive();a&&b||this.abortDrawing_(),this.overlay_.setMap(b?a:null)},b}(G.default),P=O;c.default=P},{"../Feature.js":10,"../MapBrowserEventType.js":24,"../MapBrowserPointerEvent.js":25,"../Object.js":29,"../coordinate.js":62,"../events.js":66,"../events/Event.js":67,"../events/EventType.js":68,"../events/condition.js":71,"../extent.js":72,"../functions.js":126,"../geom/Circle.js":128,"../geom/GeometryType.js":132,"../geom/LineString.js":133,"../geom/MultiLineString.js":135,"../geom/MultiPoint.js":136,"../geom/MultiPolygon.js":137,"../geom/Point.js":138,"../geom/Polygon.js":139,"../interaction/Pointer.js":180,"../interaction/Property.js":181,"../layer/Vector.js":194,"../pointer/MouseSource.js":204,"../source/Vector.js":304,"../style/Style.js":331}],172:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){return!(a instanceof q.default)||(a.type!=p.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(a),x.handleEvent.call(this,a),!1)}function g(a){var b=a.pixel,c=a.map,d=this.getExtent(),e=this.snapToVertex_(b,c),f=function(a){var b=null,c=null;return a[0]==d[0]?b=d[2]:a[0]==d[2]&&(b=d[0]),a[1]==d[1]?c=d[3]:a[1]==d[3]&&(c=d[1]),null!==b&&null!==c?[b,c]:null};if(e&&d){var g=e[0]==d[0]||e[0]==d[2]?e[0]:null,h=e[1]==d[1]||e[1]==d[3]?e[1]:null;null!==g&&null!==h?this.pointerHandler_=l(f(e)):null!==g?this.pointerHandler_=m(f([g,d[1]]),f([g,d[3]])):null!==h&&(this.pointerHandler_=m(f([d[0],h]),f([d[2],h])))}else e=c.getCoordinateFromPixel(b),this.setExtent([e[0],e[1],e[0],e[1]]),this.pointerHandler_=l(e);return!0}function h(a){if(this.pointerHandler_){var b=a.coordinate;this.setExtent(this.pointerHandler_(b)),this.createOrUpdatePointerFeature_(b)}return!0}function i(a){this.pointerHandler_=null;var b=this.getExtent();return b&&0!==(0,t.getArea)(b)||this.setExtent(null),!1}function j(){var a=(0,A.createEditingStyle)();return function(b,c){return a[u.default.POLYGON]}}function k(){var a=(0,A.createEditingStyle)();return function(b,c){return a[u.default.POINT]}}function l(a){return function(b){return(0,t.boundingExtent)([a,b])}}function m(a,b){return a[0]==b[0]?function(c){return(0,t.boundingExtent)([a,[c[0],b[1]]])}:a[1]==b[1]?function(c){return(0,t.boundingExtent)([a,[b[0],c[1]]])}:null}function n(a){return[[[a[0],a[1]],[a[0],a[3]]],[[a[0],a[3]],[a[2],a[3]]],[[a[2],a[3]],[a[2],a[1]]],[[a[2],a[1]],[a[0],a[1]]]]}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var o=e(a("../Feature.js")),p=e(a("../MapBrowserEventType.js")),q=e(a("../MapBrowserPointerEvent.js")),r=a("../coordinate.js"),s=e(a("../events/Event.js")),t=a("../extent.js"),u=e(a("../geom/GeometryType.js")),v=e(a("../geom/Point.js")),w=a("../geom/Polygon.js"),x=d(a("../interaction/Pointer.js")),y=e(a("../layer/Vector.js")),z=e(a("../source/Vector.js")),A=a("../style/Style.js"),B={EXTENTCHANGED:"extentchanged"},C=function(a){function b(b){a.call(this,B.EXTENTCHANGED),this.extent=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(s.default),D=function(a){function b(b){a.call(this,{handleDownEvent:g,handleDragEvent:h,handleEvent:f,handleUpEvent:i});var c=b||{};this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==c.pixelTolerance?c.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,b||(b={}),this.extentOverlay_=new y.default({source:new z.default({useSpatialIndex:!1,wrapX:!!b.wrapX}),style:b.boxStyle?b.boxStyle:j(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new y.default({source:new z.default({useSpatialIndex:!1,wrapX:!!b.wrapX}),style:b.pointerStyle?b.pointerStyle:k(),updateWhileAnimating:!0,updateWhileInteracting:!0}),b.extent&&this.setExtent(b.extent)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.snapToVertex_=function(a,b){var c=b.getCoordinateFromPixel(a),d=function(a,b){return(0,r.squaredDistanceToSegment)(c,a)-(0,r.squaredDistanceToSegment)(c,b)},e=this.getExtent();if(e){var f=n(e);f.sort(d);var g=f[0],h=(0,r.closestOnSegment)(c,g),i=b.getPixelFromCoordinate(h);if((0,r.distance)(a,i)<=this.pixelTolerance_){var j=b.getPixelFromCoordinate(g[0]),k=b.getPixelFromCoordinate(g[1]),l=(0,r.squaredDistance)(i,j),m=(0,r.squaredDistance)(i,k),o=Math.sqrt(Math.min(l,m));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(h=l>m?g[1]:g[0]),h}}return null},b.prototype.handlePointerMove_=function(a){var b=a.pixel,c=a.map,d=this.snapToVertex_(b,c);d||(d=c.getCoordinateFromPixel(b)),this.createOrUpdatePointerFeature_(d)},b.prototype.createOrUpdateExtentFeature_=function(a){var b=this.extentFeature_;return b?a?b.setGeometry((0,w.fromExtent)(a)):b.setGeometry(void 0):(b=a?new o.default((0,w.fromExtent)(a)):new o.default({}),this.extentFeature_=b,this.extentOverlay_.getSource().addFeature(b)),b},b.prototype.createOrUpdatePointerFeature_=function(a){var b=this.vertexFeature_;if(b){b.getGeometry().setCoordinates(a)}else b=new o.default(new v.default(a)),this.vertexFeature_=b,this.vertexOverlay_.getSource().addFeature(b);return b},b.prototype.setMap=function(b){this.extentOverlay_.setMap(b),this.vertexOverlay_.setMap(b),a.prototype.setMap.call(this,b)},b.prototype.getExtent=function(){return this.extent_},b.prototype.setExtent=function(a){this.extent_=a||null,this.createOrUpdateExtentFeature_(a),this.dispatchEvent(new C(this.extent_))},b}(x.default),E=D;c.default=E},{"../Feature.js":10,"../MapBrowserEventType.js":24,"../MapBrowserPointerEvent.js":25,"../coordinate.js":62,"../events/Event.js":67,"../extent.js":72,"../geom/GeometryType.js":132,"../geom/Point.js":138,"../geom/Polygon.js":139,"../interaction/Pointer.js":180,"../layer/Vector.js":194,"../source/Vector.js":304,"../style/Style.js":331}],173:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=a.getCenter();if(d){var e=a.constrainCenter([d[0]+b[0],d[1]+b[1]]);c?a.animate({duration:c,easing:l.linear,center:e}):a.setCenter(e)}}function f(a,b,c,d){b=a.constrainRotation(b,0),g(a,b,c,d)}function g(a,b,c,d){if(void 0!==b){var e=a.getRotation(),f=a.getCenter();void 0!==e&&f&&d>0?a.animate({rotation:b,anchor:c,duration:d,easing:l.easeOut}):a.rotate(b,c)}}function h(a,b,c,d,e){b=a.constrainResolution(b,0,e),j(a,b,c,d)}function i(a,b,c,d){var e=a.getResolution(),f=a.constrainResolution(e,b,0);if(void 0!==f){var g=a.getResolutions();f=(0,n.clamp)(f,a.getMinResolution()||g[g.length-1],a.getMaxResolution()||g[0])}if(c&&void 0!==f&&f!==e){var h=a.getCenter(),i=a.calculateCenterZoom(f,c);i=a.constrainCenter(i),c=[(f*h[0]-e*i[0])/(f-e),(f*h[1]-e*i[1])/(f-e)]}j(a,f,c,d)}function j(a,b,c,d){if(b){var e=a.getResolution(),f=a.getCenter();if(void 0!==e&&f&&b!==e&&d)a.animate({resolution:b,anchor:c,duration:d,easing:l.easeOut});else{if(c){var g=a.calculateCenterZoom(b,c);a.setCenter(g)}a.setResolution(b)}}}Object.defineProperty(c,"__esModule",{value:!0}),c.pan=e,c.rotate=f,c.rotateWithoutConstraints=g,c.zoom=h,c.zoomByDelta=i,c.zoomWithoutConstraints=j,c.default=void 0;var k=d(a("../Object.js")),l=a("../easing.js"),m=d(a("../interaction/Property.js")),n=a("../math.js"),o=function(a){function b(b){a.call(this),this.map_=null,this.setActive(!0),this.handleEvent=b.handleEvent}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getActive=function(){return this.get(m.default.ACTIVE)},b.prototype.getMap=function(){return this.map_},b.prototype.setActive=function(a){this.set(m.default.ACTIVE,a)},b.prototype.setMap=function(a){this.map_=a},b}(k.default),p=o;c.default=p},{"../Object.js":29,"../easing.js":65,"../interaction/Property.js":181,"../math.js":199}],174:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=!1;if(a.type==h.default.KEYDOWN){var c=a.originalEvent,d=c.keyCode;if(this.condition_(a)&&(d==i.default.DOWN||d==i.default.LEFT||d==i.default.RIGHT||d==i.default.UP)){var e=a.map,f=e.getView(),j=f.getResolution()*this.pixelDelta_,l=0,m=0;d==i.default.DOWN?m=-j:d==i.default.LEFT?l=-j:d==i.default.RIGHT?l=j:m=j;var n=[l,m];(0,g.rotate)(n,f.getRotation()),(0,k.pan)(f,n,this.duration_),a.preventDefault(),b=!0}}return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=a("../coordinate.js"),h=e(a("../events/EventType.js")),i=e(a("../events/KeyCode.js")),j=a("../events/condition.js"),k=d(a("../interaction/Interaction.js")),l=function(a){function b(b){a.call(this,{handleEvent:f});var c=b||{};this.defaultCondition_=function(a){return(0,j.noModifierKeys)(a)&&(0,j.targetNotEditable)(a)},this.condition_=void 0!==c.condition?c.condition:this.defaultCondition_,this.duration_=void 0!==c.duration?c.duration:100,this.pixelDelta_=void 0!==c.pixelDelta?c.pixelDelta:128}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(k.default),m=l;c.default=m},{"../coordinate.js":62,"../events/EventType.js":68,"../events/KeyCode.js":69,"../events/condition.js":71,"../interaction/Interaction.js":173}],175:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=!1;if(a.type==g.default.KEYDOWN||a.type==g.default.KEYPRESS){var c=a.originalEvent,d=c.charCode;if(this.condition_(a)&&(d=="+".charCodeAt(0)||d=="-".charCodeAt(0))){var e=a.map,f=d=="+".charCodeAt(0)?this.delta_:-this.delta_,h=e.getView();(0,i.zoomByDelta)(h,f,void 0,this.duration_),a.preventDefault(),b=!0}}return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=e(a("../events/EventType.js")),h=a("../events/condition.js"),i=d(a("../interaction/Interaction.js")),j=function(a){function b(b){a.call(this,{handleEvent:f});var c=b||{};this.condition_=c.condition?c.condition:h.targetNotEditable,this.delta_=c.delta?c.delta:1,this.duration_=void 0!==c.duration?c.duration:100}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),k=j;c.default=k},{"../events/EventType.js":68,"../events/condition.js":71,"../interaction/Interaction.js":173}],176:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){return a.index-b.index}function g(a){var b=this;if(!this.condition_(a))return!1;this.handlePointerAtPixel_(a.pixel,a.map);var c=a.map.getCoordinateFromPixel(a.pixel);this.dragSegments_.length=0,this.modified_=!1;var d=this.vertexFeature_;if(d){var e=[],g=d.getGeometry(),h=g.getCoordinates(),i=(0,z.boundingExtent)([h]),j=this.rBush_.getInExtent(i),k={};j.sort(f);for(var m=0,o=j.length;m<o;++m){var p=j[m],q=p.segment,r=(0,n.getUid)(p.feature),s=p.depth;if(s&&(r+="-"+s.join("-")),k[r]||(k[r]=new Array(2)),p.geometry.getType()===A.default.CIRCLE&&p.index===J){var t=l(c,p);(0,u.equals)(t,h)&&!k[r][0]&&(b.dragSegments_.push([p,0]),k[r][0]=p)}else if((0,u.equals)(q[0],h)&&!k[r][0])b.dragSegments_.push([p,0]),k[r][0]=p;else if((0,u.equals)(q[1],h)&&!k[r][1]){if((p.geometry.getType()===A.default.LINE_STRING||p.geometry.getType()===A.default.MULTI_LINE_STRING)&&k[r][0]&&0===k[r][0].index)continue;b.dragSegments_.push([p,1]),k[r][1]=p}else b.insertVertexCondition_(a)&&(0,n.getUid)(q)in b.vertexSegments_&&!k[r][0]&&!k[r][1]&&e.push([p,h])}e.length&&this.willModifyFeatures_(a);for(var v=e.length-1;v>=0;--v)b.insertVertex_.apply(b,e[v])}return!!this.vertexFeature_}function h(a){var b=this;this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(a);for(var c=a.coordinate,d=0,e=this.dragSegments_.length;d<e;++d){for(var f=b.dragSegments_[d],g=f[0],h=g.depth,i=g.geometry,j=void 0,k=g.segment,l=f[1];c.length<i.getStride();)c.push(k[l][c.length]);switch(i.getType()){case A.default.POINT:j=c,k[0]=k[1]=c;break;case A.default.MULTI_POINT:j=i.getCoordinates(),j[g.index]=c,k[0]=k[1]=c;break;case A.default.LINE_STRING:j=i.getCoordinates(),j[g.index+l]=c,k[l]=c;break;case A.default.MULTI_LINE_STRING:case A.default.POLYGON:j=i.getCoordinates(),j[h[0]][g.index+l]=c,k[l]=c;break;case A.default.MULTI_POLYGON:j=i.getCoordinates(),j[h[1]][h[0]][g.index+l]=c,k[l]=c;break;case A.default.CIRCLE:
k[0]=k[1]=c,g.index===I?(b.changingFeature_=!0,i.setCenter(c),b.changingFeature_=!1):(b.changingFeature_=!0,i.setRadius((0,u.distance)(i.getCenter(),c)),b.changingFeature_=!1)}j&&b.setGeometryCoordinates_(i,j)}this.createOrUpdateVertexFeature_(c)}function i(a){for(var b=this,c=this.dragSegments_.length-1;c>=0;--c){var d=b.dragSegments_[c][0],e=d.geometry;if(e.getType()===A.default.CIRCLE){var f=e.getCenter(),g=d.featureSegments[0],h=d.featureSegments[1];g.segment[0]=g.segment[1]=f,h.segment[0]=h.segment[1]=f,b.rBush_.update((0,z.createOrUpdateFromCoordinate)(f),g),b.rBush_.update(e.getExtent(),h)}else b.rBush_.update((0,z.boundingExtent)(d.segment),d)}return this.modified_&&(this.dispatchEvent(new L(K.MODIFYEND,this.features_,a)),this.modified_=!1),!1}function j(a){if(!(a instanceof s.default))return!0;this.lastPointerEvent_=a;var b;return a.map.getView().getInteracting()||a.type!=r.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(a),this.vertexFeature_&&this.deleteCondition_(a)&&(b=!(a.type!=r.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),a.type==r.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),C.handleEvent.call(this,a)&&!b}function k(a,b){var c=b.geometry;if(c.getType()===A.default.CIRCLE){var d=c;if(b.index===J){var e=(0,u.squaredDistance)(d.getCenter(),a),f=Math.sqrt(e)-d.getRadius();return f*f}}return(0,u.squaredDistanceToSegment)(a,b.segment)}function l(a,b){var c=b.geometry;return c.getType()===A.default.CIRCLE&&b.index===J?c.getClosestPoint(a):(0,u.closestOnSegment)(a,b.segment)}function m(){var a=(0,H.createEditingStyle)();return function(b,c){return a[A.default.POINT]}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.ModifyEvent=void 0;var n=a("../util.js"),o=e(a("../Collection.js")),p=e(a("../CollectionEventType.js")),q=e(a("../Feature.js")),r=e(a("../MapBrowserEventType.js")),s=e(a("../MapBrowserPointerEvent.js")),t=a("../array.js"),u=a("../coordinate.js"),v=a("../events.js"),w=e(a("../events/Event.js")),x=e(a("../events/EventType.js")),y=a("../events/condition.js"),z=a("../extent.js"),A=e(a("../geom/GeometryType.js")),B=e(a("../geom/Point.js")),C=d(a("../interaction/Pointer.js")),D=e(a("../layer/Vector.js")),E=e(a("../source/Vector.js")),F=e(a("../source/VectorEventType.js")),G=e(a("../structs/RBush.js")),H=a("../style/Style.js"),I=0,J=1,K={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},L=function(a){function b(b,c,d){a.call(this,b),this.features=c,this.mapBrowserEvent=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(w.default);c.ModifyEvent=L;var M=function(a){function b(b){a.call(this,{handleDownEvent:g,handleDragEvent:h,handleEvent:j,handleUpEvent:i}),this.condition_=b.condition?b.condition:y.primaryAction,this.defaultDeleteCondition_=function(a){return(0,y.altKeyOnly)(a)&&(0,y.singleClick)(a)},this.deleteCondition_=b.deleteCondition?b.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=b.insertVertexCondition?b.insertVertexCondition:y.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new G.default,this.pixelTolerance_=void 0!==b.pixelTolerance?b.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new D.default({source:new E.default({useSpatialIndex:!1,wrapX:!!b.wrapX}),style:b.style?b.style:m(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null;var c;if(b.source?(this.source_=b.source,c=new o.default(this.source_.getFeatures()),(0,v.listen)(this.source_,F.default.ADDFEATURE,this.handleSourceAdd_,this),(0,v.listen)(this.source_,F.default.REMOVEFEATURE,this.handleSourceRemove_,this)):c=b.features,!c)throw new Error("The modify interaction requires features or a source");this.features_=c,this.features_.forEach(this.addFeature_.bind(this)),(0,v.listen)(this.features_,p.default.ADD,this.handleFeatureAdd_,this),(0,v.listen)(this.features_,p.default.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature_=function(a){var b=a.getGeometry();b&&b.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[b.getType()].call(this,a,b);var c=this.getMap();c&&c.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,c),(0,v.listen)(a,x.default.CHANGE,this.handleFeatureChange_,this)},b.prototype.willModifyFeatures_=function(a){this.modified_||(this.modified_=!0,this.dispatchEvent(new L(K.MODIFYSTART,this.features_,a)))},b.prototype.removeFeature_=function(a){this.removeFeatureSegmentData_(a),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,v.unlisten)(a,x.default.CHANGE,this.handleFeatureChange_,this)},b.prototype.removeFeatureSegmentData_=function(a){var b=this.rBush_,c=[];b.forEach(function(b){a===b.feature&&c.push(b)});for(var d=c.length-1;d>=0;--d)b.remove(c[d])},b.prototype.setActive=function(b){this.vertexFeature_&&!b&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),a.prototype.setActive.call(this,b)},b.prototype.setMap=function(b){this.overlay_.setMap(b),a.prototype.setMap.call(this,b)},b.prototype.getOverlay=function(){return this.overlay_},b.prototype.handleSourceAdd_=function(a){a.feature&&this.features_.push(a.feature)},b.prototype.handleSourceRemove_=function(a){a.feature&&this.features_.remove(a.feature)},b.prototype.handleFeatureAdd_=function(a){this.addFeature_(a.element)},b.prototype.handleFeatureChange_=function(a){if(!this.changingFeature_){var b=a.target;this.removeFeature_(b),this.addFeature_(b)}},b.prototype.handleFeatureRemove_=function(a){var b=a.element;this.removeFeature_(b)},b.prototype.writePointGeometry_=function(a,b){var c=b.getCoordinates(),d={feature:a,geometry:b,segment:[c,c]};this.rBush_.insert(b.getExtent(),d)},b.prototype.writeMultiPointGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e){var g=d[e],h={feature:a,geometry:b,depth:[e],index:e,segment:[g,g]};c.rBush_.insert(b.getExtent(),h)}},b.prototype.writeLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length-1;e<f;++e){var g=d.slice(e,e+2),h={feature:a,geometry:b,index:e,segment:g};c.rBush_.insert((0,z.boundingExtent)(g),h)}},b.prototype.writeMultiLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e)for(var g=d[e],h=0,i=g.length-1;h<i;++h){var j=g.slice(h,h+2),k={feature:a,geometry:b,depth:[e],index:h,segment:j};c.rBush_.insert((0,z.boundingExtent)(j),k)}},b.prototype.writePolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e)for(var g=d[e],h=0,i=g.length-1;h<i;++h){var j=g.slice(h,h+2),k={feature:a,geometry:b,depth:[e],index:h,segment:j};c.rBush_.insert((0,z.boundingExtent)(j),k)}},b.prototype.writeMultiPolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e)for(var g=d[e],h=0,i=g.length;h<i;++h)for(var j=g[h],k=0,l=j.length-1;k<l;++k){var m=j.slice(k,k+2),n={feature:a,geometry:b,depth:[h,e],index:k,segment:m};c.rBush_.insert((0,z.boundingExtent)(m),n)}},b.prototype.writeCircleGeometry_=function(a,b){var c=b.getCenter(),d={feature:a,geometry:b,index:I,segment:[c,c]},e={feature:a,geometry:b,index:J,segment:[c,c]},f=[d,e];d.featureSegments=e.featureSegments=f,this.rBush_.insert((0,z.createOrUpdateFromCoordinate)(c),d),this.rBush_.insert(b.getExtent(),e)},b.prototype.writeGeometryCollectionGeometry_=function(a,b){for(var c=this,d=b.getGeometriesArray(),e=0;e<d.length;++e)c.SEGMENT_WRITERS_[d[e].getType()].call(c,a,d[e])},b.prototype.createOrUpdateVertexFeature_=function(a){var b=this.vertexFeature_;if(b){b.getGeometry().setCoordinates(a)}else b=new q.default(new B.default(a)),this.vertexFeature_=b,this.overlay_.getSource().addFeature(b);return b},b.prototype.handlePointerMove_=function(a){this.lastPixel_=a.pixel,this.handlePointerAtPixel_(a.pixel,a.map)},b.prototype.handlePointerAtPixel_=function(a,b){var c=b.getCoordinateFromPixel(a),d=function(a,b){return k(c,a)-k(c,b)},e=(0,z.buffer)((0,z.createOrUpdateFromCoordinate)(c),b.getView().getResolution()*this.pixelTolerance_),f=this.rBush_,g=f.getInExtent(e);if(g.length>0){g.sort(d);var h=g[0],i=h.segment,j=l(c,h),m=b.getPixelFromCoordinate(j),o=(0,u.distance)(a,m);if(o<=this.pixelTolerance_){var p={};if(h.geometry.getType()===A.default.CIRCLE&&h.index===J)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(j);else{var q=b.getPixelFromCoordinate(i[0]),r=b.getPixelFromCoordinate(i[1]),s=(0,u.squaredDistance)(m,q),t=(0,u.squaredDistance)(m,r);o=Math.sqrt(Math.min(s,t)),this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(j=s>t?i[1]:i[0]),this.createOrUpdateVertexFeature_(j);for(var v=1,w=g.length;v<w;++v){var x=g[v].segment;if(!((0,u.equals)(i[0],x[0])&&(0,u.equals)(i[1],x[1])||(0,u.equals)(i[0],x[1])&&(0,u.equals)(i[1],x[0])))break;p[(0,n.getUid)(x)]=!0}}return p[(0,n.getUid)(i)]=!0,void(this.vertexSegments_=p)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},b.prototype.insertVertex_=function(a,b){for(var c,d=a.segment,e=a.feature,f=a.geometry,g=a.depth,h=a.index;b.length<f.getStride();)b.push(0);switch(f.getType()){case A.default.MULTI_LINE_STRING:case A.default.POLYGON:c=f.getCoordinates(),c[g[0]].splice(h+1,0,b);break;case A.default.MULTI_POLYGON:c=f.getCoordinates(),c[g[1]][g[0]].splice(h+1,0,b);break;case A.default.LINE_STRING:c=f.getCoordinates(),c.splice(h+1,0,b);break;default:return}this.setGeometryCoordinates_(f,c);var i=this.rBush_;i.remove(a),this.updateSegmentIndices_(f,h,g,1);var j={segment:[d[0],b],feature:e,geometry:f,depth:g,index:h};i.insert((0,z.boundingExtent)(j.segment),j),this.dragSegments_.push([j,1]);var k={segment:[b,d[1]],feature:e,geometry:f,depth:g,index:h+1};i.insert((0,z.boundingExtent)(k.segment),k),this.dragSegments_.push([k,0]),this.ignoreNextSingleClick_=!0},b.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=r.default.POINTERDRAG){var a=this.lastPointerEvent_;return this.willModifyFeatures_(a),this.removeVertex_(),this.dispatchEvent(new L(K.MODIFYEND,this.features_,a)),this.modified_=!1,!0}return!1},b.prototype.removeVertex_=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=this.dragSegments_,o={},p=!1;for(e=m.length-1;e>=0;--e)c=m[e],j=c[0],k=(0,n.getUid)(j.feature),j.depth&&(k+="-"+j.depth.join("-")),k in o||(o[k]={}),0===c[1]?(o[k].right=j,o[k].index=j.index):1==c[1]&&(o[k].left=j,o[k].index=j.index+1);for(k in o){switch(i=o[k].right,g=o[k].left,f=o[k].index,h=f-1,j=void 0!==g?g:i,h<0&&(h=0),d=j.geometry,b=d.getCoordinates(),a=b,p=!1,d.getType()){case A.default.MULTI_LINE_STRING:b[j.depth[0]].length>2&&(b[j.depth[0]].splice(f,1),p=!0);break;case A.default.LINE_STRING:b.length>2&&(b.splice(f,1),p=!0);break;case A.default.MULTI_POLYGON:a=a[j.depth[1]];case A.default.POLYGON:a=a[j.depth[0]],a.length>4&&(f==a.length-1&&(f=0),a.splice(f,1),p=!0,0===f&&(a.pop(),a.push(a[0]),h=a.length-1))}if(p){l.setGeometryCoordinates_(d,b);var q=[];if(void 0!==g&&(l.rBush_.remove(g),q.push(g.segment[0])),void 0!==i&&(l.rBush_.remove(i),q.push(i.segment[1])),void 0!==g&&void 0!==i){var r={depth:j.depth,feature:j.feature,geometry:j.geometry,index:h,segment:q};l.rBush_.insert((0,z.boundingExtent)(r.segment),r)}l.updateSegmentIndices_(d,f,j.depth,-1),l.vertexFeature_&&(l.overlay_.getSource().removeFeature(l.vertexFeature_),l.vertexFeature_=null),m.length=0}}return p},b.prototype.setGeometryCoordinates_=function(a,b){this.changingFeature_=!0,a.setCoordinates(b),this.changingFeature_=!1},b.prototype.updateSegmentIndices_=function(a,b,c,d){this.rBush_.forEachInExtent(a.getExtent(),function(e){e.geometry===a&&(void 0===c||void 0===e.depth||(0,t.equals)(e.depth,c))&&e.index>b&&(e.index+=d)})},b}(C.default),N=M;c.default=N},{"../Collection.js":7,"../CollectionEventType.js":8,"../Feature.js":10,"../MapBrowserEventType.js":24,"../MapBrowserPointerEvent.js":25,"../array.js":46,"../coordinate.js":62,"../events.js":66,"../events/Event.js":67,"../events/EventType.js":68,"../events/condition.js":71,"../extent.js":72,"../geom/GeometryType.js":132,"../geom/Point.js":138,"../interaction/Pointer.js":180,"../layer/Vector.js":194,"../source/Vector.js":304,"../source/VectorEventType.js":305,"../structs/RBush.js":317,"../style/Style.js":331,"../util.js":342}],177:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){if(!this.condition_(a))return!0;var b=a.type;if(b!==j.default.WHEEL&&b!==j.default.MOUSEWHEEL)return!0;a.preventDefault();var c=a.map,d=a.originalEvent;this.useAnchor_&&(this.lastAnchor_=a.coordinate);var e;if(a.type==j.default.WHEEL?(e=d.deltaY,k.FIREFOX&&d.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=k.DEVICE_PIXEL_RATIO),d.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)):a.type==j.default.MOUSEWHEEL&&(e=-d.wheelDeltaY,k.SAFARI&&(e/=3)),0===e)return!1;var f=Date.now();if(void 0===this.startTime_&&(this.startTime_=f),(!this.mode_||f-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?o.TRACKPAD:o.WHEEL),this.mode_===o.TRACKPAD){var h=c.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):h.setHint(g.default.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var l=h.getResolution()*Math.pow(2,e/this.trackpadDeltaPerZoom_),m=h.getMinResolution(),n=h.getMaxResolution(),p=0;if(l<m?(l=Math.max(l,m/this.trackpadZoomBuffer_),p=1):l>n&&(l=Math.min(l,n*this.trackpadZoomBuffer_),p=-1),this.lastAnchor_){var q=h.calculateCenterZoom(l,this.lastAnchor_);h.setCenter(h.constrainCenter(q))}return h.setResolution(l),0===p&&this.constrainResolution_&&h.animate({resolution:h.constrainResolution(l,e>0?-1:1),easing:i.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),p>0?h.animate({resolution:m,easing:i.easeOut,anchor:this.lastAnchor_,duration:500}):p<0&&h.animate({resolution:n,easing:i.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=f,!1}this.delta_+=e;var r=Math.max(this.timeout_-(f-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,c),r),!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.Mode=void 0;var g=e(a("../ViewHint.js")),h=a("../events/condition.js"),i=a("../easing.js"),j=e(a("../events/EventType.js")),k=a("../has.js"),l=d(a("../interaction/Interaction.js")),m=a("../math.js"),n=1,o={TRACKPAD:"trackpad",WHEEL:"wheel"};c.Mode=o;var p=function(a){function b(b){a.call(this,{handleEvent:f});var c=b||{};this.delta_=0,this.duration_=void 0!==c.duration?c.duration:250,this.timeout_=void 0!==c.timeout?c.timeout:80,this.useAnchor_=void 0===c.useAnchor||c.useAnchor,this.constrainResolution_=c.constrainResolution||!1,this.condition_=c.condition?c.condition:h.always,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(g.default.INTERACTING,-1)},b.prototype.handleWheelZoom_=function(a){var b=a.getView();b.getAnimating()&&b.cancelAnimations();var c=n,d=(0,m.clamp)(this.delta_,-c,c);(0,l.zoomByDelta)(b,-d,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},b.prototype.setMouseAnchor=function(a){this.useAnchor_=a,a||(this.lastAnchor_=null)},b}(l.default),q=p;c.default=q},{"../ViewHint.js":43,"../easing.js":65,"../events/EventType.js":68,"../events/condition.js":71,"../has.js":161,"../interaction/Interaction.js":173,"../math.js":199}],178:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=0,c=this.targetPointers[0],d=this.targetPointers[1],e=Math.atan2(d.clientY-c.clientY,d.clientX-c.clientX);if(void 0!==this.lastAngle_){var f=e-this.lastAngle_;this.rotationDelta_+=f,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),b=f}this.lastAngle_=e;var g=a.map,h=g.getView();if(h.getConstraints().rotation!==m.disable){var i=g.getViewport().getBoundingClientRect(),j=(0,l.centroid)(this.targetPointers);if(j[0]-=i.left,j[1]-=i.top,this.anchor_=g.getCoordinateFromPixel(j),this.rotating_){var n=h.getRotation();g.render(),(0,k.rotateWithoutConstraints)(h,n+b,this.anchor_)}}}function g(a){if(this.targetPointers.length<2){var b=a.map,c=b.getView();if(c.setHint(i.default.INTERACTING,-1),this.rotating_){var d=c.getRotation();(0,k.rotate)(c,d,this.anchor_,this.duration_)}return!1}return!0}function h(a){if(this.targetPointers.length>=2){var b=a.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||b.getView().setHint(i.default.INTERACTING,1),!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=e(a("../ViewHint.js")),j=a("../functions.js"),k=a("../interaction/Interaction.js"),l=d(a("../interaction/Pointer.js")),m=a("../rotationconstraint.js"),n=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g,stopDown:j.FALSE});var c=b||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==c.threshold?c.threshold:.3,this.duration_=void 0!==c.duration?c.duration:250}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default),o=n;c.default=o},{"../ViewHint.js":43,"../functions.js":126,"../interaction/Interaction.js":173,"../interaction/Pointer.js":180,"../rotationconstraint.js":278}],179:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=1,c=this.targetPointers[0],d=this.targetPointers[1],e=c.clientX-d.clientX,f=c.clientY-d.clientY,g=Math.sqrt(e*e+f*f);void 0!==this.lastDistance_&&(b=this.lastDistance_/g),this.lastDistance_=g;var h=a.map,i=h.getView(),j=i.getResolution(),m=i.getMaxResolution(),n=i.getMinResolution(),o=j*b;o>m?(b=m/j,o=m):o<n&&(b=n/j,o=n),1!=b&&(this.lastScaleDelta_=b);var p=h.getViewport().getBoundingClientRect(),q=(0,l.centroid)(this.targetPointers);q[0]-=p.left,q[1]-=p.top,this.anchor_=h.getCoordinateFromPixel(q),h.render(),(0,k.zoomWithoutConstraints)(i,o,this.anchor_)}function g(a){if(this.targetPointers.length<2){var b=a.map,c=b.getView();c.setHint(i.default.INTERACTING,-1);var d=c.getResolution();if(this.constrainResolution_||d<c.getMinResolution()||d>c.getMaxResolution()){var e=this.lastScaleDelta_-1;(0,k.zoom)(c,d,this.anchor_,this.duration_,e)}return!1}return!0}function h(a){if(this.targetPointers.length>=2){var b=a.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||b.getView().setHint(i.default.INTERACTING,1),!0}return!1}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=e(a("../ViewHint.js")),j=a("../functions.js"),k=a("../interaction/Interaction.js"),l=d(a("../interaction/Pointer.js")),m=function(a){function b(b){a.call(this,{handleDownEvent:h,handleDragEvent:f,handleUpEvent:g,stopDown:j.FALSE});var c=b||{};this.constrainResolution_=c.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==c.duration?c.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default),n=m;c.default=n},{"../ViewHint.js":43,"../functions.js":126,"../interaction/Interaction.js":173,"../interaction/Pointer.js":180}],180:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){for(var b=a.length,c=0,d=0,e=0;e<b;e++)c+=a[e].clientX,d+=a[e].clientY;return[c/b,d/b]}function f(a){var b=a.type;return b===j.default.POINTERDOWN||b===j.default.POINTERDRAG||b===j.default.POINTERUP}function g(a){if(!(a instanceof k.default))return!0;var b=!1;if(this.updateTrackedPointers_(a),this.handlingDownUpSequence){if(a.type==j.default.POINTERDRAG)this.handleDragEvent_(a);else if(a.type==j.default.POINTERUP){var c=this.handleUpEvent_(a);this.handlingDownUpSequence=c&&this.targetPointers.length>0}}else if(a.type==j.default.POINTERDOWN){var d=this.handleDownEvent_(a);d&&a.preventDefault(),this.handlingDownUpSequence=d,b=this.stopDown(d)}else a.type==j.default.POINTERMOVE&&this.handleMoveEvent_(a);return!b}function h(a){return a}Object.defineProperty(c,"__esModule",{value:!0}),c.centroid=e,c.handleEvent=g,c.default=void 0;var i=a("../functions.js"),j=d(a("../MapBrowserEventType.js")),k=d(a("../MapBrowserPointerEvent.js")),l=d(a("../interaction/Interaction.js")),m=a("../obj.js"),n=i.VOID,o=i.FALSE,p=i.FALSE,q=i.VOID,r=function(a){function b(b){var c=b||{};a.call(this,{handleEvent:c.handleEvent||g}),this.handleDownEvent_=c.handleDownEvent?c.handleDownEvent:p,this.handleDragEvent_=c.handleDragEvent?c.handleDragEvent:n,this.handleMoveEvent_=c.handleMoveEvent?c.handleMoveEvent:q,this.handleUpEvent_=c.handleUpEvent?c.handleUpEvent:o,this.handlingDownUpSequence=!1,this.stopDown=c.stopDown?c.stopDown:h,this.trackedPointers_={},this.targetPointers=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.updateTrackedPointers_=function(a){if(f(a)){var b=a.pointerEvent,c=b.pointerId.toString();a.type==j.default.POINTERUP?delete this.trackedPointers_[c]:a.type==j.default.POINTERDOWN?this.trackedPointers_[c]=b:c in this.trackedPointers_&&(this.trackedPointers_[c]=b),this.targetPointers=(0,m.getValues)(this.trackedPointers_)}},b}(l.default),s=r;c.default=s},{"../MapBrowserEventType.js":24,"../MapBrowserPointerEvent.js":25,"../functions.js":126,"../interaction/Interaction.js":173,"../obj.js":201}],181:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ACTIVE:"active"};c.default=d},{}],182:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(!this.condition_(a))return!0;var b=this.addCondition_(a),c=this.removeCondition_(a),d=this.toggleCondition_(a),e=!b&&!c&&!d,f=a.map,g=this.featureOverlay_.getSource().getFeaturesCollection(),h=[],j=[];if(e){(0,q.clear)(this.featureLayerAssociation_),f.forEachFeatureAtPixel(a.pixel,function(a,b){if(this.filter_(a,b))return j.push(a),this.addFeatureLayerAssociation_(a,b),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var k=g.getLength()-1;k>=0;--k){var m=g.item(k),n=j.indexOf(m);n>-1?j.splice(n,1):(g.remove(m),h.push(m))}0!==j.length&&g.extend(j)}else{f.forEachFeatureAtPixel(a.pixel,function(a,e){if(this.filter_(a,e))return!b&&!d||(0,i.includes)(g.getArray(),a)?(c||d)&&(0,i.includes)(g.getArray(),a)&&(h.push(a),this.removeFeatureLayerAssociation_(a)):(j.push(a),this.addFeatureLayerAssociation_(a,e)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var o=h.length-1;o>=0;--o)g.remove(h[o]);g.extend(j)}return(j.length>0||h.length>0)&&this.dispatchEvent(new u(t.SELECT,j,h,a)),(0,l.pointerMove)(a)}function f(){var a=(0,s.createEditingStyle)();return(0,i.extend)(a[n.default.POLYGON],a[n.default.LINE_STRING]),(0,i.extend)(a[n.default.GEOMETRY_COLLECTION],a[n.default.LINE_STRING]),function(b,c){return b.getGeometry()?a[b.getGeometry().getType()]:null}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=a("../util.js"),h=d(a("../CollectionEventType.js")),i=a("../array.js"),j=a("../events.js"),k=d(a("../events/Event.js")),l=a("../events/condition.js"),m=a("../functions.js"),n=d(a("../geom/GeometryType.js")),o=d(a("../interaction/Interaction.js")),p=d(a("../layer/Vector.js")),q=a("../obj.js"),r=d(a("../source/Vector.js")),s=a("../style/Style.js"),t={SELECT:"select"},u=function(a){function b(b,c,d,e){a.call(this,b),this.selected=c,this.deselected=d,this.mapBrowserEvent=e}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(k.default),v=function(a){function b(b){a.call(this,{handleEvent:e});var c=b||{};this.condition_=c.condition?c.condition:l.singleClick,this.addCondition_=c.addCondition?c.addCondition:l.never,this.removeCondition_=c.removeCondition?c.removeCondition:l.never,this.toggleCondition_=c.toggleCondition?c.toggleCondition:l.shiftKeyOnly,this.multi_=!!c.multi&&c.multi,this.filter_=c.filter?c.filter:m.TRUE,this.hitTolerance_=c.hitTolerance?c.hitTolerance:0;var d=new p.default({source:new r.default({useSpatialIndex:!1,features:c.features,wrapX:c.wrapX}),style:c.style?c.style:f(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.featureOverlay_=d;var g;if(c.layers)if("function"==typeof c.layers)g=c.layers;else{var k=c.layers;g=function(a){return(0,i.includes)(k,a)}}else g=m.TRUE;this.layerFilter_=g,this.featureLayerAssociation_={};var n=this.featureOverlay_.getSource().getFeaturesCollection();(0,j.listen)(n,h.default.ADD,this.addFeature_,this),(0,j.listen)(n,h.default.REMOVE,this.removeFeature_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeatureLayerAssociation_=function(a,b){var c=(0,g.getUid)(a);this.featureLayerAssociation_[c]=b},b.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},b.prototype.getHitTolerance=function(){return this.hitTolerance_},b.prototype.getLayer=function(a){var b=(0,g.getUid)(a);return this.featureLayerAssociation_[b]},b.prototype.getOverlay=function(){return this.featureOverlay_},b.prototype.setHitTolerance=function(a){this.hitTolerance_=a},b.prototype.setMap=function(b){var c=this.getMap(),d=this.featureOverlay_.getSource().getFeaturesCollection();c&&d.forEach(c.unskipFeature.bind(c)),a.prototype.setMap.call(this,b),this.featureOverlay_.setMap(b),b&&d.forEach(b.skipFeature.bind(b))},b.prototype.addFeature_=function(a){var b=this.getMap();b&&b.skipFeature(a.element)},b.prototype.removeFeature_=function(a){var b=this.getMap();b&&b.unskipFeature(a.element)},b.prototype.removeFeatureLayerAssociation_=function(a){var b=(0,g.getUid)(a);delete this.featureLayerAssociation_[b]},b}(o.default),w=v;c.default=w},{"../CollectionEventType.js":8,"../array.js":46,"../events.js":66,"../events/Event.js":67,"../events/condition.js":71,"../functions.js":126,"../geom/GeometryType.js":132,"../interaction/Interaction.js":173,"../layer/Vector.js":194,"../obj.js":201,"../source/Vector.js":304,"../style/Style.js":331,"../util.js":342}],183:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=this.snapTo(a.pixel,a.coordinate,a.map);return b.snapped&&(a.coordinate=b.vertex.slice(0,2),a.pixel=b.vertexPixel),s.handleEvent.call(this,a)}function g(a){var b=(0,t.getValues)(this.pendingFeatures_);return b.length&&(b.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}function h(a,b){return(0,l.squaredDistanceToSegment)(this.pixelCoordinate_,a.segment)-(0,l.squaredDistanceToSegment)(this.pixelCoordinate_,b.segment)}Object.defineProperty(c,"__esModule",{value:!0}),c.handleEvent=f,c.default=void 0;var i=a("../util.js"),j=a("../Collection.js"),k=e(a("../CollectionEventType.js")),l=a("../coordinate.js"),m=a("../events.js"),n=e(a("../events/EventType.js")),o=a("../extent.js"),p=a("../functions.js"),q=e(a("../geom/GeometryType.js")),r=a("../geom/Polygon.js"),s=d(a("../interaction/Pointer.js")),t=a("../obj.js"),u=a("../source/Vector.js"),v=e(a("../source/VectorEventType.js")),w=e(a("../structs/RBush.js")),x=function(a){function b(b){a.call(this,{handleEvent:f,handleDownEvent:p.TRUE,handleUpEvent:g,stopDown:p.FALSE});var c=b||{};this.source_=c.source?c.source:null,this.vertex_=void 0===c.vertex||c.vertex,this.edge_=void 0===c.edge||c.edge,this.features_=c.features?c.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==c.pixelTolerance?c.pixelTolerance:10,this.sortByDistance_=h.bind(this),this.rBush_=new w.default,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a,b){var c=void 0===b||b,d=(0,i.getUid)(a),e=a.getGeometry();if(e){var f=this.SEGMENT_WRITERS_[e.getType()];f&&(this.indexedFeaturesExtents_[d]=e.getExtent((0,o.createEmpty)()),f.call(this,a,e))}c&&(this.featureChangeListenerKeys_[d]=(0,m.listen)(a,n.default.CHANGE,this.handleFeatureChange_,this))},b.prototype.forEachFeatureAdd_=function(a){this.addFeature(a)},b.prototype.forEachFeatureRemove_=function(a){this.removeFeature(a)},b.prototype.getFeatures_=function(){var a;return this.features_?a=this.features_:this.source_&&(a=this.source_.getFeatures()),a},b.prototype.handleFeatureAdd_=function(a){var b;a instanceof u.VectorSourceEvent?b=a.feature:a instanceof j.CollectionEvent&&(b=a.element),this.addFeature(b)},b.prototype.handleFeatureRemove_=function(a){var b;a instanceof u.VectorSourceEvent?b=a.feature:a instanceof j.CollectionEvent&&(b=a.element),this.removeFeature(b)},b.prototype.handleFeatureChange_=function(a){var b=a.target;if(this.handlingDownUpSequence){var c=(0,i.getUid)(b);c in this.pendingFeatures_||(this.pendingFeatures_[c]=b)}else this.updateFeature_(b)},b.prototype.removeFeature=function(a,b){var c=void 0===b||b,d=(0,i.getUid)(a),e=this.indexedFeaturesExtents_[d];if(e){var f=this.rBush_,g=[];f.forEachInExtent(e,function(b){a===b.feature&&g.push(b)});for(var h=g.length-1;h>=0;--h)f.remove(g[h])}c&&((0,m.unlistenByKey)(this.featureChangeListenerKeys_[d]),delete this.featureChangeListenerKeys_[d])},
b.prototype.setMap=function(b){var c=this.getMap(),d=this.featuresListenerKeys_,e=this.getFeatures_();c&&(d.forEach(m.unlistenByKey),d.length=0,e.forEach(this.forEachFeatureRemove_.bind(this))),a.prototype.setMap.call(this,b),b&&(this.features_?d.push((0,m.listen)(this.features_,k.default.ADD,this.handleFeatureAdd_,this),(0,m.listen)(this.features_,k.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&d.push((0,m.listen)(this.source_,v.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,m.listen)(this.source_,v.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),e.forEach(this.forEachFeatureAdd_.bind(this)))},b.prototype.snapTo=function(a,b,c){var d=c.getCoordinateFromPixel([a[0]-this.pixelTolerance_,a[1]+this.pixelTolerance_]),e=c.getCoordinateFromPixel([a[0]+this.pixelTolerance_,a[1]-this.pixelTolerance_]),f=(0,o.boundingExtent)([d,e]),g=this.rBush_.getInExtent(f);this.vertex_&&!this.edge_&&(g=g.filter(function(a){return a.feature.getGeometry().getType()!==q.default.CIRCLE}));var h,i,j,k,m,n=!1,p=null,r=null;if(g.length>0){this.pixelCoordinate_=b,g.sort(this.sortByDistance_);var s=g[0].segment,t=g[0].feature.getGeometry().getType()===q.default.CIRCLE;this.vertex_&&!this.edge_?(i=c.getPixelFromCoordinate(s[0]),j=c.getPixelFromCoordinate(s[1]),k=(0,l.squaredDistance)(a,i),m=(0,l.squaredDistance)(a,j),h=Math.sqrt(Math.min(k,m)),h<=this.pixelTolerance_&&(n=!0,p=k>m?s[1]:s[0],r=c.getPixelFromCoordinate(p))):this.edge_&&(p=t?(0,l.closestOnCircle)(b,g[0].feature.getGeometry()):(0,l.closestOnSegment)(b,s),r=c.getPixelFromCoordinate(p),(0,l.distance)(a,r)<=this.pixelTolerance_&&(n=!0,this.vertex_&&!t&&(i=c.getPixelFromCoordinate(s[0]),j=c.getPixelFromCoordinate(s[1]),k=(0,l.squaredDistance)(r,i),m=(0,l.squaredDistance)(r,j),h=Math.sqrt(Math.min(k,m)),h<=this.pixelTolerance_&&(p=k>m?s[1]:s[0],r=c.getPixelFromCoordinate(p))))),n&&(r=[Math.round(r[0]),Math.round(r[1])])}return{snapped:n,vertex:p,vertexPixel:r}},b.prototype.updateFeature_=function(a){this.removeFeature(a,!1),this.addFeature(a,!1)},b.prototype.writeCircleGeometry_=function(a,b){for(var c=this,d=(0,r.fromCircle)(b),e=d.getCoordinates()[0],f=0,g=e.length-1;f<g;++f){var h=e.slice(f,f+2),i={feature:a,segment:h};c.rBush_.insert((0,o.boundingExtent)(h),i)}},b.prototype.writeGeometryCollectionGeometry_=function(a,b){for(var c=this,d=b.getGeometriesArray(),e=0;e<d.length;++e){var f=c.SEGMENT_WRITERS_[d[e].getType()];f&&f.call(c,a,d[e])}},b.prototype.writeLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length-1;e<f;++e){var g=d.slice(e,e+2),h={feature:a,segment:g};c.rBush_.insert((0,o.boundingExtent)(g),h)}},b.prototype.writeMultiLineStringGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e)for(var g=d[e],h=0,i=g.length-1;h<i;++h){var j=g.slice(h,h+2),k={feature:a,segment:j};c.rBush_.insert((0,o.boundingExtent)(j),k)}},b.prototype.writeMultiPointGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e){var g=d[e],h={feature:a,segment:[g,g]};c.rBush_.insert(b.getExtent(),h)}},b.prototype.writeMultiPolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e)for(var g=d[e],h=0,i=g.length;h<i;++h)for(var j=g[h],k=0,l=j.length-1;k<l;++k){var m=j.slice(k,k+2),n={feature:a,segment:m};c.rBush_.insert((0,o.boundingExtent)(m),n)}},b.prototype.writePointGeometry_=function(a,b){var c=b.getCoordinates(),d={feature:a,segment:[c,c]};this.rBush_.insert(b.getExtent(),d)},b.prototype.writePolygonGeometry_=function(a,b){for(var c=this,d=b.getCoordinates(),e=0,f=d.length;e<f;++e)for(var g=d[e],h=0,i=g.length-1;h<i;++h){var j=g.slice(h,h+2),k={feature:a,segment:j};c.rBush_.insert((0,o.boundingExtent)(j),k)}},b}(s.default),y=x;c.default=y},{"../Collection.js":7,"../CollectionEventType.js":8,"../coordinate.js":62,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../functions.js":126,"../geom/GeometryType.js":132,"../geom/Polygon.js":139,"../interaction/Pointer.js":180,"../obj.js":201,"../source/Vector.js":304,"../source/VectorEventType.js":305,"../structs/RBush.js":317,"../util.js":342}],184:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(this.lastFeature_=this.featuresAtPixel_(a.pixel,a.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=a.coordinate,h.call(this,a);var b=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new r(q.TRANSLATESTART,b,a.coordinate)),!0}return!1}function f(a){if(this.lastCoordinate_){this.lastCoordinate_=null,h.call(this,a);var b=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new r(q.TRANSLATEEND,b,a.coordinate)),!0}return!1}function g(a){if(this.lastCoordinate_){var b=a.coordinate,c=b[0]-this.lastCoordinate_[0],d=b[1]-this.lastCoordinate_[1],e=this.features_||new i.default([this.lastFeature_]);e.forEach(function(a){var b=a.getGeometry();b.translate(c,d),a.setGeometry(b)}),this.lastCoordinate_=b,this.dispatchEvent(new r(q.TRANSLATING,e,b))}}function h(a){var b=a.map.getViewport();this.featuresAtPixel_(a.pixel,a.map)?(b.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),b.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):b.classList.remove("ol-grab","ol-grabbing")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.TranslateEvent=void 0;var i=d(a("../Collection.js")),j=a("../Object.js"),k=a("../events.js"),l=d(a("../events/Event.js")),m=a("../functions.js"),n=a("../array.js"),o=d(a("../interaction/Pointer.js")),p=d(a("../interaction/Property.js")),q={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},r=function(a){function b(b,c,d){a.call(this,b),this.features=c,this.coordinate=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default);c.TranslateEvent=r;var s=function(a){function b(b){a.call(this,{handleDownEvent:e,handleDragEvent:g,handleMoveEvent:h,handleUpEvent:f});var c=b||{};this.lastCoordinate_=null,this.features_=void 0!==c.features?c.features:null;var d;if(c.layers)if("function"==typeof c.layers)d=c.layers;else{var i=c.layers;d=function(a){return(0,n.includes)(i,a)}}else d=m.TRUE;this.layerFilter_=d,this.hitTolerance_=c.hitTolerance?c.hitTolerance:0,this.lastFeature_=null,(0,k.listen)(this,(0,j.getChangeEventType)(p.default.ACTIVE),this.handleActiveChanged_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.featuresAtPixel_=function(a,b){return b.forEachFeatureAtPixel(a,function(a){if(!this.features_||(0,n.includes)(this.features_.getArray(),a))return a}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},b.prototype.getHitTolerance=function(){return this.hitTolerance_},b.prototype.setHitTolerance=function(a){this.hitTolerance_=a},b.prototype.setMap=function(b){var c=this.getMap();a.prototype.setMap.call(this,b),this.updateState_(c)},b.prototype.handleActiveChanged_=function(){this.updateState_(null)},b.prototype.updateState_=function(a){var b=this.getMap(),c=this.getActive();if((!b||!c)&&(b=b||a)){b.getViewport().classList.remove("ol-grab","ol-grabbing")}},b}(o.default),t=s;c.default=t},{"../Collection.js":7,"../Object.js":29,"../array.js":46,"../events.js":66,"../events/Event.js":67,"../functions.js":126,"../interaction/Pointer.js":180,"../interaction/Property.js":181}],185:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Group",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"Heatmap",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Layer",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Tile",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"Vector",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"VectorTile",{enumerable:!0,get:function(){return k.default}});var e=d(a("./layer/Group.js")),f=d(a("./layer/Heatmap.js")),g=d(a("./layer/Image.js")),h=d(a("./layer/Layer.js")),i=d(a("./layer/Tile.js")),j=d(a("./layer/Vector.js")),k=d(a("./layer/VectorTile.js"))},{"./layer/Group.js":187,"./layer/Heatmap.js":188,"./layer/Image.js":189,"./layer/Layer.js":190,"./layer/Tile.js":192,"./layer/Vector.js":194,"./layer/VectorTile.js":196}],186:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Object.js")),f=d(a("../layer/Property.js")),g=a("../math.js"),h=a("../obj.js"),i=function(a){function b(b){a.call(this);var c=(0,h.assign)({},b);c[f.default.OPACITY]=void 0!==b.opacity?b.opacity:1,c[f.default.VISIBLE]=void 0===b.visible||b.visible,c[f.default.Z_INDEX]=b.zIndex,c[f.default.MAX_RESOLUTION]=void 0!==b.maxResolution?b.maxResolution:1/0,c[f.default.MIN_RESOLUTION]=void 0!==b.minResolution?b.minResolution:0,this.setProperties(c),this.state_={layer:this,managed:!0},this.type}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return this.type},b.prototype.getLayerState=function(){return this.state_.opacity=(0,g.clamp)(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex()||0,this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},b.prototype.getLayersArray=function(a){},b.prototype.getLayerStatesArray=function(a){},b.prototype.getExtent=function(){return this.get(f.default.EXTENT)},b.prototype.getMaxResolution=function(){return this.get(f.default.MAX_RESOLUTION)},b.prototype.getMinResolution=function(){return this.get(f.default.MIN_RESOLUTION)},b.prototype.getOpacity=function(){return this.get(f.default.OPACITY)},b.prototype.getSourceState=function(){},b.prototype.getVisible=function(){return this.get(f.default.VISIBLE)},b.prototype.getZIndex=function(){return this.get(f.default.Z_INDEX)},b.prototype.setExtent=function(a){this.set(f.default.EXTENT,a)},b.prototype.setMaxResolution=function(a){this.set(f.default.MAX_RESOLUTION,a)},b.prototype.setMinResolution=function(a){this.set(f.default.MIN_RESOLUTION,a)},b.prototype.setOpacity=function(a){this.set(f.default.OPACITY,a)},b.prototype.setVisible=function(a){this.set(f.default.VISIBLE,a)},b.prototype.setZIndex=function(a){this.set(f.default.Z_INDEX,a)},b}(e.default),j=i;c.default=j},{"../Object.js":29,"../layer/Property.js":191,"../math.js":199,"../obj.js":201}],187:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("../Collection.js")),g=d(a("../CollectionEventType.js")),h=a("../Object.js"),i=d(a("../ObjectEventType.js")),j=a("../asserts.js"),k=a("../events.js"),l=d(a("../events/EventType.js")),m=a("../extent.js"),n=d(a("../layer/Base.js")),o=a("../obj.js"),p=d(a("../source/State.js")),q={LAYERS:"layers"},r=function(a){function b(b){var c=b||{},d=(0,o.assign)({},c);delete d.layers;var e=c.layers;a.call(this,d),this.layersListenerKeys_=[],this.listenerKeys_={},(0,k.listen)(this,(0,h.getChangeEventType)(q.LAYERS),this.handleLayersChanged_,this),e?Array.isArray(e)?e=new f.default(e.slice(),{unique:!0}):((0,j.assert)(e instanceof f.default,43),e=e):e=new f.default(void 0,{unique:!0}),this.setLayers(e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleLayerChange_=function(){this.changed()},b.prototype.handleLayersChanged_=function(){var a=this;this.layersListenerKeys_.forEach(k.unlistenByKey),this.layersListenerKeys_.length=0;var b=this.getLayers();this.layersListenerKeys_.push((0,k.listen)(b,g.default.ADD,this.handleLayersAdd_,this),(0,k.listen)(b,g.default.REMOVE,this.handleLayersRemove_,this));for(var c in a.listenerKeys_)a.listenerKeys_[c].forEach(k.unlistenByKey);(0,o.clear)(this.listenerKeys_);for(var d=b.getArray(),f=0,h=d.length;f<h;f++){var j=d[f];a.listenerKeys_[(0,e.getUid)(j).toString()]=[(0,k.listen)(j,i.default.PROPERTYCHANGE,a.handleLayerChange_,a),(0,k.listen)(j,l.default.CHANGE,a.handleLayerChange_,a)]}this.changed()},b.prototype.handleLayersAdd_=function(a){var b=a.element,c=(0,e.getUid)(b).toString();this.listenerKeys_[c]=[(0,k.listen)(b,i.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,k.listen)(b,l.default.CHANGE,this.handleLayerChange_,this)],this.changed()},b.prototype.handleLayersRemove_=function(a){var b=a.element,c=(0,e.getUid)(b).toString();this.listenerKeys_[c].forEach(k.unlistenByKey),delete this.listenerKeys_[c],this.changed()},b.prototype.getLayers=function(){return this.get(q.LAYERS)},b.prototype.setLayers=function(a){this.set(q.LAYERS,a)},b.prototype.getLayersArray=function(a){var b=void 0!==a?a:[];return this.getLayers().forEach(function(a){a.getLayersArray(b)}),b},b.prototype.getLayerStatesArray=function(a){var b=void 0!==a?a:[],c=b.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(b)});for(var d=this.getLayerState(),e=c,f=b.length;e<f;e++){var g=b[e];g.opacity*=d.opacity,g.visible=g.visible&&d.visible,g.maxResolution=Math.min(g.maxResolution,d.maxResolution),g.minResolution=Math.max(g.minResolution,d.minResolution),void 0!==d.extent&&(void 0!==g.extent?g.extent=(0,m.getIntersection)(g.extent,d.extent):g.extent=d.extent)}return b},b.prototype.getSourceState=function(){return p.default.READY},b}(n.default),s=r;c.default=s},{"../Collection.js":7,"../CollectionEventType.js":8,"../Object.js":29,"../ObjectEventType.js":30,"../asserts.js":47,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../layer/Base.js":186,"../obj.js":201,"../source/State.js":294,"../util.js":342}],188:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){for(var b=1,c=256,d=(0,h.createCanvasContext2D)(b,c),e=d.createLinearGradient(0,0,b,c),f=1/(a.length-1),g=0,i=a.length;g<i;++g)e.addColorStop(g*f,a[g]);return d.fillStyle=e,d.fillRect(0,0,b,c),d.getImageData(0,0,b,c).data}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../events.js"),g=a("../Object.js"),h=a("../dom.js"),i=d(a("../layer/Vector.js")),j=a("../math.js"),k=a("../obj.js"),l=d(a("../render/EventType.js")),m=d(a("../style/Icon.js")),n=d(a("../style/Style.js")),o={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},p=["#00f","#0ff","#0f0","#ff0","#f00"],q=function(a){function b(b){var c=b||{},d=(0,k.assign)({},c);delete d.gradient,delete d.radius,delete d.blur,delete d.shadow,delete d.weight,a.call(this,d),this.gradient_=null,this.shadow_=void 0!==c.shadow?c.shadow:250,this.circleImage_=void 0,this.styleCache_=null,(0,f.listen)(this,(0,g.getChangeEventType)(o.GRADIENT),this.handleGradientChanged_,this),this.setGradient(c.gradient?c.gradient:p),this.setBlur(void 0!==c.blur?c.blur:15),this.setRadius(void 0!==c.radius?c.radius:8),(0,f.listen)(this,(0,g.getChangeEventType)(o.BLUR),this.handleStyleChanged_,this),(0,f.listen)(this,(0,g.getChangeEventType)(o.RADIUS),this.handleStyleChanged_,this),this.handleStyleChanged_();var e,h=c.weight?c.weight:"weight";e="string"==typeof h?function(a){return a.get(h)}:h,this.setStyle(function(a,b){var c=e(a),d=void 0!==c?(0,j.clamp)(c,0,1):1,f=255*d|0,g=this.styleCache_[f];return g||(g=[new n.default({image:new m.default({opacity:d,src:this.circleImage_})})],this.styleCache_[f]=g),g}.bind(this)),this.setRenderOrder(null),(0,f.listen)(this,l.default.RENDER,this.handleRender_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createCircle_=function(){var a=this.getRadius(),b=this.getBlur(),c=a+b+1,d=2*c,e=(0,h.createCanvasContext2D)(d,d);e.shadowOffsetX=e.shadowOffsetY=this.shadow_,e.shadowBlur=b,e.shadowColor="#000",e.beginPath();var f=c-this.shadow_;return e.arc(f,f,a,0,2*Math.PI,!0),e.fill(),e.canvas.toDataURL()},b.prototype.getBlur=function(){return this.get(o.BLUR)},b.prototype.getGradient=function(){return this.get(o.GRADIENT)},b.prototype.getRadius=function(){return this.get(o.RADIUS)},b.prototype.handleGradientChanged_=function(){this.gradient_=e(this.getGradient())},b.prototype.handleStyleChanged_=function(){this.circleImage_=this.createCircle_(),this.styleCache_=new Array(256),this.changed()},b.prototype.handleRender_=function(a){for(var b=this,c=a.context,d=c.canvas,e=c.getImageData(0,0,d.width,d.height),f=e.data,g=0,h=f.length;g<h;g+=4){var i=4*f[g+3];i&&(f[g]=b.gradient_[i],f[g+1]=b.gradient_[i+1],f[g+2]=b.gradient_[i+2])}c.putImageData(e,0,0)},b.prototype.setBlur=function(a){this.set(o.BLUR,a)},b.prototype.setGradient=function(a){this.set(o.GRADIENT,a)},b.prototype.setRadius=function(a){this.set(o.RADIUS,a)},b}(i.default),r=q;c.default=r},{"../Object.js":29,"../dom.js":64,"../events.js":66,"../layer/Vector.js":194,"../math.js":199,"../obj.js":201,"../render/EventType.js":220,"../style/Icon.js":323,"../style/Style.js":331}],189:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../LayerType.js")),f=d(a("../layer/Layer.js")),g=function(a){function b(b){var c=b||{};a.call(this,c),this.type=e.default.IMAGE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(f.default);g.prototype.getSource;var h=g;c.default=h},{"../LayerType.js":20,"../layer/Layer.js":190}],190:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return a.visible&&b>=a.minResolution&&b<a.maxResolution}Object.defineProperty(c,"__esModule",{value:!0}),c.visibleAtResolution=e,c.default=void 0;var f=a("../events.js"),g=d(a("../events/EventType.js")),h=a("../util.js"),i=a("../Object.js"),j=d(a("../layer/Base.js")),k=d(a("../layer/Property.js")),l=a("../obj.js"),m=d(a("../render/EventType.js")),n=d(a("../source/State.js")),o=function(a){function b(b){var c=(0,l.assign)({},b);delete c.source,a.call(this,c),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,b.map&&this.setMap(b.map),(0,f.listen)(this,(0,i.getChangeEventType)(k.default.SOURCE),this.handleSourcePropertyChange_,this);var d=b.source?b.source:null;this.setSource(d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getLayersArray=function(a){var b=a||[];return b.push(this),b},b.prototype.getLayerStatesArray=function(a){var b=a||[];return b.push(this.getLayerState()),b},b.prototype.getSource=function(){return this.get(k.default.SOURCE)||null},b.prototype.getSourceState=function(){var a=this.getSource();return a?a.getState():n.default.UNDEFINED},b.prototype.handleSourceChange_=function(){this.changed()},b.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&((0,f.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null);var a=this.getSource();a&&(this.sourceChangeKey_=(0,f.listen)(a,g.default.CHANGE,this.handleSourceChange_,this)),this.changed()},b.prototype.setMap=function(a){this.mapPrecomposeKey_&&((0,f.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),a||this.changed(),this.mapRenderKey_&&((0,f.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),a&&(this.mapPrecomposeKey_=(0,f.listen)(a,m.default.PRECOMPOSE,function(a){var b=this.getLayerState();b.managed=!1,void 0===this.getZIndex()&&(b.zIndex=1/0),a.frameState.layerStatesArray.push(b),a.frameState.layerStates[(0,h.getUid)(this)]=b},this),this.mapRenderKey_=(0,f.listen)(this,g.default.CHANGE,a.render,a),this.changed())},b.prototype.setSource=function(a){this.set(k.default.SOURCE,a)},b}(j.default),p=o;c.default=p},{"../Object.js":29,"../events.js":66,"../events/EventType.js":68,"../layer/Base.js":186,"../layer/Property.js":191,"../obj.js":201,"../render/EventType.js":220,"../source/State.js":294,"../util.js":342}],191:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};c.default=d},{}],192:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../LayerType.js")),f=d(a("../layer/Layer.js")),g=d(a("../layer/TileProperty.js")),h=a("../obj.js"),i=function(a){function b(b){var c=b||{},d=(0,h.assign)({},c);delete d.preload,delete d.useInterimTilesOnError,a.call(this,d),this.setPreload(void 0!==c.preload?c.preload:0),this.setUseInterimTilesOnError(void 0===c.useInterimTilesOnError||c.useInterimTilesOnError),this.type=e.default.TILE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPreload=function(){return this.get(g.default.PRELOAD)},b.prototype.setPreload=function(a){this.set(g.default.PRELOAD,a)},b.prototype.getUseInterimTilesOnError=function(){return this.get(g.default.USE_INTERIM_TILES_ON_ERROR)},b.prototype.setUseInterimTilesOnError=function(a){this.set(g.default.USE_INTERIM_TILES_ON_ERROR,a)},b}(f.default);i.prototype.getSource;var j=i;c.default=j},{"../LayerType.js":20,"../layer/Layer.js":190,"../layer/TileProperty.js":193,"../obj.js":201}],193:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};c.default=d},{}],194:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.RenderType=void 0;var e=d(a("../LayerType.js")),f=d(a("../layer/Layer.js")),g=d(a("../layer/VectorRenderType.js")),h=a("../obj.js"),i=a("../style/Style.js"),j={IMAGE:"image",VECTOR:"vector"};c.RenderType=j;var k={RENDER_ORDER:"renderOrder"},l=function(a){function b(b){var c=b||{},d=(0,h.assign)({},c);delete d.style,delete d.renderBuffer,delete d.updateWhileAnimating,delete d.updateWhileInteracting,a.call(this,d),this.declutter_=void 0!==c.declutter&&c.declutter,this.renderBuffer_=void 0!==c.renderBuffer?c.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(c.style),this.updateWhileAnimating_=void 0!==c.updateWhileAnimating&&c.updateWhileAnimating,this.updateWhileInteracting_=void 0!==c.updateWhileInteracting&&c.updateWhileInteracting,this.renderMode_=c.renderMode||g.default.VECTOR,this.type=e.default.VECTOR}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDeclutter=function(){return this.declutter_},b.prototype.setDeclutter=function(a){this.declutter_=a},b.prototype.getRenderBuffer=function(){return this.renderBuffer_},b.prototype.getRenderOrder=function(){return this.get(k.RENDER_ORDER)},b.prototype.getStyle=function(){return this.style_},b.prototype.getStyleFunction=function(){return this.styleFunction_},b.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},b.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},b.prototype.setRenderOrder=function(a){this.set(k.RENDER_ORDER,a)},b.prototype.setStyle=function(a){this.style_=void 0!==a?a:i.createDefaultStyle,this.styleFunction_=null===a?void 0:(0,i.toFunction)(this.style_),this.changed()},b.prototype.getRenderMode=function(){return this.renderMode_},b}(f.default);l.prototype.getSource;var m=l;c.default=m},{"../LayerType.js":20,"../layer/Layer.js":190,"../layer/VectorRenderType.js":195,"../obj.js":201,"../style/Style.js":331}],195:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IMAGE:"image",VECTOR:"vector"};c.default=d},{}],196:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.RenderType=void 0;var e=d(a("../LayerType.js")),f=a("../asserts.js"),g=d(a("../layer/TileProperty.js")),h=d(a("../layer/Vector.js")),i=d(a("../layer/VectorTileRenderType.js")),j=a("../obj.js"),k={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};c.RenderType=k;var l=function(a){function b(b){var c=b||{},d=c.renderMode||i.default.HYBRID;(0,f.assert)(void 0==d||d==i.default.IMAGE||d==i.default.HYBRID||d==i.default.VECTOR,28),c.declutter&&d==i.default.IMAGE&&(d=i.default.HYBRID),c.renderMode=d;var g=(0,j.assign)({},c);delete g.preload,delete g.useInterimTilesOnError,a.call(this,g),this.setPreload(c.preload?c.preload:0),this.setUseInterimTilesOnError(void 0===c.useInterimTilesOnError||c.useInterimTilesOnError),this.type=e.default.VECTOR_TILE}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPreload=function(){return this.get(g.default.PRELOAD)},b.prototype.getUseInterimTilesOnError=function(){return this.get(g.default.USE_INTERIM_TILES_ON_ERROR)},b.prototype.setPreload=function(a){this.set(g.default.PRELOAD,a)},b.prototype.setUseInterimTilesOnError=function(a){this.set(g.default.USE_INTERIM_TILES_ON_ERROR,a)},b}(h.default);l.prototype.getSource;var m=l;c.default=m},{"../LayerType.js":20,"../asserts.js":47,"../layer/TileProperty.js":193,"../layer/Vector.js":194,"../layer/VectorTileRenderType.js":197,"../obj.js":201}],197:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};c.default=d},{}],198:[function(a,b,c){"use strict";function d(a,b){return[[-1/0,-1/0,1/0,1/0]]}function e(a,b){return[a]}function f(a){return function(b,c){var d=a.getZForResolution(c),e=a.getTileRangeForExtentAndZ(b,d),f=[],g=[d,0,0];for(g[1]=e.minX;g[1]<=e.maxX;++g[1])for(g[2]=e.minY;g[2]<=e.maxY;++g[2])f.push(a.getTileCoordExtent(g));return f}}Object.defineProperty(c,"__esModule",{value:!0}),c.all=d,c.bbox=e,c.tile=f},{}],199:[function(a,b,c){"use strict";function d(a,b,c){return Math.min(Math.max(a,b),c)}function e(a){return(0,m.assert)(0<a,29),Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function f(a,b,c,d,e,f){var h=e-c,i=f-d;if(0!==h||0!==i){var j=((a-c)*h+(b-d)*i)/(h*h+i*i);j>1?(c=e,d=f):j>0&&(c+=h*j,d+=i*j)}return g(a,b,c,d)}function g(a,b,c,d){var e=c-a,f=d-b;return e*e+f*f}function h(a){for(var b=a.length,c=0;c<b;c++){for(var d=c,e=Math.abs(a[c][c]),f=c+1;f<b;f++){var g=Math.abs(a[f][c]);g>e&&(e=g,d=f)}if(0===e)return null;var h=a[d];a[d]=a[c],a[c]=h;for(var i=c+1;i<b;i++)for(var j=-a[i][c]/a[c][c],k=c;k<b+1;k++)c==k?a[i][k]=0:a[i][k]+=j*a[c][k]}for(var l=new Array(b),m=b-1;m>=0;m--){l[m]=a[m][b]/a[m][m];for(var n=m-1;n>=0;n--)a[n][b]-=a[n][m]*l[m]}return l}function i(a){return 180*a/Math.PI}function j(a){return a*Math.PI/180}function k(a,b){var c=a%b;return c*b<0?c+b:c}function l(a,b,c){return a+c*(b-a)}Object.defineProperty(c,"__esModule",{value:!0}),c.clamp=d,c.roundUpToPowerOfTwo=e,c.squaredSegmentDistance=f,c.squaredDistance=g,c.solveLinearSystem=h,c.toDegrees=i,c.toRadians=j,c.modulo=k,c.lerp=l,c.cosh=void 0;var m=a("./asserts.js"),n=function(){return"cosh"in Math?Math.cosh:function(a){var b=Math.exp(a);return(b+1/b)/2}}();c.cosh=n},{"./asserts.js":47}],200:[function(a,b,c){"use strict";function d(a,b,c,d){function f(){delete window[h],g.parentNode.removeChild(g)}var g=document.createElement("script"),h="olc_"+(0,e.getUid)(b);g.async=!0,g.src=a+(-1==a.indexOf("?")?"?":"&")+(d||"callback")+"="+h;var i=setTimeout(function(){f(),c&&c()},1e4);window[h]=function(a){clearTimeout(i),f(),b(a)},document.getElementsByTagName("head")[0].appendChild(g)}Object.defineProperty(c,"__esModule",{value:!0}),c.jsonp=d;var e=a("./util.js")},{"./util.js":342}],201:[function(a,b,c){"use strict";function d(a){for(var b in a)delete a[b]}function e(a){var b=[];for(var c in a)b.push(a[c]);return b}function f(a){var b;for(b in a)return!1;return!b}Object.defineProperty(c,"__esModule",{value:!0}),c.clear=d,c.getValues=e,c.isEmpty=f,c.assign=void 0;var g="function"==typeof Object.assign?Object.assign:function(a,b){var c=arguments;if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var d=Object(a),e=1,f=arguments.length;e<f;++e){var g=c[e];if(void 0!==g&&null!==g)for(var h in g)g.hasOwnProperty(h)&&(d[h]=g[h])}return d};c.assign=g},{}],202:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a,b){this.dispatcher=a,this.mapping_=b};d.prototype.getEvents=function(){return Object.keys(this.mapping_)},d.prototype.getHandlerForEvent=function(a){return this.mapping_[a]};var e=d;c.default=e},{}],203:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};c.default=d},{}],204:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(!this.isEventSimulatedFromTouch_(a)){l.toString()in this.pointerMap&&this.cancel(a);var b=j(a,this.dispatcher);this.pointerMap[l.toString()]=a,this.dispatcher.down(b,a)}}function f(a){if(!this.isEventSimulatedFromTouch_(a)){var b=j(a,this.dispatcher);this.dispatcher.move(b,a)}}function g(a){if(!this.isEventSimulatedFromTouch_(a)){var b=this.pointerMap[l.toString()];if(b&&b.button===a.button){var c=j(a,this.dispatcher);this.dispatcher.up(c,a),this.cleanupMouse()}}}function h(a){if(!this.isEventSimulatedFromTouch_(a)){var b=j(a,this.dispatcher);this.dispatcher.enterOver(b,a)}}function i(a){if(!this.isEventSimulatedFromTouch_(a)){var b=j(a,this.dispatcher);this.dispatcher.leaveOut(b,a)}}function j(a,b){var c=b.cloneEvent(a,a),d=c.preventDefault;return c.preventDefault=function(){a.preventDefault(),d()},c.pointerId=l,c.isPrimary=!0,c.pointerType=m,c}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.POINTER_TYPE=c.POINTER_ID=void 0;var k=d(a("../pointer/EventSource.js")),l=1;c.POINTER_ID=l;var m="mouse";c.POINTER_TYPE=m;var n=25,o=function(a){function b(b){var c={mousedown:e,mousemove:f,mouseup:g,mouseover:h,mouseout:i};a.call(this,b,c),this.pointerMap=b.pointerMap,this.lastTouches=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.isEventSimulatedFromTouch_=function(a){for(var b=this.lastTouches,c=a.clientX,d=a.clientY,e=0,f=b.length,g=void 0;e<f&&(g=b[e]);e++){var h=Math.abs(c-g[0]),i=Math.abs(d-g[1]);if(h<=n&&i<=n)return!0}return!1},b.prototype.cancel=function(a){var b=j(a,this.dispatcher);this.dispatcher.cancel(b,a),this.cleanupMouse()},b.prototype.cleanupMouse=function(){delete this.pointerMap[l.toString()]},b}(k.default),p=o;c.default=p},{"../pointer/EventSource.js":202}],205:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){this.pointerMap[a.pointerId.toString()]=a;var b=this.prepareEvent_(a);this.dispatcher.down(b,a)}function f(a){var b=this.prepareEvent_(a);this.dispatcher.move(b,a)}function g(a){var b=this.prepareEvent_(a);this.dispatcher.up(b,a),this.cleanup(a.pointerId)}function h(a){var b=this.prepareEvent_(a);this.dispatcher.leaveOut(b,a)}function i(a){var b=this.prepareEvent_(a);this.dispatcher.enterOver(b,a)}function j(a){var b=this.prepareEvent_(a);this.dispatcher.cancel(b,a),this.cleanup(a.pointerId)}function k(a){var b=this.dispatcher.makeEvent("lostpointercapture",a,a);this.dispatcher.dispatchEvent(b)}function l(a){var b=this.dispatcher.makeEvent("gotpointercapture",a,a);this.dispatcher.dispatchEvent(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0
;var m=d(a("../pointer/EventSource.js")),n=["","unavailable","touch","pen","mouse"],o=function(a){function b(b){var c={MSPointerDown:e,MSPointerMove:f,MSPointerUp:g,MSPointerOut:h,MSPointerOver:i,MSPointerCancel:j,MSGotPointerCapture:l,MSLostPointerCapture:k};a.call(this,b,c),this.pointerMap=b.pointerMap}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.prepareEvent_=function(a){var b=a;return"number"==typeof a.pointerType&&(b=this.dispatcher.cloneEvent(a,a),b.pointerType=n[a.pointerType]),b},b.prototype.cleanup=function(a){delete this.pointerMap[a.toString()]},b}(m.default),p=o;c.default=p},{"../pointer/EventSource.js":202}],206:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){this.dispatcher.fireNativeEvent(a)}function f(a){this.dispatcher.fireNativeEvent(a)}function g(a){this.dispatcher.fireNativeEvent(a)}function h(a){this.dispatcher.fireNativeEvent(a)}function i(a){this.dispatcher.fireNativeEvent(a)}function j(a){this.dispatcher.fireNativeEvent(a)}function k(a){this.dispatcher.fireNativeEvent(a)}function l(a){this.dispatcher.fireNativeEvent(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var m=d(a("../pointer/EventSource.js")),n=function(a){function b(b){var c={pointerdown:e,pointermove:f,pointerup:g,pointerout:h,pointerover:i,pointercancel:j,gotpointercapture:l,lostpointercapture:k};a.call(this,b,c)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m.default),o=n;c.default=o},{"../pointer/EventSource.js":202}],207:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../events/Event.js")),f=!1,g=function(a){function b(b,c,d){a.call(this,b),this.originalEvent=c;var e=d||{};this.buttons=this.getButtons_(e),this.pressure=this.getPressure_(e,this.buttons),this.bubbles="bubbles"in e&&e.bubbles,this.cancelable="cancelable"in e&&e.cancelable,this.view="view"in e?e.view:null,this.detail="detail"in e?e.detail:null,this.screenX="screenX"in e?e.screenX:0,this.screenY="screenY"in e?e.screenY:0,this.clientX="clientX"in e?e.clientX:0,this.clientY="clientY"in e?e.clientY:0,this.ctrlKey="ctrlKey"in e&&e.ctrlKey,this.altKey="altKey"in e&&e.altKey,this.shiftKey="shiftKey"in e&&e.shiftKey,this.metaKey="metaKey"in e&&e.metaKey,this.button="button"in e?e.button:0,this.relatedTarget="relatedTarget"in e?e.relatedTarget:null,this.pointerId="pointerId"in e?e.pointerId:0,this.width="width"in e?e.width:0,this.height="height"in e?e.height:0,this.tiltX="tiltX"in e?e.tiltX:0,this.tiltY="tiltY"in e?e.tiltY:0,this.pointerType="pointerType"in e?e.pointerType:"",this.hwTimestamp="hwTimestamp"in e?e.hwTimestamp:0,this.isPrimary="isPrimary"in e&&e.isPrimary,c.preventDefault&&(this.preventDefault=function(){c.preventDefault()})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getButtons_=function(a){var b;if(a.buttons||f)b=a.buttons;else switch(a.which){case 1:b=1;break;case 2:b=4;break;case 3:b=2;break;default:b=0}return b},b.prototype.getPressure_=function(a,b){return a.pressure?a.pressure:b?.5:0},b}(e.default);!function(){try{var a=new MouseEvent("click",{buttons:1});f=1===a.buttons}catch(a){}}();var h=g;c.default=h},{"../events/Event.js":67}],208:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../events.js"),f=d(a("../events/Target.js")),g=a("../has.js"),h=d(a("../pointer/EventType.js")),i=d(a("../pointer/MouseSource.js")),j=d(a("../pointer/MsSource.js")),k=d(a("../pointer/NativeSource.js")),l=d(a("../pointer/PointerEvent.js")),m=d(a("../pointer/TouchSource.js")),n=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],o=function(a){function b(b){a.call(this),this.element_=b,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.registerSources=function(){if(g.POINTER)this.registerSource("native",new k.default(this));else if(g.MSPOINTER)this.registerSource("ms",new j.default(this));else{var a=new i.default(this);this.registerSource("mouse",a),g.TOUCH&&this.registerSource("touch",new m.default(this,a))}this.register_()},b.prototype.registerSource=function(a,b){var c=b,d=c.getEvents();d&&(d.forEach(function(a){var b=c.getHandlerForEvent(a);b&&(this.eventMap_[a]=b.bind(c))}.bind(this)),this.eventSourceList_.push(c))},b.prototype.register_=function(){for(var a=this,b=this.eventSourceList_.length,c=0;c<b;c++){var d=a.eventSourceList_[c];a.addEvents_(d.getEvents())}},b.prototype.unregister_=function(){for(var a=this,b=this.eventSourceList_.length,c=0;c<b;c++){var d=a.eventSourceList_[c];a.removeEvents_(d.getEvents())}},b.prototype.eventHandler_=function(a){var b=a.type,c=this.eventMap_[b];c&&c(a)},b.prototype.addEvents_=function(a){a.forEach(function(a){(0,e.listen)(this.element_,a,this.eventHandler_,this)}.bind(this))},b.prototype.removeEvents_=function(a){a.forEach(function(a){(0,e.unlisten)(this.element_,a,this.eventHandler_,this)}.bind(this))},b.prototype.cloneEvent=function(a,b){for(var c={},d=0,e=n.length;d<e;d++){var f=n[d][0];c[f]=a[f]||b[f]||n[d][1]}return c},b.prototype.down=function(a,b){this.fireEvent(h.default.POINTERDOWN,a,b)},b.prototype.move=function(a,b){this.fireEvent(h.default.POINTERMOVE,a,b)},b.prototype.up=function(a,b){this.fireEvent(h.default.POINTERUP,a,b)},b.prototype.enter=function(a,b){a.bubbles=!1,this.fireEvent(h.default.POINTERENTER,a,b)},b.prototype.leave=function(a,b){a.bubbles=!1,this.fireEvent(h.default.POINTERLEAVE,a,b)},b.prototype.over=function(a,b){a.bubbles=!0,this.fireEvent(h.default.POINTEROVER,a,b)},b.prototype.out=function(a,b){a.bubbles=!0,this.fireEvent(h.default.POINTEROUT,a,b)},b.prototype.cancel=function(a,b){this.fireEvent(h.default.POINTERCANCEL,a,b)},b.prototype.leaveOut=function(a,b){this.out(a,b),this.contains_(a.target,a.relatedTarget)||this.leave(a,b)},b.prototype.enterOver=function(a,b){this.over(a,b),this.contains_(a.target,a.relatedTarget)||this.enter(a,b)},b.prototype.contains_=function(a,b){return!(!a||!b)&&a.contains(b)},b.prototype.makeEvent=function(a,b,c){return new l.default(a,c,b)},b.prototype.fireEvent=function(a,b,c){var d=this.makeEvent(a,b,c);this.dispatchEvent(d)},b.prototype.fireNativeEvent=function(a){var b=this.makeEvent(a.type,a,a);this.dispatchEvent(b)},b.prototype.wrapMouseEvent=function(a,b){return this.makeEvent(a,i.default.prepareEvent(b,this),b)},b.prototype.disposeInternal=function(){this.unregister_(),a.prototype.disposeInternal.call(this)},b}(f.default),p=o;c.default=p},{"../events.js":66,"../events/Target.js":70,"../has.js":161,"../pointer/EventType.js":203,"../pointer/MouseSource.js":204,"../pointer/MsSource.js":205,"../pointer/NativeSource.js":206,"../pointer/PointerEvent.js":207,"../pointer/TouchSource.js":209}],209:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){this.vacuumTouches_(a),this.setPrimaryTouch_(a.changedTouches[0]),this.dedupSynthMouse_(a),this.clickCount_++,this.processTouches_(a,this.overDown_)}function f(a){this.processTouches_(a,this.moveOverOut_)}function g(a){this.dedupSynthMouse_(a),this.processTouches_(a,this.upOut_)}function h(a){this.processTouches_(a,this.cancelOut_)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var i=a("../array.js"),j=d(a("../pointer/EventSource.js")),k=a("../pointer/MouseSource.js"),l=200,m="touch",n=function(a){function b(b,c){var d={touchstart:e,touchmove:f,touchend:g,touchcancel:h};a.call(this,b,d),this.pointerMap=b.pointerMap,this.mouseSource=c,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.isPrimaryTouch_=function(a){return this.firstTouchId_===a.identifier},b.prototype.setPrimaryTouch_=function(a){var b=Object.keys(this.pointerMap).length;(0===b||1===b&&k.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=a.identifier,this.cancelResetClickCount_())},b.prototype.removePrimaryPointer_=function(a){a.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},b.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),l)},b.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},b.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},b.prototype.touchToPointer_=function(a,b){var c=this.dispatcher.cloneEvent(a,b);return c.pointerId=b.identifier+2,c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount_,c.button=0,c.buttons=1,c.width=b.webkitRadiusX||b.radiusX||0,c.height=b.webkitRadiusY||b.radiusY||0,c.pressure=b.webkitForce||b.force||.5,c.isPrimary=this.isPrimaryTouch_(b),c.pointerType=m,c.clientX=b.clientX,c.clientY=b.clientY,c.screenX=b.screenX,c.screenY=b.screenY,c},b.prototype.processTouches_=function(a,b){function c(){a.preventDefault()}for(var d=this,e=Array.prototype.slice.call(a.changedTouches),f=e.length,g=0;g<f;++g){var h=d.touchToPointer_(a,e[g]);h.preventDefault=c,b.call(d,a,h)}},b.prototype.findTouch_=function(a,b){for(var c=a.length,d=0;d<c;d++){if(a[d].identifier===b)return!0}return!1},b.prototype.vacuumTouches_=function(a){var b=this,c=a.touches,d=Object.keys(this.pointerMap),e=d.length;if(e>=c.length){for(var f=[],g=0;g<e;++g){var h=d[g],i=b.pointerMap[h];h==k.POINTER_ID||b.findTouch_(c,h-2)||f.push(i.out)}for(var j=0;j<f.length;++j)b.cancelOut_(a,f[j])}},b.prototype.overDown_=function(a,b){this.pointerMap[b.pointerId]={target:b.target,out:b,outTarget:b.target},this.dispatcher.over(b,a),this.dispatcher.enter(b,a),this.dispatcher.down(b,a)},b.prototype.moveOverOut_=function(a,b){var c=b,d=this.pointerMap[c.pointerId];if(d){var e=d.out,f=d.outTarget;this.dispatcher.move(c,a),e&&f!==c.target&&(e.relatedTarget=c.target,c.relatedTarget=f,e.target=f,c.target?(this.dispatcher.leaveOut(e,a),this.dispatcher.enterOver(c,a)):(c.target=f,c.relatedTarget=null,this.cancelOut_(a,c))),d.out=c,d.outTarget=c.target}},b.prototype.upOut_=function(a,b){this.dispatcher.up(b,a),this.dispatcher.out(b,a),this.dispatcher.leave(b,a),this.cleanUpPointer_(b)},b.prototype.cancelOut_=function(a,b){this.dispatcher.cancel(b,a),this.dispatcher.out(b,a),this.dispatcher.leave(b,a),this.cleanUpPointer_(b)},b.prototype.cleanUpPointer_=function(a){delete this.pointerMap[a.pointerId],this.removePrimaryPointer_(a)},b.prototype.dedupSynthMouse_=function(a){var b=this.mouseSource.lastTouches,c=a.changedTouches[0];if(this.isPrimaryTouch_(c)){var d=[c.clientX,c.clientY];b.push(d),setTimeout(function(){(0,i.remove)(b,d)},this.dedupTimeout_)}},b}(j.default),o=n;c.default=o},{"../array.js":46,"../pointer/EventSource.js":202,"../pointer/MouseSource.js":204}],210:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b,c){var d;if(void 0!==b){for(var e=0,f=a.length;e<f;++e)b[e]=a[e];d=b}else d=a.slice();return d}function g(a,b,c){if(void 0!==b&&a!==b){for(var d=0,e=a.length;d<e;++d)b[d]=a[d];a=b}return a}function h(a){H.add(a.getCode(),a),(0,I.add)(a,a,f)}function i(a){a.forEach(h)}function j(a){var b=null;if(a instanceof F.default)b=a;else if("string"==typeof a){var c=a;b=H.get(c)}return b}function k(a,b,c,d){a=j(a);var e,f=a.getPointResolutionFunc();if(f)e=f(b,c);else{if(a.getUnits()==G.default.DEGREES&&!d||d==G.default.DEGREES)e=b;else{var g=u(a,j("EPSG:4326")),h=[c[0]-b/2,c[1],c[0]+b/2,c[1],c[0],c[1]-b/2,c[0],c[1]+b/2];h=g(h,h,2);e=((0,A.getDistance)(h.slice(0,2),h.slice(2,4))+(0,A.getDistance)(h.slice(4,6),h.slice(6,8)))/2;var i=d?G.METERS_PER_UNIT[d]:a.getMetersPerUnit();void 0!==i&&(e/=i)}}return e}function l(a){i(a),a.forEach(function(b){a.forEach(function(a){b!==a&&(0,I.add)(b,a,f)})})}function m(a,b,c,d){a.forEach(function(a){b.forEach(function(b){(0,I.add)(a,b,c),(0,I.add)(b,a,d)})})}function n(){H.clear(),(0,I.clear)()}function o(a,b){return a?"string"==typeof a?j(a):a:j(b)}function p(a){return function(b,c,d){for(var e=b.length,f=void 0!==d?d:2,g=void 0!==c?c:new Array(e),h=0;h<e;h+=f){var i=a([b[h],b[h+1]]);g[h]=i[0],g[h+1]=i[1];for(var j=f-1;j>=2;--j)g[h+j]=b[h+j]}return g}}function q(a,b,c,d){var e=j(a),f=j(b);(0,I.add)(e,f,p(c)),(0,I.add)(f,e,p(d))}function r(a,b){return w(a,"EPSG:4326",void 0!==b?b:"EPSG:3857")}function s(a,b){var c=w(a,void 0!==b?b:"EPSG:3857","EPSG:4326"),d=c[0];return(d<-180||d>180)&&(c[0]=(0,C.modulo)(d+180,360)-180),c}function t(a,b){if(a===b)return!0;var c=a.getUnits()===b.getUnits();return a.getCode()===b.getCode()?c:u(a,b)===f&&c}function u(a,b){var c=a.getCode(),d=b.getCode(),e=(0,I.get)(c,d);return e||(e=g),e}function v(a,b){return u(j(a),j(b))}function w(a,b,c){return v(b,c)(a,void 0,a.length)}function x(a,b,c){var d=v(b,c);return(0,B.applyTransform)(a,d)}function y(a,b,c){return u(b,c)(a)}function z(){l(D.PROJECTIONS),l(E.PROJECTIONS),m(E.PROJECTIONS,D.PROJECTIONS,D.fromEPSG4326,D.toEPSG4326)}Object.defineProperty(c,"__esModule",{value:!0}),c.cloneTransform=f,c.identityTransform=g,c.addProjection=h,c.addProjections=i,c.get=j,c.getPointResolution=k,c.addEquivalentProjections=l,c.addEquivalentTransforms=m,c.clearAllProjections=n,c.createProjection=o,c.createTransformFromCoordinateTransform=p,c.addCoordinateTransforms=q,c.fromLonLat=r,c.toLonLat=s,c.equivalent=t,c.getTransformFromProjections=u,c.getTransform=v,c.transform=w,c.transformExtent=x,c.transformWithProjections=y,c.addCommon=z,Object.defineProperty(c,"Projection",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(c,"METERS_PER_UNIT",{enumerable:!0,get:function(){return G.METERS_PER_UNIT}});var A=a("./sphere.js"),B=a("./extent.js"),C=a("./math.js"),D=a("./proj/epsg3857.js"),E=a("./proj/epsg4326.js"),F=e(a("./proj/Projection.js")),G=d(a("./proj/Units.js")),H=d(a("./proj/projections.js")),I=a("./proj/transforms.js");z()},{"./extent.js":72,"./math.js":199,"./proj/Projection.js":211,"./proj/Units.js":212,"./proj/epsg3857.js":213,"./proj/epsg4326.js":214,"./proj/projections.js":216,"./proj/transforms.js":217,"./sphere.js":312}],211:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../proj/Units.js"),e=function(a){this.code_=a.code,this.units_=a.units,this.extent_=void 0!==a.extent?a.extent:null,this.worldExtent_=void 0!==a.worldExtent?a.worldExtent:null,this.axisOrientation_=void 0!==a.axisOrientation?a.axisOrientation:"enu",this.global_=void 0!==a.global&&a.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=a.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=a.metersPerUnit};e.prototype.canWrapX=function(){return this.canWrapX_},e.prototype.getCode=function(){return this.code_},e.prototype.getExtent=function(){return this.extent_},e.prototype.getUnits=function(){return this.units_},e.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||d.METERS_PER_UNIT[this.units_]},e.prototype.getWorldExtent=function(){return this.worldExtent_},e.prototype.getAxisOrientation=function(){return this.axisOrientation_},e.prototype.isGlobal=function(){return this.global_},e.prototype.setGlobal=function(a){this.global_=a,this.canWrapX_=!(!a||!this.extent_)},e.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},e.prototype.setDefaultTileGrid=function(a){this.defaultTileGrid_=a},e.prototype.setExtent=function(a){this.extent_=a,this.canWrapX_=!(!this.global_||!a)},e.prototype.setWorldExtent=function(a){this.worldExtent_=a},e.prototype.setGetPointResolution=function(a){this.getPointResolutionFunc_=a},e.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var f=e;c.default=f},{"../proj/Units.js":212}],212:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.METERS_PER_UNIT=void 0;var d={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},e={};c.METERS_PER_UNIT=e,e[d.DEGREES]=2*Math.PI*6370997/360,e[d.FEET]=.3048,e[d.METERS]=1,e[d.USFEET]=1200/3937;var f=d;c.default=f},{}],213:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=a.length,e=c>1?c:2,f=b;void 0===f&&(f=e>2?a.slice():new Array(d));for(var g=k,h=0;h<d;h+=e){f[h]=g*a[h]/180;var i=j*Math.log(Math.tan(Math.PI*(a[h+1]+90)/360));i>g?i=g:i<-g&&(i=-g),f[h+1]=i}return f}function f(a,b,c){var d=a.length,e=c>1?c:2,f=b;void 0===f&&(f=e>2?a.slice():new Array(d));for(var g=0;g<d;g+=e)f[g]=180*a[g]/k,f[g+1]=360*Math.atan(Math.exp(a[g+1]/j))/Math.PI-90;return f}Object.defineProperty(c,"__esModule",{value:!0}),c.fromEPSG4326=e,c.toEPSG4326=f,c.PROJECTIONS=c.WORLD_EXTENT=c.EXTENT=c.HALF_SIZE=c.RADIUS=void 0;var g=a("../math.js"),h=d(a("../proj/Projection.js")),i=d(a("../proj/Units.js")),j=6378137;c.RADIUS=j;var k=Math.PI*j;c.HALF_SIZE=k;var l=[-k,-k,k,k];c.EXTENT=l;var m=[-180,-85,180,85];c.WORLD_EXTENT=m;var n=function(a){function b(b){a.call(this,{code:b,units:i.default.METERS,extent:l,global:!0,worldExtent:m,getPointResolution:function(a,b){return a/(0,g.cosh)(b[1]/j)}})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default),o=[new n("EPSG:3857"),new n("EPSG:102100"),new n("EPSG:102113"),new n("EPSG:900913"),new n("urn:ogc:def:crs:EPSG:6.18:3:3857"),new n("urn:ogc:def:crs:EPSG::3857"),new n("http://www.opengis.net/gml/srs/epsg.xml#3857")];c.PROJECTIONS=o},{"../math.js":199,"../proj/Projection.js":211,"../proj/Units.js":212}],214:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.PROJECTIONS=c.METERS_PER_UNIT=c.EXTENT=c.RADIUS=void 0;var e=d(a("../proj/Projection.js")),f=d(a("../proj/Units.js")),g=6378137;c.RADIUS=g;var h=[-180,-90,180,90];c.EXTENT=h;var i=Math.PI*g/180;c.METERS_PER_UNIT=i;var j=function(a){function b(b,c){a.call(this,{code:b,units:f.default.DEGREES,extent:h,axisOrientation:c,global:!0,metersPerUnit:i,worldExtent:h})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),k=[new j("CRS:84"),new j("EPSG:4326","neu"),new j("urn:ogc:def:crs:EPSG::4326","neu"),new j("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new j("urn:ogc:def:crs:OGC:1.3:CRS84"),new j("urn:ogc:def:crs:OGC:2:84"),new j("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new j("urn:x-ogc:def:crs:EPSG:4326","neu")];c.PROJECTIONS=k},{"../proj/Projection.js":211,"../proj/Units.js":212}],215:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b,c,d=Object.keys(a.defs),e=d.length;for(b=0;b<e;++b){var i=d[b];if(!(0,f.get)(i)){var j=a.defs(i);(0,f.addProjection)(new h.default({code:i,axisOrientation:j.axis,metersPerUnit:j.to_meter,units:j.units}))}}for(b=0;b<e;++b){var k=d[b],l=(0,f.get)(k);for(c=0;c<e;++c){var m=d[c],n=(0,f.get)(m);if(!(0,g.get)(k,m))if(a.defs[k]===a.defs[m])(0,f.addEquivalentProjections)([l,n]);else{var o=a(k,m);(0,f.addCoordinateTransforms)(l,n,o.forward,o.inverse)}}}}Object.defineProperty(c,"__esModule",{value:!0}),c.register=e;var f=a("../proj.js"),g=a("./transforms.js"),h=d(a("./Projection.js"))},{"../proj.js":210,"./Projection.js":211,"./transforms.js":217}],216:[function(a,b,c){"use strict";function d(){g={}}function e(a){return g[a]||null}function f(a,b){g[a]=b}Object.defineProperty(c,"__esModule",{value:!0}),c.clear=d,c.get=e,c.add=f;var g={}},{}],217:[function(a,b,c){"use strict";function d(){i={}}function e(a,b,c){var d=a.getCode(),e=b.getCode();d in i||(i[d]={}),i[d][e]=c}function f(a,b){var c=a.getCode(),d=b.getCode(),e=i[c][d];return delete i[c][d],(0,h.isEmpty)(i[c])&&delete i[c],e}function g(a,b){var c;return a in i&&b in i[a]&&(c=i[a][b]),c}Object.defineProperty(c,"__esModule",{value:!0}),c.clear=d,c.add=e,c.remove=f,c.get=g;var h=a("../obj.js"),i={}},{"../obj.js":201}],218:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Disposable.js")),f=d(a("../geom/Polygon.js")),g=function(a){function b(b){a.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+b,this.map_=null,this.startPixel_=null,this.endPixel_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.setMap(null)},b.prototype.render_=function(){var a=this.startPixel_,b=this.endPixel_,c="px",d=this.element_.style;d.left=Math.min(a[0],b[0])+c,d.top=Math.min(a[1],b[1])+c,d.width=Math.abs(b[0]-a[0])+c,d.height=Math.abs(b[1]-a[1])+c},b.prototype.setMap=function(a){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var b=this.element_.style;b.left=b.top=b.width=b.height="inherit"}this.map_=a,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},b.prototype.setPixels=function(a,b){this.startPixel_=a,this.endPixel_=b,this.createOrUpdateGeometry(),this.render_()},b.prototype.createOrUpdateGeometry=function(){var a=this.startPixel_,b=this.endPixel_,c=[a,[a[0],b[1]],b,[b[0],a[1]]],d=c.map(this.map_.getCoordinateFromPixel,this.map_);d[4]=d[0].slice(),this.geometry_?this.geometry_.setCoordinates([d]):this.geometry_=new f.default([d])},b.prototype.getGeometry=function(){return this.geometry_},b}(e.default),h=g;c.default=h},{"../Disposable.js":9,"../geom/Polygon.js":139}],219:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../events/Event.js")),f=function(a){function b(b,c,d,e,f){a.call(this,b),this.vectorContext=c,this.frameState=d,this.context=e,this.glContext=f}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),g=f;c.default=g},{"../events/Event.js":67}],220:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render",RENDERCOMPLETE:"rendercomplete"};c.default=d},{}],221:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../functions.js"),f=a("../array.js"),g=a("../extent.js"),h=d(a("../geom/GeometryType.js")),i=a("../geom/flat/center.js"),j=a("../geom/flat/interiorpoint.js"),k=a("../geom/flat/interpolate.js"),l=a("../proj.js"),m=a("../geom/flat/transform.js"),n=a("../transform.js"),o=(0,n.create)(),p=function(a,b,c,d,e){this.extent_,this.id_=e,this.type_=a,this.flatCoordinates_=b,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=c,this.properties_=d};p.prototype.get=function(a){return this.properties_[a]},p.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===h.default.POINT?(0,g.createOrUpdateFromCoordinate)(this.flatCoordinates_):(0,g.createOrUpdateFromFlatCoordinates)(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},p.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var a=(0,g.getCenter)(this.getExtent());this.flatInteriorPoints_=(0,j.getInteriorPointOfArray)(this.flatCoordinates_,0,this.ends_,2,a,0)}return this.flatInteriorPoints_},p.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var a=(0,i.linearRingss)(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=(0,j.getInteriorPointsOfMultiArray)(this.flatCoordinates_,0,this.ends_,2,a)}return this.flatInteriorPoints_},p.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=(0,k.interpolatePoint)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},p.prototype.getFlatMidpoints=function(){var a=this;if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var b=this.flatCoordinates_,c=0,d=this.ends_,e=0,g=d.length;e<g;++e){var h=d[e],i=(0,k.interpolatePoint)(b,c,h,2,.5);(0,f.extend)(a.flatMidpoints_,i),c=h}}return this.flatMidpoints_},p.prototype.getId=function(){return this.id_},p.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},p.prototype.getGeometry=function(){return this},p.prototype.getProperties=function(){return this.properties_},p.prototype.getStride=function(){return 2},p.prototype.getType=function(){return this.type_},p.prototype.transform=function(a,b){a=(0,l.get)(a);var c=a.getExtent(),d=a.getWorldExtent(),e=(0,g.getHeight)(d)/(0,g.getHeight)(c);(0,n.compose)(o,d[0],d[3],e,-e,0,0,0),(0,m.transform2D)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,o,this.flatCoordinates_)},p.prototype.getEnds=p.prototype.getEndss=function(){return this.ends_},p.prototype.getFlatCoordinates=p.prototype.getOrientedFlatCoordinates,p.prototype.getSimplifiedGeometry=p.prototype.getGeometry,p.prototype.getStyleFunction=e.VOID;var q=p;c.default=q},{"../array.js":46,"../extent.js":72,"../functions.js":126,"../geom/GeometryType.js":132,"../geom/flat/center.js":142,"../geom/flat/interiorpoint.js":149,"../geom/flat/interpolate.js":150,"../geom/flat/transform.js":160,"../proj.js":210,"../transform.js":340}],222:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){};d.prototype.getReplay=function(a,b){},d.prototype.isEmpty=function(){};var e=d;c.default=e},{}],223:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};c.default=d},{}],224:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){};d.prototype.drawCustom=function(a,b,c){},d.prototype.drawGeometry=function(a){},d.prototype.setStyle=function(a){},d.prototype.drawCircle=function(a,b){},d.prototype.drawFeature=function(a,b){},d.prototype.drawGeometryCollection=function(a,b){},d.prototype.drawLineString=function(a,b){},d.prototype.drawMultiLineString=function(a,b){},d.prototype.drawMultiPoint=function(a,b){},d.prototype.drawMultiPolygon=function(a,b){},d.prototype.drawPoint=function(a,b){},d.prototype.drawPolygon=function(a,b){},d.prototype.drawText=function(a,b){},d.prototype.setFillStrokeStyle=function(a,b){},d.prototype.setImageStyle=function(a,b){},d.prototype.setTextStyle=function(a,b){};var e=d;c.default=e},{}],225:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){return t||(t=(0,j.createCanvasContext2D)(1,1)),t}function f(a,b){var c=e();return a!=c.font&&(c.font=a),c.measureText(b).width}function g(a,b,c,d){0!==b&&(a.translate(c,d),a.rotate(b),a.translate(-c,-d))}function h(a,b,c,d,e,f,g,h,i,j,k){var l;1!=c&&(l=a.globalAlpha,a.globalAlpha=l*c),b&&a.setTransform.apply(a,b),a.drawImage(d,e,f,g,h,i,j,g*k,h*k),l&&(a.globalAlpha=l),b&&a.setTransform.apply(a,x)}Object.defineProperty(c,"__esModule",{value:!0}),c.measureTextWidth=f,c.rotateAtOffset=g,c.drawImage=h,c.resetTransform=c.measureTextHeight=c.checkFont=c.textHeights=c.checkedFonts=c.labelCache=c.defaultLineWidth=c.defaultPadding=c.defaultTextBaseline=c.defaultTextAlign=c.defaultStrokeStyle=c.defaultMiterLimit=c.defaultLineJoin=c.defaultLineDashOffset=c.defaultLineDash=c.defaultLineCap=c.defaultFillStyle=c.defaultFont=void 0;var i=a("../css.js"),j=a("../dom.js"),k=a("../obj.js"),l=d(a("../structs/LRUCache.js")),m=a("../transform.js");c.defaultFont="10px sans-serif";var n=[0,0,0,1];c.defaultFillStyle=n,c.defaultLineCap="round";var o=[];c.defaultLineDash=o,c.defaultLineDashOffset=0,c.defaultLineJoin="round",c.defaultMiterLimit=10;var p=[0,0,0,1];c.defaultStrokeStyle=p,c.defaultTextAlign="center",c.defaultTextBaseline="middle";var q=[0,0,0,0];c.defaultPadding=q,c.defaultLineWidth=1;var r=new l.default;c.labelCache=r;var s={};c.checkedFonts=s;var t=null,u={};c.textHeights=u;var v=function(){function a(a){for(var b=e(),c=100;c<=700;c+=300){for(var f=c+" ",g=!0,i=0;i<l;++i){var k=j[i];if(b.font=f+h+k,d=b.measureText(m).width,a!=k){b.font=f+h+a+","+k;var n=b.measureText(m).width;g=g&&n!=d}}if(g)return!0}return!1}function b(){var b=!0;for(var d in g)g[d]<f&&(a(d)?(g[d]=f,(0,k.clear)(u),t=null,r.clear()):(++g[d],b=!1));b&&(clearInterval(c),c=void 0)}var c,d,f=60,g=s,h="32px ",j=["monospace","serif"],l=j.length,m="wmytzilWMYTZIL@#/&?$%10";return function(d){var e=(0,i.getFontFamilies)(d);if(e)for(var h=0,j=e.length;h<j;++h){var k=e[h];k in g||(g[k]=f,a(k)||(g[k]=0,void 0===c&&(c=setInterval(b,32))))}}}();c.checkFont=v;var w=function(){var a,b=u;return function(c){var d=b[c];return void 0==d&&(a||(a=document.createElement("span"),a.textContent="M",a.style.margin=a.style.padding="0 !important",a.style.position="absolute !important",a.style.left="-99999px !important"),a.style.font=c,document.body.appendChild(a),d=b[c]=a.offsetHeight,document.body.removeChild(a)),d}}();c.measureTextHeight=w;var x=(0,m.create)();c.resetTransform=x},{"../css.js":63,"../dom.js":64,"../obj.js":201,"../structs/LRUCache.js":314,"../transform.js":340}],226:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../canvas/Instruction.js")),f=d(a("../canvas/Replay.js")),g=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c,d){return this.appendFlatCoordinates(a,b,c,d,!1,!1)},b.prototype.drawPoint=function(a,b){if(this.image_){this.beginGeometry(a,b);var c=a.getFlatCoordinates(),d=a.getStride(),f=this.coordinates.length,g=this.drawCoordinates_(c,0,c.length,d);this.instructions.push([e.default.DRAW_IMAGE,f,g,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([e.default.DRAW_IMAGE,f,g,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(a,b)}},b.prototype.drawMultiPoint=function(a,b){if(this.image_){this.beginGeometry(a,b);var c=a.getFlatCoordinates(),d=a.getStride(),f=this.coordinates.length,g=this.drawCoordinates_(c,0,c.length,d);this.instructions.push([e.default.DRAW_IMAGE,f,g,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),
this.hitDetectionInstructions.push([e.default.DRAW_IMAGE,f,g,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(a,b)}},b.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0},b.prototype.setImageStyle=function(a,b){var c=a.getAnchor(),d=a.getSize(),e=a.getHitDetectionImage(1),f=a.getImage(1),g=a.getOrigin();this.anchorX_=c[0],this.anchorY_=c[1],this.declutterGroup_=b,this.hitDetectionImage_=e,this.image_=f,this.height_=d[1],this.opacity_=a.getOpacity(),this.originX_=g[0],this.originY_=g[1],this.rotateWithView_=a.getRotateWithView(),this.rotation_=a.getRotation(),this.scale_=a.getScale(),this.width_=d[0]},b}(f.default),h=g;c.default=h},{"../canvas/Instruction.js":228,"../canvas/Replay.js":231}],227:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../array.js"),f=a("../../colorlike.js"),g=a("../../extent.js"),h=d(a("../../geom/GeometryType.js")),i=a("../../geom/SimpleGeometry.js"),j=a("../../geom/flat/transform.js"),k=a("../../has.js"),l=d(a("../VectorContext.js")),m=a("../canvas.js"),n=a("../../transform.js"),o=function(a){function b(b,c,d,e,f){a.call(this),this.context_=b,this.pixelRatio_=c,this.extent_=d,this.transform_=e,this.viewRotation_=f,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,n.create)()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawImages_=function(a,b,c,d){var e=this;if(this.image_){var f=(0,j.transform2D)(a,b,c,2,this.transform_,this.pixelCoordinates_),g=this.context_,h=this.tmpLocalTransform_,i=g.globalAlpha;1!=this.imageOpacity_&&(g.globalAlpha=i*this.imageOpacity_);var k=this.imageRotation_;this.imageRotateWithView_&&(k+=this.viewRotation_);for(var l=0,m=f.length;l<m;l+=2){var o=f[l]-e.imageAnchorX_,p=f[l+1]-e.imageAnchorY_;if(0!==k||1!=e.imageScale_){var q=o+e.imageAnchorX_,r=p+e.imageAnchorY_;(0,n.compose)(h,q,r,e.imageScale_,e.imageScale_,k,-q,-r),g.setTransform.apply(g,h)}g.drawImage(e.image_,e.imageOriginX_,e.imageOriginY_,e.imageWidth_,e.imageHeight_,o,p,e.imageWidth_,e.imageHeight_)}0===k&&1==this.imageScale_||g.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(g.globalAlpha=i)}},b.prototype.drawText_=function(a,b,c,d){var e=this;if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var f=(0,j.transform2D)(a,b,c,d,this.transform_,this.pixelCoordinates_),g=this.context_,h=this.textRotation_;for(this.textRotateWithView_&&(h+=this.viewRotation_);b<c;b+=d){var i=f[b]+e.textOffsetX_,k=f[b+1]+e.textOffsetY_;if(0!==h||1!=e.textScale_){var l=(0,n.compose)(e.tmpLocalTransform_,i,k,e.textScale_,e.textScale_,h,-i,-k);g.setTransform.apply(g,l)}e.textStrokeState_&&g.strokeText(e.text_,i,k),e.textFillState_&&g.fillText(e.text_,i,k)}0===h&&1==this.textScale_||g.setTransform(1,0,0,1,0,0)}},b.prototype.moveToLineTo_=function(a,b,c,d,e){var f=this.context_,g=(0,j.transform2D)(a,b,c,d,this.transform_,this.pixelCoordinates_);f.moveTo(g[0],g[1]);var h=g.length;e&&(h-=2);for(var i=2;i<h;i+=2)f.lineTo(g[i],g[i+1]);return e&&f.closePath(),c},b.prototype.drawRings_=function(a,b,c,d){for(var e=this,f=0,g=c.length;f<g;++f)b=e.moveToLineTo_(a,b,c[f],d,!0);return b},b.prototype.drawCircle=function(a){if((0,g.intersects)(this.extent_,a.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=(0,i.transformGeom2D)(a,this.transform_,this.pixelCoordinates_),c=b[2]-b[0],d=b[3]-b[1],e=Math.sqrt(c*c+d*d),f=this.context_;f.beginPath(),f.arc(b[0],b[1],e,0,2*Math.PI),this.fillState_&&f.fill(),this.strokeState_&&f.stroke()}""!==this.text_&&this.drawText_(a.getCenter(),0,2,2)}},b.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke()),this.setImageStyle(a.getImage()),this.setTextStyle(a.getText())},b.prototype.drawGeometry=function(a){switch(a.getType()){case h.default.POINT:this.drawPoint(a);break;case h.default.LINE_STRING:this.drawLineString(a);break;case h.default.POLYGON:this.drawPolygon(a);break;case h.default.MULTI_POINT:this.drawMultiPoint(a);break;case h.default.MULTI_LINE_STRING:this.drawMultiLineString(a);break;case h.default.MULTI_POLYGON:this.drawMultiPolygon(a);break;case h.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(a);break;case h.default.CIRCLE:this.drawCircle(a)}},b.prototype.drawFeature=function(a,b){var c=b.getGeometryFunction()(a);c&&(0,g.intersects)(this.extent_,c.getExtent())&&(this.setStyle(b),this.drawGeometry(c))},b.prototype.drawGeometryCollection=function(a){for(var b=this,c=a.getGeometriesArray(),d=0,e=c.length;d<e;++d)b.drawGeometry(c[d])},b.prototype.drawPoint=function(a){var b=a.getFlatCoordinates(),c=a.getStride();this.image_&&this.drawImages_(b,0,b.length,c),""!==this.text_&&this.drawText_(b,0,b.length,c)},b.prototype.drawMultiPoint=function(a){var b=a.getFlatCoordinates(),c=a.getStride();this.image_&&this.drawImages_(b,0,b.length,c),""!==this.text_&&this.drawText_(b,0,b.length,c)},b.prototype.drawLineString=function(a){if((0,g.intersects)(this.extent_,a.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var b=this.context_,c=a.getFlatCoordinates();b.beginPath(),this.moveToLineTo_(c,0,c.length,a.getStride(),!1),b.stroke()}if(""!==this.text_){var d=a.getFlatMidpoint();this.drawText_(d,0,2,2)}}},b.prototype.drawMultiLineString=function(a){var b=this,c=a.getExtent();if((0,g.intersects)(this.extent_,c)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var d=this.context_,e=a.getFlatCoordinates(),f=0,h=a.getEnds(),i=a.getStride();d.beginPath();for(var j=0,k=h.length;j<k;++j)f=b.moveToLineTo_(e,f,h[j],i,!1);d.stroke()}if(""!==this.text_){var l=a.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}},b.prototype.drawPolygon=function(a){if((0,g.intersects)(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=this.context_;b.beginPath(),this.drawRings_(a.getOrientedFlatCoordinates(),0,a.getEnds(),a.getStride()),this.fillState_&&b.fill(),this.strokeState_&&b.stroke()}if(""!==this.text_){var c=a.getFlatInteriorPoint();this.drawText_(c,0,2,2)}}},b.prototype.drawMultiPolygon=function(a){var b=this;if((0,g.intersects)(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var c=this.context_,d=a.getOrientedFlatCoordinates(),e=0,f=a.getEndss(),h=a.getStride();c.beginPath();for(var i=0,j=f.length;i<j;++i){var k=f[i];e=b.drawRings_(d,e,k,h)}this.fillState_&&c.fill(),this.strokeState_&&c.stroke()}if(""!==this.text_){var l=a.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}},b.prototype.setContextFillState_=function(a){var b=this.context_,c=this.contextFillState_;c?c.fillStyle!=a.fillStyle&&(c.fillStyle=b.fillStyle=a.fillStyle):(b.fillStyle=a.fillStyle,this.contextFillState_={fillStyle:a.fillStyle})},b.prototype.setContextStrokeState_=function(a){var b=this.context_,c=this.contextStrokeState_;c?(c.lineCap!=a.lineCap&&(c.lineCap=b.lineCap=a.lineCap),k.CANVAS_LINE_DASH&&((0,e.equals)(c.lineDash,a.lineDash)||b.setLineDash(c.lineDash=a.lineDash),c.lineDashOffset!=a.lineDashOffset&&(c.lineDashOffset=b.lineDashOffset=a.lineDashOffset)),c.lineJoin!=a.lineJoin&&(c.lineJoin=b.lineJoin=a.lineJoin),c.lineWidth!=a.lineWidth&&(c.lineWidth=b.lineWidth=a.lineWidth),c.miterLimit!=a.miterLimit&&(c.miterLimit=b.miterLimit=a.miterLimit),c.strokeStyle!=a.strokeStyle&&(c.strokeStyle=b.strokeStyle=a.strokeStyle)):(b.lineCap=a.lineCap,k.CANVAS_LINE_DASH&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineJoin=a.lineJoin,b.lineWidth=a.lineWidth,b.miterLimit=a.miterLimit,b.strokeStyle=a.strokeStyle,this.contextStrokeState_={lineCap:a.lineCap,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset,lineJoin:a.lineJoin,lineWidth:a.lineWidth,miterLimit:a.miterLimit,strokeStyle:a.strokeStyle})},b.prototype.setContextTextState_=function(a){var b=this.context_,c=this.contextTextState_,d=a.textAlign?a.textAlign:m.defaultTextAlign;c?(c.font!=a.font&&(c.font=b.font=a.font),c.textAlign!=d&&(c.textAlign=b.textAlign=d),c.textBaseline!=a.textBaseline&&(c.textBaseline=b.textBaseline=a.textBaseline)):(b.font=a.font,b.textAlign=d,b.textBaseline=a.textBaseline,this.contextTextState_={font:a.font,textAlign:d,textBaseline:a.textBaseline})},b.prototype.setFillStrokeStyle=function(a,b){if(a){var c=a.getColor();this.fillState_={fillStyle:(0,f.asColorLike)(c||m.defaultFillStyle)}}else this.fillState_=null;if(b){var d=b.getColor(),e=b.getLineCap(),g=b.getLineDash(),h=b.getLineDashOffset(),i=b.getLineJoin(),j=b.getWidth(),k=b.getMiterLimit();this.strokeState_={lineCap:void 0!==e?e:m.defaultLineCap,lineDash:g||m.defaultLineDash,lineDashOffset:h||m.defaultLineDashOffset,lineJoin:void 0!==i?i:m.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==j?j:m.defaultLineWidth),miterLimit:void 0!==k?k:m.defaultMiterLimit,strokeStyle:(0,f.asColorLike)(d||m.defaultStrokeStyle)}}else this.strokeState_=null},b.prototype.setImageStyle=function(a){if(a){var b=a.getAnchor(),c=a.getImage(1),d=a.getOrigin(),e=a.getSize();this.imageAnchorX_=b[0],this.imageAnchorY_=b[1],this.imageHeight_=e[1],this.image_=c,this.imageOpacity_=a.getOpacity(),this.imageOriginX_=d[0],this.imageOriginY_=d[1],this.imageRotateWithView_=a.getRotateWithView(),this.imageRotation_=a.getRotation(),this.imageScale_=a.getScale()*this.pixelRatio_,this.imageWidth_=e[0]}else this.image_=null},b.prototype.setTextStyle=function(a){if(a){var b=a.getFill();if(b){var c=b.getColor();this.textFillState_={fillStyle:(0,f.asColorLike)(c||m.defaultFillStyle)}}else this.textFillState_=null;var d=a.getStroke();if(d){var e=d.getColor(),g=d.getLineCap(),h=d.getLineDash(),i=d.getLineDashOffset(),j=d.getLineJoin(),k=d.getWidth(),l=d.getMiterLimit();this.textStrokeState_={lineCap:void 0!==g?g:m.defaultLineCap,lineDash:h||m.defaultLineDash,lineDashOffset:i||m.defaultLineDashOffset,lineJoin:void 0!==j?j:m.defaultLineJoin,lineWidth:void 0!==k?k:m.defaultLineWidth,miterLimit:void 0!==l?l:m.defaultMiterLimit,strokeStyle:(0,f.asColorLike)(e||m.defaultStrokeStyle)}}else this.textStrokeState_=null;var n=a.getFont(),o=a.getOffsetX(),p=a.getOffsetY(),q=a.getRotateWithView(),r=a.getRotation(),s=a.getScale(),t=a.getText(),u=a.getTextAlign(),v=a.getTextBaseline();this.textState_={font:void 0!==n?n:m.defaultFont,textAlign:void 0!==u?u:m.defaultTextAlign,textBaseline:void 0!==v?v:m.defaultTextBaseline},this.text_=void 0!==t?t:"",this.textOffsetX_=void 0!==o?this.pixelRatio_*o:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==q&&q,this.textRotation_=void 0!==r?r:0,this.textScale_=this.pixelRatio_*(void 0!==s?s:1)}else this.text_=""},b}(l.default),p=o;c.default=p},{"../../array.js":46,"../../colorlike.js":50,"../../extent.js":72,"../../geom/GeometryType.js":132,"../../geom/SimpleGeometry.js":140,"../../geom/flat/transform.js":160,"../../has.js":161,"../../transform.js":340,"../VectorContext.js":224,"../canvas.js":225}],228:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.closePathInstruction=c.beginPathInstruction=c.strokeInstruction=c.fillInstruction=void 0;var d={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},e=[d.FILL];c.fillInstruction=e;var f=[d.STROKE];c.strokeInstruction=f;var g=[d.BEGIN_PATH];c.beginPathInstruction=g;var h=[d.CLOSE_PATH];c.closePathInstruction=h;var i=d;c.default=i},{}],229:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("../canvas/Instruction.js")),g=d(a("../canvas/Replay.js")),h=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawFlatCoordinates_=function(a,b,c,d){var e=this.coordinates.length,g=this.appendFlatCoordinates(a,b,c,d,!1,!1),h=[f.default.MOVE_TO_LINE_TO,e,g];return this.instructions.push(h),this.hitDetectionInstructions.push(h),c},b.prototype.drawLineString=function(a,b){var c=this.state,d=c.strokeStyle,e=c.lineWidth;if(void 0!==d&&void 0!==e){this.updateStrokeStyle(c,this.applyStroke),this.beginGeometry(a,b),this.hitDetectionInstructions.push([f.default.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset],f.beginPathInstruction);var g=a.getFlatCoordinates(),h=a.getStride();this.drawFlatCoordinates_(g,0,g.length,h),this.hitDetectionInstructions.push(f.strokeInstruction),this.endGeometry(a,b)}},b.prototype.drawMultiLineString=function(a,b){var c=this,d=this.state,e=d.strokeStyle,g=d.lineWidth;if(void 0!==e&&void 0!==g){this.updateStrokeStyle(d,this.applyStroke),this.beginGeometry(a,b),this.hitDetectionInstructions.push([f.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset],f.beginPathInstruction);for(var h=a.getEnds(),i=a.getFlatCoordinates(),j=a.getStride(),k=0,l=0,m=h.length;l<m;++l)k=c.drawFlatCoordinates_(i,k,h[l],j);this.hitDetectionInstructions.push(f.strokeInstruction),this.endGeometry(a,b)}},b.prototype.finish=function(){var a=this.state;void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&this.instructions.push(f.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null},b.prototype.applyStroke=function(b){void 0!=b.lastStroke&&b.lastStroke!=this.coordinates.length&&(this.instructions.push(f.strokeInstruction),b.lastStroke=this.coordinates.length),b.lastStroke=0,a.prototype.applyStroke.call(this,b),this.instructions.push(f.beginPathInstruction)},b}(g.default),i=h;c.default=i},{"../canvas/Instruction.js":228,"../canvas/Replay.js":231}],230:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../color.js"),g=a("../../geom/flat/simplify.js"),h=a("../canvas.js"),i=e(a("../canvas/Instruction.js")),j=d(a("../canvas/Replay.js")),k=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawFlatCoordinatess_=function(a,b,c,d){var e=this,f=this.state,g=void 0!==f.fillStyle,h=void 0!=f.strokeStyle,j=c.length;this.instructions.push(i.beginPathInstruction),this.hitDetectionInstructions.push(i.beginPathInstruction);for(var k=0;k<j;++k){var l=c[k],m=e.coordinates.length,n=e.appendFlatCoordinates(a,b,l,d,!0,!h),o=[i.default.MOVE_TO_LINE_TO,m,n];e.instructions.push(o),e.hitDetectionInstructions.push(o),h&&(e.instructions.push(i.closePathInstruction),e.hitDetectionInstructions.push(i.closePathInstruction)),b=l}return g&&(this.instructions.push(i.fillInstruction),this.hitDetectionInstructions.push(i.fillInstruction)),h&&(this.instructions.push(i.strokeInstruction),this.hitDetectionInstructions.push(i.strokeInstruction)),b},b.prototype.drawCircle=function(a,b){var c=this.state,d=c.fillStyle,e=c.strokeStyle;if(void 0!==d||void 0!==e){this.setFillStrokeStyles_(a),this.beginGeometry(a,b),void 0!==c.fillStyle&&this.hitDetectionInstructions.push([i.default.SET_FILL_STYLE,(0,f.asString)(h.defaultFillStyle)]),void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset]);var g=a.getFlatCoordinates(),j=a.getStride(),k=this.coordinates.length;this.appendFlatCoordinates(g,0,g.length,j,!1,!1);var l=[i.default.CIRCLE,k];this.instructions.push(i.beginPathInstruction,l),this.hitDetectionInstructions.push(i.beginPathInstruction,l),this.hitDetectionInstructions.push(i.fillInstruction),void 0!==c.fillStyle&&this.instructions.push(i.fillInstruction),void 0!==c.strokeStyle&&(this.instructions.push(i.strokeInstruction),this.hitDetectionInstructions.push(i.strokeInstruction)),this.endGeometry(a,b)}},b.prototype.drawPolygon=function(a,b){var c=this.state,d=c.fillStyle,e=c.strokeStyle;if(void 0!==d||void 0!==e){this.setFillStrokeStyles_(a),this.beginGeometry(a,b),void 0!==c.fillStyle&&this.hitDetectionInstructions.push([i.default.SET_FILL_STYLE,(0,f.asString)(h.defaultFillStyle)]),void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset]);var g=a.getEnds(),j=a.getOrientedFlatCoordinates(),k=a.getStride();this.drawFlatCoordinatess_(j,0,g,k),this.endGeometry(a,b)}},b.prototype.drawMultiPolygon=function(a,b){var c=this,d=this.state,e=d.fillStyle,g=d.strokeStyle;if(void 0!==e||void 0!==g){this.setFillStrokeStyles_(a),this.beginGeometry(a,b),void 0!==d.fillStyle&&this.hitDetectionInstructions.push([i.default.SET_FILL_STYLE,(0,f.asString)(h.defaultFillStyle)]),void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset]);for(var j=a.getEndss(),k=a.getOrientedFlatCoordinates(),l=a.getStride(),m=0,n=0,o=j.length;n<o;++n)m=c.drawFlatCoordinatess_(k,m,j[n],l);this.endGeometry(a,b)}},b.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var a=this.tolerance;if(0!==a)for(var b=this.coordinates,c=0,d=b.length;c<d;++c)b[c]=(0,g.snap)(b[c],a)},b.prototype.setFillStrokeStyles_=function(a){var b=this.state;void 0!==b.fillStyle&&this.updateFillStyle(b,this.createFill,a),void 0!==b.strokeStyle&&this.updateStrokeStyle(b,this.applyStroke)},b}(j.default),l=k;c.default=l},{"../../color.js":49,"../../geom/flat/simplify.js":156,"../canvas.js":225,"../canvas/Instruction.js":228,"../canvas/Replay.js":231}],231:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../functions.js"),g=a("../../array.js"),h=a("../../colorlike.js"),i=a("../../extent.js"),j=d(a("../../extent/Relationship.js")),k=d(a("../../geom/GeometryType.js")),l=a("../../geom/flat/inflate.js"),m=a("../../geom/flat/length.js"),n=a("../../geom/flat/textpath.js"),o=a("../../geom/flat/transform.js"),p=a("../../has.js"),q=a("../../obj.js"),r=d(a("../VectorContext.js")),s=a("../canvas.js"),t=d(a("../canvas/Instruction.js")),u=a("../replay.js"),v=a("../../transform.js"),w=(0,i.createEmpty)(),x=(0,v.create)(),y=function(a){function b(b,c,d,e,f,g){a.call(this),this.declutterTree=g,this.tolerance=b,this.maxExtent=c,this.overlaps=f,this.pixelRatio=e,this.maxLineWidth=0,this.resolution=d,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=(0,v.create)(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.replayTextBackground_=function(a,b,c,d,e,f,g){a.beginPath(),a.moveTo.apply(a,b),a.lineTo.apply(a,c),a.lineTo.apply(a,d),a.lineTo.apply(a,e),a.lineTo.apply(a,b),f&&(this.alignFill_=f[2],this.fill_(a)),g&&(this.setStrokeStyle_(a,g),a.stroke())},b.prototype.replayImage_=function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,t){var u=r||t;e*=n,f*=n,b-=e,c-=f;var y,z,A,B,C=p+k>d.width?d.width-k:p,D=h+l>d.height?d.height-l:h,E=q[3]+C*n+q[1],F=q[0]+D*n+q[2],G=b-q[3],H=c-q[0];(u||0!==m)&&(y=[G,H],z=[G+E,H],A=[G+E,H+F],B=[G,H+F]);var I=null;if(0!==m){var J=b+e,K=c+f;I=(0,v.compose)(x,J,K,1,1,m,-J,-K),(0,i.createOrUpdateEmpty)(w),(0,i.extendCoordinate)(w,(0,v.apply)(x,y)),(0,i.extendCoordinate)(w,(0,v.apply)(x,z)),(0,i.extendCoordinate)(w,(0,v.apply)(x,A)),(0,i.extendCoordinate)(w,(0,v.apply)(x,B))}else(0,i.createOrUpdate)(G,H,G+E,H+F,w);var L=a.canvas,M=t?t[2]*n/2:0,N=w[0]-M<=L.width&&w[2]+M>=0&&w[1]-M<=L.height&&w[3]+M>=0;if(o&&(b=Math.round(b),c=Math.round(c)),g){if(!N&&1==g[4])return;(0,i.extend)(g,w);var O=N?[a,I?I.slice(0):null,j,d,k,l,C,D,b,c,n]:null;O&&u&&O.push(r,t,y,z,A,B),g.push(O)}else N&&(u&&this.replayTextBackground_(a,y,z,A,B,r,t),(0,s.drawImage)(a,I,j,d,k,l,C,D,b,c,n))},b.prototype.applyPixelRatio=function(a){var b=this.pixelRatio;return 1==b?a:a.map(function(a){return a*b})},b.prototype.appendFlatCoordinates=function(a,b,c,d,e,f){var g=this,h=this.coordinates.length,k=this.getBufferedMaxExtent();f&&(b+=d);var l,m,n,o=[a[b],a[b+1]],p=[NaN,NaN],q=!0;for(l=b+d;l<c;l+=d)p[0]=a[l],p[1]=a[l+1],n=(0,i.coordinateRelationship)(k,p),n!==m?(q&&(g.coordinates[h++]=o[0],g.coordinates[h++]=o[1]),g.coordinates[h++]=p[0],g.coordinates[h++]=p[1],q=!1):n===j.default.INTERSECTING?(g.coordinates[h++]=p[0],g.coordinates[h++]=p[1],q=!1):q=!0,o[0]=p[0],o[1]=p[1],m=n;return(e&&q||l===b+d)&&(this.coordinates[h++]=o[0],this.coordinates[h++]=o[1]),h},b.prototype.drawCustomCoordinates_=function(a,b,c,d,e){for(var f=this,g=0,h=c.length;g<h;++g){var i=c[g],j=f.appendFlatCoordinates(a,b,i,d,!1,!1);e.push(j),b=i}return b},b.prototype.drawCustom=function(a,b,c){var d=this;this.beginGeometry(a,b);var e,f,g,h,i,j=a.getType(),m=a.getStride(),n=this.coordinates.length;if(j==k.default.MULTI_POLYGON){a=a,e=a.getOrientedFlatCoordinates(),h=[];var o=a.getEndss();i=0;for(var p=0,q=o.length;p<q;++p){var r=[];i=d.drawCustomCoordinates_(e,i,o[p],m,r),h.push(r)}this.instructions.push([t.default.CUSTOM,n,h,a,c,l.inflateMultiCoordinatesArray])}else j==k.default.POLYGON||j==k.default.MULTI_LINE_STRING?(g=[],e=j==k.default.POLYGON?a.getOrientedFlatCoordinates():a.getFlatCoordinates(),i=this.drawCustomCoordinates_(e,0,a.getEnds(),m,g),this.instructions.push([t.default.CUSTOM,n,g,a,c,l.inflateCoordinatesArray])):j==k.default.LINE_STRING||j==k.default.MULTI_POINT?(e=a.getFlatCoordinates(),f=this.appendFlatCoordinates(e,0,e.length,m,!1,!1),this.instructions.push([t.default.CUSTOM,n,f,a,c,l.inflateCoordinates])):j==k.default.POINT&&(e=a.getFlatCoordinates(),this.coordinates.push(e[0],e[1]),f=this.coordinates.length,this.instructions.push([t.default.CUSTOM,n,f,a,c]));this.endGeometry(a,b)},b.prototype.beginGeometry=function(a,b){this.beginGeometryInstruction1_=[t.default.BEGIN_GEOMETRY,b,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[t.default.BEGIN_GEOMETRY,b,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},b.prototype.fill_=function(a){if(this.alignFill_){var b=(0,v.apply)(this.renderedTransform_,[0,0]),c=512*this.pixelRatio;a.translate(b[0]%c,b[1]%c),a.rotate(this.viewRotation_)}a.fill(),this.alignFill_&&a.setTransform.apply(a,s.resetTransform)},b.prototype.setStrokeStyle_=function(a,b){a.strokeStyle=b[1],a.lineWidth=b[2],a.lineCap=b[3],a.lineJoin=b[4],a.miterLimit=b[5],p.CANVAS_LINE_DASH&&(a.lineDashOffset=b[7],a.setLineDash(b[6]))},b.prototype.renderDeclutter_=function(a,b){var c=this;if(a&&a.length>5){var d=a[4];if(1==d||d==a.length-5){var e={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};if(!this.declutterTree.collides(e)){this.declutterTree.insert(e);for(var f=5,g=a.length;f<g;++f){var h=a[f];h&&(h.length>11&&c.replayTextBackground_(h[0],h[13],h[14],h[15],h[16],h[11],h[12]),s.drawImage.apply(void 0,h))}}a.length=5,(0,i.createOrUpdateEmpty)(a)}}},b.prototype.replay_=function(a,b,c,d,f,h,j){var k,l=this;this.pixelCoordinates_&&(0,g.equals)(b,this.renderedTransform_)?k=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),k=(0,o.transform2D)(this.coordinates,0,this.coordinates.length,2,b,this.pixelCoordinates_),(0,v.setFromArray)(this.renderedTransform_,b));for(var p,r,w,x,y,z,A,B,C,D,E,F,G=!(0,q.isEmpty)(c),H=0,I=d.length,J=0,K=0,L=0,M=null,N=null,O=this.coordinateCache_,P=this.viewRotation_,Q={context:a,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},R=this.instructions!=d||this.overlaps?0:200;H<I;){var S=d[H];switch(S[0]){case t.default.BEGIN_GEOMETRY:D=S[1],G&&c[(0,e.getUid)(D).toString()]||!D.getGeometry()?H=S[2]:void 0===j||(0,i.intersects)(j,D.getGeometry().getExtent())?++H:H=S[2]+1;break;case t.default.BEGIN_PATH:K>R&&(l.fill_(a),K=0),L>R&&(a.stroke(),L=0),K||L||(a.beginPath(),x=y=NaN),++H;break;case t.default.CIRCLE:J=S[1];var T=k[J],U=k[J+1],V=k[J+2],W=k[J+3],X=V-T,Y=W-U,Z=Math.sqrt(X*X+Y*Y);a.moveTo(T+Z,U),a.arc(T,U,Z,0,2*Math.PI,!0),++H;break;case t.default.CLOSE_PATH:a.closePath(),++H;break;case t.default.CUSTOM:J=S[1],p=S[2];var $=S[3],_=S[4],aa=6==S.length?S[5]:void 0;Q.geometry=$,Q.feature=D,H in O||(O[H]=[]);var ba=O[H];aa?aa(k,J,p,2,ba):(ba[0]=k[J],ba[1]=k[J+1],ba.length=2),_(ba,Q),++H;break;case t.default.DRAW_IMAGE:J=S[1],p=S[2],C=S[3],r=S[4],w=S[5],B=h?null:S[6];var ca=S[7],da=S[8],ea=S[9],fa=S[10],ga=S[11],ha=S[12],ia=S[13],ja=S[14],ka=void 0,la=void 0,ma=void 0;for(S.length>16?(ka=S[15],la=S[16],ma=S[17]):(ka=s.defaultPadding,la=ma=!1),ga&&(ha+=P);J<p;J+=2)l.replayImage_(a,k[J],k[J+1],C,r,w,B,ca,da,ea,fa,ha,ia,f,ja,ka,la?M:null,ma?N:null);l.renderDeclutter_(B,D),++H;break;case t.default.DRAW_CHARS:var na=S[1],oa=S[2],pa=S[3];B=h?null:S[4];var qa=S[5],ra=S[6],sa=S[7],ta=S[8],ua=S[9],va=S[10],wa=S[11],xa=S[12],ya=S[13],za=S[14],Aa=(0,m.lineStringLength)(k,na,oa,2),Ba=ta(xa);if(qa||Ba<=Aa){var Ca=l.textStates[ya].textAlign,Da=(Aa-Ba)*u.TEXT_ALIGN[Ca],Ea=(0,n.drawTextOnPath)(k,na,oa,2,xa,ta,Da,sa);if(Ea){var Fa=void 0,Ga=void 0,Ha=void 0,Ia=void 0,Ja=void 0;if(va)for(Fa=0,Ga=Ea.length;Fa<Ga;++Fa)Ja=Ea[Fa],Ha=Ja[4],Ia=l.getImage(Ha,ya,"",va),r=Ja[2]+wa,w=pa*Ia.height+2*(.5-pa)*wa-ua,l.replayImage_(a,Ja[0],Ja[1],Ia,r,w,B,Ia.height,1,0,0,Ja[3],za,!1,Ia.width,s.defaultPadding,null,null);if(ra)for(Fa=0,Ga=Ea.length;Fa<Ga;++Fa)Ja=Ea[Fa],Ha=Ja[4],Ia=l.getImage(Ha,ya,ra,""),r=Ja[2],w=pa*Ia.height-ua,l.replayImage_(a,Ja[0],Ja[1],Ia,r,w,B,Ia.height,1,0,0,Ja[3],za,!1,Ia.width,s.defaultPadding,null,null)}}l.renderDeclutter_(B,D),++H;break;case t.default.END_GEOMETRY:if(void 0!==h){D=S[1];var Ka=h(D);if(Ka)return Ka}++H;break;case t.default.FILL:R?K++:l.fill_(a),++H;break;case t.default.MOVE_TO_LINE_TO:for(J=S[1],p=S[2],E=k[J],F=k[J+1],z=E+.5|0,A=F+.5|0,z===x&&A===y||(a.moveTo(E,F),x=z,y=A),J+=2;J<p;J+=2)E=k[J],F=k[J+1],z=E+.5|0,A=F+.5|0,J!=p-2&&z===x&&A===y||(a.lineTo(E,F),x=z,y=A);++H;break;case t.default.SET_FILL_STYLE:M=S,l.alignFill_=S[2],K&&(l.fill_(a),K=0,L&&(a.stroke(),L=0)),a.fillStyle=S[1],++H;break;case t.default.SET_STROKE_STYLE:N=S,L&&(a.stroke(),L=0),l.setStrokeStyle_(a,S),++H;break;case t.default.STROKE:R?L++:a.stroke(),++H;break;default:++H}}K&&this.fill_(a),L&&a.stroke()},b.prototype.replay=function(a,b,c,d,e){this.viewRotation_=c,this.replay_(a,b,d,this.instructions,e,void 0,void 0)},b.prototype.replayHitDetection=function(a,b,c,d,e,f){return this.viewRotation_=c,this.replay_(a,b,d,this.hitDetectionInstructions,!0,e,f)},b.prototype.reverseHitDetectionInstructions=function(){var a=this,b=this.hitDetectionInstructions;b.reverse();var c,d,e,f=b.length,h=-1;for(c=0;c<f;++c)d=b[c],e=d[0],e==t.default.END_GEOMETRY?h=c:e==t.default.BEGIN_GEOMETRY&&(d[2]=c,(0,g.reverseSubArray)(a.hitDetectionInstructions,h,c),h=-1)},b.prototype.setFillStrokeStyle=function(a,b){var c=this.state;if(a){var d=a.getColor();c.fillStyle=(0,h.asColorLike)(d||s.defaultFillStyle)}else c.fillStyle=void 0;if(b){var e=b.getColor();c.strokeStyle=(0,h.asColorLike)(e||s.defaultStrokeStyle);var f=b.getLineCap();c.lineCap=void 0!==f?f:s.defaultLineCap;var g=b.getLineDash();c.lineDash=g?g.slice():s.defaultLineDash;var i=b.getLineDashOffset();c.lineDashOffset=i||s.defaultLineDashOffset;var j=b.getLineJoin();c.lineJoin=void 0!==j?j:s.defaultLineJoin;var k=b.getWidth();c.lineWidth=void 0!==k?k:s.defaultLineWidth;var l=b.getMiterLimit();c.miterLimit=void 0!==l?l:s.defaultMiterLimit,c.lineWidth>this.maxLineWidth&&(this.maxLineWidth=c.lineWidth,this.bufferedMaxExtent_=null)}else c.strokeStyle=void 0,c.lineCap=void 0,c.lineDash=null,c.lineDashOffset=void 0,c.lineJoin=void 0,c.lineWidth=void 0,c.miterLimit=void 0},b.prototype.createFill=function(a,b){var c=a.fillStyle,d=[t.default.SET_FILL_STYLE,c];return"string"!=typeof c&&d.push(!0),d},b.prototype.applyStroke=function(a){this.instructions.push(this.createStroke(a))},b.prototype.createStroke=function(a){return[t.default.SET_STROKE_STYLE,a.strokeStyle,a.lineWidth*this.pixelRatio,a.lineCap,a.lineJoin,a.miterLimit,this.applyPixelRatio(a.lineDash),a.lineDashOffset*this.pixelRatio]},b.prototype.updateFillStyle=function(a,b,c){var d=a.fillStyle;"string"==typeof d&&a.currentFillStyle==d||(void 0!==d&&this.instructions.push(b.call(this,a,c)),a.currentFillStyle=d)},b.prototype.updateStrokeStyle=function(a,b){var c=a.strokeStyle,d=a.lineCap,e=a.lineDash,f=a.lineDashOffset,h=a.lineJoin,i=a.lineWidth,j=a.miterLimit;(a.currentStrokeStyle!=c||a.currentLineCap!=d||e!=a.currentLineDash&&!(0,g.equals)(a.currentLineDash,e)||a.currentLineDashOffset!=f||a.currentLineJoin!=h||a.currentLineWidth!=i||a.currentMiterLimit!=j)&&(void 0!==c&&b.call(this,a),a.currentStrokeStyle=c,a.currentLineCap=d,a.currentLineDash=e,a.currentLineDashOffset=f,a.currentLineJoin=h,a.currentLineWidth=i,a.currentMiterLimit=j)},b.prototype.endGeometry=function(a,b){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var c=[t.default.END_GEOMETRY,b];this.instructions.push(c),this.hitDetectionInstructions.push(c)},b.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,i.clone)(this.maxExtent),this.maxLineWidth>0)){var a=this.resolution*(this.maxLineWidth+1)/2;(0,i.buffer)(this.bufferedMaxExtent_,a,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},b}(r.default);y.prototype.finish=f.VOID;var z=y;c.default=z},{"../../array.js":46,"../../colorlike.js":50,"../../extent.js":72,"../../extent/Relationship.js":74,"../../functions.js":126,"../../geom/GeometryType.js":132,
"../../geom/flat/inflate.js":148,"../../geom/flat/length.js":152,"../../geom/flat/textpath.js":158,"../../geom/flat/transform.js":160,"../../has.js":161,"../../obj.js":201,"../../transform.js":340,"../../util.js":342,"../VectorContext.js":224,"../canvas.js":225,"../canvas/Instruction.js":228,"../replay.js":234}],232:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d,e=Math.floor(a.length/2);if(b>=e)for(d=e;d<b;d++)a[d][c]=!0;else if(b<e)for(d=b+1;d<e;d++)a[d][c]=!0}function f(a){if(void 0!==x[a])return x[a];for(var b=2*a+1,c=new Array(b),d=0;d<b;d++)c[d]=new Array(b);for(var f=a,g=0,h=0;f>=g;)e(c,a+f,a+g),e(c,a+g,a+f),e(c,a-g,a+f),e(c,a-f,a+g),e(c,a-f,a-g),e(c,a-g,a-f),e(c,a+g,a-f),e(c,a+f,a-g),g++,2*((h+=1+2*g)-f)+1>0&&(f-=1,h+=1-2*f);return x[a]=c,c}function g(a,b,c,d){for(var e=Object.keys(a).map(Number).sort(h.numberSafeCompareFunction),f={},g=0,i=e.length;g<i;++g)for(var j=a[e[g].toString()],k=0,l=j.length;k<l;){var m=j[k++],n=j[k++];m.replay(b,n,c,f,d)}}Object.defineProperty(c,"__esModule",{value:!0}),c.getCircleArray=f,c.replayDeclutter=g,c.default=void 0;var h=a("../../array.js"),i=a("../../dom.js"),j=a("../../extent.js"),k=a("../../geom/flat/transform.js"),l=a("../../obj.js"),m=d(a("../ReplayGroup.js")),n=d(a("../ReplayType.js")),o=d(a("../canvas/Replay.js")),p=d(a("../canvas/ImageReplay.js")),q=d(a("../canvas/LineStringReplay.js")),r=d(a("../canvas/PolygonReplay.js")),s=d(a("../canvas/TextReplay.js")),t=a("../replay.js"),u=a("../../transform.js"),v={Circle:r.default,Default:o.default,Image:p.default,LineString:q.default,Polygon:r.default,Text:s.default},w=function(a){function b(b,c,d,e,f,g,h){a.call(this),this.declutterTree_=g,this.declutterGroup_=null,this.tolerance_=b,this.maxExtent_=c,this.overlaps_=f,this.pixelRatio_=e,this.resolution_=d,this.renderBuffer_=h,this.replaysByZIndex_={},this.hitDetectionContext_=(0,i.createCanvasContext2D)(1,1),this.hitDetectionTransform_=(0,u.create)()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addDeclutter=function(a){var b=null;return this.declutterTree_&&(a?(b=this.declutterGroup_,b[4]++):(b=this.declutterGroup_=(0,j.createEmpty)(),b.push(1))),b},b.prototype.clip=function(a,b){var c=this.getClipCoords(b);a.beginPath(),a.moveTo(c[0],c[1]),a.lineTo(c[2],c[3]),a.lineTo(c[4],c[5]),a.lineTo(c[6],c[7]),a.clip()},b.prototype.hasReplays=function(a){var b=this;for(var c in b.replaysByZIndex_)for(var d=b.replaysByZIndex_[c],e=0,f=a.length;e<f;++e)if(a[e]in d)return!0;return!1},b.prototype.finish=function(){var a=this;for(var b in a.replaysByZIndex_){var c=a.replaysByZIndex_[b];for(var d in c)c[d].finish()}},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,g,i){function k(a){for(var b=p.getImageData(0,0,m,m).data,c=0;c<m;c++)for(var d=0;d<m;d++)if(s[c][d]&&b[4*(d*m+c)+3]>0){var e=void 0;return(!r||v!=n.default.IMAGE&&v!=n.default.TEXT||-1!==r.indexOf(a))&&(e=g(a)),e||void p.clearRect(0,0,m,m)}}var l=this;d=Math.round(d);var m=2*d+1,o=(0,u.compose)(this.hitDetectionTransform_,d+.5,d+.5,1/b,-1/b,-c,-a[0],-a[1]),p=this.hitDetectionContext_;p.canvas.width!==m||p.canvas.height!==m?(p.canvas.width=m,p.canvas.height=m):p.clearRect(0,0,m,m);var q;void 0!==this.renderBuffer_&&(q=(0,j.createEmpty)(),(0,j.extendCoordinate)(q,a),(0,j.buffer)(q,b*(this.renderBuffer_+d),q));var r,s=f(d);this.declutterTree_&&(r=this.declutterTree_.all().map(function(a){return a.value}));var v,w=Object.keys(this.replaysByZIndex_).map(Number);w.sort(h.numberSafeCompareFunction);var x,y,z,A,B;for(x=w.length-1;x>=0;--x){var C=w[x].toString();for(z=l.replaysByZIndex_[C],y=t.ORDER.length-1;y>=0;--y)if(v=t.ORDER[y],void 0!==(A=z[v]))if(!i||v!=n.default.IMAGE&&v!=n.default.TEXT){if(B=A.replayHitDetection(p,o,c,e,k,q))return B}else{var D=i[C];D?D.push(A,o.slice(0)):i[C]=[A,o.slice(0)]}}},b.prototype.getClipCoords=function(a){var b=this.maxExtent_,c=b[0],d=b[1],e=b[2],f=b[3],g=[c,d,c,f,e,f,e,d];return(0,k.transform2D)(g,0,8,2,a,g),g},b.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0",d=this.replaysByZIndex_[c];void 0===d&&(d={},this.replaysByZIndex_[c]=d);var e=d[b];if(void 0===e){e=new(0,v[b])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),d[b]=e}return e},b.prototype.getReplays=function(){return this.replaysByZIndex_},b.prototype.isEmpty=function(){return(0,l.isEmpty)(this.replaysByZIndex_)},b.prototype.replay=function(a,b,c,d,e,f,g){var i=this,j=Object.keys(this.replaysByZIndex_).map(Number);j.sort(h.numberSafeCompareFunction),a.save(),this.clip(a,b);var k,l,m,o,p,q,r=f||t.ORDER;for(k=0,l=j.length;k<l;++k){var s=j[k].toString();for(p=i.replaysByZIndex_[s],m=0,o=r.length;m<o;++m){var u=r[m];if(q=p[u],void 0!==q)if(!g||u!=n.default.IMAGE&&u!=n.default.TEXT)q.replay(a,b,c,d,e);else{var v=g[s];v?v.push(q,b.slice(0)):g[s]=[q,b.slice(0)]}}}a.restore()},b}(m.default),x={0:[[!0]]},y=w;c.default=y},{"../../array.js":46,"../../dom.js":64,"../../extent.js":72,"../../geom/flat/transform.js":160,"../../obj.js":201,"../../transform.js":340,"../ReplayGroup.js":222,"../ReplayType.js":223,"../canvas/ImageReplay.js":226,"../canvas/LineStringReplay.js":229,"../canvas/PolygonReplay.js":230,"../canvas/Replay.js":231,"../canvas/TextReplay.js":233,"../replay.js":234}],233:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){for(var d=b.length,e=0,f=0;f<d;++f){var g=(0,m.measureTextWidth)(a,b[f]);e=Math.max(e,g),c.push(g)}return e}Object.defineProperty(c,"__esModule",{value:!0}),c.measureTextWidths=e,c.default=void 0;var f=a("../../util.js"),g=a("../../colorlike.js"),h=a("../../dom.js"),i=a("../../extent.js"),j=a("../../geom/flat/straightchunk.js"),k=d(a("../../geom/GeometryType.js")),l=a("../../has.js"),m=a("../canvas.js"),n=d(a("../canvas/Instruction.js")),o=d(a("../canvas/Replay.js")),p=a("../replay.js"),q=d(a("../../style/TextPlacement.js")),r=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},m.labelCache.prune()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawText=function(a,b){var c=this,d=this.textFillState_,e=this.textStrokeState_,f=this.textState_;if(""!==this.text_&&f&&(d||e)){var g,h,l=this.coordinates.length,m=a.getType(),n=null,o=2,p=2;if(f.placement===q.default.LINE){if(!(0,i.intersects)(this.getBufferedMaxExtent(),a.getExtent()))return;var r;if(n=a.getFlatCoordinates(),p=a.getStride(),m==k.default.LINE_STRING)r=[n.length];else if(m==k.default.MULTI_LINE_STRING)r=a.getEnds();else if(m==k.default.POLYGON)r=a.getEnds().slice(0,1);else if(m==k.default.MULTI_POLYGON){var s=a.getEndss();for(r=[],g=0,h=s.length;g<h;++g)r.push(s[g][0])}this.beginGeometry(a,b);for(var t,u=f.textAlign,v=0,w=0,x=r.length;w<x;++w){if(void 0==u){var y=(0,j.matchingChunk)(f.maxAngle,n,v,r[w],p);v=y[0],t=y[1]}else t=r[w];for(g=v;g<t;g+=p)c.coordinates.push(n[g],n[g+1]);o=c.coordinates.length,v=r[w],c.drawChars_(l,o,c.declutterGroup_),l=o}this.endGeometry(a,b)}else{var z=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),A=z.width/this.pixelRatio;switch(m){case k.default.POINT:case k.default.MULTI_POINT:n=a.getFlatCoordinates(),o=n.length;break;case k.default.LINE_STRING:n=a.getFlatMidpoint();break;case k.default.CIRCLE:n=a.getCenter();break;case k.default.MULTI_LINE_STRING:n=a.getFlatMidpoints(),o=n.length;break;case k.default.POLYGON:if(n=a.getFlatInteriorPoint(),!f.overflow&&n[2]/this.resolution<A)return;p=3;break;case k.default.MULTI_POLYGON:var B=a.getFlatInteriorPoints();for(n=[],g=0,h=B.length;g<h;g+=3)(f.overflow||B[g+2]/c.resolution>=A)&&n.push(B[g],B[g+1]);if(0==(o=n.length))return}o=this.appendFlatCoordinates(n,0,o,p,!1,!1),(f.backgroundFill||f.backgroundStroke)&&(this.setFillStrokeStyle(f.backgroundFill,f.backgroundStroke),f.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,a),this.hitDetectionInstructions.push(this.createFill(this.state,a))),f.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(a,b),this.drawTextImage_(z,l,o),this.endGeometry(a,b)}}},b.prototype.getImage=function(a,b,c,d){var f,g=d+b+a+c+this.pixelRatio;if(!m.labelCache.containsKey(g)){var i=d?this.strokeStates[d]||this.textStrokeState_:null,j=c?this.fillStates[c]||this.textFillState_:null,k=this.textStates[b]||this.textState_,n=this.pixelRatio,o=k.scale*n,q=p.TEXT_ALIGN[k.textAlign||m.defaultTextAlign],r=d&&i.lineWidth?i.lineWidth:0,s=a.split("\n"),t=s.length,u=[],v=e(k.font,s,u),w=(0,m.measureTextHeight)(k.font),x=w*t,y=v+r,z=(0,h.createCanvasContext2D)(Math.ceil(y*o),Math.ceil((x+r)*o));f=z.canvas,m.labelCache.set(g,f),1!=o&&z.scale(o,o),z.font=k.font,d&&(z.strokeStyle=i.strokeStyle,z.lineWidth=r,z.lineCap=i.lineCap,z.lineJoin=i.lineJoin,z.miterLimit=i.miterLimit,l.CANVAS_LINE_DASH&&i.lineDash.length&&(z.setLineDash(i.lineDash),z.lineDashOffset=i.lineDashOffset)),c&&(z.fillStyle=j.fillStyle),z.textBaseline="middle",z.textAlign="center";var A,B=.5-q,C=q*f.width/o+B*r;if(d)for(A=0;A<t;++A)z.strokeText(s[A],C+B*u[A],.5*(r+w)+A*w);if(c)for(A=0;A<t;++A)z.fillText(s[A],C+B*u[A],.5*(r+w)+A*w)}return m.labelCache.get(g)},b.prototype.drawTextImage_=function(a,b,c){var d=this.textState_,e=this.textStrokeState_,f=this.pixelRatio,g=p.TEXT_ALIGN[d.textAlign||m.defaultTextAlign],h=p.TEXT_ALIGN[d.textBaseline],i=e&&e.lineWidth?e.lineWidth:0,j=g*a.width/f+2*(.5-g)*i,k=h*a.height/f+2*(.5-h)*i;this.instructions.push([n.default.DRAW_IMAGE,b,c,a,(j-this.textOffsetX_)*f,(k-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,a.width,d.padding==m.defaultPadding?m.defaultPadding:d.padding.map(function(a){return a*f}),!!d.backgroundFill,!!d.backgroundStroke]),this.hitDetectionInstructions.push([n.default.DRAW_IMAGE,b,c,a,(j-this.textOffsetX_)*f,(k-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/f,a.width,d.padding,!!d.backgroundFill,!!d.backgroundStroke])},b.prototype.drawChars_=function(a,b,c){var d=this.textStrokeState_,e=this.textState_,f=this.textFillState_,g=this.strokeKey_;d&&(g in this.strokeStates||(this.strokeStates[g]={strokeStyle:d.strokeStyle,lineCap:d.lineCap,lineDashOffset:d.lineDashOffset,lineWidth:d.lineWidth,lineJoin:d.lineJoin,miterLimit:d.miterLimit,lineDash:d.lineDash}));var h=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:e.font,textAlign:e.textAlign||m.defaultTextAlign,scale:e.scale});var i=this.fillKey_;f&&(i in this.fillStates||(this.fillStates[i]={fillStyle:f.fillStyle}));var j=this.pixelRatio,k=p.TEXT_ALIGN[e.textBaseline],l=this.textOffsetY_*j,o=this.text_,q=e.font,r=e.scale,s=d?d.lineWidth*r/2:0,t=this.widths_[q];t||(this.widths_[q]=t={}),this.instructions.push([n.default.DRAW_CHARS,a,b,k,c,e.overflow,i,e.maxAngle,function(a){var b=t[a];return b||(b=t[a]=(0,m.measureTextWidth)(q,a)),b*r*j},l,g,s*j,o,h,1]),this.hitDetectionInstructions.push([n.default.DRAW_CHARS,a,b,k,c,e.overflow,i,e.maxAngle,function(a){var b=t[a];return b||(b=t[a]=(0,m.measureTextWidth)(q,a)),b*r},l,g,s,o,h,1/j])},b.prototype.setTextStyle=function(a,b){var c,d,e;if(a){this.declutterGroup_=b;var h=a.getFill();h?(d=this.textFillState_,d||(d=this.textFillState_={}),d.fillStyle=(0,g.asColorLike)(h.getColor()||m.defaultFillStyle)):d=this.textFillState_=null;var i=a.getStroke();if(i){e=this.textStrokeState_,e||(e=this.textStrokeState_={});var j=i.getLineDash(),k=i.getLineDashOffset(),l=i.getWidth(),n=i.getMiterLimit();e.lineCap=i.getLineCap()||m.defaultLineCap,e.lineDash=j?j.slice():m.defaultLineDash,e.lineDashOffset=void 0===k?m.defaultLineDashOffset:k,e.lineJoin=i.getLineJoin()||m.defaultLineJoin,e.lineWidth=void 0===l?m.defaultLineWidth:l,e.miterLimit=void 0===n?m.defaultMiterLimit:n,e.strokeStyle=(0,g.asColorLike)(i.getColor()||m.defaultStrokeStyle)}else e=this.textStrokeState_=null;c=this.textState_;var o=a.getFont()||m.defaultFont;(0,m.checkFont)(o);var p=a.getScale();c.overflow=a.getOverflow(),c.font=o,c.maxAngle=a.getMaxAngle(),c.placement=a.getPlacement(),c.textAlign=a.getTextAlign(),c.textBaseline=a.getTextBaseline()||m.defaultTextBaseline,c.backgroundFill=a.getBackgroundFill(),c.backgroundStroke=a.getBackgroundStroke(),c.padding=a.getPadding()||m.defaultPadding,c.scale=void 0===p?1:p;var q=a.getOffsetX(),r=a.getOffsetY(),s=a.getRotateWithView(),t=a.getRotation();this.text_=a.getText()||"",this.textOffsetX_=void 0===q?0:q,this.textOffsetY_=void 0===r?0:r,this.textRotateWithView_=void 0!==s&&s,this.textRotation_=void 0===t?0:t,this.strokeKey_=e?("string"==typeof e.strokeStyle?e.strokeStyle:(0,f.getUid)(e.strokeStyle))+e.lineCap+e.lineDashOffset+"|"+e.lineWidth+e.lineJoin+e.miterLimit+"["+e.lineDash.join()+"]":"",this.textKey_=c.font+c.scale+(c.textAlign||"?"),this.fillKey_=d?"string"==typeof d.fillStyle?d.fillStyle:"|"+(0,f.getUid)(d.fillStyle):""}else this.text_=""},b}(o.default),s=r;c.default=s},{"../../colorlike.js":50,"../../dom.js":64,"../../extent.js":72,"../../geom/GeometryType.js":132,"../../geom/flat/straightchunk.js":157,"../../has.js":161,"../../style/TextPlacement.js":333,"../../util.js":342,"../canvas.js":225,"../canvas/Instruction.js":228,"../canvas/Replay.js":231,"../replay.js":234}],234:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_ALIGN=c.ORDER=void 0;var e=d(a("../render/ReplayType.js")),f=[e.default.POLYGON,e.default.CIRCLE,e.default.LINE_STRING,e.default.IMAGE,e.default.TEXT,e.default.DEFAULT];c.ORDER=f;var g={};c.TEXT_ALIGN=g,g.left=0,g.end=0,g.center=.5,g.right=1,g.start=1,g.top=0,g.middle=.5,g.hanging=.2,g.alphabetic=.8,g.ideographic=.8,g.bottom=1},{"../render/ReplayType.js":223}],235:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.triangleIsCounterClockwise=c.EPSILON=c.DEFAULT_LINEWIDTH=c.DEFAULT_TEXTBASELINE=c.DEFAULT_TEXTALIGN=c.DEFAULT_STROKESTYLE=c.DEFAULT_MITERLIMIT=c.DEFAULT_LINEJOIN=c.DEFAULT_LINEDASHOFFSET=c.DEFAULT_LINEDASH=c.DEFAULT_LINECAP=c.DEFAULT_FILLSTYLE=c.DEFAULT_FONT=void 0,c.DEFAULT_FONT="10px sans-serif";var d=[0,0,0,1];c.DEFAULT_FILLSTYLE=d,c.DEFAULT_LINECAP="round";var e=[];c.DEFAULT_LINEDASH=e,c.DEFAULT_LINEDASHOFFSET=0,c.DEFAULT_LINEJOIN="round",c.DEFAULT_MITERLIMIT=10;var f=[0,0,0,1];c.DEFAULT_STROKESTYLE=f,c.DEFAULT_TEXTALIGN=.5,c.DEFAULT_TEXTBASELINE=.5,c.DEFAULT_LINEWIDTH=1;var g=Number.EPSILON||2.220446049250313e-16;c.EPSILON=g;var h=function(a,b,c,d,e,f){var h=(c-a)*(f-b)-(e-a)*(d-b);return h<=g&&h>=-g?void 0:h>0};c.triangleIsCounterClockwise=h},{}],236:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../array.js"),g=a("../../color.js"),h=a("../../extent.js"),i=a("../../obj.js"),j=a("../../geom/flat/transform.js"),k=a("../webgl/circlereplay/defaultshader.js"),l=d(a("../webgl/circlereplay/defaultshader/Locations.js")),m=d(a("../webgl/Replay.js")),n=a("../webgl.js"),o=a("../../webgl.js"),p=d(a("../../webgl/Buffer.js")),q=function(a){function b(b,c){a.call(this,b,c),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c,d){var e,f,g=this,h=this.vertices.length,i=this.indices.length,j=h/4;for(e=b,f=c;e<f;e+=d)g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=0,g.vertices[h++]=g.radius_,g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=1,g.vertices[h++]=g.radius_,g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=2,g.vertices[h++]=g.radius_,g.vertices[h++]=a[e],g.vertices[h++]=a[e+1],g.vertices[h++]=3,g.vertices[h++]=g.radius_,g.indices[i++]=j,g.indices[i++]=j+1,g.indices[i++]=j+2,g.indices[i++]=j+2,g.indices[i++]=j+3,g.indices[i++]=j,j+=4},b.prototype.drawCircle=function(a,b){var c=a.getRadius(),d=a.getStride();if(c){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=c;var e=a.getFlatCoordinates();e=(0,j.translate)(e,0,2,d,-this.origin[0],-this.origin[1]),this.drawCoordinates_(e,0,2,d)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var f=this.styles_[this.styles_.length-1];this.state_.fillColor=f[0],this.state_.strokeColor=f[1],this.state_.lineWidth=f[2],this.state_.changed=!1}},b.prototype.finish=function(a){this.verticesBuffer=new p.default(this.vertices),this.indicesBuffer=new p.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b),a.deleteBuffer(c)}},b.prototype.setUpProgram=function(a,b,c,d){var e,f=b.getProgram(k.fragment,k.vertex);return this.defaultLocations_?e=this.defaultLocations_:(e=new l.default(a,f),this.defaultLocations_=e),b.useProgram(f),a.enableVertexAttribArray(e.a_position),a.vertexAttribPointer(e.a_position,2,o.FLOAT,!1,16,0),a.enableVertexAttribArray(e.a_instruction),a.vertexAttribPointer(e.a_instruction,1,o.FLOAT,!1,16,8),a.enableVertexAttribArray(e.a_radius),a.vertexAttribPointer(e.a_radius,1,o.FLOAT,!1,16,12),a.uniform2fv(e.u_size,c),a.uniform1f(e.u_pixelRatio,d),e},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position),a.disableVertexAttribArray(b.a_instruction),a.disableVertexAttribArray(b.a_radius)},b.prototype.drawReplay=function(a,b,c,d){var e=this;if((0,i.isEmpty)(c)){var f,g,h,j;for(h=this.startIndices[this.startIndices.length-1],f=this.styleIndices_.length-1;f>=0;--f)g=e.styleIndices_[f],j=e.styles_[f],e.setFillStyle_(a,j[0]),e.setStrokeStyle_(a,j[1],j[2]),e.drawElements(a,b,g,h),h=g}else this.drawReplaySkipping_(a,b,c)},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,f){var g,i,j,k,l,m,n,o,p=this;for(o=this.startIndices.length-2,j=this.startIndices[o+1],g=this.styleIndices_.length-1;g>=0;--g)for(k=p.styles_[g],p.setFillStyle_(a,k[0]),p.setStrokeStyle_(a,k[1],k[2]),l=p.styleIndices_[g];o>=0&&this.startIndices[o]>=l;){if(i=p.startIndices[o],m=p.startIndicesFeature[o],n=(0,e.getUid)(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===f||(0,h.intersects)(f,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),p.drawElements(a,b,i,j);var q=d(m);if(q)return q}o--,j=i}},b.prototype.drawReplaySkipping_=function(a,b,c){var d,f,g,h,i,j,k,l,m,n=this;for(l=this.startIndices.length-2,g=f=this.startIndices[l+1],d=this.styleIndices_.length-1;d>=0;--d){for(h=n.styles_[d],n.setFillStyle_(a,h[0]),n.setStrokeStyle_(a,h[1],h[2]),i=n.styleIndices_[d];l>=0&&this.startIndices[l]>=i;)m=n.startIndices[l],j=n.startIndicesFeature[l],k=(0,e.getUid)(j).toString(),c[k]&&(f!==g&&n.drawElements(a,b,f,g),g=m),l--,f=m;f!==g&&n.drawElements(a,b,f,g),f=g=i}},b.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_fillColor,b)},b.prototype.setStrokeStyle_=function(a,b,c){a.uniform4fv(this.defaultLocations_.u_strokeColor,b),a.uniform1f(this.defaultLocations_.u_lineWidth,c)},b.prototype.setFillStrokeStyle=function(a,b){var c,d;if(b){var e=b.getLineDash();this.state_.lineDash=e||n.DEFAULT_LINEDASH;var h=b.getLineDashOffset();this.state_.lineDashOffset=h||n.DEFAULT_LINEDASHOFFSET,c=b.getColor(),c=c instanceof CanvasGradient||c instanceof CanvasPattern?n.DEFAULT_STROKESTYLE:(0,g.asArray)(c).map(function(a,b){return 3!=b?a/255:a})||n.DEFAULT_STROKESTYLE,d=b.getWidth(),d=void 0!==d?d:n.DEFAULT_LINEWIDTH}else c=[0,0,0,0],d=0;var i=a?a.getColor():[0,0,0,0];i=i instanceof CanvasGradient||i instanceof CanvasPattern?n.DEFAULT_FILLSTYLE:(0,g.asArray)(i).map(function(a,b){return 3!=b?a/255:a})||n.DEFAULT_FILLSTYLE,this.state_.strokeColor&&(0,f.equals)(this.state_.strokeColor,c)&&this.state_.fillColor&&(0,f.equals)(this.state_.fillColor,i)&&this.state_.lineWidth===d||(this.state_.changed=!0,this.state_.fillColor=i,this.state_.strokeColor=c,this.state_.lineWidth=d,this.styles_.push([i,c,d]))},b}(m.default),r=q;c.default=r},{"../../array.js":46,"../../color.js":49,"../../extent.js":72,"../../geom/flat/transform.js":160,"../../obj.js":201,"../../util.js":342,"../../webgl.js":344,"../../webgl/Buffer.js":345,"../webgl.js":235,"../webgl/Replay.js":241,"../webgl/circlereplay/defaultshader.js":245,"../webgl/circlereplay/defaultshader/Locations.js":246}],237:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../webgl/TextureReplay.js")),g=d(a("../../webgl/Buffer.js")),h=function(a){function b(b,c){a.call(this,b,c),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawMultiPoint=function(a,b){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b);var c=a.getFlatCoordinates(),d=a.getStride();this.drawCoordinates(c,0,c.length,d)},b.prototype.drawPoint=function(a,b){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b);var c=a.getFlatCoordinates(),d=a.getStride();this.drawCoordinates(c,0,c.length,d)},b.prototype.finish=function(b){var c=b.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new g.default(this.vertices);var d=this.indices;this.indicesBuffer=new g.default(d);var e={};this.createTextures(this.textures_,this.images_,e,c),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,e,c),this.images_=null,this.hitDetectionImages_=null,a.prototype.finish.call(this,b)},b.prototype.setImageStyle=function(a){var b,c=a.getAnchor(),d=a.getImage(1),f=a.getImageSize(),g=a.getHitDetectionImage(1),h=a.getOpacity(),i=a.getOrigin(),j=a.getRotateWithView(),k=a.getRotation(),l=a.getSize(),m=a.getScale();0===this.images_.length?this.images_.push(d):(b=this.images_[this.images_.length-1],(0,e.getUid)(b)!=(0,e.getUid)(d)&&(this.groupIndices.push(this.indices.length),this.images_.push(d))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(g):(b=this.hitDetectionImages_[this.hitDetectionImages_.length-1],(0,e.getUid)(b)!=(0,e.getUid)(g)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(g))),this.anchorX=c[0],this.anchorY=c[1],this.height=l[1],this.imageHeight=f[1],this.imageWidth=f[0],this.opacity=h,this.originX=i[0],this.originY=i[1],this.rotation=k,this.rotateWithView=j,this.scale=m,this.width=l[0]},b.prototype.getTextures=function(a){return a?this.textures_.concat(this.hitDetectionTextures_):this.textures_},b.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},b}(f.default),i=h;c.default=i},{"../../util.js":342,"../../webgl/Buffer.js":345,"../webgl/TextureReplay.js":244}],238:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../extent.js"),f=d(a("../../geom/GeometryType.js")),g=d(a("../ReplayType.js")),h=d(a("../VectorContext.js")),i=d(a("../webgl/ReplayGroup.js")),j=function(a){function b(b,c,d,e,f,g,h){a.call(this),this.context_=b,this.center_=c,this.extent_=g,this.pixelRatio_=h,this.size_=f,this.rotation_=e,this.resolution_=d,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawText_=function(a,b){var c=this.context_,d=a.getReplay(0,g.default.TEXT);d.setTextStyle(this.textStyle_),d.drawText(b,null),d.finish(c);var e,f=1,h={};d.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,f,h,e,!1),d.getDeleteResourcesFunction(c)()},b.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke()),this.setImageStyle(a.getImage()),this.setTextStyle(a.getText())},b.prototype.drawGeometry=function(a){switch(a.getType()){case f.default.POINT:this.drawPoint(a,null);break;case f.default.LINE_STRING:this.drawLineString(a,null);break;case f.default.POLYGON:this.drawPolygon(a,null);break;case f.default.MULTI_POINT:this.drawMultiPoint(a,null);break;case f.default.MULTI_LINE_STRING:this.drawMultiLineString(a,null);break;case f.default.MULTI_POLYGON:this.drawMultiPolygon(a,null);break;case f.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(a,null);break;case f.default.CIRCLE:this.drawCircle(a,null)}},b.prototype.drawFeature=function(a,b){var c=b.getGeometryFunction()(a);c&&(0,e.intersects)(this.extent_,c.getExtent())&&(this.setStyle(b),this.drawGeometry(c))},b.prototype.drawGeometryCollection=function(a,b){var c,d,e=this,f=a.getGeometriesArray();for(c=0,d=f.length;c<d;++c)e.drawGeometry(f[c])},b.prototype.drawPoint=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.IMAGE);e.setImageStyle(this.imageStyle_),e.drawPoint(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawMultiPoint=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.IMAGE);e.setImageStyle(this.imageStyle_),e.drawMultiPoint(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawLineString=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_),e.drawLineString(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawMultiLineString=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_),e.drawMultiLineString(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawPolygon=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),e.drawPolygon(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawMultiPolygon=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),e.drawMultiPolygon(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.drawCircle=function(a,b){var c=this.context_,d=new i.default(1,this.extent_),e=d.getReplay(0,g.default.CIRCLE);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),e.drawCircle(a,b),e.finish(c);var f,h=1,j={};e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,h,j,f,!1),e.getDeleteResourcesFunction(c)(),this.textStyle_&&this.drawText_(d,a)},b.prototype.setImageStyle=function(a){this.imageStyle_=a},b.prototype.setFillStrokeStyle=function(a,b){this.fillStyle_=a,this.strokeStyle_=b},b.prototype.setTextStyle=function(a){this.textStyle_=a},b}(h.default),k=j;c.default=k},{"../../extent.js":72,"../../geom/GeometryType.js":132,"../ReplayType.js":223,"../VectorContext.js":224,"../webgl/ReplayGroup.js":242}],239:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../array.js"),g=a("../../color.js"),h=a("../../extent.js"),i=a("../../geom/flat/orient.js"),j=a("../../geom/flat/transform.js"),k=a("../../geom/flat/topology.js"),l=a("../../obj.js"),m=a("../webgl.js"),n=d(a("../webgl/Replay.js")),o=a("../webgl/linestringreplay/defaultshader.js"),p=d(a("../webgl/linestringreplay/defaultshader/Locations.js")),q=a("../../webgl.js"),r=d(a("../../webgl/Buffer.js")),s={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23},t=function(a){function b(b,c){a.call(this,b,c),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c,d){var e,g,h,j,l,n,o,p,q=this,r=this.vertices.length,t=this.indices.length,u="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,v="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,w=(0,k.lineStringIsClosed)(a,b,c,d),x=t,y=1;for(e=b,g=c;e<g;e+=d){if(l=r/7,n=o,o=p||[a[e],a[e+1]],e===b){if(p=[a[e+d],a[e+d+1]],c-b==2*d&&(0,f.equals)(o,p))break;if(!w){v&&(r=q.addVertices_([0,0],o,p,y*s.BEGIN_LINE_CAP*v,r),r=q.addVertices_([0,0],o,p,-y*s.BEGIN_LINE_CAP*v,r),q.indices[t++]=l+2,q.indices[t++]=l,q.indices[t++]=l+1,q.indices[t++]=l+1,q.indices[t++]=l+3,q.indices[t++]=l+2),r=q.addVertices_([0,0],o,p,y*s.BEGIN_LINE*(v||1),r),r=q.addVertices_([0,0],o,p,-y*s.BEGIN_LINE*(v||1),r),x=r/7-1;continue}n=[a[c-2*d],a[c-2*d+1]],h=p}else{if(e===c-d){if(w){p=h;break}n=n||[0,0],r=q.addVertices_(n,o,[0,0],y*s.END_LINE*(v||1),r),r=q.addVertices_(n,o,[0,0],-y*s.END_LINE*(v||1),r),q.indices[t++]=l,q.indices[t++]=x-1,q.indices[t++]=x,q.indices[t++]=x,q.indices[t++]=l+1,q.indices[t++]=l,v&&(r=q.addVertices_(n,o,[0,0],y*s.END_LINE_CAP*v,r),r=q.addVertices_(n,o,[0,0],-y*s.END_LINE_CAP*v,r),q.indices[t++]=l+2,q.indices[t++]=l,q.indices[t++]=l+1,q.indices[t++]=l+1,q.indices[t++]=l+3,q.indices[t++]=l+2);break}p=[a[e+d],a[e+d+1]]}j=(0,m.triangleIsCounterClockwise)(n[0],n[1],o[0],o[1],p[0],p[1])?-1:1,r=q.addVertices_(n,o,p,j*s.BEVEL_FIRST*(u||1),r),r=q.addVertices_(n,o,p,j*s.BEVEL_SECOND*(u||1),r),r=q.addVertices_(n,o,p,-j*s.MITER_BOTTOM*(u||1),r),e>b&&(q.indices[t++]=l,q.indices[t++]=x-1,q.indices[t++]=x,q.indices[t++]=l+2,q.indices[t++]=l,q.indices[t++]=y*j>0?x:x-1),q.indices[t++]=l,q.indices[t++]=l+2,q.indices[t++]=l+1,x=l+2,y=j,u&&(r=q.addVertices_(n,o,p,j*s.MITER_TOP*u,r),q.indices[t++]=l+1,q.indices[t++]=l+3,q.indices[t++]=l)}w&&(l=l||r/7,j=(0,i.linearRingIsClockwise)([n[0],n[1],o[0],o[1],p[0],p[1]],0,6,2)?1:-1,r=this.addVertices_(n,o,p,j*s.BEVEL_FIRST*(u||1),r),r=this.addVertices_(n,o,p,-j*s.MITER_BOTTOM*(u||1),r),this.indices[t++]=l,this.indices[t++]=x-1,this.indices[t++]=x,this.indices[t++]=l+1,this.indices[t++]=l,
this.indices[t++]=y*j>0?x:x-1)},b.prototype.addVertices_=function(a,b,c,d,e){return this.vertices[e++]=a[0],this.vertices[e++]=a[1],this.vertices[e++]=b[0],this.vertices[e++]=b[1],this.vertices[e++]=c[0],this.vertices[e++]=c[1],this.vertices[e++]=d,e},b.prototype.isValid_=function(a,b,c,d){var e=c-b;if(e<2*d)return!1;if(e===2*d){var g=[a[b],a[b+1]],h=[a[b+d],a[b+d+1]];return!(0,f.equals)(g,h)}return!0},b.prototype.drawLineString=function(a,b){var c=a.getFlatCoordinates(),d=a.getStride();this.isValid_(c,0,c.length,d)&&(c=(0,j.translate)(c,0,c.length,d,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.drawCoordinates_(c,0,c.length,d))},b.prototype.drawMultiLineString=function(a,b){var c=this,d=this.indices.length,e=a.getEnds();e.unshift(0);var f,g,h=a.getFlatCoordinates(),i=a.getStride();if(e.length>1)for(f=1,g=e.length;f<g;++f)if(c.isValid_(h,e[f-1],e[f],i)){var k=(0,j.translate)(h,e[f-1],e[f],i,-c.origin[0],-c.origin[1]);c.drawCoordinates_(k,0,k.length,i)}this.indices.length>d&&(this.startIndices.push(d),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(d),this.state_.changed=!1))},b.prototype.drawPolygonCoordinates=function(a,b,c){var d=this;if((0,k.lineStringIsClosed)(a,0,a.length,c)||(a.push(a[0]),a.push(a[1])),this.drawCoordinates_(a,0,a.length,c),b.length){var e,f;for(e=0,f=b.length;e<f;++e)(0,k.lineStringIsClosed)(b[e],0,b[e].length,c)||(b[e].push(b[e][0]),b[e].push(b[e][1])),d.drawCoordinates_(b[e],0,b[e].length,c)}},b.prototype.setPolygonStyle=function(a,b){var c=void 0===b?this.indices.length:b;this.startIndices.push(c),this.startIndicesFeature.push(a),this.state_.changed&&(this.styleIndices_.push(c),this.state_.changed=!1)},b.prototype.getCurrentIndex=function(){return this.indices.length},b.prototype.finish=function(a){this.verticesBuffer=new r.default(this.vertices),this.indicesBuffer=new r.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b),a.deleteBuffer(c)}},b.prototype.setUpProgram=function(a,b,c,d){var e,f=b.getProgram(o.fragment,o.vertex);return this.defaultLocations_?e=this.defaultLocations_:(e=new p.default(a,f),this.defaultLocations_=e),b.useProgram(f),a.enableVertexAttribArray(e.a_lastPos),a.vertexAttribPointer(e.a_lastPos,2,q.FLOAT,!1,28,0),a.enableVertexAttribArray(e.a_position),a.vertexAttribPointer(e.a_position,2,q.FLOAT,!1,28,8),a.enableVertexAttribArray(e.a_nextPos),a.vertexAttribPointer(e.a_nextPos,2,q.FLOAT,!1,28,16),a.enableVertexAttribArray(e.a_direction),a.vertexAttribPointer(e.a_direction,1,q.FLOAT,!1,28,24),a.uniform2fv(e.u_size,c),a.uniform1f(e.u_pixelRatio,d),e},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_lastPos),a.disableVertexAttribArray(b.a_position),a.disableVertexAttribArray(b.a_nextPos),a.disableVertexAttribArray(b.a_direction)},b.prototype.drawReplay=function(a,b,c,d){var e=this,f=a.getParameter(a.DEPTH_FUNC),g=a.getParameter(a.DEPTH_WRITEMASK);if(d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL)),(0,l.isEmpty)(c)){var h,i,j,k;for(j=this.startIndices[this.startIndices.length-1],h=this.styleIndices_.length-1;h>=0;--h)i=e.styleIndices_[h],k=e.styles_[h],e.setStrokeStyle_(a,k[0],k[1],k[2]),e.drawElements(a,b,i,j),a.clear(a.DEPTH_BUFFER_BIT),j=i}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(g),a.depthFunc(f))},b.prototype.drawReplaySkipping_=function(a,b,c){var d,f,g,h,i,j,k,l,m,n=this;for(l=this.startIndices.length-2,g=f=this.startIndices[l+1],d=this.styleIndices_.length-1;d>=0;--d){for(h=n.styles_[d],n.setStrokeStyle_(a,h[0],h[1],h[2]),i=n.styleIndices_[d];l>=0&&this.startIndices[l]>=i;)m=n.startIndices[l],j=n.startIndicesFeature[l],k=(0,e.getUid)(j).toString(),c[k]&&(f!==g&&(n.drawElements(a,b,f,g),a.clear(a.DEPTH_BUFFER_BIT)),g=m),l--,f=m;f!==g&&(n.drawElements(a,b,f,g),a.clear(a.DEPTH_BUFFER_BIT)),f=g=i}},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,f){var g,i,j,k,l,m,n,o,p=this;for(o=this.startIndices.length-2,j=this.startIndices[o+1],g=this.styleIndices_.length-1;g>=0;--g)for(k=p.styles_[g],p.setStrokeStyle_(a,k[0],k[1],k[2]),l=p.styleIndices_[g];o>=0&&this.startIndices[o]>=l;){if(i=p.startIndices[o],m=p.startIndicesFeature[o],n=(0,e.getUid)(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===f||(0,h.intersects)(f,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),p.drawElements(a,b,i,j);var q=d(m);if(q)return q}o--,j=i}},b.prototype.setStrokeStyle_=function(a,b,c,d){a.uniform4fv(this.defaultLocations_.u_color,b),a.uniform1f(this.defaultLocations_.u_lineWidth,c),a.uniform1f(this.defaultLocations_.u_miterLimit,d)},b.prototype.setFillStrokeStyle=function(a,b){var c=b.getLineCap();this.state_.lineCap=void 0!==c?c:m.DEFAULT_LINECAP;var d=b.getLineDash();this.state_.lineDash=d||m.DEFAULT_LINEDASH;var e=b.getLineDashOffset();this.state_.lineDashOffset=e||m.DEFAULT_LINEDASHOFFSET;var h=b.getLineJoin();this.state_.lineJoin=void 0!==h?h:m.DEFAULT_LINEJOIN;var i=b.getColor();i=i instanceof CanvasGradient||i instanceof CanvasPattern?m.DEFAULT_STROKESTYLE:(0,g.asArray)(i).map(function(a,b){return 3!=b?a/255:a})||m.DEFAULT_STROKESTYLE;var j=b.getWidth();j=void 0!==j?j:m.DEFAULT_LINEWIDTH;var k=b.getMiterLimit();k=void 0!==k?k:m.DEFAULT_MITERLIMIT,this.state_.strokeColor&&(0,f.equals)(this.state_.strokeColor,i)&&this.state_.lineWidth===j&&this.state_.miterLimit===k||(this.state_.changed=!0,this.state_.strokeColor=i,this.state_.lineWidth=j,this.state_.miterLimit=k,this.styles_.push([i,j,k]))},b}(n.default),u=t;c.default=u},{"../../array.js":46,"../../color.js":49,"../../extent.js":72,"../../geom/flat/orient.js":153,"../../geom/flat/topology.js":159,"../../geom/flat/transform.js":160,"../../obj.js":201,"../../util.js":342,"../../webgl.js":344,"../../webgl/Buffer.js":345,"../webgl.js":235,"../webgl/Replay.js":241,"../webgl/linestringreplay/defaultshader.js":247,"../webgl/linestringreplay/defaultshader/Locations.js":248}],240:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../util.js"),g=a("../../array.js"),h=a("../../color.js"),i=a("../../extent.js"),j=a("../../obj.js"),k=a("../../geom/flat/contains.js"),l=a("../../geom/flat/orient.js"),m=a("../../geom/flat/transform.js"),n=a("../webgl/polygonreplay/defaultshader.js"),o=d(a("../webgl/polygonreplay/defaultshader/Locations.js")),p=d(a("../webgl/LineStringReplay.js")),q=d(a("../webgl/Replay.js")),r=a("../webgl.js"),s=d(a("../../style/Stroke.js")),t=d(a("../../structs/LinkedList.js")),u=d(a("../../structs/RBush.js")),v=a("../../webgl.js"),w=d(a("../../webgl/Buffer.js")),x=function(a){function b(b,c){a.call(this,b,c),this.lineStringReplay=new p.default(b,c),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawCoordinates_=function(a,b,c){var d=this,e=new t.default,f=new u.default;this.processFlatCoordinates_(a,c,e,f,!0);var g=this.getMaxCoords_(e);if(b.length){var h,i,j=[];for(h=0,i=b.length;h<i;++h){var k={list:new t.default,maxCoords:void 0,rtree:new u.default};j.push(k),d.processFlatCoordinates_(b[h],c,k.list,k.rtree,!1),d.classifyPoints_(k.list,k.rtree,!0),k.maxCoords=d.getMaxCoords_(k.list)}for(j.sort(function(a,b){return b.maxCoords[0]===a.maxCoords[0]?a.maxCoords[1]-b.maxCoords[1]:b.maxCoords[0]-a.maxCoords[0]}),h=0;h<j.length;++h){var l=j[h].list,m=l.firstItem(),n=m,o=void 0;do{if(d.getIntersections_(n,f).length){o=!0;break}n=l.nextItem()}while(m!==n);o||d.bridgeHole_(l,j[h].maxCoords[0],e,g[0],f)&&(f.concat(j[h].rtree),d.classifyPoints_(e,f,!1))}}else this.classifyPoints_(e,f,!1);this.triangulate_(e,f)},b.prototype.processFlatCoordinates_=function(a,b,c,d,e){var f,g,h,i,j,k=this,m=(0,l.linearRingIsClockwise)(a,0,a.length,b),n=this.vertices.length/2,o=[],p=[];if(e===m){for(h=this.createPoint_(a[0],a[1],n++),i=h,f=b,g=a.length;f<g;f+=b)j=k.createPoint_(a[f],a[f+1],n++),p.push(k.insertItem_(i,j,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)]),i=j;p.push(this.insertItem_(j,h,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)])}else{var q=a.length-b;for(h=this.createPoint_(a[q],a[q+1],n++),i=h,f=q-b,g=0;f>=g;f-=b)j=k.createPoint_(a[f],a[f+1],n++),p.push(k.insertItem_(i,j,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)]),i=j;p.push(this.insertItem_(j,h,c)),o.push([Math.min(i.x,j.x),Math.min(i.y,j.y),Math.max(i.x,j.x),Math.max(i.y,j.y)])}d.load(o,p)},b.prototype.getMaxCoords_=function(a){var b=a.firstItem(),c=b,d=[c.p0.x,c.p0.y];do{c=a.nextItem(),c.p0.x>d[0]&&(d=[c.p0.x,c.p0.y])}while(c!==b);return d},b.prototype.classifyPoints_=function(a,b,c){var d=this,e=a.firstItem(),f=e,g=a.nextItem(),h=!1;do{var i=c?(0,r.triangleIsCounterClockwise)(g.p1.x,g.p1.y,f.p1.x,f.p1.y,f.p0.x,f.p0.y):(0,r.triangleIsCounterClockwise)(f.p0.x,f.p0.y,f.p1.x,f.p1.y,g.p1.x,g.p1.y);void 0===i?(d.removeItem_(f,g,a,b),h=!0,g===e&&(e=a.getNextItem()),g=f,a.prevItem()):f.p1.reflex!==i&&(f.p1.reflex=i,h=!0),f=g,g=a.nextItem()}while(f!==e);return h},b.prototype.bridgeHole_=function(a,b,c,d,e){for(var f=this,g=a.firstItem();g.p1.x!==b;)g=a.nextItem();var h,i,j,k,l=g.p1,m={x:d,y:l.y,i:-1},n=1/0,o=this.getIntersections_({p0:l,p1:m},e,!0);for(h=0,i=o.length;h<i;++h){var p=o[h],q=f.calculateIntersection_(l,m,p.p0,p.p1,!0),s=Math.abs(l.x-q[0]);s<n&&void 0!==(0,r.triangleIsCounterClockwise)(l.x,l.y,p.p0.x,p.p0.y,p.p1.x,p.p1.y)&&(n=s,k={x:q[0],y:q[1],i:-1},g=p)}if(n===1/0)return!1;if(j=g.p1,n>0){var t=this.getPointsInTriangle_(l,k,g.p1,e);if(t.length){var u=1/0;for(h=0,i=t.length;h<i;++h){var v=t[h],w=Math.atan2(l.y-v.y,m.x-v.x);(w<u||w===u&&v.x<j.x)&&(u=w,j=v)}}}for(g=c.firstItem();g.p1.x!==j.x||g.p1.y!==j.y;)g=c.nextItem();var x={x:l.x,y:l.y,i:l.i,reflex:void 0},y={x:g.p1.x,y:g.p1.y,i:g.p1.i,reflex:void 0};return a.getNextItem().p0=x,this.insertItem_(l,g.p1,a,e),this.insertItem_(y,x,a,e),g.p1=y,a.setFirstItem(),c.concat(a),!0},b.prototype.triangulate_=function(a,b){for(var c=this,d=!1,e=this.isSimple_(a,b);a.getLength()>3;)if(e){if(!c.clipEars_(a,b,e,d)&&!c.classifyPoints_(a,b,d)&&!c.resolveSelfIntersections_(a,b,!0))break}else if(!c.clipEars_(a,b,e,d)&&!c.classifyPoints_(a,b,d)&&!c.resolveSelfIntersections_(a,b)){if(!(e=c.isSimple_(a,b))){c.splitPolygon_(a,b);break}d=!c.isClockwise_(a),c.classifyPoints_(a,b,d)}if(3===a.getLength()){var f=this.indices.length;this.indices[f++]=a.getPrevItem().p0.i,this.indices[f++]=a.getCurrItem().p0.i,this.indices[f++]=a.getNextItem().p0.i}},b.prototype.clipEars_=function(a,b,c,d){var e,f,g,h=this,i=this.indices.length,j=a.firstItem(),k=a.getPrevItem(),m=j,n=a.nextItem(),o=a.getNextItem(),p=!1;do{if(e=m.p0,f=m.p1,g=n.p1,!1===f.reflex){var q=void 0;q=c?0===h.getPointsInTriangle_(e,f,g,b,!0).length:d?h.diagonalIsInside_(o.p1,g,f,e,k.p0):h.diagonalIsInside_(k.p0,e,f,g,o.p1),(c||0===h.getIntersections_({p0:e,p1:g},b).length)&&q&&(c||!1===e.reflex||!1===g.reflex||(0,l.linearRingIsClockwise)([k.p0.x,k.p0.y,e.x,e.y,f.x,f.y,g.x,g.y,o.p1.x,o.p1.y],0,10,2)===!d)&&(h.indices[i++]=e.i,h.indices[i++]=f.i,h.indices[i++]=g.i,h.removeItem_(m,n,a,b),n===j&&(j=o),p=!0)}k=a.getPrevItem(),m=a.getCurrItem(),n=a.nextItem(),o=a.getNextItem()}while(m!==j&&a.getLength()>3);return p},b.prototype.resolveSelfIntersections_=function(a,b,c){var d=this,e=a.firstItem();a.nextItem();var f=e,g=a.nextItem(),h=!1;do{var i=d.calculateIntersection_(f.p0,f.p1,g.p0,g.p1,c);if(i){var j=!1,k=d.vertices.length,l=d.indices.length,m=k/2,n=a.prevItem();a.removeItem(),b.remove(n),j=n===e;var o=void 0;if(c?(i[0]===f.p0.x&&i[1]===f.p0.y?(a.prevItem(),o=f.p0,g.p0=o,b.remove(f),j=j||f===e):(o=g.p1,f.p1=o,b.remove(g),j=j||g===e),a.removeItem()):(o=d.createPoint_(i[0],i[1],m),f.p1=o,g.p0=o,b.update([Math.min(f.p0.x,f.p1.x),Math.min(f.p0.y,f.p1.y),Math.max(f.p0.x,f.p1.x),Math.max(f.p0.y,f.p1.y)],f),b.update([Math.min(g.p0.x,g.p1.x),Math.min(g.p0.y,g.p1.y),Math.max(g.p0.x,g.p1.x),Math.max(g.p0.y,g.p1.y)],g)),d.indices[l++]=n.p0.i,d.indices[l++]=n.p1.i,d.indices[l++]=o.i,h=!0,j)break}f=a.getPrevItem(),g=a.nextItem()}while(f!==e);return h},b.prototype.isSimple_=function(a,b){var c=this,d=a.firstItem(),e=d;do{if(c.getIntersections_(e,b).length)return!1;e=a.nextItem()}while(e!==d);return!0},b.prototype.isClockwise_=function(a){var b=2*a.getLength(),c=new Array(b),d=a.firstItem(),e=d,f=0;do{c[f++]=e.p0.x,c[f++]=e.p0.y,e=a.nextItem()}while(e!==d);return(0,l.linearRingIsClockwise)(c,0,b,2)},b.prototype.splitPolygon_=function(a,b){var c=this,d=a.firstItem(),e=d;do{var f=c.getIntersections_(e,b);if(f.length){var g=f[0],h=c.vertices.length/2,i=c.calculateIntersection_(e.p0,e.p1,g.p0,g.p1),j=c.createPoint_(i[0],i[1],h),k=new t.default,l=new u.default;c.insertItem_(j,e.p1,k,l),e.p1=j,b.update([Math.min(e.p0.x,j.x),Math.min(e.p0.y,j.y),Math.max(e.p0.x,j.x),Math.max(e.p0.y,j.y)],e);for(var m=a.nextItem();m!==g;)c.insertItem_(m.p0,m.p1,k,l),b.remove(m),a.removeItem(),m=a.getCurrItem();c.insertItem_(g.p0,j,k,l),g.p0=j,b.update([Math.min(g.p1.x,j.x),Math.min(g.p1.y,j.y),Math.max(g.p1.x,j.x),Math.max(g.p1.y,j.y)],g),c.classifyPoints_(a,b,!1),c.triangulate_(a,b),c.classifyPoints_(k,l,!1),c.triangulate_(k,l);break}e=a.nextItem()}while(e!==d)},b.prototype.createPoint_=function(a,b,c){var d=this.vertices.length;return this.vertices[d++]=a,this.vertices[d++]=b,{x:a,y:b,i:c,reflex:void 0}},b.prototype.insertItem_=function(a,b,c,d){var e={p0:a,p1:b};return c.insertItem(e),d&&d.insert([Math.min(a.x,b.x),Math.min(a.y,b.y),Math.max(a.x,b.x),Math.max(a.y,b.y)],e),e},b.prototype.removeItem_=function(a,b,c,d){c.getCurrItem()===b&&(c.removeItem(),a.p1=b.p1,d.remove(b),d.update([Math.min(a.p0.x,a.p1.x),Math.min(a.p0.y,a.p1.y),Math.max(a.p0.x,a.p1.x),Math.max(a.p0.y,a.p1.y)],a))},b.prototype.getPointsInTriangle_=function(a,b,c,d,f){for(var g=[],h=d.getInExtent([Math.min(a.x,b.x,c.x),Math.min(a.y,b.y,c.y),Math.max(a.x,b.x,c.x),Math.max(a.y,b.y,c.y)]),i=0,j=h.length;i<j;++i)for(var l in h[i]){var m=h[i][l];"object"!==e(m)||f&&!m.reflex||m.x===a.x&&m.y===a.y||m.x===b.x&&m.y===b.y||m.x===c.x&&m.y===c.y||-1!==g.indexOf(m)||!(0,k.linearRingContainsXY)([a.x,a.y,b.x,b.y,c.x,c.y],0,6,2,m.x,m.y)||g.push(m)}return g},b.prototype.getIntersections_=function(a,b,c){for(var d=this,e=a.p0,f=a.p1,g=b.getInExtent([Math.min(e.x,f.x),Math.min(e.y,f.y),Math.max(e.x,f.x),Math.max(e.y,f.y)]),h=[],i=0,j=g.length;i<j;++i){var k=g[i];a!==k&&(c||k.p0!==f||k.p1!==e)&&d.calculateIntersection_(e,f,k.p0,k.p1,c)&&h.push(k)}return h},b.prototype.calculateIntersection_=function(a,b,c,d,e){var f=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!==f){var g=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/f,h=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/f;if(!e&&g>r.EPSILON&&g<1-r.EPSILON&&h>r.EPSILON&&h<1-r.EPSILON||e&&g>=0&&g<=1&&h>=0&&h<=1)return[a.x+g*(b.x-a.x),a.y+g*(b.y-a.y)]}},b.prototype.diagonalIsInside_=function(a,b,c,d,e){if(void 0===b.reflex||void 0===d.reflex)return!1;var f=(c.x-d.x)*(b.y-d.y)>(c.y-d.y)*(b.x-d.x),g=(e.x-d.x)*(b.y-d.y)<(e.y-d.y)*(b.x-d.x),h=(a.x-b.x)*(d.y-b.y)>(a.y-b.y)*(d.x-b.x),i=(c.x-b.x)*(d.y-b.y)<(c.y-b.y)*(d.x-b.x),j=d.reflex?g||f:g&&f,k=b.reflex?i||h:i&&h;return j&&k},b.prototype.drawMultiPolygon=function(a,b){var c,d,e,f,g=this,h=a.getEndss(),i=a.getStride(),j=this.indices.length,k=this.lineStringReplay.getCurrentIndex(),l=a.getFlatCoordinates(),n=0;for(c=0,d=h.length;c<d;++c){var o=h[c];if(o.length>0){var p=(0,m.translate)(l,n,o[0],i,-g.origin[0],-g.origin[1]);if(p.length){var q=[],r=void 0;for(e=1,f=o.length;e<f;++e)o[e]!==o[e-1]&&(r=(0,m.translate)(l,o[e-1],o[e],i,-g.origin[0],-g.origin[1]),q.push(r));g.lineStringReplay.drawPolygonCoordinates(p,q,i),g.drawCoordinates_(p,q,i)}}n=o[o.length-1]}this.indices.length>j&&(this.startIndices.push(j),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(j),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>k&&this.lineStringReplay.setPolygonStyle(b,k)},b.prototype.drawPolygon=function(a,b){var c=this,d=a.getEnds(),e=a.getStride();if(d.length>0){var f=a.getFlatCoordinates().map(Number),g=(0,m.translate)(f,0,d[0],e,-this.origin[0],-this.origin[1]);if(g.length){var h,i,j,k=[];for(h=1,i=d.length;h<i;++h)d[h]!==d[h-1]&&(j=(0,m.translate)(f,d[h-1],d[h],e,-c.origin[0],-c.origin[1]),k.push(j));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(b),this.lineStringReplay.drawPolygonCoordinates(g,k,e),this.drawCoordinates_(g,k,e)}}},b.prototype.finish=function(a){this.verticesBuffer=new w.default(this.vertices),this.indicesBuffer=new w.default(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(a),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.lineStringReplay.getDeleteResourcesFunction(a);return function(){a.deleteBuffer(b),a.deleteBuffer(c),d()}},b.prototype.setUpProgram=function(a,b,c,d){var e,f=b.getProgram(n.fragment,n.vertex);return this.defaultLocations_?e=this.defaultLocations_:(e=new o.default(a,f),this.defaultLocations_=e),b.useProgram(f),a.enableVertexAttribArray(e.a_position),a.vertexAttribPointer(e.a_position,2,v.FLOAT,!1,8,0),e},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position)},b.prototype.drawReplay=function(a,b,c,d){var e=this,f=a.getParameter(a.DEPTH_FUNC),g=a.getParameter(a.DEPTH_WRITEMASK);if(d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL)),(0,j.isEmpty)(c)){var h,i,k,l;for(k=this.startIndices[this.startIndices.length-1],h=this.styleIndices_.length-1;h>=0;--h)i=e.styleIndices_[h],l=e.styles_[h],e.setFillStyle_(a,l),e.drawElements(a,b,i,k),k=i}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(g),a.depthFunc(f))},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){var g,h,j,k,l,m,n,o,p=this;for(o=this.startIndices.length-2,j=this.startIndices[o+1],g=this.styleIndices_.length-1;g>=0;--g)for(k=p.styles_[g],p.setFillStyle_(a,k),l=p.styleIndices_[g];o>=0&&this.startIndices[o]>=l;){if(h=p.startIndices[o],m=p.startIndicesFeature[o],n=(0,f.getUid)(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===e||(0,i.intersects)(e,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),p.drawElements(a,b,h,j);var q=d(m);if(q)return q}o--,j=h}},b.prototype.drawReplaySkipping_=function(a,b,c){var d,e,g,h,i,j,k,l,m,n=this;for(l=this.startIndices.length-2,g=e=this.startIndices[l+1],d=this.styleIndices_.length-1;d>=0;--d){for(h=n.styles_[d],n.setFillStyle_(a,h),i=n.styleIndices_[d];l>=0&&this.startIndices[l]>=i;)m=n.startIndices[l],j=n.startIndicesFeature[l],k=(0,f.getUid)(j).toString(),c[k]&&(e!==g&&(n.drawElements(a,b,e,g),a.clear(a.DEPTH_BUFFER_BIT)),g=m),l--,e=m;e!==g&&(n.drawElements(a,b,e,g),a.clear(a.DEPTH_BUFFER_BIT)),e=g=i}},b.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_color,b)},b.prototype.setFillStrokeStyle=function(a,b){var c=a?a.getColor():[0,0,0,0];if(c=c instanceof CanvasGradient||c instanceof CanvasPattern?r.DEFAULT_FILLSTYLE:(0,h.asArray)(c).map(function(a,b){return 3!=b?a/255:a})||r.DEFAULT_FILLSTYLE,this.state_.fillColor&&(0,g.equals)(c,this.state_.fillColor)||(this.state_.fillColor=c,this.state_.changed=!0,this.styles_.push(c)),b)this.lineStringReplay.setFillStrokeStyle(null,b);else{var d=new s.default({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,d)}},b}(q.default),y=x;c.default=y},{"../../array.js":46,"../../color.js":49,"../../extent.js":72,"../../geom/flat/contains.js":144,"../../geom/flat/orient.js":153,"../../geom/flat/transform.js":160,"../../obj.js":201,"../../structs/LinkedList.js":315,"../../structs/RBush.js":317,"../../style/Stroke.js":330,"../../util.js":342,"../../webgl.js":344,"../../webgl/Buffer.js":345,"../webgl.js":235,"../webgl/LineStringReplay.js":239,"../webgl/Replay.js":241,"../webgl/polygonreplay/defaultshader.js":249,"../webgl/polygonreplay/defaultshader/Locations.js":250}],241:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../extent.js"),f=d(a("../VectorContext.js")),g=a("../../transform.js"),h=a("../../vec/mat4.js"),i=a("../../webgl.js"),j=function(a){function b(b,c){a.call(this),this.tolerance=b,this.maxExtent=c,this.origin=(0,e.getCenter)(c),this.projectionMatrix_=(0,g.create)(),this.offsetRotateMatrix_=(0,g.create)(),this.offsetScaleMatrix_=(0,g.create)(),this.tmpMat4_=(0,h.create)(),this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDeleteResourcesFunction=function(a){},b.prototype.finish=function(a){},b.prototype.setUpProgram=function(a,b,c,d){},b.prototype.shutDownProgram=function(a,b){},b.prototype.drawReplay=function(a,b,c,d){},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){},b.prototype.drawHitDetectionReplay=function(a,b,c,d,e,f){return e?this.drawHitDetectionReplayOneByOne(a,b,c,d,f):this.drawHitDetectionReplayAll(a,b,c,d)},b.prototype.drawHitDetectionReplayAll=function(a,b,c,d){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawReplay(a,b,c,!0);var e=d(null);return e||void 0},b.prototype.replay=function(a,b,c,d,e,f,j,k,l,m,n){var o,p,q,r,s,t,u,v,w=a.getGL();this.lineStringReplay&&(o=w.isEnabled(w.STENCIL_TEST),p=w.getParameter(w.STENCIL_FUNC),q=w.getParameter(w.STENCIL_VALUE_MASK),r=w.getParameter(w.STENCIL_REF),s=w.getParameter(w.STENCIL_WRITEMASK),t=w.getParameter(w.STENCIL_FAIL),u=w.getParameter(w.STENCIL_PASS_DEPTH_PASS),v=w.getParameter(w.STENCIL_PASS_DEPTH_FAIL),w.enable(w.STENCIL_TEST),w.clear(w.STENCIL_BUFFER_BIT),w.stencilMask(255),w.stencilFunc(w.ALWAYS,1,255),w.stencilOp(w.KEEP,w.KEEP,w.REPLACE),this.lineStringReplay.replay(a,b,c,d,e,f,j,k,l,m,n),w.stencilMask(0),w.stencilFunc(w.NOTEQUAL,1,255)),a.bindBuffer(i.ARRAY_BUFFER,this.verticesBuffer),a.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);var x=this.setUpProgram(w,a,e,f),y=(0,g.reset)(this.projectionMatrix_);(0,g.scale)(y,2/(c*e[0]),2/(c*e[1])),(0,g.rotate)(y,-d),(0,g.translate)(y,-(b[0]-this.origin[0]),-(b[1]-this.origin[1]));var z=(0,g.reset)(this.offsetScaleMatrix_);(0,g.scale)(z,2/e[0],2/e[1]);var A=(0,g.reset)(this.offsetRotateMatrix_);0!==d&&(0,g.rotate)(A,-d),w.uniformMatrix4fv(x.u_projectionMatrix,!1,(0,h.fromTransform)(this.tmpMat4_,y)),w.uniformMatrix4fv(x.u_offsetScaleMatrix,!1,(0,h.fromTransform)(this.tmpMat4_,z)),w.uniformMatrix4fv(x.u_offsetRotateMatrix,!1,(0,h.fromTransform)(this.tmpMat4_,A)),w.uniform1f(x.u_opacity,j);var B;return void 0===l?this.drawReplay(w,a,k,!1):B=this.drawHitDetectionReplay(w,a,k,l,m,n),this.shutDownProgram(w,x),this.lineStringReplay&&(o||w.disable(w.STENCIL_TEST),w.clear(w.STENCIL_BUFFER_BIT),w.stencilFunc(p,r,q),w.stencilMask(s),w.stencilOp(t,v,u)),B},b.prototype.drawElements=function(a,b,c,d){var e=b.hasOESElementIndexUint?i.UNSIGNED_INT:i.UNSIGNED_SHORT,f=b.hasOESElementIndexUint?4:2,g=d-c,h=c*f;a.drawElements(i.TRIANGLES,g,e,h)},b}(f.default),k=j;c.default=k},{"../../extent.js":72,"../../transform.js":340,"../../vec/mat4.js":343,"../../webgl.js":344,"../VectorContext.js":224}],242:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../array.js"),f=a("../../extent.js"),g=a("../../obj.js"),h=a("../replay.js"),i=d(a("../ReplayGroup.js")),j=d(a("../webgl/CircleReplay.js")),k=d(a("../webgl/ImageReplay.js")),l=d(a("../webgl/LineStringReplay.js")),m=d(a("../webgl/PolygonReplay.js")),n=d(a("../webgl/TextReplay.js")),o=[1,1],p={Circle:j.default,Image:k.default,LineString:l.default,Polygon:m.default,Text:n.default},q=function(a){function b(b,c,d){a.call(this),this.maxExtent_=c,this.tolerance_=b,this.renderBuffer_=d,this.replaysByZIndex_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addDeclutter=function(a,b){},b.prototype.getDeleteResourcesFunction=function(a){var b,c=this,d=[];for(b in c.replaysByZIndex_){var e=c.replaysByZIndex_[b];for(var f in e)d.push(e[f].getDeleteResourcesFunction(a))}return function(){for(var a,b=arguments,c=this,e=d.length,f=0;f<e;f++)a=d[f].apply(c,b);return a}},b.prototype.finish=function(a){var b,c=this;for(b in c.replaysByZIndex_){var d=c.replaysByZIndex_[b];for(var e in d)d[e].finish(a)}},b.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0",d=this.replaysByZIndex_[c];void 0===d&&(d={},this.replaysByZIndex_[c]=d);var e=d[b];if(void 0===e){e=new(0,p[b])(this.tolerance_,this.maxExtent_),d[b]=e}return e},b.prototype.isEmpty=function(){return(0,g.isEmpty)(this.replaysByZIndex_)},b.prototype.replay=function(a,b,c,d,f,g,i,j){var k=this,l=Object.keys(this.replaysByZIndex_).map(Number);l.sort(e.numberSafeCompareFunction);var m,n,o,p,q,r;for(m=0,n=l.length;m<n;++m)for(q=k.replaysByZIndex_[l[m].toString()],o=0,p=h.ORDER.length;o<p;++o)r=q[h.ORDER[o]],void 0!==r&&r.replay(a,b,c,d,f,g,i,j,void 0,!1)},b.prototype.replayHitDetection_=function(a,b,c,d,e,f,g,i,j,k,l){var m=this,n=Object.keys(this.replaysByZIndex_).map(Number);n.sort(function(a,b){return b-a});var o,p,q,r,s,t;for(o=0,p=n.length;o<p;++o)for(r=m.replaysByZIndex_[n[o].toString()],q=h.ORDER.length-1;q>=0;--q)if(void 0!==(s=r[h.ORDER[q]])&&(t=s.replay(a,b,c,d,e,f,g,i,j,k,l)))return t},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,g,h,i,j,k){var l=b.getGL();l.bindFramebuffer(l.FRAMEBUFFER,b.getHitDetectionFramebuffer());var m;return void 0!==this.renderBuffer_&&(m=(0,f.buffer)((0,f.createOrUpdateFromCoordinate)(a),d*this.renderBuffer_)),this.replayHitDetection_(b,a,d,e,o,h,i,j,function(a){var b=new Uint8Array(4);if(l.readPixels(0,0,1,1,l.RGBA,l.UNSIGNED_BYTE,b),b[3]>0){var c=k(a);if(c)return c}},!0,m)},b.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e,f,g,h,i){var j=b.getGL();return j.bindFramebuffer(j.FRAMEBUFFER,b.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(b,a,d,e,o,g,h,i,function(a){var b=new Uint8Array(4);return j.readPixels(0,0,1,1,j.RGBA,j.UNSIGNED_BYTE,b),b[3]>0},!1)},b}(i.default),r=q;c.default=r},{"../../array.js":46,"../../extent.js":72,"../../obj.js":201,"../ReplayGroup.js":222,"../replay.js":234,"../webgl/CircleReplay.js":236,"../webgl/ImageReplay.js":237,"../webgl/LineStringReplay.js":239,"../webgl/PolygonReplay.js":240,"../webgl/TextReplay.js":243}],243:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../colorlike.js"),g=a("../../dom.js"),h=d(a("../../geom/GeometryType.js")),i=a("../../has.js"),j=a("../replay.js"),k=a("../webgl.js"),l=d(a("../webgl/TextureReplay.js")),m=d(a("../../style/AtlasManager.js")),n=d(a("../../webgl/Buffer.js")),o=function(a){function b(b,c){a.call(this,b,c),this.images_=[],this.textures_=[],this.measureCanvas_=(0,g.createCanvasContext2D)(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.drawText=function(a,b){var c=this;if(this.text_){var d=null,f=0,g=2,i=2;switch(a.getType()){case h.default.POINT:case h.default.MULTI_POINT:d=a.getFlatCoordinates(),g=d.length,i=a.getStride();break;case h.default.CIRCLE:d=a.getCenter();break;case h.default.LINE_STRING:d=a.getFlatMidpoint();break;case h.default.MULTI_LINE_STRING:d=a.getFlatMidpoints(),g=d.length;break;case h.default.POLYGON:d=a.getFlatInteriorPoint();break;case h.default.MULTI_POLYGON:d=a.getFlatInteriorPoints(),g=d.length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b);var j,k,l,m,n,o,p,q,r=this.currAtlas_,s=this.text_.split("\n"),t=this.getTextSize_(s),u=Math.round(t[0]*this.textAlign_-this.offsetX_),v=Math.round(t[1]*this.textBaseline_-this.offsetY_),w=this.state_.lineWidth/2*this.state_.scale;for(j=0,k=s.length;j<k;++j)for(n=0,o=r.height*j,p=s[j].split(""),l=0,m=p.length;l<m;++l){if(q=r.atlas.getInfo(p[l])){var x=q.image;if(c.anchorX=u-n,c.anchorY=v-o,c.originX=0===l?q.offsetX-w:q.offsetX,c.originY=q.offsetY,c.height=r.height,c.width=0===l||l===p.length-1?r.width[p[l]]+w:r.width[p[l]],c.imageHeight=x.height,c.imageWidth=x.width,0===c.images_.length)c.images_.push(x);else{var y=c.images_[c.images_.length-1];(0,e.getUid)(y)!=(0,e.getUid)(x)&&(c.groupIndices.push(c.indices.length),c.images_.push(x))}c.drawText_(d,f,g,i)}n+=c.width}}},b.prototype.getTextSize_=function(a){var b=this,c=this.currAtlas_,d=a.length*c.height;return[a.map(function(a){for(var d=0,e=0,f=a.length;e<f;++e){var g=a[e];c.width[g]||b.addCharToAtlas_(g),d+=c.width[g]?c.width[g]:0}return d}).reduce(function(a,b){return Math.max(a,b)}),d]},b.prototype.drawText_=function(a,b,c,d){for(var e=this,f=b,g=c;f<g;f+=d)e.drawCoordinates(a,b,c,d)},b.prototype.addCharToAtlas_=function(a){if(1===a.length){var b=this.currAtlas_,c=this.state_,d=this.measureCanvas_.getContext("2d");d.font=c.font;var e=Math.ceil(d.measureText(a).width*c.scale);b.atlas.add(a,e,b.height,function(b,d,e){b.font=c.font,b.fillStyle=c.fillColor,b.strokeStyle=c.strokeColor,b.lineWidth=c.lineWidth,b.lineCap=c.lineCap,b.lineJoin=c.lineJoin,b.miterLimit=c.miterLimit,b.textAlign="left",b.textBaseline="top",i.CANVAS_LINE_DASH&&c.lineDash&&(b.setLineDash(c.lineDash),b.lineDashOffset=c.lineDashOffset),1!==c.scale&&b.setTransform(c.scale,0,0,c.scale,0,0),c.strokeColor&&b.strokeText(a,d,e),c.fillColor&&b.fillText(a,d,e)})&&(b.width[a]=e)}},b.prototype.finish=function(b){var c=b.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new n.default(this.vertices),this.indicesBuffer=new n.default(this.indices);var d={};this.createTextures(this.textures_,this.images_,d,c),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,a.prototype.finish.call(this,b)},b.prototype.setTextStyle=function(a){var b=this.state_,c=a.getFill(),d=a.getStroke();if(a&&a.getText()&&(c||d)){if(c){var e=c.getColor();b.fillColor=(0,f.asColorLike)(e||k.DEFAULT_FILLSTYLE)}else b.fillColor=null;if(d){var g=d.getColor();b.strokeColor=(0,f.asColorLike)(g||k.DEFAULT_STROKESTYLE),b.lineWidth=d.getWidth()||k.DEFAULT_LINEWIDTH,
b.lineCap=d.getLineCap()||k.DEFAULT_LINECAP,b.lineDashOffset=d.getLineDashOffset()||k.DEFAULT_LINEDASHOFFSET,b.lineJoin=d.getLineJoin()||k.DEFAULT_LINEJOIN,b.miterLimit=d.getMiterLimit()||k.DEFAULT_MITERLIMIT;var h=d.getLineDash();b.lineDash=h?h.slice():k.DEFAULT_LINEDASH}else b.strokeColor=null,b.lineWidth=0;b.font=a.getFont()||k.DEFAULT_FONT,b.scale=a.getScale()||1,this.text_=a.getText();var i=j.TEXT_ALIGN[a.getTextAlign()],l=j.TEXT_ALIGN[a.getTextBaseline()];this.textAlign_=void 0===i?k.DEFAULT_TEXTALIGN:i,this.textBaseline_=void 0===l?k.DEFAULT_TEXTBASELINE:l,this.offsetX_=a.getOffsetX()||0,this.offsetY_=a.getOffsetY()||0,this.rotateWithView=!!a.getRotateWithView(),this.rotation=a.getRotation()||0,this.currAtlas_=this.getAtlas_(b)}else this.text_=""},b.prototype.getAtlas_=function(a){var b=[];for(var c in a)(a[c]||0===a[c])&&(Array.isArray(a[c])?b=b.concat(a[c]):b.push(a[c]));var d=this.calculateHash_(b);if(!this.atlases_[d]){var e=this.measureCanvas_.getContext("2d");e.font=a.font;var f=Math.ceil((1.5*e.measureText("M").width+a.lineWidth/2)*a.scale);this.atlases_[d]={atlas:new m.default({space:a.lineWidth+1}),width:{},height:f}}return this.atlases_[d]},b.prototype.calculateHash_=function(a){for(var b="",c=0,d=a.length;c<d;++c)b+=a[c];return b},b.prototype.getTextures=function(a){return this.textures_},b.prototype.getHitDetectionTextures=function(){return this.textures_},b}(l.default),p=o;c.default=p},{"../../colorlike.js":50,"../../dom.js":64,"../../geom/GeometryType.js":132,"../../has.js":161,"../../style/AtlasManager.js":320,"../../util.js":342,"../../webgl/Buffer.js":345,"../replay.js":234,"../webgl.js":235,"../webgl/TextureReplay.js":244}],244:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=a("../../extent.js"),g=a("../../obj.js"),h=a("../webgl/texturereplay/defaultshader.js"),i=d(a("../webgl/texturereplay/defaultshader/Locations.js")),j=d(a("../webgl/Replay.js")),k=a("../../webgl.js"),l=a("../../webgl/Context.js"),m=function(a){function b(b,c){a.call(this,b,c),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.getTextures(!0),e=a.getGL();return function(){if(!e.isContextLost()){var f,g;for(f=0,g=d.length;f<g;++f)e.deleteTexture(d[f])}a.deleteBuffer(b),a.deleteBuffer(c)}},b.prototype.drawCoordinates=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=this.anchorX,m=this.anchorY,n=this.height,o=this.imageHeight,p=this.imageWidth,q=this.opacity,r=this.originX,s=this.originY,t=this.rotateWithView?1:0,u=-this.rotation,v=this.scale,w=this.width,x=Math.cos(u),y=Math.sin(u),z=this.indices.length,A=this.vertices.length;for(e=b;e<c;e+=d)i=a[e]-k.origin[0],j=a[e+1]-k.origin[1],f=A/8,g=-v*l,h=-v*(n-m),k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=r/p,k.vertices[A++]=(s+n)/o,k.vertices[A++]=q,k.vertices[A++]=t,g=v*(w-l),h=-v*(n-m),k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=(r+w)/p,k.vertices[A++]=(s+n)/o,k.vertices[A++]=q,k.vertices[A++]=t,g=v*(w-l),h=v*m,k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=(r+w)/p,k.vertices[A++]=s/o,k.vertices[A++]=q,k.vertices[A++]=t,g=-v*l,h=v*m,k.vertices[A++]=i,k.vertices[A++]=j,k.vertices[A++]=g*x-h*y,k.vertices[A++]=g*y+h*x,k.vertices[A++]=r/p,k.vertices[A++]=s/o,k.vertices[A++]=q,k.vertices[A++]=t,k.indices[z++]=f,k.indices[z++]=f+1,k.indices[z++]=f+2,k.indices[z++]=f,k.indices[z++]=f+2,k.indices[z++]=f+3;return A},b.prototype.createTextures=function(a,b,c,d){var f,g,h,i,j=b.length;for(i=0;i<j;++i)g=b[i],h=(0,e.getUid)(g).toString(),h in c?f=c[h]:(f=(0,l.createTexture)(d,g,k.CLAMP_TO_EDGE,k.CLAMP_TO_EDGE),c[h]=f),a[i]=f},b.prototype.setUpProgram=function(a,b,c,d){var e,f=b.getProgram(h.fragment,h.vertex);return this.defaultLocations?e=this.defaultLocations:(e=new i.default(a,f),this.defaultLocations=e),b.useProgram(f),a.enableVertexAttribArray(e.a_position),a.vertexAttribPointer(e.a_position,2,k.FLOAT,!1,32,0),a.enableVertexAttribArray(e.a_offsets),a.vertexAttribPointer(e.a_offsets,2,k.FLOAT,!1,32,8),a.enableVertexAttribArray(e.a_texCoord),a.vertexAttribPointer(e.a_texCoord,2,k.FLOAT,!1,32,16),a.enableVertexAttribArray(e.a_opacity),a.vertexAttribPointer(e.a_opacity,1,k.FLOAT,!1,32,24),a.enableVertexAttribArray(e.a_rotateWithView),a.vertexAttribPointer(e.a_rotateWithView,1,k.FLOAT,!1,32,28),e},b.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position),a.disableVertexAttribArray(b.a_offsets),a.disableVertexAttribArray(b.a_texCoord),a.disableVertexAttribArray(b.a_opacity),a.disableVertexAttribArray(b.a_rotateWithView)},b.prototype.drawReplay=function(a,b,c,d){var e=this,f=d?this.getHitDetectionTextures():this.getTextures(),h=d?this.hitDetectionGroupIndices:this.groupIndices;if((0,g.isEmpty)(c)){var i,j,l;for(i=0,j=f.length,l=0;i<j;++i){a.bindTexture(k.TEXTURE_2D,f[i]);var m=h[i];e.drawElements(a,b,l,m),l=m}}else this.drawReplaySkipping(a,b,c,f,h)},b.prototype.drawReplaySkipping=function(a,b,c,d,f){var g,h,i=this,j=0;for(g=0,h=d.length;g<h;++g){a.bindTexture(k.TEXTURE_2D,d[g]);for(var l=g>0?f[g-1]:0,m=f[g],n=l,o=l;j<this.startIndices.length&&this.startIndices[j]<=m;){var p=i.startIndicesFeature[j];void 0!==c[(0,e.getUid)(p).toString()]?(n!==o&&i.drawElements(a,b,n,o),n=j===i.startIndices.length-1?m:i.startIndices[j+1],o=n):o=j===i.startIndices.length-1?m:i.startIndices[j+1],j++}n!==o&&i.drawElements(a,b,n,o)}},b.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,g){var h,i,j,l,m,n,o=this,p=this.startIndices.length-1,q=this.getHitDetectionTextures();for(h=q.length-1;h>=0;--h)for(a.bindTexture(k.TEXTURE_2D,q[h]),i=h>0?o.hitDetectionGroupIndices[h-1]:0,l=o.hitDetectionGroupIndices[h];p>=0&&this.startIndices[p]>=i;){if(j=o.startIndices[p],m=o.startIndicesFeature[p],n=(0,e.getUid)(m).toString(),void 0===c[n]&&m.getGeometry()&&(void 0===g||(0,f.intersects)(g,m.getGeometry().getExtent()))){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),o.drawElements(a,b,j,l);var r=d(m);if(r)return r}l=j,p--}},b.prototype.finish=function(a){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},b.prototype.getTextures=function(a){},b.prototype.getHitDetectionTextures=function(){},b}(j.default),n=m;c.default=n},{"../../extent.js":72,"../../obj.js":201,"../../util.js":342,"../../webgl.js":344,"../../webgl/Context.js":346,"../webgl/Replay.js":241,"../webgl/texturereplay/defaultshader.js":251,"../webgl/texturereplay/defaultshader/Locations.js":252}],245:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");c.vertex=i},{"../../../webgl.js":344,"../../../webgl/Fragment.js":348,"../../../webgl/Vertex.js":350}],246:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"j"),this.u_lineWidth=a.getUniformLocation(b,d.DEBUG?"u_lineWidth":"k"),this.u_pixelRatio=a.getUniformLocation(b,d.DEBUG?"u_pixelRatio":"l"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"m"),this.u_fillColor=a.getUniformLocation(b,d.DEBUG?"u_fillColor":"n"),this.u_strokeColor=a.getUniformLocation(b,d.DEBUG?"u_strokeColor":"o"),this.u_size=a.getUniformLocation(b,d.DEBUG?"u_size":"p"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"e"),this.a_instruction=a.getAttribLocation(b,d.DEBUG?"a_instruction":"f"),this.a_radius=a.getAttribLocation(b,d.DEBUG?"a_radius":"g")},f=e;c.default=f},{"../../../../webgl.js":344}],247:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");c.fragment=h;var i=new g.default(e.DEBUG?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}");c.vertex=i},{"../../../webgl.js":344,"../../../webgl/Fragment.js":348,"../../../webgl/Vertex.js":350}],248:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"j"),this.u_lineWidth=a.getUniformLocation(b,d.DEBUG?"u_lineWidth":"k"),this.u_miterLimit=a.getUniformLocation(b,d.DEBUG?"u_miterLimit":"l"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"m"),this.u_color=a.getUniformLocation(b,d.DEBUG?"u_color":"n"),this.u_size=a.getUniformLocation(b,d.DEBUG?"u_size":"o"),this.u_pixelRatio=a.getUniformLocation(b,d.DEBUG?"u_pixelRatio":"p"),this.a_lastPos=a.getAttribLocation(b,d.DEBUG?"a_lastPos":"d"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"e"),this.a_nextPos=a.getAttribLocation(b,d.DEBUG?"a_nextPos":"f"),this.a_direction=a.getAttribLocation(b,d.DEBUG?"a_direction":"g")},f=e;c.default=f},{"../../../../webgl.js":344}],249:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");c.fragment=h;var i=new g.default(e.DEBUG?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}");c.vertex=i},{"../../../webgl.js":344,"../../../webgl/Fragment.js":348,"../../../webgl/Vertex.js":350}],250:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"d"),this.u_color=a.getUniformLocation(b,d.DEBUG?"u_color":"e"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"f"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"a")},f=e;c.default=f},{"../../../../webgl.js":344}],251:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../../webgl.js"),f=d(a("../../../webgl/Fragment.js")),g=d(a("../../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}");c.vertex=i},{"../../../webgl.js":344,"../../../webgl/Fragment.js":348,"../../../webgl/Vertex.js":350}],252:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../../webgl.js"),e=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=a.getUniformLocation(b,d.DEBUG?"u_offsetRotateMatrix":"j"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"k"),this.u_image=a.getUniformLocation(b,d.DEBUG?"u_image":"l"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"c"),this.a_texCoord=a.getAttribLocation(b,d.DEBUG?"a_texCoord":"d"),this.a_offsets=a.getAttribLocation(b,d.DEBUG?"a_offsets":"e"),this.a_opacity=a.getAttribLocation(b,d.DEBUG?"a_opacity":"f"),this.a_rotateWithView=a.getAttribLocation(b,d.DEBUG?"a_rotateWithView":"g")},f=e;c.default=f},{"../../../../webgl.js":344}],253:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("../ImageState.js")),g=d(a("../Observable.js")),h=d(a("../TileState.js")),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../functions.js"),l=d(a("../source/State.js")),m=function(a){function b(b){a.call(this),this.layer_=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createLoadedTileFinder=function(a,b,c){return function(d,e){function f(a){c[d]||(c[d]={}),c[d][a.tileCoord.toString()]=a}return a.forEachLoadedTile(b,d,e,f)}},b.prototype.getLayer=function(){return this.layer_},b.prototype.handleImageChange_=function(a){a.target.getState()===f.default.LOADED&&this.renderIfReadyAndVisible()},b.prototype.loadImage=function(a){var b=a.getState();return b!=f.default.LOADED&&b!=f.default.ERROR&&(0,i.listen)(a,j.default.CHANGE,this.handleImageChange_,this),b==f.default.IDLE&&(a.load(),b=a.getState()),b==f.default.LOADED},b.prototype.renderIfReadyAndVisible=function(){var a=this.getLayer();a.getVisible()&&a.getSourceState()==l.default.READY&&this.changed()},b.prototype.scheduleExpireCache=function(a,b){if(b.canExpireCache()){var c=function(a,b,c){var d=(0,e.getUid)(a).toString();d in c.usedTiles&&a.expireCache(c.viewState.projection,c.usedTiles[d])}.bind(null,b);a.postRenderFunctions.push(c)}},b.prototype.updateUsedTiles=function(a,b,c,d){var f=(0,e.getUid)(b).toString(),g=c.toString()
;f in a?g in a[f]?a[f][g].extend(d):a[f][g]=d:(a[f]={},a[f][g]=d)},b.prototype.manageTilePyramid=function(a,b,c,d,f,g,i,j,k,l){var m=(0,e.getUid)(b).toString();m in a.wantedTiles||(a.wantedTiles[m]={});var n,o,p,q,r,s,t=a.wantedTiles[m],u=a.tileQueue,v=c.getMinZoom();for(s=v;s<=i;++s)for(o=c.getTileRangeForExtentAndZ(g,s,o),p=c.getResolution(s),q=o.minX;q<=o.maxX;++q)for(r=o.minY;r<=o.maxY;++r)i-s<=j?(n=b.getTile(s,q,r,d,f),n.getState()==h.default.IDLE&&(t[n.getKey()]=!0,u.isKeyQueued(n.getKey())||u.enqueue([n,m,c.getTileCoordCenter(n.tileCoord),p])),void 0!==k&&k.call(l,n)):b.useTile(s,q,r,f)},b}(g.default);m.prototype.forEachFeatureAtCoordinate=k.VOID,m.prototype.hasFeatureAtCoordinate=k.FALSE;var n=m;c.default=n},{"../ImageState.js":17,"../Observable.js":31,"../TileState.js":39,"../events.js":66,"../events/EventType.js":68,"../functions.js":126,"../source/State.js":294,"../util.js":342}],254:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){n.shared.expire()}function f(a,b){return a.zIndex-b.zIndex}Object.defineProperty(c,"__esModule",{value:!0}),c.sortByZIndex=f,c.default=void 0;var g=a("../util.js"),h=d(a("../Disposable.js")),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../extent.js"),l=a("../functions.js"),m=a("../layer/Layer.js"),n=a("../style/IconImageCache.js"),o=a("../transform.js"),p=function(a){function b(b){a.call(this),this.map_=b,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.registerLayerRenderers=function(a){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,a)},b.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},b.prototype.calculateMatrices2D=function(a){var b=a.viewState,c=a.coordinateToPixelTransform,d=a.pixelToCoordinateTransform;(0,o.compose)(c,a.size[0]/2,a.size[1]/2,1/b.resolution,-1/b.resolution,-b.rotation,-b.center[0],-b.center[1]),(0,o.invert)((0,o.setFromArray)(d,c))},b.prototype.removeLayerRenderers=function(){var a=this;for(var b in a.layerRenderers_)a.removeLayerRendererByKey_(b).dispose()},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,h){function i(a,c){var f=(0,g.getUid)(a).toString(),h=b.layerStates[(0,g.getUid)(c)].managed;if(!(f in b.skippedFeatureUids)||h)return d.call(e,a,h?c:null)}var j,l=this,n=b.viewState,o=n.resolution,p=n.projection,q=a;if(p.canWrapX()){var r=p.getExtent(),s=(0,k.getWidth)(r),t=a[0];if(t<r[0]||t>r[2]){q=[t+s*Math.ceil((r[0]-t)/s),a[1]]}}var u,v=b.layerStatesArray,w=v.length;for(u=w-1;u>=0;--u){var x=v[u],y=x.layer;if((0,m.visibleAtResolution)(x,o)&&f.call(h,y)){var z=l.getLayerRenderer(y);if(y.getSource()&&(j=z.forEachFeatureAtCoordinate(y.getSource().getWrapX()?q:a,b,c,i,e)),j)return j}}},b.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f,g){},b.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){return void 0!==this.forEachFeatureAtCoordinate(a,b,c,l.TRUE,this,d,e)},b.prototype.getLayerRenderer=function(a){var b=this,c=(0,g.getUid)(a).toString();if(c in this.layerRenderers_)return this.layerRenderers_[c];for(var d,e=0,f=this.layerRendererConstructors_.length;e<f;++e){var h=b.layerRendererConstructors_[e];if(h.handles(a)){d=h.create(b,a);break}}if(!d)throw new Error("Unable to create renderer for layer: "+a.getType());return this.layerRenderers_[c]=d,this.layerRendererListeners_[c]=(0,i.listen)(d,j.default.CHANGE,this.handleLayerRendererChange_,this),d},b.prototype.getLayerRendererByKey=function(a){return this.layerRenderers_[a]},b.prototype.getLayerRenderers=function(){return this.layerRenderers_},b.prototype.getMap=function(){return this.map_},b.prototype.handleLayerRendererChange_=function(){this.map_.render()},b.prototype.removeLayerRendererByKey_=function(a){var b=this.layerRenderers_[a];return delete this.layerRenderers_[a],(0,i.unlistenByKey)(this.layerRendererListeners_[a]),delete this.layerRendererListeners_[a],b},b.prototype.removeUnusedLayerRenderers_=function(a,b){var c=this;for(var d in c.layerRenderers_)b&&d in b.layerStates||c.removeLayerRendererByKey_(d).dispose()},b.prototype.scheduleExpireIconCache=function(a){a.postRenderFunctions.push(e)},b.prototype.scheduleRemoveUnusedLayerRenderers=function(a){var b=this;for(var c in b.layerRenderers_)if(!(c in a.layerStates))return void a.postRenderFunctions.push(b.removeUnusedLayerRenderers_.bind(b))},b}(h.default);p.prototype.renderFrame=l.VOID,p.prototype.dispatchRenderEvent=l.VOID;var q=p;c.default=q},{"../Disposable.js":9,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../functions.js":126,"../layer/Layer.js":190,"../style/IconImageCache.js":326,"../transform.js":340,"../util.js":342}],255:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../reproj/common.js"),f=d(a("../../ImageCanvas.js")),g=d(a("../../LayerType.js")),h=d(a("../../ViewHint.js")),i=a("../../array.js"),j=a("../../extent.js"),k=d(a("../../layer/VectorRenderType.js")),l=a("../../obj.js"),m=a("./Map.js"),n=d(a("./IntermediateCanvas.js")),o=a("../../transform.js"),p=function(a){function b(c){var d=this;if(a.call(this,c),this.image_=null,this.imageTransform_=(0,o.create)(),this.skippedFeatures_=[],this.vectorRenderer_=null,c.getType()===g.default.VECTOR)for(var e=0,f=m.layerRendererConstructors.length;e<f;++e){var h=m.layerRendererConstructors[e];if(h!==b&&h.handles(c)){d.vectorRenderer_=new h(c);break}}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.image_?this.image_.getImage():null},b.prototype.getImageTransform=function(){return this.imageTransform_},b.prototype.prepareFrame=function(a,b){var c,d=a.pixelRatio,g=a.size,k=a.viewState,m=k.center,n=k.resolution,p=this.getLayer(),q=p.getSource(),r=a.viewHints,s=this.vectorRenderer_,t=a.extent;if(s||void 0===b.extent||(t=(0,j.getIntersection)(t,b.extent)),!r[h.default.ANIMATING]&&!r[h.default.INTERACTING]&&!(0,j.isEmpty)(t)){var u=k.projection;if(!e.ENABLE_RASTER_REPROJECTION){var v=q.getProjection();v&&(u=v)}var w=this.skippedFeatures_;if(s){var x=s.context,y=(0,l.assign)({},a,{size:[(0,j.getWidth)(t)/n,(0,j.getHeight)(t)/n],viewState:(0,l.assign)({},a.viewState,{rotation:0})}),z=Object.keys(y.skippedFeatureUids).sort();c=new f.default(t,n,d,x.canvas,function(a){!s.prepareFrame(y,b)||!s.replayGroupChanged&&(0,i.equals)(w,z)||(x.canvas.width=y.size[0]*d,x.canvas.height=y.size[1]*d,s.compose(x,y,b),w=z,a())})}else c=q.getImage(t,n,d,u);c&&this.loadImage(c)&&(this.image_=c,this.skippedFeatures_=w)}if(this.image_){c=this.image_;var A=c.getExtent(),B=c.getResolution(),C=c.getPixelRatio(),D=d*B/(n*C),E=(0,o.compose)(this.imageTransform_,d*g[0]/2,d*g[1]/2,D,D,0,C*(A[0]-m[0])/B,C*(m[1]-A[3])/B);(0,o.compose)(this.coordinateToCanvasPixelTransform,d*g[0]/2-E[4],d*g[1]/2-E[5],d/n,-d/n,0,-m[0],-m[1]),this.renderedResolution=B*d/C}return!!this.image_},b.prototype.forEachFeatureAtCoordinate=function(b,c,d,e,f){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(b,c,d,e,f):a.prototype.forEachFeatureAtCoordinate.call(this,b,c,d,e,f)},b}(n.default);p.handles=function(a){return a.getType()===g.default.IMAGE||a.getType()===g.default.VECTOR&&a.getRenderMode()===k.default.IMAGE},p.create=function(a,b){return new p(b)};var q=p;c.default=q},{"../../ImageCanvas.js":16,"../../LayerType.js":20,"../../ViewHint.js":43,"../../array.js":46,"../../extent.js":72,"../../layer/VectorRenderType.js":195,"../../obj.js":201,"../../reproj/common.js":276,"../../transform.js":340,"./IntermediateCanvas.js":256,"./Map.js":258}],256:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../coordinate.js"),f=a("../../dom.js"),g=a("../../extent.js"),h=a("../../functions.js"),i=d(a("../canvas/Layer.js")),j=a("../../transform.js"),k=function(a){function b(b){a.call(this,b),this.coordinateToCanvasPixelTransform=(0,j.create)(),this.hitCanvasContext_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.composeFrame=function(a,b,c){this.preCompose(c,a);var d=this.getImage();if(d){var e=b.extent,f=void 0!==e&&!(0,g.containsExtent)(e,a.extent)&&(0,g.intersects)(e,a.extent);f&&this.clip(c,a,e);var h=this.getImageTransform(),i=c.globalAlpha;c.globalAlpha=b.opacity;var j=h[4],k=h[5],l=d.width*h[0],m=d.height*h[3];c.drawImage(d,0,0,+d.width,+d.height,Math.round(j),Math.round(k),Math.round(l),Math.round(m)),c.globalAlpha=i,f&&c.restore()}this.postCompose(c,a,b)},b.prototype.getImage=function(){},b.prototype.getImageTransform=function(){},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer(),g=f.getSource(),h=b.viewState.resolution,i=b.viewState.rotation,j=b.skippedFeatureUids;return g.forEachFeatureAtCoordinate(a,h,i,c,j,function(a){return d.call(e,a,f)})},b.prototype.forEachLayerAtCoordinate=function(b,c,d,g,i){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==h.VOID)return a.prototype.forEachLayerAtCoordinate.call(this,arguments);var k=(0,j.apply)(this.coordinateToCanvasPixelTransform,b.slice());(0,e.scale)(k,c.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=(0,f.createCanvasContext2D)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),k[0],k[1],1,1,0,0,1,1);var l=this.hitCanvasContext_.getImageData(0,0,1,1).data;return l[3]>0?g.call(i,this.getLayer(),l):void 0}},b}(i.default),l=k;c.default=l},{"../../coordinate.js":62,"../../dom.js":64,"../../extent.js":72,"../../functions.js":126,"../../transform.js":340,"../canvas/Layer.js":257}],257:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../extent.js"),f=a("../../functions.js"),g=d(a("../../render/Event.js")),h=d(a("../../render/EventType.js")),i=a("../../render/canvas.js"),j=d(a("../../render/canvas/Immediate.js")),k=d(a("../Layer.js")),l=a("../../transform.js"),m=function(a){function b(b){a.call(this,b),this.renderedResolution,this.transform_=(0,l.create)()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clip=function(a,b,c){var d=b.pixelRatio,f=b.size[0]*d,g=b.size[1]*d,h=b.viewState.rotation,j=(0,e.getTopLeft)(c),k=(0,e.getTopRight)(c),m=(0,e.getBottomRight)(c),n=(0,e.getBottomLeft)(c);(0,l.apply)(b.coordinateToPixelTransform,j),(0,l.apply)(b.coordinateToPixelTransform,k),(0,l.apply)(b.coordinateToPixelTransform,m),(0,l.apply)(b.coordinateToPixelTransform,n),a.save(),(0,i.rotateAtOffset)(a,-h,f/2,g/2),a.beginPath(),a.moveTo(j[0]*d,j[1]*d),a.lineTo(k[0]*d,k[1]*d),a.lineTo(m[0]*d,m[1]*d),a.lineTo(n[0]*d,n[1]*d),a.clip(),(0,i.rotateAtOffset)(a,h,f/2,g/2)},b.prototype.dispatchComposeEvent_=function(a,b,c,d){var e=this.getLayer();if(e.hasListener(a)){var f=c.size[0]*c.pixelRatio,h=c.size[1]*c.pixelRatio,k=c.viewState.rotation;(0,i.rotateAtOffset)(b,-k,f/2,h/2);var l=void 0!==d?d:this.getTransform(c,0),m=new j.default(b,c.pixelRatio,c.extent,l,c.viewState.rotation),n=new g.default(a,m,c,b,null);e.dispatchEvent(n),(0,i.rotateAtOffset)(b,k,f/2,h/2)}},b.prototype.forEachLayerAtCoordinate=function(a,b,c,d,e){return this.forEachFeatureAtCoordinate(a,b,c,f.TRUE,this)?d.call(e,this.getLayer(),null):void 0},b.prototype.postCompose=function(a,b,c,d){this.dispatchComposeEvent_(h.default.POSTCOMPOSE,a,b,d)},b.prototype.preCompose=function(a,b,c){this.dispatchComposeEvent_(h.default.PRECOMPOSE,a,b,c)},b.prototype.dispatchRenderEvent=function(a,b,c){this.dispatchComposeEvent_(h.default.RENDER,a,b,c)},b.prototype.getTransform=function(a,b){var c=a.viewState,d=a.pixelRatio,e=d*a.size[0]/2,f=d*a.size[1]/2,g=d/c.resolution,h=-g,i=-c.rotation,j=-c.center[0]+b,k=-c.center[1];return(0,l.compose)(this.transform_,e,f,g,h,i,j,k)},b.prototype.composeFrame=function(a,b,c){},b.prototype.prepareFrame=function(a,b){},b}(k.default),n=m;c.default=n},{"../../extent.js":72,"../../functions.js":126,"../../render/Event.js":219,"../../render/EventType.js":220,"../../render/canvas.js":225,"../../render/canvas/Immediate.js":227,"../../transform.js":340,"../Layer.js":253}],258:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.layerRendererConstructors=void 0;var f=a("../../transform.js"),g=a("../../array.js"),h=a("../../css.js"),i=a("../../dom.js"),j=a("../../layer/Layer.js"),k=e(a("../../render/Event.js")),l=e(a("../../render/EventType.js")),m=a("../../render/canvas.js"),n=e(a("../../render/canvas/Immediate.js")),o=d(a("../Map.js")),p=e(a("../../source/State.js")),q=[];c.layerRendererConstructors=q;var r=function(a){function b(b){a.call(this,b);var c=b.getViewport();this.context_=(0,i.createCanvasContext2D)(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=h.CLASS_UNSELECTABLE,c.insertBefore(this.canvas_,c.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=(0,f.create)()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.dispatchRenderEvent=function(a,b){var c=this.getMap(),d=this.context_;if(c.hasListener(a)){var e=b.extent,f=b.pixelRatio,g=b.viewState,h=g.rotation,i=this.getTransform(b),j=new n.default(d,f,e,i,h),l=new k.default(a,j,b,d,null);c.dispatchEvent(l)}},b.prototype.getTransform=function(a){var b=a.viewState,c=this.canvas_.width/2,d=this.canvas_.height/2,e=a.pixelRatio/b.resolution,g=-e,h=-b.rotation,i=-b.center[0],j=-b.center[1];return(0,f.compose)(this.transform_,c,d,e,g,h,i,j)},b.prototype.renderFrame=function(a){var b=this;if(!a)return void(this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1));var c=this.context_,d=a.pixelRatio,e=Math.round(a.size[0]*d),f=Math.round(a.size[1]*d);this.canvas_.width!=e||this.canvas_.height!=f?(this.canvas_.width=e,this.canvas_.height=f):c.clearRect(0,0,e,f);var h=a.viewState.rotation;this.calculateMatrices2D(a),this.dispatchRenderEvent(l.default.PRECOMPOSE,a);var i=a.layerStatesArray;(0,g.stableSort)(i,o.sortByZIndex),h&&(c.save(),(0,m.rotateAtOffset)(c,h,e/2,f/2));var k,n,q,r,s,t=a.viewState.resolution;for(k=0,n=i.length;k<n;++k)s=i[k],q=s.layer,r=b.getLayerRenderer(q),(0,j.visibleAtResolution)(s,t)&&s.sourceState==p.default.READY&&r.prepareFrame(a,s)&&r.composeFrame(a,s,c);h&&c.restore(),this.dispatchRenderEvent(l.default.POSTCOMPOSE,a),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(a),this.scheduleExpireIconCache(a)},b.prototype.forEachLayerAtPixel=function(a,b,c,d,e,g,h){var i,k,l=this,m=b.viewState,n=m.resolution,o=b.layerStatesArray,p=o.length,q=(0,f.apply)(b.pixelToCoordinateTransform,a.slice());for(k=p-1;k>=0;--k){var r=o[k],s=r.layer;if((0,j.visibleAtResolution)(r,n)&&g.call(h,s)){if(i=l.getLayerRenderer(s).forEachLayerAtCoordinate(q,b,c,d,e))return i}}},b.prototype.registerLayerRenderers=function(b){a.prototype.registerLayerRenderers.call(this,b);for(var c=0,d=b.length;c<d;++c){var e=b[c];(0,g.includes)(q,e)||q.push(e)}},b}(o.default),s=r;c.default=s},{"../../array.js":46,"../../css.js":63,"../../dom.js":64,"../../layer/Layer.js":190,"../../render/Event.js":219,"../../render/EventType.js":220,"../../render/canvas.js":225,"../../render/canvas/Immediate.js":227,"../../source/State.js":294,"../../transform.js":340,"../Map.js":254}],259:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../../LayerType.js")),g=d(a("../../TileRange.js")),h=d(a("../../TileState.js")),i=d(a("../../ViewHint.js")),j=a("../../dom.js"),k=a("../../extent.js"),l=d(a("../canvas/IntermediateCanvas.js")),m=a("../../transform.js"),n=function(a){function b(b,c){a.call(this,b),this.context=c?null:(0,j.createCanvasContext2D)(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,k.createEmpty)(),this.tmpTileRange_=new g.default(0,0,0,0),this.imageTransform_=(0,m.create)(),this.zDirection=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.isDrawableTile_=function(a){var b=a.getState(),c=this.getLayer().getUseInterimTilesOnError();return b==h.default.LOADED||b==h.default.EMPTY||b==h.default.ERROR&&!c},b.prototype.getTile=function(a,b,c,d,e){var f=this.getLayer(),g=f.getSource(),i=g.getTile(a,b,c,d,e);return i.getState()==h.default.ERROR&&(f.getUseInterimTilesOnError()?f.getPreload()>0&&(this.newTiles_=!0):i.setState(h.default.LOADED)),this.isDrawableTile_(i)||(i=i.getInterimTile()),i},b.prototype.prepareFrame=function(a,b){var c=this,d=a.pixelRatio,f=a.size,g=a.viewState,j=g.projection,l=g.resolution,n=g.center,o=this.getLayer(),p=o.getSource(),q=p.getRevision(),r=p.getTileGridForProjection(j),s=r.getZForResolution(l,this.zDirection),t=r.getResolution(s),u=Math.round(l/t)||1,v=a.extent;if(void 0!==b.extent&&(v=(0,k.getIntersection)(v,b.extent)),(0,k.isEmpty)(v))return!1;var w=r.getTileRangeForExtentAndZ(v,s),x=r.getTileRangeExtent(s,w),y=p.getTilePixelRatio(d),z={};z[s]={};var A=this.createLoadedTileFinder(p,j,z),B=a.viewHints,C=B[i.default.ANIMATING]||B[i.default.INTERACTING],D=this.tmpExtent,E=this.tmpTileRange_;this.newTiles_=!1;var F,G,H;for(G=w.minX;G<=w.maxX;++G)for(H=w.minY;H<=w.maxY;++H)if(!(Date.now()-a.time>16&&C)){if(F=c.getTile(s,G,H,d,j),c.isDrawableTile_(F)){var I=(0,e.getUid)(c);if(F.getState()==h.default.LOADED){z[s][F.tileCoord.toString()]=F;var J=F.inTransition(I);c.newTiles_||!J&&-1!==c.renderedTiles.indexOf(F)||(c.newTiles_=!0)}if(1===F.getAlpha(I,a.time))continue}var K=r.getTileCoordChildTileRange(F.tileCoord,E,D),L=!1;K&&(L=A(s+1,K)),L||r.forEachTileCoordParentTileRange(F.tileCoord,A,null,E,D)}var M=t*d/y*u;if(!(this.renderedResolution&&Date.now()-a.time>16&&C)&&(this.newTiles_||!this.renderedExtent_||!(0,k.containsExtent)(this.renderedExtent_,v)||this.renderedRevision!=q||u!=this.oversampling_||!C&&M!=this.renderedResolution)){var N=this.context;if(N){var O=p.getTilePixelSize(s,d,j),P=Math.round(w.getWidth()*O[0]/u),Q=Math.round(w.getHeight()*O[1]/u),R=N.canvas;R.width!=P||R.height!=Q?(this.oversampling_=u,R.width=P,R.height=Q):(this.renderedExtent_&&!(0,k.equals)(x,this.renderedExtent_)&&N.clearRect(0,0,P,Q),u=this.oversampling_)}this.renderedTiles.length=0;var S=Object.keys(z).map(Number);S.sort(function(a,b){return a===s?1:b===s?-1:a>b?1:a<b?-1:0});var T,U,V,W,X,Y,Z,$,_,aa,ba;for(X=0,Y=S.length;X<Y;++X){W=S[X],V=p.getTilePixelSize(W,d,j),T=r.getResolution(W),U=T/t,$=y*p.getGutterForProjection(j),_=z[W];for(var ca in _)F=_[ca],Z=r.getTileCoordExtent(F.getTileCoord(),D),G=(Z[0]-x[0])/t*y/u,H=(x[3]-Z[3])/t*y/u,aa=V[0]*U/u,ba=V[1]*U/u,c.drawTileImage(F,a,b,G,H,aa,ba,$,s===W),c.renderedTiles.push(F)}this.renderedRevision=q,this.renderedResolution=t*d/y*u,this.renderedExtent_=x}var da=this.renderedResolution/l,ea=(0,m.compose)(this.imageTransform_,d*f[0]/2,d*f[1]/2,da,da,0,(this.renderedExtent_[0]-n[0])/this.renderedResolution*d,(n[1]-this.renderedExtent_[3])/this.renderedResolution*d);return(0,m.compose)(this.coordinateToCanvasPixelTransform,d*f[0]/2-ea[4],d*f[1]/2-ea[5],d/l,-d/l,0,-n[0],-n[1]),this.updateUsedTiles(a.usedTiles,p,s,w),this.manageTilePyramid(a,p,r,d,j,v,s,o.getPreload()),this.scheduleExpireCache(a,p),this.renderedTiles.length>0},b.prototype.drawTileImage=function(a,b,c,d,f,g,h,i,j){var k=a.getImage(this.getLayer());if(k){var l=(0,e.getUid)(this),m=j?a.getAlpha(l,b.time):1;1!==m||this.getLayer().getSource().getOpaque(b.viewState.projection)||this.context.clearRect(d,f,g,h);var n=m!==this.context.globalAlpha;n&&(this.context.save(),this.context.globalAlpha=m),this.context.drawImage(k,i,i,k.width-2*i,k.height-2*i,d,f,g,h),n&&this.context.restore(),1!==m?b.animate=!0:j&&a.endTransition(l)}},b.prototype.getImage=function(){var a=this.context;return a?a.canvas:null},b.prototype.getImageTransform=function(){return this.imageTransform_},b}(l.default);n.handles=function(a){return a.getType()===f.default.TILE},n.create=function(a,b){return new n(b)},n.prototype.getLayer;var o=n;c.default=o},{"../../LayerType.js":20,"../../TileRange.js":38,"../../TileState.js":39,"../../ViewHint.js":43,"../../dom.js":64,"../../extent.js":72,"../../transform.js":340,"../../util.js":342,"../canvas/IntermediateCanvas.js":256}],260:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../../LayerType.js")),g=d(a("../../ViewHint.js")),h=a("../../dom.js"),i=a("../../events.js"),j=d(a("../../events/EventType.js")),k=d(a("rbush")),l=a("../../extent.js"),m=d(a("../../render/EventType.js")),n=a("../../render/canvas.js"),o=d(a("../../render/canvas/ReplayGroup.js")),p=d(a("../canvas/Layer.js")),q=a("../vector.js"),r=function(a){function b(b){a.call(this,b),this.declutterTree_=b.getDeclutter()?(0,k.default)(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,l.createEmpty)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=(0,h.createCanvasContext2D)(),(0,i.listen)(n.labelCache,j.default.CLEAR,this.handleFontsChanged_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){(0,i.unlisten)(n.labelCache,j.default.CLEAR,this.handleFontsChanged_,this),a.prototype.disposeInternal.call(this)},b.prototype.compose=function(a,b,c){var d=this,e=b.extent,f=b.pixelRatio,h=c.managed?b.skippedFeatureUids:{},i=b.viewState,j=i.projection,k=i.rotation,o=j.getExtent(),p=this.getLayer().getSource(),q=this.getTransform(b,0),r=c.extent,s=void 0!==r;s&&this.clip(a,b,r);var t=this.replayGroup_;if(t&&!t.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var u,v=this.getLayer(),w=0,x=0,y=1!==c.opacity,z=v.hasListener(m.default.RENDER);if(y||z){var A=a.canvas.width,B=a.canvas.height;if(k){var C=Math.round(Math.sqrt(A*A+B*B));w=(C-A)/2,x=(C-B)/2,A=B=C}this.context.canvas.width=A,this.context.canvas.height=B,u=this.context}else u=a;var D=u.globalAlpha;y||(u.globalAlpha=c.opacity),u!=a&&u.translate(w,x);var E=b.viewHints,F=!(E[g.default.ANIMATING]||E[g.default.INTERACTING]),G=b.size[0]*f,H=b.size[1]*f;if((0,n.rotateAtOffset)(u,-k,G/2,H/2),t.replay(u,q,k,h,F),p.getWrapX()&&j.canWrapX()&&!(0,l.containsExtent)(o,e)){for(var I,J=e[0],K=(0,l.getWidth)(o),L=0;J<o[0];)--L,I=K*L,q=d.getTransform(b,I),t.replay(u,q,k,h,F),J+=K;for(L=0,J=e[2];J>o[2];)++L,I=K*L,q=d.getTransform(b,I),t.replay(u,q,k,h,F),J-=K}if((0,n.rotateAtOffset)(u,k,G/2,H/2),z&&this.dispatchRenderEvent(u,b,q),u!=a){if(y){var M=a.globalAlpha;a.globalAlpha=c.opacity,a.drawImage(u.canvas,-w,-x),a.globalAlpha=M}else a.drawImage(u.canvas,-w,-x);u.translate(-w,-x)}y||(u.globalAlpha=D)}s&&a.restore()},b.prototype.composeFrame=function(a,b,c){var d=this.getTransform(a,0);this.preCompose(c,a,d),this.compose(c,a,b),this.postCompose(c,a,b,d)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,f){if(this.replayGroup_){var g=b.viewState.resolution,h=b.viewState.rotation,i=this.getLayer(),j={};return this.replayGroup_.forEachFeatureAtCoordinate(a,g,h,c,{},function(a){var b=(0,e.getUid)(a).toString();if(!(b in j))return j[b]=!0,d.call(f,a,i)},null)}},b.prototype.handleFontsChanged_=function(a){var b=this.getLayer();b.getVisible()&&this.replayGroup_&&b.changed()},b.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()},b.prototype.prepareFrame=function(a,b){var c=this.getLayer(),d=c.getSource(),e=a.viewHints[g.default.ANIMATING],f=a.viewHints[g.default.INTERACTING],h=c.getUpdateWhileAnimating(),i=c.getUpdateWhileInteracting();if(!this.dirty_&&!h&&e||!i&&f)return!0;var j=a.extent,k=a.viewState,m=k.projection,n=k.resolution,p=a.pixelRatio,r=c.getRevision(),s=c.getRenderBuffer(),t=c.getRenderOrder();void 0===t&&(t=q.defaultOrder);var u=(0,l.buffer)(j,s*n),v=k.projection.getExtent();if(d.getWrapX()&&k.projection.canWrapX()&&!(0,l.containsExtent)(v,a.extent)){var w=(0,l.getWidth)(v),x=Math.max((0,l.getWidth)(u)/2,w);u[0]=v[0]-x,u[2]=v[2]+x}if(!this.dirty_&&this.renderedResolution_==n&&this.renderedRevision_==r&&this.renderedRenderOrder_==t&&(0,l.containsExtent)(this.renderedExtent_,u))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var y=new o.default((0,q.getTolerance)(n,p),u,n,p,d.getOverlaps(),this.declutterTree_,c.getRenderBuffer());d.loadFeatures(u,n,m);var z=function(a){var b,d=a.getStyleFunction()||c.getStyleFunction();if(d&&(b=d(a,n)),b){var e=this.renderFeature(a,n,p,b,y);this.dirty_=this.dirty_||e}}.bind(this);if(t){var A=[];d.forEachFeatureInExtent(u,function(a){A.push(a)},this),A.sort(t);for(var B=0,C=A.length;B<C;++B)z(A[B])}else d.forEachFeatureInExtent(u,z,this);return y.finish(),this.renderedResolution_=n,this.renderedRevision_=r,this.renderedRenderOrder_=t,this.renderedExtent_=u,this.replayGroup_=y,this.replayGroupChanged=!0,!0},b.prototype.renderFeature=function(a,b,c,d,e){var f=this;if(!d)return!1;var g=!1;if(Array.isArray(d))for(var h=0,i=d.length;h<i;++h)g=(0,q.renderFeature)(e,a,d[h],(0,q.getSquaredTolerance)(b,c),f.handleStyleImageChange_,f)||g;else g=(0,q.renderFeature)(e,a,d,(0,q.getSquaredTolerance)(b,c),this.handleStyleImageChange_,this);return g},b}(p.default);r.handles=function(a){return a.getType()===f.default.VECTOR},r.create=function(a,b){return new r(b)};var s=r;c.default=s},{"../../LayerType.js":20,"../../ViewHint.js":43,"../../dom.js":64,"../../events.js":66,"../../events/EventType.js":68,"../../extent.js":72,"../../render/EventType.js":220,"../../render/canvas.js":225,"../../render/canvas/ReplayGroup.js":232,"../../util.js":342,"../canvas/Layer.js":257,"../vector.js":262,rbush:357}],261:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../util.js"),g=e(a("../../LayerType.js")),h=e(a("../../TileState.js")),i=e(a("../../ViewHint.js")),j=a("../../dom.js"),k=a("../../events.js"),l=e(a("../../events/EventType.js")),m=e(a("rbush")),n=a("../../extent.js"),o=e(a("../../layer/VectorTileRenderType.js")),p=a("../../proj.js"),q=e(a("../../proj/Units.js")),r=e(a("../../render/ReplayType.js")),s=a("../../render/canvas.js"),t=d(a("../../render/canvas/ReplayGroup.js")),u=a("../../render/replay.js"),v=e(a("../canvas/TileLayer.js")),w=a("../vector.js"),x=a("../../transform.js"),y={image:[r.default.POLYGON,r.default.CIRCLE,r.default.LINE_STRING,r.default.IMAGE,r.default.TEXT],hybrid:[r.default.POLYGON,r.default.LINE_STRING]},z={image:[r.default.DEFAULT],hybrid:[r.default.IMAGE,r.default.TEXT,r.default.DEFAULT],vector:u.ORDER},A=function(a){function b(b){a.call(this,b,!0),this.declutterTree_=b.getDeclutter()?(0,m.default)(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=(0,x.create)(),this.zDirection=b.getRenderMode()==o.default.VECTOR?1:0,(0,k.listen)(s.labelCache,l.default.CLEAR,this.handleFontsChanged_,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){(0,k.unlisten)(s.labelCache,l.default.CLEAR,this.handleFontsChanged_,this),a.prototype.disposeInternal.call(this)},b.prototype.getTile=function(b,c,d,e,f){var g=a.prototype.getTile.call(this,b,c,d,e,f);return g.getState()===h.default.LOADED&&(this.createReplayGroup_(g,e,f),this.context&&this.renderTileImage_(g,e,f)),g},b.prototype.prepareFrame=function(b,c){var d=this.getLayer(),e=d.getRevision();if(this.renderedLayerRevision_!=e){this.renderedTiles.length=0;var f=d.getRenderMode();this.context||f==o.default.VECTOR||(this.context=(0,j.createCanvasContext2D)()),this.context&&f==o.default.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=e,a.prototype.prepareFrame.call(this,b,c)},b.prototype.createReplayGroup_=function(a,b,c){var d=this,e=this.getLayer(),f=e.getRevision(),g=e.getRenderOrder()||null,i=a.getReplayState(e);if(i.dirty||i.renderedRevision!=f||i.renderedRenderOrder!=g){for(var j=e.getSource(),k=j.getTileGrid(),l=j.getTileGridForProjection(c),m=l.getResolution(a.tileCoord[0]),o=a.extent,r={},s=function(f,l){var s=a.getTile(a.tileKeys[f]);if(s.getState()==h.default.LOADED){var u=s.tileCoord,v=k.getTileCoordExtent(u),x=(0,n.getIntersection)(o,v),y=(0,n.equals)(v,x)?null:(0,n.buffer)(x,e.getRenderBuffer()*m,d.tmpExtent),z=s.getProjection(),A=!1;(0,p.equivalent)(c,z)||(A=!0,s.setProjection(c)),i.dirty=!1;var B=new t.default(0,x,m,b,j.getOverlaps(),d.declutterTree_,e.getRenderBuffer()),C=(0,w.getSquaredTolerance)(m,b),D=function(a){var b,c=a.getStyleFunction()||e.getStyleFunction();if(c&&(b=c(a,m)),b){var d=this.renderFeature(a,C,b,B);this.dirty_=this.dirty_||d,i.dirty=i.dirty||d}},E=s.getFeatures();g&&g!==i.renderedRenderOrder&&E.sort(g);for(var F=0,G=E.length;F<G;++F){var H=E[F];A&&(z.getUnits()==q.default.TILE_PIXELS&&(z.setWorldExtent(v),z.setExtent(s.getExtent())),H.getGeometry().transform(z,c)),y&&!(0,n.intersects)(y,H.getGeometry().getExtent())||D.call(d,H)}B.finish();for(var I in B.getReplays())r[I]=!0;s.setReplayGroup(e,a.tileCoord.toString(),B)}},u=0,v=a.tileKeys.length;u<v;++u)s(u,v);i.renderedRevision=f,i.renderedRenderOrder=g}},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var g=b.viewState.resolution,i=b.viewState.rotation;c=void 0==c?0:c;var j,k,l,m,o,p=this.getLayer(),q={},r=this.renderedTiles;for(l=0,m=r.length;l<m;++l){var s=r[l];if(j=(0,n.buffer)(s.extent,c*g,j),(0,n.containsCoordinate)(j,a))for(var t=0,u=s.tileKeys.length;t<u;++t){var v=s.getTile(s.tileKeys[t]);v.getState()==h.default.LOADED&&(o=v.getReplayGroup(p,s.tileCoord.toString()),k=k||o.forEachFeatureAtCoordinate(a,g,i,c,{},function(a){var b=(0,f.getUid)(a).toString();if(!(b in q))return q[b]=!0,d.call(e,a,p)},null))}}return k},b.prototype.getReplayTransform_=function(a,b){var c=this.getLayer(),d=c.getSource(),e=d.getTileGrid(),f=a.tileCoord,g=e.getResolution(f[0]),h=b.viewState,i=b.pixelRatio,j=h.resolution/i,k=e.getTileCoordExtent(f,this.tmpExtent),l=h.center,m=(0,n.getTopLeft)(k),o=b.size,p=Math.round(i*o[0]/2),q=Math.round(i*o[1]/2);return(0,x.compose)(this.tmpTransform_,p,q,g/j,g/j,h.rotation,(m[0]-l[0])/g,(l[1]-m[1])/g)},b.prototype.handleFontsChanged_=function(a){var b=this.getLayer();b.getVisible()&&void 0!==this.renderedLayerRevision_&&b.changed()},b.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()},b.prototype.postCompose=function(b,c,d){var e=this,f=this.getLayer(),g=f.getRenderMode();if(g!=o.default.IMAGE){var j,k,l=f.getDeclutter()?{}:null,m=f.getSource(),n=z[g],p=c.pixelRatio,q=c.viewState.rotation,r=c.size;q&&(j=Math.round(p*r[0]/2),
k=Math.round(p*r[1]/2),(0,s.rotateAtOffset)(b,-q,j,k)),l&&this.declutterTree_.clear();for(var u=c.viewHints,v=!(u[i.default.ANIMATING]||u[i.default.INTERACTING]),w=this.renderedTiles,x=m.getTileGridForProjection(c.viewState.projection),y=[],A=[],B=w.length-1;B>=0;--B){var C=w[B];if(C.getState()!=h.default.ABORT)for(var D=C.tileCoord,E=x.getTileCoordExtent(D,e.tmpExtent)[0]-C.extent[0],F=void 0,G=0,H=C.tileKeys.length;G<H;++G){var I=C.getTile(C.tileKeys[G]);if(I.getState()==h.default.LOADED){var J=I.getReplayGroup(f,D.toString());if(J&&J.hasReplays(n)){F||(F=e.getTransform(c,E));var K=I.tileCoord[0],L=J.getClipCoords(F);b.save(),b.globalAlpha=d.opacity;for(var M=0,N=y.length;M<N;++M){var O=y[M];K<A[M]&&(b.beginPath(),b.moveTo(L[0],L[1]),b.lineTo(L[2],L[3]),b.lineTo(L[4],L[5]),b.lineTo(L[6],L[7]),b.moveTo(O[6],O[7]),b.lineTo(O[4],O[5]),b.lineTo(O[2],O[3]),b.lineTo(O[0],O[1]),b.clip())}J.replay(b,F,q,{},v,n,l),b.restore(),y.push(L),A.push(K)}}}}l&&(0,t.replayDeclutter)(l,b,q,v),q&&(0,s.rotateAtOffset)(b,q,j,k)}a.prototype.postCompose.call(this,b,c,d)},b.prototype.renderFeature=function(a,b,c,d){var e=this;if(!c)return!1;var f=!1;if(Array.isArray(c))for(var g=0,h=c.length;g<h;++g)f=(0,w.renderFeature)(d,a,c[g],b,e.handleStyleImageChange_,e)||f;else f=(0,w.renderFeature)(d,a,c,b,this.handleStyleImageChange_,this);return f},b.prototype.renderTileImage_=function(a,b,c){var d=this,e=this.getLayer(),f=a.getReplayState(e),g=e.getRevision(),i=y[e.getRenderMode()];if(i&&f.renderedTileRevision!==g){f.renderedTileRevision=g;var j=a.wrappedTileCoord,k=j[0],l=e.getSource(),m=l.getTileGridForProjection(c),n=m.getResolution(k),o=a.getContext(e),p=l.getTilePixelSize(k,b,c);o.canvas.width=p[0],o.canvas.height=p[1];for(var q=m.getTileCoordExtent(j,this.tmpExtent),r=0,s=a.tileKeys.length;r<s;++r){var t=a.getTile(a.tileKeys[r]);if(t.getState()==h.default.LOADED){var u=b/n,v=(0,x.reset)(d.tmpTransform_);(0,x.scale)(v,u,-u),(0,x.translate)(v,-q[0],-q[3]);t.getReplayGroup(e,a.tileCoord.toString()).replay(o,v,0,{},!0,i)}}}},b}(v.default);A.handles=function(a){return a.getType()===g.default.VECTOR_TILE},A.create=function(a,b){return new A(b)};var B=A;c.default=B},{"../../LayerType.js":20,"../../TileState.js":39,"../../ViewHint.js":43,"../../dom.js":64,"../../events.js":66,"../../events/EventType.js":68,"../../extent.js":72,"../../layer/VectorTileRenderType.js":197,"../../proj.js":210,"../../proj/Units.js":212,"../../render/ReplayType.js":223,"../../render/canvas.js":225,"../../render/canvas/ReplayGroup.js":232,"../../render/replay.js":234,"../../transform.js":340,"../../util.js":342,"../canvas/TileLayer.js":259,"../vector.js":262,rbush:357}],262:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return(0,s.getUid)(a)-(0,s.getUid)(b)}function f(a,b){var c=g(a,b);return c*c}function g(a,b){return w*a/b}function h(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),v.default.CIRCLE);g.setFillStrokeStyle(e,f),g.drawCircle(b,d)}var h=c.getText();if(h){var i=a.getReplay(c.getZIndex(),v.default.TEXT);i.setTextStyle(h,a.addDeclutter(!1)),i.drawText(b,d)}}function i(a,b,c,d,e,f){var g=!1,h=c.getImage();if(h){var i=h.getImageState();i==t.default.LOADED||i==t.default.ERROR?h.unlistenImageChange(e,f):(i==t.default.IDLE&&h.load(),i=h.getImageState(),h.listenImageChange(e,f),g=!0)}return j(a,b,c,d),g}function j(a,b,c,d){var e=c.getGeometryFunction()(b);if(e){var f=e.getSimplifiedGeometry(d);if(c.getRenderer())k(a,f,c,b);else{(0,x[f.getType()])(a,f,c,b)}}}function k(a,b,c,d){if(b.getType()!=u.default.GEOMETRY_COLLECTION){a.getReplay(c.getZIndex(),v.default.DEFAULT).drawCustom(b,d,c.getRenderer())}else for(var e=b.getGeometries(),f=0,g=e.length;f<g;++f)k(a,e[f],c,d)}function l(a,b,c,d){var e,f,g=b.getGeometriesArray();for(e=0,f=g.length;e<f;++e){(0,x[g[e].getType()])(a,g[e],c,d)}}function m(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),v.default.LINE_STRING);f.setFillStrokeStyle(null,e),f.drawLineString(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!1)),h.drawText(b,d)}}function n(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),v.default.LINE_STRING);f.setFillStrokeStyle(null,e),f.drawMultiLineString(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!1)),h.drawText(b,d)}}function o(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(f||e){var g=a.getReplay(c.getZIndex(),v.default.POLYGON);g.setFillStrokeStyle(e,f),g.drawMultiPolygon(b,d)}var h=c.getText();if(h){var i=a.getReplay(c.getZIndex(),v.default.TEXT);i.setTextStyle(h,a.addDeclutter(!1)),i.drawText(b,d)}}function p(a,b,c,d){var e=c.getImage();if(e){if(e.getImageState()!=t.default.LOADED)return;var f=a.getReplay(c.getZIndex(),v.default.IMAGE);f.setImageStyle(e,a.addDeclutter(!1)),f.drawPoint(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!!e)),h.drawText(b,d)}}function q(a,b,c,d){var e=c.getImage();if(e){if(e.getImageState()!=t.default.LOADED)return;var f=a.getReplay(c.getZIndex(),v.default.IMAGE);f.setImageStyle(e,a.addDeclutter(!1)),f.drawMultiPoint(b,d)}var g=c.getText();if(g){var h=a.getReplay(c.getZIndex(),v.default.TEXT);h.setTextStyle(g,a.addDeclutter(!!e)),h.drawText(b,d)}}function r(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),v.default.POLYGON);g.setFillStrokeStyle(e,f),g.drawPolygon(b,d)}var h=c.getText();if(h){var i=a.getReplay(c.getZIndex(),v.default.TEXT);i.setTextStyle(h,a.addDeclutter(!1)),i.drawText(b,d)}}Object.defineProperty(c,"__esModule",{value:!0}),c.defaultOrder=e,c.getSquaredTolerance=f,c.getTolerance=g,c.renderFeature=i;var s=a("../util.js"),t=d(a("../ImageState.js")),u=d(a("../geom/GeometryType.js")),v=d(a("../render/ReplayType.js")),w=.5,x={Point:p,LineString:m,Polygon:r,MultiPoint:q,MultiLineString:n,MultiPolygon:o,GeometryCollection:l,Circle:h}},{"../ImageState.js":17,"../geom/GeometryType.js":132,"../render/ReplayType.js":223,"../util.js":342}],263:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../reproj/common.js"),f=a("../../functions.js"),g=d(a("../../LayerType.js")),h=d(a("../../ViewHint.js")),i=a("../../dom.js"),j=a("../../extent.js"),k=d(a("../webgl/Layer.js")),l=a("../../transform.js"),m=a("../../webgl.js"),n=a("../../webgl/Context.js"),o=function(a){function b(b,c){a.call(this,b,c),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createTexture_=function(a){var b=a.getImage(),c=this.mapRenderer.getGL();return(0,n.createTexture)(c,b,m.CLAMP_TO_EDGE,m.CLAMP_TO_EDGE)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer(),g=f.getSource(),h=b.viewState.resolution,i=b.viewState.rotation,j=b.skippedFeatureUids;return g.forEachFeatureAtCoordinate(a,h,i,c,j,function(a){return d.call(e,a,f)})},b.prototype.prepareFrame=function(a,b,c){var d=this.mapRenderer.getGL(),f=a.pixelRatio,g=a.viewState,i=g.center,k=g.resolution,m=g.rotation,n=this.image_,o=this.texture,p=this.getLayer(),q=p.getSource(),r=a.viewHints,s=a.extent;if(void 0!==b.extent&&(s=(0,j.getIntersection)(s,b.extent)),!r[h.default.ANIMATING]&&!r[h.default.INTERACTING]&&!(0,j.isEmpty)(s)){var t=g.projection;if(!e.ENABLE_RASTER_REPROJECTION){var u=q.getProjection();u&&(t=u)}var v=q.getImage(s,k,f,t);if(v){if(this.loadImage(v)&&(n=v,o=this.createTexture_(v),this.texture)){var w=function(a,b){a.isContextLost()||a.deleteTexture(b)}.bind(null,d,this.texture);a.postRenderFunctions.push(w)}}}if(n){var x=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(x.width,x.height,f,i,k,m,n.getExtent()),this.hitTransformationMatrix_=null;var y=this.texCoordMatrix;(0,l.reset)(y),(0,l.scale)(y,1,-1),(0,l.translate)(y,0,-1),this.image_=n,this.texture=o}return!!n},b.prototype.updateProjectionMatrix_=function(a,b,c,d,e,f,g){var h=a*e,i=b*e,j=this.projectionMatrix;(0,l.reset)(j),(0,l.scale)(j,2*c/h,2*c/i),(0,l.rotate)(j,-f),(0,l.translate)(j,g[0]-d[0],g[1]-d[1]),(0,l.scale)(j,(g[2]-g[0])/2,(g[3]-g[1])/2),(0,l.translate)(j,1,1)},b.prototype.hasFeatureAtCoordinate=function(a,b){return void 0!==this.forEachFeatureAtCoordinate(a,b,0,f.TRUE,this)},b.prototype.forEachLayerAtPixel=function(a,b,c,d){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==f.VOID){var e=(0,l.apply)(b.pixelToCoordinateTransform,a.slice());return this.forEachFeatureAtCoordinate(e,b,0,f.TRUE,this)?c.call(d,this.getLayer(),null):void 0}var g=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(b.size,g));var h=(0,l.apply)(this.hitTransformationMatrix_,a.slice());if(!(h[0]<0||h[0]>g[0]||h[1]<0||h[1]>g[1])){this.hitCanvasContext_||(this.hitCanvasContext_=(0,i.createCanvasContext2D)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),h[0],h[1],1,1,0,0,1,1);var j=this.hitCanvasContext_.getImageData(0,0,1,1).data;return j[3]>0?c.call(d,this.getLayer(),j):void 0}}},b.prototype.getHitTransformationMatrix_=function(a,b){var c=(0,l.create)();(0,l.translate)(c,-1,-1),(0,l.scale)(c,2/a[0],2/a[1]),(0,l.translate)(c,0,a[1]),(0,l.scale)(c,1,-1);var d=(0,l.invert)(this.projectionMatrix.slice()),e=(0,l.create)();return(0,l.translate)(e,0,b[1]),(0,l.scale)(e,1,-1),(0,l.scale)(e,b[0]/2,b[1]/2),(0,l.translate)(e,1,1),(0,l.multiply)(e,d),(0,l.multiply)(e,c),e},b}(k.default);o.handles=function(a){return a.getType()===g.default.IMAGE},o.create=function(a,b){return new o(a,b)};var p=o;c.default=p},{"../../LayerType.js":20,"../../ViewHint.js":43,"../../dom.js":64,"../../extent.js":72,"../../functions.js":126,"../../reproj/common.js":276,"../../transform.js":340,"../../webgl.js":344,"../../webgl/Context.js":346,"../webgl/Layer.js":264}],264:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../../render/Event.js")),f=d(a("../../render/EventType.js")),g=d(a("../../render/webgl/Immediate.js")),h=d(a("../Layer.js")),i=a("../webgl/defaultmapshader.js"),j=d(a("../webgl/defaultmapshader/Locations.js")),k=a("../../transform.js"),l=a("../../vec/mat4.js"),m=a("../../webgl.js"),n=d(a("../../webgl/Buffer.js")),o=a("../../webgl/Context.js"),p=function(a){function b(b,c){a.call(this,c),this.mapRenderer=b,this.arrayBuffer_=new n.default([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=(0,k.create)(),this.projectionMatrix=(0,k.create)(),this.tmpMat4_=(0,l.create)(),this.defaultLocations_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.bindFramebuffer=function(a,b){var c=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=b){var d=function(a,b,c){a.isContextLost()||(a.deleteFramebuffer(b),a.deleteTexture(c))}.bind(null,c,this.framebuffer,this.texture);a.postRenderFunctions.push(d);var e=(0,o.createEmptyTexture)(c,b,b),f=c.createFramebuffer();c.bindFramebuffer(m.FRAMEBUFFER,f),c.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,e,0),this.texture=e,this.framebuffer=f,this.framebufferDimension=b}else c.bindFramebuffer(m.FRAMEBUFFER,this.framebuffer)},b.prototype.composeFrame=function(a,b,c){this.dispatchComposeEvent_(f.default.PRECOMPOSE,c,a),c.bindBuffer(m.ARRAY_BUFFER,this.arrayBuffer_);var d,e=c.getGL(),g=c.getProgram(i.fragment,i.vertex);this.defaultLocations_?d=this.defaultLocations_:(d=new j.default(e,g),this.defaultLocations_=d),c.useProgram(g)&&(e.enableVertexAttribArray(d.a_position),e.vertexAttribPointer(d.a_position,2,m.FLOAT,!1,16,0),e.enableVertexAttribArray(d.a_texCoord),e.vertexAttribPointer(d.a_texCoord,2,m.FLOAT,!1,16,8),e.uniform1i(d.u_texture,0)),e.uniformMatrix4fv(d.u_texCoordMatrix,!1,(0,l.fromTransform)(this.tmpMat4_,this.getTexCoordMatrix())),e.uniformMatrix4fv(d.u_projectionMatrix,!1,(0,l.fromTransform)(this.tmpMat4_,this.getProjectionMatrix())),e.uniform1f(d.u_opacity,b.opacity),e.bindTexture(m.TEXTURE_2D,this.getTexture()),e.drawArrays(m.TRIANGLE_STRIP,0,4),this.dispatchComposeEvent_(f.default.POSTCOMPOSE,c,a)},b.prototype.dispatchComposeEvent_=function(a,b,c){var d=this.getLayer();if(d.hasListener(a)){var f=c.viewState,h=f.resolution,i=c.pixelRatio,j=c.extent,k=f.center,l=f.rotation,m=c.size,n=new g.default(b,k,h,l,m,j,i),o=new e.default(a,n,c,null,b);d.dispatchEvent(o)}},b.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},b.prototype.getTexture=function(){return this.texture},b.prototype.getProjectionMatrix=function(){return this.projectionMatrix},b.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},b.prototype.prepareFrame=function(a,b,c){},b.prototype.forEachLayerAtPixel=function(a,b,c,d){},b}(h.default),q=p;c.default=q},{"../../render/Event.js":219,"../../render/EventType.js":220,"../../render/webgl/Immediate.js":238,"../../transform.js":340,"../../vec/mat4.js":343,"../../webgl.js":344,"../../webgl/Buffer.js":345,"../../webgl/Context.js":346,"../Layer.js":253,"../webgl/defaultmapshader.js":268,"../webgl/defaultmapshader/Locations.js":269}],265:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../../array.js"),g=a("../../css.js"),h=a("../../dom.js"),i=a("../../events.js"),j=a("../../layer/Layer.js"),k=e(a("../../render/Event.js")),l=e(a("../../render/EventType.js")),m=e(a("../../render/webgl/Immediate.js")),n=d(a("../Map.js")),o=e(a("../../source/State.js")),p=e(a("../../structs/LRUCache.js")),q=e(a("../../structs/PriorityQueue.js")),r=a("../../webgl.js"),s=e(a("../../webgl/Context.js")),t=e(a("../../webgl/ContextEventType.js")),u=1024,v=function(a){function b(b){a.call(this,b);var c=b.getViewport();this.canvas_=document.createElement("canvas"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=g.CLASS_UNSELECTABLE,c.insertBefore(this.canvas_,c.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=(0,h.createCanvasContext2D)(),this.renderedVisible_=!0,this.gl_=(0,r.getContext)(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new s.default(this.canvas_,this.gl_),(0,i.listen)(this.canvas_,t.default.LOST,this.handleWebGLContextLost,this),(0,i.listen)(this.canvas_,t.default.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new p.default,this.focus_=null,this.tileTextureQueue_=new q.default(function(a){var b=a[1],c=a[2],d=b[0]-this.focus_[0],e=b[1]-this.focus_[1];return 65536*Math.log(c)+Math.sqrt(d*d+e*e)/c}.bind(this),function(a){return a[0].getKey()}),this.loadNextTileTexture_=function(a,b){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var c=this.tileTextureQueue_.dequeue(),d=c[0],e=c[3],f=c[4];this.bindTileTexture(d,e,f,r.LINEAR,r.LINEAR)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.bindTileTexture=function(a,b,c,d,e){var f=this.getGL(),g=a.getKey();if(this.textureCache_.containsKey(g)){var h=this.textureCache_.get(g);f.bindTexture(r.TEXTURE_2D,h.texture),h.magFilter!=d&&(f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,d),h.magFilter=d),h.minFilter!=e&&(f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e),h.minFilter=e)}else{var i=f.createTexture();if(f.bindTexture(r.TEXTURE_2D,i),c>0){var j=this.clipTileContext_.canvas,k=this.clipTileContext_;this.clipTileCanvasWidth_!==b[0]||this.clipTileCanvasHeight_!==b[1]?(j.width=b[0],j.height=b[1],this.clipTileCanvasWidth_=b[0],this.clipTileCanvasHeight_=b[1]):k.clearRect(0,0,b[0],b[1]),k.drawImage(a.getImage(),c,c,b[0],b[1],0,0,b[0],b[1]),f.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,j)}else f.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,a.getImage());f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,d),f.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e),f.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),f.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),this.textureCache_.set(g,{texture:i,magFilter:d,minFilter:e})}},b.prototype.dispatchRenderEvent=function(a,b){var c=this.getMap();if(c.hasListener(a)){var d=this.context_,e=b.extent,f=b.size,g=b.viewState,h=b.pixelRatio,i=g.resolution,j=g.center,l=g.rotation,n=new m.default(d,j,i,l,f,e,h),o=new k.default(a,n,b,null,d);c.dispatchEvent(o)}},b.prototype.disposeInternal=function(){var b=this.getGL();b.isContextLost()||this.textureCache_.forEach(function(a){a&&b.deleteTexture(a.texture)}),this.context_.dispose(),a.prototype.disposeInternal.call(this)},b.prototype.expireCache_=function(a,b){for(var c,d=this,e=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>u;){if(c=d.textureCache_.peekLast())e.deleteTexture(c.texture);else{if(+d.textureCache_.peekLastKey()==b.index)break;--d.textureCacheFrameMarkerCount_}d.textureCache_.pop()}},b.prototype.getContext=function(){return this.context_},b.prototype.getGL=function(){return this.gl_},b.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},b.prototype.handleWebGLContextLost=function(a){a.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var b=this.getLayerRenderers();for(var c in b){b[c].handleWebGLContextLost()}},b.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},b.prototype.initializeGL_=function(){var a=this.gl_;a.activeTexture(r.TEXTURE0),a.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),a.disable(r.CULL_FACE),a.disable(r.DEPTH_TEST),a.disable(r.SCISSOR_TEST),a.disable(r.STENCIL_TEST)},b.prototype.isTileTextureLoaded=function(a){return this.textureCache_.containsKey(a.getKey())},b.prototype.renderFrame=function(a){var b=this,c=this.getContext(),d=this.getGL();if(d.isContextLost())return!1;if(!a)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=a.focus,this.textureCache_.set((-a.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchRenderEvent(l.default.PRECOMPOSE,a);var e=[],g=a.layerStatesArray;(0,f.stableSort)(g,n.sortByZIndex);var h,i,k,m,p=a.viewState.resolution;for(h=0,i=g.length;h<i;++h)m=g[h],(0,j.visibleAtResolution)(m,p)&&m.sourceState==o.default.READY&&(k=b.getLayerRenderer(m.layer),k.prepareFrame(a,m,c)&&e.push(m));var q=a.size[0]*a.pixelRatio,s=a.size[1]*a.pixelRatio;for(this.canvas_.width==q&&this.canvas_.height==s||(this.canvas_.width=q,this.canvas_.height=s),d.bindFramebuffer(r.FRAMEBUFFER,null),d.clearColor(0,0,0,0),d.clear(r.COLOR_BUFFER_BIT),d.enable(r.BLEND),d.viewport(0,0,this.canvas_.width,this.canvas_.height),h=0,i=e.length;h<i;++h)m=e[h],k=b.getLayerRenderer(m.layer),k.composeFrame(a,m,c);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(a),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>u&&a.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(a.postRenderFunctions.push(this.loadNextTileTexture_),a.animate=!0),this.dispatchRenderEvent(l.default.POSTCOMPOSE,a),this.scheduleRemoveUnusedLayerRenderers(a),this.scheduleExpireIconCache(a)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g){var h,i=this;if(this.getGL().isContextLost())return!1;var k,l=b.viewState,m=b.layerStatesArray,n=m.length;for(k=n-1;k>=0;--k){var o=m[k],p=o.layer;if((0,j.visibleAtResolution)(o,l.resolution)&&f.call(g,p)){if(h=i.getLayerRenderer(p).forEachFeatureAtCoordinate(a,b,c,d,e))return h}}},b.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){var f=this,g=!1;if(this.getGL().isContextLost())return!1;var h,i=b.viewState,k=b.layerStatesArray,l=k.length;for(h=l-1;h>=0;--h){var m=k[h],n=m.layer;if((0,j.visibleAtResolution)(m,i.resolution)&&d.call(e,n)){if(g=f.getLayerRenderer(n).hasFeatureAtCoordinate(a,b))return!0}}return g},b.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f,g){var h=this;if(this.getGL().isContextLost())return!1;var i,k,l=b.viewState,m=b.layerStatesArray,n=m.length;for(k=n-1;k>=0;--k){var o=m[k],p=o.layer;if((0,j.visibleAtResolution)(o,l.resolution)&&f.call(e,p)){if(i=h.getLayerRenderer(p).forEachLayerAtPixel(a,b,d,e))return i}}},b}(n.default),w=v;c.default=w},{"../../array.js":46,"../../css.js":63,"../../dom.js":64,"../../events.js":66,"../../layer/Layer.js":190,"../../render/Event.js":219,"../../render/EventType.js":220,"../../render/webgl/Immediate.js":238,"../../source/State.js":294,"../../structs/LRUCache.js":314,"../../structs/PriorityQueue.js":316,"../../webgl.js":344,"../../webgl/Context.js":346,"../../webgl/ContextEventType.js":347,"../Map.js":254}],266:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../../LayerType.js")),f=d(a("../../TileRange.js")),g=d(a("../../TileState.js")),h=a("../../array.js"),i=a("../../extent.js"),j=a("../../math.js"),k=d(a("../webgl/Layer.js")),l=a("../webgl/tilelayershader.js"),m=d(a("../webgl/tilelayershader/Locations.js")),n=a("../../size.js"),o=a("../../transform.js"),p=a("../../webgl.js"),q=d(a("../../webgl/Buffer.js")),r=function(a){function b(b,c){a.call(this,b,c),this.fragmentShader_=l.fragment,this.vertexShader_=l.vertex,this.locations_=null,this.renderArrayBuffer_=new q.default([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),a.prototype.disposeInternal.call(this)},b.prototype.createLoadedTileFinder=function(a,b,c){var d=this.mapRenderer;return function(e,f){function g(a){var b=d.isTileTextureLoaded(a);return b&&(c[e]||(c[e]={}),c[e][a.tileCoord.toString()]=a),b}return a.forEachLoadedTile(b,e,f,g)}},b.prototype.handleWebGLContextLost=function(){a.prototype.handleWebGLContextLost.call(this),this.locations_=null},b.prototype.prepareFrame=function(a,b,c){var d,e=this,k=this.mapRenderer,l=c.getGL(),q=a.viewState,r=q.projection,s=this.getLayer(),t=s.getSource(),u=t.getTileGridForProjection(r),v=u.getZForResolution(q.resolution),w=u.getResolution(v),x=t.getTilePixelSize(v,a.pixelRatio,r),y=x[0]/(0,n.toSize)(u.getTileSize(v),this.tmpSize_)[0],z=w/y,A=t.getTilePixelRatio(y)*t.getGutterForProjection(r),B=q.center,C=a.extent,D=u.getTileRangeForExtentAndZ(C,v);if(this.renderedTileRange_&&this.renderedTileRange_.equals(D)&&this.renderedRevision_==t.getRevision())d=this.renderedFramebufferExtent_;else{var E=D.getSize(),F=Math.max(E[0]*x[0],E[1]*x[1]),G=(0,j.roundUpToPowerOfTwo)(F),H=z*G,I=u.getOrigin(v),J=I[0]+D.minX*x[0]*z,K=I[1]+D.minY*x[1]*z;d=[J,K,J+H,K+H],this.bindFramebuffer(a,G),l.viewport(0,0,G,G),l.clearColor(0,0,0,0),l.clear(p.COLOR_BUFFER_BIT),l.disable(p.BLEND);var L=c.getProgram(this.fragmentShader_,this.vertexShader_);c.useProgram(L),this.locations_||(this.locations_=new m.default(l,L)),c.bindBuffer(p.ARRAY_BUFFER,this.renderArrayBuffer_),l.enableVertexAttribArray(this.locations_.a_position),l.vertexAttribPointer(this.locations_.a_position,2,p.FLOAT,!1,16,0),l.enableVertexAttribArray(this.locations_.a_texCoord),l.vertexAttribPointer(this.locations_.a_texCoord,2,p.FLOAT,!1,16,8),l.uniform1i(this.locations_.u_texture,0);var M={};M[v]={};var N,O,P,Q,R,S,T,U,V=this.createLoadedTileFinder(t,r,M),W=s.getUseInterimTilesOnError(),X=!0,Y=(0,i.createEmpty)(),Z=new f.default(0,0,0,0);for(S=D.minX;S<=D.maxX;++S)for(T=D.minY;T<=D.maxY;++T)if(Q=t.getTile(v,S,T,y,r),void 0===b.extent||(U=u.getTileCoordExtent(Q.tileCoord,Y),(0,i.intersects)(U,b.extent))){if(R=Q.getState(),O=R==g.default.LOADED||R==g.default.EMPTY||R==g.default.ERROR&&!W,O||(Q=Q.getInterimTile()),(R=Q.getState())==g.default.LOADED){if(k.isTileTextureLoaded(Q)){M[v][Q.tileCoord.toString()]=Q;continue}}else if(R==g.default.EMPTY||R==g.default.ERROR&&!W)continue;X=!1,P=u.forEachTileCoordParentTileRange(Q.tileCoord,V,null,Z,Y),P||(N=u.getTileCoordChildTileRange(Q.tileCoord,Z,Y))&&V(v+1,N)}var $=Object.keys(M).map(Number);$.sort(h.numberSafeCompareFunction);for(var _=new Float32Array(4),aa=0,ba=$.length;aa<ba;++aa){var ca=M[$[aa]];for(var da in ca)Q=ca[da],U=u.getTileCoordExtent(Q.tileCoord,Y),_[0]=2*(U[2]-U[0])/H,_[1]=2*(U[3]-U[1])/H,_[2]=2*(U[0]-d[0])/H-1,_[3]=2*(U[1]-d[1])/H-1,l.uniform4fv(e.locations_.u_tileOffset,_),k.bindTileTexture(Q,x,A*y,p.LINEAR,p.LINEAR),l.drawArrays(p.TRIANGLE_STRIP,0,4)}X?(this.renderedTileRange_=D,this.renderedFramebufferExtent_=d,this.renderedRevision_=t.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,a.animate=!0)}this.updateUsedTiles(a.usedTiles,t,v,D);var ea=k.getTileTextureQueue();this.manageTilePyramid(a,t,u,y,r,C,v,s.getPreload(),function(a){a.getState()!=g.default.LOADED||k.isTileTextureLoaded(a)||ea.isKeyQueued(a.getKey())||ea.enqueue([a,u.getTileCoordCenter(a.tileCoord),u.getResolution(a.tileCoord[0]),x,A*y])},this),this.scheduleExpireCache(a,t);var fa=this.texCoordMatrix;return(0,o.reset)(fa),(0,o.translate)(fa,(Math.round(B[0]/w)*w-d[0])/(d[2]-d[0]),(Math.round(B[1]/w)*w-d[1])/(d[3]-d[1])),0!==q.rotation&&(0,o.rotate)(fa,q.rotation),(0,o.scale)(fa,a.size[0]*q.resolution/(d[2]-d[0]),a.size[1]*q.resolution/(d[3]-d[1])),(0,o.translate)(fa,-.5,-.5),!0},b.prototype.forEachLayerAtPixel=function(a,b,c,d){if(this.framebuffer){var e=[a[0]/b.size[0],(b.size[1]-a[1])/b.size[1]],f=(0,o.apply)(this.texCoordMatrix,e.slice()),g=[f[0]*this.framebufferDimension,f[1]*this.framebufferDimension],h=this.mapRenderer.getContext().getGL();h.bindFramebuffer(h.FRAMEBUFFER,this.framebuffer);var i=new Uint8Array(4);return h.readPixels(g[0],g[1],1,1,h.RGBA,h.UNSIGNED_BYTE,i),i[3]>0?c.call(d,this.getLayer(),i):void 0}},b}(k.default);r.handles=function(a){return a.getType()===e.default.TILE},r.create=function(a,b){return new r(a,b)};var s=r;c.default=s},{"../../LayerType.js":20,"../../TileRange.js":38,"../../TileState.js":39,"../../array.js":46,"../../extent.js":72,"../../math.js":199,"../../size.js":279,"../../transform.js":340,"../../webgl.js":344,"../../webgl/Buffer.js":345,"../webgl/Layer.js":264,"../webgl/tilelayershader.js":270,"../webgl/tilelayershader/Locations.js":271}],267:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../../util.js"),f=d(a("../../LayerType.js")),g=d(a("../../ViewHint.js")),h=a("../../extent.js"),i=d(a("../../render/webgl/ReplayGroup.js")),j=a("../vector.js"),k=d(a("../webgl/Layer.js")),l=a("../../transform.js"),m=function(a){function b(b,c){a.call(this,b,c),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,h.createEmpty)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.composeFrame=function(a,b,c){this.layerState_=b;var d=a.viewState,e=this.replayGroup_,f=a.size,g=a.pixelRatio,h=this.mapRenderer.getGL();e&&!e.isEmpty()&&(h.enable(h.SCISSOR_TEST),h.scissor(0,0,f[0]*g,f[1]*g),e.replay(c,d.center,d.resolution,d.rotation,f,g,b.opacity,b.managed?a.skippedFeatureUids:{}),h.disable(h.SCISSOR_TEST))},b.prototype.disposeInternal=function(){var b=this.replayGroup_;if(b){var c=this.mapRenderer.getContext();b.getDeleteResourcesFunction(c)(),this.replayGroup_=null}a.prototype.disposeInternal.call(this)},b.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,f){if(this.replayGroup_&&this.layerState_){var g=this.mapRenderer.getContext(),h=b.viewState,i=this.getLayer(),j=this.layerState_,k={};return this.replayGroup_.forEachFeatureAtCoordinate(a,g,h.center,h.resolution,h.rotation,b.size,b.pixelRatio,j.opacity,{},function(a){var b=(0,e.getUid)(a).toString();if(!(b in k))return k[b]=!0,d.call(f,a,i)})}},b.prototype.hasFeatureAtCoordinate=function(a,b){if(this.replayGroup_&&this.layerState_){var c=this.mapRenderer.getContext(),d=b.viewState,e=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(a,c,d.center,d.resolution,d.rotation,b.size,b.pixelRatio,e.opacity,b.skippedFeatureUids)}return!1},b.prototype.forEachLayerAtPixel=function(a,b,c,d){var e=(0,l.apply)(b.pixelToCoordinateTransform,a.slice());return this.hasFeatureAtCoordinate(e,b)?c.call(d,this.getLayer(),null):void 0},b.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()},b.prototype.prepareFrame=function(a,b,c){var d=this.getLayer(),e=d.getSource(),f=a.viewHints[g.default.ANIMATING],k=a.viewHints[g.default.INTERACTING],l=d.getUpdateWhileAnimating(),m=d.getUpdateWhileInteracting();if(!this.dirty_&&!l&&f||!m&&k)return!0;var n=a.extent,o=a.viewState,p=o.projection,q=o.resolution,r=a.pixelRatio,s=d.getRevision(),t=d.getRenderBuffer(),u=d.getRenderOrder();void 0===u&&(u=j.defaultOrder);var v=(0,h.buffer)(n,t*q);if(!this.dirty_&&this.renderedResolution_==q&&this.renderedRevision_==s&&this.renderedRenderOrder_==u&&(0,h.containsExtent)(this.renderedExtent_,v))return!0;this.replayGroup_&&a.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(c)),this.dirty_=!1;var w=new i.default((0,j.getTolerance)(q,r),v,d.getRenderBuffer());e.loadFeatures(v,q,p);var x=function(a){var b,c=a.getStyleFunction()||d.getStyleFunction();if(c&&(b=c(a,q)),b){var e=this.renderFeature(a,q,r,b,w);this.dirty_=this.dirty_||e}};if(u){var y=[];e.forEachFeatureInExtent(v,function(a){y.push(a)},this),y.sort(u),y.forEach(x.bind(this))}else e.forEachFeatureInExtent(v,x,this);return w.finish(c),this.renderedResolution_=q,this.renderedRevision_=s,this.renderedRenderOrder_=u,this.renderedExtent_=v,this.replayGroup_=w,!0},b.prototype.renderFeature=function(a,b,c,d,e){var f=this;if(!d)return!1;var g=!1;if(Array.isArray(d))for(var h=d.length-1,i=0;h>=i;--h)g=(0,j.renderFeature)(e,a,d[h],(0,j.getSquaredTolerance)(b,c),f.handleStyleImageChange_,f)||g;else g=(0,j.renderFeature)(e,a,d,(0,j.getSquaredTolerance)(b,c),this.handleStyleImageChange_,this)||g;return g},b}(k.default);m.handles=function(a){return a.getType()===f.default.VECTOR},m.create=function(a,b){return new m(a,b)};var n=m;c.default=n},{"../../LayerType.js":20,"../../ViewHint.js":43,"../../extent.js":72,"../../render/webgl/ReplayGroup.js":242,"../../transform.js":340,"../../util.js":342,"../vector.js":262,"../webgl/Layer.js":264}],268:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0
;var e=a("../../webgl.js"),f=d(a("../../webgl/Fragment.js")),g=d(a("../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}");c.vertex=i},{"../../webgl.js":344,"../../webgl/Fragment.js":348,"../../webgl/Vertex.js":350}],269:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../webgl.js"),e=function(a,b){this.u_texCoordMatrix=a.getUniformLocation(b,d.DEBUG?"u_texCoordMatrix":"d"),this.u_projectionMatrix=a.getUniformLocation(b,d.DEBUG?"u_projectionMatrix":"e"),this.u_opacity=a.getUniformLocation(b,d.DEBUG?"u_opacity":"f"),this.u_texture=a.getUniformLocation(b,d.DEBUG?"u_texture":"g"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"b"),this.a_texCoord=a.getAttribLocation(b,d.DEBUG?"a_texCoord":"c")},f=e;c.default=f},{"../../../webgl.js":344}],270:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.vertex=c.fragment=void 0;var e=a("../../webgl.js"),f=d(a("../../webgl/Fragment.js")),g=d(a("../../webgl/Vertex.js")),h=new f.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}");c.fragment=h;var i=new g.default(e.DEBUG?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}");c.vertex=i},{"../../webgl.js":344,"../../webgl/Fragment.js":348,"../../webgl/Vertex.js":350}],271:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../../../webgl.js"),e=function(a,b){this.u_tileOffset=a.getUniformLocation(b,d.DEBUG?"u_tileOffset":"d"),this.u_texture=a.getUniformLocation(b,d.DEBUG?"u_texture":"e"),this.a_position=a.getAttribLocation(b,d.DEBUG?"a_position":"b"),this.a_texCoord=a.getAttribLocation(b,d.DEBUG?"a_texCoord":"c")},f=e;c.default=f},{"../../../webgl.js":344}],272:[function(a,b,c){"use strict";function d(a,b,c,d){var e=(0,j.transform)(c,b,a),f=(0,j.getPointResolution)(b,d,c),g=b.getMetersPerUnit();void 0!==g&&(f*=g);var i=a.getMetersPerUnit();void 0!==i&&(f/=i);var k=a.getExtent();if(!k||(0,h.containsCoordinate)(k,e)){var l=(0,j.getPointResolution)(a,f,e)/f;isFinite(l)&&l>0&&(f/=l)}return f}function e(a,b,c,d){var e=c-a,f=d-b,g=Math.sqrt(e*e+f*f);return[Math.round(c+e/g),Math.round(d+f/g)]}function f(a,b,c,d,f,j,k,l,m,n,o){var p=(0,g.createCanvasContext2D)(Math.round(c*a),Math.round(c*b));if(0===m.length)return p.canvas;p.scale(c,c);var q=(0,h.createEmpty)();m.forEach(function(a,b,c){(0,h.extend)(q,a.extent)});var r=(0,h.getWidth)(q),s=(0,h.getHeight)(q),t=(0,g.createCanvasContext2D)(Math.round(c*r/d),Math.round(c*s/d)),u=c/d;m.forEach(function(a,b,c){var d=a.extent[0]-q[0],e=-(a.extent[3]-q[3]),f=(0,h.getWidth)(a.extent),g=(0,h.getHeight)(a.extent);t.drawImage(a.image,n,n,a.image.width-2*n,a.image.height-2*n,d*u,e*u,f*u,g*u)});var v=(0,h.getTopLeft)(k);return l.getTriangles().forEach(function(a,b,f){var g=a.source,h=a.target,k=g[0][0],l=g[0][1],m=g[1][0],n=g[1][1],o=g[2][0],r=g[2][1],s=(h[0][0]-v[0])/j,u=-(h[0][1]-v[1])/j,w=(h[1][0]-v[0])/j,x=-(h[1][1]-v[1])/j,y=(h[2][0]-v[0])/j,z=-(h[2][1]-v[1])/j,A=k,B=l;k=0,l=0,m-=A,n-=B,o-=A,r-=B;var C=[[m,n,0,0,w-s],[o,r,0,0,y-s],[0,0,m,n,x-u],[0,0,o,r,z-u]],D=(0,i.solveLinearSystem)(C);if(D){p.save(),p.beginPath();var E=(s+w+y)/3,F=(u+x+z)/3,G=e(E,F,s,u),H=e(E,F,w,x),I=e(E,F,y,z);p.moveTo(H[0],H[1]),p.lineTo(G[0],G[1]),p.lineTo(I[0],I[1]),p.clip(),p.transform(D[0],D[2],D[1],D[3],s,u),p.translate(q[0]-A,q[3]-B),p.scale(d/c,-d/c),p.drawImage(t.canvas,0,0),p.restore()}}),o&&(p.save(),p.strokeStyle="black",p.lineWidth=1,l.getTriangles().forEach(function(a,b,c){var d=a.target,e=(d[0][0]-v[0])/j,f=-(d[0][1]-v[1])/j,g=(d[1][0]-v[0])/j,h=-(d[1][1]-v[1])/j,i=(d[2][0]-v[0])/j,k=-(d[2][1]-v[1])/j;p.beginPath(),p.moveTo(g,h),p.lineTo(e,f),p.lineTo(i,k),p.closePath(),p.stroke()}),p.restore()),p.canvas}Object.defineProperty(c,"__esModule",{value:!0}),c.calculateSourceResolution=d,c.render=f;var g=a("./dom.js"),h=a("./extent.js"),i=a("./math.js"),j=a("./proj.js")},{"./dom.js":64,"./extent.js":72,"./math.js":199,"./proj.js":210}],273:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=d(a("../ImageBase.js")),g=d(a("../ImageState.js")),h=a("../events.js"),i=d(a("../events/EventType.js")),j=a("../extent.js"),k=a("../reproj.js"),l=d(a("../reproj/Triangulation.js")),m=function(a){function b(b,c,d,f,h,i){var m=b.getExtent(),n=c.getExtent(),o=n?(0,j.getIntersection)(d,n):d,p=(0,j.getCenter)(o),q=(0,k.calculateSourceResolution)(b,c,p,f),r=e.ERROR_THRESHOLD,s=new l.default(b,c,o,m,q*r),t=s.calculateSourceExtent(),u=i(t,q,h),v=g.default.LOADED;u&&(v=g.default.IDLE);var w=u?u.getPixelRatio():1;a.call(this,d,f,w,v),this.targetProj_=c,this.maxSourceExtent_=m,this.triangulation_=s,this.targetResolution_=f,this.targetExtent_=d,this.sourceImage_=u,this.sourcePixelRatio_=w,this.canvas_=null,this.sourceListenerKey_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.state==g.default.LOADING&&this.unlistenSource_(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.canvas_},b.prototype.getProjection=function(){return this.targetProj_},b.prototype.reproject_=function(){var a=this.sourceImage_.getState();if(a==g.default.LOADED){var b=(0,j.getWidth)(this.targetExtent_)/this.targetResolution_,c=(0,j.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,k.render)(b,c,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=a,this.changed()},b.prototype.load=function(){if(this.state==g.default.IDLE){this.state=g.default.LOADING,this.changed();var a=this.sourceImage_.getState();a==g.default.LOADED||a==g.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,h.listen)(this.sourceImage_,i.default.CHANGE,function(a){var b=this.sourceImage_.getState();b!=g.default.LOADED&&b!=g.default.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},b.prototype.unlistenSource_=function(){(0,h.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null},b}(f.default),n=m;c.default=n},{"../ImageBase.js":15,"../ImageState.js":17,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../reproj.js":272,"../reproj/Triangulation.js":275,"./common.js":276}],274:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=d(a("../Tile.js")),g=d(a("../TileState.js")),h=a("../events.js"),i=d(a("../events/EventType.js")),j=a("../extent.js"),k=a("../math.js"),l=a("../reproj.js"),m=d(a("../reproj/Triangulation.js")),n=function(a){function b(b,c,d,f,h,i,n,o,p,q,r){var s=this;a.call(this,h,g.default.IDLE),this.renderEdges_=void 0!==r&&r,this.pixelRatio_=n,this.gutter_=o,this.canvas_=null,this.sourceTileGrid_=c,this.targetTileGrid_=f,this.wrappedTileCoord_=i||h,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var t=f.getTileCoordExtent(this.wrappedTileCoord_),u=this.targetTileGrid_.getExtent(),v=this.sourceTileGrid_.getExtent(),w=u?(0,j.getIntersection)(t,u):t;if(0===(0,j.getArea)(w))return void(this.state=g.default.EMPTY);var x=b.getExtent();x&&(v=v?(0,j.getIntersection)(v,x):x);var y=f.getResolution(this.wrappedTileCoord_[0]),z=(0,j.getCenter)(w),A=(0,l.calculateSourceResolution)(b,d,z,y);if(!isFinite(A)||A<=0)return void(this.state=g.default.EMPTY);var B=void 0!==q?q:e.ERROR_THRESHOLD;if(this.triangulation_=new m.default(b,d,w,v,A*B),0===this.triangulation_.getTriangles().length)return void(this.state=g.default.EMPTY);this.sourceZ_=c.getZForResolution(A);var C=this.triangulation_.calculateSourceExtent();if(v&&(b.canWrapX()?(C[1]=(0,k.clamp)(C[1],v[1],v[3]),C[3]=(0,k.clamp)(C[3],v[1],v[3])):C=(0,j.getIntersection)(C,v)),(0,j.getArea)(C)){for(var D=c.getTileRangeForExtentAndZ(C,this.sourceZ_),E=D.minX;E<=D.maxX;E++)for(var F=D.minY;F<=D.maxY;F++){var G=p(s.sourceZ_,E,F,n);G&&s.sourceTiles_.push(G)}0===this.sourceTiles_.length&&(this.state=g.default.EMPTY)}else this.state=g.default.EMPTY}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.disposeInternal=function(){this.state==g.default.LOADING&&this.unlistenSources_(),a.prototype.disposeInternal.call(this)},b.prototype.getImage=function(){return this.canvas_},b.prototype.reproject_=function(){var a=[];if(this.sourceTiles_.forEach(function(b,c,d){b&&b.getState()==g.default.LOADED&&a.push({extent:this.sourceTileGrid_.getTileCoordExtent(b.tileCoord),image:b.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===a.length)this.state=g.default.ERROR;else{var b=this.wrappedTileCoord_[0],c=this.targetTileGrid_.getTileSize(b),d="number"==typeof c?c:c[0],e="number"==typeof c?c:c[1],f=this.targetTileGrid_.getResolution(b),h=this.sourceTileGrid_.getResolution(this.sourceZ_),i=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,l.render)(d,e,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),f,i,this.triangulation_,a,this.gutter_,this.renderEdges_),this.state=g.default.LOADED}this.changed()},b.prototype.load=function(){if(this.state==g.default.IDLE){this.state=g.default.LOADING,this.changed();var a=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(b,c,d){var e=b.getState();if(e==g.default.IDLE||e==g.default.LOADING){a++;var f=(0,h.listen)(b,i.default.CHANGE,function(c){var d=b.getState();d!=g.default.LOADED&&d!=g.default.ERROR&&d!=g.default.EMPTY||((0,h.unlistenByKey)(f),0===--a&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(f)}}.bind(this)),this.sourceTiles_.forEach(function(a,b,c){a.getState()==g.default.IDLE&&a.load()}),0===a&&setTimeout(this.reproject_.bind(this),0)}},b.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(h.unlistenByKey),this.sourcesListenerKeys_=null},b}(f.default),o=n;c.default=o},{"../Tile.js":35,"../TileState.js":39,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../math.js":199,"../reproj.js":272,"../reproj/Triangulation.js":275,"./common.js":276}],275:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../extent.js"),e=a("../math.js"),f=a("../proj.js"),g=10,h=.25,i=function(a,b,c,e,h){this.sourceProj_=a,this.targetProj_=b;var i={},j=(0,f.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(a){var b=a[0]+"/"+a[1];return i[b]||(i[b]=j(a)),i[b]},this.maxSourceExtent_=e,this.errorThresholdSquared_=h*h,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!e&&!!this.sourceProj_.getExtent()&&(0,d.getWidth)(e)==(0,d.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,d.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,d.getWidth)(this.targetProj_.getExtent()):null;var k=(0,d.getTopLeft)(c),l=(0,d.getTopRight)(c),m=(0,d.getBottomRight)(c),n=(0,d.getBottomLeft)(c),o=this.transformInv_(k),p=this.transformInv_(l),q=this.transformInv_(m),r=this.transformInv_(n);if(this.addQuad_(k,l,m,n,o,p,q,r,g),this.wrapsXInSource_){var s=1/0;this.triangles_.forEach(function(a,b,c){s=Math.min(s,a.source[0][0],a.source[1][0],a.source[2][0])}),this.triangles_.forEach(function(a){if(Math.max(a.source[0][0],a.source[1][0],a.source[2][0])-s>this.sourceWorldWidth_/2){var b=[[a.source[0][0],a.source[0][1]],[a.source[1][0],a.source[1][1]],[a.source[2][0],a.source[2][1]]];b[0][0]-s>this.sourceWorldWidth_/2&&(b[0][0]-=this.sourceWorldWidth_),b[1][0]-s>this.sourceWorldWidth_/2&&(b[1][0]-=this.sourceWorldWidth_),b[2][0]-s>this.sourceWorldWidth_/2&&(b[2][0]-=this.sourceWorldWidth_);var c=Math.min(b[0][0],b[1][0],b[2][0]);Math.max(b[0][0],b[1][0],b[2][0])-c<this.sourceWorldWidth_/2&&(a.source=b)}}.bind(this))}i={}};i.prototype.addTriangle_=function(a,b,c,d,e,f){this.triangles_.push({source:[d,e,f],target:[a,b,c]})},i.prototype.addQuad_=function(a,b,c,f,g,i,j,k,l){var m=(0,d.boundingExtent)([g,i,j,k]),n=this.sourceWorldWidth_?(0,d.getWidth)(m)/this.sourceWorldWidth_:null,o=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&n>.5&&n<1,q=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var r=(0,d.boundingExtent)([a,b,c,f]);q|=(0,d.getWidth)(r)/this.targetWorldWidth_>h}!p&&this.sourceProj_.isGlobal()&&n&&(q|=n>h)}if(q||!this.maxSourceExtent_||(0,d.intersects)(m,this.maxSourceExtent_)){if(!(q||isFinite(g[0])&&isFinite(g[1])&&isFinite(i[0])&&isFinite(i[1])&&isFinite(j[0])&&isFinite(j[1])&&isFinite(k[0])&&isFinite(k[1]))){if(!(l>0))return;q=!0}if(l>0){if(!q){var s,t=[(a[0]+c[0])/2,(a[1]+c[1])/2],u=this.transformInv_(t);if(p){s=((0,e.modulo)(g[0],o)+(0,e.modulo)(j[0],o))/2-(0,e.modulo)(u[0],o)}else s=(g[0]+j[0])/2-u[0];var v=(g[1]+j[1])/2-u[1];q=s*s+v*v>this.errorThresholdSquared_}if(q){if(Math.abs(a[0]-c[0])<=Math.abs(a[1]-c[1])){var w=[(b[0]+c[0])/2,(b[1]+c[1])/2],x=this.transformInv_(w),y=[(f[0]+a[0])/2,(f[1]+a[1])/2],z=this.transformInv_(y);this.addQuad_(a,b,w,y,g,i,x,z,l-1),this.addQuad_(y,w,c,f,z,x,j,k,l-1)}else{var A=[(a[0]+b[0])/2,(a[1]+b[1])/2],B=this.transformInv_(A),C=[(c[0]+f[0])/2,(c[1]+f[1])/2],D=this.transformInv_(C);this.addQuad_(a,A,C,f,g,B,D,k,l-1),this.addQuad_(A,b,c,C,B,i,j,D,l-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(a,c,f,g,j,k),this.addTriangle_(a,b,c,g,i,j)}},i.prototype.calculateSourceExtent=function(){var a=(0,d.createEmpty)();return this.triangles_.forEach(function(b,c,e){var f=b.source;(0,d.extendCoordinate)(a,f[0]),(0,d.extendCoordinate)(a,f[1]),(0,d.extendCoordinate)(a,f[2])}),a},i.prototype.getTriangles=function(){return this.triangles_};var j=i;c.default=j},{"../extent.js":72,"../math.js":199,"../proj.js":210}],276:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ENABLE_RASTER_REPROJECTION=c.ERROR_THRESHOLD=void 0,c.ERROR_THRESHOLD=.5,c.ENABLE_RASTER_REPROJECTION=!0},{}],277:[function(a,b,c){"use strict";function d(a){return function(b,c,d){if(void 0!==b){var e=(0,f.linearFindNearest)(a,b,d);e=(0,g.clamp)(e+c,0,a.length-1);var h=Math.floor(e);if(e!=h&&h<a.length-1){var i=a[h]/a[h+1];return a[h]/Math.pow(i,e-h)}return a[h]}}}function e(a,b,c){return function(d,e,f){if(void 0!==d){var g=-f/2+.5,h=Math.floor(Math.log(b/d)/Math.log(a)+g),i=Math.max(h+e,0);return void 0!==c&&(i=Math.min(i,c)),b/Math.pow(a,i)}}}Object.defineProperty(c,"__esModule",{value:!0}),c.createSnapToResolutions=d,c.createSnapToPower=e;var f=a("./array.js"),g=a("./math.js")},{"./array.js":46,"./math.js":199}],278:[function(a,b,c){"use strict";function d(a,b){return void 0!==a?0:void 0}function e(a,b){return void 0!==a?a+b:void 0}function f(a){var b=2*Math.PI/a;return function(a,c){return void 0!==a?a=Math.floor((a+c)/b+.5)*b:void 0}}function g(a){var b=a||(0,h.toRadians)(5);return function(a,c){return void 0!==a?Math.abs(a+c)<=b?0:a+c:void 0}}Object.defineProperty(c,"__esModule",{value:!0}),c.disable=d,c.none=e,c.createSnapToN=f,c.createSnapToZero=g;var h=a("./math.js")},{"./math.js":199}],279:[function(a,b,c){"use strict";function d(a,b,c){return void 0===c&&(c=[0,0]),c[0]=a[0]+2*b,c[1]=a[1]+2*b,c}function e(a){return a[0]>0&&a[1]>0}function f(a,b,c){return void 0===c&&(c=[0,0]),c[0]=a[0]*b+.5|0,c[1]=a[1]*b+.5|0,c}function g(a,b){return Array.isArray(a)?a:(void 0===b?b=[a,a]:b[0]=b[1]=a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.buffer=d,c.hasArea=e,c.scale=f,c.toSize=g},{}],280:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BingMaps",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"CartoDB",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Cluster",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"ImageArcGISRest",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"ImageCanvas",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"ImageMapGuide",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"ImageStatic",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"ImageWMS",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"OSM",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"Raster",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"Source",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(c,"Stamen",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(c,"Tile",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"TileArcGISRest",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"TileDebug",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(c,"TileImage",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(c,"TileJSON",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(c,"TileWMS",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(c,"UrlTile",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(c,"UTFGrid",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(c,"Vector",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(c,"WMTS",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(c,"XYZ",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(c,"Zoomify",{enumerable:!0,get:function(){return C.default}});var e=d(a("./source/BingMaps.js")),f=d(a("./source/CartoDB.js")),g=d(a("./source/Cluster.js")),h=d(a("./source/Image.js")),i=d(a("./source/ImageArcGISRest.js")),j=d(a("./source/ImageCanvas.js")),k=d(a("./source/ImageMapGuide.js")),l=d(a("./source/ImageStatic.js")),m=d(a("./source/ImageWMS.js")),n=d(a("./source/OSM.js")),o=d(a("./source/Raster.js")),p=d(a("./source/Source.js")),q=d(a("./source/Stamen.js")),r=d(a("./source/Tile.js")),s=d(a("./source/TileArcGISRest.js")),t=d(a("./source/TileDebug.js")),u=d(a("./source/TileImage.js")),v=d(a("./source/TileJSON.js")),w=d(a("./source/TileWMS.js")),x=d(a("./source/UrlTile.js")),y=d(a("./source/UTFGrid.js")),z=d(a("./source/Vector.js")),A=d(a("./source/WMTS.js")),B=d(a("./source/XYZ.js")),C=d(a("./source/Zoomify.js"))},{"./source/BingMaps.js":281,"./source/CartoDB.js":282,"./source/Cluster.js":283,"./source/Image.js":284,"./source/ImageArcGISRest.js":285,"./source/ImageCanvas.js":286,"./source/ImageMapGuide.js":287,"./source/ImageStatic.js":288,"./source/ImageWMS.js":289,"./source/OSM.js":290,"./source/Raster.js":291,"./source/Source.js":292,"./source/Stamen.js":293,"./source/Tile.js":295,"./source/TileArcGISRest.js":296,"./source/TileDebug.js":297,"./source/TileImage.js":299,"./source/TileJSON.js":300,"./source/TileWMS.js":301,"./source/UTFGrid.js":302,"./source/UrlTile.js":303,"./source/Vector.js":304,"./source/WMTS.js":307,"./source/XYZ.js":309,"./source/Zoomify.js":310}],281:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../tileurlfunction.js"),f=a("../extent.js"),g=a("../net.js"),h=a("../proj.js"),i=d(a("../source/State.js")),j=d(a("../source/TileImage.js")),k=a("../tilecoord.js"),l=a("../tilegrid.js"),m='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>',n=function(a){function b(b){var c=void 0!==b.hidpi&&b.hidpi;a.call(this,{cacheSize:b.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:(0,h.get)("EPSG:3857"),reprojectionErrorThreshold:b.reprojectionErrorThreshold,state:i.default.LOADING,tileLoadFunction:b.tileLoadFunction,tilePixelRatio:c?2:1,wrapX:void 0===b.wrapX||b.wrapX,transition:b.transition}),this.hidpi_=c,this.culture_=void 0!==b.culture?b.culture:"en-us",this.maxZoom_=void 0!==b.maxZoom?b.maxZoom:-1,this.apiKey_=b.key,this.imagerySet_=b.imagerySet;var d="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;(0,g.jsonp)(d,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getApiKey=function(){return this.apiKey_},b.prototype.getImagerySet=function(){return this.imagerySet_},b.prototype.handleImageryMetadataResponse=function(a){if(200!=a.statusCode||"OK"!=a.statusDescription||"ValidCredentials"!=a.authenticationResultCode||1!=a.resourceSets.length||1!=a.resourceSets[0].resources.length)return void this.setState(i.default.ERROR);var b=a.resourceSets[0].resources[0],c=-1==this.maxZoom_?b.zoomMax:this.maxZoom_,d=this.getProjection(),g=(0,l.extentFromProjection)(d),j=b.imageWidth==b.imageHeight?b.imageWidth:[b.imageWidth,b.imageHeight],n=(0,l.createXYZ)({extent:g,minZoom:b.zoomMin,maxZoom:c,tileSize:j/(this.hidpi_?2:1)});this.tileGrid=n;var o=this.culture_,p=this.hidpi_;if(this.tileUrlFunction=(0,e.createFromTileUrlFunctions)(b.imageUrlSubdomains.map(function(a){var c=[0,0,0],d=b.imageUrl.replace("{subdomain}",a).replace("{culture}",o);return function(a,b,e){if(a){(0,k.createOrUpdate)(a[0],a[1],-a[2]-1,c);var f=d;return p&&(f+="&dpi=d1&device=mobile"),f.replace("{quadkey}",(0,k.quadKey)(c))}}})),b.imageryProviders){var q=(0,h.getTransformFromProjections)((0,h.get)("EPSG:4326"),this.getProjection());this.setAttributions(function(a){var c=[],d=a.viewState.zoom;return b.imageryProviders.map(function(b){for(var e=!1,g=b.coverageAreas,h=0,i=g.length;h<i;++h){var j=g[h];if(d>=j.zoomMin&&d<=j.zoomMax){var k=j.bbox,l=[k[1],k[0],k[3],k[2]],m=(0,f.applyTransform)(l,q);if((0,f.intersects)(m,a.extent)){e=!0;break}}}e&&c.push(b.attribution)}),c.push(m),c})}this.setState(i.default.READY)},b}(j.default),o=n;c.default=o},{"../extent.js":72,"../net.js":200,"../proj.js":210,"../source/State.js":294,"../source/TileImage.js":299,"../tilecoord.js":334,"../tilegrid.js":335,"../tileurlfunction.js":339}],282:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../obj.js"),f=d(a("../source/State.js")),g=d(a("../source/XYZ.js")),h=function(a){function b(b){a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,crossOrigin:b.crossOrigin,maxZoom:void 0!==b.maxZoom?b.maxZoom:18,minZoom:b.minZoom,projection:b.projection,state:f.default.LOADING,wrapX:b.wrapX}),this.account_=b.account,this.mapId_=b.map||"",this.config_=b.config||{},this.templateCache_={},this.initializeMap_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getConfig=function(){return this.config_},b.prototype.updateConfig=function(a){(0,e.assign)(this.config_,a),this.initializeMap_()},b.prototype.setConfig=function(a){this.config_=a||{},this.initializeMap_()},b.prototype.initializeMap_=function(){var a=JSON.stringify(this.config_);if(this.templateCache_[a])return void this.applyTemplate_(this.templateCache_[a]);var b="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(b+="/named/"+this.mapId_);var c=new XMLHttpRequest;c.addEventListener("load",this.handleInitResponse_.bind(this,a)),c.addEventListener("error",this.handleInitError_.bind(this)),c.open("POST",b),c.setRequestHeader("Content-type","application/json"),c.send(JSON.stringify(this.config_))},b.prototype.handleInitResponse_=function(a,b){var c=b.target;if(!c.status||c.status>=200&&c.status<300){var d;try{d=JSON.parse(c.responseText)}catch(a){return void this.setState(f.default.ERROR)}this.applyTemplate_(d),this.templateCache_[a]=d,this.setState(f.default.READY)}else this.setState(f.default.ERROR)},b.prototype.handleInitError_=function(a){this.setState(f.default.ERROR)},b.prototype.applyTemplate_=function(a){var b="https://"+a.cdn_url.https+"/"+this.account_+"/api/v1/map/"+a.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(b)},b}(g.default),i=h;c.default=i},{"../obj.js":201,"../source/State.js":294,"../source/XYZ.js":309}],283:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=a("../asserts.js"),g=d(a("../Feature.js")),h=a("../coordinate.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../extent.js"),l=d(a("../geom/Point.js")),m=d(a("../source/Vector.js")),n=function(a){function b(b){a.call(this,{attributions:b.attributions,extent:b.extent,projection:b.projection,wrapX:b.wrapX}),this.resolution=void 0,this.distance=void 0!==b.distance?b.distance:20,this.features=[],this.geometryFunction=b.geometryFunction||function(a){var b=a.getGeometry();return(0,f.assert)(b instanceof l.default,10),b},this.source=b.source,(0,i.listen)(this.source,j.default.CHANGE,this.refresh,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDistance=function(){return this.distance},b.prototype.getSource=function(){return this.source},b.prototype.loadFeatures=function(a,b,c){this.source.loadFeatures(a,b,c),b!==this.resolution&&(this.clear(),this.resolution=b,this.cluster(),this.addFeatures(this.features))},b.prototype.setDistance=function(a){this.distance=a,this.refresh()},b.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features),a.prototype.refresh.call(this)},b.prototype.cluster=function(){var a=this;if(void 0!==this.resolution){this.features.length=0;for(var b=(0,k.createEmpty)(),c=this.distance*this.resolution,d=this.source.getFeatures(),f={},g=0,h=d.length;g<h;g++){var i=d[g];if(!((0,e.getUid)(i).toString()in f)){var j=a.geometryFunction(i);if(j){var l=j.getCoordinates();(0,k.createOrUpdateFromCoordinate)(l,b),(0,k.buffer)(b,c,b);var m=a.source.getFeaturesInExtent(b);m=m.filter(function(a){var b=(0,e.getUid)(a).toString();return!(b in f)&&(f[b]=!0,!0)}),a.features.push(a.createCluster(m))}}}}},b.prototype.createCluster=function(a){for(var b=this,c=[0,0],d=a.length-1;d>=0;--d){var e=b.geometryFunction(a[d]);e?(0,h.add)(c,e.getCoordinates()):a.splice(d,1)}(0,h.scale)(c,1/a.length);var f=new g.default(new l.default(c));return f.set("features",a),f},b}(m.default),o=n;c.default=o},{"../Feature.js":10,"../asserts.js":47,"../coordinate.js":62,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../geom/Point.js":138,"../source/Vector.js":304,"../util.js":342}],284:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){a.getImage().src=b}Object.defineProperty(c,"__esModule",{value:!0}),c.defaultImageLoadFunction=e,c.default=void 0;var f=a("../reproj/common.js"),g=d(a("../ImageState.js")),h=a("../array.js"),i=d(a("../events/Event.js")),j=a("../extent.js"),k=a("../proj.js"),l=d(a("../reproj/Image.js")),m=d(a("../source/Source.js")),n={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},o=function(a){function b(b,c){a.call(this,b),this.image=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(i.default),p=function(a){function b(b){a.call(this,{attributions:b.attributions,extent:b.extent,projection:b.projection,state:b.state}),this.resolutions_=void 0!==b.resolutions?b.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getResolutions=function(){return this.resolutions_},b.prototype.findNearestResolution=function(a){if(this.resolutions_){var b=(0,h.linearFindNearest)(this.resolutions_,a,0);a=this.resolutions_[b]}return a},b.prototype.getImage=function(a,b,c,d){var e=this.getProjection();if(f.ENABLE_RASTER_REPROJECTION&&e&&d&&!(0,k.equivalent)(e,d)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,k.equivalent)(this.reprojectedImage_.getProjection(),d)&&this.reprojectedImage_.getResolution()==b&&(0,j.equals)(this.reprojectedImage_.getExtent(),a))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new l.default(e,d,a,b,c,function(a,b,c){return this.getImageInternal(a,b,c,e)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return e&&(d=e),this.getImageInternal(a,b,c,d)},b.prototype.getImageInternal=function(a,b,c,d){},b.prototype.handleImageChange=function(a){var b=a.target;switch(b.getState()){case g.default.LOADING:this.loading=!0,this.dispatchEvent(new o(n.IMAGELOADSTART,b));break;case g.default.LOADED:this.loading=!1,this.dispatchEvent(new o(n.IMAGELOADEND,b));break;case g.default.ERROR:this.loading=!1,this.dispatchEvent(new o(n.IMAGELOADERROR,b))}},b}(m.default),q=p;c.default=q},{"../ImageState.js":17,"../array.js":46,"../events/Event.js":67,"../extent.js":72,"../proj.js":210,"../reproj/Image.js":273,"../reproj/common.js":276,"../source/Source.js":292}],285:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("../Image.js")),g=a("../asserts.js"),h=a("../events.js"),i=e(a("../events/EventType.js")),j=a("../extent.js"),k=a("../obj.js"),l=d(a("../source/Image.js")),m=a("../uri.js"),n=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,projection:c.projection,resolutions:c.resolutions}),this.crossOrigin_=void 0!==c.crossOrigin?c.crossOrigin:null,this.hidpi_=void 0===c.hidpi||c.hidpi,this.url_=c.url,this.imageLoadFunction_=void 0!==c.imageLoadFunction?c.imageLoadFunction:l.defaultImageLoadFunction,this.params_=c.params||{},this.image_=null,
this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==c.ratio?c.ratio:1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getParams=function(){return this.params_},b.prototype.getImageInternal=function(a,b,c,d){if(void 0===this.url_)return null;b=this.findNearestResolution(b),c=this.hidpi_?c:1;var e=this.image_;if(e&&this.renderedRevision_==this.getRevision()&&e.getResolution()==b&&e.getPixelRatio()==c&&(0,j.containsExtent)(e.getExtent(),a))return e;var g={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};(0,k.assign)(g,this.params_),a=a.slice();var l=(a[0]+a[2])/2,m=(a[1]+a[3])/2;if(1!=this.ratio_){var n=this.ratio_*(0,j.getWidth)(a)/2,o=this.ratio_*(0,j.getHeight)(a)/2;a[0]=l-n,a[1]=m-o,a[2]=l+n,a[3]=m+o}var p=b/c,q=Math.ceil((0,j.getWidth)(a)/p),r=Math.ceil((0,j.getHeight)(a)/p);a[0]=l-p*q/2,a[2]=l+p*q/2,a[1]=m-p*r/2,a[3]=m+p*r/2,this.imageSize_[0]=q,this.imageSize_[1]=r;var s=this.getRequestUrl_(a,this.imageSize_,c,d,g);return this.image_=new f.default(a,b,c,s,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),(0,h.listen)(this.image_,i.default.CHANGE,this.handleImageChange,this),this.image_},b.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},b.prototype.getRequestUrl_=function(a,b,c,d,e){var f=d.getCode().split(":").pop();e.SIZE=b[0]+","+b[1],e.BBOX=a.join(","),e.BBOXSR=f,e.IMAGESR=f,e.DPI=Math.round(90*c);var h=this.url_,i=h.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return i==h&&(0,g.assert)(!1,50),(0,m.appendParams)(i,e)},b.prototype.getUrl=function(){return this.url_},b.prototype.setImageLoadFunction=function(a){this.image_=null,this.imageLoadFunction_=a,this.changed()},b.prototype.setUrl=function(a){a!=this.url_&&(this.url_=a,this.image_=null,this.changed())},b.prototype.updateParams=function(a){(0,k.assign)(this.params_,a),this.image_=null,this.changed()},b}(l.default),o=n;c.default=o},{"../Image.js":14,"../asserts.js":47,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../obj.js":201,"../source/Image.js":284,"../uri.js":341}],286:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../ImageCanvas.js")),f=a("../extent.js"),g=d(a("../source/Image.js")),h=function(a){function b(b){a.call(this,{attributions:b.attributions,projection:b.projection,resolutions:b.resolutions,state:b.state}),this.canvasFunction_=b.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==b.ratio?b.ratio:1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImageInternal=function(a,b,c,d){b=this.findNearestResolution(b);var g=this.canvas_;if(g&&this.renderedRevision_==this.getRevision()&&g.getResolution()==b&&g.getPixelRatio()==c&&(0,f.containsExtent)(g.getExtent(),a))return g;a=a.slice(),(0,f.scaleFromCenter)(a,this.ratio_);var h=(0,f.getWidth)(a)/b,i=(0,f.getHeight)(a)/b,j=[h*c,i*c],k=this.canvasFunction_(a,b,c,j,d);return k&&(g=new e.default(a,b,c,k)),this.canvas_=g,this.renderedRevision_=this.getRevision(),g},b}(g.default),i=h;c.default=i},{"../ImageCanvas.js":16,"../extent.js":72,"../source/Image.js":284}],287:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b,c,d){var e=(0,j.getWidth)(a),f=(0,j.getHeight)(a),g=b[0],h=b[1],i=.0254/d;return h*e>g*f?e*c/(g*i):f*c/(h*i)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=e(a("../Image.js")),h=a("../events.js"),i=e(a("../events/EventType.js")),j=a("../extent.js"),k=a("../obj.js"),l=d(a("../source/Image.js")),m=a("../uri.js"),n=function(a){function b(b){a.call(this,{projection:b.projection,resolutions:b.resolutions}),this.crossOrigin_=void 0!==b.crossOrigin?b.crossOrigin:null,this.displayDpi_=void 0!==b.displayDpi?b.displayDpi:96,this.params_=b.params||{},this.url_=b.url,this.imageLoadFunction_=void 0!==b.imageLoadFunction?b.imageLoadFunction:l.defaultImageLoadFunction,this.hidpi_=void 0===b.hidpi||b.hidpi,this.metersPerUnit_=void 0!==b.metersPerUnit?b.metersPerUnit:1,this.ratio_=void 0!==b.ratio?b.ratio:1,this.useOverlay_=void 0!==b.useOverlay&&b.useOverlay,this.image_=null,this.renderedRevision_=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getParams=function(){return this.params_},b.prototype.getImageInternal=function(a,b,c,d){b=this.findNearestResolution(b),c=this.hidpi_?c:1;var e=this.image_;if(e&&this.renderedRevision_==this.getRevision()&&e.getResolution()==b&&e.getPixelRatio()==c&&(0,j.containsExtent)(e.getExtent(),a))return e;1!=this.ratio_&&(a=a.slice(),(0,j.scaleFromCenter)(a,this.ratio_));var f=(0,j.getWidth)(a)/b,k=(0,j.getHeight)(a)/b,l=[f*c,k*c];if(void 0!==this.url_){var m=this.getUrl(this.url_,this.params_,a,l,d);e=new g.default(a,b,c,m,this.crossOrigin_,this.imageLoadFunction_),(0,h.listen)(e,i.default.CHANGE,this.handleImageChange,this)}else e=null;return this.image_=e,this.renderedRevision_=this.getRevision(),e},b.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},b.prototype.updateParams=function(a){(0,k.assign)(this.params_,a),this.changed()},b.prototype.getUrl=function(a,b,c,d,e){var g=f(c,d,this.metersPerUnit_,this.displayDpi_),h=(0,j.getCenter)(c),i={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(d[0]),SETDISPLAYHEIGHT:Math.round(d[1]),SETVIEWSCALE:g,SETVIEWCENTERX:h[0],SETVIEWCENTERY:h[1]};return(0,k.assign)(i,b),(0,m.appendParams)(a,i)},b.prototype.setImageLoadFunction=function(a){this.image_=null,this.imageLoadFunction_=a,this.changed()},b}(l.default),o=n;c.default=o},{"../Image.js":14,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../obj.js":201,"../source/Image.js":284,"../uri.js":341}],288:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=e(a("../Image.js")),g=e(a("../ImageState.js")),h=a("../dom.js"),i=a("../events.js"),j=e(a("../events/EventType.js")),k=a("../extent.js"),l=a("../proj.js"),m=d(a("../source/Image.js")),n=function(a){function b(b){var c=void 0!==b.crossOrigin?b.crossOrigin:null,d=void 0!==b.imageLoadFunction?b.imageLoadFunction:m.defaultImageLoadFunction;a.call(this,{attributions:b.attributions,projection:(0,l.get)(b.projection)}),this.url_=b.url,this.imageExtent_=b.imageExtent,this.image_=new f.default(this.imageExtent_,void 0,1,this.url_,c,d),this.imageSize_=b.imageSize?b.imageSize:null,(0,i.listen)(this.image_,j.default.CHANGE,this.handleImageChange,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImageExtent=function(){return this.imageExtent_},b.prototype.getImageInternal=function(a,b,c,d){return(0,k.intersects)(a,this.image_.getExtent())?this.image_:null},b.prototype.getUrl=function(){return this.url_},b.prototype.handleImageChange=function(b){if(this.image_.getState()==g.default.LOADED){var c,d,e=this.image_.getExtent(),f=this.image_.getImage();this.imageSize_?(c=this.imageSize_[0],d=this.imageSize_[1]):(c=f.width,d=f.height);var i=(0,k.getHeight)(e)/d,j=Math.ceil((0,k.getWidth)(e)/i);if(j!=c){var l=(0,h.createCanvasContext2D)(j,d),m=l.canvas;l.drawImage(f,0,0,c,d,0,0,m.width,m.height),this.image_.setImage(m)}}a.prototype.handleImageChange.call(this,b)},b}(m.default),o=n;c.default=o},{"../Image.js":14,"../ImageState.js":17,"../dom.js":64,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../proj.js":210,"../source/Image.js":284}],289:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("./common.js"),g=e(a("../Image.js")),h=a("../asserts.js"),i=a("../events.js"),j=e(a("../events/EventType.js")),k=a("../extent.js"),l=a("../obj.js"),m=a("../proj.js"),n=a("../reproj.js"),o=d(a("../source/Image.js")),p=e(a("../source/WMSServerType.js")),q=a("../string.js"),r=a("../uri.js"),s=[101,101],t=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,projection:c.projection,resolutions:c.resolutions}),this.crossOrigin_=void 0!==c.crossOrigin?c.crossOrigin:null,this.url_=c.url,this.imageLoadFunction_=void 0!==c.imageLoadFunction?c.imageLoadFunction:o.defaultImageLoadFunction,this.params_=c.params||{},this.v13_=!0,this.updateV13_(),this.serverType_=c.serverType,this.hidpi_=void 0===c.hidpi||c.hidpi,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==c.ratio?c.ratio:1.5}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getGetFeatureInfoUrl=function(a,b,c,d){if(void 0!==this.url_){var e=(0,m.get)(c),g=this.getProjection();g&&g!==e&&(b=(0,n.calculateSourceResolution)(g,e,a,b),a=(0,m.transform)(a,e,g));var h=(0,k.getForViewAndSize)(a,b,0,s),i={SERVICE:"WMS",VERSION:f.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};(0,l.assign)(i,this.params_,d);var j=Math.floor((a[0]-h[0])/b),o=Math.floor((h[3]-a[1])/b);return i[this.v13_?"I":"X"]=j,i[this.v13_?"J":"Y"]=o,this.getRequestUrl_(h,s,1,g||e,i)}},b.prototype.getParams=function(){return this.params_},b.prototype.getImageInternal=function(a,b,c,d){if(void 0===this.url_)return null;b=this.findNearestResolution(b),1==c||this.hidpi_&&void 0!==this.serverType_||(c=1);var e=b/c,h=(0,k.getCenter)(a),m=Math.ceil((0,k.getWidth)(a)/e),n=Math.ceil((0,k.getHeight)(a)/e),o=(0,k.getForViewAndSize)(h,e,0,[m,n]),p=Math.ceil(this.ratio_*(0,k.getWidth)(a)/e),q=Math.ceil(this.ratio_*(0,k.getHeight)(a)/e),r=(0,k.getForViewAndSize)(h,e,0,[p,q]),s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==b&&s.getPixelRatio()==c&&(0,k.containsExtent)(s.getExtent(),o))return s;var t={SERVICE:"WMS",VERSION:f.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};(0,l.assign)(t,this.params_),this.imageSize_[0]=Math.round((0,k.getWidth)(r)/e),this.imageSize_[1]=Math.round((0,k.getHeight)(r)/e);var u=this.getRequestUrl_(r,this.imageSize_,c,d,t);return this.image_=new g.default(r,b,c,u,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),(0,i.listen)(this.image_,j.default.CHANGE,this.handleImageChange,this),this.image_},b.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},b.prototype.getRequestUrl_=function(a,b,c,d,e){if((0,h.assert)(void 0!==this.url_,9),e[this.v13_?"CRS":"SRS"]=d.getCode(),"STYLES"in this.params_||(e.STYLES=""),1!=c)switch(this.serverType_){case p.default.GEOSERVER:var f=90*c+.5|0;"FORMAT_OPTIONS"in e?e.FORMAT_OPTIONS+=";dpi:"+f:e.FORMAT_OPTIONS="dpi:"+f;break;case p.default.MAPSERVER:e.MAP_RESOLUTION=90*c;break;case p.default.CARMENTA_SERVER:case p.default.QGIS:e.DPI=90*c;break;default:(0,h.assert)(!1,8)}e.WIDTH=b[0],e.HEIGHT=b[1];var g,i=d.getAxisOrientation();return g=this.v13_&&"ne"==i.substr(0,2)?[a[1],a[0],a[3],a[2]]:a,e.BBOX=g.join(","),(0,r.appendParams)(this.url_,e)},b.prototype.getUrl=function(){return this.url_},b.prototype.setImageLoadFunction=function(a){this.image_=null,this.imageLoadFunction_=a,this.changed()},b.prototype.setUrl=function(a){a!=this.url_&&(this.url_=a,this.image_=null,this.changed())},b.prototype.updateParams=function(a){(0,l.assign)(this.params_,a),this.updateV13_(),this.image_=null,this.changed()},b.prototype.updateV13_=function(){var a=this.params_.VERSION||f.DEFAULT_WMS_VERSION;this.v13_=(0,q.compareVersions)(a,"1.3")>=0},b}(o.default),u=t;c.default=u},{"../Image.js":14,"../asserts.js":47,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../obj.js":201,"../proj.js":210,"../reproj.js":272,"../source/Image.js":284,"../source/WMSServerType.js":306,"../string.js":313,"../uri.js":341,"./common.js":311}],290:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.ATTRIBUTION=void 0;var e=d(a("../source/XYZ.js")),f='&#169; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';c.ATTRIBUTION=f;var g=function(a){function b(b){var c,d=b||{};c=void 0!==d.attributions?d.attributions:[f];var e=void 0!==d.crossOrigin?d.crossOrigin:"anonymous",g=void 0!==d.url?d.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";a.call(this,{attributions:c,cacheSize:d.cacheSize,crossOrigin:e,opaque:void 0===d.opaque||d.opaque,maxZoom:void 0!==d.maxZoom?d.maxZoom:19,reprojectionErrorThreshold:d.reprojectionErrorThreshold,tileLoadFunction:d.tileLoadFunction,url:g,wrapX:d.wrapX})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),h=g;c.default=h},{"../source/XYZ.js":309}],291:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){if(!a.prepareFrame(b,c))return null;var d=b.size[0],e=b.size[1];if(I){var f=I.canvas;f.width!==d||f.height!==e?I=(0,n.createCanvasContext2D)(d,e):I.clearRect(0,0,d,e)}else I=(0,n.createCanvasContext2D)(d,e);return a.composeFrame(b,c,I),I.getImageData(0,0,d,e)}function f(a){return a.map(function(a){return a.getLayer().getLayerState()})}function g(a){for(var b=a.length,c=new Array(b),d=0;d<b;++d)c[d]=h(a[d]);return c}function h(a){var b=null;return a instanceof C.default?b=j(a):a instanceof A.default?b=i(a):a instanceof w.default?b=new z.default(a):a instanceof u.default&&(a.getType()==t.default.IMAGE||a.getType()==t.default.VECTOR)&&(b=new y.default(a)),b}function i(a){var b=new v.default({source:a});return new y.default(b)}function j(a){var b=new w.default({source:a});return new z.default(b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var k=a("../util.js"),l=d(a("../ImageCanvas.js")),m=d(a("../TileQueue.js")),n=a("../dom.js"),o=a("../events.js"),p=d(a("../events/Event.js")),q=d(a("../events/EventType.js")),r=a("pixelworks/lib/index"),s=a("../extent.js"),t=d(a("../LayerType.js")),u=d(a("../layer/Layer.js")),v=d(a("../layer/Image.js")),w=d(a("../layer/Tile.js")),x=a("../obj.js"),y=d(a("../renderer/canvas/ImageLayer.js")),z=d(a("../renderer/canvas/TileLayer.js")),A=d(a("../source/Image.js")),B=d(a("../source/State.js")),C=d(a("../source/Tile.js")),D=a("../transform.js"),E={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"},F={PIXEL:"pixel",IMAGE:"image"},G=function(a){function b(b,c,d){a.call(this,b),this.extent=c.extent,this.resolution=c.viewState.resolution/c.pixelRatio,this.data=d}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(p.default),H=function(a){function b(b){var c=this;a.call(this,{}),this.worker_=null,this.operationType_=void 0!==b.operationType?b.operationType:F.PIXEL,this.threads_=void 0!==b.threads?b.threads:1,this.renderers_=g(b.sources);for(var d=0,e=this.renderers_.length;d<e;++d)(0,o.listen)(c.renderers_[d],q.default.CHANGE,c.changed,c);this.tileQueue_=new m.default(function(){return 1},this.changed.bind(this));for(var h=f(this.renderers_),i={},j=0,l=h.length;j<l;++j)i[(0,k.getUid)(h[j].layer)]=h[j];this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:(0,D.create)(),extent:null,focus:null,index:0,layerStates:i,layerStatesArray:h,pixelRatio:1,pixelToCoordinateTransform:(0,D.create)(),postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}},void 0!==b.operation&&this.setOperation(b.operation,b.lib)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setOperation=function(a,b){this.worker_=new r.Processor({operation:a,imageOps:this.operationType_===F.IMAGE,queue:1,lib:b,threads:this.threads_}),this.changed()},b.prototype.updateFrameState_=function(a,b,c){var d=(0,x.assign)({},this.frameState_);d.viewState=(0,x.assign)({},d.viewState);var e=(0,s.getCenter)(a);d.extent=a.slice(),d.focus=e,d.size[0]=Math.round((0,s.getWidth)(a)/b),d.size[1]=Math.round((0,s.getHeight)(a)/b),d.time=Date.now(),d.animate=!1;var f=d.viewState;return f.center=e,f.projection=c,f.resolution=b,d},b.prototype.allSourcesReady_=function(){for(var a,b=this,c=!0,d=0,e=this.renderers_.length;d<e;++d)if(a=b.renderers_[d].getLayer().getSource(),a.getState()!==B.default.READY){c=!1;break}return c},b.prototype.getImage=function(a,b,c,d){if(!this.allSourcesReady_())return null;var e=this.updateFrameState_(a,b,d);if(this.requestedFrameState_=e,this.renderedImageCanvas_){var f=this.renderedImageCanvas_.getResolution(),g=this.renderedImageCanvas_.getExtent();b===f&&(0,s.equals)(a,g)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),e.tileQueue.loadMoreTiles(16,16),e.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},b.prototype.processSources_=function(){for(var a=this,b=this.requestedFrameState_,c=this.renderers_.length,d=new Array(c),f=0;f<c;++f){var g=e(a.renderers_[f],b,b.layerStatesArray[f]);if(!g)return;d[f]=g}var h={};this.dispatchEvent(new G(E.BEFOREOPERATIONS,b,h)),this.worker_.process(d,h,this.onWorkerComplete_.bind(this,b))},b.prototype.onWorkerComplete_=function(a,b,c,d){if(!b&&c){var e=a.extent,f=a.viewState.resolution;if(f===this.requestedFrameState_.viewState.resolution&&(0,s.equals)(e,this.requestedFrameState_.extent)){var g;if(this.renderedImageCanvas_)g=this.renderedImageCanvas_.getImage().getContext("2d");else{var h=Math.round((0,s.getWidth)(e)/f),i=Math.round((0,s.getHeight)(e)/f);g=(0,n.createCanvasContext2D)(h,i),this.renderedImageCanvas_=new l.default(e,f,1,g.canvas)}g.putImageData(c,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new G(E.AFTEROPERATIONS,a,d))}}},b.prototype.getImageInternal=function(){return null},b}(A.default),I=null,J=H;c.default=J},{"../ImageCanvas.js":16,"../LayerType.js":20,"../TileQueue.js":37,"../dom.js":64,"../events.js":66,"../events/Event.js":67,"../events/EventType.js":68,"../extent.js":72,"../layer/Image.js":189,"../layer/Layer.js":190,"../layer/Tile.js":192,"../obj.js":201,"../renderer/canvas/ImageLayer.js":255,"../renderer/canvas/TileLayer.js":259,"../source/Image.js":284,"../source/State.js":294,"../source/Tile.js":295,"../transform.js":340,"../util.js":342,"pixelworks/lib/index":353}],292:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../functions.js"),f=d(a("../Object.js")),g=a("../proj.js"),h=d(a("../source/State.js")),i=function(a){function b(b){a.call(this),this.projection_=(0,g.get)(b.projection),this.attributions_=this.adaptAttributions_(b.attributions),this.loading=!1,this.state_=void 0!==b.state?b.state:h.default.READY,this.wrapX_=void 0!==b.wrapX&&b.wrapX}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.adaptAttributions_=function(a){return a?Array.isArray(a)?function(b){return a}:"function"==typeof a?a:function(b){return[a]}:null},b.prototype.getAttributions=function(){return this.attributions_},b.prototype.getProjection=function(){return this.projection_},b.prototype.getResolutions=function(){},b.prototype.getState=function(){return this.state_},b.prototype.getWrapX=function(){return this.wrapX_},b.prototype.refresh=function(){this.changed()},b.prototype.setAttributions=function(a){this.attributions_=this.adaptAttributions_(a),this.changed()},b.prototype.setState=function(a){this.state_=a,this.changed()},b}(f.default);i.prototype.forEachFeatureAtCoordinate=e.VOID;var j=i;c.default=j},{"../Object.js":29,"../functions.js":126,"../proj.js":210,"../source/State.js":294}],293:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../source/OSM.js"),f=d(a("../source/XYZ.js")),g=['Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',e.ATTRIBUTION],h={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},i={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}},j=function(a){function b(b){var c=b.layer.indexOf("-"),d=-1==c?b.layer:b.layer.slice(0,c),e=i[d],f=h[b.layer],j=void 0!==b.url?b.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+b.layer+"/{z}/{x}/{y}."+f.extension;a.call(this,{attributions:g,cacheSize:b.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=b.maxZoom?b.maxZoom:e.maxZoom,minZoom:void 0!=b.minZoom?b.minZoom:e.minZoom,opaque:f.opaque,reprojectionErrorThreshold:b.reprojectionErrorThreshold,tileLoadFunction:b.tileLoadFunction,url:j,wrapX:b.wrapX})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(f.default),k=j;c.default=k},{"../source/OSM.js":290,"../source/XYZ.js":309}],294:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};c.default=d},{}],295:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.TileSourceEvent=void 0;var e=a("../functions.js"),f=d(a("../TileCache.js")),g=d(a("../TileState.js")),h=d(a("../events/Event.js")),i=a("../proj.js"),j=a("../size.js"),k=d(a("../source/Source.js")),l=a("../tilecoord.js"),m=a("../tilegrid.js"),n=function(a){function b(b){a.call(this,{attributions:b.attributions,extent:b.extent,projection:b.projection,state:b.state,wrapX:b.wrapX}),this.opaque_=void 0!==b.opaque&&b.opaque,this.tilePixelRatio_=void 0!==b.tilePixelRatio?b.tilePixelRatio:1,this.tileGrid=void 0!==b.tileGrid?b.tileGrid:null,this.tileCache=new f.default(b.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:b.transition}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},b.prototype.expireCache=function(a,b){var c=this.getTileCacheForProjection(a);c&&c.expireCache(b)},b.prototype.forEachLoadedTile=function(a,b,c,d){var e=this.getTileCacheForProjection(a);if(!e)return!1;for(var f,h,i,j=!0,k=c.minX;k<=c.maxX;++k)for(var m=c.minY;m<=c.maxY;++m)h=(0,l.getKeyZXY)(b,k,m),i=!1,e.containsKey(h)&&(f=e.get(h),(i=f.getState()===g.default.LOADED)&&(i=!1!==d(f))),i||(j=!1);return j},b.prototype.getGutterForProjection=function(a){return 0},b.prototype.getKey=function(){return this.key_},b.prototype.setKey=function(a){this.key_!==a&&(this.key_=a,this.changed())},b.prototype.getOpaque=function(a){return this.opaque_},b.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},b.prototype.getTile=function(a,b,c,d,e){},b.prototype.getTileGrid=function(){return this.tileGrid},b.prototype.getTileGridForProjection=function(a){return this.tileGrid?this.tileGrid:(0,m.getForProjection)(a)},b.prototype.getTileCacheForProjection=function(a){var b=this.getProjection();return b&&!(0,i.equivalent)(b,a)?null:this.tileCache},b.prototype.getTilePixelRatio=function(a){return this.tilePixelRatio_},b.prototype.getTilePixelSize=function(a,b,c){var d=this.getTileGridForProjection(c),e=this.getTilePixelRatio(b),f=(0,j.toSize)(d.getTileSize(a),this.tmpSize);return 1==e?f:(0,j.scale)(f,e,this.tmpSize)},b.prototype.getTileCoordForTileUrlFunction=function(a,b){var c=void 0!==b?b:this.getProjection(),d=this.getTileGridForProjection(c);return this.getWrapX()&&c.isGlobal()&&(a=(0,m.wrapX)(d,a,c)),(0,l.withinExtentAndZ)(a,d)?a:null},b.prototype.refresh=function(){this.tileCache.clear(),this.changed()},b}(k.default);n.prototype.useTile=e.VOID;var o=function(a){function b(b,c){a.call(this,b),this.tile=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(h.default);c.TileSourceEvent=o;var p=n;c.default=p},{"../TileCache.js":36,"../TileState.js":39,"../events/Event.js":67,"../functions.js":126,"../proj.js":210,"../size.js":279,"../source/Source.js":292,"../tilecoord.js":334,"../tilegrid.js":335}],296:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../extent.js"),f=a("../math.js"),g=a("../obj.js"),h=a("../size.js"),i=d(a("../source/TileImage.js")),j=a("../tilecoord.js"),k=a("../uri.js"),l=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,cacheSize:c.cacheSize,crossOrigin:c.crossOrigin,projection:c.projection,reprojectionErrorThreshold:c.reprojectionErrorThreshold,tileGrid:c.tileGrid,tileLoadFunction:c.tileLoadFunction,url:c.url,urls:c.urls,wrapX:void 0===c.wrapX||c.wrapX,transition:c.transition}),this.params_=c.params||{},this.tmpExtent_=(0,e.createEmpty)(),this.setKey(this.getKeyForParams_())}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getKeyForParams_=function(){var a=this,b=0,c=[];for(var d in a.params_)c[b++]=d+"-"+a.params_[d];return c.join("/")},b.prototype.getParams=function(){return this.params_},b.prototype.getRequestUrl_=function(a,b,c,d,e,g){var h=this.urls;if(h){var i=e.getCode().split(":").pop();g.SIZE=b[0]+","+b[1],g.BBOX=c.join(","),g.BBOXSR=i,g.IMAGESR=i,g.DPI=Math.round(g.DPI?g.DPI*d:90*d);var l;if(1==h.length)l=h[0];else{l=h[(0,f.modulo)((0,j.hash)(a),h.length)]}var m=l.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return(0,k.appendParams)(m,g)}},b.prototype.getTilePixelRatio=function(a){return a},b.prototype.fixedTileUrlFunction=function(a,b,c){var d=this.getTileGrid();if(d||(d=this.getTileGridForProjection(c)),!(d.getResolutions().length<=a[0])){var e=d.getTileCoordExtent(a,this.tmpExtent_),f=(0,h.toSize)(d.getTileSize(a[0]),this.tmpSize);1!=b&&(f=(0,h.scale)(f,b,this.tmpSize));var i={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return(0,g.assign)(i,this.params_),this.getRequestUrl_(a,f,e,b,c,i)}},b.prototype.updateParams=function(a){(0,g.assign)(this.params_,a),this.setKey(this.getKeyForParams_())},b}(i.default),m=l;c.default=m},{"../extent.js":72,"../math.js":199,"../obj.js":201,"../size.js":279,"../source/TileImage.js":299,"../tilecoord.js":334,"../uri.js":341}],297:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../Tile.js")),f=d(a("../TileState.js")),g=a("../dom.js"),h=a("../size.js"),i=d(a("../source/Tile.js")),j=a("../tilecoord.js"),k=function(a){function b(b,c,d){a.call(this,b,f.default.LOADED),this.tileSize_=c,this.text_=d,this.canvas_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var a=this.tileSize_,b=(0,g.createCanvasContext2D)(a[0],a[1]);return b.strokeStyle="black",b.strokeRect(.5,.5,a[0]+.5,a[1]+.5),b.fillStyle="black",b.textAlign="center",b.textBaseline="middle",b.font="24px sans-serif",b.fillText(this.text_,a[0]/2,a[1]/2),this.canvas_=b.canvas,b.canvas},b.prototype.load=function(){},b}(e.default),l=function(a){function b(b){a.call(this,{opaque:!1,projection:b.projection,tileGrid:b.tileGrid,wrapX:void 0===b.wrapX||b.wrapX})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getTile=function(a,b,c){var d=(0,j.getKeyZXY)(a,b,c);if(this.tileCache.containsKey(d))return this.tileCache.get(d);var e=(0,h.toSize)(this.tileGrid.getTileSize(a)),f=[a,b,c],g=this.getTileCoordForTileUrlFunction(f),i=g?this.getTileCoordForTileUrlFunction(g).toString():"",l=new k(f,e,i);return this.tileCache.set(d,l),l},b}(i.default),m=l;c.default=m},{"../Tile.js":35,"../TileState.js":39,"../dom.js":64,"../size.js":279,"../source/Tile.js":295,"../tilecoord.js":334}],298:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};c.default=d},{}],299:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){a.getImage().src=b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../reproj/common.js"),g=a("../util.js"),h=d(a("../ImageTile.js")),i=d(a("../TileCache.js")),j=d(a("../TileState.js")),k=a("../events.js"),l=d(a("../events/EventType.js")),m=a("../proj.js"),n=d(a("../reproj/Tile.js")),o=d(a("../source/UrlTile.js")),p=a("../tilecoord.js"),q=a("../tilegrid.js"),r=function(a){function b(b){a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,extent:b.extent,opaque:b.opaque,projection:b.projection,state:b.state,tileGrid:b.tileGrid,tileLoadFunction:b.tileLoadFunction?b.tileLoadFunction:e,tilePixelRatio:b.tilePixelRatio,tileUrlFunction:b.tileUrlFunction,url:b.url,urls:b.urls,wrapX:b.wrapX,transition:b.transition}),this.crossOrigin=void 0!==b.crossOrigin?b.crossOrigin:null,this.tileClass=void 0!==b.tileClass?b.tileClass:h.default,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=b.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.canExpireCache=function(){var b=this;if(!f.ENABLE_RASTER_REPROJECTION)return a.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var c in b.tileCacheForProjection)if(b.tileCacheForProjection[c].canExpireCache())return!0;return!1},b.prototype.expireCache=function(b,c){var d=this;if(!f.ENABLE_RASTER_REPROJECTION)return void a.prototype.expireCache.call(this,b,c);var e=this.getTileCacheForProjection(b);this.tileCache.expireCache(this.tileCache==e?c:{});for(var g in d.tileCacheForProjection){var h=d.tileCacheForProjection[g];h.expireCache(h==e?c:{})}},b.prototype.getGutterForProjection=function(a){return f.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&a&&!(0,m.equivalent)(this.getProjection(),a)?0:this.getGutter()},b.prototype.getGutter=function(){return 0},b.prototype.getOpaque=function(b){return!(f.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&b&&!(0,
m.equivalent)(this.getProjection(),b))&&a.prototype.getOpaque.call(this,b)},b.prototype.getTileGridForProjection=function(b){if(!f.ENABLE_RASTER_REPROJECTION)return a.prototype.getTileGridForProjection.call(this,b);var c=this.getProjection();if(!this.tileGrid||c&&!(0,m.equivalent)(c,b)){var d=(0,g.getUid)(b).toString();return d in this.tileGridForProjection||(this.tileGridForProjection[d]=(0,q.getForProjection)(b)),this.tileGridForProjection[d]}return this.tileGrid},b.prototype.getTileCacheForProjection=function(b){if(!f.ENABLE_RASTER_REPROJECTION)return a.prototype.getTileCacheForProjection.call(this,b);var c=this.getProjection();if(!c||(0,m.equivalent)(c,b))return this.tileCache;var d=(0,g.getUid)(b).toString();return d in this.tileCacheForProjection||(this.tileCacheForProjection[d]=new i.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[d]},b.prototype.createTile_=function(a,b,c,d,e,f){var g=[a,b,c],h=this.getTileCoordForTileUrlFunction(g,e),i=h?this.tileUrlFunction(h,d,e):void 0,m=new this.tileClass(g,void 0!==i?j.default.IDLE:j.default.EMPTY,void 0!==i?i:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return m.key=f,(0,k.listen)(m,l.default.CHANGE,this.handleTileChange,this),m},b.prototype.getTile=function(a,b,c,d,e){var g=this.getProjection();if(f.ENABLE_RASTER_REPROJECTION&&g&&e&&!(0,m.equivalent)(g,e)){var h,i=this.getTileCacheForProjection(e),j=[a,b,c],k=(0,p.getKey)(j);i.containsKey(k)&&(h=i.get(k));var l=this.getKey();if(h&&h.key==l)return h;var o=this.getTileGridForProjection(g),q=this.getTileGridForProjection(e),r=this.getTileCoordForTileUrlFunction(j,e),s=new n.default(g,o,e,q,j,r,this.getTilePixelRatio(d),this.getGutter(),function(a,b,c,d){return this.getTileInternal(a,b,c,d,g)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return s.key=l,h?(s.interimTile=h,s.refreshInterimChain(),i.replace(k,s)):i.set(k,s),s}return this.getTileInternal(a,b,c,d,g||e)},b.prototype.getTileInternal=function(a,b,c,d,e){var f=null,g=(0,p.getKeyZXY)(a,b,c),h=this.getKey();if(this.tileCache.containsKey(g)){if(f=this.tileCache.get(g),f.key!=h){var i=f;f=this.createTile_(a,b,c,d,e,h),i.getState()==j.default.IDLE?f.interimTile=i.interimTile:f.interimTile=i,f.refreshInterimChain(),this.tileCache.replace(g,f)}}else f=this.createTile_(a,b,c,d,e,h),this.tileCache.set(g,f);return f},b.prototype.setRenderReprojectionEdges=function(a){var b=this;if(f.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=a){this.renderReprojectionEdges_=a;for(var c in b.tileCacheForProjection)b.tileCacheForProjection[c].clear();this.changed()}},b.prototype.setTileGridForProjection=function(a,b){if(f.ENABLE_RASTER_REPROJECTION){var c=(0,m.get)(a);if(c){var d=(0,g.getUid)(c).toString();d in this.tileGridForProjection||(this.tileGridForProjection[d]=b)}}},b}(o.default),s=r;c.default=s},{"../ImageTile.js":18,"../TileCache.js":36,"../TileState.js":39,"../events.js":66,"../events/EventType.js":68,"../proj.js":210,"../reproj/Tile.js":274,"../reproj/common.js":276,"../source/UrlTile.js":303,"../tilecoord.js":334,"../tilegrid.js":335,"../util.js":342}],300:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../tileurlfunction.js"),f=a("../asserts.js"),g=a("../extent.js"),h=a("../net.js"),i=a("../proj.js"),j=d(a("../source/State.js")),k=d(a("../source/TileImage.js")),l=a("../tilegrid.js"),m=function(a){function b(b){if(a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,crossOrigin:b.crossOrigin,projection:(0,i.get)("EPSG:3857"),reprojectionErrorThreshold:b.reprojectionErrorThreshold,state:j.default.LOADING,tileLoadFunction:b.tileLoadFunction,wrapX:void 0===b.wrapX||b.wrapX,transition:b.transition}),this.tileJSON_=null,b.url)if(b.jsonp)(0,h.jsonp)(b.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var c=new XMLHttpRequest;c.addEventListener("load",this.onXHRLoad_.bind(this)),c.addEventListener("error",this.onXHRError_.bind(this)),c.open("GET",b.url),c.send()}else b.tileJSON?this.handleTileJSONResponse(b.tileJSON):(0,f.assert)(!1,51)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onXHRLoad_=function(a){var b=a.target;if(!b.status||b.status>=200&&b.status<300){var c;try{c=JSON.parse(b.responseText)}catch(a){return void this.handleTileJSONError()}this.handleTileJSONResponse(c)}else this.handleTileJSONError()},b.prototype.onXHRError_=function(a){this.handleTileJSONError()},b.prototype.getTileJSON=function(){return this.tileJSON_},b.prototype.handleTileJSONResponse=function(a){var b,c=(0,i.get)("EPSG:4326"),d=this.getProjection();if(void 0!==a.bounds){var f=(0,i.getTransformFromProjections)(c,d);b=(0,g.applyTransform)(a.bounds,f)}var h=a.minzoom||0,k=a.maxzoom||22,m=(0,l.createXYZ)({extent:(0,l.extentFromProjection)(d),maxZoom:k,minZoom:h});if(this.tileGrid=m,this.tileUrlFunction=(0,e.createFromTemplates)(a.tiles,m),void 0!==a.attribution&&!this.getAttributions()){var n=void 0!==b?b:c.getExtent();this.setAttributions(function(b){return(0,g.intersects)(n,b.extent)?[a.attribution]:null})}this.tileJSON_=a,this.setState(j.default.READY)},b.prototype.handleTileJSONError=function(){this.setState(j.default.ERROR)},b}(k.default),n=m;c.default=n},{"../asserts.js":47,"../extent.js":72,"../net.js":200,"../proj.js":210,"../source/State.js":294,"../source/TileImage.js":299,"../tilegrid.js":335,"../tileurlfunction.js":339}],301:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=a("../asserts.js"),g=a("../extent.js"),h=a("../obj.js"),i=a("../math.js"),j=a("../proj.js"),k=a("../reproj.js"),l=a("../size.js"),m=d(a("../source/TileImage.js")),n=d(a("../source/WMSServerType.js")),o=a("../tilecoord.js"),p=a("../string.js"),q=a("../uri.js"),r=function(a){function b(b){var c=b||{},d=c.params||{},e=!("TRANSPARENT"in d)||d.TRANSPARENT;a.call(this,{attributions:c.attributions,cacheSize:c.cacheSize,crossOrigin:c.crossOrigin,opaque:!e,projection:c.projection,reprojectionErrorThreshold:c.reprojectionErrorThreshold,tileClass:c.tileClass,tileGrid:c.tileGrid,tileLoadFunction:c.tileLoadFunction,url:c.url,urls:c.urls,wrapX:void 0===c.wrapX||c.wrapX,transition:c.transition}),this.gutter_=void 0!==c.gutter?c.gutter:0,this.params_=d,this.v13_=!0,this.serverType_=c.serverType,this.hidpi_=void 0===c.hidpi||c.hidpi,this.tmpExtent_=(0,g.createEmpty)(),this.updateV13_(),this.setKey(this.getKeyForParams_())}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getGetFeatureInfoUrl=function(a,b,c,d){var f=(0,j.get)(c),i=this.getProjection(),m=this.getTileGrid();m||(m=this.getTileGridForProjection(f));var n=m.getTileCoordForCoordAndResolution(a,b);if(!(m.getResolutions().length<=n[0])){var o=m.getResolution(n[0]),p=m.getTileCoordExtent(n,this.tmpExtent_),q=(0,l.toSize)(m.getTileSize(n[0]),this.tmpSize),r=this.gutter_;0!==r&&(q=(0,l.buffer)(q,r,this.tmpSize),p=(0,g.buffer)(p,o*r,p)),i&&i!==f&&(o=(0,k.calculateSourceResolution)(i,f,a,o),p=(0,j.transformExtent)(p,f,i),a=(0,j.transform)(a,f,i));var s={SERVICE:"WMS",VERSION:e.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};(0,h.assign)(s,this.params_,d);var t=Math.floor((a[0]-p[0])/o),u=Math.floor((p[3]-a[1])/o);return s[this.v13_?"I":"X"]=t,s[this.v13_?"J":"Y"]=u,this.getRequestUrl_(n,q,p,1,i||f,s)}},b.prototype.getGutter=function(){return this.gutter_},b.prototype.getParams=function(){return this.params_},b.prototype.getRequestUrl_=function(a,b,c,d,e,g){var h=this.urls;if(h){if(g.WIDTH=b[0],g.HEIGHT=b[1],g[this.v13_?"CRS":"SRS"]=e.getCode(),"STYLES"in this.params_||(g.STYLES=""),1!=d)switch(this.serverType_){case n.default.GEOSERVER:var j=90*d+.5|0;"FORMAT_OPTIONS"in g?g.FORMAT_OPTIONS+=";dpi:"+j:g.FORMAT_OPTIONS="dpi:"+j;break;case n.default.MAPSERVER:g.MAP_RESOLUTION=90*d;break;case n.default.CARMENTA_SERVER:case n.default.QGIS:g.DPI=90*d;break;default:(0,f.assert)(!1,52)}var k=e.getAxisOrientation(),l=c;if(this.v13_&&"ne"==k.substr(0,2)){var m;m=c[0],l[0]=c[1],l[1]=m,m=c[2],l[2]=c[3],l[3]=m}g.BBOX=l.join(",");var p;if(1==h.length)p=h[0];else{p=h[(0,i.modulo)((0,o.hash)(a),h.length)]}return(0,q.appendParams)(p,g)}},b.prototype.getTilePixelRatio=function(a){return this.hidpi_&&void 0!==this.serverType_?a:1},b.prototype.getKeyForParams_=function(){var a=this,b=0,c=[];for(var d in a.params_)c[b++]=d+"-"+a.params_[d];return c.join("/")},b.prototype.fixedTileUrlFunction=function(a,b,c){var d=this.getTileGrid();if(d||(d=this.getTileGridForProjection(c)),!(d.getResolutions().length<=a[0])){1==b||this.hidpi_&&void 0!==this.serverType_||(b=1);var f=d.getResolution(a[0]),i=d.getTileCoordExtent(a,this.tmpExtent_),j=(0,l.toSize)(d.getTileSize(a[0]),this.tmpSize),k=this.gutter_;0!==k&&(j=(0,l.buffer)(j,k,this.tmpSize),i=(0,g.buffer)(i,f*k,i)),1!=b&&(j=(0,l.scale)(j,b,this.tmpSize));var m={SERVICE:"WMS",VERSION:e.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return(0,h.assign)(m,this.params_),this.getRequestUrl_(a,j,i,b,c,m)}},b.prototype.updateParams=function(a){(0,h.assign)(this.params_,a),this.updateV13_(),this.setKey(this.getKeyForParams_())},b.prototype.updateV13_=function(){var a=this.params_.VERSION||e.DEFAULT_WMS_VERSION;this.v13_=(0,p.compareVersions)(a,"1.3")>=0},b}(m.default),s=r;c.default=s},{"../asserts.js":47,"../extent.js":72,"../math.js":199,"../obj.js":201,"../proj.js":210,"../reproj.js":272,"../size.js":279,"../source/TileImage.js":299,"../source/WMSServerType.js":306,"../string.js":313,"../tilecoord.js":334,"../uri.js":341,"./common.js":311}],302:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.CustomTile=void 0;var e=d(a("../Tile.js")),f=d(a("../TileState.js")),g=a("../tileurlfunction.js"),h=a("../asserts.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=a("../extent.js"),l=a("../net.js"),m=a("../proj.js"),n=d(a("../source/State.js")),o=d(a("../source/Tile.js")),p=a("../tilecoord.js"),q=a("../tilegrid.js"),r=function(a){function b(b,c,d,e,f,g){a.call(this,b,c),this.src_=d,this.extent_=e,this.preemptive_=f,this.grid_=null,this.keys_=null,this.data_=null,this.jsonp_=g}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){return null},b.prototype.getData=function(a){if(!this.grid_||!this.keys_)return null;var b=(a[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),c=(a[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),d=this.grid_[Math.floor((1-c)*this.grid_.length)];if("string"!=typeof d)return null;var e=d.charCodeAt(Math.floor(b*d.length));e>=93&&e--,e>=35&&e--,e-=32;var f=null;if(e in this.keys_){var g=this.keys_[e];f=this.data_&&g in this.data_?this.data_[g]:g}return f},b.prototype.forDataAtCoordinate=function(a,b,c,d){this.state==f.default.IDLE&&!0===d?((0,i.listenOnce)(this,j.default.CHANGE,function(d){b.call(c,this.getData(a))},this),this.loadInternal_()):!0===d?setTimeout(function(){b.call(c,this.getData(a))}.bind(this),0):b.call(c,this.getData(a))},b.prototype.getKey=function(){return this.src_},b.prototype.handleError_=function(){this.state=f.default.ERROR,this.changed()},b.prototype.handleLoad_=function(a){this.grid_=a.grid,this.keys_=a.keys,this.data_=a.data,this.state=f.default.EMPTY,this.changed()},b.prototype.loadInternal_=function(){if(this.state==f.default.IDLE)if(this.state=f.default.LOADING,this.jsonp_)(0,l.jsonp)(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var a=new XMLHttpRequest;a.addEventListener("load",this.onXHRLoad_.bind(this)),a.addEventListener("error",this.onXHRError_.bind(this)),a.open("GET",this.src_),a.send()}},b.prototype.onXHRLoad_=function(a){var b=a.target;if(!b.status||b.status>=200&&b.status<300){var c;try{c=JSON.parse(b.responseText)}catch(a){return void this.handleError_()}this.handleLoad_(c)}else this.handleError_()},b.prototype.onXHRError_=function(a){this.handleError_()},b.prototype.load=function(){this.preemptive_&&this.loadInternal_()},b}(e.default);c.CustomTile=r;var s=function(a){function b(b){if(a.call(this,{projection:(0,m.get)("EPSG:3857"),state:n.default.LOADING}),this.preemptive_=void 0===b.preemptive||b.preemptive,this.tileUrlFunction_=g.nullTileUrlFunction,this.template_=void 0,this.jsonp_=b.jsonp||!1,b.url)if(this.jsonp_)(0,l.jsonp)(b.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var c=new XMLHttpRequest;c.addEventListener("load",this.onXHRLoad_.bind(this)),c.addEventListener("error",this.onXHRError_.bind(this)),c.open("GET",b.url),c.send()}else b.tileJSON?this.handleTileJSONResponse(b.tileJSON):(0,h.assert)(!1,51)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onXHRLoad_=function(a){var b=a.target;if(!b.status||b.status>=200&&b.status<300){var c;try{c=JSON.parse(b.responseText)}catch(a){return void this.handleTileJSONError()}this.handleTileJSONResponse(c)}else this.handleTileJSONError()},b.prototype.onXHRError_=function(a){this.handleTileJSONError()},b.prototype.getTemplate=function(){return this.template_},b.prototype.forDataAtCoordinateAndResolution=function(a,b,c,d){if(this.tileGrid){var e=this.tileGrid.getTileCoordForCoordAndResolution(a,b);this.getTile(e[0],e[1],e[2],1,this.getProjection()).forDataAtCoordinate(a,c,null,d)}else!0===d?setTimeout(function(){c(null)},0):c(null)},b.prototype.handleTileJSONError=function(){this.setState(n.default.ERROR)},b.prototype.handleTileJSONResponse=function(a){var b,c=(0,m.get)("EPSG:4326"),d=this.getProjection();if(void 0!==a.bounds){var e=(0,m.getTransformFromProjections)(c,d);b=(0,k.applyTransform)(a.bounds,e)}var f=a.minzoom||0,h=a.maxzoom||22,i=(0,q.createXYZ)({extent:(0,q.extentFromProjection)(d),maxZoom:h,minZoom:f});this.tileGrid=i,this.template_=a.template;var j=a.grids;if(!j)return void this.setState(n.default.ERROR);if(this.tileUrlFunction_=(0,g.createFromTemplates)(j,i),void 0!==a.attribution){var l=void 0!==b?b:c.getExtent();this.setAttributions(function(b){return(0,k.intersects)(l,b.extent)?[a.attribution]:null})}this.setState(n.default.READY)},b.prototype.getTile=function(a,b,c,d,e){var g=(0,p.getKeyZXY)(a,b,c);if(this.tileCache.containsKey(g))return this.tileCache.get(g);var h=[a,b,c],i=this.getTileCoordForTileUrlFunction(h,e),j=this.tileUrlFunction_(i,d,e),k=new r(h,void 0!==j?f.default.IDLE:f.default.EMPTY,void 0!==j?j:"",this.tileGrid.getTileCoordExtent(h),this.preemptive_,this.jsonp_);return this.tileCache.set(g,k),k},b.prototype.useTile=function(a,b,c){var d=(0,p.getKeyZXY)(a,b,c);this.tileCache.containsKey(d)&&this.tileCache.get(d)},b}(o.default),t=s;c.default=t},{"../Tile.js":35,"../TileState.js":39,"../asserts.js":47,"../events.js":66,"../events/EventType.js":68,"../extent.js":72,"../net.js":200,"../proj.js":210,"../source/State.js":294,"../source/Tile.js":295,"../tilecoord.js":334,"../tilegrid.js":335,"../tileurlfunction.js":339}],303:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=a("../util.js"),g=e(a("../TileState.js")),h=a("../tileurlfunction.js"),i=d(a("../source/Tile.js")),j=e(a("../source/TileEventType.js")),k=a("../tilecoord.js"),l=function(a){function b(b){a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,extent:b.extent,opaque:b.opaque,projection:b.projection,state:b.state,tileGrid:b.tileGrid,tilePixelRatio:b.tilePixelRatio,wrapX:b.wrapX,transition:b.transition}),this.tileLoadFunction=b.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):h.nullTileUrlFunction,this.urls=null,b.urls?this.setUrls(b.urls):b.url&&this.setUrl(b.url),b.tileUrlFunction&&this.setTileUrlFunction(b.tileUrlFunction),this.tileLoadingKeys_={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},b.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},b.prototype.getUrls=function(){return this.urls},b.prototype.handleTileChange=function(a){var b,c=a.target,d=(0,f.getUid)(c),e=c.getState();e==g.default.LOADING?(this.tileLoadingKeys_[d]=!0,b=j.default.TILELOADSTART):d in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[d],b=e==g.default.ERROR?j.default.TILELOADERROR:e==g.default.LOADED||e==g.default.ABORT?j.default.TILELOADEND:void 0),void 0!=b&&this.dispatchEvent(new i.TileSourceEvent(b,c))},b.prototype.setTileLoadFunction=function(a){this.tileCache.clear(),this.tileLoadFunction=a,this.changed()},b.prototype.setTileUrlFunction=function(a,b){this.tileUrlFunction=a,this.tileCache.pruneExceptNewestZ(),void 0!==b?this.setKey(b):this.changed()},b.prototype.setUrl=function(a){var b=this.urls=(0,h.expandUrl)(a);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,h.createFromTemplates)(b,this.tileGrid),a)},b.prototype.setUrls=function(a){this.urls=a;var b=a.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,h.createFromTemplates)(a,this.tileGrid),b)},b.prototype.useTile=function(a,b,c){var d=(0,k.getKeyZXY)(a,b,c);this.tileCache.containsKey(d)&&this.tileCache.get(d)},b}(i.default);l.prototype.fixedTileUrlFunction;var m=l;c.default=m},{"../TileState.js":39,"../source/Tile.js":295,"../source/TileEventType.js":298,"../tilecoord.js":334,"../tileurlfunction.js":339,"../util.js":342}],304:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.VectorSourceEvent=void 0;var e=a("../util.js"),f=d(a("../Collection.js")),g=d(a("../CollectionEventType.js")),h=d(a("../ObjectEventType.js")),i=a("../array.js"),j=a("../asserts.js"),k=a("../events.js"),l=d(a("../events/Event.js")),m=d(a("../events/EventType.js")),n=a("../extent.js"),o=a("../featureloader.js"),p=a("../functions.js"),q=a("../loadingstrategy.js"),r=a("../obj.js"),s=d(a("../source/Source.js")),t=d(a("../source/State.js")),u=d(a("../source/VectorEventType.js")),v=d(a("../structs/RBush.js")),w=function(a){function b(b,c){a.call(this,b),this.feature=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(l.default);c.VectorSourceEvent=w;var x=function(a){function b(b){var c=b||{};a.call(this,{attributions:c.attributions,projection:void 0,state:t.default.READY,wrapX:void 0===c.wrapX||c.wrapX}),this.loader_=p.VOID,this.format_=c.format,this.overlaps_=void 0==c.overlaps||c.overlaps,this.url_=c.url,void 0!==c.loader?this.loader_=c.loader:void 0!==this.url_&&((0,j.assert)(this.format_,7),this.loader_=(0,o.xhr)(this.url_,this.format_)),this.strategy_=void 0!==c.strategy?c.strategy:q.all;var d=void 0===c.useSpatialIndex||c.useSpatialIndex;this.featuresRtree_=d?new v.default:null,this.loadedExtentsRtree_=new v.default,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;var e,g;c.features instanceof f.default?(e=c.features,g=e.getArray()):Array.isArray(c.features)&&(g=c.features),d||void 0!==e||(e=new f.default(g)),void 0!==g&&this.addFeaturesInternal(g),void 0!==e&&this.bindFeaturesCollection_(e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a){this.addFeatureInternal(a),this.changed()},b.prototype.addFeatureInternal=function(a){var b=(0,e.getUid)(a).toString();if(this.addToIndex_(b,a)){this.setupChangeEvents_(b,a);var c=a.getGeometry();if(c){var d=c.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(d,a)}else this.nullGeometryFeatures_[b]=a;this.dispatchEvent(new w(u.default.ADDFEATURE,a))}},b.prototype.setupChangeEvents_=function(a,b){this.featureChangeKeys_[a]=[(0,k.listen)(b,m.default.CHANGE,this.handleFeatureChange_,this),(0,k.listen)(b,h.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]},b.prototype.addToIndex_=function(a,b){var c=!0,d=b.getId();return void 0!==d?d.toString()in this.idIndex_?c=!1:this.idIndex_[d.toString()]=b:((0,j.assert)(!(a in this.undefIdIndex_),30),this.undefIdIndex_[a]=b),c},b.prototype.addFeatures=function(a){this.addFeaturesInternal(a),this.changed()},b.prototype.addFeaturesInternal=function(a){for(var b=this,c=[],d=[],f=[],g=0,h=a.length;g<h;g++){var i=a[g],j=(0,e.getUid)(i).toString();b.addToIndex_(j,i)&&d.push(i)}for(var k=0,l=d.length;k<l;k++){var m=d[k],n=(0,e.getUid)(m).toString();b.setupChangeEvents_(n,m);var o=m.getGeometry();if(o){var p=o.getExtent();c.push(p),f.push(m)}else b.nullGeometryFeatures_[n]=m}this.featuresRtree_&&this.featuresRtree_.load(c,f);for(var q=0,r=d.length;q<r;q++)b.dispatchEvent(new w(u.default.ADDFEATURE,d[q]))},b.prototype.bindFeaturesCollection_=function(a){var b=!1;(0,k.listen)(this,u.default.ADDFEATURE,function(c){b||(b=!0,a.push(c.feature),b=!1)}),(0,k.listen)(this,u.default.REMOVEFEATURE,function(c){b||(b=!0,a.remove(c.feature),b=!1)}),(0,k.listen)(a,g.default.ADD,function(a){b||(b=!0,this.addFeature(a.element),b=!1)},this),(0,k.listen)(a,g.default.REMOVE,function(a){b||(b=!0,this.removeFeature(a.element),b=!1)},this),this.featuresCollection_=a},b.prototype.clear=function(a){var b=this;if(a){for(var c in b.featureChangeKeys_){b.featureChangeKeys_[c].forEach(k.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(var d in b.nullGeometryFeatures_)b.removeFeatureInternal(b.nullGeometryFeatures_[d])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var e=new w(u.default.CLEAR);this.dispatchEvent(e),this.changed()},b.prototype.forEachFeature=function(a){return this.featuresRtree_?this.featuresRtree_.forEach(a):this.featuresCollection_?this.featuresCollection_.forEach(a):void 0},b.prototype.forEachFeatureAtCoordinateDirect=function(a,b){var c=[a[0],a[1],a[0],a[1]];return this.forEachFeatureInExtent(c,function(c){return c.getGeometry().intersectsCoordinate(a)?b(c):void 0})},b.prototype.forEachFeatureInExtent=function(a,b){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(a,b):this.featuresCollection_?this.featuresCollection_.forEach(b):void 0},b.prototype.forEachFeatureIntersectingExtent=function(a,b){return this.forEachFeatureInExtent(a,function(c){if(c.getGeometry().intersectsExtent(a)){var d=b(c);if(d)return d}})},b.prototype.getFeaturesCollection=function(){return this.featuresCollection_},b.prototype.getFeatures=function(){var a;return this.featuresCollection_?a=this.featuresCollection_.getArray():this.featuresRtree_&&(a=this.featuresRtree_.getAll(),(0,r.isEmpty)(this.nullGeometryFeatures_)||(0,i.extend)(a,(0,r.getValues)(this.nullGeometryFeatures_))),a},b.prototype.getFeaturesAtCoordinate=function(a){var b=[];return this.forEachFeatureAtCoordinateDirect(a,function(a){b.push(a)}),b},b.prototype.getFeaturesInExtent=function(a){return this.featuresRtree_.getInExtent(a)},b.prototype.getClosestFeatureToCoordinate=function(a,b){var c=a[0],d=a[1],e=null,f=[NaN,NaN],g=1/0,h=[-1/0,-1/0,1/0,1/0],i=b||p.TRUE;return this.featuresRtree_.forEachInExtent(h,function(a){if(i(a)){var b=a.getGeometry(),j=g;if((g=b.closestPointXY(c,d,f,g))<j){e=a;var k=Math.sqrt(g);h[0]=c-k,h[1]=d-k,h[2]=c+k,h[3]=d+k}}}),e},b.prototype.getExtent=function(a){return this.featuresRtree_.getExtent(a)},b.prototype.getFeatureById=function(a){var b=this.idIndex_[a.toString()];return void 0!==b?b:null},b.prototype.getFormat=function(){return this.format_},b.prototype.getOverlaps=function(){return this.overlaps_},b.prototype.getResolutions=function(){},b.prototype.getUrl=function(){return this.url_},b.prototype.handleFeatureChange_=function(a){var b=a.target,c=(0,e.getUid)(b).toString(),d=b.getGeometry();if(d){var f=d.getExtent();c in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[c],this.featuresRtree_&&this.featuresRtree_.insert(f,b)):this.featuresRtree_&&this.featuresRtree_.update(f,b)}else c in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(b),this.nullGeometryFeatures_[c]=b);var g=b.getId();if(void 0!==g){var h=g.toString();c in this.undefIdIndex_?(delete this.undefIdIndex_[c],this.idIndex_[h]=b):this.idIndex_[h]!==b&&(this.removeFromIdIndex_(b),this.idIndex_[h]=b)}else c in this.undefIdIndex_||(this.removeFromIdIndex_(b),this.undefIdIndex_[c]=b);this.changed(),this.dispatchEvent(new w(u.default.CHANGEFEATURE,b))},b.prototype.hasFeature=function(a){var b=a.getId();return void 0!==b?b in this.idIndex_:(0,e.getUid)(a).toString()in this.undefIdIndex_},b.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&(0,r.isEmpty)(this.nullGeometryFeatures_)},b.prototype.loadFeatures=function(a,b,c){var d=this,e=this.loadedExtentsRtree_,f=this.strategy_(a,b);this.loading=!1;for(var g=function(a,g){var h=f[a];e.forEachInExtent(h,function(a){return(0,n.containsExtent)(a.extent,h)})||(d.loader_.call(d,h,b,c),e.insert(h,{extent:h.slice()}),d.loading=!0)},h=0,i=f.length;h<i;++h)g(h,i)},b.prototype.removeLoadedExtent=function(a){var b,c=this.loadedExtentsRtree_;c.forEachInExtent(a,function(c){if((0,n.equals)(c.extent,a))return b=c,!0}),b&&c.remove(b)},b.prototype.removeFeature=function(a){var b=(0,e.getUid)(a).toString();b in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[b]:this.featuresRtree_&&this.featuresRtree_.remove(a),this.removeFeatureInternal(a),this.changed()},b.prototype.removeFeatureInternal=function(a){var b=(0,e.getUid)(a).toString();this.featureChangeKeys_[b].forEach(k.unlistenByKey),delete this.featureChangeKeys_[b];var c=a.getId();void 0!==c?delete this.idIndex_[c.toString()]:delete this.undefIdIndex_[b],this.dispatchEvent(new w(u.default.REMOVEFEATURE,a))},b.prototype.removeFromIdIndex_=function(a){var b=this,c=!1;for(var d in b.idIndex_)if(b.idIndex_[d]===a){delete b.idIndex_[d],c=!0;break}return c},b.prototype.setLoader=function(a){this.loader_=a},b}(s.default),y=x;c.default=y},{"../Collection.js":7,"../CollectionEventType.js":8,"../ObjectEventType.js":30,"../array.js":46,"../asserts.js":47,"../events.js":66,"../events/Event.js":67,"../events/EventType.js":68,"../extent.js":72,"../featureloader.js":75,"../functions.js":126,"../loadingstrategy.js":198,"../obj.js":201,"../source/Source.js":292,"../source/State.js":294,"../source/VectorEventType.js":305,"../structs/RBush.js":317,"../util.js":342}],305:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};c.default=d},{}],306:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};c.default=d},{}],307:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){var c=a.Contents.Layer,d=(0,h.find)(c,function(a,c,d){return a.Identifier==b.layer});if(null===d)return null;var e,f=a.Contents.TileMatrixSet;(e=d.TileMatrixSetLink.length>1?"projection"in b?(0,h.findIndex)(d.TileMatrixSetLink,function(a,c,d){var e=(0,h.find)(f,function(b){return b.Identifier==a.TileMatrixSet}),g=e.SupportedCRS,i=(0,k.get)(g.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,k.get)(g),j=(0,k.get)(b.projection);return i&&j?(0,k.equivalent)(i,j):g==b.projection}):(0,h.findIndex)(d.TileMatrixSetLink,function(a,c,d){return a.TileMatrixSet==b.matrixSet}):0)<0&&(e=0);var g=d.TileMatrixSetLink[e].TileMatrixSet,j=d.TileMatrixSetLink[e].TileMatrixSetLimits,l=d.Format[0];"format"in b&&(l=b.format),(e=(0,h.findIndex)(d.Style,function(a,c,d){return"style"in b?a.Title==b.style:a.isDefault}))<0&&(e=0);var o=d.Style[e].Identifier,p={};"Dimension"in d&&d.Dimension.forEach(function(a,b,c){var d=a.Identifier,e=a.Default;void 0===e&&(e=a.Value[0]),p[d]=e});var q,r=a.Contents.TileMatrixSet,s=(0,h.find)(r,function(a,b,c){return a.Identifier==g}),t=s.SupportedCRS;if(t&&(q=(0,k.get)(t.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,k.get)(t)),"projection"in b){var u=(0,k.get)(b.projection);u&&(q&&!(0,k.equivalent)(u,q)||(q=u))}var v,w,x=d.WGS84BoundingBox;if(void 0!==x){var y=(0,k.get)("EPSG:4326").getExtent();w=x[0]==y[0]&&x[2]==y[2],v=(0,k.transformExtent)(x,"EPSG:4326",q);var z=q.getExtent();z&&((0,i.containsExtent)(z,v)||(v=void 0))}var A=(0,n.createFromCapabilitiesMatrixSet)(s,v,j),B=[],C=b.requestEncoding;if(C=void 0!==C?C:"","OperationsMetadata"in a&&"GetTile"in a.OperationsMetadata)for(var D=a.OperationsMetadata.GetTile.DCP.HTTP.Get,E=0,F=D.length;E<F;++E)if(D[E].Constraint){var G=(0,h.find)(D[E].Constraint,function(a){return"GetEncoding"==a.name}),H=G.AllowedValues.Value;if(""===C&&(C=H[0]),C!==m.default.KVP)break;(0,h.includes)(H,m.default.KVP)&&B.push(D[E].href)}else D[E].href&&(C=m.default.KVP,B.push(D[E].href));return 0===B.length&&(C=m.default.REST,d.ResourceURL.forEach(function(a){"tile"===a.resourceType&&(l=a.format,B.push(a.template))})),{urls:B,layer:b.layer,matrixSet:g,format:l,projection:q,requestEncoding:C,tileGrid:A,style:o,dimensions:p,wrapX:w,crossOrigin:b.crossOrigin}}function f(a){var b=this.requestEncoding_,c={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};b==m.default.KVP&&(0,j.assign)(c,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),a=b==m.default.KVP?(0,o.appendParams)(a,c):a.replace(/\{(\w+?)\}/g,function(a,b){return b.toLowerCase()in c?c[b.toLowerCase()]:a});var d=this.tileGrid,e=this.dimensions_;return function(c,f,g){if(c){var h={TileMatrix:d.getMatrixId(c[0]),TileCol:c[1],TileRow:-c[2]-1};(0,j.assign)(h,e);var i=a;return i=b==m.default.KVP?(0,o.appendParams)(i,h):i.replace(/\{(\w+?)\}/g,function(a,b){return h[b]})}}}Object.defineProperty(c,"__esModule",{value:!0}),c.optionsFromCapabilities=e,c.default=void 0;var g=a("../tileurlfunction.js"),h=a("../array.js"),i=a("../extent.js"),j=a("../obj.js"),k=a("../proj.js"),l=d(a("../source/TileImage.js")),m=d(a("../source/WMTSRequestEncoding.js")),n=a("../tilegrid/WMTS.js"),o=a("../uri.js"),p=function(a){function b(b){var c=void 0!==b.requestEncoding?b.requestEncoding:m.default.KVP,d=b.tileGrid,e=b.urls;void 0===e&&void 0!==b.url&&(e=(0,g.expandUrl)(b.url)),a.call(this,{attributions:b.attributions,cacheSize:b.cacheSize,crossOrigin:b.crossOrigin,projection:b.projection,reprojectionErrorThreshold:b.reprojectionErrorThreshold,tileClass:b.tileClass,tileGrid:d,tileLoadFunction:b.tileLoadFunction,tilePixelRatio:b.tilePixelRatio,tileUrlFunction:g.nullTileUrlFunction,urls:e,wrapX:void 0!==b.wrapX&&b.wrapX,transition:b.transition}),this.version_=void 0!==b.version?b.version:"1.0.0",this.format_=void 0!==b.format?b.format:"image/jpeg",this.dimensions_=void 0!==b.dimensions?b.dimensions:{},this.layer_=b.layer,this.matrixSet_=b.matrixSet,this.style_=b.style,this.requestEncoding_=c,this.setKey(this.getKeyForDimensions_()),e&&e.length>0&&(this.tileUrlFunction=(0,g.createFromTileUrlFunctions)(e.map(f.bind(this))))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setUrls=function(a){this.urls=a;var b=a.join("\n")
;this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,g.createFromTileUrlFunctions)(a.map(f.bind(this))),b)},b.prototype.getDimensions=function(){return this.dimensions_},b.prototype.getFormat=function(){return this.format_},b.prototype.getLayer=function(){return this.layer_},b.prototype.getMatrixSet=function(){return this.matrixSet_},b.prototype.getRequestEncoding=function(){return this.requestEncoding_},b.prototype.getStyle=function(){return this.style_},b.prototype.getVersion=function(){return this.version_},b.prototype.getKeyForDimensions_=function(){var a=this,b=0,c=[];for(var d in a.dimensions_)c[b++]=d+"-"+a.dimensions_[d];return c.join("/")},b.prototype.updateDimensions=function(a){(0,j.assign)(this.dimensions_,a),this.setKey(this.getKeyForDimensions_())},b}(l.default),q=p;c.default=q},{"../array.js":46,"../extent.js":72,"../obj.js":201,"../proj.js":210,"../source/TileImage.js":299,"../source/WMTSRequestEncoding.js":308,"../tilegrid/WMTS.js":337,"../tileurlfunction.js":339,"../uri.js":341}],308:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={KVP:"KVP",REST:"REST"};c.default=d},{}],309:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../source/TileImage.js")),f=a("../tilegrid.js"),g=function(a){function b(b){var c=b||{},d=void 0!==c.projection?c.projection:"EPSG:3857",e=void 0!==c.tileGrid?c.tileGrid:(0,f.createXYZ)({extent:(0,f.extentFromProjection)(d),maxZoom:c.maxZoom,minZoom:c.minZoom,tileSize:c.tileSize});a.call(this,{attributions:c.attributions,cacheSize:c.cacheSize,crossOrigin:c.crossOrigin,opaque:c.opaque,projection:d,reprojectionErrorThreshold:c.reprojectionErrorThreshold,tileGrid:e,tileLoadFunction:c.tileLoadFunction,tilePixelRatio:c.tilePixelRatio,tileUrlFunction:c.tileUrlFunction,url:c.url,urls:c.urls,wrapX:void 0===c.wrapX||c.wrapX,transition:c.transition})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(e.default),h=g;c.default=h},{"../source/TileImage.js":299,"../tilegrid.js":335}],310:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.CustomTile=void 0;var e=a("../tilegrid/common.js"),f=d(a("../ImageTile.js")),g=d(a("../TileState.js")),h=a("../tileurlfunction.js"),i=a("../asserts.js"),j=a("../dom.js"),k=a("../extent.js"),l=a("../size.js"),m=d(a("../source/TileImage.js")),n=d(a("../tilegrid/TileGrid.js")),o={DEFAULT:"default",TRUNCATED:"truncated"},p=function(a){function b(b,c,d,e,f,g,h){a.call(this,c,d,e,f,g,h),this.zoomifyImage_=null,this.tileSize_=(0,l.toSize)(b.getTileSize(c[0]))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var b=a.prototype.getImage.call(this);if(this.state==g.default.LOADED){var c=this.tileSize_;if(b.width==c[0]&&b.height==c[1])return this.zoomifyImage_=b,b;var d=(0,j.createCanvasContext2D)(c[0],c[1]);return d.drawImage(b,0,0),this.zoomifyImage_=d.canvas,d.canvas}return b},b}(f.default);c.CustomTile=p;var q=function(a){function b(b){function c(a){return function(b,c,d){if(b){var e=b[0],f=b[1],g=-b[2]-1,h=f+g*q[e][0],i=z.getTileSize(e),j=(h+w[e])/i|0,k={z:e,x:f,y:g,tileIndex:h,TileGroup:"TileGroup"+j};return a.replace(/\{(\w+?)\}/g,function(a,b){return k[b]})}}}var d=b||{},f=d.size,g=void 0!==d.tierSizeCalculation?d.tierSizeCalculation:o.DEFAULT,j=f[0],l=f[1],m=d.extent||[0,-f[1],f[0],0],q=[],r=d.tileSize||e.DEFAULT_TILE_SIZE,s=r;switch(g){case o.DEFAULT:for(;j>s||l>s;)q.push([Math.ceil(j/s),Math.ceil(l/s)]),s+=s;break;case o.TRUNCATED:for(var t=j,u=l;t>s||u>s;)q.push([Math.ceil(t/s),Math.ceil(u/s)]),t>>=1,u>>=1;break;default:(0,i.assert)(!1,53)}q.push([1,1]),q.reverse();for(var v=[1],w=[0],x=1,y=q.length;x<y;x++)v.push(1<<x),w.push(q[x-1][0]*q[x-1][1]+w[x-1]);v.reverse();var z=new n.default({tileSize:r,extent:m,origin:(0,k.getTopLeft)(m),resolutions:v}),A=d.url;A&&-1==A.indexOf("{TileGroup}")&&-1==A.indexOf("{tileIndex}")&&(A+="{TileGroup}/{z}-{x}-{y}.jpg");var B=(0,h.expandUrl)(A),C=(0,h.createFromTileUrlFunctions)(B.map(c)),D=p.bind(null,z);a.call(this,{attributions:d.attributions,cacheSize:d.cacheSize,crossOrigin:d.crossOrigin,projection:d.projection,reprojectionErrorThreshold:d.reprojectionErrorThreshold,tileClass:D,tileGrid:z,tileUrlFunction:C,transition:d.transition})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m.default),r=q;c.default=r},{"../ImageTile.js":18,"../TileState.js":39,"../asserts.js":47,"../dom.js":64,"../extent.js":72,"../size.js":279,"../source/TileImage.js":299,"../tilegrid/TileGrid.js":336,"../tilegrid/common.js":338,"../tileurlfunction.js":339}],311:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_WMS_VERSION=void 0,c.DEFAULT_WMS_VERSION="1.3.0"},{}],312:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=c||m,e=(0,k.toRadians)(a[1]),f=(0,k.toRadians)(b[1]),g=(f-e)/2,h=(0,k.toRadians)(b[0]-a[0])/2,i=Math.sin(g)*Math.sin(g)+Math.sin(h)*Math.sin(h)*Math.cos(e)*Math.cos(f);return 2*d*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function f(a,b){for(var c=0,d=0,f=a.length;d<f-1;++d)c+=e(a[d],a[d+1],b);return c}function g(a,b){var c=b||{},d=c.radius||m,e=c.projection||"EPSG:3857",h=a.getType();h!==l.default.GEOMETRY_COLLECTION&&(a=a.clone().transform(e,"EPSG:4326"));var i,j,k,n,o,p,q=0;switch(h){case l.default.POINT:case l.default.MULTI_POINT:break;case l.default.LINE_STRING:case l.default.LINEAR_RING:i=a.getCoordinates(),q=f(i,d);break;case l.default.MULTI_LINE_STRING:case l.default.POLYGON:for(i=a.getCoordinates(),k=0,n=i.length;k<n;++k)q+=f(i[k],d);break;case l.default.MULTI_POLYGON:for(i=a.getCoordinates(),k=0,n=i.length;k<n;++k)for(j=i[k],o=0,p=j.length;o<p;++o)q+=f(j[o],d);break;case l.default.GEOMETRY_COLLECTION:var r=a.getGeometries();for(k=0,n=r.length;k<n;++k)q+=g(r[k],b);break;default:throw new Error("Unsupported geometry type: "+h)}return q}function h(a,b){for(var c=0,d=a.length,e=a[d-1][0],f=a[d-1][1],g=0;g<d;g++){var h=a[g][0],i=a[g][1];c+=(0,k.toRadians)(h-e)*(2+Math.sin((0,k.toRadians)(f))+Math.sin((0,k.toRadians)(i))),e=h,f=i}return c*b*b/2}function i(a,b){var c=b||{},d=c.radius||m,e=c.projection||"EPSG:3857",f=a.getType();f!==l.default.GEOMETRY_COLLECTION&&(a=a.clone().transform(e,"EPSG:4326"));var g,j,k,n,o,p,q=0;switch(f){case l.default.POINT:case l.default.MULTI_POINT:case l.default.LINE_STRING:case l.default.MULTI_LINE_STRING:case l.default.LINEAR_RING:break;case l.default.POLYGON:for(g=a.getCoordinates(),q=Math.abs(h(g[0],d)),k=1,n=g.length;k<n;++k)q-=Math.abs(h(g[k],d));break;case l.default.MULTI_POLYGON:for(g=a.getCoordinates(),k=0,n=g.length;k<n;++k)for(j=g[k],q+=Math.abs(h(j[0],d)),o=1,p=j.length;o<p;++o)q-=Math.abs(h(j[o],d));break;case l.default.GEOMETRY_COLLECTION:var r=a.getGeometries();for(k=0,n=r.length;k<n;++k)q+=i(r[k],b);break;default:throw new Error("Unsupported geometry type: "+f)}return q}function j(a,b,c,d){var e=d||m,f=(0,k.toRadians)(a[1]),g=(0,k.toRadians)(a[0]),h=b/e,i=Math.asin(Math.sin(f)*Math.cos(h)+Math.cos(f)*Math.sin(h)*Math.cos(c)),j=g+Math.atan2(Math.sin(c)*Math.sin(h)*Math.cos(f),Math.cos(h)-Math.sin(f)*Math.sin(i));return[(0,k.toDegrees)(j),(0,k.toDegrees)(i)]}Object.defineProperty(c,"__esModule",{value:!0}),c.getDistance=e,c.getLength=g,c.getArea=i,c.offset=j,c.DEFAULT_RADIUS=void 0;var k=a("./math.js"),l=d(a("./geom/GeometryType.js")),m=6371008.8;c.DEFAULT_RADIUS=m},{"./geom/GeometryType.js":132,"./math.js":199}],313:[function(a,b,c){"use strict";function d(a,b,c){var d=void 0!==c?a.toFixed(c):""+a,e=d.indexOf(".");return e=-1===e?d.length:e,e>b?d:new Array(1+b-e).join("0")+d}function e(a,b){for(var c=(""+a).split("."),d=(""+b).split("."),e=0;e<Math.max(c.length,d.length);e++){var f=parseInt(c[e]||"0",10),g=parseInt(d[e]||"0",10);if(f>g)return 1;if(g>f)return-1}return 0}Object.defineProperty(c,"__esModule",{value:!0}),c.padNumber=d,c.compareVersions=e},{}],314:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../asserts.js"),f=d(a("../events/Target.js")),g=d(a("../events/EventType.js")),h=function(a){function b(b){a.call(this),this.highWaterMark=void 0!==b?b:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},b.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(g.default.CLEAR)},b.prototype.containsKey=function(a){return this.entries_.hasOwnProperty(a)},b.prototype.forEach=function(a,b){for(var c=this,d=this.oldest_;d;)a.call(b,d.value_,d.key_,c),d=d.newer},b.prototype.get=function(a){var b=this.entries_[a];return(0,e.assert)(void 0!==b,15),b===this.newest_?b.value_:(b===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(b.newer.older=b.older,b.older.newer=b.newer),b.newer=null,b.older=this.newest_,this.newest_.newer=b,this.newest_=b,b.value_)},b.prototype.remove=function(a){var b=this.entries_[a];return(0,e.assert)(void 0!==b,15),b===this.newest_?(this.newest_=b.older,this.newest_&&(this.newest_.newer=null)):b===this.oldest_?(this.oldest_=b.newer,this.oldest_&&(this.oldest_.older=null)):(b.newer.older=b.older,b.older.newer=b.newer),delete this.entries_[a],--this.count_,b.value_},b.prototype.getCount=function(){return this.count_},b.prototype.getKeys=function(){var a,b=new Array(this.count_),c=0;for(a=this.newest_;a;a=a.older)b[c++]=a.key_;return b},b.prototype.getValues=function(){var a,b=new Array(this.count_),c=0;for(a=this.newest_;a;a=a.older)b[c++]=a.value_;return b},b.prototype.peekLast=function(){return this.oldest_.value_},b.prototype.peekLastKey=function(){return this.oldest_.key_},b.prototype.peekFirstKey=function(){return this.newest_.key_},b.prototype.pop=function(){var a=this.oldest_;return delete this.entries_[a.key_],a.newer&&(a.newer.older=null),this.oldest_=a.newer,this.oldest_||(this.newest_=null),--this.count_,a.value_},b.prototype.replace=function(a,b){this.get(a),this.entries_[a].value_=b},b.prototype.set=function(a,b){(0,e.assert)(!(a in this.entries_),16);var c={key_:a,newer:null,older:this.newest_,value_:b};this.newest_?this.newest_.newer=c:this.oldest_=c,this.newest_=c,this.entries_[a]=c,++this.count_},b.prototype.setSize=function(a){this.highWaterMark=a},b.prototype.prune=function(){for(var a=this;this.canExpireCache();)a.pop()},b}(f.default),i=h;c.default=i},{"../asserts.js":47,"../events/EventType.js":68,"../events/Target.js":70}],315:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a){this.first_,this.last_,this.head_,this.circular_=void 0===a||a,this.length_=0};d.prototype.insertItem=function(a){var b={prev:void 0,next:void 0,data:a},c=this.head_;if(c){var d=c.next;b.prev=c,b.next=d,c.next=b,d&&(d.prev=b),c===this.last_&&(this.last_=b)}else this.first_=b,this.last_=b,this.circular_&&(b.next=b,b.prev=b);this.head_=b,this.length_++},d.prototype.removeItem=function(){var a=this.head_;if(a){var b=a.next,c=a.prev;b&&(b.prev=c),c&&(c.next=b),this.head_=b||c,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===a?this.first_=this.head_:this.last_===a&&(this.last_=c?this.head_.prev:this.head_),this.length_--}},d.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},d.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},d.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},d.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},d.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},d.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},d.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},d.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},d.prototype.concat=function(a){if(a.head_){if(this.head_){var b=this.head_.next;this.head_.next=a.first_,a.first_.prev=this.head_,b.prev=a.last_,a.last_.next=b,this.length_+=a.length_}else this.head_=a.head_,this.first_=a.first_,this.last_=a.last_,this.length_=a.length_;a.head_=void 0,a.first_=void 0,a.last_=void 0,a.length_=0}},d.prototype.getLength=function(){return this.length_};var e=d;c.default=e},{}],316:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.DROP=void 0;var d=a("../asserts.js"),e=a("../obj.js"),f=1/0;c.DROP=f;var g=function(a,b){this.priorityFunction_=a,this.keyFunction_=b,this.elements_=[],this.priorities_=[],this.queuedElements_={}};g.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,(0,e.clear)(this.queuedElements_)},g.prototype.dequeue=function(){var a=this.elements_,b=this.priorities_,c=a[0];1==a.length?(a.length=0,b.length=0):(a[0]=a.pop(),b[0]=b.pop(),this.siftUp_(0));var d=this.keyFunction_(c);return delete this.queuedElements_[d],c},g.prototype.enqueue=function(a){(0,d.assert)(!(this.keyFunction_(a)in this.queuedElements_),31);var b=this.priorityFunction_(a);return b!=f&&(this.elements_.push(a),this.priorities_.push(b),this.queuedElements_[this.keyFunction_(a)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},g.prototype.getCount=function(){return this.elements_.length},g.prototype.getLeftChildIndex_=function(a){return 2*a+1},g.prototype.getRightChildIndex_=function(a){return 2*a+2},g.prototype.getParentIndex_=function(a){return a-1>>1},g.prototype.heapify_=function(){var a,b=this;for(a=(this.elements_.length>>1)-1;a>=0;a--)b.siftUp_(a)},g.prototype.isEmpty=function(){return 0===this.elements_.length},g.prototype.isKeyQueued=function(a){return a in this.queuedElements_},g.prototype.isQueued=function(a){return this.isKeyQueued(this.keyFunction_(a))},g.prototype.siftUp_=function(a){for(var b=this,c=this.elements_,d=this.priorities_,e=c.length,f=c[a],g=d[a],h=a;a<e>>1;){var i=b.getLeftChildIndex_(a),j=b.getRightChildIndex_(a),k=j<e&&d[j]<d[i]?j:i;c[a]=c[k],d[a]=d[k],a=k}c[a]=f,d[a]=g,this.siftDown_(h,a)},g.prototype.siftDown_=function(a,b){for(var c=this,d=this.elements_,e=this.priorities_,f=d[b],g=e[b];b>a;){var h=c.getParentIndex_(b);if(!(e[h]>g))break;d[b]=d[h],e[b]=e[h],b=h}d[b]=f,e[b]=g},g.prototype.reprioritize=function(){var a,b,c,d=this,e=this.priorityFunction_,g=this.elements_,h=this.priorities_,i=0,j=g.length;for(b=0;b<j;++b)a=g[b],c=e(a),c==f?delete d.queuedElements_[d.keyFunction_(a)]:(h[i]=c,g[i++]=a);g.length=i,h.length=i,this.heapify_()};var h=g;c.default=h},{"../asserts.js":47,"../obj.js":201}],317:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("rbush")),g=a("../extent.js"),h=a("../obj.js"),i=function(a){this.rbush_=(0,f.default)(a,void 0),this.items_={}};i.prototype.insert=function(a,b){var c={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};this.rbush_.insert(c),this.items_[(0,e.getUid)(b)]=c},i.prototype.load=function(a,b){for(var c=this,d=new Array(b.length),f=0,g=b.length;f<g;f++){var h=a[f],i=b[f],j={minX:h[0],minY:h[1],maxX:h[2],maxY:h[3],value:i};d[f]=j,c.items_[(0,e.getUid)(i)]=j}this.rbush_.load(d)},i.prototype.remove=function(a){var b=(0,e.getUid)(a),c=this.items_[b];return delete this.items_[b],null!==this.rbush_.remove(c)},i.prototype.update=function(a,b){var c=this.items_[(0,e.getUid)(b)],d=[c.minX,c.minY,c.maxX,c.maxY];(0,g.equals)(d,a)||(this.remove(b),this.insert(a,b))},i.prototype.getAll=function(){return this.rbush_.all().map(function(a){return a.value})},i.prototype.getInExtent=function(a){var b={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]};return this.rbush_.search(b).map(function(a){return a.value})},i.prototype.forEach=function(a,b){return this.forEach_(this.getAll(),a,b)},i.prototype.forEachInExtent=function(a,b,c){return this.forEach_(this.getInExtent(a),b,c)},i.prototype.forEach_=function(a,b,c){for(var d,e=0,f=a.length;e<f;e++)if(d=b.call(c,a[e]))return d;return d},i.prototype.isEmpty=function(){return(0,h.isEmpty)(this.items_)},i.prototype.clear=function(){this.rbush_.clear(),this.items_={}},i.prototype.getExtent=function(a){var b=this.rbush_.data;return(0,g.createOrUpdate)(b.minX,b.minY,b.maxX,b.maxY,a)},i.prototype.concat=function(a){var b=this;this.rbush_.load(a.rbush_.all());for(var c in a.items_)b.items_[0|c]=a.items_[0|c]};var j=i;c.default=j},{"../extent.js":72,"../obj.js":201,"../util.js":342,rbush:357}],318:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Atlas",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"AtlasManager",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"Circle",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(c,"Fill",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"Icon",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"IconImage",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(c,"RegularShape",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"Stroke",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(c,"Style",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"Text",{enumerable:!0,get:function(){return o.default}});var e=d(a("./style/Atlas.js")),f=d(a("./style/AtlasManager.js")),g=d(a("./style/Circle.js")),h=d(a("./style/Fill.js")),i=d(a("./style/Icon.js")),j=d(a("./style/IconImage.js")),k=d(a("./style/Image.js")),l=d(a("./style/RegularShape.js")),m=d(a("./style/Stroke.js")),n=d(a("./style/Style.js")),o=d(a("./style/Text.js"))},{"./style/Atlas.js":319,"./style/AtlasManager.js":320,"./style/Circle.js":321,"./style/Fill.js":322,"./style/Icon.js":323,"./style/IconImage.js":325,"./style/Image.js":328,"./style/RegularShape.js":329,"./style/Stroke.js":330,"./style/Style.js":331,"./style/Text.js":332}],319:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../dom.js"),e=function(a,b){this.space_=b,this.emptyBlocks_=[{x:0,y:0,width:a,height:a}],this.entries_={},this.context_=(0,d.createCanvasContext2D)(a,a),this.canvas_=this.context_.canvas};e.prototype.get=function(a){return this.entries_[a]||null},e.prototype.add=function(a,b,c,d,e){for(var f=this,g=0,h=this.emptyBlocks_.length;g<h;++g){var i=f.emptyBlocks_[g];if(i.width>=b+f.space_&&i.height>=c+f.space_){var j={offsetX:i.x+f.space_,offsetY:i.y+f.space_,image:f.canvas_};return f.entries_[a]=j,d.call(e,f.context_,i.x+f.space_,i.y+f.space_),f.split_(g,i,b+f.space_,c+f.space_),j}}return null},e.prototype.split_=function(a,b,c,d){var e,f,g=b.width-c,h=b.height-d;g>h?(e={x:b.x+c,y:b.y,width:b.width-c,height:b.height},f={x:b.x,y:b.y+d,width:c,height:b.height-d},this.updateBlocks_(a,e,f)):(e={x:b.x+c,y:b.y,width:b.width-c,height:d},f={x:b.x,y:b.y+d,width:b.width,height:b.height-d},this.updateBlocks_(a,e,f))},e.prototype.updateBlocks_=function(a,b,c){var d=[a,1];b.width>0&&b.height>0&&d.push(b),c.width>0&&c.height>0&&d.push(c),this.emptyBlocks_.splice.apply(this.emptyBlocks_,d)};var f=e;c.default=f},{"../dom.js":64}],320:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../webgl.js"),f=a("../functions.js"),g=d(a("../style/Atlas.js")),h=256,i=-1,j=function(a){var b=a||{};this.currentSize_=void 0!==b.initialSize?b.initialSize:h,this.maxSize_=void 0!==b.maxSize?b.maxSize:-1!=i?i:void 0!==e.MAX_TEXTURE_SIZE?e.MAX_TEXTURE_SIZE:2048,this.space_=void 0!==b.space?b.space:1,this.atlases_=[new g.default(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new g.default(this.currentHitSize_,this.space_)]};j.prototype.getInfo=function(a){var b=this.getInfo_(this.atlases_,a);if(!b)return null;var c=this.getInfo_(this.hitAtlases_,a);return this.mergeInfos_(b,c)},j.prototype.getInfo_=function(a,b){for(var c=0,d=a.length;c<d;++c){var e=a[c],f=e.get(b);if(f)return f}return null},j.prototype.mergeInfos_=function(a,b){return{offsetX:a.offsetX,offsetY:a.offsetY,image:a.image,hitImage:b.image}},j.prototype.add=function(a,b,c,d,e,g){if(b+this.space_>this.maxSize_||c+this.space_>this.maxSize_)return null;var h=this.add_(!1,a,b,c,d,g);if(!h)return null;var i=void 0!==e?e:f.VOID,j=this.add_(!0,a,b,c,i,g);return this.mergeInfos_(h,j)},j.prototype.add_=function(a,b,c,d,e,f){var h,i,j,k,l=this,m=a?this.hitAtlases_:this.atlases_;for(j=0,k=m.length;j<k;++j){if(h=m[j],i=h.add(b,c,d,e,f))return i;if(!i&&j===k-1){var n=void 0;a?(n=Math.min(2*l.currentHitSize_,l.maxSize_),l.currentHitSize_=n):(n=Math.min(2*l.currentSize_,l.maxSize_),l.currentSize_=n),h=new g.default(n,l.space_),m.push(h),++k}}return null};var k=j;c.default=k},{"../functions.js":126,"../style/Atlas.js":319,"../webgl.js":344}],321:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../style/RegularShape.js")),f=function(a){function b(b){var c=b||{};a.call(this,{points:1/0,fill:c.fill,radius:c.radius,stroke:c.stroke,atlasManager:c.atlasManager})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){var a=new b({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return a.setOpacity(this.getOpacity()),a.setScale(this.getScale()),a},b.prototype.setRadius=function(a){this.radius_=a,this.render_(this.atlasManager_)},b}(e.default),g=f;c.default=g},{"../style/RegularShape.js":329}],322:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../util.js"),e=a("../color.js"),f=function(a){var b=a||{};this.color_=void 0!==b.color?b.color:null,this.checksum_=void 0};f.prototype.clone=function(){var a=this.getColor();return new f({color:a&&a.slice?a.slice():a||void 0})},f.prototype.getColor=function(){return this.color_},f.prototype.setColor=function(a){this.color_=a,this.checksum_=void 0},f.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=(0,d.getUid)(this.color_).toString():this.checksum_="f"+(this.color_?(0,e.asString)(this.color_):"-")),this.checksum_};var g=f;c.default=g},{"../color.js":49,"../util.js":342}],323:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../util.js"),f=d(a("../ImageState.js")),g=a("../asserts.js"),h=a("../color.js"),i=a("../events.js"),j=d(a("../events/EventType.js")),k=d(a("../style/IconAnchorUnits.js")),l=a("../style/IconImage.js"),m=d(a("../style/IconOrigin.js")),n=d(a("../style/Image.js")),o=function(a){function b(b){var c=b||{},d=void 0!==c.opacity?c.opacity:1,i=void 0!==c.rotation?c.rotation:0,j=void 0!==c.scale?c.scale:1,n=void 0!==c.rotateWithView&&c.rotateWithView;a.call(this,{opacity:d,rotation:i,scale:j,rotateWithView:n}),this.anchor_=void 0!==c.anchor?c.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==c.anchorOrigin?c.anchorOrigin:m.default.TOP_LEFT,this.anchorXUnits_=void 0!==c.anchorXUnits?c.anchorXUnits:k.default.FRACTION,this.anchorYUnits_=void 0!==c.anchorYUnits?c.anchorYUnits:k.default.FRACTION,this.crossOrigin_=void 0!==c.crossOrigin?c.crossOrigin:null;var o=void 0!==c.img?c.img:null,p=void 0!==c.imgSize?c.imgSize:null,q=c.src;(0,g.assert)(!(void 0!==q&&o),4),(0,g.assert)(!o||o&&p,5),void 0!==q&&0!==q.length||!o||(q=o.src||(0,e.getUid)(o).toString()),(0,g.assert)(void 0!==q&&q.length>0,6);var r=void 0!==c.src?f.default.IDLE:f.default.LOADED;this.color_=void 0!==c.color?(0,h.asArray)(c.color):null,this.iconImage_=(0,l.get)(o,q,p,this.crossOrigin_,r,this.color_),this.offset_=void 0!==c.offset?c.offset:[0,0],this.offsetOrigin_=void 0!==c.offsetOrigin?c.offsetOrigin:m.default.TOP_LEFT,this.origin_=null,this.size_=void 0!==c.size?c.size:null}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},b.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var a=this.anchor_,b=this.getSize();if(this.anchorXUnits_==k.default.FRACTION||this.anchorYUnits_==k.default.FRACTION){if(!b)return null;a=this.anchor_.slice(),this.anchorXUnits_==k.default.FRACTION&&(a[0]*=b[0]),this.anchorYUnits_==k.default.FRACTION&&(a[1]*=b[1])}if(this.anchorOrigin_!=m.default.TOP_LEFT){if(!b)return null;a===this.anchor_&&(a=this.anchor_.slice()),this.anchorOrigin_!=m.default.TOP_RIGHT&&this.anchorOrigin_!=m.default.BOTTOM_RIGHT||(a[0]=-a[0]+b[0]),this.anchorOrigin_!=m.default.BOTTOM_LEFT&&this.anchorOrigin_!=m.default.BOTTOM_RIGHT||(a[1]=-a[1]+b[1])}return this.normalizedAnchor_=a,this.normalizedAnchor_},b.prototype.setAnchor=function(a){this.anchor_=a,this.normalizedAnchor_=null},b.prototype.getColor=function(){return this.color_},b.prototype.getImage=function(a){return this.iconImage_.getImage(a)},b.prototype.getImageSize=function(){return this.iconImage_.getSize()},b.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},b.prototype.getImageState=function(){return this.iconImage_.getImageState()},b.prototype.getHitDetectionImage=function(a){return this.iconImage_.getHitDetectionImage(a)},b.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var a=this.offset_;if(this.offsetOrigin_!=m.default.TOP_LEFT){var b=this.getSize(),c=this.iconImage_.getSize();if(!b||!c)return null;a=a.slice(),this.offsetOrigin_!=m.default.TOP_RIGHT&&this.offsetOrigin_!=m.default.BOTTOM_RIGHT||(a[0]=c[0]-b[0]-a[0]),this.offsetOrigin_!=m.default.BOTTOM_LEFT&&this.offsetOrigin_!=m.default.BOTTOM_RIGHT||(a[1]=c[1]-b[1]-a[1])}return this.origin_=a,this.origin_},b.prototype.getSrc=function(){return this.iconImage_.getSrc()},b.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},b.prototype.listenImageChange=function(a,b){return(0,i.listen)(this.iconImage_,j.default.CHANGE,a,b)},b.prototype.load=function(){this.iconImage_.load()},b.prototype.unlistenImageChange=function(a,b){(0,i.unlisten)(this.iconImage_,j.default.CHANGE,a,b)},b}(n.default),p=o;c.default=p},{"../ImageState.js":17,"../asserts.js":47,"../color.js":49,"../events.js":66,"../events/EventType.js":68,"../style/IconAnchorUnits.js":324,"../style/IconImage.js":325,"../style/IconOrigin.js":327,"../style/Image.js":328,"../util.js":342}],324:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={FRACTION:"fraction",PIXELS:"pixels"};c.default=d},{}],325:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c,d,e,f){var g=k.shared.get(b,d,f);return g||(g=new l(a,b,c,d,e,f),k.shared.set(b,d,f,g)),g}Object.defineProperty(c,"__esModule",{value:!0}),c.get=e,c.default=void 0;var f=a("../dom.js"),g=a("../events.js"),h=d(a("../events/Target.js")),i=d(a("../events/EventType.js")),j=d(a("../ImageState.js")),k=a("../style/IconImageCache.js"),l=function(a){function b(b,c,d,e,f,g){a.call(this),this.hitDetectionImage_=null,this.image_=b||new Image,null!==e&&(this.image_.crossOrigin=e),this.canvas_=g?document.createElement("canvas"):null,this.color_=g,this.imageListenerKeys_=null,this.imageState_=f,this.size_=d,this.src_=c,this.tainting_=!1,this.imageState_==j.default.LOADED&&this.determineTainting_()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.determineTainting_=function(){var a=(0,f.createCanvasContext2D)(1,1);try{a.drawImage(this.image_,0,0),a.getImageData(0,0,1,1)}catch(a){this.tainting_=!0}},b.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(i.default.CHANGE)},b.prototype.handleImageError_=function(){this.imageState_=j.default.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},b.prototype.handleImageLoad_=function(){this.imageState_=j.default.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.determineTainting_(),this.replaceColor_(),this.dispatchChangeEvent_()},b.prototype.getImage=function(a){return this.canvas_?this.canvas_:this.image_},b.prototype.getImageState=function(){return this.imageState_},b.prototype.getHitDetectionImage=function(a){if(!this.hitDetectionImage_)if(this.tainting_){var b=this.size_[0],c=this.size_[1],d=(0,f.createCanvasContext2D)(b,c);d.fillRect(0,0,b,c),this.hitDetectionImage_=d.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},b.prototype.getSize=function(){return this.size_},b.prototype.getSrc=function(){return this.src_},b.prototype.load=function(){if(this.imageState_==j.default.IDLE){this.imageState_=j.default.LOADING,this.imageListenerKeys_=[(0,g.listenOnce)(this.image_,i.default.ERROR,this.handleImageError_,this),(0,g.listenOnce)(this.image_,i.default.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(a){this.handleImageError_()}}},b.prototype.replaceColor_=function(){if(!this.tainting_&&null!==this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var a=this.canvas_.getContext("2d");a.drawImage(this.image_,0,0);for(var b=a.getImageData(0,0,this.image_.width,this.image_.height),c=b.data,d=this.color_[0]/255,e=this.color_[1]/255,f=this.color_[2]/255,g=0,h=c.length;g<h;g+=4)c[g]*=d,c[g+1]*=e,c[g+2]*=f;a.putImageData(b,0,0)}},b.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(g.unlistenByKey),this.imageListenerKeys_=null},b}(h.default),m=l;c.default=m},{"../ImageState.js":17,"../dom.js":64,"../events.js":66,"../events/EventType.js":68,"../events/Target.js":70,"../style/IconImageCache.js":326}],326:[function(a,b,c){"use strict";function d(a,b,c){return b+":"+a+":"+(c?(0,e.asString)(c):"null")}Object.defineProperty(c,"__esModule",{value:!0}),c.shared=c.default=void 0;var e=a("../color.js"),f=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};f.prototype.clear=function(){this.cache_={},this.cacheSize_=0},f.prototype.expire=function(){var a=this;if(this.cacheSize_>this.maxCacheSize_){var b=0;for(var c in a.cache_){var d=a.cache_[c];0!=(3&b++)||d.hasListener()||(delete a.cache_[c],--a.cacheSize_)}}},f.prototype.get=function(a,b,c){var e=d(a,b,c);return e in this.cache_?this.cache_[e]:null},f.prototype.set=function(a,b,c,e){var f=d(a,b,c);this.cache_[f]=e,++this.cacheSize_},
f.prototype.setSize=function(a){this.maxCacheSize_=a,this.expire()};var g=f;c.default=g;var h=new f;c.shared=h},{"../color.js":49}],327:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};c.default=d},{}],328:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(a){this.opacity_=a.opacity,this.rotateWithView_=a.rotateWithView,this.rotation_=a.rotation,this.scale_=a.scale};d.prototype.getOpacity=function(){return this.opacity_},d.prototype.getRotateWithView=function(){return this.rotateWithView_},d.prototype.getRotation=function(){return this.rotation_},d.prototype.getScale=function(){return this.scale_},d.prototype.getSnapToPixel=function(){return!1},d.prototype.getAnchor=function(){},d.prototype.getImage=function(a){},d.prototype.getHitDetectionImage=function(a){},d.prototype.getImageState=function(){},d.prototype.getImageSize=function(){},d.prototype.getHitDetectionImageSize=function(){},d.prototype.getOrigin=function(){},d.prototype.getSize=function(){},d.prototype.setOpacity=function(a){this.opacity_=a},d.prototype.setRotateWithView=function(a){this.rotateWithView_=a},d.prototype.setRotation=function(a){this.rotation_=a},d.prototype.setScale=function(a){this.scale_=a},d.prototype.setSnapToPixel=function(a){},d.prototype.listenImageChange=function(a,b){},d.prototype.load=function(){},d.prototype.unlistenImageChange=function(a,b){};var e=d;c.default=e},{}],329:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../colorlike.js"),f=a("../dom.js"),g=a("../has.js"),h=d(a("../ImageState.js")),i=a("../render/canvas.js"),j=d(a("../style/Image.js")),k=function(a){function b(b){var c=void 0!==b.rotateWithView&&b.rotateWithView;a.call(this,{opacity:1,rotateWithView:c,rotation:void 0!==b.rotation?b.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==b.fill?b.fill:null,this.origin_=[0,0],this.points_=b.points,this.radius_=void 0!==b.radius?b.radius:b.radius1,this.radius2_=b.radius2,this.angle_=void 0!==b.angle?b.angle:0,this.stroke_=void 0!==b.stroke?b.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=b.atlasManager,this.render_(this.atlasManager_)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){var a=new b({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return a.setOpacity(this.getOpacity()),a.setScale(this.getScale()),a},b.prototype.getAnchor=function(){return this.anchor_},b.prototype.getAngle=function(){return this.angle_},b.prototype.getFill=function(){return this.fill_},b.prototype.getHitDetectionImage=function(a){return this.hitDetectionCanvas_},b.prototype.getImage=function(a){return this.canvas_},b.prototype.getImageSize=function(){return this.imageSize_},b.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},b.prototype.getImageState=function(){return h.default.LOADED},b.prototype.getOrigin=function(){return this.origin_},b.prototype.getPoints=function(){return this.points_},b.prototype.getRadius=function(){return this.radius_},b.prototype.getRadius2=function(){return this.radius2_},b.prototype.getSize=function(){return this.size_},b.prototype.getStroke=function(){return this.stroke_},b.prototype.listenImageChange=function(a,b){},b.prototype.load=function(){},b.prototype.unlistenImageChange=function(a,b){},b.prototype.render_=function(a){var b,c,d="",h="",j=0,k=null,l=0,m=0;this.stroke_&&(c=this.stroke_.getColor(),null===c&&(c=i.defaultStrokeStyle),c=(0,e.asColorLike)(c),m=this.stroke_.getWidth(),void 0===m&&(m=i.defaultLineWidth),k=this.stroke_.getLineDash(),l=this.stroke_.getLineDashOffset(),g.CANVAS_LINE_DASH||(k=null,l=0),h=this.stroke_.getLineJoin(),void 0===h&&(h=i.defaultLineJoin),d=this.stroke_.getLineCap(),void 0===d&&(d=i.defaultLineCap),void 0===(j=this.stroke_.getMiterLimit())&&(j=i.defaultMiterLimit));var n=2*(this.radius_+m)+1,o={strokeStyle:c,strokeWidth:m,size:n,lineCap:d,lineDash:k,lineDashOffset:l,lineJoin:h,miterLimit:j};if(void 0===a){var p=(0,f.createCanvasContext2D)(n,n);this.canvas_=p.canvas,n=this.canvas_.width,b=n,this.draw_(o,p,0,0),this.createHitDetectionCanvas_(o)}else{n=Math.round(n);var q,r=!this.fill_;r&&(q=this.drawHitDetectionCanvas_.bind(this,o));var s=this.getChecksum(),t=a.add(s,n,n,this.draw_.bind(this,o),q);this.canvas_=t.image,this.origin_=[t.offsetX,t.offsetY],b=t.image.width,r?(this.hitDetectionCanvas_=t.hitImage,this.hitDetectionImageSize_=[t.hitImage.width,t.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[b,b])}this.anchor_=[n/2,n/2],this.size_=[n,n],this.imageSize_=[b,b]},b.prototype.draw_=function(a,b,c,d){var f,g,h,j=this;b.setTransform(1,0,0,1,0,0),b.translate(c,d),b.beginPath();var k=this.points_;if(k===1/0)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(k*=2),f=0;f<=k;f++)g=2*f*Math.PI/k-Math.PI/2+j.angle_,h=f%2==0?j.radius_:l,b.lineTo(a.size/2+h*Math.cos(g),a.size/2+h*Math.sin(g))}if(this.fill_){var m=this.fill_.getColor();null===m&&(m=i.defaultFillStyle),b.fillStyle=(0,e.asColorLike)(m),b.fill()}this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineCap=a.lineCap,b.lineJoin=a.lineJoin,b.miterLimit=a.miterLimit,b.stroke()),b.closePath()},b.prototype.createHitDetectionCanvas_=function(a){if(this.hitDetectionImageSize_=[a.size,a.size],this.fill_)return void(this.hitDetectionCanvas_=this.canvas_);var b=(0,f.createCanvasContext2D)(a.size,a.size);this.hitDetectionCanvas_=b.canvas,this.drawHitDetectionCanvas_(a,b,0,0)},b.prototype.drawHitDetectionCanvas_=function(a,b,c,d){var e=this;b.setTransform(1,0,0,1,0,0),b.translate(c,d),b.beginPath();var f=this.points_;if(f===1/0)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{var g=void 0!==this.radius2_?this.radius2_:this.radius_;g!==this.radius_&&(f*=2);var h,j,k;for(h=0;h<=f;h++)k=2*h*Math.PI/f-Math.PI/2+e.angle_,j=h%2==0?e.radius_:g,b.lineTo(a.size/2+j*Math.cos(k),a.size/2+j*Math.sin(k))}b.fillStyle=i.defaultFillStyle,b.fill(),this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.stroke()),b.closePath()},b.prototype.getChecksum=function(){var a=this.stroke_?this.stroke_.getChecksum():"-",b=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||a!=this.checksums_[1]||b!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var c="r"+a+b+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[c,a,b,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},b}(j.default),l=k;c.default=l},{"../ImageState.js":17,"../colorlike.js":50,"../dom.js":64,"../has.js":161,"../render/canvas.js":225,"../style/Image.js":328}],330:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../util.js"),e=function(a){var b=a||{};this.color_=void 0!==b.color?b.color:null,this.lineCap_=b.lineCap,this.lineDash_=void 0!==b.lineDash?b.lineDash:null,this.lineDashOffset_=b.lineDashOffset,this.lineJoin_=b.lineJoin,this.miterLimit_=b.miterLimit,this.width_=b.width,this.checksum_=void 0};e.prototype.clone=function(){var a=this.getColor();return new e({color:a&&a.slice?a.slice():a||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},e.prototype.getColor=function(){return this.color_},e.prototype.getLineCap=function(){return this.lineCap_},e.prototype.getLineDash=function(){return this.lineDash_},e.prototype.getLineDashOffset=function(){return this.lineDashOffset_},e.prototype.getLineJoin=function(){return this.lineJoin_},e.prototype.getMiterLimit=function(){return this.miterLimit_},e.prototype.getWidth=function(){return this.width_},e.prototype.setColor=function(a){this.color_=a,this.checksum_=void 0},e.prototype.setLineCap=function(a){this.lineCap_=a,this.checksum_=void 0},e.prototype.setLineDash=function(a){this.lineDash_=a,this.checksum_=void 0},e.prototype.setLineDashOffset=function(a){this.lineDashOffset_=a,this.checksum_=void 0},e.prototype.setLineJoin=function(a){this.lineJoin_=a,this.checksum_=void 0},e.prototype.setMiterLimit=function(a){this.miterLimit_=a,this.checksum_=void 0},e.prototype.setWidth=function(a){this.width_=a,this.checksum_=void 0},e.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=(0,d.getUid)(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var f=e;c.default=f},{"../util.js":342}],331:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b;if("function"==typeof a)b=a;else{var c;Array.isArray(a)?c=a:((0,i.assert)(a instanceof n,41),c=[a]),b=function(){return c}}return b}function f(a,b){if(!o){var c=new l.default({color:"rgba(255,255,255,0.4)"}),d=new m.default({color:"#3399CC",width:1.25});o=[new n({image:new k.default({fill:c,stroke:d,radius:5}),fill:c,stroke:d})]}return o}function g(){var a={},b=[255,255,255,1],c=[0,153,255,1],d=3;return a[j.default.POLYGON]=[new n({fill:new l.default({color:[255,255,255,.5]})})],a[j.default.MULTI_POLYGON]=a[j.default.POLYGON],a[j.default.LINE_STRING]=[new n({stroke:new m.default({color:b,width:d+2})}),new n({stroke:new m.default({color:c,width:d})})],a[j.default.MULTI_LINE_STRING]=a[j.default.LINE_STRING],a[j.default.CIRCLE]=a[j.default.POLYGON].concat(a[j.default.LINE_STRING]),a[j.default.POINT]=[new n({image:new k.default({radius:2*d,fill:new l.default({color:c}),stroke:new m.default({color:b,width:d/2})}),zIndex:1/0})],a[j.default.MULTI_POINT]=a[j.default.POINT],a[j.default.GEOMETRY_COLLECTION]=a[j.default.POLYGON].concat(a[j.default.LINE_STRING],a[j.default.POINT]),a}function h(a){return a.getGeometry()}Object.defineProperty(c,"__esModule",{value:!0}),c.toFunction=e,c.createDefaultStyle=f,c.createEditingStyle=g,c.default=void 0;var i=a("../asserts.js"),j=d(a("../geom/GeometryType.js")),k=d(a("../style/Circle.js")),l=d(a("../style/Fill.js")),m=d(a("../style/Stroke.js")),n=function(a){var b=a||{};this.geometry_=null,this.geometryFunction_=h,void 0!==b.geometry&&this.setGeometry(b.geometry),this.fill_=void 0!==b.fill?b.fill:null,this.image_=void 0!==b.image?b.image:null,this.renderer_=void 0!==b.renderer?b.renderer:null,this.stroke_=void 0!==b.stroke?b.stroke:null,this.text_=void 0!==b.text?b.text:null,this.zIndex_=b.zIndex};n.prototype.clone=function(){var a=this.getGeometry();return a&&a.clone&&(a=a.clone()),new n({geometry:a,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},n.prototype.getRenderer=function(){return this.renderer_},n.prototype.setRenderer=function(a){this.renderer_=a},n.prototype.getGeometry=function(){return this.geometry_},n.prototype.getGeometryFunction=function(){return this.geometryFunction_},n.prototype.getFill=function(){return this.fill_},n.prototype.setFill=function(a){this.fill_=a},n.prototype.getImage=function(){return this.image_},n.prototype.setImage=function(a){this.image_=a},n.prototype.getStroke=function(){return this.stroke_},n.prototype.setStroke=function(a){this.stroke_=a},n.prototype.getText=function(){return this.text_},n.prototype.setText=function(a){this.text_=a},n.prototype.getZIndex=function(){return this.zIndex_},n.prototype.setGeometry=function(a){"function"==typeof a?this.geometryFunction_=a:"string"==typeof a?this.geometryFunction_=function(b){return b.get(a)}:a?void 0!==a&&(this.geometryFunction_=function(){return a}):this.geometryFunction_=h,this.geometry_=a},n.prototype.setZIndex=function(a){this.zIndex_=a};var o=null,p=n;c.default=p},{"../asserts.js":47,"../geom/GeometryType.js":132,"../style/Circle.js":321,"../style/Fill.js":322,"../style/Stroke.js":330}],332:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=d(a("../style/Fill.js")),f=d(a("../style/TextPlacement.js")),g="#333",h=function(a){var b=a||{};this.font_=b.font,this.rotation_=b.rotation,this.rotateWithView_=b.rotateWithView,this.scale_=b.scale,this.text_=b.text,this.textAlign_=b.textAlign,this.textBaseline_=b.textBaseline,this.fill_=void 0!==b.fill?b.fill:new e.default({color:g}),this.maxAngle_=void 0!==b.maxAngle?b.maxAngle:Math.PI/4,this.placement_=void 0!==b.placement?b.placement:f.default.POINT,this.overflow_=!!b.overflow,this.stroke_=void 0!==b.stroke?b.stroke:null,this.offsetX_=void 0!==b.offsetX?b.offsetX:0,this.offsetY_=void 0!==b.offsetY?b.offsetY:0,this.backgroundFill_=b.backgroundFill?b.backgroundFill:null,this.backgroundStroke_=b.backgroundStroke?b.backgroundStroke:null,this.padding_=void 0===b.padding?null:b.padding};h.prototype.clone=function(){return new h({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},h.prototype.getOverflow=function(){return this.overflow_},h.prototype.getFont=function(){return this.font_},h.prototype.getMaxAngle=function(){return this.maxAngle_},h.prototype.getPlacement=function(){return this.placement_},h.prototype.getOffsetX=function(){return this.offsetX_},h.prototype.getOffsetY=function(){return this.offsetY_},h.prototype.getFill=function(){return this.fill_},h.prototype.getRotateWithView=function(){return this.rotateWithView_},h.prototype.getRotation=function(){return this.rotation_},h.prototype.getScale=function(){return this.scale_},h.prototype.getStroke=function(){return this.stroke_},h.prototype.getText=function(){return this.text_},h.prototype.getTextAlign=function(){return this.textAlign_},h.prototype.getTextBaseline=function(){return this.textBaseline_},h.prototype.getBackgroundFill=function(){return this.backgroundFill_},h.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},h.prototype.getPadding=function(){return this.padding_},h.prototype.setOverflow=function(a){this.overflow_=a},h.prototype.setFont=function(a){this.font_=a},h.prototype.setMaxAngle=function(a){this.maxAngle_=a},h.prototype.setOffsetX=function(a){this.offsetX_=a},h.prototype.setOffsetY=function(a){this.offsetY_=a},h.prototype.setPlacement=function(a){this.placement_=a},h.prototype.setFill=function(a){this.fill_=a},h.prototype.setRotation=function(a){this.rotation_=a},h.prototype.setScale=function(a){this.scale_=a},h.prototype.setStroke=function(a){this.stroke_=a},h.prototype.setText=function(a){this.text_=a},h.prototype.setTextAlign=function(a){this.textAlign_=a},h.prototype.setTextBaseline=function(a){this.textBaseline_=a},h.prototype.setBackgroundFill=function(a){this.backgroundFill_=a},h.prototype.setBackgroundStroke=function(a){this.backgroundStroke_=a},h.prototype.setPadding=function(a){this.padding_=a};var i=h;c.default=i},{"../style/Fill.js":322,"../style/TextPlacement.js":333}],333:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={POINT:"point",LINE:"line"};c.default=d},{}],334:[function(a,b,c){"use strict";function d(a,b,c,d){return void 0!==d?(d[0]=a,d[1]=b,d[2]=c,d):[a,b,c]}function e(a,b,c){return a+"/"+b+"/"+c}function f(a){return e(a[0],a[1],a[2])}function g(a){return a.split("/").map(Number)}function h(a){return(a[1]<<a[0])+a[2]}function i(a){var b,c,d=a[0],e=new Array(d),f=1<<d-1;for(b=0;b<d;++b)c=48,a[1]&f&&(c+=1),a[2]&f&&(c+=2),e[b]=String.fromCharCode(c),f>>=1;return e.join("")}function j(a,b){var c=a[0],d=a[1],e=a[2];if(b.getMinZoom()>c||c>b.getMaxZoom())return!1;var f,g=b.getExtent();return!(f=g?b.getTileRangeForExtentAndZ(g,c):b.getFullTileRange(c))||f.containsXY(d,e)}Object.defineProperty(c,"__esModule",{value:!0}),c.createOrUpdate=d,c.getKeyZXY=e,c.getKey=f,c.fromKey=g,c.hash=h,c.quadKey=i,c.withinExtentAndZ=j},{}],335:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){var b=a.getDefaultTileGrid();return b||(b=j(a),a.setDefaultTileGrid(b)),b}function f(a,b,c){var d=b[0],e=a.getTileCoordCenter(b),f=k(c);if((0,n.containsCoordinate)(f,e))return b;var g=(0,n.getWidth)(f),h=Math.ceil((f[0]-e[0])/g);return e[0]+=g*h,a.getTileCoordForCoordAndZ(e,d)}function g(a,b,c,d){var e=void 0!==d?d:o.default.TOP_LEFT,f=i(a,b,c);return new s.default({extent:a,origin:(0,n.getCorner)(a,e),resolutions:f,tileSize:c})}function h(a){var b={};return(0,p.assign)(b,void 0!==a?a:{}),void 0===b.extent&&(b.extent=(0,q.get)("EPSG:3857").getExtent()),b.resolutions=i(b.extent,b.maxZoom,b.tileSize),delete b.maxZoom,new s.default(b)}function i(a,b,c){for(var d=void 0!==b?b:l.DEFAULT_MAX_ZOOM,e=(0,n.getHeight)(a),f=(0,n.getWidth)(a),g=(0,m.toSize)(void 0!==c?c:l.DEFAULT_TILE_SIZE),h=Math.max(f/g[0],e/g[1]),i=d+1,j=new Array(i),k=0;k<i;++k)j[k]=h/Math.pow(2,k);return j}function j(a,b,c,d){return g(k(a),b,c,d)}function k(a){a=(0,q.get)(a);var b=a.getExtent();if(!b){var c=180*q.METERS_PER_UNIT[r.default.DEGREES]/a.getMetersPerUnit();b=(0,n.createOrUpdate)(-c,-c,c,c)}return b}Object.defineProperty(c,"__esModule",{value:!0}),c.getForProjection=e,c.wrapX=f,c.createForExtent=g,c.createXYZ=h,c.createForProjection=j,c.extentFromProjection=k;var l=a("./tilegrid/common.js"),m=a("./size.js"),n=a("./extent.js"),o=d(a("./extent/Corner.js")),p=a("./obj.js"),q=a("./proj.js"),r=d(a("./proj/Units.js")),s=d(a("./tilegrid/TileGrid.js"))},{"./extent.js":72,"./extent/Corner.js":73,"./obj.js":201,"./proj.js":210,"./proj/Units.js":212,"./size.js":279,"./tilegrid/TileGrid.js":336,"./tilegrid/common.js":338}],336:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("./common.js"),f=a("../asserts.js"),g=d(a("../TileRange.js")),h=a("../array.js"),i=a("../extent.js"),j=a("../math.js"),k=a("../size.js"),l=a("../tilecoord.js"),m=[0,0,0],n=function(a){var b=this;this.minZoom=void 0!==a.minZoom?a.minZoom:0,this.resolutions_=a.resolutions,(0,f.assert)((0,h.isSorted)(this.resolutions_,function(a,b){return b-a},!0),17);var c;if(!a.origins)for(var d=0,j=this.resolutions_.length-1;d<j;++d)if(c){if(b.resolutions_[d]/b.resolutions_[d+1]!==c){c=void 0;break}}else c=b.resolutions_[d]/b.resolutions_[d+1];this.zoomFactor_=c,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==a.origin?a.origin:null,this.origins_=null,void 0!==a.origins&&(this.origins_=a.origins,(0,f.assert)(this.origins_.length==this.resolutions_.length,20));var k=a.extent;void 0===k||this.origin_||this.origins_||(this.origin_=(0,i.getTopLeft)(k)),(0,f.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==a.tileSizes&&(this.tileSizes_=a.tileSizes,(0,f.assert)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==a.tileSize?a.tileSize:this.tileSizes_?null:e.DEFAULT_TILE_SIZE,(0,f.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==k?k:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==a.sizes?this.fullTileRanges_=a.sizes.map(function(a,b){return new g.default(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1))},this):k&&this.calculateTileRanges_(k)};n.prototype.forEachTileCoord=function(a,b,c){for(var d=this.getTileRangeForExtentAndZ(a,b),e=d.minX,f=d.maxX;e<=f;++e)for(var g=d.minY,h=d.maxY;g<=h;++g)c([b,e,g])},n.prototype.forEachTileCoordParentTileRange=function(a,b,c,d,e){var f,h,i,j=this,k=null,l=a[0]-1;for(2===this.zoomFactor_?(h=a[1],i=a[2]):k=this.getTileCoordExtent(a,e);l>=this.minZoom;){if(2===j.zoomFactor_?(h=Math.floor(h/2),i=Math.floor(i/2),f=(0,g.createOrUpdate)(h,h,i,i,d)):f=j.getTileRangeForExtentAndZ(k,l,d),b.call(c,l,f))return!0;--l}return!1},n.prototype.getExtent=function(){return this.extent_},n.prototype.getMaxZoom=function(){return this.maxZoom},n.prototype.getMinZoom=function(){return this.minZoom},n.prototype.getOrigin=function(a){return this.origin_?this.origin_:this.origins_[a]},n.prototype.getResolution=function(a){return this.resolutions_[a]},n.prototype.getResolutions=function(){return this.resolutions_},n.prototype.getTileCoordChildTileRange=function(a,b,c){if(a[0]<this.maxZoom){if(2===this.zoomFactor_){var d=2*a[1],e=2*a[2];return(0,g.createOrUpdate)(d,d+1,e,e+1,b)}var f=this.getTileCoordExtent(a,c);return this.getTileRangeForExtentAndZ(f,a[0]+1,b)}return null},n.prototype.getTileRangeExtent=function(a,b,c){var d=this.getOrigin(a),e=this.getResolution(a),f=(0,k.toSize)(this.getTileSize(a),this.tmpSize_),g=d[0]+b.minX*f[0]*e,h=d[0]+(b.maxX+1)*f[0]*e,j=d[1]+b.minY*f[1]*e,l=d[1]+(b.maxY+1)*f[1]*e;return(0,i.createOrUpdate)(g,j,h,l,c)},n.prototype.getTileRangeForExtentAndZ=function(a,b,c){var d=m;this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,d);var e=d[1],f=d[2];return this.getTileCoordForXYAndZ_(a[2],a[3],b,!0,d),(0,g.createOrUpdate)(e,d[1],f,d[2],c)},n.prototype.getTileCoordCenter=function(a){var b=this.getOrigin(a[0]),c=this.getResolution(a[0]),d=(0,k.toSize)(this.getTileSize(a[0]),this.tmpSize_);return[b[0]+(a[1]+.5)*d[0]*c,b[1]+(a[2]+.5)*d[1]*c]},n.prototype.getTileCoordExtent=function(a,b){var c=this.getOrigin(a[0]),d=this.getResolution(a[0]),e=(0,k.toSize)(this.getTileSize(a[0]),this.tmpSize_),f=c[0]+a[1]*e[0]*d,g=c[1]+a[2]*e[1]*d,h=f+e[0]*d,j=g+e[1]*d;return(0,i.createOrUpdate)(f,g,h,j,b)},n.prototype.getTileCoordForCoordAndResolution=function(a,b,c){return this.getTileCoordForXYAndResolution_(a[0],a[1],b,!1,c)},n.prototype.getTileCoordForXYAndResolution_=function(a,b,c,d,e){var f=this.getZForResolution(c),g=c/this.getResolution(f),h=this.getOrigin(f),i=(0,k.toSize)(this.getTileSize(f),this.tmpSize_),j=d?.5:0,m=d?0:.5,n=Math.floor((a-h[0])/c+j),o=Math.floor((b-h[1])/c+m),p=g*n/i[0],q=g*o/i[1];return d?(p=Math.ceil(p)-1,q=Math.ceil(q)-1):(p=Math.floor(p),q=Math.floor(q)),(0,l.createOrUpdate)(f,p,q,e)},n.prototype.getTileCoordForXYAndZ_=function(a,b,c,d,e){var f=this.getOrigin(c),g=this.getResolution(c),h=(0,k.toSize)(this.getTileSize(c),this.tmpSize_),i=d?.5:0,j=d?0:.5,m=Math.floor((a-f[0])/g+i),n=Math.floor((b-f[1])/g+j),o=m/h[0],p=n/h[1];return d?(o=Math.ceil(o)-1,p=Math.ceil(p)-1):(o=Math.floor(o),p=Math.floor(p)),(0,l.createOrUpdate)(c,o,p,e)},n.prototype.getTileCoordForCoordAndZ=function(a,b,c){return this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,c)},n.prototype.getTileCoordResolution=function(a){return this.resolutions_[a[0]]},n.prototype.getTileSize=function(a){return this.tileSize_?this.tileSize_:this.tileSizes_[a]},n.prototype.getFullTileRange=function(a){return this.fullTileRanges_?this.fullTileRanges_[a]:null},n.prototype.getZForResolution=function(a,b){var c=(0,h.linearFindNearest)(this.resolutions_,a,b||0);return(0,j.clamp)(c,this.minZoom,this.maxZoom)},n.prototype.calculateTileRanges_=function(a){for(var b=this,c=this.resolutions_.length,d=new Array(c),e=this.minZoom;e<c;++e)d[e]=b.getTileRangeForExtentAndZ(a,e);this.fullTileRanges_=d};var o=n;c.default=o},{"../TileRange.js":38,"../array.js":46,"../asserts.js":47,"../extent.js":72,"../math.js":199,"../size.js":279,"../tilecoord.js":334,"./common.js":338}],337:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=[],e=[],h=[],j=[],k=[],l=void 0!==c?c:[],m="SupportedCRS",n="TileMatrix",o="Identifier",p="ScaleDenominator",q="TopLeftCorner",r=a[m],s=(0,g.get)(r.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,g.get)(r),t=s.getMetersPerUnit(),u="ne"==s.getAxisOrientation().substr(0,2);return a[n].sort(function(a,b){return b[p]-a[p]}),a[n].forEach(function(b){if(!(l.length>0)||(0,f.find)(l,function(c){return b[o]==c[n]||-1===b[o].indexOf(":")&&a[o]+":"+b[o]===c[n]})){e.push(b[o]);var c=28e-5*b[p]/t,g=b.TileWidth,i=b.TileHeight;u?h.push([b[q][1],b[q][0]]):h.push(b[q]),d.push(c),j.push(g==i?g:[g,i]),k.push([b.MatrixWidth,-b.MatrixHeight])}}),new i({extent:b,origins:h,resolutions:d,matrixIds:e,tileSizes:j,sizes:k})}Object.defineProperty(c,"__esModule",{value:!0}),c.createFromCapabilitiesMatrixSet=e,c.default=void 0;var f=a("../array.js"),g=a("../proj.js"),h=d(a("../tilegrid/TileGrid.js")),i=function(a){function b(b){a.call(this,{extent:b.extent,origin:b.origin,origins:b.origins,resolutions:b.resolutions,tileSize:b.tileSize,tileSizes:b.tileSizes,sizes:b.sizes}),this.matrixIds_=b.matrixIds}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getMatrixId=function(a){return this.matrixIds_[a]},b.prototype.getMatrixIds=function(){return this.matrixIds_},b}(h.default),j=i;c.default=j},{"../array.js":46,"../proj.js":210,"../tilegrid/TileGrid.js":336}],338:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_TILE_SIZE=c.DEFAULT_MAX_ZOOM=void 0,c.DEFAULT_MAX_ZOOM=42,c.DEFAULT_TILE_SIZE=256},{}],339:[function(a,b,c){"use strict";function d(a,b){var c=/\{z\}/g,d=/\{x\}/g,e=/\{y\}/g,f=/\{-y\}/g;return function(g,h,j){return g?a.replace(c,g[0].toString()).replace(d,g[1].toString()).replace(e,function(){return(-g[2]-1).toString()}).replace(f,function(){var a=g[0],c=b.getFullTileRange(a);return(0,i.assert)(c,55),(c.getHeight()+g[2]).toString()}):void 0}}function e(a,b){for(var c=a.length,e=new Array(c),g=0;g<c;++g)e[g]=d(a[g],b);return f(e)}function f(a){return 1===a.length?a[0]:function(b,c,d){if(b){var e=(0,k.hash)(b),f=(0,j.modulo)(e,a.length);return a[f](b,c,d)}}}function g(a,b,c){}function h(a){var b=[],c=/\{([a-z])-([a-z])\}/.exec(a);if(c){var d,e=c[1].charCodeAt(0),f=c[2].charCodeAt(0);for(d=e;d<=f;++d)b.push(a.replace(c[0],String.fromCharCode(d)));return b}if(c=c=/\{(\d+)-(\d+)\}/.exec(a)){for(var g=parseInt(c[2],10),h=parseInt(c[1],10);h<=g;h++)b.push(a.replace(c[0],h.toString()));return b}return b.push(a),b}Object.defineProperty(c,"__esModule",{value:!0}),c.createFromTemplate=d,c.createFromTemplates=e,c.createFromTileUrlFunctions=f,c.nullTileUrlFunction=g,c.expandUrl=h;var i=a("./asserts.js"),j=a("./math.js"),k=a("./tilecoord.js")},{"./asserts.js":47,"./math.js":199,"./tilecoord.js":334}],340:[function(a,b,c){"use strict";function d(){return[1,0,0,1,0,0]}function e(a){return g(a,1,0,0,1,0,0)}function f(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=b[0],j=b[1],k=b[2],l=b[3],m=b[4],n=b[5];return a[0]=c*i+e*j,a[1]=d*i+f*j,a[2]=c*k+e*l,a[3]=d*k+f*l,a[4]=c*m+e*n+g,a[5]=d*m+f*n+h,a}function g(a,b,c,d,e,f,g){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a[4]=f,a[5]=g,a}function h(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a}function i(a,b){var c=b[0],d=b[1];return b[0]=a[0]*c+a[2]*d+a[4],b[1]=a[1]*c+a[3]*d+a[5],b}function j(a,b){var c=Math.cos(b),d=Math.sin(b);return f(a,g(q,c,d,-d,c,0,0))}function k(a,b,c){return f(a,g(q,b,0,0,c,0,0))}function l(a,b,c){return f(a,g(q,1,0,0,1,b,c))}function m(a,b,c,d,e,f,g,h){var i=Math.sin(f),j=Math.cos(f);return a[0]=d*j,a[1]=e*i,a[2]=-d*i,a[3]=e*j,a[4]=g*d*j-h*d*i+b,a[5]=g*e*i+h*e*j+c,a}function n(a){var b=o(a);(0,p.assert)(0!==b,32);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5];return a[0]=f/b,a[1]=-d/b,a[2]=-e/b,a[3]=c/b,a[4]=(e*h-f*g)/b,a[5]=-(c*h-d*g)/b,a}function o(a){return a[0]*a[3]-a[1]*a[2]}Object.defineProperty(c,"__esModule",{value:!0}),c.create=d,c.reset=e,c.multiply=f,c.set=g,c.setFromArray=h,c.apply=i,c.rotate=j,c.scale=k,c.translate=l,c.compose=m,c.invert=n,c.determinant=o;var p=a("./asserts.js"),q=new Array(6)},{"./asserts.js":47}],341:[function(a,b,c){"use strict";function d(a,b){var c=[];Object.keys(b).forEach(function(a){null!==b[a]&&void 0!==b[a]&&c.push(a+"="+encodeURIComponent(b[a]))});var d=c.join("&");return a=a.replace(/[?&]$/,""),(a=-1===a.indexOf("?")?a+"?":a+"&")+d}Object.defineProperty(c,"__esModule",{value:!0}),c.appendParams=d},{}],342:[function(a,b,c){"use strict";function d(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a}function e(a){return a.ol_uid||(a.ol_uid=++f)}Object.defineProperty(c,"__esModule",{value:!0}),c.inherits=d,c.getUid=e,c.VERSION=void 0;var f=0;c.VERSION="5.2.0"},{}],343:[function(a,b,c){"use strict";function d(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function e(a,b){return a[0]=b[0],a[1]=b[1],a[4]=b[2],a[5]=b[3],a[12]=b[4],a[13]=b[5],a}Object.defineProperty(c,"__esModule",{value:!0}),c.create=d,c.fromTransform=e},{}],344:[function(a,b,c){"use strict";function d(a,b){for(var c=e.length,d=0;d<c;++d)try{var f=a.getContext(e[d],b);if(f)return f}catch(a){}return null}Object.defineProperty(c,"__esModule",{value:!0}),c.getContext=d,c.EXTENSIONS=c.MAX_TEXTURE_SIZE=c.HAS=c.DEBUG=c.FRAMEBUFFER=c.COMPILE_STATUS=c.CLAMP_TO_EDGE=c.TEXTURE0=c.TEXTURE_2D=c.TEXTURE_WRAP_T=c.TEXTURE_WRAP_S=c.TEXTURE_MIN_FILTER=c.TEXTURE_MAG_FILTER=c.LINEAR=c.LINK_STATUS=c.VERTEX_SHADER=c.FRAGMENT_SHADER=c.RGBA=c.FLOAT=c.UNSIGNED_INT=c.UNSIGNED_SHORT=c.UNSIGNED_BYTE=c.SCISSOR_TEST=c.DEPTH_TEST=c.STENCIL_TEST=c.BLEND=c.CULL_FACE=c.DYNAMIC_DRAW=c.STATIC_DRAW=c.STREAM_DRAW=c.ELEMENT_ARRAY_BUFFER=c.ARRAY_BUFFER=c.ONE_MINUS_SRC_ALPHA=c.TRIANGLE_STRIP=c.TRIANGLES=c.COLOR_BUFFER_BIT=c.COLOR_ATTACHMENT0=c.SRC_ALPHA=c.ONE=void 0,c.ONE=1,c.SRC_ALPHA=770,c.COLOR_ATTACHMENT0=36064,c.COLOR_BUFFER_BIT=16384,c.TRIANGLES=4,c.TRIANGLE_STRIP=5,c.ONE_MINUS_SRC_ALPHA=771,c.ARRAY_BUFFER=34962,c.ELEMENT_ARRAY_BUFFER=34963,c.STREAM_DRAW=35040,c.STATIC_DRAW=35044,c.DYNAMIC_DRAW=35048,c.CULL_FACE=2884,c.BLEND=3042,c.STENCIL_TEST=2960,c.DEPTH_TEST=2929,c.SCISSOR_TEST=3089,c.UNSIGNED_BYTE=5121,c.UNSIGNED_SHORT=5123,c.UNSIGNED_INT=5125,c.FLOAT=5126,c.RGBA=6408,c.FRAGMENT_SHADER=35632,c.VERTEX_SHADER=35633,c.LINK_STATUS=35714,c.LINEAR=9729,c.TEXTURE_MAG_FILTER=10240,c.TEXTURE_MIN_FILTER=10241,c.TEXTURE_WRAP_S=10242,c.TEXTURE_WRAP_T=10243,c.TEXTURE_2D=3553,c.TEXTURE0=33984,c.CLAMP_TO_EDGE=33071,c.COMPILE_STATUS=35713,c.FRAMEBUFFER=36160
;var e=["experimental-webgl","webgl","webkit-3d","moz-webgl"];c.DEBUG=!0;var f;c.MAX_TEXTURE_SIZE=f;var g;c.EXTENSIONS=g;var h=!1;if(c.HAS=h,"undefined"!=typeof window&&"WebGLRenderingContext"in window)try{var i=document.createElement("canvas"),j=d(i,{failIfMajorPerformanceCaveat:!0});j&&(c.HAS=h=!0,c.MAX_TEXTURE_SIZE=f=j.getParameter(j.MAX_TEXTURE_SIZE),c.EXTENSIONS=g=j.getSupportedExtensions())}catch(a){}},{}],345:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../webgl.js"),e={STATIC_DRAW:d.STATIC_DRAW,STREAM_DRAW:d.STREAM_DRAW,DYNAMIC_DRAW:d.DYNAMIC_DRAW},f=function(a,b){this.arr_=void 0!==a?a:[],this.usage_=void 0!==b?b:e.STATIC_DRAW};f.prototype.getArray=function(){return this.arr_},f.prototype.getUsage=function(){return this.usage_};var g=f;c.default=g},{"../webgl.js":344}],346:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){var d=a.createTexture();return a.bindTexture(a.TEXTURE_2D,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),void 0!==b&&a.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,b),void 0!==c&&a.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,c),d}function f(a,b,c,d,f){var g=e(a,d,f);return a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null),g}function g(a,b,c,d){var f=e(a,c,d);return a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b),f}Object.defineProperty(c,"__esModule",{value:!0}),c.createEmptyTexture=f,c.createTexture=g,c.default=void 0;var h=a("../util.js"),i=a("../webgl.js"),j=d(a("../Disposable.js")),k=a("../array.js"),l=a("../events.js"),m=a("../obj.js"),n=d(a("../webgl/ContextEventType.js")),o=function(a){function b(b,c){a.call(this),this.canvas_=b,this.gl_=c,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=(0,k.includes)(i.EXTENSIONS,"OES_element_index_uint"),this.hasOESElementIndexUint&&c.getExtension("OES_element_index_uint"),(0,l.listen)(this.canvas_,n.default.LOST,this.handleWebGLContextLost,this),(0,l.listen)(this.canvas_,n.default.RESTORED,this.handleWebGLContextRestored,this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.bindBuffer=function(a,b){var c=this.getGL(),d=b.getArray(),e=String((0,h.getUid)(b));if(e in this.bufferCache_){var f=this.bufferCache_[e];c.bindBuffer(a,f.buffer)}else{var g=c.createBuffer();c.bindBuffer(a,g);var j;a==i.ARRAY_BUFFER?j=new Float32Array(d):a==i.ELEMENT_ARRAY_BUFFER&&(j=this.hasOESElementIndexUint?new Uint32Array(d):new Uint16Array(d)),c.bufferData(a,j,b.getUsage()),this.bufferCache_[e]={buf:b,buffer:g}}},b.prototype.deleteBuffer=function(a){var b=this.getGL(),c=String((0,h.getUid)(a)),d=this.bufferCache_[c];b.isContextLost()||b.deleteBuffer(d.buffer),delete this.bufferCache_[c]},b.prototype.disposeInternal=function(){var a=this;(0,l.unlistenAll)(this.canvas_);var b=this.getGL();if(!b.isContextLost()){for(var c in a.bufferCache_)b.deleteBuffer(a.bufferCache_[c].buffer);for(var d in a.programCache_)b.deleteProgram(a.programCache_[d]);for(var e in a.shaderCache_)b.deleteShader(a.shaderCache_[e]);b.deleteFramebuffer(this.hitDetectionFramebuffer_),b.deleteRenderbuffer(this.hitDetectionRenderbuffer_),b.deleteTexture(this.hitDetectionTexture_)}},b.prototype.getCanvas=function(){return this.canvas_},b.prototype.getGL=function(){return this.gl_},b.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},b.prototype.getShader=function(a){var b=String((0,h.getUid)(a));if(b in this.shaderCache_)return this.shaderCache_[b];var c=this.getGL(),d=c.createShader(a.getType());return c.shaderSource(d,a.getSource()),c.compileShader(d),this.shaderCache_[b]=d,d},b.prototype.getProgram=function(a,b){var c=(0,h.getUid)(a)+"/"+(0,h.getUid)(b);if(c in this.programCache_)return this.programCache_[c];var d=this.getGL(),e=d.createProgram();return d.attachShader(e,this.getShader(a)),d.attachShader(e,this.getShader(b)),d.linkProgram(e),this.programCache_[c]=e,e},b.prototype.handleWebGLContextLost=function(){(0,m.clear)(this.bufferCache_),(0,m.clear)(this.shaderCache_),(0,m.clear)(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},b.prototype.handleWebGLContextRestored=function(){},b.prototype.initHitDetectionFramebuffer_=function(){var a=this.gl_,b=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,b);var c=f(a,1,1),d=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,1,1),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,d),a.bindTexture(a.TEXTURE_2D,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=b,this.hitDetectionTexture_=c,this.hitDetectionRenderbuffer_=d},b.prototype.useProgram=function(a){return a!=this.currentProgram_&&(this.getGL().useProgram(a),this.currentProgram_=a,!0)},b}(j.default),p=o;c.default=p},{"../Disposable.js":9,"../array.js":46,"../events.js":66,"../obj.js":201,"../util.js":342,"../webgl.js":344,"../webgl/ContextEventType.js":347}],347:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};c.default=d},{}],348:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../webgl.js"),f=d(a("../webgl/Shader.js")),g=function(a){function b(b){a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return e.FRAGMENT_SHADER},b}(f.default),h=g;c.default=h},{"../webgl.js":344,"../webgl/Shader.js":349}],349:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a("../functions.js"),e=function(a){this.source_=a};e.prototype.getType=function(){},e.prototype.getSource=function(){return this.source_},e.prototype.isAnimated=d.FALSE;var f=e;c.default=f},{"../functions.js":126}],350:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=a("../webgl.js"),f=d(a("../webgl/Shader.js")),g=function(a){function b(b){a.call(this,b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getType=function(){return e.VERTEX_SHADER},b}(f.default),h=g;c.default=h},{"../webgl.js":344,"../webgl/Shader.js":349}],351:[function(a,b,c){"use strict";function d(a,b){return z.createElementNS(a,b)}function e(a,b){return f(a,b,[]).join("")}function f(a,b,c){if(a.nodeType==Node.CDATA_SECTION_NODE||a.nodeType==Node.TEXT_NODE)b?c.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):c.push(a.nodeValue);else{var d;for(d=a.firstChild;d;d=d.nextSibling)f(d,b,c)}return c}function g(a){return a instanceof Document}function h(a){return a instanceof Node}function i(a,b,c){return a.getAttributeNS(b,c)||""}function j(a){return(new DOMParser).parseFromString(a,"application/xml")}function k(a,b){return function(c,d){var e=a.call(void 0!==b?b:this,c,d);if(void 0!==e){var f=d[d.length-1];(0,y.extend)(f,e)}}}function l(a,b){return function(c,d){var e=a.call(void 0!==b?b:this,c,d);if(void 0!==e){d[d.length-1].push(e)}}}function m(a,b){return function(c,d){var e=a.call(void 0!==b?b:this,c,d);void 0!==e&&(d[d.length-1]=e)}}function n(a,b,c){return function(d,e){var f=a.call(void 0!==c?c:this,d,e);if(void 0!==f){var g,h=e[e.length-1],i=void 0!==b?b:d.localName;g=i in h?h[i]:h[i]=[],g.push(f)}}}function o(a,b,c){return function(d,e){var f=a.call(void 0!==c?c:this,d,e);if(void 0!==f){e[e.length-1][void 0!==b?b:d.localName]=f}}}function p(a,b){return function(c,d,e){a.call(void 0!==b?b:this,c,d,e),e[e.length-1].node.appendChild(c)}}function q(a,b){var c,d;return function(b,e,f){if(void 0===c){c={};var g={};g[b.localName]=a,c[b.namespaceURI]=g,d=r(b.localName)}w(c,d,e,f)}}function r(a,b){var c=a;return function(a,e,f){var g=e[e.length-1],h=g.node,i=c;return void 0===i&&(i=f),d(void 0!==b?b:h.namespaceURI,i)}}function s(a,b){for(var c=b.length,d=new Array(c),e=0;e<c;++e)d[e]=a[b[e]];return d}function t(a,b,c){var d,e,f=void 0!==c?c:{};for(d=0,e=a.length;d<e;++d)f[a[d]]=b;return f}function u(a,b,c,d){var e;for(e=b.firstElementChild;e;e=e.nextElementSibling){var f=a[e.namespaceURI];if(void 0!==f){var g=f[e.localName];void 0!==g&&g.call(d,e,c)}}}function v(a,b,c,d,e){return d.push(a),u(b,c,d,e),d.pop()}function w(a,b,c,d,e,f){for(var g,h,i=this,j=(void 0!==e?e:c).length,k=0;k<j;++k)void 0!==(g=c[k])&&void 0!==(h=b.call(void 0!==f?f:i,g,d,void 0!==e?e[k]:void 0))&&a[h.namespaceURI][h.localName].call(f,h,g,d)}function x(a,b,c,d,e,f,g){return e.push(a),w(b,c,d,e,f,g),e.pop()}Object.defineProperty(c,"__esModule",{value:!0}),c.createElementNS=d,c.getAllTextContent=e,c.getAllTextContent_=f,c.isDocument=g,c.isNode=h,c.getAttributeNS=i,c.parse=j,c.makeArrayExtender=k,c.makeArrayPusher=l,c.makeReplacer=m,c.makeObjectPropertyPusher=n,c.makeObjectPropertySetter=o,c.makeChildAppender=p,c.makeArraySerializer=q,c.makeSimpleNodeFactory=r,c.makeSequence=s,c.makeStructureNS=t,c.parseNode=u,c.pushParseAndPop=v,c.serialize=w,c.pushSerializeAndPop=x,c.OBJECT_PROPERTY_NODE_FACTORY=c.XML_SCHEMA_INSTANCE_URI=c.DOCUMENT=void 0;var y=a("./array.js"),z=document.implementation.createDocument("","",null);c.DOCUMENT=z,c.XML_SCHEMA_INSTANCE_URI="http://www.w3.org/2001/XMLSchema-instance";var A=r();c.OBJECT_PROPERTY_NODE_FACTORY=A},{"./array.js":46}],352:[function(a,b,c){"use strict";function d(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}function e(a,b,c){var d,e,f=c.buf;if(e=f[c.pos++],d=(112&e)>>4,e<128)return g(a,d,b);if(e=f[c.pos++],d|=(127&e)<<3,e<128)return g(a,d,b);if(e=f[c.pos++],d|=(127&e)<<10,e<128)return g(a,d,b);if(e=f[c.pos++],d|=(127&e)<<17,e<128)return g(a,d,b);if(e=f[c.pos++],d|=(127&e)<<24,e<128)return g(a,d,b);if(e=f[c.pos++],d|=(1&e)<<31,e<128)return g(a,d,b);throw new Error("Expected varint not more than 10 bytes")}function f(a){return a.type===d.Bytes?a.readVarint()+a.pos:a.pos+1}function g(a,b,c){return c?4294967296*b+(a>>>0):4294967296*(b>>>0)+(a>>>0)}function h(a,b){var c,d;if(a>=0?(c=a%4294967296|0,d=a/4294967296|0):(c=~(-a%4294967296),d=~(-a/4294967296),4294967295^c?c=c+1|0:(c=0,d=d+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");b.realloc(10),i(c,d,b),j(d,b)}function i(a,b,c){c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos]=127&a}function j(a,b){var c=(7&a)<<4;b.buf[b.pos++]|=c|((a>>>=3)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a)))))}function k(a,b,c){var d=b<=16383?1:b<=2097151?2:b<=268435455?3:Math.ceil(Math.log(b)/(7*Math.LN2));c.realloc(d);for(var e=c.pos-1;e>=a;e--)c.buf[e+d]=c.buf[e]}function l(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function m(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function n(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function o(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function p(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function q(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function r(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function s(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function t(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}function u(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+16777216*a[b+3]}function v(a,b,c){a[c]=b,a[c+1]=b>>>8,a[c+2]=b>>>16,a[c+3]=b>>>24}function w(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+(a[b+3]<<24)}function x(a,b,c){for(var d="",e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h>c)break;var i,j,k;1===h?f<128&&(g=f):2===h?128==(192&(i=a[e+1]))&&(g=(31&f)<<6|63&i)<=127&&(g=null):3===h?(i=a[e+1],j=a[e+2],128==(192&i)&&128==(192&j)&&((g=(15&f)<<12|(63&i)<<6|63&j)<=2047||g>=55296&&g<=57343)&&(g=null)):4===h&&(i=a[e+1],j=a[e+2],k=a[e+3],128==(192&i)&&128==(192&j)&&128==(192&k)&&((g=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k)<=65535||g>=1114112)&&(g=null)),null===g?(g=65533,h=1):g>65535&&(g-=65536,d+=String.fromCharCode(g>>>10&1023|55296),g=56320|1023&g),d+=String.fromCharCode(g),e+=h}return d}function y(a,b,c){for(var d,e,f=0;f<b.length;f++){if((d=b.charCodeAt(f))>55295&&d<57344){if(!e){d>56319||f+1===b.length?(a[c++]=239,a[c++]=191,a[c++]=189):e=d;continue}if(d<56320){a[c++]=239,a[c++]=191,a[c++]=189,e=d;continue}d=e-55296<<10|d-56320|65536,e=null}else e&&(a[c++]=239,a[c++]=191,a[c++]=189,e=null);d<128?a[c++]=d:(d<2048?a[c++]=d>>6|192:(d<65536?a[c++]=d>>12|224:(a[c++]=d>>18|240,a[c++]=d>>12&63|128),a[c++]=d>>6&63|128),a[c++]=63&d|128)}return c}b.exports=d;var z=a("ieee754");d.Varint=0,d.Fixed64=1,d.Bytes=2,d.Fixed32=5;var A=4294967296,B=1/A;d.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;this.type=7&d,a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=u(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=w(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=u(this.buf,this.pos)+u(this.buf,this.pos+4)*A;return this.pos+=8,a},readSFixed64:function(){var a=u(this.buf,this.pos)+w(this.buf,this.pos+4)*A;return this.pos+=8,a},readFloat:function(){var a=z.read(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=z.read(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var b,c,d=this.buf;return c=d[this.pos++],b=127&c,c<128?b:(c=d[this.pos++],b|=(127&c)<<7,c<128?b:(c=d[this.pos++],b|=(127&c)<<14,c<128?b:(c=d[this.pos++],b|=(127&c)<<21,c<128?b:(c=d[this.pos],b|=(15&c)<<28,e(b,a,this)))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=x(this.buf,this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.subarray(this.pos,a);return this.pos=a,b},readPackedVarint:function(a,b){var c=f(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(b));return a},readPackedSVarint:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readBoolean());return a},readPackedFloat:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readFloat());return a},readPackedDouble:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readDouble());return a},readPackedFixed32:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){var b=f(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed64());return a},skip:function(a){var b=7&a;if(b===d.Varint)for(;this.buf[this.pos++]>127;);else if(b===d.Bytes)this.pos=this.readVarint()+this.pos;else if(b===d.Fixed32)this.pos+=4;else{if(b!==d.Fixed64)throw new Error("Unimplemented type: "+b);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){var c=new Uint8Array(b);c.set(this.buf),this.buf=c,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),v(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),v(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),v(this.buf,-1&a,this.pos),v(this.buf,Math.floor(a*B),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),v(this.buf,-1&a,this.pos),v(this.buf,Math.floor(a*B),this.pos+4),this.pos+=8},writeVarint:function(a){if((a=+a||0)>268435455||a<0)return void h(a,this);this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127)))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var b=this.pos;this.pos=y(this.buf,a,this.pos);var c=this.pos-b;c>=128&&k(b,c,this),this.pos=b-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),z.write(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),z.write(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;c<b;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c;d>=128&&k(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,d.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){this.writeMessage(a,l,b)},writePackedSVarint:function(a,b){this.writeMessage(a,m,b)},writePackedBoolean:function(a,b){this.writeMessage(a,p,b)},writePackedFloat:function(a,b){this.writeMessage(a,n,b)},writePackedDouble:function(a,b){this.writeMessage(a,o,b)},writePackedFixed32:function(a,b){this.writeMessage(a,q,b)},writePackedSFixed32:function(a,b){this.writeMessage(a,r,b)},writePackedFixed64:function(a,b){this.writeMessage(a,s,b)},writePackedSFixed64:function(a,b){this.writeMessage(a,t,b)},writeBytesField:function(a,b){this.writeTag(a,d.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,d.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,d.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,d.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}}},{ieee754:2}],353:[function(a,b,c){"use strict";var d=a("./processor");c.Processor=d},{"./processor":354}],354:[function(a,b,c){"use strict";function d(a){function b(a,b,d){return c?new ImageData(a,b,d):{data:a,width:b,height:d}}var c=!0;try{new ImageData(10,10)}catch(a){c=!1}return function(c){var d,e,f=c.buffers,g=c.meta,h=c.imageOps,i=c.width,j=c.height,k=f.length,l=f[0].byteLength;if(h){var m=new Array(k);for(e=0;e<k;++e)m[e]=b(new Uint8ClampedArray(f[e]),i,j);d=a(m,g).data}else{d=new Uint8ClampedArray(l);var n=new Array(k),o=new Array(k);for(e=0;e<k;++e)n[e]=new Uint8ClampedArray(f[e]),o[e]=[0,0,0,0];for(var p=0;p<l;p+=4){for(var q=0;q<k;++q){var r=n[q];o[q][0]=r[p],o[q][1]=r[p+1],o[q][2]=r[p+2],o[q][3]=r[p+3]}var s=a(o,g);d[p]=s[0],d[p+1]=s[1],d[p+2]=s[2],d[p+3]=s[3]}}return d.buffer}}function e(a,b){var c=Object.keys(a.lib||{}).map(function(b){return"var "+b+" = "+a.lib[b].toString()+";"}),e=c.concat(["var __minion__ = ("+d.toString()+")(",a.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),f=new Blob(e,{type:"text/javascript"}),g=URL.createObjectURL(f),h=new Worker(g);return h.addEventListener("message",b),h}function f(a,b){var c=d(a.operation);return{postMessage:function(a){setTimeout(function(){b({data:{buffer:c(a),meta:a.meta}})},0)}}}function g(a){this._imageOps=!!a.imageOps;var b;b=0===a.threads?0:this._imageOps?1:a.threads||1;var c=[];if(b)for(var d=0;d<b;++d)c[d]=e(a,this._onWorkerMessage.bind(this,d));else c[0]=f(a,this._onWorkerMessage.bind(this,0));this._workers=c,this._queue=[],this._maxQueueLength=a.queue||1/0,this._running=0,this._dataLookup={},this._job=null}var h=a("./util").newImageData;g.prototype.process=function(a,b,c){this._enqueue({inputs:a,meta:b,callback:c}),this._dispatch()},g.prototype.destroy=function(){for(var a in this)this[a]=null;this._destroyed=!0},g.prototype._enqueue=function(a){for(this._queue.push(a);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},g.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var a=this._job=this._queue.shift(),b=a.inputs[0].width,c=a.inputs[0].height,d=a.inputs.map(function(a){return a.data.buffer}),e=this._workers.length;if(this._running=e,1===e)this._workers[0].postMessage({buffers:d,meta:a.meta,imageOps:this._imageOps,width:b,height:c},d);else for(var f=a.inputs[0].data.length,g=4*Math.ceil(f/4/e),h=0;h<e;++h){for(var i=h*g,j=[],k=0,l=d.length;k<l;++k)j.push(d[h].slice(i,i+g));this._workers[h].postMessage({buffers:j,meta:a.meta,imageOps:this._imageOps,width:b,height:c},j)}}},g.prototype._onWorkerMessage=function(a,b){this._destroyed||(this._dataLookup[a]=b.data,0===--this._running&&this._resolveJob())},g.prototype._resolveJob=function(){var a,b,c=this._job,d=this._workers.length;if(1===d)a=new Uint8ClampedArray(this._dataLookup[0].buffer),b=this._dataLookup[0].meta;else{var e=c.inputs[0].data.length;a=new Uint8ClampedArray(e),b=new Array(e);for(var f=4*Math.ceil(e/4/d),g=0;g<d;++g){var i=this._dataLookup[g].buffer,j=g*f;a.set(new Uint8ClampedArray(i),j),b[g]=this._dataLookup[g].meta}}this._job=null,this._dataLookup={},c.callback(null,h(a,c.inputs[0].width,c.inputs[0].height),b),this._dispatch()},b.exports=g},{"./util":355}],355:[function(a,b,c){"use strict";function d(a,b,c){if(e)return new ImageData(a,b,c);var d=f.createImageData(b,c);return d.data.set(a),d}var e=!0;try{new ImageData(10,10)}catch(a){e=!1}var f=document.createElement("canvas").getContext("2d");c.newImageData=d},{}],356:[function(a,b,c){"use strict";function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(a,e){"object"===(void 0===c?"undefined":d(c))&&void 0!==b?b.exports=e():"function"==typeof define&&define.amd?define(e):a.quickselect=e()}(void 0,function(){function a(a,c,e,f,g){b(a,c,e||0,f||a.length-1,g||d)}function b(a,d,e,f,g){for(;f>e;){if(f-e>600){var h=f-e+1,i=d-e+1,j=Math.log(h),k=.5*Math.exp(2*j/3),l=.5*Math.sqrt(j*k*(h-k)/h)*(i-h/2<0?-1:1);b(a,d,Math.max(e,Math.floor(d-i*k/h+l)),Math.min(f,Math.floor(d+(h-i)*k/h+l)),g)}var m=a[d],n=e,o=f;for(c(a,e,d),g(a[f],m)>0&&c(a,e,f);n<o;){for(c(a,n,o),n++,o--;g(a[n],m)<0;)n++;for(;g(a[o],m)>0;)o--}0===g(a[e],m)?c(a,e,o):(o++,c(a,o,f)),o<=d&&(e=o+1),d<=o&&(f=o-1)}}function c(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function d(a,b){return a<b?-1:a>b?1:0}return a})},{}],357:[function(a,b,c){"use strict";function d(a,b){if(!(this instanceof d))return new d(a,b);this._maxEntries=Math.max(4,a||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),b&&this._initFormat(b),this.clear()}function e(a,b,c){if(!c)return b.indexOf(a);for(var d=0;d<b.length;d++)if(c(a,b[d]))return d;return-1}function f(a,b){g(a,0,a.children.length,b,a)}function g(a,b,c,d,e){e||(e=q(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var f,g=b;g<c;g++)f=a.children[g],h(e,a.leaf?d(f):f);return e}function h(a,b){return a.minX=Math.min(a.minX,b.minX),a.minY=Math.min(a.minY,b.minY),a.maxX=Math.max(a.maxX,b.maxX),a.maxY=Math.max(a.maxY,b.maxY),a}function i(a,b){return a.minX-b.minX}function j(a,b){return a.minY-b.minY}function k(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function l(a){return a.maxX-a.minX+(a.maxY-a.minY)}function m(a,b){return(Math.max(b.maxX,a.maxX)-Math.min(b.minX,a.minX))*(Math.max(b.maxY,a.maxY)-Math.min(b.minY,a.minY))}function n(a,b){var c=Math.max(a.minX,b.minX),d=Math.max(a.minY,b.minY),e=Math.min(a.maxX,b.maxX),f=Math.min(a.maxY,b.maxY);return Math.max(0,e-c)*Math.max(0,f-d)}function o(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function p(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function q(a){return{children:a,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function r(a,b,c,d,e){for(var f,g=[b,c];g.length;)c=g.pop(),b=g.pop(),c-b<=d||(f=b+Math.ceil((c-b)/d/2)*d,s(a,f,b,c,e),g.push(b,f,f,c))}b.exports=d,b.exports.default=d;var s=a("quickselect");d.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!p(a,b))return c;for(var e,f,g,h,i=[];b;){for(e=0,f=b.children.length;e<f;e++)g=b.children[e],h=b.leaf?d(g):g,p(a,h)&&(b.leaf?c.push(g):o(a,h)?this._all(g,c):i.push(g));b=i.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!p(a,b))return!1;for(var d,e,f,g,h=[];b;){for(d=0,e=b.children.length;d<e;d++)if(f=b.children[d],g=b.leaf?c(f):f,p(a,g)){if(b.leaf||o(a,g))return!0;h.push(f)}b=h.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}var d=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var e=this.data;this.data=d,d=e}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},insert:function(a){return a&&this._insert(a,this.data.height-1),this},clear:function(){return this.data=q([]),this},remove:function(a,b){if(!a)return this;for(var c,d,f,g,h=this.data,i=this.toBBox(a),j=[],k=[];h||j.length;){if(h||(h=j.pop(),d=j[j.length-1],c=k.pop(),g=!0),h.leaf&&-1!==(f=e(a,h.children,b)))return h.children.splice(f,1),j.push(h),this._condense(j),this;g||h.leaf||!o(h,i)?d?(c++,h=d.children[c],g=!1):h=null:(j.push(h),k.push(c),c=0,d=h,h=h.children[0])}return this},toBBox:function(a){return a},compareMinX:i,compareMinY:j,toJSON:function(){return this.data},fromJSON:function(a){return this.data=a,this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,d){var e,g=c-b+1,h=this._maxEntries;if(g<=h)return e=q(a.slice(b,c+1)),f(e,this.toBBox),e;d||(d=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,d-1))),e=q([]),e.leaf=!1,e.height=d;var i,j,k,l,m=Math.ceil(g/h),n=m*Math.ceil(Math.sqrt(h));for(r(a,b,c,n,this.compareMinX),i=b;i<=c;i+=n)for(k=Math.min(i+n-1,c),r(a,i,k,m,this.compareMinY),j=i;j<=k;j+=m)l=Math.min(j+m-1,k),e.children.push(this._build(a,j,l,d-1));return f(e,this.toBBox),e},_chooseSubtree:function(a,b,c,d){for(var e,f,g,h,i,j,l,n;;){if(d.push(b),b.leaf||d.length-1===c)break;for(l=n=1/0,e=0,f=b.children.length;e<f;e++)g=b.children[e],i=k(g),j=m(a,g)-i,j<n?(n=j,l=i<l?i:l,h=g):j===n&&i<l&&(l=i,h=g);b=h||b.children[0]}return b},_insert:function(a,b,c){var d=this.toBBox,e=c?a:d(a),f=[],g=this._chooseSubtree(e,this.data,b,f);for(g.children.push(a),h(g,e);b>=0&&f[b].children.length>this._maxEntries;)this._split(f,b),b--;this._adjustParentBBoxes(e,f,b)},_split:function(a,b){var c=a[b],d=c.children.length,e=this._minEntries;this._chooseSplitAxis(c,e,d);var g=this._chooseSplitIndex(c,e,d),h=q(c.children.splice(g,c.children.length-g));h.height=c.height,h.leaf=c.leaf,f(c,this.toBBox),f(h,this.toBBox),b?a[b-1].children.push(h):this._splitRoot(c,h)},_splitRoot:function(a,b){this.data=q([a,b]),this.data.height=a.height+1,this.data.leaf=!1,f(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var d,e,f,h,i,j,l,m;for(j=l=1/0,d=b;d<=c-b;d++)e=g(a,0,d,this.toBBox),f=g(a,d,c,this.toBBox),h=n(e,f),i=k(e)+k(f),h<j?(j=h,m=d,l=i<l?i:l):h===j&&i<l&&(l=i,m=d);return m},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:i,e=a.leaf?this.compareMinY:j;this._allDistMargin(a,b,c,d)<this._allDistMargin(a,b,c,e)&&a.children.sort(d)},_allDistMargin:function(a,b,c,d){a.children.sort(d);var e,f,i=this.toBBox,j=g(a,0,b,i),k=g(a,c-b,c,i),m=l(j)+l(k);for(e=b;e<c-b;e++)f=a.children[e],h(j,a.leaf?i(f):f),m+=l(j);for(e=c-b-1;e>=b;e--)f=a.children[e],h(k,a.leaf?i(f):f),m+=l(k);return m},_adjustParentBBoxes:function(a,b,c){for(var d=c;d>=0;d--)h(b[d],a)},_condense:function(a){for(var b,c=a.length-1;c>=0;c--)0===a[c].children.length?c>0?(b=a[c-1].children,b.splice(b.indexOf(a[c]),1)):this.clear():f(a[c],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0])),this.compareMinY=new Function("a","b",b.join(a[1])),this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}}},{quickselect:356}]},{},[1]),function(a,b){"use strict";function c(c){function d(b,c){var d=a("body");fa.utils.trigger(d,b,c)}function e(){return fa.utils.t.apply(this,arguments)}function f(){return fa.utils.newDeferred.apply(this,arguments)}function g(){var b={trigger:"none",showTip:function(b){a(b).fadeIn(ga)},hideTip:function(b,c){a(b).animate({opacity:0},ga,c)},shrinkToFit:!0,padding:"0px",windowMargin:"0px",fill:"rgba(0, 0, 0, .9)",cornerRadius:10,strokeWidth:1,shadow:!0,shadowOffsetX:3,shadowOffsetY:3,shadowBlur:3,shadowColor:"rgba(6,6,6,.5)",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#666",strokeWidth:1},positions:["left","top"],cssStyles:{color:"#FFF"},closeWhenOthersOpen:!0,clickAnywhereToClose:!1},c=a(".crs-list");a.extend(a.bt.defaults,b),c.first().bt({contentSelector:"$('.help-1')"}),c.last().bt({contentSelector:"$('.help-2')"}),a(".source .container").bt({contentSelector:"$('.help-3')"}),a(".source .convert-button").bt({contentSelector:"$('.help-4')"}),a(".next_button").button({icons:{secondary:"ui-icon-seek-next"}})}function h(){a(".previous.history").button({icons:{primary:"ui-icon-seek-first"},text:!1}),a("#help").button({icons:{primary:"ui-icon-help"},text:!1}),a(".next.history").button({icons:{primary:"ui-icon-seek-end"},text:!1}),a(".source .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-s"}}),a(".destination .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-n"}}),a("#converter").draggable({handle:".drag-handle"}),a('input[type="text"]',"#p-research").addClass("ui-corner-all"),a("#p-new").dialog({closeText:e("close"),modal:!0,title:e("customSystem"),width:400,autoOpen:!1}),a("#p-crs").dialog({closeText:e("close"),modal:!0,title:e("systemDefinition"),width:500,autoOpen:!1}),a("#p-research").dialog({closeText:e("close"),modal:!0,title:e("research"),width:400,autoOpen:!1}),X(0,0)}function i(){a(".button-set").buttonset(),a("#auto-zoom-toggle").button({icons:{primary:"ui-icon-zoomin"},text:!1,disabled:!0}),a("#full-screen").button({icons:{primary:"ui-icon-arrow-4-diag"},text:!1}).closest("p").toggle(null!==a(document).fullScreen()),a("#o-container").accordion({collapsible:!0,active:!1,heightStyle:"content",icons:{header:"ui-icon-gear"}}),
a("#p-convention_help").dialog({closeText:e("close"),modal:!0,title:e("conventionTitle"),width:"840px",autoOpen:!1})}function j(){var b=fa.system.adsense.parameters;window.adsbygoogle=window.adsbygoogle||[],a("ins.adsbygoogle").each(function(){window.adsbygoogle.push({params:a.extend({},b)})})}function k(){var b=L(),c=a("#p-donate"),d=a("#p-loading"),f=d.find(".progressbar"),g=a(".progress-label");a(".section, .searchbtn").addClass("ui-corner-all"),a(".view").addClass("ui-corner-br ui-corner-tr"),a(".search-field").addClass("ui-corner-bl ui-corner-tl"),a("#p-poll").dialog({closeText:e("close"),modal:!0,title:e("poll"),width:500,open:function(){K("poll")},close:function(){J("poll")},autoOpen:"poll"==b}),fa.system.raterMasterSw&&!fa.context.session.userHasRatedOne&&F(!1),a("#p-contact").dialog({closeText:e("close"),modal:!0,title:e("contactUs"),width:500,open:function(){K("contact")},close:function(){J("contact")},autoOpen:"contact"==b}),a(".contact-button").button({icons:{secondary:"ui-icon-mail-closed"}}),c.find("input.dont-show-again").prop("checked",R("p-donate")),a(".help-1").find("input.dont-show-again").prop("checked",R("help-1")),c.dialog({closeText:e("close"),modal:!0,title:e("donate"),width:750,open:function(){K("donate")},close:function(){J("donate")},autoOpen:"donate"==b}),c.find(".progressbar").progressbar({value:fa.donations.total,max:fa.donations.max}),f.progressbar({value:!1,change:function(){g.text(Math.round(f.progressbar("value"))+"%")},complete:function(){g.text("Complete!")}}),a("#p-about").dialog({closeText:e("close"),modal:!0,title:e("about"),width:"70%",open:function(){K("about")},close:function(){J("about")},autoOpen:"about"==b}),a("body").on("history.indexchanged",function(a,b){var c=b.data;X(c.currentIndex,c.maxIndex)}),a("#p-info").dialog({closeText:e("close"),modal:!0,title:"Information",width:750,autoOpen:!0}),a("#csvFeatures").hide(),a("#language").find(">dt>a").button({icons:{secondary:"ui-icon-triangle-1-s"}}),fa.system.facebookEnabled&&(window.fbAsyncInit=function(){FB.init({appId:fa.system.facebookAppId,xfbml:!0,version:"v2.2"})},a.fn.getXDomain({url:"http://connect.facebook.net/"+fa.context.locale+"/sdk.js"})),fa.context.isDevEnv||(window.___gcfg={lang:fa.context.googlePlusLocale,parsetags:"onload"},a.fn.getXDomain({url:"https://apis.google.com/js/plusone.js"})),d.dialog({dialogClass:"no-close",modal:!0,title:e("loading"),autoOpen:!0}),a(".ui-widget-overlay").css({backgroundImage:"none",opacity:.7})}function l(a){return a.closest(".converter-container").hasClass("source")?"source":"destination"}function m(){var c=a("a.snippet"),e=16,f=a("#converter"),g=a("body");c.on("mouseenter",function(){a("body").append('<div id="Tip" style="z-index:9999;" class="ui-corner-all"><img src="'+this.href+'" alt="'+this.href+'"></div>')}),c.on("mousemove",function(b){a("#Tip").css({left:b.pageX+e,top:b.pageY+e}).show()}),c.on("mouseout",function(){a("#Tip").remove()}),c.click(function(a){a.preventDefault()}),a(".search-crs").click(function(b){var c=l(a(this));b.preventDefault(),a("#select").val(c),a("#p-research").dialog("open")}),f.on("converter.info",I),f.on("click",".show-p-new",function(b){var c=l(a(this));b.preventDefault(),a('#new-form input[name="target"]').val(c),a("#p-new").dialog("open")}),g.on("click","#view-reference",function(b){var c="http://spatialreference.org/ref/?search="+encodeURIComponent(a("#find-reference").val());b.preventDefault(),window.open(c)}),g.on("submit","#reference-form",function(b){b.preventDefault(),a("#view-reference").click()}),a("#crsResult").on("change",function(b){D(a(b.target).val())}),a("#research").click(function(a){a.preventDefault(),C()}),ca=new b("#converter .octicon-clippy",{text:function(b){var c=a(b),d=c.closest(".converter-container");if(d.length)return d.converter("value").toString()}}),ca.on("success",function(b){a(b.trigger).animate({opacity:.3},500,function(){a(this).animate({opacity:1},500)}),d("clipboard.aftercopy")})}function n(){a("#help").animate({opacity:"hide"},ga),a(".crs-list").first().btOn()}function o(){R("help-1")||n()}function p(){a(".close_button, .help-4 .next_button").click(function(b){b.preventDefault(),a("#help").animate({opacity:"show"},ga)}),a(".next_button").click(function(a){a.preventDefault()}),a(".close_button",".help-1").click(function(){a(".crs-list").first().btOff()}),a(".close_button",".help-2").click(function(){a(".crs-list").last().btOff()}),a(".close_button",".help-3").click(function(){a(".source .container").btOff()}),a(".close_button, .next_button",".help-4").click(function(){a(".source .convert-button").btOff()}),a(".next_button",".help-1").click(function(){a(".crs-list").last().btOn()}),a(".next_button",".help-2").click(function(){a(".source .container").btOn()}),a(".next_button",".help-3").click(function(){a(".source .convert-button").btOn()}),a(".help-1").find("input.dont-show-again").on("change",function(){Q("help-1",a(this)[0].checked)}),a("#help").click(function(){event.preventDefault(),n()})}function q(){var b=a(".dropdown dd ul"),c=a(".dropdown dt a");c.click(function(a){a.preventDefault(),b.slideToggle(200)}),b.find("li a").click(function(d){var e;d.preventDefault(),e=a(this).html(),a(this).parent().find("span.value").text(),c.find("span").html(e),b.hide(),document.location.href=a(this).prop("href")}),a(document).click(function(c){a(c.target).parents().hasClass("dropdown")||b.hide()})}function r(a){T(a),d("ui.csv_changed",a)}function s(){a(".convention").click(function(b){b.preventDefault(),a("#p-convention_help").dialog("open")}),a("#full-screen").click(function(a){a.preventDefault(),d("ui.full_screen")}),a("#auto-zoom-toggle").click(function(){fa.utils.enableAutoZoom(a(this).is(":checked"))}),a('input[name="csv"]').click(function(){r(!!+a(this).val())}),a('input[name="convention"]').click(function(){W(!!+a(this).val())}),a("body").on("converterset.csv_changed main.ready",function(a,b){var c=void 0===b.data?b.csv:b.data.csv;S(c),T(c)})}function t(){var b=a("body");a(".toggle-next").click(function(b){b.preventDefault(),a(this).parent().find(".toogle-me").toggle()}),a(document).on("fullscreenchange",function(){P(),Y()}),a(document).on("mousemove",function(a){Z(a.target,".trsp-panel, #converter")}),b.on("click",".show-p-poll",function(a){a.preventDefault(),F()}),b.on("mousedown","#view-map, .donate_btn, .about, converter.info, .convert-button, .contact, .search-crs, .show-p-new",function(){P()}),b.on("map.metrics_changed",function(a,b){z(b.data)}),b.on("map.tiles_loaded",function(){j()}),b.on("converter.changed",function(a,b){V(b.data.magneticDeclinationInDegrees)}),a("#p-donate").find("input.dont-show-again").on("change",function(){Q("p-donate",a(this)[0].checked)}),a(".donate_btn").click(function(b){b.preventDefault(),a("#p-donate").dialog("open")}),a(".about").click(function(b){b.preventDefault(),a("#p-about").dialog("open")}),b.one("main.ready",function(){setTimeout(x,800)}),b.on("main.start",y),b.on("main.failed",{message:": failure! "+e("contactUs"),className:"failure"},function(){y.apply(this,arguments),x()}),b.on("main.succeeded",{message:": success.",className:"success"},function(){var b=a("#p-loading").find(".progressbar"),c=b.progressbar("value")||0;y.apply(this,arguments),b.progressbar("value",c+20)}),b.on("click",".ui-widget-overlay",function(){P()})}function u(b){a(".contact").click(function(b){b.preventDefault(),a("#p-contact").dialog("open")}),b||(a("#contact-form").on("submit",function(b){b.preventDefault(),a("#send-message").click()}),a("#send-message").click(function(b){b.preventDefault(),a("#p-contact").dialog("close"),M()&&N()}))}function v(){a(document).keyup(function(a){switch(a.keyCode){case 27:a.preventDefault(),P();break;case 122:a.preventDefault(),d("ui.full_screen")}})}function w(){h(),i(),g(),k(),m(),s(),p(),t(),u(),q(),v()}function x(){var b=a("#p-loading");b.find(".failure").length?b.closest(".no-close").find(".ui-dialog-titlebar-close").show():(b.dialog("close"),R("p-donate")||fa.context.GET.isSetNoDonate||a("#p-donate").dialog("open")),a(".ui-widget-overlay").removeAttr("style")}function y(b,c){var d,e=c.data,f=e.name,g=a("#p-loading .logs"),h="loading-"+f.toLowerCase().replace(/\s/gi,"-"),i=b.data,j=e.message?": "+e.message:i?i.message:void 0;if(!g.find("."+h).length){var k=a("<div>",{class:h}).text("Loading "+f);g.append(k)}d=g.find("."+h),i&&j&&i.className&&d.length&&!d.hasClass(i.className)&&d.addClass(i.className).append(j)}function z(a){void 0!==a&&(A(a.length),B(a.area))}function A(b){var c=e("unitMeter"),d=0;b&&void 0!==b?(b>999&&(c=e("unitKilometer"),b/=1e3,d=1),a("#lengthContainer").text(fa.math.round(b,d).toString()+c)):a("#lengthContainer").text("-"+c)}function B(b){var c=e("unitMeter")+"<sup>2</sup>",d=0;b&&void 0!==b?(b>999999&&(c=e("unitKilometer")+"<sup>2</sup>",b/=1e6,d=1),a("#areaContainer").html(fa.math.round(b,d).toString()+c)):a("#areaContainer").html("-"+c)}function C(){var b=a("#crsResult");b.html('<option value="#" class="disabledoption">'+e("loading")+"</option>").prop("disabled",!0),a.post(fa.system.httpServer+"/"+fa.system.dirWsIncludes+"c.php",{l:fa.context.languageCode,i:a("#crsCountry").val(),c:a("#crsCode").val(),n:a("#crsName").val(),f:""}).done(function(c){b.html(""),a(c).length?(b.prop("disabled",!1),a.each(c,function(b,c){a.each(c,function(c,d){fa.utils.addOptionToSelect(b,c,a("#crsResult"),d.def)})})):b.append(a("<option>",{val:"",text:e("resultEmpty"),classname:"disabledoption"}))}).fail(function(){b.html(""),b.append(a("<option>",{val:"",text:e("resultEmpty"),classname:"disabledoption"}))})}function D(b){var c=a("#select").val();a("#closeSearch").prop("checked")&&a("#p-research").dialog("close"),App.TWCCConverter.setSelection(c,b)}function E(){return'<div class="loading"><img src="'+fa.system.dirWsImages+'loading.gif" alt="" width="35" height="35">'+e("loading")+"</div>"}function F(b){b=void 0===b||b,a("#poll-info").html(E()),b&&P(),a("#p-poll").dialog("open"),G()}function G(b){b=b||"",a("#poll-info").html(E()),a.post(fa.system.dirWsModules+"rater/forms.php","rater=true&"+b,H)}function H(b){var c=a("#poll-info");c.html(b),c.find("form").each(function(){a(this).on("submit",function(b){b.preventDefault(),G(a(this).serialize())}),u(!0)})}function I(b,c){var d=a("#crs-info");d.html(E()),a.post(fa.system.dirWsIncludes+"crs_info.php",{c:c.srsCode,d:c.definitionString,l:fa.context.languageCode},function(a){d.html(a)}),a("#p-crs").dialog("open")}function J(){window.location.hash=""}function K(a){window.location.hash="#"+a}function L(){return window.location.hash.replace("#","")}function M(){return a("#message").val().length<1?(alert(e("messageNotSent")+"empty msg."),a("#p-contact").dialog("open"),!1):!(a("#email").val().length<1)||(alert(e("messageWrongEmail")),a("#p-contact").dialog("open"),!1)}function N(){fa.utils.sendMsg(a("#message").val(),a("#email").val(),O)}function O(b){switch(b){case"1":alert(e("messageSent"));break;case"-3":alert(e("messageWrongEmail"));break;default:alert(e("messageNotSent")+b)}"1"==b?(a("#email").val(""),a("#message").val("")):a("#p-contact").dialog("open")}function P(){a(".crs-list, .source .container, .source .convert-button").each(function(){a(this).btOff()}),a("#help").animate({opacity:"show"},ga),a("#p-new").dialog("close"),a("#p-contact").dialog("close"),a("#p-about").dialog("close"),a("#p-crs").dialog("close"),a("#p-poll").dialog("close"),a("#p-info").dialog("close"),a("#p-donate").dialog("close"),a("#p-research").dialog("close"),a("#p-convention_help").dialog("close")}function Q(a,b){fa.utils.setPreferenceCookie(a,b)}function R(a){return fa.utils.getPreferenceCookie(a)}function S(b){b!==U()&&(a('input[name="csv"][value="'+ +b+'"]').prop("checked",!0),a(".csv-radio").buttonset("refresh"))}function T(b){b=!!b,a("#manualFeatures").toggle(!b),a("#csvFeatures").toggle(b),b?(a("#auto-zoom-toggle").button("enable"),a(".convention-radio").buttonset("disable"),z()):(a("#auto-zoom-toggle").button("disable"),a(".convention-radio").buttonset("enable"))}function U(){return!!+a('input[name="csv"]:checked').val()}function V(b){var c=void 0===b?"":fa.math.round(b,4).toString();a("#magneticDeclinationContainer").text(c)}function W(a){ea=a,d("ui.convergence_changed")}function X(b,c){var d=0,e=b<c,f=b>d;a(".previous.history").button("option","disabled",!f),a(".next.history").button("option","disabled",!e)}function Y(){a(document).fullScreen()?a(".trsp-panel, .spare, #converter, #h-container").fadeOut():a(".trsp-panel, .spare, #converter, #h-container").fadeIn()}function Z(b,c){a(document).fullScreen()&&(a(c).is(":hidden")?a(c).fadeIn():a(b).closest(c).length?clearInterval(ha[c]):(clearInterval(ha[c]),ha[c]=setTimeout(function(){a(document).fullScreen()&&a(c).fadeOut()},1e3)))}function $(){"undefined"==typeof blockAdBlock?_():blockAdBlock.onDetected(_).onNotDetected(aa)}function _(){da.reject(e("pleaseDisableYourAdblock"))}function aa(){da.resolve()}function ba(){da=f("UI"),w(),$()}var ca,da=null,ea=!0,fa=a.extend(!0,{},c),ga=250,ha={};return ba(),{promise:da.promise(),getConvergenceConvention:function(){return ea},startHelp:o,setCsvMode:r}}if(void 0===window.TWCCUi){var d;window.TWCCUi={getInstance:function(a){return d=d||c(a)}}}}(jQuery,ClipboardJS),function(a){"use strict";if(void 0===window.TWCCConverter){var b,c=function(b){function c(){return t.utils.t.apply(this,arguments)}function d(){return t.utils.newDeferred.apply(this,arguments)}function e(a){return c("errorContactUs").replace("%s",a.status.toString())}function f(b,d){var e="",f=new RegExp("\\+title=[^\\+]+","i");return""===b?"":(b=b.toString().replace(f,""),a.each(r.options.definitions,function(g,h){if(a.each(h,function(a,h){var i=h.def||"";if(a.toUpperCase()==b.toUpperCase()||i.toUpperCase().replace(f,"")==b.toUpperCase())return e=c("crsAlreadyExists")+g+" > "+(i?t.utils.getTitleFromDefinitionString(i,a):a),o(d,a),!1}),""!==e)return!1}),e)}function g(a,b){var c={"*[UD]":{}};return c["*[UD]"][b]={def:a,isConnector:!1},r.mergeDefinitions(c)}function h(b,c){alert(b),a("#loadingxtra").hide(),a("#new-form").show(),c?s--:(a("#p-new").dialog("close"),a("#find-reference").val(""),a("#add-reference").val(""))}function i(a,b,c){var d=a.split(":");return c=c||!1,b.replace(/\$\{\d\}/gi,function(a){a=a.match(/\d+/)[0];var b=d[a]||a;return c?b.toUpperCase():b.toLowerCase()})}function j(a,b,c){window.Proj4js={defs:{}},b(c).done(function(){m(Proj4js.defs[a])}).fail(function(a){h(e(a),!0)}).always(function(){delete window.Proj4js})}function k(b){var c=i(b,"http://spatialreference.org/ref/${0}/${1}/proj4js/");window.Proj4js={defs:{}},j(b,a.fn.getXDomain,{url:c})}function l(b){var c=i(b,"/js/data/defs/${0}${1}.js",!0);j(b,a.ajax,{url:c,cache:!0,dataType:"script"})}function m(b){var d,e,i,j,m,p=a("#new-form input[name='target']").val(),q=b.toUpperCase(),r=0===q.indexOf("EPSG:"),u=0===q.indexOf("ESRI:"),v=0===q.indexOf("IAU2000:"),w=0===q.indexOf("SR-ORG:"),x=0===q.indexOf("IGNF:");if(a("#new-form").hide(),a("#loadingxtra").show(),j=f(b,p))return void h(j);if(r||u||v||w)e=q,k(e);else if(x)e=q,l(e);else{if(i=b.match(new RegExp('^[^\\[]+\\["([^\\]]+)"\\][\\s=]+"([^"]+)";$',"i")),null!==i&&(b=i[2]),d=t.utils.getTitleFromDefinitionString(b,""),s++,e="UD"+s,void 0===d&&(d=c("undefinedTitle"),b="+title="+d+" "+b),m=e+" "+d,b=b.replace("+title="+d,"+title="+m),j=f(e,p),j||(j=f(b,p)),j)return void h(j);g(b,e).done(function(){a("#loadingxtra").hide(),a("#new-form").show();var d=o(p);try{o(p,e),alert(c("newSystemAdded")+'"'+m+'".'),a("#p-new").dialog("close"),a("#find-reference").val(""),a("#add-reference").val(""),t.utils.sendMsg("New user-defined system:\n\r"+e+' = "'+b+'"')}catch(a){s--,o(p,d),n(e),""===b?alert(c("errorContactUs").replace("%s","-2 (NotFound)")):alert(c("errorContactUs").replace("%s","-1 (WrongFormat:"+b+")"))}})}}function n(a){r.unloadCRS(a)}function o(a,b){a=a.toLowerCase();var c="pushPull"+a.charAt(0).toUpperCase()+a.slice(1);return r[c]("selection",b)}function p(){var b=t.context.converter,f=b.defaultSourceSrs,g=b.defaultDestSrs,h=b.defaultWgs84,i=!(""===h||""===h.x||""===h.y),j=a("#converter"),k=a("body"),l={units:{dms:{D:c("unitDegree"),M:c("unitMinute"),S:c("unitSecond")},dd:{x:{DD:c("unitDegreeEast")},y:{DD:c("unitDegreeNorth")}},cartesian:{XY:{m:c("unitMeter"),km:c("unitKilometer"),"us-ft":c("unitFeet")},CONVERGENCE:c("unitDegree")}},labels:{spherical:{x:c("labelLng"),y:c("labelLat"),convergence:c("labelConvergence")},cartesian:{x:c("labelX"),y:c("labelY"),z:c("labelZone"),h:c("labelHemi"),convergence:c("labelConvergence")},csv:{csv:c("labelCsv"),l:c("labelFormat")}},options:{x:{E:c("optionE"),W:c("optionW")},y:{N:c("optionN"),S:c("optionS")},o:{_DMS:c("optionDMS"),_DM:c("optionDM"),_DD:c("optionDD")},h:{n:c("optionNorth"),s:c("optionSouth")},u:{_M:c("optionM"),_KM:c("optionKM"),_F:c("optionF")}}};b.fromUrl&&!i&&alert("Invalid URL"),h=b.fromUrl&&i?[h]:b.fromRss?[{x:10,y:10}]:null,t.context.converter.fromUrl=!1,t.context.converter.fromRss=!1,q=d("Converter"),r=j.converterSet({units:l.units,labels:l.labels,options:l.options,wgs84:h,defaultWgs84:[t.utils.getRandomCityLocation()],value:{x:0,y:0},selections:{source:f,destination:g},url:t.system.httpServer+"/"+t.system.dirWsIncludes+"c.php"}).data("twccConverterSet"),j.one("converterset.done",function(a,b){q.resolve(b)}),j.on("converterset.fail",function(a,b){var c=e.call(null,b);alert(c)}),k.on("click","#new-reference",function(b){b.preventDefault(),m(a("#add-reference").val())}),k.on("submit","#new-form",function(b){b.preventDefault(),a("#new-reference").click()}),k.on("ui.convergence_changed",function(){r.setConvergence()}),k.on("ui.csv_changed",function(a,b){r.csv(b.data)}),a(".to-remove").remove()}var q=null,r=null,s=0,t=a.extend(!0,{},b);return p(),{promise:q.promise(),converterWidget:r,setSelection:o}};window.TWCCConverter={getInstance:function(a){return b=b||c(a)}}}}(jQuery),function(a,b,c,d){"use strict";!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(a,b,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-17790812-2","auto"),ga("send","pageview"),c(b).ready(function(){function a(a,b,c,d){try{ga("send","event",a,b,c,d)}catch(a){}}function b(a,b,c,d){try{ga("send","timing",a,b,c,d)}catch(a){}}function e(b,c){a("main","fails",c.data.name)}function f(b,c){a("xhr","fails",c.data)}function g(b,c){a("layer","change",c.data)}function h(b){a("select","change",c(b.target).find("option:selected").text())}function i(b){a("radio","click",c(b.target).val())}function j(b){a("radio","click",c(b.target).prop("name"))}function k(){a("clipboard","click")}function l(){a("clipboard","success")}function m(){a("converter","changed")}function n(){b("TWCC","Render infowindow",(new Date).getTime()-d.context.startTime),a("infowindow","opened")}function o(){var a=c("body");a.on("change",".crs-list",h),a.on("click",'#converter input[type="radio"]',i),a.on("click",'#o-container input[type="radio"]',j),a.on("click",".octicon-clippy",k),a.on("clipboard.aftercopy",l),a.on("converter.changed",m),a.on("xhr.failed",f),a.on("map.layer.change",g),a.one("infowindow.dom_ready",n),a.one("main.failed",e),a.one("main.ready",function(b,c){(void 0===c.data?c.csv:c.data.csv)&&a.off("infowindow.dom_ready",n)})}o()})}(window,document,jQuery,App);