/*!  * TWCC - Version 2.4.2
 * The World Coordinate Converter
 * Author: Clément Ronzon - clem.rz@gmail.com
 * Build date: 2022-12-14 08:46:51
 * Copyright (c) 2022 
 * Released under the AGPL-3.0 license
 *
 * This file is part of TWCC.
 *
 * TWCC is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TWCC is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with TWCC.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @copyright Copyright (c) 2010-2014 Clément Ronzon
 * @license http://www.gnu.org/licenses/agpl.txt
 */
function d(e){var t,r;if(this.length){if((t=this[0]).ownerDocument?r=t.ownerDocument:t=(r=t).documentElement,null==e)return r.cancelFullScreen||r.webkitCancelFullScreen||r.mozCancelFullScreen?(e=!!r.fullScreen||!!r.webkitIsFullScreen||!!r.mozFullScreen)&&(r.fullScreenElement||r.webkitCurrentFullScreenElement||r.mozFullScreenElement||e):null;e?(e=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen)&&e.call(t,Element.ALLOW_KEYBOARD_INPUT):(e=r.cancelFullScreen||r.webkitCancelFullScreen||r.mozCancelFullScreen)&&e.call(r)}return this}var e,f,g,cookieScripts=(!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ClipboardJS=t():e.ClipboardJS=t()}(this,function(){return r=[function(e,t,r){var n;r=[e,r(7)],void 0!==(t="function"==typeof(n=function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(e){return e&&e.__esModule?e:{default:e}}(t),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=function(){function t(e){r(this,t),this.resolveOptions(e),this.initSelection()}return o(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var r=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=r+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,n.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,n.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":i(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),t}();e.exports=a})?n.apply(t,r):n)&&(e.exports=t)},function(e,t,r){var l=r(6),c=r(5);e.exports=function(e,t,r){if(!e&&!t&&!r)throw new Error("Missing required arguments");if(!l.string(t))throw new TypeError("Second argument must be a String");if(!l.fn(r))throw new TypeError("Third argument must be a Function");if(l.node(e))return i=t,o=r,(n=e).addEventListener(i,o),{destroy:function(){n.removeEventListener(i,o)}};var n,i,o,a,s,u;if(l.nodeList(e))return a=e,s=t,u=r,Array.prototype.forEach.call(a,function(e){e.addEventListener(s,u)}),{destroy:function(){Array.prototype.forEach.call(a,function(e){e.removeEventListener(s,u)})}};if(l.string(e))return c(document.body,e,t,r);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){function n(){i.off(e,n),t.apply(r,arguments)}var i=this;return n._=t,this.on(e,n,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,i=r.length;n<i;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],i=[];if(n&&t)for(var o=0,a=n.length;o<a;o++)n[o].fn!==t&&n[o].fn._!==t&&i.push(n[o]);return i.length?r[e]=i:delete r[e],this}},e.exports=r},function(e,t,r){var n;r=[e,r(0),r(2),r(1)],void 0!==(t="function"==typeof(n=function(e,t,r,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var r="data-clipboard-"+e;if(t.hasAttribute(r))return t.getAttribute(r)}var l=i(t),c=i(r),f=i(n),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),d=function(e){function n(e,t){o(this,n);var r=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return r.resolveOptions(t),r.listenClick(e),r}return s(n,e),p(n,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===h(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,f.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new l.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return u("action",e)}},{key:"defaultTarget",value:function(e){var t=u("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return u("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,r=!!document.queryCommandSupported;return t.forEach(function(e){r=r&&!!document.queryCommandSupported(e)}),r}}]),n}(c.default);e.exports=d})?n.apply(t,r):n)&&(e.exports=t)},function(e,t){var r;"undefined"==typeof Element||Element.prototype.matches||((r=Element.prototype).matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector),e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},function(e,t,r){function o(e,t,r,n,i){var o=function(t,r,e,n){return function(e){e.delegateTarget=a(e.target,r),e.delegateTarget&&n.call(t,e)}}.apply(this,arguments);return e.addEventListener(r,o,i),{destroy:function(){e.removeEventListener(r,o,i)}}}var a=r(4);e.exports=function(e,t,r,n,i){return"function"==typeof e.addEventListener?o.apply(null,arguments):"function"==typeof r?o.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return o(e,t,r,n,i)}))}},function(e,r){r.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},r.nodeList=function(e){var t=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in e&&(0===e.length||r.node(e[0]))},r.string=function(e){return"string"==typeof e||e instanceof String},r.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e){var t,r;return e="SELECT"===e.nodeName?(e.focus(),e.value):"INPUT"===e.nodeName||"TEXTAREA"===e.nodeName?((t=e.hasAttribute("readonly"))||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),t||e.removeAttribute("readonly"),e.value):(e.hasAttribute("contenteditable")&&e.focus(),t=window.getSelection(),(r=document.createRange()).selectNodeContents(e),t.removeAllRanges(),t.addRange(r),t.toString())}}],i={},n.m=r,n.c=i,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3);function n(e){var t;return(i[e]||(t=i[e]={i:e,l:!1,exports:{}},r[e].call(t.exports,t,t.exports,n),t.l=!0,t)).exports}var r,i}),!function(p){"use strict";var t,r;void 0===window.TWCCHistory&&(r=function(e){var t,r,n=p.extend(!0,{},e),i=!0,o=n.system.historyCookie,a=0,s=n.system.historyLimit;function u(e){t=e}function l(){return t.length-1}function c(e){r=Math.min(Math.abs(e),s),n.utils.trigger(p("body"),"history.indexchanged",{currentIndex:e,maxIndex:l(),currentValue:f()})}function f(){return t[r]}function h(e){return c(e),f()}return t=n.utils.getCookieContent(o),p.isEmptyObject(t)&&(t=[]),c(l()),{toggle:function(e){i=e},isEnabled:function(){return i},add:function(e){i&&e&&(e.wgs84=function e(t){var r,n;if(null===t||"object"!=typeof t)return t;for(n in r=t.constructor(),t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}(e.wgs84),JSON.stringify(e)!==JSON.stringify(f()))&&(u(t.slice(a,r+1)),t.push(e),u(t.slice(-s)),c(l()),n.utils.setCookieContent(o,t))},moveToPrevious:function(){return a<r?h(r-1):f()},moveToNext:function(){return r<l()?h(r+1):f()},getCurrentValue:f}},window.TWCCHistory={getInstance:function(e){return t=t||r(e)}})}(jQuery),!function(a,s){"use strict";var t,r,n=s.locations.capitals;function o(e){return s.translations.hasOwnProperty(e)?s.translations[e]:e}function u(e,t,r){e.trigger(t,{data:r})}function i(e){return a.cookie(e)}function l(e,t,r){a.cookie(e,t,{expires:r=r||30})}function c(e,t,r){l(e,JSON.stringify(t),r)}function f(e){return i(e)?a.parseJSON(i(e)):{}}function h(e,t){var r,n,i;r=s.system.preferencesCookie,e=e,t=t,n=7,(i=f(r))[e]=t,c(r,i,n)}function p(e){return t=s.system.preferencesCookie,e=e,f(t)[e];var t}function d(){var e=a("#map");e.on("linestring.edit_end",function(e,t){t=t.data;_()||s.TWCCUi.setCsvMode(!0),v(t.map(b))}),e.on("map.click",function(e,t){m(t.data)}),e.on("marker.drag_end",function(e,t){m(t.data)}),e.on("linestring.add_vertice",function(e,t){var r;_()&&((r=g()).push(b(t.data)),v(r))}),e.on("linestring.remove_vertice",function(e,t){var r;_()&&(r=b(t.data),v(g().filter(function(e){return!(e.x===r.x&&e.y===r.y)})))}),e.on("place.changed",function(e,t){m(t.data)}),e.on("map.layer.change",function(e,t){var t=t.data.split(" "),r=p("layers")||{};-1<t.indexOf("on")||-1<t.indexOf("off")?(r.hasOwnProperty("opt")||(r.opt={}),r.opt[t[1]]="on"===t[2]):(r.base={},r.base[t[0]]=t[1]),h("layers",r)})}function y(e,t){return/\+title=/gi.test(e)?e.replace(/.*\+title=([^\+]+).*/gi,"$1"):t}function g(){return t.wgs84().slice()}function m(e){v([b(e)])}function v(e){t.transform({wgs84:e})}function b(e){return{x:e[0],y:e[1]}}function _(){return t.csv()}function w(){a("#map-container").length?s.initialisers.initializeMap().done(e):e()}function e(){s.initialisers.initializeConverter().done(function(e){s.context.GET.isSetGraticule&&s.TWCCMap.setGraticule(),s.TWCCUi.startHelp(),u(a("body"),"main.ready",e)})}a.fn.extend({sort:function(){return this.pushStack([].sort.apply(this,arguments),[])},sortOptions:function(e){return jQuery("option",this).sort(e).appendTo(this),this},sortGroups:function(e){return jQuery("optgroup",this).sort(e).appendTo(this),this},sortOptionsByText:function(){return this.sortOptions(function(e,t){e=jQuery(e).text().toUpperCase(),t=jQuery(t).text().toUpperCase();return e<t?-1:t<e?1:0})},sortOptgroupsByLabel:function(){return this.sortGroups(function(e,t){e=jQuery(e).prop("label").toUpperCase(),t=jQuery(t).prop("label").toUpperCase();return e<t?-1:t<e?1:0})},sortGrpsNOptionsByText:function(){var t=this;return a("optgroup",this).each(function(e){a("optgroup:eq("+e+")",t).sortOptionsByText()}),this.sortOptgroupsByLabel()},getXDomain:function(e){var t=s.system.httpServer+"/"+s.system.dirWsIncludes+"proxy.php",r=e.data?"?"+a.param(e.data,!0):"";return a.ajax(a.extend({dataType:"script"},e,{url:t,cache:!0,data:{u:e.url+r}}))}}),a.extend(s,{utils:{addOptionToSelect:function(e,t,r,n){var i=(i=proj4.defs(t))?i.title||t:y(n,t),n='optgroup[label="'+e+'"]';r.find(n).length||r.append(a("<optgroup>",{label:e})),r.find(n).append(a("<option>",{val:t,text:i}))},degToRad:function r(e){var n;switch(a.type(e)){case"object":n={},a.each(e,function(e,t){if(t&&"number"!==a.type(t))throw"Wrong data type";n[e]=r(t)});break;case"number":n="number"===a.type(e)?e*Math.PI/180:void 0}return n},enableAutoZoom:function(e){s.TWCCMap.model.setBoolean("autoZoom",e)},getConvergenceConvention:function(){return s.TWCCUi.getConvergenceConvention()},getCookieContent:f,getPreferenceCookie:p,getRandomCityLocation:function(){var e=s.math.getRandomInteger(0,n.length-1);return{x:n[e].lng,y:n[e].lat}},getTitleFromDefinitionString:y,getWMM:function(){return r},newDeferred:function(t,r,n){var i,o=new a.Deferred(function(){u(a("body"),"main.start",{name:t})});return r=r||s.system.timeout,n=n||0,setTimeout(function e(){0<n?(n--,o.notify("retry"),setTimeout(e,r)):o.reject(t+" timed out")},r),setTimeout(function e(){"pending"===o.state()&&(o.notify(t+" pending"),setTimeout(e,500))},1),i=t,a.when(o).then(function(){u(a("body"),"main.succeeded",{name:i})},function(e){u(a("body"),"main.failed",{name:i,message:e})},function(e){u(a("body"),"main.progress",{name:i,message:e})}),o},radToDeg:function(e){return"number"===a.type(e)?180*e/Math.PI:void 0},sendMsg:function(e,t,r){var n,i;return t=t||s.system.applicationNoreply,i=s.system.httpServer+"/"+s.system.dirWsIncludes+"s.php",(n=a.ajax({type:"POST",url:i,async:!1,cache:!1,data:"ff=g"}).responseText).length<10?(alert(o("messageNotSent")+n),!1):(l(s.system.tokenName,n),a.post(i,{ff:"d",f:t,b:e,l:s.context.languageCode},function(e){"function"==typeof r&&r(e)}),!0)},setCookie:l,setCookieContent:c,setPreferenceCookie:h,t:o,trigger:u}}),a.extend(s,{constants:{keyboard:{RETURN:13}}}),a.extend(s,{Class:function(e){function t(){this.initialize.apply(this,arguments)}for(var r in e)e.hasOwnProperty(r)&&(t.prototype[r]=e[r]);return t.prototype.initialize=t.prototype.initialize||function(){},t}}),a.extend(s,{initialisers:{initializeMap:function(){var e=a.extend(!0,{},s,s.TWCCMapOptions);return delete e.TWCCMapOptions,s.TWCCMap=window.TWCCMap.getInstance(e),s.map=s.TWCCMap.getMap(),d(),s.TWCCMap.promise},initializeUi:function(){var e=a.extend(!0,{},s);return s.TWCCUi=window.TWCCUi.getInstance(e),s.TWCCUi.promise},initializeConverter:function(){var e=a.extend(!0,{},s,s.TWCCConverterOptions);return delete e.TWCCConverterOptions,s.TWCCConverter=window.TWCCConverter.getInstance(e),t=s.TWCCConverter.converterWidget,s.TWCCConverter.promise}}}),a(document).ready(function(){var e={title:e="*GPS (WGS84) (deg)",defData:"+title="+e+" +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees",isConnector:!1};"function"!==a.type(Math.sinh)&&(Math.sinh=function(e){return(Math.exp(e)-Math.exp(-e))/2}),a.ajax({url:"/js/data/WMM.COF",cache:!0,dataType:"text"}).done(function(e){r=geoMagFactory(cof2Obj(e))}).fail(function(){r=function(){return{}}}),a.extend(proj4.WGS84,e),a.extend(proj4.defs("WGS84"),e),s.initialisers.initializeUi().done(w)})}(jQuery,App),!function(e,t){"use strict";function n(e){return e=e.toString().replace(/,/gi,"."),isNaN(e)&&(e=0),parseFloat(e)}e.extend(t,{math:{getRandomInteger:function(e,t){return t-=e,t=Math.random()*t+e,Math.round(t)},round:function(e,t){var r;return t=void 0===t?0:t,""===(r=e.toString())||"NaN"==r?"":Math.round(n(e)*Math.pow(10,n(t)))/Math.pow(10,n(t))},parseFloat:n}})}(jQuery,App),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(o){function a(e){return e&&e.constructor===Number?e+"px":e}o.fn.bgiframe=function(n){n=o.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;",conditional:/MSIE 6\.0/.test(navigator.userAgent)},n),o.isFunction(n.conditional)||(e=n.conditional,n.conditional=function(){return e});var e,i=o('<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+n.src+'"style="display:block;position:absolute;z-index:-1;"/>');return this.each(function(){var e,t,r=o(this);!1!==n.conditional(this)&&((t=0===(e=r.children("iframe.bgiframe")).length?i.clone():e).css({top:"auto"==n.top?-1*(parseInt(r.css("borderTopWidth"),10)||0)+"px":a(n.top),left:"auto"==n.left?-1*(parseInt(r.css("borderLeftWidth"),10)||0)+"px":a(n.left),width:"auto"==n.width?this.offsetWidth+"px":a(n.width),height:"auto"==n.height?this.offsetHeight+"px":a(n.height),opacity:!0===n.opacity?0:void 0}),0===e.length)&&r.prepend(t)})},o.fn.bgIframe=o.fn.bgiframe}),jQuery.bt={version:"0.9.5-rc1"},!function($){jQuery.fn.bt=function(content,options){var contentSelect,contentSelect;return"string"!=typeof content?(contentSelect=!0,options=content,content=!1):contentSelect=!1,jQuery.fn.hoverIntent&&"hover"==jQuery.bt.defaults.trigger&&(jQuery.bt.defaults.trigger="hoverIntent"),this.each(function(index){var opts=jQuery.extend(!1,jQuery.bt.defaults,jQuery.bt.options,options),ajaxTimeout=(opts.spikeLength=numb(opts.spikeLength),opts.spikeGirth=numb(opts.spikeGirth),opts.overlap=numb(opts.overlap),!1),hoverOpts,refresh=(opts.killTitle&&$(this).find("[title]").addBack().each(function(){$(this).prop("bt-xTitle")||$(this).prop("bt-xTitle",$(this).prop("title")).prop("title","")}),"string"==typeof opts.tpropigger&&(opts.trigger=[opts.trigger]),"hoverIntent"==opts.trigger[0]?(hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn()},out:function(){this.btOff()}}),$(this).hoverIntent(hoverOpts)):"hover"==opts.trigger[0]?$(this).hover(function(){this.btOn()},function(){this.btOff()}):"now"==opts.trigger[0]?$(this).hasClass("bt-active")?this.btOff():this.btOn():"none"!=opts.trigger[0]&&(1<opts.trigger.length&&opts.trigger[0]!=opts.trigger[1]?$(this).bind(opts.trigger[0],function(){this.btOn()}).bind(opts.trigger[1],function(){this.btOff()}):$(this).bind(opts.trigger[0],function(){$(this).hasClass("bt-active")?this.btOff():this.btOn()})),this.btOn=function(){var url,url,off,selector,cacheData,target,ajaxOpts,shadowMarginX=("object"==typeof $(this).data("bt-box")&&this.btOff(),opts.preBuild.apply(this),$(jQuery.bt.vars.closeWhenOpenStack).btOff(),$(this).addClass("bt-active "+opts.activeClass),contentSelect&&null==opts.ajaxPath&&(opts.killTitle&&$(this).prop("title",$(this).prop("bt-xTitle")),content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector),opts.killTitle)&&$(this).prop("title",""),null!=opts.ajaxPath&&0==content&&("object"==typeof opts.ajaxPath?(url=eval(opts.ajaxPath[0]),url+=opts.ajaxPath[1]?" "+opts.ajaxPath[1]:""):url=opts.ajaxPath,off=url.indexOf(" "),0<=off&&(selector=url.slice(off,url.length),url=url.slice(0,off)),cacheData=opts.ajaxCache?$(document.body).data("btCache-"+url.replace(/\./g,"")):null,content="string"==typeof cacheData?selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData:(target=this,ajaxOpts=jQuery.extend(!1,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(e,t){content="success"==t||"notmodified"==t?(opts.ajaxCache&&$(document.body).data("btCache-"+url.replace(/\./g,""),e.responseText),ajaxTimeout=!1,selector?$("<div/>").append(e.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):e.responseText):("timeout"==t&&(ajaxTimeout=!0),opts.ajaxError.replace(/%error/g,e.statusText)),$(target).hasClass("bt-active")&&target.btOn()}},opts.ajaxOpts),jQuery.ajax(ajaxOpts),opts.ajaxLoading)),0),shadowMarginY=0,shadowShiftX=0,shadowShiftY=0,offsetParent,offsetParentPos,pos,top,left,offsetParent,pos,top,left,width=(opts.shadow&&!shadowSupport()&&(opts.shadow=!1,jQuery.extend(opts,opts.noShadowOpts)),opts.shadow&&(shadowMarginX=opts.shadowBlur>Math.abs(opts.shadowOffsetX)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetX),shadowShiftX=0<opts.shadowBlur-opts.shadowOffsetX?opts.shadowBlur-opts.shadowOffsetX:0,shadowMarginY=opts.shadowBlur>Math.abs(opts.shadowOffsetY)?2*opts.shadowBlur:opts.shadowBlur+Math.abs(opts.shadowOffsetY),shadowShiftY=0<opts.shadowBlur-opts.shadowOffsetY?opts.shadowBlur-opts.shadowOffsetY:0),left=opts.offsetParent?(offsetParent=$(opts.offsetParent),offsetParentPos=offsetParent.offset(),pos=$(this).offset(),top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css("margin-top"))-shadowShiftY,numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css("margin-left"))-shadowShiftX):(offsetParent=("absolute"==$(this).css("position")?$(this).parents().eq(0):$(this)).offsetParent(),pos=$(this).btPosition(),top=numb(pos.top)+numb($(this).css("margin-top"))-shadowShiftY,numb(pos.left)+numb($(this).css("margin-left"))-shadowShiftX),$(this).btOuterWidth()),height=$(this).outerHeight();if("object"==typeof content){if(null==content)return;var original=content,clone=$(original).clone(!0).show(),origClones=$(original).data("bt-clones")||[];origClones.push(clone),$(original).data("bt-clones",origClones),$(clone).data("bt-orig",original),$(this).data("bt-content-orig",{original:original,clone:clone}),content=clone}if("null"!=typeof content&&""!=content){var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:"absolute",width:opts.shrinkToFit?"auto":opts.width,zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles),$box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:"absolute",width:opts.width,zIndex:opts.wrapperzIndex,visibility:"hidden"}).appendTo(offsetParent),scrollTop=(jQuery.fn.bgiframe&&($text.bgiframe(),$box.bgiframe()),$(this).data("bt-box",$box),numb($(document).scrollTop())),scrollLeft=numb($(document).scrollLeft()),docWidth=numb($(window).width()),docHeight=numb($(window).height()),winRight=scrollLeft+docWidth,winBottom=scrollTop+docHeight,space=new Object,thisOffset=$(this).offset(),textOutHeight=(space.top=thisOffset.top-scrollTop,space.bottom=docHeight-(thisOffset+height-scrollTop),space.left=thisOffset.left-scrollLeft,space.right=docWidth-(thisOffset.left+width-scrollLeft),numb($text.outerHeight())),textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String&&(opts.positions=opts.positions.replace(/ /,"").split(",")),"most"==opts.positions[0]){var position="top",pig;for(pig in space)position=space[pig]>space[position]?pig:position}else for(var x in opts.positions){var position=opts.positions[x];if(("left"==position||"right"==position)&&space[position]>textOutWidth+opts.spikeLength)break;if(("top"==position||"bottom"==position)&&space[position]>textOutHeight+opts.spikeLength)break}var horiz=left+.5*(width-textOutWidth),vert=top+.5*(height-textOutHeight),points=new Array,textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(position){case"top":$text.css("margin-bottom",opts.spikeLength+"px"),$box.css({top:top-$text.outerHeight(!0)+opts.overlap,left:horiz});var textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0)),xShift=shadowShiftX;textRightSpace<0&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),textLeftSpace<0&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:.5*(textRight-textLeft)+xShift,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.CornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textBottom,type:"join"},points[points.length]=spikePoint;break;case"left":$text.css("margin-right",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left-$text.btOuterWidth(!0)+opts.overlap+"px"});var textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0)),yShift=shadowShiftY;textBottomSpace<0&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),textTopSpace<0&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint;break;case"bottom":$text.css("margin-top",opts.spikeLength+"px"),$box.css({top:top+height-opts.overlap,left:horiz}),textRightSpace=winRight-opts.windowMargin-($text.offset().left+$text.btOuterWidth(!0));var xShift=shadowShiftX;textRightSpace<0&&($box.css("left",numb($box.css("left"))+textRightSpace+"px"),xShift-=textRightSpace),textLeftSpace=$text.offset().left+numb($text.css("margin-left"))-(scrollLeft+opts.windowMargin),textLeftSpace<0&&($box.css("left",numb($box.css("left"))-textLeftSpace+"px"),xShift+=textLeftSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:.5*(textRight-textLeft)+xShift,y:shadowShiftY,type:"spike"},crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop),crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x,crossPoint.x=crossPoint.x>textRight-opts.spikeGirth/2-opts.cornerRadius?textRight-opts.spikeGirth/2-opts.cornerRadius:crossPoint.x,points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:crossPoint.x-opts.spikeGirth/2,y:textTop,type:"join"},points[points.length]=spikePoint;break;case"right":$text.css("margin-left",opts.spikeLength+"px"),$box.css({top:vert+"px",left:left+width-opts.overlap+"px"}),textBottomSpace=winBottom-opts.windowMargin-($text.offset().top+$text.outerHeight(!0));var yShift=shadowShiftY;textBottomSpace<0&&($box.css("top",numb($box.css("top"))+textBottomSpace+"px"),yShift-=textBottomSpace),textTopSpace=$text.offset().top+numb($text.css("margin-top"))-(scrollTop+opts.windowMargin),textTopSpace<0&&($box.css("top",numb($box.css("top"))-textTopSpace+"px"),yShift+=textTopSpace),textTop=$text.btPosition().top+numb($text.css("margin-top")),textLeft=$text.btPosition().left+numb($text.css("margin-left")),textRight=textLeft+$text.btOuterWidth(),textBottom=textTop+$text.outerHeight(),textCenter={x:textLeft+$text.btOuterWidth()*opts.centerPointX,y:textTop+$text.outerHeight()*opts.centerPointY},points[points.length]=spikePoint={x:shadowShiftX,y:.5*(textBottom-textTop)+yShift,type:"spike"},crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft),crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y,crossPoint.y=crossPoint.y>textBottom-opts.spikeGirth/2-opts.cornerRadius?textBottom-opts.spikeGirth/2-opts.cornerRadius:crossPoint.y,points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:"join"},points[points.length]={x:textLeft,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textTop,type:"corner"},points[points.length]={x:textRight,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:textBottom,type:"corner"},points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:"join"},points[points.length]=spikePoint}var canvas=document.createElement("canvas");if($(canvas).prop("width",numb($text.btOuterWidth(!0))+2*opts.strokeWidth+shadowMarginX).prop("height",numb($text.outerHeight(!0))+2*opts.strokeWidth+shadowMarginY).appendTo($box).css({position:"absolute",zIndex:opts.boxzIndex}),"undefined"!=typeof G_vmlCanvasManager&&(canvas=G_vmlCanvasManager.initElement(canvas)),0<opts.cornerRadius){for(var newPoints=new Array,newPoint,i=0;i<points.length;i++)"corner"==points[i].type?(newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius),newPoint.type="arcStart",newPoints[newPoints.length]=newPoint,newPoints[newPoints.length]=points[i],newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius),newPoint.type="arcEnd",newPoints[newPoints.length]=newPoint):newPoints[newPoints.length]=points[i];points=newPoints}var ctx=canvas.getContext("2d"),overlay;if(opts.shadow&&!0!==opts.shadowOverlap){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case"top":0<opts.shadowOffsetX+opts.shadowBlur-shadowOverlap&&$box.css("top",numb($box.css("top"))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap));break;case"right":0<shadowShiftX-shadowOverlap&&$box.css("left",numb($box.css("left"))+shadowShiftX-shadowOverlap);break;case"bottom":0<shadowShiftY-shadowOverlap&&$box.css("top",numb($box.css("top"))+shadowShiftY-shadowOverlap);break;case"left":0<opts.shadowOffsetY+opts.shadowBlur-shadowOverlap&&$box.css("left",numb($box.css("left"))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap))}}drawIt.apply(ctx,[points],opts.strokeWidth),ctx.fillStyle=opts.fill,opts.shadow&&(ctx.shadowOffsetX=opts.shadowOffsetX,ctx.shadowOffsetY=opts.shadowOffsetY,ctx.shadowBlur=opts.shadowBlur,ctx.shadowColor=opts.shadowColor),ctx.closePath(),ctx.fill(),0<opts.strokeWidth&&(ctx.shadowColor="rgba(0, 0, 0, 0)",ctx.lineWidth=opts.strokeWidth,ctx.strokeStyle=opts.strokeStyle,ctx.beginPath(),drawIt.apply(ctx,[points],opts.strokeWidth),ctx.closePath(),ctx.stroke()),opts.preShow.apply(this,[$box[0]]),$box.css({display:"none",visibility:"visible"}),opts.showTip.apply(this,[$box[0]]),opts.overlay&&(overlay=$('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:top,left:left,width:width,height:height,opacity:".2"}).appendTo(offsetParent),$(this).data("overlay",overlay)),(null!=opts.ajaxPath&&0==opts.ajaxCache||ajaxTimeout)&&(content=!1),opts.clickAnywhereToClose&&(jQuery.bt.vars.clickAnywhereStack.push(this),$(document).click(jQuery.bt.docClick)),opts.closeWhenOthersOpen&&jQuery.bt.vars.closeWhenOpenStack.push(this),opts.postShow.apply(this,[$box[0]])}},this.btOff=function(){var n,e=$(this).data("bt-box");void 0!==e&&(opts.preHide.apply(this,[e]),(n=this).btCleanup=function(){var e=$(n).data("bt-box"),t=$(n).data("bt-content-orig"),r=$(n).data("bt-overlay");"object"==typeof e&&($(e).remove(),$(n).removeData("bt-box")),"object"==typeof t&&(e=$(t.original).data("bt-clones"),$(t).data("bt-clones",arrayRemove(e,t.clone))),"object"==typeof r&&($(r).remove(),$(n).removeData("bt-overlay")),jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,n),jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,n),$(n).removeClass("bt-active "+opts.activeClass),opts.postHide.apply(n)},opts.hideTip.apply(this,[e,n.btCleanup]))},this.btRefresh=function(){this.btOff(),this.btOn()})});function drawIt(e,t){for(this.moveTo(e[0].x,e[0].y),i=1;i<e.length;i++)"arcStart"==e[i-1].type?(this.quadraticCurveTo(round5(e[i].x,t),round5(e[i].y,t),round5(e[(i+1)%e.length].x,t),round5(e[(i+1)%e.length].y,t)),i++):this.lineTo(round5(e[i].x,t),round5(e[i].y,t))}function round5(e,t){return(t=numb(t))%2?e:Math.round(e-.5)+.5}function numb(e){return parseInt(e)||0}function arrayRemove(e,t){var r,n=new Array;for(r in e)e[r]!=t&&n.push(e[r]);return n}function canvasSupport(){try{document.createElement("canvas").getContext("2d")}catch(e){document.createElement("canvas").getContext}}function shadowSupport(){try{var e=navigator.userAgent.toLowerCase();if(/webkit/.test(e))return 1;if(/gecko|mozilla/.test(e)&&3.1<=parseFloat(e.match(/firefox\/(\d+(?:\.\d+)+)/)[1]))return 1}catch(e){}}function betweenPoint(e,t,r){var n;return e.x==t.x?(n=e.y<t.y?e.y+r:e.y-r,{x:e.x,y:n}):e.y==t.y?{x:e.x<t.x?e.x+r:e.x-r,y:e.y}:void 0}function centerPoint(e,t,r){(t.x==e.x?r:e).x,(t.y==e.y?r:e).y,e.x,r.x,e.y>r.y&&Math.PI,Math.PI}function findIntersect(e,t,r,n,i,o,a,s){var u,l;return i==a?findIntersectY(e,t,r,n,i):o==s?findIntersectX(e,t,r,n,o):void(l=(o-s)/(i-a),u=(t-n)/(e-r))}function findIntersectY(e,t,r,n,i){return t==n?{x:i,y:t}:{x:i,y:(n=(t-n)/(e-r))*i+(t-n*e)}}function findIntersectX(e,t,r,n,i){return e==r?{x:e,y:i}:{x:(i-(t-(t=(t-n)/(e-r))*e))/t,y:i}}},jQuery.fn.btPosition=function(){function e(e,t){return e[0]&&parseInt(jQuery.css(e[0],t,!0),10)||0}var t,r,n;return this[0]&&(t=this.offsetParent(),r=this.offset(),n=/^body|html$/i.test(t[0].tagName)?{top:0,left:0}:t.offset(),r.top-=e(this,"marginTop"),r.left-=e(this,"marginLeft"),n.top+=e(t,"borderTopWidth"),n.left+=e(t,"borderLeftWidth"),t={top:r.top-n.top,left:r.left-n.left}),t},jQuery.fn.btOuterWidth=function(e){function t(e,t){return e[0]&&parseInt(jQuery.css(e[0],t,!0),10)||0}return this.innerWidth()+t(this,"borderLeftWidth")+t(this,"borderRightWidth")+(e?t(this,"marginLeft")+t(this,"marginRight"):0)},jQuery.fn.btOn=function(){return this.each(function(e){jQuery.isFunction(this.btOn)&&this.btOn()})},jQuery.fn.btOff=function(){return this.each(function(e){jQuery.isFunction(this.btOff)&&this.btOff()})},jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]},jQuery.bt.docClick=function(e){e=e||window.event,!$(e.target).parents().addBack().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length&&($(jQuery.bt.vars.clickAnywhereStack).btOff(),$(document).unbind("click",jQuery.bt.docClick))},jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:!0,closeWhenOthersOpen:!1,shrinkToFit:!1,width:"200px",padding:"10px",spikeGirth:10,spikeLength:15,overlap:0,overlay:!1,killTitle:!0,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:.5,centerPointY:.5,shadow:!1,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",contentSelector:"$(this).prop('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:!0,ajaxOpts:{},preBuild:function(){},preShow:function(e){},showTip:function(e){$(e).show()},postShow:function(e){},preHide:function(e){},hideTip:function(e,t){$(e).hide(),t()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}},jQuery.bt.options={}}(jQuery),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(x){function n(e,t){var r,n,i,o=e.nodeName.toLowerCase();return"area"===o?(n=(r=e.parentNode).name,!(!e.href||!n||"map"!==r.nodeName.toLowerCase()||!(i=x("img[usemap='#"+n+"']")[0]))&&a(i)):(/input|select|textarea|button|object/.test(o)?!e.disabled:"a"===o&&e.href||t)&&a(e)}function a(e){return x.expr.filters.visible(e)&&!x(e).parents().addBack().filter(function(){return"hidden"===x.css(this,"visibility")}).length}function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},x.extend(this._defaults,this.regional[""]),this.regional.en=x.extend(!0,{},this.regional[""]),this.regional["en-US"]=x.extend(!0,{},this.regional.en),this.dpDiv=r(x("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){x(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",o)}function o(){x.datepicker._isDisabledDatepicker((m.inline?m.dpDiv.parent():m.input)[0])||(x(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),x(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).addClass("ui-datepicker-next-hover"))}function u(e,t){for(var r in x.extend(e,t),t)null==t[r]&&(e[r]=t[r])}function t(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}x.ui=x.ui||{},x.extend(x.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),x.fn.extend({scrollParent:function(e){var t=this.css("position"),r="absolute"===t,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,e=this.parents().filter(function(){var e=x(this);return(!r||"static"!==e.css("position"))&&n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&e.length?e:x(this[0].ownerDocument||document)},uniqueId:(F=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++F)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&x(this).removeAttr("id")})}}),x.extend(x.expr[":"],{data:x.expr.createPseudo?x.expr.createPseudo(function(t){return function(e){return!!x.data(e,t)}}):function(e,t,r){return!!x.data(e,r[3])},focusable:function(e){return n(e,!isNaN(x.attr(e,"tabindex")))},tabbable:function(e){var t=x.attr(e,"tabindex"),r=isNaN(t);return(r||0<=t)&&n(e,!r)}}),x("<a>").outerWidth(1).jquery||x.each(["Width","Height"],function(e,r){function n(e,t,r,n){return x.each(i,function(){t-=parseFloat(x.css(e,"padding"+this))||0,r&&(t-=parseFloat(x.css(e,"border"+this+"Width"))||0),n&&(t-=parseFloat(x.css(e,"margin"+this))||0)}),t}var i="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),a={innerWidth:x.fn.innerWidth,innerHeight:x.fn.innerHeight,outerWidth:x.fn.outerWidth,outerHeight:x.fn.outerHeight};x.fn["inner"+r]=function(e){return void 0===e?a["inner"+r].call(this):this.each(function(){x(this).css(o,n(this,e)+"px")})},x.fn["outer"+r]=function(e,t){return"number"!=typeof e?a["outer"+r].call(this,e):this.each(function(){x(this).css(o,n(this,e,!0,t)+"px")})}}),x.fn.addBack||(x.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),x("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(x.fn.removeData=(s=x.fn.removeData,function(e){return arguments.length?s.call(this,x.camelCase(e)):s.call(this)})),x.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),x.fn.extend({focus:(D=x.fn.focus,function(t,r){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){x(e).focus(),r&&r.call(e)},t)}):D.apply(this,arguments)}),disableSelection:(i="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(i+".ui-disableSelection",function(e){e.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,r=x(this[0]);r.length&&r[0]!==document;){if(("absolute"===(t=r.css("position"))||"relative"===t||"fixed"===t)&&(t=parseInt(r.css("zIndex"),10),!isNaN(t))&&0!==t)return t;r=r.parent()}return 0}}),x.ui.plugin={add:function(e,t,r){var n,i=x.ui[e].prototype;for(n in r)i.plugins[n]=i.plugins[n]||[],i.plugins[n].push([t,r[n]])},call:function(e,t,r,n){var i,o=e.plugins[t];if(o&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(i=0;o.length>i;i++)e.options[o[i][0]]&&o[i][1].apply(e.element,r)}};var i,D,s,F,N,B=0,G=Array.prototype.slice,l=(x.cleanData=(N=x.cleanData,function(e){for(var t,r,n=0;null!=(r=e[n]);n++)try{(t=x._data(r,"events"))&&t.remove&&x(r).triggerHandler("remove")}catch(e){}N(e)}),x.widget=function(e,r,t){var n,i,o,a,s={},u=e.split(".")[0];return e=e.split(".")[1],n=u+"-"+e,t||(t=r,r=x.Widget),x.expr[":"][n.toLowerCase()]=function(e){return!!x.data(e,n)},x[u]=x[u]||{},i=x[u][e],o=x[u][e]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},x.extend(o,i,{version:t.version,_proto:x.extend({},t),_childConstructors:[]}),(a=new r).options=x.widget.extend({},a.options),x.each(t,function(t,n){return x.isFunction(n)?void(s[t]=function(){var e,t=this._super,r=this._superApply;return this._super=i,this._superApply=o,e=n.apply(this,arguments),this._super=t,this._superApply=r,e}):void(s[t]=n);function i(){return r.prototype[t].apply(this,arguments)}function o(e){return r.prototype[t].apply(this,e)}}),o.prototype=x.widget.extend(a,{widgetEventPrefix:i&&a.widgetEventPrefix||e},s,{constructor:o,namespace:u,widgetName:e,widgetFullName:n}),i?(x.each(i._childConstructors,function(e,t){var r=t.prototype;x.widget(r.namespace+"."+r.widgetName,o,t._proto)}),delete i._childConstructors):r._childConstructors.push(o),x.widget.bridge(e,o),o},x.widget.extend=function(e){for(var t,r,n=G.call(arguments,1),i=0,o=n.length;i<o;i++)for(t in n[i])r=n[i][t],n[i].hasOwnProperty(t)&&void 0!==r&&(e[t]=x.isPlainObject(r)?x.isPlainObject(e[t])?x.widget.extend({},e[t],r):x.widget.extend({},r):r);return e},x.widget.bridge=function(o,t){var a=t.prototype.widgetFullName||o;x.fn[o]=function(r){var e="string"==typeof r,n=G.call(arguments,1),i=this;return r=!e&&n.length?x.widget.extend.apply(null,[r].concat(n)):r,e?this.each(function(){var e,t=x.data(this,a);return"instance"===r?(i=t,!1):t?x.isFunction(t[r])&&"_"!==r.charAt(0)?(e=t[r].apply(t,n))!==t&&void 0!==e?(i=e&&e.jquery?i.pushStack(e.get()):e,!1):void 0:x.error("no such method '"+r+"' for "+o+" widget instance"):x.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=x.data(this,a);e?(e.option(r||{}),e._init&&e._init()):x.data(this,a,new t(r,this))}),i}},x.Widget=function(){},x.Widget._childConstructors=[],x.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=x(t||this.defaultElement||this)[0],this.element=x(t),this.uuid=B++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=x(),this.hoverable=x(),this.focusable=x(),t!==this&&(x.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=x(t.style?t.ownerDocument:t.document||t),this.window=x(this.document[0].defaultView||this.document[0].parentWindow)),this.options=x.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:x.noop,_getCreateEventData:x.noop,_create:x.noop,_init:x.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(x.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:x.noop,widget:function(){return this.element},option:function(e,t){var r,n,i,o=e;if(0===arguments.length)return x.widget.extend({},this.options);if("string"==typeof e)if(o={},e=(r=e.split(".")).shift(),r.length){for(n=o[e]=x.widget.extend({},this.options[e]),i=0;r.length-1>i;i++)n[r[i]]=n[r[i]]||{},n=n[r[i]];if(e=r.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=t}return this._setOptions(o),this},_setOptions:function(e){for(var t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t)&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(i,o,e){var a,s=this;"boolean"!=typeof i&&(e=o,o=i,i=!1),e?(o=a=x(o),this.bindings=this.bindings.add(o)):(e=o,o=this.element,a=this.widget()),x.each(e,function(e,t){function r(){return i||!0!==s.options.disabled&&!x(this).hasClass("ui-state-disabled")?("string"==typeof t?s[t]:t).apply(s,arguments):void 0}"string"!=typeof t&&(r.guid=t.guid=t.guid||r.guid||x.guid++);var e=e.match(/^([\w:-]*)\s*(.*)$/),n=e[1]+s.eventNamespace,e=e[2];e?a.delegate(e,n,r):o.bind(n,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=x(this.bindings.not(e).get()),this.focusable=x(this.focusable.not(e).get()),this.hoverable=x(this.hoverable.not(e).get())},_delay:function(e,t){var r=this;return setTimeout(function(){return("string"==typeof e?r[e]:e).apply(r,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){x(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){x(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){x(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){x(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,r){var n,i,o=this.options[e];if(r=r||{},(t=x.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],i=t.originalEvent)for(n in i)n in t||(t[n]=i[n]);return this.element.trigger(t,r),!(x.isFunction(o)&&!1===o.apply(this.element[0],[t].concat(r))||t.isDefaultPrevented())}},x.each({show:"fadeIn",hide:"fadeOut"},function(o,a){x.Widget.prototype["_"+o]=function(t,e,r){var n=(e="string"==typeof e?{effect:e}:e)?!0!==e&&"number"!=typeof e&&e.effect||a:o,i=!x.isEmptyObject(e="number"==typeof(e=e||{})?{duration:e}:e);e.complete=r,e.delay&&t.delay(e.delay),i&&x.effects&&x.effects.effect[n]?t[o](e):n!==o&&t[n]?t[n](e.duration,e.easing,r):t.queue(function(e){x(this)[o](),r&&r.call(t[0]),e()})}}),x.widget,!1);function U(e,t,r){return[parseFloat(e[0])*(X.test(e[0])?t/100:1),parseFloat(e[1])*(X.test(e[1])?r/100:1)]}function S(e,t){return parseInt(x.css(e,t),10)||0}x(document).mouseup(function(){l=!1}),x.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(e){return!0===x.data(e.target,t.widgetName+".preventClickEvent")?(x.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){var t,r,n;if(!l)return this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),r=1===(this._mouseDownEvent=e).which,n=!("string"!=typeof(t=this).options.cancel||!e.target.nodeName)&&x(e.target).closest(this.options.cancel).length,r&&!n&&this._mouseCapture(e)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?e.preventDefault():(!0===x.data(e.target,this.widgetName+".preventClickEvent")&&x.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),l=!0)),!0},_mouseMove:function(e){if(this._mouseMoved){if(x.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&x.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),l=!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),x.ui=x.ui||{};var c,z,j=Math.max,O=Math.abs,W=Math.round,V=/left|center|right/,H=/top|center|bottom/,q=/[\+\-]\d+(\.[\d]+)?%?/,Y=/^\w+/,X=/%$/,Z=x.fn.position;x.position={scrollbarWidth:function(){var e,t,r;return void 0!==c?c:(r=(t=x("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>")).children()[0],x("body").append(t),e=r.offsetWidth,t.css("overflow","scroll"),e===(r=r.offsetWidth)&&(r=t[0].clientWidth),t.remove(),c=e-r)},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),r=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),t="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth;return{width:"scroll"===r||"auto"===r&&e.height<e.element[0].scrollHeight?x.position.scrollbarWidth():0,height:t?x.position.scrollbarWidth():0}},getWithinInfo:function(e){var e=x(e||window),t=x.isWindow(e[0]),r=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:t,isDocument:r,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:t||r?e.width():e.outerWidth(),height:t||r?e.height():e.outerHeight()}}},x.fn.position=function(f){if(!f||!f.of)return Z.apply(this,arguments);f=x.extend({},f);var h,p,d,y,g,e,m=x(f.of),v=x.position.getWithinInfo(f.within),b=x.position.getScrollInfo(v),_=(f.collision||"flip").split(" "),w={},t=9===(t=(e=m)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:x.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()};return m[0].preventDefault&&(f.at="left top"),p=t.width,d=t.height,g=x.extend({},y=t.offset),x.each(["my","at"],function(){var e,t,r=(f[this]||"").split(" ");(r=1===r.length?V.test(r[0])?r.concat(["center"]):H.test(r[0])?["center"].concat(r):["center","center"]:r)[0]=V.test(r[0])?r[0]:"center",r[1]=H.test(r[1])?r[1]:"center",e=q.exec(r[0]),t=q.exec(r[1]),w[this]=[e?e[0]:0,t?t[0]:0],f[this]=[Y.exec(r[0])[0],Y.exec(r[1])[0]]}),1===_.length&&(_[1]=_[0]),"right"===f.at[0]?g.left+=p:"center"===f.at[0]&&(g.left+=p/2),"bottom"===f.at[1]?g.top+=d:"center"===f.at[1]&&(g.top+=d/2),h=U(w.at,p,d),g.left+=h[0],g.top+=h[1],this.each(function(){var r,e,a=x(this),s=a.outerWidth(),u=a.outerHeight(),t=S(this,"marginLeft"),n=S(this,"marginTop"),i=s+t+S(this,"marginRight")+b.width,o=u+n+S(this,"marginBottom")+b.height,l=x.extend({},g),c=U(w.my,a.outerWidth(),a.outerHeight());"right"===f.my[0]?l.left-=s:"center"===f.my[0]&&(l.left-=s/2),"bottom"===f.my[1]?l.top-=u:"center"===f.my[1]&&(l.top-=u/2),l.left+=c[0],l.top+=c[1],z||(l.left=W(l.left),l.top=W(l.top)),r={marginLeft:t,marginTop:n},x.each(["left","top"],function(e,t){x.ui.position[_[e]]&&x.ui.position[_[e]][t](l,{targetWidth:p,targetHeight:d,elemWidth:s,elemHeight:u,collisionPosition:r,collisionWidth:i,collisionHeight:o,offset:[h[0]+c[0],h[1]+c[1]],my:f.my,at:f.at,within:v,elem:a})}),f.using&&(e=function(e){var t=y.left-l.left,r=t+p-s,n=y.top-l.top,i=n+d-u,o={target:{element:m,left:y.left,top:y.top,width:p,height:d},element:{element:a,left:l.left,top:l.top,width:s,height:u},horizontal:r<0?"left":0<t?"right":"center",vertical:i<0?"top":0<n?"bottom":"middle"};p<s&&p>O(t+r)&&(o.horizontal="center"),d<u&&d>O(n+i)&&(o.vertical="middle"),o.important=j(O(t),O(r))>j(O(n),O(i))?"horizontal":"vertical",f.using.call(this,e,o)}),a.offset(x.extend(l,{using:e}))})},x.ui.position={fit:{left:function(e,t){var r,n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,n=n.width,o=e.left-t.collisionPosition.marginLeft,a=i-o,s=o+t.collisionWidth-n-i;t.collisionWidth>n?0<a&&s<=0?(r=e.left+a+t.collisionWidth-n-i,e.left+=a-r):e.left=!(0<s&&a<=0)&&s<a?i+n-t.collisionWidth:i:0<a?e.left+=a:0<s?e.left-=s:e.left=j(e.left-o,e.left)},top:function(e,t){var r,n=t.within,n=n.isWindow?n.scrollTop:n.offset.top,i=t.within.height,o=e.top-t.collisionPosition.marginTop,a=n-o,s=o+t.collisionHeight-i-n;t.collisionHeight>i?0<a&&s<=0?(r=e.top+a+t.collisionHeight-i-n,e.top+=a-r):e.top=!(0<s&&a<=0)&&s<a?n+i-t.collisionHeight:n:0<a?e.top+=a:0<s?e.top-=s:e.top=j(e.top-o,e.top)}},flip:{left:function(e,t){var r=t.within,n=r.offset.left+r.scrollLeft,i=r.width,r=r.isWindow?r.scrollLeft:r.offset.left,o=e.left-t.collisionPosition.marginLeft,a=o-r,o=o+t.collisionWidth-i-r,s="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,u="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,l=-2*t.offset[0];a<0?((i=e.left+s+u+l+t.collisionWidth-i-n)<0||O(a)>i)&&(e.left+=s+u+l):0<o&&(0<(n=e.left-t.collisionPosition.marginLeft+s+u+l-r)||o>O(n))&&(e.left+=s+u+l)},top:function(e,t){var r=t.within,n=r.offset.top+r.scrollTop,i=r.height,r=r.isWindow?r.scrollTop:r.offset.top,o=e.top-t.collisionPosition.marginTop,a=o-r,o=o+t.collisionHeight-i-r,s="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,u="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,l=-2*t.offset[1];a<0?(i=e.top+s+u+l+t.collisionHeight-i-n,e.top+s+u+l>a&&(i<0||O(a)>i)&&(e.top+=s+u+l)):0<o&&(n=e.top-t.collisionPosition.marginTop+s+u+l-r,e.top+s+u+l>o)&&(0<n||o>O(n))&&(e.top+=s+u+l)}},flipfit:{left:function(){x.ui.position.flip.left.apply(this,arguments),x.ui.position.fit.left.apply(this,arguments)},top:function(){x.ui.position.flip.top.apply(this,arguments),x.ui.position.fit.top.apply(this,arguments)}}};var f,h=document.getElementsByTagName("body")[0],p=document.createElement("div"),d=document.createElement(h?"div":"body"),y={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(f in h&&x.extend(y,{position:"absolute",left:"-1000px",top:"-1000px"}),y)d.style[f]=y[f];function K(e,t,r){return t<=e&&e<t+r}d.appendChild(p),(h=h||document.documentElement).insertBefore(d,h.firstChild),p.style.cssText="position: absolute; left: 10.7432222px;",p=x(p).offset().left,z=10<p&&p<11,d.innerHTML="",h.removeChild(d),x.ui.position,x.widget("ui.draggable",x.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return this._blurActiveElement(e),!(this.helper||t.disabled||0<x(e.target).closest(".ui-resizable-handle").length||(this.handle=this._getHandle(e),!this.handle)||(this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=x(this);return x("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=this.document[0];if(this.handleElement.is(e.target))try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&x(t.activeElement).blur()}catch(e){}},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),x.ui.ddmanager&&(x.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===x(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),x.ui.ddmanager&&!t.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),x.ui.ddmanager&&x.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){t=this._uiHash();if(!1===this._trigger("drag",e,t))return this._mouseUp({}),!1;this.position=t.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",x.ui.ddmanager&&x.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,r=!1;return x.ui.ddmanager&&!this.options.dropBehaviour&&(r=x.ui.ddmanager.drop(this,e)),this.dropped&&(r=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||!0===this.options.revert||x.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?x(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==t._trigger("stop",e)&&t._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),x.ui.ddmanager&&x.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),x.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!x(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,r=x.isFunction(t.helper),e=r?x(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),r&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),"left"in(e=x.isArray(e)?{left:+e[0],top:+e[1]||0}:e)&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),{top:(e=this._isRootNode(this.offsetParent[0])?{top:0,left:0}:e).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){var e,t;return"relative"!==this.cssPosition?{top:0,left:0}:(e=this.element.position(),t=this._isRootNode(this.scrollParent[0]),{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())})},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t=this.options,r=this.document[0];return this.relativeContainer=null,t.containment?"window"===t.containment?void(this.containment=[x(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,x(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,x(window).scrollLeft()+x(window).width()-this.helperProportions.width-this.margins.left,x(window).scrollTop()+(x(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===t.containment?void(this.containment=[0,0,x(r).width()-this.helperProportions.width-this.margins.left,(x(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):t.containment.constructor===Array?void(this.containment=t.containment):("parent"===t.containment&&(t.containment=this.helper[0].parentNode),void((t=(r=x(t.containment))[0])&&(e=/(scroll|auto)/.test(r.css("overflow")),this.containment=[(parseInt(r.css("borderLeftWidth"),10)||0)+(parseInt(r.css("paddingLeft"),10)||0),(parseInt(r.css("borderTopWidth"),10)||0)+(parseInt(r.css("paddingTop"),10)||0),(e?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(r.css("borderRightWidth"),10)||0)-(parseInt(r.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(r.css("borderBottomWidth"),10)||0)-(parseInt(r.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=r))):void(this.containment=null)},_convertPositionTo:function(e,t){t=t||this.position;var e="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*e+this.offset.parent.top*e-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*e,left:t.left+this.offset.relative.left*e+this.offset.parent.left*e-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*e}},_generatePosition:function(e,t){var r,n=this.options,i=this._isRootNode(this.scrollParent[0]),o=e.pageX,a=e.pageY;return i&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),{top:(a=t&&(this.containment&&(r=this.relativeContainer?(t=this.relativeContainer.offset(),[this.containment[0]+t.left,this.containment[1]+t.top,this.containment[2]+t.left,this.containment[3]+t.top]):this.containment,e.pageX-this.offset.click.left<r[0]&&(o=r[0]+this.offset.click.left),e.pageY-this.offset.click.top<r[1]&&(a=r[1]+this.offset.click.top),e.pageX-this.offset.click.left>r[2]&&(o=r[2]+this.offset.click.left),e.pageY-this.offset.click.top>r[3])&&(a=r[3]+this.offset.click.top),n.grid&&(t=n.grid[1]?this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY,a=!r||t-this.offset.click.top>=r[1]||t-this.offset.click.top>r[3]?t:t-this.offset.click.top>=r[1]?t-n.grid[1]:t+n.grid[1],e=n.grid[0]?this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX,o=!r||e-this.offset.click.left>=r[0]||e-this.offset.click.left>r[2]?e:e-this.offset.click.left>=r[0]?e-n.grid[0]:e+n.grid[0]),"y"===n.axis&&(o=this.originalPageX),"x"===n.axis)?this.originalPageY:a)-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,t,r){return r=r||this._uiHash(),x.ui.plugin.call(this,e,[t,r,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),r.offset=this.positionAbs),x.Widget.prototype._trigger.call(this,e,t,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),x.ui.plugin.add("draggable","connectToSortable",{start:function(t,e,r){var n=x.extend({},e,{item:r.element});r.sortables=[],x(r.options.connectToSortable).each(function(){var e=x(this).sortable("instance");e&&!e.options.disabled&&(r.sortables.push(e),e.refreshPositions(),e._trigger("activate",t,n))})},stop:function(t,e,r){var n=x.extend({},e,{item:r.element});r.cancelHelperRemoval=!1,x.each(r.sortables,function(){var e=this;e.isOver?(e.isOver=0,r.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(r,n,i){x.each(i.sortables,function(){var e=!1,t=this;t.positionAbs=i.positionAbs,t.helperProportions=i.helperProportions,t.offset.click=i.offset.click,t._intersectsWith(t.containerCache)&&(e=!0,x.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,e=this!==t&&this._intersectsWith(this.containerCache)&&x.contains(t.element[0],this.element[0])?!1:e})),e?(t.isOver||(t.isOver=1,t.currentItem=n.helper.appendTo(t.element).data("ui-sortable-item",!0),t.options._helper=t.options.helper,t.options.helper=function(){return n.helper[0]},r.target=t.currentItem[0],t._mouseCapture(r,!0),t._mouseStart(r,!0,!0),t.offset.click.top=i.offset.click.top,t.offset.click.left=i.offset.click.left,t.offset.parent.left-=i.offset.parent.left-t.offset.parent.left,t.offset.parent.top-=i.offset.parent.top-t.offset.parent.top,i._trigger("toSortable",r),i.dropped=t.element,x.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,t.fromOutside=i),t.currentItem&&(t._mouseDrag(r),n.position=t.position)):t.isOver&&(t.isOver=0,t.cancelHelperRemoval=!0,t.options._revert=t.options.revert,t.options.revert=!1,t._trigger("out",r,t._uiHash(t)),t._mouseStop(r,!0),t.options.revert=t.options._revert,t.options.helper=t.options._helper,t.placeholder&&t.placeholder.remove(),i._refreshOffsets(r),n.position=i._generatePosition(r,!0),i._trigger("fromSortable",r),i.dropped=!1,x.each(i.sortables,function(){this.refreshPositions()}))})}}),x.ui.plugin.add("draggable","cursor",{start:function(e,t,r){var n=x("body"),r=r.options;n.css("cursor")&&(r._cursor=n.css("cursor")),n.css("cursor",r.cursor)},stop:function(e,t,r){r=r.options;r._cursor&&x("body").css("cursor",r._cursor)}}),x.ui.plugin.add("draggable","opacity",{start:function(e,t,r){t=x(t.helper),r=r.options;t.css("opacity")&&(r._opacity=t.css("opacity")),t.css("opacity",r.opacity)},stop:function(e,t,r){r=r.options;r._opacity&&x(t.helper).css("opacity",r._opacity)}}),x.ui.plugin.add("draggable","scroll",{start:function(e,t,r){r.scrollParentNotHidden||(r.scrollParentNotHidden=r.helper.scrollParent(!1)),r.scrollParentNotHidden[0]!==r.document[0]&&"HTML"!==r.scrollParentNotHidden[0].tagName&&(r.overflowOffset=r.scrollParentNotHidden.offset())},drag:function(e,t,r){var n=r.options,i=!1,o=r.scrollParentNotHidden[0],a=r.document[0];o!==a&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(r.overflowOffset.top+o.offsetHeight-e.pageY<n.scrollSensitivity?o.scrollTop=i=o.scrollTop+n.scrollSpeed:e.pageY-r.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=i=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(r.overflowOffset.left+o.offsetWidth-e.pageX<n.scrollSensitivity?o.scrollLeft=i=o.scrollLeft+n.scrollSpeed:e.pageX-r.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=i=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-x(a).scrollTop()<n.scrollSensitivity?i=x(a).scrollTop(x(a).scrollTop()-n.scrollSpeed):x(window).height()-(e.pageY-x(a).scrollTop())<n.scrollSensitivity&&(i=x(a).scrollTop(x(a).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-x(a).scrollLeft()<n.scrollSensitivity?i=x(a).scrollLeft(x(a).scrollLeft()-n.scrollSpeed):x(window).width()-(e.pageX-x(a).scrollLeft())<n.scrollSensitivity&&(i=x(a).scrollLeft(x(a).scrollLeft()+n.scrollSpeed)))),!1!==i&&x.ui.ddmanager&&!n.dropBehaviour&&x.ui.ddmanager.prepareOffsets(r,e)}}),x.ui.plugin.add("draggable","snap",{start:function(e,t,r){var n=r.options;r.snapElements=[],x(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=x(this),t=e.offset();this!==r.element[0]&&r.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})})},drag:function(e,t,r){for(var n,i,o,a,s,u,l,c,f,h=r.options,p=h.snapTolerance,d=t.offset.left,y=d+r.helperProportions.width,g=t.offset.top,m=g+r.helperProportions.height,v=r.snapElements.length-1;0<=v;v--)u=(s=r.snapElements[v].left-r.margins.left)+r.snapElements[v].width,c=(l=r.snapElements[v].top-r.margins.top)+r.snapElements[v].height,y<s-p||u+p<d||m<l-p||c+p<g||!x.contains(r.snapElements[v].item.ownerDocument,r.snapElements[v].item)?(r.snapElements[v].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,e,x.extend(r._uiHash(),{snapItem:r.snapElements[v].item})),r.snapElements[v].snapping=!1):("inner"!==h.snapMode&&(n=p>=Math.abs(l-m),i=p>=Math.abs(c-g),o=p>=Math.abs(s-y),a=p>=Math.abs(u-d),n&&(t.position.top=r._convertPositionTo("relative",{top:l-r.helperProportions.height,left:0}).top),i&&(t.position.top=r._convertPositionTo("relative",{top:c,left:0}).top),o&&(t.position.left=r._convertPositionTo("relative",{top:0,left:s-r.helperProportions.width}).left),a)&&(t.position.left=r._convertPositionTo("relative",{top:0,left:u}).left),f=n||i||o||a,"outer"!==h.snapMode&&(n=p>=Math.abs(l-g),i=p>=Math.abs(c-m),o=p>=Math.abs(s-d),a=p>=Math.abs(u-y),n&&(t.position.top=r._convertPositionTo("relative",{top:l,left:0}).top),i&&(t.position.top=r._convertPositionTo("relative",{top:c-r.helperProportions.height,left:0}).top),o&&(t.position.left=r._convertPositionTo("relative",{top:0,left:s}).left),a)&&(t.position.left=r._convertPositionTo("relative",{top:0,left:u-r.helperProportions.width}).left),!r.snapElements[v].snapping&&(n||i||o||a||f)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,e,x.extend(r._uiHash(),{snapItem:r.snapElements[v].item})),r.snapElements[v].snapping=n||i||o||a||f)}}),x.ui.plugin.add("draggable","stack",{start:function(e,t,r){var n,r=r.options,r=x.makeArray(x(r.stack)).sort(function(e,t){return(parseInt(x(e).css("zIndex"),10)||0)-(parseInt(x(t).css("zIndex"),10)||0)});r.length&&(n=parseInt(x(r[0]).css("zIndex"),10)||0,x(r).each(function(e){x(this).css("zIndex",n+e)}),this.css("zIndex",n+r.length))}}),x.ui.plugin.add("draggable","zIndex",{start:function(e,t,r){t=x(t.helper),r=r.options;t.css("zIndex")&&(r._zIndex=t.css("zIndex")),t.css("zIndex",r.zIndex)},stop:function(e,t,r){r=r.options;r._zIndex&&x(t.helper).css("zIndex",r._zIndex)}}),x.ui.draggable,x.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,r=t.accept;this.isover=!1,this.isout=!0,this.accept=x.isFunction(r)?r:function(e){return e.is(r)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e=e||{width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){x.ui.ddmanager.droppables[e]=x.ui.ddmanager.droppables[e]||[],x.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=x.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){var r;"accept"===e?this.accept=x.isFunction(t)?t:function(e){return e.is(t)}:"scope"===e&&(r=x.ui.ddmanager.droppables[this.options.scope],this._splice(r),this._addToManager(t)),this._super(e,t)},_activate:function(e){var t=x.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=x.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=x.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=x.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(t,e){var r=e||x.ui.ddmanager.current,n=!1;return!(!r||(r.currentItem||r.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=x(this).droppable("instance");return e.options.greedy&&!e.options.disabled&&e.options.scope===r.options.scope&&e.accept.call(e.element[0],r.currentItem||r.element)&&x.ui.intersect(r,x.extend(e,{offset:e.element.offset()}),e.options.tolerance,t)?!(n=!0):void 0}),n)||!this.accept.call(this.element[0],r.currentItem||r.element))&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element)},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),x.ui.intersect=function(e,t,r,n){if(!t.offset)return!1;var i=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,a=i+e.helperProportions.width,s=o+e.helperProportions.height,u=t.offset.left,l=t.offset.top,c=u+t.proportions().width,f=l+t.proportions().height;switch(r){case"fit":return u<=i&&a<=c&&l<=o&&s<=f;case"intersect":return i+e.helperProportions.width/2>u&&c>a-e.helperProportions.width/2&&o+e.helperProportions.height/2>l&&f>s-e.helperProportions.height/2;case"pointer":return K(n.pageY,l,t.proportions().height)&&K(n.pageX,u,t.proportions().width);case"touch":return(l<=o&&o<=f||l<=s&&s<=f||o<l&&f<s)&&(u<=i&&i<=c||u<=a&&a<=c||i<u&&c<a);default:return!1}},x.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var r,n,i=x.ui.ddmanager.droppables[e.options.scope]||[],o=t?t.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(r=0;i.length>r;r++)if(!(i[r].options.disabled||e&&!i[r].accept.call(i[r].element[0],e.currentItem||e.element))){for(n=0;a.length>n;n++)if(a[n]===i[r].element[0]){i[r].proportions().height=0;continue e}i[r].visible="none"!==i[r].element.css("display"),i[r].visible&&("mousedown"===o&&i[r]._activate.call(i[r],t),i[r].offset=i[r].element.offset(),i[r].proportions({width:i[r].element[0].offsetWidth,height:i[r].element[0].offsetHeight}))}},drop:function(e,t){var r=!1;return x.each((x.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&x.ui.intersect(e,this,this.options.tolerance,t)&&(r=this._drop.call(this,t)||r),!this.options.disabled)&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t))}),r},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||x.ui.ddmanager.prepareOffsets(e,t)})},drag:function(i,o){i.options.refreshPositions&&x.ui.ddmanager.prepareOffsets(i,o),x.each(x.ui.ddmanager.droppables[i.options.scope]||[],function(){var e,t,r,n;this.options.disabled||this.greedyChild||!this.visible||(n=!(n=x.ui.intersect(i,this,this.options.tolerance,o))&&this.isover?"isout":n&&!this.isover?"isover":null)&&(this.options.greedy&&(t=this.options.scope,(r=this.element.parents(":data(ui-droppable)").filter(function(){return x(this).droppable("instance").options.scope===t})).length)&&((e=x(r[0]).droppable("instance")).greedyChild="isover"===n),e&&"isover"===n&&(e.isover=!1,e.isout=!0,e._out.call(e,o)),this[n]=!0,this["isout"===n?"isover":"isout"]=!1,this["isover"===n?"_over":"_out"].call(this,o),e)&&"isout"===n&&(e.isout=!1,e.isover=!0,e._over.call(e,o))})},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||x.ui.ddmanager.prepareOffsets(e,t)}},x.ui.droppable,x.widget("ui.resizable",x.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(e,t){var r;return"hidden"!==x(e).css("overflow")&&(r=!1,0<e[t=t&&"left"===t?"scrollLeft":"scrollTop"]||(e[t]=1,r=0<e[t],e[t]=0,r))},_create:function(){var e,t,r,n,i=this,o=this.options;if(this.element.addClass("ui-resizable"),x.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(x("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||(x(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},t=0;e.length>t;t++)r=x.trim(e[t]),(n=x("<div class='ui-resizable-handle "+("ui-resizable-"+r)+"'></div>")).css({zIndex:o.zIndex}),"se"===r&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(n);this._renderAxis=function(e){var t,r,n;for(t in e=e||this.element,this.handles)this.handles[t].constructor===String&&(this.handles[t]=this.element.children(this.handles[t]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=x(this.handles[t],this.element),n=/sw|ne|nw|se|n|s/.test(t)?n.outerHeight():n.outerWidth(),r=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join(""),e.css(r,n),this._proportionallyResize()),x(this.handles[t]).length},this._renderAxis(this.element),this._handles=x(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){i.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),i.axis=n&&n[1]?n[1]:"se")}),o.autoHide&&(this._handles.hide(),x(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||(x(this).removeClass("ui-resizable-autohide"),i._handles.show())}).mouseleave(function(){o.disabled||i.resizing||(x(this).addClass("ui-resizable-autohide"),i._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();function e(e){x(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()}var t;return this.elementIsWrapper&&(e(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var t,r,n=!1;for(t in this.handles)r=x(this.handles[t])[0],r!==e.target&&!x.contains(r,e.target)||(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var t,r,n=this.options,i=this.element;return this.resizing=!0,this._renderProxy(),r=this._num(this.helper.css("left")),t=this._num(this.helper.css("top")),n.containment&&(r+=x(n.containment).scrollLeft()||0,t+=x(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:t},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:i.width(),height:i.height()},this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()},this.originalPosition={left:r,top:t},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=x(".ui-resizable-"+this.axis).css("cursor"),x("body").css("cursor","auto"===r?this.axis+"-resize":r),i.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var t=this.originalMousePosition,r=this.axis,n=e.pageX-t.left||0,t=e.pageY-t.top||0,r=this._change[r];return this._updatePrevProperties(),r&&(r=r.apply(this,[e,n,t]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(r=this._updateRatio(r,e)),r=this._respectSize(r,e),this._updateCache(r),this._propagate("resize",e),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),x.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges())),!1},_mouseStop:function(e){this.resizing=!1;var t,r,n,i=this.options,o=this;return this._helper&&(r=(t=(r=this._proportionallyResizeElements).length&&/textarea/i.test(r[0].nodeName))&&this._hasScroll(r[0],"left")?0:o.sizeDiff.height,t=t?0:o.sizeDiff.width,t={width:o.helper.width()-t,height:o.helper.height()-r},r=parseInt(o.element.css("left"),10)+(o.position.left-o.originalPosition.left)||null,n=parseInt(o.element.css("top"),10)+(o.position.top-o.originalPosition.top)||null,i.animate||this.element.css(x.extend(t,{top:n,left:r})),o.helper.height(o.size.height),o.helper.width(o.size.width),this._helper)&&!i.animate&&this._proportionallyResize(),x("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,r,n,i=this.options,i={minWidth:this._isNumber(i.minWidth)?i.minWidth:0,maxWidth:this._isNumber(i.maxWidth)?i.maxWidth:1/0,minHeight:this._isNumber(i.minHeight)?i.minHeight:0,maxHeight:this._isNumber(i.maxHeight)?i.maxHeight:1/0};(this._aspectRatio||e)&&(e=i.minHeight*this.aspectRatio,r=i.minWidth/this.aspectRatio,t=i.maxHeight*this.aspectRatio,n=i.maxWidth/this.aspectRatio,i.minWidth<e&&(i.minWidth=e),i.minHeight<r&&(i.minHeight=r),t<i.maxWidth&&(i.maxWidth=t),n<i.maxHeight)&&(i.maxHeight=n),this._vBoundaries=i},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,r=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(r.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(r.height-e.height),e.left=t.left+(r.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,r=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,i=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,a=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,s=this.originalPosition.left+this.originalSize.width,u=this.position.top+this.size.height,l=/sw|nw|w/.test(r),r=/nw|ne|n/.test(r);return o&&(e.width=t.minWidth),a&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),i&&(e.height=t.maxHeight),o&&l&&(e.left=s-t.minWidth),n&&l&&(e.left=s-t.maxWidth),a&&r&&(e.top=u-t.minHeight),i&&r&&(e.top=u-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,r=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],i=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)r[t]=parseInt(n[t],10)||0,r[t]+=parseInt(i[t],10)||0;return{height:r[0]+r[2],width:r[1]+r[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,r=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:r.height()-this.outerDimensions.height||0,width:r.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||x("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var r=this.originalSize;return{left:this.originalPosition.left+t,width:r.width-t}},n:function(e,t,r){var n=this.originalSize;return{top:this.originalPosition.top+r,height:n.height-r}},s:function(e,t,r){return{height:this.originalSize.height+r}},se:function(e,t,r){return x.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,r]))},sw:function(e,t,r){return x.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,r]))},ne:function(e,t,r){return x.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,r]))},nw:function(e,t,r){return x.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,r]))}},_propagate:function(e,t){x.ui.plugin.call(this,e,[t,this.ui()]),"resize"!==e&&this._trigger(e,t,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),x.ui.plugin.add("resizable","animate",{stop:function(t){var r=x(this).resizable("instance"),e=r.options,n=r._proportionallyResizeElements,i=n.length&&/textarea/i.test(n[0].nodeName),o=i&&r._hasScroll(n[0],"left")?0:r.sizeDiff.height,i=i?0:r.sizeDiff.width,i={width:r.size.width-i,height:r.size.height-o},o=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,a=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;r.element.animate(x.extend(i,a&&o?{top:a,left:o}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var e={width:parseInt(r.element.css("width"),10),height:parseInt(r.element.css("height"),10),top:parseInt(r.element.css("top"),10),left:parseInt(r.element.css("left"),10)};n&&n.length&&x(n[0]).css({width:e.width,height:e.height}),r._updateCache(e),r._propagate("resize",t)}})}}),x.ui.plugin.add("resizable","containment",{start:function(){var r,n,e,t,i=x(this).resizable("instance"),o=i.options,a=i.element,o=o.containment,a=o instanceof x?o.get(0):/parent/.test(o)?a.parent().get(0):o;a&&(i.containerElement=x(a),/document/.test(o)||o===document?(i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:x(document),left:0,top:0,width:x(document).width(),height:x(document).height()||document.body.parentNode.scrollHeight}):(r=x(a),n=[],x(["Top","Right","Left","Bottom"]).each(function(e,t){n[e]=i._num(r.css("padding"+t))}),i.containerOffset=r.offset(),i.containerPosition=r.position(),i.containerSize={height:r.innerHeight()-n[3],width:r.innerWidth()-n[1]},o=i.containerOffset,t=i.containerSize.height,e=i.containerSize.width,e=i._hasScroll(a,"left")?a.scrollWidth:e,t=i._hasScroll(a)?a.scrollHeight:t,i.parentData={element:a,left:o.left,top:o.top,width:e,height:t}))},resize:function(e){var t=x(this).resizable("instance"),r=t.options,n=t.containerOffset,i=t.position,e=t._aspectRatio||e.shiftKey,o={top:0,left:0},a=t.containerElement,s=!0;a[0]!==document&&/static/.test(a.css("position"))&&(o=n),i.left<(t._helper?n.left:0)&&(t.size.width=t.size.width+(t._helper?t.position.left-n.left:t.position.left-o.left),e&&(t.size.height=t.size.width/t.aspectRatio,s=!1),t.position.left=r.helper?n.left:0),i.top<(t._helper?n.top:0)&&(t.size.height=t.size.height+(t._helper?t.position.top-n.top:t.position.top),e&&(t.size.width=t.size.height*t.aspectRatio,s=!1),t.position.top=t._helper?n.top:0),a=t.containerElement.get(0)===t.element.parent().get(0),r=/relative|absolute/.test(t.containerElement.css("position")),a&&r?(t.offset.left=t.parentData.left+t.position.left,t.offset.top=t.parentData.top+t.position.top):(t.offset.left=t.element.offset().left,t.offset.top=t.element.offset().top),i=Math.abs(t.sizeDiff.width+(t._helper?t.offset.left-o.left:t.offset.left-n.left)),a=Math.abs(t.sizeDiff.height+(t._helper?t.offset.top-o.top:t.offset.top-n.top)),i+t.size.width>=t.parentData.width&&(t.size.width=t.parentData.width-i,e)&&(t.size.height=t.size.width/t.aspectRatio,s=!1),a+t.size.height>=t.parentData.height&&(t.size.height=t.parentData.height-a,e)&&(t.size.width=t.size.height*t.aspectRatio,s=!1),s||(t.position.left=t.prevPosition.left,t.position.top=t.prevPosition.top,t.size.width=t.prevSize.width,t.size.height=t.prevSize.height)},stop:function(){var e=x(this).resizable("instance"),t=e.options,r=e.containerOffset,n=e.containerPosition,i=e.containerElement,o=x(e.helper),a=o.offset(),s=o.outerWidth()-e.sizeDiff.width,o=o.outerHeight()-e.sizeDiff.height;e._helper&&!t.animate&&/relative/.test(i.css("position"))&&x(this).css({left:a.left-n.left-r.left,width:s,height:o}),e._helper&&!t.animate&&/static/.test(i.css("position"))&&x(this).css({left:a.left-n.left-r.left,width:s,height:o})}}),x.ui.plugin.add("resizable","alsoResize",{start:function(){function t(e){x(e).each(function(){var e=x(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})}var e=x(this).resizable("instance").options;"object"!=typeof e.alsoResize||e.alsoResize.parentNode?t(e.alsoResize):e.alsoResize.length?(e.alsoResize=e.alsoResize[0],t(e.alsoResize)):x.each(e.alsoResize,function(e){t(e)})},resize:function(e,o){function r(e,r){x(e).each(function(){var e=x(this),n=x(this).data("ui-resizable-alsoresize"),i={},t=r&&r.length?r:e.parents(o.originalElement[0]).length?["width","height"]:["width","height","top","left"];x.each(t,function(e,t){var r=(n[t]||0)+(s[t]||0);r&&0<=r&&(i[t]=r||null)}),e.css(i)})}var t=x(this).resizable("instance"),n=t.options,i=t.originalSize,a=t.originalPosition,s={height:t.size.height-i.height||0,width:t.size.width-i.width||0,top:t.position.top-a.top||0,left:t.position.left-a.left||0};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?r(n.alsoResize):x.each(n.alsoResize,function(e,t){r(e,t)})},stop:function(){x(this).removeData("resizable-alsoresize")}}),x.ui.plugin.add("resizable","ghost",{start:function(){var e=x(this).resizable("instance"),t=e.options,r=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof t.ghost?t.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=x(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=x(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),x.ui.plugin.add("resizable","grid",{resize:function(){var e,t=x(this).resizable("instance"),r=t.options,n=t.size,i=t.originalSize,o=t.originalPosition,a=t.axis,s="number"==typeof r.grid?[r.grid,r.grid]:r.grid,u=s[0]||1,l=s[1]||1,c=Math.round((n.width-i.width)/u)*u,n=Math.round((n.height-i.height)/l)*l,f=i.width+c,h=i.height+n,p=r.maxWidth&&f>r.maxWidth,d=r.maxHeight&&h>r.maxHeight,y=r.minWidth&&r.minWidth>f,g=r.minHeight&&r.minHeight>h;r.grid=s,y&&(f+=u),g&&(h+=l),p&&(f-=u),d&&(h-=l),/^(se|s|e)$/.test(a)?(t.size.width=f,t.size.height=h):/^(ne)$/.test(a)?(t.size.width=f,t.size.height=h,t.position.top=o.top-n):/^(sw)$/.test(a)?(t.size.width=f,t.size.height=h,t.position.left=o.left-c):((h-l<=0||f-u<=0)&&(e=t._getPaddingPlusBorderDimensions(this)),0<h-l?(t.size.height=h,t.position.top=o.top-n):(h=l-e.height,t.size.height=h,t.position.top=o.top+i.height-h),0<f-u?(t.size.width=f,t.position.left=o.left-c):(f=l-e.height,t.size.width=f,t.position.left=o.left+i.width-f))}}),x.ui.resizable,x.widget("ui.selectable",x.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,t=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){(e=x(t.options.filter,t.element[0])).addClass("ui-selectee"),e.each(function(){var e=x(this),t=e.offset();x.data(this,"selectable-item",{element:this,$element:e,left:t.left,top:t.top,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=x("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(r){var n=this,e=this.options;this.opos=[r.pageX,r.pageY],this.options.disabled||(this.selectees=x(e.filter,this.element[0]),this._trigger("start",r),x(e.appendTo).append(this.helper),this.helper.css({left:r.pageX,top:r.pageY,width:0,height:0}),e.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var e=x.data(this,"selectable-item");e.startselected=!0,r.metaKey||r.ctrlKey||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,n._trigger("unselecting",r,{unselecting:e.element}))}),x(r.target).parents().addBack().each(function(){var e,t=x.data(this,"selectable-item");return t?(e=!r.metaKey&&!r.ctrlKey||!t.$element.hasClass("ui-selected"),t.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),t.unselecting=!e,t.selecting=e,(t.selected=e)?n._trigger("selecting",r,{selecting:t.element}):n._trigger("unselecting",r,{unselecting:t.element}),!1):void 0}))},_mouseDrag:function(r){var e,n,i,o,a,s,u;if(this.dragged=!0,!this.options.disabled)return i=(n=this).options,o=this.opos[0],a=this.opos[1],s=r.pageX,u=r.pageY,s<o&&(e=s,s=o,o=e),u<a&&(e=u,u=a,a=e),this.helper.css({left:o,top:a,width:s-o,height:u-a}),this.selectees.each(function(){var e=x.data(this,"selectable-item"),t=!1;e&&e.element!==n.element[0]&&("touch"===i.tolerance?t=!(e.left>s||o>e.right||e.top>u||a>e.bottom):"fit"===i.tolerance&&(t=e.left>o&&s>e.right&&e.top>a&&u>e.bottom),t?(e.selected&&(e.$element.removeClass("ui-selected"),e.selected=!1),e.unselecting&&(e.$element.removeClass("ui-unselecting"),e.unselecting=!1),e.selecting||(e.$element.addClass("ui-selecting"),e.selecting=!0,n._trigger("selecting",r,{selecting:e.element}))):(e.selecting&&((r.metaKey||r.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),n._trigger("unselecting",r,{unselecting:e.element}))),!e.selected||r.metaKey||r.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,n._trigger("unselecting",r,{unselecting:e.element}))))}),!1},_mouseStop:function(t){var r=this;return this.dragged=!1,x(".ui-unselecting",this.element[0]).each(function(){var e=x.data(this,"selectable-item");e.$element.removeClass("ui-unselecting"),e.unselecting=!1,e.startselected=!1,r._trigger("unselected",t,{unselected:e.element})}),x(".ui-selecting",this.element[0]).each(function(){var e=x.data(this,"selectable-item");e.$element.removeClass("ui-selecting").addClass("ui-selected"),e.selecting=!1,e.selected=!0,e.startselected=!0,r._trigger("selected",t,{selected:e.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),x.widget("ui.sortable",x.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,r){return t<=e&&e<t+r},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===e.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),x.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;0<=e;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,t){var r=null,n=!1,i=this;return!(this.reverting||this.options.disabled||"static"===this.options.type||(this._refreshItems(e),x(e.target).parents().each(function(){return x.data(this,i.widgetName+"-item")===i?(r=x(this),!1):void 0}),!(r=x.data(e.target,i.widgetName+"-item")===i?x(e.target):r))||(this.options.handle&&!t&&(x(this.options.handle,r).find("*").addBack().each(function(){this===e.target&&(n=!0)}),!n)||(this.currentItem=r,this._removeCurrentsFromItems(),0)))},_mouseStart:function(e,t,r){var n,i,o=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},x.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(i=this.document.find("body"),this.storedCursor=i.css("cursor"),i.css("cursor",o.cursor),this.storedStylesheet=x("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(i)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(n=this.containers.length-1;0<=n;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return x.ui.ddmanager&&(x.ui.ddmanager.current=this),x.ui.ddmanager&&!o.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var t,r,n,i,o=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-x(document).scrollTop()<o.scrollSensitivity?a=x(document).scrollTop(x(document).scrollTop()-o.scrollSpeed):x(window).height()-(e.pageY-x(document).scrollTop())<o.scrollSensitivity&&(a=x(document).scrollTop(x(document).scrollTop()+o.scrollSpeed)),e.pageX-x(document).scrollLeft()<o.scrollSensitivity?a=x(document).scrollLeft(x(document).scrollLeft()-o.scrollSpeed):x(window).width()-(e.pageX-x(document).scrollLeft())<o.scrollSensitivity&&(a=x(document).scrollLeft(x(document).scrollLeft()+o.scrollSpeed))),!1!==a)&&x.ui.ddmanager&&!o.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,e),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t=this.items.length-1;0<=t;t--)if(n=(r=this.items[t]).item[0],(i=this._intersectsWithPointer(r))&&r.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===i?"next":"prev"]()[0]!==n&&!x.contains(this.placeholder[0],n)&&("semi-dynamic"!==this.options.type||!x.contains(this.element[0],n))){if(this.direction=1===i?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(e,r),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),x.ui.ddmanager&&x.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,t){var r,n,i,o;if(e)return x.ui.ddmanager&&!this.options.dropBehaviour&&x.ui.ddmanager.drop(this,e),this.options.revert?(n=(r=this).placeholder.offset(),o={},(i=this.options.axis)&&"x"!==i||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),i&&"y"!==i||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,x(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(e)})):this._clear(e,t),!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),x.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?x(this.domPosition.prev).after(this.currentItem):x(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},x(e).each(function(){var e=(x(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);e&&r.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),r=[];return e=e||{},t.each(function(){r.push(x(e.item||this).attr(e.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,r=t+this.helperProportions.width,n=this.positionAbs.top,i=n+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,u=s+e.height,l=this.offset.click.top,c=this.offset.click.left,l="x"===this.options.axis||s<n+l&&n+l<u,c="y"===this.options.axis||o<t+c&&t+c<a;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?l&&c:t+this.helperProportions.width/2>o&&a>r-this.helperProportions.width/2&&n+this.helperProportions.height/2>s&&u>i-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),e="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),t=t&&e,e=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return!!t&&(this.floating?r&&"right"===r||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),e=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&e||"left"===n&&!e:r&&("down"===r&&t||"up"===r&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(0<e?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(0<e?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){function t(){a.push(this)}var r,n,i,o,a=[],s=[],u=this._connectWith();if(u&&e)for(r=u.length-1;0<=r;r--)for(n=(i=x(u[r])).length-1;0<=n;n--)(o=x.data(i[n],this.widgetFullName))&&o!==this&&!o.options.disabled&&s.push([x.isFunction(o.options.items)?o.options.items.call(o.element):x(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(s.push([x.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):x(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),r=s.length-1;0<=r;r--)s[r][0].each(t);return x(a)},_removeCurrentsFromItems:function(){var r=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=x.grep(this.items,function(e){for(var t=0;r.length>t;t++)if(r[t]===e.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var t,r,n,i,o,a,s,u,l=this.items,c=[[x.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):x(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(t=f.length-1;0<=t;t--)for(r=(n=x(f[t])).length-1;0<=r;r--)(i=x.data(n[r],this.widgetFullName))&&i!==this&&!i.options.disabled&&(c.push([x.isFunction(i.options.items)?i.options.items.call(i.element[0],e,{item:this.currentItem}):x(i.options.items,i.element),i]),this.containers.push(i));for(t=c.length-1;0<=t;t--)for(o=c[t][1],u=(a=c[t][r=0]).length;r<u;r++)(s=x(a[r])).data(this.widgetName+"-item",o),l.push({item:s,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var t,r,n,i;for(this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),t=this.items.length-1;0<=t;t--)(r=this.items[t]).instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?x(this.options.toleranceElement,r.item):r.item,e||(r.width=n.outerWidth(),r.height=n.outerHeight()),i=n.offset(),r.left=i.left,r.top=i.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;0<=t;t--)i=this.containers[t].element.offset(),this.containers[t].containerCache.left=i.left,this.containers[t].containerCache.top=i.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(r){var n,i=(r=r||this).options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var e=r.currentItem[0].nodeName.toLowerCase(),t=x("<"+e+">",r.document[0]).addClass(n||r.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===e?r.currentItem.children().each(function(){x("<td>&#160;</td>",r.document[0]).attr("colspan",x(this).attr("colspan")||1).appendTo(t)}):"img"===e&&t.attr("src",r.currentItem.attr("src")),n||t.css("visibility","hidden"),t},update:function(e,t){n&&!i.forcePlaceholderSize||(t.height()||t.height(r.currentItem.innerHeight()-parseInt(r.currentItem.css("paddingTop")||0,10)-parseInt(r.currentItem.css("paddingBottom")||0,10)),t.width())||t.width(r.currentItem.innerWidth()-parseInt(r.currentItem.css("paddingLeft")||0,10)-parseInt(r.currentItem.css("paddingRight")||0,10))}}),r.placeholder=x(i.placeholder.element.call(r.element,r.currentItem)),r.currentItem.after(r.placeholder),i.placeholder.update(r,r.placeholder)},_contactContainers:function(e){for(var t,r,n,i,o,a,s,u,l,c=null,f=null,h=this.containers.length-1;0<=h;h--)if(!x.contains(this.currentItem[0],this.containers[h].element[0]))if(this._intersectsWith(this.containers[h].containerCache)){if(c&&x.contains(this.containers[h].element[0],c.element[0]))continue;c=this.containers[h],f=h}else this.containers[h].containerCache.over&&(this.containers[h]._trigger("out",e,this._uiHash(this)),this.containers[h].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[f].containerCache.over||(this.containers[f]._trigger("over",e,this._uiHash(this)),this.containers[f].containerCache.over=1);else{for(r=1e4,n=null,i=(u=c.floating||this._isFloating(this.currentItem))?"left":"top",o=u?"width":"height",l=u?"clientX":"clientY",t=this.items.length-1;0<=t;t--)x.contains(this.containers[f].element[0],this.items[t].item[0])&&this.items[t].item[0]!==this.currentItem[0]&&(a=this.items[t].item.offset()[i],s=!1,e[l]-a>this.items[t][o]/2&&(s=!0),r>Math.abs(e[l]-a))&&(r=Math.abs(e[l]-a),n=this.items[t],this.direction=s?"up":"down");(n||this.options.dropOnEmpty)&&(this.currentContainer===this.containers[f]?this.currentContainer.containerCache.over||(this.containers[f]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1):(n?this._rearrange(e,n,null,!0):this._rearrange(e,null,this.containers[f].element,!0),this._trigger("change",e,this._uiHash()),this.containers[f]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[f],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[f]._trigger("over",e,this._uiHash(this)),this.containers[f].containerCache.over=1))}},_createHelper:function(e){var t=this.options,e=x.isFunction(t.helper)?x(t.helper.apply(this.element[0],[e,this.currentItem])):"clone"===t.helper?this.currentItem.clone():this.currentItem;return e.parents("body").length||x("parent"!==t.appendTo?t.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0]),e[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),e[0].style.width&&!t.forceHelperSize||e.width(this.currentItem.width()),e[0].style.height&&!t.forceHelperSize||e.height(this.currentItem.height()),e},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),"left"in(e=x.isArray(e)?{left:+e[0],top:+e[1]||0}:e)&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),{top:(e=this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&x.ui.ie?{top:0,left:0}:e).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){var e;return"relative"===this.cssPosition?{top:(e=this.currentItem.position()).top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}:{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),"document"!==r.containment&&"window"!==r.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,x("document"===r.containment?document:window).width()-this.helperProportions.width-this.margins.left,(x("document"===r.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(e=x(r.containment)[0],r=x(r.containment).offset(),t="hidden"!==x(e).css("overflow"),this.containment=[r.left+(parseInt(x(e).css("borderLeftWidth"),10)||0)+(parseInt(x(e).css("paddingLeft"),10)||0)-this.margins.left,r.top+(parseInt(x(e).css("borderTopWidth"),10)||0)+(parseInt(x(e).css("paddingTop"),10)||0)-this.margins.top,r.left+(t?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(x(e).css("borderLeftWidth"),10)||0)-(parseInt(x(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,r.top+(t?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(x(e).css("borderTopWidth"),10)||0)-(parseInt(x(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,t){t=t||this.position;var e="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&x.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(r[0].tagName);return{top:t.top+this.offset.relative.top*e+this.offset.parent.top*e-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():n?0:r.scrollTop())*e,left:t.left+this.offset.relative.left*e+this.offset.parent.left*e-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():n?0:r.scrollLeft())*e}},_generatePosition:function(e){var t=this.options,r=e.pageX,n=e.pageY,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&x.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(i[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(n=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3])&&(n=this.containment[3]+this.offset.click.top),t.grid)&&(e=this.originalPageY+Math.round((n-this.originalPageY)/t.grid[1])*t.grid[1],n=!this.containment||e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-t.grid[1]:e+t.grid[1],e=this.originalPageX+Math.round((r-this.originalPageX)/t.grid[0])*t.grid[0],r=!this.containment||e-this.offset.click.left>=this.containment[0]&&e-this.offset.click.left<=this.containment[2]?e:e-this.offset.click.left>=this.containment[0]?e-t.grid[0]:e+t.grid[0]),{top:n-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:i.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:i.scrollLeft())}},_rearrange:function(e,t,r,n){r?r[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function r(t,r,n){return function(e){n._trigger(t,e,r._uiHash(r))}}this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push(function(e){this._trigger("update",e,this._uiHash())}),this===this.currentContainer||t||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))),n=this.containers.length-1;0<=n;n--)t||i.push(r("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(r("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<i.length;n++)i[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===x.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||x([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}}),x.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=x(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():x()}},_createIcons:function(){var e=this.options.icons;e&&(x("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t)&&this._createIcons(),void("disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t))))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var t=x.ui.keyCode,r=this.headers.length,n=this.headers.index(e.target),i=!1;switch(e.keyCode){case t.RIGHT:case t.DOWN:i=this.headers[(n+1)%r];break;case t.LEFT:case t.UP:i=this.headers[(n-1+r)%r];break;case t.SPACE:case t.ENTER:this._eventHandler(e);break;case t.HOME:i=this.headers[0];break;case t.END:i=this.headers[r-1]}i&&(x(e.target).attr("tabIndex",-1),x(i).attr("tabIndex",0),i.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===x.ui.keyCode.UP&&e.ctrlKey&&x(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=x()):!1===e.active?this._activate(0):this.active.length&&!x.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=x()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var r,e=this.options,t=e.heightStyle,n=this.element.parent();this.active=this._findActive(e.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var e=x(this),t=e.uniqueId().attr("id"),r=e.next(),n=r.uniqueId().attr("id");e.attr("aria-controls",n),r.attr("aria-labelledby",t)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(e.event),"fill"===t?(r=n.height(),this.element.siblings(":visible").each(function(){var e=x(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(r-=e.outerHeight(!0))}),this.headers.each(function(){r-=x(this).outerHeight(!0)}),this.headers.next().each(function(){x(this).height(Math.max(0,r-x(this).innerHeight()+x(this).height()))}).css("overflow","auto")):"auto"===t&&(r=0,this.headers.next().each(function(){r=Math.max(r,x(this).css("height","").height())}).height(r))},_activate:function(e){e=this._findActive(e)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,currentTarget:e,preventDefault:x.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):x()},_setupEvents:function(e){var r={keydown:"_keydown"};e&&x.each(e.split(" "),function(e,t){r[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,r),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var t=this.options,r=this.active,n=x(e.currentTarget),i=n[0]===r[0],o=i&&t.collapsible,a=o?x():n.next(),s=r.next(),s={oldHeader:r,oldPanel:s,newHeader:o?x():n,newPanel:a};e.preventDefault(),i&&!t.collapsible||!1===this._trigger("beforeActivate",e,s)||(t.active=!o&&this.headers.index(n),this.active=i?x():n,this._toggle(s),r.removeClass("ui-accordion-header-active ui-state-active"),t.icons&&r.children(".ui-accordion-header-icon").removeClass(t.icons.activeHeader).addClass(t.icons.header),i)||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),t.icons&&n.children(".ui-accordion-header-icon").removeClass(t.icons.header).addClass(t.icons.activeHeader),n.next().addClass("ui-accordion-content-active"))},_toggle:function(e){var t=e.newPanel,r=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=t,this.prevHide=r,this.options.animate?this._animate(t,r,e):(r.hide(),t.show(),this._toggleComplete(e)),r.attr({"aria-hidden":"true"}),r.prev().attr("aria-selected","false"),t.length&&r.length?r.prev().attr({tabIndex:-1,"aria-expanded":"false"}):t.length&&this.headers.filter(function(){return 0===x(this).attr("tabIndex")}).attr("tabIndex",-1),t.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,r,t){function n(){o._toggleComplete(t)}var i,o=this,a=0,s=e.length&&(!r.length||e.index()<r.index()),u=this.options.animate||{},s=s&&u.down||u,l=(l="string"==typeof s?s:l)||s.easing||u.easing,c=(c="number"==typeof s?s:c)||s.duration||u.duration;return r.length?e.length?(i=e.show().outerHeight(),r.animate(this.hideProps,{duration:c,easing:l,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:c,easing:l,complete:n,step:function(e,t){t.now=Math.round(e),"height"!==t.prop?a+=t.now:"content"!==o.options.heightStyle&&(t.now=Math.round(i-r.outerHeight()-a),a=0)}})):r.animate(this.hideProps,c,l,n):e.animate(this.showProps,c,l,n)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),x.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(e){var t=x(e.target);!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),t.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&x(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active)&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer))},"mouseenter .ui-menu-item":function(e){var t;this.previousFilter||((t=x(e.currentTarget)).siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,t))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var r=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,r)},blur:function(e){this._delay(function(){x.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=x(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var t,r,n,i=!0;switch(e.keyCode){case x.ui.keyCode.PAGE_UP:this.previousPage(e);break;case x.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case x.ui.keyCode.HOME:this._move("first","first",e);break;case x.ui.keyCode.END:this._move("last","last",e);break;case x.ui.keyCode.UP:this.previous(e);break;case x.ui.keyCode.DOWN:this.next(e);break;case x.ui.keyCode.LEFT:this.collapse(e);break;case x.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case x.ui.keyCode.ENTER:case x.ui.keyCode.SPACE:this._activate(e);break;case x.ui.keyCode.ESCAPE:this.collapse(e);break;default:i=!1,t=this.previousFilter||"",r=String.fromCharCode(e.keyCode),n=!1,clearTimeout(this.filterTimer),r===t?n=!0:r=t+r,t=this._filterMenuItems(r),(t=n&&-1!==t.index(this.active.next())?this.active.nextAll(".ui-menu-item"):t).length||(r=String.fromCharCode(e.keyCode),t=this._filterMenuItems(r)),t.length?(this.focus(e,t),this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}i&&e.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t=this,n=this.options.icons.submenu,e=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),e.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=x(this),t=e.parent(),r=x("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);t.attr("aria-haspopup","true").prepend(r),e.attr("aria-labelledby",t.attr("id"))}),(e=e.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var e=x(this);t._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),e.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!x.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),r=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(r=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(r),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,r,n;this._hasScroll()&&(t=parseFloat(x.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(x.css(this.activeMenu[0],"paddingTop"))||0,t=e.offset().top-this.activeMenu.offset().top-t-r,r=this.activeMenu.scrollTop(),n=this.activeMenu.height(),e=e.outerHeight(),t<0?this.activeMenu.scrollTop(r+t):n<t+e&&this.activeMenu.scrollTop(r+t-n+e))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(e){var t=x.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,r){clearTimeout(this.timer),this.timer=this._delay(function(){var e=r?this.element:x(t&&t.target).closest(this.element.find(".ui-menu"));e.length||(e=this.element),this._close(e),this.blur(t),this.activeMenu=e},this.delay)},_close:function(e){(e=e||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!x(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,r){var n;(n=this.active?"first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0):n)&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[t]()),this.focus(r,n)},nextPage:function(e){var t,r,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(t=x(this)).offset().top-r-n<0}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var t,r,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(t=x(this)).offset().top-r+n}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||x(e.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,t)},_filterMenuItems:function(e){var e=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),t=RegExp("^"+e,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return t.test(x.trim(x(this).text()))})}}),x.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var r,n,i,e=this.element[0].nodeName.toLowerCase(),t="textarea"===e,e="input"===e;this.isMultiLine=t||!e&&this.element.prop("isContentEditable"),this.valueMethod=this.element[t||e?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))n=i=r=!0;else{n=i=r=!1;var t=x.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:r=!0,this._move("previousPage",e);break;case t.PAGE_DOWN:r=!0,this._move("nextPage",e);break;case t.UP:r=!0,this._keyEvent("previous",e);break;case t.DOWN:r=!0,this._keyEvent("next",e);break;case t.ENTER:this.menu.active&&(r=!0,e.preventDefault(),this.menu.select(e));break;case t.TAB:this.menu.active&&this.menu.select(e);break;case t.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:n=!0,this._searchTimeout(e)}}},keypress:function(e){if(r)r=!1,this.isMultiLine&&!this.menu.element.is(":visible")||e.preventDefault();else if(!n){var t=x.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:this._move("previousPage",e);break;case t.PAGE_DOWN:this._move("nextPage",e);break;case t.UP:this._keyEvent("previous",e);break;case t.DOWN:this._keyEvent("next",e)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=x("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var r=this.menu.element[0];x(e.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(e){e.target===t.element[0]||e.target===r||x.contains(r,e.target)||t.close()})})},menufocus:function(e,t){var r;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent)&&/^mouse/.test(e.originalEvent.type)?(this.menu.blur(),void this.document.one("mousemove",function(){x(e.target).trigger(e.originalEvent)})):(r=t.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:r})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(r.value),void((t=t.item.attr("aria-label")||r.value)&&x.trim(t).length&&(this.liveRegion.children().hide(),x("<div>").text(t).appendTo(this.liveRegion))))},menuselect:function(e,t){var r=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=r})),!1!==this._trigger("select",e,{item:r})&&this._value(r.value),this.term=this._value(),this.close(e),this.selectedItem=r}}),this.liveRegion=x("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e=(e=(e=e&&(e.jquery||e.nodeType?x(e):this.document.find(e).eq(0)))&&e[0]?e:this.element.closest(".ui-front")).length?e:this.document[0].body},_initSource:function(){var r,n,i=this;x.isArray(this.options.source)?(r=this.options.source,this.source=function(e,t){t(x.ui.autocomplete.filter(r,e.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(e,t){i.xhr&&i.xhr.abort(),i.xhr=x.ajax({url:n,data:e,dataType:"json",success:function(e){t(e)},error:function(){t([])}})}):this.source=this.options.source},_searchTimeout:function(n){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),t=this.menu.element.is(":visible"),r=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;e&&(t||r)||(this.selectedItem=null,this.search(null,n))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return x.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e=e&&this._normalize(e),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:x.map(e,function(e){return"string"==typeof e?{label:e,value:e}:x.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e),this.isNewMenu=!0,this.menu.refresh(),t.show(),this._resizeMenu(),t.position(x.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(r,e){var n=this;x.each(e,function(e,t){n._renderItemData(r,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return x("<li>").text(t.label).appendTo(e)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),x.extend(x.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var r=RegExp(x.ui.autocomplete.escapeRegex(t),"i");return x.grep(e,function(e){return r.test(e.label||e.value||e)})}}),x.widget("ui.autocomplete",x.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(1<e?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),x("<div>").text(t).appendTo(this.liveRegion))}}),x.ui.autocomplete;function $(){var e=x(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)}function J(e){var t=e.name,r=e.form,n=x([]);return t&&(t=t.replace(/'/g,"\\'"),n=r?x(r).find("[name='"+t+"'][type=radio]"):x("[name='"+t+"'][type=radio]",e.ownerDocument).filter(function(){return!this.form})),n}var g,m,v,b,Q,ee,te,re,ne,ie,oe,ae,_,w,P,se,ue,k,E,T,C,R,le="ui-button ui-widget ui-state-default ui-corner-all",ce="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",fe=(x.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,$),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,r=this.options,e="checkbox"===this.type||"radio"===this.type,n=e?"":"ui-state-active";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(le).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===g&&x(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||x(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){r.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),e&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!r.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled)return!1;x(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var e=t.element[0];J(e).not(e).map(function(){return x(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!r.disabled&&(x(this).addClass("ui-state-active"),g=this,void t.document.one("mouseup",function(){g=null}))}).bind("mouseup"+this.eventNamespace,function(){return!r.disabled&&void x(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return!r.disabled&&void(e.keyCode!==x.ui.keyCode.SPACE&&e.keyCode!==x.ui.keyCode.ENTER||x(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){x(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===x.ui.keyCode.SPACE&&x(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var e,t;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=(t.length?t:this.element).siblings(),this.buttonElement=t.filter(e),this.buttonElement.length)||(this.buttonElement=t.find(e)),this.element.addClass("ui-helper-hidden-accessible"),(t=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",t)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(le+" ui-state-active "+ce).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),void(t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?J(this.element[0]).each(function(){x(this).is(":checked")?x(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):x(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){var e,t,r,n,i;"input"===this.type?this.options.label&&this.element.val(this.options.label):(e=this.buttonElement.removeClass(ce),t=x("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),n=(r=this.options.icons).primary&&r.secondary,i=[],r.primary||r.secondary?(this.options.text&&i.push("ui-button-text-icon"+(n?"s":r.primary?"-primary":"-secondary")),r.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(i.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle)||e.attr("title",x.trim(t))):i.push("ui-button-text-only"),e.addClass(i.join(" ")))}}),x.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var e="rtl"===this.element.css("direction"),t=this.element.find(this.options.items),r=t.filter(":ui-button");t.not(":ui-button").button(),r.button("refresh"),this.buttons=t.map(function(){return x(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return x(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),x.ui.button,x.extend(x.ui,{datepicker:{version:"1.11.2"}}),x.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return u(this._defaults,e||{}),this},_attachDatepicker:function(e,t){var r,n=e.nodeName.toLowerCase(),i="div"===n||"span"===n;e.id||(this.uuid+=1,e.id="dp"+this.uuid),(r=this._newInst(x(e),i)).settings=x.extend({},t||{}),"input"===n?this._connectDatepicker(e,r):i&&this._inlineDatepicker(e,r)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?r(x("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,t){var r=x(e);t.append=x([]),t.trigger=x([]),r.hasClass(this.markerClassName)||(this._attachments(r,t),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(t),x.data(e,"datepicker",t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var r,n=this._get(t,"appendText"),i=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=x("<span class='"+this._appendClass+"'>"+n+"</span>"),e[i?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),"focus"!==(n=this._get(t,"showOn"))&&"both"!==n||e.focus(this._showDatepicker),"button"!==n&&"both"!==n||(n=this._get(t,"buttonText"),r=this._get(t,"buttonImage"),t.trigger=x(this._get(t,"buttonImageOnly")?x("<img/>").addClass(this._triggerClass).attr({src:r,alt:n,title:n}):x("<button type='button'></button>").addClass(this._triggerClass).html(r?x("<img/>").attr({src:r,alt:n,title:n}):n)),e[i?"before":"after"](t.trigger),t.trigger.click(function(){return x.datepicker._datepickerShowing&&x.datepicker._lastInput===e[0]?x.datepicker._hideDatepicker():(x.datepicker._datepickerShowing&&x.datepicker._lastInput!==e[0]&&x.datepicker._hideDatepicker(),x.datepicker._showDatepicker(e[0])),!1}))},_autoSize:function(e){var t,r,n,i,o,a;this._get(e,"autoSize")&&!e.inline&&(o=new Date(2009,11,20),(a=this._get(e,"dateFormat")).match(/[DM]/)&&(o.setMonth((t=function(e){for(i=n=r=0;e.length>i;i++)e[i].length>r&&(r=e[i].length,n=i);return n})(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),e.input.attr("size",this._formatDate(e,o).length))},_inlineDatepicker:function(e,t){var r=x(e);r.hasClass(this.markerClassName)||(r.addClass(this.markerClassName).append(t.dpDiv),x.data(e,"datepicker",t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,r,n,i){var o,a=this._dialogInst;return a||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=x("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),x("body").append(this._dialogInput),(a=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},x.data(this._dialogInput[0],"datepicker",a)),u(a.settings,n||{}),t=t&&t.constructor===Date?this._formatDate(a,t):t,this._dialogInput.val(t),this._pos=i?i.length?i:[i.pageX,i.pageY]:null,this._pos||(o=document.documentElement.clientWidth,n=document.documentElement.clientHeight,t=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[o/2-100+t,n/2-150+i]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),a.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),x.blockUI&&x.blockUI(this.dpDiv),x.data(this._dialogInput[0],"datepicker",a),this},_destroyDatepicker:function(e){var t,r=x(e),n=x.data(e,"datepicker");r.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),x.removeData(e,"datepicker"),"input"===t?(n.append.remove(),n.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==t&&"span"!==t||r.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var e,r=x(t),n=x.data(t,"datepicker");r.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==e&&"span"!==e||((n=r.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=x.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var e,r=x(t),n=x.data(t,"datepicker");r.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==e&&"span"!==e||((n=r.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=x.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(e)for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(e){try{return x.data(e,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,r){var n,i,o,a,s=this._getInst(e);return 2===arguments.length&&"string"==typeof t?"defaults"===t?x.extend({},x.datepicker._defaults):s?"all"===t?x.extend({},s.settings):this._get(s,t):null:(n=t||{},"string"==typeof t&&((n={})[t]=r),void(s&&(this._curInst===s&&this._hideDatepicker(),i=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(s,"min"),a=this._getMinMaxDate(s,"max"),u(s.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(s.settings.minDate=this._formatDate(s,o)),null!==a&&void 0!==n.dateFormat&&void 0===n.maxDate&&(s.settings.maxDate=this._formatDate(s,a)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(x(e),s),this._autoSize(s),this._setDate(s,i),this._updateAlternate(s),this._updateDatepicker(s))))},_changeDatepicker:function(e,t,r){this._optionDatepicker(e,t,r)},_refreshDatepicker:function(e){e=this._getInst(e);e&&this._updateDatepicker(e)},_setDateDatepicker:function(e,t){e=this._getInst(e);e&&(this._setDate(e,t),this._updateDatepicker(e),this._updateAlternate(e))},_getDateDatepicker:function(e,t){e=this._getInst(e);return e&&!e.inline&&this._setDateFromField(e,t),e?this._getDate(e):null},_doKeyDown:function(e){var t,r,n=x.datepicker._getInst(e.target),i=!0,o=n.dpDiv.is(".ui-datepicker-rtl");if(n._keyEvent=!0,x.datepicker._datepickerShowing)switch(e.keyCode){case 9:x.datepicker._hideDatepicker(),i=!1;break;case 13:return(r=x("td."+x.datepicker._dayOverClass+":not(."+x.datepicker._currentClass+")",n.dpDiv))[0]&&x.datepicker._selectDay(e.target,n.selectedMonth,n.selectedYear,r[0]),(r=x.datepicker._get(n,"onSelect"))?(t=x.datepicker._formatDate(n),r.apply(n.input?n.input[0]:null,[t,n])):x.datepicker._hideDatepicker(),!1;case 27:x.datepicker._hideDatepicker();break;case 33:x.datepicker._adjustDate(e.target,e.ctrlKey?-x.datepicker._get(n,"stepBigMonths"):-x.datepicker._get(n,"stepMonths"),"M");break;case 34:x.datepicker._adjustDate(e.target,e.ctrlKey?+x.datepicker._get(n,"stepBigMonths"):+x.datepicker._get(n,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&x.datepicker._clearDate(e.target),i=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&x.datepicker._gotoToday(e.target),i=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,o?1:-1,"D"),i=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&x.datepicker._adjustDate(e.target,e.ctrlKey?-x.datepicker._get(n,"stepBigMonths"):-x.datepicker._get(n,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,-7,"D"),i=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,o?-1:1,"D"),i=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&x.datepicker._adjustDate(e.target,e.ctrlKey?+x.datepicker._get(n,"stepBigMonths"):+x.datepicker._get(n,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,7,"D"),i=e.ctrlKey||e.metaKey;break;default:i=!1}else 36===e.keyCode&&e.ctrlKey?x.datepicker._showDatepicker(this):i=!1;i&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t,r=x.datepicker._getInst(e.target);return x.datepicker._get(r,"constrainInput")?(r=x.datepicker._possibleChars(x.datepicker._get(r,"dateFormat")),t=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||t<" "||!r||-1<r.indexOf(t)):void 0},_doKeyUp:function(e){e=x.datepicker._getInst(e.target);if(e.input.val()!==e.lastVal)try{x.datepicker.parseDate(x.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,x.datepicker._getFormatConfig(e))&&(x.datepicker._setDateFromField(e),x.datepicker._updateAlternate(e),x.datepicker._updateDatepicker(e))}catch(e){}return!0},_showDatepicker:function(e){var t,r,n,i;"input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=x("input",e.parentNode)[0]),x.datepicker._isDisabledDatepicker(e)||x.datepicker._lastInput===e||(i=x.datepicker._getInst(e),x.datepicker._curInst&&x.datepicker._curInst!==i&&(x.datepicker._curInst.dpDiv.stop(!0,!0),i)&&x.datepicker._datepickerShowing&&x.datepicker._hideDatepicker(x.datepicker._curInst.input[0]),!1!==(r=(r=x.datepicker._get(i,"beforeShow"))?r.apply(e,[e,i]):{})&&(u(i.settings,r),i.lastVal=null,x.datepicker._lastInput=e,x.datepicker._setDateFromField(i),x.datepicker._inDialog&&(e.value=""),x.datepicker._pos||(x.datepicker._pos=x.datepicker._findPos(e),x.datepicker._pos[1]+=e.offsetHeight),t=!1,x(e).parents().each(function(){return!(t|="fixed"===x(this).css("position"))}),r={left:x.datepicker._pos[0],top:x.datepicker._pos[1]},x.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),x.datepicker._updateDatepicker(i),r=x.datepicker._checkOffset(i,r,t),i.dpDiv.css({position:x.datepicker._inDialog&&x.blockUI?"static":t?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),i.inline||(r=x.datepicker._get(i,"showAnim"),n=x.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(e){for(var t;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(t=parseInt(e.css("zIndex"),10),!isNaN(t))&&0!==t)return t;e=e.parent()}return 0}(x(e))+1),x.datepicker._datepickerShowing=!0,x.effects&&x.effects.effect[r]?i.dpDiv.show(r,x.datepicker._get(i,"showOptions"),n):i.dpDiv[r||"show"](r?n:null),x.datepicker._shouldFocusInput(i)&&i.input.focus(),x.datepicker._curInst=i)))},_updateDatepicker:function(e){this.maxRows=4,(m=e).dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var t,r=this._getNumberOfMonths(e),n=r[1],i=e.dpDiv.find("."+this._dayOverClass+" a");0<i.length&&o.apply(i.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<n&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em"),e.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===x.datepicker._curInst&&x.datepicker._datepickerShowing&&x.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(t=e.yearshtml,setTimeout(function(){t===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),t=e.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,r){var n=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,s=document.documentElement.clientWidth+(r?0:x(document).scrollLeft()),u=document.documentElement.clientHeight+(r?0:x(document).scrollTop());return t.left-=this._get(e,"isRTL")?n-o:0,t.left-=r&&t.left===e.input.offset().left?x(document).scrollLeft():0,t.top-=r&&t.top===e.input.offset().top+a?x(document).scrollTop():0,t.left-=Math.min(t.left,t.left+n>s&&n<s?Math.abs(t.left+n-s):0),t.top-=Math.min(t.top,t.top+i>u&&i<u?Math.abs(i+a):0),t},_findPos:function(e){for(var t=this._getInst(e),r=this._get(t,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||x.expr.filters.hidden(e));)e=e[r?"previousSibling":"nextSibling"];return[(t=x(e).offset()).left,t.top]},_hideDatepicker:function(e){var t,r,n=this._curInst;!n||e&&n!==x.data(e,"datepicker")||this._datepickerShowing&&(e=this._get(n,"showAnim"),r=this._get(n,"duration"),t=function(){x.datepicker._tidyDialog(n)},x.effects&&(x.effects.effect[e]||x.effects[e])?n.dpDiv.hide(e,x.datepicker._get(n,"showOptions"),r,t):n.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?r:null,t),e||t(),this._datepickerShowing=!1,(r=this._get(n,"onClose"))&&r.apply(n.input?n.input[0]:null,[n.input?n.input.val():"",n]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),x.blockUI)&&(x.unblockUI(),x("body").append(this.dpDiv)),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){var t;x.datepicker._curInst&&(e=x(e.target),t=x.datepicker._getInst(e[0]),!(e[0].id===x.datepicker._mainDivId||0!==e.parents("#"+x.datepicker._mainDivId).length||e.hasClass(x.datepicker.markerClassName)||e.closest("."+x.datepicker._triggerClass).length||!x.datepicker._datepickerShowing||x.datepicker._inDialog&&x.blockUI)||e.hasClass(x.datepicker.markerClassName)&&x.datepicker._curInst!==t)&&x.datepicker._hideDatepicker()},_adjustDate:function(e,t,r){var e=x(e),n=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(n,t+("M"===r?this._get(n,"showCurrentAtPos"):0),r),this._updateDatepicker(n))},_gotoToday:function(e){var t,e=x(e),r=this._getInst(e[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(t=new Date,r.selectedDay=t.getDate(),r.drawMonth=r.selectedMonth=t.getMonth(),r.drawYear=r.selectedYear=t.getFullYear()),this._notifyChange(r),this._adjustDate(e)},_selectMonthYear:function(e,t,r){var e=x(e),n=this._getInst(e[0]);n["selected"+("M"===r?"Month":"Year")]=n["draw"+("M"===r?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(n),this._adjustDate(e)},_selectDay:function(e,t,r,n){var i=x(e);x(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(i[0])||((i=this._getInst(i[0])).selectedDay=i.currentDay=x("a",n).html(),i.selectedMonth=i.currentMonth=t,i.selectedYear=i.currentYear=r,this._selectDate(e,this._formatDate(i,i.currentDay,i.currentMonth,i.currentYear)))},_clearDate:function(e){e=x(e);this._selectDate(e,"")},_selectDate:function(e,t){var r,e=x(e),e=this._getInst(e[0]);t=null!=t?t:this._formatDate(e),e.input&&e.input.val(t),this._updateAlternate(e),(r=this._get(e,"onSelect"))?r.apply(e.input?e.input[0]:null,[t,e]):e.input&&e.input.trigger("change"),e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t,r,n,i=this._get(e,"altField");i&&(t=this._get(e,"altFormat")||this._get(e,"dateFormat"),r=this._getDate(e),n=this.formatDate(t,r,this._getFormatConfig(e)),x(i).each(function(){x(this).val(n)}))},noWeekends:function(e){e=e.getDay();return[0<e&&e<6,""]},iso8601Week:function(e){var t,e=new Date(e.getTime());return e.setDate(e.getDate()+4-(e.getDay()||7)),t=e.getTime(),e.setMonth(0),e.setDate(1),Math.floor(Math.round((t-e)/864e5)/7)+1},parseDate:function(t,i,e){if(null==t||null==i)throw"Invalid arguments";if(""===(i="object"==typeof i?""+i:i+""))return null;function r(e){var t=b(e),t="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,e=RegExp("^\\d{"+("y"===e?t:1)+","+t+"}");if(t=i.substring(u).match(e))return u+=t[0].length,parseInt(t[0],10);throw"Missing number at position "+u}function n(e,t,r){var n=-1,e=x.map(b(e)?r:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(x.each(e,function(e,t){var r=t[1];return i.substr(u,r.length).toLowerCase()===r.toLowerCase()?(n=t[0],u+=r.length,!1):void 0}),-1!==n)return n+1;throw"Unknown name at position "+u}function o(){if(i.charAt(u)!==t.charAt(_))throw"Unexpected literal at position "+u;u++}for(var a,s,u=0,l=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,l="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),c=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,f=(e?e.dayNames:null)||this._defaults.dayNames,h=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,p=(e?e.monthNames:null)||this._defaults.monthNames,d=-1,y=-1,g=-1,m=-1,v=!1,b=function(e){e=t.length>_+1&&t.charAt(_+1)===e;return e&&_++,e},_=0;t.length>_;_++)if(v)"'"!==t.charAt(_)||b("'")?o():v=!1;else switch(t.charAt(_)){case"d":g=r("d");break;case"D":n("D",c,f);break;case"o":m=r("o");break;case"m":y=r("m");break;case"M":y=n("M",h,p);break;case"y":d=r("y");break;case"@":d=(s=new Date(r("@"))).getFullYear(),y=s.getMonth()+1,g=s.getDate();break;case"!":d=(s=new Date((r("!")-this._ticksTo1970)/1e4)).getFullYear(),y=s.getMonth()+1,g=s.getDate();break;case"'":b("'")?o():v=!0;break;default:o()}if(i.length>u&&(e=i.substr(u),!/^\s+/.test(e)))throw"Extra/unparsed characters found in date: "+e;if(-1===d?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=l?0:-100)),-1<m)for(y=1,g=m;!(g<=(a=this._getDaysInMonth(d,y-1)));)y++,g-=a;if((s=this._daylightSavingAdjust(new Date(d,y-1,g))).getFullYear()!==d||s.getMonth()+1!==y||s.getDate()!==g)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,r){if(!e)return"";function n(e,t,r){var n=""+t;if(c(e))for(;r>n.length;)n="0"+n;return n}function i(e,t,r,n){return(c(e)?n:r)[t]}var o,a=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,s=(r?r.dayNames:null)||this._defaults.dayNames,u=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,l=(r?r.monthNames:null)||this._defaults.monthNames,c=function(e){e=t.length>o+1&&t.charAt(o+1)===e;return e&&o++,e},f="",h=!1;if(e)for(o=0;t.length>o;o++)if(h)"'"!==t.charAt(o)||c("'")?f+=t.charAt(o):h=!1;else switch(t.charAt(o)){case"d":f+=n("d",e.getDate(),2);break;case"D":f+=i("D",e.getDay(),a,s);break;case"o":f+=n("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":f+=n("m",e.getMonth()+1,2);break;case"M":f+=i("M",e.getMonth(),u,l);break;case"y":f+=c("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":f+=e.getTime();break;case"!":f+=1e4*e.getTime()+this._ticksTo1970;break;case"'":c("'")?f+="'":h=!0;break;default:f+=t.charAt(o)}return f},_possibleChars:function(t){function e(e){return(e=t.length>i+1&&t.charAt(i+1)===e)&&i++,e}for(var r="",n=!1,i=0;t.length>i;i++)if(n)"'"!==t.charAt(i)||e("'")?r+=t.charAt(i):n=!1;else switch(t.charAt(i)){case"d":case"m":case"y":case"@":r+="0123456789";break;case"D":case"M":return null;case"'":e("'")?r+="'":n=!0;break;default:r+=t.charAt(i)}return r},_get:function(e,t){return(void 0!==e.settings[t]?e.settings:this._defaults)[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var r=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),o=i,a=this._getFormatConfig(e);try{o=this.parseDate(r,n,a)||i}catch(e){n=t?"":n}e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),e.currentDay=n?o.getDate():0,e.currentMonth=n?o.getMonth():0,e.currentYear=n?o.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(s,e,t){var r,n=null==e||""===e?t:"string"==typeof e?function(e){try{return x.datepicker.parseDate(x.datepicker._get(s,"dateFormat"),e,x.datepicker._getFormatConfig(s))}catch(e){}for(var t=(e.toLowerCase().match(/^c/)?x.datepicker._getDate(s):null)||new Date,r=t.getFullYear(),n=t.getMonth(),i=t.getDate(),o=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=o.exec(e);a;){switch(a[2]||"d"){case"d":case"D":i+=parseInt(a[1],10);break;case"w":case"W":i+=7*parseInt(a[1],10);break;case"m":case"M":n+=parseInt(a[1],10),i=Math.min(i,x.datepicker._getDaysInMonth(r,n));break;case"y":case"Y":r+=parseInt(a[1],10),i=Math.min(i,x.datepicker._getDaysInMonth(r,n))}a=o.exec(e)}return new Date(r,n,i)}(e):"number"==typeof e?isNaN(e)?t:(n=e,(r=new Date).setDate(r.getDate()+n),r):new Date(e.getTime());return(n=n&&"Invalid Date"==""+n?t:n)&&(n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)),this._daylightSavingAdjust(n)},_daylightSavingAdjust:function(e){return e?(e.setHours(12<e.getHours()?e.getHours()+2:0),e):null},_setDate:function(e,t,r){var n=!t,i=e.selectedMonth,o=e.selectedYear,t=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=t.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=t.getMonth(),e.drawYear=e.selectedYear=e.currentYear=t.getFullYear(),i===e.selectedMonth&&o===e.selectedYear||r||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),r="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){x.datepicker._adjustDate(r,-t,"M")},next:function(){x.datepicker._adjustDate(r,+t,"M")},hide:function(){x.datepicker._hideDatepicker()},today:function(){x.datepicker._gotoToday(r)},selectDay:function(){return x.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return x.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return x.datepicker._selectMonthYear(r,this,"Y"),!1}};x(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,r,n,i,o,D,F,N,B,a,s,G,u,l,c,f,h,p,d,y,g,m,U,v,b,_,w,z,W,x,S,j,O=new Date,V=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth(),O.getDate())),P=this._get(e,"isRTL"),O=this._get(e,"showButtonPanel"),k=this._get(e,"hideIfNoPrevNext"),E=this._get(e,"navigationAsDateFormat"),T=this._getNumberOfMonths(e),C=this._get(e,"showCurrentAtPos"),R=this._get(e,"stepMonths"),H=1!==T[0]||1!==T[1],q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),M=this._getMinMaxDate(e,"min"),I=this._getMinMaxDate(e,"max"),A=e.drawMonth-C,L=e.drawYear;if(A<0&&(A+=12,L--),I)for(t=this._daylightSavingAdjust(new Date(I.getFullYear(),I.getMonth()-T[0]*T[1]+1,I.getDate())),t=M&&t<M?M:t;this._daylightSavingAdjust(new Date(L,A,1))>t;)--A<0&&(A=11,L--);for(e.drawMonth=A,e.drawYear=L,C=this._get(e,"prevText"),C=E?this.formatDate(C,this._daylightSavingAdjust(new Date(L,A-R,1)),this._getFormatConfig(e)):C,r=this._canAdjustMonth(e,-1,L,A)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+C+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"e":"w")+"'>"+C+"</span></a>":k?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+C+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"e":"w")+"'>"+C+"</span></a>",C=this._get(e,"nextText"),C=E?this.formatDate(C,this._daylightSavingAdjust(new Date(L,A+R,1)),this._getFormatConfig(e)):C,n=this._canAdjustMonth(e,1,L,A)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+C+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"w":"e")+"'>"+C+"</span></a>":k?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+C+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"w":"e")+"'>"+C+"</span></a>",R=this._get(e,"currentText"),k=this._get(e,"gotoCurrent")&&e.currentDay?q:V,R=E?this.formatDate(R,k,this._getFormatConfig(e)):R,C=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",E=O?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(P?C:"")+(this._isInRange(e,k)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+R+"</button>":"")+(P?"":C)+"</div>":"",i=parseInt(this._get(e,"firstDay"),10),i=isNaN(i)?0:i,o=this._get(e,"showWeek"),D=this._get(e,"dayNames"),F=this._get(e,"dayNamesMin"),N=this._get(e,"monthNames"),B=this._get(e,"monthNamesShort"),a=this._get(e,"beforeShowDay"),s=this._get(e,"showOtherMonths"),G=this._get(e,"selectOtherMonths"),u=this._getDefaultDate(e),l="",f=0;T[0]>f;f++){for(h="",this.maxRows=4,p=0;T[1]>p;p++){if(d=this._daylightSavingAdjust(new Date(L,A,e.selectedDay)),y=" ui-corner-all",g="",H){if(g+="<div class='ui-datepicker-group",1<T[1])switch(p){case 0:g+=" ui-datepicker-group-first",y=" ui-corner-"+(P?"right":"left");break;case T[1]-1:g+=" ui-datepicker-group-last",y=" ui-corner-"+(P?"left":"right");break;default:g+=" ui-datepicker-group-middle",y=""}g+="'>"}for(g+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+y+"'>"+(/all|left/.test(y)&&0===f?P?n:r:"")+(/all|right/.test(y)&&0===f?P?r:n:"")+this._generateMonthYearHeader(e,A,L,M,I,0<f||0<p,N,B)+"</div><table class='ui-datepicker-calendar'><thead><tr>",m=o?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",c=0;c<7;c++)m+="<th scope='col'"+(5<=(c+i+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+D[U=(c+i)%7]+"'>"+F[U]+"</span></th>";for(g+=m+"</tr></thead><tbody>",b=this._getDaysInMonth(L,A),L===e.selectedYear&&A===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,b)),v=(this._getFirstDayOfMonth(L,A)-i+7)%7,b=Math.ceil((v+b)/7),_=H&&this.maxRows>b?this.maxRows:b,this.maxRows=_,w=this._daylightSavingAdjust(new Date(L,A,1-v)),z=0;z<_;z++){for(g+="<tr>",W=o?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(w)+"</td>":"",c=0;c<7;c++)x=a?a.apply(e.input?e.input[0]:null,[w]):[!0,""],j=(S=w.getMonth()!==A)&&!G||!x[0]||M&&w<M||I&&I<w,W+="<td class='"+(5<=(c+i+6)%7?" ui-datepicker-week-end":"")+(S?" ui-datepicker-other-month":"")+(w.getTime()===d.getTime()&&A===e.selectedMonth&&e._keyEvent||u.getTime()===w.getTime()&&u.getTime()===d.getTime()?" "+this._dayOverClass:"")+(j?" "+this._unselectableClass+" ui-state-disabled":"")+(S&&!s?"":" "+x[1]+(w.getTime()===q.getTime()?" "+this._currentClass:"")+(w.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(S&&!s||!x[2]?"":" title='"+x[2].replace(/'/g,"&#39;")+"'")+(j?"":" data-handler='selectDay' data-event='click' data-month='"+w.getMonth()+"' data-year='"+w.getFullYear()+"'")+">"+(S&&!s?"&#xa0;":j?"<span class='ui-state-default'>"+w.getDate()+"</span>":"<a class='ui-state-default"+(w.getTime()===V.getTime()?" ui-state-highlight":"")+(w.getTime()===q.getTime()?" ui-state-active":"")+(S?" ui-priority-secondary":"")+"' href='#'>"+w.getDate()+"</a>")+"</td>",w.setDate(w.getDate()+1),w=this._daylightSavingAdjust(w);g+=W+"</tr>"}11<++A&&(A=0,L++),h+=g+="</tbody></table>"+(H?"</div>"+(0<T[0]&&p===T[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}l+=h}return l+=E,e._keyEvent=!1,l},_generateMonthYearHeader:function(e,t,r,n,i,o,a,s){var u,l,c,f,h,p,d,y=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),m=this._get(e,"showMonthAfterYear"),v="<div class='ui-datepicker-title'>",b="";if(o||!y)b+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(u=n&&n.getFullYear()===r,l=i&&i.getFullYear()===r,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;c<12;c++)(!u||c>=n.getMonth())&&(!l||i.getMonth()>=c)&&(b+="<option value='"+c+"'"+(c===t?" selected='selected'":"")+">"+s[c]+"</option>");b+="</select>"}if(m||(v+=b+(!o&&y&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",o||!g)v+="<span class='ui-datepicker-year'>"+r+"</span>";else{for(a=this._get(e,"yearRange").split(":"),f=(new Date).getFullYear(),p=(h=function(e){e=e.match(/c[+\-].*/)?r+parseInt(e.substring(1),10):e.match(/[+\-].*/)?f+parseInt(e,10):parseInt(e,10);return isNaN(e)?f:e})(a[0]),d=Math.max(p,h(a[1]||"")),p=n?Math.max(p,n.getFullYear()):p,d=i?Math.min(d,i.getFullYear()):d,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p<=d;p++)e.yearshtml+="<option value='"+p+"'"+(p===r?" selected='selected'":"")+">"+p+"</option>";e.yearshtml+="</select>",v+=e.yearshtml,e.yearshtml=null}return v+=this._get(e,"yearSuffix"),m&&(v+=(!o&&y&&g?"":"&#xa0;")+b),v+"</div>"},_adjustInstDate:function(e,t,r){var n=e.drawYear+("Y"===r?t:0),i=e.drawMonth+("M"===r?t:0),t=Math.min(e.selectedDay,this._getDaysInMonth(n,i))+("D"===r?t:0),n=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,i,t)));e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),"M"!==r&&"Y"!==r||this._notifyChange(e)},_restrictMinMax:function(e,t){var r=this._getMinMaxDate(e,"min"),e=this._getMinMaxDate(e,"max"),r=r&&t<r?r:t;return e&&e<r?e:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){e=this._get(e,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,r,n){var i=this._getNumberOfMonths(e),r=this._daylightSavingAdjust(new Date(r,n+(t<0?t:i[0]*i[1]),1));return t<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(e,r)},_isInRange:function(e,t){var r,n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),o=null,a=null,e=this._get(e,"yearRange");return e&&(e=e.split(":"),r=(new Date).getFullYear(),o=parseInt(e[0],10),a=parseInt(e[1],10),e[0].match(/[+\-].*/)&&(o+=r),e[1].match(/[+\-].*/))&&(a+=r),(!n||t.getTime()>=n.getTime())&&(!i||t.getTime()<=i.getTime())&&(!o||t.getFullYear()>=o)&&(!a||a>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:"string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,r,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,r,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),x.fn.datepicker=function(e){if(!this.length)return this;x.datepicker.initialized||(x(document).mousedown(x.datepicker._checkExternalClick),x.datepicker.initialized=!0),0===x("#"+x.datepicker._mainDivId).length&&x("body").append(x.datepicker.dpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&("isDisabled"===e||"getDate"===e||"widget"===e)||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this].concat(t)):x.datepicker._attachDatepicker(this,e)})},x.datepicker=new e,x.datepicker.initialized=!1,x.datepicker.uuid=(new Date).getTime(),x.datepicker.version="1.11.2",x.datepicker,x.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=x(this).css(e).offset().top;t<0&&x(this).css("top",e.top-t)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&x.fn.draggable&&this._makeDraggable(),this.options.resizable&&x.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?x(e):this.document.find(e||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:x.noop,enable:x.noop,close:function(e){var t,r=this;if(this._isOpen&&!1!==this._trigger("beforeClose",e)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(t=this.document[0].activeElement)&&"body"!==t.nodeName.toLowerCase()&&x(t).blur()}catch(e){}this._hide(this.uiDialog,this.options.hide,function(){r._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var r=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+x(this).css("z-index")}).get(),n=Math.max.apply(null,n);return n>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",n+1),r=!0),r&&!t&&this._trigger("focus",e),r},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=x(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;(e=(e=(e=(e=(e=e||this.element.find("[autofocus]")).length?e:this.element.find(":tabbable")).length?e:this.uiDialogButtonPane.find(":tabbable")).length?e:this.uiDialogTitlebarClose.filter(":tabbable")).length?e:this.uiDialog).eq(0).focus()},_keepFocus:function(e){function t(){var e=this.document[0].activeElement;this.uiDialog[0]===e||x.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),t.call(this),this._delay(t)},_createWrapper:function(){this.uiDialog=x("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){var t,r,n;this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===x.ui.keyCode.ESCAPE?(e.preventDefault(),this.close(e)):e.keyCode!==x.ui.keyCode.TAB||e.isDefaultPrevented()||(t=this.uiDialog.find(":tabbable"),r=t.filter(":first"),n=t.filter(":last"),e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==r[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.focus()}),e.preventDefault()):(this._delay(function(){r.focus()}),e.preventDefault()))},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=x("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){x(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=x("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),e=x("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=x("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=x("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var n=this,e=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),x.isEmptyObject(e)||x.isArray(e)&&!e.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(x.each(e,function(e,t){var r;t=x.isFunction(t)?{click:t,text:e}:t,t=x.extend({type:"button"},t),r=t.click,t.click=function(){r.apply(n.element[0],arguments)},e={icons:t.icons,text:t.showText},delete t.icons,delete t.showText,x("<button></button>",t).button(e).appendTo(n.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function i(e){return{position:e.position,offset:e.offset}}var o=this,a=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,t){x(this).addClass("ui-dialog-dragging"),o._blockFrames(),o._trigger("dragStart",e,i(t))},drag:function(e,t){o._trigger("drag",e,i(t))},stop:function(e,t){var r=t.offset.left-o.document.scrollLeft(),n=t.offset.top-o.document.scrollTop();a.position={my:"left top",at:"left"+(0<=r?"+":"")+r+" top"+(0<=n?"+":"")+n,of:o.window},x(this).removeClass("ui-dialog-dragging"),o._unblockFrames(),o._trigger("dragStop",e,i(t))}})},_makeResizable:function(){function i(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var o=this,a=this.options,e=a.resizable,t=this.uiDialog.css("position"),e="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:this._minHeight(),handles:e,start:function(e,t){x(this).addClass("ui-dialog-resizing"),o._blockFrames(),o._trigger("resizeStart",e,i(t))},resize:function(e,t){o._trigger("resize",e,i(t))},stop:function(e,t){var r=o.uiDialog.offset(),n=r.left-o.document.scrollLeft(),r=r.top-o.document.scrollTop();a.height=o.uiDialog.height(),a.width=o.uiDialog.width(),a.position={my:"left top",at:"left"+(0<=n?"+":"")+n+" top"+(0<=r?"+":"")+r,of:o.window},x(this).removeClass("ui-dialog-resizing"),o._unblockFrames(),o._trigger("resizeStop",e,i(t))}}).css("position",t)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=x(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),t=x.inArray(this,e);-1!==t&&e.splice(t,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||this.document.data("ui-dialog-instances",e=[]),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(e){var r=this,n=!1,i={};x.each(e,function(e,t){r._setOption(e,t),e in r.sizeRelatedOptions&&(n=!0),e in r.resizableRelatedOptions&&(i[e]=t)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",i)},_setOption:function(e,t){var r,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&((r=n.is(":data(ui-draggable)"))&&!t&&n.draggable("destroy"),!r)&&t&&this._makeDraggable(),"position"===e&&this._position(),"resizable"===e&&((r=n.is(":data(ui-resizable)"))&&!t&&n.resizable("destroy"),r&&"string"==typeof t&&n.resizable("option","handles",t),r||!1===t||this._makeResizable()),"title"===e)&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))},_size:function(){var e,t,r,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),r="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:r,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=x(this);return x("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!x(e.target).closest(".ui-dialog").length||!!x(e.target).closest(".ui-datepicker").length},_createOverlay:function(){var t;this.options.modal&&(t=!0,this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=x("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1))},_destroyOverlay:function(){var e;this.options.modal&&this.overlay&&((e=this.document.data("ui-dialog-overlays")-1)?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null)}}),x.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=x("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,t=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=x("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),x.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this,t=this.element.attr("tabindex");this.label=x("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=x("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:t||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),x("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=x("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var r=this;this.menu=x("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=x("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,t){e.preventDefault(),r._setSelection(),r._select(t.item.data("ui-selectmenu-item"),e)},focus:function(e,t){t=t.item.data("ui-selectmenu-item");null!=r.focusIndex&&t.index!==r.focusIndex&&(r._trigger("focus",e,{item:t}),r.isOpen||r._select(t,e)),r.focusIndex=t.index,r.button.attr("aria-activedescendant",r.menuItems.eq(t.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(x.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(r,e){var n=this,i="";x.each(e,function(e,t){t.optgroup!==i&&(x("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(t.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:t.optgroup}).appendTo(r),i=t.optgroup),n._renderItemData(r,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(e,t){var r=x("<li>");return t.disabled&&r.addClass("ui-state-disabled"),this._setText(r,t.label),r.appendTo(e)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var r,n=".ui-menu-item";this.isOpen?r=this.menuItems.eq(this.focusIndex):(r=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),(r="first"===e||"last"===e?r["first"===e?"prevAll":"nextAll"](n).eq(-1):r[e+"All"](n).eq(0)).length&&this.menuInstance.focus(t,r)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?((e=window.getSelection()).removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){!this.isOpen||x(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e)}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection()).rangeCount&&(this.range=e.getRangeAt(0)):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(e){var t=!0;switch(e.keyCode){case x.ui.keyCode.TAB:case x.ui.keyCode.ESCAPE:this.close(e),t=!1;break;case x.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case x.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case x.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case x.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case x.ui.keyCode.LEFT:this._move("prev",e);break;case x.ui.keyCode.RIGHT:this._move("next",e);break;case x.ui.keyCode.HOME:case x.ui.keyCode.PAGE_UP:this._move("first",e);break;case x.ui.keyCode.END:case x.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),t=!1}t&&e.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var r=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==r&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){e=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e=(e=(e=e&&(e.jquery||e.nodeType?x(e):this.document.find(e).eq(0)))&&e[0]?e:this.element.closest(".ui-front")).length?e:this.document[0].body},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var n=[];e.each(function(e,t){var t=x(t),r=t.parent("optgroup");n.push({element:t,index:e,value:t.attr("value"),label:t.text(),optgroup:r.attr("label")||"",disabled:r.prop("disabled")||t.prop("disabled")})}),this.items=n},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),x.widget("ui.slider",x.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,t=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),n=[],i=t.values&&t.values.length||1;for(r.length>i&&(r.slice(i).remove(),r=r.slice(0,i)),e=r.length;e<i;e++)n.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=r.add(x(n.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){x(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,t="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:x.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=x("<div></div>").appendTo(this.element),t="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(t+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var r,n,i,o,t,a,s=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),t={x:e.pageX,y:e.pageY},r=this._normValueFromMouse(t),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var t=Math.abs(r-s.values(e));(t<n||n===t&&(e===s._lastChangedValue||s.values(e)===u.min))&&(n=t,i=x(this),o=e)}),!1!==this._start(e,o))&&(this._mouseSliding=!0,this._handleIndex=o,i.addClass("ui-state-active").focus(),t=i.offset(),a=!x(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=a?{left:0,top:0}:{left:e.pageX-t.left-i.width()/2,top:e.pageY-t.top-i.height()/2-(parseInt(i.css("borderTopWidth"),10)||0)-(parseInt(i.css("borderBottomWidth"),10)||0)+(parseInt(i.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,r),this._animateOff=!0)},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},t=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,t),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,e="horizontal"===this.orientation?(t=this.elementSize.width,e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),e=e/t;return(e=1<e?1:e)<0&&(e=0),"vertical"===this.orientation&&(e=1-e),t=this._valueMax()-this._valueMin(),e=this._valueMin()+e*t,this._trimAlignValue(e)},_start:function(e,t){var r={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(r.value=this.values(t),r.values=this.values()),this._trigger("start",e,r)},_slide:function(e,t,r){var n,i;this.options.values&&this.options.values.length?(n=this.values(t?0:1),(r=2===this.options.values.length&&!0===this.options.range&&(0===t&&n<r||1===t&&r<n)?n:r)!==this.values(t)&&((n=this.values())[t]=r,i=this._trigger("slide",e,{handle:this.handles[t],value:r,values:n}),this.values(t?0:1),!1!==i)&&this.values(t,r)):r!==this.value()&&!1!==(i=this._trigger("slide",e,{handle:this.handles[t],value:r}))&&this.value(r)},_stop:function(e,t){var r={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(r.value=this.values(t),r.values=this.values()),this._trigger("stop",e,r)},_change:function(e,t){var r;this._keySliding||this._mouseSliding||(r={handle:this.handles[t],value:this.value()},this.options.values&&this.options.values.length&&(r.value=this.values(t),r.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,r))},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,t){var r,n,i;if(1<arguments.length)this.options.values[e]=this._trimAlignValue(t),this._refreshValue(),this._change(null,e);else{if(!arguments.length)return this._values();if(!x.isArray(e))return this.options.values&&this.options.values.length?this._values(e):this.value();for(r=this.options.values,n=e,i=0;r.length>i;i+=1)r[i]=this._trimAlignValue(n[i]),this._change(null,i);this._refreshValue()}},_setOption:function(e,t){var r,n=0;switch("range"===e&&!0===this.options.range&&("min"===t?(this.options.value=this._values(0),this.options.values=null):"max"===t&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),x.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t),this._super(e,t),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===t?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;r<n;r+=1)this._change(null,r);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return this._trimAlignValue(e)},_values:function(e){var t,r,n;if(arguments.length)return t=this.options.values[e],this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(r=this.options.values.slice(),n=0;r.length>n;n+=1)r[n]=this._trimAlignValue(r[n]);return r}return[]},_trimAlignValue:function(e){var t,r;return this._valueMin()>=e?this._valueMin():e>=this._valueMax()?this._valueMax():(t=0<this.options.step?this.options.step:1,r=e-(e=(e-this._valueMin())%t),2*Math.abs(e)>=t&&(r+=0<e?t:-t),parseFloat(r.toFixed(5)))},_calculateNewMax:function(){var e=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-e},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,r,e,n,i,o=this.options.range,a=this.options,s=this,u=!this._animateOff&&a.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(e){r=(s.values(e)-s._valueMin())/(s._valueMax()-s._valueMin())*100,l["horizontal"===s.orientation?"left":"bottom"]=r+"%",x(this).stop(1,1)[u?"animate":"css"](l,a.animate),!0===s.options.range&&("horizontal"===s.orientation?(0===e&&s.range.stop(1,1)[u?"animate":"css"]({left:r+"%"},a.animate),1===e&&s.range[u?"animate":"css"]({width:r-t+"%"},{queue:!1,duration:a.animate})):(0===e&&s.range.stop(1,1)[u?"animate":"css"]({bottom:r+"%"},a.animate),1===e&&s.range[u?"animate":"css"]({height:r-t+"%"},{queue:!1,duration:a.animate}))),t=r}):(e=this.value(),n=this._valueMin(),i=this._valueMax(),r=i!==n?(e-n)/(i-n)*100:0,l["horizontal"===this.orientation?"left":"bottom"]=r+"%",this.handle.stop(1,1)[u?"animate":"css"](l,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({width:r+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[u?"animate":"css"]({width:100-r+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({height:r+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[u?"animate":"css"]({height:100-r+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var t,r,n,i=x(e.target).data("ui-slider-handle-index");switch(e.keyCode){case x.ui.keyCode.HOME:case x.ui.keyCode.END:case x.ui.keyCode.PAGE_UP:case x.ui.keyCode.PAGE_DOWN:case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,x(e.target).addClass("ui-state-active"),!1===this._start(e,i)))return}switch(n=this.options.step,t=r=this.options.values&&this.options.values.length?this.values(i):this.value(),e.keyCode){case x.ui.keyCode.HOME:r=this._valueMin();break;case x.ui.keyCode.END:r=this._valueMax();break;case x.ui.keyCode.PAGE_UP:r=this._trimAlignValue(t+(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(t-(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:if(t===this._valueMax())return;r=this._trimAlignValue(t+n);break;case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(t===this._valueMin())return;r=this._trimAlignValue(t-n)}this._slide(e,i,r)},keyup:function(e){var t=x(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,t),this._change(e,t),x(e.target).removeClass("ui-state-active"))}}}),x.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var n={},i=this.element;return x.each(["min","max","step"],function(e,t){var r=i.attr(t);void 0!==r&&r.length&&(n[t]=r)}),n},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((0<t?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(e){function t(){this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r}))}var r=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();e.preventDefault(),t.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,t.call(this)}),!1!==this._start(e)&&this._repeat(null,x(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return x(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,x(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&0<e.height()&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(e){var t=this.options,r=x.ui.keyCode;switch(e.keyCode){case r.UP:return this._repeat(null,1,e),!0;case r.DOWN:return this._repeat(null,-1,e),!0;case r.PAGE_UP:return this._repeat(null,t.page,e),!0;case r.PAGE_DOWN:return this._repeat(null,-t.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e)||(this.counter||(this.counter=1),this.spinning=!0,0))},_repeat:function(e,t,r){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,r)},e),this._spin(t*this.options.step,r)},_spin:function(e,t){var r=this.value()||0;this.counter||(this.counter=1),r=this._adjustValue(r+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:r})||(this._value(r),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?x.isFunction(t)?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return e=null!==this.options.min?Math.max(e,this._precisionOf(this.options.min)):e},_precisionOf:function(e){var e=""+e,t=e.indexOf(".");return-1===t?0:e.length-t-1},_adjustValue:function(e){var t=this.options,r=null!==t.min?t.min:0,n=e-r;return e=r+Math.round(n/t.step)*t.step,e=parseFloat(e.toFixed(this._precision())),null!==t.max&&e>t.max?t.max:null!==t.min&&t.min>e?t.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){var r;"culture"===e||"numberFormat"===e?(r=this._parse(this.element.val()),this.options[e]=t,this.element.val(this._format(r))):("max"!==e&&"min"!==e&&"step"!==e||"string"!=typeof t||(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")))},_setOptions:t(function(e){this._super(e)}),_parse:function(e){return""===(e="string"==typeof e&&""!==e?window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e:e)||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var r;""!==e&&null!==(r=this._parse(e))&&(t||(r=this._adjustValue(r)),e=this._format(r)),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),x.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(v=/#.*$/,function(e){var t=(e=e.cloneNode(!1)).href.replace(v,""),r=location.href.replace(v,"");try{t=decodeURIComponent(t)}catch(e){}try{r=decodeURIComponent(r)}catch(e){}return 1<e.hash.length&&t===r}),_create:function(){var t=this,e=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",e.collapsible),this._processTabs(),e.active=this._initialActive(),x.isArray(e.disabled)&&(e.disabled=x.unique(e.disabled.concat(x.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(e.active):x(),this._refresh(),this.active.length&&this.load(e.active)},_initialActive:function(){var r=this.options.active,e=this.options.collapsible,n=location.hash.substring(1);return!1!==(r=null===r&&(n&&this.tabs.each(function(e,t){return x(t).attr("aria-controls")===n?(r=e,!1):void 0}),null===(r=null===r?this.tabs.index(this.tabs.filter(".ui-tabs-active")):r)||-1===r)?!!this.tabs.length&&0:r)&&-1===(r=this.tabs.index(this.tabs.eq(r)))&&(r=!e&&0),r=!e&&!1===r&&this.anchors.length?0:r},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):x()}},_tabKeydown:function(e){var t=x(this.document[0].activeElement).closest("li"),r=this.tabs.index(t),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:r++;break;case x.ui.keyCode.UP:case x.ui.keyCode.LEFT:n=!1,r--;break;case x.ui.keyCode.END:r=this.anchors.length-1;break;case x.ui.keyCode.HOME:r=0;break;case x.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(r);case x.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(r!==this.options.active&&r);default:return}e.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,n),e.ctrlKey||(t.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===x.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===x.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===x.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,t){for(var r=this.tabs.length-1;-1!==x.inArray(e=(e=r<e?0:e)<0?r:e,this.options.disabled);)e=t?e+1:e-1;return e},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=x.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)}),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!x.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=x()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=x()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var u=this,e=this.tabs,t=this.anchors,r=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(e){x(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){x(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return x("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=x(),this.anchors.each(function(e,t){var r,n,i,o=x(t).uniqueId().attr("id"),a=x(t).closest("li"),s=a.attr("aria-controls");u._isLocal(t)?(i=(r=t.hash).substring(1),n=u.element.find(u._sanitizeSelector(r))):(i=a.attr("aria-controls")||x({}).uniqueId()[0].id,(n=u.element.find(r="#"+i)).length||(n=u._createPanel(i)).insertAfter(u.panels[e-1]||u.tablist),n.attr("aria-live","polite")),n.length&&(u.panels=u.panels.add(n)),s&&a.data("ui-tabs-aria-controls",s),a.attr({"aria-controls":i,"aria-labelledby":o}),n.attr("aria-labelledby",o)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),e&&(this._off(e.not(this.tabs)),this._off(t.not(this.anchors)),this._off(r.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return x("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){x.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var t,r=0;t=this.tabs[r];r++)!0===e||-1!==x.inArray(r,e)?x(t).addClass("ui-state-disabled").attr("aria-disabled","true"):x(t).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var r={};e&&x.each(e.split(" "),function(e,t){r[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,r),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var r,t=this.element.parent();"fill"===e?(r=t.height(),r-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=x(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(r-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){r-=x(this).outerHeight(!0)}),this.panels.each(function(){x(this).height(Math.max(0,r-x(this).innerHeight()+x(this).height()))}).css("overflow","auto")):"auto"===e&&(r=0,this.panels.each(function(){r=Math.max(r,x(this).height("").height())}).height(r))},_eventHandler:function(e){var t=this.options,r=this.active,n=x(e.currentTarget).closest("li"),i=n[0]===r[0],o=i&&t.collapsible,a=o?x():this._getPanelForTab(n),s=r.length?this._getPanelForTab(r):x(),r={oldTab:r,oldPanel:s,newTab:o?x():n,newPanel:a};e.preventDefault(),n.hasClass("ui-state-disabled")||n.hasClass("ui-tabs-loading")||this.running||i&&!t.collapsible||!1===this._trigger("beforeActivate",e,r)||(t.active=!o&&this.tabs.index(n),this.active=i?x():n,this.xhr&&this.xhr.abort(),s.length||a.length||x.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(n),e),this._toggle(e,r))},_toggle:function(e,t){function r(){i.running=!1,i._trigger("activate",e,t)}function n(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&i.options.show?i._show(o,i.options.show,r):(o.show(),r())}var i=this,o=t.newPanel,a=t.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),n()),a.attr("aria-hidden","true"),t.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&a.length?t.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===x(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),t.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var e=this._findActive(e);e[0]!==this.active[0]&&(e=(e=e.length?e:this.active).find(".ui-tabs-anchor")[0],this._eventHandler({target:e,currentTarget:e,preventDefault:x.noop}))},_findActive:function(e){return!1===e?x():this.tabs.eq(e)},_getIndex:function(e){return e="string"==typeof e?this.anchors.index(this.anchors.filter("[href$='"+e+"']")):e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){x.data(this,"ui-tabs-destroy")?x(this).remove():x(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=x(this),t=e.data("ui-tabs-aria-controls");t?e.attr("aria-controls",t).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(r){var e=this.options.disabled;!1!==e&&(e=void 0!==r&&(r=this._getIndex(r),x.isArray(e)?x.map(e,function(e){return e!==r?e:null}):x.map(this.tabs,function(e,t){return t!==r?t:null})),this._setupDisabled(e))},disable:function(e){var t=this.options.disabled;if(!0!==t){if(void 0===e)t=!0;else{if(e=this._getIndex(e),-1!==x.inArray(e,t))return;t=x.isArray(t)?x.merge([e],t).sort():[e]}this._setupDisabled(t)}},load:function(e,t){e=this._getIndex(e);var r=this,n=this.tabs.eq(e),e=n.find(".ui-tabs-anchor"),i=this._getPanelForTab(n),o={tab:n,panel:i};this._isLocal(e[0])||(this.xhr=x.ajax(this._ajaxSettings(e,t,o)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),i.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){i.html(e),r._trigger("load",t,o)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),i.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(e,r,n){var i=this;return{url:e.attr("href"),beforeSend:function(e,t){return i._trigger("beforeLoad",r,x.extend({jqXHR:e,ajaxSettings:t},n))}}},_getPanelForTab:function(e){e=x(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}}),x.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var e=x(this).attr("title")||"";return x("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,t){var r=(e.attr("aria-describedby")||"").split(/\s+/);r.push(t),e.data("ui-tooltip-id",t).attr("aria-describedby",x.trim(r.join(" ")))},_removeDescribedBy:function(e){var t=e.data("ui-tooltip-id"),r=(e.attr("aria-describedby")||"").split(/\s+/),t=x.inArray(t,r);-1!==t&&r.splice(t,1),e.removeData("ui-tooltip-id"),(r=x.trim(r.join(" ")))?e.attr("aria-describedby",r):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=x("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(e,t){var r=this;return"disabled"===e?(this[t?"_disable":"_enable"](),void(this.options[e]=t)):(this._super(e,t),void("content"===e&&x.each(this.tooltips,function(e,t){r._updateContent(t.element)})))},_disable:function(){var n=this;x.each(this.tooltips,function(e,t){var r=x.Event("blur");r.target=r.currentTarget=t.element[0],n.close(r,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=x(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=x(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var r=this,t=x(e?e.target:this.element).closest(this.options.items);t.length&&!t.data("ui-tooltip-id")&&(t.attr("title")&&t.data("ui-tooltip-title",t.attr("title")),t.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&t.parents().each(function(){var e,t=x(this);t.data("ui-tooltip-open")&&((e=x.Event("blur")).target=e.currentTarget=this,r.close(e,!0)),t.attr("title")&&(t.uniqueId(),r.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(t,e))},_updateContent:function(t,r){var e=this.options.content,n=this,i=r?r.type:null;return"string"==typeof e?this._open(r,t,e):void((e=e.call(t[0],function(e){t.data("ui-tooltip-open")&&n._delay(function(){r&&(r.type=i),this._open(r,t,e)})}))&&this._open(r,t,e))},_open:function(e,t,r){function n(e){u.of=e,i.is(":hidden")||i.position(u)}var i,o,a,s,u=x.extend({},this.options.position);r&&((o=this._find(t))?o.tooltip.find(".ui-tooltip-content").html(r):(t.is("[title]")&&(e&&"mouseover"===e.type?t.attr("title",""):t.removeAttr("title")),o=this._tooltip(t),i=o.tooltip,this._addDescribedBy(t,i.attr("id")),i.find(".ui-tooltip-content").html(r),this.liveRegion.children().hide(),r.clone?(s=r.clone()).removeAttr("id").find("[id]").removeAttr("id"):s=r,x("<div>").html(s).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):i.position(x.extend({of:t},this.options.position)),i.hide(),this._show(i,this.options.show),this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval(function(){i.is(":visible")&&(n(u.of),clearInterval(a))},x.fx.interval)),this._trigger("open",e,{tooltip:i}),o={keyup:function(e){e.keyCode===x.ui.keyCode.ESCAPE&&((e=x.Event(e)).currentTarget=t[0],this.close(e,!0))}},t[0]!==this.element[0]&&(o.remove=function(){this._removeTooltip(i)}),e&&"mouseover"!==e.type||(o.mouseleave="close"),e&&"focusin"!==e.type||(o.focusout="close"),this._on(!0,t,o)))},close:function(e){var t,r=this,n=x(e?e.currentTarget:this.element),i=this._find(n);i&&(t=i.tooltip,i.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),i.hiding=!0,t.stop(!0),this._hide(t,this.options.hide,function(){r._removeTooltip(x(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&x.each(this.parents,function(e,t){x(t.element).attr("title",t.title),delete r.parents[e]}),i.closing=!0,this._trigger("close",e,{tooltip:t}),i.hiding)||(i.closing=!1))},_tooltip:function(e){var t=x("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),r=t.uniqueId().attr("id");return x("<div>").addClass("ui-tooltip-content").appendTo(t),t.appendTo(this.document[0].body),this.tooltips[r]={element:e,tooltip:t}},_find:function(e){e=e.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var n=this;x.each(this.tooltips,function(e,t){var r=x.Event("blur"),t=t.element;r.target=r.currentTarget=t[0],n.close(r,!0),x("#"+e).remove(),t.data("ui-tooltip-title")&&(t.attr("title")||t.attr("title",t.data("ui-tooltip-title")),t.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),"ui-effects-"),he=x;function M(e,t,r,n){return e={effect:e=x.isPlainObject(e)?(t=e).effect:e},x.isFunction(t=null==t?{}:t)&&(n=t,r=null,t={}),"number"!=typeof t&&!x.fx.speeds[t]||(n=r,r=t,t={}),x.isFunction(r)&&(n=r,r=null),t&&x.extend(e,t),r=r||t.duration,e.duration=x.fx.off?0:"number"==typeof r?r:r in x.fx.speeds?x.fx.speeds[r]:x.fx.speeds._default,e.complete=n||t.complete,e}function I(e){return!e||"number"==typeof e||x.fx.speeds[e]||"string"==typeof e&&!x.effects.effect[e]||x.isFunction(e)||"object"==typeof e&&!e.effect}function pe(e){var t,r,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,i={};if(n&&n.length&&n[0]&&n[n[0]])for(r=n.length;r--;)"string"==typeof n[t=n[r]]&&(i[x.camelCase(t)]=n[t]);else for(t in n)"string"==typeof n[t]&&(i[t]=n[t]);return i}function A(e,t,r){var n=T[t.type]||{};return null==e?r||!t.def?null:t.def:(e=n.floor?~~e:parseFloat(e),isNaN(e)?t.def:n.mod?(e+n.mod)%n.mod:e<0?0:e>n.max?n.max:e)}function de(n){var i=k(),o=i._rgba=[];return n=n.toLowerCase(),R(ue,function(e,t){var r=t.re.exec(n),r=r&&t.parse(r),t=t.space||"rgba";return r?(r=i[t](r),i[E[t].cache]=r[E[t].cache],o=i._rgba=r._rgba,!1):w}),o.length?("0,0,0,0"===o.join()&&_.extend(o,P.transparent),i):P[n]}function L(e,t,r){return 6*(r=(r+1)%1)<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(t-e)*(2/3-r):e}x.effects={effect:{}},se=/^([\-+])=\s*(\d+\.?\d*)/,ue=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],k=(_=he).Color=function(e,t,r,n){return new _.Color.fn.parse(e,t,r,n)},E={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},T={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},C=k.support={},p=_("<p>")[0],R=_.each,p.style.cssText="background-color:rgba(1,1,1,.5)",C.rgba=-1<p.style.backgroundColor.indexOf("rgba"),R(E,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),(k.fn=_.extend(k.prototype,{parse:function(i,e,t,r){if(i===w)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=_(i).css(e),e=w);var o=this,n=_.type(i),a=this._rgba=[];return e!==w&&(i=[i,e,t,r],n="array"),"string"===n?this.parse(de(i)||P._default):"array"===n?(R(E.rgba.props,function(e,t){a[t.idx]=A(i[t.idx],t)}),this):"object"===n?(i instanceof k?R(E,function(e,t){i[t.cache]&&(o[t.cache]=i[t.cache].slice())}):R(E,function(e,r){var n=r.cache;R(r.props,function(e,t){if(!o[n]&&r.to){if("alpha"===e||null==i[e])return;o[n]=r.to(o._rgba)}o[n][t.idx]=A(i[e],t,!0)}),o[n]&&_.inArray(null,o[n].slice(0,3))<0&&(o[n][3]=1,r.from)&&(o._rgba=r.from(o[n]))}),this):w},is:function(e){var i=k(e),o=!0,a=this;return R(E,function(e,t){var r,n=i[t.cache];return n&&(r=a[t.cache]||t.to&&t.to(a._rgba)||[],R(t.props,function(e,t){return null!=n[t.idx]?o=n[t.idx]===r[t.idx]:w})),o}),o},_space:function(){var r=[],n=this;return R(E,function(e,t){n[t.cache]&&r.push(e)}),r.pop()},transition:function(e,a){var e=(l=k(e))._space(),t=E[e],r=0===this.alpha()?k("transparent"):this,s=r[t.cache]||t.to(r._rgba),u=s.slice(),l=l[t.cache];return R(t.props,function(e,t){var r=t.idx,n=s[r],i=l[r],o=T[t.type]||{};null!==i&&(null===n?u[r]=i:(o.mod&&(i-n>o.mod/2?n+=o.mod:n-i>o.mod/2&&(n-=o.mod)),u[r]=A((i-n)*a+n,t)))}),this[e](u)},blend:function(e){var t,r,n;return 1===this._rgba[3]?this:(t=this._rgba.slice(),r=t.pop(),n=k(e)._rgba,k(_.map(t,function(e,t){return(1-r)*n[t]+r*e})))},toRgbaString:function(){var e="rgba(",t=_.map(this._rgba,function(e,t){return null==e?2<t?1:0:e});return 1===t[3]&&(t.pop(),e="rgb("),e+t.join()+")"},toHslaString:function(){var e="hsla(",t=_.map(this.hsla(),function(e,t){return null==e&&(e=2<t?1:0),e=t&&t<3?Math.round(100*e)+"%":e});return 1===t[3]&&(t.pop(),e="hsl("),e+t.join()+")"},toHexString:function(e){var t=this._rgba.slice(),r=t.pop();return e&&t.push(~~(255*r)),"#"+_.map(t,function(e){return 1===(e=(e||0).toString(16)).length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}})).parse.prototype=k.fn,E.hsla.to=function(e){var t,r,n,i,o,a,s,u;return null==e[0]||null==e[1]||null==e[2]?[null,null,null,e[3]]:(t=e[0]/255,r=e[1]/255,n=e[2]/255,e=e[3],s=.5*(u=(i=Math.max(t,r,n))+(o=Math.min(t,r,n))),u=0==(a=i-o)?0:s<=.5?a/u:a/(2-u),[Math.round(o===i?0:t===i?60*(r-n)/a+360:r===i?60*(n-t)/a+120:60*(t-r)/a+240)%360,u,s,null==e?1:e])},E.hsla.from=function(e){var t,r,n;return null==e[0]||null==e[1]||null==e[2]?[null,null,null,e[3]]:(t=e[0]/360,n=e[1],r=e[2],e=e[3],n=2*r-(r=r<=.5?r*(1+n):r+n-r*n),[Math.round(255*L(n,r,t+1/3)),Math.round(255*L(n,r,t)),Math.round(255*L(n,r,t-1/3)),e])},R(E,function(s,e){var o=e.props,a=e.cache,u=e.to,l=e.from;k.fn[s]=function(e){var t,r,n,i;return u&&!this[a]&&(this[a]=u(this._rgba)),e===w?this[a].slice():(r=_.type(e),n="array"===r||"object"===r?e:arguments,i=this[a].slice(),R(o,function(e,t){e=n["object"===r?e:t.idx];null==e&&(e=i[t.idx]),i[t.idx]=A(e,t)}),l?((t=k(l(i)))[a]=i,t):k(i))},R(o,function(o,a){k.fn[o]||(k.fn[o]=function(e){var t=_.type(e),r="alpha"===o?this._hsla?"hsla":"rgba":s,n=this[r](),i=n[a.idx];return"undefined"===t?i:("function"===t&&(e=e.call(this,i),t=_.type(e)),null==e&&a.empty?this:("string"===t&&(t=se.exec(e))&&(e=i+parseFloat(t[2])*("+"===t[1]?1:-1)),n[a.idx]=e,this[r](n)))})})}),(k.hook=function(e){e=e.split(" ");R(e,function(e,o){_.cssHooks[o]={set:function(e,t){var r,n,i="";if("transparent"!==t&&("string"!==_.type(t)||(r=de(t)))){if(t=k(r||t),!C.rgba&&1!==t._rgba[3]){for(n="backgroundColor"===o?e.parentNode:e;(""===i||"transparent"===i)&&n&&n.style;)try{i=_.css(n,"backgroundColor"),n=n.parentNode}catch(e){}t=t.blend(i&&"transparent"!==i?i:"_default")}t=t.toRgbaString()}try{e.style[o]=t}catch(e){}}},_.fx.step[o]=function(e){e.colorInit||(e.start=k(e.elem,o),e.end=k(e.end),e.colorInit=!0),_.cssHooks[o].set(e.elem,e.start.transition(e.end,e.pos))}})})("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),_.cssHooks.borderColor={expand:function(r){var n={};return R(["Top","Right","Bottom","Left"],function(e,t){n["border"+t+"Color"]=r}),n}},P=_.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"},oe=["add","remove","toggle"],ae={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},x.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,t){x.fx.step[t]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(he.style(e.elem,t,e.end),e.setAttr=!0)}}),x.fn.addBack||(x.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),x.effects.animateClass=function(i,e,t,r){var o=x.speed(e,t,r);return this.queue(function(){var r=x(this),e=r.attr("class")||"",t=(t=o.children?r.find("*").addBack():r).map(function(){return{el:x(this),start:pe(this)}}),n=function(){x.each(oe,function(e,t){i[t]&&r[t+"Class"](i[t])})};n(),t=t.map(function(){return this.end=pe(this.el[0]),this.diff=function(e,t){var r,n,i={};for(r in t)n=t[r],e[r]===n||ae[r]||!x.fx.step[r]&&isNaN(parseFloat(n))||(i[r]=n);return i}(this.start,this.end),this}),r.attr("class",e),t=t.map(function(){var e=this,t=x.Deferred(),r=x.extend({},o,{queue:!1,complete:function(){t.resolve(e)}});return this.el.animate(this.diff,r),t.promise()}),x.when.apply(x,t.get()).done(function(){n(),x.each(arguments,function(){var t=this.el;x.each(this.diff,function(e){t.css(e,"")})}),o.complete.call(r[0])})})},x.fn.extend({addClass:(ie=x.fn.addClass,function(e,t,r,n){return t?x.effects.animateClass.call(this,{add:e},t,r,n):ie.apply(this,arguments)}),removeClass:(ne=x.fn.removeClass,function(e,t,r,n){return 1<arguments.length?x.effects.animateClass.call(this,{remove:e},t,r,n):ne.apply(this,arguments)}),toggleClass:(re=x.fn.toggleClass,function(e,t,r,n,i){return"boolean"==typeof t||void 0===t?r?x.effects.animateClass.call(this,t?{add:e}:{remove:e},r,n,i):re.apply(this,arguments):x.effects.animateClass.call(this,{toggle:e},t,r,n)}),switchClass:function(e,t,r,n,i){return x.effects.animateClass.call(this,{add:t,remove:e},r,n,i)}}),x.extend(x.effects,{version:"1.11.2",save:function(e,t){for(var r=0;t.length>r;r++)null!==t[r]&&e.data(fe+t[r],e[0].style[t[r]])},restore:function(e,t){for(var r,n=0;t.length>n;n++)null!==t[n]&&(r=e.data(fe+t[n]),e.css(t[n],r=void 0===r?"":r))},setMode:function(e,t){return t="toggle"===t?e.is(":hidden")?"show":"hide":t},getBaseline:function(e,t){var r,n;switch(e[0]){case"top":r=0;break;case"middle":r=.5;break;case"bottom":r=1;break;default:r=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:r}},createWrapper:function(r){if(r.parent().is(".ui-effects-wrapper"))return r.parent();var n={width:r.outerWidth(!0),height:r.outerHeight(!0),float:r.css("float")},e=x("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),t={width:r.width(),height:r.height()},i=document.activeElement;try{i.id}catch(e){i=document.body}return r.wrap(e),r[0]!==i&&!x.contains(r[0],i)||x(i).focus(),e=r.parent(),"static"===r.css("position")?(e.css({position:"relative"}),r.css({position:"relative"})):(x.extend(n,{position:r.css("position"),zIndex:r.css("z-index")}),x.each(["top","left","bottom","right"],function(e,t){n[t]=r.css(t),isNaN(parseInt(n[t],10))&&(n[t]="auto")}),r.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),r.css(t),e.css(n).show()},removeWrapper:function(e){var t=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),e[0]===t||x.contains(e[0],t))&&x(t).focus(),e},setTransition:function(n,e,i,o){return o=o||{},x.each(e,function(e,t){var r=n.cssUnit(t);0<r[0]&&(o[t]=r[0]*i+r[1])}),o}}),x.fn.extend({effect:function(){function e(e){function t(){x.isFunction(n)&&n.call(r[0]),x.isFunction(e)&&e()}var r=x(this),n=o.complete,i=o.mode;(r.is(":hidden")?"hide"===i:"show"===i)?(r[i](),t()):a.call(r[0],o,t)}var o=M.apply(this,arguments),t=o.mode,r=o.queue,a=x.effects.effect[o.effect];return x.fx.off||!a?t?this[t](o.duration,o.complete):this.each(function(){o.complete&&o.complete.call(this)}):!1===r?this.each(e):this.queue(r||"fx",e)},show:(te=x.fn.show,function(e){var t;return I(e)?te.apply(this,arguments):((t=M.apply(this,arguments)).mode="show",this.effect.call(this,t))}),hide:(ee=x.fn.hide,function(e){var t;return I(e)?ee.apply(this,arguments):((t=M.apply(this,arguments)).mode="hide",this.effect.call(this,t))}),toggle:(Q=x.fn.toggle,function(e){var t;return I(e)||"boolean"==typeof e?Q.apply(this,arguments):((t=M.apply(this,arguments)).mode="toggle",this.effect.call(this,t))}),cssUnit:function(e){var r=this.css(e),n=[];return x.each(["em","px","%","pt"],function(e,t){0<r.indexOf(t)&&(n=[parseFloat(r),t])}),n}}),b={},x.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,e){b[e]=function(e){return Math.pow(e,t+2)}}),x.extend(b,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,r=4;((t=Math.pow(2,--r))-1)/11>e;);return 1/Math.pow(4,3-r)-7.5625*Math.pow((3*t-2)/22-e,2)}}),x.each(b,function(e,t){x.easing["easeIn"+e]=t,x.easing["easeOut"+e]=function(e){return 1-t(1-e)},x.easing["easeInOut"+e]=function(e){return e<.5?t(2*e)/2:1-t(-2*e+2)/2}}),x.effects,x.effects.effect.blind=function(e,t){var r,n,i,o=x(this),a=["position","top","bottom","left","right","height","width"],s=x.effects.setMode(o,e.mode||"hide"),u=e.direction||"up",l=/up|down|vertical/.test(u),c=l?"height":"width",f=l?"top":"left",u=/up|left|vertical|horizontal/.test(u),h={},p="show"===s;o.parent().is(".ui-effects-wrapper")?x.effects.save(o.parent(),a):x.effects.save(o,a),o.show(),n=(r=x.effects.createWrapper(o).css({overflow:"hidden"}))[c](),i=parseFloat(r.css(f))||0,h[c]=p?n:0,u||(o.css(l?"bottom":"right",0).css(l?"top":"left","auto").css({position:"absolute"}),h[f]=p?i:n+i),p&&(r.css(c,0),u||r.css(f,i+n)),r.animate(h,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===s&&o.hide(),x.effects.restore(o,a),x.effects.removeWrapper(o),t()}})},x.effects.effect.bounce=function(e,t){var r,n,i,o=x(this),a=["position","top","bottom","left","right","height","width"],s=x.effects.setMode(o,e.mode||"effect"),u="hide"===s,s="show"===s,l=e.direction||"up",c=e.distance,f=e.times||5,h=2*f+(s||u?1:0),p=e.duration/h,d=e.easing,y="up"===l||"down"===l?"top":"left",g="up"===l||"left"===l,e=o.queue(),l=e.length;for((s||u)&&a.push("opacity"),x.effects.save(o,a),o.show(),x.effects.createWrapper(o),c=c||o["top"==y?"outerHeight":"outerWidth"]()/3,s&&((i={opacity:1})[y]=0,o.css("opacity",0).css(y,g?2*-c:2*c).animate(i,p,d)),u&&(c/=Math.pow(2,f-1)),r=(i={})[y]=0;r<f;r++)(n={})[y]=(g?"-=":"+=")+c,o.animate(n,p,d).animate(i,p,d),c=u?2*c:c/2;u&&((n={opacity:0})[y]=(g?"-=":"+=")+c,o.animate(n,p,d)),o.queue(function(){u&&o.hide(),x.effects.restore(o,a),x.effects.removeWrapper(o),t()}),1<l&&e.splice.apply(e,[1,0].concat(e.splice(l,1+h))),o.dequeue()},x.effects.effect.clip=function(e,t){var r,n,i=x(this),o=["position","top","bottom","left","right","height","width"],a="show"===x.effects.setMode(i,e.mode||"hide"),s="vertical"===(e.direction||"vertical"),u=s?"height":"width",s=s?"top":"left",l={};x.effects.save(i,o),i.show(),r=x.effects.createWrapper(i).css({overflow:"hidden"}),n=(r="IMG"===i[0].tagName?r:i)[u](),a&&(r.css(u,0),r.css(s,n/2)),l[u]=a?n:0,l[s]=a?0:n/2,r.animate(l,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){a||i.hide(),x.effects.restore(i,o),x.effects.removeWrapper(i),t()}})},x.effects.effect.drop=function(e,t){var r,n=x(this),i=["position","top","bottom","left","right","opacity","height","width"],o=x.effects.setMode(n,e.mode||"hide"),a="show"===o,s=e.direction||"left",u="up"===s||"down"===s?"top":"left",s="up"===s||"left"===s?"pos":"neg",l={opacity:a?1:0};x.effects.save(n,i),n.show(),x.effects.createWrapper(n),r=e.distance||n["top"==u?"outerHeight":"outerWidth"](!0)/2,a&&n.css("opacity",0).css(u,"pos"==s?-r:r),l[u]=(a?"pos"==s?"+=":"-=":"pos"==s?"-=":"+=")+r,n.animate(l,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&n.hide(),x.effects.restore(n,i),x.effects.removeWrapper(n),t()}})},x.effects.effect.explode=function(e,t){function r(){y.push(this),y.length===u*l&&(c.css({visibility:"visible"}),x(y).remove(),f||c.hide(),t())}for(var n,i,o,a,s,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,l=u,c=x(this),f="show"===x.effects.setMode(c,e.mode||"hide"),h=c.show().css("visibility","hidden").offset(),p=Math.ceil(c.outerWidth()/l),d=Math.ceil(c.outerHeight()/u),y=[],g=0;g<u;g++)for(o=h.top+g*d,s=g-(u-1)/2,n=0;n<l;n++)i=h.left+n*p,a=n-(l-1)/2,c.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*p,top:-g*d}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p,height:d,left:i+(f?a*p:0),top:o+(f?s*d:0),opacity:f?0:1}).animate({left:i+(f?0:a*p),top:o+(f?0:s*d),opacity:f?1:0},e.duration||500,e.easing,r)},x.effects.effect.fade=function(e,t){var r=x(this),n=x.effects.setMode(r,e.mode||"toggle");r.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:t})},x.effects.effect.fold=function(e,t){var r,n=x(this),i=["position","top","bottom","left","right","height","width"],o=x.effects.setMode(n,e.mode||"hide"),a="show"===o,s="hide"===o,o=e.size||15,u=/([0-9]+)%/.exec(o),l=!!e.horizFirst,c=a!=l,f=c?["width","height"]:["height","width"],h=e.duration/2,p={},d={};x.effects.save(n,i),n.show(),r=x.effects.createWrapper(n).css({overflow:"hidden"}),c=c?[r.width(),r.height()]:[r.height(),r.width()],u&&(o=parseInt(u[1],10)/100*c[s?0:1]),a&&r.css(l?{height:0,width:o}:{height:o,width:0}),p[f[0]]=a?c[0]:o,d[f[1]]=a?c[1]:0,r.animate(p,h,e.easing).animate(d,h,e.easing,function(){s&&n.hide(),x.effects.restore(n,i),x.effects.removeWrapper(n),t()})},x.effects.effect.highlight=function(e,t){var r=x(this),n=["backgroundImage","backgroundColor","opacity"],i=x.effects.setMode(r,e.mode||"show"),o={backgroundColor:r.css("backgroundColor")};"hide"===i&&(o.opacity=0),x.effects.save(r,n),r.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===i&&r.hide(),x.effects.restore(r,n),t()}})},x.effects.effect.size=function(o,e){var t,a,s=x(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],u=["width","height","overflow"],n=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],i=x.effects.setMode(s,o.mode||"effect"),f=o.restore||"effect"!==i,h=o.scale||"both",p=o.origin||["middle","center"],d=s.css("position"),y=f?r:["position","top","bottom","left","right","overflow","opacity"],g={height:0,width:0,outerHeight:0,outerWidth:0};"show"===i&&s.show(),t={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},"toggle"===o.mode&&"show"===i?(s.from=o.to||g,s.to=o.from||t):(s.from=o.from||("show"===i?g:t),s.to=o.to||("hide"===i?g:t)),a={from:{y:s.from.height/t.height,x:s.from.width/t.width},to:{y:s.to.height/t.height,x:s.to.width/t.width}},"box"!==h&&"both"!==h||(a.from.y!==a.to.y&&(y=y.concat(l),s.from=x.effects.setTransition(s,l,a.from.y,s.from),s.to=x.effects.setTransition(s,l,a.to.y,s.to)),a.from.x===a.to.x)||(y=y.concat(c),s.from=x.effects.setTransition(s,c,a.from.x,s.from),s.to=x.effects.setTransition(s,c,a.to.x,s.to)),"content"!==h&&"both"!==h||a.from.y===a.to.y||(y=y.concat(n).concat(u),s.from=x.effects.setTransition(s,n,a.from.y,s.from),s.to=x.effects.setTransition(s,n,a.to.y,s.to)),x.effects.save(s,y),s.show(),x.effects.createWrapper(s),s.css("overflow","hidden").css(s.from),p&&(g=x.effects.getBaseline(p,t),s.from.top=(t.outerHeight-s.outerHeight())*g.y,s.from.left=(t.outerWidth-s.outerWidth())*g.x,s.to.top=(t.outerHeight-s.to.outerHeight)*g.y,s.to.left=(t.outerWidth-s.to.outerWidth)*g.x),s.css(s.from),"content"!==h&&"both"!==h||(l=l.concat(["marginTop","marginBottom"]).concat(n),c=c.concat(["marginLeft","marginRight"]),u=r.concat(l).concat(c),s.find("*[width]").each(function(){var e=x(this),t=e.height(),r=e.width(),n=e.outerHeight(),i=e.outerWidth();f&&x.effects.save(e,u),e.from={height:t*a.from.y,width:r*a.from.x,outerHeight:n*a.from.y,outerWidth:i*a.from.x},e.to={height:t*a.to.y,width:r*a.to.x,outerHeight:t*a.to.y,outerWidth:r*a.to.x},a.from.y!==a.to.y&&(e.from=x.effects.setTransition(e,l,a.from.y,e.from),e.to=x.effects.setTransition(e,l,a.to.y,e.to)),a.from.x!==a.to.x&&(e.from=x.effects.setTransition(e,c,a.from.x,e.from),e.to=x.effects.setTransition(e,c,a.to.x,e.to)),e.css(e.from),e.animate(e.to,o.duration,o.easing,function(){f&&x.effects.restore(e,u)})})),s.animate(s.to,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){0===s.to.opacity&&s.css("opacity",s.from.opacity),"hide"===i&&s.hide(),x.effects.restore(s,y),f||("static"===d?s.css({position:"relative",top:s.to.top,left:s.to.left}):x.each(["top","left"],function(i,e){s.css(e,function(e,t){var r=parseInt(t,10),n=i?s.to.left:s.to.top;return"auto"===t?n+"px":r+n+"px"})})),x.effects.removeWrapper(s),e()}})},x.effects.effect.scale=function(e,t){var r=x(this),n=x.extend(!0,{},e),i=x.effects.setMode(r,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)||"hide"===i?0:100),a=e.direction||"both",s=e.origin,u={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l="horizontal"!==a?o/100:1,a="vertical"!==a?o/100:1;n.effect="size",n.queue=!1,n.complete=t,"effect"!==i&&(n.origin=s||["middle","center"],n.restore=!0),n.from=e.from||("show"===i?{height:0,width:0,outerHeight:0,outerWidth:0}:u),n.to={height:u.height*l,width:u.width*a,outerHeight:u.outerHeight*l,outerWidth:u.outerWidth*a},n.fade&&("show"===i&&(n.from.opacity=0,n.to.opacity=1),"hide"===i)&&(n.from.opacity=1,n.to.opacity=0),r.effect(n)},x.effects.effect.puff=function(e,t){var r=x(this),n=x.effects.setMode(r,e.mode||"hide"),i="hide"===n,o=parseInt(e.percent,10)||150,a=o/100,s={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};x.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:t,percent:i?o:100,from:i?s:{height:s.height*a,width:s.width*a,outerHeight:s.outerHeight*a,outerWidth:s.outerWidth*a}}),r.effect(e)},x.effects.effect.pulsate=function(e,t){var r,n=x(this),i=x.effects.setMode(n,e.mode||"show"),o="show"===i,a="hide"===i,s=2*(e.times||5)+(o||"hide"===i?1:0),u=e.duration/s,l=0,i=n.queue(),c=i.length;for(!o&&n.is(":visible")||(n.css("opacity",0).show(),l=1),r=1;r<s;r++)n.animate({opacity:l},u,e.easing),l=1-l;n.animate({opacity:l},u,e.easing),n.queue(function(){a&&n.hide(),t()}),1<c&&i.splice.apply(i,[1,0].concat(i.splice(c,1+s))),n.dequeue()},x.effects.effect.shake=function(e,t){var r,n=x(this),i=["position","top","bottom","left","right","height","width"],o=x.effects.setMode(n,e.mode||"effect"),a=e.direction||"left",s=e.distance||20,u=e.times||3,l=2*u+1,c=Math.round(e.duration/l),f="up"===a||"down"===a?"top":"left",a="up"===a||"left"===a,h={},p={},d={},y=n.queue(),g=y.length;for(x.effects.save(n,i),n.show(),x.effects.createWrapper(n),h[f]=(a?"-=":"+=")+s,p[f]=(a?"+=":"-=")+2*s,d[f]=(a?"-=":"+=")+2*s,n.animate(h,c,e.easing),r=1;r<u;r++)n.animate(p,c,e.easing).animate(d,c,e.easing);n.animate(p,c,e.easing).animate(h,c/2,e.easing).queue(function(){"hide"===o&&n.hide(),x.effects.restore(n,i),x.effects.removeWrapper(n),t()}),1<g&&y.splice.apply(y,[1,0].concat(y.splice(g,1+l))),n.dequeue()},x.effects.effect.slide=function(e,t){var r,n=x(this),i=["position","top","bottom","left","right","width","height"],o=x.effects.setMode(n,e.mode||"show"),a="show"===o,s=e.direction||"left",u="up"===s||"down"===s?"top":"left",s="up"===s||"left"===s,l={};x.effects.save(n,i),n.show(),r=e.distance||n["top"==u?"outerHeight":"outerWidth"](!0),x.effects.createWrapper(n).css({overflow:"hidden"}),a&&n.css(u,s?isNaN(r)?"-"+r:-r:r),l[u]=(a?s?"+=":"-=":s?"-=":"+=")+r,n.animate(l,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&n.hide(),x.effects.restore(n,i),x.effects.removeWrapper(n),t()}})},x.effects.effect.transfer=function(e,t){var r=x(this),n=x(e.to),i="fixed"===n.css("position"),o=x("body"),a=i?o.scrollTop():0,o=i?o.scrollLeft():0,s=n.offset(),s={top:s.top-a,left:s.left-o,height:n.innerHeight(),width:n.innerWidth()},n=r.offset(),u=x("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:n.top-a,left:n.left-o,height:r.innerHeight(),width:r.innerWidth(),position:i?"fixed":"absolute"}).animate(s,e.duration,e.easing,function(){u.remove(),t()})}}),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(f){var r=/\+/g;function h(e){return d.raw?e:encodeURIComponent(e)}function p(e,t){e=d.raw?e:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(r," ")),d.json?JSON.parse(e):e}catch(e){}}(e);return f.isFunction(t)?t(e):e}var d=f.cookie=function(e,t,r){var n,i;if(void 0!==t&&!f.isFunction(t))return"number"==typeof(r=f.extend({},d.defaults,r)).expires&&(n=r.expires,(i=r.expires=new Date).setTime(+i+864e5*n)),document.cookie=[h(e),"=",(i=t,h(d.json?JSON.stringify(i):String(i))),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("");for(var o=e?void 0:{},a=document.cookie?document.cookie.split("; "):[],s=0,u=a.length;s<u;s++){var l=a[s].split("="),c=(c=l.shift(),d.raw?c:decodeURIComponent(c)),l=l.join("=");if(e&&e===c){o=p(l,t);break}e||void 0===(l=p(l))||(o[c]=l)}return o};d.defaults={},f.removeCookie=function(e,t){return void 0!==f.cookie(e)&&(f.cookie(e,"",f.extend({},t,{expires:-1})),!f.cookie(e))}}),jQuery.fn.fullScreen=d,jQuery.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))},e=document,g=e.webkitCancelFullScreen?(f="webkitfullscreenchange","webkitfullscreenerror"):e.mozCancelFullScreen?(f="mozfullscreenchange","mozfullscreenerror"):(f="fullscreenchange","fullscreenerror"),jQuery(document).bind(f,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))}),jQuery(document).bind(g,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))}),document.getElementsByTagName("script")),cookieScriptSrc=cookieScripts[cookieScripts.length-1].src,cookieQuery=null,cookieScriptPosition="bottom",cookieScriptSide="right",cookieScriptSource="cookie-script.com",cookieScriptDomain="",cookieScriptReadMore="/policies/cookie_"+App.context.languageCode+".html",cookieId="6a00eb3cf69b00d1af83ec32b891828a",cookieScriptDebug=0,cookieScriptCurrentUrl=window.location.href,cookieScriptTitle='<h4 id="cookiescript_header">'+App.translations.weUseCookies+"</h4>",cookieScriptDesc=App.translations.weUseCookiesDescription,cookieScriptAccept="×",cookieScriptMore=App.translations.readMore,cookieScriptCopyrights="",cookieScriptLoadJavaScript=function(e,t){var r=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,null!=t&&(n.onload=n.onreadystatechange=function(){n.readyState&&!/loaded|complete/.test(n.readyState)||(n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=void 0,t())}),r.insertBefore(n,r.firstChild)},InjectCookieScript=function(){function t(e){"show"==e?(cookieQuery("#cookiescript_overlay",cookieScriptWindow).show(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).show()):"hide"==e&&(cookieQuery("#cookiescript_overlay",cookieScriptWindow).hide(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).hide())}function e(){cookieQuery('img[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('script[type="text/plain"][data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src")?cookieQuery(this).after('<script type="text/javascript" src="'+cookieQuery(this).attr("src")+'"><\/script>'):cookieQuery(this).after('<script type="text/javascript">'+cookieQuery(this).html()+"<\/script>"),cookieQuery(this).empty()}),cookieQuery('iframe[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))}),cookieQuery('embed[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("src",cookieQuery(this).attr("data-src"))[0].outerHTML)}),cookieQuery('object[data-cookiescript="accepted"]').each(function(){cookieQuery(this).replaceWith(cookieQuery(this).attr("data",cookieQuery(this).attr("data-data"))[0].outerHTML)}),cookieQuery('link[data-cookiescript="accepted"]').each(function(){cookieQuery(this).attr("href",cookieQuery(this).attr("data-href"))})}cookieScriptDropfromFlag=0,cookieScriptDroptoFlag=0,cookieScriptCreateCookie=function(e,t,r){var n,i="";r&&((n=new Date).setTime(n.getTime()+864e5*r),i="; expires="+n.toGMTString()),(r="")!=cookieScriptDomain&&(r="; domain="+cookieScriptDomain),document.cookie=e+"="+t+i+r+"; path=/"},cookieScriptReadCookie=function(e){e+="=";for(var t,r=document.cookie.split(";"),n=0;n<r.length;n++){for(t=r[n];" "==t.charAt(0);)t=t.substring(1,t.length);if(0==t.indexOf(e))return t.substring(e.length,t.length)}return null},cookieQuery(function(){if(cookieScriptWindow=window.document,cookieQuery("#cookiescript_injected",cookieScriptWindow).remove(),cookieQuery("#cookiescript_overlay",cookieScriptWindow).remove(),cookieQuery("#cookiescript_info_box",cookieScriptWindow).remove(),"visit"==(cookieScriptCurrentValue=cookieScriptReadCookie("cookiescriptaccept")))return!1;if(cookieScriptCurrentValue){if("firstvisit"==cookieScriptCurrentValue.substring(0,10)&&cookieScriptCurrentValue!="firstvisit-"+cookieScriptCurrentUrl)return cookieScriptCreateCookie("cookiescriptaccept","visit",30),e(),!1}else cookieScriptCreateCookie("cookiescriptaccept","firstvisit-"+cookieScriptCurrentUrl,30);cookieQuery("body",cookieScriptWindow).append('<div id="cookiescript_injected">'+cookieScriptTitle+cookieScriptDesc+' <span id="cookiescript_readmore">'+cookieScriptMore+'</span><div id="cookiescript_accept">'+cookieScriptAccept+'</div><div style="clear:both"></div>'),cookieQuery("#cookiescript_injected",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,opacity:1,position:"fixed",padding:"15px",width:"300px","font-size":"13px","font-weight":"normal","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"none","line-height":"15px","letter-spacing":"normal","-moz-box-shadow":"0px 0px 8px #000000","-webkit-box-shadow":"0px 0px 8px #000000","box-shadow":"0px 0px 8px #000000"}),"top"==cookieScriptPosition?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("top",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("bottom",0),"left"==cookieScriptSide?cookieQuery("#cookiescript_injected",cookieScriptWindow).css("left",0):cookieQuery("#cookiescript_injected",cookieScriptWindow).css("right",0),cookieQuery("#cookiescript_injected h4#cookiescript_header",cookieScriptWindow).css({"background-color":"#111111","z-index":999999,padding:"0 0 7px 0","text-align":"left",color:"#FFFFFF","font-family":"Arial, sans-serif",display:"block","font-size":"15px","font-weight":"bold","line-height":"normal","letter-spacing":"normal","font-style":"normal",margin:"0"}),cookieQuery("#cookiescript_injected a",cookieScriptWindow).css({"text-decoration":"underline",color:"#FFFFFF"}),cookieQuery("#cookiescript_injected a#cookiescript_link",cookieScriptWindow).css({"text-decoration":"none",color:"#FFFFFF",float:"right","font-size":"90%","margin-top":"8px"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({border:0,padding:"0","text-decoration":"underline",cursor:"pointer",margin:"0","white-space":"nowrap"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"-webkit-border-radius":"10px","-khtml-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",border:0,padding:"0",cursor:"pointer",margin:"0","-webkit-transition":"0.25s","-moz-transition":"0.25s",transition:"0.25s",width:"20px",height:"20px",position:"absolute",top:"12px",right:"17px","text-align":"center","font-weight":"bold","line-height":"21px","font-size":"20px"}),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).css({"background-color":"#5BB75B",color:"#FFFFFF",float:"left"}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).css({}),cookieQuery("#cookiescript_injected div#cookiescript_pixel",cookieScriptWindow).css({width:"1px",height:"1px",float:"left"}),cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeIn(1e3),cookieQuery("#cookiescript_injected div#cookiescript_accept",cookieScriptWindow).click(function(){"undefined"==typeof cookieScriptScrollfired&&(cookieQuery("#cookiescript_injected",cookieScriptWindow).fadeOut(200),cookieScriptCreateCookie("cookiescriptaccept","visit",30),t("hide"),e())}),cookieQuery("#cookiescript_injected span#cookiescript_readmore",cookieScriptWindow).click(function(){return window.open(cookieScriptReadMore,"_blank"),!1}),cookieQuery("#cookiescript_overlay",cookieScriptWindow).click(function(){t("hide")}),cookieQuery("#cookiescript_info_close",cookieScriptWindow).click(function(){t("hide")}),document.onkeydown=function(e){27==(e=e||window.event).keyCode&&t("hide")},cookieQuery('iframe[data-cookiescript="accepted"]').not(":has([src])").each(function(){var e=this;(e=e.contentWindow||e.contentDocument.document||e.contentDocument).document.open(),e.document.write(cookieQuery(this).attr("alt")),e.document.close()})}),"visit"!=cookieScriptReadCookie("cookiescriptaccept")&&"shown"!=cookieScriptReadCookie("cookiescriptaccept")||e()};function cof2Obj(e){"use strict";var t,r,n,i,o,a=e.split("\n"),s=[];for(t in a)a.hasOwnProperty(t)&&(3===(r=a[t].replace(/^\s+|\s+$/g,"").split(/\s+/)).length?(n=parseFloat(r[0]),i=r[1],o=r[2]):6===r.length&&s.push({n:parseInt(r[0],10),m:parseInt(r[1],10),gnm:parseFloat(r[2]),hnm:parseFloat(r[3]),dgnm:parseFloat(r[4]),dhnm:parseFloat(r[5])}));return{epoch:n,model:i,modelDate:o,wmm:s}}function geoMagFactory(e){"use strict";function S(e){return e*(180/Math.PI)}function j(e){return e*(Math.PI/180)}var t,r,O,P,n,i,o,k=e.epoch,a=[0,0,0,0,0,0,0,0,0,0,0,0,0],E=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],T=a.slice(),C=a.slice(),R=a.slice(),M=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],I=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],s=6356.7523142,A=40680631.59076899,L=s*s,D=A-L,F=A*A,N=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],B=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],u=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],G=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice(),a.slice()],U=[0,2,3,4,5,6,7,8,9,10,11,12,13],z=[0,1,2,3,4,5,6,7,8,9,10,11,12];for(t in E[0][0]=0,T[0]=0,C[0]=1,R[0]=1,M[0][0]=1,r=e.wmm)r.hasOwnProperty(t)&&r[t].m<=r[t].n&&(N[r[t].m][r[t].n]=r[t].gnm,B[r[t].m][r[t].n]=r[t].dgnm,0!==r[t].m)&&(N[r[t].n][r[t].m-1]=r[t].hnm,B[r[t].n][r[t].m-1]=r[t].dhnm);for(r=e=null,u[0][0]=1,O=1;O<=12;O++)for(u[0][O]=u[0][O-1]*(2*O-1)/O,n=2,o=O-(P=0)+1;0<o;o--,P++)G[P][O]=((O-1)*(O-1)-P*P)/((2*O-1)*(2*O-3)),0<P&&(i=(O-P+1)*n/(O+P),u[P][O]=u[P-1][O]*Math.sqrt(i),N[O][P-(n=1)]=u[P][O]*N[O][P-1],B[O][P-1]=u[P][O]*B[O][P-1]),N[P][O]=u[P][O]*N[P][O],B[P][O]=u[P][O]*B[P][O];return G[1][1]=0,function(e,t,r,n){r=r/3280.8399||0;d=(n=(n=n)||new Date).getFullYear(),y=24*(365+(d%400==0||d%4==0&&0<d%100?1:0))*60*60*1e3;var i,o,a,s,u,l,c,f,h,p=n.getFullYear()+(n.valueOf()-new Date(d,0).valueOf())/y-k,n=j(e),d=j(t),y=Math.sin(d),g=Math.sin(n),d=Math.cos(d),n=Math.cos(n),m=g*g,v=n*n,b=0,_=0,w=0,x=0;for(T[1]=y,C[1]=d,d=r*(y=Math.sqrt(A-D*m)),i=g/Math.sqrt((d+A)/(d+L)*((d+A)/(d+L))*v+m),o=Math.sqrt(1-i*i),d=Math.sqrt(r*r+2*d+(F-22083079019902.25*m)/(y*y)),r=(r+(y=Math.sqrt(A*v+L*m)))/d,v=D*n*g/(d*y),P=2;P<=12;P++)T[P]=T[1]*C[P-1]+C[1]*T[P-1],C[P]=C[1]*C[P-1]-T[1]*T[P-1];for(s=(a=6371.2/d)*a,O=1;O<=12;O++)for(s*=a,f=O+(P=0)+1;0<f;f--,P++)O===P?(M[P][O]=o*M[P-1][O-1],I[P][O]=o*I[P-1][O-1]+i*M[P-1][O-1]):1===O&&0===P?(M[P][O]=i*M[P][O-1],I[P][O]=i*I[P][O-1]-o*M[P][O-1]):1<O&&O!==P&&(O-2<P&&(M[P][O-2]=0),O-2<P&&(I[P][O-2]=0),M[P][O]=i*M[P][O-1]-G[P][O]*M[P][O-2],I[P][O]=i*I[P][O-1]-o*M[P][O-1]-G[P][O]*I[P][O-2]),E[P][O]=N[P][O]+p*B[P][O],0!==P&&(E[O][P-1]=N[O][P-1]+p*B[O][P-1]),c=s*M[P][O],l=0===P?(u=E[P][O]*C[P],E[P][O]*T[P]):(u=E[P][O]*C[P]+E[O][P-1]*T[P],E[P][O]*T[P]-E[O][P-1]*C[P]),_-=s*u*I[P][O],w+=z[P]*l*c,b+=U[O]*u*c,0===o&&1===P&&(R[O]=1===O?R[O-1]:i*R[O-1]-G[P][O]*R[O-2],c=s*R[O],x+=z[P]*l*c);return m=-_*r-b*v,n=w=0===o?x:w/o,g=_*v-b*r,y=Math.sqrt(m*m+n*n),d=Math.sqrt(y*y+g*g),v=S(Math.atan2(n,m)),r=S(Math.atan2(g,y)),55<=Math.abs(e)&&(0<e&&0<=t?h=v-t:0<e&&t<0?h=v+Math.abs(t):e<0&&0<=t?h=v+t:e<0&&t<0&&(h=v-Math.abs(t)),180<h?h-=360:h<-180&&(h+=360)),{dec:v,dip:r,ti:d,bh:y,bx:m,by:n,bz:g,lat:e,lon:t,gv:h,epoch:k}}}window.jQuery&&jQuery.fn&&/^(1\.[8-9]|2\.[0-9])/.test(jQuery.fn.jquery)?(cookieScriptDebug&&window.console&&console.log("Using existing jQuery version "+jQuery.fn.jquery),cookieQuery=window.jQuery,InjectCookieScript()):(cookieScriptDebug&&window.console&&console.log("Loading jQuery 1.8.1 from ajax.googleapis.com"),cookieScriptLoadJavaScript(("https:"==document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js",function(){cookieQuery=jQuery.noConflict(!0),InjectCookieScript()})),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("wkt-parser")):"function"==typeof define&&define.amd?define(["wkt-parser"],t):e.proj4=t(e.wkt)}(this,function(i){"use strict";function d(e,t){if(e[t])return e[t];for(var r,n=Object.keys(e),i=t.toLowerCase().replace(ke,""),o=-1;++o<n.length;)if((r=n[o]).toLowerCase().replace(ke,"")===i)return e[r]}function o(e){var t=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?o[e]=Ee(arguments[1]):o[e]=i(arguments[1]):o[e]=r}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(e){Array.isArray(e)?o.apply(t,e):o(e)});if("string"==typeof e){if(e in o)return o[e]}else"EPSG"in e?o["EPSG:"+e.EPSG]=e:"ESRI"in e?o["ESRI:"+e.ESRI]=e:"IAU2000"in e?o["IAU2000:"+e.IAU2000]=e:console.log(e)}}function N(e){var t,r,n;return"string"!=typeof e?e:e in o?o[e]:(n=e,Te.some(function(e){return-1<n.indexOf(e)})?function(e){if(e=d(e,"authority"))return(e=d(e,"epsg"))&&-1<Ce.indexOf(e)}(t=i(e))?o["EPSG:3857"]:(r=function(e){if(e=d(e,"extension"))return d(e,"proj4")}(t))?Ee(r):t:"+"===e[0]?Ee(e):void 0)}function r(e){return e}function n(e,t){var r=Ie.length;return e.names?((Ie[r]=e).names.forEach(function(e){Me[e.toLowerCase()]=r}),this):(console.log(t),!0)}function y(e,t){if(!(this instanceof y))return new y(e);t=t||function(e){if(e)throw e};var r,n,i,o,a,s,u,l,c,f,h,p=N(e);"object"==typeof p&&(r=y.projections.get(p.projName))?(p.datumCode&&"none"!==p.datumCode&&(u=d(C,p.datumCode))&&(p.datum_params=u.towgs84?u.towgs84.split(","):null,p.ellps=u.ellipse,p.datumName=u.datumName||p.datumCode),p.k0=p.k0||1,p.axis=p.axis||"enu",p.ellps=p.ellps||"wgs84",u=p.a,l=p.b,c=p.rf,f=p.ellps,h=p.sphere,u||(u=(f=(f=d(Ae,f))||Le).a,l=f.b,c=f.rf),c&&!l&&(l=(1-1/c)*u),(0===c||Math.abs(u-l)<O)&&(h=!0,l=u),l=(f={a:u,b:l,rf:c,sphere:h}).a,c=f.b,h=p.R_A,a=((o=l*l)-(c=c*c))/o,s=0,h?(o=(l*=1-a*(we+a*(xe+a*Se)))*l,a=0):s=Math.sqrt(a),h={es:a,e:s,ep2:(o-c)/c},l=p.datum||(l=p.datumCode,a=p.datum_params,s=f.a,o=f.b,c=h.es,n=h.ep2,(i={}).datum_type=void 0===l||"none"===l?be:ve,a&&(i.datum_params=a.map(parseFloat),0===i.datum_params[0]&&0===i.datum_params[1]&&0===i.datum_params[2]||(i.datum_type=x),3<i.datum_params.length)&&(0===i.datum_params[3]&&0===i.datum_params[4]&&0===i.datum_params[5]&&0===i.datum_params[6]||(i.datum_type=S,i.datum_params[3]*=_e,i.datum_params[4]*=_e,i.datum_params[5]*=_e,i.datum_params[6]=i.datum_params[6]/1e6+1)),i.a=s,i.b=o,i.es=c,i.ep2=n,i),ee(this,p),ee(this,r),this.a=f.a,this.b=f.b,this.rf=f.rf,this.sphere=f.sphere,this.es=h.es,this.e=h.e,this.ep2=h.ep2,this.datum=l,this.init(),t(null,this)):t(e)}function B(e,t,r){var n=e.x,i=e.y,o=e.z||0;if(i<-j&&-1.001*j<i)i=-j;else if(j<i&&i<1.001*j)i=j;else{if(i<-j)return{x:-1/0,y:-1/0,z:e.z};if(j<i)return{x:1/0,y:1/0,z:e.z}}return n>Math.PI&&(n-=2*Math.PI),e=Math.sin(i),i=Math.cos(i),{x:((r=r/Math.sqrt(1-t*(e*e)))+o)*i*Math.cos(n),y:(r+o)*i*Math.sin(n),z:(r*(1-t)+o)*e}}function G(e,t,r,n){var i,o,a,s,u,l,c,f,h,p,d,y=e.x,g=e.y,m=e.z||0,v=Math.sqrt(y*y+g*g),b=Math.sqrt(y*y+g*g+m*m);if(v/r<1e-12){if(p=0,b/r<1e-12)return d=-n,{x:e.x,y:e.y,z:e.z}}else p=Math.atan2(g,y);for(i=m/b,s=(o=v/b)*(1-t)*(a=1/Math.sqrt(1-t*(2-t)*o*o)),u=i*a,h=0;h++,f=t*(f=r/Math.sqrt(1-t*u*u))/(f+(d=v*s+m*u-f*(1-t*u*u))),f=(c=i*(a=1/Math.sqrt(1-f*(2-f)*o*o)))*s-(l=o*(1-f)*a)*u,s=l,u=c,1e-24<f*f&&h<30;);return{x:p,y:Math.atan(c/Math.abs(l)),z:d}}function U(e){return e===x||e===S}function z(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function W(e,t,r){var n,i;if(Array.isArray(r)&&(r=ne(r)),ie(r),e.datum&&t.datum&&(i=t,((n=e).datum.datum_type===x||n.datum.datum_type===S)&&"WGS84"!==i.datumCode||(i.datum.datum_type===x||i.datum.datum_type===S)&&"WGS84"!==n.datumCode)&&(r=W(e,i=new y("WGS84"),r),e=i),"enu"!==e.axis&&(r=re(e,!1,r)),"longlat"===e.projName)r={x:r.x*P,y:r.y*P,z:r.z||0};else if(e.to_meter&&(r={x:r.x*e.to_meter,y:r.y*e.to_meter,z:r.z||0}),!(r=e.inverse(r)))return;return e.from_greenwich&&(r.x+=e.from_greenwich),r=te(e.datum,t.datum,r),t.from_greenwich&&(r={x:r.x-t.from_greenwich,y:r.y,z:r.z||0}),"longlat"===t.projName?r={x:r.x*k,y:r.y*k,z:r.z||0}:(r=t.forward(r),t.to_meter&&(r={x:r.x/t.to_meter,y:r.y/t.to_meter,z:r.z||0})),"enu"!==t.axis?re(t,!0,r):r}function V(t,r,n){var i,e;return Array.isArray(n)?(e=W(t,r,n)||{x:NaN,y:NaN},2<n.length?void 0!==t.name&&"geocent"===t.name||void 0!==r.name&&"geocent"===r.name?("number"==typeof e.z?[e.x,e.y,e.z]:[e.x,e.y,n[2]]).concat(n.splice(3)):[e.x,e.y].concat(n.splice(2)):[e.x,e.y]):(i=W(t,r,n),2===(e=Object.keys(n)).length||e.forEach(function(e){if(void 0!==t.name&&"geocent"===t.name||void 0!==r.name&&"geocent"===r.name){if("x"===e||"y"===e||"z"===e)return}else if("x"===e||"y"===e)return;i[e]=n[e]}),i)}function H(e){return e instanceof y?e:e.oProj||y(e)}function e(t,r,e){t=H(t);var n=!1;return void 0===r?(r=t,t=De,n=!0):void 0===r.x&&!Array.isArray(r)||(e=r,r=t,t=De,n=!0),r=H(r),e?V(t,r,e):(e={forward:function(e){return V(t,r,e)},inverse:function(e){return V(r,t,e)}},n&&(e.oProj=r),e)}function q(e,t){return t=t||5,e={lat:e[1],lon:e[0]},o=e.lat,e=e.lon,a=X(o),s=X(e),i=Math.floor((e+180)/6)+1,180===e&&(i=60),56<=o&&o<64&&3<=e&&e<12&&(i=32),72<=o&&o<84&&(0<=e&&e<9?i=31:9<=e&&e<21?i=33:21<=e&&e<33?i=35:33<=e&&e<42&&(i=37)),e=X(6*(i-1)-180+3),u=6378137/Math.sqrt(1-.00669438*Math.sin(a)*Math.sin(a)),r=Math.tan(a)*Math.tan(a),n=.006739496752268451*Math.cos(a)*Math.cos(a),e=.9996*u*((s=Math.cos(a)*(s-e))+(1-r+n)*s*s*s/6+(5-18*r+r*r+72*n-.39089081163157013)*s*s*s*s*s/120)+5e5,u=.9996*(6378137*(.9983242984503243*a-.002514607064228144*Math.sin(2*a)+2639046602129982e-21*Math.sin(4*a)-3.418046101696858e-9*Math.sin(6*a))+u*Math.tan(a)*(s*s/2+(5-r+9*n+4*n*n)*s*s*s*s/24+(61-58*r+r*r+600*n-2.2240339282485886)*s*s*s*s*s*s/720)),o<0&&(u+=1e7),a={northing:Math.round(u),easting:Math.round(e),zoneNumber:i,zoneLetter:function(e){var t="Z";return e<=84&&72<=e?t="X":e<72&&64<=e?t="W":e<64&&56<=e?t="V":e<56&&48<=e?t="U":e<48&&40<=e?t="T":e<40&&32<=e?t="S":e<32&&24<=e?t="R":e<24&&16<=e?t="Q":e<16&&8<=e?t="P":e<8&&0<=e?t="N":e<0&&-8<=e?t="M":e<-8&&-16<=e?t="L":e<-16&&-24<=e?t="K":e<-24&&-32<=e?t="J":e<-32&&-40<=e?t="H":e<-40&&-48<=e?t="G":e<-48&&-56<=e?t="F":e<-56&&-64<=e?t="E":e<-64&&-72<=e?t="D":e<-72&&-80<=e&&(t="C"),t}(o)},r=t,n="00000"+a.easting,s="00000"+a.northing,a.zoneNumber+a.zoneLetter+function(e,t,r){r=$(r);return function(e,t,r){var r=r-1,n=Ne.charCodeAt(r),r=Be.charCodeAt(r),e=n+e-1,t=r+t,i=!1;return Ue<e&&(e=e-Ue+R-1,i=!0),(e===M||n<M&&M<e||(M<e||n<M)&&i)&&e++,(e===I||n<I&&I<e||(I<e||n<I)&&i)&&++e===M&&e++,Ue<e&&(e=e-Ue+R-1),i=Ge<t&&(t=t-Ge+R-1,!0),(t===M||r<M&&M<t||(M<t||r<M)&&i)&&t++,(t===I||r<I&&I<t||(I<t||r<I)&&i)&&++t===M&&t++,Ge<t&&(t=t-Ge+R-1),String.fromCharCode(e)+String.fromCharCode(t)}(Math.floor(e/1e5),Math.floor(t/1e5)%20,r)}(a.easting,a.northing,a.zoneNumber)+n.substr(n.length-5,r)+s.substr(s.length-5,r);var r,n,i,o,a,s,u}function Y(e){e=K(J(e.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function X(e){return e*(Math.PI/180)}function Z(e){return e/Math.PI*180}function K(e){var t,r,n,i=e.northing,o=e.easting,a=e.zoneLetter,s=e.zoneNumber;return s<0||60<s?null:(o=o-5e5,i=i,a<"N"&&(i-=1e7),a=6*(s-1)-180+3,i=(s=i/.9996/6367449.145945056)+(3*(i=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)))/2-27*i*i*i/32)*Math.sin(2*s)+(21*i*i/16-55*i*i*i*i/32)*Math.sin(4*s)+151*i*i*i/96*Math.sin(6*s),s=6378137/Math.sqrt(1-.00669438*Math.sin(i)*Math.sin(i)),t=Math.tan(i)*Math.tan(i),r=.006739496752268451*Math.cos(i)*Math.cos(i),n=6335439.32722994/Math.pow(1-.00669438*Math.sin(i)*Math.sin(i),1.5),o=o/(.9996*s),s=Z(s=i-s*Math.tan(i)/n*(o*o/2-(5+3*t+10*r-4*r*r-.06065547077041606)*o*o*o*o/24+(61+90*t+298*r+45*t*t-1.6983531815716497-3*r*r)*o*o*o*o*o*o/720)),n=a+Z(n=(o-(1+2*t+r)*o*o*o/6+(5-2*r+28*t-3*r*r+.05391597401814761+24*t*t)*o*o*o*o*o/120)/Math.cos(i)),e.accuracy?{top:(a=K({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber})).lat,right:a.lon,bottom:s,left:n}:{lat:s,lon:n})}function $(e){e%=Fe;return e=0===e?Fe:e}function J(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,r=e.length,n=null,i="",o=0;!/[A-Z]/.test(t=e.charAt(o));){if(2<=o)throw"MGRSPoint bad conversion from: "+e;i+=t,o++}var a=parseInt(i,10);if(0===o||r<o+3)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(o++);if(s<="A"||"B"===s||"Y"===s||"Z"<=s||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+e;for(var n=e.substring(o,o+=2),u=$(a),l=function(e,t){for(var r=Ne.charCodeAt(t-1),n=1e5,i=!1;r!==e.charCodeAt(0);){if(++r===M&&r++,r===I&&r++,Ue<r){if(i)throw"Bad character: "+e;r=R,i=!0}n+=1e5}return n}(n.charAt(0),u),c=function(e,t){if("V"<e)throw"MGRSPoint given invalid Northing "+e;for(var r=Be.charCodeAt(t-1),n=0,i=!1;r!==e.charCodeAt(0);){if(++r===M&&r++,r===I&&r++,Ge<r){if(i)throw"Bad character: "+e;r=R,i=!0}n+=1e5}return n}(n.charAt(1),u);c<function(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(0<=t)return t;throw"Invalid zone letter: "+e}(s);)c+=2e6;n=r-o;if(n%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var f,h,u=n/2,r=0,n=0;return 0<u&&(f=1e5/Math.pow(10,u),h=e.substring(o,o+u),r=parseFloat(h)*f,h=e.substring(o+u),n=parseFloat(h)*f),{easting:r+l,northing:n+c,zoneLetter:s,zoneNumber:a,accuracy:f}}function a(e,t,r){if(!(this instanceof a))return new a(e,t,r);var n;Array.isArray(e)?(this.x=e[0],this.y=e[1],this.z=e[2]||0):"object"==typeof e?(this.x=e.x,this.y=e.y,this.z=e.z||0):"string"==typeof e&&void 0===t?(n=e.split(","),this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0):(this.x=e,this.y=t,this.z=r||0),console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function Q(e,t,r,n){var i;return e<O?(n.value=A,i=0):(i=Math.atan2(t,r),Math.abs(i)<=E?n.value=A:E<i&&i<=j+E?(n.value=L,i-=j):j+E<i||i<=-(j+E)?(n.value=D,i=0<=i?i-T:i+T):(n.value=F,i+=j)),i}function l(e,t){e+=t;return e<-T?e+=je:T<e&&(e-=je),e}i=i&&i.hasOwnProperty("default")?i.default:i;function ee(e,t){var r,n;if(e=e||{},t)for(n in t)void 0!==(r=t[n])&&(e[n]=r)}function s(e,t,r){return e*=t,r/Math.sqrt(1-e*e)}function h(e){return e<0?-1:1}function g(e){return Math.abs(e)<=T?e:e-h(e)*je}function u(e,t,r){return r*=e,r=Math.pow((1-r)/(1+r),.5*e),Math.tan(.5*(j-t))/r}function c(e,t){for(var r,n=.5*e,i=j-2*Math.atan(t),o=0;o<=15;o++)if(r=e*Math.sin(i),i+=r=j-2*Math.atan(t*Math.pow((1-r)/(1+r),n))-i,Math.abs(r)<=1e-10)return i;return-9999}function te(e,t,r){return l=t,((u=e).datum_type!==l.datum_type||u.a!==l.a||5e-11<Math.abs(u.es-l.es)||(u.datum_type===x?u.datum_params[0]!==l.datum_params[0]||u.datum_params[1]!==l.datum_params[1]||u.datum_params[2]!==l.datum_params[2]:u.datum_type===S&&(u.datum_params[0]!==l.datum_params[0]||u.datum_params[1]!==l.datum_params[1]||u.datum_params[2]!==l.datum_params[2]||u.datum_params[3]!==l.datum_params[3]||u.datum_params[4]!==l.datum_params[4]||u.datum_params[5]!==l.datum_params[5]||u.datum_params[6]!==l.datum_params[6])))&&e.datum_type!==be&&t.datum_type!==be&&(e.es!==t.es||e.a!==t.a||U(e.datum_type)||U(t.datum_type))?(r=B(r,e.es,e.a),U(e.datum_type)&&(u=r,l=e.datum_type,e=e.datum_params,r=l===x?{x:u.x+e[0],y:u.y+e[1],z:u.z+e[2]}:l===S?(l=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],{x:(e=e[6])*(u.x-s*u.y+a*u.z)+l,y:e*(s*u.x+u.y-o*u.z)+n,z:e*(-a*u.x+o*u.y+u.z)+i}):void 0),U(t.datum_type)&&(l=r,s=t.datum_type,n=t.datum_params,r=s===x?{x:l.x-n[0],y:l.y-n[1],z:l.z-n[2]}:s===S?(s=n[0],e=n[1],a=n[2],o=n[3],u=n[4],i=n[5],n=n[6],{x:(s=(l.x-s)/n)+i*(e=(l.y-e)/n)-u*(l=(l.z-a)/n),y:-i*s+e+o*l,z:u*s-o*e+l}):void 0),G(r,t.es,t.a,t.b)):r;var n,i,o,a,s,u,l}function re(e,t,r){for(var n,i,o=r.x,a=r.y,s=r.z||0,u={},l=0;l<3;l++)if(!t||2!==l||void 0!==r.z)switch(i=0===l?(n=o,-1!=="ew".indexOf(e.axis[l])?"x":"y"):1===l?(n=a,-1!=="ns".indexOf(e.axis[l])?"y":"x"):(n=s,"z"),e.axis[l]){case"e":case"w":case"n":case"s":u[i]=n;break;case"u":void 0!==r[i]&&(u.z=n);break;case"d":void 0!==r[i]&&(u.z=-n);break;default:return null}return u}function ne(e){var t={x:e[0],y:e[1]};return 2<e.length&&(t.z=e[2]),3<e.length&&(t.m=e[3]),t}function ie(e){z(e.x),z(e.y)}function oe(e){var t=[],r=(t[0]=1-e*(.25+e*(.046875+e*(.01953125+e*ze))),t[1]=e*(.75-e*(.046875+e*(.01953125+e*ze))),e*e);return t[2]=r*(.46875-e*(.013020833333333334+.007120768229166667*e)),t[3]=(r*=e)*(.3645833333333333-.005696614583333333*e),t[4]=r*e*.3076171875,t}function ae(e,t,r,n){return n[0]*e-(r*=t)*(n[1]+(t*=t)*(n[2]+t*(n[3]+t*n[4])))}function se(e,t,r){for(var n=1/(1-t),i=e,o=20;o;--o){var a=Math.sin(i),s=1-t*a*a;if(i-=s=(ae(i,a,Math.cos(i),r)-e)*(s*Math.sqrt(s))*n,Math.abs(s)<O)return i}return i}function ue(e){return((e=Math.exp(e))-1/e)/2}function le(e,t){e=Math.abs(e),t=Math.abs(t);var r=Math.max(e,t),e=Math.min(e,t)/(r||1);return r*Math.sqrt(1+Math.pow(e,2))}function ce(e){var t,r,n,i=Math.abs(e);return t=i*(1+i/(le(1,i)+1)),i=0==(n=(r=1+t)-1)?t:t*Math.log(r)/n,e<0?-i:i}function fe(e,t){for(var r,n=2*Math.cos(2*t),i=e.length-1,o=e[i],a=0;0<=--i;)r=n*o-a+e[i],a=o,o=r;return t+r*Math.sin(2*t)}function he(e,t,r){for(var n,i,o=Math.sin(t),t=Math.cos(t),a=ue(r),r=function(e){e=Math.exp(e);return(e+1/e)/2}(r),s=2*t*r,u=-2*o*a,l=e.length-1,c=e[l],f=0,h=0,p=0;0<=--l;)n=h,i=f,c=s*(h=c)-n-u*(f=p)+e[l],p=u*h-i+s*f;return[(s=o*r)*c-(u=t*a)*p,s*p+u*c]}function pe(e,t){return Math.pow((1-e)/(1+e),t)}function m(e,t,r,n,i){return e*i-t*Math.sin(2*i)+r*Math.sin(4*i)-n*Math.sin(6*i)}function p(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function v(e){return.375*e*(1+.25*e*(1+.46875*e))}function de(e){return.05859375*e*e*(1+.75*e)}function ye(e){return e*e*e*(35/3072)}function b(e,t,r){return t*=r,e/Math.sqrt(1-t*t)}function f(e){return Math.abs(e)<j?e:e-h(e)*Math.PI}function ge(e,t,r,n,i){for(var o,a=e/t,s=0;s<15;s++)if(a+=o=(e-(t*a-r*Math.sin(2*a)+n*Math.sin(4*a)-i*Math.sin(6*a)))/(t-2*r*Math.cos(2*a)+4*n*Math.cos(4*a)-6*i*Math.cos(6*a)),Math.abs(o)<=1e-10)return a;return NaN}function _(e,t){var r;return 1e-7<e?(1-e*e)*(t/(1-(r=e*t)*r)-.5/e*Math.log((1-r)/(1+r))):2*t}function w(e){return 1<Math.abs(e)&&(e=1<e?1:-1),Math.asin(e)}function me(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))}var x=1,S=2,ve=4,be=5,_e=484813681109536e-20,j=Math.PI/2,we=.16666666666666666,xe=.04722222222222222,Se=.022156084656084655,O=1e-10,P=.017453292519943295,k=57.29577951308232,E=Math.PI/4,je=2*Math.PI,T=3.14159265359,Oe={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Pe={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},ke=/[\s_\-\/\(\)]/g,Ee=function(e){var t,r,n,i={},o=e.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,t){t=t.split("=");return t.push(!0),e[t[0].toLowerCase()]=t[1],e},{}),a={proj:"projName",datum:"datumCode",rf:function(e){i.rf=parseFloat(e)},lat_0:function(e){i.lat0=e*P},lat_1:function(e){i.lat1=e*P},lat_2:function(e){i.lat2=e*P},lat_ts:function(e){i.lat_ts=e*P},lon_0:function(e){i.long0=e*P},lon_1:function(e){i.long1=e*P},lon_2:function(e){i.long2=e*P},alpha:function(e){i.alpha=parseFloat(e)*P},lonc:function(e){i.longc=e*P},x_0:function(e){i.x0=parseFloat(e)},y_0:function(e){i.y0=parseFloat(e)},k_0:function(e){i.k0=parseFloat(e)},k:function(e){i.k0=parseFloat(e)},a:function(e){i.a=parseFloat(e)},b:function(e){i.b=parseFloat(e)},r_a:function(){i.R_A=!0},zone:function(e){i.zone=parseInt(e,10)},south:function(){i.utmSouth=!0},towgs84:function(e){i.datum_params=e.split(",").map(function(e){return parseFloat(e)})},to_meter:function(e){i.to_meter=parseFloat(e)},units:function(e){e=d(Pe,i.units=e);e&&(i.to_meter=e.to_meter)},from_greenwich:function(e){i.from_greenwich=e*P},pm:function(e){var t=d(Oe,e);i.from_greenwich=(t||parseFloat(e))*P},nadgrids:function(e){"@null"===e?i.datumCode="none":i.nadgrids=e},axis:function(e){3===e.length&&-1!=="ewnsud".indexOf(e.substr(0,1))&&-1!=="ewnsud".indexOf(e.substr(1,1))&&-1!=="ewnsud".indexOf(e.substr(2,1))&&(i.axis=e)}};for(t in o)r=o[t],t in a?"function"==typeof(n=a[t])?n(r):i[n]=r:i[t]=r;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},Te=((t=o)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"],["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"]),Ce=["3857","900913","3785","102113"],Re=[{init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(e){var t,r,n=e.x,i=e.y;return 90<i*k&&i*k<-90&&180<n*k&&n*k<-180||Math.abs(Math.abs(i)-j)<=O?null:(r=this.sphere?(t=this.x0+this.a*this.k0*g(n-this.long0),this.y0+this.a*this.k0*Math.log(Math.tan(E+.5*i))):(r=Math.sin(i),i=u(this.e,i,r),t=this.x0+this.a*this.k0*g(n-this.long0),this.y0-this.a*this.k0*Math.log(i)),e.x=t,e.y=r,e)},inverse:function(e){var t,r=e.x-this.x0,n=e.y-this.y0;if(this.sphere)t=j-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var n=Math.exp(-n/(this.a*this.k0));if(-9999===(t=c(this.e,n)))return null}return n=g(this.long0+r/(this.a*this.k0)),e.x=n,e.y=t,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:r,inverse:r,names:["longlat","identity"]}],Me={},Ie=[],t={start:function(){Re.forEach(n)},add:n,get:function(e){return!!e&&(e=e.toLowerCase(),void 0!==Me[e]&&Ie[Me[e]]?Ie[Me[e]]:void 0)}},Ae={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Le=Ae.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},C=(Ae.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"},{}),De=(C.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},C.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},C.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},C.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},C.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},C.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},C.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},C.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},C.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},C.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},C.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},C.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},C.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},C.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},C.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},C.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},C.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},(y.projections=t).start(),y("WGS84")),Fe=6,Ne="AJSAJS",Be="AFAFAF",R=65,M=73,I=79,Ge=86,Ue=90,t={forward:q,inverse:function(e){e=K(J(e.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:Y},ze=(a.fromMGRS=function(e){return new a(Y(e))},a.prototype.toMGRS=function(e){return q([this.x,this.y],e)},.01068115234375),We={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=oe(this.es),this.ml0=ae(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var t=e.x,r=e.y,t=g(t-this.long0),n=Math.sin(r),i=Math.cos(r);if(this.es)var o=i*t,a=Math.pow(o,2),s=this.ep2*Math.pow(i,2),u=Math.pow(s,2),l=Math.abs(i)>O?Math.tan(r):0,l=Math.pow(l,2),c=Math.pow(l,2),f=1-this.es*Math.pow(n,2),f=(o/=Math.sqrt(f),ae(r,n,i,this.en)),h=this.a*(this.k0*o*(1+a/6*(1-l+s+a/20*(5-18*l+c+14*s-58*l*s+a/42*(61+179*c-c*l-479*l)))))+this.x0,f=this.a*(this.k0*(f-this.ml0+n*t*o/2*(1+a/12*(5-l+9*s+4*u+a/30*(61+c-58*l+270*s-330*l*s+a/56*(1385+543*c-c*l-3111*l))))))+this.y0;else{n=i*Math.sin(t);if(Math.abs(Math.abs(n)-1)<O)return 93;if(h=.5*this.a*this.k0*Math.log((1+n)/(1-n))+this.x0,f=i*Math.cos(t)/Math.sqrt(1-Math.pow(n,2)),1<=(n=Math.abs(f))){if(O<n-1)return 93;f=0}else f=Math.acos(f);f=this.a*this.k0*((f=r<0?-f:f)-this.lat0)+this.y0}return e.x=h,e.y=f,e},inverse:function(e){var t,r,n,i,o,a,s,u,l,c=(e.x-this.x0)*(1/this.a),f=(e.y-this.y0)*(1/this.a);return o=this.es?(n=this.ml0+f/this.k0,l=se(n,this.es,this.en),Math.abs(l)<j?(s=Math.sin(l),t=Math.cos(l),i=Math.abs(t)>O?Math.tan(l):0,u=this.ep2*Math.pow(t,2),a=Math.pow(u,2),r=Math.pow(i,2),o=Math.pow(r,2),n=1-this.es*Math.pow(s,2),s=c*Math.sqrt(n)/this.k0,i=l-(n*=i)*(l=Math.pow(s,2))/(1-this.es)*.5*(1-l/12*(5+3*r-9*u*r+u-4*a-l/30*(61+90*r-252*u*r+45*o+46*u-l/56*(1385+3633*r+4095*o+1574*o*r)))),g(this.long0+s*(1-l/6*(1+2*r+u-l/20*(5+28*r+24*o+8*u*r+6*u-l/42*(61+662*r+1320*o+720*o*r))))/t)):(i=j*h(f),0)):(s=.5*((a=Math.exp(c/this.k0))-1/a),u=this.lat0+f/this.k0,l=Math.cos(u),n=Math.sqrt((1-Math.pow(l,2))/(1+Math.pow(s,2))),i=Math.asin(n),f<0&&(i=-i),0==s&&0===l?0:g(Math.atan2(s,l)+this.long0)),e.x=o,e.y=i,e},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Ve={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),e=e/(2-e),t=e,e=(this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+-2854/675*e))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+4642/4725*e))))-2),this.cgb[1]=(t*=e)*(7/3+e*(e*(-227/45+e*(2704/315+2323/945*e))-1.6)),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+-1522/945*e)))),this.cgb[2]=(t*=e)*(56/15+e*(-136/35+e*(-1262/105+73814/2835*e))),this.cbg[2]=t*(-26/15+e*(34/21+e*(1.6+-12686/2835*e))),this.cgb[3]=(t*=e)*(4279/630+e*(-332/35+-399572/14175*e)),this.cbg[3]=t*(1237/630+e*(-24832/14175*e-2.4)),this.cgb[4]=(t*=e)*(4174/315+-144838/6237*e),this.cbg[4]=t*(-734/315+109598/31185*e),this.cgb[5]=601676/22275*(t*=e),this.cbg[5]=444337/155925*t,t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(.25+t*(1/64+t/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+-96199/604800*e))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+7891/37800*e))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+1118711/3870720*e)))),this.gtu[1]=t*(13/48+e*(e*(557/1440+e*(281/630+-1983433/1935360*e))-.6)),this.utg[2]=(t*=e)*(-17/480+e*(37/840+e*(209/4480+-5569/90720*e))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+167603/181440*e))),this.utg[3]=(t*=e)*(-4397/161280+e*(11/504+830251/7257600*e)),this.gtu[3]=t*(49561/161280+e*(-179/168+6601661/7257600*e)),this.utg[4]=(t*=e)*(-4583/161280+108847/3991680*e),this.gtu[4]=t*(34729/80640+-3418889/1995840*e),this.utg[5]=-.03233083094085698*(t*=e),this.gtu[5]=.6650675310896665*t,fe(this.cbg,this.lat0));this.Zb=-this.Qn*(e+function(e,t){for(var r,n=2*Math.cos(t),i=e.length-1,o=e[i],a=0;0<=--i;)r=n*o-a+e[i],a=o,o=r;return Math.sin(t)*r}(this.gtu,2*e))},forward:function(e){var t,r=g(e.x-this.long0),n=e.y,n=fe(this.cbg,n),i=Math.sin(n),o=Math.cos(n),a=Math.sin(r),s=Math.cos(r),a=(n=Math.atan2(i,s*o),r=Math.atan2(a*o,le(i,o*s)),r=ce(Math.tan(r)),he(this.gtu,2*n,2*r));return n+=a[0],r+=a[1],i=Math.abs(r)<=2.623395162778?(t=this.a*(this.Qn*r)+this.x0,this.a*(this.Qn*n+this.Zb)+this.y0):t=1/0,e.x=t,e.y=i,e},inverse:function(e){var t,r,n,i,o=(e.x-this.x0)*(1/this.a),a=(e.y-this.y0)*(1/this.a);return a=(a-this.Zb)/this.Qn,o/=this.Qn,i=Math.abs(o)<=2.623395162778?(a+=(n=he(this.utg,2*a,2*o))[0],o+=n[1],o=Math.atan(ue(o)),n=Math.sin(a),t=Math.cos(a),i=Math.sin(o),r=Math.cos(o),a=Math.atan2(n*r,le(i,r*t)),o=Math.atan2(i,r*t),n=g(o+this.long0),fe(this.cgb,a)):n=1/0,e.x=n,e.y=i,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},He={init:function(){var e=function(e,t){if(void 0===e){if((e=Math.floor(30*(g(t)+Math.PI)/Math.PI)+1)<0)return 0;if(60<e)return 60}return e}(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*P,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Ve.init.apply(this),this.forward=Ve.forward,this.inverse=Ve.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},qe={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+E)/(Math.pow(Math.tan(.5*this.lat0+E),this.C)*pe(this.e*e,this.ratexp))},forward:function(e){var t=e.x,r=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+E),this.C)*pe(this.e*Math.sin(r),this.ratexp))-j,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,r=e.y,n=Math.pow(Math.tan(.5*r+E)/this.K,1/this.C),i=20;0<i&&(r=2*Math.atan(n*pe(this.e*Math.sin(e.y),-.5*this.e))-j,!(Math.abs(r-e.y)<1e-14));--i)e.y=r;return i?(e.x=t,e.y=r,e):null},names:["gauss"]},Ye={init:function(){qe.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,r,n,i;return e.x=g(e.x-this.long0),qe.forward.apply(this,[e]),t=Math.sin(e.y),r=Math.cos(e.y),n=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*r*n),e.x=i*r*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*r*n),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,r,n,i;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,i=(i=Math.sqrt(e.x*e.x+e.y*e.y))?(r=2*Math.atan2(i,this.R2),t=Math.sin(r),r=Math.cos(r),n=Math.asin(r*this.sinc0+e.y*t*this.cosc0/i),Math.atan2(e.x*t,i*this.cosc0*r-e.y*this.sinc0*t)):(n=this.phic0,0),e.x=i,e.y=n,qe.inverse.apply(this,[e]),e.x=g(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Xe={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=O&&(this.k0=.5*(1+h(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=O&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=O&&(this.k0=.5*this.cons*s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/u(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=s(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-j,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var t,r,n=e.x,i=e.y,o=Math.sin(i),a=Math.cos(i),s=g(n-this.long0);return Math.abs(Math.abs(n-this.long0)-Math.PI)<=O&&Math.abs(i+this.lat0)<=O?(e.x=NaN,e.y=NaN):this.sphere?(t=2*this.k0/(1+this.sinlat0*o+this.coslat0*a*Math.cos(s)),e.x=this.a*t*a*Math.sin(s)+this.x0,e.y=this.a*t*(this.coslat0*o-this.sinlat0*a*Math.cos(s))+this.y0):(a=2*Math.atan(this.ssfn_(i,o,this.e))-j,r=Math.cos(a),a=Math.sin(a),Math.abs(this.coslat0)<=O?(i=u(this.e,i*this.con,this.con*o),o=2*this.a*this.k0*i/this.cons,e.x=this.x0+o*Math.sin(n-this.long0),e.y=this.y0-this.con*o*Math.cos(n-this.long0)):(Math.abs(this.sinlat0)<O?(t=2*this.a*this.k0/(1+r*Math.cos(s)),e.y=t*a):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*r*Math.cos(s))),e.y=t*(this.cosX0*a-this.sinX0*r*Math.cos(s))+this.y0),e.x=t*r*Math.sin(s)+this.x0)),e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,n,i,o=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere)r=2*Math.atan(o/(2*this.a*this.k0)),n=this.long0,i=this.lat0,o<=O||(i=Math.asin(Math.cos(r)*this.sinlat0+e.y*Math.sin(r)*this.coslat0/o),n=g(Math.abs(this.coslat0)<O?0<this.lat0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y):this.long0+Math.atan2(e.x*Math.sin(r),o*this.coslat0*Math.cos(r)-e.y*this.sinlat0*Math.sin(r))));else if(Math.abs(this.coslat0)<=O){if(o<=O)return i=this.lat0,n=this.long0,e.x=n,e.y=i,e;e.x*=this.con,e.y*=this.con,r=o*this.cons/(2*this.a*this.k0),i=this.con*c(this.e,r),n=this.con*g(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),n=this.long0,o<=O?t=this.X0:(t=Math.asin(Math.cos(r)*this.sinX0+e.y*Math.sin(r)*this.cosX0/o),n=g(this.long0+Math.atan2(e.x*Math.sin(r),o*this.cosX0*Math.cos(r)-e.y*this.sinX0*Math.sin(r)))),i=-1*c(this.e,Math.tan(.5*(j+t)));return e.x=n,e.y=i,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,t,r){return t*=r,Math.tan(.5*(j+e))*Math.pow((1-t)/(1+t),.5*r)}},Ze={init:function(){var e=this.lat0,t=(this.lambda0=this.long0,Math.sin(e)),r=this.a,n=1/this.rf,n=2*n-Math.pow(n,2),i=this.e=Math.sqrt(n),r=(this.R=this.k0*r*Math.sqrt(1-n)/(1-n*Math.pow(t,2)),this.alpha=Math.sqrt(1+n/(1-n)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha),Math.log(Math.tan(Math.PI/4+this.b0/2))),n=Math.log(Math.tan(Math.PI/4+e/2)),e=Math.log((1+i*t)/(1-i*t));this.K=r-this.alpha*n+this.alpha*i/2*e},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),t=-this.alpha*(t+r)+this.K,r=2*(Math.atan(Math.exp(t))-Math.PI/4),t=this.alpha*(e.x-this.lambda0),n=Math.atan(Math.sin(t)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(t))),r=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(t));return e.y=this.R/2*Math.log((1+Math.sin(r))/(1-Math.sin(r)))+this.y0,e.x=this.R*n+this.x0,e},inverse:function(e){for(var t,r=e.x-this.x0,n=e.y-this.y0,r=r/this.R,n=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),i=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(r)),r=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(n))),n=this.lambda0+r/this.alpha,o=i,a=-1e3,s=0;1e-7<Math.abs(o-a);){if(20<++s)return;t=1/this.alpha*(Math.log(Math.tan(Math.PI/4+i/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(o))/2)),a=o,o=2*Math.atan(Math.exp(t))-Math.PI/2}return e.x=n,e.y=o,e},names:["somerc"]},Ke={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e,t,r,n,i=Math.sin(this.lat0),o=Math.cos(this.lat0),a=this.e*i,i=(this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(o,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-a*a),u(this.e,this.lat0,i)),o=this.bl/o*Math.sqrt((1-this.es)/(1-a*a));o*o<1&&(o=1),isNaN(this.longc)?(a=u(this.e,this.lat1,Math.sin(this.lat1)),r=u(this.e,this.lat2,Math.sin(this.lat2)),0<=this.lat0?this.el=(o+Math.sqrt(o*o-1))*Math.pow(i,this.bl):this.el=(o-Math.sqrt(o*o-1))*Math.pow(i,this.bl),a=Math.pow(a,this.bl),r=Math.pow(r,this.bl),t=.5*((e=this.el/a)-1/e),n=(this.el*this.el-r*a)/(this.el*this.el+r*a),r=(r-a)/(r+a),a=g(this.long1-this.long2),this.long0=.5*(this.long1+this.long2)-Math.atan(n*Math.tan(.5*this.bl*a)/r)/this.bl,this.long0=g(this.long0),n=g(this.long1-this.long0),this.gamma0=Math.atan(Math.sin(this.bl*n)/t),this.alpha=Math.asin(o*Math.sin(this.gamma0))):(e=0<=this.lat0?o+Math.sqrt(o*o-1):o-Math.sqrt(o*o-1),this.el=e*Math.pow(i,this.bl),t=.5*(e-1/e),this.gamma0=Math.asin(Math.sin(this.alpha)/o),this.long0=this.longc-Math.asin(t*Math.tan(this.gamma0))/this.bl),this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha))},forward:function(e){var t,r,n,i=e.x,o=e.y,i=g(i-this.long0);return o=Math.abs(Math.abs(o)-j)<=O?(t=0<o?-1:1,n=this.al/this.bl*Math.log(Math.tan(E+t*this.gamma0*.5)),-1*t*j*this.al/this.bl):(t=u(this.e,o,Math.sin(o)),t=.5*((o=this.el/Math.pow(t,this.bl))-1/o),o=.5*(o+1/o),r=Math.sin(this.bl*i),o=(t*Math.sin(this.gamma0)-r*Math.cos(this.gamma0))/o,n=Math.abs(Math.abs(o)-1)<=O?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-o)/(1+o))/this.bl,Math.abs(Math.cos(this.bl*i))<=O?this.al*this.bl*i:this.al*Math.atan2(t*Math.cos(this.gamma0)+r*Math.sin(this.gamma0),Math.cos(this.bl*i))/this.bl),this.no_rot?(e.x=this.x0+o,e.y=this.y0+n):(o-=this.uc,e.x=this.x0+n*Math.cos(this.alpha)+o*Math.sin(this.alpha),e.y=this.y0+o*Math.cos(this.alpha)-n*Math.sin(this.alpha)),e},inverse:function(e){this.no_rot?(r=e.y-this.y0,t=e.x-this.x0):(r=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var t,r=Math.exp(-1*this.bl*r/this.al),n=.5*(r-1/r),r=.5*(r+1/r),i=Math.sin(this.bl*t/this.al),r=(i*Math.cos(this.gamma0)+n*Math.sin(this.gamma0))/r,o=Math.pow(this.el/Math.sqrt((1+r)/(1-r)),1/this.bl);return Math.abs(r-1)<O?(e.x=this.long0,e.y=j):Math.abs(1+r)<O?(e.x=this.long0,e.y=-1*j):(e.y=c(this.e,o),e.x=g(this.long0-Math.atan2(n*Math.cos(this.gamma0)-i*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},$e={init:function(){var e,t,r,n,i,o;this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,Math.abs(this.lat1+this.lat2)<O||(e=this.b/this.a,this.e=Math.sqrt(1-e*e),e=Math.sin(this.lat1),t=Math.cos(this.lat1),t=s(this.e,e,t),r=u(this.e,this.lat1,e),i=Math.sin(this.lat2),n=Math.cos(this.lat2),n=s(this.e,i,n),i=u(this.e,this.lat2,i),o=u(this.e,this.lat0,Math.sin(this.lat0)),Math.abs(this.lat1-this.lat2)>O?this.ns=Math.log(t/n)/Math.log(r/i):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=t/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(o,this.ns),this.title)||(this.title="Lambert Conformal Conic")},forward:function(e){var t=e.x,r=e.y;Math.abs(2*Math.abs(r)-Math.PI)<=O&&(r=h(r)*(j-2*O));var n,i=Math.abs(Math.abs(r)-j);if(O<i)i=u(this.e,r,Math.sin(r)),n=this.a*this.f0*Math.pow(i,this.ns);else{if(r*this.ns<=0)return null;n=0}i=this.ns*g(t-this.long0);return e.x=this.k0*(n*Math.sin(i))+this.x0,e.y=this.k0*(this.rh-n*Math.cos(i))+this.y0,e},inverse:function(e){var t,r,n=(e.x-this.x0)/this.k0,i=this.rh-(e.y-this.y0)/this.k0,o=0<this.ns?(t=Math.sqrt(n*n+i*i),1):(t=-Math.sqrt(n*n+i*i),-1),a=0;if(0!==t&&(a=Math.atan2(o*n,o*i)),0!==t||0<this.ns){if(o=1/this.ns,n=Math.pow(t/(this.a*this.f0),o),-9999===(r=c(this.e,n)))return null}else r=-j;return i=g(a/this.ns+this.long0),e.x=i,e.y=r,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Je={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t=e.x,r=e.y,t=g(t-this.long0),n=Math.pow((1+this.e*Math.sin(r))/(1-this.e*Math.sin(r)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(r/2+this.s45),this.alfa)/n)-this.s45),n=-t*this.alfa,t=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),r=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(t)),n=this.n*r,r=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(t/2+this.s45),this.n);return e.y=r*Math.cos(n),e.x=r*Math.sin(n),this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){for(var t,r,n,i,o=e.x,a=(e.x=e.y,e.y=o,this.czech||(e.y*=-1,e.x*=-1),o=Math.sqrt(e.x*e.x+e.y*e.y),r=Math.atan2(e.y,e.x)/Math.sin(this.s0),o=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(o)-Math.sin(this.ad)*Math.cos(o)*Math.cos(r)),o=Math.asin(Math.cos(o)*Math.sin(r)/Math.cos(t)),e.x=this.long0-o/this.alfa,n=t,i=0);e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(n))/(1-this.e*Math.sin(n)),this.e/2))-this.s45),Math.abs(n-e.y)<1e-10&&(i=1),n=e.y,a+=1,0===i&&a<15;);return 15<=a?null:e},names:["Krovak","krovak"]},Qe={init:function(){this.sphere||(this.e0=p(this.es),this.e1=v(this.es),this.e2=de(this.es),this.e3=ye(this.es),this.ml0=this.a*m(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t,r,n,i,o,a,s=e.x,u=e.y,s=g(s-this.long0);return u=this.sphere?(a=this.a*Math.asin(Math.cos(u)*Math.sin(s)),this.a*(Math.atan2(Math.tan(u),Math.cos(s))-this.lat0)):(t=Math.sin(u),r=Math.cos(u),n=b(this.a,this.e,t),i=Math.tan(u)*Math.tan(u),a=n*(s=s*Math.cos(u))*(1-(s=s*s)*i*(1/6-(8-i+8*(o=this.es*r*r/(1-this.es)))*s/120)),this.a*m(this.e0,this.e1,this.e2,this.e3,u)-this.ml0+n*t/r*s*(.5+(5-i+6*o)*s/24)),e.x=a+this.x0,e.y=u+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,r=e.y/this.a;if(this.sphere)var n=r+this.lat0,i=Math.asin(Math.sin(n)*Math.cos(t)),n=Math.atan2(Math.tan(t),Math.cos(n));else{var o=this.ml0/this.a+r,o=ge(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-j)<=O)return e.x=this.long0,e.y=j,r<0&&(e.y*=-1),e;var r=b(this.a,this.e,Math.sin(o)),a=r*r*r/this.a/this.a*(1-this.es),s=Math.pow(Math.tan(o),2),t=t*this.a/r,u=t*t;i=o-r*Math.tan(o)/a*t*t*(.5-(1+3*s)*t*t/24),n=t*(1-u*(s/3+(1+3*s)*s*u/15))/Math.cos(o)}return e.x=g(n+this.long0),e.y=f(i),e},names:["Cassini","Cassini_Soldner","cass"]},et={init:function(){var e,t,r,n=Math.abs(this.lat0);if(Math.abs(n-j)<O?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<O?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es)switch(this.qp=_(this.e,1),this.mmf=.5/(1-this.es),this.apa=(n=this.es,(r=[])[0]=.3333333333333333*n,r[0]+=.17222222222222222*(t=n*n),r[1]=.06388888888888888*t,r[0]+=.10257936507936508*(t*=n),r[1]+=.0664021164021164*t,r[2]=.016415012942191543*t,r),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=_(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t,r,n,i,o,a,s,u,l,c,f=e.x,h=e.y,f=g(f-this.long0);if(this.sphere){if(o=Math.sin(h),c=Math.cos(h),n=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((r=this.mode===this.EQUIT?1+c*n:1+this.sinph0*o+this.cosph0*c*n)<=O)return null;t=(r=Math.sqrt(2/r))*c*Math.sin(f),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(h+this.lat0)<O)return null;r=E-.5*h,t=(r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)))*Math.sin(f),r*=n}}else{switch(l=u=s=0,n=Math.cos(f),i=Math.sin(f),o=Math.sin(h),a=_(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(s=a/this.qp,u=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:l=1+this.sinb1*s+this.cosb1*u*n;break;case this.EQUIT:l=1+u*n;break;case this.N_POLE:l=j+h,a=this.qp-a;break;case this.S_POLE:l=h-j,a=this.qp+a}if(Math.abs(l)<O)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),r=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*s-this.sinb1*u*n):(l=Math.sqrt(2/(1+u*n)))*s*this.ymf,t=this.xmf*l*u*i;break;case this.N_POLE:case this.S_POLE:0<=a?(t=(l=Math.sqrt(a))*i,r=n*(this.mode===this.S_POLE?l:-l)):t=r=0}}return e.x=this.a*t+this.x0,e.y=this.a*r+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,n,i,o,a,s,u=e.x/this.a,l=e.y/this.a;if(this.sphere){var c=0,f=0,h=Math.sqrt(u*u+l*l);if(1<(r=.5*h))return null;switch(r=2*Math.asin(r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(f=Math.sin(r),c=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(h)<=O?0:Math.asin(l*f/h),u*=f,l=c*h;break;case this.OBLIQ:r=Math.abs(h)<=O?this.lat0:Math.asin(c*this.sinph0+l*f*this.cosph0/h),u*=f*this.cosph0,l=(c-Math.sin(r)*this.sinph0)*h;break;case this.N_POLE:l=-l,r=j-r;break;case this.S_POLE:r-=j}t=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,l):0}else{if(i=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,l*=this.dd,(a=Math.sqrt(u*u+l*l))<O)return e.x=this.long0,e.y=this.lat0,e;o=2*Math.asin(.5*a/this.rq),s=Math.cos(o),u*=o=Math.sin(o),l=this.mode===this.OBLIQ?(i=s*this.sinb1+l*o*this.cosb1/a,n=this.qp*i,a*this.cosb1*s-l*this.sinb1*o):(n=this.qp*(i=l*o/a),a*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(!(n=u*u+(l=this.mode===this.N_POLE?-l:l)*l))return e.x=this.long0,e.y=this.lat0,e;i=1-n/this.qp,this.mode===this.S_POLE&&(i=-i)}t=Math.atan2(u,l),o=Math.asin(i),a=this.apa,s=o+o,r=o+a[0]*Math.sin(s)+a[1]*Math.sin(s+s)+a[2]*Math.sin(s+s+s)}return e.x=g(this.long0+t),e.y=r,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},tt={init:function(){Math.abs(this.lat1+this.lat2)<O||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=s(this.e3,this.sin_po,this.cos_po),this.qs1=_(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=s(this.e3,this.sin_po,this.cos_po),this.qs2=_(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=_(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>O?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,r=e.y,r=(this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r),_(this.e3,this.sin_phi,this.cos_phi)),r=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,t=this.ns0*g(t-this.long0),n=r*Math.sin(t)+this.x0,r=this.rh-r*Math.cos(t)+this.y0;return e.x=n,e.y=r,e},inverse:function(e){var t,r,n;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,n=0<=this.ns0?(r=Math.sqrt(e.x*e.x+e.y*e.y),1):(r=-Math.sqrt(e.x*e.x+e.y*e.y),-1),(t=0)!==r&&(t=Math.atan2(n*e.x,n*e.y)),n=r*this.ns0/this.a,n=this.sphere?Math.asin((this.c-n*n)/(2*this.ns0)):(r=(this.c-n*n)/this.ns0,this.phi1z(this.e3,r)),r=g(t/this.ns0+this.long0),e.x=r,e.y=n,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,t){var r,n,i,o=w(.5*t);if(e<O)return o;for(var a=e*e,s=1;s<=25;s++)if(o+=i=.5*(n=1-(r=e*(i=Math.sin(o)))*r)*n/Math.cos(o)*(t/(1-a)-i/n+.5/e*Math.log((1-r)/(1+r))),Math.abs(i)<=1e-7)return o;return null}},rt={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,r=e.x,n=e.y,r=g(r-this.long0),i=Math.sin(n),n=Math.cos(n),o=Math.cos(r),a=0<(a=this.sin_p14*i+this.cos_p14*n*o)||Math.abs(a)<=O?(t=this.x0+ +this.a*n*Math.sin(r)/a,this.y0+ +this.a*(this.cos_p14*i-this.sin_p14*n*o)/a):(t=this.x0+this.infinity_dist*n*Math.sin(r),this.y0+this.infinity_dist*(this.cos_p14*i-this.sin_p14*n*o));return e.x=t,e.y=a,e},inverse:function(e){var t,r,n,i;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,n=(t=Math.sqrt(e.x*e.x+e.y*e.y))?(n=Math.atan2(t,this.rc),r=Math.sin(n),n=Math.cos(n),i=w(n*this.sin_p14+e.y*r*this.cos_p14/t),n=Math.atan2(e.x*r,t*this.cos_p14*n-e.y*this.sin_p14*r),g(this.long0+n)):(i=this.phic0,0),e.x=n,e.y=i,e},names:["gnom"]},nt={init:function(){this.sphere||(this.k0=s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t,r=e.x,n=e.y,r=g(r-this.long0);return r=this.sphere?(t=this.x0+this.a*r*Math.cos(this.lat_ts),this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts)):(n=_(this.e,Math.sin(n)),t=this.x0+this.a*this.k0*r,this.y0+this.a*n*.5/this.k0),e.x=t,e.y=r,e},inverse:function(e){var t,r;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=g(this.long0+e.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(r=function(e,t){var r=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-r)<1e-6)return t<0?-1*j:j;for(var n,i,o,a=Math.asin(.5*t),s=0;s<30;s++)if(n=Math.sin(a),i=Math.cos(a),o=e*n,a+=i=Math.pow(1-o*o,2)/(2*i)*(t/(1-e*e)-n/(1-o*o)+.5/e*Math.log((1-o)/(1+o))),Math.abs(i)<=1e-10)return a;return NaN}(this.e,2*e.y*this.k0/this.a),t=g(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=r,e},names:["cea"]},it={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,r=e.y,t=g(t-this.long0),r=f(r-this.lat0);return e.x=this.x0+this.a*t*this.rc,e.y=this.y0+this.a*r,e},inverse:function(e){var t=e.x,r=e.y;return e.x=g(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=f(this.lat0+(r-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},ot={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=p(this.es),this.e1=v(this.es),this.e2=de(this.es),this.e3=ye(this.es),this.ml0=this.a*m(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,r=e.x,n=e.y,r=g(r-this.long0),i=r*Math.sin(n);return n=this.sphere?Math.abs(n)<=O?(t=this.a*r,-1*this.a*this.lat0):(t=this.a*Math.sin(i)/Math.tan(n),this.a*(f(n-this.lat0)+(1-Math.cos(i))/Math.tan(n))):Math.abs(n)<=O?(t=this.a*r,-1*this.ml0):(t=(r=b(this.a,this.e,Math.sin(n))/Math.tan(n))*Math.sin(i),this.a*m(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+r*(1-Math.cos(i))),e.x=t+this.x0,e.y=n+this.y0,e},inverse:function(e){var t,r,n,i,o,a,s=e.x-this.x0,u=e.y-this.y0;if(this.sphere)if(Math.abs(u+this.a*this.lat0)<=O)t=g(s/this.a+this.long0),r=0;else{for(var l,c=this.lat0+u/this.a,f=s*s/this.a/this.a+c*c,h=c,p=20;p;--p)if(h+=n=-1*(c*(h*(l=Math.tan(h))+1)-h-.5*(h*h+f)*l)/((h-c)/l-1),Math.abs(n)<=O){r=h;break}t=g(this.long0+Math.asin(s*Math.tan(h)/this.a)/Math.sin(r))}else if(Math.abs(u+this.ml0)<=O)r=0,t=g(this.long0+s/this.a);else{for(c=(this.ml0+u)/this.a,f=s*s/this.a/this.a+c*c,h=c,p=20;p;--p)if(a=this.e*Math.sin(h),i=Math.sqrt(1-a*a)*Math.tan(h),a=this.a*m(this.e0,this.e1,this.e2,this.e3,h),o=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=n=(c*(i*(a=a/this.a)+1)-a-.5*i*(a*a+f))/(this.es*Math.sin(2*h)*(a*a+f-2*c*a)/(4*i)+(c-a)*(i*o-2/Math.sin(2*h))-o),Math.abs(n)<=O){r=h;break}i=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),t=g(this.long0+Math.asin(s*i/this.a)/Math.sin(r))}return e.x=t,e.y=r,e},names:["Polyconic","poly"]},at={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){for(var t=e.x,r=e.y-this.lat0,t=t-this.long0,n=r/_e*1e-5,r=t,i=1,o=0,a=1;a<=10;a++)o+=this.A[a]*(i*=n);var s,u=o,l=r,c=1,f=0,h=0,p=0;for(a=1;a<=6;a++)s=f*u+c*l,h=h+this.B_re[a]*(c=c*u-f*l)-this.B_im[a]*(f=s),p=p+this.B_im[a]*c+this.B_re[a]*f;return e.x=p*this.a+this.x0,e.y=h*this.a+this.y0,e},inverse:function(e){var t,r=e.x,n=e.y,r=r-this.x0,i=(n-this.y0)/this.a,o=r/this.a,a=1,s=0,u=0,l=0;for(g=1;g<=6;g++)t=s*i+a*o,u=u+this.C_re[g]*(a=a*i-s*o)-this.C_im[g]*(s=t),l=l+this.C_im[g]*a+this.C_re[g]*s;for(var c=0;c<this.iterations;c++){for(var f,h=u,p=l,d=i,y=o,g=2;g<=6;g++)f=p*u+h*l,h=h*u-p*l,p=f,d+=(g-1)*(this.B_re[g]*h-this.B_im[g]*p),y+=(g-1)*(this.B_im[g]*h+this.B_re[g]*p);var h=1,p=0,m=this.B_re[1],v=this.B_im[1];for(g=2;g<=6;g++)f=p*u+h*l,h=h*u-p*l,p=f,m+=g*(this.B_re[g]*h-this.B_im[g]*p),v+=g*(this.B_im[g]*h+this.B_re[g]*p);var b=m*m+v*v,u=(d*m+y*v)/b,l=(y*m-d*v)/b}var _=u,n=l,w=1,x=0;for(g=1;g<=9;g++)x+=this.D[g]*(w*=_);r=this.lat0+x*_e*1e5,n=this.long0+n;return e.x=n,e.y=r,e},names:["New_Zealand_Map_Grid","nzmg"]},st={init:function(){},forward:function(e){var t=e.x,r=e.y,t=g(t-this.long0),t=this.x0+this.a*t,r=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return e.x=t,e.y=r,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=g(this.long0+e.x/this.a),r=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=r,e},names:["Miller_Cylindrical","mill"]},ut={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=oe(this.es)},forward:function(e){var t=e.x,r=e.y,t=g(t-this.long0);if(this.sphere){if(this.m)for(var n=this.n*Math.sin(r),i=20;i;--i){var o=(this.m*r+Math.sin(r)-n)/(this.m+Math.cos(r));if(r-=o,Math.abs(o)<O)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;l=this.a*this.C_x*t*(this.m+Math.cos(r)),u=this.a*this.C_y*r}else var a=Math.sin(r),s=Math.cos(r),u=this.a*ae(r,a,s,this.en),l=this.a*t*s/Math.sqrt(1-this.es*a*a);return e.x=l,e.y=u,e},inverse:function(e){var t,r,n,i;return e.x-=this.x0,n=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,n/=this.C_x*(this.m+Math.cos(t)),this.m?t=w((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=w(Math.sin(t)/this.n)),n=g(n+this.long0),t=f(t)):(t=se(e.y/this.a,this.es,this.en),(i=Math.abs(t))<j?(i=Math.sin(t),r=this.long0+e.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(t)),n=g(r)):i-O<j&&(n=this.long0)),e.x=n,e.y=t,e},names:["Sinusoidal","sinu"]},lt={init:function(){},forward:function(e){for(var t=e.x,r=e.y,t=g(t-this.long0),n=r,i=Math.PI*Math.sin(r);;){var o=-(n+Math.sin(n)-i)/(1+Math.cos(n));if(n+=o,Math.abs(o)<O)break}n/=2,Math.PI/2-Math.abs(r)<O&&(t=0);r=.900316316158*this.a*t*Math.cos(n)+this.x0,t=1.4142135623731*this.a*Math.sin(n)+this.y0;return e.x=r,e.y=t,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0,t=e.y/(1.4142135623731*this.a),.999999999999<Math.abs(t)&&(t=.999999999999),n=Math.asin(t);var t,r=g(this.long0+e.x/(.900316316158*this.a*Math.cos(n))),n=((r=r<-Math.PI?-Math.PI:r)>Math.PI&&(r=Math.PI),t=(2*n+Math.sin(2*n))/Math.PI,1<Math.abs(t)&&(t=1),Math.asin(t));return e.x=r,e.y=n,e},names:["Mollweide","moll"]},ct={init:function(){Math.abs(this.lat1+this.lat2)<O||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=p(this.es),this.e1=v(this.es),this.e2=de(this.es),this.e3=ye(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=s(this.e,this.sinphi,this.cosphi),this.ml1=m(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<O?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=s(this.e,this.sinphi,this.cosphi),this.ml2=m(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=m(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t=e.x,r=e.y,t=(r=this.sphere?this.a*(this.g-r):(r=m(this.e0,this.e1,this.e2,this.e3,r),this.a*(this.g-r)),this.ns*g(t-this.long0)),n=this.x0+r*Math.sin(t),r=this.y0+this.rh-r*Math.cos(t);return e.x=n,e.y=r,e},inverse:function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0,r=0<=this.ns?(t=Math.sqrt(e.x*e.x+e.y*e.y),1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),-1);var t,r,n,i,o=0;return(0!==t&&(o=Math.atan2(r*e.x,r*e.y)),this.sphere)?(i=g(this.long0+o/this.ns),n=f(this.g-t/this.a),e.x=i,e.y=n):(r=this.g-t/this.a,n=ge(r,this.e0,this.e1,this.e2,this.e3),i=g(this.long0+o/this.ns),e.x=i,e.y=n),e},names:["Equidistant_Conic","eqdc"]},ft={init:function(){this.R=this.a},forward:function(e){var t,r=e.x,n=e.y,r=g(r-this.long0),i=(Math.abs(n)<=O&&(t=this.x0+this.R*r,c=this.y0),w(2*Math.abs(n/Math.PI))),o=((Math.abs(r)<=O||Math.abs(Math.abs(n)-j)<=O)&&(t=this.x0,c=0<=n?this.y0+Math.PI*this.R*Math.tan(.5*i):this.y0+Math.PI*this.R*-Math.tan(.5*i)),.5*Math.abs(Math.PI/r-r/Math.PI)),a=o*o,s=Math.sin(i),i=Math.cos(i),i=i/(s+i-1),s=i*(2/s-1),u=s*s,l=Math.PI*this.R*(o*(i-u)+Math.sqrt(a*(i-u)*(i-u)-(u+a)*(i*i-u)))/(u+a),r=(t=this.x0+(l=r<0?-l:l),a+i),l=Math.PI*this.R*(s*r-o*Math.sqrt((u+a)*(1+a)-r*r))/(u+a),c=0<=n?this.y0+l:this.y0-l;return e.x=t,e.y=c,e},inverse:function(e){var t,r,n,i,o,a,s;return e.x-=this.x0,e.y-=this.y0,s=Math.PI*this.R,n=(t=e.x/s)*t+(r=e.y/s)*r,s=3*(r*r/(o=-2*(a=-Math.abs(r)*(1+n))+1+2*r*r+n*n)+(2*(i=a-2*r*r+t*t)*i*i/o/o/o-9*a*i/o/o)/27)/(a=(a-i*i/3/o)/o)/(a=2*Math.sqrt(-a/3)),1<Math.abs(s)&&(s=0<=s?1:-1),s=Math.acos(s)/3,a=0<=e.y?(-a*Math.cos(s+Math.PI/3)-i/3/o)*Math.PI:-(-a*Math.cos(s+Math.PI/3)-i/3/o)*Math.PI,s=Math.abs(t)<O?this.long0:g(this.long0+Math.PI*(n-1+Math.sqrt(1+2*(t*t-r*r)+n*n))/2/t),e.x=s,e.y=a,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},ht={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,r,n,i,o,a,s,u=e.x,l=e.y,c=Math.sin(e.y),f=Math.cos(e.y),u=g(u-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=O?(e.x=this.x0+this.a*(j-l)*Math.sin(u),e.y=this.y0-this.a*(j-l)*Math.cos(u)):Math.abs(this.sin_p12+1)<=O?(e.x=this.x0+this.a*(j+l)*Math.sin(u),e.y=this.y0+this.a*(j+l)*Math.cos(u)):(i=this.sin_p12*c+this.cos_p12*f*Math.cos(u),a=(i=Math.acos(i))?i/Math.sin(i):1,e.x=this.x0+this.a*a*f*Math.sin(u),e.y=this.y0+this.a*a*(this.cos_p12*c-this.sin_p12*f*Math.cos(u))):(a=p(this.es),t=v(this.es),n=de(this.es),s=ye(this.es),Math.abs(this.sin_p12-1)<=O?(o=this.a*m(a,t,n,s,j),r=this.a*m(a,t,n,s,l),e.x=this.x0+(o-r)*Math.sin(u),e.y=this.y0-(o-r)*Math.cos(u)):Math.abs(this.sin_p12+1)<=O?(o=this.a*m(a,t,n,s,j),r=this.a*m(a,t,n,s,l),e.x=this.x0+(o+r)*Math.sin(u),e.y=this.y0+(o+r)*Math.cos(u)):(a=c/f,t=b(this.a,this.e,this.sin_p12),n=b(this.a,this.e,c),s=Math.atan((1-this.es)*a+this.es*t*this.sin_p12/(n*f)),o=0===(l=Math.atan2(Math.sin(u),this.cos_p12*Math.tan(s)-this.sin_p12*Math.cos(u)))?Math.asin(this.cos_p12*Math.sin(s)-this.sin_p12*Math.cos(s)):Math.abs(Math.abs(l)-Math.PI)<=O?-Math.asin(this.cos_p12*Math.sin(s)-this.sin_p12*Math.cos(s)):Math.asin(Math.sin(u)*Math.cos(s)/Math.sin(l)),r=this.e*this.sin_p12/Math.sqrt(1-this.es),c=this.e*this.cos_p12*Math.cos(l)/Math.sqrt(1-this.es),e.x=this.x0+(i=t*o*(1-(a=o*o)*(n=c*c)*(1-n)/6+(f=a*o)/8*(u=r*c)*(1-2*n)+(s=f*o)/120*(n*(4-7*n)-3*r*r*(1-7*n))-s*o/48*u))*Math.sin(l),e.y=this.y0+i*Math.cos(l))),e},inverse:function(e){var t,r,n,i,o,a,s,u;return e.x-=this.x0,e.y-=this.y0,this.sphere?(u=Math.sqrt(e.x*e.x+e.y*e.y))>2*j*this.a?void 0:(i=u/this.a,s=Math.sin(i),i=Math.cos(i),t=this.long0,Math.abs(u)<=O?r=this.lat0:(r=w(i*this.sin_p12+e.y*s*this.cos_p12/u),a=Math.abs(this.lat0)-j,t=g(Math.abs(a)<=O?0<=this.lat0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y):this.long0+Math.atan2(e.x*s,u*this.cos_p12*i-e.y*this.sin_p12*s))),e.x=t,e.y=r,e):(a=p(this.es),i=v(this.es),s=de(this.es),o=ye(this.es),Math.abs(this.sin_p12-1)<=O?(n=this.a*m(a,i,s,o,j),u=Math.sqrt(e.x*e.x+e.y*e.y),r=ge((n-u)/this.a,a,i,s,o),t=g(this.long0+Math.atan2(e.x,-1*e.y))):Math.abs(this.sin_p12+1)<=O?(n=this.a*m(a,i,s,o,j),u=Math.sqrt(e.x*e.x+e.y*e.y),r=ge((u-n)/this.a,a,i,s,o),t=g(this.long0+Math.atan2(e.x,e.y))):(u=Math.sqrt(e.x*e.x+e.y*e.y),n=Math.atan2(e.x,e.y),a=b(this.a,this.e,this.sin_p12),i=Math.cos(n),o=-(s=this.e*this.cos_p12*i)*s/(1-this.es),s=3*this.es*(1-o)*this.sin_p12*this.cos_p12*i/(1-this.es),s=1-o*(a=(u=u/a)-o*(1+o)*Math.pow(u,3)/6-s*(1+3*o)*Math.pow(u,4)/24)*a/2-u*a*a*a/6,o=Math.asin(this.sin_p12*Math.cos(a)+this.cos_p12*Math.sin(a)*i),t=g(this.long0+Math.asin(Math.sin(n)*Math.sin(a)/Math.cos(o))),u=Math.sin(o),r=Math.atan2((u-this.es*s*this.sin_p12)*Math.tan(o),u*(1-this.es))),e.x=t,e.y=r,e)},names:["Azimuthal_Equidistant","aeqd"]},pt={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,r,n,i=e.x,o=e.y,i=g(i-this.long0),a=Math.sin(o),o=Math.cos(o),s=Math.cos(i);return(0<(t=this.sin_p14*a+this.cos_p14*o*s)||Math.abs(t)<=O)&&(r=+this.a*o*Math.sin(i),n=this.y0+ +this.a*(this.cos_p14*a-this.sin_p14*o*s)),e.x=r,e.y=n,e},inverse:function(e){var t,r,n,i,o,a;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),n=w(t/this.a),r=Math.sin(n),n=Math.cos(n),o=this.long0,Math.abs(t)<=O?a=this.lat0:(a=w(n*this.sin_p14+e.y*r*this.cos_p14/t),i=Math.abs(this.lat0)-j,o=Math.abs(i)<=O?g(0<=this.lat0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y)):g(this.long0+Math.atan2(e.x*r,t*this.cos_p14*n-e.y*this.sin_p14*r))),e.x=o,e.y=a,e},names:["ortho"]},dt=1,yt=2,gt=3,mt=4,vt=5,bt=6,A=1,L=2,D=3,F=4,_t={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=j-E/2?this.face=vt:this.lat0<=-(j-E/2)?this.face=bt:Math.abs(this.long0)<=E?this.face=dt:Math.abs(this.long0)<=j+E?this.face=0<this.long0?yt:mt:this.face=gt,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var t,r,n,i,o,a,s={x:0,y:0},u={value:0};return e.x-=this.long0,o=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,n=e.x,this.face===vt?(r=j-o,t=E<=n&&n<=j+E?(u.value=A,n-j):j+E<n||n<=-(j+E)?(u.value=L,0<n?n-T:n+T):-(j+E)<n&&n<=-E?(u.value=D,n+j):(u.value=F,n)):this.face===bt?(r=j+o,t=E<=n&&n<=j+E?(u.value=A,-n+j):n<E&&-E<=n?(u.value=L,-n):n<-E&&-(j+E)<=n?(u.value=D,-n-j):(u.value=F,0<n?T-n:-n-T)):(this.face===yt?n=l(n,+j):this.face===gt?n=l(n,T):this.face===mt&&(n=l(n,-j)),i=Math.sin(o),o=Math.cos(o),a=Math.sin(n),n=o*Math.cos(n),o=o*a,a=i,this.face===dt?t=Q(r=Math.acos(n),a,o,u):this.face===yt?t=Q(r=Math.acos(o),a,-n,u):this.face===gt?t=Q(r=Math.acos(-n),a,-o,u):this.face===mt?t=Q(r=Math.acos(-o),a,n,u):(r=t=0,u.value=A)),i=Math.atan(12/T*(t+Math.acos(Math.sin(t)*Math.cos(E))-j)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(i)*Math.cos(i))/(1-Math.cos(Math.atan(1/Math.cos(t))))),u.value===L?i+=j:u.value===D?i+=T:u.value===F&&(i+=1.5*T),s.x=o*Math.cos(i),s.y=o*Math.sin(i),s.x=s.x*this.a+this.x0,s.y=s.y*this.a+this.y0,e.x=s.x,e.y=s.y,e},inverse:function(e){var t,r,n,i,o,a={lam:0,phi:0},s={value:0};return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,n=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),t=Math.atan2(e.y,e.x),0<=e.x&&e.x>=Math.abs(e.y)?s.value=A:0<=e.y&&e.y>=Math.abs(e.x)?(s.value=L,t-=j):e.x<0&&-e.x>=Math.abs(e.y)?(s.value=D,t=t<0?t+T:t-T):(s.value=F,t+=j),o=T/12*Math.tan(t),i=Math.sin(o)/(Math.cos(o)-1/Math.sqrt(2)),i=Math.atan(i),(n=1-(t=Math.cos(t))*t*(t=Math.tan(n))*t*(1-Math.cos(Math.atan(1/Math.cos(i)))))<-1?n=-1:1<n&&(n=1),this.face===vt?(r=Math.acos(n),a.phi=j-r,a.lam=s.value===A?i+j:s.value===L?i<0?i+T:i-T:s.value===D?i-j:i):this.face===bt?(r=Math.acos(n),a.phi=r-j,a.lam=s.value===A?-i+j:s.value===L?-i:s.value===D?-i-j:i<0?-i-T:T-i):(o=(t=n)*t,n=1<=(o+=(r=1<=o?0:Math.sqrt(1-o)*Math.sin(i))*r)?0:Math.sqrt(1-o),s.value===L?(o=n,n=-r,r=o):s.value===D?(n=-n,r=-r):s.value===F&&(o=n,n=r,r=-o),this.face===yt?(o=t,t=-n,n=o):this.face===gt?(t=-t,n=-n):this.face===mt&&(o=t,t=n,n=-o),a.phi=Math.acos(-r)-j,a.lam=Math.atan2(n,t),this.face===yt?a.lam=l(a.lam,-j):this.face===gt?a.lam=l(a.lam,-T):this.face===mt&&(a.lam=l(a.lam,+j))),0!==this.es&&(i=a.phi<0?1:0,s=Math.tan(a.phi),o=this.b/Math.sqrt(s*s+this.one_minus_f_squared),a.phi=Math.atan(Math.sqrt(this.a*this.a-o*o)/(this.one_minus_f*o)),i)&&(a.phi=-a.phi),a.lam+=this.long0,e.x=a.lam,e.y=a.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},wt=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],xt=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],St=k/5,jt=1/St,Ot={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=g(e.x-this.long0),r=Math.abs(e.y),n=Math.floor(r*St),t=(n<0?n=0:18<=n&&(n=17),{x:me(wt[n],r=k*(r-jt*n))*t,y:me(xt[n],r)});return e.y<0&&(t.y=-t.y),t.x=t.x*this.a*.8487+this.x0,t.y=t.y*this.a*1.3523+this.y0,t},inverse:function(e){var t={x:(e.x-this.x0)/(.8487*this.a),y:Math.abs(e.y-this.y0)/(1.3523*this.a)};if(1<=t.y)t.x/=wt[18][0],t.y=e.y<0?-j:j;else{var r=Math.floor(18*t.y);for(r<0?r=0:18<=r&&(r=17);;)if(xt[r][0]>t.y)--r;else{if(!(xt[r+1][0]<=t.y))break;++r}var n=xt[r],i=function(e,t,r,n){for(var i=t;n;--n){var o=e(i);if(i-=o,Math.abs(o)<r)break}return i}(function(e){return(me(n,e)-t.y)/(n[1]+e*(2*n[2]+3*e*n[3]))},5*(t.y-n[0])/(xt[r+1][0]-n[0]),O,100);t.x/=me(wt[r],i),t.y=(5*r+i)*P,e.y<0&&(t.y=-t.y)}return t.x=g(t.x+this.long0),t},names:["Robinson","robin"]},Pt={init:function(){this.name="geocent"},forward:function(e){return B(e,this.es,this.a)},inverse:function(e){return G(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};return e.defaultDatum="WGS84",e.Proj=y,e.WGS84=new e.Proj("WGS84"),e.Point=a,e.toPoint=ne,e.defs=o,e.transform=W,e.mgrs=t,e.version="2.6.2",(t=e).Proj.projections.add(We),t.Proj.projections.add(Ve),t.Proj.projections.add(He),t.Proj.projections.add(Ye),t.Proj.projections.add(Xe),t.Proj.projections.add(Ze),t.Proj.projections.add(Ke),t.Proj.projections.add($e),t.Proj.projections.add(Je),t.Proj.projections.add(Qe),t.Proj.projections.add(et),t.Proj.projections.add(tt),t.Proj.projections.add(rt),t.Proj.projections.add(nt),t.Proj.projections.add(it),t.Proj.projections.add(ot),t.Proj.projections.add(at),t.Proj.projections.add(st),t.Proj.projections.add(ut),t.Proj.projections.add(lt),t.Proj.projections.add(ct),t.Proj.projections.add(ft),t.Proj.projections.add(ht),t.Proj.projections.add(pt),t.Proj.projections.add(_t),t.Proj.projections.add(Ot),t.Proj.projections.add(Pt),e}),!function(m,v,n,o){"use strict";var b="INPUT ERROR ON LINE ";function i(e){return e=+e.toString().replace(/\,/gi,"."),isNaN(e)?0:e}function t(){return o.utils.newDeferred.apply(this,arguments)}function a(e){return 0<=e?Math.floor((e+180)/6)+1:Math.floor(e/6)+31}function s(e){return 0<=e?"n":"s"}function r(e){var t;switch(e){case"m":t=1;break;case"km":t=1e3;break;case"us-ft":t=.304800609601219;break;default:t=1e3}return t}function u(e,t){return i(e)*r(t)}m.widget("twcc.converterSet",{options:{units:{dms:{D:"°",M:"'",S:"''"},dd:{x:{DD:"°E"},y:{DD:"°N"}},cartesian:{XY:{m:"m",km:"km","us-ft":"ft"},CONVERGENCE:"°"}},labels:{spherical:{x:"Lng = ",y:"Lat = ",convergence:"Conv. = "},cartesian:{x:"X = ",y:"Y = ",z:"Zone = ",h:"Hemisphere = ",convergence:"Conv. = "},csv:{csv:"CSV : ",l:"Format : "}},options:{x:{E:"East",W:"West"},y:{N:"North",S:"South"},o:{_DMS:"Deg. min. sec.",_DM:"Deg. min.",_DD:"Decimal deg."},h:{n:"North",s:"South"},u:{_M:"Meters",_KM:"Kilometers",_F:"Feet"}},value:{x:0,y:0},wgs84:[],defaultWgs84:[{x:0,y:0}],selections:{},definitions:{},url:"",$containers:[],masterLoadingToggleSwitch:!1,csv:!1},_create:function(){var e,t=this;if(this._bindEvents(),this._historyManager=n.getInstance(o),e=this._historyManager.getCurrentValue(),!this.options.wgs84)if(e){var r=/UD\d+/gi;if(1<e.wgs84.length)this.options.wgs84=e.wgs84,t.options.csv=!0;else{if("array"!==m.type(e.wgs84))throw"Wrong data type";this.options.wgs84=e.wgs84}this.options.selections.source=r.test(e.sc)?"WGS84":e.sc,this.options.selections.destination=r.test(e.dc)?"WGS84":e.dc}else this.options.wgs84=this.options.defaultWgs84;this.options.$containers=this.element.find(".converter-container"),this.options.$containers.each(function(e){m(this).converter({units:t.options.units,labels:t.options.labels,options:t.options.options,csv:t.options.csv,target:e?"dest":"source",selection:t.options.selections[e?"destination":"source"],value:t.options.value,wgs84:t.options.wgs84})}),this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this._reload().progress(function(e){t._trigger(".notify",null,e)}).done(function(){t._reloadSucceeded.apply(t,arguments),t._trigger(".done",null,{wgs84:t.wgs84(),csv:t.csv(),selections:t.options.selections}),t.setConvergence()}).fail(function(){t._reloadFailed.apply(t,arguments)})},_bindEvents:function(){var r=this;this.element.on("converter.transform",function(e,t){r.transform(t)}),this.element.on("converter.source.wgs84_changed converterset.done ",function(e,t){t={wgs84:t.wgs84,convergenceInDegrees:r._convergence(),srsCode:r._selection(),magneticDeclinationInDegrees:(t=t.wgs84,o.utils.getWMM()(t[0].y,t[0].x).dec)};r._addToHistory(t),r._triggerWgs84Changed(e,t)}),this.element.on("converter.source.selection_changed converter.dest.selection_changed ",function(e,t){t={wgs84:t.wgs84,srsCode:r._selection()};r._addToHistory(t),r._triggerConvergenceChange()}),this.element.on("converter.source.convergence_changed converter.dest.convergence_changed ",function(){r._triggerConvergenceChange()}),this.element.find(".history").click(function(){m(this).hasClass("next")?r._historyManager.moveToNext():r._historyManager.moveToPrevious(),r._restoreFromHistory()})},_triggerWgs84Changed:function(e,t){this._trigger(".wgs84_changed",e,t)},_triggerConvergenceChange:function(){this._trigger(".convergence_changed",null,{convergenceInDegrees:this._convergence()})},_reloadSucceeded:function(){this._loadDefinitionsObject(),this.options.masterLoadingToggleSwitch=!1,this._toggleLoading()},_reloadFailed:function(e){this._trigger(".fail",null,e)},_reload:function(){var e=this,n=t("Reload");return this._toggleLoading(!0),this._loadDefinitions().always(function(){e._toggleLoading(!1)}).done(function(){var r={};e.options.definitions.WGS84&&(e.options.definitions={"*World":e.options.definitions}),m.each(e.options.definitions,function(e,t){m.extend(r,t)}),n.resolve()}).fail(function(e,t){n.reject(t)}),n.promise()},_loadDefinitions:function(){var n=this,i=t("Load definitions");return"object"!==m.type(this.options.definitions)?i.reject("Wrong definitions type"):m.isEmptyObject(this.options.definitions)?m.ajax({url:this.options.url,data:{u:"u"},type:"POST",cache:!1,dataType:"json"}).done(function(e,t,r){void 0!==e.error?i.reject("Server Error",[r,t,e]):(n.options.definitions=e,i.resolve())}).fail(function(e,t,r){i.reject("Server Error",arguments)}):i.resolve(),i.promise()},_loadDefinitionsObject:function(){this._pushPullAll("loadDefinitionsObject",this.options.definitions)},_toggleLoading:function(e){e=this.options.masterLoadingToggleSwitch||!!e,this._pushPullAll("toggleLoading",e)},_addToHistory:function(e){this._historyManager.isEnabled()&&this._historyManager.add({wgs84:e.wgs84,sc:e.srsCode.source,dc:e.srsCode.destination})},_restoreFromHistory:function(){var t=this,r=this._historyManager.getCurrentValue();this._underTheRadar(function(){var e=1<r.wgs84.length;t.csv()!==e&&t.csv(e),t.transform(r),t.pushPullSource("selection",r.sc),t.pushPullDestination("selection",r.dc)})},_underTheRadar:function(e){if("function"!==m.type(e))throw"Invalid function";this._historyManager.toggle(!1),e(),this._historyManager.toggle(!0)},_pushPullWithCriterion:function(e,t,r,n){var i=null,o=this;return this.options.$containers.each(function(){m(this).converter("option",r)===n&&(i=o._pushPullOne(e,t,m(this)))}),i},_pushPullOne:function(e,t,r){r=void 0===t?r.converter(e):r.converter(e,t);return this.options.hasOwnProperty(e)&&(this.options[e]=r),r},pushPullSource:function(e,t){return this._pushPullWithCriterion(e,t,"target","source")},pushPullDestination:function(e,t){return this._pushPullWithCriterion(e,t,"target","dest")},_pushPullAll:function(e,t){var r=this;return this.options.$containers.each(function(){r._pushPullOne(e,t,m(this))}),this.options[e]},_pullAll:function(e){return{source:this.pushPullSource(e),destination:this.pushPullDestination(e)}},wgs84:function(e){return this._pushPullAll("wgs84",e)},toggle:function(e){return this._pushPullAll("toggle",e)},_getFirstWgs84:function(){var e=null,t=this.wgs84();return m.each(t,function(){return!!this.error||(e=this,!1)}),e||{x:0,y:0}},_convergence:function(){return this._pullAll("convergence")},_selection:function(){return this.options.selections=this._pullAll("selection"),this.options.selections},setConvergence:function(){this._pushPullAll("setConvergence")},readOnly:function(){return this.options.readOnly},csv:function(e){var t;return e!=this.options.csv&&void 0!==e&&(e||(t=[this._getFirstWgs84()],JSON.stringify(t[0])===JSON.stringify(this.wgs84()[0])?this.wgs84(t):this.transform({wgs84:t})),this._trigger(".csv_changed",null,{csv:e})),this._pushPullAll("csv",e)},unloadCRS:function(e){this._pushPullAll("unloadCRS",e)},removeEmptyOptgroups:function(){this._pushPullAll("removeEmptyOptgroups")},mergeDefinitions:function(e){var t=this,r=new m.Deferred;return this.options.masterLoadingToggleSwitch=!0,this._toggleLoading(),this.options.definitions="object"!==m.type(this.options.definitions)?{}:this.options.definitions,m.extend(!0,this.options.definitions,e),this._reload().progress(function(){r.notify("Reloading")}).done(function(){t._reloadSucceeded.apply(t,arguments),r.resolve()}).fail(function(){t._reloadFailed.apply(t,arguments),r.reject.apply(null,arguments)}),r.promise()},transform:function(e){var t,r=e.hasOwnProperty("wgs84");if(!(r&&"array"===m.type(e.wgs84)||e.hasOwnProperty("target")))throw"Wrong data format";r?this._pushPullAll("transform",e):"source"===e.target?(t=this.pushPullSource("transform",{input:null}),this.pushPullDestination("transform",{wgs84:t})):(t=this.pushPullDestination("transform",{input:null}),this.pushPullSource("transform",{wgs84:t}))},_setOption:function(e,t){return this._superApply(arguments)},_destroy:function(){return this._toggleLoading(!0),this._pushPullAll("destroy"),this._super()}}),m.widget("twcc.converter",{options:{readOnly:!1,wrapper:{fieldSet:["<div>"],title:["<h3>"],info:["<a>",{name:"info",href:"#"}]},projections:{},units:{},labels:{},options:{},angleUnit:"dd",lengthUnit:"m",convergence:null,hint:"",wgs84:[{x:0,y:0}],value:{x:0,y:0},selection:null,mapping:{aea:"cartesian",aeqd:"cartesian",cass:"cartesian",cea:"cartesian",csv:"csv",eqc:"cartesian",eqdc:"cartesian",equi:"cartesian",gauss:"cartesian",geocent:"cartesian",gnom:"cartesian",gstmerc:"cartesian",laea:"cartesian",lcc:"cartesian",longlat:"spherical",merc:"cartesian",mill:"cartesian",moll:"cartesian",nzmg:"cartesian",omerc:"cartesian",ortho:"cartesian",poly:"cartesian",sinu:"cartesian",somerc:"cartesian",stere:"cartesian",sterea:"cartesian",tmerc:"cartesian",utm:"utm",vandg:"spherical",connector:"connector"},$select:null,$container:null,csv:!1},_widget:void 0,_create:function(){m.extend(this.options,{$select:this.element.find("select.crs-list"),$container:this.element.find(".container")}),this._bindEvents(),this._unload()},_triggerTransform:function(e){e.preventDefault(),this._trigger(".transform",e,{target:this.options.target})},_bindEvents:function(){var r=this;this.options.$select.on("change",function(){r.selection()}),this.element.on("angleswitchgeofield.update_display",function(e,t){r.options.angleUnit=t.value,r.value(),r.updateContainer()}),this.element.find(".convert-button").click(function(e){r._triggerTransform(e)}),this.element.on("keyup","input, select",function(e){var t;((t=e).keyCode||t.which)==o.constants.keyboard.RETURN&&r._triggerTransform(e)})},_getFieldSetUnit:function(e){var e=this._getWidgetPrefix(e),t=this._getFieldSetUnitName(e);return t||(e=e.match(/([A-Z]?[a-z]*)/g),t=this._getFieldSetUnitName(e[1]))?this.options.units[t]:void 0},_getFieldSetUnitName:function(e){var t;switch(e){case"utm":t="cartesian";break;case"Dm":t="dms";break;case"csv":case"connector":break;default:t=e.toLowerCase()}if(t&&this.options.units.hasOwnProperty(t))return t},_getFieldSetLabel:function(e){var e=this._getWidgetPrefix(e),t=this._getFieldSetLabelName(e);return t||(e=e.match(/([A-Z]?[a-z]*)/g),t=this._getFieldSetLabelName(e[0]))?this.options.labels[t]:void 0},_getFieldSetLabelName:function(e){var t;switch(e){case"utm":t="cartesian";break;case"connector":break;default:t=e.toLowerCase()}if(t&&this.options.labels.hasOwnProperty(t))return t},_getWidgetMidfix:function(e){var t="";return t="spherical"===e?(t=this.options.angleUnit).charAt(0).toUpperCase()+t.substr(1).toLowerCase():t},_getWidgetPrefix:function(e){return e=this.options.projections[this.options.selection].isConnector&&"csv"!==e?"connector":e,(e=this.options.mapping.hasOwnProperty(e)?this.options.mapping[e]:(console.error("Projection not found: "+e),"cartesian"))+this._getWidgetMidfix(e)},_getWidgetName:function(e){return this._getWidgetPrefix(e)+"FieldSet"},_unload:function(){this.element.find("select.crs-list, .container").empty(),this.projections={}},toggleLoading:function(e){this.element.find(".container").toggle(!e),this.element.find(".loading").toggle(!!e)},removeEmptyOptgroups:function(){this.options.$select.find("optgroup:empty").remove()},loadDefinitionsObject:function(e){var n,i=this,t=this.options.$select;if(this.options.definitions=e,this.removeEmptyOptgroups(),n=!1,m.each(this.options.definitions,function(r,e){m.each(e,function(e,t){i.options.$select.has('optgroup[label="'+r+'"] option[value="'+e+'"]').length||(o.utils.addOptionToSelect(r,e,i.options.$select,t.def),n=!0)})}),n){t.sortGrpsNOptionsByText();try{this.selection(this.options.selection||t.find("option:first").val())}catch(e){this.selection(t.find("option:first").val())}}},unloadCRS:function(r){var e,n=this;this.selection()===r&&(e=this._widget.options.srsCode,this.selection(e)),this.options.$select.find('option[value="'+r.toString()+'"]').remove(),v.defs(r,void 0),delete this.options.projections[r],m.each(this.options.definitions,function(e,t){return!t.hasOwnProperty(r)||(delete n.options.definitions[e][r],!1)}),this.removeEmptyOptgroups()},updateContainer:function(){var t,e,r,n,i,o,a,s,u,l=this,c=this.selection();this.options.value=this.options.csv||"array"!==m.type(this.options.value)?this.options.value:this.options.value[0],this.options.value=this.options.csv&&"array"!==m.type(this.options.value)?[this.options.value]:this.options.value,c&&(this.options.projections.hasOwnProperty(c)||this._registerProjection(c),e=(t=this._getProjection(c)).projName,a=this._getFieldSetUnit(e)||"",r=this._getFieldSetLabel(e)||"",n={srsCode:c,target:this.options.target,convergence:this.options.convergence,wgs84:this.options.wgs84,value:this.options.value,units:a,labels:r,lengthUnit:this.options.lengthUnit,options:this.options.options,readOnly:this.options.readOnly},s=t.title||c,i=this._getWidgetName(this.options.csv?"csv":t.projName),o=m.apply(null,this.options.wrapper.fieldSet),this.options.$container.empty(),(u=m.apply(null,this.options.wrapper.title)).append(s),(s=m.apply(null,this.options.wrapper.info)).click(function(e){l._trigger(".info",e,{srsCode:c,definitionString:t.defData})}),s.text(" [?]"),u.append(s),o.append(u),"csvFieldSet"==i&&(a=a.D?this.options.units.dd:a,s=(("utm"===e?r.h+","+r.z+",":"")+(r.x?r.x+(a.x?"("+a.x.DD+")":"("+a.XY.m+")"):"")+(r.y?","+r.y+(a.y?"("+a.y.DD+")":"("+a.XY.m+")"):"")).replace(/[\s]*=[\s]*/gi,""),m.extend(n,{originalProjection:t.isConnector?"connector":e,hint:s,units:null,labels:this.options.labels.csv})),this._widget=o[i](n).data("twcc"+((u=i).charAt(0).toUpperCase()+u.substring(1))),this.options.$container.append(o))},_registerProjection:function(e){var t,r,n,i;v.defs(e)||(t=0<=e.indexOf("Connector"),r=e,n=this.options.definitions,i="",m.each(n,function(e,t){return!t.hasOwnProperty(r)||(i=t[r].def,!1)}),t={defData:n=i,isConnector:t},v.defs(e,n),m.extend(v.defs(e),t)),n=m.extend({},v.defs(e)),this._setProjection(e,n)},_getProjection:function(e){if(this.options.projections.hasOwnProperty(e))return this.options.projections[e];throw"Unknown srsCode"},_setProjection:function(e,t){this.options.projections[e]=t},selection:function(e){var t=this.options.$select,r=!1,n=this.options.selection;if(void 0!==e){this.options.selection=e;try{t.val(this.options.selection)}catch(e){}r=!0}else t.val()&&t.val()!=this.options.selection&&(this.options.selection=t.val(),r=!0);return r&&(this.updateContainer(),e=this.options.selection,t=this.wgs84(),this.transform({wgs84:t}),this.setConvergence(),n!==e)&&this._trigger("."+this.options.target+".selection_changed",null,{wgs84:t,srsCode:e}),this.options.selection},projection:function(){return this._getProjection(this.selection())},_pushPull:function(e,t){return this._widget?(t=this._widget[e](t),this.options.hasOwnProperty(e)&&(this.options[e]=t),t):null},value:function(e){if(void 0!==e&&(!this.options.csv&&"object"!==m.type(e)||this.options.csv&&"array"!==m.type(e)))throw"Invalid type";return this._pushPull("value",e)},wgs84:function(e){return void 0!==e&&JSON.stringify(this.options.wgs84)!==JSON.stringify(e)&&(this._pushPull("wgs84",e),this._trigger("."+this.options.target+".wgs84_changed",null,{wgs84:e}),this.setConvergence()),this.options.wgs84},convergence:function(e){return this._pushPull("convergence",e),void 0!==e&&(e=this.wgs84(),this._trigger("."+this.options.target+".convergence_changed",null,{wgs84:e})),this.options.convergence},setConvergence:function(){var e,t,r,n,i;this._widget&&"null"!==m.type(this._widget.convergence())&&(n=this.wgs84()[0],t=new v.Proj(this.projection().defData),r=!this._widget.zone&&t.long0||null,e=t.a,t=t.b,n=n,r=(r=r)||o.utils.degToRad(6*a(n.x)-183),i=o.utils.degToRad(n.y),n=o.utils.degToRad(n.x),e=(t=(e-t)/e)*Math.pow(Math.cos(i),2)/(1-t),t=n-r,n=Math.sin(i),r=(1+3*e+2*Math.pow(e,2))*Math.sin(i)*Math.pow(Math.cos(i),2)/3,e=(2-Math.pow(Math.tan(i),2))*Math.sin(i)*Math.pow(Math.cos(i),4)/15,i=t*n+Math.pow(t,3)*r+Math.pow(t,5)*e,n=o.utils.radToDeg(i*=-1),this.convergence(n))},csv:function(e){return void 0!==e&&(this.value(),this.options.csv=!!e,this.updateContainer()),this.options.csv},hint:function(e){return this._pushPull("hint",e)},toggle:function(e){return this._pushPull("toggle",e)},readOnly:function(){return this.options.readOnly},_formatCoordinates:function(e){if(m.inArray(m.type(e),["array","object"])<0)throw"Wrong data type";return"array"===m.type(e)?e:[e]},_setupInputProjection:function(e,t,r,n){r=r?{z:a(t.x),h:s(t.y)}:n,t=e.defData;return t=(t=t.replace(/\+zone=[^\s]+/gi,"+zone="+r.z)).replace("+south",""),t+="s"===r.h?" +south":"",new v.Proj(t)},_isValidPoint:function(e,t){var r=1,r=(r&="object"===m.type(e))&e.hasOwnProperty("x");return t?r&=e.x.indexOf(b)<0:r=(r=(r&=e.hasOwnProperty("y"))&("number"===m.type(e.x)&&!isNaN(e.x)))&("number"===m.type(e.y)&&!isNaN(e.y)),!!r},_getConnector:function(){var e=this.selection();return window.hasOwnProperty(e)||m.ajax({url:"/js/connectors/"+e+".js",async:!1,cache:!0,dataType:"script"}),window[e].getInstance(o.context)},transform:function(e){var t,l,c,f=this,h=[],p=[],d=e.hasOwnProperty("wgs84"),y=this.value(),r=v.WGS84,g=this.projection(),n=-1<g.defData.indexOf("+proj=utm"),i={type:"pivot",getProjection:function(){return m.extend({isConnector:r.isConnector},new v.Proj(r.defData))}},o={type:"input",getProjection:function(){return n?f._setupInputProjection.apply(f,arguments):m.extend({isConnector:g.isConnector},new v.Proj(g.defData))}};if(!d&&!e.hasOwnProperty("input"))throw"Wrong data format";this.toggleLoading(!0);var e=d?e.wgs84:e.input;return d&&e&&this.wgs84(e),d?(t=e||this.wgs84(),c={A:i,B:o}):(t=e||y,c={A:o,B:i},l=this._widget.options.originalProjection),e=this._formatCoordinates(t),m.each(e,function(e,t){var r,n={},i=f.wgs84()[e],o="array"===m.type(y)?y[e]:y,a=c.A.getProjection(g,i,d,o),o=c.B.getProjection(g,i,d,o),s="connector"===l||!d&&a.isConnector,u=d&&o.isConnector,u=s||u;!f._isValidPoint(t,s)||d&&i.error?(p.push({x:0,y:0,error:!0}),h.push(b+(e+1))):(u&&(r=f._getConnector()),u&&d?n[c.B.type]=r.forward(t):(u&&(t=r.inverse(t)),n[c.B.type]=v(a,o,m.extend({},t))),n[c.A.type]=m.extend({},t),p.push({x:n.pivot.x,y:n.pivot.y}),h.push({x:n.input.x,y:n.input.y}))}),this.csv()||(h=h[0]),d?this.value(h):this.wgs84(p),this.toggleLoading(!1),this.wgs84()},_setOption:function(e,t){return this._superApply(arguments)},_destroy:function(){return this._unload(),this._super()}}),m.widget("twcc.fieldSet",{options:{srsCode:null,value:{},units:{},target:null,wrapper:{set:["<div>",{class:"table"}],geoField:["<div>",{class:"row"}],geoCaption:["<div>",{class:"caption"}]},readOnly:!1,geoFields:{},geoFieldsIndex:0,wgs84:null},_create:function(){var e=m.apply(null,this.options.wrapper.set),t=this._getGeoFieldsOptions();this._setDefaultsGeoFieldsOptions(t),this._buildGeoFields(e,t),this._setFieldsHandlers(),this.element.append(e)},_setFieldsHandlers:function(){},_setDefaultsGeoFieldsOptions:function(r){var n=this;m.each(r,function(e,t){t={name:n.options.srsCode+"_"+n.options.target,readOnly:n.options.readOnly,unit:n.options.units,target:n.options.target,value:n.options.value[t.options.axis]};r[e].options=m.extend(t,r[e].options)})},_buildGeoField:function(e,t,r,n){var i=this.options.geoFieldsIndex++,o=0<=r.indexOf("Switch")||0<=r.indexOf("connector")?m.apply(null,this.options.wrapper.geoCaption):m.apply(null,this.options.wrapper.geoField);this.options.geoFields[i]=o[r](n),e.append(o)},_buildGeoFields:function(r,e){var n=this;m.each(e,function(e,t){n._buildGeoField(r,e,t.type,t.options)})},_getGeoFieldsOptions:function(){return{}},_getConvergenceIcon:function(){return'<img src="'+o.system.dirWsImages+"GN_"+this.options.target+'.png" alt="">'},convergence:function(){return null},hint:function(){return null},wgs84:function(e){return void 0===e?this._getWgs84():this._setWgs84(e)},_getWgs84:function(){return this.options.wgs84},_setWgs84:function(e){return this.options.wgs84=e,this.options.wgs84},value:function(e){return this.options.value=void 0===e?this._getValue():this._setValue(e),this._setToStringMethod(),this.options.value},_getValue:function(){return this.options.value},_setValue:function(e){this.options.value=e},_setToStringMethod:function(){var e=this;this.options.value.toString=function(){return e._getStringValue()}},_getStringValue:function(){return""},toggle:function(e){return e=void 0===e?this.options.readOnly:!!e,this.options.readOnly=this._toggle(e),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(e){return!e},_setOption:function(e,t){return this._superApply(arguments)},_destroy:function(){return this.element.empty(),this._super()}}),m.widget("twcc.connectorFieldSet",m.twcc.fieldSet,{options:{options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"connectorGeoField",options:{axis:"x"}}]},_getValue:function(){return{x:this.options.geoFields[0].connectorGeoField("value")}},_setValue:function(e){return{x:this.options.geoFields[0].connectorGeoField("value",e.x)}},_toggle:function(e){return this.options.geoFields[0].connectorGeoField("toggle",e)},_getStringValue:function(){return this.options.geoFields[0].connectorGeoField("value")}}),m.widget("twcc.csvFieldSet",m.twcc.fieldSet,{options:{labels:{},units:{},options:{},geoFields:{},value:[],hint:"",wgs84:[],originalProjection:null},_getGeoFieldsOptions:function(){return[{type:"csvGeoField",options:{value:this._toString(this.options.value),label:this.options.labels.csv}},{type:"labelGeoField",options:{value:this.options.hint,label:this.options.labels.l}}]},_getValue:function(){return this._fromString(this.options.geoFields[0].csvGeoField("value"))},_setValue:function(e){return this._fromString(this.options.geoFields[0].csvGeoField("value",this._toString(e)))},_fromString:function(e){var n=e.split("\n"),i=this;return m.each(n,function(e,t){var r=t.split(",");switch(i.options.originalProjection){case"utm":n[e]={h:r[0],z:+r[1],x:+r[2],y:+r[3]};break;case"connector":n[e]={x:r[0],y:r[1]};break;default:n[e]={x:+r[0],y:+r[1]}}}),n},_toString:function(e){var n=[],i=this;if("array"!==m.type(e))throw"Invalid type";return m.each(e,function(e,t){var r,e=i.wgs84()[e];e.error?n.push(t.toString()):"utm"==i.options.originalProjection?(r=t.h||s(e.y),e=t.z||a(e.x),n.push(r+","+e+","+t.x+","+t.y)):n.push(t.x+","+t.y)}),n.join("\n")},originalProjection:function(e){if(void 0===e)return this.options.originalProjection;this.options.originalProjection=e},hint:function(e){if(void 0===e)return this.options.hint=this.options.geoFields[1].labelGeoField("value"),this.options.hint;this.options.hint=e,this.options.geoFields[1].labelGeoField("value",this.options.hint)},_toggle:function(e){return this.options.geoFields[0].csvGeoField("toggle",e),this.options.geoFields[1].labelGeoField("toggle",e)},_getStringValue:function(){return this.options.hint+"\n"+this.options.geoFields[0].csvGeoField("value")}}),m.widget("twcc.utmFieldSet",m.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0,wgs84:[]},_getGeoFieldsOptions:function(){return[{type:"hemisphereGeoField",options:{label:this.options.labels.h,options:this.options.options.h,axis:"h"}},{type:"zoneGeoField",options:{label:this.options.labels.z,options:this.options.options.z,axis:"z"}},{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var r=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(e,t){r.options.lengthUnit=r.unit(t.value)})},_getValue:function(){return{h:this.hemisphere(),z:this.zone(),x:this.options.geoFields[2].xyGeoField("value"),y:this.options.geoFields[3].xyGeoField("value")}},_setValue:function(e){var t=this._getWgs84()[0];return e.h&&e.z||m.extend(e,{y:Math.abs(e.y),h:s(t.y),z:a(t.x)}),{h:this.hemisphere(e.h),z:this.zone(e.z),x:this.options.geoFields[2].xyGeoField("value",e.x),y:this.options.geoFields[3].xyGeoField("value",e.y)}},unit:function(e){return void 0===e?this.options.lengthUnit=this.options.geoFields[2].xyGeoField("unit"):(this.options.geoFields[2].xyGeoField("unit",e),this.options.geoFields[3].xyGeoField("unit",e),this.options.lengthUnit=this.options.geoFields[5].lengthSwitchGeoField("value",e)),this.options.lengthUnit},convergence:function(e){return this.options.convergence=void 0===e?this.options.geoFields[4].convergenceGeoField("value"):this.options.geoFields[4].convergenceGeoField("value",e),this.options.convergence},zone:function(e){return this.options.value.z=void 0===e?this.options.geoFields[1].zoneGeoField("value"):this.options.geoFields[1].zoneGeoField("value",e),this.options.value.z},hemisphere:function(e){return this.options.value.h=void 0===e?this.options.geoFields[0].hemisphereGeoField("value"):this.options.geoFields[0].hemisphereGeoField("value",e),this.options.value.h},_toggle:function(e){return this.options.geoFields[0].hemisphereGeoField("toggle",e),this.options.geoFields[1].zoneGeoField("toggle",e),this.options.geoFields[2].xyGeoField("toggle",e),this.options.geoFields[3].xyGeoField("toggle",e),this.options.geoFields[5].lengthSwitchGeoField("toggle",e)},_getStringValue:function(){var e=this.options.geoFields;return e[2].xyGeoField("getStringValue")+", "+e[3].xyGeoField("getStringValue")+" "+e[1].zoneGeoField("value")+e[0].hemisphereGeoField("value")}}),m.widget("twcc.cartesianFieldSet",m.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},lengthUnit:"m",value:{},convergence:0},_getGeoFieldsOptions:function(){return[{type:"xyGeoField",options:{label:this.options.labels.x,lengthUnit:this.options.lengthUnit,axis:"x"}},{type:"xyGeoField",options:{label:this.options.labels.y,lengthUnit:this.options.lengthUnit,axis:"y"}},{type:"convergenceGeoField",options:{value:this.options.convergence,label:this.options.labels.convergence,icon:this._getConvergenceIcon()}},{type:"lengthSwitchGeoField",options:{value:this.options.lengthUnit,unit:this.options.options.u}}]},_setFieldsHandlers:function(){var r=this;this._super(),this.element.on("lengthswitchgeofield.update_display",function(e,t){r.options.lengthUnit=r.unit(t.value)})},_getValue:function(){return{x:this.options.geoFields[0].xyGeoField("value"),y:this.options.geoFields[1].xyGeoField("value")}},_setValue:function(e){return{x:this.options.geoFields[0].xyGeoField("value",e.x),y:this.options.geoFields[1].xyGeoField("value",e.y)}},unit:function(e){return void 0===e?this.options.lengthUnit=this.options.geoFields[0].xyGeoField("unit"):(this.options.geoFields[0].xyGeoField("unit",e),this.options.geoFields[1].xyGeoField("unit",e),this.options.lengthUnit=this.options.geoFields[3].lengthSwitchGeoField("value",e)),this.options.lengthUnit},convergence:function(e){return this.options.convergence=void 0===e?this.options.geoFields[2].convergenceGeoField("value"):this.options.geoFields[2].convergenceGeoField("value",e),this.options.convergence},_toggle:function(e){return this.options.geoFields[0].xyGeoField("toggle",e),this.options.geoFields[1].xyGeoField("toggle",e),this.options.geoFields[3].lengthSwitchGeoField("toggle",e)},_getStringValue:function(){var e=this.options.geoFields;return e[0].xyGeoField("getStringValue")+", "+e[1].xyGeoField("getStringValue")}}),m.widget("twcc.sphericalDdFieldSet",m.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"ddGeoField",options:{unit:this.options.units.y,label:this.options.labels.y,axis:"y"}},{type:"ddGeoField",options:{unit:this.options.units.x,label:this.options.labels.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dd",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].ddGeoField("value"),y:this.options.geoFields[0].ddGeoField("value")}},_setValue:function(e){return{x:this.options.geoFields[1].ddGeoField("value",e.x),y:this.options.geoFields[0].ddGeoField("value",e.y)}},_toggle:function(e){return this.options.geoFields[0].ddGeoField("toggle",e),this.options.geoFields[1].ddGeoField("toggle",e),this.options.geoFields[2].angleSwitchGeoField("toggle",e)},_getStringValue:function(){var e=this.options.geoFields;return e[0].ddGeoField("getStringValue")+", "+e[1].ddGeoField("getStringValue")}}),m.widget("twcc.sphericalDmFieldSet",m.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dm",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmGeoField("value"),y:this.options.geoFields[0].dmGeoField("value")}},_setValue:function(e){return{x:this.options.geoFields[1].dmGeoField("value",e.x),y:this.options.geoFields[0].dmGeoField("value",e.y)}},_toggle:function(e){return this.options.geoFields[0].dmGeoField("toggle",e),this.options.geoFields[1].dmGeoField("toggle",e),this.options.geoFields[2].angleSwitchGeoField("toggle",e)},_getStringValue:function(){var e=this.options.geoFields;return e[0].dmGeoField("getStringValue")+", "+e[1].dmGeoField("getStringValue")}}),m.widget("twcc.sphericalDmsFieldSet",m.twcc.fieldSet,{options:{labels:{},options:{},geoFields:{},value:{}},_getGeoFieldsOptions:function(){return[{type:"dmsGeoField",options:{label:this.options.labels.y,options:this.options.options.y,axis:"y"}},{type:"dmsGeoField",options:{label:this.options.labels.x,options:this.options.options.x,axis:"x"}},{type:"angleSwitchGeoField",options:{value:"dms",unit:this.options.options.o}}]},_getValue:function(){return{x:this.options.geoFields[1].dmsGeoField("value"),y:this.options.geoFields[0].dmsGeoField("value")}},_setValue:function(e){return{x:this.options.geoFields[1].dmsGeoField("value",e.x),y:this.options.geoFields[0].dmsGeoField("value",e.y)}},_toggle:function(e){return this.options.geoFields[0].dmsGeoField("toggle",e),this.options.geoFields[1].dmsGeoField("toggle",e),this.options.geoFields[2].angleSwitchGeoField("toggle",e)},_getStringValue:function(){var e=this.options.geoFields;return e[0].dmsGeoField("getStringValue")+", "+e[1].dmsGeoField("getStringValue")}}),m.widget("twcc.geoField",{options:{name:null,unit:null,label:null,readOnly:!1,lengthUnit:"m",glue:"_",wrapper:{field:["<span>"],fields:["<div>",{class:"cell fields"}],label:["<div>",{class:"cell label"}],options:["<div>",{class:"fields"}]},attributes:{},fields:{},icon:""},_create:function(){var r,e,n=this;m.each(this.options.attributes,function(e){var t={disabled:n.options.readOnly,readonly:n.options.readOnly};n.options.attributes[e]=m.extend(t,n.options.attributes[e])}),r=this._getEmptyFieldCell(),e=this._getFieldsOptions(),this._setDefaultsFieldsOptions(e),m.each(e,function(e,t){t=n._buildField(e,t);n._setFieldHandlers(t),t.append(n._getFieldSetUnit(e)),t.append("&nbsp;"),r.append(t)}),this._appendLabelCell(),this.element.append(r)},_getFieldSetUnit:function(e){return this.options.unit[e]},_setFieldHandlers:function(){},_clean:function(e,t){return this._superClean(e,t)},_superClean:function(e,t){return isNaN(e)||null===e?"":o.math.round(e,t||0)},_buildField:function(e,t){return this.options.fields[e]=m.apply(null,this.options.wrapper.field).field(t),this.options.fields[e]},_appendLabelCell:function(){var e=this._getForId(),e=e?m("<label>",{for:e}).html(this.options.icon+this.options.label):this.options.icon+this.options.label,e=m.apply(null,this.options.wrapper.label).append(e);this.element.append(e)},_getForId:function(){},_getEmptyFieldCell:function(){return m.apply(null,this.options.wrapper.fields)},_getFieldsOptions:function(){return{}},_setDefaultsFieldsOptions:function(r){var n=this;m.each(r,function(e){var t={name:n.options.name+n.options.glue+e,attributes:n.options.attributes[e],value:n._clean(n.options.value)};r[e]=m.extend(t,r[e])})},value:function(e){return this.options.value=void 0===e?this._constraint(this._getRawValue()):this._setValue(this._clean(e)),this.options.value},toggle:function(e){return e=void 0===e?this.options.readOnly:!!e,this.options.readOnly=this._toggle(e),this.options.readOnly},readOnly:function(){return this.options.readOnly},_toggle:function(r){var n=this;return m.each(this.options.fields,function(e,t){e=n._getFieldsOptions()[e];n._toggleField(t,r,e)}),!r},_toggleField:function(e,t){e.field("toggle",t)},_getRawValue:function(){return this.options.value},getStringValue:function(){return this.options.value},_constraint:function(e){return e},_setValue:function(e){this.options.value=e},_setOption:function(e,t){this.options[e]=t,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),m.widget("twcc.ddGeoField",m.twcc.geoField,{options:{value:0,attributes:{DD:{size:"20",class:"width_5"}}},_getFieldsOptions:function(){return{DD:{type:"text"}}},_getForId:function(){return this.options.fields.DD.field("id")},_getRawValue:function(){return o.math.parseFloat(this.options.fields.DD.field("value"))},getStringValue:function(){return this.options.value+this._getFieldSetUnit("DD")},_setValue:function(e){return this.options.fields.DD.field("value",e)},_constraint:function(e){var t="y"===this.options.axis?180*Math.atan(Math.sinh(Math.PI))/Math.PI:180;return e=Math.max(e,-t),e=Math.min(e,t)},_clean:function(e){return this._constraint(this._super(e,15))}}),m.widget("twcc.dmGeoField",m.twcc.ddGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"6",class:"width_3"}}},_buildField:function(e,t){return"option"===t.type?(this.options.fields[e]=m.apply(null,this.options.wrapper.field).optionField(t),this.options.fields[e]):this._superApply(arguments)},_getFieldsOptions:function(){var e=this._clean(this.options.value);return{C:{type:"option",value:e.C||"",options:this.options.options},D:{type:"text",value:this._superClean(e.D)},M:{type:"text",value:this._superClean(e.M,12)}}},_getForId:function(){return this.options.fields.D.field("id")},_getFieldSetUnit:function(e){return"C"!=e?this._superApply(arguments):""},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:o.math.parseFloat(this.options.fields.D.field("value")),M:o.math.parseFloat(this.options.fields.M.field("value"))}},value:function(e){var t,r,n;return void 0===e?this._clean((void 0!==(t=this._getObjectValue())&&(r=Math.abs(i(t.D)),r+=Math.abs(i(t.M))/60,n=0<=i(t.D)?1:-1,n=(n*="N"==t.C||"E"==t.C?1:-1)*r),n)):(e=this._clean(e),this.options.fields.C.optionField("value",e.C||""),this.options.fields.D.field("value",this._superClean(e.D)),this.options.fields.M.field("value",this._superClean(e.M,12))),this.options.value},getStringValue:function(){var e=this._getObjectValue();return e.D+this._getFieldSetUnit("D")+e.M+this._getFieldSetUnit("M")+e.C},_clean:function(e){return this.options.value=this._constraint(e),e=this.options.value,t=this.options.options,"number"!==m.type(+e)||isNaN(e)?(n=r=0,t&&(i=t.N?"N":"E")):(t&&(i=0<=e?t.N?"N":"E":t.S?"S":"W"),n=60*((e=Math.abs(e))-(r=Math.floor(e)))),{C:i,D:r.toString(),M:n.toString()};var t,r,n,i},_toggleField:function(e,t,r){return"option"===r.type?e.optionField("toggle",t):this._superApply(arguments)}}),m.widget("twcc.dmsGeoField",m.twcc.dmGeoField,{options:{value:0,options:{},attributes:{C:{size:"1"},D:{size:"4",class:"width_1"},M:{size:"4",class:"width_1"},S:{size:"6",class:"width_3"}}},_getFieldsOptions:function(){var e=this._clean(this.options.value);return{C:{type:"option",value:e.C||"",options:this.options.options},D:{type:"text",value:this._superClean(e.D)},M:{type:"text",value:this._superClean(e.M)},S:{type:"text",value:this._superClean(e.S,12)}}},_getObjectValue:function(){return{C:this.options.fields.C.optionField("value"),D:o.math.parseFloat(this.options.fields.D.field("value")),M:o.math.parseFloat(this.options.fields.M.field("value")),S:o.math.parseFloat(this.options.fields.S.field("value"))}},value:function(e){var t,r,n;return void 0===e?this._clean((void 0!==(t=this._getObjectValue())&&(r=Math.abs(i(t.D)),r=(r+=Math.abs(i(t.M))/60)+Math.abs(i(t.S))/3600,n=0<=i(t.D)?1:-1,n=(n*="N"==t.C||"E"==t.C?1:-1)*r),n)):(e=this._clean(e),this.options.fields.C.optionField("value",e.C||""),this.options.fields.D.field("value",this._superClean(e.D)),this.options.fields.M.field("value",this._superClean(e.M)),this.options.fields.S.field("value",this._superClean(e.S,12))),this.options.value},getStringValue:function(){var e=this._getObjectValue();return e.D+this._getFieldSetUnit("D")+e.M+this._getFieldSetUnit("M")+e.S+this._getFieldSetUnit("S")+e.C},_clean:function(e){return this.options.value=this._constraint(e),e=this.options.value,t=this.options.options,"number"!==m.type(+e)||isNaN(e)?(i=n=r=0,t&&(o=t.N?"N":"E")):(t&&(o=0<=e?t.N?"N":"E":t.S?"S":"W"),i=60*((t=60*((e=Math.abs(e))-(r=Math.floor(e))))-(n=Math.floor(t)))),{C:o,D:r.toString(),M:n.toString(),S:i.toString()};var t,r,n,i,o}}),m.widget("twcc.switchGeoField",m.twcc.geoField,{_clean:function(e){return this._constraint(e)},_setFieldHandlers:function(e){var t=this;e.find(":first-child").click(function(e){t._trigger(".update_display",e,{value:t.value()})})},_appendLabelCell:function(){},_getEmptyFieldCell:function(){return m.apply(null,this.options.wrapper.options)},_setDefaultsFieldsOptions:function(){},_getRawValue:function(){return m("input:radio:checked",this.element).val()},_setValue:function(e){return this.element.find('input:radio[value="'+e+'"]').prop("checked",!0),e},_getForId:function(e){return this.options.fields[e].field("id")},_getFieldSetUnit:function(e){var t=this._superApply(arguments),e=this._getForId(e);return m("<label>",{for:e}).append(t)}}),m.widget("twcc.angleSwitchGeoField",m.twcc.switchGeoField,{options:{value:"dd"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var e=this.options.name+"_DMS_DM_DD",t=this.options.value,r="dd"===t,t="dm"===t;return{_DMS:{name:e,type:"radio",value:"dms",attributes:{checked:!r&&!t}},_DM:{name:e,type:"radio",value:"dm",attributes:{checked:t}},_DD:{name:e,type:"radio",value:"dd",attributes:{checked:r}}}},_constraint:function(e){return m.inArray(e,["dms","dm","dd"])<0?"dms":e}}),m.widget("twcc.lengthSwitchGeoField",m.twcc.switchGeoField,{options:{value:"m"},_getFieldsOptions:function(){this.options.value=this._clean(this.options.value);var e=this.options.name+"_M_KM_F",t=this.options.value,r="km"===t,t="us-ft"===t;return{_M:{name:e,type:"radio",value:"m",attributes:{checked:!r&&!t}},_KM:{name:e,type:"radio",value:"km",attributes:{checked:r}},_F:{name:e,type:"radio",value:"us-ft",attributes:{checked:t}}}},_constraint:function(e){return m.inArray(e,["m","km","us-ft"])<0?"m":e}}),m.widget("twcc.xyGeoField",m.twcc.geoField,{options:{value:0,attributes:{XY:{size:"20",class:"width_4"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XY:{type:"text"}}},_getForId:function(){return this.options.fields.XY.field("id")},_getFieldSetUnit:function(){return this.options.unit.XY[this.options.lengthUnit]},_getRawValue:function(){return u(this.options.fields.XY.field("value"),this.options.lengthUnit)},getStringValue:function(){return this.options.fields.XY.field("value")+this.options.lengthUnit},_setValue:function(e){return u(this.options.fields.XY.field("value",e),this.options.lengthUnit)},_clean:function(e){return this._super((t=this.options.lengthUnit,i(e)/r(t)),"m"==this.options.lengthUnit?3:5);var t},unit:function(e){return void 0!==e&&(this.value(),this.options.lengthUnit=this._cleanUnit(e),this._update()),this.options.lengthUnit},_cleanUnit:function(e){return m.inArray(e,["m","km","us-ft"])<0?"m":e}}),m.widget("twcc.zoneGeoField",m.twcc.geoField,{options:{value:31,attributes:{Z:{size:"5",class:"width_2"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{Z:{type:"text"}}},_getForId:function(){return this.options.fields.Z.field("id")},_getRawValue:function(){return parseInt(this.options.fields.Z.field("value"))},_setValue:function(e){return this.options.fields.Z.field("value",e)},_constraint:function(e){return e=Math.max(e,0)},_clean:function(e){return this._constraint(this._super(e))}}),m.widget("twcc.hemisphereGeoField",m.twcc.geoField,{options:{value:"n",attributes:{E:{size:"1"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{E:{type:"option",options:this.options.options}}},_getForId:function(){return this.options.fields.E.optionField("id")},_getFieldSetUnit:function(){},_buildField:function(e,t){return this.options.fields[e]=m.apply(null,this.options.wrapper.field).optionField(t),this.options.fields[e]},_clean:function(e){return this._constraint(e||"n")},_getRawValue:function(){return this.options.fields.E.optionField("value")},_constraint:function(e){return m.inArray(e,["n","s"])<0?"n":e},_setValue:function(e){return this.options.fields.E.optionField("value",e)},_toggleField:function(e,t){return e.optionField("toggle",t)}}),m.widget("twcc.csvGeoField",m.twcc.geoField,{options:{value:"",attributes:{CSV:{rows:"5",wrap:"off"}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CSV:{type:"textarea"}}},_getFieldSetUnit:function(){return""},_getForId:function(){return this.options.fields.CSV.textareaField("id")},_buildField:function(e,t){return this.options.fields[e]=m.apply(null,this.options.wrapper.field).textareaField(t),this.options.fields[e]},_clean:function(e){return this._constraint(e||"")},_getRawValue:function(){return this.options.fields.CSV.textareaField("value")},_setValue:function(e){return this.options.fields.CSV.textareaField("value",e)},_toggleField:function(e,t){return e.textareaField("toggle",t)}}),m.widget("twcc.convergenceGeoField",m.twcc.geoField,{options:{value:0,attributes:{CONVERGENCE:{size:"10",class:"width_4",readonly:!0}}},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{CONVERGENCE:{type:"text"}}},_getForId:function(){return this.options.fields.CONVERGENCE.field("id")},_getRawValue:function(){return this.options.fields.CONVERGENCE.field("value")},_constraint:function(e){return e=Math.max(e,-360),e=Math.min(e,360)},_setValue:function(e){return this.options.fields.CONVERGENCE.field("value",e)},_clean:function(e){return this._constraint(this._super(e,4))}}),m.widget("twcc.connectorGeoField",m.twcc.geoField,{options:{value:""},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{XX:{type:"text"}}},_appendLabelCell:function(){},_getRawValue:function(){return this.options.fields.XX.field("value")},_setValue:function(e){return this.options.fields.XX.field("value",e)},_constraint:function(e){return e},_clean:function(e){return this._constraint(e)}}),m.widget("twcc.labelGeoField",m.twcc.geoField,{options:{value:""},_create:function(){this._super(),this.options.fields.L.text(this.options.value)},_buildField:function(e,t){return this.options.fields[e]=t,this.options.fields[e]},_setFieldHandlers:function(){},_getFieldsOptions:function(){return{L:m("<span>")}},_getFieldSetUnit:function(){return""},_getRawValue:function(){return this.options.fields.L.text()},_constraint:function(e){return e},_setValue:function(e){return this.options.fields.L.text(e),e},_clean:function(e){return this._constraint(e)},_toggleField:function(){return this.options.readonly}}),m.widget("twcc.field",{options:{type:null,value:null,name:null,glue:"_id_",attributes:{},readOnly:!1},_create:function(){this.options.attributes=m.extend({val:this.options.value,id:this.options.name+this.options.glue+Math.floor(10001*Math.random()),name:this.options.name,disabled:this.options.readOnly,readonly:this.options.readOnly},this.options.attributes),this._setTag()},_setTag:function(){m.extend(this.options.attributes,{type:this.options.type}),this.element.tag({name:"input",attributes:this.options.attributes})},value:function(e){return this.options.value=void 0===e?this.element.tag("value"):this.element.tag("value",e),this.options.value},toggle:function(e){return e=void 0===e?this.options.readOnly:!!e,this.options.readOnly=this._toggle(e),this.options.readOnly},_toggle:function(e){return this.element.tag("toggle",e)},readOnly:function(){return this.options.readOnly},id:function(){return this.options.attributes.id},_setOption:function(e,t){this.options[e]=t,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this.element.empty(),this._super()}}),m.widget("twcc.textareaField",m.twcc.field,{options:{type:"textarea"},_setTag:function(){this.element.tag({name:"textarea",attributes:this.options.attributes})}}),m.widget("twcc.optionField",m.twcc.field,{options:{type:"option",options:{}},_setTag:function(){this.element.selectTag({attributes:this.options.attributes,options:this.options.options})},value:function(e){return this.options.value=void 0===e?this.element.selectTag("value"):this.element.selectTag("value",e),this.options.value},_toggle:function(e){return this.element.selectTag("toggle",e)}}),m.widget("twcc.tag",{options:{name:null,attributes:{},readOnly:!1},_$elt:null,_create:function(){var e;this.options.attributes.val&&(this.options.attributes.val=this._clean(this.options.attributes.val)),this.options.attributes.hasOwnProperty("checked")&&(e=this.options.attributes.checked,delete this.options.attributes.checked),this._$elt=m("<"+this.options.name+">",this.options.attributes),void 0!==e&&this._$elt.prop("checked",e),this._appendChildren(),this.value(this.options.attributes.val),this.element.append(this._$elt)},value:function(e){return void 0===e?this.options.attributes.val=this._$elt.val():(this.options.attributes.val=this._clean(e),this._$elt.val(this.options.attributes.val)),this.options.attributes.val},toggle:function(e){e=void 0===e?this.options.readOnly:!e;return this.options.readOnly=this._toggle(e),this.options.readOnly},_toggle:function(e){return this._$elt.prop("disabled",e).prop("readonly",e),e},readOnly:function(){return this.options.readOnly},_clean:function(e){return e="number"==typeof e&&1<e.toString().split("e").length?o.math.round(e):e},_appendChildren:function(){},_setOption:function(e,t){this.options[e]=t,this._update()},_update:function(){this._destroy(),this._create()},_destroy:function(){return this._$elt.remove(),this._super()}}),m.widget("twcc.selectTag",m.twcc.tag,{options:{name:"select",options:{}},_$elt:null,_appendChildren:function(){var r=this;m.each(this.options.options,function(e,t){r._$elt.append(m("<option>",{value:e,text:t}))})}})}(jQuery,proj4,TWCCHistory,App),!function n(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return s(i[t][1][e]||e)},r,r.exports,n,i,o,a)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){"use strict";var X,Z,n,i,K=e("ol"),$=e("ol/proj/proj4.js"),J=e("ol/layer.js"),Q=e("ol/source"),ee=o(e("ol/source/Vector")),te=e("ol/geom"),re=o(e("ol/geom/Geometry.js")),ne=e("ol/style.js"),ie=e("ol/control.js"),oe=e("ol/format.js"),ae=e("ol/interaction.js"),se=e("ol/proj.js"),ue=e("ol/coordinate.js"),le=o(e("ol-geocoder")),ce=o(e("ol/layer/Group")),fe=e("ol/sphere"),he=o(e("ol-layerswitcher"));o(e("ol-ext/control/Graticule"));function o(e){return e&&e.__esModule?e:{default:e}}X=jQuery,Z=proj4,void 0===window.TWCCMap&&(i=function(e){var s,r,n,u,i,o,l,a,c,f,h,p,d=null,y={mapOptions:{zoom:2,center:[0,0],azimuthOpacity:.7},mapContainerElt:X("#map")[0],context:{languageCode:"en"}},D={title:"Hybrid",lyrs:"y"},F={title:"Satellite",lyrs:"s"},N={title:"Terrain",lyrs:"p"},B={title:"Road",lyrs:"m"};function G(e){this._array=e,this._index=0;var t=this;this.get=function(){var e=t._array[t._index];return++t._index,t._index===t._array.length&&(t._index=0),e}}function g(){return y.utils.t.apply(this,arguments)}function m(e,t){y.utils.trigger(X(y.mapContainerElt),e,t)}function t(e){return(0,se.fromLonLat)(e,r.getProjection())}function v(e){return(0,se.toLonLat)(e,r.getProjection())}function b(e){return t([e.x,e.y])}function _(e,t){A.setMetrics("length",e),A.setMetrics("area",t),m("map.metrics_changed",{length:e,area:t})}function w(){var e,t=a.getFeatures()[0];t&&((e=(t=t.getGeometry()).getCoordinates()).push(e[0]),e=new te.Polygon([e]),_((0,fe.getLength)(t),(0,fe.getArea)(e)))}function x(){h.setPosition(void 0)}function S(n){l.getFeatures().forEach(function(e){e.getGeometry().setCoordinates(n||e.getGeometry().getCoordinates());var t=e.get("name"),r=A.getAngleInRadians(t)||0,t="true"===t||r?y.mapOptions.azimuthOpacity:0,e=e.get("style").getImage();e.setRotation(r),e.setOpacity(t)})}function j(e){return"data:image/svg+xml,"+escape('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'+e)}function O(){l.clear()}function U(e){var r=[new ne.Style({stroke:new ne.Stroke({color:"rgba(0,0,0,0.5)",width:2})})],n=0,e=e.getGeometry(),i=e.getCoordinates().length-1,o={font:"10px Arial",stroke:new ne.Stroke({color:"#fff",width:2}),fill:new ne.Fill({color:"#000"})};return e.forEachSegment(function(e,t){++n,r.push(new ne.Style({geometry:new te.Point(e),text:new ne.Text(X.extend(o,{text:n.toString()}))})),n===i&&r.push(new ne.Style({geometry:new te.Point(t),text:new ne.Text(X.extend(o,{text:(n+1).toString()}))}))}),r}function P(e){var t=new X.Deferred;return r.animate({center:e,duration:200},t.resolve),t.promise()}function z(){X("#zoom-btn").button("option","disabled",!0);var e,t=c.getFeatures()[0].getGeometry().getCoordinates();X.when(P(t),(t=10,e=new X.Deferred,r.animate({zoom:t,duration:200},e.resolve),e.promise())).done(function(){X("#zoom-btn").button("option","disabled",!1)})}function W(e){var t;a&&(e=e.map(b),a.getFeatures().length?(t=e,a.getFeatures()[0].getGeometry().setCoordinates(t)):(a.addFeature(new K.Feature({geometry:new te.LineString(e)})),s.addInteraction(i)),w(),!0===A.getBoolean("autoZoom"))&&s.getView().fit(a.getExtent(),{duration:200,padding:[0,270,36,204]})}function k(e){var t,r="",n="",i="",o=v(e),a={key:y.mapOptions.timezonedbKey,format:"json",by:"position",lng:o[0],lat:o[1],fields:"abbreviation,gmtOffset"},s=(0,ue.degreesToStringHDMS)("NS",o[1]),u=(0,ue.degreesToStringHDMS)("EW",o[0]),l=X.get("https://elevation-api.io/api/elevation",{points:o[1]+","+o[0]}).done(function(e){e.elevations&&"-9999"!==(e=e.elevations[0].elevation.toString())&&(r='<p><img src="'+y.system.dirWsImages+'elevation_icon.png" alt="'+g("elevation")+'" title="'+g("elevation")+'" width="38" height="30"> '+e+g("unitMeter")+"</p>")}).fail(function(){m("xhr.failed","Elevation API")}),a=X.get("https://api.timezonedb.com/v2.1/get-time-zone",a).done(function(e){var t;"OK"===e.status&&(t=e.gmtOffset/3600,i="<p>"+e.abbreviation+" (GMT",0<t&&(i+="+"),0!=t&&(i+=t),i+=")</p>")}).fail(function(){m("xhr.failed","Timezonedb API")}),o=X.get("https://nominatim.openstreetmap.org/reverse",{format:"json",lat:o[1],lon:o[0],"accept-language":y.context.languageCode}).done(function(e){var t;e&&!e.error&&(t=e.address.country_code.toUpperCase(),n='<img src="'+y.system.dirWsImages+'address_icon.png" alt="'+g("address")+'" title="'+g("address")+'" width="38" height="30"><p>'+e.display_name+'   <img src="'+y.system.dirWsImages+"flags/"+t+'.png" alt="'+t+'" width="22" height="15"></p>')}).fail(function(){m("xhr.failed","Nominatim API")});x(),X.when(o,l,a).always(function(){t='<div id="popup" class="ol-popup">   <a href="#" id="popup-closer" class="ol-popup-closer"></a>   <div class="popup-content" dir="'+g("dir")+'">       <h3>'+g("dragMe")+"</h3>       <div>"+n+'           <a id="zoom-btn" href="#" title="'+g("zoom")+'">'+g("zoom")+'</a>       </div>       <div>           <img src="'+y.system.dirWsImages+'gps_icon.png" alt="GPS (WGS84)" title="GPS (WGS84)" width="38" height="30">           <p>'+s+"<br>"+u+"</p>"+i+r+"       </div>   </div></div>",f.innerHTML=t,X("#zoom-btn").button({icons:{primary:"ui-icon-zoomin"},text:!1}).click(function(){z()}),X("#popup-closer").click(function(e){return x(),this.blur(),e.stopPropagation(),e.preventDefault(),!1}),m("infowindow.dom_ready"),h.setPosition(e)})}function V(e){if(c){var t,e=b(e);if(c.getFeatures().length?(t=e,c.getFeatures().forEach(function(e){e.getGeometry().setCoordinates(t)})):(c.addFeature(new K.Feature({geometry:new te.Point(e),style:new ne.Style({image:new ne.Icon({src:y.system.dirWsImages+"twcc_icon_with_shadow.png",anchor:[19,1],anchorXUnits:"pixels"})})})),s.addInteraction(u)),l.getFeatures().length)S(e);else{var r,n,i=e,o=j('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/><rect style="fill:#fff;stroke:#fff;stroke-width:1;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;" width="8.779562" height="8.2131386" x="3.610219" y="4.5313869"/></svg>'),a={true:{src:j('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="97" viewBox="0 0 16 97" enable-background="new 0 0 512 512" xml:space="preserve"><polygon style="fill:#fff;stroke:#fff;stroke-width:37.61520004;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10" stroke-miterlimit="10" points="374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 259.216,29.942 330.27,173.919 489.16,197.007 " transform="matrix(0.03217603,0,0,0.03217603,-0.33683664,-0.35833699)"/><path style="stroke:#fff;stroke-width:2;" d="M 8,12.943205 8,96.999397"/></svg>')},magneticDeclination:{src:j('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16 97" xml:space="preserve" width="16" height="97"><g transform="matrix(0.07106223,0,0,0.07106223,-0.43846047,1.8741008e-6)"><path style="fill:#fff" d="m 7.954,226.53 c -2.23,4.623 -2.295,8.072 -0.609,9.915 3.911,4.275 15.926,-3.905 23.323,-9.051 l 58.416,-40.662 c 7.397,-5.145 20.402,-11.835 29.414,-11.993 0.897,-0.016 1.8,-0.011 2.703,0.011 9.007,0.218 21.958,7.016 29.3,12.238 l 56.403,40.151 c 7.343,5.221 19.303,13.473 23.301,9.219 1.74,-1.849 1.751,-5.33 -0.381,-9.997 L 129.648,7.047 c -4.264,-9.333 -11.335,-9.404 -15.79,-0.163 L 7.954,226.53 Z"/><path style="stroke:#fff;stroke-width:28.14434624;" d="m 118.74748,174.45383 0,1190.45957"/></g></svg>'),rotation:A.getAngleInRadians("magneticDeclination")},srcConvergence:{src:o,color:"#f00",rotation:A.getAngleInRadians("srcConvergence")},dstConvergence:{src:o,rotation:A.getAngleInRadians("dstConvergence")}};for(r in a)a.hasOwnProperty(r)&&(n=a[r],l.addFeature(new K.Feature({geometry:new te.Point(i),name:r,style:new ne.Style({image:new ne.Icon(X.extend({anchor:[.5,1],rotateWithView:!0,opacity:"true"===r||n.rotation?y.mapOptions.azimuthOpacity:0,scale:.75,color:"#000"},n))})})))}P(e),k(e),_()}}function H(e){1===e.length?(a.clear(),s.removeInteraction(i),V(e[0])):(x(),c.clear(),s.removeInteraction(u),O(),W(e))}function E(e,r){return e.reduce(function(e,t){return e.concat(r(t))},[])}function T(e){return E(e,function(e){return e})}function C(e){switch(e.getType()){case re.default.POINT:return[e.getCoordinates()];case re.default.LINE_STRING:case re.default.LINEAR_RING:case re.default.MULTI_POINT:return e.getCoordinates();case re.default.POLYGON:case re.default.MULTI_LINE_STRING:return T(e.getCoordinates());case re.default.MULTI_POLYGON:return T(T(e.getCoordinates()));case re.default.GEOMETRY_COLLECTION:return E(e.getGeometries(),C);case re.default.CIRCLE:return[e.getCenter()];default:return[]}}function R(e){return new J.Tile({title:e.title,type:"base",visible:!1,preload:1/0,source:new Q.XYZ({attributions:'© Google <a href="https://developers.google.com/maps/terms" target="_blank">Terms of Use.</a>',url:"http://mt0.google.com/vt/lyrs="+e.lyrs+"&hl=en&x={x}&y={y}&z={z}&s=Ga"})})}function q(){var e=y.utils.getPreferenceCookie("layers");if(e){var t,r=e.opt;if(r)for(var n in r)r.hasOwnProperty(n)&&(t=X(".ol-control.layer-switcher label:contains('"+n+"')").closest("li").children("input[type=checkbox]")).length&&t[0].checked!==r[n]&&t.click();var i=e.base;if(i)for(var o in i)i.hasOwnProperty(o)&&(o=X(".ol-control.layer-switcher label:contains('"+o+"')").closest("li").find("label:contains('"+i[o]+"')").closest("li").children("input[type=radio]")).length&&o.click()}}function M(e){if(e.features){var t;if(X.isFunction(e.features.getArray))t=e.features.getArray();else{if(!X.isArray(e.features))return;t=e.features}m("linestring.edit_end",E(t,function(e){return C(e.getGeometry())}).map(v)),w()}}function Y(){var e=X("body"),t=(n.once("tileloadend",function(){q(),m("map.tiles_loaded"),X(".ol-control.layer-switcher").on("change","input",function(e){var e=X(e.target),t=e.closest("li.group").children("label").text();t+=" "+e.closest("li.layer").children("label").text(),m("map.layer.change",t="checkbox"===e.attr("type")?t+" "+(this.checked?"on":"off"):t)}),d.resolve()}),n.on("tileloaderror",d.reject),s.on("singleclick",function(e){var t=s.forEachFeatureAtPixel(s.getEventPixel(e.originalEvent),function(e){return e});t?k(t.getGeometry().getCoordinates()):(x(),m("map.click",v(e.coordinate)))}),u.on("modifystart",function(){x(),O(),m("marker.drag_start")}),u.on("modifyend",function(e){m("marker.drag_end",v(e.features.getArray()[0].getGeometry().getCoordinates()))}),i.on("modifyend",M),o.on("addfeatures",M),s.getViewport().addEventListener("contextmenu",function(e){var t=s.forEachFeatureAtPixel(s.getEventPixel(e),function(e){return e});t?m("linestring.remove_vertice",v(t.getGeometry().getCoordinates())):m("linestring.add_vertice",v(s.getEventCoordinate(e))),w(),e.stopPropagation(),e.preventDefault()}),e.on("converter.source.selection_changed converterset.done",function(e,t){}),e.on("converterset.wgs84_changed",function(e,t){var r,n,i=y.utils.degToRad(t.convergenceInDegrees),o=y.utils.getConvergenceConvention()?-1:1;t.wgs84=(r=t.wgs84,n=[],X.each(r,function(){if(void 0===this.lat&&void 0===this.x||this.error)return!0;n.push(this)}),n),A.setAngleInDegrees("magneticDeclination",t.magneticDeclinationInDegrees),A.setAngleInRadians("srcConvergence",o*i.source),A.setAngleInRadians("dstConvergence",o*i.destination),H(t.wgs84),m("converter.changed",t)}),e.on("converterset.convergence_changed",function(e,t){var r;l.getFeatures().length&&(t=y.utils.degToRad(t.convergenceInDegrees),r=y.utils.getConvergenceConvention()?-1:1,A.setAngleInRadians("srcConvergence",r*t.source),A.setAngleInRadians("dstConvergence",r*t.destination),S())}),e.on("ui.full_screen",function(){X(".ol-full-screen button").trigger("click")}),new G("degrees"));X(".ol-scale-line").click(function(){p.setUnits(t.get())})}X.extend(!0,y,e);var I,A={anglesInRadians:{},booleans:{autoZoom:!0},metrics:{},setAngleInRadians:function(e,t){A.anglesInRadians[e]=t},setAngleInDegrees:function(e,t){A.setAngleInRadians(e,y.utils.degToRad(t))},getAngleInRadians:function(e){return A.anglesInRadians[e]},setBoolean:function(e,t){A.booleans[e]=!!t},getBoolean:function(e){return A.booleans[e]},setMetrics:function(e,t){A.metrics[e]=t},getMetrics:function(e){return A.metrics[e]}};(I=ie.Control)&&(L.__proto__=I),(L.prototype=Object.create(I&&I.prototype)).constructor=L;function L(e){var e=e||{},t=X("#c-ads-1")[0];I.call(this,{element:t,target:e.target})}return d=function(){return y.utils.newDeferred.apply(this,arguments)}("Map"),(0,$.register)(Z),e=new ne.Style({image:new ne.Circle({radius:6,fill:null,stroke:new ne.Stroke({color:"rgba(0,0,0,0.6)",width:3})})}),f=X("<div>")[0],p=new ie.ScaleLine,l=new ee.default,c=new ee.default,a=new ee.default,u=new ae.Modify({source:c,style:e,pixelTolerance:30}),i=new ae.Modify({source:a,style:e}),o=new ae.DragAndDrop({formatConstructors:[oe.GPX,oe.GeoJSON,oe.IGC,oe.KML,oe.TopoJSON]}),n=new Q.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),r=new K.View({zoom:y.mapOptions.zoom}),new le.default("nominatim",{provider:"osm",autoComplete:!0,autoCompleteMinLength:2,placeholder:g("searchByAddress"),targetType:"glass-button",lang:y.context.languageCode,limit:5,keepOpen:!1,preventDefault:!0,debug:!1}),h=new K.Overlay({element:f,autoPan:!0,autoPanAnimation:{duration:200}}),e=t(y.mapOptions.center),r.setCenter(e),s=new K.Map({controls:(0,ie.defaults)().extend([new ie.FullScreen({source:"map-container"}),new he.default,p]),interactions:(0,ae.defaults)().extend([new ae.DragRotateAndZoom,o]),target:y.mapContainerElt,loadTilesWhileAnimating:!0,overlays:[h],layers:[new ce.default({title:"Maps",layers:[new ce.default({title:"ArcGIS",layers:[new J.Tile({title:"Satellite",type:"base",visible:!1,preload:1/0,source:new Q.XYZ({attributions:'Tiles © <a target="_blank" href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer">ArcGIS</a>',url:"http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.jpg"})}),new J.Tile({title:"Terrain",type:"base",preload:1/0,source:n})]}),new ce.default({title:"OSM",layers:[new J.Tile({title:"Stamen toner",type:"base",visible:!1,preload:1/0,source:new Q.Stamen({layer:"toner"})}),new J.Tile({title:"Stamen terrain",type:"base",visible:!1,preload:1/0,source:new Q.Stamen({layer:"terrain"})}),new J.Tile({title:"Open Street Map",type:"base",visible:!1,preload:1/0,source:new Q.OSM})]}),new ce.default({title:"Google",layers:[R(D),R(F),R(N),R(B)]})]}),new ce.default({title:"Features",layers:[new J.Vector({title:"Azimuths",style:function(e){return e.get("style")},source:l})]}),new J.Vector({style:function(e){return e.get("style")},source:c}),new J.Vector({style:U,source:a})],view:r}),Y(),{promise:d.promise(),setGraticule:function(){new GridOverlay(s).setMap(s)},model:{setAngleInRadians:A.setAngleInRadians,setAngleInDegrees:A.setAngleInDegrees,getMetrics:A.getMetrics,setBoolean:A.setBoolean},getMap:function(){return s},olVersion:K.VERSION}},window.TWCCMap={getInstance:function(e){return n=n||i(e)}})},{ol:222,"ol-ext/control/Graticule":65,"ol-geocoder":67,"ol-layerswitcher":68,"ol/control.js":109,"ol/coordinate.js":121,"ol/format.js":134,"ol/geom":190,"ol/geom/Geometry.js":192,"ol/interaction.js":223,"ol/layer.js":247,"ol/layer/Group":253,"ol/proj.js":271,"ol/proj/proj4.js":276,"ol/source":320,"ol/source/Vector":346,"ol/sphere":353,"ol/style.js":358}],2:[function(e,t,r){"use strict";function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nt(n.key),n)}}function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=s(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nt(e){e=function(e,t){if("object"!==Dt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Dt(e)?e:String(e)}function Bt(){Bt=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==Dt(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}!function(e){var D="This constructor is not a subclass of Float16Array",F="The constructor property value is not an object",l="Attempting to access detached ArrayBuffer",N="Cannot convert undefined or null to object",B="Cannot mix BigInt and other types, use explicit conversions",G="@@iterator property is not callable",U="Reduce of empty array with no initial value",z="Offset is out of bounds";function r(i){return function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return p(i,e,r)}}function t(e,t){return r(i(e,t).get)}function W(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return p(we,v,t)}var p=Reflect.apply,c=Reflect.construct,V=Reflect.defineProperty,H=Reflect.get,i=Reflect.getOwnPropertyDescriptor,o=Reflect.getPrototypeOf,q=Reflect.has,Y=Reflect.ownKeys,X=Reflect.set,Z=Reflect.setPrototypeOf,K=Proxy,$=Number.MAX_SAFE_INTEGER,J=Number.isFinite,Q=Number.isNaN,f=Symbol.iterator,ee=Symbol.species,te=Symbol.toStringTag,re=Symbol.for,d=Object,ne=d.create,ie=d.defineProperty,oe=d.freeze,ae=d.is,n=d.prototype,se=n.__lookupGetter__?r(n.__lookupGetter__):function(e,t){if(null==e)throw b(N);var r=d(e);do{var n=i(r,t);if(void 0!==n)return a(n,"get")?n.get:void 0}while(null!==(r=o(r)))},a=d.hasOwn||r(n.hasOwnProperty),n=Array,ue=n.isArray,n=n.prototype,le=r(n.join),ce=r(n.push),fe=r(n.toLocaleString),he=n[f],pe=r(he),de=Math.trunc,ye=ArrayBuffer,ge=ye.isView,n=ye.prototype,me=r(n.slice),ve=t(n,"byteLength"),be="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null,_e=be&&t(be.prototype,"byteLength"),n=o(Uint8Array),we=n.from,s=n.prototype,xe=s[f],Se=r(s.keys),je=r(s.values),Oe=r(s.entries),Pe=r(s.set),ke=r(s.reverse),Ee=r(s.fill),Te=r(s.copyWithin),Ce=r(s.sort),Re=r(s.slice),Me=r(s.subarray),y=t(s,"buffer"),g=t(s,"byteOffset"),m=t(s,"length"),Ie=t(s,te),v=Uint16Array,u=Uint32Array,Ae=Float32Array,Le=o([][f]()),De=r(Le.next),Fe=r(Bt().mark(function e(){return Bt().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})().next),Ne=o(Le),Be=DataView.prototype,Ge=r(Be.getUint16),Ue=r(Be.setUint16),b=TypeError,ze=RangeError,Be=WeakSet,h=Be.prototype,We=r(h.add),Ve=r(h.has),h=WeakMap,_=h.prototype,He=r(_.get),qe=r(_.has),Ye=r(_.set),Xe=new h,Ze=ne(null,(_={next:{value:function(){var e=He(Xe,this);return De(e)}}},L={value:function(){return this}},(x=Nt(x=f))in _?Object.defineProperty(_,x,{value:L,enumerable:!0,configurable:!0,writable:!0}):_[x]=L,_));function w(e){var t;return e[f]===he?e:(t=ne(Ze),Ye(Xe,t,pe(e)),t)}var Ke,$e=new h,Je=ne(Ne,{next:{value:function(){var e=He($e,this);return Fe(e)},writable:!0,configurable:!0}}),Qe=Ft(Y(Le));try{for(Qe.s();!(Ke=Qe.n()).done;){var et=Ke.value;"next"!==et&&ie(Je,et,i(Le,et))}}catch(e){Qe.e(e)}finally{Qe.f()}function tt(e){var t=ne(Je);return Ye($e,t,e),t}function rt(e){return null!==e&&"object"===Dt(e)||"function"==typeof e}function nt(e){return null!==e&&"object"===Dt(e)}function it(e){return void 0!==Ie(e)}function ot(e){e=Ie(e);return"BigInt64Array"===e||"BigUint64Array"===e}function at(e){return ue(e)&&(e[f]===he||"Array Iterator"===e[f]()[te])}function st(e){return"string"==typeof e&&e===(e=+e)+""?J(e)&&e===de(e):void 0}var ut=re("__Float16Array__");for(var x=new ye(4),lt=new Ae(x),ct=new u(x),S=new u(512),j=new u(512),O=0;O<256;++O){var P=O-127;P<-27?(S[O]=0,S[256|O]=32768,j[O]=24,j[256|O]=24):P<-14?(S[O]=1024>>-P-14,S[256|O]=1024>>-P-14|32768,j[O]=-P-1,j[256|O]=-P-1):P<=15?(S[O]=15+P<<10,S[256|O]=15+P<<10|32768,j[O]=13,j[256|O]=13):P<128?(S[O]=31744,S[256|O]=64512,j[O]=24,j[256|O]=24):(S[O]=31744,S[256|O]=64512,j[O]=13,j[256|O]=13)}function k(e){lt[0]=e;var e=ct[0],t=e>>23&511;return S[t]+((8388607&e)>>j[t])}for(var ft=new u(2048),E=new u(64),ht=new u(64),pt=1;pt<1024;++pt){for(var dt=pt<<13,yt=0;0==(8388608&dt);)dt<<=1,yt-=8388608;dt&=-8388609,yt+=947912704,ft[pt]=dt|yt}for(var gt=1024;gt<2048;++gt)ft[gt]=939524096+(gt-1024<<13);for(var mt=1;mt<31;++mt)E[mt]=mt<<23;E[31]=1199570944,E[32]=2147483648;for(var vt=33;vt<63;++vt)E[vt]=2147483648+(vt-32<<23);E[63]=3347054592;for(var bt=1;bt<64;++bt)32!==bt&&(ht[bt]=1024);function T(e){var t=e>>10;return ct[0]=ft[ht[t]+(1023&e)]+E[t],lt[0]}function C(e){e=+e;return Q(e)||0==e?0:de(e)}function _t(e){e=C(e);return e<0?0:e<$?e:$}function wt(e,t){if(!rt(e))throw b("This is not an object");var e=e.constructor;if(void 0===e)return t;if(rt(e))return null==(e=e[ee])?t:e;throw b(F)}function xt(e){if(!function(e){if(null!==be)try{return _e(e),1}catch(e){}}(e)){try{return void me(e,0,0)}catch(e){}return 1}}function St(e,t){var r=Q(e),n=Q(t);if(!r||!n){if(r)return 1;if(n)return-1;if(e<t)return-1;if(t<e)return 1;if(0===e&&0===t){r=ae(e,0),n=ae(t,0);if(!r&&n)return-1;if(r&&!n)return 1}}return 0}var jt=new h;function R(e){return qe(jt,e)||!ge(e)&&function(e){if(!nt(e))return!1;if(!nt(e=o(e)))return!1;if(void 0===(e=e.constructor))return!1;if(rt(e))return q(e,ut);throw b(F)}(e)}function M(e){if(!R(e))throw b("This is not a Float16Array object")}function Ot(e,t){var r=R(e),n=it(e);if(!r&&!n)throw b("Species constructor didn't return TypedArray object");if("number"==typeof t&&(r?(n=I(e),m(n)):m(e))<t)throw b("Derived constructor created TypedArray object which was too small length");if(ot(e))throw b(B)}function I(e){var t=He(jt,e);if(void 0!==t){if(xt(y(t)))throw b(l);return t}t=e.buffer;if(xt(t))throw b(l);t=c(A,[t,e.byteOffset,e.length],e.constructor);return He(jt,t)}function Pt(e){for(var t=m(e),r=[],n=0;n<t;++n)r[n]=T(e[n]);return r}var kt,Et=new Be,Tt=Ft(Y(s));try{for(Tt.s();!(kt=Tt.n()).done;){var Ct,Rt=kt.value;Rt!==te&&(Ct=i(s,Rt),a(Ct,"get")&&"function"==typeof Ct.get)&&We(Et,Ct.get)}}catch(e){Tt.e(e)}finally{Tt.f()}var Mt=oe({get:function(e,t,r){return st(t)&&a(e,t)?T(H(e,t)):Ve(Et,se(e,t))?H(e,t):H(e,t,r)},set:function(e,t,r,n){return st(t)&&a(e,t)?X(e,t,k(r)):X(e,t,r,n)},getOwnPropertyDescriptor:function(e,t){var r;return st(t)&&a(e,t)?((r=i(e,t)).value=T(r.value),r):i(e,t)},defineProperty:function(e,t,r){return st(t)&&a(e,t)&&a(r,"value")&&(r.value=k(r.value)),V(e,t,r)}}),A=function(){function h(e,t,r){var n=this,i=h;if(!(n instanceof i))throw new TypeError("Cannot call a class as a function");if(R(e))s=c(v,[I(e)],this instanceof h?this.constructor:void 0);else if(rt(e)&&!function(e){try{return ve(e),1}catch(e){}}(e)){if(it(e)){var o=e,a=m(e);if(xt(y(e)))throw b(l);if(ot(e))throw b(B);var n=new ye(2*a),s=c(v,[n],this instanceof h?this.constructor:void 0)}else{i=e[f];if(null!=i&&"function"!=typeof i)throw b(G);a=null!=i?(o=at(e)?e:At(e)).length:_t((o=e).length),s=c(v,[a],this instanceof h?this.constructor:void 0)}for(var u=0;u<a;++u)s[u]=k(o[u])}else s=c(v,arguments,this instanceof h?this.constructor:void 0);n=new K(s,Mt);return Ye(jt,n,s),n}var e,t,r;return e=h,r=[{key:"from",value:function(e){var i,t,r;if(!q(this,ut))throw b(D);if(this===h)return R(e)&&0==(arguments.length<=1?0:arguments.length-1)?(n=I(e),n=new v(y(n),g(n),m(n)),new h(y(Re(n)))):0==(arguments.length<=1?0:arguments.length-1)?new h(y(W(e,k))):(i=arguments.length<=1?void 0:arguments[1],new h(y(W(e,function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return k(p(i,this,[e].concat(At(w(r)))))},arguments.length<=2?void 0:arguments[2]))));var n=e[f];if(null!=n&&"function"!=typeof n)throw b(G);if(null!=n)r=at(e)?(t=e).length:!it(n=e)||n[f]!==xe&&"Array Iterator"!==n[f]()[te]?(t=At(e)).length:m(t=e);else{if(null==e)throw b(N);r=_t((t=d(e)).length)}var o=new this(r);if(0==(arguments.length<=1?0:arguments.length-1))for(var a=0;a<r;++a)o[a]=t[a];else for(var s=arguments.length<=1?void 0:arguments[1],u=arguments.length<=2?void 0:arguments[2],l=0;l<r;++l)o[l]=p(s,u,[t[l],l]);return o}},{key:"of",value:function(){if(!q(this,ut))throw b(D);var e=arguments.length;if(this===h){for(var t=new h(e),r=I(t),n=0;n<e;++n)r[n]=k(n<0||arguments.length<=n?void 0:arguments[n]);return t}for(var i=new this(e),o=0;o<e;++o)i[o]=o<0||arguments.length<=o?void 0:arguments[o];return i}}],(t=[{key:"keys",value:function(){M(this);var e=I(this);return Se(e)}},{key:"values",value:function(){M(this);var n=I(this);return tt(Bt().mark(function e(){var t,r;return Bt().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Ft(je(n)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return r=r.value,e.next=7,T(r);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})())}},{key:"entries",value:function(){M(this);var i=I(this);return tt(Bt().mark(function e(){var t,r,n;return Bt().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Ft(Oe(i)),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return n=It(n.value,2),r=n[0],n=n[1],e.next=7,[r,T(n)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})())}},{key:"at",value:function(e){M(this);var t=I(this),r=m(t),e=C(e),e=0<=e?e:r+e;if(!(e<0||r<=e))return T(t[e])}},{key:"with",value:function(e,t){M(this);var r=I(this),n=m(r),e=C(e),e=0<=e?e:n+e,t=+t;if(e<0||n<=e)throw ze(z);n=new v(y(r),g(r),m(r)),r=new h(y(Re(n)));return I(r)[e]=k(t),r}},{key:"map",value:function(e){M(this);var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=wt(t,h);if(i===h){for(var o=new h(r),a=I(o),s=0;s<r;++s){var u=T(t[s]);a[s]=k(p(e,n,[u,s,this]))}return o}var l=new i(r);Ot(l,r);for(var c=0;c<r;++c){var f=T(t[c]);l[c]=p(e,n,[f,c,this])}return l}},{key:"filter",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=[],o=0;o<r;++o){var a=T(t[o]);p(e,n,[a,o,this])&&ce(i,a)}var s=new(wt(t,h))(i);return Ot(s),s}},{key:"reduce",value:function(e){M(this);var t,r=I(this),n=m(r);if(0===n&&0==(arguments.length<=1?0:arguments.length-1))throw b(U);for(var i=0==(arguments.length<=1?0:arguments.length-1)?(t=T(r[0]),1):(t=arguments.length<=1?void 0:arguments[1],0);i<n;++i)t=e(t,T(r[i]),i,this);return t}},{key:"reduceRight",value:function(e){M(this);var t,r=I(this),n=m(r);if(0===n&&0==(arguments.length<=1?0:arguments.length-1))throw b(U);for(var i=0==(arguments.length<=1?0:arguments.length-1)?(t=T(r[n-1]),n-2):(t=arguments.length<=1?void 0:arguments[1],n-1);0<=i;--i)t=e(t,T(r[i]),i,this);return t}},{key:"forEach",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=0;i<r;++i)p(e,n,[T(t[i]),i,this])}},{key:"find",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=0;i<r;++i){var o=T(t[i]);if(p(e,n,[o,i,this]))return o}}},{key:"findIndex",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=0;i<r;++i){var o=T(t[i]);if(p(e,n,[o,i,this]))return i}return-1}},{key:"findLast",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=r-1;0<=i;--i){var o=T(t[i]);if(p(e,n,[o,i,this]))return o}}},{key:"findLastIndex",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=r-1;0<=i;--i){var o=T(t[i]);if(p(e,n,[o,i,this]))return i}return-1}},{key:"every",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=0;i<r;++i)if(!p(e,n,[T(t[i]),i,this]))return!1;return!0}},{key:"some",value:function(e){M(this);for(var t=I(this),r=m(t),n=arguments.length<=1?void 0:arguments[1],i=0;i<r;++i)if(p(e,n,[T(t[i]),i,this]))return!0;return!1}},{key:"set",value:function(e){M(this);var t=I(this),r=C(arguments.length<=1?void 0:arguments[1]);if(r<0)throw ze(z);if(null==e)throw b(N);if(ot(e))throw b(B);if(R(e))return Pe(I(this),I(e),r);if(it(e)&&xt(y(e)))throw b(l);var n=m(t),i=d(e),o=_t(i.length);if(r===1/0||n<o+r)throw ze(z);for(var a=0;a<o;++a)t[a+r]=k(i[a])}},{key:"reverse",value:function(){M(this);var e=I(this);return ke(e),this}},{key:"toReversed",value:function(){M(this);var e=I(this),e=new v(y(e),g(e),m(e)),e=new h(y(Re(e))),t=I(e);return ke(t),e}},{key:"fill",value:function(e){M(this);for(var t=I(this),r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Ee.apply(void 0,[t,k(e)].concat(At(w(n)))),this}},{key:"copyWithin",value:function(e,t){M(this);for(var r=I(this),n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return Te.apply(void 0,[r,e,t].concat(At(w(i)))),this}},{key:"sort",value:function(e){M(this);var t=I(this),r=void 0!==e?e:St;return Ce(t,function(e,t){return r(T(e),T(t))}),this}},{key:"toSorted",value:function(e){M(this);var t=I(this);if(void 0!==e&&"function"!=typeof e)throw new b("The comparison function must be either a function or undefined");var r=void 0!==e?e:St,e=new v(y(t),g(t),m(t)),t=new h(y(Re(e))),e=I(t);return Ce(e,function(e,t){return r(T(e),T(t))}),t}},{key:"slice",value:function(e,t){M(this);var r=I(this),n=wt(r,h);if(n===h)return i=new v(y(r),g(r),m(r)),new h(y(Re(i,e,t)));var i=m(r),e=C(e),t=void 0===t?i:C(t),o=e===-1/0?0:e<0?0<i+e?i+e:0:i<e?i:e,a=t===-1/0?0:t<0?0<i+t?i+t:0:i<t?i:t,e=0<a-o?a-o:0,s=new n(e);if(Ot(s,e),0!=e){if(xt(y(r)))throw b(l);for(var u=0;o<a;)s[u]=T(r[o]),++o,++u}return s}},{key:"subarray",value:function(e,t){M(this);var r=I(this),n=wt(r,h),r=new v(y(r),g(r),m(r)),r=Me(r,e,t),e=new n(y(r),g(r),m(r));return Ot(e),e}},{key:"indexOf",value:function(e){M(this);var t=I(this),r=m(t),n=C(arguments.length<=1?void 0:arguments[1]);if(n!==1/0)for(var i=n=n<0&&(n+=r)<0?0:n;i<r;++i)if(a(t,i)&&T(t[i])===e)return i;return-1}},{key:"lastIndexOf",value:function(e){M(this);var t=I(this),r=m(t),n=1<=(arguments.length<=1?0:arguments.length-1)?C(arguments.length<=1?void 0:arguments[1]):r-1;if(n!==-1/0){0<=n?n=n<r-1?n:r-1:n+=r;for(var i=n;0<=i;--i)if(a(t,i)&&T(t[i])===e)return i}return-1}},{key:"includes",value:function(e){M(this);var t=I(this),r=m(t),n=C(arguments.length<=1?void 0:arguments[1]);if(n!==1/0){n<0&&(n+=r)<0&&(n=0);for(var i=Q(e),o=n;o<r;++o){var a=T(t[o]);if(i&&Q(a))return!0;if(a===e)return!0}}return!1}},{key:"join",value:function(e){M(this);var t=Pt(I(this));return le(t,e)}},{key:"toLocaleString",value:function(){M(this);for(var e=Pt(I(this)),t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return fe.apply(void 0,[e].concat(At(w(r))))}},{key:te,get:function(){if(R(this))return"Float16Array"}}])&&Lt(e.prototype,t),r&&Lt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(),L=(ie(A,"BYTES_PER_ELEMENT",{value:2}),ie(A,ut,{}),Z(A,n),A.prototype);ie(L,"BYTES_PER_ELEMENT",{value:2}),ie(L,f,{value:L.values,writable:!0,configurable:!0}),Z(L,s),e.Float16Array=A,e.getFloat16=function(e,t){for(var r=arguments.length,n=new Array(2<r?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return T(Ge.apply(void 0,[e,t].concat(At(w(n)))))},e.hfround=function(e){return J(e=+e)&&0!=e?T(k(e)):e},e.isFloat16Array=R,e.isTypedArray=function(e){return it(e)||R(e)},e.setFloat16=function(e,t,r){for(var n=arguments.length,i=new Array(3<n?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return Ue.apply(void 0,[e,t,k(r)].concat(At(w(i))))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}({})},{}],3:[function(e,t,r){"use strict";r.byteLength=function(e){var e=c(e),t=e[0],e=e[1];return 3*(t+e)/4-e},r.toByteArray=function(e){var t,r,n=c(e),i=n[0],n=n[1],o=new l(function(e,t){return 3*(e+t)/4-t}(i,n)),a=0,s=0<n?i-4:i;for(r=0;r<s;r+=4)t=u[e.charCodeAt(r)]<<18|u[e.charCodeAt(r+1)]<<12|u[e.charCodeAt(r+2)]<<6|u[e.charCodeAt(r+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;2===n&&(t=u[e.charCodeAt(r)]<<2|u[e.charCodeAt(r+1)]>>4,o[a++]=255&t);1===n&&(t=u[e.charCodeAt(r)]<<10|u[e.charCodeAt(r+1)]<<4|u[e.charCodeAt(r+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t);return o},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],o=0,a=r-n;o<a;o+=16383)i.push(function(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(function(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}(n));return i.join("")}(e,o,a<o+16383?a:o+16383));1==n?(t=e[r-1],i.push(s[t>>2]+s[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return i.join("")};for(var s=[],u=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=n.length;i<o;++i)s[i]=n[i],u[n.charCodeAt(i)]=i;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],4:[function(e,t,r){},{}],5:[function(e,t,r){},{}],6:[function(M,e,I){!function(e){!function(){"use strict";function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j=M("base64-js"),o=M("ieee754"),t=(I.Buffer=h,I.SlowBuffer=function(e){+e!=e&&(e=0);return h.alloc(+e)},I.INSPECT_MAX_BYTES=50,2147483647);function u(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=h.prototype,e}function h(e,t,r){if("number"!=typeof e)return n(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return a(e)}function n(e,t,r){if("string"==typeof e){var n=e,i=t;if(h.isEncoding(i="string"==typeof i&&""!==i?i:"utf8"))return o=0|p(n,i),a=u(o),a=(n=a.write(n,i))!==o?a.slice(0,n):a;throw new TypeError("Unknown encoding: "+i)}if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+f(e));if(C(e,ArrayBuffer)||e&&C(e.buffer,ArrayBuffer)){var o=e,n=t,a=r;if(n<0||o.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<n+(a||0))throw new RangeError('"length" is outside of buffer bounds');return(o=void 0===n&&void 0===a?new Uint8Array(o):void 0===a?new Uint8Array(o,n):new Uint8Array(o,n,a)).__proto__=h.prototype,o}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return h.from(i,t,r);var s=function(e){{var t,r;if(h.isBuffer(e))return t=0|c(e.length),0!==(r=u(t)).length&&e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||R(e.length)?u(0):l(e);if("Buffer"===e.type&&Array.isArray(e.data))return l(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+f(e))}function i(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function a(e){return i(e),u(e<0?0:0|c(e))}function l(e){for(var t=e.length<0?0:0|c(e.length),r=u(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function c(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function p(e,t){if(h.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||C(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+f(e));var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return k(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return E(e).length;default:if(i)return n?-1:k(e).length;t=(""+t).toLowerCase(),i=!0}}function r(e,t,r){var n,i=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var o=this,a=t,s=r,u=o.length;(!s||s<0||u<s)&&(s=u);for(var l="",c=a=!a||a<0?0:a;c<s;++c)l+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(o[c]);return l;case"utf8":case"utf-8":return O(this,t,r);case"ascii":var f=this,u=t,h=r,p="";h=Math.min(f.length,h);for(var d=u;d<h;++d)p+=String.fromCharCode(127&f[d]);return p;case"latin1":case"binary":var y=this,a=t,g=r,m="";g=Math.min(y.length,g);for(var v=a;v<g;++v)m+=String.fromCharCode(y[v]);return m;case"base64":return b=this,n=r,0===(_=t)&&n===b.length?j.fromByteArray(b):j.fromByteArray(b.slice(_,n));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var b=t,_=r,w=this.slice(b,_),x="",S=0;S<w.length;S+=2)x+=String.fromCharCode(w[S]+256*w[S+1]);return x;default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function s(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function d(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=R(r=+r)?i?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=h.from(t,n)),h.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):y(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var o=1,a=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a/=o=2,s/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i)for(var l=-1,c=r;c<a;c++)if(u(e,c)===u(t,-1===l?0:c-l)){if(c-(l=-1===l?c:l)+1===s)return l*o}else-1!==l&&(c-=c-l),l=-1;else for(c=r=a<r+s?a-s:r;0<=c;c--){for(var f=!0,h=0;h<s;h++)if(u(e,c+h)!==u(t,h)){f=!1;break}if(f)return c}return-1}function g(e,t,r,n){return T(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function m(e,t,r,n){return T(function(e,t){for(var r,n,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i.push(r%256),i.push(n);return i}(t,e.length-r),e,r,n)}function O(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,l=e[i],c=null,f=239<l?4:223<l?3:191<l?2:1;if(i+f<=r)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&127<(u=(31&l)<<6|63&o)&&(c=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&2047<(u=(15&l)<<12|(63&o)<<6|63&a)&&(u<55296||57343<u)&&(c=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)&&u<1114112&&(c=u)}null===c?(c=65533,f=1):65535<c&&(n.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=f}var h=n,p=h.length;if(p<=v)return String.fromCharCode.apply(String,h);for(var d="",y=0;y<p;)d+=String.fromCharCode.apply(String,h.slice(y,y+=v));return d}I.kMaxLength=t,(h.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=n,h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(e,t,r){return t=t,r=r,i(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?u(e).fill(t,r):u(e).fill(t):u(e)},h.allocUnsafe=a,h.allocUnsafeSlow=a,h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(C(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),C(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var r=h.allocUnsafe(t),n=0,i=0;i<e.length;++i){var o=e[i];if(C(o,Uint8Array)&&(o=h.from(o)),!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,n),n+=o.length}return r},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)s(this,t,t+1);return this},h.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)s(this,t,t+3),s(this,t+1,t+2);return this},h.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)s(this,t,t+7),s(this,t+1,t+6),s(this,t+2,t+5),s(this,t+3,t+4);return this},h.prototype.toLocaleString=h.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?O(this,0,e):r.apply(this,arguments)},h.prototype.equals=function(e){if(h.isBuffer(e))return this===e||0===h.compare(this,e);throw new TypeError("Argument must be a Buffer")},h.prototype.inspect=function(){var e="",t=I.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},h.prototype.compare=function(e,t,r,n,i){if(C(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+f(e));if(void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),(t=void 0===t?0:t)<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=t)return 0;if(i<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(n,i),l=e.slice(t,r),c=0;c<s;++c)if(u[c]!==l[c]){o=u[c],a=l[c];break}return o<a?-1:a<o?1:0},h.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},h.prototype.indexOf=function(e,t,r){return d(this,e,t,r,!0)},h.prototype.lastIndexOf=function(e,t,r){return d(this,e,t,r,!1)},h.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||i<r)&&(r=i),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var o,a,s,u=!1;;)switch(n){case"hex":var l=this,c=e,f=t,h=r,p=(f=Number(f)||0,l.length-f);(!h||p<(h=Number(h)))&&(h=p),(p=c.length)/2<h&&(h=p/2);for(var d=0;d<h;++d){var y=parseInt(c.substr(2*d,2),16);if(R(y))return d;l[f+d]=y}return d;case"utf8":case"utf-8":return p=t,s=r,T(k(e,(a=this).length-p),a,p,s);case"ascii":return g(this,e,t,r);case"latin1":case"binary":return g(this,e,t,r);case"base64":return a=this,s=t,o=r,T(E(e),a,s,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,e,t,r);default:if(u)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),u=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var v=4096;function b(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function _(e,t,r,n,i,o){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function w(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function x(e,t,r,n,i){return t=+t,r>>>=0,i||w(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function S(e,t,r,n,i){return t=+t,r>>>=0,i||w(e,0,r,8),o.write(e,t,r,n,52,8),r+8}h.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return r.__proto__=h.prototype,r},h.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},h.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},h.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*t)),n},h.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=t,i=1,o=this[e+--n];0<n&&(i*=256);)o+=this[e+--n]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*t)),o},h.prototype.readInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),o.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),o.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),o.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),o.read(this,e,!1,52,8)},h.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||_(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},h.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||_(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;0<=--i&&(o*=256);)this[t+i]=e/o&255;return t+r},h.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||_(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},h.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||_(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=r-1,o=1,a=0;for(this[t+i]=255&e;0<=--i&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},h.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},h.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeFloatLE=function(e,t,r){return x(this,e,t,!0,r)},h.prototype.writeFloatBE=function(e,t,r){return x(this,e,t,!1,r)},h.prototype.writeDoubleLE=function(e,t,r){return S(this,e,t,!0,r)},h.prototype.writeDoubleBE=function(e,t,r){return S(this,e,t,!1,r)},h.prototype.copy=function(e,t,r,n){if(!h.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var i=(n=e.length-t<n-r?e.length-t+r:n)-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var o=i-1;0<=o;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},h.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!h.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i;1===e.length&&(i=e.charCodeAt(0),"utf8"===n&&i<128||"latin1"===n)&&(e=i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");var o;if(!(r<=t))if(t>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(e=e||0))for(o=t;o<r;++o)this[o]=e;else{var a=h.isBuffer(e)?e:h.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var P=/[^+/0-9A-Za-z-_]/g;function k(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],a=0;a<n;++a){if(55295<(r=e.charCodeAt(a))&&r<57344){if(!i){if(56319<r){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===n){-1<(t-=3)&&o.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(t-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,r<128){if(--t<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function E(e){return j.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function T(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function C(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function R(e){return e!=e}}.call(this)}.call(this,M("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:60}],7:[function(e,t,r){"use strict";t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],8:[function(e,t,r){"use strict";function n(e,t,r){r=r||2;var n,i,o,a,s,u=t&&t.length,l=u?t[0]*r:e.length,c=y(e,0,l,r,!0),f=[];if(c&&c.next!==c.prev){if(u&&(c=function(e,t,r,n){var i,o,a,s,u=[];for(i=0,o=t.length;i<o;i++)s=t[i]*n,a=i<o-1?t[i+1]*n:e.length,(s=y(e,s,a,n,!1))===s.next&&(s.steiner=!0),u.push(function(e){var t=e,r=e;for(;(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next,t!==e;);return r}(s));for(u.sort(g),i=0;i<u.length;i++)r=function(e,t){var r=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&a<s&&(a=s,r=n.x<n.next.x?n:n.next,s===i))return r}}while(n=n.next,n!==t);if(!r)return null;var u,l=r,c=r.x,f=r.y,h=1/0;n=r;for(;i>=n.x&&n.x>=c&&i!==n.x&&E(o<f?i:a,o,c,f,o<f?a:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),M(n,e))&&(u<h||u===h&&(n.x>r.x||n.x===r.x&&function(e,t){return T(e.prev,e,t.prev)<0&&T(t.next,e,e.next)<0}(r,n)))&&(r=n,h=u),n=n.next,n!==l;);return r}(e,t);return r?(O(e=I(r,e),e.next),O(r,r.next)):t}(u[i],r);return r}(e,t,c,r)),e.length>80*r){for(var h=n=e[0],p=i=e[1],d=r;d<l;d+=r)(o=e[d])<h&&(h=o),(a=e[d+1])<p&&(p=a),n<o&&(n=o),i<a&&(i=a);s=0!==(s=Math.max(n-h,i-p))?32767/s:0}P(c,f,r,h,p,s,0)}return f}function y(e,t,r,n,i){var o,a;if(i===0<m(e,t,r,n))for(o=t;o<r;o+=n)a=s(o,e[o],e[o+1],a);else for(o=r-n;t<=o;o-=n)a=s(o,e[o],e[o+1],a);return a&&C(a,a.next)&&(A(a),a=a.next),a}function O(e,t){if(!e)return e;t=t||e;var r,n=e;do{if(r=!1,n.steiner||!C(n,n.next)&&0!==T(n.prev,n,n.next))n=n.next;else{if(A(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function P(e,t,r,n,i,o,a){if(e){if(!a&&o){for(var s=e,u=n,l=i,c=o,f=s;0===f.z&&(f.z=k(f.x,f.y,u,l,c)),f.prevZ=f.prev,f.nextZ=f.next,(f=f.next)!==s;);f.prevZ.nextZ=null,f.prevZ=null;var h,p,d,y,g,m,v,b,_=f,w=1;do{for(p=_,g=_=null,m=0;p;){for(m++,d=p,h=v=0;h<w&&(v++,d=d.nextZ);h++);for(b=w;0<v||0<b&&d;)0!==v&&(0===b||!d||p.z<=d.z)?(p=(y=p).nextZ,v--):(d=(y=d).nextZ,b--),g?g.nextZ=y:_=y,y.prevZ=g,g=y;p=d}}while(g.nextZ=null,w*=2,1<m)}for(var x,S,j=e;e.prev!==e.next;)if(x=e.prev,S=e.next,o?function(e,t,r,n){var i=e.prev,o=e,a=e.next;if(0<=T(i,o,a))return;var s=i.x,u=o.x,l=a.x,c=i.y,f=o.y,h=a.y,p=s<u?s<l?s:l:u<l?u:l,d=c<f?c<h?c:h:f<h?f:h,y=u<s?l<s?s:l:l<u?u:l,g=f<c?h<c?c:h:h<f?f:h,m=k(p,d,t,r,n),v=k(y,g,t,r,n),b=e.prevZ,_=e.nextZ;for(;b&&b.z>=m&&_&&_.z<=v;){if(b.x>=p&&b.x<=y&&b.y>=d&&b.y<=g&&b!==i&&b!==a&&E(s,c,u,f,l,h,b.x,b.y)&&0<=T(b.prev,b,b.next))return;if(b=b.prevZ,_.x>=p&&_.x<=y&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&E(s,c,u,f,l,h,_.x,_.y)&&0<=T(_.prev,_,_.next))return;_=_.nextZ}for(;b&&b.z>=m;){if(b.x>=p&&b.x<=y&&b.y>=d&&b.y<=g&&b!==i&&b!==a&&E(s,c,u,f,l,h,b.x,b.y)&&0<=T(b.prev,b,b.next))return;b=b.prevZ}for(;_&&_.z<=v;){if(_.x>=p&&_.x<=y&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&E(s,c,u,f,l,h,_.x,_.y)&&0<=T(_.prev,_,_.next))return;_=_.nextZ}return 1}(e,n,i,o):function(e){var t=e.prev,r=e,e=e.next;if(0<=T(t,r,e))return;var n=t.x,i=r.x,o=e.x,a=t.y,s=r.y,u=e.y,l=n<i?n<o?n:o:i<o?i:o,c=a<s?a<u?a:u:s<u?s:u,f=i<n?o<n?n:o:o<i?i:o,h=s<a?u<a?a:u:u<s?s:u,p=e.next;for(;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=c&&p.y<=h&&E(n,a,i,s,o,u,p.x,p.y)&&0<=T(p.prev,p,p.next))return;p=p.next}return 1}(e))t.push(x.i/r|0),t.push(e.i/r|0),t.push(S.i/r|0),A(e),e=S.next,j=S.next;else if((e=S)===j){a?1===a?P(e=function(e,t,r){var n=e;do{var i=n.prev,o=n.next.next}while(!C(i,o)&&R(i,n,n.next,o)&&M(i,o)&&M(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),A(n),A(n.next),n=e=o),n=n.next,n!==e);return O(n)}(O(e),t,r),t,r,n,i,o,2):2===a&&function(e,t,r,n,i,o){var a=e;do{for(var s,u=a.next.next;u!==a.prev;){if(a.i!==u.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&R(r,r.next,e,t))return 1}while(r=r.next,r!==e);return}(e,t)&&(M(e,t)&&M(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;for(;r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next,r!==e;);return n}(e,t)&&(T(e.prev,e,t.prev)||T(e,t.prev,t))||C(e,t)&&0<T(e.prev,e,e.next)&&0<T(t.prev,t,t.next))}(a,u))return s=I(a,u),a=O(a,a.next),s=O(s,s.next),P(a,t,r,n,i,o,0),P(s,t,r,n,i,o,0);u=u.next}}while(a=a.next,a!==e)}(e,t,r,n,i,o):P(O(e),t,r,n,i,o,1);break}}}function g(e,t){return e.x-t.x}function k(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function E(e,t,r,n,i,o,a,s){return(e-a)*(o-s)<=(i-a)*(t-s)&&(r-a)*(t-s)<=(e-a)*(n-s)&&(i-a)*(n-s)<=(r-a)*(o-s)}function T(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function C(e,t){return e.x===t.x&&e.y===t.y}function R(e,t,r,n){var i=l(T(e,t,r)),o=l(T(e,t,n)),a=l(T(r,n,e)),s=l(T(r,n,t));return i!==o&&a!==s||0===i&&u(e,r,t)||0===o&&u(e,n,t)||0===a&&u(r,e,n)||!(0!==s||!u(r,t,n))}function u(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function l(e){return 0<e?1:e<0?-1:0}function M(e,t){return T(e.prev,e,e.next)<0?0<=T(e,t,e.next)&&0<=T(e,e.prev,t):T(e,t,e.prev)<0||T(e,e.next,t)<0}function I(e,t){var r=new a(e.i,e.x,e.y),n=new a(t.i,t.x,t.y),i=e.next,o=t.prev;return(e.next=t).prev=e,(r.next=i).prev=r,(n.next=r).prev=n,(o.next=n).prev=o,n}function s(e,t,r,n){e=new a(e,t,r);return n?(e.next=n.next,(e.prev=n).next.prev=e,n.next=e):(e.prev=e).next=e,e}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function a(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function m(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}t.exports=n,(t.exports.default=n).deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(m(e,0,o,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;a-=Math.abs(m(e,l,c,r))}for(var f=0,s=0;s<n.length;s+=3){var h=n[s]*r,p=n[s+1]*r,d=n[s+2]*r;f+=Math.abs((e[h]-e[d])*(e[1+p]-e[1+h])-(e[h]-e[p])*(e[1+d]-e[1+h]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},n.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);0<i&&(n+=e[i-1].length,r.holes.push(n))}return r}},{}],9:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n="object"===("undefined"==typeof Reflect?"undefined":a(Reflect))?Reflect:null,u=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};var i=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(s,u){return new Promise(function(e,t){function r(e){s.removeListener(u,n),t(e)}function n(){"function"==typeof s.removeListener&&s.removeListener("error",r),e([].slice.call(arguments))}var i,o,a;m(s,u,n,{once:!0}),"error"!==u&&(o=r,a={once:!0},"function"==typeof(i=s).on)&&m(i,"error",o,a)})},(s.EventEmitter=s).prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+a(e))}function f(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,r,n){var i,o;return c(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener||r),i=e._events),o=i[t]),void 0===o?(o=i[t]=r,++e._eventsCount):("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),0<(i=f(e))&&o.length>i&&!o.warned&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,r=n,console)&&console.warn&&console.warn(r)),e}function p(e,t,r){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e);return t.listener=r,e.wrapFn=t}function d(e,t,r){e=e._events;if(void 0===e)return[];e=e[t];if(void 0===e)return[];if("function"==typeof e)return r?[e.listener||e]:[e];if(r){for(var n=e,i=new Array(n.length),o=0;o<i.length;++o)i[o]=n[o].listener||n[o];return i}return g(e,e.length)}function y(e){var t=this._events;if(void 0!==t){t=t[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(r,n,i,o){if("function"==typeof r.on)o.once?r.once(n,i):r.on(n,i);else{if("function"!=typeof r.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+a(r));r.addEventListener(n,function e(t){o.once&&r.removeEventListener(n,e),i(t)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return f(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){if((o=0<t.length?t[0]:o)instanceof Error)throw o;n=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw n.context=o,n}var o=i[e];if(void 0===o)return!1;if("function"==typeof o)u(o,this,t);else for(var a=o.length,s=g(o,a),r=0;r<a;++r)u(s[r],this,t);return!0},s.prototype.on=s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},s.prototype.off=s.prototype.removeListener=function(e,t){var r,n,i,o,a;if(c(t),void 0!==(n=this._events)&&void 0!==(r=n[e]))if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;0<=o;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;if(0===i)r.shift();else{for(var s=r,u=i;u+1<s.length;u++)s[u]=s[u+1];s.pop()}1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.removeAllListeners=function(e){var t,r=this._events;if(void 0!==r)if(void 0===r.removeListener)0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]);else if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0}else if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},s.prototype.listeners=function(e){return d(this,e,!0)},s.prototype.rawListeners=function(e){return d(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):y.call(e,t)},s.prototype.listenerCount=y,s.prototype.eventNames=function(){return 0<this._eventsCount?i(this._events):[]}},{}],10:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0});var l=e("../predictor.js"),e=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n,s,i;return t=e,(r=[{key:"decode",value:(s=O().mark(function e(t,r){var n,i,o,a;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decodeBlock(r);case 2:if(n=e.sent,1!==(i=t.Predictor||1))return a=!t.StripOffsets,o=a?t.TileWidth:t.ImageWidth,a=a?t.TileLength:t.RowsPerStrip||t.ImageLength,e.abrupt("return",(0,l.applyPredictor)(n,i,o,a,t.BitsPerSample,t.PlanarConfiguration));e.next=9;break;case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}),i=function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})},function(e,t){return i.apply(this,arguments)})}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=e},{"../predictor.js":27}],11:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){return e&&e.__esModule?e:{default:e}},l=(Object.defineProperty(r,"__esModule",{value:!0}),e("pako")),n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(){var e=this,t=i;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"decodeBlock",value:function(e){return(0,l.inflate)(new Uint8Array(e)).buffer}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n(e("./basedecoder.js")).default);r.default=n},{"./basedecoder.js":10,pako:43}],12:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=(Object.defineProperty(r,"__esModule",{value:!0}),r.getDecoder=r.addDecoder=void 0,new Map);function s(e,t){(e=Array.isArray(e)?e:[e]).forEach(function(e){return a.set(e,t)})}function l(){var s;return s=O().mark(function e(t){var r,n;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.get(t.Compression)){e.next=3;break}throw new Error("Unknown compression method identifier: ".concat(t.Compression));case 3:return e.next=5,r();case 5:return n=e.sent,e.abrupt("return",new n(t));case 7:case"end":return e.stop()}},e)}),(l=function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}).apply(this,arguments)}r.addDecoder=s,r.getDecoder=function(e){return l.apply(this,arguments)},s([void 0,1],function(){return Promise.resolve().then(function(){return o(e("./raw.js"))}).then(function(e){return e.default})}),s(5,function(){return Promise.resolve().then(function(){return o(e("./lzw.js"))}).then(function(e){return e.default})}),s(6,function(){throw new Error("old style JPEG compression is not supported.")}),s(7,function(){return Promise.resolve().then(function(){return o(e("./jpeg.js"))}).then(function(e){return e.default})}),s([8,32946],function(){return Promise.resolve().then(function(){return o(e("./deflate.js"))}).then(function(e){return e.default})}),s(32773,function(){return Promise.resolve().then(function(){return o(e("./packbits.js"))}).then(function(e){return e.default})}),s(34887,function(){return Promise.resolve().then(function(){return o(e("./lerc.js"))}).then(function(e){return e.default})}),s(50001,function(){return Promise.resolve().then(function(){return o(e("./webimage.js"))}).then(function(e){return e.default})})},{"./deflate.js":11,"./jpeg.js":13,"./lerc.js":14,"./lzw.js":15,"./packbits.js":16,"./raw.js":17,"./webimage.js":18}],13:[function(e,t,r){"use strict";function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==H(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===H(e)?e:String(e)}(n.key),n)}}function u(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=function(e){return e&&e.__esModule?e:{default:e}},l=(Object.defineProperty(r,"__esModule",{value:!0}),l(e("./basedecoder.js"))),X=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function Z(e,t){for(var r=0,n=[],i=16;0<i&&!e[i-1];)--i;n.push({children:[],index:0});for(var o,a=n[0],s=0;s<i;s++){for(var u=0;u<e[s];u++){for((a=n.pop()).children[a.index]=t[r];0<a.index;)a=n.pop();for(a.index++,n.push(a);n.length<=s;)n.push(o={children:[],index:0}),a.children[a.index]=o.children,a=o;r++}s+1<i&&(n.push(o={children:[],index:0}),a.children[a.index]=o.children,a=o)}return n[0].children}function K(t,e,r,n,D,l,c,i,f){var o=r.mcusPerLine,F=r.progressive,N=e,a=e,s=0,u=0;function h(){if(0<u)return s>>--u&1;if(255===(s=t[a++])){var e=t[a++];if(e)throw new Error("unexpected marker: ".concat((s<<8|e).toString(16)))}return s>>>(u=7)}function p(e){for(var t,r=e;null!==(t=h());){if("number"==typeof(r=r[t]))return r;if("object"!==H(r))throw new Error("invalid huffman sequence")}return null}function d(e){for(var t=e,r=0;0<t;){var n=h();if(null===n)return;r=r<<1|n,--t}return r}function y(e){var t=d(e);return 1<<e-1<=t?t:t+(-1<<e)+1}var g=0;var m,v=0;for(var b,_,w,x,S,j,O,P,k,E,B,T,C,R=n.length,G=F?0===l?0===i?function(e,t){var r=0===(r=p(e.huffmanTableDC))?0:y(r)<<f;e.pred+=r,t[0]=e.pred}:function(e,t){t[0]|=h()<<f}:0===i?function(e,t){if(0<g)g--;else for(var r=l,n=c;r<=n;){var i=p(e.huffmanTableAC),o=15&i,i=i>>4;if(0==o){if(i<15){g=d(i)+(1<<i)-1;break}r+=16}else t[X[r+=i]]=y(o)*(1<<f),r++}}:function(e,t){for(var r=l,n=c,i=0;r<=n;){var o=X[r],a=t[o]<0?-1:1;switch(v){case 0:var s=p(e.huffmanTableAC),u=15&s,i=s>>4;if(0==u)v=i<15?(g=d(i)+(1<<i),4):(i=16,1);else{if(1!=u)throw new Error("invalid ACn encoding");m=y(u),v=i?2:3}continue;case 1:case 2:t[o]?t[o]+=(h()<<f)*a:0===--i&&(v=2===v?3:0);break;case 3:t[o]?t[o]+=(h()<<f)*a:(t[o]=m<<f,v=0);break;case 4:t[o]&&(t[o]+=(h()<<f)*a)}r++}4===v&&0===--g&&(v=0)}:function(e,t){for(var r=0===(r=p(e.huffmanTableDC))?0:y(r),n=(e.pred+=r,t[0]=e.pred,1);n<64;){var i=p(e.huffmanTableAC),o=15&i,i=i>>4;if(0==o){if(i<15)break;n+=16}else t[X[n+=i]]=y(o),n++}},M=0,I=1===R?n[0].blocksPerLine*n[0].blocksPerColumn:o*r.mcusPerColumn,U=D||I;M<I;){for(b=0;b<R;b++)n[b].pred=0;if(g=0,1===R)for(A=n[0],w=0;w<U;w++)B=G,C=void 0,C=(T=M)/(E=A).blocksPerLine|0,T%=E.blocksPerLine,B(E,E.blocks[C][T]),M++;else for(w=0;w<U;w++){for(b=0;b<R;b++)for(var A,z=A=n[b],W=z.h,V=z.v,L=0;L<V;L++)for(_=0;_<W;_++)j=G,P=L,k=_,P=((O=M)/o|0)*(S=A).v+P,O=O%o*S.h+k,j(S,S.blocks[P][O]);if(++M===I)break}if(u=0,(x=t[a]<<8|t[a+1])<65280)throw new Error("marker was not found");if(!(65488<=x&&x<=65495))break;a+=2}return a-N}function b(e,t){var r=[],n=t.blocksPerLine,i=t.blocksPerColumn,o=n<<3,a=new Int32Array(64),s=new Uint8Array(64);for(var u=0;u<i;u++){for(var l=u<<3,c=0;c<8;c++)r.push(new Uint8Array(o));for(var f=0;f<n;f++){T=E=k=P=O=_=b=v=m=g=y=d=p=h=j=S=x=w=void 0;for(var h,p,d,y,g,m,v,b,_,w=t.blocks[u][f],x=s,S=a,j=t.quantizationTable,O=S,P=0;P<64;P++)O[P]=w[P]*j[P];for(P=0;P<8;++P){var k=8*P;0===O[1+k]&&0===O[2+k]&&0===O[3+k]&&0===O[4+k]&&0===O[5+k]&&0===O[6+k]&&0===O[7+k]?(_=5793*O[0+k]+512>>10,O[0+k]=_,O[1+k]=_,O[2+k]=_,O[3+k]=_,O[4+k]=_,O[5+k]=_,O[6+k]=_,O[7+k]=_):(h=5793*O[0+k]+128>>8,p=5793*O[4+k]+128>>8,d=O[2+k],y=O[6+k],g=2896*(O[1+k]-O[7+k])+128>>8,b=2896*(O[1+k]+O[7+k])+128>>8,m=O[3+k]<<4,_=h-p+1>>1,h=h+p+1>>1,p=_,_=3784*d+1567*y+128>>8,d=1567*d-3784*y+128>>8,y=_,_=g-(v=O[5+k]<<4)+1>>1,g=g+v+1>>1,v=_,_=b+m+1>>1,m=b-m+1>>1,b=_,_=h-y+1>>1,h=h+y+1>>1,y=_,_=p-d+1>>1,p=p+d+1>>1,d=_,_=2276*g+3406*b+2048>>12,g=3406*g-2276*b+2048>>12,b=_,_=799*m+4017*v+2048>>12,m=4017*m-799*v+2048>>12,v=_,O[0+k]=h+b,O[7+k]=h-b,O[1+k]=p+v,O[6+k]=p-v,O[2+k]=d+m,O[5+k]=d-m,O[3+k]=y+g,O[4+k]=y-g)}for(P=0;P<8;++P){var E=P;0===O[8+E]&&0===O[16+E]&&0===O[24+E]&&0===O[32+E]&&0===O[40+E]&&0===O[48+E]&&0===O[56+E]?(_=5793*S[P+0]+8192>>14,O[0+E]=_,O[8+E]=_,O[16+E]=_,O[24+E]=_,O[32+E]=_,O[40+E]=_,O[48+E]=_,O[56+E]=_):(h=5793*O[0+E]+2048>>12,p=5793*O[32+E]+2048>>12,d=O[16+E],y=O[48+E],g=2896*(O[8+E]-O[56+E])+2048>>12,b=2896*(O[8+E]+O[56+E])+2048>>12,m=O[24+E],_=h-p+1>>1,h=h+p+1>>1,p=_,_=3784*d+1567*y+2048>>12,d=1567*d-3784*y+2048>>12,y=_,_=g-(v=O[40+E])+1>>1,g=g+v+1>>1,v=_,_=b+m+1>>1,m=b-m+1>>1,b=_,_=h-y+1>>1,h=h+y+1>>1,y=_,_=p-d+1>>1,p=p+d+1>>1,d=_,_=2276*g+3406*b+2048>>12,g=3406*g-2276*b+2048>>12,b=_,_=799*m+4017*v+2048>>12,m=4017*m-799*v+2048>>12,v=_,O[0+E]=h+b,O[56+E]=h-b,O[8+E]=p+v,O[48+E]=p-v,O[16+E]=d+m,O[40+E]=d-m,O[24+E]=y+g,O[32+E]=y-g)}for(P=0;P<64;++P){var T=128+(O[P]+8>>4);x[P]=T<0?0:255<T?255:T}for(var C=0,R=f<<3,M=0;M<8;M++)for(var I=r[l+M],A=0;A<8;A++)I[R+A]=s[C++]}}return r}var c=function(){function e(){s(this,e),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return u(e,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(t){var r=0;function e(){var e=t[r]<<8|t[r+1];return r+=2,e}var n=e();if(65496!==n)throw new Error("SOI not found");for(n=e();65497!==n;){switch(n){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:void 0,L=void 0,L=e(),L=t.subarray(r,r+L-2),r+=L.length;65504===n&&74===L[0]&&70===L[1]&&73===L[2]&&70===L[3]&&0===L[4]&&(this.jfif={version:{major:L[5],minor:L[6]},densityUnits:L[7],xDensity:L[8]<<8|L[9],yDensity:L[10]<<8|L[11],thumbWidth:L[12],thumbHeight:L[13],thumbData:L.subarray(14,14+3*L[12]*L[13])}),65518===n&&65===L[0]&&100===L[1]&&111===L[2]&&98===L[3]&&101===L[4]&&0===L[5]&&(this.adobe={version:L[6],flags0:L[7]<<8|L[8],flags1:L[9]<<8|L[10],transformCode:L[11]});break;case 65499:for(var D=e()+r-2;r<D;){var i=t[r++],o=new Int32Array(64);if(i>>4==0)for(var a=0;a<64;a++)o[X[a]]=t[r++];else{if(i>>4!=1)throw new Error("DQT: invalid table spec");for(var s=0;s<64;s++)o[X[s]]=e()}this.quantizationTables[15&i]=o}break;case 65472:case 65473:case 65474:e();for(var u={extended:65473===n,progressive:65474===n,precision:t[r++],scanLines:e(),samplesPerLine:e(),components:{},componentsOrder:[]},F=t[r++],l=0;l<F;l++){var c=t[r],N=t[r+1]>>4,B=15&t[r+1],G=t[r+2];u.componentsOrder.push(c),u.components[c]={h:N,v:B,quantizationIdx:G},r+=3}O=j=S=x=w=_=b=v=g=y=f=m=d=p=h=void 0;var f,h=u,p=0,d=0;for(f in h.components)h.components.hasOwnProperty(f)&&(p<(m=h.components[f]).h&&(p=m.h),d<m.v)&&(d=m.v);var y=Math.ceil(h.samplesPerLine/8/p),g=Math.ceil(h.scanLines/8/d);for(f in h.components)if(h.components.hasOwnProperty(f)){for(var m=h.components[f],v=Math.ceil(Math.ceil(h.samplesPerLine/8)*m.h/p),b=Math.ceil(Math.ceil(h.scanLines/8)*m.v/d),_=y*m.h,w=g*m.v,x=[],S=0;S<w;S++){for(var j=[],O=0;O<_;O++)j.push(new Int32Array(64));x.push(j)}m.blocksPerLine=v,m.blocksPerColumn=b,m.blocks=x}h.maxH=p,h.maxV=d,h.mcusPerLine=y,h.mcusPerColumn=g,this.frames.push(u);break;case 65476:for(var U=e(),P=2;P<U;){for(var k=t[r++],E=new Uint8Array(16),T=0,C=0;C<16;C++,r++)E[C]=t[r],T+=E[C];for(var R=new Uint8Array(T),M=0;M<T;M++,r++)R[M]=t[r];P+=17+T,k>>4==0?this.huffmanTablesDC[15&k]=Z(E,R):this.huffmanTablesAC[15&k]=Z(E,R)}break;case 65501:e(),this.resetInterval=e();break;case 65498:e();for(var z=t[r++],I=[],W=this.frames[0],V=0;V<z;V++){var A=W.components[t[r++]],H=t[r++];A.huffmanTableDC=this.huffmanTablesDC[H>>4],A.huffmanTableAC=this.huffmanTablesAC[15&H],I.push(A)}var L=t[r++],q=t[r++],Y=t[r++],q=K(t,r,W,I,this.resetInterval,L,q,Y>>4,15&Y);r+=q;break;case 65535:255!==t[r]&&r--;break;default:if(255===t[r-3]&&192<=t[r-2]&&t[r-2]<=254){r-=3;break}throw new Error("unknown JPEG marker ".concat(n.toString(16)))}n=e()}}},{key:"getResult",value:function(){var e=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");1<this.frames.length&&console.warn("more than one frame is not supported");for(var t=0;t<this.frames.length;t++)for(var r=this.frames[t].components,n=0,i=Object.keys(r);n<i.length;n++){var o=i[n];r[o].quantizationTable=this.quantizationTables[r[o].quantizationIdx],delete r[o].quantizationIdx}for(var a=e[0],s=a.components,u=a.componentsOrder,l=[],c=a.samplesPerLine,f=a.scanLines,t=0;t<u.length;t++){var h=s[u[t]];l.push({lines:b(0,h),scaleX:h.h/a.maxH,scaleY:h.v/a.maxV})}for(var p=new Uint8Array(c*f*l.length),d=0,y=0;y<f;++y)for(var g=0;g<c;++g)for(var m=0;m<l.length;++m){var v=l[m];p[d]=v.lines[0|y*v.scaleY][0|g*v.scaleX],++d}return p}}]),e}(),e=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e);var r=o(n);function n(e){var t;return s(this,n),(t=r.call(this)).reader=new c,e.JPEGTables&&t.reader.parse(e.JPEGTables),t}return u(n,[{key:"decodeBlock",value:function(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}]),n}(l.default);r.default=e},{"./basedecoder.js":10}],14:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){return e&&e.__esModule?e:{default:e}},l=(Object.defineProperty(r,"__esModule",{value:!0}),e("pako")),c=n(e("lerc")),n=n(e("./basedecoder.js")),f=e("../globals.js"),e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).planarConfiguration=void 0!==e.PlanarConfiguration?e.PlanarConfiguration:1,t.samplesPerPixel=void 0!==e.SamplesPerPixel?e.SamplesPerPixel:1,t.addCompression=e.LercParameters[f.LercParameters.AddCompression],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"decodeBlock",value:function(e){switch(this.addCompression){case f.LercAddCompression.None:break;case f.LercAddCompression.Deflate:e=(0,l.inflate)(new Uint8Array(e)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return c.default.decode(e,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../globals.js":24,"./basedecoder.js":10,lerc:62,pako:43}],15:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(r,"__esModule",{value:!0}),n(e("./basedecoder.js"))),g=257;function m(e,t){for(var r=t.length-1;0<=r;r--)e.push(t[r])}function l(e){for(var n=new Uint16Array(4093),i=new Uint8Array(4093),t=0;t<=257;t++)n[t]=4096,i[t]=t;var r=258,l=9,c=0;function o(){r=258,l=9}function a(e){e=e,r=l,n=(t=c)%8,i=Math.floor(t/8),o=8-n,a=t+r-8*(i+1),u=8*(i+2)-(t+r),s=8*(i+2)-t,u=Math.max(0,u);var t,r,n,i,o,a,s,u=i>=e.length?(console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),g):(n=e[i]&Math.pow(2,8-n)-1,o=n<<=r-o,i+1<e.length&&(n=e[i+1]>>>u,o+=n<<=Math.max(0,r-s)),8<a&&i+2<e.length&&(o+=e[i+2]>>>8*(i+3)-(t+r)),o);return c+=l,u}function s(e,t){i[r]=t,n[r]=e,r++}function u(e){for(var t=[],r=e;4096!==r;r=n[r])t.push(i[r]);return t}for(var f,h=[],p=(o(),new Uint8Array(e)),d=a(p);d!==g;){if(256===d){for(o(),d=a(p);256===d;)d=a(p);if(d===g)break;if(256<d)throw new Error("corrupted code at scanline ".concat(d));m(h,u(d))}else if(d<r){var y=u(d);m(h,y),s(f,y[y.length-1])}else{y=u(f);if(!y)throw new Error("Bogus entry. Not in dictionary, ".concat(f," / ").concat(r,", position: ").concat(c));m(h,y),h.push(y[y.length-1]),s(f,y[y.length-1])}f=d,r+1>=Math.pow(2,l)&&(12===l?f=void 0:l++),d=a(p)}return new Uint8Array(h)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(){var e=this,t=i;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"decodeBlock",value:function(e){return l(e).buffer}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"./basedecoder.js":10}],16:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(){var e=this,t=i;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"decodeBlock",value:function(e){for(var t=new DataView(e),r=[],n=0;n<e.byteLength;++n)if((o=t.getInt8(n))<0){for(var i=t.getUint8(n+1),o=-o,a=0;a<=o;++a)r.push(i);n+=1}else{for(var s=0;s<=o;++s)r.push(t.getUint8(n+s+1));n+=o+1}return new Uint8Array(r).buffer}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n(e("./basedecoder.js")).default);r.default=n},{"./basedecoder.js":10}],17:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(){var e=this,t=i;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"decodeBlock",value:function(e){return e}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n(e("./basedecoder.js")).default);r.default=n},{"./basedecoder.js":10}],18:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});n=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,s,n,i=c(o);function o(){var e;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");if(e=i.call(this),"undefined"==typeof createImageBitmap)throw new Error("Cannot decode WebImage as `createImageBitmap` is not available");if("undefined"==typeof document&&"undefined"==typeof OffscreenCanvas)throw new Error("Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available");return e}return t=o,(e=[{key:"decode",value:(s=O().mark(function e(t,r){var n,i,o;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Blob([r]),e.next=3,createImageBitmap(n);case 3:return n=e.sent,"undefined"!=typeof document?((i=document.createElement("canvas")).width=n.width,i.height=n.height):i=new OffscreenCanvas(n.width,n.height),(o=i.getContext("2d")).drawImage(n,0,0),e.abrupt("return",o.getImageData(0,0,n.width,n.height).data.buffer);case 8:case"end":return e.stop()}},e)}),n=function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})},function(e,t){return n.apply(this,arguments)})}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n(e("./basedecoder.js")).default);r.default=n},{"./basedecoder.js":10}],19:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function i(e,t,r,n){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=n}var e,t,r;return e=i,(t=[{key:"sliceOffset",get:function(){return this._sliceOffset}},{key:"sliceTop",get:function(){return this._sliceOffset+this.buffer.byteLength}},{key:"littleEndian",get:function(){return this._littleEndian}},{key:"bigTiff",get:function(){return this._bigTiff}},{key:"buffer",get:function(){return this._dataView.buffer}},{key:"covers",value:function(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}},{key:"readUint8",value:function(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}},{key:"readInt8",value:function(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}},{key:"readUint16",value:function(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}},{key:"readInt16",value:function(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}},{key:"readUint32",value:function(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}},{key:"readInt32",value:function(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}},{key:"readFloat32",value:function(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}},{key:"readFloat64",value:function(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}},{key:"readUint64",value:function(e){var t,r=this.readUint32(e),e=this.readUint32(e+4);if(this._littleEndian){if(t=r+Math.pow(2,32)*e,Number.isSafeInteger(t))return t}else if(t=Math.pow(2,32)*r+e,Number.isSafeInteger(t))return t;throw new Error("".concat(t," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues")}},{key:"readInt64",value:function(e){for(var t=0,r=0<(128&this._dataView.getUint8(e+(this._littleEndian?7:0))),n=!0,i=0;i<8;i++){var o=this._dataView.getUint8(e+(this._littleEndian?i:7-i));r&&(n?0!==o&&(o=255&~(o-1),n=!1):o=255&~o),t+=o*Math.pow(256,i)}return t=r?-t:t}},{key:"readOffset",value:function(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}])&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();r.default=o},{}],20:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("@petamoriken/float16"),e=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this._dataView=new DataView(e)}var e,r,n;return e=t,(r=[{key:"buffer",get:function(){return this._dataView.buffer}},{key:"getUint64",value:function(e,t){var r,n=this.getUint32(e,t),e=this.getUint32(e+4,t);if(t){if(r=n+Math.pow(2,32)*e,Number.isSafeInteger(r))return r}else if(r=Math.pow(2,32)*n+e,Number.isSafeInteger(r))return r;throw new Error("".concat(r," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues")}},{key:"getInt64",value:function(e,t){for(var r=0,n=0<(128&this._dataView.getUint8(e+(t?7:0))),i=!0,o=0;o<8;o++){var a=this._dataView.getUint8(e+(t?o:7-o));n&&(i?0!==a&&(a=255&~(a-1),i=!1):a=255&~a),r+=a*Math.pow(256,o)}return r=n?-r:r}},{key:"getUint8",value:function(e,t){return this._dataView.getUint8(e,t)}},{key:"getInt8",value:function(e,t){return this._dataView.getInt8(e,t)}},{key:"getUint16",value:function(e,t){return this._dataView.getUint16(e,t)}},{key:"getInt16",value:function(e,t){return this._dataView.getInt16(e,t)}},{key:"getUint32",value:function(e,t){return this._dataView.getUint32(e,t)}},{key:"getInt32",value:function(e,t){return this._dataView.getInt32(e,t)}},{key:"getFloat16",value:function(e,t){return(0,a.getFloat16)(this._dataView,e,t)}},{key:"getFloat32",value:function(e,t){return this._dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e,t){return this._dataView.getFloat64(e,t)}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=e},{"@petamoriken/float16":2}],21:[function(e,D,t){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(){k=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function r(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function E(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function l(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function h(r){var n=o();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function F(e){var r="function"==typeof Map?new Map:void 0;return function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return i(e,arguments,s(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)}(e)}function i(e,t,r){return(i=o()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&a(t,r.prototype),t}).apply(null,arguments)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function p(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var N=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},B=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&N(t,e,r);return B(t,e),t},m=function(e){return e&&e.__esModule?e:{default:e}},v=(Object.defineProperty(t,"__esModule",{value:!0}),t.GeoTIFFImage=t.Pool=t.writeArrayBuffer=t.fromUrls=t.fromBlob=t.fromFile=t.fromArrayBuffer=t.fromUrl=t.MultiGeoTIFF=t.GeoTIFF=t.setLogger=t.addDecoder=t.getDecoder=t.rgb=t.globals=void 0,m(e("./geotiffimage.js"))),G=(t.GeoTIFFImage=v.default,m(e("./dataview64.js"))),U=m(e("./dataslice.js")),m=m(e("./pool.js")),b=(t.Pool=m.default,e("./source/remote.js")),z=e("./source/arraybuffer.js"),W=e("./source/filereader.js"),V=e("./source/file.js"),_=e("./globals.js"),H=e("./geotiffwriter.js"),m=g(e("./globals.js")),m=(t.globals=m,g(e("./rgb.js"))),w=(t.rgb=m,e("./compression/index.js")),q=(Object.defineProperty(t,"getDecoder",{enumerable:!0,get:function(){return w.getDecoder}}),Object.defineProperty(t,"addDecoder",{enumerable:!0,get:function(){return w.addDecoder}}),e("./logging.js"));function x(e){switch(e){case _.fieldTypes.BYTE:case _.fieldTypes.ASCII:case _.fieldTypes.SBYTE:case _.fieldTypes.UNDEFINED:return 1;case _.fieldTypes.SHORT:case _.fieldTypes.SSHORT:return 2;case _.fieldTypes.LONG:case _.fieldTypes.SLONG:case _.fieldTypes.FLOAT:case _.fieldTypes.IFD:return 4;case _.fieldTypes.RATIONAL:case _.fieldTypes.SRATIONAL:case _.fieldTypes.DOUBLE:case _.fieldTypes.LONG8:case _.fieldTypes.SLONG8:case _.fieldTypes.IFD8:return 8;default:throw new RangeError("Invalid field type: ".concat(e))}}function S(e,t,r,n){var i=null,o=null,a=x(t);switch(t){case _.fieldTypes.BYTE:case _.fieldTypes.ASCII:case _.fieldTypes.UNDEFINED:i=new Uint8Array(r),o=e.readUint8;break;case _.fieldTypes.SBYTE:i=new Int8Array(r),o=e.readInt8;break;case _.fieldTypes.SHORT:i=new Uint16Array(r),o=e.readUint16;break;case _.fieldTypes.SSHORT:i=new Int16Array(r),o=e.readInt16;break;case _.fieldTypes.LONG:case _.fieldTypes.IFD:i=new Uint32Array(r),o=e.readUint32;break;case _.fieldTypes.SLONG:i=new Int32Array(r),o=e.readInt32;break;case _.fieldTypes.LONG8:case _.fieldTypes.IFD8:i=new Array(r),o=e.readUint64;break;case _.fieldTypes.SLONG8:i=new Array(r),o=e.readInt64;break;case _.fieldTypes.RATIONAL:i=new Uint32Array(2*r),o=e.readUint32;break;case _.fieldTypes.SRATIONAL:i=new Int32Array(2*r),o=e.readInt32;break;case _.fieldTypes.FLOAT:i=new Float32Array(r),o=e.readFloat32;break;case _.fieldTypes.DOUBLE:i=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError("Invalid field type: ".concat(t))}if(t!==_.fieldTypes.RATIONAL&&t!==_.fieldTypes.SRATIONAL)for(var s=0;s<r;++s)i[s]=o.call(e,n+s*a);else for(var u=0;u<r;u+=2)i[u]=o.call(e,n+u*a),i[u+1]=o.call(e,n+(u*a+4));return t===_.fieldTypes.ASCII?new TextDecoder("utf-8").decode(i):i}Object.defineProperty(t,"setLogger",{enumerable:!0,get:function(){return q.setLogger}});var Y=p(function e(t,r,n){y(this,e),this.fileDirectory=t,this.geoKeyDirectory=r,this.nextIFDByteOffset=n}),O=function(){f(n,F(Error));var r=h(n);function n(e){var t;return y(this,n),(t=r.call(this,"No image at index ".concat(e))).index=e,t}return p(n)}(),P=function(){function e(){y(this,e)}var t;return p(e,[{key:"readRasters",value:(t=l(k().mark(function e(){var t,r,n,i,o,a,s,u,l,c,f,h,p,d,y,g,m,v,b,_,w,x,S,j,O,P=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=0<P.length&&void 0!==P[0]?P[0]:{}).window,n=t.width,i=t.height,o=t.resX,a=t.resY,s=t.bbox,e.next=5,this.getImage();case 5:return u=e.sent,l=u,e.next=9,this.getImageCount();case 9:if(c=e.sent,f=u.getBoundingBox(),r&&s)throw new Error('Both "bbox" and "window" passed.');e.next=13;break;case 13:if(n||i)if(r&&(g=u.getOrigin(),g=T(g,2),h=g[0],g=g[1],m=u.getResolution(),m=T(m,2),y=m[0],m=m[1],s=[h+r[0]*y,g+r[1]*m,h+r[2]*y,g+r[3]*m]),h=s||f,n){if(o)throw new Error("Both width and resX passed");e.next=19}else e.next=20;else e.next=24;break;case 19:o=(h[2]-h[0])/n;case 20:if(i){if(a)throw new Error("Both width and resY passed");e.next=23}else e.next=24;break;case 23:a=(h[3]-h[1])/i;case 24:if(!o&&!a){e.next=48;break}p=[],d=0;case 27:if(d<c)return e.next=30,this.getImage(d);e.next=36;break;case 30:y=e.sent,g=y.fileDirectory,m=g.SubfileType,b=g.NewSubfileType,(0===d||2===m||1&b)&&p.push(y);case 33:++d,e.next=27;break;case 36:p.sort(function(e,t){return e.getWidth()-t.getWidth()}),v=0;case 38:if(v<p.length){if(b=p[v],_=(f[2]-f[0])/b.getWidth(),w=(f[3]-f[1])/b.getHeight(),l=b,o&&_<o||a&&w<a)return e.abrupt("break",48);e.next=45}else e.next=48;break;case 45:++v,e.next=38;break;case 48:return _=r,s&&(w=u.getOrigin(),S=T(w,2),x=S[0],S=S[1],O=l.getResolution(u),O=T(O,2),j=O[0],O=O[1],_=[Math.round((s[0]-x)/j),Math.round((s[1]-S)/O),Math.round((s[2]-x)/j),Math.round((s[3]-S)/O)],_=[Math.min(_[0],_[2]),Math.min(_[1],_[3]),Math.max(_[0],_[2]),Math.max(_[1],_[3])]),e.abrupt("return",l.readRasters(E(E({},t),{},{window:_})));case 51:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})}]),e}(),C=function(){f(c,P);var n,e,t,r,i,o,a,s=h(c);function c(e,t,r,n){var i,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};return y(this,c),(i=s.call(this)).source=e,i.littleEndian=t,i.bigTiff=r,i.firstIFDOffset=n,i.cache=o.cache||!1,i.ifdRequests=[],i.ghostValues=null,i}return p(c,[{key:"getSlice",value:(a=l(k().mark(function e(t,r){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.bigTiff?4048:1024,e.t0=U.default,e.next=4,this.source.fetch([{offset:t,length:void 0!==r?r:n}]);case 4:return e.t1=e.sent[0],e.t2=t,e.t3=this.littleEndian,e.t4=this.bigTiff,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 9:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"parseFileDirectoryAt",value:(o=l(k().mark(function e(t){var r,n,i,o,a,s,u,l,c,f,h,p,d,y,g,m,v,b;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.bigTiff?20:12,n=this.bigTiff?8:2,e.next=4,this.getSlice(t);case 4:if(i=e.sent,o=this.bigTiff?i.readUint64(t):i.readUint16(t),d=o*r+(this.bigTiff?16:6),i.covers(t,d)){e.next=11;break}return e.next=10,this.getSlice(t,d);case 10:i=e.sent;case 11:a={},s=t+(this.bigTiff?8:2),u=0;case 14:u<o?(l=i.readUint16(s),c=i.readUint16(s+2),f=this.bigTiff?i.readUint64(s+4):i.readUint32(s+4),p=h=void 0,d=x(c),y=s+(this.bigTiff?12:8),d*f<=(this.bigTiff?8:4)?(h=S(i,c,f,y),e.next=36):e.next=26):e.next=41;break;case 26:g=i.readOffset(y),m=x(c)*f,i.covers(g,m)?(h=S(i,c,f,g),e.next=36):e.next=32;break;case 32:return e.next=34,this.getSlice(g,m);case 34:v=e.sent,h=S(v,c,f,g);case 36:p=1===f&&-1===_.arrayFields.indexOf(l)&&c!==_.fieldTypes.RATIONAL&&c!==_.fieldTypes.SRATIONAL?h[0]:h,a[_.fieldTagNames[l]]=p;case 38:s+=r,++u,e.next=14;break;case 41:return v=function(e){var t=e.GeoKeyDirectory;if(!t)return null;for(var r={},n=4;n<=4*t[3];n+=4){var i=_.geoKeyNames[t[n]],o=t[n+1]?_.fieldTagNames[t[n+1]]:null,a=t[n+2],s=t[n+3],u=null;if(o){if(null==(u=e[o]))throw new Error("Could not get value of geoKey '".concat(i,"'."));"string"==typeof u?u=u.substring(s,s+a-1):u.subarray&&(u=u.subarray(s,s+a),1===a)&&(u=u[0])}else u=s;r[i]=u}return r}(a),b=i.readOffset(t+n+r*o),e.abrupt("return",new Y(a,v,b));case 44:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"requestIFD",value:(i=l(k().mark(function e(r){var n=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ifdRequests[r])return e.abrupt("return",this.ifdRequests[r]);e.next=4;break;case 4:if(0===r)return this.ifdRequests[r]=this.parseFileDirectoryAt(this.firstIFDOffset),e.abrupt("return",this.ifdRequests[r]);e.next=9;break;case 9:this.ifdRequests[r-1]?e.next=19:(e.prev=10,this.ifdRequests[r-1]=this.requestIFD(r-1),e.next=19);break;case 14:if(e.prev=14,e.t0=e.catch(10),e.t0 instanceof O)throw new O(r);e.next=18;break;case 18:throw e.t0;case 19:return this.ifdRequests[r]=l(k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ifdRequests[r-1];case 2:if(0===(t=e.sent).nextIFDByteOffset)throw new O(r);e.next=5;break;case 5:return e.abrupt("return",n.parseFileDirectoryAt(t.nextIFDByteOffset));case 6:case"end":return e.stop()}},e)}))(),e.abrupt("return",this.ifdRequests[r]);case 21:case"end":return e.stop()}},e,this,[[10,14]])})),function(e){return i.apply(this,arguments)})},{key:"getImage",value:(r=l(k().mark(function e(){var t,r=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:0,e.next=3,this.requestIFD(t);case 3:return t=e.sent,e.abrupt("return",new v.default(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source));case 5:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getImageCount",value:(t=l(k().mark(function e(){var t,r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!(t=0);case 2:if(r)return e.prev=3,e.next=6,this.requestIFD(t);e.next=18;break;case 6:++t,e.next=16;break;case 9:e.prev=9,e.t0=e.catch(3),e.t0 instanceof O?(r=!1,e.next=16):e.next=15;break;case 15:throw e.t0;case 16:e.next=2;break;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this,[[3,9]])})),function(){return t.apply(this,arguments)})},{key:"getGhostValues",value:(e=l(k().mark(function e(){var t,r,n,i,o,a,s=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.bigTiff?16:8,this.ghostValues)return e.abrupt("return",this.ghostValues);e.next=3;break;case 3:return n=(r="GDAL_STRUCTURAL_METADATA_SIZE=").length+100,e.next=7,this.getSlice(t,n);case 7:if(i=e.sent,r!==S(i,_.fieldTypes.ASCII,r.length,t))e.next=19;else{if(o=S(i,_.fieldTypes.ASCII,n,t),o=o.split("\n")[0],o=Number(o.split("=")[1].split(" ")[0])+o.length,n<o)return e.next=15,this.getSlice(t,o);e.next=16}break;case 15:i=e.sent;case 16:a=S(i,_.fieldTypes.ASCII,o,t),this.ghostValues={},a.split("\n").filter(function(e){return 0<e.length}).map(function(e){return e.split("=")}).forEach(function(e){var e=T(e,2),t=e[0],e=e[1];s.ghostValues[t]=e});case 19:return e.abrupt("return",this.ghostValues);case 20:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"close",value:function(){return"function"==typeof this.source.close&&this.source.close()}}],[{key:"fromSource",value:(n=l(k().mark(function e(t,r,n){var i,o,a,s,u,l;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetch([{offset:0,length:1024}],n);case 2:i=e.sent[0],i=new G.default(i),18761!==(o=i.getUint16(0,0))?e.next=9:(a=!0,e.next=14);break;case 9:19789!==o?e.next=13:(a=!1,e.next=14);break;case 13:throw new TypeError("Invalid byte order value.");case 14:42!==(s=i.getUint16(2,a))?e.next=19:(u=!1,e.next=27);break;case 19:if(43!==s)e.next=26;else{if(u=!0,8!==i.getUint16(4,a))throw new Error("Unsupported offset byte-size.");e.next=24}break;case 24:e.next=27;break;case 26:throw new TypeError("Invalid magic number.");case 27:return l=u?i.getUint64(8,a):i.getUint32(4,a),e.abrupt("return",new c(t,a,u,l,r));case 29:case"end":return e.stop()}},e)})),function(e,t,r){return n.apply(this,arguments)})}]),c}(),R=(t.GeoTIFF=C,t.default=C,function(){f(i,P);var e,t,r,n=h(i);function i(e,t){var r;return y(this,i),(r=n.call(this)).mainFile=e,r.overviewFiles=t,r.imageFiles=[e].concat(t),r.fileDirectoriesPerFile=null,r.fileDirectoriesPerFileParsing=null,r.imageCount=null,r}return p(i,[{key:"parseFileDirectoriesPerFile",value:(r=l(k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(function(e){return e.parseFileDirectoryAt(e.firstIFDOffset)})),e.next=3,Promise.all(t);case 3:return this.fileDirectoriesPerFile=e.sent,e.abrupt("return",this.fileDirectoriesPerFile);case 5:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getImage",value:(t=l(k().mark(function e(){var t,r,n,i,o,a,s,u=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<u.length&&void 0!==u[0]?u[0]:0,e.next=3,this.getImageCount();case 3:return e.next=5,this.parseFileDirectoriesPerFile();case 5:i=n=r=0;case 8:if(!(i<this.imageFiles.length)){e.next=26;break}o=this.imageFiles[i],a=0;case 11:if(a<this.imageCounts[i]){if(t===r)return e.next=15,o.requestIFD(n);e.next=17}else e.next=22;break;case 15:return s=e.sent,e.abrupt("return",new v.default(s.fileDirectory,s.geoKeyDirectory,o.dataView,o.littleEndian,o.cache,o.source));case 17:r++,n++;case 19:a++,e.next=11;break;case 22:n=0;case 23:i++,e.next=8;break;case 26:throw new RangeError("Invalid image index");case 27:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getImageCount",value:(e=l(k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.imageCount)return e.abrupt("return",this.imageCount);e.next=2;break;case 2:return t=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(function(e){return e.getImageCount()})),e.next=5,Promise.all(t);case 5:return this.imageCounts=e.sent,this.imageCount=this.imageCounts.reduce(function(e,t){return e+t},0),e.abrupt("return",this.imageCount);case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),i}());function M(){return(M=l(k().mark(function e(t){var r,n,i=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<i.length&&void 0!==i[1]?i[1]:{},n=2<i.length?i[2]:void 0,e.abrupt("return",C.fromSource((0,b.makeRemoteSource)(t,r),n));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function I(){return(I=l(k().mark(function e(t,r){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C.fromSource((0,z.makeBufferSource)(t),r));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(){return(A=l(k().mark(function e(t,r){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C.fromSource((0,V.makeFileSource)(t),r));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return(L=l(k().mark(function e(t,r){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C.fromSource((0,W.makeFileReaderSource)(t),r));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X(){return(X=l(k().mark(function e(t){var r,n,i,o,a=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<a.length&&void 0!==a[1]?a[1]:[],n=2<a.length&&void 0!==a[2]?a[2]:{},o=3<a.length?a[3]:void 0,e.next=5,C.fromSource((0,b.makeRemoteSource)(t,n),o);case 5:return i=e.sent,e.next=8,Promise.all(r.map(function(e){return C.fromSource((0,b.makeRemoteSource)(e,n))}));case 8:return o=e.sent,e.abrupt("return",new R(i,o));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}t.MultiGeoTIFF=R,t.fromUrl=function(e){return M.apply(this,arguments)},t.fromArrayBuffer=function(e,t){return I.apply(this,arguments)},t.fromFile=function(e,t){return A.apply(this,arguments)},t.fromBlob=function(e,t){return L.apply(this,arguments)},t.fromUrls=function(e){return X.apply(this,arguments)},t.writeArrayBuffer=function(e,t){return(0,H.writeGeotiff)(e,t)}},{"./compression/index.js":12,"./dataslice.js":19,"./dataview64.js":20,"./geotiffimage.js":22,"./geotiffwriter.js":23,"./globals.js":24,"./logging.js":25,"./pool.js":26,"./rgb.js":29,"./source/arraybuffer.js":30,"./source/file.js":37,"./source/filereader.js":38,"./source/remote.js":40}],22:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(){C=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function d(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}var i=function(e){return e&&e.__esModule?e:{default:e}},f=(Object.defineProperty(r,"__esModule",{value:!0}),e("@petamoriken/float16")),h=i(e("xml-utils/get-attribute.js")),p=i(e("xml-utils/find-tags-by-name.js")),O=e("./globals.js"),P=e("./rgb.js"),w=e("./compression/index.js"),R=e("./resample.js");function x(e,t,r){switch(e){case 1:if(t<=8)return new Uint8Array(r);if(t<=16)return new Uint16Array(r);if(t<=32)return new Uint32Array(r);break;case 2:if(8===t)return new Int8Array(r);if(16===t)return new Int16Array(r);if(32===t)return new Int32Array(r);break;case 3:switch(t){case 16:case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}i=function(){function a(e,t,r,n,i,o){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=n,this.tiles=i?{}:null,this.isTiled=!e.StripOffsets;t=e.PlanarConfiguration;if(this.planarConfiguration=void 0===t?1:t,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}var e,t,r,n,i,l,o;return e=a,(t=[{key:"getFileDirectory",value:function(){return this.fileDirectory}},{key:"getGeoKeys",value:function(){return this.geoKeys}},{key:"getWidth",value:function(){return this.fileDirectory.ImageWidth}},{key:"getHeight",value:function(){return this.fileDirectory.ImageLength}},{key:"getSamplesPerPixel",value:function(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}},{key:"getTileWidth",value:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}},{key:"getTileHeight",value:function(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}},{key:"getBlockWidth",value:function(){return this.getTileWidth()}},{key:"getBlockHeight",value:function(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}},{key:"getBytesPerPixel",value:function(){for(var e=0,t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}},{key:"getSampleByteSize",value:function(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index ".concat(e," is out of range."));return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}},{key:"getReaderForSample",value:function(e){var t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(r<=8)return DataView.prototype.getUint8;if(r<=16)return DataView.prototype.getUint16;if(r<=32)return DataView.prototype.getUint32;break;case 2:if(r<=8)return DataView.prototype.getInt8;if(r<=16)return DataView.prototype.getInt16;if(r<=32)return DataView.prototype.getInt32;break;case 3:switch(r){case 16:return function(e,t){return(0,f.getFloat16)(this,e,t)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}},{key:"getSampleFormat",value:function(){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[0<arguments.length&&void 0!==arguments[0]?arguments[0]:0]:1}},{key:"getBitsPerSample",value:function(){return this.fileDirectory.BitsPerSample[0<arguments.length&&void 0!==arguments[0]?arguments[0]:0]}},{key:"getArrayForSample",value:function(e,t){return x(this.getSampleFormat(e),this.getBitsPerSample(e),t)}},{key:"getTileOrStrip",value:(o=d(C().mark(function e(t,a,r,s,n){var i,o,u,l,c,f,h,p=this;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Math.ceil(this.getWidth()/this.getTileWidth()),c=Math.ceil(this.getHeight()/this.getTileHeight()),u=this.tiles,1===this.planarConfiguration?o=a*i+t:2===this.planarConfiguration&&(o=r*i*c+a*i+t),c=(this.isTiled?(l=this.fileDirectory.TileOffsets[o],this.fileDirectory.TileByteCounts):(l=this.fileDirectory.StripOffsets[o],this.fileDirectory.StripByteCounts))[o],e.next=7,this.source.fetch([{offset:l,length:c}],n);case 7:return f=e.sent[0],null!==u&&u[o]?h=u[o]:(h=d(C().mark(function e(){var n,i,o;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.decode(p.fileDirectory,f);case 2:return n=e.sent,i=p.getSampleFormat(),o=p.getBitsPerSample(),r=o,(1===(t=i)||2===t)&&r<=32&&r%8==0||3===t&&(16===r||32===r||64===r)||(n=function(e,t,r,n,i,o,a){var s=new DataView(e),u=2===r?1:n,l=x(t,i,2===r?a*o:a*o*n),c=parseInt("1".repeat(i),2);if(1===t){var e=1===r?n*i:i,f=o*e;0!=(7&f)&&(f=f+7&-8);for(var h=0;h<a;++h)for(var p=h*f,d=0;d<o;++d)for(var y=p+d*u*i,g=0;g<u;++g){var m,v=y+g*i,b=(h*o+d)*u+g,_=Math.floor(v/8),v=v%8;v+i<=8?l[b]=s.getUint8(_)>>8-i-v&c:v+i<=16?l[b]=s.getUint16(_)>>16-i-v&c:v+i<=24?(m=s.getUint16(_)<<8|s.getUint8(_+2),l[b]=m>>24-i-v&c):l[b]=s.getUint32(_)>>32-i-v&c}}return l.buffer}(n,i,p.planarConfiguration,p.getSamplesPerPixel(),o,p.getTileWidth(),p.getBlockHeight(a))),e.abrupt("return",n);case 7:case"end":return e.stop()}var t,r},e)}))(),null!==u&&(u[o]=h)),e.t0=t,e.t1=a,e.t2=r,e.next=14,h;case 14:return e.t3=e.sent,e.abrupt("return",{x:e.t0,y:e.t1,sample:e.t2,data:e.t3});case 16:case"end":return e.stop()}},e,this)})),function(e,t,r,n,i){return o.apply(this,arguments)})},{key:"_readRaster",value:(l=d(C().mark(function e(p,d,y,g,r,t,n,i,o){var m,v,b,_,a,s,u,w,x,S,j,l,c,O,f,P,h,k,E,T=this;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(m=this.getTileWidth(),v=this.getTileHeight(),b=this.getWidth(),_=this.getHeight(),a=Math.max(Math.floor(p[0]/m),0),s=Math.min(Math.ceil(p[2]/m),Math.ceil(b/m)),E=Math.max(Math.floor(p[1]/v),0),u=Math.min(Math.ceil(p[3]/v),Math.ceil(_/v)),w=p[2]-p[0],x=this.getBytesPerPixel(),S=[],j=[],l=0;l<d.length;++l)1===this.planarConfiguration?S.push(function(e,t,r){for(var n=0,i=t;i<r;++i)n+=e[i];return n}(this.fileDirectory.BitsPerSample,0,d[l])/8):S.push(0),j.push(this.getReaderForSample(d[l]));for(c=[],O=this.littleEndian,f=E;f<u;++f)for(P=a;P<s;++P)for(h=function(e){var h=e,t=d[e],e=(2===T.planarConfiguration&&(x=T.getSampleByteSize(e)),T.getTileOrStrip(P,f,t,r,o));c.push(e),e.then(function(e){for(var t=e.data,r=new DataView(t),t=T.getBlockHeight(e.y),n=e.y*v,i=e.x*m,e=(e.x+1)*m,o=j[h],a=Math.min(t,t-(n+t-p[3]),_-n),s=Math.min(m,m-(e-p[2]),b-i),u=Math.max(0,p[1]-n);u<a;++u)for(var l=Math.max(0,p[0]-i);l<s;++l){var c=(u*m+l)*x,c=o.call(r,c+S[h],O),f=void 0;g?(f=(u+n-p[1])*w*d.length+(l+i-p[0])*d.length+h,y[f]=c):(f=(u+n-p[1])*w+l+i-p[0],y[h][f]=c)}})},k=0;k<d.length;++k)h(k);return e.next=18,Promise.all(c);case 18:if(t&&p[2]-p[0]!==t||n&&p[3]-p[1]!==n)return(E=g?(0,R.resampleInterleaved)(y,p[2]-p[0],p[3]-p[1],t,n,d.length,i):(0,R.resample)(y,p[2]-p[0],p[3]-p[1],t,n,i)).width=t,E.height=n,e.abrupt("return",E);e.next=23;break;case 23:return y.width=t||p[2]-p[0],y.height=n||p[3]-p[1],e.abrupt("return",y);case 26:case"end":return e.stop()}},e,this)})),function(e,t,r,n,i,o,a,s,u){return l.apply(this,arguments)})},{key:"readRasters",value:(i=d(C().mark(function e(){var t,r,n,i,o,a,s,u,l,c,f,h,p,d,y,g,m,v,b,_=arguments;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=(u=0<_.length&&void 0!==_[0]?_[0]:{}).window,r=u.samples,t=void 0===r?[]:r,r=u.interleave,n=u.pool,n=void 0===n?null:n,i=u.width,o=u.height,a=u.resampleMethod,s=u.fillValue,u=u.signal,(l=l||[0,0,this.getWidth(),this.getHeight()])[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");e.next=4;break;case 4:if(y=l[2]-l[0],g=l[3]-l[1],c=y*g,f=this.getSamplesPerPixel(),t&&t.length)e.next=12;else{for(h=0;h<f;++h)t.push(h);e.next=19}break;case 12:p=0;case 13:if(p<t.length){if(t[p]>=f)return e.abrupt("return",Promise.reject(new RangeError("Invalid sample index '".concat(t[p],"'."))));e.next=16}else e.next=19;break;case 16:++p,e.next=13;break;case 19:if(r)y=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,g=Math.max.apply(null,this.fileDirectory.BitsPerSample),d=x(y,g,c*t.length),s&&d.fill(s);else for(d=[],m=0;m<t.length;++m)v=this.getArrayForSample(t[m],c),Array.isArray(s)&&m<s.length?v.fill(s[m]):s&&!Array.isArray(s)&&v.fill(s),d.push(v);if(e.t0=n,e.t0){e.next=25;break}return e.next=24,(0,w.getDecoder)(this.fileDirectory);case 24:e.t0=e.sent;case 25:return b=e.t0,e.next=28,this._readRaster(l,t,d,r,b,i,o,a,u);case 28:return b=e.sent,e.abrupt("return",b);case 30:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"readRGB",value:(n=d(C().mark(function e(){var t,r,n,i,o,a,s,u,l,c,f,h,p,d,y,g,m,v,b,_,w,x,S=arguments;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(u=0<S.length&&void 0!==S[0]?S[0]:{}).window,r=u.interleave,r=void 0===r||r,n=u.pool,n=void 0===n?null:n,i=u.width,o=u.height,a=u.resampleMethod,s=u.enableAlpha,s=void 0!==s&&s,u=u.signal,(l=t||[0,0,this.getWidth(),this.getHeight()])[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");e.next=4;break;case 4:if((c=this.fileDirectory.PhotometricInterpretation)!==O.photometricInterpretations.RGB){e.next=9;break}if(f=[0,1,2],this.fileDirectory.ExtraSamples!==O.ExtraSamplesValues.Unspecified&&s)for(f=[],h=0;h<this.fileDirectory.BitsPerSample.length;h+=1)f.push(h);return e.abrupt("return",this.readRasters({window:t,interleave:r,samples:f,pool:n,width:i,height:o,resampleMethod:a,signal:u}));case 9:e.t0=c,e.next=e.t0===O.photometricInterpretations.WhiteIsZero||e.t0===O.photometricInterpretations.BlackIsZero||e.t0===O.photometricInterpretations.Palette?12:e.t0===O.photometricInterpretations.CMYK?14:e.t0===O.photometricInterpretations.YCbCr||e.t0===O.photometricInterpretations.CIELab?16:18;break;case 12:return p=[0],e.abrupt("break",19);case 14:return p=[0,1,2,3],e.abrupt("break",19);case 16:return p=[0,1,2],e.abrupt("break",19);case 18:throw new Error("Invalid or unsupported photometric interpretation.");case 19:return d={window:l,interleave:!0,samples:p,pool:n,width:i,height:o,resampleMethod:a,signal:u},y=this.fileDirectory,e.next=23,this.readRasters(d);case 23:g=e.sent,m=Math.pow(2,this.fileDirectory.BitsPerSample[0]),e.t1=c,e.next=e.t1===O.photometricInterpretations.WhiteIsZero?28:e.t1===O.photometricInterpretations.BlackIsZero?30:e.t1===O.photometricInterpretations.Palette?32:e.t1===O.photometricInterpretations.CMYK?34:e.t1===O.photometricInterpretations.YCbCr?36:e.t1===O.photometricInterpretations.CIELab?38:40;break;case 28:return v=(0,P.fromWhiteIsZero)(g,m),e.abrupt("break",41);case 30:return v=(0,P.fromBlackIsZero)(g,m),e.abrupt("break",41);case 32:return v=(0,P.fromPalette)(g,y.ColorMap),e.abrupt("break",41);case 34:return v=(0,P.fromCMYK)(g),e.abrupt("break",41);case 36:return v=(0,P.fromYCbCr)(g),e.abrupt("break",41);case 38:return v=(0,P.fromCIELab)(g),e.abrupt("break",41);case 40:throw new Error("Unsupported photometric interpretation.");case 41:if(!r){for(b=new Uint8Array(v.length/3),_=new Uint8Array(v.length/3),w=new Uint8Array(v.length/3),x=h=0;h<v.length;h+=3,++x)b[x]=v[h],_[x]=v[h+1],w[x]=v[h+2];v=[b,_,w]}return v.width=g.width,v.height=g.height,e.abrupt("return",v);case 45:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getTiePoints",value:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var e=[],t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}},{key:"getGDALMetadata",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e={};if(!this.fileDirectory.GDAL_METADATA)return null;for(var r=this.fileDirectory.GDAL_METADATA,n=(0,p.default)(r,"Item"),n=null===t?n.filter(function(e){return void 0===(0,h.default)(e,"sample")}):n.filter(function(e){return Number((0,h.default)(e,"sample"))===t}),i=0;i<n.length;++i){var o=n[i];e[(0,h.default)(o,"name")]=o.inner}return e}},{key:"getGDALNoData",value:function(){var e;return this.fileDirectory.GDAL_NODATA?(e=this.fileDirectory.GDAL_NODATA,Number(e.substring(0,e.length-1))):null}},{key:"getOrigin",value:function(){var e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}},{key:"getResolution",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(r)return[r[0],-r[1],r[2]];if(n)return[n[0],n[5],n[10]];if(t)return n=(r=s(t.getResolution(),3))[0],e=r[1],r=r[2],[n*t.getWidth()/this.getWidth(),e*t.getHeight()/this.getHeight(),r*t.getWidth()/this.getWidth()];throw new Error("The image does not have an affine transformation.")}},{key:"pixelIsArea",value:function(){return 1===this.geoKeys.GTRasterTypeGeoKey}},{key:"getBoundingBox",value:function(){var e=this.getOrigin(),t=this.getResolution(),r=e[0],e=e[1],n=r+t[0]*this.getWidth(),t=e+t[1]*this.getHeight();return[Math.min(r,n),Math.min(e,t),Math.max(r,n),Math.max(e,t)]}}])&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),a}();r.default=i},{"./compression/index.js":12,"./globals.js":24,"./resample.js":28,"./rgb.js":29,"@petamoriken/float16":2,"xml-utils/find-tags-by-name.js":426,"xml-utils/get-attribute.js":427}],23:[function(e,t,r){"use strict";function n(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=function(e,t){var r;if(e)return"string"==typeof e?s(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.writeGeotiff=void 0;function a(a,s,e,u){var l,c=e,e=Object.keys(u).filter(function(e){return null!=e&&"undefined"!==e}),f=(a.writeUshort(s,c,e.length),(c+=2)+12*e.length+4),t=n(e);try{for(t.s();!(l=t.n()).done;)!function(){var e=l.value,t=null,r=("number"==typeof e?t=e:"string"==typeof e&&(t=parseInt(e,10)),v.fieldTagTypes[t]),n=h[r];if(null==r||void 0===r)throw new Error("unknown type of tag: ".concat(t));var i=u[e];if(void 0===i)throw new Error("failed to get value for key ".concat(e));"ASCII"===r&&"string"==typeof i&&!1===(0,b.endsWith)(i,"\0")&&(i+="\0");var e=i.length,t=(a.writeUshort(s,c,t),c+=2,a.writeUshort(s,c,n),c+=2,a.writeUint(s,c,e),c+=4,[-1,1,1,2,4,8,0,0,0,0,0,0,8][n]*e),o=c;4<t&&(a.writeUint(s,c,f),o=f),"ASCII"===r?a.writeASCII(s,o,i):"SHORT"===r?(0,b.times)(e,function(e){a.writeUshort(s,o+2*e,i[e])}):"LONG"===r?(0,b.times)(e,function(e){a.writeUint(s,o+4*e,i[e])}):"RATIONAL"===r?(0,b.times)(e,function(e){a.writeUint(s,o+8*e,Math.round(1e4*i[e])),a.writeUint(s,o+8*e+4,1e4)}):"DOUBLE"===r&&(0,b.times)(e,function(e){a.writeDouble(s,o+8*e,i[e])}),4<t&&(f+=t+=1&t),c+=4}()}catch(e){t.e(e)}finally{t.f()}return[c,f]}var v=e("./globals.js"),b=e("./utils.js"),e=(0,b.invert)(v.fieldTagNames),i=(0,b.invert)(v.geoKeyNames),_={},h=((0,b.assign)(_,e),(0,b.assign)(_,i),(0,b.invert)(v.fieldTypeNames)),w=1e3,u={nextZero:function(e,t){for(var r=t;0!==e[r];)r++;return r},readUshort:function(e,t){return e[t]<<8|e[t+1]},readShort:function(e,t){var r=u.ui8;return r[0]=e[t+1],r[1]=e[t+0],u.i16[0]},readInt:function(e,t){var r=u.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],u.i32[0]},readUint:function(e,t){var r=u.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],u.ui32[0]},readASCII:function(t,r,e){return e.map(function(e){return String.fromCharCode(t[r+e])}).join("")},readFloat:function(t,r){var n=u.ui8;return(0,b.times)(4,function(e){n[e]=t[r+3-e]}),u.fl32[0]},readDouble:function(t,r){var n=u.ui8;return(0,b.times)(8,function(e){n[e]=t[r+7-e]}),u.fl64[0]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:function(t,r,n){(0,b.times)(n.length,function(e){t[r+e]=n.charCodeAt(e)})},ui8:new Uint8Array(8)},x=(u.fl64=new Float64Array(u.ui8.buffer),u.writeDouble=function(t,r,e){u.fl64[0]=e,(0,b.times)(8,function(e){t[r+e]=u.ui8[7-e]})},function(r){var n=new Uint8Array(w),i=u,o=(n[0]=77,n[1]=77,n[3]=42,8);if(i.writeUint(n,4,o),r.forEach(function(e,t){e=a(i,n,o,e);o=e[1],t<r.length-1&&i.writeUint(n,e[0],o)}),n.slice)return n.slice(0,o).buffer;for(var e=new Uint8Array(o),t=0;t<o;t++)e[t]=n[t];return e.buffer}),S=[["Compression",1],["PlanarConfiguration",1],["ExtraSamples",0]];r.writeGeotiff=function(n,o){"number"==typeof n[0]?(l=o.height||o.ImageLength,t=o.width||o.ImageWidth,e=n.length/(l*t),i=n):(e=n.length,l=n[0].length,t=n[0][0].length,i=[],(0,b.times)(l,function(r){(0,b.times)(t,function(t){(0,b.times)(e,function(e){i.push(n[e][r][t])})})})),o.ImageLength=l,delete o.height,o.ImageWidth=t,delete o.width,o.BitsPerSample||(o.BitsPerSample=(0,b.times)(e,function(){return 8})),S.forEach(function(e){var t=e[0];o[t]||(e=e[1],o[t]=e)}),o.PhotometricInterpretation||(o.PhotometricInterpretation=3===o.BitsPerSample.length?2:1),o.SamplesPerPixel||(o.SamplesPerPixel=[e]),o.StripByteCounts||(o.StripByteCounts=[e*l*t]),o.ModelPixelScale||(o.ModelPixelScale=[360/t,180/l,0]),o.SampleFormat||(o.SampleFormat=(0,b.times)(e,function(){return 1})),o.hasOwnProperty("GeographicTypeGeoKey")||o.hasOwnProperty("ProjectedCSTypeGeoKey")||(o.GeographicTypeGeoKey=4326,o.ModelTiepoint=[0,0,0,-180,90,0],o.GeogCitationGeoKey="WGS 84",o.GTModelTypeGeoKey=2);var e,t,i,r,a,s,u=Object.keys(o).filter(function(e){return(0,b.endsWith)(e,"GeoKey")}).sort(function(e,t){return _[e]-_[t]});for(s in o.GeoAsciiParams||(r="",u.forEach(function(e){var t=Number(_[e]);"ASCII"===v.fieldTagTypes[t]&&(r+="".concat(o[e].toString(),"\0"))}),0<r.length&&(o.GeoAsciiParams=r)),o.GeoKeyDirectory||(a=[1,1,0,u.length],u.forEach(function(e){var t,r,n,i=Number(_[e]);a.push(i),"SHORT"===v.fieldTagTypes[i]?(t=1,r=0,n=o[e]):"GeogCitationGeoKey"===e?(t=o.GeoAsciiParams.length,r=Number(_.GeoAsciiParams),n=0):console.log("[geotiff.js] couldn't get TIFFTagLocation for ".concat(e)),a.push(r),a.push(t),a.push(n)}),o.GeoKeyDirectory=a),u)u.hasOwnProperty(s)&&delete o[s];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","Orientation","PhotometricInterpretation","ProjectedCSTypeGeoKey","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach(function(e){o[e]&&(o[e]=(e=o[e],Array.isArray(e)?e:[e]))});var l,c=function(e){var t,r={};for(t in e)"StripOffsets"!==t&&(_[t]||console.error(t,"not in name2code:",Object.keys(_)),r[_[t]]=e[t]);return r}(o),f=i,h=t,p=c;if(null==l)throw new Error("you passed into encodeImage a width of type ".concat(l));if(null==h)throw new Error("you passed into encodeImage a width of type ".concat(h));var d={256:[h],257:[l],273:[w],278:[l],305:"geotiff.js"};if(p)for(var y in p)p.hasOwnProperty(y)&&(d[y]=p[y]);var g=new Uint8Array(x([d])),f=new Uint8Array(f),m=new Uint8Array(w+h*l*d[277]);return(0,b.times)(g.length,function(e){m[e]=g[e]}),(0,b.forEach)(f,function(e,t){m[w+t]=e}),m.buffer}},{"./globals.js":24,"./utils.js":41}],24:[function(e,t,r){"use strict";for(var n in Object.defineProperty(r,"__esModule",{value:!0}),r.geoKeys=r.geoKeyNames=r.LercAddCompression=r.LercParameters=r.ExtraSamplesValues=r.photometricInterpretations=r.fieldTypes=r.fieldTypeNames=r.arrayFields=r.fieldTagTypes=r.fieldTags=r.fieldTagNames=void 0,r.fieldTagNames={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},r.fieldTags={},r.fieldTagNames)r.fieldTagNames.hasOwnProperty(n)&&(r.fieldTags[r.fieldTagNames[n]]=parseInt(n,10));for(var i in r.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",297:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",3072:"SHORT",3073:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"},r.arrayFields=[r.fieldTags.BitsPerSample,r.fieldTags.ExtraSamples,r.fieldTags.SampleFormat,r.fieldTags.StripByteCounts,r.fieldTags.StripOffsets,r.fieldTags.StripRowCounts,r.fieldTags.TileByteCounts,r.fieldTags.TileOffsets,r.fieldTags.SubIFDs],r.fieldTypeNames={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},r.fieldTypes={},r.fieldTypeNames)r.fieldTypeNames.hasOwnProperty(i)&&(r.fieldTypes[r.fieldTypeNames[i]]=parseInt(i,10));for(var o in r.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},r.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2},r.LercParameters={Version:0,AddCompression:1},r.LercAddCompression={None:0,Deflate:1},r.geoKeyNames={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},r.geoKeys={},r.geoKeyNames)r.geoKeyNames.hasOwnProperty(o)&&(r.geoKeys[r.geoKeyNames[o]]=parseInt(o,10))},{}],25:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.timeEnd=r.time=r.error=r.warn=r.info=r.log=r.debug=r.setLogger=void 0;var n=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,(r=[{key:"log",value:function(){}},{key:"debug",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}},{key:"time",value:function(){}},{key:"timeEnd",value:function(){}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),a=new n;r.setLogger=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new n;a=e},r.debug=function(){return a.debug.apply(a,arguments)},r.log=function(){return a.log.apply(a,arguments)},r.info=function(){return a.info.apply(a,arguments)},r.warn=function(){return a.warn.apply(a,arguments)},r.error=function(){return a.error.apply(a,arguments)},r.time=function(){return a.time.apply(a,arguments)},r.timeEnd=function(){return a.timeEnd.apply(a,arguments)}},{}],26:[function(a,e,t){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},o=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},c=(Object.defineProperty(t,"__esModule",{value:!0}),a("./compression/index.js")),f="undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,r=function(){function o(){var r=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f,e=1<arguments.length?arguments[1]:void 0,t=this,i=o;if(!(t instanceof i))throw new TypeError("Cannot call a class as a function");this.workers=null,this._awaitingDecoder=null,this.size=n,this.messageId=0,n&&(this._awaitingDecoder=e?Promise.resolve(e):new Promise(function(t){Promise.resolve().then(function(){return l(a("./worker/decoder.js"))}).then(function(e){t(e.create)})}),this._awaitingDecoder.then(function(e){r._awaitingDecoder=null,r.workers=[];for(var t=0;t<n;t++)r.workers.push({worker:e(),idle:!0})}))}var e,t,r,s,n;return e=o,(t=[{key:"decode",value:(s=O().mark(function e(t,o){var a=this;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._awaitingDecoder)return e.next=3,this._awaitingDecoder;e.next=3;break;case 3:return e.abrupt("return",0===this.size?(0,c.getDecoder)(t).then(function(e){return e.decode(t,o)}):new Promise(function(r){var n=a.workers.find(function(e){return e.idle})||a.workers[Math.floor(Math.random()*a.size)],i=(n.idle=!1,a.messageId++);n.worker.addEventListener("message",function e(t){t.data.id===i&&(n.idle=!0,r(t.data.decoded),n.worker.removeEventListener("message",e))}),n.worker.postMessage({fileDirectory:t,buffer:o,id:i},[o])}));case 4:case"end":return e.stop()}},e,this)}),n=function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})},function(e,t){return n.apply(this,arguments)})},{key:"destroy",value:function(){this.workers&&(this.workers.forEach(function(e){e.worker.terminate()}),this.workers=null)}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();t.default=r},{"./compression/index.js":12,"./worker/decoder.js":42}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.applyPredictor=void 0,r.applyPredictor=function(e,t,r,n,i,o){if(t&&1!==t){for(var a=0;a<i.length;++a){if(i[a]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(i[a]!==i[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var s=i[0]/8,u=2===o?1:i.length,l=0;l<n&&!(l*u*r*s>=e.byteLength);++l){var c=void 0;if(2===t){switch(i[0]){case 8:c=new Uint8Array(e,l*u*r*s,u*r*s);break;case 16:c=new Uint16Array(e,l*u*r*s,u*r*s/2);break;case 32:c=new Uint32Array(e,l*u*r*s,u*r*s/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(i[0]," bits per sample."))}y=d=p=h=f=void 0;var f=c,h=u,p=f.length-h,d=0;do{for(var y=h;0<y;y--)f[d+h]+=f[d],d++}while(0<(p-=h))}else if(3===t){c=new Uint8Array(e,l*u*r*s,u*r*s),O=j=S=x=w=_=b=v=m=g=void 0;for(var g=c,m=u,v=s,b=0,_=g.length,w=_/v;m<_;){for(var x=m;0<x;--x)g[b+m]+=g[b],++b;_-=m}for(var S=g.slice(),j=0;j<w;++j)for(var O=0;O<v;++O)g[v*j+O]=S[(v-O-1)*w+j]}}}return e}},{}],28:[function(e,t,r){"use strict";function S(e,t,r,n){n=3<arguments.length&&void 0!==n?n:1;return new(Object.getPrototypeOf(e).constructor)(t*r*n)}function a(e,a,s,u,l){var c=a/u,f=s/l;return e.map(function(e){for(var t=S(e,u,l),r=0;r<l;++r)for(var n=Math.min(Math.round(f*r),s-1),i=0;i<u;++i){var o=Math.min(Math.round(c*i),a-1),o=e[n*a+o];t[r*u+i]=o}return t})}function j(e,t,r){return(1-r)*e+r*t}function s(e,h,p,d,y){var g=h/d,m=p/y;return e.map(function(e){for(var t=S(e,d,y),r=0;r<y;++r)for(var n=m*r,i=Math.floor(n),o=Math.min(Math.ceil(n),p-1),a=0;a<d;++a){var s=g*a,u=s%1,l=Math.floor(s),s=Math.min(Math.ceil(s),h-1),c=e[i*h+l],f=e[i*h+s],l=e[o*h+l],s=e[o*h+s],c=j(j(c,f,u),j(l,s,u),n%1);t[r*d+a]=c}return t})}function u(e,t,r,n,i,o){for(var a=t/n,s=r/i,u=S(e,n,i,o),l=0;l<i;++l)for(var c=Math.min(Math.round(s*l),r-1),f=0;f<n;++f)for(var h=Math.min(Math.round(a*f),t-1),p=0;p<o;++p){var d=e[c*t*o+h*o+p];u[l*n*o+f*o+p]=d}return u}function l(e,t,r,n,i,o){for(var a=t/n,s=r/i,u=S(e,n,i,o),l=0;l<i;++l)for(var c=s*l,f=Math.floor(c),h=Math.min(Math.ceil(c),r-1),p=0;p<n;++p)for(var d=a*p,y=d%1,g=Math.floor(d),m=Math.min(Math.ceil(d),t-1),v=0;v<o;++v){var b=e[f*t*o+g*o+v],_=e[f*t*o+m*o+v],w=e[h*t*o+g*o+v],x=e[h*t*o+m*o+v],b=j(j(b,_,y),j(w,x,y),c%1);u[l*n*o+p*o+v]=b}return u}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleInterleaved=r.resampleBilinearInterleaved=r.resampleNearestInterleaved=r.resample=r.resampleBilinear=r.resampleNearest=void 0,r.resampleNearest=a,r.resampleBilinear=s,r.resample=function(e,t,r,n,i){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"nearest";switch(o.toLowerCase()){case"nearest":return a(e,t,r,n,i);case"bilinear":case"linear":return s(e,t,r,n,i);default:throw new Error("Unsupported resampling method: '".concat(o,"'"))}},r.resampleNearestInterleaved=u,r.resampleBilinearInterleaved=l,r.resampleInterleaved=function(e,t,r,n,i,o){var a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"nearest";switch(a.toLowerCase()){case"nearest":return u(e,t,r,n,i,o);case"bilinear":case"linear":return l(e,t,r,n,i,o);default:throw new Error("Unsupported resampling method: '".concat(a,"'"))}}},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromCIELab=r.fromYCbCr=r.fromCMYK=r.fromPalette=r.fromBlackIsZero=r.fromWhiteIsZero=void 0,r.fromWhiteIsZero=function(e,t){for(var r,n=e.width,i=e.height,o=new Uint8Array(n*i*3),a=0,s=0;a<e.length;++a,s+=3)r=256-e[a]/t*256,o[s]=r,o[s+1]=r,o[s+2]=r;return o},r.fromBlackIsZero=function(e,t){for(var r,n=e.width,i=e.height,o=new Uint8Array(n*i*3),a=0,s=0;a<e.length;++a,s+=3)r=e[a]/t*256,o[s]=r,o[s+1]=r,o[s+2]=r;return o},r.fromPalette=function(e,t){for(var r=e.width,n=e.height,i=new Uint8Array(r*n*3),o=t.length/3,a=t.length/3*2,s=0,u=0;s<e.length;++s,u+=3){var l=e[s];i[u]=t[l]/65536*256,i[u+1]=t[l+o]/65536*256,i[u+2]=t[l+a]/65536*256}return i},r.fromCMYK=function(e){for(var t=e.width,r=e.height,n=new Uint8Array(t*r*3),i=0,o=0;i<e.length;i+=4,o+=3){var a=e[i],s=e[i+1],u=e[i+2],l=e[i+3];n[o]=(255-a)/256*255*((255-l)/256),n[o+1]=(255-s)/256*255*((255-l)/256),n[o+2]=(255-u)/256*255*((255-l)/256)}return n},r.fromYCbCr=function(e){for(var t=e.width,r=e.height,n=new Uint8ClampedArray(t*r*3),i=0,o=0;i<e.length;i+=3,o+=3){var a=e[i],s=e[i+1],u=e[i+2];n[o]=a+1.402*(u-128),n[o+1]=a-.34414*(s-128)-.71414*(u-128),n[o+2]=a+1.772*(s-128)}return n};r.fromCIELab=function(e){for(var t=e.width,r=e.height,n=new Uint8Array(t*r*3),i=0,o=0;i<e.length;i+=3,o+=3){var a=(e[i+0]+16)/116,s=(e[i+1]<<24>>24)/500+a,u=a-(e[i+2]<<24>>24)/200,l=-.9689*(s=.95047*(.008856<s*s*s?s*s*s:(s-16/116)/7.787))+1.8758*(a=.008856<a*a*a?a*a*a:(a-16/116)/7.787)+.0415*(u=1.08883*(.008856<u*u*u?u*u*u:(u-16/116)/7.787)),c=.0557*s+-.204*a+1.057*u;s=.0031308<(s=3.2406*s+-1.5372*a+-.4986*u)?1.055*Math.pow(s,1/2.4)-.055:12.92*s,l=.0031308<l?1.055*Math.pow(l,1/2.4)-.055:12.92*l,c=.0031308<c?1.055*Math.pow(c,1/2.4)-.055:12.92*c,n[o]=255*Math.max(0,Math.min(1,s)),n[o+1]=255*Math.max(0,Math.min(1,l)),n[o+2]=255*Math.max(0,Math.min(1,c))}return n}},{}],30:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.makeBufferSource=void 0;var n=e("./basesource.js"),l=e("../utils.js"),c=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).arrayBuffer=e,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"fetchSlice",value:function(e,t){if(t&&t.aborted)throw new l.AbortError("Request aborted");return this.arrayBuffer.slice(e.offset,e.offset+e.length)}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.BaseSource);r.makeBufferSource=function(e){return new c(e)}},{"../utils.js":41,"./basesource.js":31}],31:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function s(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSource=void 0;var n=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n,i,o,a;return t=e,(r=[{key:"fetch",value:(a=s(O().mark(function e(t){var r,n=this,i=arguments;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<i.length&&void 0!==i[1]?i[1]:void 0,e.abrupt("return",Promise.all(t.map(function(e){return n.fetchSlice(e,r)})));case 2:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)})},{key:"fetchSlice",value:(o=s(O().mark(function e(t){return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("fetching of slice ".concat(t," not possible, not implemented"));case 1:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})},{key:"fileSize",get:function(){return null}},{key:"close",value:(i=s(O().mark(function e(){return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return i.apply(this,arguments)})}])&&l(t.prototype,r),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.BaseSource=n},{}],32:[function(e,t,r){"use strict";function B(){B=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=s(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function c(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function h(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var p=function(e){return e&&e.__esModule?e:{default:e}},d=(Object.defineProperty(r,"__esModule",{value:!0}),r.BlockedSource=void 0,p(e("lru-cache"))),p=e("./basesource.js"),z=e("../utils.js"),y=function(){function n(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;f(this,n),this.offset=e,this.length=t,this.data=r}return h(n,[{key:"top",get:function(){return this.offset+this.length}}]),n}(),g=h(function e(t,r,n){f(this,e),this.offset=t,this.length=r,this.blockIds=n}),e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,i=l(o);function o(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=r.blockSize,n=void 0===n?65536:n,r=r.cacheSize,r=void 0===r?100:r;return f(this,o),(t=i.call(this)).source=e,t.blockSize=n,t.blockCache=new d.default({max:r}),t.blockRequests=new Map,t.blockIdsToFetch=new Set,t}return h(o,[{key:"fileSize",get:function(){return this.source.fileSize}},{key:"fetch",value:(r=c(B().mark(function e(t,r){var n,i,o,a,s,u,l,c,f,h,p,d,y,g,m,v,b,_,w,x,S,j,O,P,k,E,T,C,R,M,I,A,L,D,F,N;return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=new Map,i=new Map,o=new Set,a=U(t);try{for(a.s();!(s=a.n()).done;)for(u=s.value,l=u.offset,c=u.length,f=l+c,null!==(h=this.fileSize)&&(f=Math.min(f,h)),p=Math.floor(l/this.blockSize)*this.blockSize,d=p;d<f;d+=this.blockSize)y=Math.floor(d/this.blockSize),this.blockCache.has(y)?n.set(y,this.blockCache.get(y)):this.blockRequests.has(y)?i.set(y,this.blockRequests.get(y)):(this.blockIdsToFetch.has(y)||this.blockIdsToFetch.add(y),o.add(y))}catch(e){a.e(e)}finally{a.f()}return e.next=7,(0,z.wait)();case 7:this.fetchBlocks(r),g=U(o),e.prev=9,g.s();case 11:(T=g.n()).done?e.next=26:(m=T.value,T=this.blockRequests.get(m),v=this.blockCache.get(m),T?(i.set(m,T),e.next=24):e.next=19);break;case 19:v?(n.set(m,v),e.next=24):e.next=23;break;case 23:throw new Error("Block ".concat(m," is not in the block requests"));case 24:e.next=11;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(9),g.e(e.t0);case 31:return e.prev=31,g.f(),e.finish(31);case 34:return e.next=36,Promise.allSettled(Array.from(i.values()));case 36:if(!(b=e.sent).some(function(e){return"rejected"===e.status})){e.next=65;break}_=new Set,w=U((0,z.zip)(i.keys(),b));try{for(w.s();!(x=w.n()).done;)S=G(x.value,2),j=S[0],O=S[1],P=O.rejected,k=O.reason,P&&"AbortError"===k.name&&k.signal!==r&&(this.blockIdsToFetch.add(j),_.add(j))}catch(e){w.e(e)}finally{w.f()}if(!(0<this.blockIdsToFetch.length)){e.next=65;break}this.fetchBlocks(r),E=U(_),e.prev=44,E.s();case 46:if((T=E.n()).done){e.next=54;break}if(C=T.value,R=this.blockRequests.get(C)){e.next=51;break}throw new Error("Block ".concat(C," is not in the block requests"));case 51:i.set(C,R);case 52:e.next=46;break;case 54:e.next=59;break;case 56:e.prev=56,e.t1=e.catch(44),E.e(e.t1);case 59:return e.prev=59,E.f(),e.finish(59);case 62:return e.next=64,Promise.allSettled(Array.from(i.values()));case 64:b=e.sent;case 65:if(b.some(function(e){return"rejected"===e.status})){if(r&&r.aborted)throw new z.AbortError("Request was aborted");e.next=68}else e.next=69;break;case 68:throw new z.AggregateError(b.filter(function(e){return"rejected"===e.status}).map(function(e){return e.reason}),"Request failed");case 69:M=b.map(function(e){return e.value}),I=new Map((0,z.zip)(Array.from(i.keys()),M)),A=U(n);try{for(A.s();!(L=A.n()).done;)D=G(L.value,2),F=D[0],N=D[1],I.set(F,N)}catch(e){A.e(e)}finally{A.f()}return e.abrupt("return",this.readSliceData(t,I));case 74:case"end":return e.stop()}},e,this,[[9,28,31,34],[44,56,59,62]])})),function(e,t){return r.apply(this,arguments)})},{key:"fetchBlocks",value:function(s){var u=this;if(0<this.blockIdsToFetch.size){for(var e=u.groupBlocks(u.blockIdsToFetch),l=u.source.fetch(e,s),t=function(a){var t,r=U(e[a].blockIds);try{for(r.s();!(t=r.n()).done;)!function(){var o=t.value,e=c(B().mark(function e(){var t,r,n,i;return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l;case 3:return e.t0=a,n=e.sent[e.t0],t=o*u.blockSize,i=t-n.offset,r=Math.min(i+u.blockSize,n.data.byteLength),n=n.data.slice(i,r),i=new y(t,n.byteLength,n),u.blockCache.set(o,i),e.abrupt("return",i);case 14:throw e.prev=14,e.t1=e.catch(0),"AbortError"===e.t1.name&&(e.t1.signal=s),e.t1;case 18:return e.prev=18,u.blockRequests.delete(o),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[0,14,18,21]])}))();u.blockRequests.set(o,e)}()}catch(e){r.e(e)}finally{r.f()}},r=0;r<e.length;++r)t(r);u.blockIdsToFetch.clear()}}},{key:"groupBlocks",value:function(e){e=Array.from(e).sort(function(e,t){return e-t});if(0===e.length)return[];var t,r=[],n=null,i=[],o=U(e);try{for(o.s();!(t=o.n()).done;)var a=t.value,n=(null===n||n+1===a?r.push(a):(i.push(new g(r[0]*this.blockSize,r.length*this.blockSize,r)),r=[a]),a)}catch(e){o.e(e)}finally{o.f()}return i.push(new g(r[0]*this.blockSize,r.length*this.blockSize,r)),i}},{key:"readSliceData",value:function(e,h){var p=this;return e.map(function(e){for(var t=e.offset+e.length,r=Math.floor(e.offset/p.blockSize),n=Math.floor((e.offset+e.length)/p.blockSize),i=new ArrayBuffer(e.length),o=new Uint8Array(i),a=r;a<=n;++a){var s=h.get(a),u=s.offset-e.offset,l=0,c=0,f=void 0,u=(u<0?l=-u:0<u&&(c=u),f=s.top-t<0?s.length-l:t-s.offset-l,new Uint8Array(s.data,l,f));o.set(u,c)}return i})}}]),o}(p.BaseSource);r.BlockedSource=e},{"../utils.js":41,"./basesource.js":31,"lru-cache":63}],33:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function n(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function a(e,t,r){t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1})}Object.defineProperty(r,"__esModule",{value:!0}),r.BaseClient=r.BaseResponse=void 0;var s=function(){function e(){i(this,e)}var t;return a(e,[{key:"ok",get:function(){return 200<=this.status&&this.status<=299}},{key:"status",get:function(){throw new Error("not implemented")}},{key:"getHeader",value:function(e){throw new Error("not implemented")}},{key:"getData",value:(t=n(O().mark(function e(){return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("not implemented");case 1:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})}]),e}(),s=(r.BaseResponse=s,function(){function t(e){i(this,t),this.url=e}var e;return a(t,[{key:"request",value:(e=n(O().mark(function e(){var t,r=arguments;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw(t=0<r.length&&void 0!==r[0]?r[0]:{}).headers,t.credentials,t.signal,new Error("request is not implemented");case 2:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}]),t}());r.BaseClient=s},{}],34:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function i(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function a(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.FetchClient=void 0;var h=e("./base.js"),p=function(){s(n,h.BaseResponse);var e,r=c(n);function n(e){var t;return o(this,n),(t=r.call(this)).response=e,t}return a(n,[{key:"status",get:function(){return this.response.status}},{key:"getHeader",value:function(e){return this.response.headers.get(e)}},{key:"getData",value:(e=i(O().mark(function e(){var t;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.response.arrayBuffer)return e.next=3,this.response.arrayBuffer();e.next=6;break;case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,this.response.buffer();case 8:e.t0=e.sent.buffer;case 9:return t=e.t0,e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),n}(),e=function(){s(n,h.BaseClient);var e,r=c(n);function n(e,t){return o(this,n),(e=r.call(this,e)).credentials=t,e}return a(n,[{key:"request",value:(e=i(O().mark(function e(){var t,r,n,i=arguments;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(r=0<i.length&&void 0!==i[0]?i[0]:{}).headers,t=r.credentials,r=r.signal,e.next=3,fetch(this.url,{headers:n,credentials:t,signal:r});case 3:return n=e.sent,e.abrupt("return",new p(n));case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),n}();r.FetchClient=e},{"./base.js":33}],35:[function(_,e,w){!function(b){!function(){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function a(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?t(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function o(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function l(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function c(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=function(e){return e&&e.__esModule?e:{default:e}},p=(Object.defineProperty(w,"__esModule",{value:!0}),w.HttpClient=void 0,e(_("http"))),d=e(_("https")),y=e(_("url")),g=_("./base.js"),m=_("../../utils.js"),v=function(){f(i,g.BaseResponse);var e,n=h(i);function i(e,t){var r;return s(this,i),(r=n.call(this)).response=e,r.dataPromise=t,r}return l(i,[{key:"status",get:function(){return this.response.statusCode}},{key:"getHeader",value:function(e){return this.response.headers[e]}},{key:"getData",value:(e=o(O().mark(function e(){var t;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataPromise;case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),i}(),e=function(){f(r,g.BaseClient);var e,t=h(r);function r(e){return s(this,r),(e=t.call(this,e)).parsedUrl=y.default.parse(e.url),e.httpApi=("http:"===e.parsedUrl.protocol?p:d).default,e}return l(r,[{key:"constructRequest",value:function(t,i){var o=this;return new Promise(function(r,n){var e=o.httpApi.get(a(a({},o.parsedUrl),{},{headers:t}),function(e){var t=new Promise(function(t){var r=[];e.on("data",function(e){r.push(e)}),e.on("end",function(){var e=b.concat(r).buffer;t(e)}),e.on("error",n)});r(new v(e,t))});e.on("error",n),i&&(i.aborted&&e.destroy(new m.AbortError("Request aborted")),i.addEventListener("abort",function(){return e.destroy(new m.AbortError("Request aborted"))}))})}},{key:"request",value:(e=o(O().mark(function e(){var t,r,n=arguments;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=0<n.length&&void 0!==n[0]?n[0]:{}).headers,t=t.signal,e.next=3,this.constructRequest(r,t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),r}();w.HttpClient=e}.call(this)}.call(this,_("buffer").Buffer)},{"../../utils.js":41,"./base.js":33,buffer:6,http:399,https:59,url:420}],36:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function o(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function s(e,t,r){t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.XHRClient=void 0;var d=e("./base.js"),y=e("../../utils.js"),g=function(){l(i,d.BaseResponse);var e,n=h(i);function i(e,t){var r;return a(this,i),(r=n.call(this)).xhr=e,r.data=t,r}return s(i,[{key:"status",get:function(){return this.xhr.status}},{key:"getHeader",value:function(e){return this.xhr.getResponseHeader(e)}},{key:"getData",value:(e=o(O().mark(function e(){return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.data);case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),i}(),e=function(){l(r,d.BaseClient);var e,t=h(r);function r(){return a(this,r),t.apply(this,arguments)}return s(r,[{key:"constructRequest",value:function(s,u){var l=this;return new Promise(function(t,e){var r=new XMLHttpRequest;r.open("GET",l.url),r.responseType="arraybuffer";for(var n=0,i=Object.entries(s);n<i.length;n++){var o=c(i[n],2),a=o[0],o=o[1];r.setRequestHeader(a,o)}r.onload=function(){var e=r.response;t(new g(r,e))},r.onerror=e,r.onabort=function(){return e(new y.AbortError("Request aborted"))},r.send(),u&&(u.aborted&&r.abort(),u.addEventListener("abort",function(){return r.abort()}))})}},{key:"request",value:(e=o(O().mark(function e(){var t,r,n=arguments;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=0<n.length&&void 0!==n[0]?n[0]:{}).headers,t=t.signal,e.next=3,this.constructRequest(r,t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),r}();r.XHRClient=e},{"../../utils.js":41,"./base.js":33}],37:[function(r,e,n){!function(p){!function(){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function s(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=function(e){return e&&e.__esModule?e:{default:e}},h=(Object.defineProperty(n,"__esModule",{value:!0}),n.makeFileSource=void 0,e(r("fs")));var t=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n,i,o=f(a);function a(e){var t;if(this instanceof a)return(t=o.call(this)).path=e,t.openRequest=function(e,t,r){var i=2<arguments.length&&void 0!==r?r:void 0;return new Promise(function(r,n){h.default.open(e,t,i,function(e,t){e?n(e):r(t)})})}(e,"r"),t;throw new TypeError("Cannot call a class as a function")}return t=a,(e=[{key:"fetchSlice",value:(i=s(O().mark(function e(t){var r,n;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openRequest;case 2:return r=e.sent,e.next=5,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Promise(function(n,i){var e;(e=h.default).read.apply(e,t.concat([function(e,t,r){e?i(e):n({bytesRead:t,buffer:r})}]))})}(r,p.alloc(t.length),0,t.length,t.offset);case 5:return r=e.sent,n=r.buffer,e.abrupt("return",n.buffer);case 8:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"close",value:(n=s(O().mark(function e(){var t;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openRequest;case 2:t=e.sent,e.next=5;var n=t;return new Promise(function(t,r){h.default.close(n,function(e){e?r(e):t()})});case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(r("./basesource.js").BaseSource);n.makeFileSource=function(e){return new t(e)}}.call(this)}.call(this,r("buffer").Buffer)},{"./basesource.js":31,buffer:6,fs:5}],38:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function u(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.makeFileReaderSource=void 0;var n=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,s,n,i=c(o);function o(e){var t;if(this instanceof o)return(t=i.call(this)).file=e,t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"fetchSlice",value:(s=O().mark(function e(i,o){var a=this;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t,e){var r=a.file.slice(i.offset,i.offset+i.length),n=new FileReader;n.onload=function(e){return t(e.target.result)},n.onerror=e,n.onabort=e,n.readAsArrayBuffer(r),o&&o.addEventListener("abort",function(){return n.abort()})}));case 1:case"end":return e.stop()}},e)}),n=function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){u(n,t,r,i,o,"next",e)}function o(e){u(n,t,r,i,o,"throw",e)}i(void 0)})},function(e,t){return n.apply(this,arguments)})}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(e("./basesource.js").BaseSource);r.makeFileReaderSource=function(e){return new n(e)}},{"./basesource.js":31}],39:[function(e,t,r){"use strict";function n(e){return o(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||i()}function s(e,t){return o(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||u(e,t)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e){if(Array.isArray(e))return e}function u(e,t){var r;if(e)return"string"==typeof e?a(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.parseByteRanges=r.parseContentRange=r.parseContentType=void 0;function p(e){if(void 0!==Object.fromEntries)return Object.fromEntries(e);var t,r={},n=function(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=u(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);try{for(n.s();!(t=n.n()).done;){var i=s(t.value,2),o=i[0],a=i[1];r[o.toLowerCase()]=a}}catch(e){n.e(e)}finally{n.f()}return r}function d(e){var t,r,n;return e&&(t=(e=s(e.match(/bytes (\d+)-(\d+)\/(\d+)/),4))[1],r=e[2],n=e[3],t=parseInt(t,10),r=parseInt(r,10),n=parseInt(n,10)),{start:t,end:r,total:n}}r.parseContentType=function(e){return{type:(e=n(e.split(";").map(function(e){return e.trim()})))[0],params:p(e.slice(1).map(function(e){return e.split("=")}))}},r.parseContentRange=d,r.parseByteRanges=function(e,t){for(var r=null,n=new TextDecoder("ascii"),i=[],o="--".concat(t),a="".concat(o,"--"),s=0;s<10;++s)n.decode(new Uint8Array(e,s,o.length))===o&&(r=s);if(null===r)throw new Error("Could not find initial boundary");for(;r<e.byteLength;){var u=n.decode(new Uint8Array(e,r,Math.min(o.length+1024,e.byteLength-r)));if(0===u.length||u.startsWith(a))break;if(!u.startsWith(o))throw new Error("Part does not start with boundary");u=u.substr(o.length+2);if(0===u.length)break;var l=u.indexOf("\r\n\r\n"),u=p(u.substr(0,l).split("\r\n").map(function(e){e=e.split(":").map(function(e){return e.trim()});return e[0]=e[0].toLowerCase(),e})),c=d(u["content-range"]),f=c.start,h=c.end,c=c.total,l=r+o.length+l+"\r\n\r\n".length,h=parseInt(h,10)+1-parseInt(f,10);i.push({headers:u,data:e.slice(l,l+h),offset:f,length:h,fileSize:c}),r=l+h+4}return i}},{}],40:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=["headers","credentials","maxRanges","allowFullFile"],o=["headers","maxRanges","allowFullFile"],s=["headers","maxRanges","allowFullFile"],n=["forceXHR"];function u(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],0<=t.indexOf(r)||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(e),o=0;o<i.length;o++)r=i[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function l(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function f(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function c(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function h(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){c(n,t,r,i,o,"next",e)}function o(e){c(n,t,r,i,o,"throw",e)}i(void 0)})}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.makeRemoteSource=r.makeHttpSource=r.makeXHRSource=r.makeFetchSource=void 0;var m=e("./httputils.js"),v=e("./basesource.js"),b=e("./blockedsource.js"),_=e("./client/fetch.js"),w=e("./client/xhr.js"),x=e("./client/http.js"),S=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n,i,o,a=g(s);function s(e,t,r,n){var i;if(this instanceof s)return(i=a.call(this)).client=e,i.headers=t,i.maxRanges=r,i.allowFullFile=n,i._fileSize=null,i;throw new TypeError("Cannot call a class as a function")}return t=s,(e=[{key:"fetch",value:(o=h(O().mark(function e(t,r){var n=this;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.maxRanges>=t.length)return e.abrupt("return",this.fetchSlices(t,r));e.next=4;break;case 4:0<this.maxRanges&&t.length;case 5:return e.abrupt("return",Promise.all(t.map(function(e){return n.fetchSlice(e,r)})));case 6:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"fetchSlices",value:(i=h(O().mark(function e(t,r){var n,i,o,a,s,u,l,c=this;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.request({headers:f(f({},this.headers),{},{Range:"bytes=".concat(t.map(function(e){var t=e.offset,e=e.length;return"".concat(t,"-").concat(t+e)}).join(","))}),signal:r});case 2:if((n=e.sent).ok){e.next=7;break}throw new Error("Error fetching data.");case 7:if(206!==n.status)e.next=32;else{if(i=(0,m.parseContentType)(n.getHeader("content-type")),o=i.type,i=i.params,"multipart/byteranges"===o)return e.t0=m.parseByteRanges,e.next=13,n.getData();e.next=18}break;case 13:return e.t1=e.sent,e.t2=i.boundary,o=(0,e.t0)(e.t1,e.t2),this._fileSize=o[0].fileSize||null,e.abrupt("return",o);case 18:return e.next=20,n.getData();case 20:if(u=e.sent,s=(0,m.parseContentRange)(n.getHeader("content-range")),a=s.start,l=s.end,s=s.total,this._fileSize=s||null,s=[{data:u,offset:a,length:l-a}],1<t.length)return e.next=27,Promise.all(t.slice(1).map(function(e){return c.fetchSlice(e,r)}));e.next=29;break;case 27:return u=e.sent,e.abrupt("return",s.concat(u));case 29:return e.abrupt("return",s);case 32:if(this.allowFullFile){e.next=34;break}throw new Error("Server responded with full file");case 34:return e.next=36,n.getData();case 36:return l=e.sent,this._fileSize=l.byteLength,e.abrupt("return",[{data:l,offset:0,length:l.byteLength}]);case 39:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"fetchSlice",value:(n=h(O().mark(function e(t,r){var n,i,o,a,s;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offset,i=t.length,e.next=3,this.client.request({headers:f(f({},this.headers),{},{Range:"bytes=".concat(n,"-").concat(n+i)}),signal:r});case 3:if((o=e.sent).ok){e.next=8;break}throw new Error("Error fetching data.");case 8:if(206===o.status)return e.next=11,o.getData();e.next=17;break;case 11:return a=e.sent,s=(0,m.parseContentRange)(o.getHeader("content-range")),s=s.total,this._fileSize=s||null,e.abrupt("return",{data:a,offset:n,length:i});case 17:if(this.allowFullFile){e.next=19;break}throw new Error("Server responded with full file");case 19:return e.next=21,o.getData();case 21:return s=e.sent,this._fileSize=s.byteLength,e.abrupt("return",{data:s,offset:0,length:s.byteLength});case 24:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"fileSize",get:function(){return this._fileSize}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(v.BaseSource);function P(e,t){var r=t.blockSize,t=t.cacheSize;return null===r?e:new b.BlockedSource(e,r,t)}function k(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,r=void 0===r?{}:r,n=t.credentials,i=t.maxRanges,i=void 0===i?0:i,o=t.allowFullFile,o=void 0!==o&&o,t=u(t,a),e=new _.FetchClient(e,n);return P(new S(e,r,i,o),t)}function E(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,r=void 0===r?{}:r,n=t.maxRanges,n=void 0===n?0:n,i=t.allowFullFile,i=void 0!==i&&i,t=u(t,o),e=new w.XHRClient(e);return P(new S(e,r,n,i),t)}function T(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,r=void 0===r?{}:r,n=t.maxRanges,n=void 0===n?0:n,i=t.allowFullFile,i=void 0!==i&&i,t=u(t,s),e=new x.HttpClient(e);return P(new S(e,r,n,i),t)}r.makeFetchSource=k,r.makeXHRSource=E,r.makeHttpSource=T,r.makeRemoteSource=function(e){var t=void 0!==(t=(r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).forceXHR)&&t,r=u(r,n);return("function"!=typeof fetch||t?"undefined"!=typeof XMLHttpRequest?E:T:k)(e,r)}},{"./basesource.js":31,"./blockedsource.js":32,"./client/fetch.js":34,"./client/http.js":35,"./client/xhr.js":36,"./httputils.js":39}],41:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===j(e)?e:String(e)}(n.key),n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function u(r){var n=f();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){var r="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return c(e,arguments,p(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),h(t,e)})(e)}function c(e,t,r){return(c=f()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&h(t,r.prototype),t}).apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function y(e){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}function g(){var s;return s=O().mark(function e(t){return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,t)}));case 1:case"end":return e.stop()}},e)}),(g=function(){var e=this,a=arguments;return new Promise(function(t,r){var n=s.apply(e,a);function i(e){d(n,t,r,i,o,"next",e)}function o(e){d(n,t,r,i,o,"throw",e)}i(void 0)})}).apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.AggregateError=r.CustomAggregateError=r.AbortError=r.zip=r.wait=r.parseContentRange=r.toArrayRecursively=r.toArray=r.times=r.range=r.invert=r.forEach=r.endsWith=r.chunk=r.assign=void 0,r.assign=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r.chunk=function(e,t){for(var r=[],n=e.length,i=0;i<n;i+=t){for(var o=[],a=i;a<i+t;a++)o.push(e[a]);r.push(o)}return r},r.endsWith=function(e,t){return!(e.length<t.length)&&e.substr(e.length-t.length)===t},r.forEach=function(e,t){for(var r=e.length,n=0;n<r;n++)t(e[n],n)},r.invert=function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[e[t]]=t);return r},r.range=function(e){for(var t=[],r=0;r<e;r++)t.push(r);return t},r.times=function(e,t){for(var r=[],n=0;n<e;n++)r.push(t(n));return r},r.toArray=y,r.toArrayRecursively=function e(t){return t.length?y(t).map(e):t},r.parseContentRange=function(e){if(!e)return null;if("string"!=typeof e)throw new Error("invalid argument");function t(e){return Number.parseInt(e,10)}var r=e.match(/^(\w*) /),n=r&&r[1];return(r=e.match(/(\d+)-(\d+)\/(\d+|\*)/))?{unit:n,first:t(r[1]),last:t(r[2]),length:"*"===r[3]?null:t(r[3])}:(r=e.match(/(\d+|\*)/))?{unit:n,first:null,last:null,length:"*"===r[1]?null:t(r[1])}:null},r.wait=function(e){return g.apply(this,arguments)},r.zip=function(e,t){var e=Array.isArray(e)?e:Array.from(e),r=Array.isArray(t)?t:Array.from(t);return e.map(function(e,t){return[e,r[t]]})};var m=function(){s(r,l(Error));var t=u(r);function r(e){return a(this,r),e=t.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(i(e),r),e.name="AbortError",e}return o(r)}(),m=(r.AbortError=m,function(){s(i,l(Error));var n=u(i);function i(e,t){var r;return a(this,i),(r=n.call(this,t)).errors=e,r.message=t,r.name="AggregateError",r}return o(i)}());r.CustomAggregateError=m,r.AggregateError=m},{}],42:[function(n,e,i){!function(r){!function(){"use strict";var e=function(e){return e&&e.__esModule?e:{default:e}},t=(Object.defineProperty(i,"__esModule",{value:!0}),i.create=void 0,e(n("web-worker")));i.create=function(){var e='function e(e,t,r,n,i,a,o){try{var s=e[a](o),f=s.value}catch(e){return void r(e)}s.done?t(f):Promise.resolve(f).then(n,i)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(i,a){var o=t.apply(r,n);function s(t){e(o,i,a,s,f,"next",t)}function f(t){e(o,i,a,s,f,"throw",t)}s(void 0)}))}}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var n={exports:{}};!function(e){var t=function(e){var t,n=Object.prototype,i=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),o=new T(n||[]);return a._invoke=function(e,t,r){var n=h;return function(i,a){if(n===p)throw new Error("Generator is already running");if(n===m){if("throw"===i)throw a;return E()}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=I(o,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var f=c(e,t,r);if("normal"===f.type){if(n=r.done?m:d,f.arg===v)continue;return{value:f.arg,done:r.done}}"throw"===f.type&&(n=m,r.method="throw",r.arg=f.arg)}}}(e,r,o),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",m="completed",v={};function y(){}function w(){}function g(){}var b={};l(b,o,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(D([])));x&&x!==n&&i.call(x,o)&&(b=x);var _=g.prototype=y.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(a,o,s,f){var l=c(e[a],e,o);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"===r(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,f)}),(function(e){n("throw",e,s,f)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,f)}))}f(l.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}}function I(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a \'throw\' method")}return v}var i=c(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function U(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(U,this),this.reset(!0)}function D(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:E}}function E(){return{value:t,done:!0}}return w.prototype=g,l(_,"constructor",g),l(g,"constructor",w),w.displayName=l(g,f,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,f,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},A(P.prototype),l(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new P(u(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(_),l(_,f,"Generator"),l(_,o,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=D,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var f=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(f&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(f){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(n);var i=n.exports,a=new Map;function o(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){return a.set(e,t)}))}function s(e){return f.apply(this,arguments)}function f(){return(f=t(i.mark((function e(t){var r,n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.get(t.Compression)){e.next=3;break}throw new Error("Unknown compression method identifier: ".concat(t.Compression));case 3:return e.next=5,r();case 5:return n=e.sent,e.abrupt("return",new n(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o([void 0,1],(function(){return Promise.resolve().then((function(){return _})).then((function(e){return e.default}))})),o(5,(function(){return Promise.resolve().then((function(){return S})).then((function(e){return e.default}))})),o(6,(function(){throw new Error("old style JPEG compression is not supported.")})),o(7,(function(){return Promise.resolve().then((function(){return L})).then((function(e){return e.default}))})),o([8,32946],(function(){return Promise.resolve().then((function(){return Ne})).then((function(e){return e.default}))})),o(32773,(function(){return Promise.resolve().then((function(){return Ye})).then((function(e){return e.default}))})),o(34887,(function(){return Promise.resolve().then((function(){return ut})).then((function(e){return e.default}))})),o(50001,(function(){return Promise.resolve().then((function(){return dt})).then((function(e){return e.default}))}));var l=globalThis;function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function m(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function y(e,t){var r=e.length-t,n=0;do{for(var i=t;i>0;i--)e[n+t]+=e[n],n++;r-=t}while(r>0)}function w(e,t,r){for(var n=0,i=e.length,a=i/r;i>t;){for(var o=t;o>0;--o)e[n+t]+=e[n],++n;i-=t}for(var s=e.slice(),f=0;f<a;++f)for(var l=0;l<r;++l)e[r*f+l]=s[(r-l-1)*a+f]}function g(e,t,r,n,i,a){if(!t||1===t)return e;for(var o=0;o<i.length;++o){if(i[o]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(i[o]!==i[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var s=i[0]/8,f=2===a?1:i.length,l=0;l<n&&!(l*f*r*s>=e.byteLength);++l){var u=void 0;if(2===t){switch(i[0]){case 8:u=new Uint8Array(e,l*f*r*s,f*r*s);break;case 16:u=new Uint16Array(e,l*f*r*s,f*r*s/2);break;case 32:u=new Uint32Array(e,l*f*r*s,f*r*s/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(i[0]," bits per sample."))}y(u,f)}else 3===t&&w(u=new Uint8Array(e,l*f*r*s,f*r*s),f,s)}return e}l.addEventListener("message",function(){var e=t(i.mark((function e(t){var r,n,a,o,f,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.data,n=r.id,a=r.fileDirectory,o=r.buffer,e.next=3,s(a);case 3:return f=e.sent,e.next=6,f.decode(a,o);case 6:u=e.sent,l.postMessage({decoded:u,id:n},[u]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var b=function(){function e(){u(this,e)}var r;return h(e,[{key:"decode",value:(r=t(i.mark((function e(t,r){var n,a,o,s,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decodeBlock(r);case 2:if(n=e.sent,1===(a=t.Predictor||1)){e.next=9;break}return o=!t.StripOffsets,s=o?t.TileWidth:t.ImageWidth,f=o?t.TileLength:t.RowsPerStrip||t.ImageLength,e.abrupt("return",g(n,a,s,f,t.BitsPerSample,t.PlanarConfiguration));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}]),e}();function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}var x=function(e){p(r,b);var t=k(r);function r(){return u(this,r),t.apply(this,arguments)}return h(r,[{key:"decodeBlock",value:function(e){return e}}]),r}(),_=Object.freeze({__proto__:null,default:x});function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}function P(e,t){for(var r=t.length-1;r>=0;r--)e.push(t[r]);return e}function I(e){for(var t=new Uint16Array(4093),r=new Uint8Array(4093),n=0;n<=257;n++)t[n]=4096,r[n]=n;var i=258,a=9,o=0;function s(){i=258,a=9}function f(e){var t=function(e,t,r){var n=t%8,i=Math.floor(t/8),a=8-n,o=t+r-8*(i+1),s=8*(i+2)-(t+r),f=8*(i+2)-t;if(s=Math.max(0,s),i>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;var l=e[i]&Math.pow(2,8-n)-1,u=l<<=r-a;if(i+1<e.length){var c=e[i+1]>>>s;u+=c<<=Math.max(0,r-f)}if(o>8&&i+2<e.length){var h=8*(i+3)-(t+r);u+=e[i+2]>>>h}return u}(e,o,a);return o+=a,t}function l(e,n){return r[i]=n,t[i]=e,++i-1}function u(e){for(var n=[],i=e;4096!==i;i=t[i])n.push(r[i]);return n}var c=[];s();for(var h,d=new Uint8Array(e),p=f(d);257!==p;){if(256===p){for(s(),p=f(d);256===p;)p=f(d);if(257===p)break;if(p>256)throw new Error("corrupted code at scanline ".concat(p));P(c,u(p)),h=p}else if(p<i){var m=u(p);P(c,m),l(h,m[m.length-1]),h=p}else{var v=u(h);if(!v)throw new Error("Bogus entry. Not in dictionary, ".concat(h," / ").concat(i,", position: ").concat(o));P(c,v),c.push(v[v.length-1]),l(h,v[v.length-1]),h=p}i+1>=Math.pow(2,a)&&(12===a?h=void 0:a++),p=f(d)}return new Uint8Array(c)}var U=function(e){p(r,b);var t=A(r);function r(){return u(this,r),t.apply(this,arguments)}return h(r,[{key:"decodeBlock",value:function(e){return I(e).buffer}}]),r}(),S=Object.freeze({__proto__:null,default:U});function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}var D=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function E(e,t){for(var r=0,n=[],i=16;i>0&&!e[i-1];)--i;n.push({children:[],index:0});for(var a,o=n[0],s=0;s<i;s++){for(var f=0;f<e[s];f++){for((o=n.pop()).children[o.index]=t[r];o.index>0;)o=n.pop();for(o.index++,n.push(o);n.length<=s;)n.push(a={children:[],index:0}),o.children[o.index]=a.children,o=a;r++}s+1<i&&(n.push(a={children:[],index:0}),o.children[o.index]=a.children,o=a)}return n[0].children}function B(e,t,n,i,a,o,s,f,l){var u=n.mcusPerLine,c=n.progressive,h=t,d=t,p=0,m=0;function v(){if(m>0)return m--,p>>m&1;if(255===(p=e[d++])){var t=e[d++];if(t)throw new Error("unexpected marker: ".concat((p<<8|t).toString(16)))}return m=7,p>>>7}function y(e){for(var t,n=e;null!==(t=v());){if("number"==typeof(n=n[t]))return n;if("object"!==r(n))throw new Error("invalid huffman sequence")}return null}function w(e){for(var t=e,r=0;t>0;){var n=v();if(null===n)return;r=r<<1|n,--t}return r}function g(e){var t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}var b=0;var k,x=0;function _(e,t,r,n,i){var a=r%u,o=(r/u|0)*e.v+n,s=a*e.h+i;t(e,e.blocks[o][s])}function A(e,t,r){var n=r/e.blocksPerLine|0,i=r%e.blocksPerLine;t(e,e.blocks[n][i])}var P,I,U,S,T,E,B=i.length;E=c?0===o?0===f?function(e,t){var r=y(e.huffmanTableDC),n=0===r?0:g(r)<<l;e.pred+=n,t[0]=e.pred}:function(e,t){t[0]|=v()<<l}:0===f?function(e,t){if(b>0)b--;else for(var r=o,n=s;r<=n;){var i=y(e.huffmanTableAC),a=15&i,f=i>>4;if(0===a){if(f<15){b=w(f)+(1<<f)-1;break}r+=16}else t[D[r+=f]]=g(a)*(1<<l),r++}}:function(e,t){for(var r=o,n=s,i=0;r<=n;){var a=D[r],f=t[a]<0?-1:1;switch(x){case 0:var u=y(e.huffmanTableAC),c=15&u;if(i=u>>4,0===c)i<15?(b=w(i)+(1<<i),x=4):(i=16,x=1);else{if(1!==c)throw new Error("invalid ACn encoding");k=g(c),x=i?2:3}continue;case 1:case 2:t[a]?t[a]+=(v()<<l)*f:0==--i&&(x=2===x?3:0);break;case 3:t[a]?t[a]+=(v()<<l)*f:(t[a]=k<<l,x=0);break;case 4:t[a]&&(t[a]+=(v()<<l)*f)}r++}4===x&&0==--b&&(x=0)}:function(e,t){var r=y(e.huffmanTableDC),n=0===r?0:g(r);e.pred+=n,t[0]=e.pred;for(var i=1;i<64;){var a=y(e.huffmanTableAC),o=15&a,s=a>>4;if(0===o){if(s<15)break;i+=16}else t[D[i+=s]]=g(o),i++}};var O,M,C=0;M=1===B?i[0].blocksPerLine*i[0].blocksPerColumn:u*n.mcusPerColumn;for(var L=a||M;C<M;){for(I=0;I<B;I++)i[I].pred=0;if(b=0,1===B)for(P=i[0],T=0;T<L;T++)A(P,E,C),C++;else for(T=0;T<L;T++){for(I=0;I<B;I++){var R=P=i[I],V=R.h,G=R.v;for(U=0;U<G;U++)for(S=0;S<V;S++)_(P,E,C,U,S)}if(++C===M)break}if(m=0,(O=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(O>=65488&&O<=65495))break;d+=2}return d-h}function O(e,t){var r=[],n=t.blocksPerLine,i=t.blocksPerColumn,a=n<<3,o=new Int32Array(64),s=new Uint8Array(64);function f(e,r,n){var i,a,o,s,f,l,u,c,h,d,p=t.quantizationTable,m=n;for(d=0;d<64;d++)m[d]=e[d]*p[d];for(d=0;d<8;++d){var v=8*d;0!==m[1+v]||0!==m[2+v]||0!==m[3+v]||0!==m[4+v]||0!==m[5+v]||0!==m[6+v]||0!==m[7+v]?(i=5793*m[0+v]+128>>8,a=5793*m[4+v]+128>>8,o=m[2+v],s=m[6+v],f=2896*(m[1+v]-m[7+v])+128>>8,c=2896*(m[1+v]+m[7+v])+128>>8,l=m[3+v]<<4,h=i-a+1>>1,i=i+a+1>>1,a=h,h=3784*o+1567*s+128>>8,o=1567*o-3784*s+128>>8,s=h,h=f-(u=m[5+v]<<4)+1>>1,f=f+u+1>>1,u=h,h=c+l+1>>1,l=c-l+1>>1,c=h,h=i-s+1>>1,i=i+s+1>>1,s=h,h=a-o+1>>1,a=a+o+1>>1,o=h,h=2276*f+3406*c+2048>>12,f=3406*f-2276*c+2048>>12,c=h,h=799*l+4017*u+2048>>12,l=4017*l-799*u+2048>>12,u=h,m[0+v]=i+c,m[7+v]=i-c,m[1+v]=a+u,m[6+v]=a-u,m[2+v]=o+l,m[5+v]=o-l,m[3+v]=s+f,m[4+v]=s-f):(h=5793*m[0+v]+512>>10,m[0+v]=h,m[1+v]=h,m[2+v]=h,m[3+v]=h,m[4+v]=h,m[5+v]=h,m[6+v]=h,m[7+v]=h)}for(d=0;d<8;++d){var y=d;0!==m[8+y]||0!==m[16+y]||0!==m[24+y]||0!==m[32+y]||0!==m[40+y]||0!==m[48+y]||0!==m[56+y]?(i=5793*m[0+y]+2048>>12,a=5793*m[32+y]+2048>>12,o=m[16+y],s=m[48+y],f=2896*(m[8+y]-m[56+y])+2048>>12,c=2896*(m[8+y]+m[56+y])+2048>>12,l=m[24+y],h=i-a+1>>1,i=i+a+1>>1,a=h,h=3784*o+1567*s+2048>>12,o=1567*o-3784*s+2048>>12,s=h,h=f-(u=m[40+y])+1>>1,f=f+u+1>>1,u=h,h=c+l+1>>1,l=c-l+1>>1,c=h,h=i-s+1>>1,i=i+s+1>>1,s=h,h=a-o+1>>1,a=a+o+1>>1,o=h,h=2276*f+3406*c+2048>>12,f=3406*f-2276*c+2048>>12,c=h,h=799*l+4017*u+2048>>12,l=4017*l-799*u+2048>>12,u=h,m[0+y]=i+c,m[56+y]=i-c,m[8+y]=a+u,m[48+y]=a-u,m[16+y]=o+l,m[40+y]=o-l,m[24+y]=s+f,m[32+y]=s-f):(h=5793*n[d+0]+8192>>14,m[0+y]=h,m[8+y]=h,m[16+y]=h,m[24+y]=h,m[32+y]=h,m[40+y]=h,m[48+y]=h,m[56+y]=h)}for(d=0;d<64;++d){var w=128+(m[d]+8>>4);r[d]=w<0?0:w>255?255:w}}for(var l=0;l<i;l++){for(var u=l<<3,c=0;c<8;c++)r.push(new Uint8Array(a));for(var h=0;h<n;h++){f(t.blocks[l][h],s,o);for(var d=0,p=h<<3,m=0;m<8;m++)for(var v=r[u+m],y=0;y<8;y++)v[p+y]=s[d++]}}return r}var M=function(){function e(){u(this,e),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return h(e,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(e){var t=0;function r(){var r=e[t]<<8|e[t+1];return t+=2,r}function n(e){var t,r,n=0,i=0;for(r in e.components)e.components.hasOwnProperty(r)&&(n<(t=e.components[r]).h&&(n=t.h),i<t.v&&(i=t.v));var a=Math.ceil(e.samplesPerLine/8/n),o=Math.ceil(e.scanLines/8/i);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];for(var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/n),f=Math.ceil(Math.ceil(e.scanLines/8)*t.v/i),l=a*t.h,u=o*t.v,c=[],h=0;h<u;h++){for(var d=[],p=0;p<l;p++)d.push(new Int32Array(64));c.push(d)}t.blocksPerLine=s,t.blocksPerColumn=f,t.blocks=c}e.maxH=n,e.maxV=i,e.mcusPerLine=a,e.mcusPerColumn=o}var i,a,o=r();if(65496!==o)throw new Error("SOI not found");for(o=r();65497!==o;){switch(o){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var s=(i=void 0,a=void 0,i=r(),a=e.subarray(t,t+i-2),t+=a.length,a);65504===o&&74===s[0]&&70===s[1]&&73===s[2]&&70===s[3]&&0===s[4]&&(this.jfif={version:{major:s[5],minor:s[6]},densityUnits:s[7],xDensity:s[8]<<8|s[9],yDensity:s[10]<<8|s[11],thumbWidth:s[12],thumbHeight:s[13],thumbData:s.subarray(14,14+3*s[12]*s[13])}),65518===o&&65===s[0]&&100===s[1]&&111===s[2]&&98===s[3]&&101===s[4]&&0===s[5]&&(this.adobe={version:s[6],flags0:s[7]<<8|s[8],flags1:s[9]<<8|s[10],transformCode:s[11]});break;case 65499:for(var f=r()+t-2;t<f;){var l=e[t++],u=new Int32Array(64);if(l>>4==0)for(var c=0;c<64;c++){u[D[c]]=e[t++]}else{if(l>>4!=1)throw new Error("DQT: invalid table spec");for(var h=0;h<64;h++){u[D[h]]=r()}}this.quantizationTables[15&l]=u}break;case 65472:case 65473:case 65474:r();for(var d={extended:65473===o,progressive:65474===o,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},p=e[t++],m=void 0,v=0;v<p;v++){m=e[t];var y=e[t+1]>>4,w=15&e[t+1],g=e[t+2];d.componentsOrder.push(m),d.components[m]={h:y,v:w,quantizationIdx:g},t+=3}n(d),this.frames.push(d);break;case 65476:for(var b=r(),k=2;k<b;){for(var x=e[t++],_=new Uint8Array(16),A=0,P=0;P<16;P++,t++)_[P]=e[t],A+=_[P];for(var I=new Uint8Array(A),U=0;U<A;U++,t++)I[U]=e[t];k+=17+A,x>>4==0?this.huffmanTablesDC[15&x]=E(_,I):this.huffmanTablesAC[15&x]=E(_,I)}break;case 65501:r(),this.resetInterval=r();break;case 65498:r();for(var S=e[t++],T=[],O=this.frames[0],M=0;M<S;M++){var C=O.components[e[t++]],L=e[t++];C.huffmanTableDC=this.huffmanTablesDC[L>>4],C.huffmanTableAC=this.huffmanTablesAC[15&L],T.push(C)}var R=e[t++],V=e[t++],G=e[t++],F=B(e,t,O,T,this.resetInterval,R,V,G>>4,15&G);t+=F;break;case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error("unknown JPEG marker ".concat(o.toString(16)))}o=r()}}},{key:"getResult",value:function(){var e=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var t=0;t<this.frames.length;t++)for(var r=this.frames[t].components,n=0,i=Object.keys(r);n<i.length;n++){var a=i[n];r[a].quantizationTable=this.quantizationTables[r[a].quantizationIdx],delete r[a].quantizationIdx}for(var o=e[0],s=o.components,f=o.componentsOrder,l=[],u=o.samplesPerLine,c=o.scanLines,h=0;h<f.length;h++){var d=s[f[h]];l.push({lines:O(0,d),scaleX:d.h/o.maxH,scaleY:d.v/o.maxV})}for(var p=new Uint8Array(u*c*l.length),m=0,v=0;v<c;++v)for(var y=0;y<u;++y)for(var w=0;w<l.length;++w){var g=l[w];p[m]=g.lines[0|v*g.scaleY][0|y*g.scaleX],++m}return p}}]),e}(),C=function(e){p(r,b);var t=T(r);function r(e){var n;return u(this,r),(n=t.call(this)).reader=new M,e.JPEGTables&&n.reader.parse(e.JPEGTables),n}return h(r,[{key:"decodeBlock",value:function(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}]),r}(),L=Object.freeze({__proto__:null,default:C});function R(e){for(var t=e.length;--t>=0;)e[t]=0}R(new Array(576)),R(new Array(60)),R(new Array(512)),R(new Array(256)),R(new Array(29)),R(new Array(30));var V=function(e,t,r,n){for(var i=65535&e|0,a=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{a=a+(i=i+t[n++]|0)|0}while(--o);i%=65521,a%=65521}return i|a<<16|0},G=new Uint32Array(function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}()),F=function(e,t,r,n){var i=G,a=n+r;e^=-1;for(var o=n;o<a;o++)e=e>>>8^i[255&(e^t[o])];return-1^e},z={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},j={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},N=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Z=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!==r(n))throw new TypeError(n+"must be non-object");for(var i in n)N(n,i)&&(e[i]=n[i])}}return e},K=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var i=new Uint8Array(t),a=0,o=0,s=e.length;a<s;a++){var f=e[a];i.set(f,o),o+=f.length}return i},H=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){H=!1}for(var Y=new Uint8Array(256),X=0;X<256;X++)Y[X]=X>=252?6:X>=248?5:X>=240?4:X>=224?3:X>=192?2:1;Y[254]=Y[254]=1;var W=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,r,n,i,a,o=e.length,s=0;for(i=0;i<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),a=0,i=0;a<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},q=function(e,t){var r,n,i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var a=new Array(2*i);for(n=0,r=0;r<i;){var o=e[r++];if(o<128)a[n++]=o;else{var s=Y[o];if(s>4)a[n++]=65533,r+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&r<i;)o=o<<6|63&e[r++],s--;s>1?a[n++]=65533:o<65536?a[n++]=o:(o-=65536,a[n++]=55296|o>>10&1023,a[n++]=56320|1023&o)}}}return function(e,t){if(t<65534&&e.subarray&&H)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}(a,n)},J=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Y[e[r]]>t?r:t};var Q=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},$=function(e,t){var r,n,i,a,o,s,f,l,u,c,h,d,p,m,v,y,w,g,b,k,x,_,A,P,I=e.state;r=e.next_in,A=e.input,n=r+(e.avail_in-5),i=e.next_out,P=e.output,a=i-(t-e.avail_out),o=i+(e.avail_out-257),s=I.dmax,f=I.wsize,l=I.whave,u=I.wnext,c=I.window,h=I.hold,d=I.bits,p=I.lencode,m=I.distcode,v=(1<<I.lenbits)-1,y=(1<<I.distbits)-1;e:do{d<15&&(h+=A[r++]<<d,d+=8,h+=A[r++]<<d,d+=8),w=p[h&v];t:for(;;){if(h>>>=g=w>>>24,d-=g,0===(g=w>>>16&255))P[i++]=65535&w;else{if(!(16&g)){if(0==(64&g)){w=p[(65535&w)+(h&(1<<g)-1)];continue t}if(32&g){I.mode=12;break e}e.msg="invalid literal/length code",I.mode=30;break e}b=65535&w,(g&=15)&&(d<g&&(h+=A[r++]<<d,d+=8),b+=h&(1<<g)-1,h>>>=g,d-=g),d<15&&(h+=A[r++]<<d,d+=8,h+=A[r++]<<d,d+=8),w=m[h&y];r:for(;;){if(h>>>=g=w>>>24,d-=g,!(16&(g=w>>>16&255))){if(0==(64&g)){w=m[(65535&w)+(h&(1<<g)-1)];continue r}e.msg="invalid distance code",I.mode=30;break e}if(k=65535&w,d<(g&=15)&&(h+=A[r++]<<d,(d+=8)<g&&(h+=A[r++]<<d,d+=8)),(k+=h&(1<<g)-1)>s){e.msg="invalid distance too far back",I.mode=30;break e}if(h>>>=g,d-=g,k>(g=i-a)){if((g=k-g)>l&&I.sane){e.msg="invalid distance too far back",I.mode=30;break e}if(x=0,_=c,0===u){if(x+=f-g,g<b){b-=g;do{P[i++]=c[x++]}while(--g);x=i-k,_=P}}else if(u<g){if(x+=f+u-g,(g-=u)<b){b-=g;do{P[i++]=c[x++]}while(--g);if(x=0,u<b){b-=g=u;do{P[i++]=c[x++]}while(--g);x=i-k,_=P}}}else if(x+=u-g,g<b){b-=g;do{P[i++]=c[x++]}while(--g);x=i-k,_=P}for(;b>2;)P[i++]=_[x++],P[i++]=_[x++],P[i++]=_[x++],b-=3;b&&(P[i++]=_[x++],b>1&&(P[i++]=_[x++]))}else{x=i-k;do{P[i++]=P[x++],P[i++]=P[x++],P[i++]=P[x++],b-=3}while(b>2);b&&(P[i++]=P[x++],b>1&&(P[i++]=P[x++]))}break}}break}}while(r<n&&i<o);r-=b=d>>3,h&=(1<<(d-=b<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<o?o-i+257:257-(i-o),I.hold=h,I.bits=d},ee=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),te=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),re=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ne=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ie=function(e,t,r,n,i,a,o,s){var f,l,u,c,h,d,p,m,v,y=s.bits,w=0,g=0,b=0,k=0,x=0,_=0,A=0,P=0,I=0,U=0,S=null,T=0,D=new Uint16Array(16),E=new Uint16Array(16),B=null,O=0;for(w=0;w<=15;w++)D[w]=0;for(g=0;g<n;g++)D[t[r+g]]++;for(x=y,k=15;k>=1&&0===D[k];k--);if(x>k&&(x=k),0===k)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(b=1;b<k&&0===D[b];b++);for(x<b&&(x=b),P=1,w=1;w<=15;w++)if(P<<=1,(P-=D[w])<0)return-1;if(P>0&&(0===e||1!==k))return-1;for(E[1]=0,w=1;w<15;w++)E[w+1]=E[w]+D[w];for(g=0;g<n;g++)0!==t[r+g]&&(o[E[t[r+g]]++]=g);if(0===e?(S=B=o,d=19):1===e?(S=ee,T-=257,B=te,O-=257,d=256):(S=re,B=ne,d=-1),U=0,g=0,w=b,h=a,_=x,A=0,u=-1,c=(I=1<<x)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){p=w-A,o[g]<d?(m=0,v=o[g]):o[g]>d?(m=B[O+o[g]],v=S[T+o[g]]):(m=96,v=0),f=1<<w-A,b=l=1<<_;do{i[h+(U>>A)+(l-=f)]=p<<24|m<<16|v|0}while(0!==l);for(f=1<<w-1;U&f;)f>>=1;if(0!==f?(U&=f-1,U+=f):U=0,g++,0==--D[w]){if(w===k)break;w=t[r+o[g]]}if(w>x&&(U&c)!==u){for(0===A&&(A=x),h+=b,P=1<<(_=w-A);_+A<k&&!((P-=D[_+A])<=0);)_++,P<<=1;if(I+=1<<_,1===e&&I>852||2===e&&I>592)return 1;i[u=U&c]=x<<24|_<<16|h-a|0}}return 0!==U&&(i[h+U]=w-A<<24|64<<16|0),s.bits=x,0},ae=j.Z_FINISH,oe=j.Z_BLOCK,se=j.Z_TREES,fe=j.Z_OK,le=j.Z_STREAM_END,ue=j.Z_NEED_DICT,ce=j.Z_STREAM_ERROR,he=j.Z_DATA_ERROR,de=j.Z_MEM_ERROR,pe=j.Z_BUF_ERROR,me=j.Z_DEFLATED,ve=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function ye(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var we,ge,be=function(e){if(!e||!e.state)return ce;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,fe},ke=function(e){if(!e||!e.state)return ce;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,be(e)},xe=function(e,t){var r;if(!e||!e.state)return ce;var n=e.state;return t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?ce:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,ke(e))},_e=function(e,t){if(!e)return ce;var r=new ye;e.state=r,r.window=null;var n=xe(e,t);return n!==fe&&(e.state=null),n},Ae=!0,Pe=function(e){if(Ae){we=new Int32Array(512),ge=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ie(1,e.lens,0,288,we,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ie(2,e.lens,0,32,ge,0,e.work,{bits:5}),Ae=!1}e.lencode=we,e.lenbits=9,e.distcode=ge,e.distbits=5},Ie=function(e,t,r,n){var i,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):((i=a.wsize-a.wnext)>n&&(i=n),a.window.set(t.subarray(r-n,r-n+i),a.wnext),(n-=i)?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Ue={inflateReset:ke,inflateReset2:xe,inflateResetKeep:be,inflateInit:function(e){return _e(e,15)},inflateInit2:_e,inflate:function(e,t){var r,n,i,a,o,s,f,l,u,c,h,d,p,m,v,y,w,g,b,k,x,_,A,P,I=0,U=new Uint8Array(4),S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return ce;12===(r=e.state).mode&&(r.mode=13),o=e.next_out,i=e.output,f=e.avail_out,a=e.next_in,n=e.input,s=e.avail_in,l=r.hold,u=r.bits,c=s,h=f,_=fe;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;u<16;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(2&r.wrap&&35615===l){r.check=0,U[0]=255&l,U[1]=l>>>8&255,r.check=F(r.check,U,2,0),l=0,u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=30;break}if((15&l)!==me){e.msg="unknown compression method",r.mode=30;break}if(u-=4,x=8+(15&(l>>>=4)),0===r.wbits)r.wbits=x;else if(x>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=512&l?10:12,l=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(r.flags=l,(255&r.flags)!==me){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&(U[0]=255&l,U[1]=l>>>8&255,r.check=F(r.check,U,2,0)),l=0,u=0,r.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}r.head&&(r.head.time=l),512&r.flags&&(U[0]=255&l,U[1]=l>>>8&255,U[2]=l>>>16&255,U[3]=l>>>24&255,r.check=F(r.check,U,4,0)),l=0,u=0,r.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&(U[0]=255&l,U[1]=l>>>8&255,r.check=F(r.check,U,2,0)),l=0,u=0,r.mode=5;case 5:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&(U[0]=255&l,U[1]=l>>>8&255,r.check=F(r.check,U,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((d=r.length)>s&&(d=s),d&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+d),x)),512&r.flags&&(r.check=F(r.check,n,d,a)),s-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;d=0;do{x=n[a+d++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&d<s);if(512&r.flags&&(r.check=F(r.check,n,d,a)),s-=d,a+=d,x)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;d=0;do{x=n[a+d++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&d<s);if(512&r.flags&&(r.check=F(r.check,n,d,a)),s-=d,a+=d,x)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;u<32;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}e.adler=r.check=ve(l),l=0,u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=o,e.avail_out=f,e.next_in=a,e.avail_in=s,r.hold=l,r.bits=u,ue;e.adler=r.check=1,r.mode=12;case 12:if(t===oe||t===se)break e;case 13:if(r.last){l>>>=7&u,u-=7&u,r.mode=27;break}for(;u<3;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}switch(r.last=1&l,u-=1,3&(l>>>=1)){case 0:r.mode=14;break;case 1:if(Pe(r),r.mode=20,t===se){l>>>=2,u-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}l>>>=2,u-=2;break;case 14:for(l>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&l,l=0,u=0,r.mode=15,t===se)break e;case 15:r.mode=16;case 16:if(d=r.length){if(d>s&&(d=s),d>f&&(d=f),0===d)break e;i.set(n.subarray(a,a+d),o),s-=d,a+=d,f-=d,o+=d,r.length-=d;break}r.mode=12;break;case 17:for(;u<14;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(r.nlen=257+(31&l),l>>>=5,u-=5,r.ndist=1+(31&l),l>>>=5,u-=5,r.ncode=4+(15&l),l>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}r.lens[S[r.have++]]=7&l,l>>>=3,u-=3}for(;r.have<19;)r.lens[S[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},_=ie(0,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,_){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;y=(I=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,w=65535&I,!((v=I>>>24)<=u);){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(w<16)l>>>=v,u-=v,r.lens[r.have++]=w;else{if(16===w){for(P=v+2;u<P;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(l>>>=v,u-=v,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}x=r.lens[r.have-1],d=3+(3&l),l>>>=2,u-=2}else if(17===w){for(P=v+3;u<P;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}u-=v,x=0,d=3+(7&(l>>>=v)),l>>>=3,u-=3}else{for(P=v+7;u<P;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}u-=v,x=0,d=11+(127&(l>>>=v)),l>>>=7,u-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;d--;)r.lens[r.have++]=x}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,A={bits:r.lenbits},_=ie(1,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,_){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},_=ie(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,_){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,t===se)break e;case 20:r.mode=21;case 21:if(s>=6&&f>=258){e.next_out=o,e.avail_out=f,e.next_in=a,e.avail_in=s,r.hold=l,r.bits=u,$(e,h),o=e.next_out,i=e.output,f=e.avail_out,a=e.next_in,n=e.input,s=e.avail_in,l=r.hold,u=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;y=(I=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,w=65535&I,!((v=I>>>24)<=u);){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(y&&0==(240&y)){for(g=v,b=y,k=w;y=(I=r.lencode[k+((l&(1<<g+b)-1)>>g)])>>>16&255,w=65535&I,!(g+(v=I>>>24)<=u);){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}l>>>=g,u-=g,r.back+=g}if(l>>>=v,u-=v,r.back+=v,r.length=w,0===y){r.mode=26;break}if(32&y){r.back=-1,r.mode=12;break}if(64&y){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&y,r.mode=22;case 22:if(r.extra){for(P=r.extra;u<P;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;y=(I=r.distcode[l&(1<<r.distbits)-1])>>>16&255,w=65535&I,!((v=I>>>24)<=u);){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(0==(240&y)){for(g=v,b=y,k=w;y=(I=r.distcode[k+((l&(1<<g+b)-1)>>g)])>>>16&255,w=65535&I,!(g+(v=I>>>24)<=u);){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}l>>>=g,u-=g,r.back+=g}if(l>>>=v,u-=v,r.back+=v,64&y){e.msg="invalid distance code",r.mode=30;break}r.offset=w,r.extra=15&y,r.mode=24;case 24:if(r.extra){for(P=r.extra;u<P;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===f)break e;if(d=h-f,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}d>r.wnext?(d-=r.wnext,p=r.wsize-d):p=r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=i,p=o-r.offset,d=r.length;d>f&&(d=f),f-=d,r.length-=d;do{i[o++]=m[p++]}while(--d);0===r.length&&(r.mode=21);break;case 26:if(0===f)break e;i[o++]=r.length,f--,r.mode=21;break;case 27:if(r.wrap){for(;u<32;){if(0===s)break e;s--,l|=n[a++]<<u,u+=8}if(h-=f,e.total_out+=h,r.total+=h,h&&(e.adler=r.check=r.flags?F(r.check,i,h,o-h):V(r.check,i,h,o-h)),h=f,(r.flags?l:ve(l))!==r.check){e.msg="incorrect data check",r.mode=30;break}l=0,u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,l+=n[a++]<<u,u+=8}if(l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}l=0,u=0}r.mode=29;case 29:_=le;break e;case 30:_=he;break e;case 31:return de;default:return ce}return e.next_out=o,e.avail_out=f,e.next_in=a,e.avail_in=s,r.hold=l,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<30&&(r.mode<27||t!==ae))&&Ie(e,e.output,e.next_out,h-e.avail_out),c-=e.avail_in,h-=e.avail_out,e.total_in+=c,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=r.flags?F(r.check,i,h,e.next_out-h):V(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===c&&0===h||t===ae)&&_===fe&&(_=pe),_},inflateEnd:function(e){if(!e||!e.state)return ce;var t=e.state;return t.window&&(t.window=null),e.state=null,fe},inflateGetHeader:function(e,t){if(!e||!e.state)return ce;var r=e.state;return 0==(2&r.wrap)?ce:(r.head=t,t.done=!1,fe)},inflateSetDictionary:function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?ce:11===r.mode&&V(1,t,n,0)!==r.check?he:Ie(e,t,n,n)?(r.mode=31,de):(r.havedict=1,fe):ce},inflateInfo:"pako inflate (from Nodeca project)"};var Se=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Te=Object.prototype.toString,De=j.Z_NO_FLUSH,Ee=j.Z_FINISH,Be=j.Z_OK,Oe=j.Z_STREAM_END,Me=j.Z_NEED_DICT,Ce=j.Z_STREAM_ERROR,Le=j.Z_DATA_ERROR,Re=j.Z_MEM_ERROR;function Ve(e){this.options=Z({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Q,this.strm.avail_out=0;var r=Ue.inflateInit2(this.strm,t.windowBits);if(r!==Be)throw new Error(z[r]);if(this.header=new Se,Ue.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=W(t.dictionary):"[object ArrayBuffer]"===Te.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Ue.inflateSetDictionary(this.strm,t.dictionary))!==Be))throw new Error(z[r])}function Ge(e,t){var r=new Ve(t);if(r.push(e),r.err)throw r.msg||z[r.err];return r.result}Ve.prototype.push=function(e,t){var r,n,i,a=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?Ee:De,"[object ArrayBuffer]"===Te.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(o),a.next_out=0,a.avail_out=o),(r=Ue.inflate(a,n))===Me&&s&&((r=Ue.inflateSetDictionary(a,s))===Be?r=Ue.inflate(a,n):r===Le&&(r=Me));a.avail_in>0&&r===Oe&&a.state.wrap>0&&0!==e[a.next_in];)Ue.inflateReset(a),r=Ue.inflate(a,n);switch(r){case Ce:case Le:case Me:case Re:return this.onEnd(r),this.ended=!0,!1}if(i=a.avail_out,a.next_out&&(0===a.avail_out||r===Oe))if("string"===this.options.to){var f=J(a.output,a.next_out),l=a.next_out-f,u=q(a.output,f);a.next_out=l,a.avail_out=o-l,l&&a.output.set(a.output.subarray(f,f+l),0),this.onData(u)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(r!==Be||0!==i){if(r===Oe)return r=Ue.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},Ve.prototype.onData=function(e){this.chunks.push(e)},Ve.prototype.onEnd=function(e){e===Be&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=K(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Fe={Inflate:Ve,inflate:Ge,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Ge(e,t)},ungzip:Ge,constants:j}.inflate;function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}var je=function(e){p(r,b);var t=ze(r);function r(){return u(this,r),t.apply(this,arguments)}return h(r,[{key:"decodeBlock",value:function(e){return Fe(new Uint8Array(e)).buffer}}]),r}(),Ne=Object.freeze({__proto__:null,default:je});function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}var Ke,He=function(e){p(r,b);var t=Ze(r);function r(){return u(this,r),t.apply(this,arguments)}return h(r,[{key:"decodeBlock",value:function(e){for(var t=new DataView(e),r=[],n=0;n<e.byteLength;++n){var i=t.getInt8(n);if(i<0){var a=t.getUint8(n+1);i=-i;for(var o=0;o<=i;++o)r.push(a);n+=1}else{for(var s=0;s<=i;++s)r.push(t.getUint8(n+s+1));n+=i+1}}return new Uint8Array(r).buffer}}]),r}(),Ye=Object.freeze({__proto__:null,default:He}),Xe={exports:{}};Ke=Xe,\n/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */\nfunction(){var e,t,r,n,i,a,o,s,f,l,u,c,h,d,p,m,v=(e={defaultNoDataValue:-34027999387901484e22,decode:function(a,o){var s=(o=o||{}).encodedMaskData||null===o.encodedMaskData,f=i(a,o.inputOffset||0,s),l=null!==o.noDataValue?o.noDataValue:e.defaultNoDataValue,u=t(f,o.pixelType||Float32Array,o.encodedMaskData,l,o.returnMask),c={width:f.width,height:f.height,pixelData:u.resultPixels,minValue:u.minValue,maxValue:f.pixels.maxValue,noDataValue:l};return u.resultMask&&(c.maskData=u.resultMask),o.returnEncodedMask&&f.mask&&(c.encodedMaskData=f.mask.bitset?f.mask.bitset:null),o.returnFileInfo&&(c.fileInfo=r(f),o.computeUsedBitDepths&&(c.fileInfo.bitDepths=n(f))),c}},t=function(e,t,r,n,i){var o,s,f,l=0,u=e.pixels.numBlocksX,c=e.pixels.numBlocksY,h=Math.floor(e.width/u),d=Math.floor(e.height/c),p=2*e.maxZError,m=Number.MAX_VALUE;r=r||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),i&&r&&(f=new Uint8Array(e.width*e.height));for(var v,y,w=new Float32Array(h*d),g=0;g<=c;g++){var b=g!==c?d:e.height%c;if(0!==b)for(var k=0;k<=u;k++){var x=k!==u?h:e.width%u;if(0!==x){var _,A,P,I,U=g*e.width*d+k*h,S=e.width-x,T=e.pixels.blocks[l];if(T.encoding<2?(0===T.encoding?_=T.rawData:(a(T.stuffedData,T.bitsPerPixel,T.numValidPixels,T.offset,p,w,e.pixels.maxValue),_=w),A=0):P=2===T.encoding?0:T.offset,r)for(y=0;y<b;y++){for(7&U&&(I=r[U>>3],I<<=7&U),v=0;v<x;v++)7&U||(I=r[U>>3]),128&I?(f&&(f[U]=1),m=m>(o=T.encoding<2?_[A++]:P)?o:m,s[U++]=o):(f&&(f[U]=0),s[U++]=n),I<<=1;U+=S}else if(T.encoding<2)for(y=0;y<b;y++){for(v=0;v<x;v++)m=m>(o=_[A++])?o:m,s[U++]=o;U+=S}else for(m=m>P?P:m,y=0;y<b;y++){for(v=0;v<x;v++)s[U++]=P;U+=S}if(1===T.encoding&&A!==T.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:s,resultMask:f,minValue:m}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},n=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var i=e.pixels.blocks[n];0===i.encoding?r.float32=!0:1===i.encoding?r[i.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},i=function(e,t,r){var n={},i=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,i),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var a=new DataView(e,t,24);if(n.fileVersion=a.getInt32(0,!0),n.imageType=a.getInt32(4,!0),n.height=a.getUint32(8,!0),n.width=a.getUint32(12,!0),n.maxZError=a.getFloat64(16,!0),t+=24,!r)if(a=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=a.getUint32(0,!0),n.mask.numBlocksX=a.getUint32(4,!0),n.mask.numBytes=a.getUint32(8,!0),n.mask.maxValue=a.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(a=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),f=2,l=0;do{if(s>0)for(;s--;)o[l++]=a.getUint8(f++);else{var u=a.getUint8(f++);for(s=-s;s--;)o[l++]=u}s=a.getInt16(f,!0),f+=2}while(f<n.mask.numBytes);if(-32768!==s||l<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));a=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=a.getUint32(0,!0),n.pixels.numBlocksX=a.getUint32(4,!0),n.pixels.numBytes=a.getUint32(8,!0),n.pixels.maxValue=a.getFloat32(12,!0),t+=16;var c=n.pixels.numBlocksX,h=n.pixels.numBlocksY,d=c+(n.width%c>0?1:0),p=h+(n.height%h>0?1:0);n.pixels.blocks=new Array(d*p);for(var m=0,v=0;v<p;v++)for(var y=0;y<d;y++){var w=0,g=e.byteLength-t;a=new DataView(e,t,Math.min(10,g));var b={};n.pixels.blocks[m++]=b;var k=a.getUint8(0);if(w++,b.encoding=63&k,b.encoding>3)throw"Invalid block encoding ("+b.encoding+")";if(2!==b.encoding){if(0!==k&&2!==k){if(k>>=6,b.offsetType=k,2===k)b.offset=a.getInt8(1),w++;else if(1===k)b.offset=a.getInt16(1,!0),w+=2;else{if(0!==k)throw"Invalid block offset type";b.offset=a.getFloat32(1,!0),w+=4}if(1===b.encoding)if(k=a.getUint8(w),w++,b.bitsPerPixel=63&k,k>>=6,b.numValidPixelsType=k,2===k)b.numValidPixels=a.getUint8(w),w++;else if(1===k)b.numValidPixels=a.getUint16(w,!0),w+=2;else{if(0!==k)throw"Invalid valid pixel count type";b.numValidPixels=a.getUint32(w,!0),w+=4}}var x;if(t+=w,3!==b.encoding)if(0===b.encoding){var _=(n.pixels.numBytes-1)/4;if(_!==Math.floor(_))throw"uncompressed block has invalid length";x=new ArrayBuffer(4*_),new Uint8Array(x).set(new Uint8Array(e,t,4*_));var A=new Float32Array(x);b.rawData=A,t+=4*_}else if(1===b.encoding){var P=Math.ceil(b.numValidPixels*b.bitsPerPixel/8),I=Math.ceil(P/4);x=new ArrayBuffer(4*I),new Uint8Array(x).set(new Uint8Array(e,t,P)),b.stuffedData=new Uint32Array(x),t+=P}}else t++}return n.eofOffset=t,n},a=function(e,t,r,n,i,a,o){var s,f,l,u=(1<<t)-1,c=0,h=0,d=Math.ceil((o-n)/i),p=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*p,s=0;s<r;s++){if(0===h&&(l=e[c++],h=32),h>=t)f=l>>>h-t&u,h-=t;else{var m=t-h;f=(l&u)<<m&u,f+=(l=e[c++])>>>(h=32-m)}a[s]=f<d?n+f*i:o}return a},e),y=(o=function(e,t,r,n,i,a,o,s){var f,l,u,c,h,d=(1<<r)-1,p=0,m=0,v=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*v,i)for(f=0;f<n;f++)0===m&&(u=e[p++],m=32),m>=r?(l=u>>>m-r&d,m-=r):(l=(u&d)<<(c=r-m)&d,l+=(u=e[p++])>>>(m=32-c)),t[f]=i[l];else for(h=Math.ceil((s-a)/o),f=0;f<n;f++)0===m&&(u=e[p++],m=32),m>=r?(l=u>>>m-r&d,m-=r):(l=(u&d)<<(c=r-m)&d,l+=(u=e[p++])>>>(m=32-c)),t[f]=l<h?a+l*o:s},s=function(e,t,r,n,i,a){var o,s=(1<<t)-1,f=0,l=0,u=0,c=0,h=0,d=[],p=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*p;var m=Math.ceil((a-n)/i);for(l=0;l<r;l++)0===c&&(o=e[f++],c=32),c>=t?(h=o>>>c-t&s,c-=t):(h=(o&s)<<(u=t-c)&s,h+=(o=e[f++])>>>(c=32-u)),d[l]=h<m?n+h*i:a;return d.unshift(n),d},f=function(e,t,r,n,i,a,o,s){var f,l,u,c,h=(1<<r)-1,d=0,p=0,m=0;if(i)for(f=0;f<n;f++)0===p&&(u=e[d++],p=32,m=0),p>=r?(l=u>>>m&h,p-=r,m+=r):(l=u>>>m&h,p=32-(c=r-p),l|=((u=e[d++])&(1<<c)-1)<<r-c,m=c),t[f]=i[l];else{var v=Math.ceil((s-a)/o);for(f=0;f<n;f++)0===p&&(u=e[d++],p=32,m=0),p>=r?(l=u>>>m&h,p-=r,m+=r):(l=u>>>m&h,p=32-(c=r-p),l|=((u=e[d++])&(1<<c)-1)<<r-c,m=c),t[f]=l<v?a+l*o:s}return t},l=function(e,t,r,n,i,a){var o,s=(1<<t)-1,f=0,l=0,u=0,c=0,h=0,d=0,p=[],m=Math.ceil((a-n)/i);for(l=0;l<r;l++)0===c&&(o=e[f++],c=32,d=0),c>=t?(h=o>>>d&s,c-=t,d+=t):(h=o>>>d&s,c=32-(u=t-c),h|=((o=e[f++])&(1<<u)-1)<<t-u,d=u),p[l]=h<m?n+h*i:a;return p.unshift(n),p},u=function(e,t,r,n){var i,a,o,s,f=(1<<r)-1,l=0,u=0,c=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*c,i=0;i<n;i++)0===u&&(o=e[l++],u=32),u>=r?(a=o>>>u-r&f,u-=r):(a=(o&f)<<(s=r-u)&f,a+=(o=e[l++])>>>(u=32-s)),t[i]=a;return t},c=function(e,t,r,n){var i,a,o,s,f=(1<<r)-1,l=0,u=0,c=0;for(i=0;i<n;i++)0===u&&(o=e[l++],u=32,c=0),u>=r?(a=o>>>c&f,u-=r,c+=r):(a=o>>>c&f,u=32-(s=r-u),a|=((o=e[l++])&(1<<s)-1)<<r-s,c=s),t[i]=a;return t},h={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,i=Math.floor(n/2),a=0;i;){var o=i>=359?359:i;i-=o;do{t+=e[a++]<<8,r+=t+=e[a++]}while(--o);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[a]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),i={};if(i.fileIdentifierString=String.fromCharCode.apply(null,n),0!==i.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+i.fileIdentifierString;r+=6;var a,o=new DataView(e,r,8),s=o.getInt32(0,!0);if(i.fileVersion=s,r+=4,s>=3&&(i.checksum=o.getUint32(4,!0),r+=4),o=new DataView(e,r,12),i.height=o.getUint32(0,!0),i.width=o.getUint32(4,!0),r+=8,s>=4?(i.numDims=o.getUint32(8,!0),r+=4):i.numDims=1,o=new DataView(e,r,40),i.numValidPixel=o.getUint32(0,!0),i.microBlockSize=o.getInt32(4,!0),i.blobSize=o.getInt32(8,!0),i.imageType=o.getInt32(12,!0),i.maxZError=o.getFloat64(16,!0),i.zMin=o.getFloat64(24,!0),i.zMax=o.getFloat64(32,!0),r+=40,t.headerInfo=i,t.ptr=r,s>=3&&(a=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-a,i.blobSize-14))!==i.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),i=r.numDims*this.getDataTypeSize(r.imageType),a=this.readSubArray(e,t.ptr,n,i),o=this.readSubArray(e,t.ptr+i,n,i);t.ptr+=2*i;var s,f=!0;for(s=0;s<r.numDims;s++)if(a[s]!==o[s]){f=!1;break}return r.minValues=a,r.maxValues=o,f},readSubArray:function(e,t,r,n){var i;if(r===Uint8Array)i=new Uint8Array(e,t,n);else{var a=new ArrayBuffer(n);new Uint8Array(a).set(new Uint8Array(e,t,n)),i=new r(a)}return i},readMask:function(e,t){var r,n,i=t.ptr,a=t.headerInfo,o=a.width*a.height,s=a.numValidPixel,f=new DataView(e,i,4),l={};if(l.numBytes=f.getUint32(0,!0),i+=4,(0===s||o===s)&&0!==l.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(o/8)),l.bitset=r,n=new Uint8Array(o),t.pixels.resultMask=n,i+=l.numBytes;else if(l.numBytes>0){r=new Uint8Array(Math.ceil(o/8));var u=(f=new DataView(e,i,l.numBytes)).getInt16(0,!0),c=2,h=0,d=0;do{if(u>0)for(;u--;)r[h++]=f.getUint8(c++);else for(d=f.getUint8(c++),u=-u;u--;)r[h++]=d;u=f.getInt16(c,!0),c+=2}while(c<l.numBytes);if(-32768!==u||h<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var p=0,m=0;for(m=0;m<o;m++)7&m?(p=r[m>>3],p<<=7&m):p=r[m>>3],128&p&&(n[m]=1);t.pixels.resultMask=n,l.bitset=r,i+=l.numBytes}return t.ptr=i,t.mask=l,!0},readDataOneSweep:function(e,t,r,n){var i,a=t.ptr,o=t.headerInfo,s=o.numDims,f=o.width*o.height,l=o.imageType,u=o.numValidPixel*h.getDataTypeSize(l)*s,c=t.pixels.resultMask;if(r===Uint8Array)i=new Uint8Array(e,a,u);else{var d=new ArrayBuffer(u);new Uint8Array(d).set(new Uint8Array(e,a,u)),i=new r(d)}if(i.length===f*s)t.pixels.resultPixels=n?h.swapDimensionOrder(i,f,s,r,!0):i;else{t.pixels.resultPixels=new r(f*s);var p=0,m=0,v=0,y=0;if(s>1){if(n){for(m=0;m<f;m++)if(c[m])for(y=m,v=0;v<s;v++,y+=f)t.pixels.resultPixels[y]=i[p++]}else for(m=0;m<f;m++)if(c[m])for(y=m*s,v=0;v<s;v++)t.pixels.resultPixels[y+v]=i[p++]}else for(m=0;m<f;m++)c[m]&&(t.pixels.resultPixels[m]=i[p++])}return a+=u,t.ptr=a,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var i=n.getInt32(4,!0),a=n.getInt32(8,!0),o=n.getInt32(12,!0);if(a>=o)return!1;var s=new Uint32Array(o-a);h.decodeBits(e,t,s);var f,l,u,c,p=[];for(f=a;f<o;f++)p[l=f-(f<i?0:i)]={first:s[f-a],second:null};var m=e.byteLength-t.ptr,v=Math.ceil(m/4),y=new ArrayBuffer(4*v);new Uint8Array(y).set(new Uint8Array(e,t.ptr,m));var w,g=new Uint32Array(y),b=0,k=0;for(w=g[0],f=a;f<o;f++)(c=p[l=f-(f<i?0:i)].first)>0&&(p[l].second=w<<b>>>32-c,32-b>=c?32===(b+=c)&&(b=0,w=g[++k]):(b+=c-32,w=g[++k],p[l].second|=w>>>32-b));var x=0,_=0,A=new d;for(f=0;f<p.length;f++)void 0!==p[f]&&(x=Math.max(x,p[f].first));_=x>=r?r:x;var P,I,U,S,T,D=[];for(f=a;f<o;f++)if((c=p[l=f-(f<i?0:i)].first)>0)if(P=[c,l],c<=_)for(I=p[l].second<<_-c,U=1<<_-c,u=0;u<U;u++)D[I|u]=P;else for(I=p[l].second,T=A,S=c-1;S>=0;S--)I>>>S&1?(T.right||(T.right=new d),T=T.right):(T.left||(T.left=new d),T=T.left),0!==S||T.val||(T.val=P[1]);return{decodeLut:D,numBitsLUTQick:_,numBitsLUT:x,tree:A,stuffedData:g,srcPtr:k,bitPos:b}},readHuffman:function(e,t,r,n){var i,a,o,s,f,l,u,c,d,p=t.headerInfo.numDims,m=t.headerInfo.height,v=t.headerInfo.width,y=v*m,w=this.readHuffmanTree(e,t),g=w.decodeLut,b=w.tree,k=w.stuffedData,x=w.srcPtr,_=w.bitPos,A=w.numBitsLUTQick,P=w.numBitsLUT,I=0===t.headerInfo.imageType?128:0,U=t.pixels.resultMask,S=0;_>0&&(x++,_=0);var T,D=k[x],E=1===t.encodeMode,B=new r(y*p),O=B;if(p<2||E){for(T=0;T<p;T++)if(p>1&&(O=new r(B.buffer,y*T,y),S=0),t.headerInfo.numValidPixel===v*m)for(c=0,l=0;l<m;l++)for(u=0;u<v;u++,c++){if(a=0,f=s=D<<_>>>32-A,32-_<A&&(f=s|=k[x+1]>>>64-_-A),g[f])a=g[f][1],_+=g[f][0];else for(f=s=D<<_>>>32-P,32-_<P&&(f=s|=k[x+1]>>>64-_-P),i=b,d=0;d<P;d++)if(!(i=s>>>P-d-1&1?i.right:i.left).left&&!i.right){a=i.val,_=_+d+1;break}_>=32&&(_-=32,D=k[++x]),o=a-I,E?(o+=u>0?S:l>0?O[c-v]:S,o&=255,O[c]=o,S=o):O[c]=o}else for(c=0,l=0;l<m;l++)for(u=0;u<v;u++,c++)if(U[c]){if(a=0,f=s=D<<_>>>32-A,32-_<A&&(f=s|=k[x+1]>>>64-_-A),g[f])a=g[f][1],_+=g[f][0];else for(f=s=D<<_>>>32-P,32-_<P&&(f=s|=k[x+1]>>>64-_-P),i=b,d=0;d<P;d++)if(!(i=s>>>P-d-1&1?i.right:i.left).left&&!i.right){a=i.val,_=_+d+1;break}_>=32&&(_-=32,D=k[++x]),o=a-I,E?(u>0&&U[c-1]?o+=S:l>0&&U[c-v]?o+=O[c-v]:o+=S,o&=255,O[c]=o,S=o):O[c]=o}}else for(c=0,l=0;l<m;l++)for(u=0;u<v;u++)if(c=l*v+u,!U||U[c])for(T=0;T<p;T++,c+=y){if(a=0,f=s=D<<_>>>32-A,32-_<A&&(f=s|=k[x+1]>>>64-_-A),g[f])a=g[f][1],_+=g[f][0];else for(f=s=D<<_>>>32-P,32-_<P&&(f=s|=k[x+1]>>>64-_-P),i=b,d=0;d<P;d++)if(!(i=s>>>P-d-1&1?i.right:i.left).left&&!i.right){a=i.val,_=_+d+1;break}_>=32&&(_-=32,D=k[++x]),o=a-I,O[c]=o}t.ptr=t.ptr+4*(x+1)+(_>0?4:0),t.pixels.resultPixels=B,p>1&&!n&&(t.pixels.resultPixels=h.swapDimensionOrder(B,y,p,r))},decodeBits:function(e,t,r,n,i){var a=t.headerInfo,h=a.fileVersion,d=0,p=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,m=new DataView(e,t.ptr,p),v=m.getUint8(0);d++;var y=v>>6,w=0===y?4:3-y,g=(32&v)>0,b=31&v,k=0;if(1===w)k=m.getUint8(d),d++;else if(2===w)k=m.getUint16(d,!0),d+=2;else{if(4!==w)throw"Invalid valid pixel count type";k=m.getUint32(d,!0),d+=4}var x,_,A,P,I,U,S,T,D,E=2*a.maxZError,B=a.numDims>1?a.maxValues[i]:a.zMax;if(g){for(t.counter.lut++,T=m.getUint8(d),d++,P=Math.ceil((T-1)*b/8),I=Math.ceil(P/4),_=new ArrayBuffer(4*I),A=new Uint8Array(_),t.ptr+=d,A.set(new Uint8Array(e,t.ptr,P)),S=new Uint32Array(_),t.ptr+=P,D=0;T-1>>>D;)D++;P=Math.ceil(k*D/8),I=Math.ceil(P/4),_=new ArrayBuffer(4*I),(A=new Uint8Array(_)).set(new Uint8Array(e,t.ptr,P)),x=new Uint32Array(_),t.ptr+=P,U=h>=3?l(S,b,T-1,n,E,B):s(S,b,T-1,n,E,B),h>=3?f(x,r,D,k,U):o(x,r,D,k,U)}else t.counter.bitstuffer++,D=b,t.ptr+=d,D>0&&(P=Math.ceil(k*D/8),I=Math.ceil(P/4),_=new ArrayBuffer(4*I),(A=new Uint8Array(_)).set(new Uint8Array(e,t.ptr,P)),x=new Uint32Array(_),t.ptr+=P,h>=3?null==n?c(x,r,D,k):f(x,r,D,k,!1,n,E,B):null==n?u(x,r,D,k):o(x,r,D,k,!1,n,E,B))},readTiles:function(e,t,r,n){var i=t.headerInfo,a=i.width,o=i.height,s=a*o,f=i.microBlockSize,l=i.imageType,u=h.getDataTypeSize(l),c=Math.ceil(a/f),d=Math.ceil(o/f);t.pixels.numBlocksY=d,t.pixels.numBlocksX=c,t.pixels.ptr=0;var p,m,v,y,w,g,b,k,x,_,A=0,P=0,I=0,U=0,S=0,T=0,D=0,E=0,B=0,O=0,M=0,C=0,L=0,R=0,V=0,G=new r(f*f),F=o%f||f,z=a%f||f,j=i.numDims,N=t.pixels.resultMask,Z=t.pixels.resultPixels,K=i.fileVersion>=5?14:15,H=i.zMax;for(I=0;I<d;I++)for(S=I!==d-1?f:F,U=0;U<c;U++)for(O=I*a*f+U*f,M=a-(T=U!==c-1?f:z),k=0;k<j;k++){if(j>1?(_=Z,O=I*a*f+U*f,Z=new r(t.pixels.resultPixels.buffer,s*k*u,s),H=i.maxValues[k]):_=null,D=e.byteLength-t.ptr,m={},V=0,E=(p=new DataView(e,t.ptr,Math.min(10,D))).getUint8(0),V++,x=i.fileVersion>=5?4&E:0,B=E>>6&255,(E>>2&K)!=(U*f>>3&K))throw"integrity issue";if(x&&0===k)throw"integrity issue";if((w=3&E)>3)throw t.ptr+=V,"Invalid block encoding ("+w+")";if(2!==w)if(0===w){if(x)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=V,C=(C=S*T*u)<(L=e.byteLength-t.ptr)?C:L,v=new ArrayBuffer(C%u==0?C:C+u-C%u),new Uint8Array(v).set(new Uint8Array(e,t.ptr,C)),y=new r(v),R=0,N)for(A=0;A<S;A++){for(P=0;P<T;P++)N[O]&&(Z[O]=y[R++]),O++;O+=M}else for(A=0;A<S;A++){for(P=0;P<T;P++)Z[O++]=y[R++];O+=M}t.ptr+=R*u}else if(g=h.getDataTypeUsed(x&&l<6?4:l,B),b=h.getOnePixel(m,V,g,p),V+=h.getDataTypeSize(g),3===w)if(t.ptr+=V,t.counter.constantoffset++,N)for(A=0;A<S;A++){for(P=0;P<T;P++)N[O]&&(Z[O]=x?Math.min(H,_[O]+b):b),O++;O+=M}else for(A=0;A<S;A++){for(P=0;P<T;P++)Z[O]=x?Math.min(H,_[O]+b):b,O++;O+=M}else if(t.ptr+=V,h.decodeBits(e,t,G,b,k),V=0,x)if(N)for(A=0;A<S;A++){for(P=0;P<T;P++)N[O]&&(Z[O]=G[V++]+_[O]),O++;O+=M}else for(A=0;A<S;A++){for(P=0;P<T;P++)Z[O]=G[V++]+_[O],O++;O+=M}else if(N)for(A=0;A<S;A++){for(P=0;P<T;P++)N[O]&&(Z[O]=G[V++]),O++;O+=M}else for(A=0;A<S;A++){for(P=0;P<T;P++)Z[O++]=G[V++];O+=M}else{if(x)if(N)for(A=0;A<S;A++)for(P=0;P<T;P++)N[O]&&(Z[O]=_[O]),O++;else for(A=0;A<S;A++)for(P=0;P<T;P++)Z[O]=_[O],O++;t.counter.constant++,t.ptr+=V}}j>1&&!n&&(t.pixels.resultPixels=h.swapDimensionOrder(t.pixels.resultPixels,s,j,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:h.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,i=e.headerInfo.maxValues,a=e.headerInfo.numDims,o=e.headerInfo.height*e.headerInfo.width,s=0,f=0,l=0,u=e.pixels.resultMask,c=e.pixels.resultPixels;if(u)if(a>1){if(t)for(s=0;s<a;s++)for(l=s*o,r=i[s],f=0;f<o;f++)u[f]&&(c[l+f]=r);else for(f=0;f<o;f++)if(u[f])for(l=f*a,s=0;s<a;s++)c[l+a]=i[s]}else for(f=0;f<o;f++)u[f]&&(c[f]=r);else if(a>1&&n!==r)if(t)for(s=0;s<a;s++)for(l=s*o,r=i[s],f=0;f<o;f++)c[l+f]=r;else for(f=0;f<o;f++)for(l=f*a,s=0;s<a;s++)c[l+s]=i[s];else for(f=0;f<o*a;f++)c[f]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:default:t=Float32Array;break;case 7:t=Float64Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:default:t="F32";break;case 7:t="F64"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=-17976931348623157e292&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var i=0;switch(r){case 0:i=n.getInt8(t);break;case 1:i=n.getUint8(t);break;case 2:i=n.getInt16(t,!0);break;case 3:i=n.getUint16(t,!0);break;case 4:i=n.getInt32(t,!0);break;case 5:i=n.getUInt32(t,!0);break;case 6:i=n.getFloat32(t,!0);break;case 7:i=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return i},swapDimensionOrder:function(e,t,r,n,i){var a=0,o=0,s=0,f=0,l=e;if(r>1)if(l=new n(t*r),i)for(a=0;a<t;a++)for(f=a,s=0;s<r;s++,f+=t)l[f]=e[o++];else for(a=0;a<t;a++)for(f=a,s=0;s<r;s++,f+=t)l[o++]=e[f];return l}},d=function(e,t,r){this.val=e,this.left=t,this.right=r},{decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,i={};i.ptr=t.inputOffset||0,i.pixels={},h.readHeaderInfo(e,i);var a=i.headerInfo,o=a.fileVersion,s=h.getDataTypeArray(a.imageType);if(o>5)throw"unsupported lerc version 2."+o;h.readMask(e,i),a.numValidPixel===a.width*a.height||i.pixels.resultMask||(i.pixels.resultMask=t.maskData);var f=a.width*a.height;i.pixels.resultPixels=new s(f*a.numDims),i.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var l,u=!t.returnPixelInterleavedDims;if(0!==a.numValidPixel)if(a.zMax===a.zMin)h.constructConstantSurface(i,u);else if(o>=4&&h.checkMinMaxRanges(e,i))h.constructConstantSurface(i,u);else{var c=new DataView(e,i.ptr,2),d=c.getUint8(0);if(i.ptr++,d)h.readDataOneSweep(e,i,s,u);else if(o>1&&a.imageType<=1&&Math.abs(a.maxZError-.5)<1e-5){var p=c.getUint8(1);if(i.ptr++,i.encodeMode=p,p>2||o<4&&p>1)throw"Invalid Huffman flag "+p;p?h.readHuffman(e,i,s,u):h.readTiles(e,i,s,u)}else h.readTiles(e,i,s,u)}i.eofOffset=i.ptr,t.inputOffset?(l=i.headerInfo.blobSize+t.inputOffset-i.ptr,Math.abs(l)>=1&&(i.eofOffset=t.inputOffset+i.headerInfo.blobSize)):(l=i.headerInfo.blobSize-i.ptr,Math.abs(l)>=1&&(i.eofOffset=i.headerInfo.blobSize));var m={width:a.width,height:a.height,pixelData:i.pixels.resultPixels,minValue:a.zMin,maxValue:a.zMax,validPixelCount:a.numValidPixel,dimCount:a.numDims,dimStats:{minValues:a.minValues,maxValues:a.maxValues},maskData:i.pixels.resultMask};if(i.pixels.resultMask&&h.isValidPixelValue(a.imageType,r)){var v=i.pixels.resultMask;for(n=0;n<f;n++)v[n]||(m.pixelData[n]=r);m.noDataValue=r}return i.noDataValue=r,t.returnFileInfo&&(m.fileInfo=h.formatFileInfo(i)),m},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)h.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}}),w=(p=new ArrayBuffer(4),m=new Uint8Array(p),new Uint32Array(p)[0]=1,1===m[0]),g={decode:function(e,t){if(!w)throw"Big endian system is not supported.";var r,n,i=(t=t||{}).inputOffset||0,a=new Uint8Array(e,i,10),o=String.fromCharCode.apply(null,a);if("CntZImage"===o.trim())r=v,n=1;else{if("Lerc2"!==o.substring(0,5))throw"Unexpected file identifier string: "+o;r=y,n=2}for(var s,f,l,u,c,h,d=0,p=e.byteLength-10,m=[],g={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]},b=0;i<p;){var k=r.decode(e,{inputOffset:i,encodedMaskData:s,maskData:l,returnMask:0===d,returnEncodedMask:0===d,returnFileInfo:!0,returnPixelInterleavedDims:t.returnPixelInterleavedDims,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});i=k.fileInfo.eofOffset,l=k.maskData,0===d&&(s=k.encodedMaskData,g.width=k.width,g.height=k.height,g.dimCount=k.dimCount||1,g.pixelType=k.pixelType||k.fileInfo.pixelType,g.mask=l),n>1&&(l&&m.push(l),k.fileInfo.mask&&k.fileInfo.mask.numBytes>0&&b++),d++,g.pixels.push(k.pixelData),g.statistics.push({minValue:k.minValue,maxValue:k.maxValue,noDataValue:k.noDataValue,dimStats:k.dimStats})}if(n>1&&b>1){for(h=g.width*g.height,g.bandMasks=m,(l=new Uint8Array(h)).set(m[0]),u=1;u<m.length;u++)for(f=m[u],c=0;c<h;c++)l[c]=l[c]&f[c];g.maskData=l}return g}};Ke.exports?Ke.exports=g:this.Lerc=g}();var We=Xe.exports,qe={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Je={};for(var Qe in qe)qe.hasOwnProperty(Qe)&&(Je[qe[Qe]]=parseInt(Qe,10));Je.BitsPerSample,Je.ExtraSamples,Je.SampleFormat,Je.StripByteCounts,Je.StripOffsets,Je.StripRowCounts,Je.TileByteCounts,Je.TileOffsets,Je.SubIFDs;var $e={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},et={};for(var tt in $e)$e.hasOwnProperty(tt)&&(et[$e[tt]]=parseInt(tt,10));var rt=1,nt=0,it=1,at={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},ot={};for(var st in at)at.hasOwnProperty(st)&&(ot[at[st]]=parseInt(st,10));function ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}var lt=function(e){p(r,b);var t=ft(r);function r(e){var n;return u(this,r),(n=t.call(this)).planarConfiguration=void 0!==e.PlanarConfiguration?e.PlanarConfiguration:1,n.samplesPerPixel=void 0!==e.SamplesPerPixel?e.SamplesPerPixel:1,n.addCompression=e.LercParameters[rt],n}return h(r,[{key:"decodeBlock",value:function(e){switch(this.addCompression){case nt:break;case it:e=Fe(new Uint8Array(e)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return We.decode(e,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}]),r}(),ut=Object.freeze({__proto__:null,default:lt});function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}var ht=function(e){p(a,b);var r,n=ct(a);function a(){var e;if(u(this,a),e=n.call(this),"undefined"==typeof createImageBitmap)throw new Error("Cannot decode WebImage as `createImageBitmap` is not available");if("undefined"==typeof document&&"undefined"==typeof OffscreenCanvas)throw new Error("Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available");return e}return h(a,[{key:"decode",value:(r=t(i.mark((function e(t,r){var n,a,o,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Blob([r]),e.next=3,createImageBitmap(n);case 3:return a=e.sent,"undefined"!=typeof document?((o=document.createElement("canvas")).width=a.width,o.height=a.height):o=new OffscreenCanvas(a.width,a.height),(s=o.getContext("2d")).drawImage(a,0,0),e.abrupt("return",s.getImageData(0,0,a.width,a.height).data.buffer);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})}]),a}(),dt=Object.freeze({__proto__:null,default:ht});';return new t.default("undefined"==typeof Blob?"data:application/javascript;base64,"+r.from(e,"binary").toString("base64"):URL.createObjectURL(new Blob([e],{type:"application/javascript"})))}}.call(this)}.call(this,n("buffer").Buffer)},{buffer:6,"web-worker":423}],43:[function(e,t,r){"use strict";var n=e("./lib/deflate"),i=n.Deflate,o=n.deflate,a=n.deflateRaw,n=n.gzip,s=e("./lib/inflate"),u=s.Inflate,l=s.inflate,c=s.inflateRaw,s=s.ungzip,e=e("./lib/zlib/constants");t.exports.Deflate=i,t.exports.deflate=o,t.exports.deflateRaw=a,t.exports.gzip=n,t.exports.Inflate=u,t.exports.inflate=l,t.exports.inflateRaw=c,t.exports.ungzip=s,t.exports.constants=e},{"./lib/deflate":44,"./lib/inflate":45,"./lib/zlib/constants":49}],44:[function(e,t,r){"use strict";var a=e("./zlib/deflate"),n=e("./utils/common"),s=e("./utils/strings"),i=e("./zlib/messages"),o=e("./zlib/zstream"),u=Object.prototype.toString,l=e("./zlib/constants"),c=l.Z_NO_FLUSH,f=l.Z_SYNC_FLUSH,h=l.Z_FULL_FLUSH,p=l.Z_FINISH,d=l.Z_OK,y=l.Z_STREAM_END,g=l.Z_DEFAULT_COMPRESSION,m=l.Z_DEFAULT_STRATEGY,v=l.Z_DEFLATED;function b(e){this.options=n.assign({level:g,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:m},e||{});e=this.options;if(e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0,(t=a.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy))!==d)throw new Error(i[t]);if(e.header&&a.deflateSetHeader(this.strm,e.header),e.dictionary){var t,e="string"==typeof e.dictionary?s.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary;if((t=a.deflateSetDictionary(this.strm,e))!==d)throw new Error(i[t]);this._dict_set=!0}}function _(e,t){t=new b(t);if(t.push(e,!0),t.err)throw t.msg||i[t.err];return t.result}b.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;for(n=t===~~t?t:!0===t?p:c,"string"==typeof e?i.input=s.string2buf(e):"[object ArrayBuffer]"===u.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(n===f||n===h)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(a.deflate(i,n)===y)return 0<i.next_out&&this.onData(i.output.subarray(0,i.next_out)),r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===d;if(0===i.avail_out)this.onData(i.output);else if(0<n&&0<i.next_out)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}return!0},b.prototype.onData=function(e){this.chunks.push(e)},b.prototype.onEnd=function(e){e===d&&(this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.exports.Deflate=b,t.exports.deflate=_,t.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,_(e,t)},t.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,_(e,t)},t.exports.constants=e("./zlib/constants")},{"./utils/common":46,"./utils/strings":47,"./zlib/constants":49,"./zlib/deflate":51,"./zlib/messages":56,"./zlib/zstream":58}],45:[function(e,t,r){"use strict";var f=e("./zlib/inflate"),n=e("./utils/common"),h=e("./utils/strings"),i=e("./zlib/messages"),o=e("./zlib/zstream"),a=e("./zlib/gzheader"),p=Object.prototype.toString,s=e("./zlib/constants"),d=s.Z_NO_FLUSH,y=s.Z_FINISH,g=s.Z_OK,m=s.Z_STREAM_END,v=s.Z_NEED_DICT,b=s.Z_STREAM_ERROR,_=s.Z_DATA_ERROR,w=s.Z_MEM_ERROR;function u(e){this.options=n.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options,e=(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits)&&(t.windowBits=-15),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0,f.inflateInit2(this.strm,t.windowBits));if(e!==g)throw new Error(i[e]);if(this.header=new a,f.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=h.string2buf(t.dictionary):"[object ArrayBuffer]"===p.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw)&&(e=f.inflateSetDictionary(this.strm,t.dictionary))!==g)throw new Error(i[e])}function l(e,t){t=new u(t);if(t.push(e),t.err)throw t.msg||i[t.err];return t.result}u.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize,a=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?y:d,"[object ArrayBuffer]"===p.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(r=f.inflate(i,n))===v&&a&&((r=f.inflateSetDictionary(i,a))===g?r=f.inflate(i,n):r===_&&(r=v));0<i.avail_in&&r===m&&0<i.state.wrap&&0!==e[i.next_in];)f.inflateReset(i),r=f.inflate(i,n);switch(r){case b:case _:case v:case w:return this.onEnd(r),!(this.ended=!0)}var s,u,l,c=i.avail_out;if(!i.next_out||0!==i.avail_out&&r!==m||("string"===this.options.to?(s=h.utf8border(i.output,i.next_out),u=i.next_out-s,l=h.buf2string(i.output,s),i.next_out=u,i.avail_out=o-u,u&&i.output.set(i.output.subarray(s,s+u),0),this.onData(l)):this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out))),r!==g||0!==c){if(r===m)return r=f.inflateEnd(this.strm),this.onEnd(r),this.ended=!0;if(0===i.avail_in)break}}return!0},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===g&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.exports.Inflate=u,t.exports.inflate=l,t.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,l(e,t)},t.exports.ungzip=l,t.exports.constants=e("./zlib/constants")},{"./utils/common":46,"./utils/strings":47,"./zlib/constants":49,"./zlib/gzheader":52,"./zlib/inflate":54,"./zlib/messages":56,"./zlib/zstream":58}],46:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.exports.assign=function(e){for(var t,r,n=Array.prototype.slice.call(arguments,1);n.length;){var i=n.shift();if(i){if("object"!==a(i))throw new TypeError(i+"must be non-object");for(var o in i)t=i,r=o,Object.prototype.hasOwnProperty.call(t,r)&&(e[o]=i[o])}}return e},t.exports.flattenChunks=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var i=new Uint8Array(t),o=0,a=0,s=e.length;o<s;o++){var u=e[o];i.set(u,a),a+=u.length}return i}},{}],47:[function(e,t,r){"use strict";var h=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){h=!1}for(var p=new Uint8Array(256),n=0;n<256;n++)p[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;p[254]=p[254]=1,t.exports.string2buf=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);for(var t,r,n,i,o=e.length,a=0,s=0;s<o;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),s=i=0;i<a;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t};t.exports.buf2string=function(e,t){var r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));for(var n=new Array(2*r),i=0,o=0;o<r;){var a=e[o++];if(a<128)n[i++]=a;else{var s=p[a];if(4<s)n[i++]=65533,o+=s-1;else{for(a&=2===s?31:3===s?15:7;1<s&&o<r;)a=a<<6|63&e[o++],s--;1<s?n[i++]=65533:a<65536?n[i++]=a:(a-=65536,n[i++]=55296|a>>10&1023,n[i++]=56320|1023&a)}}}var u=n,l=i;if(l<65534&&u.subarray&&h)return String.fromCharCode.apply(null,u.length===l?u:u.subarray(0,l));for(var c="",f=0;f<l;f++)c+=String.fromCharCode(u[f]);return c},t.exports.utf8border=function(e,t){for(var r=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=r&&128==(192&e[r]);)r--;return!(r<0)&&0!==r&&r+p[e[r]]>t?r:t}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;o=o+(i=i+t[n++]|0)|0,--a;);i%=65521,o%=65521}return i|o<<16|0}},{}],49:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],50:[function(e,t,r){"use strict";var s=new Uint32Array(function(){for(var e=[],t=0;t<256;t++){for(var r=t,n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;e[t]=r}return e}());t.exports=function(e,t,r,n){var i=s,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}},{}],51:[function(e,t,a){"use strict";function G(e){return 2*e-(4<e?9:0)}function f(e,t){e.pending_buf[e.pending++]=t}function h(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function s(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-O?e.strstart-(e.w_size-O):0,l=e.window,c=e.w_mask,f=e.prev,h=e.strstart+j,p=l[o+a-1],d=l[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(r=t)+a]===d&&l[r+a-1]===p&&l[r]===l[o]&&l[++r]===l[o+1]){for(o+=2,r++;l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<h;);if(n=j-(h-o),o=h-j,a<n){if(e.match_start=t,s<=(a=n))break;p=l[o+a-1],d=l[o+a]}}}while((t=f[t&c])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead}function U(e,t){for(var r,n,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;r=65535,i=e.bi_valid+42>>3,!(e.strm.avail_out<i||(r=(i=e.strm.avail_out-i)<(r=r>(n=e.strstart-e.block_start)+e.strm.avail_in?n+e.strm.avail_in:r)?i:r)<o&&(0===r&&t!==m||t===g||r!==n+e.strm.avail_in)||(a=t===m&&r===n+e.strm.avail_in?1:0,p(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,L(e.strm),n&&(r<n&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(de(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r),0!==a)););return(s-=e.strm.avail_in)&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart)&&(e.insert=e.strstart),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?M:t!==g&&t!==m&&0===e.strm.avail_in&&e.strstart===e.block_start?C:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart)&&(e.insert=e.strstart),(i=i>e.strm.avail_in?e.strm.avail_in:i)&&(de(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,((o=(i=65535<e.pending_buf_size-i?65535:e.pending_buf_size-i)>e.w_size?e.w_size:i)<=(n=e.strstart-e.block_start)||(n||t===m)&&t!==g&&0===e.strm.avail_in&&n<=i)&&(r=i<n?i:n,a=t===m&&0===e.strm.avail_in&&r===n?1:0,p(e,e.block_start,r,a),e.block_start+=r,L(e.strm)),a?R:T)}function r(e,t){for(var r,n;;){if(e.lookahead<O){if(F(e),e.lookahead<O&&t===g)return T;if(0===e.lookahead)break}if(r=0,e.lookahead>=S&&(e.ins_h=c(e,e.ins_h,e.window[e.strstart+S-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-O&&(e.match_length=s(e,r)),e.match_length>=S)if(n=d(e,e.strstart-e.match_start,e.match_length-S),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=S){for(e.match_length--;e.strstart++,e.ins_h=c(e,e.ins_h,e.window[e.strstart+S-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=c(e,e.ins_h,e.window[e.strstart+1]);else n=d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(D(e,!1),0===e.strm.avail_out))return T}return e.insert=e.strstart<S-1?e.strstart:S-1,t===m?(D(e,!0),0===e.strm.avail_out?R:M):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?T:C}function n(e,t){for(var r,n,i;;){if(e.lookahead<O){if(F(e),e.lookahead<O&&t===g)return T;if(0===e.lookahead)break}if(r=0,e.lookahead>=S&&(e.ins_h=c(e,e.ins_h,e.window[e.strstart+S-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=S-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-O&&(e.match_length=s(e,r),e.match_length<=5)&&(e.strategy===$||e.match_length===S&&4096<e.strstart-e.match_start)&&(e.match_length=S-1),e.prev_length>=S&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-S,n=d(e,e.strstart-1-e.prev_match,e.prev_length-S),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=c(e,e.ins_h,e.window[e.strstart+S-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=S-1,e.strstart++,n&&(D(e,!1),0===e.strm.avail_out))return T}else if(e.match_available){if((n=d(e,0,e.window[e.strstart-1]))&&D(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return T}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=d(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<S-1?e.strstart:S-1,t===m?(D(e,!0),0===e.strm.avail_out?R:M):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?T:C}var i=e("./trees"),u=i._tr_init,p=i._tr_stored_block,l=i._tr_flush_block,d=i._tr_tally,z=i._tr_align,W=e("./adler32"),y=e("./crc32"),V=e("./messages"),i=e("./constants"),g=i.Z_NO_FLUSH,H=i.Z_PARTIAL_FLUSH,q=i.Z_FULL_FLUSH,m=i.Z_FINISH,Y=i.Z_BLOCK,v=i.Z_OK,X=i.Z_STREAM_END,b=i.Z_STREAM_ERROR,Z=i.Z_DATA_ERROR,_=i.Z_BUF_ERROR,K=i.Z_DEFAULT_COMPRESSION,$=i.Z_FILTERED,w=i.Z_HUFFMAN_ONLY,J=i.Z_RLE,Q=i.Z_FIXED,ee=i.Z_DEFAULT_STRATEGY,te=i.Z_UNKNOWN,x=i.Z_DEFLATED,re=9,ne=286,ie=30,oe=19,ae=2*ne+1,se=15,S=3,j=258,O=j+S+1,P=42,ue=57,le=69,ce=73,fe=91,he=103,k=113,E=666,T=1,C=2,R=3,M=4,I=function(e,t){return e.msg=V[t],t},A=function(e){for(var t=e.length;0<=--t;)e[t]=0},pe=function(e){for(var t,r=e.w_size,n=e.hash_size,i=n;t=e.head[--i],e.head[i]=r<=t?t-r:0,--n;);for(i=n=r;t=e.prev[--i],e.prev[i]=r<=t?t-r:0,--n;);},c=function(e,t,r){return(t<<e.hash_shift^r)&e.hash_mask},L=function(e){var t=e.state,r=t.pending;0!==(r=r>e.avail_out?e.avail_out:r)&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending)&&(t.pending_out=0)},D=function(e,t){l(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,L(e.strm)},de=function(e,t,r,n){var i=e.avail_in;return 0===(i=n<i?n:i)?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=W(e.adler,t,i,r):2===e.state.wrap&&(e.adler=y(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},F=function(e){var t,r,n=e.w_size;do{if(t=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-O)&&(e.window.set(e.window.subarray(n,n+n-t),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),pe(e),t+=n),0===e.strm.avail_in)break;if(t=de(e.strm,e.window,e.strstart+e.lookahead,t),e.lookahead+=t,e.lookahead+e.insert>=S)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=c(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=c(e,e.ins_h,e.window[r+S-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<S)););}while(e.lookahead<O&&0!==e.strm.avail_in)};function o(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}var N=[new o(0,0,0,0,U),new o(4,4,8,4,r),new o(4,5,16,8,r),new o(4,6,32,32,r),new o(4,4,16,16,n),new o(8,16,32,32,n),new o(8,16,128,128,n),new o(8,32,128,256,n),new o(32,128,258,1024,n),new o(32,258,258,4096,n)];function ye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*ae),this.dyn_dtree=new Uint16Array(2*(2*ie+1)),this.bl_tree=new Uint16Array(2*(2*oe+1)),A(this.dyn_ltree),A(this.dyn_dtree),A(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(se+1),this.heap=new Uint16Array(2*ne+1),A(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ne+1),A(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ge(e){if(B(e))return I(e,b);e.total_in=e.total_out=0,e.data_type=te;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?ue:t.wrap?P:k,e.adler=2===t.wrap?0:1,t.last_flush=-2,u(t),v}function me(e,t,r,n,i,o){if(!e)return b;var a=1;if(t===K&&(t=6),n<0?(a=0,n=-n):15<n&&(a=2,n-=16),i<1||re<i||r!==x||n<8||15<n||t<0||9<t||o<0||Q<o||8===n&&1!==a)return I(e,b);8===n&&(n=9);var s=new ye;return(e.state=s).strm=e,s.status=P,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+S-1)/S),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=o,s.method=r,ve(e)}var B=function(e){var t;return!e||!(t=e.state)||t.strm!==e||t.status!==P&&t.status!==ue&&t.status!==le&&t.status!==ce&&t.status!==fe&&t.status!==he&&t.status!==k&&t.status!==E?1:0},ve=function(e){var t=ge(e);return t===v&&((e=e.state).window_size=2*e.w_size,A(e.head),e.max_lazy_match=N[e.level].max_lazy,e.good_match=N[e.level].good_length,e.nice_match=N[e.level].nice_length,e.max_chain_length=N[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=S-1,e.match_available=0,e.ins_h=0),t};t.exports.deflateInit=function(e,t){return me(e,t,x,15,8,ee)},t.exports.deflateInit2=me,t.exports.deflateReset=ve,t.exports.deflateResetKeep=ge,t.exports.deflateSetHeader=function(e,t){return B(e)||2!==e.state.wrap?b:(e.state.gzhead=t,v)},t.exports.deflate=function(e,t){if(B(e)||Y<t||t<0)return e?I(e,b):b;var r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===E&&t!==m)return I(e,0===e.avail_out?_:b);var n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(L(e),0===e.avail_out)return r.last_flush=-1,v}else if(0===e.avail_in&&G(t)<=G(n)&&t!==m)return I(e,_);if(r.status===E&&0!==e.avail_in)return I(e,_);if(r.status===P&&0===r.wrap&&(r.status=k),r.status===P){n=x+(r.w_bits-8<<4)<<8;if(n|=(r.strategy>=w||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(n|=32),h(r,n+=31-n%31),0!==r.strstart&&(h(r,e.adler>>>16),h(r,65535&e.adler)),e.adler=1,r.status=k,L(e),0!==r.pending)return r.last_flush=-1,v}if(r.status===ue)if(e.adler=0,f(r,31),f(r,139),f(r,8),r.gzhead)f(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),f(r,255&r.gzhead.time),f(r,r.gzhead.time>>8&255),f(r,r.gzhead.time>>16&255),f(r,r.gzhead.time>>24&255),f(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),f(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(f(r,255&r.gzhead.extra.length),f(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=y(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=le;else if(f(r,0),f(r,0),f(r,0),f(r,0),f(r,0),f(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),f(r,3),r.status=k,L(e),0!==r.pending)return r.last_flush=-1,v;if(r.status===le){if(r.gzhead.extra){for(var i=r.pending,o=(65535&r.gzhead.extra.length)-r.gzindex;r.pending+o>r.pending_buf_size;){var a=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>i&&(e.adler=y(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex+=a,L(e),0!==r.pending)return r.last_flush=-1,v;i=0,o-=a}n=new Uint8Array(r.gzhead.extra);r.pending_buf.set(n.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending+=o,r.gzhead.hcrc&&r.pending>i&&(e.adler=y(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=ce}if(r.status===ce){if(r.gzhead.name){var s,u=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>u&&(e.adler=y(e.adler,r.pending_buf,r.pending-u,u)),L(e),0!==r.pending)return r.last_flush=-1,v;u=0}}while(s=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,f(r,s),0!==s);r.gzhead.hcrc&&r.pending>u&&(e.adler=y(e.adler,r.pending_buf,r.pending-u,u)),r.gzindex=0}r.status=fe}if(r.status===fe){if(r.gzhead.comment){var l,c=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>c&&(e.adler=y(e.adler,r.pending_buf,r.pending-c,c)),L(e),0!==r.pending)return r.last_flush=-1,v;c=0}}while(l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,f(r,l),0!==l);r.gzhead.hcrc&&r.pending>c&&(e.adler=y(e.adler,r.pending_buf,r.pending-c,c))}r.status=he}if(r.status===he){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(L(e),0!==r.pending))return r.last_flush=-1,v;f(r,255&e.adler),f(r,e.adler>>8&255),e.adler=0}if(r.status=k,L(e),0!==r.pending)return r.last_flush=-1,v}if(0!==e.avail_in||0!==r.lookahead||t!==g&&r.status!==E){n=0===r.level?U(r,t):r.strategy===w?function(e,t){for(var r;;){if(0===e.lookahead&&(F(e),0===e.lookahead)){if(t===g)return T;break}if(e.match_length=0,r=d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(D(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===m?(D(e,!0),0===e.strm.avail_out?R:M):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?T:C}(r,t):r.strategy===J?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=j){if(F(e),e.lookahead<=j&&t===g)return T;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=S&&0<e.strstart&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){for(o=e.strstart+j;n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o;);e.match_length=j-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=S?(r=d(e,1,e.match_length-S),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(D(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===m?(D(e,!0),0===e.strm.avail_out?R:M):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?T:C}(r,t):N[r.level].func(r,t);if(n!==R&&n!==M||(r.status=E),n===T||n===R)return 0===e.avail_out&&(r.last_flush=-1),v;if(n===C&&(t===H?z(r):t!==Y&&(p(r,0,0,!1),t===q)&&(A(r.head),0===r.lookahead)&&(r.strstart=0,r.block_start=0,r.insert=0),L(e),0===e.avail_out))return r.last_flush=-1,v}return t!==m||!(r.wrap<=0)&&(2===r.wrap?(f(r,255&e.adler),f(r,e.adler>>8&255),f(r,e.adler>>16&255),f(r,e.adler>>24&255),f(r,255&e.total_in),f(r,e.total_in>>8&255),f(r,e.total_in>>16&255),f(r,e.total_in>>24&255)):(h(r,e.adler>>>16),h(r,65535&e.adler)),L(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending)?v:X},t.exports.deflateEnd=function(e){var t;return B(e)?b:(t=e.state.status,e.state=null,t===k?I(e,Z):v)},t.exports.deflateSetDictionary=function(e,t){var r=t.length;if(B(e))return b;var n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==P||n.lookahead)return b;1===i&&(e.adler=W(e.adler,t,r,0)),n.wrap=0,r>=n.w_size&&(0===i&&(A(n.head),n.strstart=0,n.block_start=0,n.insert=0),(o=new Uint8Array(n.w_size)).set(t.subarray(r-n.w_size,r),0),t=o,r=n.w_size);var o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,F(n);n.lookahead>=S;){for(var u=n.strstart,l=n.lookahead-(S-1);n.ins_h=c(n,n.ins_h,n.window[u+S-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++,--l;);n.strstart=u,n.lookahead=S-1,F(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=S-1,n.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,n.wrap=i,v},t.exports.deflateInfo="pako deflate (from Nodeca project)"},{"./adler32":48,"./constants":49,"./crc32":50,"./messages":56,"./trees":57}],52:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],53:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,i,o,a,s,u=e.state,l=e.next_in,c=e.input,f=l+(e.avail_in-5),h=e.next_out,p=e.output,d=h-(t-e.avail_out),y=h+(e.avail_out-257),g=u.dmax,m=u.wsize,v=u.whave,b=u.wnext,_=u.window,w=u.hold,x=u.bits,S=u.lencode,j=u.distcode,O=(1<<u.lenbits)-1,P=(1<<u.distbits)-1;e:do{for(x<15&&(w+=c[l++]<<x,x+=8,w+=c[l++]<<x,x+=8),r=S[w&O];;){if(w>>>=n=r>>>24,x-=n,0===(n=r>>>16&255))p[h++]=65535&r;else{if(!(16&n)){if(0==(64&n)){r=S[(65535&r)+(w&(1<<n)-1)];continue}if(32&n){u.mode=16191;break e}e.msg="invalid literal/length code",u.mode=16209;break e}for(i=65535&r,(n&=15)&&(x<n&&(w+=c[l++]<<x,x+=8),i+=w&(1<<n)-1,w>>>=n,x-=n),x<15&&(w+=c[l++]<<x,x+=8,w+=c[l++]<<x,x+=8),r=j[w&P];;){if(w>>>=n=r>>>24,x-=n,!(16&(n=r>>>16&255))){if(0==(64&n)){r=j[(65535&r)+(w&(1<<n)-1)];continue}e.msg="invalid distance code",u.mode=16209;break e}if(o=65535&r,x<(n&=15)&&(w+=c[l++]<<x,(x+=8)<n)&&(w+=c[l++]<<x,x+=8),g<(o+=w&(1<<n)-1)){e.msg="invalid distance too far back",u.mode=16209;break e}if(w>>>=n,x-=n,(n=h-d)<o){if(v<(n=o-n)&&u.sane){e.msg="invalid distance too far back",u.mode=16209;break e}if(s=_,(a=0)===b){if(a+=m-n,n<i){for(i-=n;p[h++]=_[a++],--n;);a=h-o,s=p}}else if(b<n){if(a+=m+b-n,(n-=b)<i){for(i-=n;p[h++]=_[a++],--n;);if(a=0,b<i){for(i-=n=b;p[h++]=_[a++],--n;);a=h-o,s=p}}}else if(a+=b-n,n<i){for(i-=n;p[h++]=_[a++],--n;);a=h-o,s=p}for(;2<i;)p[h++]=s[a++],p[h++]=s[a++],p[h++]=s[a++],i-=3;i&&(p[h++]=s[a++],1<i)&&(p[h++]=s[a++])}else{for(a=h-o;p[h++]=p[a++],p[h++]=p[a++],p[h++]=p[a++],2<(i-=3););i&&(p[h++]=p[a++],1<i)&&(p[h++]=p[a++])}break}}break}}while(l<f&&h<y);w&=(1<<(x-=(i=x>>3)<<3))-1,e.next_in=l-=i,e.next_out=h,e.avail_in=l<f?f-l+5:5-(l-f),e.avail_out=h<y?y-h+257:257-(h-y),u.hold=w,u.bits=x}},{}],54:[function(e,t,c){"use strict";function R(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}var M=e("./adler32"),I=e("./crc32"),A=e("./inffast"),L=e("./inftrees"),D=1,F=2,e=e("./constants"),N=e.Z_FINISH,B=e.Z_BLOCK,G=e.Z_TREES,U=e.Z_OK,z=e.Z_STREAM_END,W=e.Z_NEED_DICT,V=e.Z_STREAM_ERROR,H=e.Z_DATA_ERROR,q=e.Z_MEM_ERROR,Y=e.Z_BUF_ERROR,X=e.Z_DEFLATED,Z=16180,K=16191,$=16209,r=16211,n=852,i=592;function o(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(e){var t;return te(e)?V:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Z,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(n),t.distcode=t.distdyn=new Int32Array(i),t.sane=1,t.back=-1,U)}function s(e){var t;return te(e)?V:((t=e.state).wsize=0,t.whave=0,t.wnext=0,a(e))}function u(e,t){var r;return e?(r=new o,(e.state=r).strm=e,r.window=null,r.mode=Z,(r=l(e,t))!==U&&(e.state=null),r):V}function J(e,t,r,n){var i;return null===(e=e.state).window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new Uint8Array(e.wsize)),n>=e.wsize?(e.window.set(t.subarray(r-e.wsize,r),0),e.wnext=0,e.whave=e.wsize):(n<(i=e.wsize-e.wnext)&&(i=n),e.window.set(t.subarray(r-n,r-n+i),e.wnext),(n-=i)?(e.window.set(t.subarray(r-n,r),0),e.wnext=n,e.whave=e.wsize):(e.wnext+=i,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=i))),0}var Q,ee,te=function(e){var t;return!e||!(t=e.state)||t.strm!==e||t.mode<Z||t.mode>r?1:0},l=function(e,t){var r,n;return te(e)||(n=e.state,t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t))?V:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,s(e))},re=!0;t.exports.inflateReset=s,t.exports.inflateReset2=l,t.exports.inflateResetKeep=a,t.exports.inflateInit=function(e){return u(e,15)},t.exports.inflateInit2=u,t.exports.inflate=function(e,t){var r,n,i,o,a,s,u,l,c,f,h,p,d,y,g,m,v,b,_,w,x,S,j,O,P=0,k=new Uint8Array(4),E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(te(e)||!e.output||!e.input&&0!==e.avail_in)return V;(r=e.state).mode===K&&(r.mode=16192),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,l=r.hold,c=r.bits,f=s,h=u,S=U;e:for(;;)switch(r.mode){case Z:if(0===r.wrap)r.mode=16192;else{for(;c<16;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}2&r.wrap&&35615===l?(0===r.wbits&&(r.wbits=15),k[r.check=0]=255&l,k[1]=l>>>8&255,r.check=I(r.check,k,2,0),c=l=0,r.mode=16181):(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31?(e.msg="incorrect header check",r.mode=$):(15&l)!==X?(e.msg="unknown compression method",r.mode=$):(c-=4,x=8+(15&(l>>>=4)),0===r.wbits&&(r.wbits=x),15<x||x>r.wbits?(e.msg="invalid window size",r.mode=$):(r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&l?16189:K,c=l=0)))}break;case 16181:for(;c<16;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(r.flags=l,(255&r.flags)!==X){e.msg="unknown compression method",r.mode=$;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=$;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&4&r.wrap&&(k[0]=255&l,k[1]=l>>>8&255,r.check=I(r.check,k,2,0)),c=l=0,r.mode=16182;case 16182:for(;c<32;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}r.head&&(r.head.time=l),512&r.flags&&4&r.wrap&&(k[0]=255&l,k[1]=l>>>8&255,k[2]=l>>>16&255,k[3]=l>>>24&255,r.check=I(r.check,k,4,0)),c=l=0,r.mode=16183;case 16183:for(;c<16;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&4&r.wrap&&(k[0]=255&l,k[1]=l>>>8&255,r.check=I(r.check,k,2,0)),c=l=0,r.mode=16184;case 16184:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&4&r.wrap&&(k[0]=255&l,k[1]=l>>>8&255,r.check=I(r.check,k,2,0)),c=l=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&((p=s<(p=r.length)?s:p)&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+p),x)),512&r.flags&&4&r.wrap&&(r.check=I(r.check,n,p,o)),s-=p,o+=p,r.length-=p),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break e;for(p=0;x=n[o+p++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x)),x&&p<s;);if(512&r.flags&&4&r.wrap&&(r.check=I(r.check,n,p,o)),s-=p,o+=p,x)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break e;for(p=0;x=n[o+p++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x)),x&&p<s;);if(512&r.flags&&4&r.wrap&&(r.check=I(r.check,n,p,o)),s-=p,o+=p,x)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(4&r.wrap&&l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=$;break}c=l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=K;break;case 16189:for(;c<32;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}e.adler=r.check=R(l),c=l=0,r.mode=16190;case 16190:if(0===r.havedict)return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,r.hold=l,r.bits=c,W;e.adler=r.check=1,r.mode=K;case K:if(t===B||t===G)break e;case 16192:if(r.last)l>>>=7&c,c-=7&c,r.mode=16206;else{for(;c<3;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}switch(r.last=1&l,--c,3&(l>>>=1)){case 0:r.mode=16193;break;case 1:C=void 0;var T=r;if(re){Q=new Int32Array(512),ee=new Int32Array(32);for(var C=0;C<144;)T.lens[C++]=8;for(;C<256;)T.lens[C++]=9;for(;C<280;)T.lens[C++]=7;for(;C<288;)T.lens[C++]=8;for(L(D,T.lens,0,288,Q,0,T.work,{bits:9}),C=0;C<32;)T.lens[C++]=5;L(F,T.lens,0,32,ee,0,T.work,{bits:5}),re=!1}if(T.lencode=Q,T.lenbits=9,T.distcode=ee,T.distbits=5,r.mode=16199,t!==G)break;l>>>=2,c-=2;break e;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=$}l>>>=2,c-=2}break;case 16193:for(l>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=$;break}if(r.length=65535&l,c=l=0,r.mode=16194,t===G)break e;case 16194:r.mode=16195;case 16195:if(p=r.length){if(0===(p=u<(p=s<p?s:p)?u:p))break e;i.set(n.subarray(o,o+p),a),s-=p,o+=p,u-=p,a+=p,r.length-=p}else r.mode=K;break;case 16196:for(;c<14;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(r.nlen=257+(31&l),l>>>=5,c-=5,r.ndist=1+(31&l),l>>>=5,c-=5,r.ncode=4+(15&l),l>>>=4,c-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=$;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}r.lens[E[r.have++]]=7&l,l>>>=3,c-=3}for(;r.have<19;)r.lens[E[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,j={bits:r.lenbits},S=L(0,r.lens,0,19,r.lencode,0,r.work,j),r.lenbits=j.bits,S){e.msg="invalid code lengths set",r.mode=$;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;m=(P=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,v=65535&P,!((g=P>>>24)<=c);){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(v<16)l>>>=g,c-=g,r.lens[r.have++]=v;else{if(16===v){for(O=g+2;c<O;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(l>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=$;break}x=r.lens[r.have-1],p=3+(3&l),l>>>=2,c-=2}else if(17===v){for(O=g+3;c<O;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}x=0,p=3+(7&(l>>>=g)),l>>>=3,c=c-g-3}else{for(O=g+7;c<O;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}x=0,p=11+(127&(l>>>=g)),l>>>=7,c=c-g-7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=$;break}for(;p--;)r.lens[r.have++]=x}}if(r.mode===$)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=$;break}if(r.lenbits=9,j={bits:r.lenbits},S=L(D,r.lens,0,r.nlen,r.lencode,0,r.work,j),r.lenbits=j.bits,S){e.msg="invalid literal/lengths set",r.mode=$;break}if(r.distbits=6,r.distcode=r.distdyn,j={bits:r.distbits},S=L(F,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,j),r.distbits=j.bits,S){e.msg="invalid distances set",r.mode=$;break}if(r.mode=16199,t===G)break e;case 16199:r.mode=16200;case 16200:if(6<=s&&258<=u){e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,r.hold=l,r.bits=c,A(e,h),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,l=r.hold,c=r.bits,r.mode===K&&(r.back=-1);break}for(r.back=0;m=(P=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,v=65535&P,!((g=P>>>24)<=c);){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(m&&0==(240&m)){for(b=g,_=m,w=v;m=(P=r.lencode[w+((l&(1<<b+_)-1)>>b)])>>>16&255,v=65535&P,!(b+(g=P>>>24)<=c);){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}l>>>=b,c-=b,r.back+=b}if(l>>>=g,c-=g,r.back+=g,r.length=v,0===m){r.mode=16205;break}if(32&m){r.back=-1,r.mode=K;break}if(64&m){e.msg="invalid literal/length code",r.mode=$;break}r.extra=15&m,r.mode=16201;case 16201:if(r.extra){for(O=r.extra;c<O;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;m=(P=r.distcode[l&(1<<r.distbits)-1])>>>16&255,v=65535&P,!((g=P>>>24)<=c);){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(0==(240&m)){for(b=g,_=m,w=v;m=(P=r.distcode[w+((l&(1<<b+_)-1)>>b)])>>>16&255,v=65535&P,!(b+(g=P>>>24)<=c);){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}l>>>=b,c-=b,r.back+=b}if(l>>>=g,c-=g,r.back+=g,64&m){e.msg="invalid distance code",r.mode=$;break}r.offset=v,r.extra=15&m,r.mode=16203;case 16203:if(r.extra){for(O=r.extra;c<O;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=$;break}r.mode=16204;case 16204:if(0===u)break e;if(r.offset>(p=h-u)){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=$;break}d=p>r.wnext?(p-=r.wnext,r.wsize-p):r.wnext-p,p>r.length&&(p=r.length),y=r.window}else y=i,d=a-r.offset,p=r.length;for(u-=p=u<p?u:p,r.length-=p;i[a++]=y[d++],--p;);0===r.length&&(r.mode=16200);break;case 16205:if(0===u)break e;i[a++]=r.length,u--,r.mode=16200;break;case 16206:if(r.wrap){for(;c<32;){if(0===s)break e;s--,l|=n[o++]<<c,c+=8}if(h-=u,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=(r.flags?I:M)(r.check,i,h,a-h)),h=u,4&r.wrap&&(r.flags?l:R(l))!==r.check){e.msg="incorrect data check",r.mode=$;break}c=l=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,l+=n[o++]<<c,c+=8}if(4&r.wrap&&l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=$;break}c=l=0}r.mode=16208;case 16208:S=z;break e;case $:S=H;break e;case 16210:return q;default:return V}return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,r.hold=l,r.bits=c,(r.wsize||h!==e.avail_out&&r.mode<$&&(r.mode<16206||t!==N))&&J(e,e.output,e.next_out,h-e.avail_out)?(r.mode=16210,q):(f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=(r.flags?I:M)(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===K?128:0)+(16199===r.mode||16194===r.mode?256:0),(0==f&&0===h||t===N)&&S===U?Y:S)},t.exports.inflateEnd=function(e){var t;return te(e)?V:((t=e.state).window&&(t.window=null),e.state=null,U)},t.exports.inflateGetHeader=function(e,t){return te(e)||0==(2&(e=e.state).wrap)?V:((e.head=t).done=!1,U)},t.exports.inflateSetDictionary=function(e,t){var r,n=t.length;return te(e)||0!==(r=e.state).wrap&&16190!==r.mode?V:16190===r.mode&&M(1,t,n,0)!==r.check?H:J(e,t,n,n)?(r.mode=16210,q):(r.havedict=1,U)},t.exports.inflateInfo="pako inflate (from Nodeca project)"},{"./adler32":48,"./constants":49,"./crc32":50,"./inffast":53,"./inftrees":55}],55:[function(e,t,r){"use strict";var M=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),I=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),A=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),L=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);t.exports=function(e,t,r,n,i,o,a,s){for(var u,l,c,f,h,p,d,y,g,m=s.bits,v=0,b=0,_=0,w=0,x=0,S=0,j=0,O=0,P=0,k=0,E=null,T=new Uint16Array(16),C=new Uint16Array(16),R=null,v=0;v<=15;v++)T[v]=0;for(b=0;b<n;b++)T[t[r+b]]++;for(x=m,w=15;1<=w&&0===T[w];w--);if(w<x&&(x=w),0===w)i[o++]=20971520,i[o++]=20971520,s.bits=1;else{for(_=1;_<w&&0===T[_];_++);for(x<_&&(x=_),v=O=1;v<=15;v++)if((O=(O<<=1)-T[v])<0)return-1;if(0<O&&(0===e||1!==w))return-1;for(C[1]=0,v=1;v<15;v++)C[v+1]=C[v]+T[v];for(b=0;b<n;b++)0!==t[r+b]&&(a[C[t[r+b]]++]=b);if(p=0===e?(E=R=a,20):1===e?(E=M,R=I,257):(E=A,R=L,0),v=_,h=o,j=b=k=0,c=-1,f=(P=1<<(S=x))-1,1===e&&852<P||2===e&&592<P)return 1;for(;;){for(g=a[b]+1<p?(y=0,a[b]):a[b]>=p?(y=R[a[b]-p],E[a[b]-p]):(y=96,0),u=1<<(d=v-j),_=l=1<<S;i[h+(k>>j)+(l-=u)]=d<<24|y<<16|g|0,0!==l;);for(u=1<<v-1;k&u;)u>>=1;if(k=0!==u?(k&u-1)+u:0,b++,0==--T[v]){if(v===w)break;v=t[r+a[b]]}if(x<v&&(k&f)!==c){for(h+=_,O=1<<(S=v-(j=0===j?x:j));S+j<w&&!((O-=T[S+j])<=0);)S++,O<<=1;if(P+=1<<S,1===e&&852<P||2===e&&592<P)return 1;i[c=k&f]=x<<24|S<<16|h-o|0}}0!==k&&(i[h+k]=v-j<<24|64<<16|0),s.bits=x}return 0}},{}],56:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],57:[function(r,e,a){"use strict";var c=0,f=1;function t(e){for(var t=e.length;0<=--t;)e[t]=0}var s,u,l,h=29,p=256,d=p+1+h,y=30,g=19,m=2*d+1,v=15,n=16,N=7,b=256,_=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),w=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),B=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),x=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),S=new Array(2*(d+2)),j=(t(S),new Array(2*y)),O=(t(j),new Array(512)),P=(t(O),new Array(256)),k=(t(P),new Array(h)),E=(t(k),new Array(y));function T(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function C(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(E);function R(e){for(var t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<y;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*b]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0}function M(e){8<e.bi_valid?i(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function o(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function I(e,t,r){var n,i,o,a,s=0;if(0!==e.sym_next)for(;n=255&e.pending_buf[e.sym_buf+s++],n+=(255&e.pending_buf[e.sym_buf+s++])<<8,i=e.pending_buf[e.sym_buf+s++],0==n?L(e,i,t):(o=P[i],L(e,o+p+1,t),0!==(a=_[o])&&(i-=k[o],A(e,i,a)),o=U(--n),L(e,o,r),0!==(a=w[o])&&(n-=E[o],A(e,n,a))),s<e.sym_next;);L(e,b,t)}function G(e,t,r,n){A(e,0+(n?1:0),3),M(e),i(e,r),i(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r}var U=function(e){return e<256?O[e]:O[256+(e>>>7)]},i=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},A=function(e,t,r){e.bi_valid>n-r?(e.bi_buf|=t<<e.bi_valid&65535,i(e,e.bi_buf),e.bi_buf=t>>n-e.bi_valid,e.bi_valid+=r-n):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},L=function(e,t,r){A(e,r[2*t],r[2*t+1])},z=function(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1},W=function(e,t){for(var r,n,i,o,a,s=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,c=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,d=0,y=0;y<=v;y++)e.bl_count[y]=0;for(s[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<m;r++)p<(y=s[2*s[2*(n=e.heap[r])+1]+1]+1)&&(y=p,d++),s[2*n+1]=y,u<n||(e.bl_count[y]++,o=0,h<=n&&(o=f[n-h]),a=s[2*n],e.opt_len+=a*(y+o),c&&(e.static_len+=a*(l[2*n+1]+o)));if(0!==d){do{for(y=p-1;0===e.bl_count[y];)y--}while(e.bl_count[y]--,e.bl_count[y+1]+=2,e.bl_count[p]--,0<(d-=2));for(y=p;0!==y;y--)for(n=e.bl_count[y];0!==n;)u<(i=e.heap[--r])||(s[2*i+1]!==y&&(e.opt_len+=(y-s[2*i+1])*s[2*i],s[2*i+1]=y),n--)}},V=function(e,t,r){for(var n,i=new Array(v+1),o=0,a=1;a<=v;a++)o=o+r[a-1]<<1,i[a]=o;for(n=0;n<=t;n++){var s=e[2*n+1];0!==s&&(e[2*n]=z(i[s]++,s))}},D=function(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&o(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!o(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},F=function(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=m,r=0;r<u;r++)0!==o[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=l,r=e.heap_len>>1;1<=r;r--)D(e,o,r);for(i=u;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,D(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],W(e,t),V(o,l,e.bl_count)},H=function(e,t,r){var n,i,o=-1,a=t[1],s=0,u=7,l=4;for(0===a&&(u=138,l=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<u&&i===a||(s<l?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=i,l=(s=0)===a?(u=138,3):i===a?(u=6,3):(u=7,4))},q=function(e,t,r){var n,i,o=-1,a=t[1],s=0,u=7,l=4;for(0===a&&(u=138,l=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<u&&i===a)){if(s<l)for(;L(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==o&&(L(e,i,e.bl_tree),s--),L(e,16,e.bl_tree),A(e,s-3,2)):s<=10?(L(e,17,e.bl_tree),A(e,s-3,3)):(L(e,18,e.bl_tree),A(e,s-11,7));o=i,l=(s=0)===a?(u=138,3):i===a?(u=6,3):(u=7,4)}},Y=!1;e.exports._tr_init=function(e){if(!Y){for(var t,r,n,i=new Array(v+1),o=0,a=0;a<h-1;a++)for(k[a]=o,t=0;t<1<<_[a];t++)P[o++]=a;for(P[o-1]=a,a=n=0;a<16;a++)for(E[a]=n,t=0;t<1<<w[a];t++)O[n++]=a;for(n>>=7;a<y;a++)for(E[a]=n<<7,t=0;t<1<<w[a]-7;t++)O[256+n++]=a;for(r=0;r<=v;r++)i[r]=0;for(t=0;t<=143;)S[2*t+1]=8,t++,i[8]++;for(;t<=255;)S[2*t+1]=9,t++,i[9]++;for(;t<=279;)S[2*t+1]=7,t++,i[7]++;for(;t<=287;)S[2*t+1]=8,t++,i[8]++;for(V(S,d+1,i),t=0;t<y;t++)j[2*t+1]=5,j[2*t]=z(t,5);s=new T(S,_,p+1,d,v),u=new T(j,w,0,y,v),l=new T(new Array(0),B,0,g,N),Y=!0}e.l_desc=new C(e.dyn_ltree,s),e.d_desc=new C(e.dyn_dtree,u),e.bl_desc=new C(e.bl_tree,l),e.bi_buf=0,e.bi_valid=0,R(e)},e.exports._tr_stored_block=G,e.exports._tr_flush_block=function(e,t,r,n){var i,o,a=0;if(0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){for(var t=4093624447,r=0;r<=31;r++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*r])return c;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return f;for(r=32;r<p;r++)if(0!==e.dyn_ltree[2*r])return f;return c}(e)),F(e,e.l_desc),F(e,e.d_desc),a=function(e){var t;for(H(e,e.dyn_ltree,e.l_desc.max_code),H(e,e.dyn_dtree,e.d_desc.max_code),F(e,e.bl_desc),t=g-1;3<=t&&0===e.bl_tree[2*x[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t)G(e,t,r,n);else if(4===e.strategy||o===i)A(e,2+(n?1:0),3),I(e,S,j);else{A(e,4+(n?1:0),3);var s,u=e,t=e.l_desc.max_code+1,r=e.d_desc.max_code+1,l=a+1;for(A(u,t-257,5),A(u,r-1,5),A(u,l-4,4),s=0;s<l;s++)A(u,u.bl_tree[2*x[s]+1],3);q(u,u.dyn_ltree,t-1),q(u,u.dyn_dtree,r-1),I(e,e.dyn_ltree,e.dyn_dtree)}R(e),n&&M(e)},e.exports._tr_tally=function(e,t,r){return e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(P[r]+p+1)]++,e.dyn_dtree[2*U(t)]++),e.sym_next===e.sym_end},e.exports._tr_align=function(e){A(e,2,3),L(e,b,S),16===(e=e).bi_valid?(i(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{}],58:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],59:[function(e,t,r){"use strict";var n,i=e("http"),o=e("url"),a=t.exports;for(n in i)i.hasOwnProperty(n)&&(a[n]=i[n]);function s(e){if((e="string"==typeof e?o.parse(e):e).protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}a.request=function(e,t){return e=s(e),i.request.call(this,e,t)},a.get=function(e,t){return e=s(e),i.get.call(this,e,t)}},{http:399,url:420}],60:[function(e,t,r){"use strict";r.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,f=r?i-1:0,h=r?-1:1,i=e[t+f];for(f+=h,o=i&(1<<-c)-1,i>>=-c,c+=s;0<c;o=256*o+e[t+f],f+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;0<c;a=256*a+e[t+f],f+=h,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(i?-1:1);a+=Math.pow(2,n),o-=l}return(i?-1:1)*a*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var a,s,u=8*o-i-1,l=(1<<u)-1,c=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,o=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-a))<1&&(a--,n*=2),2<=(t+=1<=a+c?f/n:f*Math.pow(2,1-c))*n&&(a++,n/=2),l<=a+c?(s=0,a=l):1<=a+c?(s=(t*n-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));8<=i;e[r+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;0<u;e[r+h]=255&a,h+=p,a/=256,u-=8);e[r+h-p]|=128*o}},{}],61:[function(e,t,r){"use strict";"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){var r;t&&(e.super_=t,(r=function(){}).prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e)}},{}],62:[function(e,n,t){"use strict";!function(){o=function(e,t,r,n,i){for(var o,a,s,u,l,c=0,f=e.pixels.numBlocksX,h=e.pixels.numBlocksY,p=Math.floor(e.width/f),d=Math.floor(e.height/h),y=2*e.maxZError,g=Number.MAX_VALUE,m=(r=r||(e.mask?e.mask.bitset:null),a=new t(e.width*e.height),i&&r&&(s=new Uint8Array(e.width*e.height)),new Float32Array(p*d)),v=0;v<=h;v++){var b=v!==h?d:e.height%h;if(0!==b)for(var _=0;_<=f;_++){var w=_!==f?p:e.width%f;if(0!==w){var x,S,j,O,P=v*e.width*d+_*p,k=e.width-w,E=e.pixels.blocks[c];if(E.encoding<2?(x=0===E.encoding?E.rawData:(T(E.stuffedData,E.bitsPerPixel,E.numValidPixels,E.offset,y,m,e.pixels.maxValue),m),S=0):j=2===E.encoding?0:E.offset,r)for(l=0;l<b;l++){for(7&P&&(O=r[P>>3],O<<=7&P),u=0;u<w;u++)128&(O=7&P?O:r[P>>3])?(s&&(s[P]=1),g=(o=E.encoding<2?x[S++]:j)<g?o:g,a[P++]=o):(s&&(s[P]=0),a[P++]=n),O<<=1;P+=k}else if(E.encoding<2)for(l=0;l<b;l++){for(u=0;u<w;u++)g=(o=x[S++])<g?o:g,a[P++]=o;P+=k}else for(g=j<g?j:g,l=0;l<b;l++){for(u=0;u<w;u++)a[P++]=j;P+=k}if(1===E.encoding&&S!==E.numValidPixels)throw"Block and Mask do not match";c++}}}return{resultPixels:a,resultMask:s,minValue:g}},a=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},s=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var i=e.pixels.blocks[n];0===i.encoding?r.float32=!0:1===i.encoding?r[i.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},u=function(e,t,r){var n={},i=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,i),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var o=new DataView(e,t,24);if(n.fileVersion=o.getInt32(0,!0),n.imageType=o.getInt32(4,!0),n.height=o.getUint32(8,!0),n.width=o.getUint32(12,!0),n.maxZError=o.getFloat64(16,!0),t+=24,!r)if(o=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=o.getUint32(0,!0),n.mask.numBlocksX=o.getUint32(4,!0),n.mask.numBytes=o.getUint32(8,!0),n.mask.maxValue=o.getFloat32(12,!0),t+=16,0<n.mask.numBytes){var a=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(o=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),u=2,l=0;do{if(0<s)for(;s--;)a[l++]=o.getUint8(u++);else for(var c=o.getUint8(u++),s=-s;s--;)a[l++]=c}while(s=o.getInt16(u,!0),(u+=2)<n.mask.numBytes);if(-32768!==s||l<a.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=a,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));o=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=o.getUint32(0,!0),n.pixels.numBlocksX=o.getUint32(4,!0),n.pixels.numBytes=o.getUint32(8,!0),n.pixels.maxValue=o.getFloat32(12,!0),t+=16;for(var i=n.pixels.numBlocksX,r=n.pixels.numBlocksY,f=i+(0<n.width%i?1:0),h=r+(0<n.height%r?1:0),p=(n.pixels.blocks=new Array(f*h),0),d=0;d<h;d++)for(var y=0;y<f;y++){var g,m=0,v=e.byteLength-t,v=(o=new DataView(e,t,Math.min(10,v)),{}),b=(n.pixels.blocks[p++]=v,o.getUint8(0));if(m++,v.encoding=63&b,3<v.encoding)throw"Invalid block encoding ("+v.encoding+")";if(2===v.encoding)t++;else{if(0!==b&&2!==b){if(b>>=6,2==(v.offsetType=b))v.offset=o.getInt8(1),m++;else if(1==b)v.offset=o.getInt16(1,!0),m+=2;else{if(0!=b)throw"Invalid block offset type";v.offset=o.getFloat32(1,!0),m+=4}if(1===v.encoding)if(b=o.getUint8(m),m++,v.bitsPerPixel=63&b,b>>=6,2==(v.numValidPixelsType=b))v.numValidPixels=o.getUint8(m),m++;else if(1==b)v.numValidPixels=o.getUint16(m,!0),m+=2;else{if(0!=b)throw"Invalid valid pixel count type";v.numValidPixels=o.getUint32(m,!0),m+=4}}if(t+=m,3!==v.encoding)if(0===v.encoding){var b=(n.pixels.numBytes-1)/4;if(b!==Math.floor(b))throw"uncompressed block has invalid length";g=new ArrayBuffer(4*b),new Uint8Array(g).set(new Uint8Array(e,t,4*b));var m=new Float32Array(g);v.rawData=m,t+=4*b}else 1===v.encoding&&(m=Math.ceil(v.numValidPixels*v.bitsPerPixel/8),b=Math.ceil(m/4),g=new ArrayBuffer(4*b),new Uint8Array(g).set(new Uint8Array(e,t,m)),v.stuffedData=new Uint32Array(g),t+=m)}}return n.eofOffset=t,n},T=function(e,t,r,n,i,o,a){var s,u,l,c,f=(1<<t)-1,h=0,p=0,d=Math.ceil((a-n)/i),y=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*y,s=0;s<r;s++)0===p&&(c=e[h++],p=32),t<=p?(l=c>>>p-t&f,p-=t):(l=(c&f)<<(u=t-p)&f,l+=(c=e[h++])>>>(p=32-u)),o[s]=l<d?n+l*i:a;return o};var i,o,a,s,u,T,_,w,x,S,j,O,z,k,e,t,v=i={defaultNoDataValue:-34027999387901484e22,decode:function(e,t){var r=(t=t||{}).encodedMaskData||null===t.encodedMaskData,e=u(e,t.inputOffset||0,r),r=null!==t.noDataValue?t.noDataValue:i.defaultNoDataValue,n=o(e,t.pixelType||Float32Array,t.encodedMaskData,r,t.returnMask),r={width:e.width,height:e.height,pixelData:n.resultPixels,minValue:n.minValue,maxValue:e.pixels.maxValue,noDataValue:r};return n.resultMask&&(r.maskData=n.resultMask),t.returnEncodedMask&&e.mask&&(r.encodedMaskData=e.mask.bitset||null),t.returnFileInfo&&(r.fileInfo=a(e),t.computeUsedBitDepths)&&(r.fileInfo.bitDepths=s(e)),r}},b=(_=function(e,t,r,n,i,o,a,s){var u,l,c,f,h,p=(1<<r)-1,d=0,y=0,g=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*g,i)for(u=0;u<n;u++)0===y&&(c=e[d++],y=32),r<=y?(l=c>>>y-r&p,y-=r):(l=(c&p)<<(f=r-y)&p,l+=(c=e[d++])>>>(y=32-f)),t[u]=i[l];else for(h=Math.ceil((s-o)/a),u=0;u<n;u++)0===y&&(c=e[d++],y=32),r<=y?(l=c>>>y-r&p,y-=r):(l=(c&p)<<(f=r-y)&p,l+=(c=e[d++])>>>(y=32-f)),t[u]=l<h?o+l*a:s},w=function(e,t,r,n,i,o){for(var a,s,u=(1<<t)-1,l=0,c=0,f=0,h=0,p=[],d=4*e.length-Math.ceil(t*r/8),y=(e[e.length-1]<<=8*d,Math.ceil((o-n)/i)),c=0;c<r;c++)0===f&&(s=e[l++],f=32),t<=f?(h=s>>>f-t&u,f-=t):(h=(s&u)<<(a=t-f)&u,h+=(s=e[l++])>>>(f=32-a)),p[c]=h<y?n+h*i:o;return p.unshift(n),p},x=function(e,t,r,n,i,o,a,s){var u,l,c,f=(1<<r)-1,h=0,p=0,d=0;if(i)for(g=0;g<n;g++)0===p&&(l=e[h++],p=32,d=0),r<=p?(u=l>>>d&f,p-=r,d+=r):(u=l>>>d&f,p=32-(c=r-p),u|=((l=e[h++])&(1<<c)-1)<<r-c,d=c),t[g]=i[u];else for(var y=Math.ceil((s-o)/a),g=0;g<n;g++)0===p&&(l=e[h++],p=32,d=0),r<=p?(u=l>>>d&f,p-=r,d+=r):(u=l>>>d&f,p=32-(c=r-p),u|=((l=e[h++])&(1<<c)-1)<<r-c,d=c),t[g]=u<y?o+u*a:s;return t},S=function(e,t,r,n,i,o){for(var a,s,u=(1<<t)-1,l=0,c=0,f=0,h=0,p=0,d=[],y=Math.ceil((o-n)/i),c=0;c<r;c++)0===f&&(s=e[l++],f=32,p=0),t<=f?(h=s>>>p&u,f-=t,p+=t):(h=s>>>p&u,f=32-(a=t-f),h|=((s=e[l++])&(1<<a)-1)<<t-a,p=a),d[c]=h<y?n+h*i:o;return d.unshift(n),d},j=function(e,t,r,n){var i,o,a,s,u=(1<<r)-1,l=0,c=0,f=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*f,i=0;i<n;i++)0===c&&(a=e[l++],c=32),r<=c?(o=a>>>c-r&u,c-=r):(o=(a&u)<<(s=r-c)&u,o+=(a=e[l++])>>>(c=32-s)),t[i]=o;return t},O=function(e,t,r,n){for(var i,o,a,s=(1<<r)-1,u=0,l=0,c=0,f=0;f<n;f++)0===l&&(o=e[u++],l=32,c=0),r<=l?(i=o>>>c&s,l-=r,c+=r):(i=o>>>c&s,l=32-(a=r-l),i|=((o=e[u++])&(1<<a)-1)<<r-a,c=a),t[f]=i;return t},z={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,i=Math.floor(n/2),o=0;i;){var a=359<=i?359:i;for(i-=a;r+=t=(t+=e[o++]<<8)+e[o++],--a;);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[o]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),i={};if(i.fileIdentifierString=String.fromCharCode.apply(null,n),0!==i.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+i.fileIdentifierString;r+=6;var n=new DataView(e,r,8),o=n.getInt32(0,!0);if(r+=4,3<=(i.fileVersion=o)&&(i.checksum=n.getUint32(4,!0),r+=4),n=new DataView(e,r,12),i.height=n.getUint32(0,!0),i.width=n.getUint32(4,!0),r+=8,4<=o?(i.numDims=n.getUint32(8,!0),r+=4):i.numDims=1,n=new DataView(e,r,40),i.numValidPixel=n.getUint32(0,!0),i.microBlockSize=n.getInt32(4,!0),i.blobSize=n.getInt32(8,!0),i.imageType=n.getInt32(12,!0),i.maxZError=n.getFloat64(16,!0),i.zMin=n.getFloat64(24,!0),i.zMax=n.getFloat64(32,!0),r+=40,t.headerInfo=i,t.ptr=r,3<=o&&this.computeChecksumFletcher32(new Uint8Array(e,r-(4<=o?52:48),i.blobSize-14))!==i.checksum)throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),i=r.numDims*this.getDataTypeSize(r.imageType),o=this.readSubArray(e,t.ptr,n,i),a=this.readSubArray(e,t.ptr+i,n,i);t.ptr+=2*i;for(var s=!0,u=0;u<r.numDims;u++)if(o[u]!==a[u]){s=!1;break}return r.minValues=o,r.maxValues=a,s},readSubArray:function(e,t,r,n){var i,e=r===Uint8Array?new Uint8Array(e,t,n):(i=new ArrayBuffer(n),new Uint8Array(i).set(new Uint8Array(e,t,n)),new r(i));return e},readMask:function(e,t){var r=t.ptr,n=t.headerInfo,i=n.width*n.height,n=n.numValidPixel,o=new DataView(e,r,4),a={};if(a.numBytes=o.getUint32(0,!0),r+=4,(0===n||i===n)&&0!==a.numBytes)throw"invalid mask";if(0===n)u=new Uint8Array(Math.ceil(i/8)),a.bitset=u,h=new Uint8Array(i),t.pixels.resultMask=h,r+=a.numBytes;else if(0<a.numBytes){var s,u=new Uint8Array(Math.ceil(i/8)),l=(o=new DataView(e,r,a.numBytes)).getInt16(0,!0),c=2,f=0;do{if(0<l)for(;l--;)u[f++]=o.getUint8(c++);else for(s=o.getUint8(c++),l=-l;l--;)u[f++]=s}while(l=o.getInt16(c,!0),(c+=2)<a.numBytes);if(-32768!==l||f<u.length)throw"Unexpected end of mask RLE encoding";for(var h=new Uint8Array(i),p=0,d=0,d=0;d<i;d++)7&d?(p=u[d>>3],p<<=7&d):p=u[d>>3],128&p&&(h[d]=1);t.pixels.resultMask=h,a.bitset=u,r+=a.numBytes}return t.ptr=r,t.mask=a,!0},readDataOneSweep:function(e,t,r,n){var i=t.ptr,o=t.headerInfo,a=o.numDims,s=o.width*o.height,u=o.imageType,o=o.numValidPixel*z.getDataTypeSize(u)*a,l=t.pixels.resultMask,c=r===Uint8Array?new Uint8Array(e,i,o):(u=new ArrayBuffer(o),new Uint8Array(u).set(new Uint8Array(e,i,o)),new r(u));if(c.length===s*a)t.pixels.resultPixels=n?z.swapDimensionOrder(c,s,a,r,!0):c;else{t.pixels.resultPixels=new r(s*a);var f=0,h=0,p=0,d=0;if(1<a){if(n){for(h=0;h<s;h++)if(l[h])for(d=h,p=0;p<a;p++,d+=s)t.pixels.resultPixels[d]=c[f++]}else for(h=0;h<s;h++)if(l[h])for(d=h*a,p=0;p<a;p++)t.pixels.resultPixels[d+p]=c[f++]}else for(h=0;h<s;h++)l[h]&&(t.pixels.resultPixels[h]=c[f++])}return t.ptr=i+=o,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var i=n.getInt32(4,!0),o=n.getInt32(8,!0),a=n.getInt32(12,!0);if(a<=o)return!1;for(var s,u,l,c=new Uint32Array(a-o),f=(z.decodeBits(e,t,c),[]),h=o;h<a;h++)f[s=h-(h<i?0:i)]={first:c[h-o],second:null};var n=e.byteLength-t.ptr,p=Math.ceil(n/4),p=new ArrayBuffer(4*p),d=(new Uint8Array(p).set(new Uint8Array(e,t.ptr,n)),new Uint32Array(p)),y=0,g=0,m=d[0];for(h=o;h<a;h++)0<(l=f[s=h-(h<i?0:i)].first)&&(f[s].second=m<<y>>>32-l,l<=32-y?32===(y+=l)&&(y=0,m=d[++g]):(m=d[++g],f[s].second|=m>>>32-(y+=l-32)));var v=0,b=0,_=new k;for(h=0;h<f.length;h++)void 0!==f[h]&&(v=Math.max(v,f[h].first));var w,x,S,j,O,b=r<=v?r:v,P=[];for(h=o;h<a;h++)if(0<(l=f[s=h-(h<i?0:i)].first))if(w=[l,s],l<=b)for(x=f[s].second<<b-l,S=1<<b-l,u=0;u<S;u++)P[x|u]=w;else for(x=f[s].second,O=_,j=l-1;0<=j;j--)O=x>>>j&1?(O.right||(O.right=new k),O.right):(O.left||(O.left=new k),O.left),0!==j||O.val||(O.val=w[1]);return{decodeLut:P,numBitsLUTQick:b,numBitsLUT:v,tree:_,stuffedData:d,srcPtr:g,bitPos:y}},readHuffman:function(e,t,r,n){var i,o,a,s,u,l,c,f,h,p,d=t.headerInfo.numDims,y=t.headerInfo.height,g=t.headerInfo.width,m=g*y,e=this.readHuffmanTree(e,t),v=e.decodeLut,b=e.tree,_=e.stuffedData,w=e.srcPtr,x=e.bitPos,S=e.numBitsLUTQick,j=e.numBitsLUT,O=0===t.headerInfo.imageType?128:0,P=t.pixels.resultMask,k=0,E=(0<x&&(w++,x=0),_[w]),T=1===t.encodeMode,C=new r(m*d),R=C;if(d<2||T){for(p=0;p<d;p++)if(1<d&&(R=new r(C.buffer,m*p,m),k=0),t.headerInfo.numValidPixel===g*y)for(l=f=0;l<y;l++)for(c=0;c<g;c++,f++){if(o=0,u=s=E<<x>>>32-S,v[u=32-x<S?s|=_[w+1]>>>64-x-S:u])o=v[u][1],x+=v[u][0];else for(u=s=E<<x>>>32-j,32-x<j&&(u=s|=_[w+1]>>>64-x-j),i=b,h=0;h<j;h++)if(!(i=s>>>j-h-1&1?i.right:i.left).left&&!i.right){o=i.val,x=x+h+1;break}32<=x&&(x-=32,E=_[++w]),a=o-O,T?(a=a+(!(0<c)&&0<l?R[f-g]:k)&255,k=R[f]=a):R[f]=a}else for(l=f=0;l<y;l++)for(c=0;c<g;c++,f++)if(P[f]){if(o=0,u=s=E<<x>>>32-S,v[u=32-x<S?s|=_[w+1]>>>64-x-S:u])o=v[u][1],x+=v[u][0];else for(u=s=E<<x>>>32-j,32-x<j&&(u=s|=_[w+1]>>>64-x-j),i=b,h=0;h<j;h++)if(!(i=s>>>j-h-1&1?i.right:i.left).left&&!i.right){o=i.val,x=x+h+1;break}32<=x&&(x-=32,E=_[++w]),a=o-O,T?(!(0<c&&P[f-1])&&0<l&&P[f-g]?a+=R[f-g]:a+=k,a&=255,k=R[f]=a):R[f]=a}}else for(l=f=0;l<y;l++)for(c=0;c<g;c++)if(f=l*g+c,!P||P[f])for(p=0;p<d;p++,f+=m){if(o=0,u=s=E<<x>>>32-S,v[u=32-x<S?s|=_[w+1]>>>64-x-S:u])o=v[u][1],x+=v[u][0];else for(u=s=E<<x>>>32-j,32-x<j&&(u=s|=_[w+1]>>>64-x-j),i=b,h=0;h<j;h++)if(!(i=s>>>j-h-1&1?i.right:i.left).left&&!i.right){o=i.val,x=x+h+1;break}32<=x&&(x-=32,E=_[++w]),R[f]=a=o-O}t.ptr=t.ptr+4*(w+1)+(0<x?4:0),t.pixels.resultPixels=C,1<d&&!n&&(t.pixels.resultPixels=z.swapDimensionOrder(C,m,d,r))},decodeBits:function(e,t,r,n,i){var o=t.headerInfo,a=o.fileVersion,s=0,u=5<=e.byteLength-t.ptr?5:e.byteLength-t.ptr,u=new DataView(e,t.ptr,u),l=u.getUint8(0),c=(s++,l>>6),c=0==c?4:3-c,f=0<(32&l),l=31&l,h=0;if(1==c)h=u.getUint8(s),s++;else if(2==c)h=u.getUint16(s,!0),s+=2;else{if(4!=c)throw"Invalid valid pixel count type";h=u.getUint32(s,!0),s+=4}var p,d,y,g,m,v,b,c=2*o.maxZError,i=1<o.numDims?o.maxValues[i]:o.zMax;if(f){for(t.counter.lut++,v=u.getUint8(s),s++,g=Math.ceil((v-1)*l/8),m=Math.ceil(g/4),d=new ArrayBuffer(4*m),y=new Uint8Array(d),t.ptr+=s,y.set(new Uint8Array(e,t.ptr,g)),o=new Uint32Array(d),t.ptr+=g,b=0;v-1>>>b;)b++;g=Math.ceil(h*b/8),m=Math.ceil(g/4),d=new ArrayBuffer(4*m),(y=new Uint8Array(d)).set(new Uint8Array(e,t.ptr,g)),p=new Uint32Array(d),t.ptr+=g,f=(3<=a?S:w)(o,l,v-1,n,c,i),(3<=a?x:_)(p,r,b,h,f)}else t.counter.bitstuffer++,b=l,t.ptr+=s,0<b&&(g=Math.ceil(h*b/8),m=Math.ceil(g/4),d=new ArrayBuffer(4*m),(y=new Uint8Array(d)).set(new Uint8Array(e,t.ptr,g)),p=new Uint32Array(d),t.ptr+=g,3<=a?null==n?O(p,r,b,h):x(p,r,b,h,!1,n,c,i):null==n?j(p,r,b,h):_(p,r,b,h,!1,n,c,i))},readTiles:function(e,t,r,D){for(var n,i,F,o,a,N,s,u,l,c,f,h,p,d,y=t.headerInfo,g=y.width,m=y.height,v=g*m,b=y.microBlockSize,_=y.imageType,w=z.getDataTypeSize(_),x=Math.ceil(g/b),S=Math.ceil(m/b),j=(t.pixels.numBlocksY=S,t.pixels.numBlocksX=x,t.pixels.ptr=0),O=0,P=0,k=0,E=0,T=0,C=0,R=new r(b*b),B=m%b||b,G=g%b||b,M=y.numDims,I=t.pixels.resultMask,A=t.pixels.resultPixels,U=5<=y.fileVersion?14:15,L=y.zMax,P=0;P<S;P++)for(n=P!==S-1?b:B,k=0;k<x;k++)for(E=P*g*b+k*b,o=g-(i=k!==x-1?b:G),h=0;h<M;h++){if(1<M?(d=A,E=P*g*b+k*b,A=new r(t.pixels.resultPixels.buffer,v*h*w,v),L=y.maxValues[h]):d=null,a=e.byteLength-t.ptr,N={},l=(a=new DataView(e,t.ptr,Math.min(10,a))).getUint8(C=0),C++,p=5<=y.fileVersion?4&l:0,F=l>>6&255,(l>>2&U)!=(k*b>>3&U))throw"integrity issue";if(p&&0===h)throw"integrity issue";if(3<(l=3&l))throw t.ptr+=C,"Invalid block encoding ("+l+")";if(2==l){if(p)if(I)for(j=0;j<n;j++)for(O=0;O<i;O++)I[E]&&(A[E]=d[E]),E++;else for(j=0;j<n;j++)for(O=0;O<i;O++)A[E]=d[E],E++;t.counter.constant++,t.ptr+=C}else if(0==l){if(p)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=C,c=(c=n*i*w)<(s=e.byteLength-t.ptr)?c:s,s=new ArrayBuffer(c%w==0?c:c+w-c%w),new Uint8Array(s).set(new Uint8Array(e,t.ptr,c)),u=new r(s),T=0,I)for(j=0;j<n;j++){for(O=0;O<i;O++)I[E]&&(A[E]=u[T++]),E++;E+=o}else for(j=0;j<n;j++){for(O=0;O<i;O++)A[E++]=u[T++];E+=o}t.ptr+=T*w}else if(c=z.getDataTypeUsed(p&&_<6?4:_,F),f=z.getOnePixel(N,C,c,a),C+=z.getDataTypeSize(c),3==l)if(t.ptr+=C,t.counter.constantoffset++,I)for(j=0;j<n;j++){for(O=0;O<i;O++)I[E]&&(A[E]=p?Math.min(L,d[E]+f):f),E++;E+=o}else for(j=0;j<n;j++){for(O=0;O<i;O++)A[E]=p?Math.min(L,d[E]+f):f,E++;E+=o}else if(t.ptr+=C,z.decodeBits(e,t,R,f,h),C=0,p)if(I)for(j=0;j<n;j++){for(O=0;O<i;O++)I[E]&&(A[E]=R[C++]+d[E]),E++;E+=o}else for(j=0;j<n;j++){for(O=0;O<i;O++)A[E]=R[C++]+d[E],E++;E+=o}else if(I)for(j=0;j<n;j++){for(O=0;O<i;O++)I[E]&&(A[E]=R[C++]),E++;E+=o}else for(j=0;j<n;j++){for(O=0;O<i;O++)A[E++]=R[C++];E+=o}}1<M&&!D&&(t.pixels.resultPixels=z.swapDimensionOrder(t.pixels.resultPixels,v,M,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:z.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,i=e.headerInfo.maxValues,o=e.headerInfo.numDims,a=e.headerInfo.height*e.headerInfo.width,s=0,u=0,l=0,c=e.pixels.resultMask,f=e.pixels.resultPixels;if(c)if(1<o){if(t)for(s=0;s<o;s++)for(l=s*a,r=i[s],u=0;u<a;u++)c[u]&&(f[l+u]=r);else for(u=0;u<a;u++)if(c[u])for(l=u*o,s=0;s<o;s++)f[l+o]=i[s]}else for(u=0;u<a;u++)c[u]&&(f[u]=r);else if(1<o&&n!==r)if(t)for(s=0;s<o;s++)for(l=s*a,r=i[s],u=0;u<a;u++)f[l+u]=r;else for(u=0;u<a;u++)for(l=u*o,s=0;s<o;s++)f[l+s]=i[s];else for(u=0;u<a*o;u++)f[u]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=-128<=t&&t<=127;break;case 1:r=0<=t&&t<=255;break;case 2:r=-32768<=t&&t<=32767;break;case 3:r=0<=t&&t<=65536;break;case 4:r=-2147483648<=t&&t<=2147483647;break;case 5:r=0<=t&&t<=4294967296;break;case 6:r=-34027999387901484e22<=t&&t<=34027999387901484e22;break;case 7:r=-17976931348623157e292<=t&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var i=0;switch(r){case 0:i=n.getInt8(t);break;case 1:i=n.getUint8(t);break;case 2:i=n.getInt16(t,!0);break;case 3:i=n.getUint16(t,!0);break;case 4:i=n.getInt32(t,!0);break;case 5:i=n.getUInt32(t,!0);break;case 6:i=n.getFloat32(t,!0);break;case 7:i=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return i},swapDimensionOrder:function(e,t,r,n,i){var o=0,a=0,s=0,u=0,l=e;if(1<r)if(l=new n(t*r),i)for(o=0;o<t;o++)for(u=o,s=0;s<r;s++,u+=t)l[u]=e[a++];else for(o=0;o<t;o++)for(u=o,s=0;s<r;s++,u+=t)l[a++]=e[u];return l}},k=function(e,t,r){this.val=e,this.left=t,this.right=r},{decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,i={};if(i.ptr=t.inputOffset||0,i.pixels={},z.readHeaderInfo(e,i)){var o=i.headerInfo,a=o.fileVersion,s=z.getDataTypeArray(o.imageType);if(5<a)throw"unsupported lerc version 2."+a;z.readMask(e,i),o.numValidPixel===o.width*o.height||i.pixels.resultMask||(i.pixels.resultMask=t.maskData);var u,l=o.width*o.height,c=(i.pixels.resultPixels=new s(l*o.numDims),i.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},!t.returnPixelInterleavedDims);if(0!==o.numValidPixel)if(o.zMax===o.zMin)z.constructConstantSurface(i,c);else if(4<=a&&z.checkMinMaxRanges(e,i))z.constructConstantSurface(i,c);else{var f=new DataView(e,i.ptr,2),h=f.getUint8(0);if(i.ptr++,h)z.readDataOneSweep(e,i,s,c);else if(1<a&&o.imageType<=1&&Math.abs(o.maxZError-.5)<1e-5){h=f.getUint8(1);if(i.ptr++,2<(i.encodeMode=h)||a<4&&1<h)throw"Invalid Huffman flag "+h;h?z.readHuffman(e,i,s,c):z.readTiles(e,i,s,c)}else z.readTiles(e,i,s,c)}i.eofOffset=i.ptr,t.inputOffset?(u=i.headerInfo.blobSize+t.inputOffset-i.ptr,1<=Math.abs(u)&&(i.eofOffset=t.inputOffset+i.headerInfo.blobSize)):(u=i.headerInfo.blobSize-i.ptr,1<=Math.abs(u)&&(i.eofOffset=i.headerInfo.blobSize));var p={width:o.width,height:o.height,pixelData:i.pixels.resultPixels,minValue:o.zMin,maxValue:o.zMax,validPixelCount:o.numValidPixel,dimCount:o.numDims,dimStats:{minValues:o.minValues,maxValues:o.maxValues},maskData:i.pixels.resultMask};if(i.pixels.resultMask&&z.isValidPixelValue(o.imageType,r)){for(var d=i.pixels.resultMask,n=0;n<l;n++)d[n]||(p.pixelData[n]=r);p.noDataValue=r}return i.noDataValue=r,t.returnFileInfo&&(p.fileInfo=z.formatFileInfo(i)),p}},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)z.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}}),P=(e=new ArrayBuffer(4),t=new Uint8Array(e),(new Uint32Array(e)[0]=1)===t[0]),r={decode:function(e,t){if(!P)throw"Big endian system is not supported.";var r,n,i=(t=t||{}).inputOffset||0,o=new Uint8Array(e,i,10),o=String.fromCharCode.apply(null,o);if("CntZImage"===o.trim())r=v,n=1;else{if("Lerc2"!==o.substring(0,5))throw"Unexpected file identifier string: "+o;r=b,n=2}for(var a,s,u,l,c,f=0,h=e.byteLength-10,p=[],d={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]},y=0;i<h;){var g=r.decode(e,{inputOffset:i,encodedMaskData:a,maskData:m,returnMask:0===f,returnEncodedMask:0===f,returnFileInfo:!0,returnPixelInterleavedDims:t.returnPixelInterleavedDims,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null}),i=g.fileInfo.eofOffset,m=g.maskData;0===f&&(a=g.encodedMaskData,d.width=g.width,d.height=g.height,d.dimCount=g.dimCount||1,d.pixelType=g.pixelType||g.fileInfo.pixelType,d.mask=m),1<n&&(m&&p.push(m),g.fileInfo.mask)&&0<g.fileInfo.mask.numBytes&&y++,f++,d.pixels.push(g.pixelData),d.statistics.push({minValue:g.minValue,maxValue:g.maxValue,noDataValue:g.noDataValue,dimStats:g.dimStats})}if(1<n&&1<y){for(c=d.width*d.height,d.bandMasks=p,(m=new Uint8Array(c)).set(p[0]),u=1;u<p.length;u++)for(s=p[u],l=0;l<c;l++)m[l]=m[l]&s[l];d.maskData=m}return d}};"function"==typeof define&&define.amd?define([],function(){return r}):void 0!==n&&n.exports?n.exports=r:this.Lerc=r}()},{}],63:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(){return 1}var u=e("yallist"),l=Symbol("max"),c=Symbol("length"),f=Symbol("lengthCalculator"),h=Symbol("allowStale"),p=Symbol("maxAge"),d=Symbol("dispose"),y=Symbol("noDisposeOnSet"),g=Symbol("lruList"),m=Symbol("cache"),v=Symbol("updateAgeOnGet"),e=function(){function r(e){if(a(this,r),(e=(e="number"==typeof e?{max:e}:e)||{}).max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[l]=e.max||1/0;var t=e.length||s;if(this[f]="function"!=typeof t?s:t,this[h]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[p]=e.maxAge||0,this[d]=e.dispose,this[y]=e.noDisposeOnSet||!1,this[v]=e.updateAgeOnGet||!1,this.reset()}return o(r,[{key:"max",get:function(){return this[l]},set:function(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[l]=e||1/0,w(this)}},{key:"allowStale",get:function(){return this[h]},set:function(e){this[h]=!!e}},{key:"maxAge",get:function(){return this[p]},set:function(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[p]=e,w(this)}},{key:"lengthCalculator",get:function(){return this[f]},set:function(e){var t=this;(e="function"!=typeof e?s:e)!==this[f]&&(this[f]=e,this[c]=0,this[g].forEach(function(e){e.length=t[f](e.value,e.key),t[c]+=e.length})),w(this)}},{key:"length",get:function(){return this[c]}},{key:"itemCount",get:function(){return this[g].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var r=this[g].tail;null!==r;){var n=r.prev;j(this,e,r,t),r=n}}},{key:"forEach",value:function(e,t){t=t||this;for(var r=this[g].head;null!==r;){var n=r.next;j(this,e,r,t),r=n}}},{key:"keys",value:function(){return this[g].toArray().map(function(e){return e.key})}},{key:"values",value:function(){return this[g].toArray().map(function(e){return e.value})}},{key:"reset",value:function(){var t=this;this[d]&&this[g]&&this[g].length&&this[g].forEach(function(e){return t[d](e.key,e.value)}),this[m]=new Map,this[g]=new u,this[c]=0}},{key:"dump",value:function(){var t=this;return this[g].map(function(e){return!_(t,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}}).toArray().filter(function(e){return e})}},{key:"dumpLru",value:function(){return this[g]}},{key:"set",value:function(e,t,r){if((r=r||this[p])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");var n,i=r?Date.now():0,o=this[f](t,e);return this[m].has(e)?o>this[l]?(x(this,this[m].get(e)),!1):(n=this[m].get(e).value,this[d]&&!this[y]&&this[d](e,n.value),n.now=i,n.maxAge=r,n.value=t,this[c]+=o-n.length,n.length=o,this.get(e),w(this),!0):(n=new S(e,t,o,i,r)).length>this[l]?(this[d]&&this[d](e,t),!1):(this[c]+=n.length,this[g].unshift(n),this[m].set(e,this[g].head),w(this),!0)}},{key:"has",value:function(e){return!!this[m].has(e)&&(e=this[m].get(e).value,!_(this,e))}},{key:"get",value:function(e){return b(this,e,!0)}},{key:"peek",value:function(e){return b(this,e,!1)}},{key:"pop",value:function(){var e=this[g].tail;return e?(x(this,e),e.value):null}},{key:"del",value:function(e){x(this,this[m].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),r=e.length-1;0<=r;r--){var n=e[r],i=n.e||0;0===i?this.set(n.k,n.v):0<(i=i-t)&&this.set(n.k,n.v,i)}}},{key:"prune",value:function(){var r=this;this[m].forEach(function(e,t){return b(r,t,!1)})}}]),r}(),b=function(e,t,r){t=e[m].get(t);if(t){var n=t.value;if(_(e,n)){if(x(e,t),!e[h])return}else r&&(e[v]&&(t.value.now=Date.now()),e[g].unshiftNode(t));return n.value}},_=function(e,t){var r;return!(!t||!t.maxAge&&!e[p])&&(r=Date.now()-t.now,t.maxAge?r>t.maxAge:e[p]&&r>e[p])},w=function(e){if(e[c]>e[l])for(var t=e[g].tail;e[c]>e[l]&&null!==t;){var r=t.prev;x(e,t),t=r}},x=function(e,t){var r;t&&(r=t.value,e[d]&&e[d](r.key,r.value),e[c]-=r.length,e[m].delete(r.key),e[g].removeNode(t))},S=o(function e(t,r,n,i,o){a(this,e),this.key=t,this.value=r,this.length=n,this.now=i,this.maxAge=o||0}),j=function(e,t,r,n){var i=r.value;_(e,i)&&(x(e,r),e[h]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};t.exports=e},{yallist:432}],64:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=f(e("ol/control/Control.js")),o=e("ol/Observable.js"),a=f(e("ol/style/Style.js")),s=f(e("ol/style/Fill.js")),u=f(e("ol/style/Stroke.js")),l=f(e("ol/style/Text.js")),c=f(e("../util/getMapCanvas.js"));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=y(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,e=e||{})).setStyle(e.style),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"setMap",value:function(e){this.getCanvas(e);var t=this.getMap();if(this._listener&&((0,o.unByKey)(this._listener),this._listener=null),p(g(i.prototype),"setMap",this).call(this,e),t)try{t.renderSync()}catch(e){}e&&(this._listener=e.on("postcompose",this._draw.bind(this)))}},{key:"getCanvas",value:function(e){return(0,c.default)(e)}},{key:"getContext",value:function(e){var t,e=e.context;return e=!e&&this.getMap()?(t=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0])?t.getContext("2d"):null:e}},{key:"setStyle",value:function(e){this._style=e||new a.default({})}},{key:"getStyle",value:function(){return this._style}},{key:"getStroke",value:function(){return this._style.getStroke()||this._style.setStroke(new u.default({color:"#000",width:1.25})),this._style.getStroke()}},{key:"getFill",value:function(){return this._style.getFill()||this._style.setFill(new s.default({color:"#fff"})),this._style.getFill()}},{key:"getTextStroke",value:function(){var e=this._style.getText();return(e=e||new l.default({})).getStroke()||e.setStroke(new u.default({color:"#fff",width:3})),e.getStroke()}},{key:"getTextFill",value:function(){var e=this._style.getText();return(e=e||new l.default({})).getFill()||e.setFill(new s.default({color:"#fff"})),e.getFill()}},{key:"getTextFont",value:function(){var e=this._style.getText();return(e=e||new l.default({})).getFont()||e.setFont("12px sans-serif"),e.getFont()}},{key:"_draw",value:function(){console.warn("[CanvasBase] draw function not implemented.")}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../util/getMapCanvas.js":66,"ol/Observable.js":92,"ol/control/Control.js":111,"ol/style/Fill.js":360,"ol/style/Stroke.js":366,"ol/style/Style.js":367,"ol/style/Text.js":368}],65:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("ol/proj/Projection.js")),s=n(e("ol/style/Style.js")),u=n(e("ol/style/Stroke.js")),l=n(e("ol/style/Fill.js")),c=n(e("ol/style/Text.js")),D=e("ol/proj.js");function n(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,i=p(o);function o(e){var t;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");e=e||{};var r=document.createElement("div");r.className="ol-graticule ol-unselectable ol-hidden",(t=i.call(this,{element:r})).set("projection",e.projection||"EPSG:4326");var n=new a.default({code:t.get("projection")}).getMetersPerUnit();for(t.fac=1;10<n/t.fac;)t.fac*=10;return t.fac=1e4/t.fac,t.set("maxResolution",e.maxResolution||1/0),t.set("step",e.step||.1),t.set("stepCoord",e.stepCoord||1),t.set("spacing",e.spacing||40),t.set("intervals",e.intervals),t.set("precision",e.precision),t.set("margin",e.margin||0),t.set("borderWidth",e.borderWidth||5),t.set("stroke",!1!==e.stroke),t.formatCoord=e.formatCoord||function(e){return e},e.style instanceof s.default?t.setStyle(e.style):t.setStyle(new s.default({stroke:new u.default({color:"#000",width:1}),fill:new l.default({color:"#fff"}),text:new c.default({stroke:new u.default({color:"#fff",width:2}),fill:new l.default({color:"#000"})})})),t}return t=o,(e=[{key:"setStyle",value:function(e){this._style=e}},{key:"_draw",value:function(e){if(!(this.get("maxResolution")<e.frameState.viewState.resolution)){for(var t,r=this.getContext(e),n=r.canvas,e=e.frameState.pixelRatio,i=n.width/e,o=n.height/e,a=this.get("projection"),s=this.getMap(),u=[s.getCoordinateFromPixel([0,0]),s.getCoordinateFromPixel([i,0]),s.getCoordinateFromPixel([i,o]),s.getCoordinateFromPixel([0,o])],l=-1/0,c=1/0,f=-1/0,h=1/0,p=0;t=u[p];p++)u[p]=(0,D.transform)(t,s.getView().getProjection(),a),l=Math.max(l,u[p][0]),c=Math.min(c,u[p][0]),f=Math.max(f,u[p][1]),h=Math.min(h,u[p][1]);var n=this.get("spacing"),d=this.get("step"),y=this.get("stepCoord"),g=this.get("borderWidth"),m=this.get("margin"),v=(i<(l-c)/d*n&&(d*=Math.round((l-c)/i*n/d))>this.fac&&(d=Math.round(d/this.fac)*this.fac),this.get("intervals"));if(Array.isArray(v)){for(var b=v[0],_=0,w=v.length;_<w&&!(d>=v[_]);++_)b=v[_];d=b}for(var x,S,j,O,n=this.get("precision"),P=d,n=(0<n&&n<d&&(P=d/Math.ceil(d/n)),c=Math.floor(c/d)*d-d,h=Math.floor(h/d)*d-d,l=Math.floor(l/d)*d+2*d,f=Math.floor(f/d)*d+2*d,(0,D.get)(a).getExtent()),k=(n&&(c<n[0]&&(c=n[0]),h<n[1]&&(h=n[1]),l>n[2]&&(l=n[2]+d),f>n[3])&&(f=n[3]+d),this.getStyle().getStroke()&&this.get("stroke")),n=this.getStyle().getText(),E=this.getStyle().getFill(),T=(r.save(),r.scale(e,e),r.beginPath(),r.rect(m,m,i-2*m,o-2*m),r.clip(),r.beginPath(),{top:[],left:[],bottom:[],right:[]}),C=c;C<l;C+=d)for(j=(0,D.transform)([C,h],a,s.getView().getProjection()),j=s.getPixelFromCoordinate(j),k&&r.moveTo(j[0],j[1]),S=j,x=h+P;x<=f;x+=P)O=(0,D.transform)([C,x],a,s.getView().getProjection()),O=s.getPixelFromCoordinate(O),k&&r.lineTo(O[0],O[1]),0<S[1]&&O[1]<0&&T.top.push([C,S]),S[1]>o&&O[1]<o&&T.bottom.push([C,S]),S=O;for(x=h;x<f;x+=d)for(j=(0,D.transform)([c,x],a,s.getView().getProjection()),j=s.getPixelFromCoordinate(j),k&&r.moveTo(j[0],j[1]),S=j,C=c+P;C<=l;C+=P)O=(0,D.transform)([C,x],a,s.getView().getProjection()),O=s.getPixelFromCoordinate(O),k&&r.lineTo(O[0],O[1]),S[0]<0&&0<O[0]&&T.left.push([x,S]),S[0]<i&&O[0]>i&&T.right.push([x,S]),S=O;if(k&&(r.strokeStyle=this.getStyle().getStroke().getColor(),r.lineWidth=this.getStyle().getStroke().getWidth(),r.stroke()),n){r.fillStyle=this.getStyle().getText().getFill().getColor(),r.strokeStyle=this.getStyle().getText().getStroke().getColor(),r.lineWidth=this.getStyle().getText().getStroke().getWidth(),r.font=this.getStyle().getText().getFont(),r.textAlign="center",r.textBaseline="hanging";for(var R,M,I=(E?g:0)+m+2,p=0;R=T.top[p];p++)Math.round(R[0]/this.get("step"))%y||(M=this.formatCoord(R[0],"top"),r.strokeText(M,R[1][0],I),r.fillText(M,R[1][0],I));for(r.textBaseline="alphabetic",p=0;R=T.bottom[p];p++)Math.round(R[0]/this.get("step"))%y||(M=this.formatCoord(R[0],"bottom"),r.strokeText(M,R[1][0],o-I),r.fillText(M,R[1][0],o-I));for(r.textBaseline="middle",r.textAlign="left",p=0;R=T.left[p];p++)Math.round(R[0]/this.get("step"))%y||(M=this.formatCoord(R[0],"left"),r.strokeText(M,I,R[1][1]),r.fillText(M,I,R[1][1]));for(r.textAlign="right",p=0;R=T.right[p];p++)Math.round(R[0]/this.get("step"))%y||(M=this.formatCoord(R[0],"right"),r.strokeText(M,i-I,R[1][1]),r.fillText(M,i-I,R[1][1]))}if(E){var A,L=this.getStyle().getFill().getColor();for((e=this.getStyle().getStroke())?A=this.getStyle().getStroke().getColor():(A=L,L="#fff"),r.strokeStyle=A,r.lineWidth=e?e.getWidth():1,p=1;p<T.top.length;p++)r.beginPath(),r.rect(T.top[p-1][1][0],m,T.top[p][1][0]-T.top[p-1][1][0],g),r.fillStyle=Math.round(T.top[p][0]/d)%2?A:L,r.fill(),r.stroke();for(p=1;p<T.bottom.length;p++)r.beginPath(),r.rect(T.bottom[p-1][1][0],o-g-m,T.bottom[p][1][0]-T.bottom[p-1][1][0],g),r.fillStyle=Math.round(T.bottom[p][0]/d)%2?A:L,r.fill(),r.stroke();for(p=1;p<T.left.length;p++)r.beginPath(),r.rect(m,T.left[p-1][1][1],g,T.left[p][1][1]-T.left[p-1][1][1]),r.fillStyle=Math.round(T.left[p][0]/d)%2?A:L,r.fill(),r.stroke();for(p=1;p<T.right.length;p++)r.beginPath(),r.rect(i-g-m,T.right[p-1][1][1],g,T.right[p][1][1]-T.right[p-1][1][1]),r.fillStyle=Math.round(T.right[p][0]/d)%2?A:L,r.fill(),r.stroke();r.beginPath(),r.fillStyle=A,r.rect(m,m,g,g),r.rect(m,o-g-m,g,g),r.rect(i-g-m,m,g,g),r.rect(i-g-m,o-g-m,g,g),r.fill()}r.restore()}}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n(e("./CanvasBase.js")).default);r.default=e},{"./CanvasBase.js":64,"ol/proj.js":271,"ol/proj/Projection.js":272,"ol/style/Fill.js":360,"ol/style/Stroke.js":366,"ol/style/Style.js":367,"ol/style/Text.js":368}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=function(t){var r;return t?((r=t.getViewport().getElementsByClassName("ol-fixedoverlay")[0])||(t.getViewport().querySelector(".ol-layers")?((r=document.createElement("canvas")).className="ol-fixedoverlay",t.getViewport().querySelector(".ol-layers").after(r),t.on("precompose",function(e){r.width=t.getSize()[0]*e.frameState.pixelRatio,r.height=t.getSize()[1]*e.frameState.pixelRatio})):r=t.getViewport().querySelector("canvas")),r):null}},{}],67:[function(e,t,r){"use strict";function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,i;n=void 0,i=function(e,t,r,n,i,o,a,s){function u(e){return e&&"object"==W(e)&&"default"in e?e:{default:e}}var e=u(e),D=u(t),F=u(r),N=u(n),B=u(i),G=u(o),U=u(a),c=u(s),t="gcd-container",r="gcd-button-control",n="gcd-input-query",i="gcd-input-reset",o={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},l=Object.freeze({__proto__:null,containerId:t,buttonControlId:r,inputQueryId:n,inputResetId:i,cssClasses:o,default:{containerId:t,buttonControlId:r,inputQueryId:n,inputResetId:i,cssClasses:o}}),f="addresschosen",h="nominatim",p="glass-button",d={provider:"osm",placeholder:"Search for an address",featureStyle:null,targetType:p,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,autoCompleteTimeout:200,debug:!1};function y(e,t){if(void 0===t&&(t="Assertion failed"),!e){if("undefined"!=typeof Error)throw new Error(t);throw t}}function g(e){"performance"in window==0&&(window.performance={}),"now"in window.performance==0&&(t=Date.now(),performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t});var t,r=window.performance.now().toString(36);return e?e+r:r}function m(e){return/^[0-9]+$/.test(e)}function v(e,t,r){if(Array.isArray(e))e.forEach(function(e){return v(e,t)});else for(var n=Array.isArray(t)?t:t.split(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/),i=n.length;i--;)_(e,n[i])||S(e,n[i],r)}function b(e,t,r){if(Array.isArray(e))e.forEach(function(e){return b(e,t,r)});else for(var n=Array.isArray(t)?t:t.split(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/),i=n.length;i--;)_(e,n[i])&&j(e,n[i],r)}function _(e,t){return e.classList?e.classList.contains(t):x(t).test(e.className)}function w(e,t){var r;if(Array.isArray(e)){if(r=document.createElement(e[0]),e[1].id&&(r.id=e[1].id),e[1].classname&&(r.className=e[1].classname),e[1].attr){var n=e[1].attr;if(Array.isArray(n))for(var i=-1;++i<n.length;)r.setAttribute(n[i].name,n[i].value);else r.setAttribute(n.name,n.value)}}else r=document.createElement(e);r.innerHTML=t;for(var o=document.createDocumentFragment();r.childNodes[0];)o.append(r.childNodes[0]);return r.append(o),r}function x(e){return new RegExp("(^|\\s+) "+e+" (\\s+|$)","u")}function S(e,t,r){e.classList?e.classList.add(t):e.className=(e.className+" "+t).trim(),r&&m(r)&&window.setTimeout(function(){return j(e,t)},r)}function j(e,t,r){e.classList?e.classList.remove(t):e.className=e.className.replace(x(t)," ").trim(),r&&m(r)&&window.setTimeout(function(){return S(e,t)},r)}function O(e){this.options=e.options,this.els=this.createControl()}function P(){this.settings={url:"https://photon.komoot.io/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}}function k(){this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}function E(){this.settings={url:"https://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}function T(){this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}}function C(){this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}}var R=l.cssClasses;O.prototype.createControl=function(){var e,t="text-input"===this.options.targetType?(t=R.namespace+" "+R.inputText.container,{container:e=w(["div",{id:l.containerId,classname:t}],O.input),control:e.querySelector("."+R.inputText.control),input:e.querySelector("."+R.inputText.input),reset:e.querySelector("."+R.inputText.reset),result:e.querySelector("."+R.inputText.result)}):(t=R.namespace+" "+R.glass.container,{container:e=w(["div",{id:l.containerId,classname:t}],O.glass),control:e.querySelector("."+R.glass.control),button:e.querySelector("."+R.glass.button),input:e.querySelector("."+R.glass.input),reset:e.querySelector("."+R.glass.reset),result:e.querySelector("."+R.glass.result)});return t.input.placeholder=this.options.placeholder,t},O.glass='\n  <div class="'+R.glass.control+" "+R.olControl+'">\n    <button type="button" id="'+l.buttonControlId+'" class="'+R.glass.button+'"></button>\n    <input type="text" id="'+l.inputQueryId+'" class="'+R.glass.input+'" autocomplete="off" placeholder="Search ...">\n    <a id="'+l.inputResetId+'" class="'+R.glass.reset+" "+R.hidden+'"></a>\n  </div>\n  <ul class="'+R.glass.result+'"></ul>\n',O.input='\n  <div class="'+R.inputText.control+'">\n    <input type="text" id="'+l.inputQueryId+'" class="'+R.inputText.input+'" autocomplete="off" placeholder="Search ...">\n    <span class="'+R.inputText.icon+'"></span>\n    <button type="button" id="'+l.inputResetId+'" class="'+R.inputText.reset+" "+R.hidden+'"></button>\n  </div>\n  <ul class="'+R.inputText.result+'"></ul>\n',P.prototype.getParameters=function(e){return e.lang=e.lang.toLowerCase(),{url:this.settings.url,params:{q:e.query,limit:e.limit||this.settings.params.limit,lang:(this.settings.langs.includes(e.lang)?e:this.settings.params).lang}}},P.prototype.handleResponse=function(e){return 0===e.features.length?[]:e.features.map(function(e){return{lon:e.geometry.coordinates[0],lat:e.geometry.coordinates[1],address:{name:e.properties.name,postcode:e.properties.postcode,city:e.properties.city,state:e.properties.state,country:e.properties.country},original:{formatted:e.properties.name,details:e.properties}}})},k.prototype.getParameters=function(e){return{url:this.settings.url,params:{q:e.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,"accept-language":e.lang||this.settings.params["accept-language"]}}},k.prototype.handleResponse=function(e){return 0===e.length?[]:e.map(function(e){return{lon:e.lon,lat:e.lat,bbox:e.boundingbox,address:{name:e.display_name,road:e.address.road||"",houseNumber:e.address.house_number||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}})},E.prototype.getParameters=function(e){return{url:this.settings.url,params:{q:e.query,key:e.key,format:"json",addressdetails:1,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,"accept-language":e.lang||this.settings.params["accept-language"]}}},E.prototype.handleResponse=function(e){return 0===e.length?[]:e.map(function(e){return{lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||"",road:e.address.road||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}})},T.prototype.getParameters=function(e){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:e.query,key:e.key,includeNeighborhood:e.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:e.maxResults||this.settings.params.maxResults}}},T.prototype.handleResponse=function(e){e=e.resourceSets[0].resources;return 0===e.length?[]:e.map(function(e){return{lon:e.point.coordinates[1],lat:e.point.coordinates[0],address:{name:e.name},original:{formatted:e.address.formattedAddress,details:e.address}}})};function z(l){return new Promise(function(e,t){r=l.url,(u=l.data)&&"object"==W(u)&&(r+=(/\?/.test(r)?"&":"?")+function r(n){return Object.keys(n).reduce(function(e,t){return e.push("object"==W(n[t])?r(n[t]):encodeURIComponent(t)+"="+encodeURIComponent(n[t])),e},[]).join("&")}(u));var r,n,i,o,a,s,u=r;l.jsonp?(r=u,n=l.callbackName,i=e,o=document.head,a=document.createElement("script"),s="f"+Math.round(Math.random()*Date.now()),a.setAttribute("src",r+(0<r.indexOf("?")?"&":"?")+n+"="+s),window[s]=function(e){window[s]=void 0,setTimeout(function(){return o.removeChild(a)},0),i(e)},o.append(a)):fetch(u,{method:"GET",mode:"cors",credentials:"same-origin"}).then(function(e){return e.json()}).then(e).catch(t)})}C.prototype.getParameters=function(e){return{url:this.settings.url,params:{q:e.query,key:e.key,limit:e.limit||this.settings.params.limit,countrycode:e.countrycodes||this.settings.params.countrycodes}}},C.prototype.handleResponse=function(e){return 0===e.results.length?[]:e.results.map(function(e){return{lon:e.geometry.lng,lat:e.geometry.lat,address:{name:e.components.house_number||"",road:e.components.road||"",postcode:e.components.postcode,city:e.components.city||e.components.town,state:e.components.state,country:e.components.country},original:{formatted:e.formatted,details:e.components}}})};function M(e,t){this.Base=e,this.layerName=g("geocoder-layer-"),this.layer=new N.default({name:this.layerName,source:new B.default}),this.options=e.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.provider=this.newProvider(),this.els=t,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners()}var I,A=l.cssClasses;return M.prototype.setListeners=function(){var r,n,i=this;this.els.input.addEventListener("keypress",function(e){var t=e.target.value.trim();(e.key?"Enter"===e.key:e.which?13===e.which:e.keyCode&&13===e.keyCode)&&(e.preventDefault(),i.query(t))},!1),this.els.input.addEventListener("click",function(e){return e.stopPropagation()},!1),this.els.input.addEventListener("input",function(e){var t=e.target.value.trim();(0!==t.length?b:v)(i.els.reset,A.hidden),i.options.autoComplete&&t!==n&&(n=t,r&&clearTimeout(r),r=setTimeout(function(){t.length>=i.options.autoCompleteMinLength&&i.query(t)},i.options.autoCompleteTimeout))},!1),this.els.reset.addEventListener("click",function(e){i.els.input.focus(),i.els.input.value="",i.lastQuery="",v(i.els.reset,A.hidden),i.clearResults()},!1),this.options.targetType===p&&this.els.button.addEventListener("click",function(e){e.stopPropagation(),_(i.els.control,A.glass.expanded)?i.collapse():i.expand()},!1)},M.prototype.query=function(e){var r=this,t=(this.provider||(this.provider=this.newProvider()),this.provider.getParameters({query:e,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit}));this.lastQuery===e&&this.els.result.firstChild||(this.lastQuery=e,this.clearResults(),v(this.els.reset,A.spin),e={url:t.url,data:t.params},t.callbackName&&(e.jsonp=!0,e.callbackName=t.callbackName),z(e).then(function(e){r.options.debug&&console.info(e),b(r.els.reset,A.spin);e=r.provider.handleResponse(e);e&&(r.createList(e),r.listenMapClick())}).catch(function(e){b(r.els.reset,A.spin);var t=w("li","<h5>Error! No internet connection?</h5>");r.els.result.append(t)}))},M.prototype.createList=function(e){var n=this,i=this.els.result;e.forEach(function(t){var r="osm"===n.options.provider?'<span class="'+A.road+'">'+t.address.name+"</span>":n.addressTemplate(t.address),e=w("li",'<a href="#">'+r+"</a>");e.addEventListener("click",function(e){e.preventDefault(),n.chosen(t,r,t.address,t.original)},!1),i.append(e)})},M.prototype.chosen=function(e,t,r,n){var i,o,a=this.Base.getMap(),s=[Number.parseFloat(e.lon),Number.parseFloat(e.lat)],u=a.getView().getProjection(),s=c.default.transform(s,"EPSG:4326",u),l=(l=e.bbox)&&c.default.transformExtent([l[2],l[1],l[3],l[0]],"EPSG:4326",u),u={formatted:t,details:r,original:n};!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault?this.Base.dispatchEvent({type:f,address:u,coordinate:s,bbox:l,place:e}):(l?a.getView().fit(l,{duration:500}):(t=s,void 0===i&&(i=500),void 0===o&&(o=2.388657133911758),a.getView().animate({duration:i,resolution:o},{duration:i,center:t})),r=this.createFeature(s,u),this.Base.dispatchEvent({type:f,address:u,feature:r,coordinate:s,bbox:l,place:e}))},M.prototype.createFeature=function(e){e=new U.default(new G.default(e));return this.addLayer(),e.setStyle(this.options.featureStyle),e.setId(g("geocoder-ft-")),this.getSource().addFeature(e),e},M.prototype.addressTemplate=function(e){var r,t=[];return e.name&&t.push(['<span class="',A.road,'">{name}</span>'].join("")),(e.road||e.building||e.house_number)&&t.push(['<span class="',A.road,'">{building} {road} {house_number}</span>'].join("")),(e.city||e.town||e.village)&&t.push(['<span class="',A.city,'">{postcode} {city} {town} {village}</span>'].join("")),(e.state||e.country)&&t.push(['<span class="',A.country,'">{state} {country}</span>'].join("")),t=t.join("<br>"),r=e,t.replace(/\{[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([\x2D0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\}/g,function(e,t){t=void 0===r[t]?"":r[t];return String(t).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")})},M.prototype.newProvider=function(){switch(this.options.provider){case"osm":return new k;case"mapquest":return new E;case"photon":return new P;case"bing":return new T;case"opencage":return new C;default:return this.options.provider}},M.prototype.expand=function(){var e=this;b(this.els.input,A.spin),v(this.els.control,A.glass.expanded),window.setTimeout(function(){return e.els.input.focus()},100),this.listenMapClick()},M.prototype.collapse=function(){this.els.input.value="",this.els.input.blur(),v(this.els.reset,A.hidden),b(this.els.control,A.glass.expanded),this.clearResults()},M.prototype.listenMapClick=function(){var t,r;this.registeredListeners.mapClick||(r=(t=this).Base.getMap().getTargetElement(),this.registeredListeners.mapClick=!0,r.addEventListener("click",{handleEvent:function(e){t.clearResults(!0),r.removeEventListener(e.type,this,!1),t.registeredListeners.mapClick=!1}},!1))},M.prototype.clearResults=function(e){if(e&&this.options.targetType===p)this.collapse();else for(var t=this.els.result;t.firstChild;)t.firstChild.remove()},M.prototype.getSource=function(){return this.layer.getSource()},M.prototype.addLayer=function(){var t=this,r=!1,e=this.Base.getMap();e.getLayers().forEach(function(e){e===t.layer&&(r=!0)}),r||e.addLayer(this.layer)},(I=e.default)&&(L.__proto__=I),((L.prototype=Object.create(I&&I.prototype)).constructor=L).prototype.getLayer=function(){return this.layer},L.prototype.getSource=function(){return this.getLayer().getSource()},L.prototype.setProvider=function(e){this.options.provider=e},L.prototype.setProviderKey=function(e){this.options.key=e},L;function L(e,t){if(void 0===e&&(e=h),void 0===t&&(t={}),!(this instanceof L))return new L;y("string"==typeof e,"@param `type` should be string!"),y(e===h||"reverse"===e,"@param 'type' should be '"+h+"'\n      or 'reverse'!"),y("object"==W(t),"@param `options` should be object!"),d.featureStyle=[new D.default({image:new F.default({scale:.7,src:"//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png"})})],this.options=function(e,t){var r,n,i={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i}(d,t),this.container=void 0;t=new O(this);e===h&&(this.container=t.els.container,e=new M(this,t.els),this.layer=e.layer),I.call(this,{element:this.container})}},"object"==(void 0===r?"undefined":W(r))&&void 0!==t?t.exports=i(e("ol/control/Control"),e("ol/style/Style"),e("ol/style/Icon"),e("ol/layer/Vector"),e("ol/source/Vector"),e("ol/geom/Point"),e("ol/Feature"),e("ol/proj")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/style/Style","ol/style/Icon","ol/layer/Vector","ol/source/Vector","ol/geom/Point","ol/Feature","ol/proj"],i):(n="undefined"!=typeof globalThis?globalThis:self).Geocoder=i(n.ol.control.Control,n.ol.style.Style,n.ol.style.Icon,n.ol.layer.Vector,n.ol.source.Vector,n.ol.geom.Point,n.ol.Feature,n.ol.proj)},{"ol/Feature":75,"ol/control/Control":111,"ol/geom/Point":199,"ol/layer/Vector":261,"ol/proj":271,"ol/source/Vector":346,"ol/style/Icon":361,"ol/style/Style":367}],68:[function(e,t,r){"use strict";function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,o;o=function(i,o,h){i="default"in i?i.default:i,h="default"in h?h.default:h;var p="layer-switcher-",e=function(){var e=f,t=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t);var r,n=l(f);function f(e){var t,r;if(this instanceof f)return e=Object.assign({},e),t=document.createElement("div"),(r=n.call(this,{element:t,target:e.target})).activationMode=e.activationMode||"mouseover",r.startActive=!0===e.startActive,r.label=void 0!==e.label?e.label:"",r.collapseLabel=void 0!==e.collapseLabel?e.collapseLabel:"»",r.tipLabel=e.tipLabel||"Legend",r.collapseTipLabel=e.collapseTipLabel||"Collapse legend",r.groupSelectStyle=f.getGroupSelectStyle(e.groupSelectStyle),r.reverse=!1!==e.reverse,r.mapListeners=[],r.hiddenClassName="ol-unselectable ol-control layer-switcher",f.isTouchDevice_()&&(r.hiddenClassName+=" touch"),r.shownClassName="shown",t.className=r.hiddenClassName,r.button=document.createElement("button"),t.appendChild(r.button),r.panel=document.createElement("div"),r.panel.className="panel",t.appendChild(r.panel),f.enableTouchScroll_(r.panel),t.classList.add(p+"group-select-style-"+r.groupSelectStyle),t.classList.add(p+"activation-mode-"+r.activationMode),"click"===r.activationMode?(t.classList.add("activationModeClick"),r.button.onclick=function(e){e=e||window.event;r.element.classList.contains(r.shownClassName)?r.hidePanel():r.showPanel(),e.preventDefault()}):(r.button.onmouseover=function(){r.showPanel()},r.button.onclick=function(e){e=e||window.event;r.showPanel(),e.preventDefault()},r.panel.onmouseout=function(e){r.panel.contains(e.relatedTarget)||r.hidePanel()}),r.updateButton(),r;throw new TypeError("Cannot call a class as a function")}return e=f,t=[{key:"renderPanel",value:function(t,r,n){var e=new Event("render");for(r.dispatchEvent(e),(n=n||{}).groupSelectStyle=f.getGroupSelectStyle(n.groupSelectStyle),f.ensureTopVisibleBaseLayerShown(t,n.groupSelectStyle);r.firstChild;)r.removeChild(r.firstChild);f.forEachRecursive(t,function(e,t,r){e.set("indeterminate",!1)}),"children"===n.groupSelectStyle||"none"===n.groupSelectStyle?f.setGroupVisibility(t):"group"===n.groupSelectStyle&&f.setChildVisibility(t);e=document.createElement("ul"),r.appendChild(e),f.renderLayers_(t,t,e,n,function(e){f.renderPanel(t,r,n)}),e=new Event("rendercomplete");r.dispatchEvent(e)}},{key:"isBaseGroup",value:function(e){return e instanceof h&&(e=e.getLayers().getArray()).length&&"base"===e[0].get("type")}},{key:"setGroupVisibility",value:function(e){f.getGroupsAndLayers(e,function(e){return e instanceof h&&!e.get("combine")&&!f.isBaseGroup(e)}).reverse().forEach(function(e){var t=e.getLayersArray().map(function(e){return e.getVisible()});t.every(function(e){return!0===e})?(e.setVisible(!0),e.set("indeterminate",!1)):t.every(function(e){return!1===e})?(e.setVisible(!1),e.set("indeterminate",!1)):(e.setVisible(!0),e.set("indeterminate",!0))})}},{key:"setChildVisibility",value:function(e){f.getGroupsAndLayers(e,function(e){return e instanceof h&&!e.get("combine")&&!f.isBaseGroup(e)}).forEach(function(e){var t=e.getVisible(),r=e.get("indeterminate");e.getLayers().getArray().forEach(function(e){e.set("indeterminate",!1),t&&!r||!e.getVisible()||e.set("indeterminate",!0)})})}},{key:"ensureTopVisibleBaseLayerShown",value:function(e,t){var n;f.forEachRecursive(e,function(e,t,r){"base"===e.get("type")&&e.getVisible()&&(n=e)}),n&&f.setVisible_(e,n,!0,t)}},{key:"getGroupsAndLayers",value:function(e,n){var i=[];return n=n||function(e,t,r){return!0},f.forEachRecursive(e,function(e,t,r){e.get("title")&&n(e,t,r)&&i.push(e)}),i}},{key:"setVisible_",value:function(t,n,e,r){n.setVisible(e),e&&"base"===n.get("type")&&f.forEachRecursive(t,function(e,t,r){e!=n&&"base"===e.get("type")&&e.setVisible(!1)}),n instanceof h&&!n.get("combine")&&"children"===r&&n.getLayers().forEach(function(e){f.setVisible_(t,e,n.getVisible(),r)})}},{key:"renderLayer_",value:function(t,r,e,n,i){var o,a,s=document.createElement("li"),u=r.get("title"),l=f.uuid(),c=document.createElement("label");return r instanceof h&&!r.get("combine")?(o=f.isBaseGroup(r),s.classList.add("group"),o&&s.classList.add(p+"base-group"),r.get("fold")&&(s.classList.add(p+"fold"),s.classList.add(p+r.get("fold")),(a=document.createElement("button")).onclick=function(e){e=e||window.event;f.toggleFold_(r,s),e.preventDefault()},s.appendChild(a)),o||"none"==n.groupSelectStyle||((a=document.createElement("input")).type="checkbox",a.id=l,a.checked=r.getVisible(),a.indeterminate=r.get("indeterminate"),a.onchange=function(e){e=e.target;f.setVisible_(t,r,e.checked,n.groupSelectStyle),i(r)},s.appendChild(a),c.htmlFor=l),c.innerHTML=u,s.appendChild(c),o=document.createElement("ul"),s.appendChild(o),f.renderLayers_(t,r,o,n,i)):(s.className="layer",a=document.createElement("input"),"base"===r.get("type")?a.type="radio":a.type="checkbox",a.id=l,a.checked=r.get("visible"),a.indeterminate=r.get("indeterminate"),a.onchange=function(e){e=e.target;f.setVisible_(t,r,e.checked,n.groupSelectStyle),i(r)},s.appendChild(a),c.htmlFor=l,c.innerHTML=u,((o=t.getView().getResolution())>=r.getMaxResolution()||o<r.getMinResolution()||r.getMinZoom&&r.getMaxZoom&&((a=t.getView().getZoom())<=r.getMinZoom()||a>r.getMaxZoom()))&&(c.className+=" disabled"),s.appendChild(c)),s}},{key:"renderLayers_",value:function(e,t,r,n,i){var o=t.getLayers().getArray().slice();n.reverse&&(o=o.reverse());for(var a,s=0;s<o.length;s++)(a=o[s]).get("title")&&r.appendChild(f.renderLayer_(e,a,s,n,i))}},{key:"forEachRecursive",value:function(e,n){e.getLayers().forEach(function(e,t,r){n(e,t,r),e instanceof h&&f.forEachRecursive(e,n)})}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}},{key:"enableTouchScroll_",value:function(e){var t;f.isTouchDevice_()&&(t=0,e.addEventListener("touchstart",function(e){t=this.scrollTop+e.touches[0].pageY},!1),e.addEventListener("touchmove",function(e){this.scrollTop=t-e.touches[0].pageY},!1))}},{key:"isTouchDevice_",value:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}},{key:"toggleFold_",value:function(e,t){t.classList.remove(p+e.get("fold")),e.set("fold","open"===e.get("fold")?"close":"open"),t.classList.add(p+e.get("fold"))}},{key:"getGroupSelectStyle",value:function(e){return 0<=["none","children","group"].indexOf(e)?e:"children"}}],(r=[{key:"setMap",value:function(e){for(var t=this,r=0;r<this.mapListeners.length;r++)o.unByKey(this.mapListeners[r]);this.mapListeners.length=0,s(c(f.prototype),"setMap",this).call(this,e),e&&(this.startActive?this.showPanel():this.renderPanel(),"click"!==this.activationMode)&&this.mapListeners.push(e.on("pointerdown",function(){t.hidePanel()}))}},{key:"showPanel",value:function(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.updateButton(),this.renderPanel()),this.dispatchEvent("show")}},{key:"hidePanel",value:function(){this.element.classList.contains(this.shownClassName)&&(this.element.classList.remove(this.shownClassName),this.updateButton()),this.dispatchEvent("hide")}},{key:"updateButton",value:function(){this.element.classList.contains(this.shownClassName)?(this.button.textContent=this.collapseLabel,this.button.setAttribute("title",this.collapseTipLabel),this.button.setAttribute("aria-label",this.collapseTipLabel)):(this.button.textContent=this.label,this.button.setAttribute("title",this.tipLabel),this.button.setAttribute("aria-label",this.tipLabel))}},{key:"renderPanel",value:function(){this.dispatchEvent("render"),f.renderPanel(this.getMap(),this.panel,{groupSelectStyle:this.groupSelectStyle,reverse:this.reverse}),this.dispatchEvent("rendercomplete")}}])&&a(e.prototype,r),t&&a(e,t),Object.defineProperty(e,"prototype",{writable:!1}),f}();return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=e),e},"object"===((n=void 0)===r?"undefined":i(r))&&void 0!==t?t.exports=o(e("ol/control/Control"),e("ol/Observable"),e("ol/layer/Group")):"function"==typeof define&&define.amd?define(["ol/control/Control","ol/Observable","ol/layer/Group"],o):n.LayerSwitcher=o(n.ol.control.Control,n.ol.Observable,n.ol.layer.Group)},{"ol/Observable":92,"ol/control/Control":111,"ol/layer/Group":253}],69:[function(e,A,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.apply=function(n,i,o){void 0===o&&(o={});var e;("string"==typeof n||n instanceof HTMLElement)&&(n=new F.default({target:n}));{var a;e="string"==typeof i?(a=i.startsWith("data:")?location.href:hr(i,o.accessToken),o=Xr(a,o),new Promise(function(t,r){_r(i,o).then(function(e){on(e,n,a,o).then(function(){t(n)}).catch(r)}).catch(function(e){r(new Error("Could not load "+i+": "+e.message))})})):new Promise(function(e,t){on(i,n,!o.styleUrl||o.styleUrl.startsWith("data:")?location.href:hr(o.styleUrl,o.accessToken),o).then(function(){e(n)}).catch(t)})}return e},t.applyBackground=function(t,e,r){void 0===r&&(r={});return"object"!==be(e)?_r(e,r).then(function(e){Jr(t,e,r)}):(Jr(t,e,r),Promise.resolve())},t.applyStyle=Zr,t.getFeatureState=function(e,t){for(var r=("getLayers"in e?sn(e,t.source):[e]),n=0,i=r.length;n<i;++n){var o=r[n].get("mapbox-featurestate");if(o&&o[t.id])return o[t.id]}return null},t.getLayer=function(e,t){for(var r=e.getLayers().getArray(),n=0,i=r.length;n<i;++n){var o=r[n].get("mapbox-layers");if(o&&-1!==o.indexOf(t))return r[n]}},t.getLayers=sn,t.getSource=function(e,t){for(var r=e.getLayers().getArray(),n=0,i=r.length;n<i;++n){var o=r[n].getSource();if(r[n].get("mapbox-source")===t)return o}},t.recordStyleLayer=function(e){void 0===e&&(e=!1);qr=e},t.renderTransparent=function(e){zr=e},t.setFeatureState=function(e,t,r){for(var n=("getLayers"in e?sn(e,t.source):[e]),i=0,o=n.length;i<o;++i){var a=n[i].get("mapbox-featurestate");if(!a)throw new Error('Map or layer for source "'+t.source+'" not found.');r?a[t.id]=r:delete a[t.id],n[i].changed()}},t.stylefunction=Yr;var we=r(e("ol/style/Circle.js")),xe=r(e("ol/style/Fill.js")),Se=r(e("ol/style/Icon.js")),je=r(e("ol/render/Feature.js")),Oe=r(e("ol/style/Stroke.js")),Pe=r(e("ol/style/Style.js")),ke=r(e("ol/style/Text.js")),L=e("ol/render/canvas.js"),t=r(e("ol/format/GeoJSON.js")),D=r(e("ol/format/MVT.js")),F=r(e("ol/Map.js")),N=r(e("ol/tilegrid/TileGrid.js")),B=r(e("ol/source/TileJSON.js")),G=r(e("ol/layer/Tile.js")),U=r(e("ol/layer/Vector.js")),z=r(e("ol/source/Vector.js")),W=r(e("ol/layer/VectorTile.js")),V=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==be(e)&&"function"!=typeof e)return{default:e};t=X(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("ol/source/VectorTile.js")),H=r(e("ol/View.js")),q=e("ol/tilegrid.js"),Y=e("ol/proj.js");function X(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(X=function(e){return e?r:t})(e))}function r(e){return e&&e.__esModule?e:{default:e}}function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Z,K={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function $(e){return(e=Math.round(e))<0?0:255<e?255:e}function J(e){return e<0?0:1<e?1:e}function Q(e){return"%"===e[e.length-1]?$(parseFloat(e)/100*255):$(parseInt(e))}function ee(e){return"%"===e[e.length-1]?J(parseFloat(e)/100):J(parseFloat(e))}function te(e,t,r){return r<0?r+=1:1<r&&--r,6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{Z={}.parseCSSColor=function(e){if((e=e.replace(/ /g,"").toLowerCase())in K)return K[e].slice();if("#"===e[0])return 4===e.length?0<=(t=parseInt(e.substr(1),16))&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===e.length&&0<=(t=parseInt(e.substr(1),16))&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var t=e.indexOf("("),r=e.indexOf(")");if(-1!==t&&r+1===e.length){var n,i,o,a=e.substr(0,t),s=e.substr(t+1,r-(t+1)).split(","),u=1;switch(a){case"rgba":if(4!==s.length)return null;u=ee(s.pop());case"rgb":return 3!==s.length?null:[Q(s[0]),Q(s[1]),Q(s[2]),u];case"hsla":if(4!==s.length)return null;u=ee(s.pop());case"hsl":return 3!==s.length?null:(n=(parseFloat(s[0])%360+360)%360/360,o=ee(s[1]),[$(255*te(o=2*(i=ee(s[2]))-(i=i<=.5?i*(o+1):i+o-i*o),i,n+1/3)),$(255*te(o,i,n)),$(255*te(o,i,n-1/3)),u]);default:return null}}return null}}catch(e){}var c=function(e,t,r,n){void 0===n&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n};function re(e){return"object"===be(e)?["literal",e]:e}function ne(e,t){if(!(o=e.stops))return i=t,O=["get",(r=e).property],void 0===r.default?"string"===i.type?["string",O]:O:"enum"===i.type?["match",O,Object.keys(i.values),O,r.default]:(O=["color"===i.type?"to-color":i.type,O,re(r.default)],"array"===i.type&&O.splice(1,0,i.value,i.length||null),O);var r=o&&"object"===be(o[0][0]),n=r||void 0!==e.property,i=r||!n,o=o.map(function(e){return!n&&t.tokens&&"string"==typeof e[1]?[e[0],function(e){for(var t=["concat"],r=/{([^{}]+)}/g,n=0,i=r.exec(e);null!==i;i=r.exec(e)){var o=e.slice(n,r.lastIndex-i[0].length);n=r.lastIndex,0<o.length&&t.push(o),t.push(["get",i[1]])}if(1===t.length)return e;if(n<e.length)t.push(e.slice(n));else if(2===t.length)return["to-string",t[1]];return t}(e[1])]:[e[0],re(e[1])]});if(r){for(var a=e,s=t,u=o,l={},c={},f=[],h=0;h<u.length;h++){var p=u[h],d=p[0].zoom;void 0===l[d]&&(l[d]={zoom:d,type:a.type,property:a.property,default:a.default},c[d]=[],f.push(d)),c[d].push([p[0].value,p[1]])}if("exponential"===le({},s)){for(var y=[ie(a),["linear"],["zoom"]],g=0,m=f;g<m.length;g+=1){var v=m[g],b=ae(l[v],s,c[v]);ue(y,v,b,!1)}return y}for(var _=["step",["zoom"]],w=0,x=f;w<x.length;w+=1){var S=x[w],j=ae(l[S],s,c[S]);ue(_,S,j,!0)}return se(_),_}if(i){var O=e,P=o,k=void 0;void 0===k&&(k=["zoom"]);var E,T=le(O,T=t),C=!1;if("interval"===T)E=["step",k],C=!0;else{if("exponential"!==T)throw new Error('Unknown zoom function type "'+T+'"');T=void 0!==O.base?O.base:1;E=[ie(O),1===T?["linear"]:["exponential",T],k]}for(var R=0,M=P;R<M.length;R+=1){var I=M[R];ue(E,I[0],I[1],C)}return se(E),E}return ae(e,t,o)}function ie(e){switch(e.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function oe(e,t){var r,e=re((e=e.default,r=t.default,void 0!==e?e:void 0!==r?r:void 0));return void 0===e&&"resolvedImage"===t.type?"":e}function ae(e,t,r){var n=le(e,t),i=["get",e.property];if("categorical"===n&&"boolean"==typeof r[0][0]){for(var o=["case"],a=0,s=r;a<s.length;a+=1){var u=s[a];o.push(["==",i,u[0]],u[1])}return o.push(oe(e,t)),o}if("categorical"===n){for(var l=["match",i],c=0,f=r;c<f.length;c+=1){var h=f[c];ue(l,h[0],h[1],!1)}return l.push(oe(e,t)),l}if("interval"===n){for(var p=["step",["number",i]],d=0,y=r;d<y.length;d+=1){var g=y[d];ue(p,g[0],g[1],!0)}return se(p),void 0===e.default?p:["case",["==",["typeof",i],"number"],p,re(e.default)]}if("exponential"!==n)throw new Error("Unknown property function type "+n);for(var t=void 0!==e.base?e.base:1,m=[ie(e),1===t?["linear"]:["exponential",t],["number",i]],v=0,b=r;v<b.length;v+=1){var _=b[v];ue(m,_[0],_[1],!1)}return void 0===e.default?m:["case",["==",["typeof",i],"number"],m,re(e.default)]}function se(e){"step"===e[0]&&3===e.length&&(e.push(0),e.push(e[3]))}function ue(e,t,r,n){3<e.length&&t===e[e.length-2]||(n&&2===e.length||e.push(t),e.push(r))}function le(e,t){return e.type||(t.expression.interpolated?"exponential":"interval")}c.parse=function(e){if(e){if(e instanceof c)return e;if("string"==typeof e){e=Z(e);if(e)return new c(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},c.prototype.toString=function(){var e=this.toArray(),t=e[0],r=e[1],n=e[2],e=e[3];return"rgba("+Math.round(t)+","+Math.round(r)+","+Math.round(n)+","+e+")"},c.prototype.toArray=function(){var e=this.r,t=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*r/n,n]},c.prototype.toArray01=function(){var e=this.r,t=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[e/n,t/n,r/n,n]},c.prototype.toArray01PremultipliedAlpha=function(){return[this.r,this.g,this.b,this.a]},c.black=new c(0,0,0,1),c.white=new c(1,1,1,1),c.transparent=new c(0,0,0,0),c.red=new c(1,0,0,1),c.blue=new c(0,0,1,1);function ce(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i[0],i=i[1];this.bindings[o]=i}}var a=function(r){function e(e,t){r.call(this,t),this.message=t,this.key=e}return r&&(e.__proto__=r),(e.prototype=Object.create(r&&r.prototype)).constructor=e}(Error),fe=(ce.prototype.concat=function(e){return new ce(this,e)},ce.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ce.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)},{kind:"null"}),d={kind:"number"},f={kind:"string"},h={kind:"boolean"},y={kind:"color"},he={kind:"object"},g={kind:"value"},pe={kind:"collator"},de={kind:"formatted"},ye={kind:"resolvedImage"};function p(e,t){return{kind:"array",itemType:e,N:t}}function S(e){var t;return"array"===e.kind?(t=S(e.itemType),"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"):e.kind}var ge=[fe,d,f,h,y,de,he,p(g),ye];function me(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!me(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,n=ge;r<n.length;r+=1)if(!me(n[r],t))return null}return"Expected "+S(e)+" but found "+S(t)+" instead."}function ve(t,e){return e.some(function(e){return e.kind===t.kind})}function Ee(t,e){return e.some(function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"===be(t):e===be(t)})}function Te(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale||[],{sensitivity:this.sensitivity,usage:"search"})}function Ce(e,t,r,n,i){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i}Te.prototype.compare=function(e,t){return this.collator.compare(e,t)},Te.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale||[]).resolvedOptions().locale};var m=function(e){this.sections=e},v=(m.fromString=function(e){return new m([new Ce(e,null,null,null,null)])},m.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length})},m.factory=function(e){return e instanceof m?e:m.fromString(e)},m.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(e){return e.text}).join("")},m.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n,i=r[t];i.image?e.push(["image",i.image.name]):(e.push(i.text),n={},i.fontStack&&(n["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(n["font-scale"]=i.scale),i.textColor&&(n["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(n))}return e},function(e){this.name=e.name,this.available=e.available});function Re(e,t,r,n){return"number"==typeof e&&0<=e&&e<=255&&"number"==typeof t&&0<=t&&t<=255&&"number"==typeof r&&0<=r&&r<=255?void 0===n||"number"==typeof n&&0<=n&&n<=1?null:"Invalid rgba value ["+[e,t,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Me(e){if(null===e)return 1;if("string"==typeof e)return 1;if("boolean"==typeof e)return 1;if("number"==typeof e)return 1;if(e instanceof c)return 1;if(e instanceof Te)return 1;if(e instanceof m)return 1;if(e instanceof v)return 1;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Me(r[t]))return;return 1}if("object"===be(e)){for(var n in e)if(!Me(e[n]))return;return 1}}function b(e){if(null===e)return fe;if("string"==typeof e)return f;if("boolean"==typeof e)return h;if("number"==typeof e)return d;if(e instanceof c)return y;if(e instanceof Te)return pe;if(e instanceof m)return de;if(e instanceof v)return ye;if(Array.isArray(e)){for(var t,r=e.length,n=0,i=e;n<i.length;n+=1){var o=b(i[n]);if(t){if(t!==o){t=g;break}}else t=o}return p(t||g,r)}return he}function Ie(e){var t=be(e);return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof c||e instanceof m||e instanceof v?e.toString():JSON.stringify(e)}v.prototype.toString=function(){return this.name},v.fromString=function(e){return e?new v({name:e,available:!1}):null},v.prototype.serialize=function(){return["image",this.name]};function s(e,t){this.type=e,this.value=t}function _(e){this.name="ExpressionEvaluationError",this.message=e}s.parse=function(e,t){var r,n;return 2!==e.length?t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead."):Me(e[1])?(r=b(e=e[1]),n=t.expectedType,"array"!==r.kind||0!==r.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(r=n),new s(r,e)):t.error("invalid value")},s.prototype.evaluate=function(){return this.value},s.prototype.eachChild=function(){},s.prototype.outputDefined=function(){return!0},s.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof c?["rgba"].concat(this.value.toArray()):this.value instanceof m?this.value.serialize():this.value};function w(e,t){this.type=e,this.args=t}function x(e){this.type=de,this.sections=e}function n(e){this.type=ye,this.input=e}function u(e,t){this.type=e,this.args=t}function l(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}_.prototype.toJSON=function(){return this.message};var Ae={string:f,number:d,boolean:h,object:he},Le=(w.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,n=1,i=e[0];if("array"===i){if(2<e.length){var o=e[1];if("string"!=typeof o||!(o in Ae)||"object"===o)return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=Ae[o],n++}else o=g;if(3<e.length){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);r=e[2],n++}o=p(o,r)}else o=Ae[i];for(var a=[];n<e.length;n++){var s=t.parse(e[n],n,g);if(!s)return null;a.push(s)}return new w(o,a)},w.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!me(this.type,b(r)))return r;if(t===this.args.length-1)throw new _("Expected value to be of type "+S(this.type)+", but found "+S(b(r))+" instead.")}return null},w.prototype.eachChild=function(e){this.args.forEach(e)},w.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},w.prototype.serialize=function(){var e,t=this.type,r=[t.kind];return"array"===t.kind&&("string"===(e=t.itemType).kind||"number"===e.kind||"boolean"===e.kind)&&(r.push(e.kind),"number"==typeof(e=t.N)||1<this.args.length)&&r.push(e),r.concat(this.args.map(function(e){return e.serialize()}))},x.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"===be(r))return t.error("First argument must be an image or text section.");for(var n=[],i=!1,o=1;o<=e.length-1;++o){var a=e[o];if(i&&"object"===be(a)&&!Array.isArray(a)){var i=!1,s=null;if(a["font-scale"]&&!(s=t.parse(a["font-scale"],1,d)))return null;var u=null;if(a["text-font"]&&!(u=t.parse(a["text-font"],1,p(f))))return null;var l=null;if(a["text-color"]&&!(l=t.parse(a["text-color"],1,y)))return null;a=n[n.length-1];a.scale=s,a.font=u,a.textColor=l}else{s=t.parse(e[o],1,g);if(!s)return null;u=s.type.kind;if("string"!==u&&"value"!==u&&"null"!==u&&"resolvedImage"!==u)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:s,scale:null,font:null,textColor:null})}}return new x(n)},x.prototype.evaluate=function(r){return new m(this.sections.map(function(e){var t=e.content.evaluate(r);return b(t)===ye?new Ce("",t,null,null,null):new Ce(Ie(t),null,e.scale?e.scale.evaluate(r):null,e.font?e.font.evaluate(r).join(","):null,e.textColor?e.textColor.evaluate(r):null)}))},x.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}},x.prototype.outputDefined=function(){return!1},x.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t],i=(e.push(n.content.serialize()),{});n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),e.push(i)}return e},n.parse=function(e,t){return 2!==e.length?t.error("Expected two arguments."):(e=t.parse(e[1],1,f))?new n(e):t.error("No image name provided.")},n.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=v.fromString(t);return r&&e.availableImages&&(r.available=-1<e.availableImages.indexOf(t)),r},n.prototype.eachChild=function(e){e(this.input)},n.prototype.outputDefined=function(){return!1},n.prototype.serialize=function(){return["image",this.input.serialize()]},{"to-boolean":h,"to-color":y,"to-number":d,"to-string":f}),De=(u.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var r=Le[r],n=[],i=1;i<e.length;i++){var o=t.parse(e[i],i,g);if(!o)return null;n.push(o)}return new u(r,n)},u.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t=0,r=this.args;t<r.length;t+=1){var n,i=null;if((n=r[t].evaluate(e))instanceof c)return n;if("string"==typeof n){var o=e.parseColor(n);if(o)return o}else if(Array.isArray(n)&&!(i=n.length<3||4<n.length?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":Re(n[0],n[1],n[2],n[3])))return new c(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new _(i||"Could not parse color from value '"+("string"==typeof n?n:String(JSON.stringify(n)))+"'")}if("number"!==this.type.kind)return"formatted"===this.type.kind?m.fromString(Ie(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?v.fromString(Ie(this.args[0].evaluate(e))):Ie(this.args[0].evaluate(e));for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(e)))return 0;var l=Number(a);if(!isNaN(l))return l}throw new _("Could not convert "+JSON.stringify(a)+" to number.")},u.prototype.eachChild=function(e){this.args.forEach(e)},u.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},u.prototype.serialize=function(){var t;return"formatted"===this.type.kind?new x([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize():"resolvedImage"===this.type.kind?new n(this.args[0]).serialize():(t=["to-"+this.type.kind],this.eachChild(function(e){t.push(e.serialize())}),t)},["Unknown","Point","LineString","Polygon"]),j=(l.prototype.id=function(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null},l.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?De[this.feature.type]:this.feature.type:null},l.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},l.prototype.canonicalID=function(){return this.canonical},l.prototype.properties=function(){return this.feature&&this.feature.properties||{}},l.prototype.distanceFromCenter=function(){var e,t,r,n;return this.featureTileCoord&&this.featureDistanceData?(e=this.featureDistanceData.center,t=this.featureDistanceData.scale,r=(n=this.featureTileCoord).x,n=n.y,r=r*t-e[0],n=n*t-e[1],this.featureDistanceData.bearing[0]*r+this.featureDistanceData.bearing[1]*n):0},l.prototype.parseColor=function(e){return this._parseColorCache[e]||(this._parseColorCache[e]=c.parse(e))},function(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n});j.prototype.evaluate=function(e){return this._evaluate(e,this.args)},j.prototype.eachChild=function(e){this.args.forEach(e)},j.prototype.outputDefined=function(){return!1},j.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},j.parse=function(t,e){var r=t[0],n=j.definitions[r];if(!n)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(n)?n[0]:n.type,n=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=n.filter(function(e){e=e[0];return!Array.isArray(e)||e.length===t.length-1}),a=null,s=0,u=o;s<u.length;s+=1){for(var l=u[s],c=l[0],l=l[1],a=new T(e.registry,e.path,null,e.scope),f=[],h=!1,p=1;p<t.length;p++){var d=t[p],y=Array.isArray(c)?c[p-1]:c.type,d=a.parse(d,1+f.length,y);if(!d){h=!0;break}f.push(d)}if(!h)if(Array.isArray(c)&&c.length!==f.length)a.error("Expected "+c.length+" arguments, but found "+f.length+" instead.");else{for(var g=0;g<f.length;g++){var m=Array.isArray(c)?c[g]:c.type,v=f[g];a.concat(g+1).checkSubtype(m,v.type)}if(0===a.errors.length)return new j(r,i,l,f)}}if(1===o.length)(b=e.errors).push.apply(b,a.errors);else{for(var b=(o.length?o:n).map(function(e){var e=e[0];return e=e,Array.isArray(e)?"("+e.map(S).join(", ")+")":"("+S(e.type)+"...)"}).join(" | "),_=[],w=1;w<t.length;w++){var x=e.parse(t[w],1+_.length);if(!x)return null;_.push(S(x.type))}e.error("Expected arguments of type "+b+", but found ("+_.join(", ")+") instead.")}return null},j.register=function(e,t){for(var r in j.definitions=t)e[r]=j};function O(e,t,r){this.type=pe,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}O.parse=function(e,t){var r,n,i;return 2!==e.length?t.error("Expected one argument."):"object"!==be(e=e[1])||Array.isArray(e)?t.error("Collator options argument must be an object."):!(r=t.parse(void 0!==e["case-sensitive"]&&e["case-sensitive"],1,h))||!(n=t.parse(void 0!==e["diacritic-sensitive"]&&e["diacritic-sensitive"],1,h))||(i=null,e.locale&&!(i=t.parse(e.locale,1,f)))?null:new O(r,n,i)},O.prototype.evaluate=function(e){return new Te(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},O.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},O.prototype.outputDefined=function(){return!1},O.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var P=8192;function Fe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ne(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Be(e,t){var r=(180+e[0])/360,e=(e=e[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360),t=Math.pow(2,t.z);return[Math.round(r*t*P),Math.round(e*t*P)]}function Ge(e,t){for(var r,n,i,o,a,s=!1,u=0,l=t.length;u<l;u++)for(var c=t[u],f=0,h=c.length;f<h-1;f++){if(r=e,n=c[f],i=c[f+1],a=o=void 0,o=r[0]-n[0],n=r[1]-n[1],a=r[0]-i[0],r=r[1]-i[1],o*r-a*n==0&&o*a<=0&&n*r<=0)return;i=e,o=c[f],a=c[f+1],o[1]>i[1]!=a[1]>i[1]&&i[0]<(a[0]-o[0])*(i[1]-o[1])/(a[1]-o[1])+o[0]&&(s=!s)}return s}function Ue(e,t,r,n){var i=e[0]-r[0],e=e[1]-r[1],o=t[0]-r[0],t=t[1]-r[1],a=n[0]-r[0],n=n[1]-r[1],r=i*n-a*e,i=o*n-a*t;return 0<r&&i<0||r<0&&0<i}function ze(e,t,r){for(var n,i,o,a,s,u,l=0,c=r;l<c.length;l+=1)for(var f=c[l],h=0;h<f.length-1;++h)if(n=e,i=t,o=f[h],a=f[h+1],u=s=void 0,s=[i[0]-n[0],i[1]-n[1]],0!=(u=[a[0]-o[0],a[1]-o[1]])[0]*s[1]-u[1]*s[0]&&!(!Ue(n,i,o,a)||!Ue(o,a,n,i)))return 1}function We(e,t){for(var r=0;r<e.length;++r)if(!Ge(e[r],t))return;for(var n=0;n<e.length-1;++n)if(ze(e[n],e[n+1],t))return;return 1}function Ve(e,t,r){for(var n=[],i=0;i<e.length;i++){for(var o=[],a=0;a<e[i].length;a++){var s=Be(e[i][a],r);Fe(t,s),o.push(s)}n.push(o)}return n}function He(e,t,r){for(var n=[],i=0;i<e.length;i++){var o=Ve(e[i],t,r);n.push(o)}return n}function qe(e,t,r,n){var i,o;(e[0]<r[0]||e[0]>r[2])&&(0===(o=e[0]-r[0]>(i=.5*n)?-n:r[0]-e[0]>i?n:0)&&(o=e[0]-r[2]>i?-n:r[2]-e[0]>i?n:0),e[0]+=o),Fe(t,e)}function Ye(e,t,r,n){var i=Math.pow(2,n.z)*P,o=[n.x*P,n.y*P],a=[];if(e)for(var s=0,u=e;s<u.length;s+=1)for(var l=0,c=u[s];l<c.length;l+=1){var f=c[l],f=[f.x+o[0],f.y+o[1]];qe(f,t,r,i),a.push(f)}return a}function Xe(e,t,r,n){var i=Math.pow(2,n.z)*P,o=[n.x*P,n.y*P],a=[];if(e){for(var s=0,u=e;s<u.length;s+=1){for(var l=[],c=0,f=u[s];c<f.length;c+=1){var h=f[c],h=[h.x+o[0],h.y+o[1]];Fe(t,h),l.push(h)}a.push(l)}if(t[2]-t[0]<=i/2){(n=t)[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(var p=0,d=a;p<d.length;p+=1)for(var y=0,g=d[p];y<g.length;y+=1)qe(g[y],t,r,i)}}return a}function Ze(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){var o=Ve(t.coordinates,n,i),a=Ye(e.geometry(),r,n,i);if(!Ne(r,n))return!1;for(var s=0,u=a;s<u.length;s+=1)if(!Ge(u[s],o))return!1}if("MultiPolygon"===t.type){var l=He(t.coordinates,n,i),a=Ye(e.geometry(),r,n,i);if(!Ne(r,n))return!1;for(var c=0,f=a;c<f.length;c+=1)if(!function(e,t){for(var r=0;r<t.length;r++)if(Ge(e,t[r]))return 1}(f[c],l))return!1}return!0}function Ke(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){var o=Ve(t.coordinates,n,i),a=Xe(e.geometry(),r,n,i);if(!Ne(r,n))return!1;for(var s=0,u=a;s<u.length;s+=1)if(!We(u[s],o))return!1}if("MultiPolygon"===t.type){var l=He(t.coordinates,n,i),a=Xe(e.geometry(),r,n,i);if(!Ne(r,n))return!1;for(var c=0,f=a;c<f.length;c+=1)if(!function(e,t){for(var r=0;r<t.length;r++)if(We(e,t[r]))return 1}(f[c],l))return!1}return!0}var k=function(e,t){this.type=h,this.geojson=e,this.geometries=t};function $e(e){if(e instanceof j){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}var t;return!(e instanceof k)&&(t=!0,e.eachChild(function(e){t&&!$e(e)&&(t=!1)}),t)}function Je(e){var t;if(!(e instanceof j&&"feature-state"===e.name))return t=!0,e.eachChild(function(e){t&&!Je(e)&&(t=!1)}),t}function Qe(e,t){var r;return!(e instanceof j&&0<=t.indexOf(e.name))&&(r=!0,e.eachChild(function(e){r&&!Qe(e,t)&&(r=!1)}),r)}k.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Me(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var n=0;n<r.features.length;++n){var i=r.features[n].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new k(r,r.features[n].geometry)}else if("Feature"===r.type){e=r.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new k(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new k(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},k.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return Ze(e,this.geometries);if("LineString"===e.geometryType())return Ke(e,this.geometries)}return!1},k.prototype.eachChild=function(){},k.prototype.outputDefined=function(){return!0},k.prototype.serialize=function(){return["within",this.geojson]};function E(e,t){this.type=t.type,this.name=e,this.boundExpression=t}E.parse=function(e,t){return 2!==e.length||"string"!=typeof e[1]?t.error("'var' expression requires exactly one string literal argument."):(e=e[1],t.scope.has(e)?new E(e,t.scope.get(e)):t.error('Unknown variable "'+e+'". Make sure "'+e+'" has been bound in an enclosing "let" expression before using it.',1))},E.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},E.prototype.eachChild=function(){},E.prototype.outputDefined=function(){return!1},E.prototype.serialize=function(){return["var",this.name]};var T=function(e,t,r,n,i){void 0===t&&(t=[]),void 0===n&&(n=new ce),void 0===i&&(i=[]),this.registry=e,this.path=t,this.key=t.map(function(e){return"["+e+"]"}).join(""),this.scope=n,this.errors=i,this.expectedType=r};function et(e,t){for(var r,n,i,o=e.length-1,a=0,s=o;a<=s;)if(n=e[r=Math.floor((a+s)/2)],i=e[r+1],n<=t){if(r===o||t<i)return r;a=r+1}else{if(!(t<n))throw new _("Input is not a number.");s=r-1}return 0}T.prototype.parse=function(e,t,r,n,i){return void 0===i&&(i={}),(t?this.concat(t,r,n):this)._parse(e,i)},T.prototype._parse=function(e,t){function r(e,t,r){return"assert"===r?new w(t,[e]):"coerce"===r?new u(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+be(n)+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[n];if(i){i=i.parse(e,this);if(!i)return null;if(this.expectedType){var o=this.expectedType,a=i.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind&&"array"!==o.kind||"value"!==a.kind)if("color"!==o.kind&&"formatted"!==o.kind&&"resolvedImage"!==o.kind||"value"!==a.kind&&"string"!==a.kind){if(this.checkSubtype(o,a))return null}else i=r(i,o,t.typeAnnotation||"coerce");else i=r(i,o,t.typeAnnotation||"assert")}if(!(i instanceof s)&&"resolvedImage"!==i.type.kind&&function t(e){{if(e instanceof E)return t(e.boundExpression);if(e instanceof j&&"error"===e.name)return!1;if(e instanceof O)return!1;if(e instanceof k)return!1}var r=e instanceof u||e instanceof w;var n=!0;e.eachChild(function(e){n=r?n&&t(e):n&&e instanceof s});if(!n)return!1;return $e(e)&&Qe(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}(i)){a=new l;try{i=new s(i.type,i.evaluate(a))}catch(e){return this.error(e.message),null}}return i}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"===be(e)?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+be(e)+" instead.")},T.prototype.concat=function(e,t,r){e="number"==typeof e?this.path.concat(e):this.path,r=r?this.scope.concat(r):this.scope;return new T(this.registry,e,t||null,r,this.errors)},T.prototype.error=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];var n=""+this.key+t.map(function(e){return"["+e+"]"}).join("");this.errors.push(new a(n,e))},T.prototype.checkSubtype=function(e,t){e=me(e,t);return e&&this.error(e),e};var C=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n],a=o[0],o=o[1];this.labels.push(a),this.outputs.push(o)}},tt=(C.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,d);if(!r)return null;var n=[],i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(var o=1;o<e.length;o+=2){var a=1===o?-1/0:e[o],s=e[o+1],u=o,l=o+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(n.length&&n[n.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);u=t.parse(s,l,i);if(!u)return null;i=i||u.type,n.push([a,u])}return new C(i,r,n)},C.prototype.evaluate=function(e){var t,r,n=this.labels,i=this.outputs;return(1===n.length||(t=this.input.evaluate(e))<=n[0]?i[0]:t>=n[(r=n.length)-1]?i[r-1]:i[et(n,t)]).evaluate(e)},C.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},C.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},C.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)0<t&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e},rt);function rt(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=r,this.p2y=n}function o(e,t,r){return e*(1-r)+t*r}rt.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},rt.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},rt.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},rt.prototype.solveCurveX=function(e,t){var r,n,i,o,a;for(void 0===t&&(t=1e-6),i=e,a=0;a<8;a++){if(o=this.sampleCurveX(i)-e,Math.abs(o)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=e)<(r=0))return r;if((n=1)<i)return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-e)<t)return i;o<e?r=i:n=i,i=.5*(n-r)+r}return i},rt.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var nt=Object.freeze({__proto__:null,number:o,color:function(e,t,r){return new c(o(e.r,t.r,r),o(e.g,t.g,r),o(e.b,t.b,r),o(e.a,t.a,r))},array:function(e,r,n){return e.map(function(e,t){return o(e,r[t],n)})}}),it=4/29,ot=6/29,at=3*ot*ot,st=ot*ot*ot,ut=Math.PI/180,lt=180/Math.PI;function ct(e){return st<e?Math.pow(e,1/3):e/at+it}function ft(e){return ot<e?e*e*e:at*(e-it)}function ht(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function pt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function dt(e){var t=pt(e.r),r=pt(e.g),n=pt(e.b),i=ct((.4124564*t+.3575761*r+.1804375*n)/.95047),o=ct(.2126729*t+.7151522*r+.072175*n);return{l:116*o-16,a:500*(i-o),b:200*(o-ct((.0193339*t+.119192*r+.9503041*n)/1.08883)),alpha:e.a}}function yt(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200,t=+ft(t),r=.95047*ft(r),n=1.08883*ft(n);return new c(ht(3.2404542*r-1.5371385*t-.4985314*n),ht(-.969266*r+1.8760108*t+.041556*n),ht(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}var gt={forward:dt,reverse:yt,interpolate:function(e,t,r){return{l:o(e.l,t.l,r),a:o(e.a,t.a,r),b:o(e.b,t.b,r),alpha:o(e.alpha,t.alpha,r)}}},mt={forward:function(e){var t=(n=dt(e)).l,r=n.a,n=n.b,i=Math.atan2(n,r)*lt;return{h:i<0?360+i:i,c:Math.sqrt(r*r+n*n),l:t,alpha:e.a}},reverse:function(e){var t=e.h*ut,r=e.c;return yt({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:(n=e.h,i=t.h,n+r*(180<(i-=n)||i<-180?i-360*Math.round(i/360):i)),c:o(e.c,t.c,r),l:o(e.l,t.l,r),alpha:o(e.alpha,t.alpha,r)};var n,i}},R=function(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],s=s[1];this.labels.push(u),this.outputs.push(s)}};function vt(e,t,r,n){n-=r,e-=r;return 0==n?0:1===t?e/n:(Math.pow(t,e)-1)/(Math.pow(t,n)-1)}R.interpolationFactor=function(e,t,r,n){var i=0;return"exponential"===e.name?i=vt(t,e.base,r,n):"linear"===e.name?i=vt(t,1,r,n):"cubic-bezier"===e.name&&(e=e.controlPoints,i=new tt(e[0],e[1],e[2],e[3]).solve(vt(t,1,r,n))),i},R.parse=function(e,t){var r=e[0],n=e[1],i=e[2],o=e.slice(3);if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var a=n[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:a}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type "+String(n[0]),1,0);a=n.slice(1);if(4!==a.length||a.some(function(e){return"number"!=typeof e||e<0||1<e}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:a}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(i=t.parse(i,2,d)))return null;var s=[],u=null;"interpolate-hcl"===r||"interpolate-lab"===r?u=y:t.expectedType&&"value"!==t.expectedType.kind&&(u=t.expectedType);for(var l=0;l<o.length;l+=2){var c=o[l],f=o[l+1],h=l+3,p=l+4;if("number"!=typeof c)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(s.length&&s[s.length-1][0]>=c)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',h);h=t.parse(f,p,u);if(!h)return null;u=u||h.type,s.push([c,h])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new R(u,r,n,i,s):t.error("Type "+S(u)+" is not interpolatable.")},R.prototype.evaluate=function(e){var t,r,n,i=this.labels,o=this.outputs;return 1===i.length||(r=this.input.evaluate(e))<=i[0]?o[0].evaluate(e):r>=i[(t=i.length)-1]?o[t-1].evaluate(e):(n=i[t=et(i,r)],i=i[t+1],r=R.interpolationFactor(this.interpolation,r,n,i),n=o[t].evaluate(e),i=o[t+1].evaluate(e),"interpolate"===this.operator?nt[this.type.kind.toLowerCase()](n,i,r):"interpolate-hcl"===this.operator?mt.reverse(mt.interpolate(mt.forward(n),mt.forward(i),r)):gt.reverse(gt.interpolate(gt.forward(n),gt.forward(i),r)))},R.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},R.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},R.prototype.serialize=function(){for(var e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};function bt(e,t,r){this.type=e,this.index=t,this.input=r}function _t(e,t){this.type=h,this.needle=e,this.haystack=t}function i(e,t,r){this.type=d,this.needle=e,this.haystack=t,this.fromIndex=r}function wt(e,t,r,n,i,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o}function xt(e,t,r){this.type=e,this.branches=t,this.otherwise=r}function M(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}var I=function(e,t){this.type=e,this.args=t},St=(I.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");for(var r=null,n=t.expectedType,i=(n&&"value"!==n.kind&&(r=n),[]),o=0,a=e.slice(1);o<a.length;o+=1){var s=a[o],s=t.parse(s,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,i.push(s)}e=n&&i.some(function(e){return me(n,e.type)});return new I(e?g:r,i)},I.prototype.evaluate=function(e){for(var t,r=null,n=0,i=0,o=this.args;i<o.length;i+=1){var a=o[i];if(n++,(r=a.evaluate(e))&&r instanceof v&&!r.available&&(t=t||r,r=null,n===this.args.length))return t;if(null!==r)break}return r},I.prototype.eachChild=function(e){this.args.forEach(e)},I.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},I.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t},function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t});St.prototype.evaluate=function(e){return this.result.evaluate(e)},St.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},St.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],n=1;n<e.length-1;n+=2){var i=e[n];if("string"!=typeof i)return t.error("Expected string, but found "+be(i)+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);var o=t.parse(e[n+1],n+1);if(!o)return null;r.push([i,o])}var a=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return a?new St(r,a):null},St.prototype.outputDefined=function(){return this.result.outputDefined()},St.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var n=r[t],i=n[0],n=n[1];e.push(i,n.serialize())}return e.push(this.result.serialize()),e},bt.parse=function(e,t){var r;return 3!==e.length?t.error("Expected 2 arguments, but found "+(e.length-1)+" instead."):(r=t.parse(e[1],1,d),e=t.parse(e[2],2,p(t.expectedType||g)),r&&e?(t=e.type,new bt(t.itemType,r,e)):null)},bt.prototype.evaluate=function(e){var t=this.index.evaluate(e),e=this.input.evaluate(e);if(t<0)throw new _("Array index out of bounds: "+t+" < 0.");if(t>=e.length)throw new _("Array index out of bounds: "+t+" > "+(e.length-1)+".");if(t!==Math.floor(t))throw new _("Array index must be an integer, but found "+t+" instead.");return e[t]},bt.prototype.eachChild=function(e){e(this.index),e(this.input)},bt.prototype.outputDefined=function(){return!1},bt.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]},_t.parse=function(e,t){var r;return 3!==e.length?t.error("Expected 2 arguments, but found "+(e.length-1)+" instead."):(r=t.parse(e[1],1,g),e=t.parse(e[2],2,g),r&&e?ve(r.type,[h,f,d,fe,g])?new _t(r,e):t.error("Expected first argument to be of type boolean, string, number or null, but found "+S(r.type)+" instead"):null)},_t.prototype.evaluate=function(e){var t=this.needle.evaluate(e),e=this.haystack.evaluate(e);if(null==e)return!1;if(!Ee(t,["boolean","string","number","null"]))throw new _("Expected first argument to be of type boolean, string, number or null, but found "+S(b(t))+" instead.");if(Ee(e,["string","array"]))return 0<=e.indexOf(t);throw new _("Expected second argument to be of type array or string, but found "+S(b(e))+" instead.")},_t.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},_t.prototype.outputDefined=function(){return!0},_t.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]},i.parse=function(e,t){var r,n;return e.length<=2||5<=e.length?t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead."):(r=t.parse(e[1],1,g),n=t.parse(e[2],2,g),r&&n?ve(r.type,[h,f,d,fe,g])?4===e.length?(e=t.parse(e[3],3,d))?new i(r,n,e):null:new i(r,n):t.error("Expected first argument to be of type boolean, string, number or null, but found "+S(r.type)+" instead"):null)},i.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Ee(t,["boolean","string","number","null"]))throw new _("Expected first argument to be of type boolean, string, number or null, but found "+S(b(t))+" instead.");if(Ee(r,["string","array"]))return this.fromIndex?(e=this.fromIndex.evaluate(e),r.indexOf(t,e)):r.indexOf(t);throw new _("Expected second argument to be of type array or string, but found "+S(b(r))+" instead.")},i.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},i.prototype.outputDefined=function(){return!1},i.prototype.serialize=function(){var e;return null!=this.fromIndex&&void 0!==this.fromIndex?(e=this.fromIndex.serialize(),["index-of",this.needle.serialize(),this.haystack.serialize(),e]):["index-of",this.needle.serialize(),this.haystack.serialize()]},wt.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var r,n,i={},o=[],a=2;a<e.length-1;a+=2){var s=e[a],u=e[a+1],l=(Array.isArray(s)||(s=[s]),t.concat(a));if(0===s.length)return l.error("Expected at least one branch label.");for(var c=0,f=s;c<f.length;c+=1){var h=f[c];if("number"!=typeof h&&"string"!=typeof h)return l.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return l.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return l.error("Numeric branch labels must be integer values.");if(r){if(l.checkSubtype(r,b(h)))return null}else r=b(h);if(void 0!==i[String(h)])return l.error("Branch labels must be unique.");i[String(h)]=o.length}s=t.parse(u,a,n);if(!s)return null;n=n||s.type,o.push(s)}var p,d=t.parse(e[1],1,g);return!d||!(p=t.parse(e[e.length-1],e.length-1,n))||"value"!==d.type.kind&&t.concat(1).checkSubtype(r,d.type)?null:new wt(r,n,d,i,o,p)},wt.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(b(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},wt.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},wt.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},wt.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],n={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i];void 0===(f=n[this.cases[a]])?(n[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[f][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,l=r;u<l.length;u+=1){var c=l[u],f=c[0],c=c[1];1===c.length?e.push(s(c[0])):e.push(c.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e},xt.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var r,n=[],i=1;i<e.length-1;i+=2){var o=t.parse(e[i],i,h);if(!o)return null;var a=t.parse(e[i+1],i+1,r);if(!a)return null;n.push([o,a]),r=r||a.type}var s=t.parse(e[e.length-1],e.length-1,r);return s?new xt(r,n,s):null},xt.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],i=n[0],n=n[1];if(i.evaluate(e))return n.evaluate(e)}return this.otherwise.evaluate(e)},xt.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],i=n[0],n=n[1];e(i),e(n)}e(this.otherwise)},xt.prototype.outputDefined=function(){return this.branches.every(function(e){return e[0],e[1].outputDefined()})&&this.otherwise.outputDefined()},xt.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};function jt(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Ot(e,t,r,n){return 0===n.compare(t,r)}function Pt(a,s,u){var l="=="!==a&&"!="!==a;return function(){function o(e,t,r){this.type=h,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return o.parse=function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var r=e[0],n=t.parse(e[1],1,g);if(!n)return null;if(!jt(r,n.type))return t.concat(1).error('"'+r+"\" comparisons are not supported for type '"+S(n.type)+"'.");var i=t.parse(e[2],2,g);if(!i)return null;if(!jt(r,i.type))return t.concat(2).error('"'+r+"\" comparisons are not supported for type '"+S(i.type)+"'.");if(n.type.kind!==i.type.kind&&"value"!==n.type.kind&&"value"!==i.type.kind)return t.error("Cannot compare types '"+S(n.type)+"' and '"+S(i.type)+"'.");l&&("value"===n.type.kind&&"value"!==i.type.kind?n=new w(i.type,[n]):"value"!==n.type.kind&&"value"===i.type.kind&&(i=new w(n.type,[i])));r=null;if(4===e.length){if("string"!==n.type.kind&&"string"!==i.type.kind&&"value"!==n.type.kind&&"value"!==i.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(r=t.parse(e[3],3,pe)))return null}return new o(n,i,r)},o.prototype.evaluate=function(e){var t=this.lhs.evaluate(e),r=this.rhs.evaluate(e);if(l&&this.hasUntypedArgument){var n=b(t),i=b(r);if(n.kind!==i.kind||"string"!==n.kind&&"number"!==n.kind)throw new _('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+n.kind+", "+i.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){n=b(t),i=b(r);if("string"!==n.kind||"string"!==i.kind)return s(e,t,r)}return this.collator?u(e,t,r,this.collator.evaluate(e)):s(e,t,r)},o.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},o.prototype.outputDefined=function(){return!0},o.prototype.serialize=function(){var t=[a];return this.eachChild(function(e){t.push(e.serialize())}),t},o}()}M.parse=function(e,t){var r,n;return e.length<=2||5<=e.length?t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead."):(r=t.parse(e[1],1,g),n=t.parse(e[2],2,d),r&&n?ve(r.type,[p(g),f,g])?4===e.length?(e=t.parse(e[3],3,d))?new M(r.type,r,n,e):null:new M(r.type,r,n):t.error("Expected first argument to be of type array or string, but found "+S(r.type)+" instead"):null)},M.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(Ee(t,["string","array"]))return this.endIndex?(e=this.endIndex.evaluate(e),t.slice(r,e)):t.slice(r);throw new _("Expected first argument to be of type array or string, but found "+S(b(t))+" instead.")},M.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},M.prototype.outputDefined=function(){return!1},M.prototype.serialize=function(){var e;return null!=this.endIndex&&void 0!==this.endIndex?(e=this.endIndex.serialize(),["slice",this.input.serialize(),this.beginIndex.serialize(),e]):["slice",this.input.serialize(),this.beginIndex.serialize()]};function kt(e,t,r,n,i){this.type=f,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}function Et(e){this.type=d,this.input=e}var e=Pt("==",function(e,t,r){return t===r},Ot),Tt=Pt("!=",function(e,t,r){return t!==r},function(e,t,r,n){return!Ot(0,t,r,n)}),Ct=Pt("<",function(e,t,r){return t<r},function(e,t,r,n){return n.compare(t,r)<0}),Rt=Pt(">",function(e,t,r){return r<t},function(e,t,r,n){return 0<n.compare(t,r)}),Mt=Pt("<=",function(e,t,r){return t<=r},function(e,t,r,n){return n.compare(t,r)<=0}),It=Pt(">=",function(e,t,r){return r<=t},function(e,t,r,n){return 0<=n.compare(t,r)}),At=(kt.parse=function(e,t){var r,n,i,o,a;return 3!==e.length?t.error("Expected two arguments."):(r=t.parse(e[1],1,d))?"object"!==be(e=e[2])||Array.isArray(e)?t.error("NumberFormat options argument must be an object."):(n=null,e.locale&&!(n=t.parse(e.locale,1,f))||(i=null,e.currency&&!(i=t.parse(e.currency,1,f)))||(o=null,e["min-fraction-digits"]&&!(o=t.parse(e["min-fraction-digits"],1,d)))||(a=null,e["max-fraction-digits"]&&!(a=t.parse(e["max-fraction-digits"],1,d)))?null:new kt(r,n,i,o,a)):null},kt.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},kt.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},kt.prototype.outputDefined=function(){return!1},kt.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]},Et.parse=function(e,t){return 2!==e.length?t.error("Expected 1 argument, but found "+(e.length-1)+" instead."):(e=t.parse(e[1],1))?"array"!==e.type.kind&&"string"!==e.type.kind&&"value"!==e.type.kind?t.error("Expected argument of type string or array, but found "+S(e.type)+" instead."):new Et(e):null},Et.prototype.evaluate=function(e){e=this.input.evaluate(e);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new _("Expected value to be of type string or array, but found "+S(b(e))+" instead.")},Et.prototype.eachChild=function(e){e(this.input)},Et.prototype.outputDefined=function(){return!1},Et.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t},{"==":e,"!=":Tt,">":Rt,"<":Ct,">=":It,"<=":Mt,array:w,at:bt,boolean:w,case:xt,coalesce:I,collator:O,format:x,image:n,in:_t,"index-of":i,interpolate:R,"interpolate-hcl":R,"interpolate-lab":R,length:Et,let:St,literal:s,match:wt,number:w,"number-format":kt,object:w,slice:M,step:C,string:w,"to-boolean":u,"to-color":u,"to-number":u,"to-string":u,var:E,within:k});function Lt(e,t){var r=t[0],n=t[1],i=t[2],t=t[3],r=r.evaluate(e),n=n.evaluate(e),i=i.evaluate(e),t=t?t.evaluate(e):1,e=Re(r,n,i,t);if(e)throw new _(e);return new c(r/255*t,n/255*t,i/255*t,t)}function Dt(e,t){t=t[e];return void 0===t?null:t}function Ft(e){return{type:e}}function Nt(e){return{result:"success",value:e}}function Bt(e){return{result:"error",value:e}}function Gt(e){return"object"===be(e)&&null!==e&&!Array.isArray(e)}j.register(At,{error:[{kind:"error"},[f],function(e,t){t=t[0];throw new _(t.evaluate(e))}],typeof:[f,[g],function(e,t){return S(b(t[0].evaluate(e)))}],"to-rgba":[p(d,4),[y],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[y,[d,d,d],Lt],rgba:[y,[d,d,d,d],Lt],has:{type:h,overloads:[[[f],function(e,t){return t[0].evaluate(e)in e.properties()}],[[f,he],function(e,t){var r=t[0],t=t[1];return r.evaluate(e)in t.evaluate(e)}]]},get:{type:g,overloads:[[[f],function(e,t){return Dt(t[0].evaluate(e),e.properties())}],[[f,he],function(e,t){var r=t[0],t=t[1];return Dt(r.evaluate(e),t.evaluate(e))}]]},"feature-state":[g,[f],function(e,t){return Dt(t[0].evaluate(e),e.featureState||{})}],properties:[he,[],function(e){return e.properties()}],"geometry-type":[f,[],function(e){return e.geometryType()}],id:[g,[],function(e){return e.id()}],zoom:[d,[],function(e){return e.globals.zoom}],pitch:[d,[],function(e){return e.globals.pitch||0}],"distance-from-center":[d,[],function(e){return e.distanceFromCenter()}],"heatmap-density":[d,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[d,[],function(e){return e.globals.lineProgress||0}],"sky-radial-progress":[d,[],function(e){return e.globals.skyRadialProgress||0}],accumulated:[g,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[d,Ft(d),function(e,t){for(var r=0,n=0,i=t;n<i.length;n+=1)r+=i[n].evaluate(e);return r}],"*":[d,Ft(d),function(e,t){for(var r=1,n=0,i=t;n<i.length;n+=1)r*=i[n].evaluate(e);return r}],"-":{type:d,overloads:[[[d,d],function(e,t){var r=t[0],t=t[1];return r.evaluate(e)-t.evaluate(e)}],[[d],function(e,t){return-t[0].evaluate(e)}]]},"/":[d,[d,d],function(e,t){var r=t[0],t=t[1];return r.evaluate(e)/t.evaluate(e)}],"%":[d,[d,d],function(e,t){var r=t[0],t=t[1];return r.evaluate(e)%t.evaluate(e)}],ln2:[d,[],function(){return Math.LN2}],pi:[d,[],function(){return Math.PI}],e:[d,[],function(){return Math.E}],"^":[d,[d,d],function(e,t){var r=t[0],t=t[1];return Math.pow(r.evaluate(e),t.evaluate(e))}],sqrt:[d,[d],function(e,t){t=t[0];return Math.sqrt(t.evaluate(e))}],log10:[d,[d],function(e,t){t=t[0];return Math.log(t.evaluate(e))/Math.LN10}],ln:[d,[d],function(e,t){t=t[0];return Math.log(t.evaluate(e))}],log2:[d,[d],function(e,t){t=t[0];return Math.log(t.evaluate(e))/Math.LN2}],sin:[d,[d],function(e,t){t=t[0];return Math.sin(t.evaluate(e))}],cos:[d,[d],function(e,t){t=t[0];return Math.cos(t.evaluate(e))}],tan:[d,[d],function(e,t){t=t[0];return Math.tan(t.evaluate(e))}],asin:[d,[d],function(e,t){t=t[0];return Math.asin(t.evaluate(e))}],acos:[d,[d],function(e,t){t=t[0];return Math.acos(t.evaluate(e))}],atan:[d,[d],function(e,t){t=t[0];return Math.atan(t.evaluate(e))}],min:[d,Ft(d),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[d,Ft(d),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[d,[d],function(e,t){t=t[0];return Math.abs(t.evaluate(e))}],round:[d,[d],function(e,t){t=t[0].evaluate(e);return t<0?-Math.round(-t):Math.round(t)}],floor:[d,[d],function(e,t){t=t[0];return Math.floor(t.evaluate(e))}],ceil:[d,[d],function(e,t){t=t[0];return Math.ceil(t.evaluate(e))}],"filter-==":[h,[f,g],function(e,t){var r=t[0],t=t[1];return e.properties()[r.value]===t.value}],"filter-id-==":[h,[g],function(e,t){t=t[0];return e.id()===t.value}],"filter-type-==":[h,[f],function(e,t){t=t[0];return e.geometryType()===t.value}],"filter-<":[h,[f,g],function(e,t){var r=t[0],t=t[1],e=e.properties()[r.value],r=t.value;return be(e)===be(r)&&e<r}],"filter-id-<":[h,[g],function(e,t){t=t[0],e=e.id(),t=t.value;return be(e)===be(t)&&e<t}],"filter->":[h,[f,g],function(e,t){var r=t[0],t=t[1],e=e.properties()[r.value],r=t.value;return be(e)===be(r)&&r<e}],"filter-id->":[h,[g],function(e,t){t=t[0],e=e.id(),t=t.value;return be(e)===be(t)&&t<e}],"filter-<=":[h,[f,g],function(e,t){var r=t[0],t=t[1],e=e.properties()[r.value],r=t.value;return be(e)===be(r)&&e<=r}],"filter-id-<=":[h,[g],function(e,t){t=t[0],e=e.id(),t=t.value;return be(e)===be(t)&&e<=t}],"filter->=":[h,[f,g],function(e,t){var r=t[0],t=t[1],e=e.properties()[r.value],r=t.value;return be(e)===be(r)&&r<=e}],"filter-id->=":[h,[g],function(e,t){t=t[0],e=e.id(),t=t.value;return be(e)===be(t)&&t<=e}],"filter-has":[h,[g],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[h,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[h,[p(f)],function(e,t){return 0<=t[0].value.indexOf(e.geometryType())}],"filter-id-in":[h,[p(g)],function(e,t){return 0<=t[0].value.indexOf(e.id())}],"filter-in-small":[h,[f,p(g)],function(e,t){var r=t[0];return 0<=t[1].value.indexOf(e.properties()[r.value])}],"filter-in-large":[h,[f,p(g)],function(e,t){for(var r=t[0],t=t[1],n=e.properties()[r.value],i=t.value,o=0,a=t.value.length-1;o<=a;){var s=o+a>>1;if(i[s]===n)return!0;i[s]>n?a=s-1:o=1+s}return!1}],all:{type:h,overloads:[[[h,h],function(e,t){var r=t[0],t=t[1];return r.evaluate(e)&&t.evaluate(e)}],[Ft(h),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(!n[r].evaluate(e))return!1;return!0}]]},any:{type:h,overloads:[[[h,h],function(e,t){var r=t[0],t=t[1];return r.evaluate(e)||t.evaluate(e)}],[Ft(h),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(n[r].evaluate(e))return!0;return!1}]]},"!":[h,[h],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[h,[f],function(e,t){var t=t[0],r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[f,[f],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[f,[f],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[f,Ft(g),function(t,e){return e.map(function(e){return Ie(e.evaluate(t))}).join("")}],"resolved-locale":[f,[pe],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});function Ut(e,t){this.expression=e,this._warningHistory={},this._evaluator=new l,this._defaultValue=t?"color"===(e=t).type&&(Gt(e.default)||Array.isArray(e.default))?new c(0,0,0,0):"color"===e.type?c.parse(e.default)||null:void 0===e.default?null:e.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}function zt(e,t){var r=new T(At,[],t?(r={color:y,string:f,number:d,enum:f,boolean:h,formatted:de,resolvedImage:ye},"array"!==(n=t).type?r[n.type]:p(r[n.value]||g,n.length)):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Nt(new Ut(n,t)):Bt(r.errors)}Ut.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,i,o,a,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)},Ut.prototype.evaluate=function(e,t,r,n,i,o,a,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null;try{var u=this.expression.evaluate(this._evaluator);if(null==u||"number"==typeof u&&u!=u)return this._defaultValue;if(!this._enumValues||u in this._enumValues)return u;throw new _("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(u)+" instead.")}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};function Wt(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Je(t.expression)}function Vt(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Je(t.expression),this.interpolationType=n}Wt.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)},Wt.prototype.evaluate=function(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)};function Ht(e,t){var r,n,i,o;return"error"===(e=zt(e,t)).result?e:(r=$e(o=e.value.expression))||"data-driven"===(n=t)["property-type"]||"cross-faded-data-driven"===n["property-type"]?(n=Qe(o,["zoom","pitch","distance-from-center"]))||(i=t).expression&&-1<i.expression.parameters.indexOf("zoom")?(i=function t(e){var r=null;if(e instanceof St)r=t(e.result);else if(e instanceof I)for(var n=0,i=e.args;n<i.length;n+=1){var o=i[n];if(r=t(o))break}else(e instanceof C||e instanceof R)&&e.input instanceof j&&"zoom"===e.input.name&&(r=e);if(r instanceof a)return r;e.eachChild(function(e){e=t(e);e instanceof a?r=e:!r&&e?r=new a("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&e&&r!==e&&(r=new a("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))});return r}(o))||n?i instanceof a?Bt([i]):!(i instanceof R)||(o=t).expression&&o.expression.interpolated?i?(t=i instanceof R?i.interpolation:void 0,Nt(new Vt(r?"camera":"composite",e.value,i.labels,t))):Nt(new Wt(r?"constant":"source",e.value)):Bt([new a("",'"interpolate" expressions cannot be used with this property')]):Bt([new a("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]):Bt([new a("","zoom expressions not supported")]):Bt([new a("","data expressions not supported")])}function qt(e){if(Array.isArray(e))return e.map(qt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t,r={};for(t in e)r[t]=qt(e[t]);return r}return(n=e)instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n;var n}Vt.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)},Vt.prototype.evaluate=function(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)};var Yt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!(Vt.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?R.interpolationFactor(this.interpolationType,e,t,r):0})},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function Xt(t,e){if(void 0===e&&(e="fill"),null==t)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};var t=t=!function e(t){if(!0===t||!1===t)return 1;if(Array.isArray(t)&&0!==t.length)switch(t[0]){case"has":return 2<=t.length&&"$id"!==t[1]&&"$type"!==t[1];case"in":return 3<=t.length&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var r=0,n=t.slice(1);r<n.length;r+=1){var i=n[r];if(!e(i)&&"boolean"!=typeof i)return}return 1;default:return 1}}(t)?Qt(t):t,r=!0;try{r=Zt(o=t)?(function e(t){var r=!1;var n=[];if("case"===t[0]){for(var i=1;i<t.length-1;i+=2)r=r||Zt(t[i]),n.push(t[i+1]);n.push(t[t.length-1])}else if("match"===t[0]){r=r||Zt(t[1]);for(var o=2;o<t.length-1;o+=2)n.push(t[o+1]);n.push(t[t.length-1])}else if("step"===t[0]){r=r||Zt(t[1]);for(var a=1;a<t.length-1;a+=2)n.push(t[a+1])}r&&(t.length=0,t.push.apply(t,["any"].concat(n)));for(var s=1;s<t.length;s++)e(t[s])}(n=qt(o)),n=function t(e){if(!Array.isArray(e))return e;e=$t(e);return!0===e?e:e.map(function(e){return t(e)})}(n)):o}catch(e){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n"+JSON.stringify(t,null,2)+"\n        ")}var n=Yt["filter_"+e],i=zt(r,n),o=null;if("error"===i.result)throw new Error(i.value.map(function(e){return e.key+": "+e.message}).join(", "));var o=function(e,t,r){return i.value.evaluate(e,t,{},r)},e=null,a=null;if(r!==t){var s=zt(t,n);if("error"===s.result)throw new Error(s.value.map(function(e){return e.key+": "+e.message}).join(", "));e=function(e,t,r,n,i){return s.value.evaluate(e,t,{},r,void 0,void 0,n,i)},a=!$e(s.value.expression)}return{filter:o,dynamicFilter:e||void 0,needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(r),needFeature:!!a}}function Zt(e){if(Array.isArray(e)){if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;for(var t,r=1;r<e.length;r++)if(Zt(e[r]))return!0}return!1}var Kt=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function $t(e){if(Kt.has(e[0]))for(var t=1;t<e.length;t++)if(Zt(e[t]))return!0;return e}function Jt(e,t){return e<t?-1:t<e?1:0}function Qt(e){var t,r;return!e||(t=e[0],e.length<=1?"any"!==t:"=="===t?er(e[1],e[2],"=="):"!="===t?nr(er(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?er(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(Qt))):"all"===t?["all"].concat(e.slice(1).map(Qt)):"none"===t?["all"].concat(e.slice(1).map(Qt).map(nr)):"in"===t?tr(e[1],e.slice(2)):"!in"===t?nr(tr(e[1],e.slice(2))):"has"===t?rr(e[1]):"!has"===t?nr(rr(e[1])):"within"!==t||e)}function er(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function tr(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return 200<t.length&&!t.some(function(e){return be(e)!==be(t[0])})?["filter-in-large",e,["literal",t.sort(Jt)]]:["filter-in-small",e,["literal",t]]}}function rr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function nr(e){return["!",e]}var ir=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function or(e){e=e.slice();for(var t=Object.create(null),r=0;r<e.length;r++)t[e[r].id]=e[r];for(var n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=function(e,t){var r,n={};for(r in e)"ref"!==r&&(n[r]=e[r]);return ir.forEach(function(e){e in t&&(n[e]=t[e])}),n}(e[n],t[e[n].ref]));return e}var ar={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},sr=/(italic|oblique)$/i,ur={},lr=function(e,t,r){var n=ur[e];if(!n){for(var i=400,o="normal",a=[],s=0,u=(e=Array.isArray(e)?e:[e]).length;s<u;++s){var l,c=e[s].split(" "),f=c[c.length-1].toLowerCase();for(l in"normal"==f||"italic"==f||"oblique"==f?(o=f,c.pop(),f=c[c.length-1].toLowerCase()):sr.test(f)&&(f=f.replace(sr,""),o=c[c.length-1].replace(f,"")),ar){var h=1<c.length?c[c.length-2].toLowerCase():"";if(f==l||f==l.replace("-","")||h+"-"+f==l){i=ar[l],c.pop(),h&&l.startsWith(h)&&c.pop();break}}"number"==typeof f&&(i=f);var p=c.join(" ").replace("Klokantech Noto Sans","Noto Sans");-1!==p.indexOf(" ")&&(p='"'+p+'"'),a.push(p)}n=ur[e]=[o,i,a]}return n[0]+" "+n[1]+" "+t+"px"+(r?"/"+r:"")+" "+n[2]},cr="https://api.mapbox.com";function fr(e){return 0!==e.indexOf("mapbox://")?"":e.slice("mapbox://".length)}function hr(e,t){var r=fr(e);if(!r)return decodeURI(new URL(e,location.href).href);if(0!==r.indexOf("styles/"))throw new Error("unexpected style url: "+e);e=r.slice("styles/".length);return cr+"/styles/v1/"+e+"?&access_token="+t}function pr(e,t,r,n){n=new URL(e,n),e=fr(e);return e?"https://{a-d}.tiles.mapbox.com/v4/"+e+"/{z}/{x}/{y}.vector.pbf?access_token="+t:(t&&n.searchParams.set(r,t),decodeURI(n.href))}function dr(e){return e*Math.PI/180}var yr=function(){for(var e=[],t=78271.51696402048;e.length<=24;t/=2)e.push(t);return e}();function gr(e,t){var r;return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(e,t):((r=document.createElement("canvas")).width=e,r.height=t,r)}function mr(e,t){for(var r,n=0,i=t.length;n<i;++n)if(t[n]<e&&n+1<i)return r=t[n]/t[n+1],n+Math.log(t[n]/e)/Math.log(r);return i-1}var vr={};function br(e,t,r){return void 0===r&&(r={}),t in vr?vr[t]:((r=r.transformRequest&&r.transformRequest(t,e)||new Request(t)).headers.get("Accept")||r.headers.set("Accept","application/json"),e=fetch(r).then(function(e){return delete vr[t],e.ok?e.json():Promise.reject(new Error("Error fetching source "+t))}).catch(function(e){return delete vr[t],Promise.reject(new Error("Error fetching source "+t))}),vr[t]=e)}function _r(e,t){if("string"!=typeof e)return Promise.resolve(e);if(!e.trim().startsWith("{"))return br("Style",e=hr(e,t.accessToken),t);try{var r=JSON.parse(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}var wr={};function xr(e,t,o){void 0===o&&(o={});var r,a,n=[t,JSON.stringify(e)].toString(),i=wr[n];return i&&!o.transformRequest||(i=(r=e.url)&&!e.tiles?(a=pr(r,o.accessToken,o.accessTokenParam||"access_token",t||location.href),r.startsWith("mapbox://")?Promise.resolve(Object.assign({},e,{url:void 0,tiles:a})):br("Source",a,o).then(function(e){for(var t=0,r=e.tiles.length;t<r;++t){var n=e.tiles[t],i=(o.transformRequest&&(i=o.transformRequest(a,"Source"))&&(a=i.url),pr(n,o.accessToken,o.accessTokenParam||"access_token",a));o.transformRequest&&(n=o.transformRequest(i,"Tiles"))instanceof Request&&(i=decodeURI(n.url)),e.tiles[t]=i}return Promise.resolve(e)})):(e=Object.assign({},e,{tiles:e.tiles.map(function(e){return pr(e,o.accessToken,o.accessTokenParam||"access_token",t||location.href)})}),Promise.resolve(Object.assign({},e))),wr[n]=i),i}var Sr,jr=Array(256).join(" ");function Or(e,t){if(.05<=t){for(var r="",n=e.split("\n"),i=jr.slice(0,Math.round(t/.1)),o=0,a=n.length;o<a;++o)0<o&&(r+="\n"),r+=n[o].split("").join(i);return r}return e}function Pr(){return Sr=Sr||gr(1,1).getContext("2d")}function kr(e,t){return Pr().measureText(e).width+(e.length-1)*t}var Er={};function Tr(e,t,r,n){if(-1!==e.indexOf("\n")){for(var i=e.split("\n"),o=[],a=0,s=i.length;a<s;++a)o.push(Tr(i[a],t,r,n));return o.join("\n")}var u=r+","+t+","+e+","+n,l=Er[u];if(!l){var c=e.split(" ");if(1<c.length){var f=Pr();f.font=t;for(var h=f.measureText("M").width*r,p="",d=[],y=0,g=c.length;y<g;++y)var m=c[y],v=p+(p?" ":"")+m,p=kr(v,n)<=h?v:(p&&d.push(p),m);p&&d.push(p);for(var b=0,_=d.length;b<_&&1<_;++b){var w,x,S=d[b];kr(S,n)<.35*h&&(w=0<b?kr(d[b-1],n):1/0,x=b<_-1?kr(d[b+1],n):1/0,d.splice(b,1),--_,w<x?(d[b-1]+=" "+S,--b):d[b]=S+" "+d[b])}for(var j=0,O=d.length-1;j<O;++j){var P,k=d[j],E=d[j+1];kr(k,n)>.7*h&&kr(E,n)<.6*h&&(kr(P=(k=k.split(" ")).pop(),n)<.2*h&&(d[j]=k.join(" "),d[j+1]=P+" "+E),--O)}l=d.join("\n")}else l=e;l=Or(l,n),Er[u]=l}return l}var Cr,Rr=/font-family: ?([^;]*);/,Mr=/("|')/g;var Ir={};function Ar(e){var t=e.toString();if(t in Ir)return Ir[t];for(var r=[],n=0,i=e.length;n<i;++n){e[n]=e[n].replace("Arial Unicode MS","Arial");var o=e[n],o=lr(o,1),o=((0,L.registerFont)(o),o.split(" "));r.push([o.slice(3).join(" ").replace(/"/g,""),o[1],o[0]])}for(var a=0,s=r.length;a<s;++a){var u=r[a],l=u[0];!function(e){if(!Cr){Cr={};for(var t=document.styleSheets,r=0,n=t.length;r<n;++r){var i=t[r];try{var o=i.rules||i.cssRules;if(o)for(var a=0,s=o.length;a<s;++a){var u,l=o[a];5==l.type&&(u=l.cssText.match(Rr),Cr[u[1].replace(Mr,"")]=!0)}}catch(e){}}}return e in Cr}(l)&&100!==L.checkedFonts.get(u[2]+"\n"+u[1]+" \n"+l)&&(l="https://fonts.googleapis.com/css?family="+l.replace(/ /g,"+")+":"+u[1]+u[2],document.querySelector('link[href="'+l+'"]')||((u=document.createElement("link")).href=l,u.rel="stylesheet",document.head.appendChild(u)))}return Ir[t]=e}function Lr(e,t){if("error"===(e=Ht(e,t)).result)throw new Error(e.value.map(function(e){return e.key+": "+e.message}).join(", "));return e.value}var Dr,Fr,Nr={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},Br={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},Gr={},Ur={zoom:0};function _e(e,t,r,n,i,o,a){var s,u=e.id,o=(o||(o={},console.warn("No functionCache provided to getValue()")),o[u]||(o[u]={}),o[u]);return o[r]||(s=(e[t]||Gr)[r],u=Yt[t+"_"+e.type][r],void 0===s&&(s=u.default),t=s,!(e=Array.isArray(t)&&0<t.length&&"string"==typeof t[0]&&t[0]in At)&&Gt(s)&&(s=ne(s,u),e=!0),e?(t=Lr(s,u),o[r]=t.evaluate.bind(t)):("color"==u.type&&(s=c.parse(s)),o[r]=function(){return s})),Ur.zoom=n,o[r](Ur,i,a)}var zr=!1;function Wr(e,t){var r;return e&&(zr||0!==e.a&&0!==t?(t=void 0===t?1:t,0===(r=e.a)?"transparent":"rgba("+Math.round(255*e.r/r)+","+Math.round(255*e.g/r)+","+Math.round(255*e.b/r)+","+r*t+")"):void 0)}var Vr=/\{[^{}}]*\}/g;function Hr(e,t){return e.replace(Vr,function(e){return t[e.slice(1,-1)]||""})}var qr=!1;function Yr(oe,e,t,ae,se,r,ue){if(void 0===ae&&(ae=yr),void 0===se&&(se=void 0),void 0===r&&(r=void 0),void 0===ue&&(ue=void 0),8!=(e="string"==typeof e?JSON.parse(e):e).version)throw new Error("glStyle version 8 required.");r&&("undefined"!=typeof Image?((n=new Image).crossOrigin="anonymous",n.onload=function(){ce=[(le=n).width,n.height],oe.changed(),n.onload=null},n.src=r):"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&((i=self).postMessage({action:"loadImage",src:r}),i.addEventListener("message",function(e){"imageLoaded"===e.data.action&&e.data.src===r&&(le=e.data.image,ce=[le.width,le.height])})));for(var le,ce,n,i,o=or(e.layers),fe={},a=[],he={},pe={},de={},ye={},s=0,u=o.length;s<u;++s){var l=o[s],c=l.id;if("string"==typeof t&&l.source==t||-1!==t.indexOf(c)){var f=l["source-layer"];if(h){if(l.source!==h)throw new Error('Layer "'+c+'" does not use source "'+h)}else{var h=l.source,p=e.sources[h];if(!p)throw new Error('Source "'+h+'" is not defined');p=p.type;if("vector"!==p&&"geojson"!==p)throw new Error('Source "'+h+'" is not of type "vector" or "geojson", but "'+p+'"')}p=fe[f];p||(fe[f]=p=[]),p.push({layer:l,index:s}),a.push(c)}}function d(e,D){var t=e.getProperties(),F=fe[t.layer];if(F){for(var r=ae.indexOf(D),u=(-1==r&&(r=mr(D,ae)),Nr[e.getGeometry().getType()]),n={properties:t,type:u},i=oe.get("mapbox-featurestate")[e.getId()],o=-1,N=0,B=F.length;N<B;++N){var a=F[N],s=a.layer,l=s.id,c=s.layout||Gr,f=s.paint||Gr;if(!("none"===c.visibility||"minzoom"in s&&r<s.minzoom||"maxzoom"in s&&r>=s.maxzoom)){var h=s.filter;if(!h||(l=l,h=h,m=n,y=r,(g=ye)||console.warn("No filterCache provided to evaluateFilter()"),l in g||(g[l]=Xt(h).filter),Ur.zoom=y,g[l](Ur,m))){var G,p,d,U=s,h=void 0,y=void 0,g=void 0,l=void 0,m=void 0,v=void 0,a=a.index,b=(3!=u||"fill"!=s.type&&"fill-extrusion"!=s.type||(y=_e(s,"paint",s.type+"-opacity",r,n,de,i),s.type+"-pattern"in f?(b=_e(s,"paint",s.type+"-pattern",r,n,de,i))&&(b="string"==typeof b?Hr(b,t):b.toString(),le)&&se&&se[b]&&((v=ve[++o])&&v.getFill()&&!v.getStroke()&&!v.getText()||(v=new Pe.default({fill:new xe.default}),ve[o]=v),g=v.getFill(),v.setZIndex(a),(S=pe[x=b+"."+y])||((_=(w=gr((b=se[b]).width,b.height)).getContext("2d")).globalAlpha=y,_.drawImage(le,b.x,b.y,b.width,b.height,0,0,b.width,b.height),S=_.createPattern(w,"repeat"),pe[x]=S),g.setColor(S)):(h=Wr(_e(s,"paint",s.type+"-color",r,n,de,i),y),m=(m=s.type+"-outline-color"in f?Wr(_e(s,"paint",s.type+"-outline-color",r,n,de,i),y):m)||h,(h||m)&&((!(v=ve[++o])||h&&!v.getFill()||!h&&v.getFill()||m&&!v.getStroke()||!m&&v.getStroke()||v.getText())&&(v=new Pe.default({fill:h?new xe.default:void 0,stroke:m?new Oe.default:void 0}),ve[o]=v),h&&(g=v.getFill()).setColor(h),m&&((l=v.getStroke()).setColor(m),l.setWidth(.5)),v.setZIndex(a)))),1!=u&&"line"==s.type&&(h=!("line-pattern"in f)&&"line-color"in f?Wr(_e(s,"paint","line-color",r,n,de,i),_e(s,"paint","line-opacity",r,n,de,i)):void 0,G=_e(s,"paint","line-width",r,n,de,i),h)&&0<G&&((v=ve[++o])&&v.getStroke()&&!v.getFill()&&!v.getText()||(v=new Pe.default({stroke:new Oe.default}),ve[o]=v),(l=v.getStroke()).setLineCap(_e(s,"layout","line-cap",r,n,de,i)),l.setLineJoin(_e(s,"layout","line-join",r,n,de,i)),l.setMiterLimit(_e(s,"layout","line-miter-limit",r,n,de,i)),l.setColor(h),l.setWidth(G),l.setLineDash(f["line-dasharray"]?_e(s,"paint","line-dasharray",r,n,de,i).map(function(e){return e*G}):null),v.setZIndex(a)),!1),_=null,z=0,w=void 0,x=void 0;if((1==u||2==u)&&"icon-image"in c){var S=_e(s,"layout","icon-image",r,n,de,i);if(S){h="string"==typeof S?Hr(S,t):S.toString(),l=void 0;if(le&&se&&se[h]){var j,O=_e(s,"layout","icon-rotation-alignment",r,n,de,i);if(2==u){var P=e.getGeometry();if(P.getFlatMidpoint||P.getFlatMidpoints){var k=P.getExtent();if(150<Math.sqrt(Math.max(Math.pow((k[2]-k[0])/D,2),Math.pow((k[3]-k[1])/D,2)))){var E="MultiLineString"===P.getType()?P.getFlatMidpoints():P.getFlatMidpoint();if(Fr||(Dr=[NaN,NaN],Fr=new je.default("Point",Dr,[],{},null)),l=Fr,Dr[0]=E[0],Dr[1]=E[1],"line"===_e(s,"layout","symbol-placement",r,n,de,i)&&"map"===O)for(var W=P.getStride(),T=P.getFlatCoordinates(),C=0,V=T.length-W;C<V;C+=W){var H=T[C],q=T[C+1],Y=T[C+W],X=T[C+W+1],Z=Math.min(H,Y),K=Math.min(q,X),$=Math.max(H,Y),J=Math.max(q,X);if(E[0]>=Z&&E[0]<=$&&E[1]>=K&&E[1]<=J){z=Math.atan2(q-X,Y-H);break}}}}}2!==u||l?(k=_e(s,"layout","icon-size",r,n,de,i),(P=void 0!==f["icon-color"]?_e(s,"paint","icon-color",r,n,de,i):null)&&0===P.a||(I=h+"."+k,null!==P&&(I+="."+P),w=he[I])||(h=se[h],M=_e(M=s,"layout","icon-allow-overlap",j=r,p=n,d=de)?_e(M,"layout","icon-ignore-placement",j,p,d)?"none":"obstacle":"declutter",j=void 0,"icon-offset"in c&&((j=_e(s,"layout","icon-offset",r,n,de,i))[1]*=-1),w=new Se.default({color:P?[255*P.r,255*P.g,255*P.b,P.a]:void 0,img:le,imgSize:ce,size:[h.width,h.height],offset:[h.x,h.y],rotateWithView:"map"===O,scale:k/h.pixelRatio,displacement:j,declutterMode:M}),he[I]=w),w&&((v=ve[++o])&&v.getImage()&&!v.getFill()&&!v.getStroke()||(v=new Pe.default,ve[o]=v),v.setGeometry(l),w.setRotation(z+dr(_e(s,"layout","icon-rotate",r,n,de,i))),w.setOpacity(_e(s,"paint","icon-opacity",r,n,de,i)),w.setAnchor(Br[_e(s,"layout","icon-anchor",r,n,de,i)]),v.setImage(w),_=v.getText(),v.setText(void 0),v.setZIndex(a),x=!(b=!0))):x=!0}}}1==u&&"circle"===s.type&&((v=ve[++o])&&v.getImage()&&!v.getFill()&&!v.getStroke()||(v=new Pe.default,ve[o]=v),p="circle-radius"in f?_e(s,"paint","circle-radius",r,n,de,i):5,d=Wr(_e(s,"paint","circle-stroke-color",r,n,de,i),_e(s,"paint","circle-stroke-opacity",r,n,de,i)),O=Wr(_e(s,"paint","circle-color",r,n,de,i),_e(s,"paint","circle-opacity",r,n,de,i)),h=_e(s,"paint","circle-stroke-width",r,n,de,i),(w=he[j=p+"."+d+"."+O+"."+h])||(w=new we.default({radius:p,stroke:d&&0<h?new Oe.default({width:h,color:d}):void 0,fill:O?new xe.default({color:O}):void 0,declutterMode:"none"}),he[j]=w),v.setImage(w),_=v.getText(),v.setText(void 0),v.setGeometry(void 0),v.setZIndex(a),b=!0);var Q,ee,te,re,R,M=void 0,I=void 0,A=void 0,L=void 0,ne=void 0,ie=void 0;"text-field"in c&&(L=Math.round(_e(s,"layout","text-size",r,n,de,i)),Q=_e(s,"layout","text-font",r,n,de,i),A=_e(s,"layout","text-line-height",r,n,de,i),(I=lr(ue?ue(Q):Q,L,A)).includes("sans-serif")||(I+=",sans-serif"),ne=_e(s,"layout","text-letter-spacing",r,n,de,i),ie=_e(s,"layout","text-max-width",r,n,de,i),M="object"===be(l=_e(s,"layout","text-field",r,n,de,i))&&l.sections?1===l.sections.length?l.toString():l.sections.reduce(function(e,t,r){var n=t.fontStack?t.fontStack.split(","):Q,i=lr(ue?ue(n):n,L*(t.scale||1),A);if("\n"===(o=t.text))return e.push("\n",""),e;if(2!=u){for(var o,a=0,s=(o=Tr(o,i,ie,ne).split("\n")).length;a<s;++a)0<a&&e.push("\n",""),e.push(o[a],i);return e}e.push(Or(o,ne),i)},[]):Hr(l,t).trim(),y=_e(s,"paint","text-opacity",r,n,de,i)),M&&y&&!x&&(b||((v=ve[++o])&&v.getText()&&!v.getFill()&&!v.getStroke()||(v=new Pe.default,ve[o]=v),v.setImage(void 0),v.setGeometry(void 0)),v.getText()||v.setText(_||new ke.default({padding:[2,2,2,2]})),_=v.getText(),"uppercase"==(f=c["text-transform"])?M=Array.isArray(M)?M.map(function(e,t){return t%2?e:e.toUpperCase()}):M.toUpperCase():"lowercase"==f&&(M=Array.isArray(M)?M.map(function(e,t){return t%2?e:e.toLowerCase()}):M.toLowerCase()),h=Array.isArray(M)?M:2==u?Or(M,ne):Tr(M,I,ie,ne),_.setText(h),_.setFont(I),_.setRotation(dr(_e(s,"layout","text-rotate",r,n,de,i))),l=_e(s,"layout","text-anchor",r,n,de,i),c=b||1==u?"point":_e(s,"layout","symbol-placement",r,n,de,i),_.setPlacement(c),_.setOverflow("point"===c),f=_e(s,"paint","text-halo-width",r,n,de,i),ee=_e(s,"layout","text-offset",r,n,de,i),te=_e(s,"paint","text-translate",r,n,de,i),R=re=0,"point"==c?(c="center",-1!==l.indexOf("left")?(c="left",R=f):-1!==l.indexOf("right")&&(c="right",R=-f),_.setTextAlign(c),c=_e(s,"layout","text-rotation-alignment",r,n,de,i),_.setRotateWithView("map"==c)):(_.setMaxAngle(dr(_e(s,"layout","text-max-angle",r,n,de,i))*M.length/h.length),_.setTextAlign(),_.setRotateWithView(!1)),c="middle",0==l.indexOf("bottom")?(c="bottom",re=-f-.5*(A-1)*L):0==l.indexOf("top")&&(c="top",re=f+.5*(A-1)*L),_.setTextBaseline(c),h=_e(s,"layout","text-justify",r,n,de,i),_.setJustify("auto"===h?void 0:h),_.setOffsetX(ee[0]*L+R+te[0]),_.setOffsetY(ee[1]*L+re+te[1]),me.setColor(Wr(_e(s,"paint","text-color",r,n,de,i),y)),_.setFill(me),(l=Wr(_e(s,"paint","text-halo-color",r,n,de,i),y))?(ge.setColor(l),f*=2,c=.5*L,ge.setWidth(f<=c?f:c),_.setStroke(ge)):_.setStroke(void 0),(h=_e(s,"layout","text-padding",r,n,de,i))!==(R=_.getPadding())[0]&&(R[0]=h,R[1]=h,R[2]=h,R[3]=h),v.setZIndex(a))}}}return-1<o?(ve.length=o+1,qr&&("function"==typeof e.set?e.set("mapbox-layer",U):e.getProperties()["mapbox-layer"]=U),ve):void 0}}var ge=new Oe.default,me=new xe.default,ve=[];return oe.setStyle(d),oe.set("mapbox-source",h),oe.set("mapbox-layers",a),oe.set("mapbox-featurestate",{}),d}function Xr(e,r){return r.accessToken||(r=Object.assign({},r),new URL(e).searchParams.forEach(function(e,t){r.accessToken=e,r.accessTokenParam=t})),r}function Zr(h,e,p,t,d){var y,g,m;return void 0===p&&(p=""),void 0===d&&(d=void 0),m="string"==typeof(t=void 0===t?{}:t)?(y=t,{}):(y=t.styleUrl,t),d=d||m.resolutions,(y=y||"string"!=typeof e||e.trim().startsWith("{")?y:e)&&(y=y.startsWith("data:")?location.href:hr(y,m.accessToken),m=Xr(y,m)),new Promise(function(c,f){_r(e,m).then(function(r){var t,n,i,e,o,a,s;return 8!=r.version?f(new Error("glStyle version 8 required.")):h instanceof U.default||h instanceof W.default?(t=h instanceof W.default?"vector":"geojson",p?g=Array.isArray(p)?r.layers.find(function(e){return e.id===p[0]}).source:p:(g=Object.keys(r.sources).find(function(e){return r.sources[e].type===t}),p=g),g?void(r.sprite?(o=new URL(function(e,t,r){var n=fr(e);if(!n)return decodeURI(new URL(e,r).href);if(0!==n.indexOf("sprites/"))throw new Error("unexpected sprites url: "+e);return r=n.slice("sprites/".length),cr+"/styles/v1/"+r+"/sprite?access_token="+t}(r.sprite,m.accessToken,y||location.href)),a=.5==(1.5<=window.devicePixelRatio?.5:1)?"@2x":"",s=o.origin+o.pathname+a+".json"+o.search,new Promise(function(t,r){br("Sprite",s,m).then(t).catch(function(e){br("Sprite",s=o.origin+o.pathname+".json"+o.search,m).then(t).catch(r)})}).then(function(e){void 0===e&&f(new Error("No sprites found.")),n=e,i=o.origin+o.pathname+a+".png"+o.search,m.transformRequest&&(e=m.transformRequest(i,"SpriteImage"))instanceof Request&&(i=encodeURI(e.url)),l()}).catch(function(e){f(new Error("Sprites cannot be loaded: "+s+": "+e.message))})):l()):f(new Error("No "+t+" source found in the glStyle."))):f(new Error("Can only apply to VectorLayer or VectorTileLayer"));function u(){var e,t;return h instanceof W.default?en(r.sources[g],y,m).then(function(e){var t=h.getSource();t?e!==t&&(t.setTileUrlFunction(e.getTileUrlFunction()),t.format_||(t.format_=e.format_),t.getAttributions()||t.setAttributions(e.getAttributions()),t.getTileLoadFunction()===V.defaultLoadFunction&&t.setTileLoadFunction(e.getTileLoadFunction()),(0,Y.equivalent)(t.getProjection(),e.getProjection()))&&(t.tileGrid=e.getTileGrid()):h.setSource(e),isFinite(h.getMaxResolution())||isFinite(h.getMinZoom())||(t=h.getSource().getTileGrid(),h.setMaxResolution(t.getResolution(t.getMinZoom())))}):(t=r.sources[g],(e=h.getSource())&&e.get("mapbox-source")===t||(e=rn(t,y,m)),(t=h.getSource())?e!==t&&(t.getAttributions()||t.setAttributions(e.getAttributions()),t.format_||(t.format_=e.getFormat()),t.url_=e.getUrl()):h.setSource(e),Promise.resolve())}function l(){e||r.sprite&&!n?e?(h.setStyle(e),u().then(c).catch(f)):f(new Error("Something went wrong trying to apply style.")):(e=Yr(h,r,p,d,n,i,Ar),h.getStyle()?u().then(c).catch(f):f(new Error("Nothing to show for source ["+g+"]")))}}).catch(f)})}var Kr={};function $r(e,a,s){var u={id:a.id,type:a.type},l={};var t,c=0,f=!1;function r(e){if(e.frameState.time!==c&&(c=e.frameState.time,f=!1),!f){if(!(e.context instanceof CanvasRenderingContext2D))throw new Error("Cannot apply background to WebGL context");var t,r,n,i=e.frameState.viewState.resolution,o=(i=i,n=a.layout||{},o=a.paint||{},u.paint=o,i=mr(i,s.resolutions||yr),void 0!==o["background-color"]&&(t=_e(u,"paint","background-color",i,Kr,l)),void 0!==o["background-opacity"]&&(r=_e(u,"paint","background-opacity",i,Kr,l)),"none"==n.visibility?void 0:Wr(t,r));o&&(n=(i=e.context).globalAlpha,i.globalAlpha=1,i.fillStyle=o,i.fillRect(0,0,e.context.canvas.width,e.context.canvas.height),i.globalAlpha=n),f=!0}}"function"==typeof e.getLayers?((t=e.getLayers()).forEach(function(e){e.on("prerender",r)}),t.on("add",function(e){e.element.on("prerender",r)}),t.on("remove",function(e){e.element.un("prerender",r)})):e.on("prerender",r)}function Jr(t,e,r){e.layers.some(function(e){if("background"===e.type)return $r(t,e,r),!0})}function Qr(e){var t,e=e.bounds;if(e)return t=(0,Y.fromLonLat)([e[0],e[1]]),e=(0,Y.fromLonLat)([e[2],e[3]]),[t[0],t[1],e[0],e[1]]}function en(t,r,n){return new Promise(function(s,e){xr(t,r,n).then(function(e){var t=new B.default({tileJSON:e}),r=t.getTileJSON(),n=t.getTileGrid(),i=Qr(r),o=r.minzoom||0,a=r.maxzoom||22,t={attributions:t.getAttributions(),format:new D.default,tileGrid:new N.default({origin:n.getOrigin(0),extent:i||n.getExtent(),minZoom:o,resolutions:yr.slice(0,a+1),tileSize:512})};Array.isArray(r.tiles)?t.urls=r.tiles:t.url=r.tiles,e.olSourceOptions&&Object.assign(t,e.olSourceOptions),s(new V.default(t))}).catch(e)})}var tn=new t.default;function rn(e,t,r){var n=e.data,i={},r=("string"==typeof n?(t=pr(n,r.accessToken,r.accessTokenParam||"access_token",t||location.href),r.transformRequest&&(r=r.transformRequest(t,"GeoJSON"))instanceof Request&&(t=encodeURI(r.url)),i.url=t):i.features=tn.readFeatures(n,{featureProjection:(0,Y.getUserProjection)()||"EPSG:3857"}),new z.default(Object.assign({attributions:e.attribution,format:tn},i)));return r.set("mapbox-source",e),r}function nn(r,n,i){var o=null;return function(e){var t;e.frameState.viewState.zoom!==o&&(o=e.frameState.viewState.zoom,e=n,t=_e(t=r,"paint","raster-opacity",o,Kr,i),e.setOpacity(t))}}function on(e,t,r,n){for(var i,o,a,s=[],u=null,l=(t instanceof F.default&&((u=t.getView()).isDef()||u.getRotation()||u.getResolutions()||(u=new H.default(Object.assign(u.getProperties(),{maxResolution:yr[0]})),t.setView(u)),"center"in e&&!u.getCenter()&&u.setCenter((0,Y.fromLonLat)(e.center)),"zoom"in e&&void 0===u.getZoom()&&u.setResolution(yr[0]/Math.pow(2,e.zoom)),u.getCenter()&&void 0!==u.getZoom()||u.fit(u.getProjection().getExtent(),{nearest:!0,size:t.getSize()})),e.layers),c=[],f=0,h=l.length;f<h;++f){var p,d=(p=l[f]).type;if("heatmap"==d||"hillshade"==d)throw new Error(d+" layers are not supported");"background"==d?$r(t,p,n):((d=p.source||function(e,t){var r;return e.some(function(e){if(e.id==t)return r=e.source,!0}),r}(l,p.ref))!=o&&(c.length&&(s.push(an(a,c,e,r,t,n)),c=[]),"vector"==(i=e.sources[d]).type?a=function(t,e,r){var n=new W.default({declutter:!0,visible:!1});return en(t,e,r).then(function(e){e.set("mapbox-source",t),n.setSource(e)}).catch(function(e){n.setSource(void 0)}),n}(i,r,n):"raster"==i.type?((a=function(s,e,t){var u=new G.default;return xr(s,e,t).then(function(e){var n=new B.default({transition:0,crossOrigin:"anonymous",tileJSON:e}),t=Qr(e),r=n.getTileGrid(),i=s.tileSize||e.tileSize||512,o=e.minzoom||0,e=e.maxzoom||22,a=(n.tileGrid=new N.default({origin:r.getOrigin(0),extent:t||r.getExtent(),minZoom:o,resolutions:(0,q.createXYZ)({maxZoom:e,tileSize:i}).getResolutions(),tileSize:i}),n.getTileUrlFunction());n.setTileUrlFunction(function(e,t,r){t=a(e,t,r);return-1!=t.indexOf("{bbox-epsg-3857}")&&(r=n.getTileGrid().getTileCoordExtent(e),t=t.replace("{bbox-epsg-3857}",r.toString())),t}),n.set("mapbox-source",s),u.setSource(n)}).catch(function(e){u.setSource(void 0)}),u}(i,r,n)).setVisible(!p.layout||"none"!==p.layout.visibility),a.on("prerender",nn(p,a,{}))):"geojson"==i.type&&(a=new U.default({declutter:!0,source:rn(i,r,n),visible:!1})),o=d,a)&&a.set("mapbox-source",o),c.push(p.id))}return s.push(an(a,c,e,r,t,n)),t.set("mapbox-style",e),Promise.all(s)}function an(o,a,s,u,r,l){void 0===l&&(l={});for(var c=24,f=0,e=s.layers,t=0,n=e.length;t<n;++t){var i=e[t];-1!==a.indexOf(i.id)&&(c=Math.min("minzoom"in i?i.minzoom:0,c),f=Math.max("maxzoom"in i?i.maxzoom:24,f))}return new Promise(function(n,i){function e(){var e,t,r=o.getSource();r&&"error"!==r.getState()?("getTileGrid"in r&&(e=r.getTileGrid())&&(t=e.getMinZoom(),(0<c||0<t)&&o.setMaxResolution(Math.min(yr[c],e.getResolution(t))+1e-9),f<24)&&o.setMinResolution(yr[f]+1e-9),r instanceof z.default||r instanceof V.default?Zr(o,s,a,Object.assign({styleUrl:u},l)).then(function(){o.setVisible(!0),n()}).catch(i):n()):i(new Error("Error accessing data for source "+o.get("mapbox-source")))}o.set("mapbox-layers",a);var t=r.getLayers();-1===t.getArray().indexOf(o)&&t.push(o),o.getSource()?e():o.once("change:source",e)})}function sn(e,t){for(var r=[],n=e.getAllLayers(),i=0,o=n.length;i<o;++i)n[i].get("mapbox-source")===t&&r.push(n[i]);return r}},{"ol/Map.js":83,"ol/View.js":101,"ol/format/GeoJSON.js":143,"ol/format/MVT.js":148,"ol/layer/Tile.js":259,"ol/layer/Vector.js":261,"ol/layer/VectorTile.js":263,"ol/proj.js":271,"ol/render/Feature.js":283,"ol/render/canvas.js":285,"ol/source/TileJSON.js":342,"ol/source/Vector.js":346,"ol/source/VectorTile.js":348,"ol/style/Circle.js":359,"ol/style/Fill.js":360,"ol/style/Icon.js":361,"ol/style/Stroke.js":366,"ol/style/Style.js":367,"ol/style/Text.js":368,"ol/tilegrid.js":372,"ol/tilegrid/TileGrid.js":373}],70:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(r){var n=u();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function n(e){var r="function"==typeof Map?new Map:void 0;return function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return o(e,arguments,c(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),l(t,e)}(e)}function o(e,t,r){return(o=u()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&l(t,r.prototype),t}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var f={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection"},h=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n,i=s(o);function o(e){var t,r;if(this instanceof o)return(r=i.call(this,t=f[e])).code=e,r.name="AssertionError",r.message=t,r;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n(Error));r.default=h},{}],71:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CollectionEvent=void 0;var s=a(e("./AssertionError.js")),n=a(e("./Object.js")),u=a(e("./CollectionEventType.js")),o=a(e("./events/Event.js"));function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g="length",m=function(){h(i,o["default"]);var n=d(i);function i(e,t,r){return f(this,i),(e=n.call(this,e)).element=t,e.index=r,e}return c(i)}(),e=(r.CollectionEvent=m,function(){h(a,n["default"]);var o=d(a);function a(e,t){var r;if(f(this,a),(r=o.call(this)).on,r.once,r.un,r.unique_=!!(t=t||{}).unique,r.array_=e||[],r.unique_)for(var n=0,i=r.array_.length;n<i;++n)r.assertUnique_(r.array_[n],n);return r.updateLength_(),r}return c(a,[{key:"clear",value:function(){for(;0<this.getLength();)this.pop()}},{key:"extend",value:function(e){for(var t=0,r=e.length;t<r;++t)this.push(e[t]);return this}},{key:"forEach",value:function(e){for(var t=this.array_,r=0,n=t.length;r<n;++r)e(t[r],r,t)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(e){return this.array_[e]}},{key:"getLength",value:function(){return this.get(g)}},{key:"insertAt",value:function(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new m(u.default.ADD,t,e))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(e){this.unique_&&this.assertUnique_(e);var t=this.getLength();return this.insertAt(t,e),this.getLength()}},{key:"remove",value:function(e){for(var t=this.array_,r=0,n=t.length;r<n;++r)if(t[r]===e)return this.removeAt(r)}},{key:"removeAt",value:function(e){var t;if(!(e<0||e>=this.getLength()))return t=this.array_[e],this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new m(u.default.REMOVE,t,e)),t}},{key:"setAt",value:function(e,t){if(this.getLength()<=e)this.insertAt(e,t);else{if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);var r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new m(u.default.REMOVE,r,e)),this.dispatchEvent(new m(u.default.ADD,t,e))}}},{key:"updateLength_",value:function(){this.set(g,this.array_.length)}},{key:"assertUnique_",value:function(e,t){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===e&&r!==t)throw new s.default(58)}}]),a}());r.default=e},{"./AssertionError.js":70,"./CollectionEventType.js":72,"./Object.js":90,"./events/Event.js":126}],72:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={ADD:"add",REMOVE:"remove"}},{}],73:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./Tile.js")),o=a(e("./TileState.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(this instanceof i)return t=o.default.IDLE,(t=n.call(this,e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate})).loader_=e.loader,t.data_=null,t.error_=null,t.size_=e.size||[256,256],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getSize",value:function(){return this.size_}},{key:"getData",value:function(){return this.data_}},{key:"getError",value:function(){return this.error_}},{key:"load",value:function(){var t;this.state!==o.default.IDLE&&this.state!==o.default.ERROR||(this.state=o.default.LOADING,this.changed(),(t=this).loader_().then(function(e){t.data_=e,t.state=o.default.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=o.default.ERROR,t.changed()}))}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"./Tile.js":94,"./TileState.js":98}],74:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.disposed=!1}var t,r,n;return t=e,(r=[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=n},{}],75:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.createStyleFunction=p,r.default=void 0;var n=u(e("./Object.js")),o=u(e("./events/EventType.js")),a=e("./asserts.js"),s=e("./events.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).on,t.once,t.un,t.id_=void 0,t.geometryName_="geometry",t.style_=null,t.styleFunction_=void 0,t.geometryChangeKey_=null,t.addChangeListener(t.geometryName_,t.handleGeometryChanged_),e&&("function"==typeof e.getSimplifiedGeometry?t.setGeometry(e):t.setProperties(e)),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){(e=new i(this.hasProperties()?this.getProperties():null)).setGeometryName(this.getGeometryName());var e,t=this.getGeometry(),t=(t&&e.setGeometry(t.clone()),this.getStyle());return t&&e.setStyle(t),e}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&((0,s.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=(0,s.listen)(e,o.default.CHANGE,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(e){this.set(this.geometryName_,e)}},{key:"setStyle",value:function(e){this.style_=e,this.styleFunction_=e?p(e):void 0,this.changed()}},{key:"setId",value:function(e){this.id_=e,this.changed()}},{key:"setGeometryName",value:function(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function p(e){var t;return"function"==typeof e?e:(t=Array.isArray(e)?e:((0,a.assert)("function"==typeof e.getZIndex,41),[e]),function(){return t})}r.default=e},{"./Object.js":90,"./asserts.js":105,"./events.js":125,"./events/EventType.js":127}],76:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=n(e("./events/Event.js")),a=n(e("./Object.js")),s=n(e("./events/EventType.js")),u=e("./geom/Polygon.js"),l=e("./proj.js"),c=e("./math.js");function n(e){return e&&e.__esModule?e:{default:e}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b="accuracy",_="accuracyGeometry",w="altitude",x="altitudeAccuracy",S="heading",j="position",O="projection",P="speed",k="tracking",E="trackingOptions",T=function(){y(n,o["default"]);var r=m(n);function n(e){var t;return d(this,n),(t=r.call(this,s.default.ERROR)).code=e.code,t.message=e.message,t}return p(n)}(),e=function(){y(n,a["default"]);var r=m(n);function n(e){var t;return d(this,n),(t=r.call(this)).on,t.once,t.un,e=e||{},t.position_=null,t.transform_=l.identityTransform,t.watchId_=void 0,t.addChangeListener(O,t.handleProjectionChanged_),t.addChangeListener(k,t.handleTrackingChanged_),void 0!==e.projection&&t.setProjection(e.projection),void 0!==e.trackingOptions&&t.setTrackingOptions(e.trackingOptions),t.setTracking(void 0!==e.tracking&&e.tracking),t}return p(n,[{key:"disposeInternal",value:function(){this.setTracking(!1),f(v(n.prototype),"disposeInternal",this).call(this)}},{key:"handleProjectionChanged_",value:function(){var e=this.getProjection();e&&(this.transform_=(0,l.getTransformFromProjections)((0,l.get)("EPSG:4326"),e),this.position_)&&this.set(j,this.transform_(this.position_))}},{key:"handleTrackingChanged_",value:function(){var e;"geolocation"in navigator&&((e=this.getTracking())&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):e||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0))}},{key:"positionChange_",value:function(e){var e=e.coords,t=(this.set(b,e.accuracy),this.set(w,null===e.altitude?void 0:e.altitude),this.set(x,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(S,null===e.heading?void 0:(0,c.toRadians)(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude],this.transform_(this.position_)),t=(this.set(j,t),this.set(P,null===e.speed?void 0:e.speed),(0,u.circular)(this.position_,e.accuracy));t.applyTransform(this.transform_),this.set(_,t),this.changed()}},{key:"positionError_",value:function(e){this.dispatchEvent(new T(e))}},{key:"getAccuracy",value:function(){return this.get(b)}},{key:"getAccuracyGeometry",value:function(){return this.get(_)||null}},{key:"getAltitude",value:function(){return this.get(w)}},{key:"getAltitudeAccuracy",value:function(){return this.get(x)}},{key:"getHeading",value:function(){return this.get(S)}},{key:"getPosition",value:function(){return this.get(j)}},{key:"getProjection",value:function(){return this.get(O)}},{key:"getSpeed",value:function(){return this.get(P)}},{key:"getTracking",value:function(){return this.get(k)}},{key:"getTrackingOptions",value:function(){return this.get(E)}},{key:"setProjection",value:function(e){this.set(O,(0,l.get)(e))}},{key:"setTracking",value:function(e){this.set(k,e)}},{key:"setTrackingOptions",value:function(e){this.set(E,e)}}]),n}();r.default=e},{"./Object.js":90,"./events/Event.js":126,"./events/EventType.js":127,"./geom/Polygon.js":200,"./math.js":267,"./proj.js":271}],77:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.listenImage=y;var s=a(e("./events/EventType.js")),n=a(e("./ImageBase.js")),u=a(e("./ImageState.js")),l=e("./has.js"),o=e("./extent.js"),c=e("./events.js");function a(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,a=p(s);function s(e,t,r,n,i,o){if(this instanceof s)return(e=a.call(this,e,t,r,u.default.IDLE)).src_=n,e.image_=new Image,null!==i&&(e.image_.crossOrigin=i),e.unlisten_=null,e.state=u.default.IDLE,e.imageLoadFunction_=o,e;throw new TypeError("Cannot call a class as a function")}return t=s,(e=[{key:"getImage",value:function(){return this.image_}},{key:"handleImageError_",value:function(){this.state=u.default.ERROR,this.unlistenImage_(),this.changed()}},{key:"handleImageLoad_",value:function(){void 0===this.resolution&&(this.resolution=(0,o.getHeight)(this.extent)/this.image_.height),this.state=u.default.LOADED,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state!=u.default.IDLE&&this.state!=u.default.ERROR||(this.state=u.default.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=y(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"setImage",value:function(e){this.image_=e,this.resolution=(0,o.getHeight)(this.extent)/this.image_.height}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default);function y(e,t,r){var n=!0,i=!1,o=!1,a=[(0,c.listenOnce)(e,s.default.LOAD,function(){o=!0,i||t()})];return e.src&&l.IMAGE_DECODE?(i=!0,e.decode().then(function(){n&&t()}).catch(function(e){n&&(o?t:r)()})):a.push((0,c.listenOnce)(e,s.default.ERROR,r)),function(){n=!1,a.forEach(c.unlistenByKey)}}r.default=e},{"./ImageBase.js":78,"./ImageState.js":80,"./events.js":125,"./events/EventType.js":127,"./extent.js":131,"./has.js":221}],78:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./events/Target.js")),s=o(e("./events/EventType.js")),u=e("./util.js");function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,o=f(a);function a(e,t,r,n){var i;if(this instanceof a)return(i=o.call(this)).extent=e,i.pixelRatio_=r,i.resolution=t,i.state=n,i;throw new TypeError("Cannot call a class as a function")}return t=a,(e=[{key:"changed",value:function(){this.dispatchEvent(s.default.CHANGE)}},{key:"getExtent",value:function(){return this.extent}},{key:"getImage",value:function(){return(0,u.abstract)()}},{key:"getPixelRatio",value:function(){return this.pixelRatio_}},{key:"getResolution",value:function(){return this.resolution}},{key:"getState",value:function(){return this.state}},{key:"load",value:function(){(0,u.abstract)()}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.default);r.default=e},{"./events/EventType.js":127,"./events/Target.js":129,"./util.js":379}],79:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./ImageBase.js")),u=o(e("./ImageState.js"));function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,a=f(s);function s(e,t,r,n,i){var o;if(this instanceof s)return o=void 0!==i?u.default.IDLE:u.default.LOADED,(e=a.call(this,e,t,r,o)).loader_=void 0!==i?i:null,e.canvas_=n,e.error_=null,e;throw new TypeError("Cannot call a class as a function")}return t=s,(e=[{key:"getError",value:function(){return this.error_}},{key:"handleLoad_",value:function(e){e?(this.error_=e,this.state=u.default.ERROR):this.state=u.default.LOADED,this.changed()}},{key:"load",value:function(){this.state==u.default.IDLE&&(this.state=u.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}},{key:"getImage",value:function(){return this.canvas_}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default);r.default=e},{"./ImageBase.js":78,"./ImageState.js":80}],80:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},{}],81:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./Tile.js")),o=a(e("./TileState.js")),u=e("./dom.js"),l=e("./Image.js");function a(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,a=h(s);function s(e,t,r,n,i,o){if(this instanceof s)return(e=a.call(this,e,t,o)).crossOrigin_=n,e.src_=r,e.key=r,e.image_=new Image,null!==n&&(e.image_.crossOrigin=n),e.unlisten_=null,e.tileLoadFunction_=i,e;throw new TypeError("Cannot call a class as a function")}return t=s,(e=[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(e){this.image_=e,this.state=o.default.LOADED,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){var e;this.state=o.default.ERROR,this.unlistenImage_(),this.image_=((e=(0,u.createCanvasContext2D)(1,1)).fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas),this.changed()}},{key:"handleImageLoad_",value:function(){var e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=o.default.LOADED:this.state=o.default.EMPTY,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state==o.default.ERROR&&(this.state=o.default.IDLE,this.image_=new Image,null!==this.crossOrigin_)&&(this.image_.crossOrigin=this.crossOrigin_),this.state==o.default.IDLE&&(this.state=o.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,l.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default);r.default=e},{"./Image.js":77,"./Tile.js":94,"./TileState.js":98,"./dom.js":123}],82:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function n(e,t,r){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}var e,t,r;return e=n,(t=[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(e,t){this.points_.push(e,t,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[2+t]<e)return!1;for(var r=t-3;0<r&&this.points_[r+2]>e;)r-=3;var n,i=this.points_[2+t]-this.points_[r+2];return!(i<1e3/60)&&(n=this.points_[t]-this.points_[r],t=this.points_[1+t]-this.points_[r+1],this.angle_=Math.atan2(t,n),this.initialVelocity_=Math.sqrt(n*n+t*t)/i,this.initialVelocity_>this.minVelocity_)}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}])&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}();r.default=n},{}],83:[function(e,D,t){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(e("./Object.js")),s=o(e("./Collection.js")),u=o(e("./CollectionEventType.js")),l=o(e("./renderer/Composite.js")),c=o(e("./events/EventType.js")),f=o(e("./layer/Layer.js")),h=i(e("./layer/Group.js")),F=o(e("./MapBrowserEvent.js")),N=o(e("./MapBrowserEventHandler.js")),p=o(e("./MapBrowserEventType.js")),d=o(e("./MapEvent.js")),y=o(e("./MapEventType.js")),g=o(e("./MapProperty.js")),n=o(e("./ObjectEventType.js")),B=o(e("./pointer/EventType.js")),m=o(e("./render/EventType.js")),v=i(e("./TileQueue.js")),b=o(e("./View.js")),_=o(e("./ViewHint.js")),w=e("./has.js"),x=e("./functions.js"),S=e("./transform.js"),j=e("./asserts.js"),O=e("./extent.js"),G=e("./control/defaults.js"),U=e("./interaction/defaults.js"),P=e("./proj.js"),z=e("./util.js"),k=e("./size.js"),E=e("./events.js"),W=e("./dom.js");function T(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(T=function(e){return e?r:t})(e))}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=T(t);if(t&&t.has(e))return t.get(e);var r,n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((n=o?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=e[r]);return i.default=e,t&&t.set(e,i),i}function o(e){return e&&e.__esModule?e:{default:e}}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function R(){return(R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function M(e,t){return(M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function V(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=A(r),t=(e=n?(e=A(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return I(t)}}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e){e instanceof f.default?e.setMapInternal(null):e instanceof h.default&&e.getLayers().forEach(L)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e);var r,i=V(o);function o(e){var t;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");(t=i.call(this)).on,t.once,t.un;var r=function(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var r,n,i={},o=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new h.default({layers:e.layers});i[g.default.LAYERGROUP]=o,i[g.default.TARGET]=e.target,i[g.default.VIEW]=e.view instanceof b.default?e.view:new b.default,void 0!==e.controls&&(r=Array.isArray(e.controls)?new s.default(e.controls.slice()):((0,j.assert)("function"==typeof e.controls.getArray,47),e.controls));void 0!==e.interactions&&(n=Array.isArray(e.interactions)?new s.default(e.interactions.slice()):((0,j.assert)("function"==typeof e.interactions.getArray,48),e.interactions));o=void 0!==e.overlays?Array.isArray(e.overlays)?new s.default(e.overlays.slice()):((0,j.assert)("function"==typeof e.overlays.getArray,49),e.overlays):new s.default;return{controls:r,interactions:n,keyboardEventTarget:t,overlays:o,values:i}}(e=e||{}),n=(t.renderComplete_,t.loaded_=!0,t.boundHandleBrowserEvent_=t.handleBrowserEvent.bind(I(t)),t.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,t.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:w.DEVICE_PIXEL_RATIO,t.postRenderTimeoutHandle_,t.animationDelayKey_,t.animationDelay_=t.animationDelay_.bind(I(t)),t.coordinateToPixelTransform_=(0,S.create)(),t.pixelToCoordinateTransform_=(0,S.create)(),t.frameIndex_=0,t.frameState_=null,t.previousExtent_=null,t.viewPropertyListenerKey_=null,t.viewChangeListenerKey_=null,t.layerGroupPropertyListenerKeys_=null,t.viewport_=document.createElement("div"),t.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),t.viewport_.style.position="relative",t.viewport_.style.overflow="hidden",t.viewport_.style.width="100%",t.viewport_.style.height="100%",t.overlayContainer_=document.createElement("div"),t.overlayContainer_.style.position="absolute",t.overlayContainer_.style.zIndex="0",t.overlayContainer_.style.width="100%",t.overlayContainer_.style.height="100%",t.overlayContainer_.style.pointerEvents="none",t.overlayContainer_.className="ol-overlaycontainer",t.viewport_.appendChild(t.overlayContainer_),t.overlayContainerStopEvent_=document.createElement("div"),t.overlayContainerStopEvent_.style.position="absolute",t.overlayContainerStopEvent_.style.zIndex="0",t.overlayContainerStopEvent_.style.width="100%",t.overlayContainerStopEvent_.style.height="100%",t.overlayContainerStopEvent_.style.pointerEvents="none",t.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",t.viewport_.appendChild(t.overlayContainerStopEvent_),t.mapBrowserEventHandler_=null,t.moveTolerance_=e.moveTolerance,t.keyboardEventTarget_=r.keyboardEventTarget,t.targetChangeHandlerKeys_=null,t.controls=r.controls||(0,G.defaults)(),t.interactions=r.interactions||(0,U.defaults)({onFocusOnly:!0}),t.overlays_=r.overlays,t.overlayIdIndex_={},t.renderer_=null,t.postRenderFunctions_=[],t.tileQueue_=new v.default(t.getTilePriority.bind(I(t)),t.handleTileChange_.bind(I(t))),t.addChangeListener(g.default.LAYERGROUP,t.handleLayerGroupChanged_),t.addChangeListener(g.default.VIEW,t.handleViewChanged_),t.addChangeListener(g.default.SIZE,t.handleSizeChanged_),t.addChangeListener(g.default.TARGET,t.handleTargetChanged_),t.setProperties(r.values),I(t));return!e.view||e.view instanceof b.default||e.view.then(function(e){n.setView(new b.default(e))}),t.controls.addEventListener(u.default.ADD,function(e){e.element.setMap(this)}.bind(I(t))),t.controls.addEventListener(u.default.REMOVE,function(e){e.element.setMap(null)}.bind(I(t))),t.interactions.addEventListener(u.default.ADD,function(e){e.element.setMap(this)}.bind(I(t))),t.interactions.addEventListener(u.default.REMOVE,function(e){e.element.setMap(null)}.bind(I(t))),t.overlays_.addEventListener(u.default.ADD,function(e){this.addOverlayInternal_(e.element)}.bind(I(t))),t.overlays_.addEventListener(u.default.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)}.bind(I(t))),t.controls.forEach(function(e){e.setMap(this)}.bind(I(t))),t.interactions.forEach(function(e){e.setMap(this)}.bind(I(t))),t.overlays_.forEach(t.addOverlayInternal_.bind(I(t))),t}return t=o,(e=[{key:"addControl",value:function(e){this.getControls().push(e)}},{key:"addInteraction",value:function(e){this.getInteractions().push(e)}},{key:"addLayer",value:function(e){this.getLayerGroup().getLayers().push(e)}},{key:"handleLayerAdd_",value:function(e){!function e(t,r){if(t instanceof f.default)t.setMapInternal(r);else if(t instanceof h.default)for(var n=t.getLayers().getArray(),i=0,o=n.length;i<o;++i)e(n[i],r)}(e.layer,this)}},{key:"addOverlay",value:function(e){this.getOverlays().push(e)}},{key:"addOverlayInternal_",value:function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}},{key:"disposeInternal",value:function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.setTarget(null),R(A(o.prototype),"disposeInternal",this).call(this)}},{key:"forEachFeatureAtPixel",value:function(e,t,r){var n,i;if(this.frameState_&&this.renderer_)return e=this.getCoordinateFromPixelInternal(e),n=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance:0,i=void 0!==r.layerFilter?r.layerFilter:x.TRUE,r=!1!==r.checkWrapped,this.renderer_.forEachFeatureAtCoordinate(e,this.frameState_,n,r,t,null,i,null)}},{key:"getFeaturesAtPixel",value:function(e,t){var r=[];return this.forEachFeatureAtPixel(e,function(e){r.push(e)},t),r}},{key:"getAllLayers",value:function(){var r=[];return function t(e){e.forEach(function(e){e instanceof h.default?t(e.getLayers()):r.push(e)})}(this.getLayers()),r}},{key:"hasFeatureAtPixel",value:function(e,t){var r,n;return!(!this.frameState_||!this.renderer_)&&(e=this.getCoordinateFromPixelInternal(e),r=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:x.TRUE,n=void 0!==t.hitTolerance?t.hitTolerance:0,t=!1!==t.checkWrapped,this.renderer_.hasFeatureAtCoordinate(e,this.frameState_,n,t,r,null))}},{key:"getEventCoordinate",value:function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}},{key:"getEventCoordinateInternal",value:function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}},{key:"getEventPixel",value:function(e){var t=this.viewport_.getBoundingClientRect(),e="changedTouches"in e?e.changedTouches[0]:e;return[e.clientX-t.left,e.clientY-t.top]}},{key:"getTarget",value:function(){return this.get(g.default.TARGET)}},{key:"getTargetElement",value:function(){var e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null}},{key:"getCoordinateFromPixel",value:function(e){return(0,P.toUserCoordinate)(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(e){var t=this.frameState_;return t?(0,S.apply)(t.pixelToCoordinateTransform,e.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(e){e=this.overlayIdIndex_[e.toString()];return void 0!==e?e:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(g.default.LAYERGROUP)}},{key:"setLayers",value:function(e){var t=this.getLayerGroup();e instanceof s.default?t.setLayers(e):((t=t.getLayers()).clear(),t.extend(e))}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var n=e[t];if(n.visible){var i=n.layer.getRenderer();if(i&&!i.ready)return!0;i=n.layer.getSource();if(i&&i.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(e){e=(0,P.fromUserCoordinate)(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}},{key:"getPixelFromCoordinateInternal",value:function(e){var t=this.frameState_;return t?(0,S.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(g.default.SIZE)}},{key:"getView",value:function(){return this.get(g.default.VIEW)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var e=this.getTargetElement();return e?e.ownerDocument:document}},{key:"getTilePriority",value:function(e,t,r,n){return(0,v.getTilePriority)(this.frameState_,e,t,r,n)}},{key:"handleBrowserEvent",value:function(e,t){t=t||e.type;t=new F.default(t,this,e);this.handleMapBrowserEvent(t)}},{key:"handleMapBrowserEvent",value:function(e){if(this.frameState_){var t=e.originalEvent,r=t.type;if(r===B.default.POINTERDOWN||r===c.default.WHEEL||r===c.default.KEYDOWN){var r=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():r,t=t.target;if(this.overlayContainerStopEvent_.contains(t)||!(n===r?r.documentElement:n).contains(t))return}if(e.frameState=this.frameState_,!1!==this.dispatchEvent(e))for(var i=this.getInteractions().getArray().slice(),o=i.length-1;0<=o;o--){var a=i[o];if(a.getMap()===this&&a.getActive()&&this.getTargetElement())if(!a.handleEvent(e)||e.propagationStopped)break}}}},{key:"handlePostRender",value:function(){for(var e,t,r,n=this.frameState_,i=this.tileQueue_,o=(i.isEmpty()||(r=t=this.maxTilesLoading_,n&&((e=n.viewHints)[_.default.ANIMATING]||e[_.default.INTERACTING])&&(t=(e=8<Date.now()-n.time)?0:8,r=e?0:2),i.getTilesLoading()<t&&(i.reprioritize(),i.loadMoreTiles(t,r))),n&&this.renderer_&&!n.animate&&(!0===this.renderComplete_?(this.hasListener(m.default.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(m.default.RENDERCOMPLETE,n),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new d.default(y.default.LOADEND,this,n)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new d.default(y.default.LOADSTART,this,n)))),this.postRenderFunctions_),a=0,s=o.length;a<s;++a)o[a](this,n);o.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var e=0,t=this.targetChangeHandlerKeys_.length;e<t;++e)(0,E.unlistenByKey)(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(c.default.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(c.default.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),(this.mapBrowserEventHandler_=null,W.removeNode)(this.viewport_)}var r=this.getTargetElement();if(r){for(var n in r.appendChild(this.viewport_),this.renderer_||(this.renderer_=new l.default(this)),this.mapBrowserEventHandler_=new N.default(this,this.moveTolerance_),p.default)this.mapBrowserEventHandler_.addEventListener(p.default[n],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(c.default.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(c.default.WHEEL,this.boundHandleBrowserEvent_,!!w.PASSIVE_EVENT_LISTENERS&&{passive:!1});var i=this.getOwnerDocument().defaultView,r=this.keyboardEventTarget_||r;this.targetChangeHandlerKeys_=[(0,E.listen)(r,c.default.KEYDOWN,this.handleBrowserEvent,this),(0,E.listen)(r,c.default.KEYPRESS,this.handleBrowserEvent,this),(0,E.listen)(i,c.default.RESIZE,this.updateSize,this)]}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&((0,E.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,E.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=(0,E.listen)(e,n.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,E.listen)(e,c.default.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(E.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.handleLayerAdd_(new h.GroupEvent("addlayer",e)),this.layerGroupPropertyListenerKeys_=[(0,E.listen)(e,n.default.PROPERTYCHANGE,this.render,this),(0,E.listen)(e,c.default.CHANGE,this.render,this),(0,E.listen)(e,"addlayer",this.handleLayerAdd_,this),(0,E.listen)(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"animationDelay_",value:function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(e){return this.getControls().remove(e)}},{key:"removeInteraction",value:function(e){return this.getInteractions().remove(e)}},{key:"removeLayer",value:function(e){return this.getLayerGroup().getLayers().remove(e)}},{key:"handleLayerRemove_",value:function(e){L(e.layer)}},{key:"removeOverlay",value:function(e){return this.getOverlays().remove(e)}},{key:"renderFrame_",value:function(e){var t,r=this,n=this.getSize(),i=this.getView(),o=this.frameState_,a=null;void 0!==n&&(0,k.hasArea)(n)&&i&&i.isDef()&&(t=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),i=i.getState(),a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:(0,O.getForViewAndSize)(i.center,i.resolution,i.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:i,viewHints:t,wantedTiles:{},mapId:(0,z.getUid)(this),renderTargets:{}},i.nextCenter)&&i.nextResolution&&(e=isNaN(i.nextRotation)?i.rotation:i.nextRotation,a.nextExtent=(0,O.getForViewAndSize)(i.nextCenter,i.nextResolution,e,n)),this.frameState_=a,this.renderer_.renderFrame(a),!a||(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),!o||this.previousExtent_&&((0,O.isEmpty)(this.previousExtent_)||(0,O.equals)(a.extent,this.previousExtent_))||(this.dispatchEvent(new d.default(y.default.MOVESTART,this,o)),this.previousExtent_=(0,O.createOrUpdateEmpty)(this.previousExtent_)),!this.previousExtent_)||a.viewHints[_.default.ANIMATING]||a.viewHints[_.default.INTERACTING]||(0,O.equals)(a.extent,this.previousExtent_)||(this.dispatchEvent(new d.default(y.default.MOVEEND,this,a)),(0,O.clone)(a.extent,this.previousExtent_)),this.dispatchEvent(new d.default(y.default.POSTRENDER,this,a)),this.renderComplete_=this.hasListener(y.default.LOADSTART)||this.hasListener(y.default.LOADEND)||this.hasListener(m.default.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){r.postRenderTimeoutHandle_=void 0,r.handlePostRender()},0))}},{key:"setLayerGroup",value:function(e){var t=this.getLayerGroup();t&&this.handleLayerRemove_(new h.GroupEvent("removelayer",t)),this.set(g.default.LAYERGROUP,e)}},{key:"setSize",value:function(e){this.set(g.default.SIZE,e)}},{key:"setTarget",value:function(e){this.set(g.default.TARGET,e)}},{key:"setView",value:function(e){var t;!e||e instanceof b.default?this.set(g.default.VIEW,e):(this.set(g.default.VIEW,new b.default),t=this,e.then(function(e){t.setView(new b.default(e))}))}},{key:"updateSize",value:function(){var e,t,r=this.getTargetElement(),n=void 0;r&&(t=getComputedStyle(r),e=r.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),t=r.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth),isNaN(e)||isNaN(t)||!(0,k.hasArea)(n=[e,t])&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")),this.setSize(n),this.updateViewportSize_()}},{key:"updateViewportSize_",value:function(){var e,t,r=this.getView();r&&(e=void 0,(t=getComputedStyle(this.viewport_)).width&&t.height&&(e=[parseInt(t.width,10),parseInt(t.height,10)]),r.setViewportSize(e))}}])&&C(t.prototype,e),r&&C(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.default);t.default=e},{"./Collection.js":71,"./CollectionEventType.js":72,"./MapBrowserEvent.js":84,"./MapBrowserEventHandler.js":85,"./MapBrowserEventType.js":86,"./MapEvent.js":87,"./MapEventType.js":88,"./MapProperty.js":89,"./Object.js":90,"./ObjectEventType.js":91,"./TileQueue.js":96,"./View.js":101,"./ViewHint.js":102,"./asserts.js":105,"./control/defaults.js":120,"./dom.js":123,"./events.js":125,"./events/EventType.js":127,"./extent.js":131,"./functions.js":189,"./has.js":221,"./interaction/defaults.js":246,"./layer/Group.js":253,"./layer/Layer.js":256,"./pointer/EventType.js":270,"./proj.js":271,"./render/EventType.js":282,"./renderer/Composite.js":299,"./size.js":319,"./transform.js":377,"./util.js":379}],84:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,a=l(s);function s(e,t,r,n,i,o){if(this instanceof s)return(e=a.call(this,e,t,i)).originalEvent=r,e.pixel_=null,e.coordinate_=null,e.dragging=void 0!==n&&n,e.activePointers=o,e;throw new TypeError("Cannot call a class as a function")}return t=s,(e=[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(e){this.pixel_=e}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(e){this.coordinate_=e}},{key:"preventDefault",value:function(){o(c(s.prototype),"preventDefault",this).call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){o(c(s.prototype),"stopPropagation",this).call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}])&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(((e=e("./MapEvent.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./MapEvent.js":87}],85:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=h(e("./events/EventType.js")),a=h(e("./MapBrowserEvent.js")),s=h(e("./MapBrowserEventType.js")),u=h(e("./pointer/EventType.js")),n=h(e("./events/Target.js")),l=e("./has.js"),c=e("./functions.js"),f=e("./events.js");function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n=g(i);function i(e,t){var r;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(r=n.call(this,e)).map_=e,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=void 0===t?1:t,r.down_=null;e=r.map_.getViewport();return r.activePointers_=[],r.trackedTouches_={},r.element_=e,r.pointerdownListenerKey_=(0,f.listen)(e,u.default.POINTERDOWN,r.handlePointerDown_,m(r)),r.originalPointerMoveEvent_,r.relayedListenerKey_=(0,f.listen)(e,u.default.POINTERMOVE,r.relayMoveEvent_,m(r)),r.boundHandleTouchMove_=r.handleTouchMove_.bind(m(r)),r.element_.addEventListener(o.default.TOUCHMOVE,r.boundHandleTouchMove_,!!l.PASSIVE_EVENT_LISTENERS&&{passive:!1}),r}return t=i,(e=[{key:"emulateClick_",value:function(t){var e=new a.default(s.default.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new a.default(s.default.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new a.default(s.default.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)}},{key:"updateActivePointers_",value:function(e){var t=e,e=t.pointerId;if(t.type==s.default.POINTERUP||t.type==s.default.POINTERCANCEL){for(var r in delete this.trackedTouches_[e],this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else t.type!=s.default.POINTERDOWN&&t.type!=s.default.POINTERMOVE||(this.trackedTouches_[e]=t);this.activePointers_=Object.values(this.trackedTouches_)}},{key:"handlePointerUp_",value:function(e){this.updateActivePointers_(e);var t=new a.default(s.default.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(f.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(e){return 0===e.button}},{key:"handlePointerDown_",value:function(e){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(e);var t,r=new a.default(s.default.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);for(t in this.dispatchEvent(r),this.down_={},e){var n=e[t];this.down_[t]="function"==typeof n?c.VOID:n}0===this.dragListenerKeys_.length&&(r=this.map_.getOwnerDocument(),this.dragListenerKeys_.push((0,f.listen)(r,s.default.POINTERMOVE,this.handlePointerMove_,this),(0,f.listen)(r,s.default.POINTERUP,this.handlePointerUp_,this),(0,f.listen)(this.element_,s.default.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode)&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push((0,f.listen)(this.element_.getRootNode(),s.default.POINTERUP,this.handlePointerUp_,this))}},{key:"handlePointerMove_",value:function(e){this.isMoving_(e)&&(this.updateActivePointers_(e),this.dragging_=!0,e=new a.default(s.default.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_),this.dispatchEvent(e))}},{key:"relayMoveEvent_",value:function(e){this.originalPointerMoveEvent_=e;var t=!(!this.down_||!this.isMoving_(e));this.dispatchEvent(new a.default(s.default.POINTERMOVE,this.map_,e,t))}},{key:"handleTouchMove_",value:function(e){var t=this.originalPointerMoveEvent_;t&&!t.defaultPrevented||"boolean"==typeof e.cancelable&&!0!==e.cancelable||e.preventDefault()}},{key:"isMoving_",value:function(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&((0,f.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(o.default.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,f.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(f.unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,d(v(i.prototype),"disposeInternal",this).call(this)}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"./MapBrowserEvent.js":84,"./MapBrowserEventType.js":86,"./events.js":125,"./events/EventType.js":127,"./events/Target.js":129,"./functions.js":189,"./has.js":221,"./pointer/EventType.js":270}],86:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=(e=e("./events/EventType.js"))&&e.__esModule?e:{default:e};e={SINGLECLICK:"singleclick",CLICK:e.default.CLICK,DBLCLICK:e.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};r.default=e},{"./events/EventType.js":127}],87:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return(e=i.call(this,e)).map=t,e.frameState=void 0!==r?r:null,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./events/Event.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./events/Event.js":126}],88:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}},{}],89:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"}},{}],90:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ObjectEvent=void 0;var o=n(e("./events/Event.js")),a=n(e("./ObjectEventType.js")),s=n(e("./Observable.js")),u=e("./util.js"),l=e("./obj.js");function n(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(r),t=(e=n?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(){p(i,o["default"]);var n=y(i);function i(e,t,r){return h(this,i),(e=n.call(this,e)).key=t,e.oldValue=r,e}return f(i)}(),e=(r.ObjectEvent=v,function(){p(n,s["default"]);var r=y(n);function n(e){var t;return h(this,n),(t=r.call(this)).on,t.once,t.un,(0,u.getUid)(g(t)),t.values_=null,void 0!==e&&t.setProperties(e),t}return f(n,[{key:"get",value:function(e){var t;return t=this.values_&&this.values_.hasOwnProperty(e)?this.values_[e]:t}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Object.assign({},this.values_)||{}}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(e,t){var r="change:".concat(e);this.hasListener(r)&&this.dispatchEvent(new v(r,e,t)),r=a.default.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new v(r,e,t))}},{key:"addChangeListener",value:function(e,t){this.addEventListener("change:".concat(e),t)}},{key:"removeChangeListener",value:function(e,t){this.removeEventListener("change:".concat(e),t)}},{key:"set",value:function(e,t,r){var n=this.values_||(this.values_={});r?n[e]=t:(r=n[e])!==(n[e]=t)&&this.notify(e,r)}},{key:"setProperties",value:function(e,t){for(var r in e)this.set(r,e[r],t)}},{key:"applyProperties",value:function(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}},{key:"unset",value:function(e,t){var r;this.values_&&e in this.values_&&(r=this.values_[e],delete this.values_[e],(0,l.isEmpty)(this.values_)&&(this.values_=null),t||this.notify(e,r))}}]),n}());r.default=e},{"./ObjectEventType.js":91,"./Observable.js":92,"./events/Event.js":126,"./obj.js":269,"./util.js":379}],91:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={PROPERTYCHANGE:"propertychange"}},{}],92:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.unByKey=h;var n=s(e("./events/Target.js")),o=s(e("./events/EventType.js")),a=e("./events.js");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(){var e;if(this instanceof i)return(e=n.call(this)).on=e.onInternal,e.once=e.onceInternal,e.un=e.unInternal,e.revision_=0,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(o.default.CHANGE)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(e,t){if(Array.isArray(e)){for(var r=e.length,n=new Array(r),i=0;i<r;++i)n[i]=(0,a.listen)(this,e[i],t);return n}return(0,a.listen)(this,e,t)}},{key:"onceInternal",value:function(e,t){if(Array.isArray(e))for(var r=e.length,n=new Array(r),i=0;i<r;++i)n[i]=(0,a.listenOnce)(this,e[i],t);else n=(0,a.listenOnce)(this,e,t);return t.ol_key=n}},{key:"unInternal",value:function(e,t){var r=t.ol_key;if(r)h(r);else if(Array.isArray(e))for(var n=0,i=e.length;n<i;++n)this.removeEventListener(e[n],t);else this.removeEventListener(e,t)}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function h(e){if(Array.isArray(e))for(var t=0,r=e.length;t<r;++t)(0,a.unlistenByKey)(e[t]);else(0,a.unlistenByKey)(e)}e.prototype.on,e.prototype.once,e.prototype.un,r.default=e},{"./events.js":125,"./events/EventType.js":127,"./events/Target.js":129}],93:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("./Object.js")),o=c(e("./MapEventType.js")),a=e("./css.js"),u=e("./extent.js"),s=e("./events.js"),l=e("./dom.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y="element",g="map",m="offset",v="position",b="positioning",e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).on,t.once,t.un,t.options=e,t.id=e.id,t.insertFirst=void 0===e.insertFirst||e.insertFirst,t.stopEvent=void 0===e.stopEvent||e.stopEvent,t.element=document.createElement("div"),t.element.className=void 0!==e.className?e.className:"ol-overlay-container "+a.CLASS_SELECTABLE,t.element.style.position="absolute",t.element.style.pointerEvents="auto",t.autoPan=!0===e.autoPan?{}:e.autoPan||void 0,t.rendered={transform_:"",visible:!0},t.mapPostrenderListenerKey=null,t.addChangeListener(y,t.handleElementChanged),t.addChangeListener(g,t.handleMapChanged),t.addChangeListener(m,t.handleOffsetChanged),t.addChangeListener(v,t.handlePositionChanged),t.addChangeListener(b,t.handlePositioningChanged),void 0!==e.element&&t.setElement(e.element),t.setOffset(void 0!==e.offset?e.offset:[0,0]),t.setPositioning(e.positioning||"top-left"),void 0!==e.position&&t.setPosition(e.position),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getElement",value:function(){return this.get(y)}},{key:"getId",value:function(){return this.id}},{key:"getMap",value:function(){return this.get(g)||null}},{key:"getOffset",value:function(){return this.get(m)}},{key:"getPosition",value:function(){return this.get(v)}},{key:"getPositioning",value:function(){return this.get(b)}},{key:"handleElementChanged",value:function(){(0,l.removeChildren)(this.element);var e=this.getElement();e&&this.element.appendChild(e)}},{key:"handleMapChanged",value:function(){this.mapPostrenderListenerKey&&((0,l.removeNode)(this.element),(0,s.unlistenByKey)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var e=this.getMap();e&&(this.mapPostrenderListenerKey=(0,s.listen)(e,o.default.POSTRENDER,this.render,this),this.updatePixelPosition(),e=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer(),this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan())}},{key:"render",value:function(){this.updatePixelPosition()}},{key:"handleOffsetChanged",value:function(){this.updatePixelPosition()}},{key:"handlePositionChanged",value:function(){this.updatePixelPosition(),this.performAutoPan()}},{key:"handlePositioningChanged",value:function(){this.updatePixelPosition()}},{key:"setElement",value:function(e){this.set(y,e)}},{key:"setMap",value:function(e){this.set(g,e)}},{key:"setOffset",value:function(e){this.set(m,e)}},{key:"setPosition",value:function(e){this.set(v,e)}},{key:"performAutoPan",value:function(){this.autoPan&&this.panIntoView(this.autoPan)}},{key:"panIntoView",value:function(e){var t,r,n,i,o,a,s=this.getMap();s&&s.getTargetElement()&&this.get(v)&&(a=this.getRect(s.getTargetElement(),s.getSize()),r=this.getElement(),r=this.getRect(r,[(0,l.outerWidth)(r),(0,l.outerHeight)(r)]),t=void 0===(e=e||{}).margin?20:e.margin,(0,u.containsExtent)(a,r)||(n=r[0]-a[0],i=a[2]-r[2],o=r[1]-a[1],a=a[3]-r[3],r=[0,0],n<0?r[0]=n-t:i<0&&(r[0]=Math.abs(i)+t),o<0?r[1]=o-t:a<0&&(r[1]=Math.abs(a)+t),(0!==r[0]||0!==r[1])&&(n=s.getView().getCenterInternal(),i=s.getPixelFromCoordinateInternal(n))&&(o=[i[0]+r[0],i[1]+r[1]],a=e.animation||{},s.getView().animateInternal({center:s.getCoordinateFromPixelInternal(o),duration:a.duration,easing:a.easing}))))}},{key:"getRect",value:function(e,t){var e=e.getBoundingClientRect(),r=e.left+window.pageXOffset,e=e.top+window.pageYOffset;return[r,e,r+t[0],e+t[1]]}},{key:"setPositioning",value:function(e){this.set(b,e)}},{key:"setVisible",value:function(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}},{key:"updatePixelPosition",value:function(){var e=this.getMap(),t=this.getPosition();e&&e.isRendered()&&t?(t=e.getPixelFromCoordinate(t),e=e.getSize(),this.updateRenderedPosition(t,e)):this.setVisible(!1)}},{key:"updateRenderedPosition",value:function(e,t){var r=this.element.style,n=this.getOffset(),i=this.getPositioning(),o=(this.setVisible(!0),Math.round(e[0]+n[0])+"px"),e=Math.round(e[1]+n[1])+"px",n="0%",a="0%",i=("bottom-right"==i||"center-right"==i||"top-right"==i?n="-100%":"bottom-center"!=i&&"center-center"!=i&&"top-center"!=i||(n="-50%"),"bottom-left"==i||"bottom-center"==i||"bottom-right"==i?a="-100%":"center-left"!=i&&"center-center"!=i&&"center-right"!=i||(a="-50%"),"translate(".concat(n,", ").concat(a,") translate(").concat(o,", ").concat(e,")"));this.rendered.transform_!=i&&(this.rendered.transform_=i,r.transform=i)}},{key:"getOptions",value:function(){return this.options}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"./MapEventType.js":88,"./Object.js":90,"./css.js":122,"./dom.js":123,"./events.js":125,"./extent.js":131}],94:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./events/Target.js")),a=o(e("./events/EventType.js")),s=o(e("./TileState.js")),u=e("./util.js"),l=e("./easing.js");function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,i=h(o);function o(e,t,r){var n;if(this instanceof o)return r=r||{},(n=i.call(this)).tileCoord=e,n.state=t,n.interimTile=null,n.key="",n.transition_=void 0===r.transition?250:r.transition,n.transitionStarts_={},n.interpolate=!!r.interpolate,n;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"changed",value:function(){this.dispatchEvent(a.default.CHANGE)}},{key:"release",value:function(){this.state===s.default.ERROR&&this.setState(s.default.EMPTY)}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){if(this.interimTile){var e=this.interimTile;do{if(e.getState()==s.default.LOADED)return this.transition_=0,e}while(e=e.interimTile)}return this}},{key:"refreshInterimChain",value:function(){if(this.interimTile){var e=this.interimTile,t=this;do{if(e.getState()==s.default.LOADED){e.interimTile=null;break}}while(e.getState()!=s.default.LOADING&&e.getState()==s.default.IDLE?t.interimTile=e.interimTile:t=e,e=t.interimTile)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){if(this.state!==s.default.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}},{key:"load",value:function(){(0,u.abstract)()}},{key:"getAlpha",value:function(e,t){if(!this.transition_)return 1;var r=this.transitionStarts_[e];if(r){if(-1===r)return 1}else this.transitionStarts_[e]=r=t;e=t-r+1e3/60;return e>=this.transition_?1:(0,l.easeIn)(e/this.transition_)}},{key:"inTransition",value:function(e){return!!this.transition_&&-1!==this.transitionStarts_[e]}},{key:"endTransition",value:function(e){this.transition_&&(this.transitionStarts_[e]=-1)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"./TileState.js":98,"./easing.js":124,"./events/EventType.js":127,"./events/Target.js":129,"./util.js":379}],95:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./structs/LRUCache.js"))&&n.__esModule?n:{default:n},o=e("./tilecoord.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(){var e=this,t=i;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clear",value:function(){for(;0<this.getCount();)this.pop().release();s(c(i.prototype),"clear",this).call(this)}},{key:"expireCache",value:function(e){for(;this.canExpireCache();){if(this.peekLast().getKey()in e)break;this.pop().release()}}},{key:"pruneExceptNewestZ",value:function(){var e,t;0!==this.getCount()&&(e=this.peekFirstKey(),t=(0,o.fromKey)(e)[0],this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove((0,o.getKey)(e.tileCoord)),e.release())}.bind(this)))}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"./structs/LRUCache.js":355,"./tilecoord.js":371}],96:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.getTilePriority=function(e,t,r,n,i){return e&&r in e.wantedTiles&&e.wantedTiles[r][t.getKey()]?(r=e.viewState.center,t=n[0]-r[0],e=n[1]-r[1],65536*Math.log(i)+Math.sqrt(t*t+e*e)/i):s.DROP};var o=n(e("./events/EventType.js")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./structs/PriorityQueue.js")),u=n(e("./TileState.js"));function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(t,e){var r;if(this instanceof i)return(r=n.call(this,function(e){return t.apply(null,e)},function(e){return e[0].getKey()})).boundHandleTileChange_=r.handleTileChange.bind(d(r)),r.tileChangeCallback_=e,r.tilesLoading_=0,r.tilesLoadingKeys_={},r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"enqueue",value:function(e){var t=f(y(i.prototype),"enqueue",this).call(this,e);return t&&e[0].addEventListener(o.default.CHANGE,this.boundHandleTileChange_),t}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(e){var e=e.target,t=e.getState();t!==u.default.LOADED&&t!==u.default.ERROR&&t!==u.default.EMPTY||(t!==u.default.ERROR&&e.removeEventListener(o.default.CHANGE,this.boundHandleTileChange_),(t=e.getKey())in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_())}},{key:"loadMoreTiles",value:function(e,t){for(var r,n,i=0;this.tilesLoading_<e&&i<t&&0<this.getCount();)n=(r=this.dequeue()[0]).getKey(),r.getState()!==u.default.IDLE||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++i,r.load())}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.default);r.default=e},{"./TileState.js":98,"./events/EventType.js":127,"./structs/PriorityQueue.js":356}],97:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.createOrUpdate=function(e,t,r,n,i){return void 0!==i?(i.minX=e,i.maxX=t,i.minY=r,i.maxY=n,i):new o(e,t,r,n)},r.default=void 0;var o=function(){function i(e,t,r,n){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.minX=e,this.maxX=t,this.minY=r,this.maxY=n}var e,t,r;return e=i,(t=[{key:"contains",value:function(e){return this.containsXY(e[1],e[2])}},{key:"containsTileRange",value:function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}},{key:"containsXY",value:function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}},{key:"equals",value:function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}},{key:"extend",value:function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}])&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();r.default=o},{}],98:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},{}],99:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Tile.js"))&&n.__esModule?n:{default:n},a=e("./dom.js"),s=e("./util.js");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=[],e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,i=f(o);function o(e,t,r,n){if(this instanceof o)return(e=i.call(this,e,t,{transition:0})).context_={},e.executorGroups={},e.declutterExecutorGroups={},e.loadingSourceTiles=0,e.hitDetectionImageData={},e.replayState_={},e.sourceTiles=[],e.errorTileKeys={},e.wantedResolution,e.getSourceTiles=n.bind(void 0,h(e)),e.wrappedTileCoord=r,e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"getContext",value:function(e){e=(0,s.getUid)(e);return e in this.context_||(this.context_[e]=(0,a.createCanvasContext2D)(1,1,d)),this.context_[e]}},{key:"hasContext",value:function(e){return(0,s.getUid)(e)in this.context_}},{key:"getImage",value:function(e){return this.hasContext(e)?this.getContext(e).canvas:null}},{key:"getReplayState",value:function(e){e=(0,s.getUid)(e);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}},{key:"load",value:function(){this.getSourceTiles()}},{key:"release",value:function(){for(var e in this.context_){var t=this.context_[e];(0,a.releaseCanvas)(t),d.push(t.canvas),delete this.context_[e]}l(p(o.prototype),"release",this).call(this)}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"./Tile.js":94,"./dom.js":123,"./util.js":379}],100:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./Tile.js")),o=a(e("./TileState.js"));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,a=c(s);function s(e,t,r,n,i,o){if(this instanceof s)return(e=a.call(this,e,t,o)).extent=null,e.format_=n,e.features_=null,e.loader_,e.projection=null,e.resolution,e.tileLoadFunction_=i,e.url_=r,e.key=r,e;throw new TypeError("Cannot call a class as a function")}return t=s,(e=[{key:"getFormat",value:function(){return this.format_}},{key:"getFeatures",value:function(){return this.features_}},{key:"load",value:function(){this.state==o.default.IDLE&&(this.setState(o.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_)&&this.loader_(this.extent,this.resolution,this.projection)}},{key:"onLoad",value:function(e,t){this.setFeatures(e)}},{key:"onError",value:function(){this.setState(o.default.ERROR)}},{key:"setFeatures",value:function(e){this.features_=e,this.setState(o.default.LOADED)}},{key:"setLoader",value:function(e){this.loader_=e}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default);r.default=e},{"./Tile.js":94,"./TileState.js":98}],101:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.createCenterConstraint=k,r.createResolutionConstraint=E,r.createRotationConstraint=T,r.default=void 0,r.isNoopAnimation=C;var n=_(e("./Object.js")),d=_(e("./ViewHint.js")),a=_(e("./ViewProperty.js")),p=e("./tilegrid/common.js"),y=e("./proj.js"),s=e("./functions.js"),o=e("./coordinate.js"),u=e("./asserts.js"),l=e("./centerconstraint.js"),g=e("./math.js"),m=e("./resolutionconstraint.js"),c=e("./rotationconstraint.js"),h=e("./easing.js"),v=e("./extent.js"),f=e("./array.js"),b=e("./geom/Polygon.js");function _(e){return e&&e.__esModule?e:{default:e}}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=j(r),t=(e=n?(e=j(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=0,e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e);var r,n=S(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).on,t.once,t.un,e=Object.assign({},e),t.hints_=[0,0],t.animations_=[],t.updateAnimationKey_,t.projection_=(0,y.createProjection)(e.projection,"EPSG:3857"),t.viewportSize_=[100,100],t.targetCenter_=null,t.targetResolution_,t.targetRotation_,t.nextCenter_=null,t.nextResolution_,t.nextRotation_,t.cancelAnchor_=void 0,e.projection&&(0,y.disableCoordinateWarning)(),e.center&&(e.center=(0,y.fromUserCoordinate)(e.center,t.projection_)),e.extent&&(e.extent=(0,y.fromUserExtent)(e.extent,t.projection_)),t.applyOptions_(e),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"applyOptions_",value:function(e){var t,r=Object.assign({},e);for(t in a.default)delete r[t];this.setProperties(r,!0);var n=E(e),i=(this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=n.minZoom,k(e)),n=n.constraint,o=T(e);this.constraints_={center:i,resolution:n,rotation:o},this.setRotation(void 0!==e.rotation?e.rotation:0),this.setCenterInternal(void 0!==e.center?e.center:null),void 0!==e.resolution?this.setResolution(e.resolution):void 0!==e.zoom&&this.setZoom(e.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(e){var t,r,n=this.padding_,i=(this.padding_=e,this.getCenter());i&&(e=e||[0,0,0,0],n=n||[0,0,0,0],t=(r=this.getResolution())/2*(e[3]-n[3]+n[1]-e[1]),r=r/2*(e[0]-n[0]+n[2]-e[2]),this.setCenterInternal([i[0]+t,i[1]-r]))}},{key:"getUpdatedOptions_",value:function(e){var t=this.getProperties();return void 0!==t.resolution?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}},{key:"animate",value:function(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var t=new Array(arguments.length),r=0;r<t.length;++r){var n=arguments[r];n.center&&((n=Object.assign({},n)).center=(0,y.fromUserCoordinate)(n.center,this.getProjection())),n.anchor&&((n=Object.assign({},n)).anchor=(0,y.fromUserCoordinate)(n.anchor,this.getProjection())),t[r]=n}this.animateInternal.apply(this,t)}},{key:"animateInternal",value:function(e){for(var t,r=arguments.length,n=(1<r&&"function"==typeof arguments[r-1]&&(t=arguments[r-1],--r),0);n<r&&!this.isDef();++n){var i=arguments[n];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(n===r)t&&P(t,!0);else{for(var o=Date.now(),a=this.targetCenter_.slice(),s=this.targetResolution_,u=this.targetRotation_,l=[];n<r;++n){var c=arguments[n],f={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||h.inAndOut,callback:t};c.center&&(f.sourceCenter=a,f.targetCenter=c.center.slice(),a=f.targetCenter),void 0!==c.zoom?(f.sourceResolution=s,f.targetResolution=this.getResolutionForZoom(c.zoom),s=f.targetResolution):c.resolution&&(f.sourceResolution=s,f.targetResolution=c.resolution,s=f.targetResolution),void 0!==c.rotation&&(f.sourceRotation=u,c=(0,g.modulo)(c.rotation-u+Math.PI,2*Math.PI)-Math.PI,f.targetRotation=u+c,u=f.targetRotation),C(f)?f.complete=!0:o+=f.duration,l.push(f)}this.animations_.push(l),this.setHint(d.default.ANIMATING,1),this.updateAnimations_()}}},{key:"getAnimating",value:function(){return 0<this.hints_[d.default.ANIMATING]}},{key:"getInteracting",value:function(){return 0<this.hints_[d.default.INTERACTING]}},{key:"cancelAnimations",value:function(){var e;this.setHint(d.default.ANIMATING,-this.hints_[d.default.ANIMATING]);for(var t=0,r=this.animations_.length;t<r;++t){var n=this.animations_[t];if(n[0].callback&&P(n[0].callback,!1),!e)for(var i=0,o=n.length;i<o;++i){var a=n[i];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var e=Date.now(),t=!1,r=this.animations_.length-1;0<=r;--r){for(var n,i=this.animations_[r],o=!0,a=0,s=i.length;a<s;++a){var u=i[a];if(!u.complete){var l,c,f,h,p=e-u.start,p=0<u.duration?p/u.duration:1,p=(1<=p?(u.complete=!0,p=1):o=!1,u.easing(p));if(u.sourceCenter&&(c=u.sourceCenter[0],h=u.sourceCenter[1],l=u.targetCenter[0],f=u.targetCenter[1],this.nextCenter_=u.targetCenter,this.targetCenter_=[c+p*(l-c),h+p*(f-h)]),u.sourceResolution&&u.targetResolution&&(l=1===p?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution),u.anchor&&(c=this.getViewportSize_(this.getRotation()),f=this.constraints_.resolution(l,0,c,!0),this.targetCenter_=this.calculateCenterZoom(f,u.anchor)),this.nextResolution_=u.targetResolution,this.targetResolution_=l,this.applyTargetState_(!0)),void 0!==u.sourceRotation&&void 0!==u.targetRotation&&(h=1===p?(0,g.modulo)(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation),u.anchor&&(p=this.constraints_.rotation(h,!0),this.targetCenter_=this.calculateCenterRotate(p,u.anchor)),this.nextRotation_=u.targetRotation,this.targetRotation_=h),this.applyTargetState_(!0),t=!0,!u.complete)break}}o&&(this.animations_[r]=null,this.setHint(d.default.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN,n=i[0].callback)&&P(n,!0)}this.animations_=this.animations_.filter(Boolean),t&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(e,t){var r,n=this.getCenterInternal();return void 0!==n&&(r=[n[0]-t[0],n[1]-t[1]],(0,o.rotate)(r,e-this.getRotation()),(0,o.add)(r,t)),r}},{key:"calculateCenterZoom",value:function(e,t){var r,n=this.getCenterInternal(),i=this.getResolution();return r=void 0!==n&&void 0!==i?[t[0]-e*(t[0]-n[0])/i,t[1]-e*(t[1]-n[1])/i]:r}},{key:"getViewportSize_",value:function(e){var t,r,n=this.viewportSize_;return e?(t=n[0],r=n[1],[Math.abs(t*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(t*Math.sin(e))+Math.abs(r*Math.cos(e))]):n}},{key:"setViewportSize",value:function(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var e=this.getCenterInternal();return e&&(0,y.toUserCoordinate)(e,this.getProjection())}},{key:"getCenterInternal",value:function(){return this.get(a.default.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(e){return void 0!==e?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}},{key:"calculateExtent",value:function(e){e=this.calculateExtentInternal(e);return(0,y.toUserExtent)(e,this.getProjection())}},{key:"calculateExtentInternal",value:function(e){e=e||this.getViewportSizeMinusPadding_();var t=this.getCenterInternal(),r=((0,u.assert)(t,1),this.getResolution()),n=((0,u.assert)(void 0!==r,2),this.getRotation());return(0,u.assert)(void 0!==n,3),(0,v.getForViewAndSize)(t,r,n,e)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}},{key:"setConstrainResolution",value:function(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(a.default.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(e,t){return this.getResolutionForExtentInternal((0,y.fromUserExtent)(e,this.getProjection()),t)}},{key:"getResolutionForExtentInternal",value:function(e,t){t=t||this.getViewportSizeMinusPadding_();var r=(0,v.getWidth)(e)/t[0],e=(0,v.getHeight)(e)/t[1];return Math.max(r,e)}},{key:"getResolutionForValueFunction",value:function(t){t=t||2;var r=this.getConstrainedResolution(this.maxResolution_),e=this.minResolution_,n=Math.log(r/e)/Math.log(t);return function(e){return r/Math.pow(t,e*n)}}},{key:"getRotation",value:function(){return this.get(a.default.ROTATION)}},{key:"getValueForResolutionFunction",value:function(e){var t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),e=this.minResolution_,n=Math.log(r/e)/t;return function(e){return Math.log(r/e)/t/n}}},{key:"getViewportSizeMinusPadding_",value:function(e){var e=this.getViewportSize_(e),t=this.padding_;return e=t?[e[0]-t[1]-t[3],e[1]-t[0]-t[2]]:e}},{key:"getState",value:function(){var e,t=this.getProjection(),r=this.getResolution(),n=this.getRotation(),i=this.getCenterInternal(),o=this.padding_;return o&&(e=this.getViewportSizeMinusPadding_(),i=R(i,this.getViewportSize_(),[e[0]/2+o[3],e[1]/2+o[0]],r,n)),{center:i.slice(0),projection:void 0!==t?t:null,resolution:r,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}},{key:"getZoom",value:function(){var e,t=this.getResolution();return e=void 0!==t?this.getZoomForResolution(t):e}},{key:"getZoomForResolution",value:function(e){var t,r,n=this.minZoom_||0;return r=this.resolutions_?(r=(0,f.linearFindNearest)(this.resolutions_,e,1),t=this.resolutions_[n=r],r==this.resolutions_.length-1?2:t/this.resolutions_[r+1]):(t=this.maxResolution_,this.zoomFactor_),n+Math.log(t/e)/Math.log(r)}},{key:"getResolutionForZoom",value:function(e){var t,r;return this.resolutions_?this.resolutions_.length<=1?0:(t=(0,g.clamp)(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1],this.resolutions_[t]/Math.pow(r,(0,g.clamp)(e-t,0,1))):this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}},{key:"fit",value:function(e,t){var r,n;(0,u.assert)(Array.isArray(e)||"function"==typeof e.getSimplifiedGeometry,24),Array.isArray(e)?((0,u.assert)(!(0,v.isEmpty)(e),25),r=(0,y.fromUserExtent)(e,this.getProjection()),r=(0,b.fromExtent)(r)):"Circle"===e.getType()?(n=(0,y.fromUserExtent)(e.getExtent(),this.getProjection()),(r=(0,b.fromExtent)(n)).rotate(this.getRotation(),(0,v.getCenter)(n))):r=(n=(0,y.getUserProjection)())?e.clone().transform(n,this.getProjection()):e,this.fitInternal(r,t)}},{key:"rotatedExtentForGeometry",value:function(e){for(var t=this.getRotation(),r=Math.cos(t),n=Math.sin(-t),i=e.getFlatCoordinates(),o=e.getStride(),a=1/0,s=1/0,u=-1/0,l=-1/0,c=0,f=i.length;c<f;c+=o)var h=i[c]*r-i[c+1]*n,p=i[c]*n+i[c+1]*r,a=Math.min(a,h),s=Math.min(s,p),u=Math.max(u,h),l=Math.max(l,p);return[a,s,u,l]}},{key:"fitInternal",value:function(e,t){var r=(r=(t=t||{}).size)||this.getViewportSizeMinusPadding_(),n=void 0!==t.padding?t.padding:[0,0,0,0],i=void 0!==t.nearest&&t.nearest,o=void 0!==t.minResolution?t.minResolution:void 0!==t.maxZoom?this.getResolutionForZoom(t.maxZoom):0,e=this.rotatedExtentForGeometry(e),r=this.getResolutionForExtentInternal(e,[r[0]-n[1]-n[3],r[1]-n[0]-n[2]]),r=isNaN(r)?o:Math.max(r,o),o=(r=this.getConstrainedResolution(r,i?0:1),this.getRotation()),i=Math.sin(o),o=Math.cos(o),e=(0,v.getCenter)(e),n=(e[0]+=(n[1]-n[3])/2*r,e[1]+=(n[0]-n[2])/2*r,e[0]*o-e[1]*i),o=e[1]*o+e[0]*i,e=this.getConstrainedCenter([n,o],r),i=t.callback||s.VOID;void 0!==t.duration?this.animateInternal({resolution:r,center:e,duration:t.duration,easing:t.easing},i):(this.targetResolution_=r,this.targetCenter_=e,this.applyTargetState_(!1,!0),P(i,!0))}},{key:"centerOn",value:function(e,t,r){this.centerOnInternal((0,y.fromUserCoordinate)(e,this.getProjection()),t,r)}},{key:"centerOnInternal",value:function(e,t,r){this.setCenterInternal(R(e,t,r,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(e,t,r,n){var i,o=this.padding_;return o&&e&&(n=R(e,n,[(n=this.getViewportSizeMinusPadding_(-r))[0]/2+o[3],n[1]/2+o[0]],t,r),i=[e[0]-n[0],e[1]-n[1]]),i}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(e){var t=(0,y.toUserCoordinate)(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}},{key:"adjustCenterInternal",value:function(e){var t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}},{key:"adjustResolution",value:function(e,t){t=t&&(0,y.fromUserCoordinate)(t,this.getProjection()),this.adjustResolutionInternal(e,t)}},{key:"adjustResolutionInternal",value:function(e,t){var r=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(this.targetResolution_*e,0,n,r);t&&(this.targetCenter_=this.calculateCenterZoom(n,t)),this.targetResolution_*=e,this.applyTargetState_()}},{key:"adjustZoom",value:function(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}},{key:"adjustRotation",value:function(e,t){t=t&&(0,y.fromUserCoordinate)(t,this.getProjection()),this.adjustRotationInternal(e,t)}},{key:"adjustRotationInternal",value:function(e,t){var r=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}},{key:"setCenter",value:function(e){this.setCenterInternal(e&&(0,y.fromUserCoordinate)(e,this.getProjection()))}},{key:"setCenterInternal",value:function(e){this.targetCenter_=e,this.applyTargetState_()}},{key:"setHint",value:function(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}},{key:"setResolution",value:function(e){this.targetResolution_=e,this.applyTargetState_()}},{key:"setRotation",value:function(e){this.targetRotation_=e,this.applyTargetState_()}},{key:"setZoom",value:function(e){this.setResolution(this.getResolutionForZoom(e))}},{key:"applyTargetState_",value:function(e,t){var t=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,t),n=this.getViewportSize_(r),i=this.constraints_.resolution(this.targetResolution_,0,n,t),t=this.constraints_.center(this.targetCenter_,i,n,t,this.calculateCenterShift(this.targetCenter_,i,r,n));this.get(a.default.ROTATION)!==r&&this.set(a.default.ROTATION,r),this.get(a.default.RESOLUTION)!==i&&(this.set(a.default.RESOLUTION,i),this.set("zoom",this.getZoom(),!0)),t&&this.get(a.default.CENTER)&&(0,o.equals)(this.get(a.default.CENTER),t)||this.set(a.default.CENTER,t),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(e,t,r){e=void 0!==e?e:200;var t=t||0,n=this.constraints_.rotation(this.targetRotation_),i=this.getViewportSize_(n),t=this.constraints_.resolution(this.targetResolution_,t,i),i=this.constraints_.center(this.targetCenter_,t,i,!1,this.calculateCenterShift(this.targetCenter_,t,n,i));0!==e||this.cancelAnchor_?(r=r||(0===e?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===t&&this.getRotation()===n&&this.getCenterInternal()&&(0,o.equals)(this.getCenterInternal(),i)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:n,center:i,resolution:t,duration:e,easing:h.easeOut,anchor:r}))):(this.targetResolution_=t,this.targetRotation_=n,this.targetCenter_=i,this.applyTargetState_())}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(d.default.INTERACTING,1)}},{key:"endInteraction",value:function(e,t,r){r=r&&(0,y.fromUserCoordinate)(r,this.getProjection()),this.endInteractionInternal(e,t,r)}},{key:"endInteractionInternal",value:function(e,t,r){this.setHint(d.default.INTERACTING,-1),this.resolveConstraints(e,t,r)}},{key:"getConstrainedCenter",value:function(e,t){var r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}},{key:"getConstrainedZoom",value:function(e,t){e=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(e,t))}},{key:"getConstrainedResolution",value:function(e,t){t=t||0;var r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}])&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function P(e,t){setTimeout(function(){e(t)},0)}function k(e){var t;return void 0!==e.extent?(t=void 0===e.smoothExtentConstraint||e.smoothExtentConstraint,(0,l.createExtent)(e.extent,e.constrainOnlyCenter,t)):(t=(0,y.createProjection)(e.projection,"EPSG:3857"),!0!==e.multiWorld&&t.isGlobal()?((e=t.getExtent().slice())[0]=-1/0,e[2]=1/0,(0,l.createExtent)(e,!1,!1)):l.none)}function E(e){var t,r,n=void 0!==e.minZoom?e.minZoom:O,i=void 0!==e.maxZoom?e.maxZoom:28,o=void 0!==e.zoomFactor?e.zoomFactor:2,a=void 0!==e.multiWorld&&e.multiWorld,s=void 0===e.smoothResolutionConstraint||e.smoothResolutionConstraint,u=void 0!==e.showFullExtent&&e.showFullExtent,l=(0,y.createProjection)(e.projection,"EPSG:3857"),c=l.getExtent(),f=e.constrainOnlyCenter,h=e.extent;return a||h||!l.isGlobal()||(f=!1,h=c),{constraint:void 0!==e.resolutions?(t=(a=e.resolutions)[n],r=void 0!==a[i]?a[i]:a[a.length-1],e.constrainResolution?(0,m.createSnapToResolutions)(a,s,!f&&h,u):(0,m.createMinMaxResolution)(t,r,s,!f&&h,u)):(c=(a=(c?Math.max((0,v.getWidth)(c),(0,v.getHeight)(c)):360*y.METERS_PER_UNIT.degrees/l.getMetersPerUnit())/p.DEFAULT_TILE_SIZE/Math.pow(2,O))/Math.pow(2,28-O),void 0!==(t=e.maxResolution)?n=0:t=a/Math.pow(o,n),void 0===(r=e.minResolution)&&(r=void 0!==e.maxZoom?void 0!==e.maxResolution?t/Math.pow(o,i):a/Math.pow(o,i):c),i=n+Math.floor(Math.log(t/r)/Math.log(o)),r=t/Math.pow(o,i-n),e.constrainResolution?(0,m.createSnapToPower)(o,t,r,s,!f&&h,u):(0,m.createMinMaxResolution)(t,r,s,!f&&h,u)),maxResolution:t,minResolution:r,minZoom:n,zoomFactor:o}}function T(e){return void 0===e.enableRotation||e.enableRotation?void 0===(e=e.constrainRotation)||!0===e?(0,c.createSnapToZero)():!1!==e&&"number"==typeof e?(0,c.createSnapToN)(e):c.none:c.disable}function C(e){return!(e.sourceCenter&&e.targetCenter&&!(0,o.equals)(e.sourceCenter,e.targetCenter))&&e.sourceResolution===e.targetResolution&&e.sourceRotation===e.targetRotation}function R(e,t,r,n,i){var o=Math.cos(-i),i=Math.sin(-i),a=e[0]*o-e[1]*i,e=e[1]*o+e[0]*i;return[(a+=(t[0]/2-r[0])*n)*o-(e+=(r[1]-t[1]/2)*n)*(i=-i),e*o+a*i]}r.default=e},{"./Object.js":90,"./ViewHint.js":102,"./ViewProperty.js":103,"./array.js":104,"./asserts.js":105,"./centerconstraint.js":106,"./coordinate.js":121,"./easing.js":124,"./extent.js":131,"./functions.js":189,"./geom/Polygon.js":200,"./math.js":267,"./proj.js":271,"./resolutionconstraint.js":317,"./rotationconstraint.js":318,"./tilegrid/common.js":375}],102:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={ANIMATING:0,INTERACTING:1}},{}],103:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"}},{}],104:[function(e,t,r){"use strict";function u(e,t){return t<e?1:e<t?-1:0}Object.defineProperty(r,"__esModule",{value:!0}),r.binarySearch=function(e,t,r){r=r||u;var n,i,o=0,a=e.length,s=!1;for(;o<a;)(i=+r(e[n=o+(a-o>>1)],t))<0?o=n+1:(a=n,s=!i);return s?o:~o},r.equals=function(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0},r.extend=function(e,t){for(var r=Array.isArray(t)?t:[t],n=r.length,i=0;i<n;i++)e[e.length]=r[i]},r.isSorted=function(r,e,n){var i=e||u;return r.every(function(e,t){return 0===t||!(0<(t=i(r[t-1],e))||n&&0===t)})},r.linearFindNearest=function(e,t,r){var n,i=e.length;{if(e[0]<=t)return 0;if(!(t<=e[i-1]))if(0<r){for(n=1;n<i;++n)if(e[n]<t)return n-1}else if(r<0){for(n=1;n<i;++n)if(e[n]<=t)return n}else for(n=1;n<i;++n){if(e[n]==t)return n;if(e[n]<t)return"function"==typeof r?0<r(t,e[n-1],e[n])?n-1:n:e[n-1]-t<t-e[n]?n-1:n}return i-1}},r.numberSafeCompareFunction=u,r.remove=function(e,t){var t=e.indexOf(t),r=-1<t;r&&e.splice(t,1);return r},r.reverseSubArray=function(e,t,r){for(;t<r;){var n=e[t];e[t]=e[r],e[r]=n,++t,--r}},r.stableSort=function(e,r){var t,n=e.length,i=Array(e.length);for(t=0;t<n;t++)i[t]={index:t,value:e[t]};for(i.sort(function(e,t){return r(e.value,t.value)||e.index-t.index}),t=0;t<e.length;t++)e[t]=i[t].value}},{}],105:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.assert=function(e,t){if(!e)throw new n.default(t)};var n=(r=e("./AssertionError.js"))&&r.__esModule?r:{default:r}},{"./AssertionError.js":70}],106:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createExtent=function(l,c,f){return function(e,t,r,n,i){var o,a,s,u;if(e)return t||c?(a=c?0:r[0]*t,r=c?0:r[1]*t,s=i?i[0]:0,i=i?i[1]:0,o=l[0]+a/2+s,a=l[2]-a/2+s,s=l[1]+r/2+i,a<o&&(a=o=(a+o)/2),(r=l[3]-r/2+i)<s&&(r=s=(r+s)/2),i=(0,h.clamp)(e[0],o,a),u=(0,h.clamp)(e[1],s,r),n&&f&&t&&(i+=-(n=30*t)*Math.log(1+Math.max(0,o-e[0])/n)+n*Math.log(1+Math.max(0,e[0]-a)/n),u+=-n*Math.log(1+Math.max(0,s-e[1])/n)+n*Math.log(1+Math.max(0,e[1]-r)/n)),[i,u]):e}},r.none=function(e){return e};var h=e("./math.js")},{"./math.js":267}],107:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.asArray=function(e){return Array.isArray(e)?e:a(e)},r.asString=function(e){return"string"==typeof e?e:h(e)},r.fromString=void 0,r.isStringColor=function(e){l.test(e)&&(e=c(e));return u.test(e)||e.startsWith("rgba(")||e.startsWith("rgb(")},r.normalize=f,r.toString=h;var s=e("./asserts.js"),n=e("./math.js"),u=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,l=/^([a-z]*)$|^hsla?\(.*\)$/i;function c(e){var t=document.createElement("div");return t.style.color=e,""!==t.style.color?(document.body.appendChild(t),e=getComputedStyle(t).color,document.body.removeChild(t),e):""}i={},o=0;var i,o,a=function(e){var t;if(i.hasOwnProperty(e))t=i[e];else{if(1024<=o){var r,n=0;for(r in i)0==(3&n++)&&(delete i[r],--o)}t=function(e){var t,r,n,i,o;l.exec(e)&&(e=c(e));{var a;u.exec(e)?(a=e.length-1,o=a<=4?1:2,a=4==a||8==a,t=parseInt(e.substr(1+0*o,o),16),r=parseInt(e.substr(+o+1,o),16),n=parseInt(e.substr(1+2*o,o),16),i=a?parseInt(e.substr(1+3*o,o),16):255,1==o&&(t=(t<<4)+t,r=(r<<4)+r,n=(n<<4)+n,a)&&(i=(i<<4)+i),o=[t,r,n,i/255]):e.startsWith("rgba(")?f(o=e.slice(5,-1).split(",").map(Number)):e.startsWith("rgb(")?((o=e.slice(4,-1).split(",").map(Number)).push(1),f(o)):(0,s.assert)(!1,14)}return o}(e),i[e]=t,++o}return t};function f(e){return e[0]=(0,n.clamp)(e[0]+.5|0,0,255),e[1]=(0,n.clamp)(e[1]+.5|0,0,255),e[2]=(0,n.clamp)(e[2]+.5|0,0,255),e[3]=(0,n.clamp)(e[3],0,1),e}function h(e){var t=e[0],r=(t!=(0|t)&&(t=t+.5|0),e[1]),n=(r!=(0|r)&&(r=r+.5|0),e[2]),e=(n!=(0|n)&&(n=n+.5|0),void 0===e[3]?1:Math.round(100*e[3])/100);return"rgba("+t+","+r+","+n+","+e+")"}r.fromString=a},{"./asserts.js":105,"./math.js":267}],108:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.asColorLike=function(e){return Array.isArray(e)?(0,n.toString)(e):e};var n=e("./color.js")},{"./color.js":107}],109:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Attribution",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"Control",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"FullScreen",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"MousePosition",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"OverviewMap",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"Rotate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"ScaleLine",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"Zoom",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"ZoomSlider",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"ZoomToExtent",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"defaults",{enumerable:!0,get:function(){return p.defaults}});var n=d(e("./control/Attribution.js")),i=d(e("./control/Control.js")),o=d(e("./control/FullScreen.js")),a=d(e("./control/MousePosition.js")),s=d(e("./control/OverviewMap.js")),u=d(e("./control/Rotate.js")),l=d(e("./control/ScaleLine.js")),c=d(e("./control/Zoom.js")),f=d(e("./control/ZoomSlider.js")),h=d(e("./control/ZoomToExtent.js")),p=e("./control/defaults.js");function d(e){return e&&e.__esModule?e:{default:e}}},{"./control/Attribution.js":110,"./control/Control.js":111,"./control/FullScreen.js":112,"./control/MousePosition.js":113,"./control/OverviewMap.js":114,"./control/Rotate.js":115,"./control/ScaleLine.js":116,"./control/Zoom.js":117,"./control/ZoomSlider.js":118,"./control/ZoomToExtent.js":119,"./control/defaults.js":120}],110:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./Control.js")),l=s(e("../events/EventType.js")),c=e("../css.js"),o=e("../array.js"),h=e("../layer/Layer.js"),a=e("../dom.js");function s(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,s=d(u);function u(e){var t;if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");e=e||{},(t=s.call(this,{element:document.createElement("div"),render:e.render,target:e.target})).ulElement_=document.createElement("ul"),t.collapsed_=void 0===e.collapsed||e.collapsed,t.userCollapsed_=t.collapsed_,t.overrideCollapsible_=void 0!==e.collapsible,t.collapsible_=void 0===e.collapsible||e.collapsible,t.collapsible_||(t.collapsed_=!1);var r=void 0!==e.className?e.className:"ol-attribution",n=void 0!==e.tipLabel?e.tipLabel:"Attributions",i=void 0!==e.expandClassName?e.expandClassName:r+"-expand",o=void 0!==e.collapseLabel?e.collapseLabel:"›",a=void 0!==e.collapseClassName?e.collapseClassName:r+"-collapse",a=("string"==typeof o?(t.collapseLabel_=document.createElement("span"),t.collapseLabel_.textContent=o,t.collapseLabel_.className=a):t.collapseLabel_=o,void 0!==e.label?e.label:"i"),o=("string"==typeof a?(t.label_=document.createElement("span"),t.label_.textContent=a,t.label_.className=i):t.label_=a,t.collapsible_&&!t.collapsed_?t.collapseLabel_:t.label_),e=(t.toggleButton_=document.createElement("button"),t.toggleButton_.setAttribute("type","button"),t.toggleButton_.setAttribute("aria-expanded",String(!t.collapsed_)),t.toggleButton_.title=n,t.toggleButton_.appendChild(o),t.toggleButton_.addEventListener(l.default.CLICK,t.handleClick_.bind(y(t)),!1),r+" "+c.CLASS_UNSELECTABLE+" "+c.CLASS_CONTROL+(t.collapsed_&&t.collapsible_?" "+c.CLASS_COLLAPSED:"")+(t.collapsible_?"":" ol-uncollapsible")),i=t.element;return i.className=e,i.appendChild(t.toggleButton_),i.appendChild(t.ulElement_),t.renderedAttributions_=[],t.renderedVisible_=!0,t}return t=u,(e=[{key:"collectSourceAttributions_",value:function(e){for(var t={},r=[],n=!0,i=e.layerStatesArray,o=0,a=i.length;o<a;++o){var s=i[o];if((0,h.inView)(s,e.viewState)){s=s.layer.getSource();if(s){var u=s.getAttributions();if(u){var l=u(e);if(l)if(n=n&&!1!==s.getAttributionsCollapsible(),Array.isArray(l))for(var c=0,f=l.length;c<f;++c)l[c]in t||(r.push(l[c]),t[l[c]]=!0);else l in t||(r.push(l),t[l]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(n),r}},{key:"updateElement_",value:function(e){if(e){var t=this.collectSourceAttributions_(e),e=0<t.length;if(this.renderedVisible_!=e&&(this.element.style.display=e?"":"none",this.renderedVisible_=e),!(0,o.equals)(t,this.renderedAttributions_)){(0,a.removeChildren)(this.ulElement_);for(var r=0,n=t.length;r<n;++r){var i=document.createElement("li");i.innerHTML=t[r],this.ulElement_.appendChild(i)}this.renderedAttributions_=t}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"handleClick_",value:function(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle(c.CLASS_COLLAPSED),this.collapsed_?(0,a.replaceNode)(this.collapseLabel_,this.label_):(0,a.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_)&&this.handleToggle_()}},{key:"setCollapsed",value:function(e){this.userCollapsed_=e,this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(e){this.updateElement_(e.frameState)}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n.default);r.default=e},{"../array.js":104,"../css.js":122,"../dom.js":123,"../events/EventType.js":127,"../layer/Layer.js":256,"./Control.js":111}],111:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("../Object.js")),o=l(e("../MapEventType.js")),a=e("../functions.js"),s=e("../events.js"),u=e("../dom.js");function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){var t,r;if(this instanceof i)return t=n.call(this),!(r=e.element)||e.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),t.element=r||null,t.target_=null,t.map_=null,t.listenerKeys=[],e.render&&(t.render=e.render),e.target&&t.setTarget(e.target),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"disposeInternal",value:function(){(0,u.removeNode)(this.element),f(d(i.prototype),"disposeInternal",this).call(this)}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(e){this.map_&&(0,u.removeNode)(this.element);for(var t=0,r=this.listenerKeys.length;t<r;++t)(0,s.unlistenByKey)(this.listenerKeys[t]);this.listenerKeys.length=0,(this.map_=e)&&((this.target_||e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==a.VOID&&this.listenerKeys.push((0,s.listen)(e,o.default.POSTRENDER,this.render,this)),e.render())}},{key:"render",value:function(e){}},{key:"setTarget",value:function(e){this.target_="string"==typeof e?document.getElementById(e):e}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../MapEventType.js":88,"../Object.js":90,"../dom.js":123,"../events.js":125,"../functions.js":189}],112:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("./Control.js")),o=c(e("../events/EventType.js")),a=c(e("../MapProperty.js")),s=e("../css.js"),u=e("../events.js"),l=e("../dom.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?h(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],_="enterfullscreen",w="leavefullscreen",e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n=g(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{},(t=n.call(this,{element:document.createElement("div"),target:e.target})).on,t.once,t.un,t.keys_=void 0!==e.keys&&e.keys,t.source_=e.source,t.isInFullscreen_=!1,t.boundHandleMapTargetChange_=t.handleMapTargetChange_.bind(m(t)),t.cssClassName_=void 0!==e.className?e.className:"ol-full-screen",t.documentListeners_=[],t.activeClassName_=void 0!==e.activeClassName?e.activeClassName.split(" "):[t.cssClassName_+"-true"],t.inactiveClassName_=void 0!==e.inactiveClassName?e.inactiveClassName.split(" "):[t.cssClassName_+"-false"];var r=void 0!==e.label?e.label:"⤢",r=(t.labelNode_="string"==typeof r?document.createTextNode(r):r,void 0!==e.labelActive?e.labelActive:"×"),r=(t.labelActiveNode_="string"==typeof r?document.createTextNode(r):r,e.tipLabel||"Toggle full-screen");return t.button_=document.createElement("button"),t.button_.title=r,t.button_.setAttribute("type","button"),t.button_.appendChild(t.labelNode_),t.button_.addEventListener(o.default.CLICK,t.handleClick_.bind(m(t)),!1),t.setClassName_(t.button_,t.isInFullscreen_),t.element.className="".concat(t.cssClassName_," ").concat(s.CLASS_UNSELECTABLE," ").concat(s.CLASS_CONTROL),t.element.appendChild(t.button_),t}return t=i,(e=[{key:"handleClick_",value:function(e){e.preventDefault(),this.handleFullScreen_()}},{key:"handleFullScreen_",value:function(){var e,t,r=this.getMap();r&&x(e=r.getOwnerDocument())&&(S(e)?(t=e).exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen&&t.webkitExitFullscreen():(t=this.source_?"string"==typeof this.source_?e.getElementById(this.source_):this.source_:r.getTargetElement(),this.keys_?(e=t).webkitRequestFullscreen?e.webkitRequestFullscreen():j(e):j(t)))}},{key:"handleFullScreenChange_",value:function(){var e,t=this.getMap();t&&(e=this.isInFullscreen_,this.isInFullscreen_=S(t.getOwnerDocument()),e!==this.isInFullscreen_)&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?((0,l.replaceNode)(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(_)):((0,l.replaceNode)(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(w)),t.updateSize())}},{key:"setClassName_",value:function(e,t){t?((t=e.classList).remove.apply(t,f(this.inactiveClassName_)),(t=e.classList).add.apply(t,f(this.activeClassName_))):((t=e.classList).remove.apply(t,f(this.activeClassName_)),(t=e.classList).add.apply(t,f(this.inactiveClassName_)))}},{key:"setMap",value:function(e){var t=this.getMap();t&&t.removeChangeListener(a.default.TARGET,this.boundHandleMapTargetChange_),d(v(i.prototype),"setMap",this).call(this,e),this.handleMapTargetChange_(),e&&e.addChangeListener(a.default.TARGET,this.boundHandleMapTargetChange_)}},{key:"handleMapTargetChange_",value:function(){for(var e=this.documentListeners_,t=0,r=e.length;t<r;++t)(0,u.unlistenByKey)(e[t]);e.length=0;var n=this.getMap();if(n){var i=n.getOwnerDocument();x(i)?this.element.classList.remove(s.CLASS_UNSUPPORTED):this.element.classList.add(s.CLASS_UNSUPPORTED);for(var o=0,a=b.length;o<a;++o)e.push((0,u.listen)(i,b[o],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function x(e){var t=e.body;return t.webkitRequestFullscreen||t.requestFullscreen&&e.fullscreenEnabled}function S(e){return!(!e.webkitIsFullScreen&&!e.fullscreenElement)}function j(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}r.default=e},{"../MapProperty.js":89,"../css.js":122,"../dom.js":123,"../events.js":125,"../events/EventType.js":127,"./Control.js":111}],113:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("./Control.js")),o=u(e("../pointer/EventType.js")),a=e("../proj.js"),s=e("../events.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d="projection",y="coordinateFormat",e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=h(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var r=document.createElement("div");return r.className=void 0!==e.className?e.className:"ol-mouse-position",(t=n.call(this,{element:r,render:e.render,target:e.target})).on,t.once,t.un,t.addChangeListener(d,t.handleProjectionChanged_),e.coordinateFormat&&t.setCoordinateFormat(e.coordinateFormat),e.projection&&t.setProjection(e.projection),t.renderOnMouseOut_=void 0!==e.placeholder,t.placeholder_=t.renderOnMouseOut_?e.placeholder:"&#160;",t.renderedHTML_=r.innerHTML,t.mapProjection_=null,t.transform_=null,t}return t=i,(e=[{key:"handleProjectionChanged_",value:function(){this.transform_=null}},{key:"getCoordinateFormat",value:function(){return this.get(y)}},{key:"getProjection",value:function(){return this.get(d)}},{key:"handleMouseMove",value:function(e){var t=this.getMap();this.updateHTML_(t.getEventPixel(e))}},{key:"handleMouseOut",value:function(e){this.updateHTML_(null)}},{key:"setMap",value:function(e){c(p(i.prototype),"setMap",this).call(this,e),e&&(e=e.getViewport(),this.listenerKeys.push((0,s.listen)(e,o.default.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push((0,s.listen)(e,o.default.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null))}},{key:"setCoordinateFormat",value:function(e){this.set(y,e)}},{key:"setProjection",value:function(e){this.set(d,(0,a.get)(e))}},{key:"updateHTML_",value:function(e){var t,r=this.placeholder_;e&&this.mapProjection_&&(this.transform_||(t=this.getProjection(),this.transform_=t?(0,a.getTransformFromProjections)(this.mapProjection_,t):a.identityTransform),t=this.getMap().getCoordinateFromPixelInternal(e))&&((e=(0,a.getUserProjection)())&&(this.transform_=(0,a.getTransformFromProjections)(this.mapProjection_,e)),this.transform_(t,t),r=(e=this.getCoordinateFormat())?e(t):t.toString()),this.renderedHTML_&&r===this.renderedHTML_||(this.element.innerHTML=r,this.renderedHTML_=r)}},{key:"render",value:function(e){e=e.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../events.js":125,"../pointer/EventType.js":270,"../proj.js":271,"./Control.js":111}],114:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var d=h(e("../Collection.js")),n=h(e("./Control.js")),y=h(e("../events/EventType.js")),g=h(e("../Map.js")),o=h(e("../MapEventType.js")),a=h(e("../MapProperty.js")),s=h(e("../ObjectEventType.js")),m=h(e("../Overlay.js")),u=h(e("../View.js")),l=h(e("../ViewProperty.js")),v=e("../css.js"),c=e("../extent.js"),f=e("../events.js"),b=e("../geom/Polygon.js"),_=e("../dom.js");function h(e){return e&&e.__esModule?e:{default:e}}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function x(){return(x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=P(r),t=(e=n?(e=P(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e);var r,h=j(p);function p(e){var t;if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");e=e||{},(t=h.call(this,{element:document.createElement("div"),render:e.render,target:e.target})).boundHandleRotationChanged_=t.handleRotationChanged_.bind(O(t)),t.collapsed_=void 0===e.collapsed||e.collapsed,t.collapsible_=void 0===e.collapsible||e.collapsible,t.collapsible_||(t.collapsed_=!1),t.rotateWithView_=void 0!==e.rotateWithView&&e.rotateWithView;function r(e){e=s.getEventCoordinateInternal(e),u.getMap().getView().setCenterInternal(e),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",r)}var n=(t.viewExtent_=void 0)!==e.className?e.className:"ol-overviewmap",i=void 0!==e.tipLabel?e.tipLabel:"Overview map",o=void 0!==e.collapseLabel?e.collapseLabel:"‹",o=("string"==typeof o?(t.collapseLabel_=document.createElement("span"),t.collapseLabel_.textContent=o):t.collapseLabel_=o,void 0!==e.label?e.label:"›"),o=("string"==typeof o?(t.label_=document.createElement("span"),t.label_.textContent=o):t.label_=o,t.collapsible_&&!t.collapsed_?t.collapseLabel_:t.label_),a=document.createElement("button"),s=(a.setAttribute("type","button"),a.title=i,a.appendChild(o),a.addEventListener(y.default.CLICK,t.handleClick_.bind(O(t)),!1),t.ovmapDiv_=document.createElement("div"),t.ovmapDiv_.className="ol-overviewmap-map",t.view_=e.view,new g.default({view:e.view,controls:new d.default,interactions:new d.default})),i=(t.ovmap_=s,e.layers&&e.layers.forEach(function(e){s.addLayer(e)}),document.createElement("div")),o=(i.className="ol-overviewmap-box",i.style.boxSizing="border-box",t.boxOverlay_=new m.default({position:[0,0],positioning:"center-center",element:i}),t.ovmap_.addOverlay(t.boxOverlay_),n+" "+v.CLASS_UNSELECTABLE+" "+v.CLASS_CONTROL+(t.collapsed_&&t.collapsible_?" "+v.CLASS_COLLAPSED:"")+(t.collapsible_?"":" ol-uncollapsible")),e=t.element,u=(e.className=o,e.appendChild(t.ovmapDiv_),e.appendChild(a),O(t)),l=t.boxOverlay_,i=t.boxOverlay_.getElement(),c=function(e){return{clientX:e.clientX,clientY:e.clientY}},f=function(e){e=c(e),e=s.getEventCoordinateInternal(e);l.setPosition(e)};return i.addEventListener("mousedown",function(){window.addEventListener("mousemove",f),window.addEventListener("mouseup",r)}),t}return t=p,(e=[{key:"setMap",value:function(e){var t=this.getMap();e!==t&&(t&&((t=t.getView())&&this.unbindView_(t),this.ovmap_.setTarget(null)),x(P(p.prototype),"setMap",this).call(this,e),e)&&(this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,f.listen)(e,s.default.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),(t=e.getView())&&(this.bindView_(t),t.isDef())&&(this.ovmap_.updateSize(),this.resetExtent_()),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_())}},{key:"handleMapPropertyChange_",value:function(e){var t;e.key===a.default.VIEW?((t=e.oldValue)&&this.unbindView_(t),t=this.getMap().getView(),this.bindView_(t)):this.ovmap_.isRendered()||e.key!==a.default.TARGET&&e.key!==a.default.SIZE||this.ovmap_.updateSize()}},{key:"bindView_",value:function(e){var t;this.view_||(t=new u.default({projection:e.getProjection()}),this.ovmap_.setView(t)),e.addChangeListener(l.default.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}},{key:"unbindView_",value:function(e){e.removeChangeListener(l.default.ROTATION,this.boundHandleRotationChanged_)}},{key:"handleRotationChanged_",value:function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}},{key:"validateExtent_",value:function(){var e,t,r,n,i=this.getMap(),o=this.ovmap_;i.isRendered()&&o.isRendered()&&(n=i.getSize(),i=i.getView().calculateExtentInternal(n),this.viewExtent_&&(0,c.equals)(i,this.viewExtent_)||(this.viewExtent_=i,n=o.getSize(),e=o.getView().calculateExtentInternal(n),r=o.getPixelFromCoordinateInternal((0,c.getTopLeft)(i)),o=o.getPixelFromCoordinateInternal((0,c.getBottomRight)(i)),t=Math.abs(r[0]-o[0]),r=Math.abs(r[1]-o[1]),o=n[0],n=n[1],t<.1*o||r<.1*n||.75*o<t||.75*n<r?this.resetExtent_():(0,c.containsExtent)(e,i)||this.recenter_()))}},{key:"resetExtent_",value:function(){var e=this.getMap(),t=this.ovmap_,r=e.getSize(),e=e.getView().calculateExtentInternal(r),r=t.getView(),t=Math.log(7.5)/Math.LN2,t=1/(.1*Math.pow(2,t/2));(0,c.scaleFromCenter)(e,t),r.fitInternal((0,b.fromExtent)(e))}},{key:"recenter_",value:function(){var e=this.getMap(),t=this.ovmap_,e=e.getView();t.getView().setCenterInternal(e.getCenterInternal())}},{key:"updateBox_",value:function(){var e,t,r,n,i,o,a=this.getMap(),s=this.ovmap_;a.isRendered()&&s.isRendered()&&(o=a.getSize(),a=a.getView(),s=s.getView(),e=this.rotateWithView_?0:-a.getRotation(),t=this.boxOverlay_,r=this.boxOverlay_.getElement(),n=a.getCenterInternal(),a=a.getResolution(),s=s.getResolution(),i=o[0]*a/s,o=o[1]*a/s,t.setPosition(n),r)&&(r.style.width=i+"px",r.style.height=o+"px",r.style.transform="rotate("+e+"rad)")}},{key:"updateBoxAfterOvmapIsRendered_",value:function(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=(0,f.listenOnce)(this.ovmap_,o.default.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}},{key:"handleClick_",value:function(e){e.preventDefault(),this.handleToggle_()}},{key:"handleToggle_",value:function(){this.element.classList.toggle(v.CLASS_COLLAPSED),this.collapsed_?(0,_.replaceNode)(this.collapseLabel_,this.label_):(0,_.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;this.collapsed_||(e.isRendered()?(this.viewExtent_=void 0,e.render()):(e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e)&&this.collapsed_&&this.handleToggle_()}},{key:"setCollapsed",value:function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"setRotateWithView",value:function(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,0!==this.getMap().getView().getRotation())&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_())}},{key:"getOverviewMap",value:function(){return this.ovmap_}},{key:"render",value:function(e){this.validateExtent_(),this.updateBox_()}}])&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),p}(n.default);r.default=e},{"../Collection.js":71,"../Map.js":83,"../MapEventType.js":88,"../MapProperty.js":89,"../ObjectEventType.js":91,"../Overlay.js":93,"../View.js":101,"../ViewProperty.js":103,"../css.js":122,"../dom.js":123,"../events.js":125,"../events/EventType.js":127,"../extent.js":131,"../geom/Polygon.js":200,"./Control.js":111}],115:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./Control.js")),s=o(e("../events/EventType.js")),u=e("../css.js"),l=e("../easing.js");function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,o=h(a);function a(e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");e=e||{};var t=o.call(this,{element:document.createElement("div"),render:e.render,target:e.target}),r=void 0!==e.className?e.className:"ol-rotate",n=void 0!==e.label?e.label:"⇧",i=void 0!==e.compassClassName?e.compassClassName:"ol-compass",n=(t.label_=null,"string"==typeof n?(t.label_=document.createElement("span"),t.label_.className=i,t.label_.textContent=n):(t.label_=n,t.label_.classList.add(i)),e.tipLabel||"Reset rotation"),i=document.createElement("button"),n=(i.className=r+"-reset",i.setAttribute("type","button"),i.title=n,i.appendChild(t.label_),i.addEventListener(s.default.CLICK,t.handleClick_.bind(p(t)),!1),r+" "+u.CLASS_UNSELECTABLE+" "+u.CLASS_CONTROL),r=t.element;return r.className=n,r.appendChild(i),t.callResetNorth_=e.resetNorth||void 0,t.duration_=void 0!==e.duration?e.duration:250,t.autoHide_=void 0===e.autoHide||e.autoHide,t.rotation_=void 0,t.autoHide_&&t.element.classList.add(u.CLASS_HIDDEN),t}return t=a,(e=[{key:"handleClick_",value:function(e){e.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var e,t=this.getMap().getView();t&&void 0!==(e=t.getRotation())&&(0<this.duration_&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:l.easeOut}):t.setRotation(0))}},{key:"render",value:function(e){var t,r,e=e.frameState;e&&((e=e.viewState.rotation)!=this.rotation_&&(t="rotate("+e+"rad)",this.autoHide_&&((r=this.element.classList.contains(u.CLASS_HIDDEN))||0!==e?r&&0!==e&&this.element.classList.remove(u.CLASS_HIDDEN):this.element.classList.add(u.CLASS_HIDDEN)),this.label_.style.transform=t),this.rotation_=e)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.default);r.default=e},{"../css.js":122,"../easing.js":124,"../events/EventType.js":127,"./Control.js":111}],116:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Control.js"))&&n.__esModule?n:{default:n},o=e("../css.js"),y=e("../proj.js"),g=e("../asserts.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=[1,2,5],v=25.4/.28,e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=document.createElement("div"),r=(t.style.pointerEvents="none",(t=n.call(this,{element:t,render:e.render,target:e.target})).on,t.once,t.un,void 0!==e.className?e.className:e.bar?"ol-scale-bar":"ol-scale-line");return t.innerElement_=document.createElement("div"),t.innerElement_.className=r+"-inner",t.element.className=r+" "+o.CLASS_UNSELECTABLE,t.element.appendChild(t.innerElement_),t.viewState_=null,t.minWidth_=void 0!==e.minWidth?e.minWidth:64,t.maxWidth_=e.maxWidth,t.renderedVisible_=!1,t.renderedWidth_=void 0,t.renderedHTML_="",t.addChangeListener("units",t.handleUnitsChanged_),t.setUnits(e.units||"metric"),t.scaleBar_=e.bar||!1,t.scaleBarSteps_=e.steps||4,t.scaleBarText_=e.text||!1,t.dpi_=e.dpi||void 0,t}return t=i,(e=[{key:"getUnits",value:function(){return this.get("units")}},{key:"handleUnitsChanged_",value:function(){this.updateElement_()}},{key:"setUnits",value:function(e){this.set("units",e)}},{key:"setDpi",value:function(e){this.dpi_=e}},{key:"updateElement_",value:function(){var e=this.viewState_;if(e){for(var t,r,n,i=e.center,o=e.projection,a=this.getUnits(),s=(0,y.getPointResolution)(o,e.resolution,i,"degrees"==a?"degrees":"m"),u=this.minWidth_*(this.dpi_||v)/v,l=void 0!==this.maxWidth_?this.maxWidth_*(this.dpi_||v)/v:void 0,o=u*s,e="",c=("degrees"==a?(o*=i=y.METERS_PER_UNIT.degrees)<i/60?(e="″",s*=3600):o<i?(e="′",s*=60):e="°":"imperial"==a?o<.9144?(e="in",s/=.0254):o<1609.344?(e="ft",s/=.3048):(e="mi",s/=1609.344):"nautical"==a?(s/=1852,e="NM"):"metric"==a?o<.001?(e="μm",s*=1e6):o<1?(e="mm",s*=1e3):o<1e3?e="m":(e="km",s/=1e3):"us"==a?o<.9144?(e="in",s*=39.37):o<1609.344?(e="ft",s/=.30480061):(e="mi",s/=1609.3472):(0,g.assert)(!1,33),3*Math.floor(Math.log(u*s)/Math.log(10)));;){var f=Math.floor(c/3),h=Math.pow(10,f),p=m[(c%3+3)%3]*h,d=Math.round(p/s);if(isNaN(d))return this.element.style.display="none",void(this.renderedVisible_=!1);if(void 0!==l&&l<=d){p=t,d=r,f=n;break}if(u<=d)break;t=p,r=d,n=f,++c}i=this.scaleBar_?this.createScaleBar(d,p,e):p.toFixed(f<0?-f:0)+" "+e;this.renderedHTML_!=i&&(this.innerElement_.innerHTML=i,this.renderedHTML_=i),this.renderedWidth_!=d&&(this.innerElement_.style.width=d+"px",this.renderedWidth_=d),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"createScaleBar",value:function(e,t,r){for(var n=this.getScaleForResolution(),n=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),i=this.scaleBarSteps_,o=e/i,a=[this.createMarker("absolute")],s=0;s<i;++s)a.push("<div><div "+'class="ol-scale-singlebar '.concat(s%2==0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even",'" ')+'style="width: '.concat(o,'px;"')+"></div>"+this.createMarker("relative")+(s%2==0||2===i?this.createStepText(s,e,!1,t,r):"")+"</div>");return a.push(this.createStepText(i,e,!0,t,r)),(this.scaleBarText_?'<div class="ol-scale-text" style="width: '.concat(e,'px;">')+n+"</div>":"")+a.join("")}},{key:"createMarker",value:function(e){var t="absolute"===e?3:-10;return'<div class="ol-scale-step-marker" '+'style="position: '.concat(e,"; top: ").concat(t,'px;"')+"></div>"}},{key:"createStepText",value:function(e,t,r,n,i){var n=(0===e?0:Math.round(n/this.scaleBarSteps_*e*100)/100)+(0===e?"":" "+i),i=0===e?-3:t/this.scaleBarSteps_*-1,o=0===e?0:t/this.scaleBarSteps_*2;return'<div class="ol-scale-step-text" style="'+"margin-left: ".concat(i,"px;")+"text-align: ".concat(0===e?"left":"center",";")+"min-width: ".concat(o,"px;")+"left: ".concat(r?t+"px":"unset",";")+'">'+n+"</div>"}},{key:"getScaleForResolution",value:function(){return(0,y.getPointResolution)(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m")*(1e3/25.4)*(this.dpi_||v)}},{key:"render",value:function(e){e=e.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../asserts.js":105,"../css.js":122,"../proj.js":271,"./Control.js":111}],117:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./Control.js")),p=a(e("../events/EventType.js")),d=e("../css.js"),o=e("../easing.js");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=h;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,f=l(h);function h(e){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");e=e||{};var t=f.call(this,{element:document.createElement("div"),target:e.target}),r=void 0!==e.className?e.className:"ol-zoom",n=void 0!==e.delta?e.delta:1,i=void 0!==e.zoomInClassName?e.zoomInClassName:r+"-in",o=void 0!==e.zoomOutClassName?e.zoomOutClassName:r+"-out",a=void 0!==e.zoomInLabel?e.zoomInLabel:"+",s=void 0!==e.zoomOutLabel?e.zoomOutLabel:"–",u=void 0!==e.zoomInTipLabel?e.zoomInTipLabel:"Zoom in",l=void 0!==e.zoomOutTipLabel?e.zoomOutTipLabel:"Zoom out",c=document.createElement("button"),i=(c.className=i,c.setAttribute("type","button"),c.title=u,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener(p.default.CLICK,t.handleClick_.bind(y(t),n),!1),document.createElement("button")),u=(i.className=o,i.setAttribute("type","button"),i.title=l,i.appendChild("string"==typeof s?document.createTextNode(s):s),i.addEventListener(p.default.CLICK,t.handleClick_.bind(y(t),-n),!1),r+" "+d.CLASS_UNSELECTABLE+" "+d.CLASS_CONTROL),a=t.element;return a.className=u,a.appendChild(c),a.appendChild(i),t.duration_=void 0!==e.duration?e.duration:250,t}return t=h,(e=[{key:"handleClick_",value:function(e,t){t.preventDefault(),this.zoomByDelta_(e)}},{key:"zoomByDelta_",value:function(e){var t,r=this.getMap().getView();r&&void 0!==(t=r.getZoom())&&(t=r.getConstrainedZoom(t+e),0<this.duration_?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:t,duration:this.duration_,easing:o.easeOut})):r.setZoom(t))}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.default);r.default=e},{"../css.js":122,"../easing.js":124,"../events/EventType.js":127,"./Control.js":111}],118:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./Control.js")),a=o(e("../events/EventType.js")),s=o(e("../pointer/EventType.js")),u=e("../css.js"),l=e("../math.js"),c=e("../easing.js"),f=e("../events.js"),h=e("../events/Event.js");function o(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=0,_=1,e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,i=g(o);function o(e){var t;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");e=e||{},(t=i.call(this,{element:document.createElement("div"),render:e.render})).dragListenerKeys_=[],t.currentResolution_=void 0,t.direction_=b,t.dragging_,t.heightLimit_=0,t.widthLimit_=0,t.startX_,t.startY_,t.thumbSize_=null,t.sliderInitialized_=!1,t.duration_=void 0!==e.duration?e.duration:200;var e=void 0!==e.className?e.className:"ol-zoomslider",r=document.createElement("button"),n=(r.setAttribute("type","button"),r.className=e+"-thumb "+u.CLASS_UNSELECTABLE,t.element);return n.className=e+" "+u.CLASS_UNSELECTABLE+" "+u.CLASS_CONTROL,n.appendChild(r),n.addEventListener(s.default.POINTERDOWN,t.handleDraggerStart_.bind(m(t)),!1),n.addEventListener(s.default.POINTERMOVE,t.handleDraggerDrag_.bind(m(t)),!1),n.addEventListener(s.default.POINTERUP,t.handleDraggerEnd_.bind(m(t)),!1),n.addEventListener(a.default.CLICK,t.handleContainerClick_.bind(m(t)),!1),r.addEventListener(a.default.CLICK,h.stopPropagation,!1),t}return t=o,(e=[{key:"setMap",value:function(e){d(v(o.prototype),"setMap",this).call(this,e),e&&e.render()}},{key:"initSlider_",value:function(){var e,t,r=this.element,n=r.offsetWidth,i=r.offsetHeight;return 0===n&&0===i?this.sliderInitialized_=!1:(t=getComputedStyle(r),n-=parseFloat(t.paddingRight)+parseFloat(t.paddingLeft),i-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),t=r.firstElementChild,r=getComputedStyle(t),e=t.offsetWidth+parseFloat(r.marginRight)+parseFloat(r.marginLeft),t=t.offsetHeight+parseFloat(r.marginTop)+parseFloat(r.marginBottom),this.thumbSize_=[e,t],i<n?(this.direction_=_,this.widthLimit_=n-e):(this.direction_=b,this.heightLimit_=i-t),this.sliderInitialized_=!0)}},{key:"handleContainerClick_",value:function(e){var t=this.getMap().getView(),e=this.getRelativePosition_(e.offsetX-this.thumbSize_[0]/2,e.offsetY-this.thumbSize_[1]/2),e=this.getResolutionForPosition_(e),e=t.getConstrainedZoom(t.getZoomForResolution(e));t.animateInternal({zoom:e,duration:this.duration_,easing:c.easeOut})}},{key:"handleDraggerStart_",value:function(e){var t,r;this.dragging_||e.target!==this.element.firstElementChild||(t=this.element.firstElementChild,this.getMap().getView().beginInteraction(),this.startX_=e.clientX-parseFloat(t.style.left),this.startY_=e.clientY-parseFloat(t.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length&&(e=this.handleDraggerDrag_,t=this.handleDraggerEnd_,r=this.getMap().getOwnerDocument(),this.dragListenerKeys_.push((0,f.listen)(r,s.default.POINTERMOVE,e,this),(0,f.listen)(r,s.default.POINTERUP,t,this))))}},{key:"handleDraggerDrag_",value:function(e){var t;this.dragging_&&(t=e.clientX-this.startX_,e=e.clientY-this.startY_,t=this.getRelativePosition_(t,e),this.currentResolution_=this.getResolutionForPosition_(t),this.getMap().getView().setResolution(this.currentResolution_))}},{key:"handleDraggerEnd_",value:function(e){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(f.unlistenByKey),this.dragListenerKeys_.length=0)}},{key:"setThumbPosition_",value:function(e){var e=this.getPositionForResolution_(e),t=this.element.firstElementChild;this.direction_==_?t.style.left=this.widthLimit_*e+"px":t.style.top=this.heightLimit_*e+"px"}},{key:"getRelativePosition_",value:function(e,t){e=this.direction_===_?e/this.widthLimit_:t/this.heightLimit_;return(0,l.clamp)(e,0,1)}},{key:"getResolutionForPosition_",value:function(e){return this.getMap().getView().getResolutionForValueFunction()(1-e)}},{key:"getPositionForResolution_",value:function(e){var t=this.getMap().getView().getValueForResolutionFunction();return(0,l.clamp)(1-t(e),0,1)}},{key:"render",value:function(e){e.frameState&&(this.sliderInitialized_||this.initSlider_())&&(e=e.frameState.viewState.resolution,this.currentResolution_=e,this.setThumbPosition_(e))}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"../css.js":122,"../easing.js":124,"../events.js":125,"../events/Event.js":126,"../events/EventType.js":127,"../math.js":267,"../pointer/EventType.js":270,"./Control.js":111}],119:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./Control.js")),s=o(e("../events/EventType.js")),u=e("../css.js"),l=e("../geom/Polygon.js");function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,o=h(a);function a(e){var t;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");e=e||{},(t=o.call(this,{element:document.createElement("div"),target:e.target})).extent=e.extent||null;var r=void 0!==e.className?e.className:"ol-zoom-extent",n=void 0!==e.label?e.label:"E",e=void 0!==e.tipLabel?e.tipLabel:"Fit to extent",i=document.createElement("button"),e=(i.setAttribute("type","button"),i.title=e,i.appendChild("string"==typeof n?document.createTextNode(n):n),i.addEventListener(s.default.CLICK,t.handleClick_.bind(p(t)),!1),r+" "+u.CLASS_UNSELECTABLE+" "+u.CLASS_CONTROL),n=t.element;return n.className=e,n.appendChild(i),t}return t=a,(e=[{key:"handleClick_",value:function(e){e.preventDefault(),this.handleZoomToExtent()}},{key:"handleZoomToExtent",value:function(){var e=this.getMap().getView(),t=this.extent||e.getProjection().getExtent();e.fitInternal((0,l.fromExtent)(t))}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.default);r.default=e},{"../css.js":122,"../events/EventType.js":127,"../geom/Polygon.js":200,"./Control.js":111}],120:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaults=function(e){e=e||{};var t=new i.default;void 0!==e.zoom&&!e.zoom||t.push(new a.default(e.zoomOptions));void 0!==e.rotate&&!e.rotate||t.push(new o.default(e.rotateOptions));void 0!==e.attribution&&!e.attribution||t.push(new n.default(e.attributionOptions));return t};var n=s(e("./Attribution.js")),i=s(e("../Collection.js")),o=s(e("./Rotate.js")),a=s(e("./Zoom.js"));function s(e){return e&&e.__esModule?e:{default:e}}},{"../Collection.js":71,"./Attribution.js":110,"./Rotate.js":115,"./Zoom.js":117}],121:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.add=function(e,t){return e[0]+=+t[0],e[1]+=+t[1],e},r.closestOnCircle=function(e,t){var r=t.getRadius(),t=t.getCenter(),n=t[0],t=t[1],i=e[0],e=e[1],i=i-n,e=e-t;0===i&&0==e&&(i=1);var o=Math.sqrt(i*i+e*e);return[n+r*i/o,t+r*e/o]},r.closestOnSegment=n,r.createStringXY=function(t){return function(e){return c(e,t)}},r.degreesToStringHDMS=i,r.distance=function(e,t){return Math.sqrt(l(e,t))},r.equals=function(e,t){for(var r=!0,n=e.length-1;0<=n;--n)if(e[n]!=t[n]){r=!1;break}return r},r.format=u,r.getWorldsAway=f,r.rotate=function(e,t){var r=Math.cos(t),t=Math.sin(t),n=e[0]*r-e[1]*t,r=e[1]*r+e[0]*t;return e[0]=n,e[1]=r,e},r.scale=function(e,t){return e[0]*=t,e[1]*=t,e},r.squaredDistance=l,r.squaredDistanceToSegment=function(e,t){return l(e,n(e,t))},r.toStringHDMS=function(e,t){return e?i("NS",e[1],t)+" "+i("EW",e[0],t):""},r.toStringXY=c,r.wrapX=function(e,t){{var r;t.canWrapX()&&(r=(0,o.getWidth)(t.getExtent()),t=f(e,t,r))&&(e[0]-=t*r)}return e};var o=e("./extent.js"),a=e("./math.js"),s=e("./string.js");function n(e,t){var r,n=e[0],e=e[1],i=t[0],t=t[1],o=i[0],i=i[1],a=t[0],t=t[1],s=a-o,u=t-i,n=0==s&&0==u?0:(s*(n-o)+u*(e-i))/(s*s+u*u||0),e=n<=0?(r=o,i):1<=n?(r=a,t):(r=o+n*s,i+n*u);return[r,e]}function i(e,t,r){var t=(0,a.modulo)(t+180,360)-180,n=Math.abs(3600*t),r=r||0,i=Math.floor(n/3600),o=Math.floor((n-3600*i)/60),n=(0,a.toFixed)(n-3600*i-60*o,r),i=(60<=n&&(n=0,o+=1),60<=o&&(o=0,i+=1),i+"°");return 0===o&&0===n||(i+=" "+(0,s.padNumber)(o,2)+"′"),0!==n&&(i+=" "+(0,s.padNumber)(n,2,r)+"″"),0!=t&&(i+=" "+e.charAt(t<0?1:0)),i}function u(e,t,r){return e?t.replace("{x}",e[0].toFixed(r)).replace("{y}",e[1].toFixed(r)):""}function l(e,t){var r=e[0]-t[0],e=e[1]-t[1];return r*r+e*e}function c(e,t){return u(e,"{x}, {y}",t)}function f(e,t,r){var n=t.getExtent(),i=0;return t.canWrapX()&&(e[0]<n[0]||e[0]>n[2])&&(r=r||(0,o.getWidth)(n),i=Math.floor((e[0]-n[0])/r)),i}},{"./extent.js":131,"./math.js":267,"./string.js":354}],122:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getFontParameters=r.CLASS_UNSUPPORTED=r.CLASS_UNSELECTABLE=r.CLASS_SELECTABLE=r.CLASS_HIDDEN=r.CLASS_CONTROL=r.CLASS_COLLAPSED=void 0;r.CLASS_HIDDEN="ol-hidden",r.CLASS_SELECTABLE="ol-selectable",r.CLASS_UNSELECTABLE="ol-unselectable",r.CLASS_UNSUPPORTED="ol-unsupported",r.CLASS_CONTROL="ol-control";r.CLASS_COLLAPSED="ol-collapsed";var a=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),s=["style","variant","weight","size","lineHeight","family"];r.getFontParameters=function(e){var t=e.match(a);if(!t)return null;for(var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,i=s.length;n<i;++n){var o=t[n+1];void 0!==o&&(r[s[n]]=o)}return r.families=r.family.split(/,\s?/),r}},{}],123:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createCanvasContext2D=function(e,t,r,n){r=r&&r.length?r.shift():i.WORKER_OFFSCREEN_CANVAS?new OffscreenCanvas(e||300,t||300):document.createElement("canvas");e&&(r.width=e);t&&(r.height=t);return r.getContext("2d",n)},r.outerHeight=function(e){var t=e.offsetHeight,e=getComputedStyle(e);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10)},r.outerWidth=function(e){var t=e.offsetWidth,e=getComputedStyle(e);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10)},r.releaseCanvas=function(e){var t=e.canvas;t.width=1,t.height=1,e.clearRect(0,0,1,1)},r.removeChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},r.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},r.replaceChildren=function(e,t){for(var r=e.childNodes,n=0;;++n){1;{var i=r[n],o=t[n];if(!i&&!o)break;i!==o&&(i?o?e.insertBefore(o,i):(e.removeChild(i),--n):e.appendChild(o))}}},r.replaceNode=function(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)};var i=e("./has.js")},{"./has.js":221}],124:[function(e,t,r){"use strict";function n(e){return Math.pow(e,3)}function i(e){return 3*e*e-2*e*e*e}Object.defineProperty(r,"__esModule",{value:!0}),r.easeIn=n,r.easeOut=function(e){return 1-n(1-e)},r.inAndOut=i,r.linear=function(e){return e},r.upAndDown=function(e){return e<.5?i(2*e):1-i(2*(e-.5))}},{}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.listen=i,r.listenOnce=function(e,t,r,n){return i(e,t,r,n,!0)},r.unlistenByKey=function(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),(0,n.clear)(e))};var n=e("./obj.js");function i(e,t,r,n,i){n&&n!==e&&(r=r.bind(n)),i&&(o=r,r=function(){e.removeEventListener(t,r),o.apply(this,arguments)});var o,n={target:e,type:t,listener:r};return e.addEventListener(t,r),n}},{"./obj.js":269}],126:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.preventDefault=function(e){e.preventDefault()},r.stopPropagation=function(e){e.stopPropagation()};var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}var e,r,n;return e=t,(r=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=n},{}],127:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"}},{}],128:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={LEFT:37,UP:38,RIGHT:39,DOWN:40}},{}],129:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("../Disposable.js")),l=a(e("./Event.js")),c=e("../functions.js"),o=e("../obj.js");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=f(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).eventTarget_=e,t.pendingRemovals_=null,t.dispatching_=null,t.listeners_=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"addEventListener",value:function(e,t){var r;e&&t&&((r=(r=this.listeners_||(this.listeners_={}))[e]||(r[e]=[])).includes(t)||r.push(t))}},{key:"dispatchEvent",value:function(e){var t="string"==typeof e,r=t?e:e.type,n=this.listeners_&&this.listeners_[r];if(n){var i,o=t?new l.default(e):e,t=(o.target||(o.target=this.eventTarget_||this),this.dispatching_||(this.dispatching_={})),e=this.pendingRemovals_||(this.pendingRemovals_={});r in t||(t[r]=0,e[r]=0),++t[r];for(var a=0,s=n.length;a<s;++a)if(!1===(i="handleEvent"in n[a]?n[a].handleEvent(o):n[a].call(this,o))||o.propagationStopped){i=!1;break}if(0==--t[r]){var u=e[r];for(delete e[r];u--;)this.removeEventListener(r,c.VOID);delete t[r]}return i}}},{key:"disposeInternal",value:function(){this.listeners_&&(0,o.clear)(this.listeners_)}},{key:"getListeners",value:function(e){return this.listeners_&&this.listeners_[e]||void 0}},{key:"hasListener",value:function(e){return!!this.listeners_&&(e?e in this.listeners_:0<Object.keys(this.listeners_).length)}},{key:"removeEventListener",value:function(e,t){var r=this.listeners_&&this.listeners_[e];r&&-1!==(t=r.indexOf(t))&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[t]=c.VOID,++this.pendingRemovals_[e]):(r.splice(t,1),0===r.length&&delete this.listeners_[e]))}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Disposable.js":74,"../functions.js":189,"../obj.js":269,"./Event.js":126}],130:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.all=function(e){var i=arguments;return function(e){for(var t=!0,r=0,n=i.length;r<n&&(t=t&&i[r](e));++r);return t}},r.touchOnly=r.targetNotEditable=r.singleClick=r.shiftKeyOnly=r.primaryAction=r.pointerMove=r.platformModifierKeyOnly=r.penOnly=r.noModifierKeys=r.never=r.mouseOnly=r.mouseActionButton=r.focusWithTabindex=r.focus=r.doubleClick=r.click=r.always=r.altShiftKeysOnly=r.altKeyOnly=void 0;var n=(i=e("../MapBrowserEventType.js"))&&i.__esModule?i:{default:i},i=e("../functions.js"),o=e("../has.js"),a=e("../asserts.js");function s(e){var t=e.map.getTargetElement(),e=e.map.getOwnerDocument().activeElement;return t.contains(e)}r.altKeyOnly=function(e){e=e.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},r.altShiftKeysOnly=function(e){e=e.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},r.focus=s;r.focusWithTabindex=function(e){return!e.map.getTargetElement().hasAttribute("tabindex")||s(e)};e=i.TRUE,r.always=e,r.click=function(e){return e.type==n.default.CLICK},r.mouseActionButton=function(e){e=e.originalEvent;return 0==e.button&&!(o.WEBKIT&&o.MAC&&e.ctrlKey)},e=i.FALSE;r.never=e,r.pointerMove=function(e){return"pointermove"==e.type},r.singleClick=function(e){return e.type==n.default.SINGLECLICK},r.doubleClick=function(e){return e.type==n.default.DBLCLICK},r.noModifierKeys=function(e){e=e.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},r.platformModifierKeyOnly=function(e){e=e.originalEvent;return!e.altKey&&(o.MAC?e.metaKey:e.ctrlKey)&&!e.shiftKey},r.shiftKeyOnly=function(e){e=e.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},r.targetNotEditable=function(e){var e=e.originalEvent,t=e.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t&&!e.target.isContentEditable},r.mouseOnly=function(e){e=e.originalEvent;return(0,a.assert)(void 0!==e,56),"mouse"==e.pointerType},r.touchOnly=function(e){e=e.originalEvent;return(0,a.assert)(void 0!==e,56),"touch"===e.pointerType},r.penOnly=function(e){e=e.originalEvent;return(0,a.assert)(void 0!==e,56),"pen"===e.pointerType};r.primaryAction=function(e){e=e.originalEvent;return(0,a.assert)(void 0!==e,56),e.isPrimary&&0===e.button}},{"../MapBrowserEventType.js":86,"../asserts.js":105,"../functions.js":189,"../has.js":221}],131:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.applyTransform=function(e,t,r,n){var i=[];if(1<n)for(var o=e[2]-e[0],a=e[3]-e[1],s=0;s<n;++s)i.push(e[0]+o*s/n,e[1],e[2],e[1]+a*s/n,e[2]-o*s/n,e[3],e[0],e[3]-a*s/n);else i=[e[0],e[1],e[2],e[1],e[2],e[3],e[0],e[3]];t(i,i,2);for(var u=[],l=[],c=0,f=i.length;c<f;c+=2)u.push(i[c]),l.push(i[c+1]);return function(e,t,r){var n=Math.min.apply(null,e),i=Math.min.apply(null,t),e=Math.max.apply(null,e),t=Math.max.apply(null,t);return h(n,i,e,t,r)}(u,l,r)},r.approximatelyEquals=function(e,t,r){return Math.abs(e[0]-t[0])<r&&Math.abs(e[2]-t[2])<r&&Math.abs(e[1]-t[1])<r&&Math.abs(e[3]-t[3])<r},r.boundingExtent=function(e){for(var t=o(),r=0,n=e.length;r<n;++r)s(t,e[r]);return t},r.buffer=function(e,t,r){return r?(r[0]=e[0]-t,r[1]=e[1]-t,r[2]=e[2]+t,r[3]=e[3]+t,r):[e[0]-t,e[1]-t,e[2]+t,e[3]+t]},r.clone=function(e,t){return t?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):e.slice()},r.closestSquaredDistanceXY=function(e,t,r){t=t<e[0]?e[0]-t:e[2]<t?t-e[2]:0;r=r<e[1]?e[1]-r:e[3]<r?r-e[3]:0;return t*t+r*r},r.containsCoordinate=function(e,t){return i(e,t[0],t[1])},r.containsExtent=function(e,t){return e[0]<=t[0]&&t[2]<=e[2]&&e[1]<=t[1]&&t[3]<=e[3]},r.containsXY=i,r.coordinateRelationship=d,r.createEmpty=o,r.createOrUpdate=h,r.createOrUpdateEmpty=a,r.createOrUpdateFromCoordinate=function(e,t){var r=e[0],e=e[1];return h(r,e,r,e,t)},r.createOrUpdateFromCoordinates=function(e,t){return u(a(t),e)},r.createOrUpdateFromFlatCoordinates=function(e,t,r,n,i){return c(a(i),e,t,r,n)},r.createOrUpdateFromRings=function(e,t){return f(a(t),e)},r.equals=function(e,t){return e[0]==t[0]&&e[2]==t[2]&&e[1]==t[1]&&e[3]==t[3]},r.extend=function(e,t){t[0]<e[0]&&(e[0]=t[0]);t[2]>e[2]&&(e[2]=t[2]);t[1]<e[1]&&(e[1]=t[1]);t[3]>e[3]&&(e[3]=t[3]);return e},r.extendCoordinate=s,r.extendCoordinates=u,r.extendFlatCoordinates=c,r.extendRings=f,r.extendXY=y,r.forEachCorner=function(e,t){var r;if(r=t(m(e)))return r;if(r=t(v(e)))return r;if(r=t(j(e)))return r;if(r=t(S(e)))return r;return!1},r.getArea=g,r.getBottomLeft=m,r.getBottomRight=v,r.getCenter=b,r.getCorner=function(e,t){var r;"bottom-left"===t?r=m(e):"bottom-right"===t?r=v(e):"top-left"===t?r=S(e):"top-right"===t?r=j(e):(0,n.assert)(!1,13);return r},r.getEnlargedArea=function(e,t){var r=Math.min(e[0],t[0]),n=Math.min(e[1],t[1]),i=Math.max(e[2],t[2]),e=Math.max(e[3],t[3]);return(i-r)*(e-n)},r.getForViewAndSize=function(e,t,r,n,i){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?l(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(_(e,t,r,n),8),t=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],e=e[7];return h(Math.min(t,n,a,u),Math.min(r,o,s,e),Math.max(t,n,a,u),Math.max(r,o,s,e),i)},r.getHeight=w,r.getIntersection=x,r.getIntersectionArea=function(e,t){return g(x(e,t))},r.getMargin=function(e){return O(e)+w(e)},r.getRotatedViewport=_,r.getSize=function(e){return[e[2]-e[0],e[3]-e[1]]},r.getTopLeft=S,r.getTopRight=j,r.getWidth=O,r.intersects=P,r.intersectsSegment=function(e,t,r){var n,i,o=!1,a=d(e,t),s=d(e,r);{var u,l,c,f,h;a===p.default.INTERSECTING||s===p.default.INTERSECTING?o=!0:(u=e[0],l=e[1],c=e[2],e=e[3],f=t[0],t=t[1],h=r[0],r=r[1],t=(r-t)/(h-f),(o=(o=(o=s&p.default.ABOVE&&!(a&p.default.ABOVE)?u<=(n=h-(r-e)/t)&&n<=c:o)||!(s&p.default.RIGHT)||a&p.default.RIGHT?o:l<=(i=r-(h-c)*t)&&i<=e)||!(s&p.default.BELOW)||a&p.default.BELOW?o:u<=(n=h-(r-l)/t)&&n<=c)||!(s&p.default.LEFT)||a&p.default.LEFT||(o=l<=(i=r-(h-u)*t)&&i<=e))}return o},r.isEmpty=k,r.returnOrUpdate=function(e,t){return t?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):e},r.scaleFromCenter=function(e,t){var r=(e[2]-e[0])/2*(t-1),t=(e[3]-e[1])/2*(t-1);e[0]-=r,e[2]+=r,e[1]-=t,e[3]+=t},r.wrapAndSliceX=function(e,t){if(t.canWrapX()){var r=t.getExtent();if(!isFinite(e[0])||!isFinite(e[2]))return[[r[0],e[1],r[2],e[3]]];E(e,t);t=O(r);if(O(e)>t)return[[r[0],e[1],r[2],e[3]]];if(e[0]<r[0])return[[e[0]+t,e[1],r[2],e[3]],[r[0],e[1],e[2],e[3]]];if(e[2]>r[2])return[[e[0],e[1],r[2],e[3]],[r[0],e[1],e[2]-t,e[3]]]}return[e]},r.wrapX=E;var p=(r=e("./extent/Relationship.js"))&&r.__esModule?r:{default:r},n=e("./asserts.js");function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t,r){return e[0]<=t&&t<=e[2]&&e[1]<=r&&r<=e[3]}function d(e,t){var r=e[0],n=e[1],i=e[2],e=e[3],o=t[0],t=t[1],a=p.default.UNKNOWN;return o<r?a|=p.default.LEFT:i<o&&(a|=p.default.RIGHT),t<n?a|=p.default.BELOW:e<t&&(a|=p.default.ABOVE),a=a===p.default.UNKNOWN?p.default.INTERSECTING:a}function o(){return[1/0,1/0,-1/0,-1/0]}function h(e,t,r,n,i){return i?(i[0]=e,i[1]=t,i[2]=r,i[3]=n,i):[e,t,r,n]}function a(e){return h(1/0,1/0,-1/0,-1/0,e)}function s(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function u(e,t){for(var r=0,n=t.length;r<n;++r)s(e,t[r]);return e}function c(e,t,r,n,i){for(;r<n;r+=i)y(e,t[r],t[r+1]);return e}function f(e,t){for(var r=0,n=t.length;r<n;++r)u(e,t[r]);return e}function y(e,t,r){e[0]=Math.min(e[0],t),e[1]=Math.min(e[1],r),e[2]=Math.max(e[2],t),e[3]=Math.max(e[3],r)}function g(e){var t=0;return t=k(e)?t:O(e)*w(e)}function m(e){return[e[0],e[1]]}function v(e){return[e[2],e[1]]}function b(e){return[(e[0]+e[2])/2,(e[1]+e[3])/2]}function _(e,t,r,n){var i=t*n[0]/2,t=t*n[1]/2,n=Math.cos(r),r=Math.sin(r),o=i*n,i=i*r,n=t*n,t=t*r,r=e[0],e=e[1];return[r-o+t,e-i-n,r-o-t,e-i+n,r+o-t,e+i+n,r+o+t,e+i-n,r-o+t,e-i-n]}function w(e){return e[3]-e[1]}function x(e,t,r){r=r||o();return P(e,t)?(e[0]>t[0]?r[0]=e[0]:r[0]=t[0],e[1]>t[1]?r[1]=e[1]:r[1]=t[1],e[2]<t[2]?r[2]=e[2]:r[2]=t[2],e[3]<t[3]?r[3]=e[3]:r[3]=t[3]):a(r),r}function S(e){return[e[0],e[3]]}function j(e){return[e[2],e[3]]}function O(e){return e[2]-e[0]}function P(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}function k(e){return e[2]<e[0]||e[3]<e[1]}function E(e,t){var r=t.getExtent(),n=b(e);return t.canWrapX()&&(n[0]<r[0]||n[0]>=r[2])&&(t=O(r),n=Math.floor((n[0]-r[0])/t)*t,e[0]-=n,e[2]-=n),e}},{"./asserts.js":105,"./extent/Relationship.js":132}],132:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}},{}],133:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.loadFeaturesXhr=c,r.setWithCredentials=function(e){l=e},r.xhr=function(a,s){return function(e,t,r,n,i){var o=this;c(a,s,e,t,r,function(e,t){o.addFeatures(e),void 0!==n&&n(e)},i||u.VOID)}};var u=e("./functions.js"),l=!1;function c(e,n,i,t,o,a,s){var u=new XMLHttpRequest;u.open("GET","function"==typeof e?e(i,t,o):e,!0),"arraybuffer"==n.getType()&&(u.responseType="arraybuffer"),u.withCredentials=l,u.onload=function(e){var t,r;(!u.status||200<=u.status&&u.status<300)&&("json"==(t=n.getType())||"text"==t?r=u.responseText:"xml"==t?r=(r=u.responseXML)||(new DOMParser).parseFromString(u.responseText,"application/xml"):"arraybuffer"==t&&(r=u.response),r)?a(n.readFeatures(r,{extent:i,featureProjection:o}),n.readProjection(r)):s()},u.onerror=s,u.send()}},{"./functions.js":189}],134:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"EsriJSON",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"GML",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"GPX",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"GeoJSON",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"IGC",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"IIIFInfo",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"KML",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"MVT",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"OWS",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"Polyline",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"TopoJSON",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"WFS",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"WKB",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"WKT",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"WMSCapabilities",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"WMSGetFeatureInfo",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(r,"WMTSCapabilities",{enumerable:!0,get:function(){return b.default}});var n=_(e("./format/EsriJSON.js")),i=_(e("./format/GeoJSON.js")),o=_(e("./format/GML.js")),a=_(e("./format/GPX.js")),s=_(e("./format/IGC.js")),u=_(e("./format/IIIFInfo.js")),l=_(e("./format/KML.js")),c=_(e("./format/MVT.js")),f=_(e("./format/OWS.js")),h=_(e("./format/Polyline.js")),p=_(e("./format/TopoJSON.js")),d=_(e("./format/WFS.js")),y=_(e("./format/WKB.js")),g=_(e("./format/WKT.js")),m=_(e("./format/WMSCapabilities.js")),v=_(e("./format/WMSGetFeatureInfo.js")),b=_(e("./format/WMTSCapabilities.js"));function _(e){return e&&e.__esModule?e:{default:e}}},{"./format/EsriJSON.js":135,"./format/GML.js":137,"./format/GPX.js":142,"./format/GeoJSON.js":143,"./format/IGC.js":144,"./format/IIIFInfo.js":145,"./format/KML.js":147,"./format/MVT.js":148,"./format/OWS.js":149,"./format/Polyline.js":150,"./format/TopoJSON.js":152,"./format/WFS.js":153,"./format/WKB.js":154,"./format/WKT.js":155,"./format/WMSCapabilities.js":156,"./format/WMSGetFeatureInfo.js":157,"./format/WMTSCapabilities.js":158}],135:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=_(e("../Feature.js")),n=_(e("./JSONFeature.js")),a=_(e("../geom/LineString.js")),c=_(e("../geom/LinearRing.js")),s=_(e("../geom/MultiLineString.js")),u=_(e("../geom/MultiPoint.js")),l=_(e("../geom/MultiPolygon.js")),f=_(e("../geom/Point.js")),h=_(e("../geom/Polygon.js")),p=e("../asserts.js"),d=e("../extent.js"),y=e("../geom/flat/deflate.js"),g=e("../proj.js"),m=e("../obj.js"),v=e("../geom/flat/orient.js"),b=e("./Feature.js");function _(e){return e&&e.__esModule?e:{default:e}}function w(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=P(r),t=(e=n?(e=P(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k={Point:function(e){e=void 0!==e.m&&void 0!==e.z?new f.default([e.x,e.y,e.z,e.m],"XYZM"):void 0!==e.z?new f.default([e.x,e.y,e.z],"XYZ"):void 0!==e.m?new f.default([e.x,e.y,e.m],"XYM"):new f.default([e.x,e.y]);return e},LineString:function(e){var t=C(e);return new a.default(e.paths[0],t)},Polygon:function(e){var t=C(e);return new h.default(e.rings,t)},MultiPoint:function(e){var t=C(e);return new u.default(e.points,t)},MultiLineString:function(e){var t=C(e);return new s.default(e.paths,t)},MultiPolygon:function(e){var t=C(e);return new l.default(e.rings,t)}},E={Point:function(e,t){var r,n=e.getCoordinates(),e=e.getLayout();"XYZ"===e?r={x:n[0],y:n[1],z:n[2]}:"XYM"===e?r={x:n[0],y:n[1],m:n[2]}:"XYZM"===e?r={x:n[0],y:n[1],z:n[2],m:n[3]}:"XY"===e?r={x:n[0],y:n[1]}:(0,p.assert)(!1,34);return r},LineString:function(e,t){var r=R(e);return{hasZ:r.hasZ,hasM:r.hasM,paths:[e.getCoordinates()]}},Polygon:function(e,t){var r=R(e);return{hasZ:r.hasZ,hasM:r.hasM,rings:e.getCoordinates(!1)}},MultiPoint:function(e,t){var r=R(e);return{hasZ:r.hasZ,hasM:r.hasM,points:e.getCoordinates()}},MultiLineString:function(e,t){var r=R(e);return{hasZ:r.hasZ,hasM:r.hasM,paths:e.getCoordinates()}},MultiPolygon:function(e,t){for(var r=R(e),n=e.getCoordinates(!1),i=[],o=0;o<n.length;o++)for(var a=n[o].length-1;0<=a;a--)i.push(n[o][a]);return{hasZ:r.hasZ,hasM:r.hasM,rings:i}}},e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e);var r,n=O(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).geometryName_=e.geometryName,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFeatureFromObject",value:function(e,t,r){var t=T(e.geometry,t),n=new o.default;return this.geometryName_&&n.setGeometryName(this.geometryName_),n.setGeometry(t),e.attributes&&(n.setProperties(e.attributes,!0),void 0!==(t=e.attributes[r]))&&n.setId(t),n}},{key:"readFeaturesFromObject",value:function(e,t){if(t=t||{},e.features){for(var r=[],n=e.features,i=0,o=n.length;i<o;++i)r.push(this.readFeatureFromObject(n[i],t,e.objectIdFieldName));return r}return[this.readFeatureFromObject(e,t)]}},{key:"readGeometryFromObject",value:T},{key:"readProjectionFromObject",value:function(e){return e.spatialReference&&void 0!==e.spatialReference.wkid?(e=e.spatialReference.wkid,(0,g.get)("EPSG:"+e)):null}},{key:"writeGeometryObject",value:function(e,t){return M(e,this.adaptOptions(t))}},{key:"writeFeatureObject",value:function(e,t){t=this.adaptOptions(t);var r,n,i={};return e.hasProperties()?(r=e.getProperties(),(n=e.getGeometry())&&(i.geometry=M(n,t),(n=t&&(t.dataProjection||t.featureProjection))&&(i.geometry.spatialReference={wkid:Number((0,g.get)(n).getCode().split(":").pop())}),delete r[e.getGeometryName()]),(0,m.isEmpty)(r)?i.attributes={}:i.attributes=r):i.attributes={},i}},{key:"writeFeaturesObject",value:function(e,t){t=this.adaptOptions(t);for(var r=[],n=0,i=e.length;n<i;++n)r.push(this.writeFeatureObject(e[n],t));return{features:r}}}])&&x(t.prototype,e),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function T(e,t){var r,n,i;return e?("number"==typeof e.x&&"number"==typeof e.y?r="Point":e.points?r="MultiPoint":e.paths?r=1===e.paths.length?"LineString":"MultiLineString":e.rings&&(n=C(i=e),e=1===(i=function(e,t){var r,n,i=[],o=[],a=[];for(r=0,n=e.length;r<n;++r)(i.length=0,y.deflateCoordinates)(i,0,e[r],t.length),(0,v.linearRingIsClockwise)(i,0,i.length,t.length)?o.push([e[r]]):a.push(e[r]);for(;a.length;){var s=a.shift(),u=!1;for(r=o.length-1;0<=r;r--){var l=o[r][0];if((0,d.containsExtent)(new c.default(l).getExtent(),new c.default(s).getExtent())){o[r].push(s),u=!0;break}}u||o.push([s.reverse()])}return o}(i.rings,n)).length?(r="Polygon",Object.assign({},e,w({},"rings",i[0]))):(r="MultiPolygon",Object.assign({},e,w({},"rings",i)))),(0,b.transformGeometryWithOptions)((0,k[r])(e),!1,t)):null}function C(e){var t="XY";return!0===e.hasZ&&!0===e.hasM?t="XYZM":!0===e.hasZ?t="XYZ":!0===e.hasM&&(t="XYM"),t}function R(e){e=e.getLayout();return{hasZ:"XYZ"===e||"XYZM"===e,hasM:"XYM"===e||"XYZM"===e}}function M(e,t){return(0,E[e.getType()])((0,b.transformGeometryWithOptions)(e,!0,t),t)}r.default=e},{"../Feature.js":75,"../asserts.js":105,"../extent.js":131,"../geom/LineString.js":194,"../geom/LinearRing.js":195,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../geom/flat/deflate.js":206,"../geom/flat/orient.js":214,"../obj.js":269,"../proj.js":271,"./Feature.js":136,"./JSONFeature.js":146}],136:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.transformExtentWithOptions=function(e,t){var r=t?(0,a.get)(t.featureProjection):null,t=t?(0,a.get)(t.dataProjection):null;return r&&t&&!(0,a.equivalent)(r,t)?(0,a.transformExtent)(e,t,r):e},r.transformGeometryWithOptions=function(e,t,r){var n=r?(0,a.get)(r.featureProjection):null,i=r?(0,a.get)(r.dataProjection):null;i=n&&i&&!(0,a.equivalent)(n,i)?(t?e.clone():e).transform(t?n:i,t?i:n):e;{var o;t&&r&&void 0!==r.decimals&&(o=Math.pow(10,r.decimals),(i=i===e?e.clone():i).applyTransform(function(e){for(var t=0,r=e.length;t<r;++t)e[t]=Math.round(e[t]*o)/o;return e}))}return i};var i=e("../util.js"),a=e("../proj.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}e=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}var t,r,n;return t=e,(r=[{key:"getReadOptions",value:function(e,t){return t&&(e=t.dataProjection?(0,a.get)(t.dataProjection):this.readProjection(e),t.extent&&e&&"tile-pixels"===e.getUnits()&&(e=(0,a.get)(e)).setWorldExtent(t.extent),t={dataProjection:e,featureProjection:t.featureProjection}),this.adaptOptions(t)}},{key:"adaptOptions",value:function(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)}},{key:"getType",value:function(){return(0,i.abstract)()}},{key:"readFeature",value:function(e,t){return(0,i.abstract)()}},{key:"readFeatures",value:function(e,t){return(0,i.abstract)()}},{key:"readGeometry",value:function(e,t){return(0,i.abstract)()}},{key:"readProjection",value:function(e){return(0,i.abstract)()}},{key:"writeFeature",value:function(e,t){return(0,i.abstract)()}},{key:"writeFeatures",value:function(e,t){return(0,i.abstract)()}},{key:"writeGeometry",value:function(e,t){return(0,i.abstract)()}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=e},{"../proj.js":271,"../util.js":379}],137:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=((e=e("./GML3.js"))&&e.__esModule?e:{default:e}).default;e.prototype.writeFeatures,e.prototype.writeFeaturesNode,r.default=e},{"./GML3.js":139}],138:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./GMLBase.js")),h=e("../xml.js"),s=e("../extent.js"),c=e("../proj.js"),u=e("./Feature.js"),p=e("./xsd.js");function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=o.GMLNS+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",m={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=y(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,e=e||{})).FEATURE_COLLECTION_PARSERS[o.GMLNS].featureMember=(0,h.makeArrayPusher)(t.readFeaturesInternal),t.schemaLocation=e.schemaLocation||g,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFlatCoordinates",value:function(e,t){for(var e=(0,h.getAllTextContent)(e,!1).replace(/^\s*|\s*$/g,""),t=t[0].srsName,r="enu",n=(t&&(t=(0,c.get)(t))&&(r=t.getAxisOrientation()),e.trim().split(/\s+/)),i=[],o=0,a=n.length;o<a;o++){var s=n[o].split(/,+/),u=parseFloat(s[0]),l=parseFloat(s[1]),s=3===s.length?parseFloat(s[2]):0;"en"===r.substr(0,2)?i.push(u,l,s):i.push(l,u,s)}return i}},{key:"readBox",value:function(e,t){e=(0,h.pushParseAndPop)([null],this.BOX_PARSERS_,e,t,this);return(0,s.createOrUpdate)(e[1][0],e[1][1],e[1][3],e[1][4])}},{key:"innerBoundaryIsParser",value:function(e,t){e=(0,h.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);e&&t[t.length-1].push(e)}},{key:"outerBoundaryIsParser",value:function(e,t){e=(0,h.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);e&&(t[t.length-1][0]=e)}},{key:"GEOMETRY_NODE_FACTORY_",value:function(e,t,r){var t=t[t.length-1],n=t.multiSurface,i=t.surface,t=t.multiCurve;return Array.isArray(e)?r="Envelope":"MultiPolygon"===(r=e.getType())&&!0===n?r="MultiSurface":"Polygon"===r&&!0===i?r="Surface":"MultiLineString"===r&&!0===t&&(r="MultiCurve"),(0,h.createElementNS)("http://www.opengis.net/gml",r)}},{key:"writeFeatureElement",value:function(e,t,r){var n=t.getId(),i=(n&&e.setAttribute("fid",n),r[r.length-1]),o=i.featureNS,a=t.getGeometryName(),s=(i.serializers||(i.serializers={},i.serializers[o]={}),[]),u=[];if(t.hasProperties()){var l,c=t.getProperties();for(l in c){var f=c[l];null!==f&&(s.push(l),u.push(f),l==a||"function"==typeof f.getSimplifiedGeometry?l in i.serializers[o]||(i.serializers[o][l]=(0,h.makeChildAppender)(this.writeGeometryElement,this)):l in i.serializers[o]||(i.serializers[o][l]=(0,h.makeChildAppender)(p.writeStringTextNode)))}}n=Object.assign({},i);n.node=e,(0,h.pushSerializeAndPop)(n,i.serializers,(0,h.makeSimpleNodeFactory)(void 0,o),u,r,s)}},{key:"writeCurveOrLineString",value:function(e,t,r){var n=r[r.length-1].srsName;"LineStringSegment"!==e.nodeName&&n&&e.setAttribute("srsName",n),"LineString"===e.nodeName||"LineStringSegment"===e.nodeName?(n=this.createCoordinatesNode_(e.namespaceURI),e.appendChild(n),this.writeCoordinates_(n,t,r)):"Curve"===e.nodeName&&(n=(0,h.createElementNS)(e.namespaceURI,"segments"),e.appendChild(n),this.writeCurveSegments_(n,t,r))}},{key:"writeLineStringOrCurveMember",value:function(e,t,r){var n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,r))}},{key:"writeMultiCurveOrLineString",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,n=n.curve,t=(o&&e.setAttribute("srsName",o),t.getLineStrings());(0,h.pushSerializeAndPop)({node:e,hasZ:i,srsName:o,curve:n},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,t,r,void 0,this)}},{key:"writeGeometryElement",value:function(e,t,r){var n=r[r.length-1],i=Object.assign({},n);i.node=e,e=Array.isArray(t)?(0,u.transformExtentWithOptions)(t,n):(0,u.transformGeometryWithOptions)(t,!0,n),(0,h.pushSerializeAndPop)(i,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[e],r,void 0,this)}},{key:"createCoordinatesNode_",value:function(e){e=(0,h.createElementNS)(e,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e}},{key:"writeCoordinates_",value:function(e,t,r){for(var r=r[r.length-1],n=r.hasZ,i=r.srsName,o=t.getCoordinates(),a=o.length,s=new Array(a),u=0;u<a;++u){var l=o[u];s[u]=this.getCoords_(l,i,n)}(0,p.writeStringTextNode)(e,s.join(" "))}},{key:"writeCurveSegments_",value:function(e,t,r){var n=(0,h.createElementNS)(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,r)}},{key:"writeSurfaceOrPolygon",value:function(e,t,r){var n,i=r[r.length-1],o=i.hasZ,i=i.srsName;"PolygonPatch"!==e.nodeName&&i&&e.setAttribute("srsName",i),"Polygon"===e.nodeName||"PolygonPatch"===e.nodeName?(n=t.getLinearRings(),(0,h.pushSerializeAndPop)({node:e,hasZ:o,srsName:i},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,n,r,void 0,this)):"Surface"===e.nodeName&&(o=(0,h.createElementNS)(e.namespaceURI,"patches"),e.appendChild(o),this.writeSurfacePatches_(o,t,r))}},{key:"RING_NODE_FACTORY_",value:function(e,t,r){var t=t[t.length-1],n=t.node,i=t.exteriorWritten;return void 0===i&&(t.exteriorWritten=!0),(0,h.createElementNS)(n.namespaceURI,void 0!==i?"innerBoundaryIs":"outerBoundaryIs")}},{key:"writeSurfacePatches_",value:function(e,t,r){var n=(0,h.createElementNS)(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r)}},{key:"writeRing",value:function(e,t,r){var n=(0,h.createElementNS)(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,r)}},{key:"getCoords_",value:function(e,t,r){var n="enu",t="en"===(n=t?(0,c.get)(t).getAxisOrientation():n).substr(0,2)?e[0]+","+e[1]:e[1]+","+e[0];return r&&(t+=","+(e[2]||0)),t}},{key:"writePoint",value:function(e,t,r){var r=r[r.length-1],n=r.hasZ,r=r.srsName,i=(r&&e.setAttribute("srsName",r),this.createCoordinatesNode_(e.namespaceURI)),e=(e.appendChild(i),t.getCoordinates()),t=this.getCoords_(e,r,n);(0,p.writeStringTextNode)(i,t)}},{key:"writeMultiPoint",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,n=n.srsName,t=(n&&e.setAttribute("srsName",n),t.getPoints());(0,h.pushSerializeAndPop)({node:e,hasZ:i,srsName:n},this.POINTMEMBER_SERIALIZERS,(0,h.makeSimpleNodeFactory)("pointMember"),t,r,void 0,this)}},{key:"writePointMember",value:function(e,t,r){var n=(0,h.createElementNS)(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,r)}},{key:"writeLinearRing",value:function(e,t,r){var n=r[r.length-1].srsName,n=(n&&e.setAttribute("srsName",n),this.createCoordinatesNode_(e.namespaceURI));e.appendChild(n),this.writeCoordinates_(n,t,r)}},{key:"writeMultiSurfaceOrPolygon",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,n=n.surface,t=(o&&e.setAttribute("srsName",o),t.getPolygons());(0,h.pushSerializeAndPop)({node:e,hasZ:i,srsName:o,surface:n},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,t,r,void 0,this)}},{key:"writeSurfaceOrPolygonMember",value:function(e,t,r){var n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r))}},{key:"writeEnvelope",value:function(e,t,r){var n=r[r.length-1].srsName,n=(n&&e.setAttribute("srsName",n),[t[0]+" "+t[1],t[2]+" "+t[3]]);(0,h.pushSerializeAndPop)({node:e},this.ENVELOPE_SERIALIZERS,h.OBJECT_PROPERTY_NODE_FACTORY,n,r,["lowerCorner","upperCorner"],this)}},{key:"MULTIGEOMETRY_MEMBER_NODE_FACTORY_",value:function(e,t,r){t=t[t.length-1].node;return(0,h.createElementNS)("http://www.opengis.net/gml",m[t.nodeName])}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);e.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:(0,h.makeReplacer)(e.prototype.readFlatCoordinates)}},e.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:e.prototype.innerBoundaryIsParser,outerBoundaryIs:e.prototype.outerBoundaryIsParser}},e.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:(0,h.makeArrayPusher)(e.prototype.readFlatCoordinates)}},e.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:(0,h.makeReplacer)(o.default.prototype.readPoint),MultiPoint:(0,h.makeReplacer)(o.default.prototype.readMultiPoint),LineString:(0,h.makeReplacer)(o.default.prototype.readLineString),MultiLineString:(0,h.makeReplacer)(o.default.prototype.readMultiLineString),LinearRing:(0,h.makeReplacer)(o.default.prototype.readLinearRing),Polygon:(0,h.makeReplacer)(o.default.prototype.readPolygon),MultiPolygon:(0,h.makeReplacer)(o.default.prototype.readMultiPolygon),Box:(0,h.makeReplacer)(e.prototype.readBox)}},e.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:(0,h.makeChildAppender)(e.prototype.writeCurveOrLineString),MultiCurve:(0,h.makeChildAppender)(e.prototype.writeMultiCurveOrLineString),Point:(0,h.makeChildAppender)(e.prototype.writePoint),MultiPoint:(0,h.makeChildAppender)(e.prototype.writeMultiPoint),LineString:(0,h.makeChildAppender)(e.prototype.writeCurveOrLineString),MultiLineString:(0,h.makeChildAppender)(e.prototype.writeMultiCurveOrLineString),LinearRing:(0,h.makeChildAppender)(e.prototype.writeLinearRing),Polygon:(0,h.makeChildAppender)(e.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,h.makeChildAppender)(e.prototype.writeMultiSurfaceOrPolygon),Surface:(0,h.makeChildAppender)(e.prototype.writeSurfaceOrPolygon),MultiSurface:(0,h.makeChildAppender)(e.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,h.makeChildAppender)(e.prototype.writeEnvelope)}},e.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:(0,h.makeChildAppender)(e.prototype.writeLineStringOrCurveMember),curveMember:(0,h.makeChildAppender)(e.prototype.writeLineStringOrCurveMember)}},e.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:(0,h.makeChildAppender)(e.prototype.writeRing),innerBoundaryIs:(0,h.makeChildAppender)(e.prototype.writeRing)}},e.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:(0,h.makeChildAppender)(e.prototype.writePointMember)}},e.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:(0,h.makeChildAppender)(e.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,h.makeChildAppender)(e.prototype.writeSurfaceOrPolygonMember)}},e.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:(0,h.makeChildAppender)(p.writeStringTextNode),upperCorner:(0,h.makeChildAppender)(p.writeStringTextNode)}};r.default=e},{"../extent.js":131,"../proj.js":271,"../xml.js":391,"./Feature.js":136,"./GMLBase.js":141,"./xsd.js":188}],139:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=m(e("./GML2.js")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=g(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./GMLBase.js")),o=m(e("../geom/LineString.js")),s=m(e("../geom/MultiLineString.js")),u=m(e("../geom/MultiPolygon.js")),l=m(e("../geom/Polygon.js")),p=e("../xml.js"),c=e("../extent.js"),f=e("../array.js"),d=e("../proj.js"),y=e("./xsd.js"),h=e("./Feature.js");function g(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(g=function(e){return e?r:t})(e))}function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=w(r),t=(e=n?(e=w(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=i.GMLNS+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",S={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e);var r,n=_(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,e=e||{})).surface_=void 0!==e.surface&&e.surface,t.curve_=void 0!==e.curve&&e.curve,t.multiCurve_=void 0===e.multiCurve||e.multiCurve,t.multiSurface_=void 0===e.multiSurface||e.multiSurface,t.schemaLocation=e.schemaLocation||x,t.hasZ=void 0!==e.hasZ&&e.hasZ,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readMultiCurve",value:function(e,t){e=(0,p.pushParseAndPop)([],this.MULTICURVE_PARSERS,e,t,this);if(e)return new s.default(e)}},{key:"readFlatCurveRing",value:function(e,t){for(var r=(0,p.pushParseAndPop)([],this.MULTICURVE_PARSERS,e,t,this),n=[],i=0,o=r.length;i<o;++i)(0,f.extend)(n,r[i].getFlatCoordinates());return n}},{key:"readMultiSurface",value:function(e,t){e=(0,p.pushParseAndPop)([],this.MULTISURFACE_PARSERS,e,t,this);if(e)return new u.default(e)}},{key:"curveMemberParser",value:function(e,t){(0,p.parseNode)(this.CURVEMEMBER_PARSERS,e,t,this)}},{key:"surfaceMemberParser",value:function(e,t){(0,p.parseNode)(this.SURFACEMEMBER_PARSERS,e,t,this)}},{key:"readPatch",value:function(e,t){return(0,p.pushParseAndPop)([null],this.PATCHES_PARSERS,e,t,this)}},{key:"readSegment",value:function(e,t){return(0,p.pushParseAndPop)([],this.SEGMENTS_PARSERS,e,t,this)}},{key:"readPolygonPatch",value:function(e,t){return(0,p.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this)}},{key:"readLineStringSegment",value:function(e,t){return(0,p.pushParseAndPop)([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}},{key:"interiorParser",value:function(e,t){e=(0,p.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);e&&t[t.length-1].push(e)}},{key:"exteriorParser",value:function(e,t){e=(0,p.pushParseAndPop)(void 0,this.RING_PARSERS,e,t,this);e&&(t[t.length-1][0]=e)}},{key:"readSurface",value:function(e,t){var r=(0,p.pushParseAndPop)([null],this.SURFACE_PARSERS,e,t,this);if(r&&r[0]){for(var n=r[0],i=[n.length],o=1,a=r.length;o<a;++o)(0,f.extend)(n,r[o]),i.push(n.length);return new l.default(n,"XYZ",i)}}},{key:"readCurve",value:function(e,t){e=(0,p.pushParseAndPop)([null],this.CURVE_PARSERS,e,t,this);if(e)return new o.default(e,"XYZ")}},{key:"readEnvelope",value:function(e,t){e=(0,p.pushParseAndPop)([null],this.ENVELOPE_PARSERS,e,t,this);return(0,c.createOrUpdate)(e[1][0],e[1][1],e[2][0],e[2][1])}},{key:"readFlatPos",value:function(e,t){for(var r,n=(0,p.getAllTextContent)(e,!1),i=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,o=[];r=i.exec(n);)o.push(parseFloat(r[1])),n=n.substr(r[0].length);if(""===n){e=t[0].srsName,t="enu";if("neu"===(t=e?(0,d.get)(e).getAxisOrientation():t))for(var a=0,s=o.length;a<s;a+=3){var u=o[a];o[a]=o[a+1],o[a+1]=u}e=o.length;if(2==e&&o.push(0),0!==e)return o}}},{key:"readFlatPosList",value:function(e,t){for(var r,n,i,o=(0,p.getAllTextContent)(e,!1).replace(/^\s*|\s*$/g,""),t=t[0],a=t.srsName,t=t.srsDimension,s="enu",u=(a&&(s=(0,d.get)(a).getAxisOrientation()),o.split(/\s+/)),l=2,c=(e.getAttribute("srsDimension")?l=(0,y.readNonNegativeIntegerString)(e.getAttribute("srsDimension")):e.getAttribute("dimension")?l=(0,y.readNonNegativeIntegerString)(e.getAttribute("dimension")):e.parentNode.getAttribute("srsDimension")?l=(0,y.readNonNegativeIntegerString)(e.parentNode.getAttribute("srsDimension")):t&&(l=(0,y.readNonNegativeIntegerString)(t)),[]),f=0,h=u.length;f<h;f+=l)r=parseFloat(u[f]),n=parseFloat(u[f+1]),i=3===l?parseFloat(u[f+2]):0,"en"===s.substr(0,2)?c.push(r,n,i):c.push(n,r,i);return c}},{key:"writePos_",value:function(e,t,r){var r=r[r.length-1],n=r.hasZ,r=(e.setAttribute("srsDimension",n?"3":"2"),r.srsName),i="enu",r=(r&&(i=(0,d.get)(r).getAxisOrientation()),t.getCoordinates()),t="en"===i.substr(0,2)?r[0]+" "+r[1]:r[1]+" "+r[0];n&&(t+=" "+(r[2]||0)),(0,y.writeStringTextNode)(e,t)}},{key:"getCoords_",value:function(e,t,r){var n="enu",t="en"===(n=t?(0,d.get)(t).getAxisOrientation():n).substr(0,2)?e[0]+" "+e[1]:e[1]+" "+e[0];return r&&(t+=" "+(e[2]||0)),t}},{key:"writePosList_",value:function(e,t,r){for(var n,r=r[r.length-1],i=r.hasZ,o=(e.setAttribute("srsDimension",i?"3":"2"),r.srsName),a=t.getCoordinates(),s=a.length,u=new Array(s),l=0;l<s;++l)n=a[l],u[l]=this.getCoords_(n,o,i);(0,y.writeStringTextNode)(e,u.join(" "))}},{key:"writePoint",value:function(e,t,r){var n=r[r.length-1].srsName,n=(n&&e.setAttribute("srsName",n),(0,p.createElementNS)(e.namespaceURI,"pos"));e.appendChild(n),this.writePos_(n,t,r)}},{key:"writeEnvelope",value:function(e,t,r){var n=r[r.length-1].srsName,n=(n&&e.setAttribute("srsName",n),[t[0]+" "+t[1],t[2]+" "+t[3]]);(0,p.pushSerializeAndPop)({node:e},this.ENVELOPE_SERIALIZERS,p.OBJECT_PROPERTY_NODE_FACTORY,n,r,["lowerCorner","upperCorner"],this)}},{key:"writeLinearRing",value:function(e,t,r){var n=r[r.length-1].srsName,n=(n&&e.setAttribute("srsName",n),(0,p.createElementNS)(e.namespaceURI,"posList"));e.appendChild(n),this.writePosList_(n,t,r)}},{key:"RING_NODE_FACTORY_",value:function(e,t,r){var t=t[t.length-1],n=t.node,i=t.exteriorWritten;return void 0===i&&(t.exteriorWritten=!0),(0,p.createElementNS)(n.namespaceURI,void 0!==i?"interior":"exterior")}},{key:"writeSurfaceOrPolygon",value:function(e,t,r){var n,i=r[r.length-1],o=i.hasZ,i=i.srsName;"PolygonPatch"!==e.nodeName&&i&&e.setAttribute("srsName",i),"Polygon"===e.nodeName||"PolygonPatch"===e.nodeName?(n=t.getLinearRings(),(0,p.pushSerializeAndPop)({node:e,hasZ:o,srsName:i},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,n,r,void 0,this)):"Surface"===e.nodeName&&(o=(0,p.createElementNS)(e.namespaceURI,"patches"),e.appendChild(o),this.writeSurfacePatches_(o,t,r))}},{key:"writeCurveOrLineString",value:function(e,t,r){var n=r[r.length-1].srsName;"LineStringSegment"!==e.nodeName&&n&&e.setAttribute("srsName",n),"LineString"===e.nodeName||"LineStringSegment"===e.nodeName?(n=(0,p.createElementNS)(e.namespaceURI,"posList"),e.appendChild(n),this.writePosList_(n,t,r)):"Curve"===e.nodeName&&(n=(0,p.createElementNS)(e.namespaceURI,"segments"),e.appendChild(n),this.writeCurveSegments_(n,t,r))}},{key:"writeMultiSurfaceOrPolygon",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,n=n.surface,t=(o&&e.setAttribute("srsName",o),t.getPolygons());(0,p.pushSerializeAndPop)({node:e,hasZ:i,srsName:o,surface:n},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,t,r,void 0,this)}},{key:"writeMultiPoint",value:function(e,t,r){var n=r[r.length-1],i=n.srsName,n=n.hasZ,t=(i&&e.setAttribute("srsName",i),t.getPoints());(0,p.pushSerializeAndPop)({node:e,hasZ:n,srsName:i},this.POINTMEMBER_SERIALIZERS,(0,p.makeSimpleNodeFactory)("pointMember"),t,r,void 0,this)}},{key:"writeMultiCurveOrLineString",value:function(e,t,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,n=n.curve,t=(o&&e.setAttribute("srsName",o),t.getLineStrings());(0,p.pushSerializeAndPop)({node:e,hasZ:i,srsName:o,curve:n},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,t,r,void 0,this)}},{key:"writeRing",value:function(e,t,r){var n=(0,p.createElementNS)(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,r)}},{key:"writeSurfaceOrPolygonMember",value:function(e,t,r){var n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r))}},{key:"writePointMember",value:function(e,t,r){var n=(0,p.createElementNS)(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,r)}},{key:"writeLineStringOrCurveMember",value:function(e,t,r){var n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,r))}},{key:"writeSurfacePatches_",value:function(e,t,r){var n=(0,p.createElementNS)(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r)}},{key:"writeCurveSegments_",value:function(e,t,r){var n=(0,p.createElementNS)(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,r)}},{key:"writeGeometryElement",value:function(e,t,r){var n=r[r.length-1],i=Object.assign({},n);i.node=e,e=Array.isArray(t)?(0,h.transformExtentWithOptions)(t,n):(0,h.transformGeometryWithOptions)(t,!0,n),(0,p.pushSerializeAndPop)(i,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[e],r,void 0,this)}},{key:"writeFeatureElement",value:function(e,t,r){var n=t.getId(),i=(n&&e.setAttribute("fid",n),r[r.length-1]),o=i.featureNS,a=t.getGeometryName(),s=(i.serializers||(i.serializers={},i.serializers[o]={}),[]),u=[];if(t.hasProperties()){var l,c=t.getProperties();for(l in c){var f=c[l];null!==f&&(s.push(l),u.push(f),l==a||"function"==typeof f.getSimplifiedGeometry?l in i.serializers[o]||(i.serializers[o][l]=(0,p.makeChildAppender)(this.writeGeometryElement,this)):l in i.serializers[o]||(i.serializers[o][l]=(0,p.makeChildAppender)(y.writeStringTextNode)))}}n=Object.assign({},i);n.node=e,(0,p.pushSerializeAndPop)(n,i.serializers,(0,p.makeSimpleNodeFactory)(void 0,o),u,r,s)}},{key:"writeFeatureMembers_",value:function(e,t,r){var n=r[r.length-1],i=n.featureType,o=n.featureNS,a={},n=(a[o]={},a[o][i]=(0,p.makeChildAppender)(this.writeFeatureElement,this),Object.assign({},n));n.node=e,(0,p.pushSerializeAndPop)(n,a,(0,p.makeSimpleNodeFactory)(i,o),t,r)}},{key:"MULTIGEOMETRY_MEMBER_NODE_FACTORY_",value:function(e,t,r){t=t[t.length-1].node;return(0,p.createElementNS)(this.namespace,S[t.nodeName])}},{key:"GEOMETRY_NODE_FACTORY_",value:function(e,t,r){var t=t[t.length-1],n=t.multiSurface,i=t.surface,o=t.curve,t=t.multiCurve;return Array.isArray(e)?r="Envelope":"MultiPolygon"===(r=e.getType())&&!0===n?r="MultiSurface":"Polygon"===r&&!0===i?r="Surface":"LineString"===r&&!0===o?r="Curve":"MultiLineString"===r&&!0===t&&(r="MultiCurve"),(0,p.createElementNS)(this.namespace,r)}},{key:"writeGeometryNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,p.createElementNS)(this.namespace,"geom"),n={node:r,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&Object.assign(n,t),this.writeGeometryElement(r,e,[n]),r}},{key:"writeFeaturesNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,p.createElementNS)(this.namespace,"featureMembers"),n=(r.setAttributeNS(p.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation),{srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType});return t&&Object.assign(n,t),this.writeFeatureMembers_(r,e,[n]),r}}])&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(i.default);e.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:(0,p.makeReplacer)(e.prototype.readFlatPos),posList:(0,p.makeReplacer)(e.prototype.readFlatPosList),coordinates:(0,p.makeReplacer)(n.default.prototype.readFlatCoordinates)}},e.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:e.prototype.interiorParser,exterior:e.prototype.exteriorParser}},e.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:(0,p.makeReplacer)(i.default.prototype.readPoint),MultiPoint:(0,p.makeReplacer)(i.default.prototype.readMultiPoint),LineString:(0,p.makeReplacer)(i.default.prototype.readLineString),MultiLineString:(0,p.makeReplacer)(i.default.prototype.readMultiLineString),LinearRing:(0,p.makeReplacer)(i.default.prototype.readLinearRing),Polygon:(0,p.makeReplacer)(i.default.prototype.readPolygon),MultiPolygon:(0,p.makeReplacer)(i.default.prototype.readMultiPolygon),Surface:(0,p.makeReplacer)(e.prototype.readSurface),MultiSurface:(0,p.makeReplacer)(e.prototype.readMultiSurface),Curve:(0,p.makeReplacer)(e.prototype.readCurve),MultiCurve:(0,p.makeReplacer)(e.prototype.readMultiCurve),Envelope:(0,p.makeReplacer)(e.prototype.readEnvelope)}},e.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:(0,p.makeArrayPusher)(e.prototype.curveMemberParser),curveMembers:(0,p.makeArrayPusher)(e.prototype.curveMemberParser)}},e.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:(0,p.makeArrayPusher)(e.prototype.surfaceMemberParser),surfaceMembers:(0,p.makeArrayPusher)(e.prototype.surfaceMemberParser)}},e.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:(0,p.makeArrayPusher)(i.default.prototype.readLineString),Curve:(0,p.makeArrayPusher)(e.prototype.readCurve)}},e.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:(0,p.makeArrayPusher)(i.default.prototype.readPolygon),Surface:(0,p.makeArrayPusher)(e.prototype.readSurface)}},e.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:(0,p.makeReplacer)(e.prototype.readPatch)}},e.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:(0,p.makeReplacer)(e.prototype.readSegment)}},e.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:(0,p.makeArrayPusher)(e.prototype.readFlatPosList),upperCorner:(0,p.makeArrayPusher)(e.prototype.readFlatPosList)}},e.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:(0,p.makeReplacer)(e.prototype.readPolygonPatch)}},e.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:(0,p.makeArrayExtender)(e.prototype.readLineStringSegment)}},i.default.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:(0,p.makeReplacer)(i.default.prototype.readFlatLinearRing),Ring:(0,p.makeReplacer)(e.prototype.readFlatCurveRing)}},e.prototype.writeFeatures,e.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:(0,p.makeChildAppender)(e.prototype.writeRing),interior:(0,p.makeChildAppender)(e.prototype.writeRing)}},e.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:(0,p.makeChildAppender)(y.writeStringTextNode),upperCorner:(0,p.makeChildAppender)(y.writeStringTextNode)}},e.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:(0,p.makeChildAppender)(e.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,p.makeChildAppender)(e.prototype.writeSurfaceOrPolygonMember)}},e.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:(0,p.makeChildAppender)(e.prototype.writePointMember)}},e.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:(0,p.makeChildAppender)(e.prototype.writeLineStringOrCurveMember),curveMember:(0,p.makeChildAppender)(e.prototype.writeLineStringOrCurveMember)}},e.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:(0,p.makeChildAppender)(e.prototype.writeCurveOrLineString),MultiCurve:(0,p.makeChildAppender)(e.prototype.writeMultiCurveOrLineString),Point:(0,p.makeChildAppender)(e.prototype.writePoint),MultiPoint:(0,p.makeChildAppender)(e.prototype.writeMultiPoint),LineString:(0,p.makeChildAppender)(e.prototype.writeCurveOrLineString),MultiLineString:(0,p.makeChildAppender)(e.prototype.writeMultiCurveOrLineString),LinearRing:(0,p.makeChildAppender)(e.prototype.writeLinearRing),Polygon:(0,p.makeChildAppender)(e.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,p.makeChildAppender)(e.prototype.writeMultiSurfaceOrPolygon),Surface:(0,p.makeChildAppender)(e.prototype.writeSurfaceOrPolygon),MultiSurface:(0,p.makeChildAppender)(e.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,p.makeChildAppender)(e.prototype.writeEnvelope)}},r.default=e},{"../array.js":104,"../extent.js":131,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPolygon.js":198,"../geom/Polygon.js":200,"../proj.js":271,"../xml.js":391,"./Feature.js":136,"./GML2.js":138,"./GMLBase.js":141,"./xsd.js":188}],140:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("./GML2.js")),o=u(e("./GML3.js")),a=u(e("./GMLBase.js")),s=e("../xml.js"),e=e("../format/xsd.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n,i=f(o);function o(e){var t;if(this instanceof o)return(t=i.call(this,e=e||{})).schemaLocation=e.schemaLocation||t.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",t;throw new TypeError("Cannot call a class as a function")}return t=o,r&&l(t.prototype,r),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(o.default);p.prototype.namespace="http://www.opengis.net/gml/3.2",p.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:(0,s.makeReplacer)(o.default.prototype.readFlatPos),posList:(0,s.makeReplacer)(o.default.prototype.readFlatPosList),coordinates:(0,s.makeReplacer)(n.default.prototype.readFlatCoordinates)}},p.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:o.default.prototype.interiorParser,exterior:o.default.prototype.exteriorParser}},p.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:(0,s.makeReplacer)(a.default.prototype.readPoint),MultiPoint:(0,s.makeReplacer)(a.default.prototype.readMultiPoint),LineString:(0,s.makeReplacer)(a.default.prototype.readLineString),MultiLineString:(0,s.makeReplacer)(a.default.prototype.readMultiLineString),LinearRing:(0,s.makeReplacer)(a.default.prototype.readLinearRing),Polygon:(0,s.makeReplacer)(a.default.prototype.readPolygon),MultiPolygon:(0,s.makeReplacer)(a.default.prototype.readMultiPolygon),Surface:(0,s.makeReplacer)(p.prototype.readSurface),MultiSurface:(0,s.makeReplacer)(o.default.prototype.readMultiSurface),Curve:(0,s.makeReplacer)(p.prototype.readCurve),MultiCurve:(0,s.makeReplacer)(o.default.prototype.readMultiCurve),Envelope:(0,s.makeReplacer)(p.prototype.readEnvelope)}},p.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:(0,s.makeArrayPusher)(o.default.prototype.curveMemberParser),curveMembers:(0,s.makeArrayPusher)(o.default.prototype.curveMemberParser)}},p.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:(0,s.makeArrayPusher)(o.default.prototype.surfaceMemberParser),surfaceMembers:(0,s.makeArrayPusher)(o.default.prototype.surfaceMemberParser)}},p.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:(0,s.makeArrayPusher)(a.default.prototype.readLineString),Curve:(0,s.makeArrayPusher)(o.default.prototype.readCurve)}},p.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:(0,s.makeArrayPusher)(a.default.prototype.readPolygon),Surface:(0,s.makeArrayPusher)(o.default.prototype.readSurface)}},p.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:(0,s.makeReplacer)(o.default.prototype.readPatch)}},p.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:(0,s.makeReplacer)(o.default.prototype.readSegment)}},p.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:(0,s.makeArrayPusher)(o.default.prototype.readFlatPosList),upperCorner:(0,s.makeArrayPusher)(o.default.prototype.readFlatPosList)}},p.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:(0,s.makeReplacer)(o.default.prototype.readPolygonPatch)}},p.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:(0,s.makeArrayExtender)(o.default.prototype.readLineStringSegment)}},p.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:(0,s.makeArrayPusher)(a.default.prototype.pointMemberParser),pointMembers:(0,s.makeArrayPusher)(a.default.prototype.pointMemberParser)}},p.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:(0,s.makeArrayPusher)(a.default.prototype.lineStringMemberParser),lineStringMembers:(0,s.makeArrayPusher)(a.default.prototype.lineStringMemberParser)}},p.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:(0,s.makeArrayPusher)(a.default.prototype.polygonMemberParser),polygonMembers:(0,s.makeArrayPusher)(a.default.prototype.polygonMemberParser)}},p.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:(0,s.makeArrayPusher)(a.default.prototype.readFlatCoordinatesFromNode)}},p.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:(0,s.makeArrayPusher)(a.default.prototype.readLineString)}},p.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:(0,s.makeArrayPusher)(a.default.prototype.readPolygon)}},p.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:(0,s.makeReplacer)(a.default.prototype.readFlatLinearRing),Ring:(0,s.makeReplacer)(p.prototype.readFlatCurveRing)}},p.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:(0,s.makeChildAppender)(o.default.prototype.writeRing),interior:(0,s.makeChildAppender)(o.default.prototype.writeRing)}},p.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:(0,s.makeChildAppender)(e.writeStringTextNode),upperCorner:(0,s.makeChildAppender)(e.writeStringTextNode)}},p.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:(0,s.makeChildAppender)(o.default.prototype.writeSurfaceOrPolygonMember),polygonMember:(0,s.makeChildAppender)(o.default.prototype.writeSurfaceOrPolygonMember)}},p.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:(0,s.makeChildAppender)(o.default.prototype.writePointMember)}},p.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:(0,s.makeChildAppender)(o.default.prototype.writeLineStringOrCurveMember),curveMember:(0,s.makeChildAppender)(o.default.prototype.writeLineStringOrCurveMember)}},p.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:(0,s.makeChildAppender)(o.default.prototype.writeCurveOrLineString),MultiCurve:(0,s.makeChildAppender)(o.default.prototype.writeMultiCurveOrLineString),Point:(0,s.makeChildAppender)(p.prototype.writePoint),MultiPoint:(0,s.makeChildAppender)(o.default.prototype.writeMultiPoint),LineString:(0,s.makeChildAppender)(o.default.prototype.writeCurveOrLineString),MultiLineString:(0,s.makeChildAppender)(o.default.prototype.writeMultiCurveOrLineString),LinearRing:(0,s.makeChildAppender)(o.default.prototype.writeLinearRing),Polygon:(0,s.makeChildAppender)(o.default.prototype.writeSurfaceOrPolygon),MultiPolygon:(0,s.makeChildAppender)(o.default.prototype.writeMultiSurfaceOrPolygon),Surface:(0,s.makeChildAppender)(o.default.prototype.writeSurfaceOrPolygon),MultiSurface:(0,s.makeChildAppender)(o.default.prototype.writeMultiSurfaceOrPolygon),Envelope:(0,s.makeChildAppender)(o.default.prototype.writeEnvelope)}},r.default=p},{"../format/xsd.js":188,"../xml.js":391,"./GML2.js":138,"./GML3.js":139,"./GMLBase.js":141}],141:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.GMLNS=void 0;var f=g(e("../Feature.js")),o=g(e("../geom/LineString.js")),a=g(e("../geom/LinearRing.js")),s=g(e("../geom/MultiLineString.js")),u=g(e("../geom/MultiPoint.js")),l=g(e("../geom/MultiPolygon.js")),c=g(e("../geom/Point.js")),h=g(e("../geom/Polygon.js")),n=g(e("./XMLFeature.js")),p=e("../array.js"),w=e("../xml.js"),d=e("../proj.js"),y=e("./Feature.js");function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=_(r),t=(e=n?(e=_(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e="http://www.opengis.net/gml",x=(r.GMLNS=e,/^\s*$/),n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e);var r,n=b(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).featureType=(e=e||{}).featureType,t.featureNS=e.featureNS,t.srsName=e.srsName,t.schemaLocation="",t.FEATURE_COLLECTION_PARSERS={},t.FEATURE_COLLECTION_PARSERS[t.namespace]={featureMember:(0,w.makeArrayPusher)(t.readFeaturesInternal),featureMembers:(0,w.makeReplacer)(t.readFeaturesInternal)},t.supportedMediaTypes=["application/gml+xml"],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFeaturesInternal",value:function(e,t){var r=e.localName,n=null;if("FeatureCollection"==r)n=(0,w.pushParseAndPop)([],this.FEATURE_COLLECTION_PARSERS,e,t,this);else if("featureMembers"==r||"featureMember"==r||"member"==r){var i=t[0],o=i.featureType,a=i.featureNS;if(!o&&e.childNodes){for(var o=[],a={},s=0,u=e.childNodes.length;s<u;++s){var l=e.childNodes[s];if(1===l.nodeType){var c=l.nodeName.split(":").pop();if(!o.includes(c)){var f,h="",p=0,d=l.namespaceURI;for(f in a){if(a[f]===d){h=f;break}++p}h||(a[h="p"+p]=d),o.push(h+":"+c)}}}"featureMember"!=r&&(i.featureType=o,i.featureNS=a)}"string"==typeof a&&(i=a,(a={}).p0=i);var y,g={},m=Array.isArray(o)?o:[o];for(y in a){for(var v={},b=0,_=m.length;b<_;++b)(m[b].includes(":")?m[b].split(":")[0]:"p0")===y&&(v[m[b].split(":").pop()]=("featureMembers"==r?(0,w.makeArrayPusher):(0,w.makeReplacer))(this.readFeatureElement,this));g[a[y]]=v}n="featureMember"==r||"member"==r?(0,w.pushParseAndPop)(void 0,g,e,t):(0,w.pushParseAndPop)([],g,e,t)}return n=null===n?[]:n}},{key:"readGeometryOrExtent",value:function(e,t){var r=t[0];return r.srsName=e.firstElementChild.getAttribute("srsName"),r.srsDimension=e.firstElementChild.getAttribute("srsDimension"),(0,w.pushParseAndPop)(null,this.GEOMETRY_PARSERS,e,t,this)}},{key:"readExtentElement",value:function(e,t){var r=t[0],e=this.readGeometryOrExtent(e,t);return e?(0,y.transformExtentWithOptions)(e,r):void 0}},{key:"readGeometryElement",value:function(e,t){var r=t[0],e=this.readGeometryOrExtent(e,t);return e?(0,y.transformGeometryWithOptions)(e,!1,r):void 0}},{key:"readFeatureElementInternal",value:function(e,t,r){for(var n,i,o={},a=e.firstElementChild;a;a=a.nextElementSibling){var s=void 0,u=a.localName,l=(0===a.childNodes.length||1===a.childNodes.length&&(3===a.firstChild.nodeType||4===a.firstChild.nodeType)?(s=(0,w.getAllTextContent)(a,!1),x.test(s)&&(s=void 0)):(s=r?"boundedBy"===u?this.readExtentElement(a,t):this.readGeometryElement(a,t):s)?"boundedBy"!==u&&(n=u):s=this.readFeatureElementInternal(a,t,!1),a.attributes.length);if(0<l)for(var s={_content_:s},c=0;c<l;c++)s[a.attributes[c].name]=a.attributes[c].value;o[u]?(o[u]instanceof Array||(o[u]=[o[u]]),o[u].push(s)):o[u]=s}return r?(i=new f.default(o),n&&i.setGeometryName(n),(e=e.getAttribute("fid")||(0,w.getAttributeNS)(e,this.namespace,"id"))&&i.setId(e),i):o}},{key:"readFeatureElement",value:function(e,t){return this.readFeatureElementInternal(e,t,!0)}},{key:"readPoint",value:function(e,t){e=this.readFlatCoordinatesFromNode(e,t);if(e)return new c.default(e,"XYZ")}},{key:"readMultiPoint",value:function(e,t){e=(0,w.pushParseAndPop)([],this.MULTIPOINT_PARSERS,e,t,this);if(e)return new u.default(e)}},{key:"readMultiLineString",value:function(e,t){e=(0,w.pushParseAndPop)([],this.MULTILINESTRING_PARSERS,e,t,this);if(e)return new s.default(e)}},{key:"readMultiPolygon",value:function(e,t){e=(0,w.pushParseAndPop)([],this.MULTIPOLYGON_PARSERS,e,t,this);if(e)return new l.default(e)}},{key:"pointMemberParser",value:function(e,t){(0,w.parseNode)(this.POINTMEMBER_PARSERS,e,t,this)}},{key:"lineStringMemberParser",value:function(e,t){(0,w.parseNode)(this.LINESTRINGMEMBER_PARSERS,e,t,this)}},{key:"polygonMemberParser",value:function(e,t){(0,w.parseNode)(this.POLYGONMEMBER_PARSERS,e,t,this)}},{key:"readLineString",value:function(e,t){e=this.readFlatCoordinatesFromNode(e,t);if(e)return new o.default(e,"XYZ")}},{key:"readFlatLinearRing",value:function(e,t){e=(0,w.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this);if(e)return e}},{key:"readLinearRing",value:function(e,t){e=this.readFlatCoordinatesFromNode(e,t);if(e)return new a.default(e,"XYZ")}},{key:"readPolygon",value:function(e,t){var r=(0,w.pushParseAndPop)([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this);if(r&&r[0]){for(var n=r[0],i=[n.length],o=1,a=r.length;o<a;++o)(0,p.extend)(n,r[o]),i.push(n.length);return new h.default(n,"XYZ",i)}}},{key:"readFlatCoordinatesFromNode",value:function(e,t){return(0,w.pushParseAndPop)(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}},{key:"readGeometryFromNode",value:function(e,t){e=this.readGeometryElement(e,[this.getReadOptions(e,t||{})]);return e||null}},{key:"readFeaturesFromNode",value:function(e,t){var r={featureType:this.featureType,featureNS:this.featureNS};return Object.assign(r,this.getReadOptions(e,t)),this.readFeaturesInternal(e,[r])||[]}},{key:"readProjectionFromNode",value:function(e){return(0,d.get)(this.srsName||e.firstElementChild.getAttribute("srsName"))}}])&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);n.prototype.namespace=e,n.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},n.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},n.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},n.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:(0,w.makeArrayPusher)(n.prototype.pointMemberParser),pointMembers:(0,w.makeArrayPusher)(n.prototype.pointMemberParser)}},n.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:(0,w.makeArrayPusher)(n.prototype.lineStringMemberParser),lineStringMembers:(0,w.makeArrayPusher)(n.prototype.lineStringMemberParser)}},n.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:(0,w.makeArrayPusher)(n.prototype.polygonMemberParser),polygonMembers:(0,w.makeArrayPusher)(n.prototype.polygonMemberParser)}},n.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:(0,w.makeArrayPusher)(n.prototype.readFlatCoordinatesFromNode)}},n.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:(0,w.makeArrayPusher)(n.prototype.readLineString)}},n.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:(0,w.makeArrayPusher)(n.prototype.readPolygon)}},n.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:(0,w.makeReplacer)(n.prototype.readFlatLinearRing)}},r.default=n},{"../Feature.js":75,"../array.js":104,"../geom/LineString.js":194,"../geom/LinearRing.js":195,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../proj.js":271,"../xml.js":391,"./Feature.js":136,"./XMLFeature.js":160}],142:[function(e,D,t){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=h(e("../Feature.js")),a=h(e("../geom/LineString.js")),s=h(e("../geom/MultiLineString.js")),u=h(e("../geom/Point.js")),r=h(e("./XMLFeature.js")),l=e("../xml.js"),c=e("../proj.js"),n=e("./xsd.js"),f=e("./Feature.js");function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],v={rte:R,trk:M,wpt:I},b=(0,l.makeStructureNS)(m,{rte:(0,l.makeArrayPusher)(R),trk:(0,l.makeArrayPusher)(M),wpt:(0,l.makeArrayPusher)(I)}),_=(0,l.makeStructureNS)(m,{text:(0,l.makeObjectPropertySetter)(n.readString,"linkText"),type:(0,l.makeObjectPropertySetter)(n.readString,"linkType")}),w=(0,l.makeStructureNS)(m,{rte:(0,l.makeChildAppender)(function(e,t,r){var n=r[0],i=t.getProperties(),e={node:e},t=(e.properties=i,t.getGeometry());"LineString"==t.getType()&&(t=(0,f.transformGeometryWithOptions)(t,!0,n),e.geometryLayout=t.getLayout(),i.rtept=t.getCoordinates());n=r[r.length-1].node,t=G[n.namespaceURI],n=(0,l.makeSequence)(i,t);(0,l.pushSerializeAndPop)(e,U,l.OBJECT_PROPERTY_NODE_FACTORY,n,r,t)}),trk:(0,l.makeChildAppender)(function(e,t,r){var n=r[0],i=t.getProperties(),e={node:e},t=(e.properties=i,t.getGeometry());"MultiLineString"==t.getType()&&(t=(0,f.transformGeometryWithOptions)(t,!0,n),i.trkseg=t.getLineStrings());n=r[r.length-1].node,t=W[n.namespaceURI],n=(0,l.makeSequence)(i,t);(0,l.pushSerializeAndPop)(e,V,l.OBJECT_PROPERTY_NODE_FACTORY,n,r,t)}),wpt:(0,l.makeChildAppender)(function(e,t,r){var n=r[0],i=r[r.length-1],t=(i.properties=t.getProperties(),t.getGeometry());"Point"==t.getType()&&(t=(0,f.transformGeometryWithOptions)(t,!0,n),i.geometryLayout=t.getLayout(),L(e,t.getCoordinates(),r))})}),e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=y(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).dataProjection=(0,c.get)("EPSG:4326"),t.readExtensions_=e.readExtensions,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleReadExtensions_",value:function(e){for(var t=0,r=(e=e||[]).length;t<r;++t){var n,i=e[t];this.readExtensions_&&(n=i.get("extensionsNode_")||null,this.readExtensions_(i,n)),i.set("extensionsNode_",void 0)}}},{key:"readFeatureFromNode",value:function(e,t){var r;return m.includes(e.namespaceURI)&&(r=v[e.localName])&&(r=r(e,[this.getReadOptions(e,t)]))?(this.handleReadExtensions_([r]),r):null}},{key:"readFeaturesFromNode",value:function(e,t){return m.includes(e.namespaceURI)&&"gpx"==e.localName&&(e=(0,l.pushParseAndPop)([],b,e,[this.getReadOptions(e,t)]))?(this.handleReadExtensions_(e),e):[]}},{key:"writeFeaturesNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,l.createElementNS)("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",l.XML_SCHEMA_INSTANCE_URI),r.setAttributeNS(l.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),(0,l.pushSerializeAndPop)({node:r},w,K,e,[t]),r}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(r.default),x=(0,l.makeStructureNS)(m,{name:(0,l.makeObjectPropertySetter)(n.readString),cmt:(0,l.makeObjectPropertySetter)(n.readString),desc:(0,l.makeObjectPropertySetter)(n.readString),src:(0,l.makeObjectPropertySetter)(n.readString),link:T,number:(0,l.makeObjectPropertySetter)(n.readPositiveInteger),extensions:C,type:(0,l.makeObjectPropertySetter)(n.readString),rtept:function(e,t){var r=(0,l.pushParseAndPop)({},S,e,t);{var n;r&&(t=t[t.length-1],n=t.flatCoordinates,t=t.layoutOptions,k(n,t,e,r))}}}),S=(0,l.makeStructureNS)(m,{ele:(0,l.makeObjectPropertySetter)(n.readDecimal),time:(0,l.makeObjectPropertySetter)(n.readDateTime)}),j=(0,l.makeStructureNS)(m,{name:(0,l.makeObjectPropertySetter)(n.readString),cmt:(0,l.makeObjectPropertySetter)(n.readString),desc:(0,l.makeObjectPropertySetter)(n.readString),src:(0,l.makeObjectPropertySetter)(n.readString),link:T,number:(0,l.makeObjectPropertySetter)(n.readPositiveInteger),type:(0,l.makeObjectPropertySetter)(n.readString),extensions:C,trkseg:function(e,t){var r=t[t.length-1],e=((0,l.parseNode)(O,e,t),r.flatCoordinates);r.ends.push(e.length)}}),O=(0,l.makeStructureNS)(m,{trkpt:function(e,t){var r=(0,l.pushParseAndPop)({},P,e,t);{var n;r&&(t=t[t.length-1],n=t.flatCoordinates,t=t.layoutOptions,k(n,t,e,r))}}}),P=(0,l.makeStructureNS)(m,{ele:(0,l.makeObjectPropertySetter)(n.readDecimal),time:(0,l.makeObjectPropertySetter)(n.readDateTime)}),F=(0,l.makeStructureNS)(m,{ele:(0,l.makeObjectPropertySetter)(n.readDecimal),time:(0,l.makeObjectPropertySetter)(n.readDateTime),magvar:(0,l.makeObjectPropertySetter)(n.readDecimal),geoidheight:(0,l.makeObjectPropertySetter)(n.readDecimal),name:(0,l.makeObjectPropertySetter)(n.readString),cmt:(0,l.makeObjectPropertySetter)(n.readString),desc:(0,l.makeObjectPropertySetter)(n.readString),src:(0,l.makeObjectPropertySetter)(n.readString),link:T,sym:(0,l.makeObjectPropertySetter)(n.readString),type:(0,l.makeObjectPropertySetter)(n.readString),fix:(0,l.makeObjectPropertySetter)(n.readString),sat:(0,l.makeObjectPropertySetter)(n.readPositiveInteger),hdop:(0,l.makeObjectPropertySetter)(n.readDecimal),vdop:(0,l.makeObjectPropertySetter)(n.readDecimal),pdop:(0,l.makeObjectPropertySetter)(n.readDecimal),ageofdgpsdata:(0,l.makeObjectPropertySetter)(n.readDecimal),dgpsid:(0,l.makeObjectPropertySetter)(n.readPositiveInteger),extensions:C}),N=["text","type"],B=(0,l.makeStructureNS)(m,{text:(0,l.makeChildAppender)(n.writeStringTextNode),type:(0,l.makeChildAppender)(n.writeStringTextNode)}),G=(0,l.makeStructureNS)(m,["name","cmt","desc","src","link","number","type","rtept"]),U=(0,l.makeStructureNS)(m,{name:(0,l.makeChildAppender)(n.writeStringTextNode),cmt:(0,l.makeChildAppender)(n.writeStringTextNode),desc:(0,l.makeChildAppender)(n.writeStringTextNode),src:(0,l.makeChildAppender)(n.writeStringTextNode),link:(0,l.makeChildAppender)(A),number:(0,l.makeChildAppender)(n.writeNonNegativeIntegerTextNode),type:(0,l.makeChildAppender)(n.writeStringTextNode),rtept:(0,l.makeArraySerializer)((0,l.makeChildAppender)(L))}),z=(0,l.makeStructureNS)(m,["ele","time"]),W=(0,l.makeStructureNS)(m,["name","cmt","desc","src","link","number","type","trkseg"]),V=(0,l.makeStructureNS)(m,{name:(0,l.makeChildAppender)(n.writeStringTextNode),cmt:(0,l.makeChildAppender)(n.writeStringTextNode),desc:(0,l.makeChildAppender)(n.writeStringTextNode),src:(0,l.makeChildAppender)(n.writeStringTextNode),link:(0,l.makeChildAppender)(A),number:(0,l.makeChildAppender)(n.writeNonNegativeIntegerTextNode),type:(0,l.makeChildAppender)(n.writeStringTextNode),trkseg:(0,l.makeArraySerializer)((0,l.makeChildAppender)(function(e,t,r){e={node:e};e.geometryLayout=t.getLayout(),e.properties={},(0,l.pushSerializeAndPop)(e,q,H,t.getCoordinates(),r)}))}),H=(0,l.makeSimpleNodeFactory)("trkpt"),q=(0,l.makeStructureNS)(m,{trkpt:(0,l.makeChildAppender)(L)}),Y=(0,l.makeStructureNS)(m,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),X=(0,l.makeStructureNS)(m,{ele:(0,l.makeChildAppender)(n.writeDecimalTextNode),time:(0,l.makeChildAppender)(n.writeDateTimeTextNode),magvar:(0,l.makeChildAppender)(n.writeDecimalTextNode),geoidheight:(0,l.makeChildAppender)(n.writeDecimalTextNode),name:(0,l.makeChildAppender)(n.writeStringTextNode),cmt:(0,l.makeChildAppender)(n.writeStringTextNode),desc:(0,l.makeChildAppender)(n.writeStringTextNode),src:(0,l.makeChildAppender)(n.writeStringTextNode),link:(0,l.makeChildAppender)(A),sym:(0,l.makeChildAppender)(n.writeStringTextNode),type:(0,l.makeChildAppender)(n.writeStringTextNode),fix:(0,l.makeChildAppender)(n.writeStringTextNode),sat:(0,l.makeChildAppender)(n.writeNonNegativeIntegerTextNode),hdop:(0,l.makeChildAppender)(n.writeDecimalTextNode),vdop:(0,l.makeChildAppender)(n.writeDecimalTextNode),pdop:(0,l.makeChildAppender)(n.writeDecimalTextNode),ageofdgpsdata:(0,l.makeChildAppender)(n.writeDecimalTextNode),dgpsid:(0,l.makeChildAppender)(n.writeNonNegativeIntegerTextNode)}),Z={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function K(e,t,r){e=e.getGeometry();if(e){e=Z[e.getType()];if(e)return t=t[t.length-1].node,(0,l.createElementNS)(t.namespaceURI,e)}}function k(e,t,r,n){return e.push(parseFloat(r.getAttribute("lon")),parseFloat(r.getAttribute("lat"))),"ele"in n?(e.push(n.ele),delete n.ele,t.hasZ=!0):e.push(0),"time"in n?(e.push(n.time),delete n.time,t.hasM=!0):e.push(0),e}function E(e,t,r){var n="XY",i=2;if(e.hasZ&&e.hasM?(n="XYZM",i=4):e.hasZ?(n="XYZ",i=3):e.hasM&&(n="XYM",i=3),4!==i){for(var o=0,a=t.length/4;o<a;o++)t[o*i]=t[4*o],t[o*i+1]=t[4*o+1],e.hasZ&&(t[o*i+2]=t[4*o+2]),e.hasM&&(t[o*i+2]=t[4*o+3]);if(t.length=t.length/4*i,r)for(var s=0,u=r.length;s<u;s++)r[s]=r[s]/4*i}return n}function T(e,t){var r=t[t.length-1],n=e.getAttribute("href");null!==n&&(r.link=n),(0,l.parseNode)(_,e,t)}function C(e,t){t[t.length-1].extensionsNode_=e}function R(e,t){var r,n=t[0],e=(0,l.pushParseAndPop)({flatCoordinates:[],layoutOptions:{}},x,e,t);if(e)return t=e.flatCoordinates,delete e.flatCoordinates,r=e.layoutOptions,delete e.layoutOptions,r=E(r,t),t=new a.default(t,r),(0,f.transformGeometryWithOptions)(t,!1,n),(r=new o.default(t)).setProperties(e,!0),r}function M(e,t){var r,n,i=t[0],e=(0,l.pushParseAndPop)({flatCoordinates:[],ends:[],layoutOptions:{}},j,e,t);if(e)return t=e.flatCoordinates,delete e.flatCoordinates,r=e.ends,delete e.ends,n=e.layoutOptions,delete e.layoutOptions,n=E(n,t,r),t=new s.default(t,n,r),(0,f.transformGeometryWithOptions)(t,!1,i),(n=new o.default(t)).setProperties(e,!0),n}function I(e,t){var r,n=t[0],t=(0,l.pushParseAndPop)({},F,e,t);if(t)return e=E(r={},r=k([],r,e,t)),r=new u.default(r,e),(0,f.transformGeometryWithOptions)(r,!1,n),(e=new o.default(r)).setProperties(t,!0),e}function A(e,t,r){e.setAttribute("href",t);t=r[r.length-1].properties,t=[t.linkText,t.linkType];(0,l.pushSerializeAndPop)({node:e},B,l.OBJECT_PROPERTY_NODE_FACTORY,t,r,N)}function L(e,t,r){var n=r[r.length-1],i=n.node.namespaceURI,o=n.properties;switch(e.setAttributeNS(null,"lat",String(t[1])),e.setAttributeNS(null,"lon",String(t[0])),n.geometryLayout){case"XYZM":0!==t[3]&&(o.time=t[3]);case"XYZ":0!==t[2]&&(o.ele=t[2]);break;case"XYM":0!==t[2]&&(o.time=t[2])}n=("rtept"==e.nodeName?z:Y)[i],i=(0,l.makeSequence)(o,n);(0,l.pushSerializeAndPop)({node:e,properties:o},X,l.OBJECT_PROPERTY_NODE_FACTORY,i,r,n)}t.default=e},{"../Feature.js":75,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/Point.js":199,"../proj.js":271,"../xml.js":391,"./Feature.js":136,"./XMLFeature.js":160,"./xsd.js":188}],143:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=m(e("../Feature.js")),n=m(e("../geom/GeometryCollection.js")),a=m(e("./JSONFeature.js")),s=m(e("../geom/LineString.js")),u=m(e("../geom/MultiLineString.js")),l=m(e("../geom/MultiPoint.js")),c=m(e("../geom/MultiPolygon.js")),f=m(e("../geom/Point.js")),h=m(e("../geom/Polygon.js")),p=e("../asserts.js"),d=e("../proj.js"),y=e("../obj.js"),g=e("./Feature.js");function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=w(r),t=(e=n?(e=w(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e);var r,n=_(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).dataProjection=(0,d.get)(e.dataProjection||"EPSG:4326"),e.featureProjection&&(t.defaultFeatureProjection=(0,d.get)(e.featureProjection)),t.geometryName_=e.geometryName,t.extractGeometryName_=e.extractGeometryName,t.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFeatureFromObject",value:function(e,t){var r=null,e=x((r="Feature"===e.type?e:{type:"Feature",geometry:e,properties:null}).geometry,t),t=new o.default;return this.geometryName_?t.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in r!==void 0&&t.setGeometryName(r.geometry_name),t.setGeometry(e),"id"in r&&t.setId(r.id),r.properties&&t.setProperties(r.properties,!0),t}},{key:"readFeaturesFromObject",value:function(e,t){var r=null;if("FeatureCollection"===e.type)for(var r=[],n=e.features,i=0,o=n.length;i<o;++i)r.push(this.readFeatureFromObject(n[i],t));else r=[this.readFeatureFromObject(e,t)];return r}},{key:"readGeometryFromObject",value:x},{key:"readProjectionFromObject",value:function(e){var t,e=e.crs;return e?"name"==e.type?t=(0,d.get)(e.properties.name):"EPSG"===e.type?t=(0,d.get)("EPSG:"+e.properties.code):(0,p.assert)(!1,36):t=this.dataProjection,t}},{key:"writeFeatureObject",value:function(e,t){t=this.adaptOptions(t);var r,n={type:"Feature",geometry:null,properties:null},i=e.getId();return void 0!==i&&(n.id=i),e.hasProperties()&&(i=e.getProperties(),(r=e.getGeometry())&&(n.geometry=S(r,t),delete i[e.getGeometryName()]),(0,y.isEmpty)(i)||(n.properties=i)),n}},{key:"writeFeaturesObject",value:function(e,t){t=this.adaptOptions(t);for(var r=[],n=0,i=e.length;n<i;++n)r.push(this.writeFeatureObject(e[n],t));return{type:"FeatureCollection",features:r}}},{key:"writeGeometryObject",value:function(e,t){return S(e,this.adaptOptions(t))}}])&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.default);function x(e,t){if(!e)return null;var r;switch(e.type){case"Point":r=new f.default(e.coordinates);break;case"LineString":r=new s.default(e.coordinates);break;case"Polygon":r=new h.default(e.coordinates);break;case"MultiPoint":r=new l.default(e.coordinates);break;case"MultiLineString":r=new u.default(e.coordinates);break;case"MultiPolygon":r=new c.default(e.coordinates);break;case"GeometryCollection":r=function(e,t){e=e.geometries.map(function(e){return x(e,t)});return new n.default(e)}(e);break;default:throw new Error("Unsupported GeoJSON type: "+e.type)}return(0,g.transformGeometryWithOptions)(r,!1,t)}function S(e,t){var r,n,i,o=(e=(0,g.transformGeometryWithOptions)(e,!0,t)).getType();switch(o){case"Point":r={type:"Point",coordinates:e.getCoordinates()};break;case"LineString":r={type:"LineString",coordinates:e.getCoordinates()};break;case"Polygon":r=function(e,t){var r;t&&(r=t.rightHanded);return{type:"Polygon",coordinates:e.getCoordinates(r)}}(e,t);break;case"MultiPoint":r={type:"MultiPoint",coordinates:e.getCoordinates()};break;case"MultiLineString":r={type:"MultiLineString",coordinates:e.getCoordinates()};break;case"MultiPolygon":r=function(e,t){var r;t&&(r=t.rightHanded);return{type:"MultiPolygon",coordinates:e.getCoordinates(r)}}(e,t);break;case"GeometryCollection":n=e,i=t,delete(i=Object.assign({},i)).featureProjection,r={type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(e){return S(e,i)})};break;case"Circle":r={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+o)}return r}r.default=e},{"../Feature.js":75,"../asserts.js":105,"../geom/GeometryCollection.js":193,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../obj.js":269,"../proj.js":271,"./Feature.js":136,"./JSONFeature.js":146}],144:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var b=a(e("../Feature.js")),_=a(e("../geom/LineString.js")),n=a(e("./TextFeature.js")),o=e("../proj.js"),w=e("./Feature.js");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,S=/^H.([A-Z]{3}).*?:(.*)/,j=/^HFDTE(\d{2})(\d{2})(\d{2})/,O=/\r\n|\r|\n/,e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).dataProjection=(0,o.get)("EPSG:4326"),t.altitudeMode_=e.altitudeMode||"none",t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFeatureFromText",value:function(e,t){for(var r=this.altitudeMode_,n=e.split(O),i={},o=[],a=2e3,s=0,u=1,l=-1,c=0,f=n.length;c<f;++c){var h,p,d,y,g,m=n[c],v=void 0;"B"==m.charAt(0)?(v=x.exec(m))&&(h=parseInt(v[1],10),p=parseInt(v[2],10),d=parseInt(v[3],10),g=parseInt(v[4],10)+parseInt(v[5],10)/6e4,"S"==v[6]&&(g=-g),y=parseInt(v[7],10)+parseInt(v[8],10)/6e4,"W"==v[9]&&(y=-y),o.push(y,g),"none"!=r&&(y=void 0,y="gps"==r?parseInt(v[11],10):"barometric"==r?parseInt(v[12],10):0,o.push(y)),(g=Date.UTC(a,s,u,h,p,d))<l&&(g=Date.UTC(a,s,u+1,h,p,d)),o.push(g/1e3),l=g):"H"==m.charAt(0)&&((v=j.exec(m))?(u=parseInt(v[1],10),s=parseInt(v[2],10)-1,a=2e3+parseInt(v[3],10)):(v=S.exec(m))&&(i[v[1]]=v[2].trim()))}return 0===o.length?null:(e=new _.default(o,"none"==r?"XYM":"XYZM"),(e=new b.default((0,w.transformGeometryWithOptions)(e,!1,t))).setProperties(i,!0),e)}},{key:"readFeaturesFromText",value:function(e,t){e=this.readFeatureFromText(e,t);return e?[e]:[]}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Feature.js":75,"../geom/LineString.js":194,"../proj.js":271,"./Feature.js":136,"./TextFeature.js":151}],145:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Versions=void 0;var o=e("../asserts.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"},l=(r.Versions=u,{}),c=(l[u.VERSION1]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},l[u.VERSION2]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},l[u.VERSION3]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},l.none={none:{supports:[],formats:[],qualities:[]}},/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/),f=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,h=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/;var p={},e=(p[u.VERSION1]=function(e){var t=e.getComplianceLevelSupportedFeatures();return void 0===t&&(t=l[u.VERSION1].level0),{url:void 0===e.imageInfo["@id"]?void 0:e.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:t.supports,formats:[].concat(s(t.formats),[void 0===e.imageInfo.formats?[]:e.imageInfo.formats]),qualities:[].concat(s(t.qualities),[void 0===e.imageInfo.qualities?[]:e.imageInfo.qualities]),resolutions:e.imageInfo.scale_factors,tileSize:void 0!==e.imageInfo.tile_width?void 0!==e.imageInfo.tile_height?[e.imageInfo.tile_width,e.imageInfo.tile_height]:[e.imageInfo.tile_width,e.imageInfo.tile_width]:null!=e.imageInfo.tile_height?[e.imageInfo.tile_height,e.imageInfo.tile_height]:void 0}},p[u.VERSION2]=function(e){var t=e.getComplianceLevelSupportedFeatures(),r=(i=Array.isArray(e.imageInfo.profile)&&1<e.imageInfo.profile.length)&&e.imageInfo.profile[1].supports?e.imageInfo.profile[1].supports:[],n=i&&e.imageInfo.profile[1].formats?e.imageInfo.profile[1].formats:[],i=i&&e.imageInfo.profile[1].qualities?e.imageInfo.profile[1].qualities:[];return{url:e.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:void 0===e.imageInfo.sizes?void 0:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===e.imageInfo.tiles?void 0:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return void 0===e.height?e.width:e.height})[0]],resolutions:void 0===e.imageInfo.tiles?void 0:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:[].concat(s(t.supports),s(r)),formats:[].concat(s(t.formats),s(n)),qualities:[].concat(s(t.qualities),s(i))}},p[u.VERSION3]=function(e){var t=e.getComplianceLevelSupportedFeatures(),r=void 0===e.imageInfo.extraFormats?t.formats:[].concat(s(t.formats),s(e.imageInfo.extraFormats)),n=void 0!==e.imageInfo.preferredFormats&&Array.isArray(e.imageInfo.preferredFormats)&&0<e.imageInfo.preferredFormats.length?e.imageInfo.preferredFormats.filter(function(e){return["jpg","png","gif"].includes(e)}).reduce(function(e,t){return void 0===e&&r.includes(t)?t:e},void 0):void 0;return{url:e.imageInfo.id,sizes:void 0===e.imageInfo.sizes?void 0:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===e.imageInfo.tiles?void 0:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return e.height})[0]],resolutions:void 0===e.imageInfo.tiles?void 0:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:void 0===e.imageInfo.extraFeatures?t.supports:[].concat(s(t.supports),s(e.imageInfo.extraFeatures)),formats:r,qualities:void 0===e.imageInfo.extraQualities?t.qualities:[].concat(s(t.qualities),s(e.imageInfo.extraQualities)),preferredFormat:n}},function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.setImageInfo(e)}var e,r,n;return e=t,(r=[{key:"setImageInfo",value:function(e){this.imageInfo="string"==typeof e?JSON.parse(e):e}},{key:"getImageApiVersion",value:function(){if(void 0!==this.imageInfo){var e=this.imageInfo["@context"]||"ol-no-context";"string"==typeof e&&(e=[e]);for(var t=0;t<e.length;t++)switch(e[t]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return u.VERSION1;case"http://iiif.io/api/image/2/context.json":return u.VERSION2;case"http://iiif.io/api/image/3/context.json":return u.VERSION3;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(u.VERSION1)&&this.imageInfo.identifier)return u.VERSION1}(0,o.assert)(!1,61)}}},{key:"getComplianceLevelEntryFromProfile",value:function(e){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(e=void 0===e?this.getImageApiVersion():e){case u.VERSION1:if(c.test(this.imageInfo.profile))return this.imageInfo.profile;break;case u.VERSION3:if(h.test(this.imageInfo.profile))return this.imageInfo.profile;break;case u.VERSION2:if("string"==typeof this.imageInfo.profile&&f.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&0<this.imageInfo.profile.length&&"string"==typeof this.imageInfo.profile[0]&&f.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}}},{key:"getComplianceLevelFromProfile",value:function(e){var e=this.getComplianceLevelEntryFromProfile(e);if(void 0!==e)return e=e.match(/level[0-2](?:\.json)?$/g),Array.isArray(e)?e[0].replace(".json",""):void 0}},{key:"getComplianceLevelSupportedFeatures",value:function(){var e,t;if(void 0!==this.imageInfo)return e=this.getImageApiVersion(),void 0===(t=this.getComplianceLevelFromProfile(e))?l.none.none:l[e][t]}},{key:"getTileSourceOptions",value:function(e){var e=e||{},t=this.getImageApiVersion();if(void 0!==t){var r=void 0===t?void 0:p[t](this);if(void 0!==r)return{url:r.url,version:t,size:[this.imageInfo.width,this.imageInfo.height],sizes:r.sizes,format:void 0!==e.format&&r.formats.includes(e.format)?e.format:void 0!==r.preferredFormat?r.preferredFormat:"jpg",supports:r.supports,quality:e.quality&&r.qualities.includes(e.quality)?e.quality:r.qualities.includes("native")?"native":"default",resolutions:Array.isArray(r.resolutions)?r.resolutions.sort(function(e,t){return t-e}):void 0,tileSize:r.tileSize}}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());r.default=e},{"../asserts.js":105}],146:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Feature.js"))&&n.__esModule?n:{default:n},o=e("../util.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(i);function i(){if(this instanceof i)return n.call(this);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getType",value:function(){return"json"}},{key:"readFeature",value:function(e,t){return this.readFeatureFromObject(c(e),this.getReadOptions(e,t))}},{key:"readFeatures",value:function(e,t){return this.readFeaturesFromObject(c(e),this.getReadOptions(e,t))}},{key:"readFeatureFromObject",value:function(e,t){return(0,o.abstract)()}},{key:"readFeaturesFromObject",value:function(e,t){return(0,o.abstract)()}},{key:"readGeometry",value:function(e,t){return this.readGeometryFromObject(c(e),this.getReadOptions(e,t))}},{key:"readGeometryFromObject",value:function(e,t){return(0,o.abstract)()}},{key:"readProjection",value:function(e){return this.readProjectionFromObject(c(e))}},{key:"readProjectionFromObject",value:function(e){return(0,o.abstract)()}},{key:"writeFeature",value:function(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}},{key:"writeFeatureObject",value:function(e,t){return(0,o.abstract)()}},{key:"writeFeatures",value:function(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}},{key:"writeFeaturesObject",value:function(e,t){return(0,o.abstract)()}},{key:"writeGeometry",value:function(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}},{key:"writeGeometryObject",value:function(e,t){return(0,o.abstract)()}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function c(e){return"string"==typeof e?JSON.parse(e)||null:null!==e?e:null}r.default=e},{"../util.js":379,"./Feature.js":136}],147:[function(e,D,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.getDefaultFillStyle=function(){return S},t.getDefaultImageStyle=function(){return O},t.getDefaultStrokeStyle=function(){return k},t.getDefaultStyle=function(){return ue},t.getDefaultStyleArray=function(){return T},t.getDefaultTextStyle=function(){return E},t.readFlatCoordinates=fe;var F=r(e("../Feature.js")),o=r(e("../style/Fill.js")),h=r(e("../geom/GeometryCollection.js")),N=r(e("../style/Icon.js")),g=r(e("../ImageState.js")),B=r(e("../geom/LineString.js")),G=r(e("../geom/MultiLineString.js")),U=r(e("../geom/MultiPoint.js")),z=r(e("../geom/MultiPolygon.js")),W=r(e("../geom/Point.js")),V=r(e("../geom/Polygon.js")),a=r(e("../style/Stroke.js")),f=r(e("../style/Style.js")),H=r(e("../style/Text.js")),q=r(e("./XMLFeature.js")),m=e("../xml.js"),Y=e("../color.js"),p=e("../asserts.js"),d=e("../array.js"),X=e("../proj.js"),y=e("./xsd.js"),Z=e("../math.js"),K=e("./Feature.js");function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function Q(e,t){return(Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ee(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u,v,b,_,w,x,l=["http://www.google.com/kml/ext/2.2"],c=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],te={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},re=(0,m.makeStructureNS)(c,{ExtendedData:Ue,Region:ze,MultiGeometry:(0,m.makeObjectPropertySetter)(Me,"geometry"),LineString:(0,m.makeObjectPropertySetter)(Te,"geometry"),LinearRing:(0,m.makeObjectPropertySetter)(Ce,"geometry"),Point:(0,m.makeObjectPropertySetter)(Ie,"geometry"),Polygon:(0,m.makeObjectPropertySetter)(Le,"geometry"),Style:(0,m.makeObjectPropertySetter)(Fe),StyleMap:function(e,t){e=ge.call(this,e,t);e&&(t=t[t.length-1],Array.isArray(e)?t.Style=e:"string"==typeof e?t.styleUrl=e:(0,p.assert)(!1,38))},address:(0,m.makeObjectPropertySetter)(y.readString),description:(0,m.makeObjectPropertySetter)(y.readString),name:(0,m.makeObjectPropertySetter)(y.readString),open:(0,m.makeObjectPropertySetter)(y.readBoolean),phoneNumber:(0,m.makeObjectPropertySetter)(y.readString),styleUrl:(0,m.makeObjectPropertySetter)(pe),visibility:(0,m.makeObjectPropertySetter)(y.readBoolean)},(0,m.makeStructureNS)(l,{MultiTrack:(0,m.makeObjectPropertySetter)(function(e,t){e=(0,m.pushParseAndPop)([],Se,e,t);if(e)return new G.default(e)},"geometry"),Track:(0,m.makeObjectPropertySetter)(Oe,"geometry")})),ne=(0,m.makeStructureNS)(c,{ExtendedData:Ue,Region:ze,Link:function(e,t){(0,m.parseNode)(ie,e,t)},address:(0,m.makeObjectPropertySetter)(y.readString),description:(0,m.makeObjectPropertySetter)(y.readString),name:(0,m.makeObjectPropertySetter)(y.readString),open:(0,m.makeObjectPropertySetter)(y.readBoolean),phoneNumber:(0,m.makeObjectPropertySetter)(y.readString),visibility:(0,m.makeObjectPropertySetter)(y.readBoolean)}),ie=(0,m.makeStructureNS)(c,{href:(0,m.makeObjectPropertySetter)(he)}),oe=(0,m.makeStructureNS)(c,{LatLonAltBox:function(e,t){var r,e=(0,m.pushParseAndPop)({},He,e,t);e&&(t=t[t.length-1],r=[parseFloat(e.west),parseFloat(e.south),parseFloat(e.east),parseFloat(e.north)],t.extent=r,t.altitudeMode=e.altitudeMode,t.minAltitude=parseFloat(e.minAltitude),t.maxAltitude=parseFloat(e.maxAltitude))},Lod:function(e,t){e=(0,m.pushParseAndPop)({},qe,e,t);e&&((t=t[t.length-1]).minLodPixels=parseFloat(e.minLodPixels),t.maxLodPixels=parseFloat(e.maxLodPixels),t.minFadeExtent=parseFloat(e.minFadeExtent),t.maxFadeExtent=parseFloat(e.maxFadeExtent))}}),ae=(0,m.makeStructureNS)(c,["Document","Placemark"]),se=(0,m.makeStructureNS)(c,{Document:(0,m.makeChildAppender)(function(e,t,r){e={node:e};(0,m.pushSerializeAndPop)(e,Ze,Ke,t,r,void 0,this)}),Placemark:(0,m.makeChildAppender)(_t)}),S=null;var j,O=null;var P,k=null;var E=null;var ue=null;var le,T=null;function C(e){return 32/Math.min(e[0],e[1])}function ce(e){return e}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e);var r,n=ee(i);function i(e){var t;if(this instanceof i)return t=n.call(this),e=e||{},T||(u=[255,255,255,1],S=new o.default({color:u}),v=[20,2],_=b="pixels",w=[64,64],x="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",O=new N.default({anchor:v,anchorOrigin:"bottom-left",anchorXUnits:b,anchorYUnits:_,crossOrigin:"anonymous",rotation:0,scale:C(w),size:w,src:x}),j="NO_IMAGE",k=new a.default({color:u,width:1}),P=new a.default({color:[51,51,51,1],width:2}),E=new H.default({font:"bold 16px Helvetica",fill:S,stroke:P,scale:.8}),ue=new f.default({fill:S,image:O,text:E,stroke:k,zIndex:0}),T=[ue]),t.dataProjection=(0,X.get)("EPSG:4326"),t.defaultStyle_=e.defaultStyle||T,t.extractStyles_=void 0===e.extractStyles||e.extractStyles,t.writeStyles_=void 0===e.writeStyles||e.writeStyles,t.sharedStyles_={},t.showPointNames_=void 0===e.showPointNames||e.showPointNames,t.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",t.iconUrlFunction_=e.iconUrlFunction||ce,t.supportedMediaTypes=["application/vnd.google-earth.kml+xml"],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readDocumentOrFolder_",value:function(e,t){var r=(0,m.makeStructureNS)(c,{Document:(0,m.makeArrayExtender)(this.readDocumentOrFolder_,this),Folder:(0,m.makeArrayExtender)(this.readDocumentOrFolder_,this),Placemark:(0,m.makeArrayPusher)(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),r=(0,m.pushParseAndPop)([],r,e,t,this);if(r)return r}},{key:"readPlacemark_",value:function(e,t){var r,a,s,u,l,c,n=(0,m.pushParseAndPop)({geometry:null},re,e,t,this);if(n)return r=new F.default,null!==(e=e.getAttribute("id"))&&r.setId(e),e=t[0],(t=n.geometry)&&(0,K.transformGeometryWithOptions)(t,!1,e),r.setGeometry(t),delete n.geometry,this.extractStyles_&&(e=n.Style,t=n.styleUrl,a=e,s=t,u=this.defaultStyle_,l=this.sharedStyles_,c=this.showPointNames_,r.setStyle(function(e,t){var r=c,n="",i=[],o=((r=r&&(o=e.getGeometry())?o instanceof h.default?0<(i=o.getGeometriesArrayRecursive().filter(function(e){e=e.getType();return"Point"===e||"MultiPoint"===e})).length:"Point"===(o=o.getType())||"MultiPoint"===o:r)&&(n=e.get("name"),r=r&&!!n)&&/&[^&]+;/.test(n)&&((le=le||document.createElement("textarea")).innerHTML=n,n=le.value),u);return a?o=a:s&&(o=function e(t,r,n){return Array.isArray(t)?t:"string"==typeof t?e(n[t],r,n):r}(s,u,l)),r?(e=function(e,t){var r=[0,0],n="start",i=e.getImage();{var o,a;i&&(o=i.getSize())&&2==o.length&&(s=i.getScaleArray(),a=i.getAnchor(),r[0]=s[0]*(o[0]-a[0]),r[1]=s[1]*(o[1]/2-a[1]),n="left")}var s=e.getText();s?((s=s.clone()).setFont(s.getFont()||E.getFont()),s.setScale(s.getScale()||E.getScale()),s.setFill(s.getFill()||E.getFill()),s.setStroke(s.getStroke()||P)):s=E.clone();return s.setText(t),s.setOffsetX(r[0]),s.setOffsetY(r[1]),s.setTextAlign(n),new f.default({image:i,text:s})}(o[0],n),0<i.length?(e.setGeometry(new h.default(i)),[e,new f.default({geometry:o[0].getGeometry(),image:null,fill:o[0].getFill(),stroke:o[0].getStroke(),text:null})].concat(o.slice(1))):e):o})),delete n.Style,r.setProperties(n,!0),r}},{key:"readSharedStyle_",value:function(e,t){var r=e.getAttribute("id");null!==r&&(t=Fe.call(this,e,t))&&(e=(e=(e=e.baseURI)&&"about:blank"!=e?e:window.location.href)?new URL("#"+r,e).href:"#"+r,this.sharedStyles_[e]=t)}},{key:"readSharedStyleMap_",value:function(e,t){var r=e.getAttribute("id");null!==r&&(t=ge.call(this,e,t))&&(e=(e=(e=e.baseURI)&&"about:blank"!=e?e:window.location.href)?new URL("#"+r,e).href:"#"+r,this.sharedStyles_[e]=t)}},{key:"readFeatureFromNode",value:function(e,t){return c.includes(e.namespaceURI)&&this.readPlacemark_(e,[this.getReadOptions(e,t)])||null}},{key:"readFeaturesFromNode",value:function(e,t){if(!c.includes(e.namespaceURI))return[];var r,n=e.localName;if("Document"==n||"Folder"==n)return(i=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]))||[];if("Placemark"==n)return(r=this.readPlacemark_(e,[this.getReadOptions(e,t)]))?[r]:[];if("kml"!=n)return[];for(var i=[],o=e.firstElementChild;o;o=o.nextElementSibling){var a=this.readFeaturesFromNode(o,t);a&&(0,d.extend)(i,a)}return i}},{key:"readName",value:function(e){var t;if(e)return"string"==typeof e?(t=(0,m.parse)(e),this.readNameFromDocument(t)):(0,m.isDocument)(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}},{key:"readNameFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){var r=this.readNameFromNode(t);if(r)return r}}},{key:"readNameFromNode",value:function(e){for(var t=e.firstElementChild;t;t=t.nextElementSibling)if(c.includes(t.namespaceURI)&&"name"==t.localName)return(0,y.readString)(t);for(var r=e.firstElementChild;r;r=r.nextElementSibling){var n=r.localName;if(c.includes(r.namespaceURI)&&("Document"==n||"Folder"==n||"Placemark"==n||"kml"==n)){n=this.readNameFromNode(r);if(n)return n}}}},{key:"readNetworkLinks",value:function(e){var t,r=[];return"string"==typeof e?(t=(0,m.parse)(e),(0,d.extend)(r,this.readNetworkLinksFromDocument(t))):(0,m.isDocument)(e)?(0,d.extend)(r,this.readNetworkLinksFromDocument(e)):(0,d.extend)(r,this.readNetworkLinksFromNode(e)),r}},{key:"readNetworkLinksFromDocument",value:function(e){for(var t=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&(0,d.extend)(t,this.readNetworkLinksFromNode(r));return t}},{key:"readNetworkLinksFromNode",value:function(e){for(var t,r=[],n=e.firstElementChild;n;n=n.nextElementSibling)c.includes(n.namespaceURI)&&"NetworkLink"==n.localName&&(t=(0,m.pushParseAndPop)({},ne,n,[]),r.push(t));for(var i=e.firstElementChild;i;i=i.nextElementSibling){var o=i.localName;!c.includes(i.namespaceURI)||"Document"!=o&&"Folder"!=o&&"kml"!=o||(0,d.extend)(r,this.readNetworkLinksFromNode(i))}return r}},{key:"readRegion",value:function(e){var t,r=[];return"string"==typeof e?(t=(0,m.parse)(e),(0,d.extend)(r,this.readRegionFromDocument(t))):(0,m.isDocument)(e)?(0,d.extend)(r,this.readRegionFromDocument(e)):(0,d.extend)(r,this.readRegionFromNode(e)),r}},{key:"readRegionFromDocument",value:function(e){for(var t=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&(0,d.extend)(t,this.readRegionFromNode(r));return t}},{key:"readRegionFromNode",value:function(e){for(var t,r=[],n=e.firstElementChild;n;n=n.nextElementSibling)c.includes(n.namespaceURI)&&"Region"==n.localName&&(t=(0,m.pushParseAndPop)({},oe,n,[]),r.push(t));for(var i=e.firstElementChild;i;i=i.nextElementSibling){var o=i.localName;!c.includes(i.namespaceURI)||"Document"!=o&&"Folder"!=o&&"kml"!=o||(0,d.extend)(r,this.readRegionFromNode(i))}return r}},{key:"writeFeaturesNode",value:function(e,t){t=this.adaptOptions(t);var r=(0,m.createElementNS)(c[4],"kml"),n="http://www.w3.org/2000/xmlns/",n=(r.setAttributeNS(n,"xmlns:gx",l[0]),r.setAttributeNS(n,"xmlns:xsi",m.XML_SCHEMA_INSTANCE_URI),r.setAttributeNS(m.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd"),{node:r}),i={},e=(1<e.length?i.Document=e:1==e.length&&(i.Placemark=e[0]),ae[r.namespaceURI]),i=(0,m.makeSequence)(i,e);return(0,m.pushSerializeAndPop)(n,se,m.OBJECT_PROPERTY_NODE_FACTORY,i,[t],e,this),r}}])&&J(t.prototype,e),r&&J(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(q.default);function R(e){var e=(0,m.getAllTextContent)(e,!1),e=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(e)return e=e[1],[parseInt(e.substr(6,2),16),parseInt(e.substr(4,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(0,2),16)/255]}function fe(e){for(var t,r=[],n=(n=(0,m.getAllTextContent)(e,!1)).replace(/\s*,\s*/g,","),i=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;t=i.exec(n);){var o=parseFloat(t[1]),a=parseFloat(t[2]),s=t[3]?parseFloat(t[3]):0;r.push(o,a,s),n=n.substr(t[0].length)}if(""===n)return r}function he(e){var t=(0,m.getAllTextContent)(e,!1).trim(),e=e.baseURI;return(e=e&&"about:blank"!=e?e:window.location.href)?new URL(t,e).href:t}function pe(e){var t=(0,m.getAllTextContent)(e,!1).trim().replace(/^(?!.*#)/,"#"),e=e.baseURI;return(e=e&&"about:blank"!=e?e:window.location.href)?new URL(t,e).href:t}function de(e){return(0,y.readDecimal)(e)}var ye=(0,m.makeStructureNS)(c,{Pair:function(e,t){var r,e=(0,m.pushParseAndPop)({},We,e,t,this);e&&(r=e.key)&&"normal"==r&&((r=e.styleUrl)&&(t[t.length-1]=r),r=e.Style)&&(t[t.length-1]=r)}});function ge(e,t){return(0,m.pushParseAndPop)(void 0,ye,e,t,this)}var me=(0,m.makeStructureNS)(c,{Icon:(0,m.makeObjectPropertySetter)(function(e,t){e=(0,m.pushParseAndPop)({},Pe,e,t);return e||null}),color:(0,m.makeObjectPropertySetter)(R),heading:(0,m.makeObjectPropertySetter)(y.readDecimal),hotSpot:(0,m.makeObjectPropertySetter)(function(e){var t=e.getAttribute("xunits"),r=e.getAttribute("yunits"),n="insetPixels"!==t?"insetPixels"!==r?"bottom-left":"top-left":"insetPixels"!==r?"bottom-right":"top-right";return{x:parseFloat(e.getAttribute("x")),xunits:te[t],y:parseFloat(e.getAttribute("y")),yunits:te[r],origin:n}}),scale:(0,m.makeObjectPropertySetter)(de)});var ve=(0,m.makeStructureNS)(c,{color:(0,m.makeObjectPropertySetter)(R),scale:(0,m.makeObjectPropertySetter)(de)});var be=(0,m.makeStructureNS)(c,{color:(0,m.makeObjectPropertySetter)(R),width:(0,m.makeObjectPropertySetter)(y.readDecimal)});var _e=(0,m.makeStructureNS)(c,{color:(0,m.makeObjectPropertySetter)(R),fill:(0,m.makeObjectPropertySetter)(y.readBoolean),outline:(0,m.makeObjectPropertySetter)(y.readBoolean)});var we=(0,m.makeStructureNS)(c,{coordinates:(0,m.makeReplacer)(fe)});function xe(e,t){return(0,m.pushParseAndPop)(null,we,e,t)}var Se=(0,m.makeStructureNS)(l,{Track:(0,m.makeArrayPusher)(Oe)});var je=(0,m.makeStructureNS)(c,{when:function(e,t){t=t[t.length-1].whens,e=(0,m.getAllTextContent)(e,!1),e=Date.parse(e);t.push(isNaN(e)?0:e)}},(0,m.makeStructureNS)(l,{coord:function(e,t){var r,n,t=t[t.length-1].coordinates,e=(0,m.getAllTextContent)(e,!1);(e=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(e))?(r=parseFloat(e[1]),n=parseFloat(e[2]),e=parseFloat(e[3]),t.push([r,n,e])):t.push([])}}));function Oe(e,t){e=(0,m.pushParseAndPop)({coordinates:[],whens:[]},je,e,t);if(e){for(var r=[],n=e.coordinates,i=e.whens,o=0,a=Math.min(n.length,i.length);o<a;++o)3==n[o].length&&r.push(n[o][0],n[o][1],n[o][2],i[o]);return new B.default(r,"XYZM")}}var Pe=(0,m.makeStructureNS)(c,{href:(0,m.makeObjectPropertySetter)(he)},(0,m.makeStructureNS)(l,{x:(0,m.makeObjectPropertySetter)(y.readDecimal),y:(0,m.makeObjectPropertySetter)(y.readDecimal),w:(0,m.makeObjectPropertySetter)(y.readDecimal),h:(0,m.makeObjectPropertySetter)(y.readDecimal)}));var ke=(0,m.makeStructureNS)(c,{coordinates:(0,m.makeReplacer)(fe)});function Ee(e,t){return(0,m.pushParseAndPop)(null,ke,e,t)}var M=(0,m.makeStructureNS)(c,{extrude:(0,m.makeObjectPropertySetter)(y.readBoolean),tessellate:(0,m.makeObjectPropertySetter)(y.readBoolean),altitudeMode:(0,m.makeObjectPropertySetter)(y.readString)});function Te(e,t){var r=(0,m.pushParseAndPop)({},M,e,t),e=Ee(e,t);if(e)return(t=new B.default(e,"XYZ")).setProperties(r,!0),t}function Ce(e,t){var r=(0,m.pushParseAndPop)({},M,e,t),e=Ee(e,t);if(e)return(t=new V.default(e,"XYZ",[e.length])).setProperties(r,!0),t}var Re=(0,m.makeStructureNS)(c,{LineString:(0,m.makeArrayPusher)(Te),LinearRing:(0,m.makeArrayPusher)(Ce),MultiGeometry:(0,m.makeArrayPusher)(Me),Point:(0,m.makeArrayPusher)(Ie),Polygon:(0,m.makeArrayPusher)(Le)});function Me(e,t){var r,n=(0,m.pushParseAndPop)([],Re,e,t);if(!n)return null;if(0===n.length)return new h.default(n);for(var i,o=!0,a=n[0].getType(),s=1,u=n.length;s<u;++s)if((i=n[s]).getType()!=a){o=!1;break}if(o)if("Point"==a){for(var e=n[0],t=e.getLayout(),l=e.getFlatCoordinates(),c=1,f=n.length;c<f;++c)i=n[c],(0,d.extend)(l,i.getFlatCoordinates());Ne(r=new U.default(l,t),n)}else"LineString"==a?Ne(r=new G.default(n),n):"Polygon"==a?Ne(r=new z.default(n),n):"GeometryCollection"==a?r=new h.default(n):(0,p.assert)(!1,37);else r=new h.default(n);return r}function Ie(e,t){var r=(0,m.pushParseAndPop)({},M,e,t),e=Ee(e,t);if(e)return(t=new W.default(e,"XYZ")).setProperties(r,!0),t}var Ae=(0,m.makeStructureNS)(c,{innerBoundaryIs:function(e,t){e=(0,m.pushParseAndPop)([],Ye,e,t);0<e.length&&(t=t[t.length-1]).push.apply(t,$(e))},outerBoundaryIs:function(e,t){e=(0,m.pushParseAndPop)(void 0,Xe,e,t);e&&(t[t.length-1][0]=e)}});function Le(e,t){var r=(0,m.pushParseAndPop)({},M,e,t),n=(0,m.pushParseAndPop)([null],Ae,e,t);if(n&&n[0]){for(var i=n[0],o=[i.length],a=1,s=n.length;a<s;++a)(0,d.extend)(i,n[a]),o.push(i.length);e=new V.default(i,"XYZ",o);return e.setProperties(r,!0),e}}var De=(0,m.makeStructureNS)(c,{IconStyle:function(e,t){var r,n,i,o,a,s,u,l,c,f,h,p,d,y;(e=(0,m.pushParseAndPop)({},me,e,t))&&(t=t[t.length-1],d="Icon"in e?e.Icon:{},y=!("Icon"in e)||0<Object.keys(d).length,(a=d.href)?r=a:y&&(r=x),a="bottom-left",(c=e.hotSpot)?(n=[c.x,c.y],i=c.xunits,o=c.yunits,a=c.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(r)&&(r.includes("pushpin")?(n=v,i=b,o=_):r.includes("arrow-reverse")?(n=[54,42],i=b,o=_):r.includes("paddle")&&(n=[32,1],i=b,o=_)),c=d.x,f=d.y,void 0!==c&&void 0!==f&&(s=[c,f]),c=d.w,f=d.h,void 0!==c&&void 0!==f&&(u=[c,f]),void 0!==(d=e.heading)&&(l=(0,Z.toRadians)(d)),c=e.scale,f=e.color,y?(r==x&&(u=w),h=new N.default({anchor:n,anchorOrigin:a,anchorXUnits:i,anchorYUnits:o,crossOrigin:this.crossOrigin_,offset:s,offsetOrigin:"bottom-left",rotation:l,scale:c,size:u,src:this.iconUrlFunction_(r),color:f}),p=h.getScaleArray()[0],null===(d=h.getSize())?(e=h.getImageState())!==g.default.IDLE&&e!==g.default.LOADING||(h.listenImageChange(function e(){var t=h.getImageState();t!==g.default.IDLE&&t!==g.default.LOADING&&((t=h.getSize())&&2==t.length&&(t=C(t),h.setScale(p*t)),h.unlistenImageChange(e))}),e===g.default.IDLE&&h.load()):2==d.length&&(y=C(d),h.setScale(p*y)),t.imageStyle=h):t.imageStyle=j)},LabelStyle:function(e,t){(e=(0,m.pushParseAndPop)({},ve,e,t))&&(t=t[t.length-1],e=new H.default({fill:new o.default({color:"color"in e?e.color:u}),scale:e.scale}),t.textStyle=e)},LineStyle:function(e,t){(e=(0,m.pushParseAndPop)({},be,e,t))&&(t=t[t.length-1],e=new a.default({color:"color"in e?e.color:u,width:"width"in e?e.width:1}),t.strokeStyle=e)},PolyStyle:function(e,t){var r;(e=(0,m.pushParseAndPop)({},_e,e,t))&&(t=t[t.length-1],r=new o.default({color:"color"in e?e.color:u}),t.fillStyle=r,void 0!==(r=e.fill)&&(t.fill=r),void 0!==(r=e.outline))&&(t.outline=r)}});function Fe(e,t){var r,n,i,e=(0,m.pushParseAndPop)({},De,e,t,this);return e?(t="fillStyle"in e?e.fillStyle:S,void 0===(n=e.fill)||n||(t=null),"imageStyle"in e?e.imageStyle!=j&&(r=e.imageStyle):r=O,n="textStyle"in e?e.textStyle:E,i="strokeStyle"in e?e.strokeStyle:k,void 0===(e=e.outline)||e?[new f.default({fill:t,image:r,stroke:i,text:n,zIndex:void 0})]:[new f.default({geometry:function(e){var t=(e=e.getGeometry()).getType();return"GeometryCollection"===t?new h.default(e.getGeometriesArrayRecursive().filter(function(e){e=e.getType();return"Polygon"!==e&&"MultiPolygon"!==e})):"Polygon"!==t&&"MultiPolygon"!==t?e:void 0},fill:t,image:r,stroke:i,text:n,zIndex:void 0}),new f.default({geometry:function(e){var t=(e=e.getGeometry()).getType();return"GeometryCollection"===t?new h.default(e.getGeometriesArrayRecursive().filter(function(e){e=e.getType();return"Polygon"===e||"MultiPolygon"===e})):"Polygon"===t||"MultiPolygon"===t?e:void 0},fill:t,stroke:null,zIndex:void 0})]):null}function Ne(e,t){for(var r=t.length,n=new Array(t.length),i=new Array(t.length),o=new Array(t.length),a=!1,s=!1,u=!1,l=0;l<r;++l){var c=t[l];n[l]=c.get("extrude"),i[l]=c.get("tessellate"),o[l]=c.get("altitudeMode"),a=a||void 0!==n[l],s=s||void 0!==i[l],u=u||o[l]}a&&e.set("extrude",n),s&&e.set("tessellate",i),u&&e.set("altitudeMode",o)}var Be=(0,m.makeStructureNS)(c,{displayName:(0,m.makeObjectPropertySetter)(y.readString),value:(0,m.makeObjectPropertySetter)(y.readString)});var Ge=(0,m.makeStructureNS)(c,{Data:function(e,t){var r=e.getAttribute("name"),n=((0,m.parseNode)(Be,e,t),t[t.length-1]);r&&n.displayName?n[r]={value:n.value,displayName:n.displayName,toString:function(){return n.value}}:null!==r?n[r]=n.value:null!==n.displayName&&(n[n.displayName]=n.value),delete n.value},SchemaData:function(e,t){(0,m.parseNode)(Ve,e,t)}});function Ue(e,t){(0,m.parseNode)(Ge,e,t)}function ze(e,t){(0,m.parseNode)(oe,e,t)}var We=(0,m.makeStructureNS)(c,{Style:(0,m.makeObjectPropertySetter)(Fe),key:(0,m.makeObjectPropertySetter)(y.readString),styleUrl:(0,m.makeObjectPropertySetter)(pe)});var Ve=(0,m.makeStructureNS)(c,{SimpleData:function(e,t){var r=e.getAttribute("name");null!==r&&(e=(0,y.readString)(e),t[t.length-1][r]=e)}});var He=(0,m.makeStructureNS)(c,{altitudeMode:(0,m.makeObjectPropertySetter)(y.readString),minAltitude:(0,m.makeObjectPropertySetter)(y.readDecimal),maxAltitude:(0,m.makeObjectPropertySetter)(y.readDecimal),north:(0,m.makeObjectPropertySetter)(y.readDecimal),south:(0,m.makeObjectPropertySetter)(y.readDecimal),east:(0,m.makeObjectPropertySetter)(y.readDecimal),west:(0,m.makeObjectPropertySetter)(y.readDecimal)});var qe=(0,m.makeStructureNS)(c,{minLodPixels:(0,m.makeObjectPropertySetter)(y.readDecimal),maxLodPixels:(0,m.makeObjectPropertySetter)(y.readDecimal),minFadeExtent:(0,m.makeObjectPropertySetter)(y.readDecimal),maxFadeExtent:(0,m.makeObjectPropertySetter)(y.readDecimal)});var Ye=(0,m.makeStructureNS)(c,{LinearRing:(0,m.makeArrayPusher)(xe)});var Xe=(0,m.makeStructureNS)(c,{LinearRing:(0,m.makeReplacer)(xe)});function I(e,t){for(var t=(0,Y.asArray)(t),r=[255*(4==t.length?t[3]:1),t[2],t[1],t[0]],n=0;n<4;++n){var i=Math.floor(r[n]).toString(16);r[n]=1==i.length?"0"+i:i}(0,y.writeStringTextNode)(e,r.join(""))}var A=(0,m.makeStructureNS)(c,{Data:(0,m.makeChildAppender)(function(e,t,r){e.setAttribute("name",t.name);e={node:e},t=t.value;"object"==i(t)?(null!==t&&t.displayName&&(0,m.pushSerializeAndPop)(e,A,m.OBJECT_PROPERTY_NODE_FACTORY,[t.displayName],r,["displayName"]),null!==t&&t.value&&(0,m.pushSerializeAndPop)(e,A,m.OBJECT_PROPERTY_NODE_FACTORY,[t.value],r,["value"])):(0,m.pushSerializeAndPop)(e,A,m.OBJECT_PROPERTY_NODE_FACTORY,[t],r,["value"])}),value:(0,m.makeChildAppender)(function(e,t){(0,y.writeStringTextNode)(e,t)}),displayName:(0,m.makeChildAppender)(function(e,t){(0,y.writeCDATASection)(e,t)})});var Ze=(0,m.makeStructureNS)(c,{Placemark:(0,m.makeChildAppender)(_t)}),Ke=function(e,t,r){t=t[t.length-1].node;return(0,m.createElementNS)(t.namespaceURI,"Placemark")};var $e=(0,m.makeSimpleNodeFactory)("Data");function Je(e,t,r){return(0,m.createElementNS)(l[0],"gx:"+r)}var Qe=(0,m.makeStructureNS)(c,["href"],(0,m.makeStructureNS)(l,["x","y","w","h"])),et=(0,m.makeStructureNS)(c,{href:(0,m.makeChildAppender)(y.writeStringTextNode)},(0,m.makeStructureNS)(l,{x:(0,m.makeChildAppender)(y.writeDecimalTextNode),y:(0,m.makeChildAppender)(y.writeDecimalTextNode),w:(0,m.makeChildAppender)(y.writeDecimalTextNode),h:(0,m.makeChildAppender)(y.writeDecimalTextNode)}));var tt=(0,m.makeStructureNS)(c,["scale","heading","Icon","color","hotSpot"]),rt=(0,m.makeStructureNS)(c,{Icon:(0,m.makeChildAppender)(function(e,t,r){var e={node:e},n=r[r.length-1].node,n=Qe[n.namespaceURI],i=(0,m.makeSequence)(t,n);(0,m.pushSerializeAndPop)(e,et,m.OBJECT_PROPERTY_NODE_FACTORY,i,r,n),n=Qe[l[0]],i=(0,m.makeSequence)(t,n),(0,m.pushSerializeAndPop)(e,et,Je,i,r,n)}),color:(0,m.makeChildAppender)(I),heading:(0,m.makeChildAppender)(y.writeDecimalTextNode),hotSpot:(0,m.makeChildAppender)(function(e,t){e.setAttribute("x",String(t.x)),e.setAttribute("y",String(t.y)),e.setAttribute("xunits",t.xunits),e.setAttribute("yunits",t.yunits)}),scale:(0,m.makeChildAppender)(Tt)});var nt=(0,m.makeStructureNS)(c,["color","scale"]),it=(0,m.makeStructureNS)(c,{color:(0,m.makeChildAppender)(I),scale:(0,m.makeChildAppender)(Tt)});var ot=(0,m.makeStructureNS)(c,["color","width"]),at=(0,m.makeStructureNS)(c,{color:(0,m.makeChildAppender)(I),width:(0,m.makeChildAppender)(y.writeDecimalTextNode)});var st={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},ut=function(e,t,r){if(e)return t=t[t.length-1].node,(0,m.createElementNS)(t.namespaceURI,st[e.getType()])},lt=(0,m.makeSimpleNodeFactory)("Point"),ct=(0,m.makeSimpleNodeFactory)("LineString"),ft=(0,m.makeSimpleNodeFactory)("LinearRing"),ht=(0,m.makeSimpleNodeFactory)("Polygon"),pt=(0,m.makeStructureNS)(c,{LineString:(0,m.makeChildAppender)(L),Point:(0,m.makeChildAppender)(L),Polygon:(0,m.makeChildAppender)(kt),GeometryCollection:(0,m.makeChildAppender)(dt)});function dt(e,t,r){var n,e={node:e},i=t.getType(),o=[];"GeometryCollection"===i?(t.getGeometriesArrayRecursive().forEach(function(e){var t=e.getType();"MultiPoint"===t?o=o.concat(e.getPoints()):"MultiLineString"===t?o=o.concat(e.getLineStrings()):"MultiPolygon"===t?o=o.concat(e.getPolygons()):"Point"===t||"LineString"===t||"Polygon"===t?o.push(e):(0,p.assert)(!1,39)}),n=ut):"MultiPoint"===i?(o=t.getPoints(),n=lt):"MultiLineString"===i?(o=t.getLineStrings(),n=ct):"MultiPolygon"===i?(o=t.getPolygons(),n=ht):(0,p.assert)(!1,39),(0,m.pushSerializeAndPop)(e,pt,n,o,r)}var yt=(0,m.makeStructureNS)(c,{LinearRing:(0,m.makeChildAppender)(L)});function gt(e,t,r){(0,m.pushSerializeAndPop)({node:e},yt,ft,[t],r)}var mt=(0,m.makeStructureNS)(c,{ExtendedData:(0,m.makeChildAppender)(function(e,t,r){for(var n={node:e},i=t.names,o=t.values,a=i.length,s=0;s<a;s++)(0,m.pushSerializeAndPop)(n,A,$e,[{name:i[s],value:o[s]}],r)}),MultiGeometry:(0,m.makeChildAppender)(dt),LineString:(0,m.makeChildAppender)(L),LinearRing:(0,m.makeChildAppender)(L),Point:(0,m.makeChildAppender)(L),Polygon:(0,m.makeChildAppender)(kt),Style:(0,m.makeChildAppender)(function(e,t,r){var e={node:e},n={};t.pointStyles.length&&((i=t.pointStyles[0].getText())&&(n.LabelStyle=i),i=t.pointStyles[0].getImage())&&"function"==typeof i.getSrc&&(n.IconStyle=i);t.lineStyles.length&&(i=t.lineStyles[0].getStroke())&&(n.LineStyle=i);t.polyStyles.length&&((i=t.polyStyles[0].getStroke())&&!n.LineStyle&&(n.LineStyle=i),n.PolyStyle=t.polyStyles[0]);var i=r[r.length-1].node,t=Ct[i.namespaceURI],i=(0,m.makeSequence)(n,t);(0,m.pushSerializeAndPop)(e,Rt,m.OBJECT_PROPERTY_NODE_FACTORY,i,r,t)}),address:(0,m.makeChildAppender)(y.writeStringTextNode),description:(0,m.makeChildAppender)(y.writeStringTextNode),name:(0,m.makeChildAppender)(y.writeStringTextNode),open:(0,m.makeChildAppender)(y.writeBooleanTextNode),phoneNumber:(0,m.makeChildAppender)(y.writeStringTextNode),styleUrl:(0,m.makeChildAppender)(y.writeStringTextNode),visibility:(0,m.makeChildAppender)(y.writeBooleanTextNode)}),vt=(0,m.makeStructureNS)(c,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),bt=(0,m.makeSimpleNodeFactory)("ExtendedData");function _t(e,r,t){var n={node:e},e=(r.getId()&&e.setAttribute("id",r.getId()),r.getProperties()),i={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1},o=(i[r.getGeometryName()]=1,Object.keys(e||{}).sort().filter(function(e){return!i[e]})),a=r.getStyleFunction(),s=(a&&(a=a(r,0))&&(l=a=Array.isArray(a)?a:[a],r.getGeometry()&&(l=a.filter(function(e){var t,e=e.getGeometryFunction()(r);if(e)return"GeometryCollection"===(t=e.getType())?e.getGeometriesArrayRecursive().filter(function(e){e=e.getType();return"Point"===e||"MultiPoint"===e}).length:"Point"===t||"MultiPoint"===t})),this.writeStyles_&&(u=s=a,r.getGeometry()&&(s=a.filter(function(e){var t,e=e.getGeometryFunction()(r);if(e)return"GeometryCollection"===(t=e.getType())?e.getGeometriesArrayRecursive().filter(function(e){e=e.getType();return"LineString"===e||"MultiLineString"===e}).length:"LineString"===t||"MultiLineString"===t}),u=a.filter(function(e){var t,e=e.getGeometryFunction()(r);if(e)return"GeometryCollection"===(t=e.getType())?e.getGeometriesArrayRecursive().filter(function(e){e=e.getType();return"Polygon"===e||"MultiPolygon"===e}).length:"Polygon"===t||"MultiPolygon"===t})),e.Style={pointStyles:l,lineStyles:s,polyStyles:u}),l.length)&&void 0===e.name&&(a=l[0].getText())&&(e.name=a.getText()),t[t.length-1].node),u=vt[s.namespaceURI],l=(0,m.makeSequence)(e,u),s=((0,m.pushSerializeAndPop)(n,mt,m.OBJECT_PROPERTY_NODE_FACTORY,l,t,u),0<o.length&&(a=(0,m.makeSequence)(e,o),(0,m.pushSerializeAndPop)(n,mt,bt,[{names:o,values:a}],t)),t[0]),l=(l=r.getGeometry())&&(0,K.transformGeometryWithOptions)(l,!0,s);(0,m.pushSerializeAndPop)(n,mt,ut,[l],t)}var wt=(0,m.makeStructureNS)(c,["extrude","tessellate","altitudeMode","coordinates"]),xt=(0,m.makeStructureNS)(c,{extrude:(0,m.makeChildAppender)(y.writeBooleanTextNode),tessellate:(0,m.makeChildAppender)(y.writeBooleanTextNode),altitudeMode:(0,m.makeChildAppender)(y.writeStringTextNode),coordinates:(0,m.makeChildAppender)(function(e,t,r){var n,i=(r=r[r.length-1]).layout,o=r.stride,a=("XY"==i||"XYM"==i?n=2:"XYZ"==i||"XYZM"==i?n=3:(0,p.assert)(!1,34),t.length),s="";if(0<a){s+=t[0];for(var u=1;u<n;++u)s+=","+t[u];for(var l=o;l<a;l+=o){s+=" "+t[l];for(var c=1;c<n;++c)s+=","+t[l+c]}}(0,y.writeStringTextNode)(e,s)})});function L(e,t,r){var n=t.getFlatCoordinates(),e={node:e},t=(e.layout=t.getLayout(),e.stride=t.getStride(),t.getProperties()),n=(t.coordinates=n,r[r.length-1].node),n=wt[n.namespaceURI],t=(0,m.makeSequence)(t,n);(0,m.pushSerializeAndPop)(e,xt,m.OBJECT_PROPERTY_NODE_FACTORY,t,r,n)}var St=(0,m.makeStructureNS)(c,["color","fill","outline"]),jt=(0,m.makeStructureNS)(c,{outerBoundaryIs:(0,m.makeChildAppender)(gt),innerBoundaryIs:(0,m.makeChildAppender)(gt)}),Ot=(0,m.makeSimpleNodeFactory)("innerBoundaryIs"),Pt=(0,m.makeSimpleNodeFactory)("outerBoundaryIs");function kt(e,t,r){var t=t.getLinearRings(),n=t.shift(),e={node:e};(0,m.pushSerializeAndPop)(e,jt,Ot,t,r),(0,m.pushSerializeAndPop)(e,jt,Pt,[n],r)}var Et=(0,m.makeStructureNS)(c,{color:(0,m.makeChildAppender)(I),fill:(0,m.makeChildAppender)(y.writeBooleanTextNode),outline:(0,m.makeChildAppender)(y.writeBooleanTextNode)});function Tt(e,t){(0,y.writeDecimalTextNode)(e,Math.round(1e6*t)/1e6)}var Ct=(0,m.makeStructureNS)(c,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Rt=(0,m.makeStructureNS)(c,{IconStyle:(0,m.makeChildAppender)(function(e,t,r){var e={node:e},n={},i=t.getSrc(),o=t.getSize(),a=t.getImageSize(),i={href:i},s=(o&&(i.w=o[0],i.h=o[1],u=t.getAnchor(),(s=t.getOrigin())&&a&&0!==s[0]&&s[1]!==o[1]&&(i.x=s[0],i.y=a[1]-(s[1]+o[1])),!u||u[0]===o[0]/2&&u[1]===o[1]/2||(a={x:u[0],xunits:"pixels",y:o[1]-u[1],yunits:"pixels"},n.hotSpot=a)),n.Icon=i,t.getScaleArray()[0]),u=o;2==(u=null===o?w:o).length&&(s/=C(u)),1!==s&&(n.scale=s),0!==(a=t.getRotation())&&(n.heading=a);(i=t.getColor())&&(n.color=i),o=r[r.length-1].node,u=tt[o.namespaceURI],s=(0,m.makeSequence)(n,u);(0,m.pushSerializeAndPop)(e,rt,m.OBJECT_PROPERTY_NODE_FACTORY,s,r,u)}),LabelStyle:(0,m.makeChildAppender)(function(e,t,r){var e={node:e},n={};(i=t.getFill())&&(n.color=i.getColor());(i=t.getScale())&&1!==i&&(n.scale=i);var t=r[r.length-1].node,i=nt[t.namespaceURI],t=(0,m.makeSequence)(n,i);(0,m.pushSerializeAndPop)(e,it,m.OBJECT_PROPERTY_NODE_FACTORY,t,r,i)}),LineStyle:(0,m.makeChildAppender)(function(e,t,r){var e={node:e},t={color:t.getColor(),width:Number(t.getWidth())||1},n=r[r.length-1].node,n=ot[n.namespaceURI],t=(0,m.makeSequence)(t,n);(0,m.pushSerializeAndPop)(e,at,m.OBJECT_PROPERTY_NODE_FACTORY,t,r,n)}),PolyStyle:(0,m.makeChildAppender)(function(e,t,r){var e={node:e},n=t.getFill(),t=t.getStroke(),n={color:n?n.getColor():void 0,fill:!!n&&void 0,outline:!!t&&void 0},t=r[r.length-1].node,t=St[t.namespaceURI],n=(0,m.makeSequence)(n,t);(0,m.pushSerializeAndPop)(e,Et,m.OBJECT_PROPERTY_NODE_FACTORY,n,r,t)})});t.default=e},{"../Feature.js":75,"../ImageState.js":80,"../array.js":104,"../asserts.js":105,"../color.js":107,"../geom/GeometryCollection.js":193,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../math.js":267,"../proj.js":271,"../style/Fill.js":360,"../style/Icon.js":361,"../style/Stroke.js":366,"../style/Style.js":367,"../style/Text.js":368,"../xml.js":391,"./Feature.js":136,"./XMLFeature.js":160,"./xsd.js":188}],148:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Feature.js")),l=n(e("../geom/LineString.js")),c=n(e("../geom/MultiLineString.js")),f=n(e("../geom/MultiPoint.js")),h=n(e("../geom/MultiPolygon.js")),p=n(e("pbf")),d=n(e("../geom/Point.js")),y=n(e("../geom/Polygon.js")),o=n(e("../proj/Projection.js")),g=n(e("../render/Feature.js")),m=e("../asserts.js"),v=e("../proj.js"),b=e("../geom/flat/orient.js");function n(e){return e&&e.__esModule?e:{default:e}}function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e);var r,n=x(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).dataProjection=new o.default({code:"",units:"tile-pixels"}),t.featureClass_=e.featureClass||g.default,t.geometryName_=e.geometryName,t.layerName_=e.layerName||"layer",t.layers_=e.layers||null,t.idProperty_=e.idProperty,t.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readRawGeometry_",value:function(e,t,r,n){e.pos=t.geometry;for(var i,o=e.readVarint()+e.pos,a=1,s=0,u=0,l=0,c=0,f=0;e.pos<o;)s||(a=7&(i=e.readVarint()),s=i>>3),s--,1===a||2===a?(u+=e.readSVarint(),l+=e.readSVarint(),1===a&&f<c&&(n.push(c),f=c),r.push(u,l),c+=2):7===a?f<c&&(r.push(r[f],r[f+1]),c+=2):(0,m.assert)(!1,59);f<c&&n.push(c)}},{key:"createFeature_",value:function(e,t,r){var n,i,o,a,s=t.type;return 0===s?null:(n=t.properties,this.idProperty_?(i=n[this.idProperty_],delete n[this.idProperty_]):i=t.id,n[this.layerName_]=t.layer.name,this.readRawGeometry_(e,t,e=[],t=[]),s=function(e,t){var r;1===e?r=1===t?"Point":"MultiPoint":2===e?r=1===t?"LineString":"MultiLineString":3===e&&(r="Polygon");return r}(s,t.length),this.featureClass_===g.default?(a=new this.featureClass_(s,e,t,n,i)).transform(r.dataProjection):(o="Polygon"==s?1<(o=(0,b.inflateEnds)(e,t)).length?new h.default(e,"XY",o):new y.default(e,"XY",t):"Point"===s?new d.default(e,"XY"):"LineString"===s?new l.default(e,"XY"):"MultiPoint"===s?new f.default(e,"XY"):"MultiLineString"===s?new c.default(e,"XY",t):null,a=new this.featureClass_,this.geometryName_&&a.setGeometryName(this.geometryName_),s=(0,u.transformGeometryWithOptions)(o,!1,r),a.setGeometry(s),void 0!==i&&a.setId(i),a.setProperties(n,!0)),a)}},{key:"getType",value:function(){return"arraybuffer"}},{key:"readFeatures",value:function(e,t){var r,n=this.layers_,i=(t=this.adaptOptions(t),(0,v.get)(t.dataProjection)),o=(i.setWorldExtent(t.extent),t.dataProjection=i,new p.default(e)),a=o.readFields(S,{}),s=[];for(r in a)if(!n||n.includes(r)){var u=a[r],l=u?[0,0,u.extent,u.extent]:null;i.setExtent(l);for(var c=0,f=u.length;c<f;++c){var h=function(e,t,r){e.pos=t.features[r];r=e.readVarint()+e.pos,t={layer:t,type:0,properties:{}};return e.readFields(O,t,r),t}(o,u,c),h=this.createFeature_(o,h,t);null!==h&&s.push(h)}}return s}},{key:"readProjection",value:function(e){return this.dataProjection}},{key:"setLayers",value:function(e){this.layers_=e}}])&&_(t.prototype,e),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(u.default);function S(e,t,r){var n;3===e&&(e={keys:[],values:[],features:[]},n=r.readVarint()+r.pos,r.readFields(j,e,n),e.length=e.features.length,e.length)&&(t[e.name]=e)}function j(e,t,r){if(15===e)t.version=r.readVarint();else if(1===e)t.name=r.readString();else if(5===e)t.extent=r.readVarint();else if(2===e)t.features.push(r.pos);else if(3===e)t.keys.push(r.readString());else if(4===e){for(var n=null,i=r.readVarint()+r.pos;r.pos<i;)n=1===(e=r.readVarint()>>3)?r.readString():2===e?r.readFloat():3===e?r.readDouble():4===e?r.readVarint64():5===e?r.readVarint():6===e?r.readSVarint():7===e?r.readBoolean():null;t.values.push(n)}}function O(e,t,r){if(1==e)t.id=r.readVarint();else if(2==e)for(var n=r.readVarint()+r.pos;r.pos<n;){var i=t.layer.keys[r.readVarint()],o=t.layer.values[r.readVarint()];t.properties[i]=o}else 3==e?t.type=r.readVarint():4==e&&(t.geometry=r.pos)}r.default=e},{"../asserts.js":105,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../geom/flat/orient.js":214,"../proj.js":271,"../proj/Projection.js":272,"../render/Feature.js":283,"./Feature.js":136,pbf:392}],149:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./XML.js"))&&n.__esModule?n:{default:n},o=e("../xml.js"),a=e("./xlink.js"),s=e("./xsd.js");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=[null,"http://www.opengis.net/ows/1.1"],h=(0,o.makeStructureNS)(e,{ServiceIdentification:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},j,e,t)}),ServiceProvider:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},O,e,t)}),OperationsMetadata:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},_,e,t)})}),n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(){if(this instanceof i)return n.call(this);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFromNode",value:function(e){e=(0,o.pushParseAndPop)({},h,e,[]);return e||null}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default),p=(0,o.makeStructureNS)(e,{DeliveryPoint:(0,o.makeObjectPropertySetter)(s.readString),City:(0,o.makeObjectPropertySetter)(s.readString),AdministrativeArea:(0,o.makeObjectPropertySetter)(s.readString),PostalCode:(0,o.makeObjectPropertySetter)(s.readString),Country:(0,o.makeObjectPropertySetter)(s.readString),ElectronicMailAddress:(0,o.makeObjectPropertySetter)(s.readString)}),d=(0,o.makeStructureNS)(e,{Value:(0,o.makeObjectPropertyPusher)(function(e,t){return(0,s.readString)(e)})}),y=(0,o.makeStructureNS)(e,{AllowedValues:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},d,e,t)})}),g=(0,o.makeStructureNS)(e,{Phone:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},w,e,t)}),Address:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},p,e,t)})}),m=(0,o.makeStructureNS)(e,{HTTP:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},v,e,t)})}),v=(0,o.makeStructureNS)(e,{Get:(0,o.makeObjectPropertyPusher)(function(e,t){var r=(0,a.readHref)(e);if(r)return(0,o.pushParseAndPop)({href:r},x,e,t)}),Post:void 0}),b=(0,o.makeStructureNS)(e,{DCP:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},m,e,t)})}),_=(0,o.makeStructureNS)(e,{Operation:function(e,t){var r=e.getAttribute("name"),e=(0,o.pushParseAndPop)({},b,e,t);if(!e)return;t[t.length-1][r]=e}}),w=(0,o.makeStructureNS)(e,{Voice:(0,o.makeObjectPropertySetter)(s.readString),Facsimile:(0,o.makeObjectPropertySetter)(s.readString)}),x=(0,o.makeStructureNS)(e,{Constraint:(0,o.makeObjectPropertyPusher)(function(e,t){var r=e.getAttribute("name");if(r)return(0,o.pushParseAndPop)({name:r},y,e,t)})}),S=(0,o.makeStructureNS)(e,{IndividualName:(0,o.makeObjectPropertySetter)(s.readString),PositionName:(0,o.makeObjectPropertySetter)(s.readString),ContactInfo:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},g,e,t)})}),j=(0,o.makeStructureNS)(e,{Abstract:(0,o.makeObjectPropertySetter)(s.readString),AccessConstraints:(0,o.makeObjectPropertySetter)(s.readString),Fees:(0,o.makeObjectPropertySetter)(s.readString),Title:(0,o.makeObjectPropertySetter)(s.readString),ServiceTypeVersion:(0,o.makeObjectPropertySetter)(s.readString),ServiceType:(0,o.makeObjectPropertySetter)(s.readString)}),O=(0,o.makeStructureNS)(e,{ProviderName:(0,o.makeObjectPropertySetter)(s.readString),ProviderSite:(0,o.makeObjectPropertySetter)(a.readHref),ServiceContact:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},S,e,t)})});r.default=n},{"../xml.js":391,"./XML.js":159,"./xlink.js":187,"./xsd.js":188}],150:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.decodeDeltas=b,r.decodeFloats=w,r.decodeSignedIntegers=S,r.decodeUnsignedIntegers=O,r.default=void 0,r.encodeDeltas=v,r.encodeFloats=_,r.encodeSignedIntegers=x,r.encodeUnsignedInteger=P,r.encodeUnsignedIntegers=j;var o=p(e("../Feature.js")),a=p(e("../geom/LineString.js")),n=p(e("./TextFeature.js")),s=e("../asserts.js"),u=e("../geom/flat/flip.js"),l=e("../proj.js"),c=e("../geom/SimpleGeometry.js"),f=e("../geom/flat/inflate.js"),h=e("./Feature.js");function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(r),t=(e=n?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n=g(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).dataProjection=(0,l.get)("EPSG:4326"),t.factor_=e.factor||1e5,t.geometryLayout_=e.geometryLayout||"XY",t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFeatureFromText",value:function(e,t){e=this.readGeometryFromText(e,t);return new o.default(e)}},{key:"readFeaturesFromText",value:function(e,t){return[this.readFeatureFromText(e,t)]}},{key:"readGeometryFromText",value:function(e,t){var r=(0,c.getStrideForLayout)(this.geometryLayout_),e=b(e,r,this.factor_),e=((0,u.flipXY)(e,0,e.length,r,e),(0,f.inflateCoordinates)(e,0,e.length,r)),r=new a.default(e,this.geometryLayout_);return(0,h.transformGeometryWithOptions)(r,!1,this.adaptOptions(t))}},{key:"writeFeatureText",value:function(e,t){e=e.getGeometry();return e?this.writeGeometryText(e,t):((0,s.assert)(!1,40),"")}},{key:"writeFeaturesText",value:function(e,t){return this.writeFeatureText(e[0],t)}},{key:"writeGeometryText",value:function(e,t){t=(e=(0,h.transformGeometryWithOptions)(e,!0,this.adaptOptions(t))).getFlatCoordinates(),e=e.getStride();return(0,u.flipXY)(t,0,t.length,e,t),v(t,e,this.factor_)}}])&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function v(e,t,r){r=r||1e5;for(var n=new Array(t),i=0;i<t;++i)n[i]=0;for(var o=0,a=e.length;o<a;)for(i=0;i<t;++i,++o){var s=e[o],u=s-n[i];n[i]=s,e[o]=u}return _(e,r)}function b(e,t,r){r=r||1e5;for(var n=new Array(t),i=0;i<t;++i)n[i]=0;for(var o=w(e,r),a=0,s=o.length;a<s;)for(i=0;i<t;++i,++a)n[i]+=o[a],o[a]=n[i];return o}function _(e,t){t=t||1e5;for(var r=0,n=e.length;r<n;++r)e[r]=Math.round(e[r]*t);return x(e)}function w(e,t){t=t||1e5;for(var r=S(e),n=0,i=r.length;n<i;++n)r[n]/=t;return r}function x(e){for(var t=0,r=e.length;t<r;++t){var n=e[t];e[t]=n<0?~(n<<1):n<<1}return j(e)}function S(e){for(var t=O(e),r=0,n=t.length;r<n;++r){var i=t[r];t[r]=1&i?~(i>>1):i>>1}return t}function j(e){for(var t="",r=0,n=e.length;r<n;++r)t+=P(e[r]);return t}function O(e){for(var t=[],r=0,n=0,i=0,o=e.length;i<o;++i){var a=e.charCodeAt(i)-63;r|=(31&a)<<n,a<32?(t.push(r),n=r=0):n+=5}return t}function P(e){for(var t,r="";32<=e;)t=63+(32|31&e),r+=String.fromCharCode(t),e>>=5;return t=e+63,r+=String.fromCharCode(t)}r.default=e},{"../Feature.js":75,"../asserts.js":105,"../geom/LineString.js":194,"../geom/SimpleGeometry.js":201,"../geom/flat/flip.js":207,"../geom/flat/inflate.js":209,"../proj.js":271,"./Feature.js":136,"./TextFeature.js":151}],151:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../format/Feature.js"))&&n.__esModule?n:{default:n},o=e("../util.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(i);function i(){if(this instanceof i)return n.call(this);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getType",value:function(){return"text"}},{key:"readFeature",value:function(e,t){return this.readFeatureFromText(c(e),this.adaptOptions(t))}},{key:"readFeatureFromText",value:function(e,t){return(0,o.abstract)()}},{key:"readFeatures",value:function(e,t){return this.readFeaturesFromText(c(e),this.adaptOptions(t))}},{key:"readFeaturesFromText",value:function(e,t){return(0,o.abstract)()}},{key:"readGeometry",value:function(e,t){return this.readGeometryFromText(c(e),this.adaptOptions(t))}},{key:"readGeometryFromText",value:function(e,t){return(0,o.abstract)()}},{key:"readProjection",value:function(e){return this.readProjectionFromText(c(e))}},{key:"readProjectionFromText",value:function(e){return this.dataProjection}},{key:"writeFeature",value:function(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}},{key:"writeFeatureText",value:function(e,t){return(0,o.abstract)()}},{key:"writeFeatures",value:function(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}},{key:"writeFeaturesText",value:function(e,t){return(0,o.abstract)()}},{key:"writeGeometry",value:function(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}},{key:"writeGeometryText",value:function(e,t){return(0,o.abstract)()}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function c(e){return"string"==typeof e?e:""}r.default=e},{"../format/Feature.js":136,"../util.js":379}],152:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=d(e("../Feature.js")),n=d(e("./JSONFeature.js")),o=d(e("../geom/LineString.js")),a=d(e("../geom/MultiLineString.js")),s=d(e("../geom/MultiPoint.js")),l=d(e("../geom/MultiPolygon.js")),u=d(e("../geom/Point.js")),f=d(e("../geom/Polygon.js")),h=e("../proj.js"),p=e("./Feature.js");function d(e){return e&&e.__esModule?e:{default:e}}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e);var r,n=m(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).layerName_=(e=e||{}).layerName,t.layers_=e.layers||null,t.dataProjection=(0,h.get)(e.dataProjection||"EPSG:4326"),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFeaturesFromObject",value:function(e,t){if("Topology"!=e.type)return[];var r,n=null,i=null,o=(e.transform&&(n=(r=e.transform).scale,i=r.translate),e.arcs);if(r)for(var a=o,s=n,u=i,l=0,c=a.length;l<c;++l){v=m=g=y=d=p=h=f=void 0;for(var f=a[l],h=s,p=u,d=0,y=0,g=0,m=f.length;g<m;++g){var v=f[g];d+=v[0],y+=v[1],v[0]=d,v[1]=y,O(v,h,p)}}var b,_,w=[],x=e.objects,S=this.layerName_;for(_ in x)this.layers_&&!this.layers_.includes(_)||("GeometryCollection"===x[_].type?(b=x[_],w.push.apply(w,function(e,t,r,n,i,o,a){for(var s=e.geometries,u=[],l=0,c=s.length;l<c;++l)u[l]=j(s[l],t,r,n,i,o,a);return u}(b,o,n,i,S,_,t))):(b=x[_],w.push(j(b,o,n,i,S,_,t))));return w}},{key:"readProjectionFromObject",value:function(e){return this.dataProjection}}])&&y(t.prototype,e),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default),b={Point:function(e,t,r){e=e.coordinates;t&&r&&O(e,t,r);return new u.default(e)},LineString:function(e,t){e=_(e.arcs,t);return new o.default(e)},Polygon:function(e,t){for(var r=[],n=0,i=e.arcs.length;n<i;++n)r[n]=_(e.arcs[n],t);return new f.default(r)},MultiPoint:function(e,t,r){var n=e.coordinates;if(t&&r)for(var i=0,o=n.length;i<o;++i)O(n[i],t,r);return new s.default(n)},MultiLineString:function(e,t){for(var r=[],n=0,i=e.arcs.length;n<i;++n)r[n]=_(e.arcs[n],t);return new a.default(r)},MultiPolygon:function(e,t){for(var r=[],n=0,i=e.arcs.length;n<i;++n){for(var o=e.arcs[n],a=[],s=0,u=o.length;s<u;++s)a[s]=_(o[s],t);r[n]=a}return new l.default(r)}};function _(e,t){for(var r,n=[],i=0,o=e.length;i<o;++i)if(r=e[i],0<i&&n.pop(),0<=r)for(var a=t[r],s=0,u=a.length;s<u;++s)n.push(a[s].slice(0));else for(var l=t[~r],c=l.length-1;0<=c;--c)n.push(l[c].slice(0));return n}function j(e,t,r,n,i,o,a){var s,u=null,l=e.type,l=(l&&(s=b[l],u="Point"===l||"MultiPoint"===l?s(e,r,n):s(e,t),u=(0,p.transformGeometryWithOptions)(u,!1,a)),new c.default({geometry:u})),r=(void 0!==e.id&&l.setId(e.id),e.properties);return i&&((r=r||{})[i]=o),r&&l.setProperties(r,!0),l}function O(e,t,r){e[0]=e[0]*t[0]+r[0],e[1]=e[1]*t[1]+r[1]}r.default=e},{"../Feature.js":75,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../proj.js":271,"./Feature.js":136,"./JSONFeature.js":146}],153:[function(e,D,t){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.writeFilter=function(e,t){t=t||"1.1.0";var r=(0,y.createElementNS)(L(t),"Filter"),n={node:r};return Object.assign(n,{version:t,filter:e}),ee(r,e,[n]),r};var s=r(e("./GML2.js")),u=r(e("./GML3.js")),l=r(e("./GML32.js")),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./GMLBase.js")),F=r(e("./XMLFeature.js")),y=e("../xml.js"),o=e("./filter.js"),g=e("../asserts.js"),N=e("../proj.js"),c=e("./xsd.js");function f(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(f=function(e){return e?r:t})(e))}function r(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function B(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d={"http://www.opengis.net/gml":{boundedBy:(0,y.makeObjectPropertySetter)(n.default.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:(0,y.makeArrayPusher)(n.default.prototype.readFeaturesInternal)}},G={"http://www.opengis.net/wfs":{totalInserted:(0,y.makeObjectPropertySetter)(c.readPositiveInteger),totalUpdated:(0,y.makeObjectPropertySetter)(c.readPositiveInteger),totalDeleted:(0,y.makeObjectPropertySetter)(c.readPositiveInteger)},"http://www.opengis.net/wfs/2.0":{totalInserted:(0,y.makeObjectPropertySetter)(c.readPositiveInteger),totalUpdated:(0,y.makeObjectPropertySetter)(c.readPositiveInteger),totalDeleted:(0,y.makeObjectPropertySetter)(c.readPositiveInteger)}},U={"http://www.opengis.net/wfs":{TransactionSummary:(0,y.makeObjectPropertySetter)(P,"transactionSummary"),InsertResults:(0,y.makeObjectPropertySetter)(q,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:(0,y.makeObjectPropertySetter)(P,"transactionSummary"),InsertResults:(0,y.makeObjectPropertySetter)(q,"insertIds")}},z={"http://www.opengis.net/wfs":{PropertyName:(0,y.makeChildAppender)(c.writeStringTextNode)},"http://www.opengis.net/wfs/2.0":{PropertyName:(0,y.makeChildAppender)(c.writeStringTextNode)}},m={"http://www.opengis.net/wfs":{Insert:(0,y.makeChildAppender)(Y),Update:(0,y.makeChildAppender)(K),Delete:(0,y.makeChildAppender)(Z),Property:(0,y.makeChildAppender)($),Native:(0,y.makeChildAppender)(J)},"http://www.opengis.net/wfs/2.0":{Insert:(0,y.makeChildAppender)(Y),Update:(0,y.makeChildAppender)(K),Delete:(0,y.makeChildAppender)(Z),Property:(0,y.makeChildAppender)($),Native:(0,y.makeChildAppender)(J)}},v="feature",b="http://www.w3.org/2000/xmlns/",_={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},w={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},x={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},S={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},j={"2.0.0":l.default,"1.1.0":u.default,"1.0.0":s.default},e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=B(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).version_=(e=e||{}).version||"1.1.0",t.featureType_=e.featureType,t.featureNS_=e.featureNS,t.gmlFormat_=e.gmlFormat||new j[t.version_],t.schemaLocation_=e.schemaLocation||S[t.version_],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getFeatureType",value:function(){return this.featureType_}},{key:"setFeatureType",value:function(e){this.featureType_=e}},{key:"readFeaturesFromNode",value:function(e,t){var r={node:e},t=(Object.assign(r,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(r,this.getReadOptions(e,t||{})),[r]),r="2.0.0"===this.version_?d:this.gmlFormat_.FEATURE_COLLECTION_PARSERS;return(0,y.pushParseAndPop)([],r,e,t,this.gmlFormat_)||[]}},{key:"readTransactionResponse",value:function(e){var t;if(e)return"string"==typeof e?(t=(0,y.parse)(e),this.readTransactionResponseFromDocument(t)):(0,y.isDocument)(e)?this.readTransactionResponseFromDocument(e):this.readTransactionResponseFromNode(e)}},{key:"readFeatureCollectionMetadata",value:function(e){var t;if(e)return"string"==typeof e?(t=(0,y.parse)(e),this.readFeatureCollectionMetadataFromDocument(t)):(0,y.isDocument)(e)?this.readFeatureCollectionMetadataFromDocument(e):this.readFeatureCollectionMetadataFromNode(e)}},{key:"readFeatureCollectionMetadataFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)}},{key:"readFeatureCollectionMetadataFromNode",value:function(e){var t={},r=(0,c.readNonNegativeIntegerString)(e.getAttribute("numberOfFeatures"));return t.numberOfFeatures=r,(0,y.pushParseAndPop)(t,d,e,[],this.gmlFormat_)}},{key:"readTransactionResponseFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)}},{key:"readTransactionResponseFromNode",value:function(e){return(0,y.pushParseAndPop)({},U,e,[])}},{key:"writeGetFeature",value:function(r){var e,n=this,i=(0,y.createElementNS)(w[this.version_],"GetFeature"),o=(i.setAttribute("service","WFS"),i.setAttribute("version",this.version_),r.handle&&i.setAttribute("handle",r.handle),r.outputFormat&&i.setAttribute("outputFormat",r.outputFormat),void 0!==r.maxFeatures&&i.setAttribute("maxFeatures",String(r.maxFeatures)),r.resultType&&i.setAttribute("resultType",r.resultType),void 0!==r.startIndex&&i.setAttribute("startIndex",String(r.startIndex)),void 0!==r.count&&i.setAttribute("count",String(r.count)),void 0!==r.viewParams&&i.setAttribute("viewParams",r.viewParams),i.setAttributeNS(y.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",this.schemaLocation_),{node:i});return Object.assign(o,{version:this.version_,srsName:r.srsName,featureNS:r.featureNS||this.featureNS_,featurePrefix:r.featurePrefix,propertyNames:r.propertyNames||[]}),(0,g.assert)(Array.isArray(r.featureTypes),11),"string"==typeof r.featureTypes[0]?(e=r.filter,r.bbox&&((0,g.assert)(r.geometryName,12),e=this.combineBboxAndFilter(r.geometryName,r.bbox,r.srsName,e)),Object.assign(o,{geometryName:r.geometryName,filter:e}),le(i,r.featureTypes,[o])):r.featureTypes.forEach(function(e){var t=n.combineBboxAndFilter(e.geometryName,e.bbox,r.srsName,r.filter);Object.assign(o,{geometryName:e.geometryName,filter:t}),le(i,[e.name],[o])}),i}},{key:"combineBboxAndFilter",value:function(e,t,r,n){e=(0,o.bbox)(e,t,r);return n?(0,o.and)(n,e):e}},{key:"writeTransaction",value:function(e,t,r,n){var i=[],o=n.version||this.version_,a=(0,y.createElementNS)(w[o],"Transaction"),s=(a.setAttribute("service","WFS"),a.setAttribute("version",o),n&&(s=n.gmlOptions||{},n.handle)&&a.setAttribute("handle",n.handle),a.setAttributeNS(y.XML_SCHEMA_INSTANCE_URI,"xsi:schemaLocation",S[o]),function(e,t,r,n){var i,o=n.featurePrefix||v;"1.0.0"===r?i=2:"1.1.0"===r?i=3:"2.0.0"===r&&(i=3.2);return Object.assign({node:e},{version:r,featureNS:n.featureNS,featureType:n.featureType,featurePrefix:o,gmlVersion:i,hasZ:n.hasZ,srsName:n.srsName},t)}(a,s,o,n));return e&&O("Insert",e,i,s),t&&O("Update",t,i,s),r&&O("Delete",r,i,s),n.nativeElements&&O("Native",n.nativeElements,i,s),a}},{key:"readProjectionFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null}},{key:"readProjectionFromNode",value:function(e){if(e.firstElementChild&&e.firstElementChild.firstElementChild)for(var t,r=(e=e.firstElementChild.firstElementChild).firstElementChild;r;r=r.nextElementSibling)if(0!==r.childNodes.length&&(1!==r.childNodes.length||3!==r.firstChild.nodeType))return this.gmlFormat_.readGeometryElement(r,t=[{}]),(0,N.get)(t.pop().srsName);return null}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(F.default);function O(e,t,r,n){(0,y.pushSerializeAndPop)(n,m,(0,y.makeSimpleNodeFactory)(e),t,r)}function P(e,t){return(0,y.pushParseAndPop)({},G,e,t)}var W={"http://www.opengis.net/ogc":{FeatureId:(0,y.makeArrayPusher)(function(e,t){return e.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:(0,y.makeArrayPusher)(function(e,t){return e.getAttribute("fid")})}};function V(e,t){(0,y.parseNode)(W,e,t)}var H={"http://www.opengis.net/wfs":{Feature:V},"http://www.opengis.net/wfs/2.0":{Feature:V}};function q(e,t){return(0,y.pushParseAndPop)([],H,e,t)}function Y(e,t,r){var n=r[r.length-1],i=n.featureType,o=n.featureNS,n=n.gmlVersion,o=(0,y.createElementNS)(o,i);e.appendChild(o),(2===n?s:3===n?u:l).default.prototype.writeFeatureElement(o,t,r)}function X(e,t,r){var r=r[r.length-1].version,r=_[r],n=(0,y.createElementNS)(r,"Filter"),r=(0,y.createElementNS)(r,"FeatureId");n.appendChild(r),r.setAttribute("fid",t),e.appendChild(n)}function k(e,t){e=(e=e||v)+":";return t.startsWith(e)?t:e+t}function Z(e,t,r){var n=r[r.length-1],i=((0,g.assert)(void 0!==t.getId(),26),n.featureType),o=n.featurePrefix,n=n.featureNS,i=k(o,i),i=(e.setAttribute("typeName",i),e.setAttributeNS(b,"xmlns:"+o,n),t.getId());void 0!==i&&X(e,i,r)}function K(e,t,r){var n=r[r.length-1],i=((0,g.assert)(void 0!==t.getId(),27),n.version),o=n.featureType,a=n.featurePrefix,s=n.featureNS,o=k(a,o),u=t.getGeometryName(),o=(e.setAttribute("typeName",o),e.setAttributeNS(b,"xmlns:"+a,s),t.getId());if(void 0!==o){for(var l=t.getKeys(),c=[],f=0,h=l.length;f<h;f++){var p,d=t.get(l[f]);void 0!==d&&(p=l[f],d&&"function"==typeof d.getSimplifiedGeometry&&(p=u),c.push({name:p,value:d}))}(0,y.pushSerializeAndPop)({version:i,gmlVersion:n.gmlVersion,node:e,hasZ:n.hasZ,srsName:n.srsName},m,(0,y.makeSimpleNodeFactory)("Property"),c,r),X(e,o,r)}}function $(e,t,r){var n=r[r.length-1],i=n.version,i=w[i],o=(0,y.createElementNS)(i,"Name"),n=n.gmlVersion;e.appendChild(o),(0,c.writeStringTextNode)(o,t.name),void 0!==t.value&&null!==t.value&&(o=(0,y.createElementNS)(i,"Value"),e.appendChild(o),t.value&&"function"==typeof t.value.getSimplifiedGeometry?(2===n?s:3===n?u:l).default.prototype.writeGeometryElement(o,t.value,r):(0,c.writeStringTextNode)(o,t.value))}function J(e,t,r){t.vendorId&&e.setAttribute("vendorId",t.vendorId),void 0!==t.safeToIgnore&&e.setAttribute("safeToIgnore",String(t.safeToIgnore)),void 0!==t.value&&(0,c.writeStringTextNode)(e,t.value)}var E={"http://www.opengis.net/wfs":{Query:(0,y.makeChildAppender)(Q)},"http://www.opengis.net/wfs/2.0":{Query:(0,y.makeChildAppender)(Q)},"http://www.opengis.net/ogc":{During:(0,y.makeChildAppender)(ne),And:(0,y.makeChildAppender)(C),Or:(0,y.makeChildAppender)(C),Not:(0,y.makeChildAppender)(ie),BBOX:(0,y.makeChildAppender)(te),Contains:(0,y.makeChildAppender)(T),Intersects:(0,y.makeChildAppender)(T),Within:(0,y.makeChildAppender)(T),DWithin:(0,y.makeChildAppender)(re),PropertyIsEqualTo:(0,y.makeChildAppender)(R),PropertyIsNotEqualTo:(0,y.makeChildAppender)(R),PropertyIsLessThan:(0,y.makeChildAppender)(R),PropertyIsLessThanOrEqualTo:(0,y.makeChildAppender)(R),PropertyIsGreaterThan:(0,y.makeChildAppender)(R),PropertyIsGreaterThanOrEqualTo:(0,y.makeChildAppender)(R),PropertyIsNull:(0,y.makeChildAppender)(oe),PropertyIsBetween:(0,y.makeChildAppender)(ae),PropertyIsLike:(0,y.makeChildAppender)(se)},"http://www.opengis.net/fes/2.0":{During:(0,y.makeChildAppender)(ne),And:(0,y.makeChildAppender)(C),Or:(0,y.makeChildAppender)(C),Not:(0,y.makeChildAppender)(ie),BBOX:(0,y.makeChildAppender)(te),Contains:(0,y.makeChildAppender)(T),Disjoint:(0,y.makeChildAppender)(T),Intersects:(0,y.makeChildAppender)(T),ResourceId:(0,y.makeChildAppender)(function(e,t,r){e.setAttribute("rid",t.rid)}),Within:(0,y.makeChildAppender)(T),DWithin:(0,y.makeChildAppender)(re),PropertyIsEqualTo:(0,y.makeChildAppender)(R),PropertyIsNotEqualTo:(0,y.makeChildAppender)(R),PropertyIsLessThan:(0,y.makeChildAppender)(R),PropertyIsLessThanOrEqualTo:(0,y.makeChildAppender)(R),PropertyIsGreaterThan:(0,y.makeChildAppender)(R),PropertyIsGreaterThanOrEqualTo:(0,y.makeChildAppender)(R),PropertyIsNull:(0,y.makeChildAppender)(oe),PropertyIsBetween:(0,y.makeChildAppender)(ae),PropertyIsLike:(0,y.makeChildAppender)(se)}};function Q(e,t,r){var n=r[r.length-1],i=n.version,o=n.featurePrefix,a=n.featureNS,s=n.propertyNames,u=n.srsName,t=o?k(o,t):t,l="2.0.0"===i?"typeNames":"typeName",l=(e.setAttribute(l,t),u&&e.setAttribute("srsName",u),a&&e.setAttributeNS(b,"xmlns:"+o,a),Object.assign({},n)),t=(l.node=e,(0,y.pushSerializeAndPop)(l,z,(0,y.makeSimpleNodeFactory)("PropertyName"),s,r),n.filter);t&&(u=(0,y.createElementNS)(L(i),"Filter"),e.appendChild(u),ee(u,t,r))}function ee(e,t,r){var n=r[r.length-1],e={node:e};Object.assign(e,{context:n}),(0,y.pushSerializeAndPop)(e,E,(0,y.makeSimpleNodeFactory)(t.getTagName()),[t],r)}function te(e,t,r){var n=r[r.length-1],i=n.context.version,n=(n.srsName=t.srsName,j[i]);A(i,e,t.geometryName),n.prototype.writeGeometryElement(e,t.extent,r)}function T(e,t,r){var n=r[r.length-1],i=n.context.version,n=(n.srsName=t.srsName,j[i]);A(i,e,t.geometryName),n.prototype.writeGeometryElement(e,t.geometry,r)}function re(e,t,r){var n=r[r.length-1].context.version,r=(T(e,t,r),(0,y.createElementNS)(L(n),"Distance"));(0,c.writeStringTextNode)(r,t.distance.toString()),"2.0.0"===n?r.setAttribute("uom",t.unit):r.setAttribute("units",t.unit),e.appendChild(r)}function ne(e,t,r){r=r[r.length-1].context.version,M(x[r],"ValueReference",e,t.propertyName),r=(0,y.createElementNS)(n.GMLNS,"TimePeriod"),e.appendChild(r),e=(0,y.createElementNS)(n.GMLNS,"begin"),r.appendChild(e),ue(e,t.begin),e=(0,y.createElementNS)(n.GMLNS,"end");r.appendChild(e),ue(e,t.end)}function C(e,t,r){for(var n=r[r.length-1].context,i={node:e},o=(Object.assign(i,{context:n}),t.conditions),a=0,s=o.length;a<s;++a){var u=o[a];(0,y.pushSerializeAndPop)(i,E,(0,y.makeSimpleNodeFactory)(u.getTagName()),[u],r)}}function ie(e,t,r){var n=r[r.length-1].context,e={node:e},n=(Object.assign(e,{context:n}),t.condition);(0,y.pushSerializeAndPop)(e,E,(0,y.makeSimpleNodeFactory)(n.getTagName()),[n],r)}function R(e,t,r){r=r[r.length-1].context.version;void 0!==t.matchCase&&e.setAttribute("matchCase",t.matchCase.toString()),A(r,e,t.propertyName),I(r,e,""+t.expression)}function oe(e,t,r){A(r[r.length-1].context.version,e,t.propertyName)}function ae(e,t,r){var r=r[r.length-1].context.version,n=L(r),i=(A(r,e,t.propertyName),(0,y.createElementNS)(n,"LowerBoundary")),i=(e.appendChild(i),I(r,i,""+t.lowerBoundary),(0,y.createElementNS)(n,"UpperBoundary"));e.appendChild(i),I(r,i,""+t.upperBoundary)}function se(e,t,r){r=r[r.length-1].context.version;e.setAttribute("wildCard",t.wildCard),e.setAttribute("singleChar",t.singleChar),e.setAttribute("escapeChar",t.escapeChar),void 0!==t.matchCase&&e.setAttribute("matchCase",t.matchCase.toString()),A(r,e,t.propertyName),I(r,e,""+t.pattern)}function M(e,t,r,n){e=(0,y.createElementNS)(e,t);(0,c.writeStringTextNode)(e,n),r.appendChild(e)}function I(e,t,r){M(L(e),"Literal",t,r)}function A(e,t,r){"2.0.0"===e?M(x[e],"ValueReference",t,r):M(_[e],"PropertyName",t,r)}function ue(e,t){var r=(0,y.createElementNS)(n.GMLNS,"TimeInstant"),e=(e.appendChild(r),(0,y.createElementNS)(n.GMLNS,"timePosition"));r.appendChild(e),(0,c.writeStringTextNode)(e,t)}function le(e,t,r){var n=r[r.length-1],n=Object.assign({},n);n.node=e,(0,y.pushSerializeAndPop)(n,E,(0,y.makeSimpleNodeFactory)("Query"),t,r)}function L(e){e=("2.0.0"===e?x:_)[e];return e}t.default=e},{"../asserts.js":105,"../proj.js":271,"../xml.js":391,"./GML2.js":138,"./GML3.js":139,"./GML32.js":140,"./GMLBase.js":141,"./XMLFeature.js":160,"./filter.js":161,"./xsd.js":188}],154:[function(e,D,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=d(e("../Feature.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==b(e)&&"function"!=typeof e)return{default:e};t=p(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Feature.js")),a=d(e("../geom/GeometryCollection.js")),r=d(e("../geom/LineString.js")),n=d(e("../geom/MultiLineString.js")),s=d(e("../geom/MultiPoint.js")),u=d(e("../geom/MultiPolygon.js")),l=d(e("../geom/Point.js")),c=d(e("../geom/Polygon.js")),f=e("../proj.js"),h=d(e("../geom/SimpleGeometry.js"));function p(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(p=function(e){return e?r:t})(e))}function d(e){return e&&e.__esModule?e:{default:e}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(r),t=(e=n?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=function(e,t){var r;if(e)return"string"==typeof e?v(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function x(e,t,r){t&&w(e.prototype,t),r&&w(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function S(e){e=function(e,t){if("object"!==b(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===b(e)?e:String(e)}var j=1,O=2,P=3,k=4,E=5,T=6,C=7,R=15,M=16,I=17,A=function(){function t(e){_(this,t),this.view_=e,this.pos_=0,this.initialized_=!1,this.isLittleEndian_=!1,this.hasZ_=!1,this.hasM_=!1,this.srid_=null,this.layout_="XY"}return x(t,[{key:"readUint8",value:function(){return this.view_.getUint8(this.pos_++)}},{key:"readUint32",value:function(e){return this.view_.getUint32((this.pos_+=4)-4,void 0!==e?e:this.isLittleEndian_)}},{key:"readDouble",value:function(e){return this.view_.getFloat64((this.pos_+=8)-8,void 0!==e?e:this.isLittleEndian_)}},{key:"readPoint",value:function(){var e=[];return e.push(this.readDouble()),e.push(this.readDouble()),this.hasZ_&&e.push(this.readDouble()),this.hasM_&&e.push(this.readDouble()),e}},{key:"readLineString",value:function(){for(var e=this.readUint32(),t=[],r=0;r<e;r++)t.push(this.readPoint());return t}},{key:"readPolygon",value:function(){for(var e=this.readUint32(),t=[],r=0;r<e;r++)t.push(this.readLineString());return t}},{key:"readWkbHeader",value:function(e){var t=0<this.readUint8(),r=this.readUint32(t),n=Math.floor((268435455&r)/1e3),i=Boolean(2147483648&r)||1===n||3===n,n=Boolean(1073741824&r)||2===n||3===n,o=Boolean(536870912&r),r=(268435455&r)%1e3,a=["XY",i?"Z":"",n?"M":""].join(""),o=o?this.readUint32(t):null;if(void 0!==e&&e!==r)throw new Error("Unexpected WKB geometry type "+r);if(this.initialized_){if(this.isLittleEndian_!==t)throw new Error("Inconsistent endian");if(this.layout_!==a)throw new Error("Inconsistent geometry layout");if(o&&this.srid_!==o)throw new Error("Inconsistent coordinate system (SRID)")}else this.isLittleEndian_=t,this.hasZ_=i,this.hasM_=n,this.layout_=a,this.srid_=o,this.initialized_=!0;return r}},{key:"readWkbPayload",value:function(e){switch(e){case j:return this.readPoint();case O:return this.readLineString();case P:case I:return this.readPolygon();case k:return this.readMultiPoint();case E:return this.readMultiLineString();case T:case R:case M:return this.readMultiPolygon();case C:return this.readGeometryCollection();default:throw new Error("Unsupported WKB geometry type "+e+" is found")}}},{key:"readWkbBlock",value:function(e){return this.readWkbPayload(this.readWkbHeader(e))}},{key:"readWkbCollection",value:function(e,t){for(var r=this.readUint32(),n=[],i=0;i<r;i++){var o=e.call(this,t);o&&n.push(o)}return n}},{key:"readMultiPoint",value:function(){return this.readWkbCollection(this.readWkbBlock,j)}},{key:"readMultiLineString",value:function(){return this.readWkbCollection(this.readWkbBlock,O)}},{key:"readMultiPolygon",value:function(){return this.readWkbCollection(this.readWkbBlock,P)}},{key:"readGeometryCollection",value:function(){return this.readWkbCollection(this.readGeometry)}},{key:"readGeometry",value:function(){var e=this.readWkbHeader(),t=this.readWkbPayload(e);switch(e){case j:return new l.default(t,this.layout_);case O:return new r.default(t,this.layout_);case P:case I:return new c.default(t,this.layout_);case k:return new s.default(t,this.layout_);case E:return new n.default(t,this.layout_);case T:case R:case M:return new u.default(t,this.layout_);case C:return new a.default(t);default:return null}}},{key:"getSrid",value:function(){return this.srid_}}]),t}(),N=function(){function t(e){_(this,t),this.layout_=(e=e||{}).layout,this.isLittleEndian_=!1!==e.littleEndian,this.isEWKB_=!1!==e.ewkb,this.writeQueue_=[],this.nodata_=Object.assign({X:0,Y:0,Z:0,M:0},e.nodata)}return x(t,[{key:"writeUint8",value:function(e){this.writeQueue_.push([1,e])}},{key:"writeUint32",value:function(e){this.writeQueue_.push([4,e])}},{key:"writeDouble",value:function(e){this.writeQueue_.push([8,e])}},{key:"writePoint",value:function(n,e){var t,r=Object.assign.apply(null,e.split("").map(function(e,t){return r={},e=e,t=n[t],(e=S(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r;var r})),i=F(this.layout_);try{for(i.s();!(t=i.n()).done;){var o=t.value;this.writeDouble((o in r?r:this.nodata_)[o])}}catch(e){i.e(e)}finally{i.f()}}},{key:"writeLineString",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writePoint(e[r],t)}},{key:"writePolygon",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeLineString(e[r],t)}},{key:"writeWkbHeader",value:function(e,t){e%=1e3,this.layout_.includes("Z")&&(e+=this.isEWKB_?2147483648:1e3),this.layout_.includes("M")&&(e+=this.isEWKB_?1073741824:2e3),this.isEWKB_&&Number.isInteger(t)&&(e|=536870912),this.writeUint8(this.isLittleEndian_?1:0),this.writeUint32(e),this.isEWKB_&&Number.isInteger(t)&&this.writeUint32(t)}},{key:"writeMultiPoint",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeWkbHeader(1),this.writePoint(e[r],t)}},{key:"writeMultiLineString",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeWkbHeader(2),this.writeLineString(e[r],t)}},{key:"writeMultiPolygon",value:function(e,t){this.writeUint32(e.length);for(var r=0;r<e.length;r++)this.writeWkbHeader(3),this.writePolygon(e[r],t)}},{key:"writeGeometryCollection",value:function(e){this.writeUint32(e.length);for(var t=0;t<e.length;t++)this.writeGeometry(e[t])}},{key:"findMinimumLayout",value:function(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"XYZM";if(e instanceof h.default)return(t=e.getLayout())===(r=n)?t:"XYZM"===t?r:"XYZM"===r?t:"XY";if(e instanceof a.default)for(var i=e.getGeometriesArray(),o=0;o<i.length&&"XY"!==n;o++)n=this.findMinimumLayout(i[o],n);return n}},{key:"writeGeometry",value:function(e,t){var r={Point:j,LineString:O,Polygon:P,MultiPoint:k,MultiLineString:E,MultiPolygon:T,GeometryCollection:C},n=e.getType(),r=r[n];if(!r)throw new Error("GeometryType "+n+" is not supported");this.layout_||(this.layout_=this.findMinimumLayout(e)),this.writeWkbHeader(r,t),e instanceof h.default?{Point:this.writePoint,LineString:this.writeLineString,Polygon:this.writePolygon,MultiPoint:this.writeMultiPoint,MultiLineString:this.writeMultiLineString,MultiPolygon:this.writeMultiPolygon}[n].call(this,e.getCoordinates(),e.getLayout()):e instanceof a.default&&this.writeGeometryCollection(e.getGeometriesArray())}},{key:"getBuffer",value:function(){var t=this,e=this.writeQueue_.reduce(function(e,t){return e+t[0]},0),e=new ArrayBuffer(e),r=new DataView(e),n=0;return this.writeQueue_.forEach(function(e){switch(e[0]){case 1:r.setUint8(n,e[1]);break;case 4:r.setUint32(n,e[1],t.isLittleEndian_);break;case 8:r.setFloat64(n,e[1],t.isLittleEndian_)}n+=e[0]}),e}}]),t}(),e=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r=g(n);function n(e){var t;return _(this,n),e=e||{},(t=r.call(this)).splitCollection=Boolean(e.splitCollection),t.viewCache_=null,t.hex_=!1!==e.hex,t.littleEndian_=!1!==e.littleEndian,t.ewkb_=!1!==e.ewkb,t.layout_=e.geometryLayout,t.nodataZ_=e.nodataZ||0,t.nodataM_=e.nodataM||0,t.srid_=e.srid,t}return x(n,[{key:"getType",value:function(){return this.hex_?"text":"arraybuffer"}},{key:"readFeature",value:function(e,t){return new i.default({geometry:this.readGeometry(e,t)})}},{key:"readFeatures",value:function(e,t){e=this.readGeometry(e,t);return(this.splitCollection&&e instanceof a.default?e.getGeometriesArray():[e]).map(function(e){return new i.default({geometry:e})})}},{key:"readGeometry",value:function(e,t){var r,n=L(e);return n?(r=new A(n).readGeometry(),this.viewCache_=n,t=this.getReadOptions(e,t),(this.viewCache_=null,o.transformGeometryWithOptions)(r,!1,t)):null}},{key:"readProjection",value:function(e){var e=this.viewCache_||L(e);if(e)return(e=new A(e)).readWkbHeader(),e.getSrid()&&(0,f.get)("EPSG:"+e.getSrid())||void 0}},{key:"writeFeature",value:function(e,t){return this.writeGeometry(e.getGeometry(),t)}},{key:"writeFeatures",value:function(e,t){return this.writeGeometry(new a.default(e.map(function(e){return e.getGeometry()})),t)}},{key:"writeGeometry",value:function(e,t){t=this.adaptOptions(t);var r=new N({layout:this.layout_,littleEndian:this.littleEndian_,ewkb:this.ewkb_,nodata:{Z:this.nodataZ_,M:this.nodataM_}}),n=Number.isInteger(this.srid_)?Number(this.srid_):null,i=(!1===this.srid_||Number.isInteger(this.srid_)||(i=t.dataProjection&&(0,f.get)(t.dataProjection))&&(i=i.getCode()).startsWith("EPSG:")&&(n=Number(i.substring(5))),r.writeGeometry((0,o.transformGeometryWithOptions)(e,!0,t),n),r.getBuffer());return this.hex_?(e=i,e=new Uint8Array(i),Array.from(e.values()).map(function(e){return(e<16?"0":"")+Number(e).toString(16).toUpperCase()}).join("")):i}}]),n}(o.default);function L(e){if("string"!=typeof e)return ArrayBuffer.isView(e)?e instanceof DataView?e:new DataView(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new DataView(e):null;for(var t=e,r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.substr(2*n,2),16);return new DataView(r.buffer)}t.default=e},{"../Feature.js":75,"../geom/GeometryCollection.js":193,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../geom/SimpleGeometry.js":201,"../proj.js":271,"./Feature.js":136}],155:[function(e,D,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=h(e("../Feature.js")),a=h(e("../geom/GeometryCollection.js")),r=h(e("../geom/LineString.js")),n=h(e("../geom/MultiLineString.js")),i=h(e("../geom/MultiPoint.js")),o=h(e("../geom/MultiPolygon.js")),u=h(e("../geom/Point.js")),l=h(e("../geom/Polygon.js")),c=h(e("./TextFeature.js")),f=e("./Feature.js");function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==g(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===g(e)?e:String(e)}(n.key),n)}}function b(e,t,r){t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1})}var _={POINT:u.default,LINESTRING:r.default,POLYGON:l.default,MULTIPOINT:i.default,MULTILINESTRING:n.default,MULTIPOLYGON:o.default},w="Z",x="M",S=0,j=1,O=2,P=3,k=4,E=5,T=6,C={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"},R=function(){function t(e){m(this,t),this.wkt=e,this.index_=-1}return b(t,[{key:"isAlpha_",value:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"}},{key:"isNumeric_",value:function(e,t){return t=void 0!==t&&t,"0"<=e&&e<="9"||"."==e&&!t}},{key:"isWhiteSpace_",value:function(e){return" "==e||"\t"==e||"\r"==e||"\n"==e}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var e,t=this.nextChar_(),r=this.index_,n=t;if("("==t)e=O;else if(","==t)e=E;else if(")"==t)e=P;else if(this.isNumeric_(t)||"-"==t)e=k,n=this.readNumber_();else if(this.isAlpha_(t))e=j,n=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);e=T}return{position:r,value:n,type:e}}},{key:"readNumber_",value:function(){for(var e,t=this.index_,r=!1,n=!1;"."==e?r=!0:"e"!=e&&"E"!=e||(n=!0),e=this.nextChar_(),this.isNumeric_(e,r)||!n&&("e"==e||"E"==e)||n&&("-"==e||"+"==e););return parseFloat(this.wkt.substring(t,this.index_--))}},{key:"readText_",value:function(){for(var e,t=this.index_;e=this.nextChar_(),this.isAlpha_(e););return this.wkt.substring(t,this.index_--).toUpperCase()}}]),t}(),F=function(){function t(e){m(this,t),this.lexer_=e,this.token_={position:0,type:S},this.layout_="XY"}return b(t,[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(e){return this.token_.type==e}},{key:"match",value:function(e){e=this.isTokenType(e);return e&&this.consume_(),e}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var e="XY",t=this.token_;return this.isTokenType(j)&&((t=t.value)===w?e="XYZ":t===x?e="XYM":"ZM"===t&&(e="XYZM"),"XY"!==e)&&this.consume_(),e}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(O)){for(var e=[];e.push(this.parseGeometry_()),this.match(E););if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(O)){var e=this.parsePoint_();if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(O)){var e=this.parsePointList_();if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(O)){var e=this.parseLineStringTextList_();if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){if(this.match(O)){var e=this.token_.type==O?this.parsePointTextList_():this.parsePointList_();if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(O)){var e=this.parseLineStringTextList_();if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(O)){var e=this.parsePolygonTextList_();if(this.match(P))return e}throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var e=[],t=this.layout_.length,r=0;r<t;++r){var n=this.token_;if(!this.match(k))break;e.push(n.value)}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var e=[this.parsePoint_()];this.match(E);)e.push(this.parsePoint_());return e}},{key:"parsePointTextList_",value:function(){for(var e=[this.parsePointText_()];this.match(E);)e.push(this.parsePointText_());return e}},{key:"parseLineStringTextList_",value:function(){for(var e=[this.parseLineStringText_()];this.match(E);)e.push(this.parseLineStringText_());return e}},{key:"parsePolygonTextList_",value:function(){for(var e=[this.parsePolygonText_()];this.match(E);)e.push(this.parsePolygonText_());return e}},{key:"isEmptyGeometry_",value:function(){var e=this.isTokenType(j)&&"EMPTY"==this.token_.value;return e&&this.consume_(),e}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var e=this.token_;if(this.match(j)){var e=e.value,t=(this.layout_=this.parseGeometryLayout_(),this.isEmptyGeometry_());if("GEOMETRYCOLLECTION"==e)return t?new a.default([]):(n=this.parseGeometryCollectionText_(),new a.default(n));var r,n=_[e];if(!n)throw new Error("Invalid geometry type: "+e);if(t)r="POINT"==e?[NaN,NaN]:[];else switch(e){case"POINT":r=this.parsePointText_();break;case"LINESTRING":r=this.parseLineStringText_();break;case"POLYGON":r=this.parsePolygonText_();break;case"MULTIPOINT":r=this.parseMultiPointText_();break;case"MULTILINESTRING":r=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":r=this.parseMultiPolygonText_()}return new n(r,this.layout_)}throw new Error(this.formatErrorMessage_())}}]),t}(),e=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r=d(n);function n(e){var t;return m(this,n),(t=r.call(this)).splitCollection_=void 0!==(e=e||{}).splitCollection&&e.splitCollection,t}return b(n,[{key:"parse_",value:function(e){e=new R(e);return new F(e).parse()}},{key:"readFeatureFromText",value:function(e,t){e=this.readGeometryFromText(e,t),t=new s.default;return t.setGeometry(e),t}},{key:"readFeaturesFromText",value:function(e,t){for(var r=[],e=this.readGeometryFromText(e,t),n=[],i=0,o=(r=this.splitCollection_&&"GeometryCollection"==e.getType()?e.getGeometriesArray():[e]).length;i<o;++i){var a=new s.default;a.setGeometry(r[i]),n.push(a)}return n}},{key:"readGeometryFromText",value:function(e,t){e=this.parse_(e);return(0,f.transformGeometryWithOptions)(e,!1,t)}},{key:"writeFeatureText",value:function(e,t){e=e.getGeometry();return e?this.writeGeometryText(e,t):""}},{key:"writeFeaturesText",value:function(e,t){if(1==e.length)return this.writeFeatureText(e[0],t);for(var r=[],n=0,i=e.length;n<i;++n)r.push(e[n].getGeometry());var o=new a.default(r);return this.writeGeometryText(o,t)}},{key:"writeGeometryText",value:function(e,t){return L((0,f.transformGeometryWithOptions)(e,!0,t))}}]),n}(c.default);function M(e){e=e.getCoordinates();return 0===e.length?"":e.join(" ")}function I(e){for(var t=e.getCoordinates(),r=[],n=0,i=t.length;n<i;++n)r.push(t[n].join(" "));return r.join(",")}function A(e){for(var t=[],r=e.getLinearRings(),n=0,i=r.length;n<i;++n)t.push("("+I(r[n])+")");return t.join(",")}var N={Point:M,LineString:I,Polygon:A,MultiPoint:function(e){for(var t=[],r=e.getPoints(),n=0,i=r.length;n<i;++n)t.push("("+M(r[n])+")");return t.join(",")},MultiLineString:function(e){for(var t=[],r=e.getLineStrings(),n=0,i=r.length;n<i;++n)t.push("("+I(r[n])+")");return t.join(",")},MultiPolygon:function(e){for(var t=[],r=e.getPolygons(),n=0,i=r.length;n<i;++n)t.push("("+A(r[n])+")");return t.join(",")},GeometryCollection:function(e){for(var t=[],r=e.getGeometries(),n=0,i=r.length;n<i;++n)t.push(L(r[n]));return t.join(",")}};function L(e){var t,r=e.getType(),n=(0,N[r])(e),r=C[r];return"function"==typeof e.getFlatCoordinates&&(e=(e=e).getLayout(),t="","XYZ"!==e&&"XYZM"!==e||(t+=w),"XYM"!==e&&"XYZM"!==e||(t+=x),0<t.length)&&(r+=" "+t),0===n.length?r+" EMPTY":r+"("+n+")"}t.default=e},{"../Feature.js":75,"../geom/GeometryCollection.js":193,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"./Feature.js":136,"./TextFeature.js":151}],156:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./XML.js"))&&n.__esModule?n:{default:n},o=e("../xml.js"),a=e("./xsd.js"),e=e("./xlink.js");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=[null,"http://www.opengis.net/wms"],h=(0,o.makeStructureNS)(f,{Service:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},d,e,t)}),Capability:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},p,e,t)})}),p=(0,o.makeStructureNS)(f,{Request:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},x,e,t)}),Exception:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)([],v,e,t)}),Layer:(0,o.makeObjectPropertySetter)(function(e,t){var r=(0,o.pushParseAndPop)({},b,e,t);return void 0!==r.Layer?r:Object.assign(r,T(e,t))})}),n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(){var e;if(this instanceof i)return(e=n.call(this)).version=void 0,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFromNode",value:function(e){this.version=e.getAttribute("version").trim();e=(0,o.pushParseAndPop)({version:this.version},h,e,[]);return e||null}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default),d=(0,o.makeStructureNS)(f,{Name:(0,o.makeObjectPropertySetter)(a.readString),Title:(0,o.makeObjectPropertySetter)(a.readString),Abstract:(0,o.makeObjectPropertySetter)(a.readString),KeywordList:(0,o.makeObjectPropertySetter)(I),OnlineResource:(0,o.makeObjectPropertySetter)(e.readHref),ContactInformation:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},y,e,t)}),Fees:(0,o.makeObjectPropertySetter)(a.readString),AccessConstraints:(0,o.makeObjectPropertySetter)(a.readString),LayerLimit:(0,o.makeObjectPropertySetter)(a.readPositiveInteger),MaxWidth:(0,o.makeObjectPropertySetter)(a.readPositiveInteger),MaxHeight:(0,o.makeObjectPropertySetter)(a.readPositiveInteger)}),y=(0,o.makeStructureNS)(f,{ContactPersonPrimary:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},g,e,t)}),ContactPosition:(0,o.makeObjectPropertySetter)(a.readString),ContactAddress:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},m,e,t)}),ContactVoiceTelephone:(0,o.makeObjectPropertySetter)(a.readString),ContactFacsimileTelephone:(0,o.makeObjectPropertySetter)(a.readString),ContactElectronicMailAddress:(0,o.makeObjectPropertySetter)(a.readString)}),g=(0,o.makeStructureNS)(f,{ContactPerson:(0,o.makeObjectPropertySetter)(a.readString),ContactOrganization:(0,o.makeObjectPropertySetter)(a.readString)}),m=(0,o.makeStructureNS)(f,{AddressType:(0,o.makeObjectPropertySetter)(a.readString),Address:(0,o.makeObjectPropertySetter)(a.readString),City:(0,o.makeObjectPropertySetter)(a.readString),StateOrProvince:(0,o.makeObjectPropertySetter)(a.readString),PostCode:(0,o.makeObjectPropertySetter)(a.readString),Country:(0,o.makeObjectPropertySetter)(a.readString)}),v=(0,o.makeStructureNS)(f,{Format:(0,o.makeArrayPusher)(a.readString)}),b=(0,o.makeStructureNS)(f,{Name:(0,o.makeObjectPropertySetter)(a.readString),Title:(0,o.makeObjectPropertySetter)(a.readString),Abstract:(0,o.makeObjectPropertySetter)(a.readString),KeywordList:(0,o.makeObjectPropertySetter)(I),CRS:(0,o.makeObjectPropertyPusher)(a.readString),EX_GeographicBoundingBox:(0,o.makeObjectPropertySetter)(function(e,t){e=(0,o.pushParseAndPop)({},w,e,t);if(!e)return;var t=e.westBoundLongitude,r=e.southBoundLatitude,n=e.eastBoundLongitude,e=e.northBoundLatitude;if(void 0!==t&&void 0!==r&&void 0!==n&&void 0!==e)return[t,r,n,e]}),BoundingBox:(0,o.makeObjectPropertyPusher)(function(e,t){var r=[(0,a.readDecimalString)(e.getAttribute("minx")),(0,a.readDecimalString)(e.getAttribute("miny")),(0,a.readDecimalString)(e.getAttribute("maxx")),(0,a.readDecimalString)(e.getAttribute("maxy"))],n=[(0,a.readDecimalString)(e.getAttribute("resx")),(0,a.readDecimalString)(e.getAttribute("resy"))];return{crs:e.getAttribute("CRS"),extent:r,res:n}}),Dimension:(0,o.makeObjectPropertyPusher)(function(e,t){return{name:e.getAttribute("name"),units:e.getAttribute("units"),unitSymbol:e.getAttribute("unitSymbol"),default:e.getAttribute("default"),multipleValues:(0,a.readBooleanString)(e.getAttribute("multipleValues")),nearestValue:(0,a.readBooleanString)(e.getAttribute("nearestValue")),current:(0,a.readBooleanString)(e.getAttribute("current")),values:(0,a.readString)(e)}}),Attribution:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},_,e,t)}),AuthorityURL:(0,o.makeObjectPropertyPusher)(function(e,t){t=C(e,t);if(t)return t.name=e.getAttribute("name"),t;return}),Identifier:(0,o.makeObjectPropertyPusher)(a.readString),MetadataURL:(0,o.makeObjectPropertyPusher)(function(e,t){t=C(e,t);if(t)return t.type=e.getAttribute("type"),t;return}),DataURL:(0,o.makeObjectPropertyPusher)(C),FeatureListURL:(0,o.makeObjectPropertyPusher)(C),Style:(0,o.makeObjectPropertyPusher)(function(e,t){return(0,o.pushParseAndPop)({},P,e,t)}),MinScaleDenominator:(0,o.makeObjectPropertySetter)(a.readDecimal),MaxScaleDenominator:(0,o.makeObjectPropertySetter)(a.readDecimal),Layer:(0,o.makeObjectPropertyPusher)(T)}),_=(0,o.makeStructureNS)(f,{Title:(0,o.makeObjectPropertySetter)(a.readString),OnlineResource:(0,o.makeObjectPropertySetter)(e.readHref),LogoURL:(0,o.makeObjectPropertySetter)(M)}),w=(0,o.makeStructureNS)(f,{westBoundLongitude:(0,o.makeObjectPropertySetter)(a.readDecimal),eastBoundLongitude:(0,o.makeObjectPropertySetter)(a.readDecimal),southBoundLatitude:(0,o.makeObjectPropertySetter)(a.readDecimal),northBoundLatitude:(0,o.makeObjectPropertySetter)(a.readDecimal)}),x=(0,o.makeStructureNS)(f,{GetCapabilities:(0,o.makeObjectPropertySetter)(R),GetMap:(0,o.makeObjectPropertySetter)(R),GetFeatureInfo:(0,o.makeObjectPropertySetter)(R)}),S=(0,o.makeStructureNS)(f,{Format:(0,o.makeObjectPropertyPusher)(a.readString),DCPType:(0,o.makeObjectPropertyPusher)(function(e,t){return(0,o.pushParseAndPop)({},j,e,t)})}),j=(0,o.makeStructureNS)(f,{HTTP:(0,o.makeObjectPropertySetter)(function(e,t){return(0,o.pushParseAndPop)({},O,e,t)})}),O=(0,o.makeStructureNS)(f,{Get:(0,o.makeObjectPropertySetter)(C),Post:(0,o.makeObjectPropertySetter)(C)}),P=(0,o.makeStructureNS)(f,{Name:(0,o.makeObjectPropertySetter)(a.readString),Title:(0,o.makeObjectPropertySetter)(a.readString),Abstract:(0,o.makeObjectPropertySetter)(a.readString),LegendURL:(0,o.makeObjectPropertyPusher)(M),StyleSheetURL:(0,o.makeObjectPropertySetter)(C),StyleURL:(0,o.makeObjectPropertySetter)(C)}),k=(0,o.makeStructureNS)(f,{Format:(0,o.makeObjectPropertySetter)(a.readString),OnlineResource:(0,o.makeObjectPropertySetter)(e.readHref)}),E=(0,o.makeStructureNS)(f,{Keyword:(0,o.makeArrayPusher)(a.readString)});function T(e,t){var r=t[t.length-1],n=(0,o.pushParseAndPop)({},b,e,t);if(n)return void 0===(t=(0,a.readBooleanString)(e.getAttribute("queryable")))&&(t=r.queryable),n.queryable=void 0!==t&&t,void 0===(t=(0,a.readNonNegativeIntegerString)(e.getAttribute("cascaded")))&&(t=r.cascaded),n.cascaded=t,void 0===(t=(0,a.readBooleanString)(e.getAttribute("opaque")))&&(t=r.opaque),n.opaque=void 0!==t&&t,void 0===(t=(0,a.readBooleanString)(e.getAttribute("noSubsets")))&&(t=r.noSubsets),n.noSubsets=void 0!==t&&t,t=(t=(0,a.readDecimalString)(e.getAttribute("fixedWidth")))||r.fixedWidth,n.fixedWidth=t,t=(t=(0,a.readDecimalString)(e.getAttribute("fixedHeight")))||r.fixedHeight,n.fixedHeight=t,["Style","CRS","AuthorityURL"].forEach(function(e){var t;e in r&&(t=n[e]||[],n[e]=t.concat(r[e]))}),["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(e){var t;e in n||(t=r[e],n[e]=t)}),n}function C(e,t){return(0,o.pushParseAndPop)({},k,e,t)}function R(e,t){return(0,o.pushParseAndPop)({},S,e,t)}function M(e,t){t=C(e,t);if(t)return e=[(0,a.readNonNegativeIntegerString)(e.getAttribute("width")),(0,a.readNonNegativeIntegerString)(e.getAttribute("height"))],t.size=e,t}function I(e,t){return(0,o.pushParseAndPop)([],E,e,t)}r.default=n},{"../xml.js":391,"./XML.js":159,"./xlink.js":187,"./xsd.js":188}],157:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("./GML2.js")),n=a(e("./XMLFeature.js")),c=e("../array.js"),f=e("../xml.js");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).featureNS_="http://mapserver.gis.umn.edu/mapserver",t.gmlFormat_=new o.default,t.layers_=e.layers||null,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getLayers",value:function(){return this.layers_}},{key:"setLayers",value:function(e){this.layers_=e}},{key:"readFeatures_",value:function(e,t){e.setAttribute("namespaceURI",this.featureNS_);var r=e.localName,n=[];if(0!==e.childNodes.length){if("msGMLOutput"==r)for(var i=0,o=e.childNodes.length;i<o;i++){var a,s,u,l=e.childNodes[i];l.nodeType===Node.ELEMENT_NODE&&(a=t[0],s=(l=l).localName.replace("_layer",""),(!this.layers_||this.layers_.includes(s))&&(a.featureType=s=s+"_feature",a.featureNS=this.featureNS_,(u={})[s]=(0,f.makeArrayPusher)(this.gmlFormat_.readFeatureElement,this.gmlFormat_),s=(0,f.makeStructureNS)([a.featureNS,null],u),l.setAttribute("namespaceURI",this.featureNS_),u=(0,f.pushParseAndPop)([],s,l,t,this.gmlFormat_)))&&(0,c.extend)(n,u)}"FeatureCollection"==r&&(r=(0,f.pushParseAndPop)([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,e,[{}],this.gmlFormat_))&&(n=r)}return n}},{key:"readFeaturesFromNode",value:function(e,t){var r={};return t&&Object.assign(r,this.getReadOptions(e,t)),this.readFeatures_(e,[r])}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../array.js":104,"../xml.js":391,"./GML2.js":138,"./XMLFeature.js":160}],158:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=c(e("./OWS.js")),n=c(e("./XML.js")),a=e("../extent.js"),s=e("../xml.js"),u=e("./xsd.js"),l=e("./xlink.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=[null,"http://www.opengis.net/wmts/1.0"],y=[null,"http://www.opengis.net/ows/1.1"],g=(0,s.makeStructureNS)(e,{Contents:(0,s.makeObjectPropertySetter)(function(e,t){return(0,s.pushParseAndPop)({},m,e,t)})}),n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(){var e;if(this instanceof i)return(e=n.call(this)).owsParser_=new o.default,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"readFromNode",value:function(e){var t=(t=e.getAttribute("version"))&&t.trim(),r=this.owsParser_.readFromNode(e);return r&&(r.version=t,(0,s.pushParseAndPop)(r,g,e,[]))||null}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default),m=(0,s.makeStructureNS)(e,{Layer:(0,s.makeObjectPropertyPusher)(function(e,t){return(0,s.pushParseAndPop)({},v,e,t)}),TileMatrixSet:(0,s.makeObjectPropertyPusher)(function(e,t){return(0,s.pushParseAndPop)({},O,e,t)})}),v=(0,s.makeStructureNS)(e,{Style:(0,s.makeObjectPropertyPusher)(function(e,t){t=(0,s.pushParseAndPop)({},b,e,t);if(t)return e="true"===e.getAttribute("isDefault"),t.isDefault=e,t}),Format:(0,s.makeObjectPropertyPusher)(u.readString),TileMatrixSetLink:(0,s.makeObjectPropertyPusher)(function(e,t){return(0,s.pushParseAndPop)({},_,e,t)}),Dimension:(0,s.makeObjectPropertyPusher)(function(e,t){return(0,s.pushParseAndPop)({},S,e,t)}),ResourceURL:(0,s.makeObjectPropertyPusher)(function(e,t){var r=e.getAttribute("format"),n=e.getAttribute("template"),e=e.getAttribute("resourceType"),i={};r&&(i.format=r);n&&(i.template=n);e&&(i.resourceType=e);return i})},(0,s.makeStructureNS)(y,{Title:(0,s.makeObjectPropertySetter)(u.readString),Abstract:(0,s.makeObjectPropertySetter)(u.readString),WGS84BoundingBox:(0,s.makeObjectPropertySetter)(k),Identifier:(0,s.makeObjectPropertySetter)(u.readString)})),b=(0,s.makeStructureNS)(e,{LegendURL:(0,s.makeObjectPropertyPusher)(function(e,t){var r={};return r.format=e.getAttribute("format"),r.href=(0,l.readHref)(e),r})},(0,s.makeStructureNS)(y,{Title:(0,s.makeObjectPropertySetter)(u.readString),Identifier:(0,s.makeObjectPropertySetter)(u.readString)})),_=(0,s.makeStructureNS)(e,{TileMatrixSet:(0,s.makeObjectPropertySetter)(u.readString),TileMatrixSetLimits:(0,s.makeObjectPropertySetter)(function(e,t){return(0,s.pushParseAndPop)([],w,e,t)})}),w=(0,s.makeStructureNS)(e,{TileMatrixLimits:(0,s.makeArrayPusher)(function(e,t){return(0,s.pushParseAndPop)({},x,e,t)})}),x=(0,s.makeStructureNS)(e,{TileMatrix:(0,s.makeObjectPropertySetter)(u.readString),MinTileRow:(0,s.makeObjectPropertySetter)(u.readPositiveInteger),MaxTileRow:(0,s.makeObjectPropertySetter)(u.readPositiveInteger),MinTileCol:(0,s.makeObjectPropertySetter)(u.readPositiveInteger),MaxTileCol:(0,s.makeObjectPropertySetter)(u.readPositiveInteger)}),S=(0,s.makeStructureNS)(e,{Default:(0,s.makeObjectPropertySetter)(u.readString),Value:(0,s.makeObjectPropertyPusher)(u.readString)},(0,s.makeStructureNS)(y,{Identifier:(0,s.makeObjectPropertySetter)(u.readString)})),j=(0,s.makeStructureNS)(y,{LowerCorner:(0,s.makeArrayPusher)(E),UpperCorner:(0,s.makeArrayPusher)(E)}),O=(0,s.makeStructureNS)(e,{WellKnownScaleSet:(0,s.makeObjectPropertySetter)(u.readString),TileMatrix:(0,s.makeObjectPropertyPusher)(function(e,t){return(0,s.pushParseAndPop)({},P,e,t)})},(0,s.makeStructureNS)(y,{SupportedCRS:(0,s.makeObjectPropertySetter)(u.readString),Identifier:(0,s.makeObjectPropertySetter)(u.readString),BoundingBox:(0,s.makeObjectPropertySetter)(k)})),P=(0,s.makeStructureNS)(e,{TopLeftCorner:(0,s.makeObjectPropertySetter)(E),ScaleDenominator:(0,s.makeObjectPropertySetter)(u.readDecimal),TileWidth:(0,s.makeObjectPropertySetter)(u.readPositiveInteger),TileHeight:(0,s.makeObjectPropertySetter)(u.readPositiveInteger),MatrixWidth:(0,s.makeObjectPropertySetter)(u.readPositiveInteger),MatrixHeight:(0,s.makeObjectPropertySetter)(u.readPositiveInteger)},(0,s.makeStructureNS)(y,{Identifier:(0,s.makeObjectPropertySetter)(u.readString)}));function k(e,t){e=(0,s.pushParseAndPop)([],j,e,t);if(2==e.length)return(0,a.boundingExtent)(e)}function E(e,t){e=(0,u.readString)(e).split(/\s+/);if(e&&2==e.length){var r=+e[0],e=+e[1];if(!isNaN(r)&&!isNaN(e))return[r,e]}}r.default=n},{"../extent.js":131,"../xml.js":391,"./OWS.js":149,"./XML.js":159,"./xlink.js":187,"./xsd.js":188}],159:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../xml.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}e=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,(r=[{key:"read",value:function(e){var t;return e?"string"==typeof e?(t=(0,i.parse)(e),this.readFromDocument(t)):(0,i.isDocument)(e)?this.readFromDocument(e):this.readFromNode(e):null}},{key:"readFromDocument",value:function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null}},{key:"readFromNode",value:function(e){}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=e},{"../xml.js":391}],160:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../format/Feature.js"))&&n.__esModule?n:{default:n},o=e("../util.js"),a=e("../array.js"),s=e("../xml.js");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(){var e;if(this instanceof i)return(e=n.call(this)).xmlSerializer_=(0,s.getXMLSerializer)(),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getType",value:function(){return"xml"}},{key:"readFeature",value:function(e,t){var r;return e?"string"==typeof e?(r=(0,s.parse)(e),this.readFeatureFromDocument(r,t)):(0,s.isDocument)(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t):null}},{key:"readFeatureFromDocument",value:function(e,t){e=this.readFeaturesFromDocument(e,t);return 0<e.length?e[0]:null}},{key:"readFeatureFromNode",value:function(e,t){return null}},{key:"readFeatures",value:function(e,t){var r;return e?"string"==typeof e?(r=(0,s.parse)(e),this.readFeaturesFromDocument(r,t)):(0,s.isDocument)(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t):[]}},{key:"readFeaturesFromDocument",value:function(e,t){for(var r=[],n=e.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&(0,a.extend)(r,this.readFeaturesFromNode(n,t));return r}},{key:"readFeaturesFromNode",value:function(e,t){return(0,o.abstract)()}},{key:"readGeometry",value:function(e,t){var r;return e?"string"==typeof e?(r=(0,s.parse)(e),this.readGeometryFromDocument(r,t)):(0,s.isDocument)(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t):null}},{key:"readGeometryFromDocument",value:function(e,t){return null}},{key:"readGeometryFromNode",value:function(e,t){return null}},{key:"readProjection",value:function(e){var t;return e?"string"==typeof e?(t=(0,s.parse)(e),this.readProjectionFromDocument(t)):(0,s.isDocument)(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e):null}},{key:"readProjectionFromDocument",value:function(e){return this.dataProjection}},{key:"readProjectionFromNode",value:function(e){return this.dataProjection}},{key:"writeFeature",value:function(e,t){e=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(e)}},{key:"writeFeatureNode",value:function(e,t){return null}},{key:"writeFeatures",value:function(e,t){e=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(e)}},{key:"writeFeaturesNode",value:function(e,t){return null}},{key:"writeGeometry",value:function(e,t){e=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(e)}},{key:"writeGeometryNode",value:function(e,t){return null}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../array.js":104,"../format/Feature.js":136,"../util.js":379,"../xml.js":391}],161:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.and=function(e){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(n.default,t))},r.bbox=function(e,t,r){return new i.default(e,t,r)},r.between=function(e,t,r){return new p.default(e,t,r)},r.contains=function(e,t,r){return new o.default(e,t,r)},r.disjoint=function(e,t,r){return new s.default(e,t,r)},r.during=function(e,t,r){return new u.default(e,t,r)},r.dwithin=function(e,t,r,n,i){return new a.default(e,t,r,n,i)},r.equalTo=function(e,t,r){return new l.default(e,t,r)},r.greaterThan=function(e,t){return new c.default(e,t)},r.greaterThanOrEqualTo=function(e,t){return new f.default(e,t)},r.intersects=function(e,t,r){return new h.default(e,t,r)},r.isNull=function(e){return new y.default(e)},r.lessThan=function(e,t){return new g.default(e,t)},r.lessThanOrEqualTo=function(e,t){return new m.default(e,t)},r.like=function(e,t,r,n,i,o){return new d.default(e,t,r,n,i,o)},r.not=function(e){return new v.default(e)},r.notEqualTo=function(e,t,r){return new b.default(e,t,r)},r.or=function(e){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(_.default,t))},r.resourceId=function(e){return new w.default(e)},r.within=function(e,t,r){return new x.default(e,t,r)};var n=S(e("./filter/And.js")),i=S(e("./filter/Bbox.js")),o=S(e("./filter/Contains.js")),a=S(e("./filter/DWithin.js")),s=S(e("./filter/Disjoint.js")),u=S(e("./filter/During.js")),l=S(e("./filter/EqualTo.js")),c=S(e("./filter/GreaterThan.js")),f=S(e("./filter/GreaterThanOrEqualTo.js")),h=S(e("./filter/Intersects.js")),p=S(e("./filter/IsBetween.js")),d=S(e("./filter/IsLike.js")),y=S(e("./filter/IsNull.js")),g=S(e("./filter/LessThan.js")),m=S(e("./filter/LessThanOrEqualTo.js")),v=S(e("./filter/Not.js")),b=S(e("./filter/NotEqualTo.js")),_=S(e("./filter/Or.js")),w=S(e("./filter/ResourceId.js")),x=S(e("./filter/Within.js"));function S(e){return e&&e.__esModule?e:{default:e}}},{"./filter/And.js":162,"./filter/Bbox.js":163,"./filter/Contains.js":166,"./filter/DWithin.js":167,"./filter/Disjoint.js":168,"./filter/During.js":169,"./filter/EqualTo.js":170,"./filter/GreaterThan.js":172,"./filter/GreaterThanOrEqualTo.js":173,"./filter/Intersects.js":174,"./filter/IsBetween.js":175,"./filter/IsLike.js":176,"./filter/IsNull.js":177,"./filter/LessThan.js":178,"./filter/LessThanOrEqualTo.js":179,"./filter/Not.js":181,"./filter/NotEqualTo.js":182,"./filter/Or.js":183,"./filter/ResourceId.js":184,"./filter/Within.js":186}],162:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){var t=this,r=o;if(t instanceof r)return i.call(this,"And",Array.prototype.slice.call(arguments));throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./LogicalNary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./LogicalNary.js":180}],163:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){var n;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");if((n=i.call(this,"BBOX")).geometryName=e,4!==(n.extent=t).length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return n.srsName=r,n}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Filter.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Filter.js":171}],164:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t){if(this instanceof o)return(e=i.call(this,e)).propertyName=t,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Filter.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Filter.js":171}],165:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r,n){if(this instanceof o)return(e=i.call(this,e,t)).expression=r,e.matchCase=n,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Comparison.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Comparison.js":164}],166:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return i.call(this,"Contains",e,t,r);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Spatial.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Spatial.js":185}],167:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n,o=l(a);function a(e,t,r,n,i){if(this instanceof a)return(e=o.call(this,"DWithin",e,t,i)).distance=r,e.unit=n,e;throw new TypeError("Cannot call a class as a function")}return t=a,r&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Spatial.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Spatial.js":185}],168:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return i.call(this,"Disjoint",e,t,r);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Spatial.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Spatial.js":185}],169:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return(e=i.call(this,"During",e)).begin=t,e.end=r,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Comparison.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Comparison.js":164}],170:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return i.call(this,"PropertyIsEqualTo",e,t,r);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./ComparisonBinary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./ComparisonBinary.js":165}],171:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.tagName_=e}var e,r,n;return e=t,(r=[{key:"getTagName",value:function(){return this.tagName_}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=n},{}],172:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t){if(this instanceof o)return i.call(this,"PropertyIsGreaterThan",e,t);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./ComparisonBinary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./ComparisonBinary.js":165}],173:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t){if(this instanceof o)return i.call(this,"PropertyIsGreaterThanOrEqualTo",e,t);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./ComparisonBinary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./ComparisonBinary.js":165}],174:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return i.call(this,"Intersects",e,t,r);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Spatial.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Spatial.js":185}],175:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return(e=i.call(this,"PropertyIsBetween",e)).lowerBoundary=t,e.upperBoundary=r,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Comparison.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Comparison.js":164}],176:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n,a=l(s);function s(e,t,r,n,i,o){if(this instanceof s)return(e=a.call(this,"PropertyIsLike",e)).pattern=t,e.wildCard=void 0!==r?r:"*",e.singleChar=void 0!==n?n:".",e.escapeChar=void 0!==i?i:"!",e.matchCase=o,e;throw new TypeError("Cannot call a class as a function")}return t=s,r&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Comparison.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Comparison.js":164}],177:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){if(this instanceof o)return i.call(this,"PropertyIsNull",e);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Comparison.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Comparison.js":164}],178:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t){if(this instanceof o)return i.call(this,"PropertyIsLessThan",e,t);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./ComparisonBinary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./ComparisonBinary.js":165}],179:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t){if(this instanceof o)return i.call(this,"PropertyIsLessThanOrEqualTo",e,t);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./ComparisonBinary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./ComparisonBinary.js":165}],180:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Filter.js"))&&n.__esModule?n:{default:n},a=e("../../asserts.js");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n,i=l(o);function o(e,t){if(this instanceof o)return(e=i.call(this,e)).conditions=t,(0,a.assert)(2<=e.conditions.length,57),e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.default);r.default=e},{"../../asserts.js":105,"./Filter.js":171}],181:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){var t;if(this instanceof o)return(t=i.call(this,"Not")).condition=e,t;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Filter.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Filter.js":171}],182:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return i.call(this,"PropertyIsNotEqualTo",e,t,r);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./ComparisonBinary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./ComparisonBinary.js":165}],183:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){var t=this,r=o;if(t instanceof r)return i.call(this,"Or",Array.prototype.slice.call(arguments));throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./LogicalNary.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./LogicalNary.js":180}],184:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){var t;if(this instanceof o)return(t=i.call(this,"ResourceId")).rid=e,t;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Filter.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Filter.js":171}],185:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r,n){if(this instanceof o)return(e=i.call(this,e)).geometryName=t||"the_geom",e.geometry=r,e.srsName=n,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Filter.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Filter.js":171}],186:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r){if(this instanceof o)return i.call(this,"Within",e,t,r);throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Spatial.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Spatial.js":185}],187:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readHref=function(e){return e.getAttributeNS(n,"href")};var n="http://www.w3.org/1999/xlink"},{}],188:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readBoolean=function(e){return o((0,n.getAllTextContent)(e,!1))},r.readBooleanString=o,r.readDateTime=function(e){e=(0,n.getAllTextContent)(e,!1),e=Date.parse(e);return isNaN(e)?void 0:e/1e3},r.readDecimal=function(e){return a((0,n.getAllTextContent)(e,!1))},r.readDecimalString=a,r.readNonNegativeIntegerString=s,r.readPositiveInteger=function(e){return s((0,n.getAllTextContent)(e,!1))},r.readString=function(e){return(0,n.getAllTextContent)(e,!1).trim()},r.writeBooleanTextNode=function(e,t){u(e,t?"1":"0")},r.writeCDATASection=function(e,t){e.appendChild((0,n.getDocument)().createCDATASection(t))},r.writeDateTimeTextNode=function(e,t){t=new Date(1e3*t),t=t.getUTCFullYear()+"-"+(0,i.padNumber)(t.getUTCMonth()+1,2)+"-"+(0,i.padNumber)(t.getUTCDate(),2)+"T"+(0,i.padNumber)(t.getUTCHours(),2)+":"+(0,i.padNumber)(t.getUTCMinutes(),2)+":"+(0,i.padNumber)(t.getUTCSeconds(),2)+"Z";e.appendChild((0,n.getDocument)().createTextNode(t))},r.writeDecimalTextNode=function(e,t){t=t.toPrecision();e.appendChild((0,n.getDocument)().createTextNode(t))},r.writeNonNegativeIntegerTextNode=function(e,t){t=t.toString();e.appendChild((0,n.getDocument)().createTextNode(t))},r.writeStringTextNode=u;var n=e("../xml.js"),i=e("../string.js");function o(e){e=/^\s*(true|1)|(false|0)\s*$/.exec(e);if(e)return void 0!==e[1]||!1}function a(e){e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);if(e)return parseFloat(e[1])}function s(e){e=/^\s*(\d+)\s*$/.exec(e);if(e)return parseInt(e[1],10)}function u(e,t){e.appendChild((0,n.getDocument)().createTextNode(t))}},{"../string.js":354,"../xml.js":391}],189:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FALSE=function(){return!1},r.TRUE=function(){return!0},r.VOID=function(){},r.memoizeOne=function(t){var r,n,i,o=!1;return function(){var e=Array.prototype.slice.call(arguments);return o&&this===i&&(0,a.equals)(e,n)||(o=!0,i=this,n=e,r=t.apply(this,arguments)),r}},r.toPromise=function(t){return function(){var e;try{e=t()}catch(e){return Promise.reject(e)}return e instanceof Promise?e:Promise.resolve(e)}()};var a=e("./array.js")},{"./array.js":104}],190:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Circle",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"Geometry",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"GeometryCollection",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"LineString",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"LinearRing",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"MultiLineString",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"MultiPoint",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"MultiPolygon",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"Point",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"Polygon",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"SimpleGeometry",{enumerable:!0,get:function(){return p.default}});var n=d(e("./geom/Circle.js")),i=d(e("./geom/Geometry.js")),o=d(e("./geom/GeometryCollection.js")),a=d(e("./geom/LinearRing.js")),s=d(e("./geom/LineString.js")),u=d(e("./geom/MultiLineString.js")),l=d(e("./geom/MultiPoint.js")),c=d(e("./geom/MultiPolygon.js")),f=d(e("./geom/Point.js")),h=d(e("./geom/Polygon.js")),p=d(e("./geom/SimpleGeometry.js"));function d(e){return e&&e.__esModule?e:{default:e}}},{"./geom/Circle.js":191,"./geom/Geometry.js":192,"./geom/GeometryCollection.js":193,"./geom/LineString.js":194,"./geom/LinearRing.js":195,"./geom/MultiLineString.js":196,"./geom/MultiPoint.js":197,"./geom/MultiPolygon.js":198,"./geom/Point.js":199,"./geom/Polygon.js":200,"./geom/SimpleGeometry.js":201}],191:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./SimpleGeometry.js"))&&n.__esModule?n:{default:n},a=e("../extent.js"),s=e("./flat/deflate.js"),u=e("./flat/transform.js");function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,i=f(o);function o(e,t,r){var n;if(this instanceof o)return n=i.call(this),void 0!==r&&void 0===t?n.setFlatCoordinates(r,e):n.setCenterAndRadius(e,t=t||0,r),n;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"clone",value:function(){var e=new o(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){var i=this.flatCoordinates,e=e-i[0],t=t-i[1],o=e*e+t*t;if(o<n){if(0==o)for(var a=0;a<this.stride;++a)r[a]=i[a];else{var s=this.getRadius()/Math.sqrt(o);r[0]=i[0]+s*e,r[1]=i[1]+s*t;for(var u=2;u<this.stride;++u)r[u]=i[u]}return r.length=this.stride,o}return n}},{key:"containsXY",value:function(e,t){var r=this.flatCoordinates,e=e-r[0],t=t-r[1];return e*e+t*t<=this.getRadiusSquared_()}},{key:"getCenter",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"computeExtent",value:function(e){var t=this.flatCoordinates,r=t[this.stride]-t[0];return(0,a.createOrUpdate)(t[0]-r,t[1]-r,t[0]+r,t[1]+r,e)}},{key:"getRadius",value:function(){return Math.sqrt(this.getRadiusSquared_())}},{key:"getRadiusSquared_",value:function(){var e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}},{key:"getType",value:function(){return"Circle"}},{key:"intersectsExtent",value:function(e){var t=this.getExtent();return!!(0,a.intersects)(e,t)&&(t=this.getCenter(),e[0]<=t[0]&&e[2]>=t[0]||e[1]<=t[1]&&e[3]>=t[1]||(0,a.forEachCorner)(e,this.intersectsCoordinate.bind(this)))}},{key:"setCenter",value:function(e){var t=this.stride,r=this.flatCoordinates[t]-this.flatCoordinates[0],n=e.slice();n[t]=n[0]+r;for(var i=1;i<t;++i)n[t+i]=e[i];this.setFlatCoordinates(this.layout,n),this.changed()}},{key:"setCenterAndRadius",value:function(e,t,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,i=(0,s.deflateCoordinate)(n,0,e,this.stride);n[i++]=n[0]+t;for(var o=1,a=this.stride;o<a;++o)n[i++]=n[o];n.length=i,this.changed()}},{key:"getCoordinates",value:function(){return null}},{key:"setCoordinates",value:function(e,t){}},{key:"setRadius",value:function(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}},{key:"rotate",value:function(e,t){var r=this.getCenter(),n=this.getStride();this.setCenter((0,u.rotate)(r,0,r.length,n,e,t,r)),this.changed()}},{key:"translate",value:function(e,t){var r=this.getCenter(),n=this.getStride();this.setCenter((0,u.translate)(r,0,r.length,n,e,t,r)),this.changed()}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);e.prototype.transform,r.default=e},{"../extent.js":131,"./SimpleGeometry.js":201,"./flat/deflate.js":206,"./flat/transform.js":220}],192:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../Object.js"))&&n.__esModule?n:{default:n},o=e("../util.js"),s=e("../transform.js"),u=e("../extent.js"),l=e("../proj.js"),a=e("../functions.js"),c=e("./flat/transform.js");function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=(0,s.create)(),e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(){var e;if(this instanceof i)return(e=n.call(this)).extent_=(0,u.createEmpty)(),e.extentRevision_=-1,e.simplifiedGeometryMaxMinSquaredTolerance=0,e.simplifiedGeometryRevision=0,e.simplifyTransformedInternal=(0,a.memoizeOne)(function(e,t,r){var n;return(r?((n=this.clone()).applyTransform(r),n):this).getSimplifiedGeometry(t)}),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"simplifyTransformed",value:function(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}},{key:"clone",value:function(){return(0,o.abstract)()}},{key:"closestPointXY",value:function(e,t,r,n){return(0,o.abstract)()}},{key:"containsXY",value:function(e,t){var r=this.getClosestPoint([e,t]);return r[0]===e&&r[1]===t}},{key:"getClosestPoint",value:function(e,t){return this.closestPointXY(e[0],e[1],t=t||[NaN,NaN],1/0),t}},{key:"intersectsCoordinate",value:function(e){return this.containsXY(e[0],e[1])}},{key:"computeExtent",value:function(e){return(0,o.abstract)()}},{key:"getExtent",value:function(e){var t;return this.extentRevision_!=this.getRevision()&&(t=this.computeExtent(this.extent_),(isNaN(t[0])||isNaN(t[1]))&&(0,u.createOrUpdateEmpty)(t),this.extentRevision_=this.getRevision()),(0,u.returnOrUpdate)(this.extent_,e)}},{key:"rotate",value:function(e,t){(0,o.abstract)()}},{key:"scale",value:function(e,t,r){(0,o.abstract)()}},{key:"simplify",value:function(e){return this.getSimplifiedGeometry(e*e)}},{key:"getSimplifiedGeometry",value:function(e){return(0,o.abstract)()}},{key:"getType",value:function(){return(0,o.abstract)()}},{key:"applyTransform",value:function(e){(0,o.abstract)()}},{key:"intersectsExtent",value:function(e){return(0,o.abstract)()}},{key:"translate",value:function(e,t){(0,o.abstract)()}},{key:"transform",value:function(e,o){var a=(0,l.get)(e),e="tile-pixels"==a.getUnits()?function(e,t,r){var n=a.getExtent(),i=a.getWorldExtent(),n=(0,u.getHeight)(i)/(0,u.getHeight)(n);return(0,s.compose)(y,i[0],i[3],n,-n,0,0,0),(0,c.transform2D)(e,0,e.length,r,y,t),(0,l.getTransform)(a,o)(e,t,r)}:(0,l.getTransform)(a,o);return this.applyTransform(e),this}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Object.js":90,"../extent.js":131,"../functions.js":189,"../proj.js":271,"../transform.js":377,"../util.js":379,"./flat/transform.js":220}],193:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=u(e("../events/EventType.js")),n=u(e("./Geometry.js")),s=e("../extent.js"),a=e("../events.js");function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(l);function l(e){var t;if(this instanceof l)return(t=n.call(this)).geometries_=e||null,t.changeEventsKeys_=[],t.listenGeometriesChange_(),t;throw new TypeError("Cannot call a class as a function")}return t=l,(e=[{key:"unlistenGeometriesChange_",value:function(){this.changeEventsKeys_.forEach(a.unlistenByKey),this.changeEventsKeys_.length=0}},{key:"listenGeometriesChange_",value:function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push((0,a.listen)(this.geometries_[e],o.default.CHANGE,this.changed,this))}},{key:"clone",value:function(){var e=new l(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){if(!(n<(0,s.closestSquaredDistanceXY)(this.getExtent(),e,t)))for(var i=this.geometries_,o=0,a=i.length;o<a;++o)n=i[o].closestPointXY(e,t,r,n);return n}},{key:"containsXY",value:function(e,t){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)if(r[n].containsXY(e,t))return!0;return!1}},{key:"computeExtent",value:function(e){(0,s.createOrUpdateEmpty)(e);for(var t=this.geometries_,r=0,n=t.length;r<n;++r)(0,s.extend)(e,t[r].getExtent());return e}},{key:"getGeometries",value:function(){return y(this.geometries_)}},{key:"getGeometriesArray",value:function(){return this.geometries_}},{key:"getGeometriesArrayRecursive",value:function(){for(var e=[],t=this.geometries_,r=0,n=t.length;r<n;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}},{key:"getSimplifiedGeometry",value:function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var t,r=[],n=this.geometries_,i=!1,o=0,a=n.length;o<a;++o){var s=n[o],u=s.getSimplifiedGeometry(e);r.push(u),u!==s&&(i=!0)}return i?((t=new l(null)).setGeometriesArray(r),t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}},{key:"getType",value:function(){return"GeometryCollection"}},{key:"intersectsExtent",value:function(e){for(var t=this.geometries_,r=0,n=t.length;r<n;++r)if(t[r].intersectsExtent(e))return!0;return!1}},{key:"isEmpty",value:function(){return 0===this.geometries_.length}},{key:"rotate",value:function(e,t){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)r[n].rotate(e,t);this.changed()}},{key:"scale",value:function(e,t,r){r=r||(0,s.getCenter)(this.getExtent());for(var n=this.geometries_,i=0,o=n.length;i<o;++i)n[i].scale(e,t,r);this.changed()}},{key:"setGeometries",value:function(e){this.setGeometriesArray(y(e))}},{key:"setGeometriesArray",value:function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}},{key:"applyTransform",value:function(e){for(var t=this.geometries_,r=0,n=t.length;r<n;++r)t[r].applyTransform(e);this.changed()}},{key:"translate",value:function(e,t){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)r[n].translate(e,t);this.changed()}},{key:"disposeInternal",value:function(){this.unlistenGeometriesChange_(),f(d(l.prototype),"disposeInternal",this).call(this)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.default);function y(e){for(var t=[],r=0,n=e.length;r<n;++r)t.push(e[r].clone());return t}r.default=e},{"../events.js":125,"../events/EventType.js":127,"../extent.js":131,"./Geometry.js":192}],194:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./SimpleGeometry.js"))&&n.__esModule?n:{default:n},o=e("./flat/closest.js"),a=e("../extent.js"),s=e("./flat/deflate.js"),u=e("./flat/simplify.js"),l=e("../array.js"),c=e("./flat/segments.js"),f=e("./flat/inflate.js"),h=e("./flat/interpolate.js"),p=e("./flat/intersectsextent.js"),d=e("./flat/length.js");function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e);var r,n=m(i);function i(e,t){var r;if(this instanceof i)return(r=n.call(this)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===t||Array.isArray(e[0])?r.setCoordinates(e,t):r.setFlatCoordinates(t,e),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"appendCoordinate",value:function(e){this.flatCoordinates?(0,l.extend)(this.flatCoordinates,e):this.flatCoordinates=e.slice(),this.changed()}},{key:"clone",value:function(){var e=new i(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){return n<(0,a.closestSquaredDistanceXY)(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,o.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,o.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,n))}},{key:"forEachSegment",value:function(e){return(0,c.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}},{key:"getCoordinateAtM",value:function(e,t){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(0,h.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t=void 0!==t&&t)}},{key:"getCoordinates",value:function(){return(0,f.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(e,t){return(0,h.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}},{key:"getLength",value:function(){return(0,d.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(e){var t=[];return t.length=(0,u.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new i(t,"XY")}},{key:"getType",value:function(){return"LineString"}},{key:"intersectsExtent",value:function(e){return(0,p.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,s.deflateCoordinates)(this.flatCoordinates,0,e,this.stride),this.changed()}}])&&y(t.prototype,e),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../array.js":104,"../extent.js":131,"./SimpleGeometry.js":201,"./flat/closest.js":204,"./flat/deflate.js":206,"./flat/inflate.js":209,"./flat/interpolate.js":211,"./flat/intersectsextent.js":212,"./flat/length.js":213,"./flat/segments.js":216,"./flat/simplify.js":217}],195:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./SimpleGeometry.js"))&&n.__esModule?n:{default:n},o=e("./flat/closest.js"),a=e("../extent.js"),s=e("./flat/deflate.js"),u=e("./flat/simplify.js"),l=e("./flat/inflate.js"),c=e("./flat/area.js");function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e,t){var r;if(this instanceof i)return(r=n.call(this)).maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===t||Array.isArray(e[0])?r.setCoordinates(e,t):r.setFlatCoordinates(t,e),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){return new i(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(e,t,r,n){return n<(0,a.closestSquaredDistanceXY)(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,o.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,o.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,n))}},{key:"getArea",value:function(){return(0,c.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return(0,l.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(e){var t=[];return t.length=(0,u.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new i(t,"XY")}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(e){return!1}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,s.deflateCoordinates)(this.flatCoordinates,0,e,this.stride),this.changed()}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../extent.js":131,"./SimpleGeometry.js":201,"./flat/area.js":202,"./flat/closest.js":204,"./flat/deflate.js":206,"./flat/inflate.js":209,"./flat/simplify.js":217}],196:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l=f(e("./LineString.js")),n=f(e("./SimpleGeometry.js")),o=e("./flat/closest.js"),a=e("../extent.js"),s=e("./flat/deflate.js"),u=e("./flat/simplify.js"),p=e("../array.js"),c=e("./flat/inflate.js"),d=e("./flat/interpolate.js"),y=e("./flat/intersectsextent.js");function f(e){return e&&e.__esModule?e:{default:e}}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=h;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e);var r,f=v(h);function h(e,t,r){var n;if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");if((n=f.call(this)).ends_=[],n.maxDelta_=-1,n.maxDeltaRevision_=-1,Array.isArray(e[0]))n.setCoordinates(e,t);else if(void 0!==t&&r)n.setFlatCoordinates(t,e),n.ends_=r;else{for(var i=n.getLayout(),o=e,a=[],s=[],u=0,l=o.length;u<l;++u){var c=o[u];0===u&&(i=c.getLayout()),(0,p.extend)(a,c.getFlatCoordinates()),s.push(a.length)}n.setFlatCoordinates(i,a),n.ends_=s}return n}return t=h,(e=[{key:"appendLineString",value:function(e){this.flatCoordinates?(0,p.extend)(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var e=new h(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){return n<(0,a.closestSquaredDistanceXY)(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,o.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,o.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,n))}},{key:"getCoordinateAtM",value:function(e,t,r){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(0,d.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,e,t=void 0!==t&&t,r=void 0!==r&&r)}},{key:"getCoordinates",value:function(){return(0,c.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getLineString",value:function(e){return e<0||this.ends_.length<=e?null:new l.default(this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]),this.layout)}},{key:"getLineStrings",value:function(){for(var e=this.flatCoordinates,t=this.ends_,r=this.layout,n=[],i=0,o=0,a=t.length;o<a;++o){var s=t[o],u=new l.default(e.slice(i,s),r);n.push(u),i=s}return n}},{key:"getFlatMidpoints",value:function(){for(var e=[],t=this.flatCoordinates,r=0,n=this.ends_,i=this.stride,o=0,a=n.length;o<a;++o){var s=n[o],u=(0,d.interpolatePoint)(t,r,s,i,.5);(0,p.extend)(e,u),r=s}return e}},{key:"getSimplifiedGeometryInternal",value:function(e){var t=[],r=[];return t.length=(0,u.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new h(t,"XY",r)}},{key:"getType",value:function(){return"MultiLineString"}},{key:"intersectsExtent",value:function(e){return(0,y.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,e)}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);t=(0,s.deflateCoordinatesArray)(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=0===t.length?0:t[t.length-1],this.changed()}}])&&g(t.prototype,e),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.default);r.default=e},{"../array.js":104,"../extent.js":131,"./LineString.js":194,"./SimpleGeometry.js":201,"./flat/closest.js":204,"./flat/deflate.js":206,"./flat/inflate.js":209,"./flat/interpolate.js":211,"./flat/intersectsextent.js":212,"./flat/simplify.js":217}],197:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=l(e("./Point.js")),n=l(e("./SimpleGeometry.js")),c=e("../extent.js"),o=e("./flat/deflate.js"),a=e("../array.js"),u=e("./flat/inflate.js"),f=e("../math.js");function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e,t){var r;if(this instanceof i)return r=n.call(this),t&&!Array.isArray(e[0])?r.setFlatCoordinates(t,e):r.setCoordinates(e,t),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"appendPoint",value:function(e){this.flatCoordinates?(0,a.extend)(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.changed()}},{key:"clone",value:function(){var e=new i(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){if(!(n<(0,c.closestSquaredDistanceXY)(this.getExtent(),e,t)))for(var i=this.flatCoordinates,o=this.stride,a=0,s=i.length;a<s;a+=o){var u=(0,f.squaredDistance)(e,t,i[a],i[a+1]);if(u<n){n=u;for(var l=0;l<o;++l)r[l]=i[a+l];r.length=o}}return n}},{key:"getCoordinates",value:function(){return(0,u.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getPoint",value:function(e){var t=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return e<0||t<=e?null:new s.default(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}},{key:"getPoints",value:function(){for(var e=this.flatCoordinates,t=this.layout,r=this.stride,n=[],i=0,o=e.length;i<o;i+=r){var a=new s.default(e.slice(i,i+r),t);n.push(a)}return n}},{key:"getType",value:function(){return"MultiPoint"}},{key:"intersectsExtent",value:function(e){for(var t=this.flatCoordinates,r=this.stride,n=0,i=t.length;n<i;n+=r){var o=t[n],a=t[n+1];if((0,c.containsXY)(e,o,a))return!0}return!1}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,o.deflateCoordinates)(this.flatCoordinates,0,e,this.stride),this.changed()}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../array.js":104,"../extent.js":131,"../math.js":267,"./Point.js":199,"./SimpleGeometry.js":201,"./flat/deflate.js":206,"./flat/inflate.js":209}],198:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=y(e("./MultiPoint.js")),h=y(e("./Polygon.js")),o=y(e("./SimpleGeometry.js")),a=e("./flat/closest.js"),s=e("../extent.js"),u=e("./flat/deflate.js"),m=e("../array.js"),l=e("./flat/interiorpoint.js"),c=e("./flat/inflate.js"),f=e("./flat/intersectsextent.js"),p=e("./flat/orient.js"),d=e("./flat/area.js"),v=e("./flat/center.js"),b=e("./flat/contains.js"),_=e("./flat/simplify.js");function y(e){return e&&e.__esModule?e:{default:e}}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=g;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e);var r,y=S(g);function g(e,t,r){var n;if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");if((n=y.call(this)).endss_=[],n.flatInteriorPointsRevision_=-1,n.flatInteriorPoints_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){for(var i=n.getLayout(),o=e,a=[],s=[],u=0,l=o.length;u<l;++u){for(var c=o[u],f=(0===u&&(i=c.getLayout()),a.length),h=c.getEnds(),p=0,d=h.length;p<d;++p)h[p]+=f;(0,m.extend)(a,c.getFlatCoordinates()),s.push(h)}t=i,e=a,r=s}return void 0!==t&&r?(n.setFlatCoordinates(t,e),n.endss_=r):n.setCoordinates(e,t),n}return t=g,(e=[{key:"appendPolygon",value:function(e){if(this.flatCoordinates){var t=this.flatCoordinates.length;(0,m.extend)(this.flatCoordinates,e.getFlatCoordinates());for(var r,n=0,i=(r=e.getEnds().slice()).length;n<i;++n)r[n]+=t}else this.flatCoordinates=e.getFlatCoordinates().slice(),r=e.getEnds().slice(),this.endss_.push();this.endss_.push(r),this.changed()}},{key:"clone",value:function(){for(var e=this.endss_.length,t=new Array(e),r=0;r<e;++r)t[r]=this.endss_[r].slice();var n=new g(this.flatCoordinates.slice(),this.layout,t);return n.applyProperties(this),n}},{key:"closestPointXY",value:function(e,t,r,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,a.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,a.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,n))}},{key:"containsXY",value:function(e,t){return(0,b.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}},{key:"getArea",value:function(){return(0,d.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}},{key:"getCoordinates",value:function(e){var t;return void 0!==e?(t=this.getOrientedFlatCoordinates().slice(),(0,p.orientLinearRingsArray)(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,(0,c.inflateMultiCoordinatesArray)(t,0,this.endss_,this.stride)}},{key:"getEndss",value:function(){return this.endss_}},{key:"getFlatInteriorPoints",value:function(){var e;return this.flatInteriorPointsRevision_!=this.getRevision()&&(e=(0,v.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride),this.flatInteriorPoints_=(0,l.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()),this.flatInteriorPoints_}},{key:"getInteriorPoints",value:function(){return new n.default(this.getFlatInteriorPoints().slice(),"XYM")}},{key:"getOrientedFlatCoordinates",value:function(){var e;return this.orientedRevision_!=this.getRevision()&&(e=this.flatCoordinates,(0,p.linearRingssAreOriented)(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=(0,p.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(e){var t=[],r=[];return t.length=(0,_.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new g(t,"XY",r)}},{key:"getPolygon",value:function(e){if(e<0||this.endss_.length<=e)return null;t=0===e?0:(n=this.endss_[e-1])[n.length-1];var t,r=this.endss_[e].slice(),n=r[r.length-1];if(0!==t)for(var i=0,o=r.length;i<o;++i)r[i]-=t;return new h.default(this.flatCoordinates.slice(t,n),this.layout,r)}},{key:"getPolygons",value:function(){for(var e=this.layout,t=this.flatCoordinates,r=this.endss_,n=[],i=0,o=0,a=r.length;o<a;++o){var s=r[o].slice(),u=s[s.length-1];if(0!==i)for(var l=0,c=s.length;l<c;++l)s[l]-=i;var f=new h.default(t.slice(i,u),e,s);n.push(f),i=u}return n}},{key:"getType",value:function(){return"MultiPolygon"}},{key:"intersectsExtent",value:function(e){return(0,f.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);t=(0,u.deflateMultiCoordinatesArray)(this.flatCoordinates,0,e,this.stride,this.endss_);0===t.length?this.flatCoordinates.length=0:(e=t[t.length-1],this.flatCoordinates.length=0===e.length?0:e[e.length-1]),this.changed()}}])&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),g}(o.default);r.default=e},{"../array.js":104,"../extent.js":131,"./MultiPoint.js":197,"./Polygon.js":200,"./SimpleGeometry.js":201,"./flat/area.js":202,"./flat/center.js":203,"./flat/closest.js":204,"./flat/contains.js":205,"./flat/deflate.js":206,"./flat/inflate.js":209,"./flat/interiorpoint.js":210,"./flat/intersectsextent.js":212,"./flat/orient.js":214,"./flat/simplify.js":217}],199:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./SimpleGeometry.js"))&&n.__esModule?n:{default:n},o=e("../extent.js"),a=e("./flat/deflate.js"),s=e("../math.js");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e,t){var r;if(this instanceof i)return(r=n.call(this)).setCoordinates(e,t),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){var e=new i(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){var i=this.flatCoordinates,e=(0,s.squaredDistance)(e,t,i[0],i[1]);if(e<n){for(var o=this.stride,a=0;a<o;++a)r[a]=i[a];return r.length=o,e}return n}},{key:"getCoordinates",value:function(){return this.flatCoordinates?this.flatCoordinates.slice():[]}},{key:"computeExtent",value:function(e){return(0,o.createOrUpdateFromCoordinate)(this.flatCoordinates,e)}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(e){return(0,o.containsXY)(e,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,a.deflateCoordinate)(this.flatCoordinates,0,e,this.stride),this.changed()}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../extent.js":131,"../math.js":267,"./SimpleGeometry.js":201,"./flat/deflate.js":206}],200:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.circular=function(e,t,r,n){r=r||32;for(var i=[],o=0;o<r;++o)(0,c.extend)(i,(0,b.offset)(e,t,2*Math.PI*o/r,n));return i.push(i[0],i[1]),new O(i,"XY",[i.length])},r.default=void 0,r.fromCircle=function(e,t,r){t=t||32;for(var n=e.getStride(),i=e.getLayout(),o=e.getCenter(),a=n*(t+1),s=new Array(a),u=0;u<a;u+=n){s[u]=0,s[u+1]=0;for(var l=2;l<n;l++)s[u+l]=o[l]}t=[s.length],i=new O(s,i,t);return P(i,o,e.getRadius(),r),i},r.fromExtent=function(e){var t=e[0],r=e[1],n=e[2],e=e[3],e=[t,r,t,e,n,e,n,r,t,r];return new O(e,"XY",[e.length])},r.makeRegular=P;var l=_(e("./LinearRing.js")),n=_(e("./Point.js")),o=_(e("./SimpleGeometry.js")),a=e("./flat/closest.js"),s=e("../extent.js"),u=e("./flat/deflate.js"),c=e("../array.js"),f=e("./flat/interiorpoint.js"),h=e("./flat/inflate.js"),p=e("./flat/intersectsextent.js"),d=e("./flat/orient.js"),y=e("./flat/area.js"),g=e("./flat/contains.js"),m=e("../math.js"),v=e("./flat/simplify.js"),b=e("../sphere.js");function _(e){return e&&e.__esModule?e:{default:e}}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=j(r),t=(e=n?(e=j(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e);var r,i=S(o);function o(e,t,r){var n;if(this instanceof o)return(n=i.call(this)).ends_=[],n.flatInteriorPointRevision_=-1,n.flatInteriorPoint_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,void 0!==t&&r?(n.setFlatCoordinates(t,e),n.ends_=r):n.setCoordinates(e,t),n;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"appendLinearRing",value:function(e){this.flatCoordinates?(0,c.extend)(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var e=new o(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,a.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,a.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,n))}},{key:"containsXY",value:function(e,t){return(0,g.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}},{key:"getArea",value:function(){return(0,y.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(e){var t;return void 0!==e?(t=this.getOrientedFlatCoordinates().slice(),(0,d.orientLinearRings)(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,(0,h.inflateCoordinatesArray)(t,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){var e;return this.flatInteriorPointRevision_!=this.getRevision()&&(e=(0,s.getCenter)(this.getExtent()),this.flatInteriorPoint_=(0,f.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()),this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new n.default(this.getFlatInteriorPoint(),"XYM")}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(e){return e<0||this.ends_.length<=e?null:new l.default(this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]),this.layout)}},{key:"getLinearRings",value:function(){for(var e=this.layout,t=this.flatCoordinates,r=this.ends_,n=[],i=0,o=0,a=r.length;o<a;++o){var s=r[o],u=new l.default(t.slice(i,s),e);n.push(u),i=s}return n}},{key:"getOrientedFlatCoordinates",value:function(){var e;return this.orientedRevision_!=this.getRevision()&&(e=this.flatCoordinates,(0,d.linearRingsAreOriented)(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=(0,d.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(e){var t=[],r=[];return t.length=(0,v.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new o(t,"XY",r)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(e){return(0,p.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}},{key:"setCoordinates",value:function(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);t=(0,u.deflateCoordinatesArray)(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=0===t.length?0:t[t.length-1],this.changed()}}])&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.default);function P(e,t,r,n){for(var i=e.getFlatCoordinates(),o=e.getStride(),a=i.length/o-1,s=n||0,u=0;u<=a;++u){var l=u*o,c=s+2*(0,m.modulo)(u,a)*Math.PI/a;i[l]=t[0]+r*Math.cos(c),i[1+l]=t[1]+r*Math.sin(c)}e.changed()}r.default=O},{"../array.js":104,"../extent.js":131,"../math.js":267,"../sphere.js":353,"./LinearRing.js":195,"./Point.js":199,"./SimpleGeometry.js":201,"./flat/area.js":202,"./flat/closest.js":204,"./flat/contains.js":205,"./flat/deflate.js":206,"./flat/inflate.js":209,"./flat/interiorpoint.js":210,"./flat/intersectsextent.js":212,"./flat/orient.js":214,"./flat/simplify.js":217}],201:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.getStrideForLayout=h,r.transformGeom2D=function(e,t,r){var n=e.getFlatCoordinates();return n?(e=e.getStride(),(0,s.transform2D)(n,0,n.length,e,t,r)):null};var n=(n=e("./Geometry.js"))&&n.__esModule?n:{default:n},o=e("../util.js"),a=e("../extent.js"),s=e("./flat/transform.js");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(){var e;if(this instanceof i)return(e=n.call(this)).layout="XY",e.stride=2,e.flatCoordinates=null,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"computeExtent",value:function(e){return(0,a.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}},{key:"getCoordinates",value:function(){return(0,o.abstract)()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(e){var t;return this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<=this.simplifiedGeometryMaxMinSquaredTolerance?this:(t=this.getSimplifiedGeometryInternal(e)).getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}},{key:"getSimplifiedGeometryInternal",value:function(e){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(e,t){this.stride=h(e),this.layout=e,this.flatCoordinates=t}},{key:"setCoordinates",value:function(e,t){(0,o.abstract)()}},{key:"setLayout",value:function(e,t,r){var n;if(e)n=h(e);else{for(var i=0;i<r;++i){if(0===t.length)return this.layout="XY",void(this.stride=2);t=t[0]}e=function(e){var t;2==e?t="XY":3==e?t="XYZ":4==e&&(t="XYZM");return t}(n=t.length)}this.layout=e,this.stride=n}},{key:"applyTransform",value:function(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(e,t){var r,n=this.getFlatCoordinates();n&&(r=this.getStride(),(0,s.rotate)(n,0,n.length,r,e,t,n),this.changed())}},{key:"scale",value:function(e,t,r){void 0===t&&(t=e),r=r||(0,a.getCenter)(this.getExtent());var n,i=this.getFlatCoordinates();i&&(n=this.getStride(),(0,s.scale)(i,0,i.length,n,e,t,r,i),this.changed())}},{key:"translate",value:function(e,t){var r,n=this.getFlatCoordinates();n&&(r=this.getStride(),(0,s.translate)(n,0,n.length,r,e,t,n),this.changed())}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function h(e){var t;return"XY"==e?t=2:"XYZ"==e||"XYM"==e?t=3:"XYZM"==e&&(t=4),t}r.default=e},{"../extent.js":131,"../util.js":379,"./Geometry.js":192,"./flat/transform.js":220}],202:[function(e,t,r){"use strict";function u(e,t,r,n){for(var i=0,o=e[r-n],a=e[r-n+1];t<r;t+=n){var s=e[t],u=e[t+1];i+=a*s-o*u,o=s,a=u}return i/2}function l(e,t,r,n){for(var i=0,o=0,a=r.length;o<a;++o){var s=r[o];i+=u(e,t,s,n),t=s}return i}Object.defineProperty(r,"__esModule",{value:!0}),r.linearRing=u,r.linearRings=l,r.linearRingss=function(e,t,r,n){for(var i=0,o=0,a=r.length;o<a;++o){var s=r[o];i+=l(e,t,s,n),t=s[s.length-1]}return i}},{}],203:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.linearRingss=function(e,t,r,n){for(var i=[],o=(0,l.createEmpty)(),a=0,s=r.length;a<s;++a){var u=r[a];o=(0,l.createOrUpdateFromFlatCoordinates)(e,t,u[0],n),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),t=u[u.length-1]}return i};var l=e("../../extent.js")},{"../../extent.js":131}],204:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.arrayMaxSquaredDelta=l,r.assignClosestArrayPoint=m,r.assignClosestMultiArrayPoint=function(e,t,r,n,i,o,a,s,u,l,c){c=c||[NaN,NaN];for(var f=0,h=r.length;f<h;++f){var p=r[f];l=m(e,t,p,n,i,o,a,s,u,l,c),t=p[p.length-1]}return l},r.assignClosestPoint=g,r.maxSquaredDelta=u,r.multiArrayMaxSquaredDelta=function(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];i=l(e,t,s,n,i),t=s[s.length-1]}return i};var y=e("../../math.js");function d(e,t,r,n,i,o,a){var s,u=e[t],l=e[t+1],c=e[r]-u,f=e[r+1]-l;if(0==c&&0==f)s=t;else{var h=((i-u)*c+(o-l)*f)/(c*c+f*f);if(1<h)s=r;else{if(0<h){for(var p=0;p<n;++p)a[p]=(0,y.lerp)(e[t+p],e[r+p],h);return void(a.length=n)}s=t}}for(var d=0;d<n;++d)a[d]=e[s+d];a.length=n}function u(e,t,r,n,i){var o=e[t],a=e[t+1];for(t+=n;t<r;t+=n){var s=e[t],u=e[t+1],l=(0,y.squaredDistance)(o,a,s,u);i<l&&(i=l),o=s,a=u}return i}function l(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];i=u(e,t,s,n,i),t=s}return i}function g(e,t,r,n,i,o,a,s,u,l,c){var f,h;if(t!=r)if(0===i){if((h=(0,y.squaredDistance)(a,s,e[t],e[t+1]))<l){for(f=0;f<n;++f)u[f]=e[t+f];return u.length=n,h}}else{c=c||[NaN,NaN];for(var p=t+n;p<r;)if(d(e,p-n,p,n,a,s,c),(h=(0,y.squaredDistance)(a,s,c[0],c[1]))<l){for(l=h,f=0;f<n;++f)u[f]=c[f];p+=u.length=n}else p+=n*Math.max((Math.sqrt(h)-Math.sqrt(l))/i|0,1);if(o&&(d(e,r-n,t,n,a,s,c),(h=(0,y.squaredDistance)(a,s,c[0],c[1]))<l)){for(l=h,f=0;f<n;++f)u[f]=c[f];u.length=n}}return l}function m(e,t,r,n,i,o,a,s,u,l,c){c=c||[NaN,NaN];for(var f=0,h=r.length;f<h;++f){var p=r[f];l=g(e,t,p,n,i,o,a,s,u,l,c),t=p}return l}},{"../../math.js":267}],205:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.linearRingContainsExtent=function(t,r,n,i,e){return!(0,o.forEachCorner)(e,function(e){return!u(t,r,n,i,e[0],e[1])})},r.linearRingContainsXY=u,r.linearRingsContainsXY=l,r.linearRingssContainsXY=function(e,t,r,n,i,o){if(0!==r.length)for(var a=0,s=r.length;a<s;++a){var u=r[a];if(l(e,t,u,n,i,o))return!0;t=u[u.length-1]}return!1};var o=e("../../extent.js");function u(e,t,r,n,i,o){for(var a=0,s=e[r-n],u=e[r-n+1];t<r;t+=n){var l=e[t],c=e[t+1];u<=o?o<c&&0<(l-s)*(o-u)-(i-s)*(c-u)&&a++:c<=o&&(l-s)*(o-u)-(i-s)*(c-u)<0&&a--,s=l,u=c}return 0!==a}function l(e,t,r,n,i,o){if(0===r.length)return!1;if(!u(e,t,r[0],n,i,o))return!1;for(var a=1,s=r.length;a<s;++a)if(u(e,r[a-1],r[a],n,i,o))return!1;return!0}},{"../../extent.js":131}],206:[function(e,t,r){"use strict";function l(e,t,r,n){for(var i=0,o=r.length;i<o;++i)for(var a=r[i],s=0;s<n;++s)e[t++]=a[s];return t}function c(e,t,r,n,i){i=i||[];for(var o=0,a=0,s=r.length;a<s;++a){var u=l(e,t,r[a],n);t=i[o++]=u}return i.length=o,i}Object.defineProperty(r,"__esModule",{value:!0}),r.deflateCoordinate=function(e,t,r,n){for(var i=0,o=r.length;i<o;++i)e[t++]=r[i];return t},r.deflateCoordinates=l,r.deflateCoordinatesArray=c,r.deflateMultiCoordinatesArray=function(e,t,r,n,i){i=i||[];for(var o=0,a=0,s=r.length;a<s;++a){var u=c(e,t,r[a],n,i[o]);0===u.length&&(u[0]=t),i[o++]=u,t=u[u.length-1]}return i.length=o,i}},{}],207:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flipXY=function(e,t,r,n,i,o){o=void 0!==i?void 0!==o?o:0:(i=[],0);var a=t;for(;a<r;){var s=e[a++];i[o++]=e[a++],i[o++]=s;for(var u=2;u<n;++u)i[o++]=e[a++]}return i.length=o,i}},{}],208:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.greatCircleArc=function(i,e,o,a,t,r){var n=(0,d.get)("EPSG:4326"),s=Math.cos((0,v.toRadians)(e)),u=Math.sin((0,v.toRadians)(e)),l=Math.cos((0,v.toRadians)(a)),c=Math.sin((0,v.toRadians)(a)),f=Math.cos((0,v.toRadians)(o-i)),h=Math.sin((0,v.toRadians)(o-i)),p=u*c+s*l*f;return y(function(e){var t,r,n;return 1<=p?[o,a]:(e=e*Math.acos(p),t=Math.cos(e),e=Math.sin(e),n=Math.atan2(h*l,s*c-u*l*f),r=Math.asin(u*t+s*e*Math.cos(n)),n=(0,v.toRadians)(i)+Math.atan2(Math.sin(n)*e*s,t-u*Math.sin(r)),[(0,v.toDegrees)(n),(0,v.toDegrees)(r)])},(0,d.getTransform)(n,t),r)},r.meridian=function(t,r,n,e,i){var o=(0,d.get)("EPSG:4326");return y(function(e){return[t,r+(n-r)*e]},(0,d.getTransform)(o,e),i)},r.parallel=function(t,r,n,e,i){var o=(0,d.get)("EPSG:4326");return y(function(e){return[r+(n-r)*e,t]},(0,d.getTransform)(o,e),i)};var d=e("../../proj.js"),v=e("../../math.js");function y(e,t,r){for(var n,i,o,a,s,u,l=[],c=e(0),f=e(1),h=t(c),p=[f,c],d=[t(f),h],y=[1,0],g={},m=1e5;0<--m&&0<y.length;)a=y.pop(),c=p.pop(),h=d.pop(),(u=a.toString())in g||(l.push(h[0],h[1]),g[u]=!0),u=y.pop(),f=p.pop(),n=d.pop(),o=t(i=e(s=(a+u)/2)),(0,v.squaredSegmentDistance)(o[0],o[1],h[0],h[1],n[0],n[1])<r?(l.push(n[0],n[1]),g[u.toString()]=!0):(y.push(u,s,s,a),d.push(n,o,o,h),p.push(f,i,i,c));return l}},{"../../math.js":267,"../../proj.js":271}],209:[function(e,t,r){"use strict";function l(e,t,r,n,i){i=void 0!==i?i:[];for(var o=0,a=t;a<r;a+=n)i[o++]=e.slice(a,a+n);return i.length=o,i}function c(e,t,r,n,i){i=void 0!==i?i:[];for(var o=0,a=0,s=r.length;a<s;++a){var u=r[a];i[o++]=l(e,t,u,n,i[o]),t=u}return i.length=o,i}Object.defineProperty(r,"__esModule",{value:!0}),r.inflateCoordinates=l,r.inflateCoordinatesArray=c,r.inflateMultiCoordinatesArray=function(e,t,r,n,i){i=void 0!==i?i:[];for(var o=0,a=0,s=r.length;a<s;++a){var u=r[a];i[o++]=1===u.length&&u[0]===t?[]:c(e,t,u,n,i[o]),t=u[u.length-1]}return i.length=o,i}},{}],210:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getInteriorPointOfArray=l,r.getInteriorPointsOfMultiArray=function(e,t,r,n,i){for(var o=[],a=0,s=r.length;a<s;++a){var u=r[a];o=l(e,t,u,n,i,2*a,o),t=u[u.length-1]}return o};var x=e("./contains.js"),S=e("../../array.js");function l(e,t,r,n,i,o,a){for(var s,u,l,c=i[o+1],f=[],h=0,p=r.length;h<p;++h)for(var d=r[h],y=e[d-n],g=e[d-n+1],m=t;m<d;m+=n)_=e[m],l=e[m+1],(c<=g&&l<=c||g<=c&&c<=l)&&f.push(u=(c-g)/(l-g)*(_-y)+y),y=_,g=l;var v=NaN,b=-1/0;for(f.sort(S.numberSafeCompareFunction),y=f[0],m=1,s=f.length;m<s;++m){var _=f[m],w=Math.abs(_-y);b<w&&(0,x.linearRingsContainsXY)(e,t,r,n,u=(y+_)/2,c)&&(v=u,b=w),y=_}return isNaN(v)&&(v=i[o]),a?(a.push(v,c,b),a):[v,c,b]}},{"../../array.js":104,"./contains.js":205}],211:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.interpolatePoint=function(e,t,r,n,i,o,a){var s,u,l=(r-t)/n;if(1==l)s=t;else if(2==l)s=t,u=i;else if(0!=l){for(var c=e[t],f=e[t+1],h=0,p=[0],d=t+n;d<r;d+=n){var y=e[d],g=e[d+1];h+=Math.sqrt((y-c)*(y-c)+(g-f)*(g-f)),p.push(h),c=y,f=g}l=i*h,i=(0,v.binarySearch)(p,l);s=i<0?(u=(l-p[-i-2])/(p[-i-1]-p[-i-2]),t+(-i-2)*n):t+i*n}a=1<a?a:2,o=o||new Array(a);for(var m=0;m<a;++m)o[m]=void 0===s?NaN:void 0===u?e[s+m]:(0,b.lerp)(e[s+m],e[s+n+m],u);return o},r.lineStringCoordinateAtM=f,r.lineStringsCoordinateAtM=function(e,t,r,n,i,o,a){if(a)return f(e,t,r[r.length-1],n,i,o);var s;if(i<e[n-1])return o?((s=e.slice(0,n))[n-1]=i,s):null;if(e[e.length-1]<i)return o?((s=e.slice(e.length-n))[n-1]=i,s):null;for(var u=0,l=r.length;u<l;++u){var c=r[u];if(t!=c){if(i<e[t+n-1])return null;if(i<=e[c-1])return f(e,t,c,n,i,!1);t=c}}return null};var v=e("../../array.js"),b=e("../../math.js");function f(e,t,r,n,i,o){if(r==t)return null;if(i<e[t+n-1])return o?((c=e.slice(t,t+n))[n-1]=i,c):null;if(e[r-1]<i)return o?((c=e.slice(r-n,r))[n-1]=i,c):null;if(i==e[t+n-1])return e.slice(t,t+n);for(var a=t/n,s=r/n;a<s;){var u=a+s>>1;i<e[(1+u)*n-1]?s=u:a=1+u}o=e[a*n-1];if(i==o)return e.slice((a-1)*n,(a-1)*n+n);for(var l=(i-o)/(e[(a+1)*n-1]-o),c=[],f=0;f<n-1;++f)c.push((0,b.lerp)(e[(a-1)*n+f],e[a*n+f],l));return c.push(i),c}},{"../../array.js":104,"../../math.js":267}],212:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.intersectsLineString=l,r.intersectsLineStringArray=function(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o){if(l(e,t,r[o],n,i))return!0;t=r[o]}return!1},r.intersectsLinearRing=c,r.intersectsLinearRingArray=f,r.intersectsLinearRingMultiArray=function(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];if(f(e,t,s,n,i))return!0;t=s[s.length-1]}return!1};var a=e("../../extent.js"),s=e("./segments.js"),u=e("./contains.js");function l(e,t,r,n,i){var o=(0,a.extendFlatCoordinates)((0,a.createEmpty)(),e,t,r,n);return!!(0,a.intersects)(i,o)&&(!!(0,a.containsExtent)(i,o)||o[0]>=i[0]&&o[2]<=i[2]||o[1]>=i[1]&&o[3]<=i[3]||(0,s.forEach)(e,t,r,n,function(e,t){return(0,a.intersectsSegment)(i,e,t)}))}function c(e,t,r,n,i){return!!l(e,t,r,n,i)||!!((0,u.linearRingContainsXY)(e,t,r,n,i[0],i[1])||(0,u.linearRingContainsXY)(e,t,r,n,i[0],i[3])||(0,u.linearRingContainsXY)(e,t,r,n,i[2],i[1])||(0,u.linearRingContainsXY)(e,t,r,n,i[2],i[3]))}function f(e,t,r,n,i){if(!c(e,t,r[0],n,i))return!1;if(1!==r.length)for(var o=1,a=r.length;o<a;++o)if((0,u.linearRingContainsExtent)(e,r[o-1],r[o],n,i)&&!l(e,r[o-1],r[o],n,i))return!1;return!0}},{"../../extent.js":131,"./contains.js":205,"./segments.js":216}],213:[function(e,t,r){"use strict";function a(e,t,r,n){for(var i=e[t],o=e[t+1],a=0,s=t+n;s<r;s+=n){var u=e[s],l=e[s+1];a+=Math.sqrt((u-i)*(u-i)+(l-o)*(l-o)),i=u,o=l}return a}Object.defineProperty(r,"__esModule",{value:!0}),r.lineStringLength=a,r.linearRingLength=function(e,t,r,n){var i=a(e,t,r,n),o=e[r-n]-e[t],r=e[r-n+1]-e[t+1];return i+=Math.sqrt(o*o+r*r)}},{}],214:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.inflateEnds=function(e,t){for(var r=[],n=0,i=0,o=0,a=t.length;o<a;++o){var s=t[o];if(c(e,n,s,2)){if(0===r.length)continue;r[r.length-1].push(t[i])}else r.push(t.slice(i,o+1));i=o+1,n=s}return r},r.linearRingIsClockwise=c,r.linearRingsAreOriented=u,r.linearRingssAreOriented=function(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];if(!u(e,t,s,n,i))return!1;s.length&&(t=s[s.length-1])}return!0},r.orientLinearRings=s,r.orientLinearRingsArray=function(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o)t=s(e,t,r[o],n,i);return t};var l=e("./reverse.js");function c(e,t,r,n){for(var i=0,o=e[r-n],a=e[r-n+1];t<r;t+=n){var s=e[t],u=e[t+1];i+=(s-o)*(u+a),o=s,a=u}return 0===i?void 0:0<i}function u(e,t,r,n,i){i=void 0!==i&&i;for(var o=0,a=r.length;o<a;++o){var s=r[o],u=c(e,t,s,n);if(0===o){if(i&&u||!i&&!u)return!1}else if(i&&!u||!i&&u)return!1;t=s}return!0}function s(e,t,r,n,i){i=void 0!==i&&i;for(var o=0,a=r.length;o<a;++o){var s=r[o],u=c(e,t,s,n);(0===o?i&&u||!i&&!u:i&&!u||!i&&u)&&(0,l.coordinates)(e,t,s,n),t=s}return t}},{"./reverse.js":215}],215:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.coordinates=function(e,t,r,n){for(;t<r-n;){for(var i=0;i<n;++i){var o=e[t+i];e[t+i]=e[r-n+i],e[r-n+i]=o}t+=n,r-=n}}},{}],216:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEach=function(e,t,r,n,i){var o;for(t+=n;t<r;t+=n)if(o=i(e.slice(t-n,t),e.slice(t,t+n)))return o;return!1}},{}],217:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.douglasPeucker=f,r.douglasPeuckerArray=h,r.douglasPeuckerMultiArray=function(e,t,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u],f=[];a=h(e,t,c,n,i,o,a,f),s.push(f),t=c[c.length-1]}return a},r.quantize=p,r.quantizeArray=d,r.quantizeMultiArray=function(e,t,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u],f=[];a=d(e,t,c,n,i,o,a,f),s.push(f),t=c[c.length-1]}return a},r.radialDistance=s,r.simplifyLineString=function(e,t,r,n,i,o,a){a=void 0!==a?a:[],o||(r=s(e,t,r,n,i,a,0),e=a,t=0,n=2);return a.length=f(e,t,r,n,i,a,0),a},r.snap=m;var x=e("../../math.js");function f(e,t,r,n,i,o,a){var s=(r-t)/n;if(s<3)for(;t<r;t+=n)o[a++]=e[t],o[a++]=e[t+1];else{for(var u=new Array(s),l=(u[0]=1,u[s-1]=1,[t,r-n]),c=0;0<l.length;){for(var f=l.pop(),h=l.pop(),p=0,d=e[h],y=e[h+1],g=e[f],m=e[f+1],v=h+n;v<f;v+=n){var b=e[v],_=e[v+1],b=(0,x.squaredSegmentDistance)(b,_,d,y,g,m);p<b&&(c=v,p=b)}i<p&&(u[(c-t)/n]=1,h+n<c&&l.push(h,c),c+n<f)&&l.push(c,f)}for(var w=0;w<s;++w)u[w]&&(o[a++]=e[t+w*n],o[a++]=e[t+w*n+1])}return a}function h(e,t,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u];a=f(e,t,c,n,i,o,a),s.push(a),t=c}return a}function s(e,t,r,n,i,o,a){if(r<=t+n)for(;t<r;t+=n)o[a++]=e[t],o[a++]=e[t+1];else{var s=e[t],u=e[t+1],l=o[a++]=s,c=o[a++]=u;for(t+=n;t<r;t+=n)l=e[t],c=e[t+1],(0,x.squaredDistance)(s,u,l,c)>i&&(s=o[a++]=l,u=o[a++]=c);l==s&&c==u||(o[a++]=l,o[a++]=c)}return a}function m(e,t){return t*Math.round(e/t)}function p(e,t,r,n,i,o,a){if(t!=r){var s,u=m(e[t],i),l=m(e[t+1],i);t+=n,o[a++]=u,o[a++]=l;do{if(s=m(e[t],i),d=m(e[t+1],i),(t+=n)==r)return o[a++]=s,o[a++]=d,a}while(s==u&&d==l);for(;t<r;){var c,f,h,p,d,y=m(e[t],i),g=m(e[t+1],i);t+=n,y==s&&g==d||(s=((c=s-u)*(p=g-l)==(f=d-l)*(h=y-u)&&(c<0&&h<c||c==h||0<c&&c<h)&&(f<0&&p<f||f==p||0<f&&f<p)||(u=o[a++]=s,l=o[a++]=d),y),d=g)}o[a++]=s,o[a++]=d}return a}function d(e,t,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u];a=p(e,t,c,n,i,o,a),s.push(a),t=c}return a}},{"../../math.js":267}],218:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.matchingChunk=function(e,t,r,n,i){var o,a,s,u,l,c,f,h,p,d,y=r,g=r,m=0,v=0,b=r;for(a=r;a<n;a+=i){var _=t[a],w=t[a+1];void 0!==l&&(p=_-l,d=w-c,u=Math.sqrt(p*p+d*d),void 0!==f&&(v+=s,o=Math.acos((f*p+h*d)/(s*u)),e<o)&&(m<v&&(m=v,y=b,g=a),v=0,b=a-i),s=u,f=p,h=d),l=_,c=w}return(v+=u)>m?[b,a]:[y,g]}},{}],219:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.drawTextOnPath=function(e,t,r,n,i,o,D,a,s,u,l,c){var f=e[t],h=e[t+1],p=0,d=0,y=0,g=0;function m(){p=f,d=h,f=e[t+=n],h=e[t+1],g+=y,y=Math.sqrt((f-p)*(f-p)+(h-d)*(h-d))}for(;m(),t<r-n&&g+y<o;);var v=0===y?0:(o-g)/y,b=(0,U.lerp)(p,f,v),_=(0,U.lerp)(d,h,v),w=t-n,F=g,x=o+a*s(u,i,l);for(;t<r-n&&g+y<x;)m();v=0===y?0:(x-g)/y;var S,j=(0,U.lerp)(p,f,v),O=(0,U.lerp)(d,h,v);{var P;S=c?(P=[b,_,j,O],(0,z.rotate)(P,0,4,2,c,P,P),P[2]<P[0]):j<b}var k,E=Math.PI,T=[],c=w+n===t;if(y=0,g=F,f=e[t=w],h=e[t+1],c)m(),k=Math.atan2(h-d,f-p),S&&(k+=0<k?-E:E),T[0]=[(j+b)/2,(O+_)/2,(x-o)/2,k,i];else{i=i.replace(/\n/g," ");for(var C=0,R=i.length;C<R;){m();var M=Math.atan2(h-d,f-p);if(S&&(M+=0<M?-E:E),void 0!==k){var I=M-k;if(I+=E<I?-2*E:I<-E?2*E:0,Math.abs(I)>D)return null}k=M;for(var A,N,B,I=C,L=0;C<R;++C){var G=a*s(u,i[S?R-C-1:C],l);if(t+n<r&&g+y<o+L+G/2)break;L+=G}C!==I&&(A=S?i.substring(R-I,R-C):i.substring(I,C),v=0===y?0:(o+L/2-g)/y,N=(0,U.lerp)(p,f,v),B=(0,U.lerp)(d,h,v),T.push([N,B,L/2,M,A]),o+=L)}}return T};var U=e("../../math.js"),z=e("./transform.js")},{"../../math.js":267,"./transform.js":220}],220:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rotate=function(e,t,r,n,i,o,a){a=a||[];for(var s=Math.cos(i),u=Math.sin(i),l=o[0],c=o[1],f=0,h=t;h<r;h+=n){var p=e[h]-l,d=e[h+1]-c;a[f++]=l+p*s-d*u,a[f++]=c+p*u+d*s;for(var y=h+2;y<h+n;++y)a[f++]=e[y]}a&&a.length!=f&&(a.length=f);return a},r.scale=function(e,t,r,n,i,o,a,s){s=s||[];for(var u=a[0],l=a[1],c=0,f=t;f<r;f+=n){var h=e[f]-u,p=e[f+1]-l;s[c++]=u+i*h,s[c++]=l+o*p;for(var d=f+2;d<f+n;++d)s[c++]=e[d]}s&&s.length!=c&&(s.length=c);return s},r.transform2D=function(e,t,r,n,i,o){o=o||[];for(var a=0,s=t;s<r;s+=n){var u=e[s],l=e[s+1];o[a++]=i[0]*u+i[2]*l+i[4],o[a++]=i[1]*u+i[3]*l+i[5]}o&&o.length!=a&&(o.length=a);return o},r.translate=function(e,t,r,n,i,o,a){a=a||[];for(var s=0,u=t;u<r;u+=n){a[s++]=e[u]+i,a[s++]=e[u+1]+o;for(var l=u+2;l<u+n;++l)a[s++]=e[l]}a&&a.length!=s&&(a.length=s);return a}},{}],221:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WORKER_OFFSCREEN_CANVAS=r.WEBKIT=r.SAFARI_BUG_237906=r.SAFARI=r.PASSIVE_EVENT_LISTENERS=r.MAC=r.IMAGE_DECODE=r.FIREFOX=r.DEVICE_PIXEL_RATIO=void 0;var n="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",i=n.includes("firefox"),i=(r.FIREFOX=i,n.includes("safari")&&!n.includes("chrom")),i=(r.SAFARI=i)&&(n.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(n)),i=(r.SAFARI_BUG_237906=i,n.includes("webkit")&&!n.includes("edge")),i=(r.WEBKIT=i,n.includes("macintosh")),n=(r.MAC=i,"undefined"!=typeof devicePixelRatio?devicePixelRatio:1),i=(r.DEVICE_PIXEL_RATIO=n,"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope),n=(r.WORKER_OFFSCREEN_CANVAS=i,"undefined"!=typeof Image&&Image.prototype.decode),i=(r.IMAGE_DECODE=n,function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch(e){}return e}());r.PASSIVE_EVENT_LISTENERS=i},{}],222:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"AssertionError",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"Collection",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"Disposable",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"Feature",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"Geolocation",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"Graticule",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"ImageBase",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"ImageCanvas",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"ImageTile",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"Kinetic",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"Map",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"MapBrowserEvent",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"MapBrowserEventHandler",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"MapEvent",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"Object",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(r,"Observable",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(r,"Overlay",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(r,"Tile",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(r,"TileCache",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(r,"TileQueue",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(r,"TileRange",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(r,"VERSION",{enumerable:!0,get:function(){return E.VERSION}}),Object.defineProperty(r,"VectorRenderTile",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(r,"VectorTile",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(r,"View",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(r,"getUid",{enumerable:!0,get:function(){return E.getUid}});var n=T(e("./AssertionError.js")),i=T(e("./Collection.js")),o=T(e("./Disposable.js")),a=T(e("./Feature.js")),s=T(e("./Geolocation.js")),u=T(e("./layer/Graticule.js")),l=T(e("./Image.js")),c=T(e("./ImageBase.js")),f=T(e("./ImageCanvas.js")),h=T(e("./ImageTile.js")),p=T(e("./Kinetic.js")),d=T(e("./Map.js")),y=T(e("./MapBrowserEvent.js")),g=T(e("./MapBrowserEventHandler.js")),m=T(e("./MapEvent.js")),v=T(e("./Object.js")),b=T(e("./Observable.js")),_=T(e("./Overlay.js")),w=T(e("./Tile.js")),x=T(e("./TileCache.js")),S=T(e("./TileQueue.js")),j=T(e("./TileRange.js")),O=T(e("./VectorRenderTile.js")),P=T(e("./VectorTile.js")),k=T(e("./View.js")),E=e("./util.js");function T(e){return e&&e.__esModule?e:{default:e}}},{"./AssertionError.js":70,"./Collection.js":71,"./Disposable.js":74,"./Feature.js":75,"./Geolocation.js":76,"./Image.js":77,"./ImageBase.js":78,"./ImageCanvas.js":79,"./ImageTile.js":81,"./Kinetic.js":82,"./Map.js":83,"./MapBrowserEvent.js":84,"./MapBrowserEventHandler.js":85,"./MapEvent.js":87,"./Object.js":90,"./Observable.js":92,"./Overlay.js":93,"./Tile.js":94,"./TileCache.js":95,"./TileQueue.js":96,"./TileRange.js":97,"./VectorRenderTile.js":99,"./VectorTile.js":100,"./View.js":101,"./layer/Graticule.js":252,"./util.js":379}],223:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"DoubleClickZoom",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"DragAndDrop",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"DragBox",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"DragPan",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"DragRotate",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"DragRotateAndZoom",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"DragZoom",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"Draw",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"Extent",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"Interaction",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"KeyboardPan",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"KeyboardZoom",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"Link",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"Modify",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"MouseWheelZoom",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"PinchRotate",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(r,"PinchZoom",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(r,"Pointer",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(r,"Select",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(r,"Snap",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(r,"Translate",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(r,"defaults",{enumerable:!0,get:function(){return j.defaults}});var n=O(e("./interaction/DoubleClickZoom.js")),i=O(e("./interaction/DragAndDrop.js")),o=O(e("./interaction/DragBox.js")),a=O(e("./interaction/DragPan.js")),s=O(e("./interaction/DragRotate.js")),u=O(e("./interaction/DragRotateAndZoom.js")),l=O(e("./interaction/DragZoom.js")),c=O(e("./interaction/Draw.js")),f=O(e("./interaction/Extent.js")),h=O(e("./interaction/Interaction.js")),p=O(e("./interaction/KeyboardPan.js")),d=O(e("./interaction/KeyboardZoom.js")),y=O(e("./interaction/Link.js")),g=O(e("./interaction/Modify.js")),m=O(e("./interaction/MouseWheelZoom.js")),v=O(e("./interaction/PinchRotate.js")),b=O(e("./interaction/PinchZoom.js")),_=O(e("./interaction/Pointer.js")),w=O(e("./interaction/Select.js")),x=O(e("./interaction/Snap.js")),S=O(e("./interaction/Translate.js")),j=e("./interaction/defaults.js");function O(e){return e&&e.__esModule?e:{default:e}}},{"./interaction/DoubleClickZoom.js":224,"./interaction/DragAndDrop.js":225,"./interaction/DragBox.js":226,"./interaction/DragPan.js":227,"./interaction/DragRotate.js":228,"./interaction/DragRotateAndZoom.js":229,"./interaction/DragZoom.js":230,"./interaction/Draw.js":231,"./interaction/Extent.js":232,"./interaction/Interaction.js":233,"./interaction/KeyboardPan.js":234,"./interaction/KeyboardZoom.js":235,"./interaction/Link.js":236,"./interaction/Modify.js":237,"./interaction/MouseWheelZoom.js":238,"./interaction/PinchRotate.js":239,"./interaction/PinchZoom.js":240,"./interaction/Pointer.js":241,"./interaction/Select.js":243,"./interaction/Snap.js":244,"./interaction/Translate.js":245,"./interaction/defaults.js":246}],224:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Interaction.js")),s=(e=e("../MapBrowserEventType.js"))&&e.__esModule?e:{default:e};function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).delta_=(e=e||{}).delta||1,t.duration_=void 0!==e.duration?e.duration:250,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleEvent",value:function(e){var t,r,n,i=!1;return e.type==s.default.DBLCLICK&&(t=e.originalEvent,n=e.map,e=e.coordinate,r=t.shiftKey?-this.delta_:this.delta_,n=n.getView(),(0,o.zoomByDelta)(n,r,e,this.duration_),t.preventDefault(),i=!0),!i}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../MapBrowserEventType.js":86,"./Interaction.js":233}],225:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.DragAndDropEvent=void 0;var n=a(e("../events/Event.js")),u=a(e("../events/EventType.js")),o=a(e("./Interaction.js")),l=e("../functions.js"),c=e("../proj.js"),f=e("../events.js");function a(e){return e&&e.__esModule?e:{default:e}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b="addfeatures",_=function(){y(o,n["default"]);var i=m(o);function o(e,t,r,n){return d(this,o),(e=i.call(this,e)).features=r,e.file=t,e.projection=n,e}return p(o)}(),e=(r.DragAndDropEvent=_,function(){y(s,o["default"]);var a=m(s);function s(e){d(this,s),e=e||{},(t=a.call(this,{handleEvent:l.TRUE})).on,t.once,t.un,t.readAsBuffer_=!1,t.formats_=[];for(var t,r=e.formatConstructors||[],n=0,i=r.length;n<i;++n){var o=r[n];"function"==typeof o&&(o=new o),t.formats_.push(o),t.readAsBuffer_=t.readAsBuffer_||"arraybuffer"===o.getType()}return t.projection_=e.projection?(0,c.get)(e.projection):null,t.dropListenKeys_=null,t.source_=e.source||null,t.target=e.target||null,t}return p(s,[{key:"handleResult_",value:function(e,t){for(var r,n=t.target.result,t=this.getMap(),i=this.projection_,o=(i=(i=i||(0,c.getUserProjection)())||t.getView().getProjection(),this.formats_),a=0,s=o.length;a<s;++a){var u=o[a],l=n,u=(this.readAsBuffer_&&"arraybuffer"!==u.getType()&&(l=r=void 0===r?(new TextDecoder).decode(n):r),this.tryReadFeatures_(u,l,{featureProjection:i}));if(u&&0<u.length){this.source_&&(this.source_.clear(),this.source_.addFeatures(u)),this.dispatchEvent(new _(b,e,u,i));break}}}},{key:"registerListeners_",value:function(){var e=this.getMap();e&&(e=this.target||e.getViewport(),this.dropListenKeys_=[(0,f.listen)(e,u.default.DROP,this.handleDrop,this),(0,f.listen)(e,u.default.DRAGENTER,this.handleStop,this),(0,f.listen)(e,u.default.DRAGOVER,this.handleStop,this),(0,f.listen)(e,u.default.DROP,this.handleStop,this)])}},{key:"setActive",value:function(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),h(v(s.prototype),"setActive",this).call(this,e)}},{key:"setMap",value:function(e){this.unregisterListeners_(),h(v(s.prototype),"setMap",this).call(this,e),this.getActive()&&this.registerListeners_()}},{key:"tryReadFeatures_",value:function(e,t,r){try{return e.readFeatures(t,r)}catch(e){return null}}},{key:"unregisterListeners_",value:function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(f.unlistenByKey),this.dropListenKeys_=null)}},{key:"handleDrop",value:function(e){for(var t=e.dataTransfer.files,r=0,n=t.length;r<n;++r){var i=t.item(r),o=new FileReader;o.addEventListener(u.default.LOAD,this.handleResult_.bind(this,i)),this.readAsBuffer_?o.readAsArrayBuffer(i):o.readAsText(i)}}},{key:"handleStop",value:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}]),s}());r.default=e},{"../events.js":125,"../events/Event.js":126,"../events/EventType.js":127,"../functions.js":189,"../proj.js":271,"./Interaction.js":233}],226:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.DragBoxEvent=void 0;var o=n(e("../events/Event.js")),a=n(e("./Pointer.js")),s=n(e("../render/Box.js")),u=e("../events/condition.js");function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g="boxstart",m="boxdrag",v="boxend",b="boxcancel",_=function(){h(i,o["default"]);var n=d(i);function i(e,t,r){return f(this,i),(e=n.call(this,e)).coordinate=t,e.mapBrowserEvent=r,e}return c(i)}(),e=(r.DragBoxEvent=_,function(){h(n,a["default"]);var r=d(n);function n(e){var t;return f(this,n),(t=r.call(this)).on,t.once,t.un,t.box_=new s.default((e=e||{}).className||"ol-dragbox"),t.minArea_=void 0!==e.minArea?e.minArea:64,e.onBoxEnd&&(t.onBoxEnd=e.onBoxEnd),t.startPixel_=null,t.condition_=e.condition||u.mouseActionButton,t.boxEndCondition_=e.boxEndCondition||t.defaultBoxEndCondition,t}return c(n,[{key:"defaultBoxEndCondition",value:function(e,t,r){var n=r[0]-t[0],r=r[1]-t[1];return n*n+r*r>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(e){this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new _(m,e.coordinate,e))}},{key:"handleUpEvent",value:function(e){this.box_.setMap(null);var t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new _(t?v:b,e.coordinate,e)),!1}},{key:"handleDownEvent",value:function(e){return!!this.condition_(e)&&(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new _(g,e.coordinate,e)),!0)}},{key:"onBoxEnd",value:function(e){}}]),n}());r.default=e},{"../events/Event.js":126,"../events/condition.js":130,"../render/Box.js":280,"./Pointer.js":241}],227:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Pointer.js")),s=e("../functions.js"),u=e("../events/condition.js"),l=e("../easing.js"),c=e("../coordinate.js");function f(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(f=function(e){return e?r:t})(e))}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this,{stopDown:s.FALSE})).kinetic_=(e=e||{}).kinetic,t.lastCentroid=null,t.lastPointersCount_,t.panning_=!1;var r=e.condition||(0,u.all)(u.noModifierKeys,u.primaryAction);return t.condition_=e.onFocusOnly?(0,u.all)(u.focusWithTabindex,r):r,t.noKinetic_=!1,t}return t=i,(e=[{key:"handleDragEvent",value:function(e){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var t,r,n=this.targetPointers,i=(0,o.centroid)(n);n.length==this.lastPointersCount_?(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid&&(t=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],r=e.map.getView(),(0,c.scale)(t,r.getResolution()),(0,c.rotate)(t,r.getRotation()),r.adjustCenterInternal(t))):this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=i,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(e){var t,r,n,e=e.map,i=e.getView();return 0===this.targetPointers.length?(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()&&(t=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),n=i.getCenterInternal(),n=e.getPixelFromCoordinateInternal(n),e=e.getCoordinateFromPixelInternal([n[0]-t*Math.cos(r),n[1]-t*Math.sin(r)]),i.animateInternal({center:i.getConstrainedCenter(e),duration:500,easing:l.easeOut})),this.panning_&&(this.panning_=!1,i.endInteraction()),!1):(this.kinetic_&&this.kinetic_.begin(),!(this.lastCentroid=null))}},{key:"handleDownEvent",value:function(e){return!!(0<this.targetPointers.length&&this.condition_(e))&&(e=e.map.getView(),this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=1<this.targetPointers.length,!0)}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../coordinate.js":121,"../easing.js":124,"../events/condition.js":130,"../functions.js":189,"./Pointer.js":241}],228:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Pointer.js"))&&n.__esModule?n:{default:n},o=e("../functions.js"),a=e("../events/condition.js"),s=e("../rotationconstraint.js");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this,{stopDown:o.FALSE})).condition_=e.condition||a.altShiftKeysOnly,t.lastAngle_=void 0,t.duration_=void 0!==e.duration?e.duration:250,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleDragEvent",value:function(e){var t,r;(0,a.mouseOnly)(e)&&(t=(r=e.map).getView()).getConstraints().rotation!==s.disable&&(r=r.getSize(),e=e.pixel,e=Math.atan2(r[1]/2-e[1],e[0]-r[0]/2),void 0!==this.lastAngle_&&(r=e-this.lastAngle_,t.adjustRotationInternal(-r)),this.lastAngle_=e)}},{key:"handleUpEvent",value:function(e){return!(0,a.mouseOnly)(e)||(e.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(e){return!!(0,a.mouseOnly)(e)&&!(!(0,a.mouseActionButton)(e)||!this.condition_(e)||(e.map.getView().beginInteraction(),this.lastAngle_=void 0))}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../events/condition.js":130,"../functions.js":189,"../rotationconstraint.js":318,"./Pointer.js":241}],229:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Pointer.js"))&&n.__esModule?n:{default:n},o=e("../events/condition.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,e=e||{})).condition_=e.condition||o.shiftKeyOnly,t.lastAngle_=void 0,t.lastMagnitude_=void 0,t.lastScaleDelta_=0,t.duration_=void 0!==e.duration?e.duration:400,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleDragEvent",value:function(e){var t,r,n;(0,o.mouseOnly)(e)&&(r=(n=e.map).getSize(),t=(e=e.pixel)[0]-r[0]/2,r=r[1]/2-e[1],e=Math.atan2(r,t),t=Math.sqrt(t*t+r*r),r=n.getView(),void 0!==this.lastAngle_&&(n=this.lastAngle_-e,r.adjustRotationInternal(n)),this.lastAngle_=e,void 0!==this.lastMagnitude_&&r.adjustResolutionInternal(this.lastMagnitude_/t),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/t),this.lastMagnitude_=t)}},{key:"handleUpEvent",value:function(e){var t;return!(0,o.mouseOnly)(e)||(e=e.map.getView(),t=1<this.lastScaleDelta_?1:-1,e.endInteraction(this.duration_,t),this.lastScaleDelta_=0,!1)}},{key:"handleDownEvent",value:function(e){return!!(0,o.mouseOnly)(e)&&!(!this.condition_(e)||(e.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0))}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../events/condition.js":130,"./Pointer.js":241}],230:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./DragBox.js"))&&n.__esModule?n:{default:n},o=e("../easing.js"),a=e("../events/condition.js");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(this instanceof i)return t=(e=e||{}).condition||a.shiftKeyOnly,(t=n.call(this,{condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea})).duration_=void 0!==e.duration?e.duration:200,t.out_=void 0!==e.out&&e.out,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"onBoxEnd",value:function(e){var t,r=this.getMap().getView(),n=this.getGeometry();this.out_&&(t=r.rotatedExtentForGeometry(n),t=r.getResolutionForExtentInternal(t),t=r.getResolution()/t,(n=n.clone()).scale(t*t)),r.fitInternal(n,{duration:this.duration_,easing:o.easeOut})}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../easing.js":124,"../events/condition.js":130,"./DragBox.js":226}],231:[function(e,D,t){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DrawEvent=void 0,t.createBox=function(){return function(e,t,r){e=(0,o.boundingExtent)([e[0],e[e.length-1]].map(function(e){return(0,p.fromUserCoordinate)(e,r)})),e=[[(0,o.getBottomLeft)(e),(0,o.getBottomRight)(e),(0,o.getTopRight)(e),(0,o.getTopLeft)(e),(0,o.getBottomLeft)(e)]],t?t.setCoordinates(e):t=new w.default(e),e=(0,p.getUserProjection)();return e&&t.transform(r,e),t}},t.createRegularPolygon=function(s,u){return function(e,t,r){var n,i=(0,p.fromUserCoordinate)(e[0],r),e=(0,p.fromUserCoordinate)(e[e.length-1],r),o=Math.sqrt((0,x.squaredDistance)(i,e)),a=(t=t||(0,w.fromCircle)(new l.default(i),s),u),e=(u||0===u||(n=e[0]-i[0],e=e[1]-i[1],a=Math.atan2(e,n)),(0,w.makeRegular)(t,i,o,a),(0,p.getUserProjection)());return e&&t.transform(r,e),t}},t.default=void 0;var l=r(e("../geom/Circle.js")),F=r(e("../events/Event.js")),N=r(e("../events/EventType.js")),n=r(e("../Feature.js")),B=r(e("../geom/GeometryCollection.js")),G=r(e("./Property.js")),v=r(e("../geom/LineString.js")),U=r(e("../MapBrowserEvent.js")),i=r(e("../MapBrowserEventType.js")),b=r(e("../geom/MultiLineString.js")),z=r(e("../geom/MultiPoint.js")),_=r(e("../geom/MultiPolygon.js")),u=r(e("../geom/Point.js")),W=r(e("./Pointer.js")),w=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("../geom/Polygon.js")),V=r(e("../layer/Vector.js")),H=r(e("../source/Vector.js")),c=e("../functions.js"),f=e("../events/condition.js"),o=e("../extent.js"),h=e("../math.js"),q=e("../style/Style.js"),x=e("../coordinate.js"),p=e("../proj.js"),d=e("../geom/SimpleGeometry.js");function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}function r(e){return e&&e.__esModule?e:{default:e}}function y(){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function m(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=k(r),t=(e=n?(e=k(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y="drawstart",X="drawend",Z="drawabort",E=function(){j(n,F["default"]);var r=P(n);function n(e,t){return S(this,n),(e=r.call(this,e)).feature=t,e}return m(n)}();function K(e,t){for(var r=[],n=0;n<t.length;++n)!function e(t,r,n){if(r instanceof v.default)return void I(t,r.getCoordinates(),!1,n);if(r instanceof b.default){for(var i=r.getCoordinates(),o=0,a=i.length;o<a;++o)I(t,i[o],!1,n);return}if(r instanceof w.default){for(var s=r.getCoordinates(),u=0,l=s.length;u<l;++u)I(t,s[u],!0,n);return}if(r instanceof _.default){for(var c=r.getCoordinates(),f=0,h=c.length;f<h;++f)for(var p=c[f],d=0,y=p.length;d<y;++d)I(t,p[d],!0,n);return}if(r instanceof B.default)for(var g=r.getGeometries(),m=0;m<g.length;++m)e(t,g[m],n)}(e,t[n].getGeometry(),r);return r}function T(e,t){return(0,h.squaredDistance)(e[0],e[1],t[0],t[1])}function C(e,t){var r=e.length;return t<0?e[t+r]:r<=t?e[t-r]:e[t]}function R(e,t,r){var n,r=t<r?(n=t,r):(n=r,t),t=Math.ceil(n),i=Math.floor(r);if(i<t)return T(L(e,n),L(e,r));var o=0;n<t&&(o+=T(L(e,n),C(e,t))),i<r&&(o+=T(C(e,i),L(e,r)));for(var a=t;a<i-1;++a)o+=T(C(e,a),C(e,a+1));return o}t.DrawEvent=E;var M={index:-1,endIndex:NaN};function I(e,t,r,n){for(var i=e[0],o=e[1],a=0,s=t.length-1;a<s;++a){var u=$(i,o,t[a],t[a+1]);if(0===u.squaredDistance)return u=a+u.along,void n.push({coordinates:t,ring:r,startIndex:u,endIndex:u})}}var A={along:0,squaredDistance:0};function $(e,t,r,n){var i=r[0],r=r[1],o=n[0]-i,n=n[1]-r,a=0,s=i,u=r;return 0==o&&0==n||(s+=o*(a=(0,h.clamp)(((e-i)*o+(t-r)*n)/(o*o+n*n),0,1)),u+=n*a),A.along=a,A.squaredDistance=(0,h.toFixed)((0,h.squaredDistance)(e,t,s,u),10),A}function L(e,t){var r=e.length,n=Math.floor(t),t=t-n,i=(r<=n?n-=r:n<0&&(n+=r),n+1),r=(r<=i&&(i-=r),e[n]),n=r[0],r=r[1],e=e[i];return[n+(e[0]-n)*t,r+(e[1]-r)*t]}e=function(){j(s,W["default"]);var a=P(s);function s(e){S(this,s);var n,i,r,t=e,o=(t.stopDown||(t.stopDown=c.FALSE),(t=a.call(this,t)).on,t.once,t.un,t.shouldHandle_=!1,t.downPx_=null,t.downTimeout_,t.lastDragTime_,t.pointerType_,t.freehand_=!1,t.source_=e.source||null,t.features_=e.features||null,t.snapTolerance_=e.snapTolerance||12,t.type_=e.type,t.mode_=function(e){switch(e){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+e)}}(t.type_),t.stopClick_=!!e.stopClick,t.minPoints_=e.minPoints||("Polygon"===t.mode_?3:2),t.maxPoints_="Circle"===t.mode_?2:e.maxPoints||1/0,t.finishCondition_=e.finishCondition||c.TRUE,t.geometryLayout_=e.geometryLayout||"XY",e.geometryFunction);return o||(o="Circle"===(n=t.mode_)?function(e,t,r){var t=t||new l.default([NaN,NaN]),n=(0,p.fromUserCoordinate)(e[0],r),e=(0,x.squaredDistance)(n,(0,p.fromUserCoordinate)(e[e.length-1],r)),n=(t.setCenterAndRadius(n,Math.sqrt(e),this.geometryLayout_),(0,p.getUserProjection)());return n&&t.transform(r,n),t}:("Point"===n?i=u.default:"LineString"===n?i=v.default:"Polygon"===n&&(i=w.default),function(e,t,r){return t?"Polygon"===n?e[0].length?t.setCoordinates([e[0].concat([e[0][0]])],this.geometryLayout_):t.setCoordinates([],this.geometryLayout_):t.setCoordinates(e,this.geometryLayout_):t=new i(e,this.geometryLayout_),t})),t.geometryFunction_=o,t.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,t.finishCoordinate_=null,t.sketchFeature_=null,t.sketchPoint_=null,t.sketchCoords_=null,t.sketchLine_=null,t.sketchLineCoords_=null,t.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,t.overlay_=new V.default({source:new H.default({useSpatialIndex:!1,wrapX:e.wrapX||!1}),style:e.style||(r=(0,q.createEditingStyle)(),function(e,t){return r[e.getGeometry().getType()]}),updateWhileInteracting:!0}),t.geometryName_=e.geometryName,t.condition_=e.condition||f.noModifierKeys,t.freehandCondition_,e.freehand?t.freehandCondition_=f.always:t.freehandCondition_=e.freehandCondition||f.shiftKeyOnly,t.traceCondition_,t.setTrace(e.trace||!1),t.traceState_={active:!1},t.traceSource_=e.traceSource||e.source||null,t.addChangeListener(G.default.ACTIVE,t.updateState_),t}return m(s,[{key:"setTrace",value:function(e){e=e?!0===e?f.always:e:f.never;this.traceCondition_=e}},{key:"setMap",value:function(e){y(k(s.prototype),"setMap",this).call(this,e),this.updateState_()}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleEvent",value:function(e){e.originalEvent.type===N.default.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);var t=e.type===i.default.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&e.type===i.default.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_)&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.freehand_&&e.type===i.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===i.default.POINTERDOWN?r=!1:t&&this.getPointerCount()<2?(r=e.type===i.default.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===i.default.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===i.default.DBLCLICK&&(r=!1),y(k(s.prototype),"handleEvent",this).call(this,e)&&r}},{key:"handleDownEvent",value:function(e){if(this.shouldHandle_=!this.freehand_,this.freehand_)this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate);else{if(!this.condition_(e))return this.lastDragTime_=void 0,!1;this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new U.default(i.default.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel}return!0}},{key:"deactivateTrace_",value:function(){this.traceState_={active:!1}}},{key:"toggleTraceState_",value:function(e){var t,r;this.traceSource_&&this.traceCondition_(e)&&(this.traceState_.active?this.deactivateTrace_():(r=(t=this.getMap()).getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),t=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=(0,o.boundingExtent)([r,t]),0!==(t=this.traceSource_.getFeaturesInExtent(r)).length&&(r=K(e.coordinate,t)).length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:r,targetIndex:-1})))}},{key:"addOrRemoveTracedCoordinates_",value:function(e,t){var r=e.startIndex<=e.endIndex;r==e.startIndex<=t?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}},{key:"removeTracedCoordinates_",value:function(e,t){var r,n,i;e!==t&&(i=0)<(i=e<t?(n=Math.ceil(e),(r=Math.floor(t))===t&&--r,r-n+1):(r=Math.floor(e),(n=Math.ceil(t))===t&&(n+=1),r-n+1))&&this.removeLastPoints_(i)}},{key:"addTracedCoordinates_",value:function(e,t,r){if(t!==r){var n=[];if(t<r){var i=Math.ceil(t),o=Math.floor(r);o===r&&--o;for(var a=i;a<=o;++a)n.push(C(e.coordinates,a))}else{var i=Math.floor(t),s=Math.ceil(r);s===r&&(s+=1);for(var u=i;s<=u;--u)n.push(C(e.coordinates,u))}n.length&&this.appendCoordinates(n)}}},{key:"updateTrace_",value:function(e){var t,r,n=this.traceState_;!n.active||-1===n.targetIndex&&(0,x.distance)(n.startPx,e.pixel)<this.snapTolerance_||(r=function(e,t,r,n){for(var i=e[0],o=e[1],a=1/0,s=-1,u=NaN,l=0;l<t.targets.length;++l){for(var c=t.targets[l],f=c.coordinates,h=1/0,p=void 0,d=0;d<f.length-1;++d){var y=$(i,o,f[d],f[d+1]);y.squaredDistance<h&&(h=y.squaredDistance,p=d+y.along)}h<a&&(a=h,c.ring&&t.targetIndex===l&&(c.endIndex>c.startIndex?p<c.startIndex&&(p+=f.length):c.endIndex<c.startIndex&&p>c.startIndex&&(p-=f.length)),u=p,s=l)}var g,m=(e=t.targets[s]).ring;return(m=t.targetIndex===s&&m&&(g=L(e.coordinates,u),r=r.getPixelFromCoordinate(g),(0,x.distance)(r,t.startPx)>n)?!1:m)&&(r=(g=e.coordinates).length,(n=e.startIndex)<(m=u)?(e=R(g,n,m),R(g,n,m-r)<e&&(u-=r)):(e=R(g,n,m),R(g,n,m+r)<e&&(u+=r))),M.index=s,M.endIndex=u,M}(e.coordinate,n,this.getMap(),this.snapTolerance_),n.targetIndex!==r.index?(-1!==n.targetIndex&&(t=n.targets[n.targetIndex],this.removeTracedCoordinates_(t.startIndex,t.endIndex)),t=n.targets[r.index],this.addTracedCoordinates_(t,t.startIndex,r.endIndex)):(t=n.targets[n.targetIndex],this.addOrRemoveTracedCoordinates_(t,r.endIndex)),n.targetIndex=r.index,(t=n.targets[n.targetIndex]).endIndex=r.endIndex,n=L(t.coordinates,t.endIndex),r=this.getMap().getPixelFromCoordinate(n),e.coordinate=n,e.pixel=[Math.round(r[0]),Math.round(r[1])])}},{key:"handleUpEvent",value:function(e){var t,r,n=!0;return 0===this.getPointerCount()&&(this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e),t=this.traceState_.active,this.toggleTraceState_(e),this.shouldHandle_?((r=!this.finishCoordinate_)&&this.startDrawing_(e.coordinate),!r&&this.freehand_?this.finishDrawing():this.freehand_||r&&"Point"!==this.mode_||(this.atFinish_(e.pixel,t)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),n=!1):this.freehand_&&this.abortDrawing()),!n&&this.stopClick_&&e.preventDefault(),n}},{key:"handlePointerMove_",value:function(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,r=e.pixel,n=t[0]-r[0],t=t[1]-r[1],r=n*n+t*t;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(e),this.modifyDrawing_(e.coordinate)):this.createOrUpdateSketchPoint_(e.coordinate.slice())}},{key:"atFinish_",value:function(e,t){var r=!1;if(this.sketchFeature_){var n=!1,i=[this.finishCoordinate_],o=this.mode_;if("Point"===o?r=!0:"Circle"===o?r=2===this.sketchCoords_.length:"LineString"===o?n=!t&&this.sketchCoords_.length>this.minPoints_:"Polygon"===o&&(n=(o=this.sketchCoords_)[0].length>this.minPoints_,i=[o[0][0],o[0][o[0].length-2]],i=t?[o[0][0]]:[o[0][0],o[0][o[0].length-2]]),n)for(var a=this.getMap(),s=0,u=i.length;s<u;s++){var l=i[s],c=a.getPixelFromCoordinate(l),f=e[0]-c[0],c=e[1]-c[1],h=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(f*f+c*c)<=h){this.finishCoordinate_=l;break}}}return r}},{key:"createOrUpdateSketchPoint_",value:function(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new n.default(new u.default(e)),this.updateSketchFeatures_())}},{key:"createOrUpdateCustomSketchLine_",value:function(e){this.sketchLine_||(this.sketchLine_=new n.default);var e=e.getLinearRing(0),t=this.sketchLine_.getGeometry();t?(t.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),t.changed()):(t=new v.default(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(t))}},{key:"startDrawing_",value:function(e){for(var t=this.getMap().getView().getProjection(),r=(0,d.getStrideForLayout)(this.geometryLayout_);e.length<r;)e.push(0);this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new n.default(new v.default(this.sketchLineCoords_)));t=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new n.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(t),this.updateSketchFeatures_(),this.dispatchEvent(new E(Y,this.sketchFeature_))}},{key:"modifyDrawing_",value:function(e){for(var t,r,n=this.getMap(),i=this.sketchFeature_.getGeometry(),o=n.getView().getProjection(),a=(0,d.getStrideForLayout)(this.geometryLayout_);e.length<a;)e.push(0);"Point"===this.mode_?r=this.sketchCoords_:"Polygon"===this.mode_?(r=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(n.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):r=(t=this.sketchCoords_)[t.length-1],r[0]=e[0],r[1]=e[1],this.geometryFunction_(this.sketchCoords_,i,o),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),"Polygon"===i.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}},{key:"addToDrawing_",value:function(e){var t,r,n=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),o=this.mode_;"LineString"===o||"Circle"===o?(this.finishCoordinate_=e.slice(),(r=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?r.pop():t=!0),r.push(e.slice()),this.geometryFunction_(r,n,i)):"Polygon"===o&&((r=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?r.pop():t=!0),r.push(e.slice()),t&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,n,i)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),t&&this.finishDrawing()}},{key:"removeLastPoints_",value:function(e){if(this.sketchFeature_){for(var t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),n=this.mode_,i=0;i<e;++i){var o,a,s=void 0;if("LineString"===n||"Circle"===n?((s=this.sketchCoords_).splice(-2,1),2<=s.length&&(this.finishCoordinate_=s[s.length-2].slice(),o=this.finishCoordinate_.slice(),s[s.length-1]=o,this.createOrUpdateSketchPoint_(o)),this.geometryFunction_(s,t,r),"Polygon"===t.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)):"Polygon"===n&&((s=this.sketchCoords_[0]).splice(-2,1),o=this.sketchLine_.getGeometry(),2<=s.length&&(a=s[s.length-2].slice(),s[s.length-1]=a,this.createOrUpdateSketchPoint_(a)),o.setCoordinates(s),this.geometryFunction_(this.sketchCoords_,t,r)),1===s.length){this.abortDrawing();break}}this.updateSketchFeatures_()}}},{key:"removeLastPoint",value:function(){this.removeLastPoints_(1)}},{key:"finishDrawing",value:function(){var e,t,r,n=this.abortDrawing_();n&&(e=this.sketchCoords_,t=n.getGeometry(),r=this.getMap().getView().getProjection(),"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,t,r)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,t,r),e=t.getCoordinates()),"MultiPoint"===this.type_?n.setGeometry(new z.default([e])):"MultiLineString"===this.type_?n.setGeometry(new b.default([e])):"MultiPolygon"===this.type_&&n.setGeometry(new _.default([e])),this.dispatchEvent(new E(X,n)),this.features_&&this.features_.push(n),this.source_)&&this.source_.addFeature(n)}},{key:"abortDrawing_",value:function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}},{key:"abortDrawing",value:function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new E(Z,e))}},{key:"appendCoordinates",value:function(e){var t,r=this.mode_,n=!this.sketchFeature_;if(n&&this.startDrawing_(e[0]),"LineString"===r||"Circle"===r)t=this.sketchCoords_;else{if("Polygon"!==r)return;t=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}n&&t.shift(),t.pop();for(var i=0;i<e.length;i++)this.addToDrawing_(e[i]);r=e[e.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)}},{key:"extend",value:function(e){var t=e.getGeometry(),e=(this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates(),this.sketchCoords_[this.sketchCoords_.length-1]);this.finishCoordinate_=e.slice(),this.sketchCoords_.push(e.slice()),this.sketchPoint_=new n.default(new u.default(e)),this.updateSketchFeatures_(),this.dispatchEvent(new E(Y,this.sketchFeature_))}},{key:"updateSketchFeatures_",value:function(){var e=[],t=(this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_),this.overlay_.getSource());t.clear(!0),t.addFeatures(e)}},{key:"updateState_",value:function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)}}]),s}();t.default=e},{"../Feature.js":75,"../MapBrowserEvent.js":84,"../MapBrowserEventType.js":86,"../coordinate.js":121,"../events/Event.js":126,"../events/EventType.js":127,"../events/condition.js":130,"../extent.js":131,"../functions.js":189,"../geom/Circle.js":191,"../geom/GeometryCollection.js":193,"../geom/LineString.js":194,"../geom/MultiLineString.js":196,"../geom/MultiPoint.js":197,"../geom/MultiPolygon.js":198,"../geom/Point.js":199,"../geom/Polygon.js":200,"../geom/SimpleGeometry.js":201,"../layer/Vector.js":261,"../math.js":267,"../proj.js":271,"../source/Vector.js":346,"../style/Style.js":367,"./Pointer.js":241,"./Property.js":242}],232:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ExtentEvent=void 0;var o=m(e("../events/Event.js")),n=m(e("../Feature.js")),a=m(e("../MapBrowserEventType.js")),s=m(e("../geom/Point.js")),u=m(e("./Pointer.js")),l=m(e("../layer/Vector.js")),c=m(e("../source/Vector.js")),f=e("../events/condition.js"),h=e("../extent.js"),p=e("../coordinate.js"),d=e("../style/Style.js"),y=e("../geom/Polygon.js"),g=e("../proj.js");function m(e){return e&&e.__esModule?e:{default:e}}function v(){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function _(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(r),t=(e=n?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P="extentchanged",k=function(){x(n,o["default"]);var r=j(n);function n(e){var t;return w(this,n),(t=r.call(this,P)).extent=e,t}return _(n)}(),e=(r.ExtentEvent=k,function(){x(o,u["default"]);var i=j(o);function o(e){var t,r,n;return w(this,o),(t=i.call(this,e=e||{})).on,t.once,t.un,t.condition_=e.condition||f.always,t.extent_=null,t.pointerHandler_=null,t.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,t.snappedToVertex_=!1,t.extentFeature_=null,t.vertexFeature_=null,t.extentOverlay_=new l.default({source:new c.default({useSpatialIndex:!1,wrapX:!!(e=e||{}).wrapX}),style:e.boxStyle||(r=(0,d.createEditingStyle)(),function(e,t){return r.Polygon}),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.vertexOverlay_=new l.default({source:new c.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle||(n=(0,d.createEditingStyle)(),function(e,t){return n.Point}),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&t.setExtent(e.extent),t}return _(o,[{key:"snapToVertex_",value:function(e,t){var r=t.getCoordinateFromPixelInternal(e),n=this.getExtentInternal();if(n){var n=[[[n[0],n[1]],[n[0],n[3]]],[[n[0],n[3]],[n[2],n[3]]],[[n[2],n[3]],[n[2],n[1]]],[[n[2],n[1]],[n[0],n[1]]]],n=(n.sort(function(e,t){return(0,p.squaredDistanceToSegment)(r,e)-(0,p.squaredDistanceToSegment)(r,t)}),n[0]),i=(0,p.closestOnSegment)(r,n),o=t.getPixelFromCoordinateInternal(i);if((0,p.distance)(e,o)<=this.pixelTolerance_)return e=t.getPixelFromCoordinateInternal(n[0]),t=t.getPixelFromCoordinateInternal(n[1]),e=(0,p.squaredDistance)(o,e),o=(0,p.squaredDistance)(o,t),t=Math.sqrt(Math.min(e,o)),this.snappedToVertex_=t<=this.pixelTolerance_,this.snappedToVertex_?o<e?n[1]:n[0]:i}return null}},{key:"handlePointerMove_",value:function(e){var t=e.pixel,e=e.map,r=(r=this.snapToVertex_(t,e))||e.getCoordinateFromPixelInternal(t);this.createOrUpdatePointerFeature_(r)}},{key:"createOrUpdateExtentFeature_",value:function(e){var t=this.extentFeature_;return t?e?t.setGeometry((0,y.fromExtent)(e)):t.setGeometry(void 0):(t=e?new n.default((0,y.fromExtent)(e)):new n.default({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}},{key:"createOrUpdatePointerFeature_",value:function(e){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(e):(t=new n.default(new s.default(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t)),t}},{key:"handleEvent",value:function(e){return!e.originalEvent||!this.condition_(e)||(e.type!=a.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),v(O(o.prototype),"handleEvent",this).call(this,e),!1)}},{key:"handleDownEvent",value:function(e){function t(e){var t=null,r=null;return e[0]==o[0]?t=o[2]:e[0]==o[2]&&(t=o[0]),e[1]==o[1]?r=o[3]:e[1]==o[3]&&(r=o[1]),null!==t&&null!==r?[t,r]:null}var r,n,i=e.pixel,e=e.map,o=this.getExtentInternal(),a=this.snapToVertex_(i,e);return a&&o?(r=a[0]==o[0]||a[0]==o[2]?a[0]:null,n=a[1]==o[1]||a[1]==o[3]?a[1]:null,null!==r&&null!==n?this.pointerHandler_=E(t(a)):null!==r?this.pointerHandler_=T(t([r,o[1]]),t([r,o[3]])):null!==n&&(this.pointerHandler_=T(t([o[0],n]),t([o[2],n])))):(a=e.getCoordinateFromPixelInternal(i),this.setExtent([a[0],a[1],a[0],a[1]]),this.pointerHandler_=E(a)),!0}},{key:"handleDragEvent",value:function(e){this.pointerHandler_&&(e=e.coordinate,this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e))}},{key:"handleUpEvent",value:function(e){this.pointerHandler_=null;var t=this.getExtentInternal();return t&&0!==(0,h.getArea)(t)||this.setExtent(null),!1}},{key:"setMap",value:function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),v(O(o.prototype),"setMap",this).call(this,e)}},{key:"getExtent",value:function(){return(0,g.toUserExtent)(this.getExtentInternal(),this.getMap().getView().getProjection())}},{key:"getExtentInternal",value:function(){return this.extent_}},{key:"setExtent",value:function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new k(this.extent_))}}]),o}());function E(t){return function(e){return(0,h.boundingExtent)([t,e])}}function T(t,r){return t[0]==r[0]?function(e){return(0,h.boundingExtent)([t,[e[0],r[1]]])}:t[1]==r[1]?function(e){return(0,h.boundingExtent)([t,[r[0],e[1]]])}:null}r.default=e},{"../Feature.js":75,"../MapBrowserEventType.js":86,"../coordinate.js":121,"../events/Event.js":126,"../events/condition.js":130,"../extent.js":131,"../geom/Point.js":199,"../geom/Polygon.js":200,"../layer/Vector.js":261,"../proj.js":271,"../source/Vector.js":346,"../style/Style.js":367,"./Pointer.js":241}],233:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.pan=function(e,t,r){var n=e.getCenterInternal();n&&(n=[n[0]+t[0],n[1]+t[1]],e.animateInternal({duration:void 0!==r?r:250,easing:a.linear,center:e.getConstrainedCenter(n)}))},r.zoomByDelta=function(e,t,r,n){var i=e.getZoom();void 0!==i&&(i=e.getConstrainedZoom(i+t),t=e.getResolutionForZoom(i),e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:t,anchor:r,duration:void 0!==n?n:250,easing:a.easeOut}))};var n=s(e("../Object.js")),o=s(e("./Property.js")),a=e("../easing.js");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).on,t.once,t.un,e&&e.handleEvent&&(t.handleEvent=e.handleEvent),t.map_=null,t.setActive(!0),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getActive",value:function(){return this.get(o.default.ACTIVE)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(e){return!0}},{key:"setActive",value:function(e){this.set(o.default.ACTIVE,e)}},{key:"setMap",value:function(e){this.map_=e}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Object.js":90,"../easing.js":124,"./Property.js":242}],234:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=n(e("../events/EventType.js")),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Interaction.js")),l=n(e("../events/KeyCode.js")),o=e("../events/condition.js"),c=e("../coordinate.js");function f(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(f=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e){var t;if(this instanceof i)return e=e||{},(t=n.call(this)).defaultCondition_=function(e){return(0,o.noModifierKeys)(e)&&(0,o.targetNotEditable)(e)},t.condition_=void 0!==e.condition?e.condition:t.defaultCondition_,t.duration_=void 0!==e.duration?e.duration:100,t.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleEvent",value:function(e){var t,r,n,i,o,a=!1;return e.type==s.default.KEYDOWN&&(o=(t=e.originalEvent).keyCode,!this.condition_(e)||o!=l.default.DOWN&&o!=l.default.LEFT&&o!=l.default.RIGHT&&o!=l.default.UP||(r=(e=e.map.getView()).getResolution()*this.pixelDelta_,i=n=0,o==l.default.DOWN?i=-r:o==l.default.LEFT?n=-r:o==l.default.RIGHT?n=r:i=r,(0,c.rotate)(o=[n,i],e.getRotation()),(0,u.pan)(e,o,this.duration_),t.preventDefault(),a=!0)),!a}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(u.default);r.default=e},{"../coordinate.js":121,"../events/EventType.js":127,"../events/KeyCode.js":128,"../events/condition.js":130,"./Interaction.js":233}],235:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(n=e("../events/EventType.js"))&&n.__esModule?n:{default:n},s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Interaction.js")),u=e("../events/condition.js");function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=h(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).condition_=(e=e||{}).condition||u.targetNotEditable,t.delta_=e.delta||1,t.duration_=void 0!==e.duration?e.duration:100,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleEvent",value:function(e){var t,r,n=!1;return e.type!=o.default.KEYDOWN&&e.type!=o.default.KEYPRESS||(r=(t=e.originalEvent).charCode,!this.condition_(e))||r!="+".charCodeAt(0)&&r!="-".charCodeAt(0)||(e=e.map,r=r=="+".charCodeAt(0)?this.delta_:-this.delta_,e=e.getView(),(0,s.zoomByDelta)(e,r,void 0,this.duration_),t.preventDefault(),n=!0),!n}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.default);r.default=n},{"../events/EventType.js":127,"../events/condition.js":130,"./Interaction.js":233}],236:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=l(e("../events/EventType.js")),n=l(e("./Interaction.js")),a=l(e("../MapEventType.js")),s=e("../events.js"),u=e("../math.js");function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){return parseFloat(e)}function m(e){return(0,u.toFixed)(e,5).toString()}function v(e,t){return!isNaN(e)&&e!==g(m(t))}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){var t,r;if(this instanceof i)return t=n.call(this),r=!0===(e=Object.assign({animate:!0,replace:!1,prefix:""},e||{})).animate?{duration:250}:e.animate||null,t.animationOptions_=r,t.replace_=e.replace,t.prefix_=e.prefix,t.listenerKeys_=[],t.initial_=!0,t.updateState_=t.updateState_.bind(d(t)),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getParamName_",value:function(e){return this.prefix_?this.prefix_+e:e}},{key:"get_",value:function(e,t){return e.get(this.getParamName_(t))}},{key:"set_",value:function(e,t,r){e.set(this.getParamName_(t),r)}},{key:"delete_",value:function(e,t){e.delete(this.getParamName_(t))}},{key:"setMap",value:function(e){var t=this.getMap();f(y(i.prototype),"setMap",this).call(this,e),e!==t&&(t&&this.unregisterListeners_(t),e)&&(this.initial_=!0,this.updateState_(),this.registerListeners_(e))}},{key:"registerListeners_",value:function(e){this.listenerKeys_.push((0,s.listen)(e,a.default.MOVEEND,this.updateUrl_,this),(0,s.listen)(e.getLayerGroup(),o.default.CHANGE,this.updateUrl_,this),(0,s.listen)(e,"change:layergroup",this.handleChangeLayerGroup_,this)),this.replace_||addEventListener("popstate",this.updateState_)}},{key:"unregisterListeners_",value:function(e){for(var t=0,r=this.listenerKeys_.length;t<r;++t)(0,s.unlistenByKey)(this.listenerKeys_[t]);this.listenerKeys_.length=0,this.replace_||removeEventListener("popstate",this.updateState_);var n=new URL(window.location.href),i=n.searchParams;this.delete_(i,"x"),this.delete_(i,"y"),this.delete_(i,"z"),this.delete_(i,"r"),this.delete_(i,"l"),window.history.replaceState(null,"",n)}},{key:"handleChangeLayerGroup_",value:function(){var e=this.getMap();e&&(this.unregisterListeners_(e),this.registerListeners_(e),this.initial_=!0,this.updateUrl_())}},{key:"updateState_",value:function(){var e=this.getMap();if(e){var t=e.getView();if(t){var r,n,i=new URL(window.location.href).searchParams,o=!1,a={},s=g(this.get_(i,"z")),s=(v(s,t.getZoom())&&(o=!0,a.zoom=s),g(this.get_(i,"r"))),s=(v(s,t.getRotation())&&(o=!0,a.rotation=s),[g(this.get_(i,"x")),g(this.get_(i,"y"))]),u=(r=s,n=t.getCenter(),(v(r[0],n[0])||v(r[1],n[1]))&&(o=!0,a.center=s),o&&(!this.initial_&&this.animationOptions_?t.animate(Object.assign(a,this.animationOptions_)):(a.center&&t.setCenter(a.center),"zoom"in a&&t.setZoom(a.zoom),"rotation"in a&&t.setRotation(a.rotation))),e.getAllLayers()),l=this.get_(i,"l");if(l&&l.length===u.length)for(var c=0,f=u.length;c<f;++c){var h,p=parseInt(l[c]);isNaN(p)||(p=Boolean(p),(h=u[c]).getVisible()!==p&&h.setVisible(p))}}}}},{key:"updateUrl_",value:function(){var e=this.getMap();if(e){var t=e.getView();if(t){for(var r=this.initial_,n=(this.initial_=!1,t.getCenter()),i=t.getZoom(),t=t.getRotation(),o=e.getAllLayers(),a=new Array(o.length),s=0,u=o.length;s<u;++s)a[s]=o[s].getVisible()?"1":"0";var e=new URL(window.location.href),l=e.searchParams;this.set_(l,"x",m(n[0])),this.set_(l,"y",m(n[1])),this.set_(l,"z",m(i)),this.set_(l,"r",m(t)),this.set_(l,"l",a.join("")),e.href!==window.location.href&&(r||this.replace_?window.history.replaceState(null,"",e):window.history.pushState(null,"",e))}}}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../MapEventType.js":88,"../events.js":125,"../events/EventType.js":127,"../math.js":267,"./Interaction.js":233}],237:[function(e,D,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ModifyEvent=void 0;var l=i(e("../Collection.js")),a=i(e("../CollectionEventType.js")),r=i(e("../events/Event.js")),n=i(e("../events/EventType.js")),s=i(e("../Feature.js")),u=i(e("../MapBrowserEventType.js")),c=i(e("../geom/Point.js")),f=i(e("./Pointer.js")),h=i(e("../structs/RBush.js")),p=i(e("../source/VectorEventType.js")),F=i(e("../layer/Vector.js")),N=i(e("../source/Vector.js")),d=e("../events/condition.js"),v=e("../extent.js"),b=e("../coordinate.js"),B=e("../style/Style.js"),G=e("../array.js"),y=e("../geom/Polygon.js"),_=e("../proj.js"),w=e("../util.js");function i(e){return e&&e.__esModule?e:{default:e}}function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==x(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===x(e)?e:String(e)}(n.key),n)}}function m(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=E(r),t=(e=n?(e=E(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return k(t)}}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=1,C=[0,0,0,0],R=[],U="modifystart",M="modifyend",I=function(){j(i,r["default"]);var n=P(i);function i(e,t,r){return S(this,i),(e=n.call(this,e)).features=t,e.mapBrowserEvent=r,e}return m(i)}(),e=(t.ModifyEvent=I,function(){j(o,f["default"]);var i=P(o);function o(e){var t,r,n;if(S(this,o),(t=i.call(this,e)).on,t.once,t.un,t.boundHandleFeatureChange_=t.handleFeatureChange_.bind(k(t)),t.condition_=e.condition||d.primaryAction,t.defaultDeleteCondition_=function(e){return(0,d.altKeyOnly)(e)&&(0,d.singleClick)(e)},t.deleteCondition_=e.deleteCondition||t.defaultDeleteCondition_,t.insertVertexCondition_=e.insertVertexCondition||d.always,t.vertexFeature_=null,t.vertexSegments_=null,t.lastPixel_=[0,0],t.ignoreNextSingleClick_=!1,t.featuresBeingModified_=null,t.rBush_=new h.default,t.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,t.snappedToVertex_=!1,t.changingFeature_=!1,t.dragSegments_=[],t.overlay_=new F.default({source:new N.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style||(r=(0,B.createEditingStyle)(),function(e,t){return r.Point}),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.SEGMENT_WRITERS_={Point:t.writePointGeometry_.bind(k(t)),LineString:t.writeLineStringGeometry_.bind(k(t)),LinearRing:t.writeLineStringGeometry_.bind(k(t)),Polygon:t.writePolygonGeometry_.bind(k(t)),MultiPoint:t.writeMultiPointGeometry_.bind(k(t)),MultiLineString:t.writeMultiLineStringGeometry_.bind(k(t)),MultiPolygon:t.writeMultiPolygonGeometry_.bind(k(t)),Circle:t.writeCircleGeometry_.bind(k(t)),GeometryCollection:t.writeGeometryCollectionGeometry_.bind(k(t))},t.source_=null,t.hitDetection_=null,e.features?n=e.features:e.source&&(t.source_=e.source,n=new l.default(t.source_.getFeatures()),t.source_.addEventListener(p.default.ADDFEATURE,t.handleSourceAdd_.bind(k(t))),t.source_.addEventListener(p.default.REMOVEFEATURE,t.handleSourceRemove_.bind(k(t)))),n)return e.hitDetection&&(t.hitDetection_=e.hitDetection),t.features_=n,t.features_.forEach(t.addFeature_.bind(k(t))),t.features_.addEventListener(a.default.ADD,t.handleFeatureAdd_.bind(k(t))),t.features_.addEventListener(a.default.REMOVE,t.handleFeatureRemove_.bind(k(t))),t.lastPointerEvent_=null,t.delta_=[0,0],t.snapToPointer_=void 0===e.snapToPointer?!t.hitDetection_:e.snapToPointer,t;throw new Error("The modify interaction requires features, a source or a layer")}return m(o,[{key:"addFeature_",value:function(e){var t=e.getGeometry(),r=(t&&(r=this.SEGMENT_WRITERS_[t.getType()])&&r(e,t),this.getMap());r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),e.addEventListener(n.default.CHANGE,this.boundHandleFeatureChange_)}},{key:"willModifyFeatures_",value:function(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new l.default;for(var r=this.featuresBeingModified_.getArray(),n=0,i=t.length;n<i;++n)for(var o=t[n],a=0,s=o.length;a<s;++a){var u=o[a].feature;u&&!r.includes(u)&&this.featuresBeingModified_.push(u)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new I(U,this.featuresBeingModified_,e))}}},{key:"removeFeature_",value:function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(n.default.CHANGE,this.boundHandleFeatureChange_)}},{key:"removeFeatureSegmentData_",value:function(t){var e=this.rBush_,r=[];e.forEach(function(e){t===e.feature&&r.push(e)});for(var n=r.length-1;0<=n;--n){for(var i=r[n],o=this.dragSegments_.length-1;0<=o;--o)this.dragSegments_[o][0]===i&&this.dragSegments_.splice(o,1);e.remove(i)}}},{key:"setActive",value:function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),g(E(o.prototype),"setActive",this).call(this,e)}},{key:"setMap",value:function(e){this.overlay_.setMap(e),g(E(o.prototype),"setMap",this).call(this,e)}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleSourceAdd_",value:function(e){e.feature&&this.features_.push(e.feature)}},{key:"handleSourceRemove_",value:function(e){e.feature&&this.features_.remove(e.feature)}},{key:"handleFeatureAdd_",value:function(e){this.addFeature_(e.element)}},{key:"handleFeatureChange_",value:function(e){this.changingFeature_||(e=e.target,this.removeFeature_(e),this.addFeature_(e))}},{key:"handleFeatureRemove_",value:function(e){this.removeFeature_(e.element)}},{key:"writePointGeometry_",value:function(e,t){var r=t.getCoordinates(),e={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),e)}},{key:"writeMultiPointGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n){var o=r[n],o={feature:e,geometry:t,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(t.getExtent(),o)}}},{key:"writeLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length-1;n<i;++n){var o=r.slice(n,n+2),a={feature:e,geometry:t,index:n,segment:o};this.rBush_.insert((0,v.boundingExtent)(o),a)}}},{key:"writeMultiLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length-1;a<s;++a){var u=o.slice(a,a+2),l={feature:e,geometry:t,depth:[n],index:a,segment:u};this.rBush_.insert((0,v.boundingExtent)(u),l)}}},{key:"writePolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length-1;a<s;++a){var u=o.slice(a,a+2),l={feature:e,geometry:t,depth:[n],index:a,segment:u};this.rBush_.insert((0,v.boundingExtent)(u),l)}}},{key:"writeMultiPolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length;a<s;++a)for(var u=o[a],l=0,c=u.length-1;l<c;++l){var f=u.slice(l,l+2),h={feature:e,geometry:t,depth:[a,n],index:l,segment:f};this.rBush_.insert((0,v.boundingExtent)(f),h)}}},{key:"writeCircleGeometry_",value:function(e,t){var r=t.getCenter(),n={feature:e,geometry:t,index:0,segment:[r,r]},e={feature:e,geometry:t,index:T,segment:[r,r]},i=[n,e],i=(n.featureSegments=i,e.featureSegments=i,this.rBush_.insert((0,v.createOrUpdateFromCoordinate)(r),n),t),r=(0,_.getUserProjection)();r&&this.getMap()&&(n=this.getMap().getView().getProjection(),i=i.clone().transform(r,n),i=(0,y.fromCircle)(i).transform(n,r)),this.rBush_.insert(i.getExtent(),e)}},{key:"writeGeometryCollectionGeometry_",value:function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var i=r[n];(0,this.SEGMENT_WRITERS_[i.getType()])(e,i)}}},{key:"createOrUpdateVertexFeature_",value:function(e,t,r){var n=this.vertexFeature_;return n?n.getGeometry().setCoordinates(e):(n=new s.default(new c.default(e)),this.vertexFeature_=n,this.overlay_.getSource().addFeature(n)),n.set("features",t),n.set("geometries",r),n}},{key:"handleEvent",value:function(e){var t;return!e.originalEvent||((this.lastPointerEvent_=e).map.getView().getInteracting()||e.type!=u.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=u.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==u.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),g(E(o.prototype),"handleEvent",this).call(this,e)&&!t)}},{key:"handleDragEvent",value:function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);for(var t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],n=[],i=0,o=this.dragSegments_.length;i<o;++i){for(var a,s,u,l,c=this.dragSegments_[i],f=c[0],h=f.feature,p=(r.includes(h)||r.push(h),f.geometry),d=(n.includes(p)||n.push(p),f.depth),y=void 0,g=f.segment,m=c[1];t.length<p.getStride();)t.push(g[m][t.length]);switch(p.getType()){case"Point":g[0]=y=t,g[1]=t;break;case"MultiPoint":(y=p.getCoordinates())[f.index]=t,g[0]=t,g[1]=t;break;case"LineString":(y=p.getCoordinates())[f.index+m]=t,g[m]=t;break;case"MultiLineString":case"Polygon":(y=p.getCoordinates())[d[0]][f.index+m]=t,g[m]=t;break;case"MultiPolygon":(y=p.getCoordinates())[d[1]][d[0]][f.index+m]=t,g[m]=t;break;case"Circle":g[0]=t,g[1]=t,0===f.index?(this.changingFeature_=!0,p.setCenter(t)):(this.changingFeature_=!0,a=e.map.getView().getProjection(),s=(0,b.distance)((0,_.fromUserCoordinate)(p.getCenter(),a),(0,_.fromUserCoordinate)(t,a)),(u=(0,_.getUserProjection)())&&((l=p.clone().transform(u,a)).setRadius(s),s=l.transform(a,u).getRadius()),p.setRadius(s)),this.changingFeature_=!1}y&&this.setGeometryCoordinates_(p,y)}this.createOrUpdateVertexFeature_(t,r,n)}},{key:"handleDownEvent",value:function(e){if(!this.condition_(e))return!1;var t=e.coordinate,r=(this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null,this.vertexFeature_);if(r){var n=e.map.getView().getProjection(),i=[],o=r.getGeometry().getCoordinates(),r=(0,v.boundingExtent)([o]),a=this.rBush_.getInExtent(r),s={};a.sort(z);for(var u=0,l=a.length;u<l;++u){var c=a[u],f=c.segment,h=(0,w.getUid)(c.geometry),p=c.depth;if(p&&(h+="-"+p.join("-")),s[h]||(s[h]=new Array(2)),"Circle"===c.geometry.getType()&&c.index===T){var d=L(t,c,n);(0,b.equals)(d,o)&&!s[h][0]&&(this.dragSegments_.push([c,0]),s[h][0]=c)}else if((0,b.equals)(f[0],o)&&!s[h][0])this.dragSegments_.push([c,0]),s[h][0]=c;else if((0,b.equals)(f[1],o)&&!s[h][1]){if(s[h][0]&&0===s[h][0].index){var y=c.geometry.getCoordinates();switch(c.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":y=y[p[1]];case"Polygon":if(c.index!==y[p[0]].length-2)continue}}this.dragSegments_.push([c,1]),s[h][1]=c}else(0,w.getUid)(f)in this.vertexSegments_&&!s[h][0]&&!s[h][1]&&this.insertVertexCondition_(e)&&i.push(c)}i.length&&this.willModifyFeatures_(e,[i]);for(var g=i.length-1;0<=g;--g)this.insertVertex_(i[g],o)}return!!this.vertexFeature_}},{key:"handleUpEvent",value:function(e){for(var t=this.dragSegments_.length-1;0<=t;--t){var r,n,i,o=this.dragSegments_[t][0],a=o.geometry;"Circle"===a.getType()?(i=a.getCenter(),n=o.featureSegments[0],r=o.featureSegments[1],n.segment[0]=i,n.segment[1]=i,r.segment[0]=i,r.segment[1]=i,this.rBush_.update((0,v.createOrUpdateFromCoordinate)(i),n),i=a,(n=(0,_.getUserProjection)())&&(a=e.map.getView().getProjection(),i=i.clone().transform(n,a),i=(0,y.fromCircle)(i).transform(a,n)),this.rBush_.update(i.getExtent(),r)):this.rBush_.update((0,v.boundingExtent)(o.segment),o)}return this.featuresBeingModified_&&(this.dispatchEvent(new I(M,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}},{key:"handlePointerMove_",value:function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}},{key:"handlePointerAtPixel_",value:function(e,t,r){var i,o,a=this,n=r||t.getCoordinateFromPixel(e),s=t.getView().getProjection();if(this.hitDetection_&&(r="object"===x(this.hitDetection_)?function(e){return e===a.hitDetection_}:void 0,t.forEachFeatureAtPixel(e,function(e,t,r){var n;return"Point"===(r=r||e.getGeometry()).getType()&&a.features_.getArray().includes(e)&&(n=(i=r).getFlatCoordinates().slice(0,2),o=[{feature:e,geometry:r,segment:[n,n]}]),!0},{layerFilter:r})),o||(r=(0,_.fromUserExtent)((0,v.createOrUpdateFromCoordinate)(n,C),s),u=t.getView().getResolution()*this.pixelTolerance_,r=(0,_.toUserExtent)((0,v.buffer)(r,u,C),s),o=this.rBush_.getInExtent(r)),o&&0<o.length){var u=o.sort(function(e,t){return A(n,e,s)-A(n,t,s)})[0],l=u.segment,r=L(n,u,s),c=t.getPixelFromCoordinate(r),e=(0,b.distance)(e,c);if(i||e<=this.pixelTolerance_){var f={};if(f[(0,w.getUid)(l)]=!0,this.snapToPointer_||(this.delta_[0]=r[0]-n[0],this.delta_[1]=r[1]-n[1]),"Circle"===u.geometry.getType()&&u.index===T)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(r,[u.feature],[u.geometry]);else{var h=t.getPixelFromCoordinate(l[0]),t=t.getPixelFromCoordinate(l[1]),h=(0,b.squaredDistance)(c,h),c=(0,b.squaredDistance)(c,t),e=Math.sqrt(Math.min(h,c)),p=(this.snappedToVertex_=e<=this.pixelTolerance_,this.snappedToVertex_&&(r=c<h?l[1]:l[0]),this.createOrUpdateVertexFeature_(r,[u.feature],[u.geometry]),{});p[(0,w.getUid)(u.geometry)]=!0;for(var d=1,y=o.length;d<y;++d){var g=o[d].segment;if(!((0,b.equals)(l[0],g[0])&&(0,b.equals)(l[1],g[1])||(0,b.equals)(l[0],g[1])&&(0,b.equals)(l[1],g[0])))break;var m=(0,w.getUid)(o[d].geometry);m in p||(p[m]=!0,f[(0,w.getUid)(g)]=!0)}}return void(this.vertexSegments_=f)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}},{key:"insertVertex_",value:function(e,t){for(var r,n=e.segment,i=e.feature,o=e.geometry,a=e.depth,s=e.index;t.length<o.getStride();)t.push(0);switch(o.getType()){case"MultiLineString":case"Polygon":(r=o.getCoordinates())[a[0]].splice(s+1,0,t);break;case"MultiPolygon":(r=o.getCoordinates())[a[1]][a[0]].splice(s+1,0,t);break;case"LineString":(r=o.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(o,r);var u=this.rBush_,e=(u.remove(e),this.updateSegmentIndices_(o,s,a,1),{segment:[n[0],t],feature:i,geometry:o,depth:a,index:s}),e=(u.insert((0,v.boundingExtent)(e.segment),e),this.dragSegments_.push([e,1]),{segment:[t,n[1]],feature:i,geometry:o,depth:a,index:s+1});u.insert((0,v.boundingExtent)(e.segment),e),this.dragSegments_.push([e,0]),this.ignoreNextSingleClick_=!0}},{key:"removePoint",value:function(){var e,t;return!(!this.lastPointerEvent_||this.lastPointerEvent_.type==u.default.POINTERDRAG)&&(e=this.lastPointerEvent_,this.willModifyFeatures_(e,this.dragSegments_),t=this.removeVertex_(),this.featuresBeingModified_&&this.dispatchEvent(new I(M,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t)}},{key:"removeVertex_",value:function(){for(var e,t,r,n,i,o,a,s,u,l,c,f=this.dragSegments_,h={},p=!1,d=f.length-1;0<=d;--d)s=(r=f[d])[0],u=(0,w.getUid)(s.feature),s.depth&&(u+="-"+s.depth.join("-")),u in h||(h[u]={}),0===r[1]?(h[u].right=s,h[u].index=s.index):1==r[1]&&(h[u].left=s,h[u].index=s.index+1);for(u in h){switch(a=h[u].right,c=h[u].left,(o=(i=h[u].index)-1)<0&&(o=0),e=t=(n=(s=void 0!==c?c:a).geometry).getCoordinates(),p=!1,n.getType()){case"MultiLineString":2<t[s.depth[0]].length&&(t[s.depth[0]].splice(i,1),p=!0);break;case"LineString":2<t.length&&(t.splice(i,1),p=!0);break;case"MultiPolygon":e=e[s.depth[1]];case"Polygon":4<(e=e[s.depth[0]]).length&&(i==e.length-1&&(i=0),e.splice(i,1),p=!0,0===i)&&(e.pop(),e.push(e[0]),o=e.length-1)}p&&(this.setGeometryCoordinates_(n,t),l=[],void 0!==c&&(this.rBush_.remove(c),l.push(c.segment[0])),void 0!==a&&(this.rBush_.remove(a),l.push(a.segment[1])),void 0!==c&&void 0!==a&&(c={depth:s.depth,feature:s.feature,geometry:s.geometry,index:o,segment:l},this.rBush_.insert((0,v.boundingExtent)(c.segment),c)),this.updateSegmentIndices_(n,i,s.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),f.length=0)}return p}},{key:"setGeometryCoordinates_",value:function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}},{key:"updateSegmentIndices_",value:function(t,r,n,i){this.rBush_.forEachInExtent(t.getExtent(),function(e){e.geometry===t&&(void 0===n||void 0===e.depth||(0,G.equals)(e.depth,n))&&e.index>r&&(e.index+=i)})}}]),o}());function z(e,t){return e.index-t.index}function A(e,t,r){var n=t.geometry;if("Circle"===n.getType()){var i;if(t.index===T)return(i=(0,_.getUserProjection)())&&(n=n.clone().transform(i,r)),i=(0,b.squaredDistance)(n.getCenter(),(0,_.fromUserCoordinate)(e,r)),(i=Math.sqrt(i)-n.getRadius())*i}n=(0,_.fromUserCoordinate)(e,r);return R[0]=(0,_.fromUserCoordinate)(t.segment[0],r),R[1]=(0,_.fromUserCoordinate)(t.segment[1],r),(0,b.squaredDistanceToSegment)(n,R)}function L(e,t,r){var n,i=t.geometry;return"Circle"===i.getType()&&t.index===T?(i=i,(n=(0,_.getUserProjection)())&&(i=i.clone().transform(n,r)),(0,_.toUserCoordinate)(i.getClosestPoint((0,_.fromUserCoordinate)(e,r)),r)):(n=(0,_.fromUserCoordinate)(e,r),R[0]=(0,_.fromUserCoordinate)(t.segment[0],r),R[1]=(0,_.fromUserCoordinate)(t.segment[1],r),(0,_.toUserCoordinate)((0,b.closestOnSegment)(n,R),r))}t.default=e},{"../Collection.js":71,"../CollectionEventType.js":72,"../Feature.js":75,"../MapBrowserEventType.js":86,"../array.js":104,"../coordinate.js":121,"../events/Event.js":126,"../events/EventType.js":127,"../events/condition.js":130,"../extent.js":131,"../geom/Point.js":199,"../geom/Polygon.js":200,"../layer/Vector.js":261,"../proj.js":271,"../source/Vector.js":346,"../source/VectorEventType.js":347,"../structs/RBush.js":357,"../style/Style.js":367,"../util.js":379,"./Pointer.js":241}],238:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(n=e("../events/EventType.js"))&&n.__esModule?n:{default:n},s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Interaction.js")),u=e("../has.js"),l=e("../events/condition.js"),c=e("../math.js");function f(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(f=function(e){return e?r:t})(e))}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this,e=e||{})).totalDelta_=0,t.lastDelta_=0,t.maxDelta_=void 0!==e.maxDelta?e.maxDelta:1,t.duration_=void 0!==e.duration?e.duration:250,t.timeout_=void 0!==e.timeout?e.timeout:80,t.useAnchor_=void 0===e.useAnchor||e.useAnchor,t.constrainResolution_=void 0!==e.constrainResolution&&e.constrainResolution;var r=e.condition||l.always;return t.condition_=e.onFocusOnly?(0,l.all)(l.focusWithTabindex,r):r,t.lastAnchor_=null,t.startTime_=void 0,t.timeoutId_,t.mode_=void 0,t.trackpadEventGap_=400,t.trackpadTimeoutId_,t.deltaPerZoom_=300,t}return t=i,(e=[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0;var e=this.getMap();e&&e.getView().endInteraction(void 0,this.lastDelta_?0<this.lastDelta_?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(e){var t,r,n,i;return!this.condition_(e)||e.type!==o.default.WHEEL||(t=e.map,(n=e.originalEvent).preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.coordinate),e.type==o.default.WHEEL&&(r=n.deltaY,u.FIREFOX&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=u.DEVICE_PIXEL_RATIO),n.deltaMode===WheelEvent.DOM_DELTA_LINE)&&(r*=40),0!==r&&(this.lastDelta_=r,e=Date.now(),void 0===this.startTime_&&(this.startTime_=e),(!this.mode_||e-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel"),n=t.getView(),"trackpad"!==this.mode_||n.getConstrainResolution()||this.constrainResolution_?(this.totalDelta_+=r,i=Math.max(this.timeout_-(e-this.startTime_),0),clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,t),i)):(this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(n.getAnimating()&&n.cancelAnimations(),n.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),n.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=e)),!1)}},{key:"handleWheelZoom_",value:function(e){var e=e.getView(),t=(e.getAnimating()&&e.cancelAnimations(),-(0,c.clamp)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_);(e.getConstrainResolution()||this.constrainResolution_)&&(t=t?0<t?1:-1:0),(0,s.zoomByDelta)(e,t,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(e){(this.useAnchor_=e)||(this.lastAnchor_=null)}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.default);r.default=n},{"../events/EventType.js":127,"../events/condition.js":130,"../has.js":221,"../math.js":267,"./Interaction.js":233}],239:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Pointer.js")),s=e("../functions.js"),u=e("../rotationconstraint.js");function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=h(i);function i(e){var t;if(this instanceof i)return(t=e=e||{}).stopDown||(t.stopDown=s.FALSE),(t=n.call(this,t)).anchor_=null,t.lastAngle_=void 0,t.rotating_=!1,t.rotationDelta_=0,t.threshold_=void 0!==e.threshold?e.threshold:.3,t.duration_=void 0!==e.duration?e.duration:250,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleDragEvent",value:function(e){var t,r=0,n=this.targetPointers[0],i=this.targetPointers[1],i=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX),n=(void 0!==this.lastAngle_&&(n=i-this.lastAngle_,this.rotationDelta_+=n,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),r=n),this.lastAngle_=i,e.map),i=n.getView();i.getConstraints().rotation!==u.disable&&(e=n.getViewport().getBoundingClientRect(),(t=(0,o.centroid)(this.targetPointers))[0]-=e.left,t[1]-=e.top,this.anchor_=n.getCoordinateFromPixelInternal(t),this.rotating_)&&(n.render(),i.adjustRotationInternal(r,this.anchor_))}},{key:"handleUpEvent",value:function(e){return!(this.targetPointers.length<2&&(e.map.getView().endInteraction(this.duration_),1))}},{key:"handleDownEvent",value:function(e){return 2<=this.targetPointers.length&&(e=e.map,this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../functions.js":189,"../rotationconstraint.js":318,"./Pointer.js":241}],240:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Pointer.js")),s=e("../functions.js");function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(i);function i(e){var t;if(this instanceof i)return(t=e=e||{}).stopDown||(t.stopDown=s.FALSE),(t=n.call(this,t)).anchor_=null,t.duration_=void 0!==e.duration?e.duration:400,t.lastDistance_=void 0,t.lastScaleDelta_=1,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"handleDragEvent",value:function(e){var t=1,r=this.targetPointers[0],n=this.targetPointers[1],i=r.clientX-n.clientX,r=r.clientY-n.clientY,n=Math.sqrt(i*i+r*r),i=(void 0!==this.lastDistance_&&(t=this.lastDistance_/n),this.lastDistance_=n,e.map),r=i.getView(),n=(1!=t&&(this.lastScaleDelta_=t),i.getViewport().getBoundingClientRect()),e=(0,o.centroid)(this.targetPointers);e[0]-=n.left,e[1]-=n.top,this.anchor_=i.getCoordinateFromPixelInternal(e),i.render(),r.adjustResolutionInternal(t,this.anchor_)}},{key:"handleUpEvent",value:function(e){var t;return!(this.targetPointers.length<2&&(e=e.map.getView(),t=1<this.lastScaleDelta_?1:-1,e.endInteraction(this.duration_,t),1))}},{key:"handleDownEvent",value:function(e){return 2<=this.targetPointers.length&&(e=e.map,this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../functions.js":189,"./Pointer.js":241}],241:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.centroid=function(e){for(var t=e.length,r=0,n=0,i=0;i<t;i++)r+=e[i].clientX,n+=e[i].clientY;return[r/t,n/t]},r.default=void 0;var n=a(e("./Interaction.js")),o=a(e("../MapBrowserEventType.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(this instanceof i)return t=n.call(this,e=e||{}),e.handleDownEvent&&(t.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(t.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(t.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(t.handleUpEvent=e.handleUpEvent),e.stopDown&&(t.stopDown=e.stopDown),t.handlingDownUpSequence=!1,t.targetPointers=[],t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(e){return!1}},{key:"handleDragEvent",value:function(e){}},{key:"handleEvent",value:function(e){var t,r;return!e.originalEvent||(t=!1,this.updateTrackedPointers_(e),this.handlingDownUpSequence?e.type==o.default.POINTERDRAG?(this.handleDragEvent(e),e.originalEvent.preventDefault()):e.type==o.default.POINTERUP&&(r=this.handleUpEvent(e),this.handlingDownUpSequence=r&&0<this.targetPointers.length):e.type==o.default.POINTERDOWN?(r=this.handleDownEvent(e),this.handlingDownUpSequence=r,t=this.stopDown(r)):e.type==o.default.POINTERMOVE&&this.handleMoveEvent(e),!t)}},{key:"handleMoveEvent",value:function(e){}},{key:"handleUpEvent",value:function(e){return!1}},{key:"stopDown",value:function(e){return e}},{key:"updateTrackedPointers_",value:function(e){e.activePointers&&(this.targetPointers=e.activePointers)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../MapBrowserEventType.js":86,"./Interaction.js":233}],242:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={ACTIVE:"active"}},{}],243:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.SelectEvent=void 0;var a=o(e("../Collection.js")),n=o(e("../CollectionEventType.js")),s=o(e("../events/Event.js")),p=o(e("../Feature.js")),u=o(e("./Interaction.js")),l=o(e("../layer/Vector.js")),c=e("../functions.js"),d=e("../obj.js"),f=e("../style/Style.js"),h=e("../array.js"),y=e("../util.js"),g=e("../events/condition.js");function o(e){return e&&e.__esModule?e:{default:e}}function m(){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function b(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(r),t=(e=n?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return j(t)}}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P="select",k=function(){w(o,s["default"]);var i=S(o);function o(e,t,r,n){return _(this,o),(e=i.call(this,e)).selected=t,e.deselected=r,e.mapBrowserEvent=n,e}return b(o)}(),E=(r.SelectEvent=k,{}),e=function(){w(o,u["default"]);var i=S(o);function o(e){var t,r,n;return _(this,o),(t=i.call(this)).on,t.once,t.un,e=e||{},t.boundAddFeature_=t.addFeature_.bind(j(t)),t.boundRemoveFeature_=t.removeFeature_.bind(j(t)),t.condition_=e.condition||g.singleClick,t.addCondition_=e.addCondition||g.never,t.removeCondition_=e.removeCondition||g.never,t.toggleCondition_=e.toggleCondition||g.shiftKeyOnly,t.multi_=e.multi||!1,t.filter_=e.filter||c.TRUE,t.hitTolerance_=e.hitTolerance||0,t.style_=void 0!==e.style?e.style:(r=(0,f.createEditingStyle)(),(0,h.extend)(r.Polygon,r.LineString),(0,h.extend)(r.GeometryCollection,r.LineString),function(e){return e.getGeometry()?r[e.getGeometry().getType()]:null}),t.features_=e.features||new a.default,e=e.layers?"function"==typeof e.layers?e.layers:(n=e.layers,function(e){return n.includes(e)}):c.TRUE,t.layerFilter_=e,t.featureLayerAssociation_={},t}return b(o,[{key:"addFeatureLayerAssociation_",value:function(e,t){this.featureLayerAssociation_[(0,y.getUid)(e)]=t}},{key:"getFeatures",value:function(){return this.features_}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"getLayer",value:function(e){return this.featureLayerAssociation_[(0,y.getUid)(e)]}},{key:"setHitTolerance",value:function(e){this.hitTolerance_=e}},{key:"setMap",value:function(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),m(O(o.prototype),"setMap",this).call(this,e),e?(this.features_.addEventListener(n.default.ADD,this.boundAddFeature_),this.features_.addEventListener(n.default.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(n.default.ADD,this.boundAddFeature_),this.features_.removeEventListener(n.default.REMOVE,this.boundRemoveFeature_))}},{key:"addFeature_",value:function(e){var t=e.element;this.style_&&this.applySelectedStyle_(t),this.getLayer(t)||(e=this.getMap().getAllLayers().find(function(e){if(e instanceof l.default&&e.getSource()&&e.getSource().hasFeature(t))return e}))&&this.addFeatureLayerAssociation_(t,e)}},{key:"removeFeature_",value:function(e){this.style_&&this.restorePreviousStyle_(e.element)}},{key:"getStyle",value:function(){return this.style_}},{key:"applySelectedStyle_",value:function(e){var t=(0,y.getUid)(e);t in E||(E[t]=e.getStyle()),e.setStyle(this.style_)}},{key:"restorePreviousStyle_",value:function(e){for(var t=this.getMap().getInteractions().getArray(),r=t.length-1;0<=r;--r){var n=t[r];if(n!==this&&n instanceof o&&n.getStyle()&&-1!==n.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(n.getStyle())}var i=(0,y.getUid)(e);e.setStyle(E[i]),delete E[i]}},{key:"removeFeatureLayerAssociation_",value:function(e){delete this.featureLayerAssociation_[(0,y.getUid)(e)]}},{key:"handleEvent",value:function(e){if(this.condition_(e)){var r=this.addCondition_(e),n=this.removeCondition_(e),i=this.toggleCondition_(e),t=!r&&!n&&!i,o=e.map,a=this.getFeatures(),s=[],u=[];if(t){(0,d.clear)(this.featureLayerAssociation_),o.forEachFeatureAtPixel(e.pixel,function(e,t){if(e instanceof p.default&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),u.push(e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=a.getLength()-1;0<=l;--l){var c=a.item(l),f=u.indexOf(c);-1<f?u.splice(f,1):(a.remove(c),s.push(c))}0!==u.length&&a.extend(u)}else{o.forEachFeatureAtPixel(e.pixel,function(e,t){if(e instanceof p.default&&this.filter_(e,t))return!r&&!i||a.getArray().includes(e)?(n||i)&&a.getArray().includes(e)&&(s.push(e),this.removeFeatureLayerAssociation_(e)):(this.addFeatureLayerAssociation_(e,t),u.push(e)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var h=s.length-1;0<=h;--h)a.remove(s[h]);a.extend(u)}(0<u.length||0<s.length)&&this.dispatchEvent(new k(P,u,s,e))}return!0}}]),o}();r.default=e},{"../Collection.js":71,"../CollectionEventType.js":72,"../Feature.js":75,"../array.js":104,"../events/Event.js":126,"../events/condition.js":130,"../functions.js":189,"../layer/Vector.js":261,"../obj.js":269,"../style/Style.js":367,"../util.js":379,"./Interaction.js":233}],244:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=p(e("../CollectionEventType.js")),a=p(e("../events/EventType.js")),n=p(e("./Pointer.js")),s=p(e("../structs/RBush.js")),u=p(e("../source/VectorEventType.js")),l=e("../functions.js"),b=e("../extent.js"),_=e("../coordinate.js"),c=e("../geom/Polygon.js"),w=e("../proj.js"),f=e("../util.js"),h=e("../events.js");function p(e){return e&&e.__esModule?e:{default:e}}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?d(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=j(r),t=(e=n?(e=j(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){return e.feature||e.element||void 0}var P=[],e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e);var r,n=v(i);function i(e){var t;if(this instanceof i)return(t=e=e||{}).handleDownEvent||(t.handleDownEvent=l.TRUE),t.stopDown||(t.stopDown=l.FALSE),(t=n.call(this,t)).source_=e.source||null,t.vertex_=void 0===e.vertex||e.vertex,t.edge_=void 0===e.edge||e.edge,t.features_=e.features||null,t.featuresListenerKeys_=[],t.featureChangeListenerKeys_={},t.indexedFeaturesExtents_={},t.pendingFeatures_={},t.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,t.rBush_=new s.default,t.GEOMETRY_SEGMENTERS_={Point:t.segmentPointGeometry_.bind(S(t)),LineString:t.segmentLineStringGeometry_.bind(S(t)),LinearRing:t.segmentLineStringGeometry_.bind(S(t)),Polygon:t.segmentPolygonGeometry_.bind(S(t)),MultiPoint:t.segmentMultiPointGeometry_.bind(S(t)),MultiLineString:t.segmentMultiLineStringGeometry_.bind(S(t)),MultiPolygon:t.segmentMultiPolygonGeometry_.bind(S(t)),GeometryCollection:t.segmentGeometryCollectionGeometry_.bind(S(t)),Circle:t.segmentCircleGeometry_.bind(S(t))},t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"addFeature",value:function(t,e){e=void 0===e||e;var r,n=(0,f.getUid)(t),i=t.getGeometry();i&&(r=this.GEOMETRY_SEGMENTERS_[i.getType()])&&(this.indexedFeaturesExtents_[n]=i.getExtent((0,b.createEmpty)()),r(r=[],i),1===r.length?this.rBush_.insert((0,b.boundingExtent)(r[0]),{feature:t,segment:r[0]}):1<r.length&&(i=r.map(function(e){return(0,b.boundingExtent)(e)}),r=r.map(function(e){return{feature:t,segment:e}}),this.rBush_.load(i,r))),e&&(this.featureChangeListenerKeys_[n]=(0,h.listen)(t,a.default.CHANGE,this.handleFeatureChange_,this))}},{key:"forEachFeatureAdd_",value:function(e){this.addFeature(e)}},{key:"forEachFeatureRemove_",value:function(e){this.removeFeature(e)}},{key:"getFeatures_",value:function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e}},{key:"handleEvent",value:function(e){var t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),g(j(i.prototype),"handleEvent",this).call(this,e)}},{key:"handleFeatureAdd_",value:function(e){e=O(e);this.addFeature(e)}},{key:"handleFeatureRemove_",value:function(e){e=O(e);this.removeFeature(e)}},{key:"handleFeatureChange_",value:function(e){var t,e=e.target;this.handlingDownUpSequence?(t=(0,f.getUid)(e))in this.pendingFeatures_||(this.pendingFeatures_[t]=e):this.updateFeature_(e)}},{key:"handleUpEvent",value:function(e){var t=Object.values(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}},{key:"removeFeature",value:function(t,e){var e=void 0===e||e,r=(0,f.getUid)(t),n=this.indexedFeaturesExtents_[r];if(n){var i=this.rBush_,o=[];i.forEachInExtent(n,function(e){t===e.feature&&o.push(e)});for(var a=o.length-1;0<=a;--a)i.remove(o[a])}e&&((0,h.unlistenByKey)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])}},{key:"setMap",value:function(e){var t=this.getMap(),r=this.featuresListenerKeys_,n=this.getFeatures_();t&&(r.forEach(h.unlistenByKey),r.length=0,n.forEach(this.forEachFeatureRemove_.bind(this))),g(j(i.prototype),"setMap",this).call(this,e),e&&(this.features_?r.push((0,h.listen)(this.features_,o.default.ADD,this.handleFeatureAdd_,this),(0,h.listen)(this.features_,o.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&r.push((0,h.listen)(this.source_,u.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,h.listen)(this.source_,u.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),n.forEach(this.forEachFeatureAdd_.bind(this)))}},{key:"snapTo",value:function(t,e,r){var n=r.getCoordinateFromPixel([t[0]-this.pixelTolerance_,t[1]+this.pixelTolerance_]),i=r.getCoordinateFromPixel([t[0]+this.pixelTolerance_,t[1]-this.pixelTolerance_]),n=(0,b.boundingExtent)([n,i]),o=this.rBush_.getInExtent(n),a=o.length;if(0!==a){var s,u=r.getView().getProjection(),l=(0,w.fromUserCoordinate)(e,u),c=1/0,f=this.pixelTolerance_*this.pixelTolerance_,i=function(){if(s){var e=r.getPixelFromCoordinate(s);if((0,_.squaredDistance)(t,e)<=f)return{vertex:s,vertexPixel:[Math.round(e[0]),Math.round(e[1])]}}return null};if(this.vertex_){for(var h=0;h<a;++h){var p=o[h];"Circle"!==p.feature.getGeometry().getType()&&p.segment.forEach(function(e){var t=(0,w.fromUserCoordinate)(e,u),t=(0,_.squaredDistance)(l,t);t<c&&(s=e,c=t)})}n=i();if(n)return n}if(this.edge_){for(var d=0;d<a;++d){var y,g,m=null,v=o[d];"Circle"===v.feature.getGeometry().getType()?(g=v.feature.getGeometry(),(y=(0,w.getUserProjection)())&&(g=g.clone().transform(y,u)),m=(0,w.toUserCoordinate)((0,_.closestOnCircle)(l,g),u)):(g=(y=x(v.segment,2))[0],(v=y[1])&&(P[0]=(0,w.fromUserCoordinate)(g,u),P[1]=(0,w.fromUserCoordinate)(v,u),m=(0,_.closestOnSegment)(l,P))),m&&(v=(0,_.squaredDistance)(l,m))<c&&(s=m,c=v)}e=i();if(e)return e}}return null}},{key:"updateFeature_",value:function(e){this.removeFeature(e,!1),this.addFeature(e,!1)}},{key:"segmentCircleGeometry_",value:function(e,t){for(var r=this.getMap().getView().getProjection(),n=(0,w.getUserProjection)(),t=(n&&(t=t.clone().transform(n,r)),(0,c.fromCircle)(t)),i=(n&&t.transform(r,n),t.getCoordinates()[0]),o=0,a=i.length-1;o<a;++o)e.push(i.slice(o,o+2))}},{key:"segmentGeometryCollectionGeometry_",value:function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var i=this.GEOMETRY_SEGMENTERS_[r[n].getType()];i&&i(e,r[n])}}},{key:"segmentLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length-1;n<i;++n)e.push(r.slice(n,n+2))}},{key:"segmentMultiLineStringGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length-1;a<s;++a)e.push(o.slice(a,a+2))}},{key:"segmentMultiPointGeometry_",value:function(t,e){e.getCoordinates().forEach(function(e){t.push([e])})}},{key:"segmentMultiPolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length;a<s;++a)for(var u=o[a],l=0,c=u.length-1;l<c;++l)e.push(u.slice(l,l+2))}},{key:"segmentPointGeometry_",value:function(e,t){e.push([t.getCoordinates()])}},{key:"segmentPolygonGeometry_",value:function(e,t){for(var r=t.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],a=0,s=o.length-1;a<s;++a)e.push(o.slice(a,a+2))}}])&&y(t.prototype,e),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../CollectionEventType.js":72,"../coordinate.js":121,"../events.js":125,"../events/EventType.js":127,"../extent.js":131,"../functions.js":189,"../geom/Polygon.js":200,"../proj.js":271,"../source/VectorEventType.js":347,"../structs/RBush.js":357,"../util.js":379,"./Pointer.js":241}],245:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.TranslateEvent=void 0;var a=o(e("../Collection.js")),n=o(e("../events/Event.js")),s=o(e("./Property.js")),u=o(e("./Pointer.js")),l=e("../functions.js"),c=e("../events/condition.js");function o(e){return e&&e.__esModule?e:{default:e}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b="translatestart",_="translating",w="translateend",x=function(){y(a,n["default"]);var o=m(a);function a(e,t,r,n,i){return d(this,a),(e=o.call(this,e)).features=t,e.coordinate=r,e.startCoordinate=n,e.mapBrowserEvent=i,e}return p(a)}(),e=(r.TranslateEvent=x,function(){y(o,u["default"]);var i=m(o);function o(e){var t,r,n;return d(this,o),(t=i.call(this,e=e||{})).on,t.once,t.un,t.lastCoordinate_=null,t.startCoordinate_=null,t.features_=void 0!==e.features?e.features:null,n=e.layers&&!t.features_?"function"==typeof e.layers?e.layers:(r=e.layers,function(e){return r.includes(e)}):l.TRUE,t.layerFilter_=n,t.filter_=e.filter&&!t.features_?e.filter:l.TRUE,t.hitTolerance_=e.hitTolerance||0,t.condition_=e.condition||c.always,t.lastFeature_=null,t.addChangeListener(s.default.ACTIVE,t.handleActiveChanged_),t}return p(o,[{key:"handleDownEvent",value:function(e){var t;return!(!e.originalEvent||!this.condition_(e)||(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),this.lastCoordinate_)||!this.lastFeature_||(this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e),t=this.features_||new a.default([this.lastFeature_]),this.dispatchEvent(new x(b,t,e.coordinate,this.startCoordinate_,e)),0))}},{key:"handleUpEvent",value:function(e){var t;return!(!this.lastCoordinate_||(this.lastCoordinate_=null,this.handleMoveEvent(e),t=this.features_||new a.default([this.lastFeature_]),this.dispatchEvent(new x(w,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null))}},{key:"handleDragEvent",value:function(e){var t,r,n,i;this.lastCoordinate_&&(t=e.coordinate,r=t[0]-this.lastCoordinate_[0],n=t[1]-this.lastCoordinate_[1],(i=this.features_||new a.default([this.lastFeature_])).forEach(function(e){var t=e.getGeometry();t.translate(r,n),e.setGeometry(t)}),this.lastCoordinate_=t,this.dispatchEvent(new x(_,i,t,this.startCoordinate_,e)))}},{key:"handleMoveEvent",value:function(e){var t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}},{key:"featuresAtPixel_",value:function(e,t){return t.forEachFeatureAtPixel(e,function(e,t){if(this.filter_(e,t)&&(!this.features_||this.features_.getArray().includes(e)))return e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"setHitTolerance",value:function(e){this.hitTolerance_=e}},{key:"setMap",value:function(e){var t=this.getMap();f(v(o.prototype),"setMap",this).call(this,e),this.updateState_(t)}},{key:"handleActiveChanged_",value:function(){this.updateState_(null)}},{key:"updateState_",value:function(e){var t=this.getMap(),r=this.getActive();t&&r||(t=t||e)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")}}]),o}());r.default=e},{"../Collection.js":71,"../events/Event.js":126,"../events/condition.js":130,"../functions.js":189,"./Pointer.js":241,"./Property.js":242}],246:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaults=function(e){e=e||{};var t=new n.default,r=new c.default(-.005,.05,100);void 0!==e.altShiftDragRotate&&!e.altShiftDragRotate||t.push(new a.default);void 0!==e.doubleClickZoom&&!e.doubleClickZoom||t.push(new i.default({delta:e.zoomDelta,duration:e.zoomDuration}));void 0!==e.dragPan&&!e.dragPan||t.push(new o.default({onFocusOnly:e.onFocusOnly,kinetic:r}));void 0!==e.pinchRotate&&!e.pinchRotate||t.push(new h.default);void 0!==e.pinchZoom&&!e.pinchZoom||t.push(new p.default({duration:e.zoomDuration}));void 0!==e.keyboard&&!e.keyboard||(t.push(new u.default),t.push(new l.default({delta:e.zoomDelta,duration:e.zoomDuration})));void 0!==e.mouseWheelZoom&&!e.mouseWheelZoom||t.push(new f.default({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));void 0!==e.shiftDragZoom&&!e.shiftDragZoom||t.push(new s.default({duration:e.zoomDuration}));return t};var n=d(e("../Collection.js")),i=d(e("./DoubleClickZoom.js")),o=d(e("./DragPan.js")),a=d(e("./DragRotate.js")),s=d(e("./DragZoom.js")),u=d(e("./KeyboardPan.js")),l=d(e("./KeyboardZoom.js")),c=d(e("../Kinetic.js")),f=d(e("./MouseWheelZoom.js")),h=d(e("./PinchRotate.js")),p=d(e("./PinchZoom.js"));function d(e){return e&&e.__esModule?e:{default:e}}},{"../Collection.js":71,"../Kinetic.js":82,"./DoubleClickZoom.js":224,"./DragPan.js":227,"./DragRotate.js":228,"./DragZoom.js":230,"./KeyboardPan.js":234,"./KeyboardZoom.js":235,"./MouseWheelZoom.js":238,"./PinchRotate.js":239,"./PinchZoom.js":240}],247:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Graticule",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"Group",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"Heatmap",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"Layer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"MapboxVector",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"Tile",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"Vector",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"VectorImage",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"VectorTile",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"WebGLPoints",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"WebGLTile",{enumerable:!0,get:function(){return d.default}});var n=y(e("./layer/Graticule.js")),i=y(e("./layer/Group.js")),o=y(e("./layer/Heatmap.js")),a=y(e("./layer/Image.js")),s=y(e("./layer/Layer.js")),u=y(e("./layer/MapboxVector.js")),l=y(e("./layer/Tile.js")),c=y(e("./layer/Vector.js")),f=y(e("./layer/VectorImage.js")),h=y(e("./layer/VectorTile.js")),p=y(e("./layer/WebGLPoints.js")),d=y(e("./layer/WebGLTile.js"));function y(e){return e&&e.__esModule?e:{default:e}}},{"./layer/Graticule.js":252,"./layer/Group.js":253,"./layer/Heatmap.js":254,"./layer/Image.js":255,"./layer/Layer.js":256,"./layer/MapboxVector.js":257,"./layer/Tile.js":259,"./layer/Vector.js":261,"./layer/VectorImage.js":262,"./layer/VectorTile.js":263,"./layer/WebGLPoints.js":264,"./layer/WebGLTile.js":265}],248:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("../Object.js")),o=i(e("./Property.js")),a=e("../util.js"),s=e("../asserts.js"),u=e("../math.js");function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===l(e)?e:String(e)}(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this)).on,t.once,t.un,t.background_=e.background;var r=Object.assign({},e);return"object"===l(e.properties)&&(delete r.properties,Object.assign(r,e.properties)),r[o.default.OPACITY]=void 0!==e.opacity?e.opacity:1,(0,s.assert)("number"==typeof r[o.default.OPACITY],64),r[o.default.VISIBLE]=void 0===e.visible||e.visible,r[o.default.Z_INDEX]=e.zIndex,r[o.default.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,r[o.default.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,r[o.default.MIN_ZOOM]=void 0!==e.minZoom?e.minZoom:-1/0,r[o.default.MAX_ZOOM]=void 0!==e.maxZoom?e.maxZoom:1/0,t.className_=void 0!==r.className?r.className:"ol-layer",delete r.className,t.setProperties(r),t.state_=null,t}return t=i,(e=[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(e){var e=this.state_||{layer:this,managed:void 0===e||e},t=this.getZIndex();return e.opacity=(0,u.clamp)(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==t||e.managed?t:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e}},{key:"getLayersArray",value:function(e){return(0,a.abstract)()}},{key:"getLayerStatesArray",value:function(e){return(0,a.abstract)()}},{key:"getExtent",value:function(){return this.get(o.default.EXTENT)}},{key:"getMaxResolution",value:function(){return this.get(o.default.MAX_RESOLUTION)}},{key:"getMinResolution",value:function(){return this.get(o.default.MIN_RESOLUTION)}},{key:"getMinZoom",value:function(){return this.get(o.default.MIN_ZOOM)}},{key:"getMaxZoom",value:function(){return this.get(o.default.MAX_ZOOM)}},{key:"getOpacity",value:function(){return this.get(o.default.OPACITY)}},{key:"getSourceState",value:function(){return(0,a.abstract)()}},{key:"getVisible",value:function(){return this.get(o.default.VISIBLE)}},{key:"getZIndex",value:function(){return this.get(o.default.Z_INDEX)}},{key:"setBackground",value:function(e){this.background_=e,this.changed()}},{key:"setExtent",value:function(e){this.set(o.default.EXTENT,e)}},{key:"setMaxResolution",value:function(e){this.set(o.default.MAX_RESOLUTION,e)}},{key:"setMinResolution",value:function(e){this.set(o.default.MIN_RESOLUTION,e)}},{key:"setMaxZoom",value:function(e){this.set(o.default.MAX_ZOOM,e)}},{key:"setMinZoom",value:function(e){this.set(o.default.MIN_ZOOM,e)}},{key:"setOpacity",value:function(e){(0,s.assert)("number"==typeof e,64),this.set(o.default.OPACITY,e)}},{key:"setVisible",value:function(e){this.set(o.default.VISIBLE,e)}},{key:"setZIndex",value:function(e){this.set(o.default.Z_INDEX,e)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),f(d(i.prototype),"disposeInternal",this).call(this)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Object.js":90,"../asserts.js":105,"../math.js":267,"../util.js":379,"./Property.js":258}],249:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){if(this instanceof o)return i.call(this,e=e||{});throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("./Layer.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./Layer.js":256}],250:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./Layer.js")),o=a(e("./TileProperty.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({},e);return delete t.preload,delete t.useInterimTilesOnError,(t=n.call(this,t)).on,t.once,t.un,t.setPreload(void 0!==e.preload?e.preload:0),t.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),t}return t=i,(e=[{key:"getPreload",value:function(){return this.get(o.default.PRELOAD)}},{key:"setPreload",value:function(e){this.set(o.default.PRELOAD,e)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(o.default.USE_INTERIM_TILES_ON_ERROR)}},{key:"setUseInterimTilesOnError",value:function(e){this.set(o.default.USE_INTERIM_TILES_ON_ERROR,e)}},{key:"getData",value:function(e){return u(f(i.prototype),"getData",this).call(this,e)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"./Layer.js":256,"./TileProperty.js":260}],251:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./Layer.js")),o=i(e("rbush")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("../style/Style.js")),u=e("../style/flat.js");function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function i(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y="renderOrder",e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({},e);return delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,(t=n.call(this,t)).declutter_=void 0!==e.declutter&&e.declutter,t.renderBuffer_=void 0!==e.renderBuffer?e.renderBuffer:100,t.style_=null,t.styleFunction_=void 0,t.setStyle(e.style),t.updateWhileAnimating_=void 0!==e.updateWhileAnimating&&e.updateWhileAnimating,t.updateWhileInteracting_=void 0!==e.updateWhileInteracting&&e.updateWhileInteracting,t}return t=i,(e=[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(e){return f(d(i.prototype),"getFeatures",this).call(this,e)}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(y)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(e){e.declutterTree||(e.declutterTree=new o.default(9)),this.getRenderer().renderDeclutter(e)}},{key:"setRenderOrder",value:function(e){this.set(y,e)}},{key:"setStyle",value:function(e){var t;if(void 0===e)t=s.createDefaultStyle;else if(null===e)t=null;else if("function"==typeof e)t=e;else if(e instanceof s.default)t=e;else if(Array.isArray(e)){for(var r=e.length,n=new Array(r),i=0;i<r;++i){var o=e[i];o instanceof s.default?n[i]=o:n[i]=(0,u.toStyle)(o)}t=n}else t=(0,u.toStyle)(e);this.style_=t,this.styleFunction_=null===e?void 0:(0,s.toFunction)(this.style_),this.changed()}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../style/Style.js":367,"../style/flat.js":370,"./Layer.js":256,rbush:398}],252:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=b(e("../Collection.js")),a=b(e("../render/EventType.js")),h=b(e("../Feature.js")),s=b(e("../style/Fill.js")),u=b(e("../geom/LineString.js")),l=b(e("../geom/Point.js")),c=b(e("../style/Stroke.js")),f=b(e("../style/Style.js")),p=b(e("../style/Text.js")),n=b(e("./Vector.js")),d=b(e("../source/Vector.js")),S=e("../extent.js"),m=e("../math.js"),y=e("../coordinate.js"),g=e("../proj.js"),j=e("../render.js"),v=e("../geom/flat/geodesic.js");function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=P(r),t=(e=n?(e=P(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=new c.default({color:"rgba(0,0,0,0.2)"}),E=[90,45,30,20,10,5,2,1,.5,20/60,10/60,5/60,2/60,1/60,30/3600,20/3600,10/3600,5/3600,2/3600,1/3600],e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e);var r,n=x(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},e);return delete t.maxLines,delete t.strokeStyle,delete t.targetSize,delete t.showLabels,delete t.lonLabelFormatter,delete t.latLabelFormatter,delete t.lonLabelPosition,delete t.latLabelPosition,delete t.lonLabelStyle,delete t.latLabelStyle,delete t.intervals,(t=n.call(this,t)).projection_=null,t.maxLat_=1/0,t.maxLon_=1/0,t.minLat_=-1/0,t.minLon_=-1/0,t.maxX_=1/0,t.maxY_=1/0,t.minX_=-1/0,t.minY_=-1/0,t.targetSize_=void 0!==e.targetSize?e.targetSize:100,t.maxLines_=void 0!==e.maxLines?e.maxLines:100,t.meridians_=[],t.parallels_=[],t.strokeStyle_=void 0!==e.strokeStyle?e.strokeStyle:k,t.fromLonLatTransform_=void 0,t.toLonLatTransform_=void 0,t.projectionCenterLonLat_=null,t.bottomLeft_=null,t.bottomRight_=null,t.topLeft_=null,t.topRight_=null,t.meridiansLabels_=null,t.parallelsLabels_=null,e.showLabels&&(t.lonLabelFormatter_=null==e.lonLabelFormatter?y.degreesToStringHDMS.bind(O(t),"EW"):e.lonLabelFormatter,t.latLabelFormatter_=null==e.latLabelFormatter?y.degreesToStringHDMS.bind(O(t),"NS"):e.latLabelFormatter,t.lonLabelPosition_=null==e.lonLabelPosition?0:e.lonLabelPosition,t.latLabelPosition_=null==e.latLabelPosition?1:e.latLabelPosition,t.lonLabelStyleBase_=new f.default({text:void 0!==e.lonLabelStyle?e.lonLabelStyle.clone():new p.default({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new s.default({color:"rgba(0,0,0,1)"}),stroke:new c.default({color:"rgba(255,255,255,1)",width:3})})}),t.lonLabelStyle_=function(e){e=e.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_}.bind(O(t)),t.latLabelStyleBase_=new f.default({text:void 0!==e.latLabelStyle?e.latLabelStyle.clone():new p.default({font:"12px Calibri,sans-serif",textAlign:"right",fill:new s.default({color:"rgba(0,0,0,1)"}),stroke:new c.default({color:"rgba(255,255,255,1)",width:3})})}),t.latLabelStyle_=function(e){e=e.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_}.bind(O(t)),t.meridiansLabels_=[],t.parallelsLabels_=[],t.addEventListener(a.default.POSTRENDER,t.drawLabels_.bind(O(t)))),t.intervals_=void 0!==e.intervals?e.intervals:E,t.setSource(new d.default({loader:t.loaderFunction.bind(O(t)),strategy:t.strategyFunction.bind(O(t)),features:new o.default,overlaps:!1,useSpatialIndex:!1,wrapX:e.wrapX})),t.featurePool_=[],t.lineStyle_=new f.default({stroke:t.strokeStyle_}),t.loadedExtent_=null,t.renderedExtent_=null,t.renderedResolution_=null,t.setRenderOrder(null),t}return t=i,(e=[{key:"strategyFunction",value:function(e,t){e=e.slice();return this.projection_&&this.getSource().getWrapX()&&(0,S.wrapX)(e,this.projection_),this.loadedExtent_&&((0,S.approximatelyEquals)(this.loadedExtent_,e,t)?e=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[e]}},{key:"loaderFunction",value:function(e,t,r){this.loadedExtent_=e;var n=this.getSource(),i=this.getExtent()||[-1/0,-1/0,1/0,1/0],i=(0,S.getIntersection)(i,e);if(!(this.renderedExtent_&&(0,S.equals)(this.renderedExtent_,i)&&this.renderedResolution_===t||(this.renderedExtent_=i,this.renderedResolution_=t,(0,S.isEmpty)(i)))){var o,e=(0,S.getCenter)(i),a=t*t/4,s=((!this.projection_||!(0,g.equivalent)(this.projection_,r))&&this.updateProjectionInfo_(r),this.createGraticule_(i,e,t,a),this.meridians_.length+this.parallels_.length);for(this.meridiansLabels_&&(s+=this.meridians_.length),this.parallelsLabels_&&(s+=this.parallels_.length);s>this.featurePool_.length;)o=new h.default,this.featurePool_.push(o);for(var u=n.getFeaturesCollection(),l=(u.clear(),0),c=0,f=this.meridians_.length;c<f;++c)(o=this.featurePool_[l++]).setGeometry(this.meridians_[c]),o.setStyle(this.lineStyle_),u.push(o);for(c=0,f=this.parallels_.length;c<f;++c)(o=this.featurePool_[l++]).setGeometry(this.parallels_[c]),o.setStyle(this.lineStyle_),u.push(o)}}},{key:"addMeridian_",value:function(e,t,r,n,i,o){t=this.getMeridian_(e,t,r,n,o);return(0,S.intersects)(t.getExtent(),i)&&(this.meridiansLabels_&&(r=this.lonLabelFormatter_(e),o in this.meridiansLabels_?this.meridiansLabels_[o].text=r:this.meridiansLabels_[o]={geom:new l.default([]),text:r}),this.meridians_[o++]=t),o}},{key:"addParallel_",value:function(e,t,r,n,i,o){t=this.getParallel_(e,t,r,n,o);return(0,S.intersects)(t.getExtent(),i)&&(this.parallelsLabels_&&(r=this.latLabelFormatter_(e),o in this.parallelsLabels_?this.parallelsLabels_[o].text=r:this.parallelsLabels_[o]={geom:new l.default([]),text:r}),this.parallels_[o++]=t),o}},{key:"drawLabels_",value:function(e){for(var t,r=e.frameState.viewState.rotation,n=e.frameState.viewState.resolution,i=e.frameState.size,o=e.frameState.extent,a=(0,S.getCenter)(o),s=o,u=(r&&(t=i[0]*n,i=i[1]*n,s=[a[0]-t/2,a[1]-i/2,a[0]+t/2,a[1]+i/2]),0),l=0,c=this.latLabelPosition_<.5,n=this.projection_.getExtent(),f=(0,S.getWidth)(n),h=(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,S.containsExtent)(n,o)&&(u=Math.floor((o[0]-n[0])/f),l=Math.ceil((o[2]-n[2])/f),c=c!==Math.abs(r)>Math.PI/2),(0,j.getVectorContext)(e)),p=u;p<=l;++p){var d=this.meridians_.length+this.parallels_.length,y=void 0,g=void 0,m=void 0,v=void 0;if(this.meridiansLabels_)for(g=0,m=this.meridiansLabels_.length;g<m;++g){var b,_=this.meridians_[g];r||0!==p?((b=_.clone()).translate(p*f,0),b.rotate(-r,a),(v=this.getMeridianPoint_(b,s,g)).rotate(r,a)):v=this.getMeridianPoint_(_,o,g),(y=this.featurePool_[d++]).setGeometry(v),y.set("graticule_label",this.meridiansLabels_[g].text),h.drawFeature(y,this.lonLabelStyle_(y))}if(this.parallelsLabels_&&(p===u&&c||p===l&&!c))for(g=0,m=this.parallels_.length;g<m;++g){var w,x=this.parallels_[g];r||0!==p?((w=x.clone()).translate(p*f,0),w.rotate(-r,a),(v=this.getParallelPoint_(w,s,g)).rotate(r,a)):v=this.getParallelPoint_(x,o,g),(y=this.featurePool_[d++]).setGeometry(v),y.set("graticule_label",this.parallelsLabels_[g].text),h.drawFeature(y,this.latLabelStyle_(y))}}}},{key:"createGraticule_",value:function(e,t,r,n){var i=this.getInterval_(r);if(-1==i)this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),this.parallelsLabels_&&(this.parallelsLabels_.length=0);else{var o,a,s,u,r=!1,l=this.projection_.getExtent(),c=(0,S.getWidth)(l),c=(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,S.containsExtent)(l,e)&&((0,S.getWidth)(e)>=c?(e[0]=l[0],e[2]=l[2]):r=!0),[(0,m.clamp)(t[0],this.minX_,this.maxX_),(0,m.clamp)(t[1],this.minY_,this.maxY_)]),l=this.toLonLatTransform_(c),t=(isNaN(l[1])&&(l[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),(0,m.clamp)(l[0],this.minLon_,this.maxLon_)),c=(0,m.clamp)(l[1],this.minLat_,this.maxLat_),f=this.maxLines_,l=e,h=(r||(l=[(0,m.clamp)(e[0],this.minX_,this.maxX_),(0,m.clamp)(e[1],this.minY_,this.maxY_),(0,m.clamp)(e[2],this.minX_,this.maxX_),(0,m.clamp)(e[3],this.minY_,this.maxY_)]),(0,S.applyTransform)(l,this.toLonLatTransform_,void 0,8)),p=h[3],d=h[2],y=h[1],g=h[0];if(r||((0,S.containsCoordinate)(l,this.bottomLeft_)&&(g=this.minLon_,y=this.minLat_),(0,S.containsCoordinate)(l,this.bottomRight_)&&(d=this.maxLon_,y=this.minLat_),(0,S.containsCoordinate)(l,this.topLeft_)&&(g=this.minLon_,p=this.maxLat_),(0,S.containsCoordinate)(l,this.topRight_)&&(d=this.maxLon_,p=this.maxLat_),p=(0,m.clamp)(p,c,this.maxLat_),d=(0,m.clamp)(d,t,this.maxLon_),y=(0,m.clamp)(y,this.minLat_,c),g=(0,m.clamp)(g,this.minLon_,t)),t=Math.floor(t/i)*i,u=(0,m.clamp)(t,this.minLon_,this.maxLon_),a=this.addMeridian_(u,y,p,n,e,0),o=0,r)for(;(u-=i)>=g&&o++<f;)a=this.addMeridian_(u,y,p,n,e,a);else for(;u!=this.minLon_&&o++<f;)u=Math.max(u-i,this.minLon_),a=this.addMeridian_(u,y,p,n,e,a);if(u=(0,m.clamp)(t,this.minLon_,this.maxLon_),o=0,r)for(;(u+=i)<=d&&o++<f;)a=this.addMeridian_(u,y,p,n,e,a);else for(;u!=this.maxLon_&&o++<f;)u=Math.min(u+i,this.maxLon_),a=this.addMeridian_(u,y,p,n,e,a);for(this.meridians_.length=a,this.meridiansLabels_&&(this.meridiansLabels_.length=a),c=Math.floor(c/i)*i,s=(0,m.clamp)(c,this.minLat_,this.maxLat_),a=this.addParallel_(s,g,d,n,e,0),o=0;s!=this.minLat_&&o++<f;)s=Math.max(s-i,this.minLat_),a=this.addParallel_(s,g,d,n,e,a);for(s=(0,m.clamp)(c,this.minLat_,this.maxLat_),o=0;s!=this.maxLat_&&o++<f;)s=Math.min(s+i,this.maxLat_),a=this.addParallel_(s,g,d,n,e,a);this.parallels_.length=a,this.parallelsLabels_&&(this.parallelsLabels_.length=a)}}},{key:"getInterval_",value:function(e){for(var t=this.projectionCenterLonLat_[0],r=this.projectionCenterLonLat_[1],n=-1,i=Math.pow(this.targetSize_*e,2),o=[],a=[],s=0,u=this.intervals_.length;s<u;++s){var l=(0,m.clamp)(this.intervals_[s]/2,0,90),c=(0,m.clamp)(r,-90+l,90-l);if(o[0]=t-l,o[1]=c-l,a[0]=t+l,a[1]=c+l,this.fromLonLatTransform_(o,o),this.fromLonLatTransform_(a,a),Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)<=i)break;n=this.intervals_[s]}return n}},{key:"getMeridian_",value:function(e,t,r,n,i){e=(0,v.meridian)(e,t,r,this.projection_,n),t=this.meridians_[i];return t?(t.setFlatCoordinates("XY",e),t.changed()):(t=new u.default(e,"XY"),this.meridians_[i]=t),t}},{key:"getMeridianPoint_",value:function(e,t,r){var e=e.getFlatCoordinates(),n=1,i=e.length-1,o=(e[n]>e[i]&&(n=i,i=1),Math.max(t[1],e[n])),a=Math.min(t[3],e[i]),t=(0,m.clamp)(t[1]+Math.abs(t[1]-t[3])*this.lonLabelPosition_,o,a),o=e[n-1]+(e[i-1]-e[n-1])*(t-e[n])/(e[i]-e[n]),a=this.meridiansLabels_[r].geom;return a.setCoordinates([o,t]),a}},{key:"getMeridians",value:function(){return this.meridians_}},{key:"getParallel_",value:function(e,t,r,n,i){e=(0,v.parallel)(e,t,r,this.projection_,n),t=this.parallels_[i];return t?(t.setFlatCoordinates("XY",e),t.changed()):t=new u.default(e,"XY"),t}},{key:"getParallelPoint_",value:function(e,t,r){var e=e.getFlatCoordinates(),n=0,i=e.length-2,o=(e[n]>e[i]&&(n=i,i=0),Math.max(t[0],e[n])),a=Math.min(t[2],e[i]),t=(0,m.clamp)(t[0]+Math.abs(t[0]-t[2])*this.latLabelPosition_,o,a),o=e[n+1]+(e[i+1]-e[n+1])*(t-e[n])/(e[i]-e[n]),a=this.parallelsLabels_[r].geom;return a.setCoordinates([t,o]),a}},{key:"getParallels",value:function(){return this.parallels_}},{key:"updateProjectionInfo_",value:function(e){var a,t=(0,g.get)("EPSG:4326"),r=e.getWorldExtent(),s=(this.maxLat_=r[3],this.maxLon_=r[2],this.minLat_=r[1],this.minLon_=r[0],(0,g.getTransform)(e,t)),r=(this.minLon_<this.maxLon_?this.toLonLatTransform_=s:(a=this.minLon_+this.maxLon_/2,this.maxLon_+=360,this.toLonLatTransform_=function(e,t,r){for(var n=s(e,t,r=r||2),i=0,o=n.length;i<o;i+=r)n[i]<a&&(n[i]+=360);return n}),this.fromLonLatTransform_=(0,g.getTransform)(t,e),(0,S.applyTransform)([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8));this.minX_=r[0],this.maxX_=r[2],this.minY_=r[1],this.maxY_=r[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_((0,S.getCenter)(e.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=e}}])&&_(t.prototype,e),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Collection.js":71,"../Feature.js":75,"../coordinate.js":121,"../extent.js":131,"../geom/LineString.js":194,"../geom/Point.js":199,"../geom/flat/geodesic.js":208,"../math.js":267,"../proj.js":271,"../render.js":279,"../render/EventType.js":282,"../source/Vector.js":346,"../style/Fill.js":360,"../style/Stroke.js":366,"../style/Style.js":367,"../style/Text.js":368,"./Vector.js":261}],253:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.GroupEvent=void 0;var o=n(e("./Base.js")),a=n(e("../Collection.js")),s=n(e("../CollectionEventType.js")),u=n(e("../events/Event.js")),l=n(e("../events/EventType.js")),c=n(e("../ObjectEventType.js")),f=e("../asserts.js"),h=e("../obj.js"),p=e("../extent.js"),d=e("../util.js"),y=e("../events.js");function n(e){return e&&e.__esModule?e:{default:e}}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function m(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=x(r),t=(e=n?(e=x(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(){b(n,u["default"]);var r=w(n);function n(e,t){return v(this,n),(e=r.call(this,e)).layer=t,e}return m(n)}();r.GroupEvent=S;var j="layers",e=function(){b(n,o["default"]);var r=w(n);function n(e){v(this,n),e=e||{};var t=Object.assign({},e),e=(delete t.layers,e.layers),t=r.call(this,t);return t.on,t.once,t.un,t.layersListenerKeys_=[],t.listenerKeys_={},t.addChangeListener(j,t.handleLayersChanged_),e?Array.isArray(e)?e=new a.default(e.slice(),{unique:!0}):(0,f.assert)("function"==typeof e.getArray,43):e=new a.default(void 0,{unique:!0}),t.setLayers(e),t}return m(n,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(y.unlistenByKey),this.layersListenerKeys_.length=0;var e,t=this.getLayers();for(e in this.layersListenerKeys_.push((0,y.listen)(t,s.default.ADD,this.handleLayersAdd_,this),(0,y.listen)(t,s.default.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(y.unlistenByKey);(0,h.clear)(this.listenerKeys_);for(var r=t.getArray(),n=0,i=r.length;n<i;n++){var o=r[n];this.registerLayerListeners_(o),this.dispatchEvent(new S("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(e){var t=[(0,y.listen)(e,c.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,y.listen)(e,l.default.CHANGE,this.handleLayerChange_,this)];e instanceof n&&t.push((0,y.listen)(e,"addlayer",this.handleLayerGroupAdd_,this),(0,y.listen)(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,d.getUid)(e)]=t}},{key:"handleLayerGroupAdd_",value:function(e){this.dispatchEvent(new S("addlayer",e.layer))}},{key:"handleLayerGroupRemove_",value:function(e){this.dispatchEvent(new S("removelayer",e.layer))}},{key:"handleLayersAdd_",value:function(e){e=e.element;this.registerLayerListeners_(e),this.dispatchEvent(new S("addlayer",e)),this.changed()}},{key:"handleLayersRemove_",value:function(e){var e=e.element,t=(0,d.getUid)(e);this.listenerKeys_[t].forEach(y.unlistenByKey),delete this.listenerKeys_[t],this.dispatchEvent(new S("removelayer",e)),this.changed()}},{key:"getLayers",value:function(){return this.get(j)}},{key:"setLayers",value:function(e){var t=this.getLayers();if(t)for(var r=t.getArray(),n=0,i=r.length;n<i;++n)this.dispatchEvent(new S("removelayer",r[n]));this.set(j,e)}},{key:"getLayersArray",value:function(t){return t=void 0!==t?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}},{key:"getLayerStatesArray",value:function(e){var t=void 0!==e?e:[],r=t.length,n=(this.getLayers().forEach(function(e){e.getLayerStatesArray(t)}),this.getLayerState()),i=n.zIndex;e||void 0!==n.zIndex||(i=0);for(var o=r,a=t.length;o<a;o++){var s=t[o];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),s.minZoom=Math.max(s.minZoom,n.minZoom),s.maxZoom=Math.min(s.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==s.extent?s.extent=(0,p.getIntersection)(s.extent,n.extent):s.extent=n.extent),void 0===s.zIndex&&(s.zIndex=i)}return t}},{key:"getSourceState",value:function(){return"ready"}}]),n}();r.default=e},{"../Collection.js":71,"../CollectionEventType.js":72,"../ObjectEventType.js":91,"../asserts.js":105,"../events.js":125,"../events/Event.js":126,"../events/EventType.js":127,"../extent.js":131,"../obj.js":269,"../util.js":379,"./Base.js":248}],254:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("./BaseVector.js")),o=u(e("../renderer/webgl/PointsLayer.js")),a=e("../math.js"),s=e("../dom.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p="blur",d="gradient",y="radius",g=["#00f","#0ff","#0f0","#ff0","#f00"],e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({},e),r=(delete t.gradient,delete t.radius,delete t.blur,delete t.weight,(t=n.call(this,t)).gradient_=null,t.addChangeListener(d,t.handleGradientChanged_),t.setGradient(e.gradient||g),t.setBlur(void 0!==e.blur?e.blur:15),t.setRadius(void 0!==e.radius?e.radius:8),e.weight||"weight");return t.weightFunction_="string"==typeof r?function(e){return e.get(r)}:r,t.setRenderOrder(null),t}return t=i,(e=[{key:"getBlur",value:function(){return this.get(p)}},{key:"getGradient",value:function(){return this.get(d)}},{key:"getRadius",value:function(){return this.get(y)}},{key:"handleGradientChanged_",value:function(){this.gradient_=function(e){for(var t=(0,s.createCanvasContext2D)(1,256),r=t.createLinearGradient(0,0,1,256),n=1/(e.length-1),i=0,o=e.length;i<o;++i)r.addColorStop(i*n,e[i]);return t.fillStyle=r,t.fillRect(0,0,1,256),t.canvas}(this.getGradient())}},{key:"setBlur",value:function(e){this.set(p,e)}},{key:"setGradient",value:function(e){this.set(d,e)}},{key:"setRadius",value:function(e){this.set(y,e)}},{key:"createRenderer",value:function(){return new o.default(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(e){e=this.weightFunction_(e);return void 0!==e?(0,a.clamp)(e,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(y)+this.get(p))}.bind(this),u_blurSlope:function(){return this.get(y)/Math.max(1,this.get(p))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n            uniform float u_opacity;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a * u_opacity;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this),u_opacity:function(){return this.getOpacity()}.bind(this)}}]})}},{key:"renderDeclutter",value:function(){}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../dom.js":123,"../math.js":267,"../renderer/webgl/PointsLayer.js":310,"./BaseVector.js":251}],255:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./BaseImage.js")),o=a(e("../renderer/canvas/ImageLayer.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){if(this instanceof i)return n.call(this,e);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"createRenderer",value:function(){return new o.default(this)}},{key:"getData",value:function(e){return u(f(i.prototype),"getData",this).call(this,e)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../renderer/canvas/ImageLayer.js":302,"./BaseImage.js":249}],256:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.inView=function(e,t){if(!e.visible)return!1;var r=t.resolution;if(r<e.minResolution||r>=e.maxResolution)return!1;r=t.zoom;return r>e.minZoom&&r<=e.maxZoom};var n=c(e("./Base.js")),o=c(e("../events/EventType.js")),a=c(e("./Property.js")),s=c(e("../render/EventType.js")),u=e("../asserts.js"),l=e("../events.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e){var t;if(this instanceof i)return delete(t=Object.assign({},e)).source,(t=n.call(this,t)).on,t.once,t.un,t.mapPrecomposeKey_=null,t.mapRenderKey_=null,t.sourceChangeKey_=null,t.renderer_=null,t.rendered=!1,e.render&&(t.render=e.render),e.map&&t.setMap(e.map),t.addChangeListener(a.default.SOURCE,t.handleSourcePropertyChange_),e=e.source||null,t.setSource(e),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getLayersArray",value:function(e){return(e=e||[]).push(this),e}},{key:"getLayerStatesArray",value:function(e){return(e=e||[]).push(this.getLayerState()),e}},{key:"getSource",value:function(){return this.get(a.default.SOURCE)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var e=this.getSource();return e?e.getState():"undefined"}},{key:"handleSourceChange_",value:function(){this.changed()}},{key:"handleSourcePropertyChange_",value:function(){this.sourceChangeKey_&&((0,l.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=(0,l.listen)(e,o.default.CHANGE,this.handleSourceChange_,this)),this.changed()}},{key:"getFeatures",value:function(e){return this.renderer_?this.renderer_.getFeatures(e):new Promise(function(e){return e([])})}},{key:"getData",value:function(e){return this.renderer_&&this.rendered?this.renderer_.getData(e):null}},{key:"render",value:function(e,t){var r=this.getRenderer();if(r.prepareFrame(e))return this.rendered=!0,r.renderFrame(e,t)}},{key:"unrender",value:function(){this.rendered=!1}},{key:"setMapInternal",value:function(e){e||this.unrender(),this.set(a.default.MAP,e)}},{key:"getMapInternal",value:function(){return this.get(a.default.MAP)}},{key:"setMap",value:function(e){this.mapPrecomposeKey_&&((0,l.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&((0,l.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=(0,l.listen)(e,s.default.PRECOMPOSE,function(e){var e=e.frameState.layerStatesArray,t=this.getLayerState(!1);(0,u.assert)(!e.some(function(e){return e.layer===t.layer}),67),e.push(t)},this),this.mapRenderKey_=(0,l.listen)(this,o.default.CHANGE,e.render,e),this.changed())}},{key:"setSource",value:function(e){this.set(a.default.SOURCE,e)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),h(y(i.prototype),"disposeInternal",this).call(this)}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../asserts.js":105,"../events.js":125,"../events/EventType.js":127,"../render/EventType.js":282,"./Base.js":248,"./Property.js":258}],257:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=c(e("../events/Event.js")),a=c(e("../events/EventType.js")),s=c(e("../format/MVT.js")),n=c(e("../layer/VectorTile.js")),u=c(e("../source/VectorTile.js")),l=e("ol-mapbox-style");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(){d(n,o["default"]);var r=g(n);function n(e){var t;return p(this,n),(t=r.call(this,a.default.ERROR)).error=e,t}return h(n)}(),e=function(){d(o,n["default"]);var i=g(o);function o(e){p(this,o);var t=!("declutter"in e)||e.declutter,r=new u.default({state:"loading",format:new s.default}),n=i.call(this,{source:r,background:e.background,declutter:t,className:e.className,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,minResolution:e.minResolution,maxResolution:e.maxResolution,minZoom:e.minZoom,maxZoom:e.maxZoom,renderOrder:e.renderOrder,renderBuffer:e.renderBuffer,renderMode:e.renderMode,map:e.map,updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting,preload:e.preload,useInterimTilesOnError:e.useInterimTilesOnError,properties:e.properties}),t=(e.accessToken&&(n.accessToken=e.accessToken),e.styleUrl);return(0,l.applyStyle)(m(n),t,e.layers||e.source,{accessToken:n.accessToken}).then(function(){r.setState("ready")}).catch(function(e){n.dispatchEvent(new b(e)),n.getSource().setState("error")}),void 0===n.getBackground()&&(0,l.applyBackground)(m(n),e.styleUrl,{accessToken:n.accessToken}),n}return h(o)}();r.default=e},{"../events/Event.js":126,"../events/EventType.js":127,"../format/MVT.js":148,"../layer/VectorTile.js":263,"../source/VectorTile.js":348,"ol-mapbox-style":69}],258:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"}},{}],259:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./BaseTile.js")),o=a(e("../renderer/canvas/TileLayer.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){if(this instanceof i)return n.call(this,e);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"createRenderer",value:function(){return new o.default(this)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../renderer/canvas/TileLayer.js":304,"./BaseTile.js":250}],260:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"}},{}],261:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./BaseVector.js")),o=a(e("../renderer/canvas/VectorLayer.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){if(this instanceof i)return n.call(this,e);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"createRenderer",value:function(){return new o.default(this)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../renderer/canvas/VectorLayer.js":306,"./BaseVector.js":251}],262:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./BaseVector.js")),o=a(e("../renderer/canvas/VectorImageLayer.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({},e);return delete t.imageRatio,(t=n.call(this,t)).imageRatio_=void 0!==e.imageRatio?e.imageRatio:1,t}return t=i,(e=[{key:"getImageRatio",value:function(){return this.imageRatio_}},{key:"createRenderer",value:function(){return new o.default(this)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../renderer/canvas/VectorImageLayer.js":305,"./BaseVector.js":251}],263:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("./BaseVector.js")),o=u(e("../renderer/canvas/VectorTileLayer.js")),a=u(e("./TileProperty.js")),s=e("../asserts.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=h(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({},e),r=(delete t.preload,delete t.useInterimTilesOnError,(t=n.call(this,t)).on,t.once,t.un,e.renderMode||"hybrid");return(0,s.assert)("hybrid"==r||"vector"==r,28),t.renderMode_=r,t.setPreload(e.preload||0),t.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),t.getBackground,t.setBackground,t}return t=i,(e=[{key:"createRenderer",value:function(){return new o.default(this)}},{key:"getFeatures",value:function(e){return c(p(i.prototype),"getFeatures",this).call(this,e)}},{key:"getRenderMode",value:function(){return this.renderMode_}},{key:"getPreload",value:function(){return this.get(a.default.PRELOAD)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(a.default.USE_INTERIM_TILES_ON_ERROR)}},{key:"setPreload",value:function(e){this.set(a.default.PRELOAD,e)}},{key:"setUseInterimTilesOnError",value:function(e){this.set(a.default.USE_INTERIM_TILES_ON_ERROR,e)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../asserts.js":105,"../renderer/canvas/VectorTileLayer.js":307,"./BaseVector.js":251,"./TileProperty.js":260}],264:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./Layer.js")),o=s(e("../renderer/webgl/PointsLayer.js")),a=e("../webgl/ShaderBuilder.js");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){var t;if(this instanceof i)return t=Object.assign({},e),(t=n.call(this,t)).parseResult_=(0,a.parseLiteralStyle)(e.style),t.styleVariables_=e.style.variables||{},t.hitDetectionDisabled_=!!e.disableHitDetection,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"createRenderer",value:function(){return new o.default(this,{vertexShader:this.parseResult_.builder.getSymbolVertexShader(),fragmentShader:this.parseResult_.builder.getSymbolFragmentShader(),hitVertexShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolVertexShader(!0),hitFragmentShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolFragmentShader(!0),uniforms:this.parseResult_.uniforms,attributes:this.parseResult_.attributes})}},{key:"updateStyleVariables",value:function(e){Object.assign(this.styleVariables_,e),this.changed()}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../renderer/webgl/PointsLayer.js":310,"../webgl/ShaderBuilder.js":388,"./Layer.js":256}],265:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./BaseTile.js")),s=i(e("../layer/Property.js")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("../renderer/webgl/TileLayer.js")),c=e("../style/expressions.js");function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function i(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(r,e){var t="\n    attribute vec2 ".concat(l.Attributes.TEXTURE_COORD,";\n    uniform mat4 ").concat(l.Uniforms.TILE_TRANSFORM,";\n    uniform float ").concat(l.Uniforms.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(l.Uniforms.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(l.Uniforms.TEXTURE_RESOLUTION,";\n    uniform float ").concat(l.Uniforms.TEXTURE_ORIGIN_X,";\n    uniform float ").concat(l.Uniforms.TEXTURE_ORIGIN_Y,";\n    uniform float ").concat(l.Uniforms.DEPTH,";\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ").concat(l.Attributes.TEXTURE_COORD,";\n      v_mapCoord = vec2(\n        ").concat(l.Uniforms.TEXTURE_ORIGIN_X," + ").concat(l.Uniforms.TEXTURE_RESOLUTION," * ").concat(l.Uniforms.TEXTURE_PIXEL_WIDTH," * v_textureCoord[0],\n        ").concat(l.Uniforms.TEXTURE_ORIGIN_Y," - ").concat(l.Uniforms.TEXTURE_RESOLUTION," * ").concat(l.Uniforms.TEXTURE_PIXEL_HEIGHT," * v_textureCoord[1]\n      );\n      gl_Position = ").concat(l.Uniforms.TILE_TRANSFORM," * vec4(").concat(l.Attributes.TEXTURE_COORD,", ").concat(l.Uniforms.DEPTH,", 1.0);\n    }\n  "),n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},i=[],o=(void 0!==r.color&&(u=(0,c.expressionToGlsl)(n,r.color,c.ValueTypes.COLOR),i.push("color = ".concat(u,";"))),void 0!==r.contrast&&(u=(0,c.expressionToGlsl)(n,r.contrast,c.ValueTypes.NUMBER),i.push("color.rgb = clamp((".concat(u," + 1.0) * color.rgb - (").concat(u," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))),void 0!==r.exposure&&(u=(0,c.expressionToGlsl)(n,r.exposure,c.ValueTypes.NUMBER),i.push("color.rgb = clamp((".concat(u," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))),void 0!==r.saturation&&(u=(0,c.expressionToGlsl)(n,r.saturation,c.ValueTypes.NUMBER),i.push("\n      float saturation = ".concat(u," + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    "))),void 0!==r.gamma&&(u=(0,c.expressionToGlsl)(n,r.gamma,c.ValueTypes.NUMBER),i.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(u,"));"))),void 0!==r.brightness&&(u=(0,c.expressionToGlsl)(n,r.brightness,c.ValueTypes.NUMBER),i.push("color.rgb = clamp(color.rgb + ".concat(u,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))),{}),a=n.variables.length;if(1<a&&!r.variables)throw new Error("Missing variables in style (expected ".concat(n.variables,")"));for(var s=0;s<a;++s)!function(e){var t=n.variables[e];if(!(t in r.variables))throw new Error("Missing '".concat(t,"' in style variables"));e=(0,c.uniformNameForVariable)(t);o[e]=function(){var e=r.variables[t];return void 0!==(e="string"==typeof e?(0,c.getStringNumberEquivalent)(n,e):e)?e:-9999999}}(s);var u=Object.keys(o).map(function(e){return"uniform float ".concat(e,";")}),e=Math.ceil(e/4),e=(u.push("uniform sampler2D ".concat(l.Uniforms.TILE_TEXTURE_ARRAY,"[").concat(e,"];")),n.paletteTextures&&u.push("uniform sampler2D ".concat(c.PALETTE_TEXTURE_ARRAY,"[").concat(n.paletteTextures.length,"];")),Object.keys(n.functions).map(function(e){return n.functions[e]}));return{vertexShader:t,fragmentShader:"\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ".concat(l.Uniforms.RENDER_EXTENT,";\n    uniform float ").concat(l.Uniforms.TRANSITION_ALPHA,";\n    uniform float ").concat(l.Uniforms.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(l.Uniforms.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(l.Uniforms.RESOLUTION,";\n    uniform float ").concat(l.Uniforms.ZOOM,";\n\n    ").concat(u.join("\n"),"\n\n    ").concat(e.join("\n"),"\n\n    void main() {\n      if (\n        v_mapCoord[0] < ").concat(l.Uniforms.RENDER_EXTENT,"[0] ||\n        v_mapCoord[1] < ").concat(l.Uniforms.RENDER_EXTENT,"[1] ||\n        v_mapCoord[0] > ").concat(l.Uniforms.RENDER_EXTENT,"[2] ||\n        v_mapCoord[1] > ").concat(l.Uniforms.RENDER_EXTENT,"[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(").concat(l.Uniforms.TILE_TEXTURE_ARRAY,"[0],  v_textureCoord);\n\n      ").concat(i.join("\n"),"\n\n      if (color.a == 0.0) {\n        discard;\n      }\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ").concat(l.Uniforms.TRANSITION_ALPHA,";\n    }"),uniforms:o,paletteTextures:n.paletteTextures}}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,i=p(o);function o(e){var t,r,n;if(this instanceof o)return r=(e=e?Object.assign({},e):{}).style||{},delete e.style,n=e.cacheSize,delete e.cacheSize,(t=i.call(this,e)).sources_=e.sources,t.renderedSource_=null,t.renderedResolution_=NaN,t.style_=r,t.cacheSize_=n,t.styleVariables_=t.style_.variables||{},t.addChangeListener(s.default.SOURCE,t.handleSourceUpdate_),t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"getSources",value:function(e,t){var r=this.getSource();return this.sources_?"function"==typeof this.sources_?this.sources_(e,t):this.sources_:r?[r]:[]}},{key:"getRenderSource",value:function(){return this.renderedSource_||this.getSource()}},{key:"getSourceState",value:function(){var e=this.getRenderSource();return e?e.getState():"undefined"}},{key:"handleSourceUpdate_",value:function(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}},{key:"getSourceBandCount_",value:function(){var e=Number.MAX_SAFE_INTEGER,e=this.getSources([-e,-e,e,e],e);return e&&e.length&&"bandCount"in e[0]?e[0].bandCount:4}},{key:"createRenderer",value:function(){var e=d(this.style_,this.getSourceBandCount_());return new l.default(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})}},{key:"renderSources",value:function(e,t){for(var r,n=this.getRenderer(),i=0,o=t.length;i<o;++i)this.renderedSource_=t[i],n.prepareFrame(e)&&(r=n.renderFrame(e));return r}},{key:"render",value:function(e,t){for(var r=this,n=(this.rendered=!0,e.viewState),i=this.getSources(e.extent,n.resolution),o=!0,a=0,s=i.length;a<s;++a)!function(e){var t=i[e],e=t.getState();"loading"==e&&t.addEventListener("change",function e(){"ready"==t.getState()&&(t.removeEventListener("change",e),r.changed())}),o=o&&"ready"==e}(a);var u=this.renderSources(e,i);if(this.getRenderer().renderComplete&&o)this.renderedResolution_=n.resolution;else if(this.renderedResolution_>.5*n.resolution){n=this.getSources(e.extent,this.renderedResolution_).filter(function(e){return!i.includes(e)});if(0<n.length)return this.renderSources(e,n)}return u}},{key:"setStyle",value:function(e){this.styleVariables_=e.variables||{},this.style_=e;e=d(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,paletteTextures:e.paletteTextures}),this.changed()}},{key:"updateStyleVariables",value:function(e){Object.assign(this.styleVariables_,e),this.changed()}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);e.prototype.dispose,r.default=e},{"../layer/Property.js":258,"../renderer/webgl/TileLayer.js":311,"../style/expressions.js":369,"./BaseTile.js":250}],266:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.all=function(e,t){return[[-1/0,-1/0,1/0,1/0]]},r.bbox=function(e,t){return[e]},r.tile=function(a){return function(e,t,r){var t=a.getZForResolution((0,s.fromUserResolution)(t,r)),n=a.getTileRangeForExtentAndZ((0,s.fromUserExtent)(e,r),t),i=[],o=[t,0,0];for(o[1]=n.minX;o[1]<=n.maxX;++o[1])for(o[2]=n.minY;o[2]<=n.maxY;++o[2])i.push((0,s.toUserExtent)(a.getTileCoordExtent(o),r));return i}};var s=e("./proj.js")},{"./proj.js":271}],267:[function(e,t,r){"use strict";function l(e,t,r,n){r-=e,e=n-t;return r*r+e*e}function n(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}Object.defineProperty(r,"__esModule",{value:!0}),r.ceil=function(e,t){return Math.ceil(n(e,t))},r.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},r.floor=function(e,t){return Math.floor(n(e,t))},r.lerp=function(e,t,r){return e+r*(t-e)},r.modulo=function(e,t){e%=t;return e*t<0?e+t:e},r.round=function(e,t){return Math.round(n(e,t))},r.solveLinearSystem=function(e){for(var t=e.length,r=0;r<t;r++){for(var n=r,i=Math.abs(e[r][r]),o=r+1;o<t;o++){var a=Math.abs(e[o][r]);i<a&&(i=a,n=o)}if(0===i)return null;var s=e[n];e[n]=e[r],e[r]=s;for(var u=r+1;u<t;u++)for(var l=-e[u][r]/e[r][r],c=r;c<t+1;c++)r==c?e[u][c]=0:e[u][c]+=l*e[r][c]}for(var f=new Array(t),h=t-1;0<=h;h--){f[h]=e[h][t]/e[h][h];for(var p=h-1;0<=p;p--)e[p][t]-=e[p][h]*f[h]}return f},r.squaredDistance=l,r.squaredSegmentDistance=function(e,t,r,n,i,o){var a=i-r,s=o-n;{var u;0==a&&0==s||(1<(u=((e-r)*a+(t-n)*s)/(a*a+s*s))?(r=i,n=o):0<u&&(r+=a*u,n+=s*u))}return l(e,t,r,n)},r.toDegrees=function(e){return 180*e/Math.PI},r.toFixed=n,r.toRadians=function(e){return e*Math.PI/180}},{}],268:[function(g,e,m){!function(y){!function(){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(m,"__esModule",{value:!0}),m.ResponseError=m.ClientError=void 0,m.getJSON=function(t){return new Promise(function(n,i){var e=new XMLHttpRequest;e.addEventListener("load",function(e){var t;if(!(e=e.target).status||200<=e.status&&e.status<300){try{t=JSON.parse(e.responseText)}catch(e){var r="Error parsing response text as JSON: "+e.message;return void i(new Error(r))}n(t)}else i(new p(e))}),e.addEventListener("error",function(e){i(new d(e.target))}),e.open("GET",t),e.setRequestHeader("Accept","application/json"),e.send()})},m.jsonp=function(e,t,r,n){var i=document.createElement("script"),o="olc_"+(0,u.getUid)(t);function a(){delete window[o],i.parentNode.removeChild(i)}i.async=!0,i.src=e+(e.includes("?")?"&":"?")+(n||"callback")+"="+o;var s=setTimeout(function(){a(),r&&r()},1e4);window[o]=function(e){clearTimeout(s),a(),t(e)},document.head.appendChild(i)},m.overrideXHR=function(e){"undefined"!=typeof XMLHttpRequest&&(r=XMLHttpRequest);y.XMLHttpRequest=e},m.resolveUrl=function(e,t){if(t.includes("://"))return t;return new URL(t,e).href},m.restoreXHR=function(){y.XMLHttpRequest=r};var u=g("./util.js");function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function e(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function a(r){var n=c();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){var r="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return l(e,arguments,h(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),f(t,e)})(e)}function l(e,t,r){return(l=c()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&f(t,r.prototype),t}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r,p=function(){t(n,s(Error));var r=a(n);function n(e){o(this,n);var t="Unexpected response status: "+e.status,t=r.call(this,t);return t.name="ResponseError",t.response=e,t}return e(n)}(),d=(m.ResponseError=p,function(){t(n,s(Error));var r=a(n);function n(e){var t;return o(this,n),(t=r.call(this,"Failed to issue request")).name="ClientError",t.client=e,t}return e(n)}());m.ClientError=d}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util.js":379}],269:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.clear=function(e){for(var t in e)delete e[t]},r.isEmpty=function(e){for(var t in e)return!1;return!t}},{}],270:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},{}],271:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"METERS_PER_UNIT",{enumerable:!0,get:function(){return s.METERS_PER_UNIT}}),Object.defineProperty(r,"Projection",{enumerable:!0,get:function(){return n.default}}),r.addCommon=T,r.addCoordinateTransforms=function(e,t,r,n){e=b(e),t=b(t);(0,u.add)(e,t,x(r)),(0,u.add)(t,e,x(n))},r.addEquivalentProjections=_,r.addEquivalentTransforms=w,r.addProjection=m,r.addProjections=v,r.clearAllProjections=function(){(0,a.clear)(),(0,u.clear)()},r.clearUserProjection=function(){k=null},r.cloneTransform=y,r.createProjection=function(e,t){return e?"string"==typeof e?b(e):e:b(t)},r.createSafeCoordinateTransform=function(i,o,a){return function(e){i.canWrapX()&&(r=i.getExtent(),n=(0,l.getWidth)(r),e=e.slice(0),(t=(0,f.getWorldsAway)(e,i,n))&&(e[0]=e[0]-t*n),e[0]=(0,c.clamp)(e[0],r[0],r[2]),e[1]=(0,c.clamp)(e[1],r[1],r[3]));var t,r,n=a(e);return t&&o.canWrapX()&&(n[0]+=t*(0,l.getWidth)(o.getExtent())),n}},r.createTransformFromCoordinateTransform=x,r.disableCoordinateWarning=d,r.equivalent=function(e,t){if(e===t)return!0;var r=e.getUnits()===t.getUnits();return(e.getCode()===t.getCode()||S(e,t)===y)&&r},r.fromLonLat=function(e,t){return d(),O(e,"EPSG:4326",void 0!==t?t:"EPSG:3857")},r.fromUserCoordinate=function(e,t){if(k)return O(e,k,t);p&&!(0,f.equals)(e,[0,0])&&-180<=e[0]&&e[0]<=180&&-90<=e[1]&&e[1]<=90&&(p=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates."));return e},r.fromUserExtent=function(e,t){return k?P(e,k,t):e},r.fromUserResolution=function(e,t){var r;return k&&(t=b(t).getUnits(),r=k.getUnits(),t)&&r?e*s.METERS_PER_UNIT[r]/s.METERS_PER_UNIT[t]:e},r.get=b,r.getPointResolution=function(e,t,r,n){var i,o=(e=b(e)).getPointResolutionFunc();{var a;o?(i=o(t,r),n&&n!==e.getUnits()&&(o=e.getMetersPerUnit())&&(i=i*o/s.METERS_PER_UNIT[n])):"degrees"==(o=e.getUnits())&&!n||"degrees"==n?i=t:(a=S(e,b("EPSG:4326")),i=a===g&&"degrees"!==o?t*e.getMetersPerUnit():(o=[r[0]-t/2,r[1],r[0]+t/2,r[1],r[0],r[1]-t/2,r[0],r[1]+t/2],o=a(o,o,2),r=(0,h.getDistance)(o.slice(0,2),o.slice(2,4)),t=(0,h.getDistance)(o.slice(4,6),o.slice(6,8)),(r+t)/2),void 0!==(a=n?s.METERS_PER_UNIT[n]:e.getMetersPerUnit())&&(i/=a))}return i},r.getTransform=j,r.getTransformFromProjections=S,r.getUserProjection=function(){return k},r.identityTransform=g,r.setUserProjection=E,r.toLonLat=function(e,t){e=O(e,void 0!==t?t:"EPSG:3857","EPSG:4326"),t=e[0];(t<-180||180<t)&&(e[0]=(0,c.modulo)(t+180,360)-180);return e},r.toUserCoordinate=function(e,t){return k?O(e,t,k):e},r.toUserExtent=function(e,t){return k?P(e,t,k):e},r.toUserResolution=function(e,t){var r;return k&&(t=b(t).getUnits(),r=k.getUnits(),t)&&r?e*s.METERS_PER_UNIT[t]/s.METERS_PER_UNIT[r]:e},r.transform=O,r.transformExtent=P,r.transformWithProjections=function(e,t,r){return S(t,r)(e)},r.useGeographic=function(){E("EPSG:4326")};var n=(r=e("./proj/Projection.js"))&&r.__esModule?r:{default:r},i=e("./proj/epsg3857.js"),o=e("./proj/epsg4326.js"),s=e("./proj/Units.js"),a=e("./proj/projections.js"),u=e("./proj/transforms.js"),l=e("./extent.js"),c=e("./math.js"),f=e("./coordinate.js"),h=e("./sphere.js");var p=!0;function d(e){p=!(void 0===e||e)}function y(e,t,r){if(void 0!==t)for(var n=0,i=e.length;n<i;++n)t[n]=e[n];else t=e.slice();return t}function g(e,t,r){if(void 0!==t&&e!==t){for(var n=0,i=e.length;n<i;++n)t[n]=e[n];e=t}return e}function m(e){(0,a.add)(e.getCode(),e),(0,u.add)(e,e,y)}function v(e){e.forEach(m)}function b(e){return"string"==typeof e?(0,a.get)(e):e||null}function _(e){v(e),e.forEach(function(t){e.forEach(function(e){t!==e&&(0,u.add)(t,e,y)})})}function w(e,r,n,i){e.forEach(function(t){r.forEach(function(e){(0,u.add)(t,e,n),(0,u.add)(e,t,i)})})}function x(l){return function(e,t,r){var n=e.length;r=void 0!==r?r:2,t=void 0!==t?t:new Array(n);for(var i=0;i<n;i+=r)for(var o=l(e.slice(i,i+r)),a=o.length,s=0,u=r;s<u;++s)t[i+s]=a<=s?e[i+s]:o[s];return t}}function S(e,t){e=e.getCode(),t=t.getCode();return(0,u.get)(e,t)||g}function j(e,t){return S(b(e),b(t))}function O(e,t,r){return j(t,r)(e,void 0,e.length)}function P(e,t,r,n){t=j(t,r);return(0,l.applyTransform)(e,t,void 0,n)}var k=null;function E(e){k=b(e)}function T(){_(i.PROJECTIONS),_(o.PROJECTIONS),w(o.PROJECTIONS,i.PROJECTIONS,i.fromEPSG4326,i.toEPSG4326)}T()},{"./coordinate.js":121,"./extent.js":131,"./math.js":267,"./proj/Projection.js":272,"./proj/Units.js":273,"./proj/epsg3857.js":274,"./proj/epsg4326.js":275,"./proj/projections.js":277,"./proj/transforms.js":278,"./sphere.js":353}],272:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("./Units.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}e=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}var e,r,n;return e=t,(r=[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||i.METERS_PER_UNIT[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(e){this.global_=e,this.canWrapX_=!(!e||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(e){this.defaultTileGrid_=e}},{key:"setExtent",value:function(e){this.extent_=e,this.canWrapX_=!(!this.global_||!e)}},{key:"setWorldExtent",value:function(e){this.worldExtent_=e}},{key:"setGetPointResolution",value:function(e){this.getPointResolutionFunc_=e}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=e},{"./Units.js":273}],273:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.METERS_PER_UNIT=void 0,r.fromCode=function(e){return n[e]};var n={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};var i={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};r.METERS_PER_UNIT=i},{}],274:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.WORLD_EXTENT=r.RADIUS=r.PROJECTIONS=r.MAX_SAFE_Y=r.HALF_SIZE=r.EXTENT=void 0,r.fromEPSG4326=function(e,t,r){var n=e.length;r=1<r?r:2,void 0===t&&(t=2<r?e.slice():new Array(n));for(var i=0;i<n;i+=r){t[i]=c*e[i]/180;var o=l*Math.log(Math.tan(Math.PI*(+e[i+1]+90)/360));p<o?o=p:o<-p&&(o=-p),t[i+1]=o}return t},r.toEPSG4326=function(e,t,r){var n=e.length;r=1<r?r:2,void 0===t&&(t=2<r?e.slice():new Array(n));for(var i=0;i<n;i+=r)t[i]=180*e[i]/c,t[i+1]=360*Math.atan(Math.exp(e[i+1]/l))/Math.PI-90;return t};e=(e=e("./Projection.js"))&&e.__esModule?e:{default:e};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=6378137,c=(r.RADIUS=l,Math.PI*l),f=[-(r.HALF_SIZE=c),-c,c,c],h=(r.EXTENT=f,[-180,-85,180,85]),p=(r.WORLD_EXTENT=h,l*Math.log(Math.tan(Math.PI/2))),e=(r.MAX_SAFE_Y=p,function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){if(this instanceof o)return i.call(this,{code:e,units:"m",extent:f,global:!0,worldExtent:h,getPointResolution:function(e,t){return e/Math.cosh(t[1]/l)}});throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e.default)),e=[new e("EPSG:3857"),new e("EPSG:102100"),new e("EPSG:102113"),new e("EPSG:900913"),new e("http://www.opengis.net/def/crs/EPSG/0/3857"),new e("http://www.opengis.net/gml/srs/epsg.xml#3857")];r.PROJECTIONS=e},{"./Projection.js":272}],275:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.RADIUS=r.PROJECTIONS=r.METERS_PER_UNIT=r.EXTENT=void 0;e=(e=e("./Projection.js"))&&e.__esModule?e:{default:e};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.RADIUS=6378137;var l=[-180,-90,180,90],c=(r.EXTENT=l,6378137*Math.PI/180),e=(r.METERS_PER_UNIT=c,function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t){if(this instanceof o)return i.call(this,{code:e,units:"degrees",extent:l,axisOrientation:t,global:!0,metersPerUnit:c,worldExtent:l});throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e.default)),e=[new e("CRS:84"),new e("EPSG:4326","neu"),new e("urn:ogc:def:crs:OGC:1.3:CRS84"),new e("urn:ogc:def:crs:OGC:2:84"),new e("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new e("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new e("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];r.PROJECTIONS=e},{"./Projection.js":272}],276:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.register=function(e){var t,r,n=Object.keys(e.defs),i=n.length;for(t=0;t<i;++t){var o,a,s=n[t];(0,p.get)(s)||(o=e.defs(s),(a=o.units)||"longlat"!==o.projName||(a="degrees"),(0,p.addProjection)(new h.default({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a})))}for(t=0;t<i;++t){var u=n[t],l=(0,p.get)(u);for(r=0;r<i;++r){var c=n[r],f=(0,p.get)(c);(0,d.get)(u,c)||(e.defs[u]===e.defs[c]?(0,p.addEquivalentProjections)([l,f]):(c=e(u,c),(0,p.addCoordinateTransforms)(l,f,(0,p.createSafeCoordinateTransform)(l,f,c.forward),(0,p.createSafeCoordinateTransform)(f,l,c.inverse))))}}};var h=(r=e("./Projection.js"))&&r.__esModule?r:{default:r},p=e("../proj.js"),d=e("./transforms.js")},{"../proj.js":271,"./Projection.js":272,"./transforms.js":278}],277:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.add=function(e,t){n[e]=t},r.clear=function(){n={}},r.get=function(e){return n[e]||n[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null};var n={}},{}],278:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.add=function(e,t,r){e=e.getCode(),t=t.getCode();e in i||(i[e]={});i[e][t]=r},r.clear=function(){i={}},r.get=function(e,t){var r;e in i&&t in i[e]&&(r=i[e][t]);return r},r.remove=function(e,t){var e=e.getCode(),t=t.getCode(),r=i[e][t];delete i[e][t],(0,n.isEmpty)(i[e])&&delete i[e];return r};var n=e("../obj.js"),i={}},{"../obj.js":269}],279:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getRenderPixel=function(e,t){return(0,u.apply)(e.inversePixelTransform,t.slice(0))},r.getVectorContext=function(e){if(!(e.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");var t,r=e.inversePixelTransform[0],n=e.frameState,i=(0,u.multiply)(e.inversePixelTransform.slice(),n.coordinateToPixelTransform),o=(0,l.getSquaredTolerance)(n.viewState.resolution,r),a=(0,c.getUserProjection)();a&&(t=(0,c.getTransformFromProjections)(a,n.viewState.projection));return new s.default(e.context,r,n.extent,i,n.viewState.rotation,o,t)},r.toContext=function(e,t){var r=e.canvas,n=(t=t||{}).pixelRatio||i.DEVICE_PIXEL_RATIO,t=t.size;t&&(r.width=t[0]*n,r.height=t[1]*n,r.style.width=t[0]+"px",r.style.height=t[1]+"px");t=[0,0,r.width,r.height],r=(0,u.scale)((0,u.create)(),n,n);return new s.default(e,n,t,r,0)};var s=(r=e("./render/canvas/Immediate.js"))&&r.__esModule?r:{default:r},i=e("./has.js"),u=e("./transform.js"),l=e("./renderer/vector.js"),c=e("./proj.js")},{"./has.js":221,"./proj.js":271,"./render/canvas/Immediate.js":291,"./renderer/vector.js":308,"./transform.js":377}],280:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("../Disposable.js")),o=a(e("../geom/Polygon.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).geometry_=null,t.element_=document.createElement("div"),t.element_.style.position="absolute",t.element_.style.pointerEvents="auto",t.element_.className="ol-box "+e,t.map_=null,t.startPixel_=null,t.endPixel_=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var e=this.startPixel_,t=this.endPixel_,r=this.element_.style;r.left=Math.min(e[0],t[0])+"px",r.top=Math.min(e[1],t[1])+"px",r.width=Math.abs(t[0]-e[0])+"px",r.height=Math.abs(t[1]-e[1])+"px"}},{key:"setMap",value:function(e){var t;this.map_&&(this.map_.getOverlayContainer().removeChild(this.element_),(t=this.element_.style).left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"),this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){var e=this.startPixel_,t=this.endPixel_,t=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);t[4]=t[0].slice(),this.geometry_?this.geometry_.setCoordinates([t]):this.geometry_=new o.default([t])}},{key:"getGeometry",value:function(){return this.geometry_}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Disposable.js":74,"../geom/Polygon.js":200}],281:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e,t,r,n){if(this instanceof o)return(e=i.call(this,e)).inversePixelTransform=t,e.frameState=r,e.context=n,e;throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(((e=e("../events/Event.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"../events/Event.js":126}],282:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"}},{}],283:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.toFeature=function(e,t){var r=e.getId(),n=v(e),e=e.getProperties(),i=new o.default;void 0!==t&&i.setGeometryName(t);i.setGeometry(n),void 0!==r&&i.setId(r);return i.setProperties(e,!0),i},r.toGeometry=v;var o=(m=e("../Feature.js"))&&m.__esModule?m:{default:m},a=e("../geom.js"),n=e("../transform.js"),i=e("../extent.js"),s=e("../array.js"),u=e("../geom/flat/interiorpoint.js"),l=e("../proj.js"),c=e("../geom/flat/orient.js"),f=e("../geom/flat/interpolate.js"),h=e("../geom/flat/center.js"),p=e("../geom/flat/transform.js");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===d(e)?e:String(e)}(n.key),n)}}var g=(0,n.create)(),m=function(){function o(e,t,r,n,i){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.styleFunction,this.extent_,this.id_=i,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r,this.properties_=n}var e,t,r;return e=o,(t=[{key:"get",value:function(e){return this.properties_[e]}},{key:"getExtent",value:function(){return this.extent_||(this.extent_="Point"===this.type_?(0,i.createOrUpdateFromCoordinate)(this.flatCoordinates_):(0,i.createOrUpdateFromFlatCoordinates)(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}},{key:"getFlatInteriorPoint",value:function(){var e;return this.flatInteriorPoints_||(e=(0,i.getCenter)(this.getExtent()),this.flatInteriorPoints_=(0,u.getInteriorPointOfArray)(this.flatCoordinates_,0,this.ends_,2,e,0)),this.flatInteriorPoints_}},{key:"getFlatInteriorPoints",value:function(){var e;return this.flatInteriorPoints_||(e=(0,h.linearRingss)(this.flatCoordinates_,0,this.ends_,2),this.flatInteriorPoints_=(0,u.getInteriorPointsOfMultiArray)(this.flatCoordinates_,0,this.ends_,2,e)),this.flatInteriorPoints_}},{key:"getFlatMidpoint",value:function(){return this.flatMidpoints_||(this.flatMidpoints_=(0,f.interpolatePoint)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}},{key:"getFlatMidpoints",value:function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var e=this.flatCoordinates_,t=0,r=this.ends_,n=0,i=r.length;n<i;++n){var o=r[n],a=(0,f.interpolatePoint)(e,t,o,2,.5);(0,s.extend)(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}},{key:"getId",value:function(){return this.id_}},{key:"getOrientedFlatCoordinates",value:function(){return this.flatCoordinates_}},{key:"getGeometry",value:function(){return this}},{key:"getSimplifiedGeometry",value:function(e){return this}},{key:"simplifyTransformed",value:function(e,t){return this}},{key:"getProperties",value:function(){return this.properties_}},{key:"getStride",value:function(){return 2}},{key:"getStyleFunction",value:function(){return this.styleFunction}},{key:"getType",value:function(){return this.type_}},{key:"transform",value:function(e){var t=(e=(0,l.get)(e)).getExtent(),e=e.getWorldExtent();t&&e&&(t=(0,i.getHeight)(e)/(0,i.getHeight)(t),(0,n.compose)(g,e[0],e[3],t,-t,0,0,0),(0,p.transform2D)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,g,this.flatCoordinates_))}},{key:"getEnds",value:function(){return this.ends_}}])&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();function v(e){var t=e.getType();switch(t){case"Point":return new a.Point(e.getFlatCoordinates());case"MultiPoint":return new a.MultiPoint(e.getFlatCoordinates(),"XY");case"LineString":return new a.LineString(e.getFlatCoordinates(),"XY");case"MultiLineString":return new a.MultiLineString(e.getFlatCoordinates(),"XY",e.getEnds());case"Polygon":var r=e.getFlatCoordinates(),n=e.getEnds(),i=(0,c.inflateEnds)(r,n);return 1<i.length?new a.MultiPolygon(r,"XY",i):new a.Polygon(r,"XY",n);default:throw new Error("Invalid geometry type:"+t)}}m.prototype.getEndss=m.prototype.getEnds,m.prototype.getFlatCoordinates=m.prototype.getOrientedFlatCoordinates,r.default=m},{"../Feature.js":75,"../array.js":104,"../extent.js":131,"../geom.js":190,"../geom/flat/center.js":203,"../geom/flat/interiorpoint.js":210,"../geom/flat/interpolate.js":211,"../geom/flat/orient.js":214,"../geom/flat/transform.js":220,"../proj.js":271,"../transform.js":377}],284:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,(r=[{key:"drawCustom",value:function(e,t,r,n){}},{key:"drawGeometry",value:function(e){}},{key:"setStyle",value:function(e){}},{key:"drawCircle",value:function(e,t){}},{key:"drawFeature",value:function(e,t){}},{key:"drawGeometryCollection",value:function(e,t){}},{key:"drawLineString",value:function(e,t){}},{key:"drawMultiLineString",value:function(e,t){}},{key:"drawMultiPoint",value:function(e,t){}},{key:"drawMultiPolygon",value:function(e,t){}},{key:"drawPoint",value:function(e,t){}},{key:"drawPolygon",value:function(e,t){}},{key:"drawText",value:function(e,t){}},{key:"setFillStrokeStyle",value:function(e,t){}},{key:"setImageStyle",value:function(e,t){}},{key:"setTextStyle",value:function(e,t){}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=n},{}],285:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultTextBaseline=r.defaultTextAlign=r.defaultStrokeStyle=r.defaultPadding=r.defaultMiterLimit=r.defaultLineWidth=r.defaultLineJoin=r.defaultLineDashOffset=r.defaultLineDash=r.defaultLineCap=r.defaultFont=r.defaultFillStyle=r.checkedFonts=void 0,r.drawImageOrLabel=function(e,t,r,n,i,o,a,s,u,l,c){e.save(),1!==r&&(e.globalAlpha*=r);t&&e.setTransform.apply(e,t);n.contextInstructions?(e.translate(u,l),e.scale(c[0],c[1]),function(e,t){for(var r=e.contextInstructions,n=0,i=r.length;n<i;n+=2)Array.isArray(r[n+1])?t[r[n]].apply(t,r[n+1]):t[r[n]]=r[n+1]}(n,e)):c[0]<0||c[1]<0?(e.translate(u,l),e.scale(c[0],c[1]),e.drawImage(n,i,o,a,s,0,0,a,s)):e.drawImage(n,i,o,a,s,u,l,a*c[0],s*c[1]);e.restore()},r.getTextDimensions=function(e,t){for(var r=[],n=[],i=[],o=0,a=0,s=0,u=0,l=0,c=t.length;l<=c;l+=2){var f,h=t[l];"\n"===h||l===c?(o=Math.max(o,a),i.push(a),a=0,s+=u):(f=t[l+1]||e.font,h=S(f,h),h=(r.push(h),a+=h,w(f)),n.push(h),u=Math.max(u,h))}return{width:o,height:s,widths:r,heights:n,lineWidths:i}},r.measureAndCacheTextWidth=function(r,e,t){if(e in t)return t[e];var n=e.split("\n").reduce(function(e,t){return Math.max(e,S(r,t))},0);return t[e]=n},r.measureTextHeight=void 0,r.measureTextWidth=S,r.registerFont=void 0,r.rotateAtOffset=function(e,t,r,n){0!==t&&(e.translate(r,n),e.rotate(t),e.translate(-r,-n))},r.textHeights=void 0;var n=(n=e("../Object.js"))&&n.__esModule?n:{default:n},i=e("../has.js"),o=e("../obj.js"),a=e("../dom.js"),s=e("../css.js");r.defaultFont="10px sans-serif",r.defaultFillStyle="#000",r.defaultLineCap="round",r.defaultLineDash=[],r.defaultLineDashOffset=0,r.defaultLineJoin="round",r.defaultMiterLimit=10,r.defaultStrokeStyle="#000",r.defaultTextAlign="center",r.defaultTextBaseline="middle",r.defaultPadding=[0,0,0,0];function u(e){var t=(0,s.getFontParameters)(e);if(t)for(var r=t.families,n=0,i=r.length;n<i;++n){var o=r[n],a=t.style+"\n"+t.weight+"\n"+o;void 0===y.get(a)&&(y.set(a,100,!0),v(t.style,t.weight,o)||(y.set(a,0,!0),void 0===c&&(c=setInterval(b,32))))}}r.defaultLineWidth=1;var l,c,f,h,p,d,y=new n.default,g=(r.checkedFonts=y,null),m={};r.textHeights=m,p=(h=["monospace","serif"]).length,d="wmytzilWMYTZIL@#/&?$%10";function v(e,t,r){for(var n=!0,i=0;i<p;++i){var o=h[i];f=S(e+" "+t+" 32px "+o,d),r!=o&&(o=S(e+" "+t+" 32px "+r+","+o,d),n=n&&o!=f)}return!!n}function b(){for(var e=!0,t=y.getKeys(),r=0,n=t.length;r<n;++r){var i=t[r];y.get(i)<100&&(v.apply(this,i.split("\n"))?((0,o.clear)(m),g=null,l=void 0,y.set(i,100)):(y.set(i,y.get(i)+1,!0),e=!1))}e&&(clearInterval(c),c=void 0)}r.registerFont=u;var _,w=function(e){var t,r,n=m[e];return null==n&&(i.WORKER_OFFSCREEN_CANVAS?(t=(0,s.getFontParameters)(e),r=x(e,"Žg"),n=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)):(_||((_=document.createElement("div")).innerHTML="M",_.style.minHeight="0",_.style.maxHeight="none",_.style.height="auto",_.style.padding="0",_.style.border="none",_.style.position="absolute",_.style.display="block",_.style.left="-99999px"),_.style.font=e,document.body.appendChild(_),n=_.offsetHeight,document.body.removeChild(_)),m[e]=n),n};function x(e,t){return g=g||(0,a.createCanvasContext2D)(1,1),e!=l&&(g.font=e,l=g.font),g.measureText(t)}function S(e,t){return x(e,t).width}r.measureTextHeight=w},{"../Object.js":90,"../css.js":122,"../dom.js":123,"../has.js":221,"../obj.js":269}],286:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var g=o(e("./Instruction.js")),m=o(e("../../extent/Relationship.js")),n=o(e("../VectorContext.js")),s=e("../../colorlike.js"),v=e("../../extent.js"),u=e("../canvas.js"),l=e("../../array.js"),b=e("../../geom/flat/inflate.js");function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r),t=(e=n?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,o=h(a);function a(e,t,r,n){var i;if(this instanceof a)return(i=o.call(this)).tolerance=e,i.maxExtent=t,i.pixelRatio=n,i.maxLineWidth=0,i.resolution=r,i.beginGeometryInstruction1_=null,i.beginGeometryInstruction2_=null,i.bufferedMaxExtent_=null,i.instructions=[],i.coordinates=[],i.tmpCoordinate_=[],i.hitDetectionInstructions=[],i.state={},i;throw new TypeError("Cannot call a class as a function")}return t=a,(e=[{key:"applyPixelRatio",value:function(e){var t=this.pixelRatio;return 1==t?e:e.map(function(e){return e*t})}},{key:"appendFlatPointCoordinates",value:function(e,t){for(var r=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,i=this.coordinates,o=i.length,a=0,s=e.length;a<s;a+=t)n[0]=e[a],n[1]=e[a+1],(0,v.containsCoordinate)(r,n)&&(i[o++]=n[0],i[o++]=n[1]);return o}},{key:"appendFlatLineCoordinates",value:function(e,t,r,n,i,o){for(var a,s,u=this.coordinates,l=u.length,c=this.getBufferedMaxExtent(),f=(o&&(t+=n),e[t]),h=e[t+1],p=this.tmpCoordinate_,d=!0,y=t+n;y<r;y+=n)p[0]=e[y],p[1]=e[y+1],(s=(0,v.coordinateRelationship)(c,p))!==a?(d&&(u[l++]=f,u[l++]=h,d=!1),u[l++]=p[0],u[l++]=p[1]):d=s!==m.default.INTERSECTING||(u[l++]=p[0],u[l++]=p[1],!1),f=p[0],h=p[1],a=s;return(i&&d||y===t+n)&&(u[l++]=f,u[l++]=h),l}},{key:"drawCustomCoordinates_",value:function(e,t,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o],u=this.appendFlatLineCoordinates(e,t,s,n,!1,!1);i.push(u),t=s}return t}},{key:"drawCustom",value:function(e,t,r,n){this.beginGeometry(e,t);var i,o,a=e.getType(),s=e.getStride(),u=this.coordinates.length;switch(a){case"MultiPolygon":for(var l=e.getOrientedFlatCoordinates(),c=[],f=e.getEndss(),h=y=0,p=f.length;h<p;++h){var d=[],y=this.drawCustomCoordinates_(l,y,f[h],s,d);c.push(d)}this.instructions.push([g.default.CUSTOM,u,c,e,r,b.inflateMultiCoordinatesArray]),this.hitDetectionInstructions.push([g.default.CUSTOM,u,c,e,n||r,b.inflateMultiCoordinatesArray]);break;case"Polygon":case"MultiLineString":o=[],l="Polygon"==a?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(l,0,e.getEnds(),s,o),this.instructions.push([g.default.CUSTOM,u,o,e,r,b.inflateCoordinatesArray]),this.hitDetectionInstructions.push([g.default.CUSTOM,u,o,e,n||r,b.inflateCoordinatesArray]);break;case"LineString":case"Circle":l=e.getFlatCoordinates(),i=this.appendFlatLineCoordinates(l,0,l.length,s,!1,!1),this.instructions.push([g.default.CUSTOM,u,i,e,r,b.inflateCoordinates]),this.hitDetectionInstructions.push([g.default.CUSTOM,u,i,e,n||r,b.inflateCoordinates]);break;case"MultiPoint":l=e.getFlatCoordinates(),u<(i=this.appendFlatPointCoordinates(l,s))&&(this.instructions.push([g.default.CUSTOM,u,i,e,r,b.inflateCoordinates]),this.hitDetectionInstructions.push([g.default.CUSTOM,u,i,e,n||r,b.inflateCoordinates]));break;case"Point":l=e.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),i=this.coordinates.length,this.instructions.push([g.default.CUSTOM,u,i,e,r]),this.hitDetectionInstructions.push([g.default.CUSTOM,u,i,e,n||r])}this.endGeometry(t)}},{key:"beginGeometry",value:function(e,t){this.beginGeometryInstruction1_=[g.default.BEGIN_GEOMETRY,t,0,e],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[g.default.BEGIN_GEOMETRY,t,0,e],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){for(var e,t,r=this.hitDetectionInstructions,n=(r.reverse(),r.length),i=-1,o=0;o<n;++o)(t=(e=r[o])[0])==g.default.END_GEOMETRY?i=o:t==g.default.BEGIN_GEOMETRY&&(e[2]=o,(0,l.reverseSubArray)(this.hitDetectionInstructions,i,o),i=-1)}},{key:"setFillStrokeStyle",value:function(e,t){var r=this.state;e?(e=e.getColor(),r.fillStyle=(0,s.asColorLike)(e||u.defaultFillStyle)):r.fillStyle=void 0,t?(e=t.getColor(),r.strokeStyle=(0,s.asColorLike)(e||u.defaultStrokeStyle),e=t.getLineCap(),r.lineCap=void 0!==e?e:u.defaultLineCap,e=t.getLineDash(),r.lineDash=e?e.slice():u.defaultLineDash,e=t.getLineDashOffset(),r.lineDashOffset=e||u.defaultLineDashOffset,e=t.getLineJoin(),r.lineJoin=void 0!==e?e:u.defaultLineJoin,e=t.getWidth(),r.lineWidth=void 0!==e?e:u.defaultLineWidth,e=t.getMiterLimit(),r.miterLimit=void 0!==e?e:u.defaultMiterLimit,r.lineWidth>this.maxLineWidth&&(this.maxLineWidth=r.lineWidth,this.bufferedMaxExtent_=null)):(r.strokeStyle=void 0,r.lineCap=void 0,r.lineDash=null,r.lineDashOffset=void 0,r.lineJoin=void 0,r.lineWidth=void 0,r.miterLimit=void 0)}},{key:"createFill",value:function(e){var e=e.fillStyle,t=[g.default.SET_FILL_STYLE,e];return"string"!=typeof e&&t.push(!0),t}},{key:"applyStroke",value:function(e){this.instructions.push(this.createStroke(e))}},{key:"createStroke",value:function(e){return[g.default.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(e,t){var r=e.fillStyle;"string"==typeof r&&e.currentFillStyle==r||(void 0!==r&&this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}},{key:"updateStrokeStyle",value:function(e,t){var r=e.strokeStyle,n=e.lineCap,i=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,s=e.lineWidth,u=e.miterLimit;e.currentStrokeStyle==r&&e.currentLineCap==n&&(i==e.currentLineDash||(0,l.equals)(e.currentLineDash,i))&&e.currentLineDashOffset==o&&e.currentLineJoin==a&&e.currentLineWidth==s&&e.currentMiterLimit==u||(void 0!==r&&t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=n,e.currentLineDash=i,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=s,e.currentMiterLimit=u)}},{key:"endGeometry",value:function(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;e=[g.default.END_GEOMETRY,e];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){var e;return this.bufferedMaxExtent_||(this.bufferedMaxExtent_=(0,v.clone)(this.maxExtent),0<this.maxLineWidth&&(e=this.resolution*(this.maxLineWidth+1)/2,(0,v.buffer)(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_))),this.bufferedMaxExtent_}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.default);r.default=e},{"../../array.js":104,"../../colorlike.js":108,"../../extent.js":131,"../../extent/Relationship.js":132,"../../geom/flat/inflate.js":209,"../VectorContext.js":284,"../canvas.js":285,"./Instruction.js":292}],287:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./Builder.js")),i=s(e("./ImageBuilder.js")),o=s(e("./LineStringBuilder.js")),a=s(e("./PolygonBuilder.js")),e=s(e("./TextBuilder.js"));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===u(e)?e:String(e)}(n.key),n)}}var c={Circle:a.default,Default:n.default,Image:i.default,LineString:o.default,Polygon:a.default,Text:e.default},n=function(){function i(e,t,r,n){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=n,this.resolution_=r,this.buildersByZIndex_={}}var e,t,r;return e=i,(t=[{key:"finish",value:function(){var e,t={};for(e in this.buildersByZIndex_){t[e]=t[e]||{};var r,n=this.buildersByZIndex_[e];for(r in n){var i=n[r].finish();t[e][r]=i}}return t}},{key:"getBuilder",value:function(e,t){var e=void 0!==e?e.toString():"0",r=this.buildersByZIndex_[e],e=(void 0===r&&(this.buildersByZIndex_[e]=r={}),r[t]);return void 0===e&&(e=new c[t](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=e),e}}])&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();r.default=n},{"./Builder.js":286,"./ImageBuilder.js":290,"./LineStringBuilder.js":293,"./PolygonBuilder.js":294,"./TextBuilder.js":295}],288:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var Me=(a=e("./Instruction.js"))&&a.__esModule?a:{default:a},Ie=e("./TextBuilder.js"),Ae=e("../../transform.js"),Le=e("../../extent.js"),De=e("../canvas.js"),Fe=e("../../geom/flat/textpath.js"),Ne=e("../../array.js"),Be=e("../../geom/flat/length.js"),Ge=e("../../geom/flat/transform.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}var v=(0,Le.createEmpty)(),b=[],_=[],w=[],x=[];function Ue(e){return e[3].declutterBox}var o=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function C(e,t){return"start"!==t&&"end"!==t||o.test(e)||(t="start"===t?"left":"right"),Ie.TEXT_ALIGN[t]}function R(e,t,r){return 0<r&&e.push("\n",""),e.push(t,""),e}var a=function(){function i(e,t,r,n){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,Ae.create)(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}var e,t,r;return e=i,(t=[{key:"createLabel",value:function(e,t,r,n){var i=e+t+r+n;if(this.labels_[i])return this.labels_[i];for(var o,a=n?this.strokeStates[n]:null,s=r?this.fillStates[r]:null,u=this.textStates[t],t=this.pixelRatio,t=[u.scale[0]*t,u.scale[1]*t],l=Array.isArray(e),c=u.justify?Ie.TEXT_ALIGN[u.justify]:C(Array.isArray(e)?e[0]:e,u.textAlign||De.defaultTextAlign),f=n&&a.lineWidth?a.lineWidth:0,h=l?e:e.split("\n").reduce(R,[]),l=(0,De.getTextDimensions)(u,h),e=l.width,p=l.height,d=l.widths,y=l.heights,g=l.lineWidths,m=e+f,l=[],e=(m+2)*t[0],p=(p+f)*t[1],e={width:e<0?Math.floor(e):Math.ceil(e),height:p<0?Math.floor(p):Math.ceil(p),contextInstructions:l},v=(1==t[0]&&1==t[1]||l.push("scale",t),n&&(l.push("strokeStyle",a.strokeStyle),l.push("lineWidth",f),l.push("lineCap",a.lineCap),l.push("lineJoin",a.lineJoin),l.push("miterLimit",a.miterLimit),l.push("setLineDash",[a.lineDash]),l.push("lineDashOffset",a.lineDashOffset)),r&&l.push("fillStyle",s.fillStyle),l.push("textBaseline","middle"),l.push("textAlign","center"),.5-c),b=c*m+v*f,_=[],w=[],x=0,S=0,j=0,O=0,P=0,k=h.length;P<k;P+=2){var E,T=h[P];"\n"===T?(S+=x,x=0,b=c*m+v*f,++O):(E=((E=h[P+1]||u.font)!==o&&(n&&_.push("font",E),r&&w.push("font",E),o=E),x=Math.max(x,y[j]),[T,b+v*d[j]+c*(d[j]-g[O]),.5*(f+x)+S]),b+=d[j],n&&_.push("strokeText",E),r&&w.push("fillText",E),++j)}return Array.prototype.push.apply(l,_),Array.prototype.push.apply(l,w),this.labels_[i]=e}},{key:"replayTextBackground_",value:function(e,t,r,n,i,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,n),e.lineTo.apply(e,i),e.lineTo.apply(e,t),o&&(this.alignFill_=o[2],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(e,t,r,n,i,o,a,s,u,l,c,f,h,p,d,y){var g,a=r-(a*=f[0]),s=n-(s*=f[1]),e=e<i+u?e-u:i,i=t<o+l?t-l:o,t=p[3]+e*f[0]+p[1],o=p[0]+i*f[1]+p[2],m=a-p[3],p=s-p[0];return!d&&0===c||(x[0]=b[0]=m,_[1]=b[1]=p,_[0]=m+t,w[0]=_[0],w[1]=p+o,x[1]=w[1]),0!==c?(g=(0,Ae.compose)((0,Ae.create)(),r,n,1,1,c,-r,-n),(0,Ae.apply)(g,b),(0,Ae.apply)(g,_),(0,Ae.apply)(g,w),(0,Ae.apply)(g,x),(0,Le.createOrUpdate)(Math.min(b[0],_[0],w[0],x[0]),Math.min(b[1],_[1],w[1],x[1]),Math.max(b[0],_[0],w[0],x[0]),Math.max(b[1],_[1],w[1],x[1]),v)):(0,Le.createOrUpdate)(Math.min(m,m+t),Math.min(p,p+o),Math.max(m,m+t),Math.max(p,p+o),v),h&&(a=Math.round(a),s=Math.round(s)),{drawImageX:a,drawImageY:s,drawImageW:e,drawImageH:i,originX:u,originY:l,declutterBox:{minX:v[0],minY:v[1],maxX:v[2],maxY:v[3],value:y},canvasTransform:g,scale:f}}},{key:"replayImageOrLabel_",value:function(e,t,r,n,i,o,a){var s=n.declutterBox,u=e.canvas,l=a?a[2]*n.scale[0]/2:0;return s.minX-l<=u.width/t&&0<=s.maxX+l&&s.minY-l<=u.height/t&&0<=s.maxY+l&&(!(!o&&!a)&&this.replayTextBackground_(e,b,_,w,x,o,a),(0,De.drawImageOrLabel)(e,n.canvasTransform,i,r,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}},{key:"fill_",value:function(e){var t,r;this.alignFill_&&(t=(0,Ae.apply)(this.renderedTransform_,[0,0]),r=512*this.pixelRatio,e.save(),e.translate(t[0]%r,t[1]%r),e.rotate(this.viewRotation_)),e.fill(),this.alignFill_&&e.restore()}},{key:"setStrokeStyle_",value:function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}},{key:"drawLabelWithPointPlacement_",value:function(e,t,r,n){var i=this.textStates[t],t=this.createLabel(e,t,n,r),n=this.strokeStates[r],r=this.pixelRatio,e=C(Array.isArray(e)?e[0]:e,i.textAlign||De.defaultTextAlign),o=Ie.TEXT_ALIGN[i.textBaseline||De.defaultTextBaseline],n=n&&n.lineWidth?n.lineWidth:0;return{label:t,anchorX:e*(t.width/r-2*i.scale[0])+2*(.5-e)*n,anchorY:o*t.height/r+2*(.5-o)*n}}},{key:"execute_",value:function(e,D,t,F,N,B,G,r){this.pixelCoordinates_&&(0,Ne.equals)(t,this.renderedTransform_)?n=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),n=(0,Ge.transform2D)(this.coordinates,0,this.coordinates.length,2,t,this.pixelCoordinates_),(0,Ae.setFromArray)(this.renderedTransform_,t));for(var n,i,o,a,s,u,U,z,l=0,W=F.length,c=0,f=0,h=0,V=null,H=null,q=this.coordinateCache_,Y=this.viewRotation_,X=Math.round(1e12*Math.atan2(-t[1],t[0]))/1e12,Z={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Y},K=this.instructions!=F||this.overlaps?0:200;l<W;){var p=F[l];switch(p[0]){case Me.default.BEGIN_GEOMETRY:L=p[1],z=p[3],L.getGeometry()?void 0===G||(0,Le.intersects)(G,z.getExtent())?++l:l=p[2]+1:l=p[2];break;case Me.default.BEGIN_PATH:K<f&&(this.fill_(e),f=0),K<h&&(e.stroke(),h=0),f||h||(e.beginPath(),o=i=NaN),++l;break;case Me.default.CIRCLE:var $=n[c=p[1]],d=n[c+1],y=n[c+2]-$,J=n[c+3]-d,y=Math.sqrt(y*y+J*J);e.moveTo($+y,d),e.arc($,d,y,0,2*Math.PI,!0),++l;break;case Me.default.CLOSE_PATH:e.closePath(),++l;break;case Me.default.CUSTOM:c=p[1];var g=p[2],J=p[3],$=p[4],d=6==p.length?p[5]:void 0,y=(Z.geometry=J,Z.feature=L,l in q||(q[l]=[]),q[l]);d?d(n,c,g,2,y):(y[0]=n[c],y[1]=n[c+1],y.length=2),$(y,Z),++l;break;case Me.default.DRAW_IMAGE:c=p[1],g=p[2],w=p[3],x=p[4],S=p[5];var m,v,b,_,w,x,S,Q=p[6],ee=p[7],te=p[8],re=p[9],ne=p[10],ie=p[11],oe=p[12],ae=p[13],se=p[14],j=p[15],ue=(!w&&20<=p.length&&(m=p[19],v=p[20],b=p[21],_=p[22],w=(O=this.drawLabelWithPointPlacement_(m,v,b,_)).label,p[3]=w,P=p[23],x=(O.anchorX-P)*this.pixelRatio,p[4]=x,P=p[24],S=(O.anchorY-P)*this.pixelRatio,p[5]=S,Q=w.height,p[6]=Q,ae=w.width,p[13]=ae),void 0),le=(25<p.length&&(ue=p[25]),void 0),ce=void 0,fe=void 0,fe=17<p.length?(le=p[16],ce=p[17],p[18]):(le=De.defaultPadding,ce=!1);ne&&X?ie+=Y:ne||X||(ie-=Y);for(var he=0;c<g;c+=2)if(!(ue&&ue[he++]<ae/this.pixelRatio)){var pe=this.calculateImageOrLabelDimensions_(w.width,w.height,n[c],n[c+1],ae,Q,x,S,te,re,ie,oe,N,le,ce||fe,L),de=[e,D,w,pe,ee,ce?V:null,fe?H:null];if(r){if("none"===se)continue;if("obstacle"===se){r.insert(pe.declutterBox);continue}var ye=void 0,ge=void 0;if(j){var me=g-c;if(!j[me]){j[me]=de;continue}if(ye=j[me],delete j[me],ge=Ue(ye),r.collides(ge))continue}if(r.collides(pe.declutterBox))continue;ye&&(r.insert(ge),this.replayImageOrLabel_.apply(this,ye)),r.insert(pe.declutterBox)}this.replayImageOrLabel_.apply(this,de)}++l;break;case Me.default.DRAW_CHARS:var O=p[1],P=p[2],ve=p[3],ne=p[4],be=(_=p[5],p[6]),k=p[7],_e=p[8],we=(b=p[9],p[10]),xe=(m=p[11],v=p[12],[p[13],p[13]]),E=this.textStates[v],T=E.font,C=[E.scale[0]*k,E.scale[1]*k],E=void 0,k=(T in this.widths_?E=this.widths_[T]:this.widths_[T]=E={},(0,Be.lineStringLength)(n,O,P,2)),Se=Math.abs(C[0])*(0,De.measureAndCacheTextWidth)(T,m,E);if(ne||Se<=k){var je=this.textStates[v].textAlign,k=(k-Se)*Ie.TEXT_ALIGN[je],R=(0,Fe.drawTextOnPath)(n,O,P,2,m,k,be,Math.abs(C[0]),De.measureAndCacheTextWidth,T,E,X?0:this.viewRotation_);e:if(R){var Oe=[],M=void 0,Pe=void 0,ke=void 0,I=void 0,A=void 0;if(b)for(M=0,Pe=R.length;M<Pe;++M){ke=(A=R[M])[4],I=this.createLabel(ke,v,"",b),x=A[2]+(C[0]<0?-we:we),S=ve*I.height+2*(.5-ve)*we*C[1]/C[0]-_e;var Ee=this.calculateImageOrLabelDimensions_(I.width,I.height,A[0],A[1],I.width,I.height,x,S,0,0,A[3],xe,!1,De.defaultPadding,!1,L);if(r&&r.collides(Ee.declutterBox))break e;Oe.push([e,D,I,Ee,1,null,null])}if(_)for(M=0,Pe=R.length;M<Pe;++M){ke=(A=R[M])[4],I=this.createLabel(ke,v,_,""),x=A[2],S=ve*I.height-_e;var Te=this.calculateImageOrLabelDimensions_(I.width,I.height,A[0],A[1],I.width,I.height,x,S,0,0,A[3],xe,!1,De.defaultPadding,!1,L);if(r&&r.collides(Te.declutterBox))break e;Oe.push([e,D,I,Te,1,null,null])}r&&r.load(Oe.map(Ue));for(var Ce=0,Re=Oe.length;Ce<Re;++Ce)this.replayImageOrLabel_.apply(this,Oe[Ce])}}++l;break;case Me.default.END_GEOMETRY:if(void 0!==B){var L,Se=B(L=p[1],z);if(Se)return Se}++l;break;case Me.default.FILL:K?f++:this.fill_(e),++l;break;case Me.default.MOVE_TO_LINE_TO:for(c=p[1],g=p[2],u=n[c],s=(U=n[c+1])+.5|0,(a=u+.5|0)===i&&s===o||(e.moveTo(u,U),i=a,o=s),c+=2;c<g;c+=2)a=(u=n[c])+.5|0,s=(U=n[c+1])+.5|0,c!=g-2&&a===i&&s===o||(e.lineTo(u,U),i=a,o=s);++l;break;case Me.default.SET_FILL_STYLE:this.alignFill_=(V=p)[2],f&&(this.fill_(e),f=0,h)&&(e.stroke(),h=0),e.fillStyle=p[1],++l;break;case Me.default.SET_STROKE_STYLE:H=p,h&&(e.stroke(),h=0),this.setStrokeStyle_(e,p),++l;break;case Me.default.STROKE:K?h++:e.stroke(),++l;break;default:++l}}f&&this.fill_(e),h&&e.stroke()}},{key:"execute",value:function(e,t,r,n,i,o){this.viewRotation_=n,this.execute_(e,t,r,this.instructions,i,void 0,void 0,o)}},{key:"executeHitDetection",value:function(e,t,r,n,i){return this.viewRotation_=r,this.execute_(e,1,t,this.hitDetectionInstructions,!0,n,i)}}])&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();r.default=a},{"../../array.js":104,"../../extent.js":131,"../../geom/flat/length.js":213,"../../geom/flat/textpath.js":219,"../../geom/flat/transform.js":220,"../../transform.js":377,"../canvas.js":285,"./Instruction.js":292,"./TextBuilder.js":295}],289:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.getPixelIndexArray=O;var s=(l=e("./Executor.js"))&&l.__esModule?l:{default:l},_=e("../../extent.js"),w=e("../../transform.js"),x=e("../../dom.js"),n=e("../../obj.js"),S=e("../../array.js"),o=e("../../geom/flat/transform.js");function f(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?i(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}var j=["Polygon","Circle","LineString","Image","Text","Default"],l=function(){function a(e,t,r,n,i,o){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.maxExtent_=e,this.overlaps_=n,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,w.create)(),this.createExecutors_(i)}var e,t,r;return e=a,(t=[{key:"clip",value:function(e,t){t=this.getClipCoords(t);e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.clip()}},{key:"createExecutors_",value:function(e){for(var t in e){var r,n=this.executorsByZIndex_[t],i=(void 0===n&&(this.executorsByZIndex_[t]=n={}),e[t]);for(r in i){var o=i[r];n[r]=new s.default(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}},{key:"hasExecutors",value:function(e){for(var t in this.executorsByZIndex_)for(var r=this.executorsByZIndex_[t],n=0,i=e.length;n<i;++n)if(e[n]in r)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,s,u,l){var n,c,f=2*(s=Math.round(s))+1,i=(0,w.compose)(this.hitDetectionTransform_,s+.5,s+.5,1/t,-1/t,-r,-e[0],-e[1]),o=!this.hitDetectionContext_,h=(o&&(this.hitDetectionContext_=(0,x.createCanvasContext2D)(f,f)),this.hitDetectionContext_),p=(h.canvas.width!==f||h.canvas.height!==f?(h.canvas.width=f,h.canvas.height=f):o||h.clearRect(0,0,f,f),void 0!==this.renderBuffer_&&(n=(0,_.createEmpty)(),(0,_.extendCoordinate)(n,e),(0,_.buffer)(n,t*(this.renderBuffer_+s),n)),O(s));function a(e,t){for(var r=h.getImageData(0,0,f,f).data,n=0,i=p.length;n<i;n++)if(0<r[p[n]]){if(!l||"Image"!==c&&"Text"!==c||l.includes(e)){var o=(p[n]-3)/4,a=s-o%f,o=s-(o/f|0),a=u(e,t,a*a+o*o);if(a)return a}h.clearRect(0,0,f,f);break}}var d,y,g=Object.keys(this.executorsByZIndex_).map(Number);for(g.sort(S.numberSafeCompareFunction),d=g.length-1;0<=d;--d)for(var m=g[d].toString(),v=this.executorsByZIndex_[m],b=j.length-1;0<=b;--b)if(void 0!==(y=v[c=j[b]])&&(y=y.executeHitDetection(h,i,r,a,n)))return y}},{key:"getClipCoords",value:function(e){var t,r,n,i=this.maxExtent_;return i?(n=i[0],t=i[1],r=i[2],i=i[3],(0,o.transform2D)(n=[n,t,n,i,r,i,r,t],0,8,2,e,n),n):null}},{key:"isEmpty",value:function(){return(0,n.isEmpty)(this.executorsByZIndex_)}},{key:"execute",value:function(e,t,r,n,i,o,a){var s,u,l=Object.keys(this.executorsByZIndex_).map(Number);for(l.sort(S.numberSafeCompareFunction),this.maxExtent_&&(e.save(),this.clip(e,r)),o=o||j,a&&l.reverse(),s=0,u=l.length;s<u;++s)for(var c,f=l[s].toString(),h=this.executorsByZIndex_[f],p=0,d=o.length;p<d;++p)void 0!==(c=h[o[p]])&&c.execute(e,t,r,n,i,a);this.maxExtent_&&e.restore()}}])&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(),h={};function O(e){if(void 0!==h[e])return h[e];for(var t=2*e+1,r=e*e,n=new Array(1+r),i=0;i<=e;++i)for(var o=0;o<=e;++o){var a=i*i+o*o;if(r<a)break;var s=n[a];s||(n[a]=s=[]),s.push(4*((e+i)*t+(e+o))+3),0<i&&s.push(4*((e-i)*t+(e+o))+3),0<o&&(s.push(4*((e+i)*t+(e-o))+3),0<i)&&s.push(4*((e-i)*t+(e-o))+3)}for(var u=[],l=0,c=n.length;l<c;++l)n[l]&&u.push.apply(u,f(n[l]));return h[e]=u}r.default=l},{"../../array.js":104,"../../dom.js":123,"../../extent.js":131,"../../geom/flat/transform.js":220,"../../obj.js":269,"../../transform.js":377,"./Executor.js":288}],290:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./Builder.js")),a=o(e("./Instruction.js"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,i=c(o);function o(e,t,r,n){if(this instanceof o)return(e=i.call(this,e,t,r,n)).hitDetectionImage_=null,e.image_=null,e.imagePixelRatio_=void 0,e.anchorX_=void 0,e.anchorY_=void 0,e.height_=void 0,e.opacity_=void 0,e.originX_=void 0,e.originY_=void 0,e.rotateWithView_=void 0,e.rotation_=void 0,e.scale_=void 0,e.width_=void 0,e.declutterMode_=void 0,e.declutterImageWithText_=void 0,e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"drawPoint",value:function(e,t){var r,n;this.image_&&(this.beginGeometry(e,t),n=e.getFlatCoordinates(),e=e.getStride(),r=this.coordinates.length,n=this.appendFlatPointCoordinates(n,e),this.instructions.push([a.default.DRAW_IMAGE,r,n,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([a.default.DRAW_IMAGE,r,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t))}},{key:"drawMultiPoint",value:function(e,t){var r,n;this.image_&&(this.beginGeometry(e,t),n=e.getFlatCoordinates(),e=e.getStride(),r=this.coordinates.length,n=this.appendFlatPointCoordinates(n,e),this.instructions.push([a.default.DRAW_IMAGE,r,n,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([a.default.DRAW_IMAGE,r,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t))}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,u(f(o.prototype),"finish",this).call(this)}},{key:"setImageStyle",value:function(e,t){var r=e.getAnchor(),n=e.getSize(),i=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=e.getOpacity(),this.originX_=i[0],this.originY_=i[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=n[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"./Builder.js":286,"./Instruction.js":292}],291:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../VectorContext.js"))&&n.__esModule?n:{default:n},c=e("../../colorlike.js"),d=e("../../transform.js"),f=e("../canvas.js"),o=e("../../array.js"),h=e("../../extent.js"),y=e("../../geom/flat/transform.js"),a=e("../../geom/SimpleGeometry.js");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,u=g(l);function l(e,t,r,n,i,o,a){var s;if(this instanceof l)return(s=u.call(this)).context_=e,s.pixelRatio_=t,s.extent_=r,s.transform_=n,s.viewRotation_=i,s.squaredTolerance_=o,s.userTransform_=a,s.contextFillState_=null,s.contextStrokeState_=null,s.contextTextState_=null,s.fillState_=null,s.strokeState_=null,s.image_=null,s.imageAnchorX_=0,s.imageAnchorY_=0,s.imageHeight_=0,s.imageOpacity_=0,s.imageOriginX_=0,s.imageOriginY_=0,s.imageRotateWithView_=!1,s.imageRotation_=0,s.imageScale_=[0,0],s.imageWidth_=0,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=!1,s.textRotation_=0,s.textScale_=[0,0],s.textFillState_=null,s.textStrokeState_=null,s.textState_=null,s.pixelCoordinates_=[],s.tmpLocalTransform_=(0,d.create)(),s;throw new TypeError("Cannot call a class as a function")}return t=l,(e=[{key:"drawImages_",value:function(e,t,r,n){if(this.image_){var i=(0,y.transform2D)(e,t,r,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,e=o.globalAlpha,s=(1!=this.imageOpacity_&&(o.globalAlpha=e*this.imageOpacity_),this.imageRotation_);this.imageRotateWithView_&&(s+=this.viewRotation_);for(var u=0,l=i.length;u<l;u+=2){var c,f,h=i[u]-this.imageAnchorX_,p=i[u+1]-this.imageAnchorY_;0!==s||1!=this.imageScale_[0]||1!=this.imageScale_[1]?(c=h+this.imageAnchorX_,f=p+this.imageAnchorY_,(0,d.compose)(a,c,f,1,1,s,-c,-f),o.setTransform.apply(o,a),o.translate(c,f),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)):o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,p,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=e)}}},{key:"drawText_",value:function(e,t,r,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var i=(0,y.transform2D)(e,t,r,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);t<r;t+=n){var s=i[t]+this.textOffsetX_,u=i[t+1]+this.textOffsetY_;0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.translate(s-this.textOffsetX_,u-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,s,u),this.textFillState_&&o.fillText(this.text_,s,u))}}}},{key:"moveToLineTo_",value:function(e,t,r,n,i){var o=this.context_,a=(0,y.transform2D)(e,t,r,n,this.transform_,this.pixelCoordinates_),s=(o.moveTo(a[0],a[1]),a.length);i&&(s-=2);for(var u=2;u<s;u+=2)o.lineTo(a[u],a[u+1]);return i&&o.closePath(),r}},{key:"drawRings_",value:function(e,t,r,n){for(var i=0,o=r.length;i<o;++i)t=this.moveToLineTo_(e,t,r[i],n,!0);return t}},{key:"drawCircle",value:function(e){var t,r,n;(0,h.intersects)(this.extent_,e.getExtent())&&((this.fillState_||this.strokeState_)&&(this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_),r=(t=(0,a.transformGeom2D)(e,this.transform_,this.pixelCoordinates_))[2]-t[0],n=t[3]-t[1],r=Math.sqrt(r*r+n*n),(n=this.context_).beginPath(),n.arc(t[0],t[1],r,0,2*Math.PI),this.fillState_&&n.fill(),this.strokeState_)&&n.stroke(),""!==this.text_)&&this.drawText_(e.getCenter(),0,2,2)}},{key:"setStyle",value:function(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}},{key:"setTransform",value:function(e){this.transform_=e}},{key:"drawGeometry",value:function(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e)}}},{key:"drawFeature",value:function(e,t){e=t.getGeometryFunction()(e);e&&(0,h.intersects)(this.extent_,e.getExtent())&&(this.setStyle(t),this.drawGeometry(e))}},{key:"drawGeometryCollection",value:function(e){for(var t=e.getGeometriesArray(),r=0,n=t.length;r<n;++r)this.drawGeometry(t[r])}},{key:"drawPoint",value:function(e){var t=(e=this.squaredTolerance_?e.simplifyTransformed(this.squaredTolerance_,this.userTransform_):e).getFlatCoordinates(),e=e.getStride();this.image_&&this.drawImages_(t,0,t.length,e),""!==this.text_&&this.drawText_(t,0,t.length,e)}},{key:"drawMultiPoint",value:function(e){var t=(e=this.squaredTolerance_?e.simplifyTransformed(this.squaredTolerance_,this.userTransform_):e).getFlatCoordinates(),e=e.getStride();this.image_&&this.drawImages_(t,0,t.length,e),""!==this.text_&&this.drawText_(t,0,t.length,e)}},{key:"drawLineString",value:function(e){var t,r;this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,h.intersects)(this.extent_,e.getExtent())&&(this.strokeState_&&(this.setContextStrokeState_(this.strokeState_),t=this.context_,r=e.getFlatCoordinates(),t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()),""!==this.text_)&&(r=e.getFlatMidpoint(),this.drawText_(r,0,2,2))}},{key:"drawMultiLineString",value:function(e){var t=(e=this.squaredTolerance_?e.simplifyTransformed(this.squaredTolerance_,this.userTransform_):e).getExtent();if((0,h.intersects)(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var t=this.context_,r=e.getFlatCoordinates(),n=0,i=e.getEnds(),o=e.getStride();t.beginPath();for(var a=0,s=i.length;a<s;++a)n=this.moveToLineTo_(r,n,i[a],o,!1);t.stroke()}""!==this.text_&&(t=e.getFlatMidpoints(),this.drawText_(t,0,t.length,2))}}},{key:"drawPolygon",value:function(e){var t;this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,h.intersects)(this.extent_,e.getExtent())&&((this.strokeState_||this.fillState_)&&(this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_),(t=this.context_).beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_)&&t.stroke(),""!==this.text_)&&(t=e.getFlatInteriorPoint(),this.drawText_(t,0,2,2))}},{key:"drawMultiPolygon",value:function(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,h.intersects)(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var t=this.context_,r=e.getOrientedFlatCoordinates(),n=0,i=e.getEndss(),o=e.getStride();t.beginPath();for(var a=0,s=i.length;a<s;++a)var u=i[a],n=this.drawRings_(r,n,u,o);this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}""!==this.text_&&(t=e.getFlatInteriorPoints(),this.drawText_(t,0,t.length,2))}}},{key:"setContextFillState_",value:function(e){var t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}},{key:"setContextStrokeState_",value:function(e){var t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),(0,o.equals)(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}},{key:"setContextTextState_",value:function(e){var t=this.context_,r=this.contextTextState_,n=e.textAlign||f.defaultTextAlign;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=n&&(r.textAlign=n,t.textAlign=n),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=n,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:n,textBaseline:e.textBaseline})}},{key:"setFillStrokeStyle",value:function(e,t){var r,n,i,o,a,s=this;e?(e=e.getColor(),this.fillState_={fillStyle:(0,c.asColorLike)(e||f.defaultFillStyle)}):this.fillState_=null,t?(e=t.getColor(),r=t.getLineCap(),a=t.getLineDash(),n=t.getLineDashOffset(),i=t.getLineJoin(),o=t.getWidth(),t=t.getMiterLimit(),a=a||f.defaultLineDash,this.strokeState_={lineCap:void 0!==r?r:f.defaultLineCap,lineDash:1===this.pixelRatio_?a:a.map(function(e){return e*s.pixelRatio_}),lineDashOffset:(n||f.defaultLineDashOffset)*this.pixelRatio_,lineJoin:void 0!==i?i:f.defaultLineJoin,lineWidth:(void 0!==o?o:f.defaultLineWidth)*this.pixelRatio_,miterLimit:void 0!==t?t:f.defaultMiterLimit,strokeStyle:(0,c.asColorLike)(e||f.defaultStrokeStyle)}):this.strokeState_=null}},{key:"setImageStyle",value:function(e){var t,r,n,i;e&&(t=e.getSize())?(r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),n=e.getOrigin(),this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation(),i=e.getScaleArray(),this.imageScale_=[i[0]*this.pixelRatio_/r,i[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r):this.image_=null}},{key:"setTextStyle",value:function(e){var t,r,n,i,o,a,s,u;e?((a=e.getFill())?(a=a.getColor(),this.textFillState_={fillStyle:(0,c.asColorLike)(a||f.defaultFillStyle)}):this.textFillState_=null,(a=e.getStroke())?(s=a.getColor(),t=a.getLineCap(),r=a.getLineDash(),n=a.getLineDashOffset(),i=a.getLineJoin(),o=a.getWidth(),a=a.getMiterLimit(),this.textStrokeState_={lineCap:void 0!==t?t:f.defaultLineCap,lineDash:r||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==i?i:f.defaultLineJoin,lineWidth:void 0!==o?o:f.defaultLineWidth,miterLimit:void 0!==a?a:f.defaultMiterLimit,strokeStyle:(0,c.asColorLike)(s||f.defaultStrokeStyle)}):this.textStrokeState_=null,t=e.getFont(),r=e.getOffsetX(),n=e.getOffsetY(),i=e.getRotateWithView(),o=e.getRotation(),a=e.getScaleArray(),s=e.getText(),u=e.getTextAlign(),e=e.getTextBaseline(),this.textState_={font:void 0!==t?t:f.defaultFont,textAlign:void 0!==u?u:f.defaultTextAlign,textBaseline:void 0!==e?e:f.defaultTextBaseline},this.text_=void 0!==s?Array.isArray(s)?s.reduce(function(e,t,r){return e+(r%2?" ":t)},""):s:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==n?this.pixelRatio_*n:0,this.textRotateWithView_=void 0!==i&&i,this.textRotation_=void 0!==o?o:0,this.textScale_=[this.pixelRatio_*a[0],this.pixelRatio_*a[1]]):this.text_=""}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.default);r.default=e},{"../../array.js":104,"../../colorlike.js":108,"../../extent.js":131,"../../geom/SimpleGeometry.js":201,"../../geom/flat/transform.js":220,"../../transform.js":377,"../VectorContext.js":284,"../canvas.js":285}],292:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.strokeInstruction=r.fillInstruction=r.default=r.closePathInstruction=r.beginPathInstruction=void 0;var n={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},i=(r.fillInstruction=[n.FILL],[n.STROKE]),i=(r.strokeInstruction=i,[n.BEGIN_PATH]),i=(r.beginPathInstruction=i,[n.CLOSE_PATH]),i=(r.closePathInstruction=i,n);r.default=i},{}],293:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Builder.js"))&&n.__esModule?n:{default:n},f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Instruction.js")),s=e("../canvas.js");function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,i=p(o);function o(e,t,r,n){if(this instanceof o)return i.call(this,e,t,r,n);throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"drawFlatCoordinates_",value:function(e,t,r,n){var i=this.coordinates.length,e=this.appendFlatLineCoordinates(e,t,r,n,!1,!1),t=[f.default.MOVE_TO_LINE_TO,i,e];return this.instructions.push(t),this.hitDetectionInstructions.push(t),r}},{key:"drawLineString",value:function(e,t){var r=this.state,n=r.strokeStyle,i=r.lineWidth;void 0!==n&&void 0!==i&&(this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t),this.hitDetectionInstructions.push([f.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,s.defaultLineDash,s.defaultLineDashOffset],f.beginPathInstruction),n=e.getFlatCoordinates(),i=e.getStride(),this.drawFlatCoordinates_(n,0,n.length,i),this.hitDetectionInstructions.push(f.strokeInstruction),this.endGeometry(t))}},{key:"drawMultiLineString",value:function(e,t){var r=this.state,n=r.strokeStyle,i=r.lineWidth;if(void 0!==n&&void 0!==i){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t),this.hitDetectionInstructions.push([f.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],f.beginPathInstruction);for(var o=e.getEnds(),a=e.getFlatCoordinates(),s=e.getStride(),u=0,l=0,c=o.length;l<c;++l)u=this.drawFlatCoordinates_(a,u,o[l],s);this.hitDetectionInstructions.push(f.strokeInstruction),this.endGeometry(t)}}},{key:"finish",value:function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(f.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,c(d(o.prototype),"finish",this).call(this)}},{key:"applyStroke",value:function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(f.strokeInstruction),e.lastStroke=this.coordinates.length),e.lastStroke=0,c(d(o.prototype),"applyStroke",this).call(this,e),this.instructions.push(f.beginPathInstruction)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"../canvas.js":285,"./Builder.js":286,"./Instruction.js":292}],294:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./Builder.js"))&&n.__esModule?n:{default:n},h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Instruction.js")),f=e("../canvas.js"),s=e("../../geom/flat/simplify.js");function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,i=d(o);function o(e,t,r,n){if(this instanceof o)return i.call(this,e,t,r,n);throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"drawFlatCoordinatess_",value:function(e,t,r,n){var i=this.state,o=void 0!==i.fillStyle,a=void 0!==i.strokeStyle,s=r.length;this.instructions.push(h.beginPathInstruction),this.hitDetectionInstructions.push(h.beginPathInstruction);for(var u=0;u<s;++u){var l=r[u],c=this.coordinates.length,f=this.appendFlatLineCoordinates(e,t,l,n,!0,!a),c=[h.default.MOVE_TO_LINE_TO,c,f];this.instructions.push(c),this.hitDetectionInstructions.push(c),a&&(this.instructions.push(h.closePathInstruction),this.hitDetectionInstructions.push(h.closePathInstruction)),t=l}return o&&(this.instructions.push(h.fillInstruction),this.hitDetectionInstructions.push(h.fillInstruction)),a&&(this.instructions.push(h.strokeInstruction),this.hitDetectionInstructions.push(h.strokeInstruction)),t}},{key:"drawCircle",value:function(e,t){var r=this.state,n=r.fillStyle,i=r.strokeStyle;void 0===n&&void 0===i||(this.setFillStrokeStyles_(),this.beginGeometry(e,t),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([h.default.SET_FILL_STYLE,f.defaultFillStyle]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([h.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]),n=e.getFlatCoordinates(),i=e.getStride(),e=this.coordinates.length,this.appendFlatLineCoordinates(n,0,n.length,i,!1,!1),n=[h.default.CIRCLE,e],this.instructions.push(h.beginPathInstruction,n),this.hitDetectionInstructions.push(h.beginPathInstruction,n),void 0!==r.fillStyle&&(this.instructions.push(h.fillInstruction),this.hitDetectionInstructions.push(h.fillInstruction)),void 0!==r.strokeStyle&&(this.instructions.push(h.strokeInstruction),this.hitDetectionInstructions.push(h.strokeInstruction)),this.endGeometry(t))}},{key:"drawPolygon",value:function(e,t){var r=this.state,n=r.fillStyle,i=r.strokeStyle;void 0===n&&void 0===i||(this.setFillStrokeStyles_(),this.beginGeometry(e,t),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([h.default.SET_FILL_STYLE,f.defaultFillStyle]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([h.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]),n=e.getEnds(),i=e.getOrientedFlatCoordinates(),r=e.getStride(),this.drawFlatCoordinatess_(i,0,n,r),this.endGeometry(t))}},{key:"drawMultiPolygon",value:function(e,t){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(e,t),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([h.default.SET_FILL_STYLE,f.defaultFillStyle]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([h.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);for(var o=e.getEndss(),a=e.getOrientedFlatCoordinates(),s=e.getStride(),u=0,l=0,c=o.length;l<c;++l)u=this.drawFlatCoordinatess_(a,u,o[l],s);this.endGeometry(t)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var t=this.coordinates,r=0,n=t.length;r<n;++r)t[r]=(0,s.snap)(t[r],e);return c(y(o.prototype),"finish",this).call(this)}},{key:"setFillStrokeStyles_",value:function(){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"../../geom/flat/simplify.js":217,"../canvas.js":285,"./Builder.js":286,"./Instruction.js":292}],295:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.TEXT_ALIGN=void 0;var n=o(e("./Builder.js")),R=o(e("./Instruction.js")),l=e("../../colorlike.js"),M=e("../canvas.js"),c=e("../../util.js"),I=e("../../extent.js"),A=e("../../geom/flat/straightchunk.js");function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},e=(r.TEXT_ALIGN=p,function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,i=f(o);function o(e,t,r,n){if(this instanceof o)return(e=i.call(this,e,t,r,n)).labels_=null,e.text_="",e.textOffsetX_=0,e.textOffsetY_=0,e.textRotateWithView_=void 0,e.textRotation_=0,e.textFillState_=null,e.fillStates={},e.textStrokeState_=null,e.strokeStates={},e.textState_={},e.textStates={},e.textKey_="",e.fillKey_="",e.strokeKey_="",e.declutterImageWithText_=void 0,e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"finish",value:function(){var e=s(h(o.prototype),"finish",this).call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}},{key:"drawText",value:function(e,t){var r=this.textFillState_,n=this.textStrokeState_,i=this.textState_;if(""!==this.text_&&i&&(r||n)){var o=this.coordinates,a=o.length,r=e.getType(),s=null,u=e.getStride();if("line"!==i.placement||"LineString"!=r&&"MultiLineString"!=r&&"Polygon"!=r&&"MultiPolygon"!=r){var l=i.overflow?null:[];switch(r){case"Point":case"MultiPoint":s=e.getFlatCoordinates();break;case"LineString":s=e.getFlatMidpoint();break;case"Circle":s=e.getCenter();break;case"MultiLineString":s=e.getFlatMidpoints(),u=2;break;case"Polygon":s=e.getFlatInteriorPoint(),i.overflow||l.push(s[2]/this.resolution),u=3;break;case"MultiPolygon":var c=e.getFlatInteriorPoints();s=[];for(var f=0,h=c.length;f<h;f+=3)i.overflow||l.push(c[f+2]/this.resolution),s.push(c[f],c[f+1]);if(0===s.length)return;u=2}var p,d,y,g,m,v,b,n=this.appendFlatPointCoordinates(s,u);n!==a&&(l&&(n-a)/2!=s.length/u&&(p=a/2,l=l.filter(function(e,t){t=o[2*(p+t)]===s[t*u]&&o[2*(p+t)+1]===s[t*u+1];return t||--p,t})),this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),i.backgroundStroke)&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state))),this.beginGeometry(e,t),(d=i.padding)!=M.defaultPadding&&(i.scale[0]<0||i.scale[1]<0)&&(b=i.padding[0],y=i.padding[1],g=i.padding[2],m=i.padding[3],i.scale[0]<0&&(y=-y,m=-m),i.scale[1]<0&&(b=-b,g=-g),d=[b,y,g,m]),v=this.pixelRatio,this.instructions.push([R.default.DRAW_IMAGE,a,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,d==M.defaultPadding?M.defaultPadding:d.map(function(e){return e*v}),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,l]),this.hitDetectionInstructions.push([R.default.DRAW_IMAGE,a,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b=1/v,b],NaN,void 0,this.declutterImageWithText_,d,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,l]),this.endGeometry(t))}else if((0,I.intersects)(this.getBufferedMaxExtent(),e.getExtent())){s=e.getFlatCoordinates();if("LineString"==r)w=[s.length];else if("MultiLineString"==r)w=e.getEnds();else if("Polygon"==r)w=e.getEnds().slice(0,1);else if("MultiPolygon"==r)for(var _=e.getEndss(),w=[],x=0,S=_.length;x<S;++x)w.push(_[x][0]);this.beginGeometry(e,t);for(var j,O=i.textAlign,P=0,k=0,E=w.length;k<E;++k){j=null==O?(P=(C=(0,A.matchingChunk)(i.maxAngle,s,P,w[k],u))[0],C[1]):w[k];for(var T=P;T<j;T+=u)o.push(s[T],s[T+1]);var C=o.length;P=w[k],this.drawChars_(a,C),a=C}this.endGeometry(t)}}}},{key:"saveTextStates_",value:function(){var e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,n=this.strokeKey_,n=(!e||n in this.strokeStates||(this.strokeStates[n]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}),this.textKey_),e=(n in this.textStates||(this.textStates[n]={font:t.font,textAlign:t.textAlign||M.defaultTextAlign,justify:t.justify,textBaseline:t.textBaseline||M.defaultTextBaseline,scale:t.scale}),this.fillKey_);!r||e in this.fillStates||(this.fillStates[e]={fillStyle:r.fillStyle})}},{key:"drawChars_",value:function(e,t){var r=this.textStrokeState_,n=this.textState_,i=this.strokeKey_,o=this.textKey_,a=this.fillKey_,s=(this.saveTextStates_(),this.pixelRatio),u=p[n.textBaseline],l=this.textOffsetY_*s,c=this.text_,r=r?r.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([R.default.DRAW_CHARS,e,t,u,n.overflow,a,n.maxAngle,s,l,i,r*s,c,o,1]),this.hitDetectionInstructions.push([R.default.DRAW_CHARS,e,t,u,n.overflow,a,n.maxAngle,1,l,i,r,c,o,1/s])}},{key:"setTextStyle",value:function(e,t){var r,n,i,o,a,s,u;e?((a=e.getFill())?((r=this.textFillState_)||(this.textFillState_=r={}),r.fillStyle=(0,l.asColorLike)(a.getColor()||M.defaultFillStyle)):this.textFillState_=r=null,(a=e.getStroke())?((n=this.textStrokeState_)||(this.textStrokeState_=n={}),i=a.getLineDash(),s=a.getLineDashOffset(),u=a.getWidth(),o=a.getMiterLimit(),n.lineCap=a.getLineCap()||M.defaultLineCap,n.lineDash=i?i.slice():M.defaultLineDash,n.lineDashOffset=void 0===s?M.defaultLineDashOffset:s,n.lineJoin=a.getLineJoin()||M.defaultLineJoin,n.lineWidth=void 0===u?M.defaultLineWidth:u,n.miterLimit=void 0===o?M.defaultMiterLimit:o,n.strokeStyle=(0,l.asColorLike)(a.getColor()||M.defaultStrokeStyle)):this.textStrokeState_=n=null,i=this.textState_,s=e.getFont()||M.defaultFont,(0,M.registerFont)(s),u=e.getScaleArray(),i.overflow=e.getOverflow(),i.font=s,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||M.defaultTextBaseline,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||M.defaultPadding,i.scale=void 0===u?[1,1]:u,o=e.getOffsetX(),a=e.getOffsetY(),s=e.getRotateWithView(),u=e.getRotation(),this.text_=e.getText()||"",this.textOffsetX_=void 0===o?0:o,this.textOffsetY_=void 0===a?0:a,this.textRotateWithView_=void 0!==s&&s,this.textRotation_=void 0===u?0:u,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:(0,c.getUid)(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+(0,c.getUid)(r.fillStyle):""):this.text_="",this.declutterImageWithText_=t}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default));r.default=e},{"../../colorlike.js":108,"../../extent.js":131,"../../geom/flat/straightchunk.js":218,"../../util.js":379,"../canvas.js":285,"./Builder.js":286,"./Instruction.js":292}],296:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HIT_DETECT_RESOLUTION=void 0,r.createHitDetectionImageData=function(e,t,r,n,i,o,a){for(var s=e[0]*G,e=e[1]*G,s=(0,F.createCanvasContext2D)(s,e),e=(s.imageSmoothingEnabled=!1,s.canvas),u=new L.default(s,G,i,null,a),l=r.length,c=Math.floor(16777215/l),f={},h=1;h<=l;++h){var p=r[h-1],d=p.getStyleFunction()||n;if(n){var y=d(p,o);if(y){Array.isArray(y)||(y=[y]);for(var g="#"+("000000"+(h*c).toString(16)).slice(-6),m=0,v=y.length;m<v;++m){var b=y[m],_=b.getGeometryFunction()(p);if(_&&(0,N.intersects)(i,_.getExtent())){var w=b.clone(),x=w.getFill(),x=(x&&x.setColor(g),w.getStroke()),x=(x&&(x.setColor(g),x.setLineDash(null)),w.setText(void 0),b.getImage());if(x&&0!==x.getOpacity()){b=x.getImageSize();if(!b)continue;var S=(0,F.createCanvasContext2D)(b[0],b[1],void 0,{alpha:!1}),j=S.canvas;S.fillStyle=g,S.fillRect(0,0,j.width,j.height),w.setImage(new D.Icon({img:j,imgSize:b,anchor:x.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:x.getOrigin(),opacity:1,size:x.getSize(),scale:x.getScale(),rotation:x.getRotation(),rotateWithView:x.getRotateWithView()}))}S=w.getZIndex()||0,j=f[S];j||(j={},(f[S]=j).Polygon=[],j.Circle=[],j.LineString=[],j.Point=[]),j[_.getType().replace("Multi","")].push(_,w)}}}}}for(var O=Object.keys(f).map(Number).sort(B.numberSafeCompareFunction),P=0,k=O.length;P<k;++P){var E,T=f[O[P]];for(E in T)for(var C=T[E],R=0,M=C.length;R<M;R+=2){u.setStyle(C[R+1]);for(var I=0,A=t.length;I<A;++I)u.setTransform(t[I]),u.drawGeometry(C[R])}}return s.getImageData(0,0,e.width,e.height)},r.hitDetect=function(e,t,r){var n=[];{var i,o;r&&(o=Math.floor(Math.round(e[0])*G),e=Math.floor(Math.round(e[1])*G),o=4*((0,a.clamp)(o,0,r.width-1)+(0,a.clamp)(e,0,r.height-1)*r.width),e=r.data[o],i=r.data[1+o],r=r.data[2+o]+256*(i+256*e),o=Math.floor(16777215/t.length),r)&&r%o==0&&n.push(t[r/o-1])}return n};var n,L=(n=e("./Immediate.js"))&&n.__esModule?n:{default:n},D=e("../../style.js"),a=e("../../math.js"),F=e("../../dom.js"),N=e("../../extent.js"),B=e("../../array.js");var G=.5;r.HIT_DETECT_RESOLUTION=G},{"../../array.js":104,"../../dom.js":123,"../../extent.js":131,"../../math.js":267,"../../style.js":358,"./Immediate.js":291}],297:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WebGLWorkerMessageType=void 0;r.WebGLWorkerMessageType={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"}},{}],298:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.colorDecodeId=function(e){var t=0;return t=(t=(t=(t+=Math.round(256*e[0]*256*256*255))+Math.round(256*e[1]*256*255))+Math.round(256*e[2]*255))+Math.round(255*e[3])},r.colorEncodeId=function(e,t){return(t=t||[])[0]=Math.floor(e/256/256/256)/255,t[1]=Math.floor(e/256/256)%256/255,t[2]=Math.floor(e/256)%256/255,t[3]=e%256/255,t},r.getBlankImageData=function(){var e=document.createElement("canvas").getContext("2d").createImageData(1,1);return e.data[0]=255,e.data[1]=255,e.data[2]=255,e.data[3]=255,e},r.writeLineSegmentToBuffers=function(e,t,r,n,i,o,a,s,u,l){var c=5+s.length,c=o.length/c,t=[e[t+0],e[t+1]],r=[e[r],e[r+1]],f=(0,v.apply)(l,[].concat(t)),h=(0,v.apply)(l,[].concat(r));function p(e,t,r){return Math.round(1500*t)+1e4*Math.round(1500*r)+1e4*e*1e4}function d(e,t,r){var n=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),t=[(t[0]-e[0])/n,(t[1]-e[1])/n],i=[-t[1],t[0]],o=Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1])),r=[(r[0]-e[0])/o,(r[1]-e[1])/o],e=0===n||0===o?0:Math.acos((0,b.clamp)(r[0]*t[0]+r[1]*t[1],-1,1));return 0<r[0]*i[0]+r[1]*i[1]?e:2*Math.PI-e}var y=null!==i,g=0,m=0;null!==n&&(n=[e[n],e[n+1]],n=(0,v.apply)(l,[].concat(n)),g=d(f,h,n));y&&(n=[e[i],e[i+1]],y=(0,v.apply)(l,[].concat(n)),m=d(h,f,y));o.push(t[0],t[1],r[0],r[1],p(0,g,m)),o.push.apply(o,_(s)),o.push(t[0],t[1],r[0],r[1],p(1,g,m)),o.push.apply(o,_(s)),o.push(t[0],t[1],r[0],r[1],p(2,g,m)),o.push.apply(o,_(s)),o.push(t[0],t[1],r[0],r[1],p(3,g,m)),o.push.apply(o,_(s)),a.push(c,1+c,2+c,1+c,3+c,2+c)},r.writePointFeatureToBuffers=function(e,t,r,n,i,o){var a=3+i,s=e[t+0],u=e[t+1],l=h;l.length=i;for(var c=0;c<l.length;c++)l[c]=e[t+2+c];var i=o?o.vertexPosition:0,o=o?o.indexPosition:0,f=i/a;return d(r,i,s,u,0),l.length&&r.set(l,i+3),d(r,i+=a,s,u,1),l.length&&r.set(l,i+3),d(r,i+=a,s,u,2),l.length&&r.set(l,i+3),d(r,i+=a,s,u,3),l.length&&r.set(l,i+3),i+=a,n[o++]=f,n[o++]=1+f,n[o++]=3+f,n[o++]=1+f,n[o++]=2+f,n[o++]=3+f,p.vertexPosition=i,p.indexPosition=o,p},r.writePolygonTrianglesToBuffers=function(e,t,r,n,i){for(var o=2+i,a=t,s=e.slice(a,a+i),u=(a+=i,e[a++]),l=0,c=new Array(u-1),f=0;f<u;f++)l+=e[a++],f<u-1&&(c[f]=l);for(var h=e.slice(a,a+2*l),p=(0,g.default)(h,c,2),d=0;d<p.length;d++)n.push(p[d]+r.length/o);for(var y=0;y<h.length;y+=2)r.push.apply(r,[h[y],h[y+1]].concat(_(s)));return a+2*l};var g=(r=e("earcut"))&&r.__esModule?r:{default:r},v=e("../../transform.js"),b=e("../../math.js");function _(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=[],p={vertexPosition:0,indexPosition:0};function d(e,t,r,n,i){e[t+0]=r,e[t+1]=n,e[t+2]=i}},{"../../math.js":267,"../../transform.js":377,earcut:8}],299:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("./Map.js")),o=c(e("../ObjectEventType.js")),a=c(e("../render/Event.js")),f=c(e("../render/EventType.js")),s=e("../css.js"),u=e("../render/canvas.js"),h=e("../layer/Layer.js"),l=e("../events.js"),p=e("../dom.js");function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function y(){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e);var r,n=m(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this,e)).fontChangeListenerKey_=(0,l.listen)(u.checkedFonts,o.default.PROPERTYCHANGE,e.redrawText.bind(e)),t.element_=document.createElement("div");var r=t.element_.style,r=(r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",t.element_.className=s.CLASS_UNSELECTABLE+" ol-layers",e.getViewport());return r.insertBefore(t.element_,r.firstChild||null),t.children_=[],t.renderedVisible_=!0,t}return t=i,(e=[{key:"dispatchRenderEvent",value:function(e,t){var r=this.getMap();r.hasListener(e)&&(e=new a.default(e,void 0,t),r.dispatchEvent(e))}},{key:"disposeInternal",value:function(){(0,l.unlistenByKey)(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),y(v(i.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(f.default.PRECOMPOSE,e);for(var t=e.layerStatesArray.sort(function(e,t){return e.zIndex-t.zIndex}),r=e.viewState,n=[],i=null,o=this.children_.length=0,a=t.length;o<a;++o){var s=t[o],u=(e.layerIndex=o,s.layer),l=u.getSourceState();!(0,h.inView)(s,r)||"ready"!=l&&"undefined"!=l?u.unrender():(s=u.render(e,i))&&(s!==i&&(this.children_.push(s),i=s),"getDeclutter"in u)&&n.push(u)}for(var c=n.length-1;0<=c;--c)n[c].renderDeclutter(e);(0,p.replaceChildren)(this.element_,this.children_),this.dispatchRenderEvent(f.default.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}}])&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../ObjectEventType.js":91,"../css.js":122,"../dom.js":123,"../events.js":125,"../layer/Layer.js":256,"../render/Event.js":281,"../render/EventType.js":282,"../render/canvas.js":285,"./Map.js":301}],300:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=u(e("../events/EventType.js")),a=u(e("../ImageState.js")),n=u(e("../Observable.js")),s=e("../util.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=h(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).ready=!0,t.boundHandleImageChange_=t.handleImageChange_.bind(p(t)),t.layer_=e,t.declutterExecutorGroup=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getFeatures",value:function(e){return(0,s.abstract)()}},{key:"getData",value:function(e){return null}},{key:"prepareFrame",value:function(e){return(0,s.abstract)()}},{key:"renderFrame",value:function(e,t){return(0,s.abstract)()}},{key:"loadedTileCallback",value:function(e,t,r){e[t]||(e[t]={}),e[t][r.tileCoord.toString()]=r}},{key:"createLoadedTileFinder",value:function(n,i,o){return function(e,t){var r=this.loadedTileCallback.bind(this,o,e);return n.forEachLoadedTile(i,e,t,r)}.bind(this)}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i){}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(e){e.target.getState()===a.default.LOADED&&this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(e){var t=e.getState();return t!=a.default.LOADED&&t!=a.default.ERROR&&e.addEventListener(o.default.CHANGE,this.boundHandleImageChange_),t==a.default.IDLE&&(e.load(),t=e.getState()),t==a.default.LOADED}},{key:"renderIfReadyAndVisible",value:function(){var e=this.getLayer();e&&e.getVisible()&&"ready"===e.getSourceState()&&e.changed()}},{key:"disposeInternal",value:function(){delete this.layer_,c(d(i.prototype),"disposeInternal",this).call(this)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../ImageState.js":80,"../Observable.js":92,"../events/EventType.js":127,"../util.js":379}],301:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../Disposable.js"))&&n.__esModule?n:{default:n},a=e("../functions.js"),o=e("../util.js"),s=e("../transform.js"),j=e("../extent.js"),u=e("../style/IconImageCache.js"),O=e("../layer/Layer.js"),P=e("../coordinate.js");function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(i);function i(e){var t;if(this instanceof i)return(t=n.call(this)).map_=e,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"dispatchRenderEvent",value:function(e,t){(0,o.abstract)()}},{key:"calculateMatrices2D",value:function(e){var t=e.viewState,r=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;(0,s.compose)(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),(0,s.makeInverse)(n,r)}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i,o,a,s){var u,l=t.viewState;function c(e,t,r,n){return i.call(o,t,e?r:null,n)}for(var f,h=l.projection,p=(0,P.wrapX)(e.slice(),h),d=[[0,0]],y=(h.canWrapX()&&n&&(n=h.getExtent(),h=(0,j.getWidth)(n),d.push([-h,0],[h,0])),t.layerStatesArray),g=y.length,m=[],v=[],b=0;b<d.length;b++)for(var _=g-1;0<=_;--_){var w=y[_],x=w.layer;if(x.hasRenderer()&&(0,O.inView)(w,l)&&a.call(s,x)){var S=x.getRenderer(),x=x.getSource();if(S&&x&&(x=x.getWrapX()?p:e,w=c.bind(null,w.managed),v[0]=x[0]+d[b][0],v[1]=x[1]+d[b][1],u=S.forEachFeatureAtCoordinate(v,t,r,w,m)),u)return u}}if(0!==m.length)return f=1/m.length,m.forEach(function(e,t){return e.distanceSq+=t*f}),m.sort(function(e,t){return e.distanceSq-t.distanceSq}),m.some(function(e){return u=e.callback(e.feature,e.layer,e.geometry)}),u}},{key:"hasFeatureAtCoordinate",value:function(e,t,r,n,i,o){return void 0!==this.forEachFeatureAtCoordinate(e,t,r,n,a.TRUE,this,i,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(e){(0,o.abstract)()}},{key:"scheduleExpireIconCache",value:function(e){u.shared.canExpireCache()&&e.postRenderFunctions.push(p)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function p(e,t){u.shared.expire()}r.default=e},{"../Disposable.js":74,"../coordinate.js":121,"../extent.js":131,"../functions.js":189,"../layer/Layer.js":256,"../style/IconImageCache.js":363,"../transform.js":377,"../util.js":379}],302:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./Layer.js")),s=o(e("../../ImageState.js")),u=o(e("../../ViewHint.js")),v=e("../../transform.js"),b=e("../../extent.js"),_=e("../../proj.js");function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){if(this instanceof i)return(e=n.call(this,e)).image_=null,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getImage",value:function(){return this.image_?this.image_.getImage():null}},{key:"prepareFrame",value:function(e){var t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,n=e.viewState,i=n.resolution,o=this.getLayer().getSource(),a=e.viewHints,e=e.extent;return void 0!==t.extent&&(e=(0,b.getIntersection)(e,(0,_.fromUserExtent)(t.extent,n.projection))),a[u.default.ANIMATING]||a[u.default.INTERACTING]||(0,b.isEmpty)(e)||(o?(t=n.projection,(a=o.getImage(e,i,r,t))&&(this.loadImage(a)?this.image_=a:a.getState()===s.default.EMPTY&&(this.image_=null))):this.image_=null),!!this.image_}},{key:"getData",value:function(e){var t,r,n,i=this.frameState;return!i||(n=this.getLayer(),i=(0,v.apply)(i.pixelToCoordinateTransform,e.slice()),(e=n.getExtent())&&!(0,b.containsCoordinate)(e,i))||(n=this.image_.getExtent(),e=this.image_.getImage(),t=(0,b.getWidth)(n),(t=Math.floor(e.width*((i[0]-n[0])/t)))<0)||t>=e.width||(r=(0,b.getHeight)(n),(n=Math.floor(e.height*((n[3]-i[1])/r)))<0)||n>=e.height?null:this.getImageData(e,t,n)}},{key:"renderFrame",value:function(e,t){var r,n=this.image_,i=n.getExtent(),o=n.getResolution(),a=n.getPixelRatio(),s=e.layerStatesArray[e.layerIndex],u=e.pixelRatio,l=e.viewState,c=l.center,f=u*o/(l.resolution*a),h=e.extent,p=l.resolution,d=l.rotation,y=Math.round((0,b.getWidth)(h)/p*u),h=Math.round((0,b.getHeight)(h)/p*u),p=((0,v.compose)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/u,1/u,d,-y/2,-h/2),(0,v.makeInverse)(this.inversePixelTransform,this.pixelTransform),(0,v.toString)(this.pixelTransform)),d=(this.useContainer(t,p,this.getBackground(e)),this.context),t=d.canvas,g=(t.width!=y||t.height!=h?(t.width=y,t.height=h):this.containerReused||d.clearRect(0,0,y,h),!1),m=!0,l=(s.extent&&(l=(0,_.fromUserExtent)(s.extent,l.projection),g=(m=(0,b.intersects)(l,e.extent))&&!(0,b.containsExtent)(l,e.extent))&&this.clipUnrotated(d,e,l),n.getImage()),n=(0,v.compose)(this.tempTransform,y/2,h/2,f,f,0,a*(i[0]-c[0])/o,a*(c[1]-i[3])/o),y=(this.renderedResolution=o*u/a,l.width*n[0]),h=l.height*n[3];return this.getLayer().getSource().getInterpolate()||(d.imageSmoothingEnabled=!1),this.preRender(d,e),m&&.5<=y&&.5<=h&&(f=n[4],c=n[5],1!==(i=s.opacity)&&(r=d.globalAlpha,d.globalAlpha=i),d.drawImage(l,0,0,+l.width,+l.height,f,c,y,h),1!==i)&&(d.globalAlpha=r),this.postRender(d,e),g&&d.restore(),d.imageSmoothingEnabled=!0,p!==t.style.transform&&(t.style.transform=p),this.container}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../../ImageState.js":80,"../../ViewHint.js":102,"../../extent.js":131,"../../proj.js":271,"../../transform.js":377,"./Layer.js":303}],303:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.canvasPool=void 0;var n=h(e("../Layer.js")),o=h(e("../../render/Event.js")),a=h(e("../../render/EventType.js")),s=e("../../transform.js"),u=e("../../color.js"),l=e("../../dom.js"),c=e("../../array.js"),f=e("../../extent.js");function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(r),t=(e=n?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.canvasPool=[];var v=null;e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n=g(i);function i(e){if(this instanceof i)return(e=n.call(this,e)).container=null,e.renderedResolution,e.tempTransform=(0,s.create)(),e.pixelTransform=(0,s.create)(),e.inversePixelTransform=(0,s.create)(),e.context=null,e.containerReused=!1,e.pixelContext_=null,e.frameState=null,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getImageData",value:function(e,t,r){var n,i;v||((n=document.createElement("canvas")).width=1,n.height=1,v=n.getContext("2d")),v.clearRect(0,0,1,1);try{v.drawImage(e,t,r,1,1,0,0,1,1),i=v.getImageData(0,0,1,1).data}catch(e){return v=null}return i}},{key:"getBackground",value:function(e){var t=this.getLayer().getBackground();return(t="function"==typeof t?t(e.viewState.resolution):t)||void 0}},{key:"useContainer",value:function(e,t,r){var n,i,o=this.getLayer().getClassName();(n=e&&e.className===o&&(!r||e&&e.style.backgroundColor&&(0,c.equals)((0,u.asArray)(e.style.backgroundColor),(0,u.asArray)(r)))&&(i=e.firstElementChild)instanceof HTMLCanvasElement?i.getContext("2d"):n)&&n.canvas.style.transform===t?(this.container=e,this.context=n,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),this.container||((i=document.createElement("div")).className=o,(t=i.style).position="absolute",t.width="100%",t.height="100%",e=(n=(0,l.createCanvasContext2D)()).canvas,i.appendChild(e),(t=e.style).position="absolute",t.left="0",t.transformOrigin="top left",this.container=i,this.context=n),this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)}},{key:"clipUnrotated",value:function(e,t,r){var n=(0,f.getTopLeft)(r),i=(0,f.getTopRight)(r),o=(0,f.getBottomRight)(r),r=(0,f.getBottomLeft)(r),t=((0,s.apply)(t.coordinateToPixelTransform,n),(0,s.apply)(t.coordinateToPixelTransform,i),(0,s.apply)(t.coordinateToPixelTransform,o),(0,s.apply)(t.coordinateToPixelTransform,r),this.inversePixelTransform);(0,s.apply)(t,n),(0,s.apply)(t,i),(0,s.apply)(t,o),(0,s.apply)(t,r),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(r[0]),Math.round(r[1])),e.clip()}},{key:"dispatchRenderEvent_",value:function(e,t,r){var n=this.getLayer();n.hasListener(e)&&(e=new o.default(e,this.inversePixelTransform,r,t),n.dispatchEvent(e))}},{key:"preRender",value:function(e,t){this.frameState=t,this.dispatchRenderEvent_(a.default.PRERENDER,e,t)}},{key:"postRender",value:function(e,t){this.dispatchRenderEvent_(a.default.POSTRENDER,e,t)}},{key:"getRenderTransform",value:function(e,t,r,n,i,o,a){n/=t,t=-e[0]+a,a=-e[1];return(0,s.compose)(this.tempTransform,i/2,o/2,n,-n,-r,t,a)}},{key:"disposeInternal",value:function(){delete this.frameState,d(m(i.prototype),"disposeInternal",this).call(this)}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../../array.js":104,"../../color.js":107,"../../dom.js":123,"../../extent.js":131,"../../render/Event.js":281,"../../render/EventType.js":282,"../../transform.js":377,"../Layer.js":300}],304:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./Layer.js")),m=a(e("../../ImageTile.js")),v=a(e("../../reproj/Tile.js")),o=a(e("../../TileRange.js")),fe=a(e("../../TileState.js")),he=e("../../transform.js"),pe=e("../../extent.js"),de=e("../../proj.js"),ye=e("../../util.js"),ge=e("../../array.js"),b=e("../../size.js");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){if(this instanceof i)return(e=n.call(this,e)).extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=(0,pe.createEmpty)(),e.tmpTileRange_=new o.default(0,0,0,0),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"isDrawableTile",value:function(e){var t=this.getLayer(),e=e.getState(),t=t.getUseInterimTilesOnError();return e==fe.default.LOADED||e==fe.default.EMPTY||e==fe.default.ERROR&&!t}},{key:"getTile",value:function(e,t,r,n){var i=n.pixelRatio,n=n.viewState.projection,o=this.getLayer(),e=o.getSource().getTile(e,t,r,i,n);return e.getState()==fe.default.ERROR&&o.getUseInterimTilesOnError()&&0<o.getPreload()&&(this.newTiles_=!0),e=this.isDrawableTile(e)?e:e.getInterimTile()}},{key:"getData",value:function(e){var t=this.frameState;if(t){var r=this.getLayer(),n=(0,he.apply)(t.pixelToCoordinateTransform,e.slice()),e=r.getExtent();if(!e||(0,pe.containsCoordinate)(e,n))for(var i=t.pixelRatio,o=t.viewState.projection,a=t.viewState,s=r.getRenderSource(),u=s.getTileGridForProjection(a.projection),l=s.getTilePixelRatio(t.pixelRatio),c=u.getZForResolution(a.resolution);c>=u.getMinZoom();--c){var f,h,p,d,y=u.getTileCoordForCoordAndZ(n,c),g=s.getTile(c,y[1],y[2],i,o);if(!(g instanceof m.default||g instanceof v.default)||g instanceof v.default&&g.getState()===fe.default.EMPTY)return null;if(g.getState()===fe.default.LOADED)return p=u.getOrigin(c),f=(0,b.toSize)(u.getTileSize(c)),d=u.getResolution(c),h=Math.floor(l*((n[0]-p[0])/d-y[1]*f[0])),p=Math.floor(l*((p[1]-n[1])/d-y[2]*f[1])),d=Math.round(l*s.getGutterForProjection(a.projection)),this.getImageData(g.getImage(),h+d,p+d)}}return null}},{key:"loadedTileCallback",value:function(e,t,r){return!!this.isDrawableTile(r)&&u(f(i.prototype),"loadedTileCallback",this).call(this,e,t,r)}},{key:"prepareFrame",value:function(e){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(e,D){for(var t=e.layerStatesArray[e.layerIndex],r=e.viewState,n=r.projection,F=r.resolution,i=r.center,o=r.rotation,a=e.pixelRatio,N=this.getLayer(),s=N.getSource(),B=s.getRevision(),u=s.getTileGridForProjection(n),l=u.getZForResolution(F,s.zDirection),c=u.getResolution(l),f=e.extent,G=e.viewState.resolution,h=s.getTilePixelRatio(a),p=Math.round((0,pe.getWidth)(f)/G*a),d=Math.round((0,pe.getHeight)(f)/G*a),U=t.extent&&(0,de.fromUserExtent)(t.extent,n),y=(U&&(f=(0,pe.getIntersection)(f,(0,de.fromUserExtent)(t.extent,n))),c*p/2/h),z=c*d/2/h,g=[i[0]-y,i[1]-z,i[0]+y,i[1]+z],m=u.getTileRangeForExtentAndZ(f,l),v={},W=(v[l]={},this.createLoadedTileFinder(s,n,v)),V=this.tmpExtent,H=this.tmpTileRange_,q=(this.newTiles_=!1,o?(0,pe.getRotatedViewport)(r.center,G,o,e.size):void 0),b=m.minX;b<=m.maxX;++b)for(var _=m.minY;_<=m.maxY;++_)if(!o||u.tileCoordIntersectsViewport([l,b,_],q)){var w=this.getTile(l,b,_,e);if(this.isDrawableTile(w)){var x=(0,ye.getUid)(this);if(w.getState()==fe.default.LOADED&&((S=(v[l][w.tileCoord.toString()]=w).inTransition(x))&&1!==t.opacity&&(w.endTransition(x),S=!1),this.newTiles_||!S&&this.renderedTiles.includes(w)||(this.newTiles_=!0)),1===w.getAlpha(x,e.time))continue}var S=u.getTileCoordChildTileRange(w.tileCoord,H,V),x=!1;(x=S?W(l+1,S):x)||u.forEachTileCoordParentTileRange(w.tileCoord,W,H,V)}var j,Y,X=c/F*a/h,y=((0,he.compose)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,o,-p/2,-d/2),(0,he.toString)(this.pixelTransform)),O=(this.useContainer(D,y,this.getBackground(e)),this.context),i=O.canvas,P=((0,he.makeInverse)(this.inversePixelTransform,this.pixelTransform),(0,he.compose)(this.tempTransform,p/2,d/2,X,X,0,-p/2,-d/2),i.width!=p||i.height!=d?(i.width=p,i.height=d):this.containerReused||O.clearRect(0,0,p,d),U&&this.clipUnrotated(O,e,U),s.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e),this.renderedTiles.length=0,Object.keys(v).map(Number));P.sort(ge.numberSafeCompareFunction),1!==t.opacity||this.containerReused&&!s.getOpaque(e.viewState.projection)?(j=[],Y=[]):P=P.reverse();for(var Z=P.length-1;0<=Z;--Z){var K,k=P[Z],$=s.getTilePixelSize(k,a,n),J=u.getResolution(k)/c,Q=$[0]*J*X,ee=$[1]*J*X,te=u.getTileCoordForCoordAndZ((0,pe.getTopLeft)(g),k),$=u.getTileCoordExtent(te),re=(0,he.apply)(this.tempTransform,[h*($[0]-g[0])/c,h*(g[3]-$[3])/c]),ne=h*s.getGutterForProjection(n),ie=v[k];for(K in ie){var E=ie[K],T=E.tileCoord,oe=te[1]-T[1],ae=Math.round(re[0]-(oe-1)*Q),T=te[2]-T[2],se=Math.round(re[1]-(T-1)*ee),C=Math.round(re[0]-oe*Q),R=Math.round(re[1]-T*ee),M=ae-C,I=se-R,oe=l===k,T=oe&&1!==E.getAlpha((0,ye.getUid)(this),e.time),ue=!1;if(!T)if(j){for(var A,L=[C,R,C+M,R,C+M,R+I,C,R+I],le=0,ce=j.length;le<ce;++le)l!==k&&k<Y[le]&&(A=j[le],(0,pe.intersects)([C,R,C+M,R+I],[A[0],A[3],A[4],A[7]]))&&(ue||(O.save(),ue=!0),O.beginPath(),O.moveTo(L[0],L[1]),O.lineTo(L[2],L[3]),O.lineTo(L[4],L[5]),O.lineTo(L[6],L[7]),O.moveTo(A[6],A[7]),O.lineTo(A[4],A[5]),O.lineTo(A[2],A[3]),O.lineTo(A[0],A[1]),O.clip());j.push(L),Y.push(k)}else O.clearRect(C,R,M,I);this.drawTileImage(E,e,C,R,M,I,ne,oe),j&&!T?(ue&&O.restore(),this.renderedTiles.unshift(E)):this.renderedTiles.push(E),this.updateUsedTiles(e.usedTiles,s,E)}}return this.renderedRevision=B,this.renderedResolution=c,this.extentChanged=!this.renderedExtent_||!(0,pe.equals)(this.renderedExtent_,g),this.renderedExtent_=g,this.renderedPixelRatio=a,this.renderedProjection=n,this.manageTilePyramid(e,s,u,a,n,f,l,N.getPreload()),this.scheduleExpireCache(e,s),this.postRender(O,e),t.extent&&O.restore(),O.imageSmoothingEnabled=!0,y!==i.style.transform&&(i.style.transform=y),this.container}},{key:"drawTileImage",value:function(e,t,r,n,i,o,a,s){var u,l,c,f,h=this.getTileImage(e);h&&(u=(0,ye.getUid)(this),(f=(c=(l=t.layerStatesArray[t.layerIndex]).opacity*(s?e.getAlpha(u,t.time):1))!==this.context.globalAlpha)&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(h,a,a,h.width-2*a,h.height-2*a,r,n,i,o),f&&this.context.restore(),c!==l.opacity?t.animate=!0:s&&e.endTransition(u))}},{key:"getImage",value:function(){var e=this.context;return e?e.canvas:null}},{key:"getTileImage",value:function(e){return e.getImage()}},{key:"scheduleExpireCache",value:function(e,t){t.canExpireCache()&&(t=function(e,t,r){var n=(0,ye.getUid)(e);n in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[n])}.bind(null,t),e.postRenderFunctions.push(t))}},{key:"updateUsedTiles",value:function(e,t,r){t=(0,ye.getUid)(t);t in e||(e[t]={}),e[t][r.getKey()]=!0}},{key:"manageTilePyramid",value:function(e,t,r,n,i,o,a,s,u){for(var l,c,f,h,p,d=(0,ye.getUid)(t),y=(d in e.wantedTiles||(e.wantedTiles[d]={}),e.wantedTiles[d]),g=e.tileQueue,m=r.getMinZoom(),v=e.viewState.rotation,b=v?(0,pe.getRotatedViewport)(e.viewState.center,e.viewState.resolution,v,e.size):void 0,_=0,w=m;w<=a;++w)for(c=r.getTileRangeForExtentAndZ(o,w,c),f=r.getResolution(w),h=c.minX;h<=c.maxX;++h)for(p=c.minY;p<=c.maxY;++p)v&&!r.tileCoordIntersectsViewport([w,h,p],b)||(a-w<=s?(++_,(l=t.getTile(w,h,p,n,i)).getState()==fe.default.IDLE&&(y[l.getKey()]=!0,g.isKeyQueued(l.getKey())||g.enqueue([l,d,r.getTileCoordCenter(l.tileCoord),f])),void 0!==u&&u(l)):t.useTile(w,h,p,i));t.updateCacheSize(_,i)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../../ImageTile.js":81,"../../TileRange.js":97,"../../TileState.js":98,"../../array.js":104,"../../extent.js":131,"../../proj.js":271,"../../reproj/Tile.js":314,"../../size.js":319,"../../transform.js":377,"../../util.js":379,"./Layer.js":303}],305:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./ImageLayer.js")),a=o(e("./VectorLayer.js")),p=o(e("../../events/EventType.js")),d=o(e("../../ImageCanvas.js")),y=o(e("../../ImageState.js")),g=o(e("rbush")),m=o(e("../../ViewHint.js")),v=e("../../transform.js"),b=e("../../extent.js");function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(o);function o(e){var t;if(this instanceof o)return(t=n.call(this,e)).vectorRenderer_=new a.default(e),t.layerImageRatio_=e.getImageRatio(),t.coordinateToVectorPixelTransform_=(0,v.create)(),t.renderedPixelToCoordinateTransform_=null,t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"disposeInternal",value:function(){this.vectorRenderer_.dispose(),u(f(o.prototype),"disposeInternal",this).call(this)}},{key:"getFeatures",value:function(e){return this.vectorRenderer_?(e=(0,v.apply)(this.coordinateToVectorPixelTransform_,(0,v.apply)(this.renderedPixelToCoordinateTransform_,e.slice())),this.vectorRenderer_.getFeatures(e)):new Promise(function(e){return e([])})}},{key:"handleFontsChanged",value:function(){this.vectorRenderer_.handleFontsChanged()}},{key:"prepareFrame",value:function(e){var t,r,n,i,o=e.pixelRatio,a=e.viewState,s=a.resolution,u=e.viewHints,l=this.vectorRenderer_,c=e.extent,f=(1!==this.layerImageRatio_&&(c=c.slice(0),(0,b.scaleFromCenter)(c,this.layerImageRatio_)),(0,b.getWidth)(c)/s),h=(0,b.getHeight)(c)/s;return u[m.default.ANIMATING]||u[m.default.INTERACTING]||(0,b.isEmpty)(c)||(l.useContainer(null,null),u=l.context,t=e.layerStatesArray[e.layerIndex],u.globalAlpha=t.opacity,t=Object.assign({},t,{opacity:1}),r=Object.assign({},e,{declutterTree:new g.default(9),extent:c,size:[f,h],viewState:Object.assign({},e.viewState,{rotation:0}),layerStatesArray:[t],layerIndex:0}),n=!0,(i=new d.default(c,s,o,u.canvas,function(e){l.prepareFrame(r)&&l.replayGroupChanged&&(l.clipping=!1,l.renderFrame(r,null)&&(l.renderDeclutter(r),n=!1),e())})).addEventListener(p.default.CHANGE,function(){var e,t;i.getState()===y.default.LOADED&&(this.image_=n?null:i,t=i.getResolution(),e=i.getPixelRatio(),this.renderedResolution=t=t*o/e,this.coordinateToVectorPixelTransform_=(0,v.compose)(this.coordinateToVectorPixelTransform_,f/2,h/2,1/t,-1/t,0,-a.center[0],-a.center[1]))}.bind(this)),i.load()),this.image_&&(this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice()),!!this.image_}},{key:"preRender",value:function(){}},{key:"postRender",value:function(){}},{key:"renderDeclutter",value:function(){}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,r,n,i):u(f(o.prototype),"forEachFeatureAtCoordinate",this).call(this,e,t,r,n,i)}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"../../ImageCanvas.js":79,"../../ImageState.js":80,"../../ViewHint.js":102,"../../events/EventType.js":127,"../../extent.js":131,"../../transform.js":377,"./ImageLayer.js":302,"./VectorLayer.js":306,rbush:398}],306:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var T=n(e("../../render/canvas/BuilderGroup.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Layer.js")),C=n(e("../../render/canvas/ExecutorGroup.js")),R=n(e("../../ViewHint.js")),m=e("../../render/canvas/hitdetect.js"),v=e("../../transform.js"),M=e("../../extent.js"),s=e("../../dom.js"),I=e("../vector.js"),A=e("../../array.js"),L=e("../../proj.js"),p=e("../../util.js"),D=e("../../coordinate.js");function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(i);function i(e){if(this instanceof i)return(e=n.call(this,e)).boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(h(e)),e.animatingOrInteracting_,e.hitDetectionImageData_=null,e.renderedFeatures_=null,e.renderedRevision_=-1,e.renderedResolution_=NaN,e.renderedExtent_=(0,M.createEmpty)(),e.wrappedRenderedExtent_=(0,M.createEmpty)(),e.renderedRotation_,e.renderedCenter_=null,e.renderedProjection_=null,e.renderedRenderOrder_=null,e.replayGroup_=null,e.replayGroupChanged=!0,e.declutterExecutorGroup=null,e.clipping=!0,e.compositionContext_=null,e.opacity_=1,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"renderWorlds",value:function(e,t,r){var n=t.extent,i=t.viewState,o=i.center,a=i.resolution,s=i.projection,u=i.rotation,i=s.getExtent(),l=this.getLayer().getSource(),c=t.pixelRatio,f=t.viewHints,h=!(f[R.default.ANIMATING]||f[R.default.INTERACTING]),p=this.compositionContext_,d=Math.round(t.size[0]*c),y=Math.round(t.size[1]*c),f=l.getWrapX()&&s.canWrapX(),g=f?(0,M.getWidth)(i):null,m=f?Math.ceil((n[2]-i[2])/g)+1:1,v=f?Math.floor((n[0]-i[0])/g):0;do{var b=this.getRenderTransform(o,a,u,c,d,y,v*g)}while(e.execute(p,1,b,u,h,void 0,r),++v<m)}},{key:"setupCompositionContext_",value:function(){var e;1!==this.opacity_?(e=(0,s.createCanvasContext2D)(this.context.canvas.width,this.context.canvas.height,o.canvasPool),this.compositionContext_=e):this.compositionContext_=this.context}},{key:"releaseCompositionContext_",value:function(){var e;1!==this.opacity_&&(e=this.context.globalAlpha,this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=e,(0,s.releaseCanvas)(this.compositionContext_),o.canvasPool.push(this.compositionContext_.canvas),this.compositionContext_=null)}},{key:"renderDeclutter",value:function(e){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,e,e.declutterTree),this.releaseCompositionContext_())}},{key:"renderFrame",value:function(e,t){var r=e.pixelRatio,n=e.layerStatesArray[e.layerIndex],i=((0,v.makeScale)(this.pixelTransform,1/r,1/r),(0,v.makeInverse)(this.inversePixelTransform,this.pixelTransform),(0,v.toString)(this.pixelTransform)),t=(this.useContainer(t,i,this.getBackground(e)),this.context),o=t.canvas,a=this.replayGroup_,s=this.declutterExecutorGroup;return a&&!a.isEmpty()||s&&!s.isEmpty()?(s=Math.round(e.size[0]*r),r=Math.round(e.size[1]*r),o.width!=s||o.height!=r?(o.width=s,o.height=r,o.style.transform!==i&&(o.style.transform=i)):this.containerReused||t.clearRect(0,0,s,r),this.preRender(t,e),i=(o=e.viewState).projection,this.opacity_=n.opacity,this.setupCompositionContext_(),r=!(s=!1),n.extent&&this.clipping&&(n=(0,L.fromUserExtent)(n.extent,i),s=(r=(0,M.intersects)(n,e.extent))&&!(0,M.containsExtent)(n,e.extent))&&this.clipUnrotated(this.compositionContext_,e,n),r&&this.renderWorlds(a,e),s&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(t,e),this.renderedRotation_!==o.rotation&&(this.renderedRotation_=o.rotation,this.hitDetectionImageData_=null),this.container):null}},{key:"getFeatures",value:function(g){return new Promise(function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var t=[this.context.canvas.width,this.context.canvas.height],r=((0,v.apply)(this.pixelTransform,t),this.renderedCenter_),n=this.renderedResolution_,i=this.renderedRotation_,o=this.renderedProjection_,a=this.wrappedRenderedExtent_,s=this.getLayer(),u=[],l=t[0]*m.HIT_DETECT_RESOLUTION,c=t[1]*m.HIT_DETECT_RESOLUTION,f=(u.push(this.getRenderTransform(r,n,i,m.HIT_DETECT_RESOLUTION,l,c,0).slice()),s.getSource()),h=o.getExtent();if(f.getWrapX()&&o.canWrapX()&&!(0,M.containsExtent)(h,a)){for(var p=a[0],d=(0,M.getWidth)(h),y=0;p<h[0];)u.push(this.getRenderTransform(r,n,i,m.HIT_DETECT_RESOLUTION,l,c,d*--y).slice()),p+=d;for(y=0,p=a[2];p>h[2];)u.push(this.getRenderTransform(r,n,i,m.HIT_DETECT_RESOLUTION,l,c,d*++y).slice()),p-=d}this.hitDetectionImageData_=(0,m.createHitDetectionImageData)(t,u,this.renderedFeatures_,s.getStyleFunction(),a,n,i)}e((0,m.hitDetect)(g,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))}},{key:"forEachFeatureAtCoordinate",value:function(t,r,n,o,a){var i,s,u,l,c,f,e,h=this;if(this.replayGroup_)return i=r.viewState.resolution,s=r.viewState.rotation,u=this.getLayer(),l={},c=function(e,t,r){var n=(0,p.getUid)(e),i=l[n];if(i){if(!0!==i&&r<i.distanceSq){if(0===r)return l[n]=!0,a.splice(a.lastIndexOf(i),1),o(e,u,t);i.geometry=t,i.distanceSq=r}}else{if(0===r)return l[n]=!0,o(e,u,t);a.push(l[n]={feature:e,layer:u,geometry:t,distanceSq:r,callback:o})}},e=[this.replayGroup_],this.declutterExecutorGroup&&e.push(this.declutterExecutorGroup),e.some(function(e){return f=e.forEachFeatureAtCoordinate(t,i,s,n,c,e===h.declutterExecutorGroup&&r.declutterTree?r.declutterTree.all().map(function(e){return e.value}):null)}),f}},{key:"handleFontsChanged",value:function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}},{key:"handleStyleImageChange_",value:function(e){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(e){var n=this.getLayer(),t=n.getSource();if(!t)return!1;var r=e.viewHints[R.default.ANIMATING],i=e.viewHints[R.default.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&i)return this.animatingOrInteracting_=!0;this.animatingOrInteracting_=!1;var o=e.extent,r=e.viewState,s=r.projection,u=r.resolution,a=e.pixelRatio,i=n.getRevision(),l=n.getRenderBuffer(),c=n.getRenderOrder(),r=(void 0===c&&(c=I.defaultOrder),r.center.slice()),o=(0,M.buffer)(o,l*u),l=o.slice(),f=[o.slice()],h=s.getExtent();if(t.getWrapX()&&s.canWrapX()&&!(0,M.containsExtent)(h,e.extent)&&(e=(0,M.getWidth)(h),E=Math.max((0,M.getWidth)(o)/2,e),o[0]=h[0]-E,o[2]=h[2]+E,(0,D.wrapX)(r,s),(E=(0,M.wrapX)(f[0],s))[0]<h[0]&&E[2]<h[2]?f.push([E[0]+e,E[1],E[2]+e,E[3]]):E[0]>h[0]&&E[2]>h[2]&&f.push([E[0]-e,E[1],E[2]-e,E[3]])),this.ready&&this.renderedResolution_==u&&this.renderedRevision_==i&&this.renderedRenderOrder_==c&&(0,M.containsExtent)(this.wrappedRenderedExtent_,o))return(0,A.equals)(this.renderedExtent_,l)||(this.hitDetectionImageData_=null,this.renderedExtent_=l),this.renderedCenter_=r,!(this.replayGroupChanged=!1);this.replayGroup_=null;var p,d,y=new T.default((0,I.getTolerance)(u,a),o,u,a),g=(this.getLayer().getDeclutter()&&(p=new T.default((0,I.getTolerance)(u,a),o,u,a)),(0,L.getUserProjection)());if(g){for(var m=0,v=f.length;m<v;++m){var b=f[m],b=(0,L.toUserExtent)(b,s);t.loadFeatures(b,(0,L.toUserResolution)(u,s),g)}d=(0,L.getTransformFromProjections)(g,s)}else for(var _=0,w=f.length;_<w;++_)t.loadFeatures(f[_],u,s);var x=(0,I.getSquaredTolerance)(u,a),S=!0,j=function(e){var t,r=e.getStyleFunction()||n.getStyleFunction();(t=r?r(e,u):t)&&(r=this.renderFeature(e,x,t,y,d,p),S=S&&!r)}.bind(this),h=(0,L.toUserExtent)(o,s),O=t.getFeaturesInExtent(h);c&&O.sort(c);for(var P=0,k=O.length;P<k;++P)j(O[P]);this.renderedFeatures_=O,this.ready=S;var e=y.finish(),E=new C.default(o,u,a,t.getOverlaps(),e,n.getRenderBuffer());return p&&(this.declutterExecutorGroup=new C.default(o,u,a,t.getOverlaps(),p.finish(),n.getRenderBuffer())),this.renderedResolution_=u,this.renderedRevision_=i,this.renderedRenderOrder_=c,this.renderedExtent_=l,this.wrappedRenderedExtent_=o,this.renderedCenter_=r,this.renderedProjection_=s,this.replayGroup_=E,this.hitDetectionImageData_=null,this.replayGroupChanged=!0}},{key:"renderFeature",value:function(e,t,r,n,i,o){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var s=0,u=r.length;s<u;++s)a=(0,I.renderFeature)(n,e,r[s],t,this.boundHandleStyleImageChange_,i,o)||a;else a=(0,I.renderFeature)(n,e,r,t,this.boundHandleStyleImageChange_,i,o);return a}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../../ViewHint.js":102,"../../array.js":104,"../../coordinate.js":121,"../../dom.js":123,"../../extent.js":131,"../../proj.js":271,"../../render/canvas/BuilderGroup.js":287,"../../render/canvas/ExecutorGroup.js":289,"../../render/canvas/hitdetect.js":296,"../../transform.js":377,"../../util.js":379,"../vector.js":308,"./Layer.js":303}],307:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var k=o(e("../../render/canvas/BuilderGroup.js")),E=o(e("../../render/canvas/ExecutorGroup.js")),n=o(e("./TileLayer.js")),T=o(e("../../TileState.js")),C=o(e("../../ViewHint.js")),w=e("../../render/canvas/hitdetect.js"),x=e("../../transform.js"),R=e("../../extent.js"),M=e("../vector.js"),I=e("../../util.js"),S=e("../../size.js"),j=e("../../coordinate.js");function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function A(){return(A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=L(r),t=(e=n?(e=L(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},D={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},e=function(e){var t=P;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(P);function P(e){if(this instanceof P)return(e=n.call(this,e)).boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(l(e)),e.renderedLayerRevision_,e.renderedPixelToCoordinateTransform_=null,e.renderedRotation_,e.tmpTransform_=(0,x.create)(),e;throw new TypeError("Cannot call a class as a function")}return t=P,(e=[{key:"prepareTile",value:function(e,t,r){var n,i=e.getState();return i!==T.default.LOADED&&i!==T.default.ERROR||(this.updateExecutorGroup_(e,t,r),this.tileImageNeedsRender_(e)&&(n=!0)),n}},{key:"getTile",value:function(e,t,r,n){var i=n.pixelRatio,o=n.viewState,a=o.resolution,o=o.projection,s=this.getLayer(),u=s.getSource().getTile(e,t,r,i,o),l=n.viewHints,l=!(l[C.default.ANIMATING]||l[C.default.INTERACTING]);return!l&&u.wantedResolution||(u.wantedResolution=a),this.prepareTile(u,i,o)&&(l||Date.now()-n.time<8)&&"vector"!==s.getRenderMode()&&this.renderTileImage_(u,n),A(L(P.prototype),"getTile",this).call(this,e,t,r,n)}},{key:"isDrawableTile",value:function(e){var t=this.getLayer();return A(L(P.prototype),"isDrawableTile",this).call(this,e)&&("vector"===t.getRenderMode()?(0,I.getUid)(t)in e.executorGroups:e.hasContext(t))}},{key:"getTileImage",value:function(e){return e.getImage(this.getLayer())}},{key:"prepareFrame",value:function(e){var t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),A(L(P.prototype),"prepareFrame",this).call(this,e)}},{key:"updateExecutorGroup_",value:function(d,y,e){var g=this,m=this.getLayer(),t=m.getRevision(),v=m.getRenderOrder()||null,b=d.wantedResolution,_=d.getReplayState(m);if(_.dirty||_.renderedResolution!==b||_.renderedRevision!=t||_.renderedRenderOrder!=v){for(var w=m.getSource(),x=m.getDeclutter(),S=w.getTileGrid(),j=w.getTileGridForProjection(e).getTileCoordExtent(d.wrappedTileCoord),O=w.getSourceTiles(y,e,d),P=(0,I.getUid)(m),r=(delete d.hitDetectionImageData[P],d.executorGroups[P]=[],x&&(d.declutterExecutorGroups[P]=[]),_.dirty=!1,function(e,t){e=O[e];if(e.getState()!=T.default.LOADED)return"continue";function r(e){var t,r=e.getStyleFunction()||m.getStyleFunction();(t=r?r(e,b):t)&&(r=this.renderFeature(e,l,t,s,u),_.dirty=_.dirty||r)}var n=e.tileCoord,n=S.getTileCoordExtent(n),i=(0,R.getIntersection)(j,n),o=(0,R.buffer)(i,m.getRenderBuffer()*b,g.tmpExtent),a=(0,R.equals)(n,i)?null:o,s=new k.default(0,o,b,y),u=x?new k.default(0,i,b,y):void 0,l=(0,M.getSquaredTolerance)(b,y),c=e.getFeatures();v&&v!==_.renderedRenderOrder&&c.sort(v);for(var f=0,h=c.length;f<h;++f){var p=c[f];a&&!(0,R.intersects)(a,p.getGeometry().getExtent())||r.call(g,p)}n=s.finish(),o="vector"!==m.getRenderMode()&&x&&1===O.length?null:i,e=new E.default(o,b,y,w.getOverlaps(),n,m.getRenderBuffer());d.executorGroups[P].push(e),u&&(i=new E.default(null,b,y,w.getOverlaps(),u.finish(),m.getRenderBuffer()),d.declutterExecutorGroups[P].push(i))}),n=0,i=O.length;n<i;++n)r(n);_.renderedRevision=t,_.renderedRenderOrder=v,_.renderedResolution=b}}},{key:"forEachFeatureAtCoordinate",value:function(a,s,u,o,l){for(var c,f=s.viewState.resolution,h=s.viewState.rotation,p=(u=null==u?0:u,this.getLayer()),n=p.getSource().getTileGridForProjection(s.viewState.projection),i=(0,R.boundingExtent)([a]),d=((0,R.buffer)(i,f*u,i),{}),y=function(e,t,r){var n=e.getId(),i=(void 0===n&&(n=(0,I.getUid)(e)),d[n]);if(i){if(!0!==i&&r<i.distanceSq){if(0===r)return d[n]=!0,l.splice(l.lastIndexOf(i),1),o(e,p,t);i.geometry=t,i.distanceSq=r}}else{if(0===r)return d[n]=!0,o(e,p,t);l.push(d[n]={feature:e,layer:p,geometry:t,distanceSq:r,callback:o})}},g=this.renderedTiles,e=0,t=g.length;!c&&e<t;++e)!function(e){var e=g[e],t=n.getTileCoordExtent(e.wrappedTileCoord);if(!(0,R.intersects)(t,i))return;var t=(0,I.getUid)(p),r=[e.executorGroups[t]],o=e.declutterExecutorGroups[t];o&&r.push(o),r.some(function(e){for(var t=e===o?s.declutterTree.all().map(function(e){return e.value}):null,r=0,n=e.length;r<n;++r){var i=e[r];if(c=i.forEachFeatureAtCoordinate(a,f,h,u,y,t))return!0}})}(e);return c}},{key:"getFeatures",value:function(_){return new Promise(function(e,t){for(var r,n,i,o,a,s,u=this.getLayer(),l=(0,I.getUid)(u),c=u.getSource(),f=this.renderedProjection,h=f.getExtent(),p=this.renderedResolution,d=c.getTileGridForProjection(f),y=(0,x.apply)(this.renderedPixelToCoordinateTransform_,_.slice()),g=d.getTileCoordForCoordAndResolution(y,p),m=0,v=this.renderedTiles.length;m<v;++m)if(g.toString()===this.renderedTiles[m].tileCoord.toString()){if((r=this.renderedTiles[m]).getState()===T.default.LOADED){var b=d.getTileCoordExtent(r.tileCoord);c.getWrapX()&&f.canWrapX()&&!(0,R.containsExtent)(h,b)&&(0,j.wrapX)(y,f);break}r=void 0}!r||0<r.loadingSourceTiles?e([]):(n=d.getTileCoordExtent(r.wrappedTileCoord),n=(0,R.getTopLeft)(n),n=[(y[0]-n[0])/p,(n[1]-y[1])/p],i=r.getSourceTiles().reduce(function(e,t){return e.concat(t.getFeatures())},[]),(s=r.hitDetectionImageData[l])||this.animatingOrInteracting_||(o=(0,S.toSize)(d.getTileSize(d.getZForResolution(p,c.zDirection))),a=this.renderedRotation_,p=[this.getRenderTransform(d.getTileCoordCenter(r.wrappedTileCoord),p,0,w.HIT_DETECT_RESOLUTION,o[0]*w.HIT_DETECT_RESOLUTION,o[1]*w.HIT_DETECT_RESOLUTION,0)],s=(0,w.createHitDetectionImageData)(o,p,i,u.getStyleFunction(),d.getTileCoordExtent(r.wrappedTileCoord),r.getReplayState(u).renderedResolution,a),r.hitDetectionImageData[l]=s),e((0,w.hitDetect)(n,i,s)))}.bind(this))}},{key:"handleFontsChanged",value:function(){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()}},{key:"handleStyleImageChange_",value:function(e){this.renderIfReadyAndVisible()}},{key:"renderDeclutter",value:function(e){for(var t=this.context,r=t.globalAlpha,n=(t.globalAlpha=this.getLayer().getOpacity(),e.viewHints),i=!(n[C.default.ANIMATING]||n[C.default.INTERACTING]),o=this.renderedTiles,a=0,s=o.length;a<s;++a){var u=o[a],l=u.declutterExecutorGroups[(0,I.getUid)(this.getLayer())];if(l)for(var c=l.length-1;0<=c;--c)l[c].execute(this.context,1,this.getTileRenderTransform(u,e),e.viewState.rotation,i,void 0,e.declutterTree)}t.globalAlpha=r}},{key:"getTileRenderTransform",value:function(e,t){var r=t.pixelRatio,n=t.viewState,i=n.center,o=n.resolution,n=n.rotation,a=t.size,s=Math.round(a[0]*r),a=Math.round(a[1]*r),t=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),u=e.tileCoord,e=t.getTileCoordExtent(e.wrappedTileCoord),t=t.getTileCoordExtent(u,this.tmpExtent)[0]-e[0];return(0,x.multiply)((0,x.scale)(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(i,o,n,r,s,a,t))}},{key:"postRender",value:function(e,t){for(var r=t.viewHints,n=!(r[C.default.ANIMATING]||r[C.default.INTERACTING]),i=(this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.getLayer()),r=i.getRenderMode(),o=e.globalAlpha,a=(e.globalAlpha=i.getOpacity(),D[r]),r=t.viewState,s=r.rotation,u=i.getSource(),l=u.getTileGridForProjection(r.projection).getZForResolution(r.resolution,u.zDirection),c=this.renderedTiles,f=[],h=[],p=!0,d=c.length-1;0<=d;--d){var y=c[d],p=p&&!y.getReplayState(i).dirty,g=y.executorGroups[(0,I.getUid)(i)].filter(function(e){return e.hasExecutors(a)});if(0!==g.length){var m=this.getTileRenderTransform(y,t),v=y.tileCoord[0],b=!1,_=g[0].getClipCoords(m);if(_){for(var w,x=0,S=f.length;x<S;++x)l!==v&&v<h[x]&&(w=f[x],(0,R.intersects)([_[0],_[3],_[4],_[7]],[w[0],w[3],w[4],w[7]]))&&(b||(e.save(),b=!0),e.beginPath(),e.moveTo(_[0],_[1]),e.lineTo(_[2],_[3]),e.lineTo(_[4],_[5]),e.lineTo(_[6],_[7]),e.moveTo(w[6],w[7]),e.lineTo(w[4],w[5]),e.lineTo(w[2],w[3]),e.lineTo(w[0],w[1]),e.clip());f.push(_),h.push(v)}for(var j=0,O=g.length;j<O;++j)g[j].execute(e,1,m,s,n,a);b&&e.restore()}}e.globalAlpha=o,this.ready=p,A(L(P.prototype),"postRender",this).call(this,e,t)}},{key:"renderFeature",value:function(e,t,r,n,i){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var a=0,s=r.length;a<s;++a)o=(0,M.renderFeature)(n,e,r[a],t,this.boundHandleStyleImageChange_,void 0,i)||o;else o=(0,M.renderFeature)(n,e,r,t,this.boundHandleStyleImageChange_,void 0,i);return o}},{key:"tileImageNeedsRender_",value:function(e){var t,r=this.getLayer();return"vector"!==r.getRenderMode()&&(t=e.getReplayState(r),r=r.getRevision(),e=e.wantedResolution,t.renderedTileResolution!==e||t.renderedTileRevision!==r)}},{key:"renderTileImage_",value:function(e,t){var r=this.getLayer(),n=e.getReplayState(r),i=r.getRevision(),o=e.executorGroups[(0,I.getUid)(r)],i=(n.renderedTileRevision=i,e.wrappedTileCoord),a=i[0],s=r.getSource(),u=t.pixelRatio,l=t.viewState.projection,c=s.getTileGridForProjection(l),f=c.getResolution(e.tileCoord[0]),t=t.pixelRatio/e.wantedResolution*f,f=c.getResolution(a),h=e.getContext(r),u=Math.round(Math.max(u,t/u)),s=s.getTilePixelSize(a,u,l),p=(h.canvas.width=s[0],h.canvas.height=s[1],u/t),l=(1!=p&&(a=(0,x.reset)(this.tmpTransform_),(0,x.scale)(a,p,p),h.setTransform.apply(h,a)),c.getTileCoordExtent(i,this.tmpExtent)),s=t/f,d=(0,x.reset)(this.tmpTransform_);(0,x.scale)(d,s,-s),(0,x.translate)(d,-l[0],-l[3]);for(var y=0,g=o.length;y<g;++y)o[y].execute(h,p,d,0,!0,m[r.getRenderMode()]);n.renderedTileResolution=e.wantedResolution}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),P}(n.default);r.default=e},{"../../TileState.js":98,"../../ViewHint.js":102,"../../coordinate.js":121,"../../extent.js":131,"../../render/canvas/BuilderGroup.js":287,"../../render/canvas/ExecutorGroup.js":289,"../../render/canvas/hitdetect.js":296,"../../size.js":319,"../../transform.js":377,"../../util.js":379,"../vector.js":308,"./TileLayer.js":304}],308:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultOrder=function(e,t){return parseInt((0,n.getUid)(e),10)-parseInt((0,n.getUid)(t),10)},r.getSquaredTolerance=function(e,t){e=i*e/t;return e*e},r.getTolerance=o,r.renderFeature=function(e,t,r,n,i,o,a){var s=!1,u=r.getImage();{var l;u&&((l=u.getImageState())==c.default.LOADED||l==c.default.ERROR?u.unlistenImageChange(i):(l==c.default.IDLE&&u.load(),u.listenImageChange(i),s=!0))}return function(e,t,r,n,i,o){var a=r.getGeometryFunction()(t);a&&(a=a.simplifyTransformed(n,i),r.getRenderer()?function e(t,r,n,i){if("GeometryCollection"==r.getType()){for(var o=r.getGeometries(),a=0,s=o.length;a<s;++a)e(t,o[a],n,i);return}var u=t.getBuilder(n.getZIndex(),"Default");u.drawCustom(r,i,n.getRenderer(),n.getHitDetectionRenderer())}(e,a,r,t):(0,f[a.getType()])(e,a,r,t,o))}(e,t,r,n,o,a),s};var c=(r=e("../ImageState.js"))&&r.__esModule?r:{default:r},n=e("../util.js");var i=.5,f={Point:function(e,t,r,n,i){var o,a=r.getImage(),s=r.getText();if(a){if(a.getImageState()!=c.default.LOADED)return;var u=e,l=(i&&"none"!==(l=a.getDeclutterMode())&&(u=i,"obstacle"===l?((l=e.getBuilder(r.getZIndex(),"Image")).setImageStyle(a,o),l.drawPoint(t,n)):s&&s.getText()&&(o={})),u.getBuilder(r.getZIndex(),"Image"));l.setImageStyle(a,o),l.drawPoint(t,n)}s&&s.getText()&&(u=e,(a=(u=i?i:u).getBuilder(r.getZIndex(),"Text")).setTextStyle(s,o),a.drawText(t,n))},LineString:function(e,t,r,n,i){var o=r.getStroke();o&&((a=e.getBuilder(r.getZIndex(),"LineString")).setFillStrokeStyle(null,o),a.drawLineString(t,n));o=r.getText();{var a;o&&o.getText()&&((a=(i||e).getBuilder(r.getZIndex(),"Text")).setTextStyle(o),a.drawText(t,n))}},Polygon:function(e,t,r,n,i){var o=r.getFill(),a=r.getStroke();{var s;(o||a)&&((s=e.getBuilder(r.getZIndex(),"Polygon")).setFillStrokeStyle(o,a),s.drawPolygon(t,n))}o=r.getText();o&&o.getText()&&((a=(i||e).getBuilder(r.getZIndex(),"Text")).setTextStyle(o),a.drawText(t,n))},MultiPoint:function(e,t,r,n,i){var o,a=r.getImage(),s=r.getText();if(a){if(a.getImageState()!=c.default.LOADED)return;var u=e,l=(i&&"none"!==(l=a.getDeclutterMode())&&(u=i,"obstacle"===l?((l=e.getBuilder(r.getZIndex(),"Image")).setImageStyle(a,o),l.drawMultiPoint(t,n)):s&&s.getText()&&(o={})),u.getBuilder(r.getZIndex(),"Image"));l.setImageStyle(a,o),l.drawMultiPoint(t,n)}s&&s.getText()&&(u=e,(a=(u=i?i:u).getBuilder(r.getZIndex(),"Text")).setTextStyle(s,o),a.drawText(t,n))},MultiLineString:function(e,t,r,n,i){var o=r.getStroke();o&&((a=e.getBuilder(r.getZIndex(),"LineString")).setFillStrokeStyle(null,o),a.drawMultiLineString(t,n));o=r.getText();{var a;o&&o.getText()&&((a=(i||e).getBuilder(r.getZIndex(),"Text")).setTextStyle(o),a.drawText(t,n))}},MultiPolygon:function(e,t,r,n,i){var o=r.getFill(),a=r.getStroke();{var s;(a||o)&&((s=e.getBuilder(r.getZIndex(),"Polygon")).setFillStrokeStyle(o,a),s.drawMultiPolygon(t,n))}o=r.getText();o&&o.getText()&&((a=(i||e).getBuilder(r.getZIndex(),"Text")).setTextStyle(o),a.drawText(t,n))},GeometryCollection:function(e,t,r,n,i){var o,a,s=t.getGeometriesArray();for(o=0,a=s.length;o<a;++o)(0,f[s[o].getType()])(e,s[o],r,n,i)},Circle:function(e,t,r,n,i){var o=r.getFill(),a=r.getStroke();{var s;(o||a)&&((s=e.getBuilder(r.getZIndex(),"Circle")).setFillStrokeStyle(o,a),s.drawCircle(t,n))}o=r.getText();o&&o.getText()&&((a=(i||e).getBuilder(r.getZIndex(),"Text")).setTextStyle(o),a.drawText(t,n))}};function o(e,t){return i*e/t}},{"../ImageState.js":80,"../util.js":379}],309:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=l(e("../../layer/Property.js")),n=l(e("../Layer.js")),a=l(e("../../render/Event.js")),s=l(e("../../render/EventType.js")),c=l(e("../../webgl/Helper.js")),u=e("../../transform.js");function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(l);function l(e,t){var r;if(this instanceof l)return t=t||{},(r=n.call(this,e)).inversePixelTransform_=(0,u.create)(),r.pixelContext_=null,r.postProcesses_=t.postProcesses,r.uniforms_=t.uniforms,r.helper,e.addChangeListener(o.default.MAP,r.removeHelper.bind(y(r))),r.dispatchPreComposeEvent=r.dispatchPreComposeEvent.bind(y(r)),r.dispatchPostComposeEvent=r.dispatchPostComposeEvent.bind(y(r)),r;throw new TypeError("Cannot call a class as a function")}return t=l,(e=[{key:"dispatchPreComposeEvent",value:function(e,t){var r=this.getLayer();r.hasListener(s.default.PRECOMPOSE)&&(t=new a.default(s.default.PRECOMPOSE,void 0,t,e),r.dispatchEvent(t))}},{key:"dispatchPostComposeEvent",value:function(e,t){var r=this.getLayer();r.hasListener(s.default.POSTCOMPOSE)&&(t=new a.default(s.default.POSTCOMPOSE,void 0,t,e),r.dispatchEvent(t))}},{key:"reset",value:function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}},{key:"removeHelper",value:function(){this.helper&&(this.helper.dispose(),delete this.helper)}},{key:"prepareFrame",value:function(e){if(this.getLayer().getRenderSource()){for(var t,r=!0,n=-1,i=0,o=e.layerStatesArray.length;i<o;i++){var a=e.layerStatesArray[i].layer,s=a.getRenderer();if(s instanceof l){a=a.getClassName();if(!r&&a===t||(n+=1,r=!1),t=a,s===this)break}else r=!0}var u="map/"+e.mapId+"/group/"+n;this.helper&&this.helper.canvasCacheKeyMatches(u)||(this.removeHelper(),this.helper=new c.default({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:u}),t&&(this.helper.getCanvas().className=t),this.afterHelperCreated())}return this.prepareFrameInternal(e)}},{key:"afterHelperCreated",value:function(){}},{key:"prepareFrameInternal",value:function(e){return!0}},{key:"disposeInternal",value:function(){this.removeHelper(),h(g(l.prototype),"disposeInternal",this).call(this)}},{key:"dispatchRenderEvent_",value:function(e,t,r){var n=this.getLayer();n.hasListener(e)&&((0,u.compose)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]),e=new a.default(e,this.inversePixelTransform_,r,t),n.dispatchEvent(e))}},{key:"preRender",value:function(e,t){this.dispatchRenderEvent_(s.default.PRERENDER,e,t)}},{key:"postRender",value:function(e,t){this.dispatchRenderEvent_(s.default.POSTRENDER,e,t)}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.default);r.default=e},{"../../layer/Property.js":258,"../../render/Event.js":281,"../../render/EventType.js":282,"../../transform.js":377,"../../webgl/Helper.js":384,"../Layer.js":300}],310:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("../../layer/BaseVector.js")),a=o(e("../../source/VectorEventType.js")),u=o(e("../../ViewHint.js")),l=o(e("../../webgl/Buffer.js")),n=o(e("./Layer.js")),c=o(e("../../webgl/RenderTarget.js")),f=e("../../webgl.js"),h=e("../../webgl/Helper.js"),p=e("../../render/webgl/constants.js"),d=e("../../transform.js"),y=e("../../asserts.js"),g=e("../../extent.js"),m=e("../../render/webgl/utils.js"),v=e("../../worker/webgl.js"),b=e("../../util.js"),_=e("../../events.js");function o(e){return e&&e.__esModule?e:{default:e}}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function x(){return(x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=P(r),t=(e=n?(e=P(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e);var r,i=j(o);function o(e,t){var r,n;if(this instanceof o)return n=t.uniforms||{},r=(0,d.create)(),n[h.DefaultUniform.PROJECTION_MATRIX]=r,(e=i.call(this,e,{uniforms:n,postProcesses:t.postProcesses})).ready=!1,e.sourceRevision_=-1,e.verticesBuffer_=new l.default(f.ARRAY_BUFFER,f.DYNAMIC_DRAW),e.hitVerticesBuffer_=new l.default(f.ARRAY_BUFFER,f.DYNAMIC_DRAW),e.indicesBuffer_=new l.default(f.ELEMENT_ARRAY_BUFFER,f.DYNAMIC_DRAW),e.vertexShader_=t.vertexShader,e.fragmentShader_=t.fragmentShader,e.program_,e.hitDetectionEnabled_=!(!t.hitFragmentShader||!t.hitVertexShader),e.hitVertexShader_=t.hitVertexShader,e.hitFragmentShader_=t.hitFragmentShader,e.hitProgram_,n=t.attributes?t.attributes.map(function(e){return{name:"a_"+e.name,size:1,type:h.AttributeType.FLOAT}}):[],e.attributes=[{name:"a_position",size:2,type:h.AttributeType.FLOAT},{name:"a_index",size:1,type:h.AttributeType.FLOAT}].concat(n),e.hitDetectionAttributes=[{name:"a_position",size:2,type:h.AttributeType.FLOAT},{name:"a_index",size:1,type:h.AttributeType.FLOAT},{name:"a_hitColor",size:4,type:h.AttributeType.FLOAT},{name:"a_featureUid",size:1,type:h.AttributeType.FLOAT}].concat(n),e.customAttributes=t.attributes||[],e.previousExtent_=(0,g.createEmpty)(),e.currentTransform_=r,e.renderTransform_=(0,d.create)(),e.invertRenderTransform_=(0,d.create)(),e.renderInstructions_=new Float32Array(0),e.hitRenderInstructions_=new Float32Array(0),e.hitRenderTarget_,e.generateBuffersRun_=0,e.worker_=(0,v.create)(),e.worker_.addEventListener("message",function(e){var t,r=e.data;r.type===p.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS&&(t=r.projectionTransform,r.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(r.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(r.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(r.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=t,(0,d.makeInverse)(this.invertRenderTransform_,this.renderTransform_),r.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):(this.renderInstructions_=new Float32Array(e.data.renderInstructions),r.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed())}.bind(O(e))),e.featureCache_={},e.featureCount_=0,n=e.getLayer().getSource(),e.sourceListenKeys_=[(0,_.listen)(n,a.default.ADDFEATURE,e.handleSourceFeatureAdded_,O(e)),(0,_.listen)(n,a.default.CHANGEFEATURE,e.handleSourceFeatureChanged_,O(e)),(0,_.listen)(n,a.default.REMOVEFEATURE,e.handleSourceFeatureDelete_,O(e)),(0,_.listen)(n,a.default.CLEAR,e.handleSourceFeatureClear_,O(e))],n.forEachFeature(function(e){this.featureCache_[(0,b.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(O(e))),e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"afterHelperCreated",value:function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new c.default(this.helper))}},{key:"handleSourceFeatureAdded_",value:function(e){e=e.feature;this.featureCache_[(0,b.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}},{key:"handleSourceFeatureChanged_",value:function(e){e=e.feature;this.featureCache_[(0,b.getUid)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}}},{key:"handleSourceFeatureDelete_",value:function(e){e=e.feature;delete this.featureCache_[(0,b.getUid)(e)],this.featureCount_--}},{key:"handleSourceFeatureClear_",value:function(){this.featureCache_={},this.featureCount_=0}},{key:"renderFrame",value:function(e){for(var t=this.helper.getGL(),r=(this.preRender(t,e),e.viewState.projection),n=this.getLayer().getSource().getWrapX()&&r.canWrapX(),r=r.getExtent(),i=e.extent,o=n?(0,g.getWidth)(r):null,a=n?Math.ceil((i[2]-r[2])/o)+1:1,n=n?Math.floor((i[0]-r[0])/o):0,s=n,u=this.indicesBuffer_.getSize();this.helper.makeProjectionTransform(e,this.currentTransform_),(0,d.translate)(this.currentTransform_,s*o,0),(0,d.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.drawElements(0,u),++s<a;);this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);i=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(e,n,a,o),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),i}},{key:"prepareFrameInternal",value:function(e){var t=this.getLayer(),r=t.getSource(),n=e.viewState,i=!e.viewHints[u.default.ANIMATING]&&!e.viewHints[u.default.INTERACTING],o=!(0,g.equals)(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();return a&&(this.sourceRevision_=r.getRevision()),i&&(o||a)&&(i=n.projection,o=n.resolution,a=t instanceof s.default?t.getRenderBuffer():0,n=(0,g.buffer)(e.extent,a*o),r.loadFeatures(n,o,i),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()),this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}},{key:"rebuildBuffers_",value:function(e){var t,r,n,i=(0,d.create)(),e=(this.helper.makeProjectionTransform(e,i),(2+this.customAttributes.length)*this.featureCount_),o=(this.renderInstructions_&&this.renderInstructions_.length===e||(this.renderInstructions_=new Float32Array(e)),this.hitDetectionEnabled_&&(e=(7+this.customAttributes.length)*this.featureCount_,this.hitRenderInstructions_&&this.hitRenderInstructions_.length===e||(this.hitRenderInstructions_=new Float32Array(e))),[]),a=[],s=0,u=0;for(n in this.featureCache_)if((r=(t=this.featureCache_[n]).geometry)&&"Point"===r.getType()){o[0]=r.getFlatCoordinates()[0],o[1]=r.getFlatCoordinates()[1],(0,d.apply)(i,o),r=(0,m.colorEncodeId)(u+6,a),this.renderInstructions_[s++]=o[0],this.renderInstructions_[s++]=o[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=o[0],this.hitRenderInstructions_[u++]=o[1],this.hitRenderInstructions_[u++]=r[0],this.hitRenderInstructions_[u++]=r[1],this.hitRenderInstructions_[u++]=r[2],this.hitRenderInstructions_[u++]=r[3],this.hitRenderInstructions_[u++]=Number(n));for(var l,c=0;c<this.customAttributes.length;c++)l=this.customAttributes[c].callback(t.feature,t.properties),this.renderInstructions_[s++]=l,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=l)}e={id:0,type:p.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};e.projectionTransform=i,e.generateBuffersRun=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(e,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_&&((e={id:0,type:p.WebGLWorkerMessageType.GENERATE_POINT_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length}).projectionTransform=i,e.hitDetection=!0,this.worker_.postMessage(e,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null)}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i){if((0,y.assert)(this.hitDetectionEnabled_,66),this.hitRenderInstructions_)return t=(0,d.apply)(t.coordinateToPixelTransform,e.slice()),t=[(e=this.hitRenderTarget_.readPixel(t[0]/2,t[1]/2))[0]/255,e[1]/255,e[2]/255,e[3]/255],e=(0,m.colorDecodeId)(t),t=this.hitRenderInstructions_[e],e=Math.floor(t).toString(),(t=this.getLayer().getSource().getFeatureByUid(e))?n(t,this.getLayer(),null):void 0}},{key:"renderHitDetection",value:function(e,t,r,n){if(this.hitVerticesBuffer_.getSize()){var i=t;this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_,e),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,d.translate)(this.currentTransform_,i*n,0),(0,d.multiply)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e);var o=this.indicesBuffer_.getSize()}while(this.helper.drawElements(0,o),++i<r)}}},{key:"disposeInternal",value:function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){(0,_.unlistenByKey)(e)}),this.sourceListenKeys_=null,x(P(o.prototype),"disposeInternal",this).call(this)}}])&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"../../ViewHint.js":102,"../../asserts.js":105,"../../events.js":125,"../../extent.js":131,"../../layer/BaseVector.js":251,"../../render/webgl/constants.js":297,"../../render/webgl/utils.js":298,"../../source/VectorEventType.js":347,"../../transform.js":377,"../../util.js":379,"../../webgl.js":381,"../../webgl/Buffer.js":382,"../../webgl/Helper.js":384,"../../webgl/RenderTarget.js":387,"../../worker/webgl.js":390,"./Layer.js":309}],311:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Uniforms=r.Attributes=void 0;var o=c(e("../../structs/LRUCache.js")),re=c(e("../../reproj/Tile.js")),a=c(e("../../TileRange.js")),ne=c(e("../../TileState.js")),O=c(e("../../webgl/TileTexture.js")),s=c(e("../../webgl/Buffer.js")),n=c(e("./Layer.js")),u=e("../../webgl/Helper.js"),l=e("../../webgl.js"),ie=e("../../transform.js"),oe=e("../../extent.js"),ae=e("../../vec/mat4.js"),se=e("../../tilecoord.js"),v=e("../../proj.js"),ue=e("../../util.js"),le=e("../../array.js"),ce=e("../../size.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},e=(r.Uniforms=fe,{TEXTURE_COORD:"a_textureCoord"}),he=[{name:(r.Attributes=e).TEXTURE_COORD,size:2,type:u.AttributeType.FLOAT}],pe={};function P(e,t,r){r in e||(e[r]=[]),e[r].push(t)}function de(e,t){var r=e.layerStatesArray[e.layerIndex],r=(r.extent&&(t=(0,oe.getIntersection)(t,(0,v.fromUserExtent)(r.extent,e.viewState.projection))),r.layer.getRenderSource());return r.getWrapX()||(r=r.getTileGridForProjection(e.viewState.projection).getExtent())&&(t=(0,oe.getIntersection)(t,r)),t}function k(e,t){return"".concat(e.getKey(),",").concat((0,se.getKey)(t))}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e,t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(e=n.call(this,e,{uniforms:t.uniforms})).renderComplete=!1,e.tileTransform_=(0,ie.create)(),e.tempMat4_=(0,ae.create)(),e.tempTileRange_=new a.default(0,0,0,0),e.tempTileCoord_=(0,se.createOrUpdate)(0,0,0),e.tempSize_=[0,0],e.program_,e.vertexShader_=t.vertexShader,e.fragmentShader_=t.fragmentShader,e.indices_=new s.default(l.ELEMENT_ARRAY_BUFFER,l.STATIC_DRAW),e.indices_.fromArray([0,1,3,1,2,3]);var r=void 0!==t.cacheSize?t.cacheSize:512;return e.tileTextureCache_=new o.default(r),e.paletteTextures_=t.paletteTextures||[],e.frameState_=null,e.projection_=void 0,e}return t=i,(e=[{key:"reset",value:function(e){h(y(i.prototype),"reset",this).call(this,{uniforms:e.uniforms}),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}},{key:"afterHelperCreated",value:function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}},{key:"isDrawableTile_",value:function(e){var t=this.getLayer(),e=e.getState(),t=t.getUseInterimTilesOnError();return e==ne.default.LOADED||e==ne.default.EMPTY||e==ne.default.ERROR&&!t}},{key:"prepareFrameInternal",value:function(e){this.projection_?e.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=e.viewState.projection):this.projection_=e.viewState.projection;var t=this.getLayer().getRenderSource();return!!t&&!(0,oe.isEmpty)(de(e,e.extent))&&"ready"===t.getState()}},{key:"enqueueTiles",value:function(e,t,r,n,i){for(var o=e.viewState,a=this.getLayer(),s=a.getRenderSource(),u=s.getTileGridForProjection(o.projection),l=s.getGutterForProjection(o.projection),c=(0,ue.getUid)(s),f=(c in e.wantedTiles||(e.wantedTiles[c]={}),e.wantedTiles[c]),h=this.tileTextureCache_,p=a.getMapInternal(),d=Math.max(r-i,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),p?p.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),s.zDirection)),y=r;d<=y;--y)for(var g=u.getTileRangeForExtentAndZ(t,y,this.tempTileRange_),m=u.getResolution(y),v=g.minX;v<=g.maxX;++v)for(var b=g.minY;b<=g.maxY;++b){var _=(0,se.createOrUpdate)(y,v,b,this.tempTileCoord_),w=k(s,_),x=void 0,S=void 0,j=(h.containsKey(w)&&(S=(x=h.get(w)).tile),x&&x.tile.key===s.getKey()||(S=s.getTile(y,v,b,e.pixelRatio,o.projection),x?this.isDrawableTile_(S)?x.setTile(S):(j=S.getInterimTile(),x.setTile(j)):(x=new O.default({tile:S,grid:u,helper:this.helper,gutter:l}),h.set(w,x))),P(n,x,y),S.getKey());f[j]=!0,S.getState()!==ne.default.IDLE||e.tileQueue.isKeyQueued(j)||e.tileQueue.enqueue([S,c,u.getTileCoordCenter(_),m])}}},{key:"renderFrame",value:function(e){for(var D=this,t=(this.frameState_=e,this.renderComplete=!0,this.helper.getGL()),r=(this.preRender(t,e),e.viewState),n=this.getLayer(),i=n.getRenderSource(),o=i.getTileGridForProjection(r.projection),a=i.getGutterForProjection(r.projection),s=de(e,e.extent),u=o.getZForResolution(r.resolution,i.zDirection),l={},c=n.getPreload(),f=(e.nextExtent&&(n=o.getZForResolution(r.nextResolution,i.zDirection),L=de(e,e.nextExtent),this.enqueueTiles(e,L,n,l,c)),this.enqueueTiles(e,s,u,l,0),0<c&&setTimeout(function(){D.enqueueTiles(e,s,u-1,l,c-1)},0),{}),h=(0,ue.getUid)(this),F=e.time,p=!1,d=l[u],y=0,N=d.length;y<N;++y){var g=d[y],m=g.tile;if(!(m instanceof re.default&&m.getState()===ne.default.EMPTY)){var v=m.tileCoord;if(g.loaded){g=m.getAlpha(h,F);if(1===g){m.endTransition(h);continue}p=!0;f[(0,se.getKey)(v)]=g}this.renderComplete=!1;m=this.findAltTiles_(o,v,u+1,l);if(!m)for(var B=o.getMinZoom(),b=u-1;B<=b;--b)if(this.findAltTiles_(o,v,b,l))break}}this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e,!p);for(var _=Object.keys(l).map(Number).sort(le.numberSafeCompareFunction),G=r.center[0],U=r.center[1],w=0,z=_.length;w<z;++w)for(var x=_[w],S=o.getResolution(x),j=(0,ce.toSize)(o.getTileSize(x),this.tempSize_),O=o.getOrigin(x),P=j[0]+2*a,k=j[1]+2*a,W=P/k,V=(G-O[0])/(j[0]*S),H=(O[1]-U)/(j[1]*S),E=r.resolution/S,q=2*(1-1/(x+1))-1,Y=l[x],T=0,X=Y.length;T<X;++T){var C=Y[T];if(C.loaded){for(var R=C.tile.tileCoord,M=(0,se.getKey)(R),Z=R[1],K=R[2],I=((0,ie.reset)(this.tileTransform_),(0,ie.scale)(this.tileTransform_,2/(e.size[0]*E/P),-2/(e.size[1]*E/P)),(0,ie.rotate)(this.tileTransform_,r.rotation),(0,ie.scale)(this.tileTransform_,1,1/W),(0,ie.translate)(this.tileTransform_,(j[0]*(Z-V)-a)/P,(j[1]*(K-H)-a)/k),this.helper.setUniformMatrixValue(fe.TILE_TRANSFORM,(0,ae.fromTransform)(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(C.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(he),0);I<C.textures.length;){var $="TEXTURE"+I,J="".concat(fe.TILE_TEXTURE_ARRAY,"[").concat(I,"]");t.activeTexture(t[$]),t.bindTexture(t.TEXTURE_2D,C.textures[I]),t.uniform1i(this.helper.getUniformLocation(J),I),++I}for(var A=0;A<this.paletteTextures_.length;++A){var Q=this.paletteTextures_[A],ee=(t.activeTexture(t["TEXTURE"+I]),Q.getTexture(t));t.bindTexture(t.TEXTURE_2D,ee),t.uniform1i(this.helper.getUniformLocation(Q.name),I),++I}M=M in f?f[M]:1,M=(M<1&&(e.animate=!0),this.helper.setUniformFloatValue(fe.TRANSITION_ALPHA,M),this.helper.setUniformFloatValue(fe.DEPTH,q),this.helper.setUniformFloatValue(fe.TEXTURE_PIXEL_WIDTH,P),this.helper.setUniformFloatValue(fe.TEXTURE_PIXEL_HEIGHT,k),this.helper.setUniformFloatValue(fe.TEXTURE_RESOLUTION,S),this.helper.setUniformFloatValue(fe.TEXTURE_ORIGIN_X,O[0]+Z*j[0]*S-a*S),this.helper.setUniformFloatValue(fe.TEXTURE_ORIGIN_Y,O[1]-K*j[1]*S+a*S),s);0<a&&(M=o.getTileCoordExtent(R),(0,oe.getIntersection)(M,s,M)),this.helper.setUniformFloatVec4(fe.RENDER_EXTENT,M),this.helper.setUniformFloatValue(fe.RESOLUTION,r.resolution),this.helper.setUniformFloatValue(fe.ZOOM,r.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var L=this.helper.getCanvas(),te=this.tileTextureCache_;te.canExpireCache();)te.pop().dispose();return e.postRenderFunctions.push(function(e,t){i.updateCacheSize(.1,t.viewState.projection),i.expireCache(t.viewState.projection,pe)}),this.postRender(t,e),L}},{key:"getData",value:function(e){if(this.helper.getGL()){var t=this.frameState_;if(t){var r=this.getLayer(),n=(0,ie.apply)(t.pixelToCoordinateTransform,e.slice()),i=t.viewState,e=r.getExtent();if(!e||(0,oe.containsCoordinate)((0,v.fromUserExtent)(e,i.projection),n)){for(var o,a,s=r.getSources((0,oe.boundingExtent)([n]),i.resolution),u=s.length-1;0<=u;--u)if("ready"===(o=s[u]).getState()){if(a=o.getTileGridForProjection(i.projection),o.getWrapX())break;var l=a.getExtent();if(!l||(0,oe.containsCoordinate)(l,n))break}if(!(u<0))for(var c=this.tileTextureCache_,f=a.getZForResolution(i.resolution);f>=a.getMinZoom();--f){var h=a.getTileCoordForCoordAndZ(n,f),p=k(o,h);if(c.containsKey(p)){var d,y,g,p=c.get(p),m=p.tile;if(m instanceof re.default&&m.getState()===ne.default.EMPTY)return null;if(p.loaded)return m=a.getOrigin(f),d=(0,ce.toSize)(a.getTileSize(f)),y=a.getResolution(f),g=(n[0]-m[0])/y-h[1]*d[0],m=(m[1]-n[1])/y-h[2]*d[1],p.getPixelData(g,m)}}}}}return null}},{key:"findAltTiles_",value:function(e,t,r,n){var i=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!i)return!1;for(var o=!0,a=this.tileTextureCache_,s=this.getLayer().getRenderSource(),u=i.minX;u<=i.maxX;++u)for(var l=i.minY;l<=i.maxY;++l){var c=k(s,[r,u,l]),f=!1;a.containsKey(c)&&(c=a.get(c)).loaded&&(P(n,c,r),f=!0),f||(o=!1)}return o}},{key:"clearCache",value:function(){var e=this.tileTextureCache_;e.forEach(function(e){return e.dispose()}),e.clear()}},{key:"removeHelper",value:function(){this.helper&&this.clearCache(),h(y(i.prototype),"removeHelper",this).call(this)}},{key:"disposeInternal",value:function(){var e=this.helper;e&&(e.getGL().deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)),h(y(i.prototype),"disposeInternal",this).call(this),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../../TileRange.js":97,"../../TileState.js":98,"../../array.js":104,"../../extent.js":131,"../../proj.js":271,"../../reproj/Tile.js":314,"../../size.js":319,"../../structs/LRUCache.js":355,"../../tilecoord.js":371,"../../transform.js":377,"../../util.js":379,"../../vec/mat4.js":380,"../../webgl.js":381,"../../webgl/Buffer.js":382,"../../webgl/Helper.js":384,"../../webgl/TileTexture.js":389,"./Layer.js":309}],312:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.calculateSourceExtentResolution=function(t,r,e,n){var i=(0,l.getCenter)(e),o=a(t,r,i,n);(!isFinite(o)||o<=0)&&(0,l.forEachCorner)(e,function(e){return o=a(t,r,e,n),isFinite(o)&&0<o});return o},r.calculateSourceResolution=a,r.canvasPool=void 0,r.render=function(e,t,m,v,r,b,n,i,o,s,a,_){var w,x,u,S,j=(0,c.createCanvasContext2D)(Math.round(m*e),Math.round(m*t),f);_||(j.imageSmoothingEnabled=!1);return 0!==o.length&&(j.scale(m,m),j.globalCompositeOperation="lighter",w=(0,l.createEmpty)(),o.forEach(function(e,t,r){(0,l.extend)(w,e.extent)}),e=(0,l.getWidth)(w),t=(0,l.getHeight)(w),x=(0,c.createCanvasContext2D)(Math.round(m*e/v),Math.round(m*t/v)),_||(x.imageSmoothingEnabled=!1),u=m/v,o.forEach(function(e,t,r){var n=e.extent[0]-w[0],i=-(e.extent[3]-w[3]),o=(0,l.getWidth)(e.extent),a=(0,l.getHeight)(e.extent);0<e.image.width&&0<e.image.height&&x.drawImage(e.image,s,s,e.image.width-2*s,e.image.height-2*s,n*u,i*u,o*u,a*u)}),S=(0,l.getTopLeft)(n),i.getTriangles().forEach(function(e,t,r){var n=e.source,e=e.target,i=n[0][0],o=n[0][1],a=n[1][0],s=n[1][1],u=n[2][0],n=n[2][1],l=O((e[0][0]-S[0])/b),c=O(-(e[0][1]-S[1])/b),f=O((e[1][0]-S[0])/b),h=O(-(e[1][1]-S[1])/b),p=O((e[2][0]-S[0])/b),e=O(-(e[2][1]-S[1])/b),a=[[a-=i,s-=o,0,0,f-l],[u-=i,n-=o,0,0,p-l],[0,0,a,s,h-c],[0,0,u,n,e-c]],s=(0,k.solveLinearSystem)(a);if(s){if(j.save(),j.beginPath(),function(){{var e;void 0===P&&((e=document.createElement("canvas").getContext("2d")).globalCompositeOperation="lighter",e.fillStyle="rgba(210, 0, 0, 0.75)",E(e,4,5,4,0),E(e,4,5,0,5),e=e.getImageData(0,0,3,3).data,P=T(e,0)||T(e,4)||T(e,8))}return P}()||!_){j.moveTo(f,h);for(var d=l-f,y=c-h,g=0;g<4;g++)j.lineTo(f+O((g+1)*d/4),h+O(g*y/3)),3!=g&&j.lineTo(f+O((g+1)*d/4),h+O((g+1)*y/3))}else j.moveTo(f,h),j.lineTo(l,c);j.lineTo(p,e),j.clip(),j.transform(s[0],s[2],s[1],s[3],l,c),j.translate(w[0]-i,w[3]-o),j.scale(v/m,-v/m),j.drawImage(x.canvas,0,0),j.restore()}}),a)&&(j.save(),j.globalCompositeOperation="source-over",j.strokeStyle="black",j.lineWidth=1,i.getTriangles().forEach(function(e,t,r){var e=e.target,n=(e[0][0]-S[0])/b,i=-(e[0][1]-S[1])/b,o=(e[1][0]-S[0])/b,a=-(e[1][1]-S[1])/b,s=(e[2][0]-S[0])/b,e=-(e[2][1]-S[1])/b;j.beginPath(),j.moveTo(o,a),j.lineTo(n,i),j.lineTo(s,e),j.closePath(),j.stroke()}),j.restore()),j.canvas;function O(e){return Math.round(e*m)/m}};var P,l=e("./extent.js"),c=e("./dom.js"),o=e("./proj.js"),k=e("./math.js"),f=[];function E(e,t,r,n,i){e.beginPath(),e.moveTo(0,0),e.lineTo(t,r),e.lineTo(n,i),e.closePath(),e.save(),e.clip(),e.fillRect(0,0,Math.max(t,n)+1,Math.max(r,i)),e.restore()}function T(e,t){return 2<Math.abs(e[4*t]-210)||2<Math.abs(e[4*t+3]-191.25)}function a(e,t,r,n){var i=(0,o.transform)(r,t,e),n=(0,o.getPointResolution)(t,n,r),r=t.getMetersPerUnit(),t=(void 0!==r&&(n*=r),e.getMetersPerUnit()),r=(void 0!==t&&(n/=t),e.getExtent());return r&&!(0,l.containsCoordinate)(r,i)||(t=(0,o.getPointResolution)(e,n,i)/n,isFinite(t)&&0<t&&(n/=t)),n}r.canvasPool=f},{"./dom.js":123,"./extent.js":131,"./math.js":267,"./proj.js":271}],313:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var p=e("./common.js"),n=s(e("../events/EventType.js")),o=s(e("../ImageBase.js")),d=s(e("../ImageState.js")),y=s(e("./Triangulation.js")),g=e("../reproj.js"),m=e("../extent.js"),a=e("../events.js");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=h;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,f=v(h);function h(e,t,r,n,i,o,a){var s,u,l,c;if(this instanceof h)return s=e.getExtent(),u=(u=t.getExtent())?(0,m.getIntersection)(r,u):r,c=(0,m.getCenter)(u),c=(0,g.calculateSourceResolution)(e,t,c,n),l=p.ERROR_THRESHOLD,u=(e=o((o=new y.default(e,t,u,s,c*l,n)).calculateSourceExtent(),c,i))?d.default.IDLE:d.default.EMPTY,l=e?e.getPixelRatio():1,(c=f.call(this,r,n,l,u)).targetProj_=t,c.maxSourceExtent_=s,c.triangulation_=o,c.targetResolution_=n,c.targetExtent_=r,c.sourceImage_=e,c.sourcePixelRatio_=l,c.interpolate_=a,c.canvas_=null,c.sourceListenerKey_=null,c;throw new TypeError("Cannot call a class as a function")}return t=h,(e=[{key:"disposeInternal",value:function(){this.state==d.default.LOADING&&this.unlistenSource_(),l(b(h.prototype),"disposeInternal",this).call(this)}},{key:"getImage",value:function(){return this.canvas_}},{key:"getProjection",value:function(){return this.targetProj_}},{key:"reproject_",value:function(){var e,t,r=this.sourceImage_.getState();r==d.default.LOADED&&(e=(0,m.getWidth)(this.targetExtent_)/this.targetResolution_,t=(0,m.getHeight)(this.targetExtent_)/this.targetResolution_,this.canvas_=(0,g.render)(e,t,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_)),this.state=r,this.changed()}},{key:"load",value:function(){var e;this.state==d.default.IDLE&&(this.state=d.default.LOADING,this.changed(),(e=this.sourceImage_.getState())==d.default.LOADED||e==d.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,a.listen)(this.sourceImage_,n.default.CHANGE,function(e){var t=this.sourceImage_.getState();t!=d.default.LOADED&&t!=d.default.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load()))}},{key:"unlistenSource_",value:function(){(0,a.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(o.default);r.default=e},{"../ImageBase.js":78,"../ImageState.js":80,"../events.js":125,"../events/EventType.js":127,"../extent.js":131,"../reproj.js":312,"./Triangulation.js":315,"./common.js":316}],314:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var b=e("./common.js"),a=u(e("../events/EventType.js")),n=u(e("../Tile.js")),_=u(e("../TileState.js")),w=u(e("./Triangulation.js")),x=e("../reproj.js"),S=e("../math.js"),j=e("../extent.js"),s=e("../events.js"),o=e("../dom.js");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r);return O(this,n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function O(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");t=e;if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=v;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,m=h(v);function v(e,t,r,n,i,o,a,s,u,l,c,f){var h;if(!(this instanceof v))throw new TypeError("Cannot call a class as a function");(h=m.call(this,i,_.default.IDLE,{interpolate:!!f})).renderEdges_=void 0!==c&&c,h.pixelRatio_=a,h.gutter_=s,h.canvas_=null,h.sourceTileGrid_=t,h.targetTileGrid_=n,h.wrappedTileCoord_=o||i,h.sourceTiles_=[],h.sourcesListenerKeys_=null,h.sourceZ_=0;f=n.getTileCoordExtent(h.wrappedTileCoord_),c=h.targetTileGrid_.getExtent(),s=h.sourceTileGrid_.getExtent(),o=c?(0,j.getIntersection)(f,c):f;if(0===(0,j.getArea)(o))return h.state=_.default.EMPTY,O(h);i=e.getExtent(),i&&(s=s?(0,j.getIntersection)(s,i):i),c=n.getResolution(h.wrappedTileCoord_[0]),f=(0,x.calculateSourceExtentResolution)(e,r,o,c);if(!isFinite(f)||f<=0)return h.state=_.default.EMPTY,O(h);i=void 0!==l?l:b.ERROR_THRESHOLD;if(h.triangulation_=new w.default(e,r,o,s,f*i,c),0===h.triangulation_.getTriangles().length)return h.state=_.default.EMPTY,O(h);h.sourceZ_=t.getZForResolution(f);n=h.triangulation_.calculateSourceExtent();if(s&&(e.canWrapX()?(n[1]=(0,S.clamp)(n[1],s[1],s[3]),n[3]=(0,S.clamp)(n[3],s[1],s[3])):n=(0,j.getIntersection)(n,s)),(0,j.getArea)(n)){for(var p=t.getTileRangeForExtentAndZ(n,h.sourceZ_),d=p.minX;d<=p.maxX;d++)for(var y=p.minY;y<=p.maxY;y++){var g=u(h.sourceZ_,d,y,a);g&&h.sourceTiles_.push(g)}0===h.sourceTiles_.length&&(h.state=_.default.EMPTY)}else h.state=_.default.EMPTY;return h}return t=v,(e=[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var e,t,r,n,i,o=[];this.sourceTiles_.forEach(function(e,t,r){e&&e.getState()==_.default.LOADED&&o.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),(this.sourceTiles_.length=0)===o.length?this.state=_.default.ERROR:(r=this.wrappedTileCoord_[0],e="number"==typeof(t=this.targetTileGrid_.getTileSize(r))?t:t[0],t="number"==typeof t?t:t[1],r=this.targetTileGrid_.getResolution(r),n=this.sourceTileGrid_.getResolution(this.sourceZ_),i=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),this.canvas_=(0,x.render)(e,t,this.pixelRatio_,n,this.sourceTileGrid_.getExtent(),r,i,this.triangulation_,o,this.gutter_,this.renderEdges_,this.interpolate),this.state=_.default.LOADED),this.changed()}},{key:"load",value:function(){var o;this.state==_.default.IDLE&&(this.state=_.default.LOADING,this.changed(),o=0,this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(r,e,t){var n,i=r.getState();i!=_.default.IDLE&&i!=_.default.LOADING||(o++,n=(0,s.listen)(r,a.default.CHANGE,function(e){var t=r.getState();t!=_.default.LOADED&&t!=_.default.ERROR&&t!=_.default.EMPTY||((0,s.unlistenByKey)(n),0===--o&&(this.unlistenSources_(),this.reproject_()))},this),this.sourcesListenerKeys_.push(n))}.bind(this)),0===o?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,t,r){e.getState()==_.default.IDLE&&e.load()}))}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(s.unlistenByKey),this.sourcesListenerKeys_=null}},{key:"release",value:function(){this.canvas_&&((0,o.releaseCanvas)(this.canvas_.getContext("2d")),x.canvasPool.push(this.canvas_),this.canvas_=null),c(p(v.prototype),"release",this).call(this)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.default);r.default=e},{"../Tile.js":94,"../TileState.js":98,"../dom.js":123,"../events.js":125,"../events/EventType.js":127,"../extent.js":131,"../math.js":267,"../reproj.js":312,"./Triangulation.js":315,"./common.js":316}],315:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var y=e("../extent.js"),d=e("../proj.js"),g=e("../math.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}e=function(){function p(e,t,r,n,i,o){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");this.sourceProj_=e,this.targetProj_=t;var a,s={},u=(0,d.getTransform)(this.targetProj_,this.sourceProj_),e=(this.transformInv_=function(e){var t=e[0]+"/"+e[1];return s[t]||(s[t]=u(e)),s[t]},this.maxSourceExtent_=n,this.errorThresholdSquared_=i*i,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&(0,y.getWidth)(n)==(0,y.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,y.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,y.getWidth)(this.targetProj_.getExtent()):null,(0,y.getTopLeft)(r)),t=(0,y.getTopRight)(r),i=(0,y.getBottomRight)(r),n=(0,y.getBottomLeft)(r),l=this.transformInv_(e),c=this.transformInv_(t),f=this.transformInv_(i),h=this.transformInv_(n),r=10+(o?Math.max(0,Math.ceil(Math.log2((0,y.getArea)(r)/(o*o*256*256)))):0);this.addQuad_(e,t,i,n,l,c,f,h,r),this.wrapsXInSource_&&(a=1/0,this.triangles_.forEach(function(e,t,r){a=Math.min(a,e.source[0][0],e.source[1][0],e.source[2][0])}),this.triangles_.forEach(function(e){var t,r;Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-a>this.sourceWorldWidth_/2&&((t=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]])[0][0]-a>this.sourceWorldWidth_/2&&(t[0][0]-=this.sourceWorldWidth_),t[1][0]-a>this.sourceWorldWidth_/2&&(t[1][0]-=this.sourceWorldWidth_),t[2][0]-a>this.sourceWorldWidth_/2&&(t[2][0]-=this.sourceWorldWidth_),r=Math.min(t[0][0],t[1][0],t[2][0]),Math.max(t[0][0],t[1][0],t[2][0])-r<this.sourceWorldWidth_/2)&&(e.source=t)}.bind(this))),s={}}var e,t,r;return e=p,(t=[{key:"addTriangle_",value:function(e,t,r,n,i,o){this.triangles_.push({source:[n,i,o],target:[e,t,r]})}},{key:"addQuad_",value:function(e,t,r,n,i,o,a,s,u){var l=(0,y.boundingExtent)([i,o,a,s]),c=this.sourceWorldWidth_?(0,y.getWidth)(l)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,h=this.sourceProj_.canWrapX()&&.5<c&&c<1,p=!1;if(!(!(p=0<u&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(d=(0,y.boundingExtent)([e,t,r,n]),p=.25<(0,y.getWidth)(d)/this.targetWorldWidth_||p),!h)&&this.sourceProj_.isGlobal()&&c?.25<c||p:p)&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3]))||(0,y.intersects)(l,this.maxSourceExtent_)){var d=0;if(!(p||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1])))if(0<u)p=!0;else if(1!=(d=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(s[0])&&isFinite(s[1])?0:1))&&2!=d&&4!=d&&8!=d)return;if(0<u)if(p||(c=[(e[0]+r[0])/2,(e[1]+r[1])/2],l=this.transformInv_(c),p=(c=h?((0,g.modulo)(i[0],f)+(0,g.modulo)(a[0],f))/2-(0,g.modulo)(l[0],f):(i[0]+a[0])/2-l[0])*c+(f=(i[1]+a[1])/2-l[1])*f>this.errorThresholdSquared_),p)return void(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])?(c=[(t[0]+r[0])/2,(t[1]+r[1])/2],l=this.transformInv_(c),f=[(n[0]+e[0])/2,(n[1]+e[1])/2],p=this.transformInv_(f),this.addQuad_(e,t,c,f,i,o,l,p,u-1),this.addQuad_(f,c,r,n,p,l,a,s,u-1)):(f=[(e[0]+t[0])/2,(e[1]+t[1])/2],c=this.transformInv_(f),p=[(r[0]+n[0])/2,(r[1]+n[1])/2],l=this.transformInv_(p),this.addQuad_(e,f,p,n,i,c,l,s,u-1),this.addQuad_(f,t,r,p,c,o,a,l,u-1)));if(h){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&d)&&this.addTriangle_(e,r,n,i,a,s),0==(14&d)&&this.addTriangle_(e,r,t,i,a,o),d&&(0==(13&d)&&this.addTriangle_(t,n,e,o,s,i),0==(7&d))&&this.addTriangle_(t,n,r,o,s,a)}}},{key:"calculateSourceExtent",value:function(){var n=(0,y.createEmpty)();return this.triangles_.forEach(function(e,t,r){e=e.source;(0,y.extendCoordinate)(n,e[0]),(0,y.extendCoordinate)(n,e[1]),(0,y.extendCoordinate)(n,e[2])}),n}},{key:"getTriangles",value:function(){return this.triangles_}}])&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),p}();r.default=e},{"../extent.js":131,"../math.js":267,"../proj.js":271}],316:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ERROR_THRESHOLD=void 0;r.ERROR_THRESHOLD=.5},{}],317:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createMinMaxResolution=function(i,o,a,s,u){return a=void 0===a||a,function(e,t,r,n){if(void 0!==e)return r=s?h(i,s,r,u):i,a&&n?p(e,r,o):(0,c.clamp)(e,o,r)}},r.createSnapToPower=function(i,o,a,s,u,l){return s=void 0===s||s,a=void 0!==a?a:0,function(e,t,r,n){if(void 0!==e)return r=u?h(o,u,r,l):o,n?s?p(e,r,a):(0,c.clamp)(e,a,r):(n=Math.ceil(Math.log(o/r)/Math.log(i)-1e-9),t=-t*(.5-1e-9)+.5,e=Math.min(r,e),e=Math.floor(Math.log(o/e)/Math.log(i)+t),t=Math.max(n,e),n=o/Math.pow(i,t),(0,c.clamp)(n,a,r))}},r.createSnapToResolutions=function(a,s,u,l){return s=void 0===s||s,function(e,t,r,n){var i,o;if(void 0!==e)return o=a[0],i=a[a.length-1],r=u?h(o,u,r,l):o,n?s?p(e,r,i):(0,c.clamp)(e,i,r):(o=Math.min(r,e),n=Math.floor((0,f.linearFindNearest)(a,o,t)),a[n]>r&&n<a.length-1?a[n+1]:a[n])}};var c=e("./math.js"),o=e("./extent.js"),f=e("./array.js");function h(e,t,r,n){var i=(0,o.getWidth)(t)/r[0],t=(0,o.getHeight)(t)/r[1];return n?Math.min(e,Math.max(i,t)):Math.min(e,Math.min(i,t))}function p(e,t,r){var n=Math.min(e,t);return n*=Math.log(1+50*Math.max(0,e/t-1))/50+1,r&&(n=Math.max(n,r),n/=Math.log(1+50*Math.max(0,r/e-1))/50+1),(0,c.clamp)(n,r/2,2*t)}},{"./array.js":104,"./extent.js":131,"./math.js":267}],318:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createSnapToN=function(e){var r=2*Math.PI/e;return function(e,t){return t?e:void 0!==e?Math.floor(e/r+.5)*r:void 0}},r.createSnapToZero=function(r){return r=r||(0,n.toRadians)(5),function(e,t){return t?e:void 0!==e?Math.abs(e)<=r?0:e:void 0}},r.disable=function(e){if(void 0!==e)return 0},r.none=function(e){if(void 0!==e)return e};var n=e("./math.js")},{"./math.js":267}],319:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.buffer=function(e,t,r){void 0===r&&(r=[0,0]);return r[0]=e[0]+2*t,r[1]=e[1]+2*t,r},r.hasArea=function(e){return 0<e[0]&&0<e[1]},r.scale=function(e,t,r){void 0===r&&(r=[0,0]);return r[0]=e[0]*t+.5|0,r[1]=e[1]*t+.5|0,r},r.toSize=function(e,t){return Array.isArray(e)?e:(void 0===t?t=[e,e]:(t[0]=e,t[1]=e),t)}},{}],320:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"BingMaps",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"CartoDB",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"Cluster",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"DataTile",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"GeoTIFF",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"IIIF",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"ImageArcGISRest",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"ImageCanvas",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"ImageMapGuide",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"ImageStatic",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"ImageWMS",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"OSM",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"Raster",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(r,"Source",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(r,"Stamen",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(r,"Tile",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(r,"TileArcGISRest",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(r,"TileDebug",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(r,"TileImage",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(r,"TileJSON",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(r,"TileWMS",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(r,"UTFGrid",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(r,"UrlTile",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(r,"Vector",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(r,"VectorTile",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(r,"WMTS",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(r,"XYZ",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(r,"Zoomify",{enumerable:!0,get:function(){return I.default}}),r.sourcesFromTileGrid=function(n,i){var o=new s.default(32),a=n.getExtent();return function(e,t){o.expireCache(),a&&(e=(0,u.getIntersection)(a,e));var t=n.getZForResolution(t),r=[];return n.forEachTileCoord(e,t,function(e){var t=e.toString();o.containsKey(t)||(e=i(e),o.set(t,e)),r.push(o.get(t))}),r}};var s=A(e("./structs/LRUCache.js")),u=e("./extent.js"),n=A(e("./source/BingMaps.js")),i=A(e("./source/CartoDB.js")),o=A(e("./source/Cluster.js")),a=A(e("./source/DataTile.js")),l=A(e("./source/GeoTIFF.js")),c=A(e("./source/IIIF.js")),f=A(e("./source/Image.js")),h=A(e("./source/ImageArcGISRest.js")),p=A(e("./source/ImageCanvas.js")),d=A(e("./source/ImageMapGuide.js")),y=A(e("./source/ImageStatic.js")),g=A(e("./source/ImageWMS.js")),m=A(e("./source/OSM.js")),v=A(e("./source/Raster.js")),b=A(e("./source/Source.js")),_=A(e("./source/Stamen.js")),w=A(e("./source/Tile.js")),x=A(e("./source/TileArcGISRest.js")),S=A(e("./source/TileDebug.js")),j=A(e("./source/TileImage.js")),O=A(e("./source/TileJSON.js")),P=A(e("./source/TileWMS.js")),k=A(e("./source/UrlTile.js")),E=A(e("./source/UTFGrid.js")),T=A(e("./source/Vector.js")),C=A(e("./source/VectorTile.js")),R=A(e("./source/WMTS.js")),M=A(e("./source/XYZ.js")),I=A(e("./source/Zoomify.js"));function A(e){return e&&e.__esModule?e:{default:e}}},{"./extent.js":131,"./source/BingMaps.js":321,"./source/CartoDB.js":322,"./source/Cluster.js":323,"./source/DataTile.js":324,"./source/GeoTIFF.js":325,"./source/IIIF.js":326,"./source/Image.js":327,"./source/ImageArcGISRest.js":328,"./source/ImageCanvas.js":329,"./source/ImageMapGuide.js":330,"./source/ImageStatic.js":331,"./source/ImageWMS.js":332,"./source/OSM.js":333,"./source/Raster.js":334,"./source/Source.js":335,"./source/Stamen.js":336,"./source/Tile.js":337,"./source/TileArcGISRest.js":338,"./source/TileDebug.js":339,"./source/TileImage.js":341,"./source/TileJSON.js":342,"./source/TileWMS.js":343,"./source/UTFGrid.js":344,"./source/UrlTile.js":345,"./source/Vector.js":346,"./source/VectorTile.js":348,"./source/WMTS.js":349,"./source/XYZ.js":350,"./source/Zoomify.js":351,"./structs/LRUCache.js":355}],321:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.quadKey=g;var n=(n=e("./TileImage.js"))&&n.__esModule?n:{default:n},c=e("../extent.js"),u=e("../tileurlfunction.js"),f=e("../tilecoord.js"),h=e("../tilegrid.js"),p=e("../proj.js"),o=e("../net.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){for(var t,r=e[0],n=new Array(r),i=1<<r-1,o=0;o<r;++o)t=48,e[1]&i&&(t+=1),e[2]&i&&(t+=2),n[o]=String.fromCharCode(t),i>>=1;return n.join("")}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=l(i);function i(e){var t,r;if(this instanceof i)return r=void 0!==e.hidpi&&e.hidpi,(t=n.call(this,{cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,opaque:!0,projection:(0,p.get)("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,tilePixelRatio:r?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})).hidpi_=r,t.culture_=void 0!==e.culture?e.culture:"en-us",t.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1,t.apiKey_=e.key,t.imagerySet_=e.imagerySet,r="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+t.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+t.apiKey_+"&c="+t.culture_,(0,o.jsonp)(r,t.handleImageryMetadataResponse.bind(d(t)),void 0,"jsonp"),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getApiKey",value:function(){return this.apiKey_}},{key:"getImagerySet",value:function(){return this.imagerySet_}},{key:"handleImageryMetadataResponse",value:function(e){var o,t,r,a,s,l;200!=e.statusCode||"OK"!=e.statusDescription||"ValidCredentials"!=e.authenticationResultCode||1!=e.resourceSets.length||1!=e.resourceSets[0].resources.length?this.setState("error"):(o=e.resourceSets[0].resources[0],e=-1==this.maxZoom_?o.zoomMax:this.maxZoom_,r=this.getProjection(),r=(0,h.extentFromProjection)(r),t=this.hidpi_?2:1,t=o.imageWidth==o.imageHeight?o.imageWidth/t:[o.imageWidth/t,o.imageHeight/t],r=(0,h.createXYZ)({extent:r,minZoom:o.zoomMin,maxZoom:e,tileSize:t}),this.tileGrid=r,a=this.culture_,s=this.hidpi_,this.tileUrlFunction=(0,u.createFromTileUrlFunctions)(o.imageUrlSubdomains.map(function(e){var n=[0,0,0],i=o.imageUrl.replace("{subdomain}",e).replace("{culture}",a);return function(e,t,r){if(e)return(0,f.createOrUpdate)(e[0],e[1],e[2],n),e=i,s&&(e+="&dpi=d1&device=mobile"),e.replace("{quadkey}",g(n))}})),o.imageryProviders&&(l=(0,p.getTransformFromProjections)((0,p.get)("EPSG:4326"),this.getProjection()),this.setAttributions(function(a){var s=[],e=a.viewState,t=this.getTileGrid(),r=t.getZForResolution(e.resolution,this.zDirection),u=t.getTileCoordForCoordAndZ(e.center,r)[0];return o.imageryProviders.map(function(e){for(var t=!1,r=e.coverageAreas,n=0,i=r.length;n<i;++n){var o=r[n];if(u>=o.zoomMin&&u<=o.zoomMax){o=o.bbox,o=[o[1],o[0],o[3],o[2]],o=(0,c.applyTransform)(o,l);if((0,c.intersects)(o,a.extent)){t=!0;break}}}t&&s.push(e.attribution)}),s.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),s}.bind(this))),this.setState("ready"))}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../extent.js":131,"../net.js":268,"../proj.js":271,"../tilecoord.js":371,"../tilegrid.js":372,"../tileurlfunction.js":376,"./TileImage.js":341}],322:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,maxZoom:void 0!==e.maxZoom?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,transition:e.transition,wrapX:e.wrapX,zDirection:e.zDirection})).account_=e.account,t.mapId_=e.map||"",t.config_=e.config||{},t.templateCache_={},t.initializeMap_(),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getConfig",value:function(){return this.config_}},{key:"updateConfig",value:function(e){Object.assign(this.config_,e),this.initializeMap_()}},{key:"setConfig",value:function(e){this.config_=e||{},this.initializeMap_()}},{key:"initializeMap_",value:function(){var e,t,r=JSON.stringify(this.config_);this.templateCache_[r]?this.applyTemplate_(this.templateCache_[r]):(e="https://"+this.account_+".carto.com/api/v1/map",this.mapId_&&(e+="/named/"+this.mapId_),(t=new XMLHttpRequest).addEventListener("load",this.handleInitResponse_.bind(this,r)),t.addEventListener("error",this.handleInitError_.bind(this)),t.open("POST",e),t.setRequestHeader("Content-type","application/json"),t.send(JSON.stringify(this.config_)))}},{key:"handleInitResponse_",value:function(e,t){var r,t=t.target;if(!t.status||200<=t.status&&t.status<300){try{r=JSON.parse(t.responseText)}catch(e){return void this.setState("error")}this.applyTemplate_(r),this.templateCache_[e]=r,this.setState("ready")}else this.setState("error")}},{key:"handleInitError_",value:function(e){this.setState("error")}},{key:"applyTemplate_",value:function(e){e="https://"+e.cdn_url.https+"/"+this.account_+"/api/v1/map/"+e.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(((e=e("./XYZ.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./XYZ.js":350}],323:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=h(e("../events/EventType.js")),a=h(e("../Feature.js")),s=h(e("../geom/Point.js")),n=h(e("./Vector.js")),u=e("../coordinate.js"),l=e("../asserts.js"),c=e("../extent.js"),f=e("../util.js");function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n=g(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:e.attributions,wrapX:e.wrapX})).resolution=void 0,t.distance=void 0!==e.distance?e.distance:20,t.minDistance=e.minDistance||0,t.interpolationRatio=0,t.features=[],t.geometryFunction=e.geometryFunction||function(e){e=e.getGeometry();return(0,l.assert)("Point"==e.getType(),10),e},t.createCustomCluster_=e.createCluster,t.source=null,t.boundRefresh_=t.refresh.bind(m(t)),t.updateDistance(t.distance,t.minDistance),t.setSource(e.source||null),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clear",value:function(e){this.features.length=0,d(v(i.prototype),"clear",this).call(this,e)}},{key:"getDistance",value:function(){return this.distance}},{key:"getSource",value:function(){return this.source}},{key:"loadFeatures",value:function(e,t,r){this.source.loadFeatures(e,t,r),t!==this.resolution&&(this.resolution=t,this.refresh())}},{key:"setDistance",value:function(e){this.updateDistance(e,this.minDistance)}},{key:"setMinDistance",value:function(e){this.updateDistance(this.distance,e)}},{key:"getMinDistance",value:function(){return this.minDistance}},{key:"setSource",value:function(e){this.source&&this.source.removeEventListener(o.default.CHANGE,this.boundRefresh_),(this.source=e)&&e.addEventListener(o.default.CHANGE,this.boundRefresh_),this.refresh()}},{key:"refresh",value:function(){this.clear(),this.cluster(),this.addFeatures(this.features)}},{key:"updateDistance",value:function(e,t){var r=0===e?0:Math.min(t,e)/e,n=e!==this.distance||this.interpolationRatio!==r;this.distance=e,this.minDistance=t,this.interpolationRatio=r,n&&this.refresh()}},{key:"cluster",value:function(){if(void 0!==this.resolution&&this.source)for(var e=(0,c.createEmpty)(),t=this.distance*this.resolution,r=this.source.getFeatures(),n={},i=0,o=r.length;i<o;i++){var a=r[i];(0,f.getUid)(a)in n||(a=this.geometryFunction(a))&&(a=a.getCoordinates(),(0,c.createOrUpdateFromCoordinate)(a,e),(0,c.buffer)(e,t,e),a=this.source.getFeaturesInExtent(e).filter(function(e){e=(0,f.getUid)(e);return!(e in n)&&(n[e]=!0)}),this.features.push(this.createCluster(a,e)))}}},{key:"createCluster",value:function(e,t){for(var r=[0,0],n=e.length-1;0<=n;--n){var i=this.geometryFunction(e[n]);i?(0,u.add)(r,i.getCoordinates()):e.splice(n,1)}(0,u.scale)(r,1/e.length);var t=(0,c.getCenter)(t),o=this.interpolationRatio,t=new s.default([r[0]*(1-o)+t[0]*o,r[1]*(1-o)+t[1]*o]);return this.createCustomCluster_?this.createCustomCluster_(t,e):new a.default({geometry:t,features:e})}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../Feature.js":75,"../asserts.js":105,"../coordinate.js":121,"../events/EventType.js":127,"../extent.js":131,"../geom/Point.js":199,"../util.js":379,"./Vector.js":346}],324:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=n(e("../DataTile.js")),l=n(e("../events/EventType.js")),o=n(e("./TileEventType.js")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=g(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Tile.js")),c=n(e("../TileState.js")),f=e("../tilegrid.js"),h=e("../tilecoord.js"),p=e("../util.js"),d=e("../functions.js"),y=e("../size.js");function g(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(g=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _(t)}}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e);var r,n=b(i);function i(e){var t,r;if(this instanceof i)return t=void 0===e.projection?"EPSG:3857":e.projection,void 0===(r=e.tileGrid)&&t&&(r=(0,f.createXYZ)({extent:(0,f.extentFromProjection)(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),(t=n.call(this,{cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:r,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate})).gutter_=void 0!==e.gutter?e.gutter:0,t.tileSize_=e.tileSize?(0,y.toSize)(e.tileSize):null,t.tileSizes_=null,t.tileLoadingKeys_={},t.loader_=e.loader,t.handleTileChange_=t.handleTileChange_.bind(_(t)),t.bandCount=void 0===e.bandCount?4:e.bandCount,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"setTileSizes",value:function(e){this.tileSizes_=e}},{key:"getTileSize",value:function(e){var t;return this.tileSizes_?this.tileSizes_[e]:this.tileSize_||((t=this.getTileGrid())?(0,y.toSize)(t.getTileSize(e)):[256,256])}},{key:"getGutterForProjection",value:function(e){return this.gutter_}},{key:"setLoader",value:function(e){this.loader_=e}},{key:"getTile",value:function(e,t,r,n,i){var o,a=this.getTileSize(e),s=(0,h.getKeyZXY)(e,t,r);return this.tileCache.containsKey(s)?this.tileCache.get(s):(o=this.loader_,a=Object.assign({tileCoord:[e,t,r],loader:function(){return(0,d.toPromise)(function(){return o(e,t,r)})},size:a},this.tileOptions),(a=new u.default(a)).key=this.getKey(),a.addEventListener(l.default.CHANGE,this.handleTileChange_),this.tileCache.set(s,a),a)}},{key:"handleTileChange_",value:function(e){var t,e=e.target,r=(0,p.getUid)(e),n=e.getState();n==c.default.LOADING?(this.tileLoadingKeys_[r]=!0,t=o.default.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],t=n==c.default.ERROR?o.default.TILELOADERROR:n==c.default.LOADED?o.default.TILELOADEND:void 0),t&&this.dispatchEvent(new s.TileSourceEvent(t,e))}}])&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.default);r.default=e},{"../DataTile.js":73,"../TileState.js":98,"../events/EventType.js":127,"../functions.js":189,"../size.js":319,"../tilecoord.js":371,"../tilegrid.js":372,"../util.js":379,"./Tile.js":337,"./TileEventType.js":340}],325:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./DataTile.js")),R=o(e("../tilegrid/TileGrid.js")),g=e("geotiff"),M=e("../proj.js"),E=e("../math.js"),I=e("../extent.js"),A=e("../proj/Units.js");function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m,T="STATISTICS_MAXIMUM",C="STATISTICS_MINIMUM";function h(n){return n.getImageCount().then(function(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n.getImage(r);return Promise.all(t)})}function L(e,t,r,n,i){if(Array.isArray(e)){var o,a=e.length;if(!Array.isArray(t)||a!=t.length)throw i(o=new Error(n)),o;for(var s=0;s<a;++s)L(e[s],t[s],r,n,i)}else if(Math.abs(e-t)>r*e)throw new Error(n)}e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,u=c(l);function l(e){var t;if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");(t=u.call(this,{state:"loading",tileGrid:null,projection:null,opaque:e.opaque,transition:e.transition,interpolate:!1!==e.interpolate,wrapX:e.wrapX})).sourceInfo_=e.sources;for(var r,n,i=t.sourceInfo_.length,o=(t.sourceOptions_=e.sourceOptions,t.sourceImagery_=new Array(i),t.sourceMasks_=new Array(i),t.resolutionFactors_=new Array(i),t.samplesPerPixel_,t.nodataValues_,t.metadata_,t.normalize_=!1!==e.normalize,t.addAlpha_=!1,t.error_=null,t.convertToRGB_=e.convertToRGB||!1,t.setKey(t.sourceInfo_.map(function(e){return e.url}).join(",")),f(t)),a=new Array(i),s=0;s<i;++s)a[s]=(r=t.sourceInfo_[s],n=t.sourceOptions_,(r=r.blob?(0,g.fromBlob)(r.blob):r.overviews?(0,g.fromUrls)(r.url,r.overviews,n):(0,g.fromUrl)(r.url,n)).then(h));return Promise.all(a).then(function(e){o.configure_(e)}).catch(function(e){console.error(e),o.error_=e,o.setState("error")}),t}return t=l,(e=[{key:"getError",value:function(){return this.error_}},{key:"configure_",value:function(g){for(var m,v,b,_,w,x=this,S=new Array(g.length),j=new Array(g.length),O=new Array(g.length),P=0,e=g.length,t=function(e){var t=[],r=[],n=(g[e].forEach(function(e){(4==(4&(e.fileDirectory.NewSubfileType||0))?r:t).push(e)}),t.length);if(0<r.length&&r.length!==n)throw new Error("Expected one mask per image found ".concat(r.length," masks and ").concat(n," images"));var i=void 0,o=void 0,a=new Array(n),s=new Array(n),u=new Array(n);j[e]=new Array(n),O[e]=new Array(n);for(var l,c,f,h=0;h<n;++h){var p=t[h],d=p.getGDALNoData(),d=(O[e][h]=p.getGDALMetadata(0),j[e][h]=d,x.sourceInfo_[e].bands),d=(S[e]=d?d.length:p.getSamplesPerPixel(),n-(h+1)),i=i||function(t){try{return t.getBoundingBox()}catch(e){t=t.fileDirectory;return[0,0,t.ImageWidth,t.ImageLength]}}(p),o=o||function(t){try{return t.getOrigin().slice(0,2)}catch(e){return[0,t.fileDirectory.ImageLength]}}(p),y=function(t,r){try{return t.getResolution(r)}catch(e){return[r.fileDirectory.ImageWidth/t.fileDirectory.ImageWidth,r.fileDirectory.ImageHeight/t.fileDirectory.ImageHeight]}}(p,t[0]),p=(u[d]=y[0],[p.getTileWidth(),p.getTileHeight()]),y=(a[d]=p,y[0]/Math.abs(y[1]));s[d]=[p[0],p[1]/y]}m?(0,I.getIntersection)(m,i,m):m=i,v?(c="Origin mismatch for source ".concat(e,", got [").concat(o,"] but expected [").concat(v,"]"),L(v,o,0,c,x.viewRejector)):v=o,w?(w.length-P>u.length&&(P=w.length-u.length),l=w[w.length-1]/u[u.length-1],x.resolutionFactors_[e]=l,c=u.map(function(e){return e*l}),f="Resolution mismatch for source ".concat(e,", got [").concat(c,"] but expected [").concat(w,"]"),L(w.slice(P,w.length),c,.02,f,x.viewRejector)):(w=u,x.resolutionFactors_[e]=1),b?L(b.slice(P,b.length),s,.01,"Tile size mismatch for source ".concat(e),x.viewRejector):b=s,_?L(_.slice(P,_.length),a,0,"Tile size mismatch for source ".concat(e),x.viewRejector):_=a,x.sourceImagery_[e]=t.reverse(),x.sourceMasks_[e]=r.reverse()},r=0;r<e;++r)t(r);for(var n,i,o,a=0,s=this.sourceImagery_.length;a<s;++a)for(var u=this.sourceImagery_[a];u.length<w.length;)u.unshift(void 0);if(!this.getProjection())for(var l=g[0],c=l.length-1;0<=c;--c){var f=l[c],f=(o=i=n=void 0,(f=(f=f).geoKeys)?f.ProjectedCSTypeGeoKey?(n="EPSG:"+f.ProjectedCSTypeGeoKey,(o=(0,M.get)(n))||(i=(0,A.fromCode)(f.ProjLinearUnitsGeoKey))&&(o=new M.Projection({code:n,units:i})),o):f.GeographicTypeGeoKey?(n="EPSG:"+f.GeographicTypeGeoKey,(i=(0,M.get)(n))||(o=(0,A.fromCode)(f.GeogAngularUnitsGeoKey))&&(i=new M.Projection({code:n,units:o})),i):null:null);if(f){this.projection=f;break}}this.samplesPerPixel_=S,this.nodataValues_=j,this.metadata_=O;e:for(var h=0;h<e;++h){if(void 0!==this.sourceInfo_[h].nodata){this.addAlpha_=!0;break}if(this.sourceMasks_[h].length){this.addAlpha_=!0;break}var p=j[h],d=this.sourceInfo_[h].bands;if(d){for(var y=0;y<d.length;++y)if(null!==p[d[y]-1]){this.addAlpha_=!0;break e}}else for(var k=0;k<p.length;++k)if(null!==p[k]){this.addAlpha_=!0;break e}}for(var E=this.addAlpha_?1:0,T=0;T<e;++T)E+=S[T];this.bandCount=E;var C=new R.default({extent:m,minZoom:P,origin:v,resolutions:w,tileSizes:b}),C=(this.tileGrid=C,this.setTileSizes(_),this.setLoader(this.loadTile_.bind(this)),this.setState("ready"),0);1===w.length&&(w=[2*w[0],w[0]],C=1),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:w,center:(0,M.toUserCoordinate)((0,I.getCenter)(m),this.projection),extent:(0,M.toUserExtent)(m,this.projection),zoom:C})}},{key:"loadTile_",value:function(a,s,u){for(var l=this,c=this.getTileSize(a),f=this.sourceImagery_.length,h=new Array(2*f),p=this.nodataValues_,d=this.sourceInfo_,y=m=m||new g.Pool,e=function(t){var e=d[t],r=l.resolutionFactors_[t],r=[Math.round(s*(c[0]*r)),Math.round(u*(c[1]*r)),Math.round((s+1)*(c[0]*r)),Math.round((u+1)*(c[1]*r))],n=l.sourceImagery_[t][a],i=void 0,o=(e.bands&&(i=e.bands.map(function(e){return e-1})),void 0),o="nodata"in e&&null!==e.nodata?e.nodata:i?i.map(function(e){return p[t][e]}):p[t],e={window:r,width:c[0],height:c[1],samples:i,fillValue:o,pool:y,interleave:!1},i=(i=l.convertToRGB_,o=n,i&&(!0===i||(3===o.getSamplesPerPixel()?(i=o.fileDirectory.PhotometricInterpretation)===(o=g.globals.photometricInterpretations).CMYK||i===o.YCbCr||i===o.CIELab||i===o.ICCLab:void 0))?h[t]=n.readRGB(e):h[t]=n.readRasters(e),f+t),o=l.sourceMasks_[t][a];if(!o)return h[i]=Promise.resolve(null),"continue";h[i]=o.readRasters({window:r,width:c[0],height:c[1],samples:[0],pool:y,interleave:!1})},t=0;t<f;++t)e(t);return Promise.all(h).then(this.composeTile_.bind(this,c)).catch(function(e){throw console.error(e),e})}},{key:"composeTile_",value:function(e,t){for(var r,n=this.metadata_,i=this.sourceInfo_,o=this.sourceImagery_.length,a=this.bandCount,s=this.samplesPerPixel_,u=this.nodataValues_,l=this.normalize_,c=this.addAlpha_,f=e[0]*e[1],e=f*a,h=new(l?Uint8Array:Float32Array)(e),p=0,d=0;d<f;++d){for(var y=c,g=0;g<o;++g){var m=i[g],v=m.min,b=m.max,_=void 0,w=void 0;l&&(x=n[g][0],w=-(v=void 0===v?x&&C in x?parseFloat(x[C]):(r=t[g][0])instanceof Int8Array?-128:r instanceof Int16Array?-32768:r instanceof Int32Array?-2147483648:r instanceof Float32Array?12e-39:0:v)*(_=255/((b=void 0===b?x&&T in x?parseFloat(x[T]):(r=t[g][0])instanceof Int8Array?127:r instanceof Uint8Array||r instanceof Uint8ClampedArray?255:r instanceof Int16Array?32767:r instanceof Uint16Array?65535:r instanceof Int32Array?2147483647:r instanceof Uint32Array?4294967295:r instanceof Float32Array?34e37:255:b)-v)));for(var x,S=0;S<s[g];++S){var j,O,P=t[g][S][d],k=void 0,k=l?(0,E.clamp)(_*P+w,0,255):P;c?(void 0===(j=m.nodata)&&(O=void 0,O=m.bands?m.bands[S]-1:S,j=u[g][O]),(!(O=isNaN(j))&&P!==j||O&&!isNaN(P))&&(y=!1,h[p]=k)):h[p]=k,p++}y||(x=t[o+g])&&!x[0][d]&&(y=!0)}c&&(y||(h[p]=255),p++)}return h}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.default);e.prototype.getView,r.default=e},{"../extent.js":131,"../math.js":267,"../proj.js":271,"../proj/Units.js":273,"../tilegrid/TileGrid.js":373,"./DataTile.js":324,geotiff:21}],326:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var k=o(e("../tilegrid/TileGrid.js")),n=o(e("./TileImage.js")),E=e("./Zoomify.js"),T=e("../tilegrid/common.js"),C=e("../format/IIIFInfo.js"),R=e("../asserts.js"),M=e("../extent.js"),I=e("../size.js");function o(e){return e&&e.__esModule?e:{default:e}}function A(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?a(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e){return e.toLocaleString("en",{maximumFractionDigits:10})}e=function(e){var t=f;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n,c=l(f);function f(e){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");var h,p,e=e||{},d=e.url||"",y=(d+=d.lastIndexOf("/")===d.length-1||""===d?"":"/",e.version||C.Versions.VERSION2),g=e.sizes||[],t=e.size,m=((0,R.assert)(null!=t&&Array.isArray(t)&&2==t.length&&!isNaN(t[0])&&0<t[0]&&!isNaN(t[1])&&0<t[1],60),t[0]),v=t[1],t=e.tileSize,r=e.tilePixelRatio||1,b=e.format||"jpg",_=e.quality||(e.version==C.Versions.VERSION1?"native":"default"),w=e.resolutions||[],x=e.supports||[],n=e.extent||[0,-v,m,0],S=null!=g&&Array.isArray(g)&&0<g.length,j=void 0!==t&&("number"==typeof t&&Number.isInteger(t)&&0<t||Array.isArray(t)&&0<t.length),O=null!=x&&Array.isArray(x)&&(x.includes("regionByPx")||x.includes("regionByPct"))&&(x.includes("sizeByWh")||x.includes("sizeByH")||x.includes("sizeByW")||x.includes("sizeByPct"));if(w.sort(function(e,t){return t-e}),j||O)if(null!=t&&("number"==typeof t&&Number.isInteger(t)&&0<t?p=h=t:Array.isArray(t)&&0<t.length&&((1==t.length||null==t[1]&&Number.isInteger(t[0]))&&(h=t[0],p=t[0]),2==t.length)&&(Number.isInteger(t[0])&&Number.isInteger(t[1])?(h=t[0],p=t[1]):null==t[0]&&Number.isInteger(t[1])&&(h=t[1],p=t[1]))),void 0!==h&&void 0!==p||(h=T.DEFAULT_TILE_SIZE,p=T.DEFAULT_TILE_SIZE),0==w.length)for(var P,i=P=Math.max(Math.ceil(Math.log(m/h)/Math.LN2),Math.ceil(Math.log(v/p)/Math.LN2));0<=i;i--)w.push(Math.pow(2,i));else{var o=Math.max.apply(Math,A(w));P=Math.round(Math.log(o)/Math.LN2)}else if(h=m,p=v,w=[],S){g.sort(function(e,t){return e[0]-t[0]}),P=-1;for(var a=[],s=0;s<g.length;s++){var u=m/g[s][0];0<w.length&&w[w.length-1]==u?a.push(s):(w.push(u),P++)}if(0<a.length)for(var l=0;l<a.length;l++)g.splice(a[l]-l,1)}else w.push(1),g.push([m,v]),P=0;o=new k.default({tileSize:[h,p],extent:n,origin:(0,M.getTopLeft)(n),resolutions:w}),n=E.CustomTile.bind(null,(0,I.toSize)(t||256).map(function(e){return e*r}));return(t=c.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:e.state,tileClass:n,tileGrid:o,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:function(e,t,r){var n=e[0];if(!(P<n)){var i,o,a,s,u,l,c=e[1],e=e[2],f=w[n];if(!(void 0===c||void 0===e||void 0===f||c<0||Math.ceil(m/f/h)<=c||e<0||Math.ceil(v/f/p)<=e))return O||j?(m<(c=c*h*f)+(i=h*f)&&(i=m-c),v<(u=e*(e=p)*f)+(o=p*f)&&(o=v-u),m<c+(a=h)*f&&(a=Math.floor((m-c+f-1)/f)),v<u+p*f&&(e=Math.floor((v-u+f-1)/f)),0==c&&i==m&&0==u&&o==v?s="full":!O||x.includes("regionByPx")?s=c+","+u+","+i+","+o:x.includes("regionByPct")&&(s="pct:"+L(c/m*100)+","+L(u/v*100)+","+L(i/m*100)+","+L(o/v*100)),y!=C.Versions.VERSION3||O&&!x.includes("sizeByWh")?!O||x.includes("sizeByW")?l=a+",":x.includes("sizeByH")?l=","+e:x.includes("sizeByWh")?l=a+","+e:x.includes("sizeByPct")&&(l="pct:"+L(100/f)):l=a+","+e):(s="full",l=S?(c=g[n][0],u=g[n][1],y==C.Versions.VERSION3?c==m&&u==v?"max":c+","+u:c==m?"full":c+","):y==C.Versions.VERSION3?"max":"full"),d+s+"/"+l+"/0/"+_+"."+b}},transition:e.transition})).zDirection=e.zDirection,t}return t=f,r&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.default);r.default=e},{"../asserts.js":105,"../extent.js":131,"../format/IIIFInfo.js":145,"../size.js":319,"../tilegrid/TileGrid.js":373,"../tilegrid/common.js":375,"./TileImage.js":341,"./Zoomify.js":351}],327:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ImageSourceEventType=r.ImageSourceEvent=void 0,r.defaultImageLoadFunction=function(e,t){e.getImage().src=t};var o=n(e("../events/Event.js")),a=n(e("../ImageState.js")),s=n(e("../reproj/Image.js")),u=n(e("./Source.js")),l=e("../util.js"),c=e("../extent.js"),f=e("../proj.js"),h=e("../array.js");function n(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function d(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},w=(r.ImageSourceEventType=_,function(){g(n,o["default"]);var r=v(n);function n(e,t){return y(this,n),(e=r.call(this,e)).image=t,e}return d(n)}()),e=(r.ImageSourceEvent=w,function(){g(n,u["default"]);var r=v(n);function n(e){var t;return y(this,n),(t=r.call(this,{attributions:e.attributions,projection:e.projection,state:e.state,interpolate:void 0===e.interpolate||e.interpolate})).on,t.once,t.un,t.resolutions_=void 0!==e.resolutions?e.resolutions:null,t.reprojectedImage_=null,t.reprojectedRevision_=0,t}return d(n,[{key:"getResolutions",value:function(){return this.resolutions_}},{key:"findNearestResolution",value:function(e){var t;return this.resolutions_&&(t=(0,h.linearFindNearest)(this.resolutions_,e,0),e=this.resolutions_[t]),e}},{key:"getImage",value:function(e,t,r,n){var i=this.getProjection();if(i&&n&&!(0,f.equivalent)(i,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,f.equivalent)(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==t&&(0,c.equals)(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new s.default(i,n,e,t,r,function(e,t,r){return this.getImageInternal(e,t,r,i)}.bind(this),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return this.getImageInternal(e,t,r,n=i?i:n)}},{key:"getImageInternal",value:function(e,t,r,n){return(0,l.abstract)()}},{key:"handleImageChange",value:function(e){var t,e=e.target;switch(e.getState()){case a.default.LOADING:this.loading=!0,t=_.IMAGELOADSTART;break;case a.default.LOADED:this.loading=!1,t=_.IMAGELOADEND;break;case a.default.ERROR:this.loading=!1,t=_.IMAGELOADERROR;break;default:return}this.hasListener(t)&&this.dispatchEvent(new w(t,e))}}]),n}());r.default=e},{"../ImageState.js":80,"../array.js":104,"../events/Event.js":126,"../extent.js":131,"../proj.js":271,"../reproj/Image.js":313,"../util.js":379,"./Source.js":335}],328:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=n(e("../events/EventType.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Image.js")),f=n(e("../Image.js")),s=e("../uri.js"),u=e("../asserts.js"),h=e("../extent.js");function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=y(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:(e=e||{}).attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions})).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,t.hidpi_=void 0===e.hidpi||e.hidpi,t.url_=e.url,t.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:o.defaultImageLoadFunction,t.params_=e.params||{},t.image_=null,t.imageSize_=[0,0],t.renderedRevision_=0,t.ratio_=void 0!==e.ratio?e.ratio:1.5,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getParams",value:function(){return this.params_}},{key:"getImageInternal",value:function(e,t,r,n){if(void 0===this.url_)return null;t=this.findNearestResolution(t),r=this.hidpi_?r:1;var i,o,a,s,u,l=this.image_;return l&&this.renderedRevision_==this.getRevision()&&l.getResolution()==t&&l.getPixelRatio()==r&&(0,h.containsExtent)(l.getExtent(),e)?l:(l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0},Object.assign(l,this.params_),u=((e=e.slice())[0]+e[2])/2,i=(e[1]+e[3])/2,1!=this.ratio_&&(o=this.ratio_*(0,h.getWidth)(e)/2,a=this.ratio_*(0,h.getHeight)(e)/2,e[0]=u-o,e[1]=i-a,e[2]=u+o,e[3]=i+a),o=t/r,a=Math.ceil((0,h.getWidth)(e)/o),s=Math.ceil((0,h.getHeight)(e)/o),e[0]=u-o*a/2,e[2]=u+o*a/2,e[1]=i-o*s/2,e[3]=i+o*s/2,this.imageSize_[0]=a,this.imageSize_[1]=s,u=this.getRequestUrl_(e,this.imageSize_,r,n,l),this.image_=new f.default(e,t,r,u,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(c.default.CHANGE,this.handleImageChange.bind(this)),this.image_)}},{key:"getImageLoadFunction",value:function(){return this.imageLoadFunction_}},{key:"getRequestUrl_",value:function(e,t,r,n,i){n=n.getCode().split(/:(?=\d+$)/).pop(),i.SIZE=t[0]+","+t[1],i.BBOX=e.join(","),i.BBOXSR=n,i.IMAGESR=n,i.DPI=Math.round(90*r),t=this.url_,e=t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return e==t&&(0,u.assert)(!1,50),(0,s.appendParams)(e,i)}},{key:"getUrl",value:function(){return this.url_}},{key:"setImageLoadFunction",value:function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}},{key:"setUrl",value:function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.image_=null,this.changed()}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../Image.js":77,"../asserts.js":105,"../events/EventType.js":127,"../extent.js":131,"../uri.js":378,"./Image.js":327}],329:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("../ImageCanvas.js")),n=o(e("./Image.js")),u=e("../extent.js");function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,n=c(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:(e=e||{}).attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions,state:e.state})).canvasFunction_=e.canvasFunction,t.canvas_=null,t.renderedRevision_=0,t.ratio_=void 0!==e.ratio?e.ratio:1.5,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getImageInternal",value:function(e,t,r,n){t=this.findNearestResolution(t);var i,o,a=this.canvas_;return a&&this.renderedRevision_==this.getRevision()&&a.getResolution()==t&&a.getPixelRatio()==r&&(0,u.containsExtent)(a.getExtent(),e)||(e=e.slice(),(0,u.scaleFromCenter)(e,this.ratio_),o=(0,u.getWidth)(e)/t,i=(0,u.getHeight)(e)/t,(o=this.canvasFunction_.call(this,e,t,r,[o*r,i*r],n))&&(a=new s.default(e,t,r,o)),this.canvas_=a,this.renderedRevision_=this.getRevision()),a}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../ImageCanvas.js":79,"../extent.js":131,"./Image.js":327}],330:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=n(e("../events/EventType.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Image.js")),u=n(e("../Image.js")),f=e("../uri.js"),h=e("../extent.js");function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions})).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,t.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,t.params_=e.params||{},t.url_=e.url,t.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:o.defaultImageLoadFunction,t.hidpi_=void 0===e.hidpi||e.hidpi,t.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,t.ratio_=void 0!==e.ratio?e.ratio:1,t.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,t.image_=null,t.renderedRevision_=0,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getParams",value:function(){return this.params_}},{key:"getImageInternal",value:function(e,t,r,n){t=this.findNearestResolution(t),r=this.hidpi_?r:1;var i,o,a=this.image_;return a&&this.renderedRevision_==this.getRevision()&&a.getResolution()==t&&a.getPixelRatio()==r&&(0,h.containsExtent)(a.getExtent(),e)||(1!=this.ratio_&&(e=e.slice(),(0,h.scaleFromCenter)(e,this.ratio_)),o=(0,h.getWidth)(e)/t,i=(0,h.getHeight)(e)/t,void 0!==this.url_?(o=this.getUrl(this.url_,this.params_,e,[o*r,i*r],n),(a=new u.default(e,t,r,o,this.crossOrigin_,this.imageLoadFunction_)).addEventListener(s.default.CHANGE,this.handleImageChange.bind(this))):a=null,this.image_=a,this.renderedRevision_=this.getRevision()),a}},{key:"getImageLoadFunction",value:function(){return this.imageLoadFunction_}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.changed()}},{key:"getUrl",value:function(e,t,r,n,i){c=r,o=n,a=this.metersPerUnit_,s=this.displayDpi_,u=(0,h.getWidth)(c),c=(0,h.getHeight)(c),l=o[0],o=o[1],s=.0254/s;var o,a,s,u=l*c<o*u?u*a/(l*s):c*a/(o*s),l=(0,h.getCenter)(r),c={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(n[0]),SETDISPLAYHEIGHT:Math.round(n[1]),SETVIEWSCALE:u,SETVIEWCENTERX:l[0],SETVIEWCENTERY:l[1]};return Object.assign(c,t),(0,f.appendParams)(e,c)}},{key:"setImageLoadFunction",value:function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../Image.js":77,"../events/EventType.js":127,"../extent.js":131,"../uri.js":378,"./Image.js":327}],331:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=n(e("../events/EventType.js")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=c(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Image.js")),f=n(e("../ImageState.js")),u=n(e("../Image.js")),h=e("../dom.js"),p=e("../extent.js"),l=e("../proj.js");function c(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(c=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function y(){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=c;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e);var r,i=m(c);function c(e){var t,r,n;if(this instanceof c)return t=void 0!==e.crossOrigin?e.crossOrigin:null,r=void 0!==e.imageLoadFunction?e.imageLoadFunction:s.defaultImageLoadFunction,(n=i.call(this,{attributions:e.attributions,interpolate:e.interpolate,projection:(0,l.get)(e.projection)})).url_=e.url,n.imageExtent_=e.imageExtent,n.image_=new u.default(n.imageExtent_,void 0,1,n.url_,t,r),n.imageSize_=e.imageSize||null,n.image_.addEventListener(o.default.CHANGE,n.handleImageChange.bind(v(n))),n;throw new TypeError("Cannot call a class as a function")}return t=c,(e=[{key:"getImageExtent",value:function(){return this.imageExtent_}},{key:"getImageInternal",value:function(e,t,r,n){return(0,p.intersects)(e,this.image_.getExtent())?this.image_:null}},{key:"getUrl",value:function(){return this.url_}},{key:"handleImageChange",value:function(e){var t,r,n,i,o,a,s,u,l;this.image_.getState()==f.default.LOADED&&(i=this.image_.getExtent(),t=this.image_.getImage(),n=this.imageSize_?(r=this.imageSize_[0],this.imageSize_[1]):(r=t.width,t.height),u=(0,p.getWidth)(i),a=r,s=n,(l=(i=(0,p.getHeight)(i))/n)<(o=u/r)?a=Math.round(u/l):s=Math.round(i/o),a===r&&s===n||(u=(0,h.createCanvasContext2D)(a,s),this.getInterpolate()||(u.imageSmoothingEnabled=!1),l=u.canvas,u.drawImage(t,0,0,r,n,0,0,l.width,l.height),this.image_.setImage(l))),y(b(c.prototype),"handleImageChange",this).call(this,e)}}])&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(s.default);r.default=e},{"../Image.js":77,"../ImageState.js":80,"../dom.js":123,"../events/EventType.js":127,"../extent.js":131,"../proj.js":271,"./Image.js":327}],332:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=n(e("../events/EventType.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=m(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Image.js")),l=n(e("../Image.js")),c=e("./wms.js"),s=e("../uri.js"),f=e("../asserts.js"),h=e("../reproj.js"),p=e("../math.js"),d=e("../string.js"),y=e("../extent.js"),g=e("../proj.js");function m(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(m=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=[101,101],e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e);var r,n=_(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:(e=e||{}).attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions})).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,t.url_=e.url,t.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:o.defaultImageLoadFunction,t.params_=Object.assign({},e.params),t.v13_=!0,t.updateV13_(),t.serverType_=e.serverType,t.hidpi_=void 0===e.hidpi||e.hidpi,t.image_=null,t.imageSize_=[0,0],t.renderedRevision_=0,t.ratio_=void 0!==e.ratio?e.ratio:1.5,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getFeatureInfoUrl",value:function(e,t,r,n){var i,o,a;if(void 0!==this.url_)return r=(0,g.get)(r),(i=this.getProjection())&&i!==r&&(t=(0,h.calculateSourceResolution)(i,r,e,t),e=(0,g.transform)(e,r,i)),o=(0,y.getForViewAndSize)(e,t,0,w),a={SERVICE:"WMS",VERSION:c.DEFAULT_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS},Object.assign(a,this.params_,n),n=(0,p.floor)((e[0]-o[0])/t,4),e=(0,p.floor)((o[3]-e[1])/t,4),a[this.v13_?"I":"X"]=n,a[this.v13_?"J":"Y"]=e,this.getRequestUrl_(o,w,1,i||r,a)}},{key:"getLegendUrl",value:function(e,t){if(void 0!==this.url_){var r={SERVICE:"WMS",VERSION:c.DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){var n=this.params_.LAYERS;if(!(!Array.isArray(n)||1===n.length))return;r.LAYER=n}return void 0!==e&&(n=this.getProjection()?this.getProjection().getMetersPerUnit():1,r.SCALE=e*n/28e-5),Object.assign(r,t),(0,s.appendParams)(this.url_,r)}}},{key:"getParams",value:function(){return this.params_}},{key:"getImageInternal",value:function(e,t,r,n){var i,o,a,s;return void 0===this.url_?null:(i=(t=this.findNearestResolution(t))/(r=1==r||this.hidpi_&&void 0!==this.serverType_?r:1),o=(0,y.getCenter)(e),s=(0,p.ceil)((0,y.getWidth)(e)/i,4),a=(0,p.ceil)((0,y.getHeight)(e)/i,4),s=(0,y.getForViewAndSize)(o,i,0,[s,a]),a=(0,p.ceil)(this.ratio_*(0,y.getWidth)(e)/i,4),e=(0,p.ceil)(this.ratio_*(0,y.getHeight)(e)/i,4),o=(0,y.getForViewAndSize)(o,i,0,[a,e]),(a=this.image_)&&this.renderedRevision_==this.getRevision()&&a.getResolution()==t&&a.getPixelRatio()==r&&(0,y.containsExtent)(a.getExtent(),s)?a:(e={SERVICE:"WMS",VERSION:c.DEFAULT_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0},Object.assign(e,this.params_),this.imageSize_[0]=(0,p.round)((0,y.getWidth)(o)/i,4),this.imageSize_[1]=(0,p.round)((0,y.getHeight)(o)/i,4),s=this.getRequestUrl_(o,this.imageSize_,r,n,e),this.image_=new l.default(o,t,r,s,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(u.default.CHANGE,this.handleImageChange.bind(this)),this.image_))}},{key:"getImageLoadFunction",value:function(){return this.imageLoadFunction_}},{key:"getRequestUrl_",value:function(e,t,r,n,i){if((0,f.assert)(void 0!==this.url_,9),i[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(i.STYLES=""),1!=r)switch(this.serverType_){case"geoserver":var o=90*r+.5|0;"FORMAT_OPTIONS"in i?i.FORMAT_OPTIONS+=";dpi:"+o:i.FORMAT_OPTIONS="dpi:"+o;break;case"mapserver":i.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":i.DPI=90*r;break;default:(0,f.assert)(!1,8)}i.WIDTH=t[0],i.HEIGHT=t[1];t=n.getAxisOrientation(),n=this.v13_&&"ne"==t.substr(0,2)?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=n.join(","),(0,s.appendParams)(this.url_,i)}},{key:"getUrl",value:function(){return this.url_}},{key:"setImageLoadFunction",value:function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}},{key:"setUrl",value:function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.updateV13_(),this.image_=null,this.changed()}},{key:"updateV13_",value:function(){var e=this.params_.VERSION||c.DEFAULT_VERSION;this.v13_=0<=(0,d.compareVersions)(e,"1.3")}}])&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.default);r.default=e},{"../Image.js":77,"../asserts.js":105,"../events/EventType.js":127,"../extent.js":131,"../math.js":267,"../proj.js":271,"../reproj.js":312,"../string.js":354,"../uri.js":378,"./Image.js":327,"./wms.js":352}],333:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ATTRIBUTION=void 0;e=(e=e("./XYZ.js"))&&e.__esModule?e:{default:e};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',e=(r.ATTRIBUTION=l,function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){var t,r,n;if(this instanceof o)return t=void 0!==(e=e||{}).attributions?e.attributions:[l],r=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",n=void 0!==e.url?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",i.call(this,{attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,opaque:void 0===e.opaque||e.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:n,wrapX:e.wrapX,zDirection:e.zDirection});throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e.default));r.default=e},{"./XYZ.js":350}],334:[function(D,e,F){!function(L){!function(){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(F,"__esModule",{value:!0}),F.default=F.RasterSourceEvent=F.Processor=void 0,F.newImageData=k;var e=r(D("../Disposable.js")),t=r(D("../events/Event.js")),s=r(D("../events/EventType.js")),u=r(D("../ImageCanvas.js")),l=r(D("../layer/Image.js")),c=r(D("./Image.js")),f=r(D("./Source.js")),h=r(D("../layer/Tile.js")),p=r(D("../TileQueue.js")),d=r(D("./Tile.js")),y=D("../dom.js"),g=D("../transform.js"),m=D("../extent.js"),v=D("../util.js");function r(e){return e&&e.__esModule?e:{default:e}}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function _(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=j(r),t=(e=n?(e=j(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O,P=!0;try{new ImageData(10,10)}catch(e){P=!1}function k(e,t,r){return P?new ImageData(e,t,r):((t=(O=O||document.createElement("canvas").getContext("2d")).createImageData(t,r)).data.set(e),t)}function E(w){var x=!0;try{new ImageData(10,10)}catch(e){x=!1}return function(e){var t,r,n,i=e.buffers,o=e.meta,a=e.imageOps,s=e.width,u=e.height,l=i.length,c=i[0].byteLength;if(a){for(var f=new Array(l),h=0;h<l;++h)f[h]=(t=new Uint8ClampedArray(i[h]),r=s,n=u,x?new ImageData(t,r,n):{data:t,width:r,height:n});return w(f,o).data.buffer}for(var p=new Uint8ClampedArray(c),d=new Array(l),y=new Array(l),g=0;g<l;++g)d[g]=new Uint8ClampedArray(i[g]),y[g]=[0,0,0,0];for(var m=0;m<c;m+=4){for(var v=0;v<l;++v){var b=d[v];y[v][0]=b[m],y[v][1]=b[m+1],y[v][2]=b[m+2],y[v][3]=b[m+3]}var _=w(y,o);p[m]=_[0],p[m+1]=_[1],p[m+2]=_[2],p[m+3]=_[3]}return p.buffer}}var T=function(){w(c,e["default"]);var l=x(c);function c(e){b(this,c),(t=l.call(this))._imageOps=!!e.imageOps,r=0===e.threads?0:!t._imageOps&&e.threads||1;var t,r,n,i,o,a,s=new Array(r);if(r)for(var u=0;u<r;++u)s[u]=function(t,e){var r=Object.keys(t.lib||{}).map(function(e){return"const "+e+" = "+t.lib[e].toString()+";"}).concat(["const __minion__ = ("+E.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]);return(r=new Worker("undefined"==typeof Blob?"data:text/javascript;base64,"+L.from(r.join("\n"),"binary").toString("base64"):URL.createObjectURL(new Blob(r,{type:"text/javascript"})))).addEventListener("message",e),r}(e,t._onWorkerMessage.bind(S(t),u));else s[0]=(n=e,i=t._onWorkerMessage.bind(S(t),0),o=E(n.operation),a=!1,{postMessage:function(e){setTimeout(function(){a||i({data:{buffer:o(e),meta:e.meta}})},0)},terminate:function(){a=!0}});return t._workers=s,t._queue=[],t._maxQueueLength=e.queue||1/0,t._running=0,t._dataLookup={},t._job=null,t}return _(c,[{key:"process",value:function(e,t,r){this._enqueue({inputs:e,meta:t,callback:r}),this._dispatch()}},{key:"_enqueue",value:function(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)}},{key:"_dispatch",value:function(){if(!this._running&&0!==this._queue.length){var e=this._queue.shift(),t=(this._job=e).inputs[0].width,r=e.inputs[0].height,n=e.inputs.map(function(e){return e.data.buffer}),i=this._workers.length;if(1===(this._running=i))this._workers[0].postMessage({buffers:n,meta:e.meta,imageOps:this._imageOps,width:t,height:r},n);else for(var o=e.inputs[0].data.length,a=4*Math.ceil(o/4/i),s=0;s<i;++s){for(var u=s*a,l=[],c=0,f=n.length;c<f;++c)l.push(n[c].slice(u,u+a));this._workers[s].postMessage({buffers:l,meta:e.meta,imageOps:this._imageOps,width:t,height:r},l)}}}},{key:"_onWorkerMessage",value:function(e,t){this.disposed||(this._dataLookup[e]=t.data,--this._running,0===this._running&&this._resolveJob())}},{key:"_resolveJob",value:function(){var e=this._job,t=this._workers.length;if(1===t)n=new Uint8ClampedArray(this._dataLookup[0].buffer),i=this._dataLookup[0].meta;else for(var r=e.inputs[0].data.length,n=new Uint8ClampedArray(r),i=new Array(t),o=4*Math.ceil(r/4/t),a=0;a<t;++a){var s=this._dataLookup[a].buffer,u=a*o;n.set(new Uint8ClampedArray(s),u),i[a]=this._dataLookup[a].meta}this._job=null,this._dataLookup={},e.callback(null,k(n,e.inputs[0].width,e.inputs[0].height),i),this._dispatch()}},{key:"disposeInternal",value:function(){for(var e=0;e<this._workers.length;++e)this._workers[e].terminate();this._workers.length=0}}]),c}();F.Processor=T;var C="beforeoperations",R="afteroperations",M=function(){w(i,t["default"]);var n=x(i);function i(e,t,r){return b(this,i),(e=n.call(this,e)).extent=t.extent,e.resolution=t.viewState.resolution/t.pixelRatio,e.data=r,e}return _(i)}(),I=(F.RasterSourceEvent=M,function(){w(a,c["default"]);var i=x(a);function a(o){b(this,a),(e=i.call(this,{projection:null})).on,e.once,e.un,e.processor_=null,e.operationType_=void 0!==o.operationType?o.operationType:"pixel",e.threads_=void 0!==o.threads?o.threads:1,e.layers_=function(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=function(e){var t;e instanceof f.default?e instanceof d.default?t=new h.default({source:e}):e instanceof c.default&&(t=new l.default({source:e})):t=e;return t}(e[n]);return r}(o.sources);for(var e,t=e.changed.bind(S(e)),r=0,n=e.layers_.length;r<n;++r)e.layers_[r].addEventListener(s.default.CHANGE,t);return e.tileQueue_=new p.default(function(){return 1},e.changed.bind(S(e))),e.requestedFrameState_,e.renderedImageCanvas_=null,e.renderedRevision_,e.frameState_={animate:!1,coordinateToPixelTransform:(0,g.create)(),declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:e.layers_.map(function(e){return e.getLayerState()}),pixelRatio:1,pixelToCoordinateTransform:(0,g.create)(),postRenderFunctions:[],size:[0,0],tileQueue:e.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:(0,v.getUid)(S(e)),renderTargets:{}},e.setAttributions(function(e){for(var t=[],r=0,n=o.sources.length;r<n;++r){var i=o.sources[r],i=(i instanceof f.default?i:i.getSource()).getAttributions();"function"==typeof i&&(i=i(e),t.push.apply(t,i))}return 0!==t.length?t:null}),void 0!==o.operation&&e.setOperation(o.operation,o.lib),e}return _(a,[{key:"setOperation",value:function(e,t){this.processor_&&this.processor_.dispose(),this.processor_=new T({operation:e,imageOps:"image"===this.operationType_,queue:1,lib:t,threads:this.threads_}),this.changed()}},{key:"updateFrameState_",value:function(e,t,r){var n=Object.assign({},this.frameState_),i=(n.viewState=Object.assign({},n.viewState),(0,m.getCenter)(e)),e=(n.extent=e.slice(),n.size[0]=Math.round((0,m.getWidth)(e)/t),n.size[1]=Math.round((0,m.getHeight)(e)/t),n.time=Date.now(),n.viewState);return e.center=i,e.projection=r,e.resolution=t,n}},{key:"allSourcesReady_",value:function(){for(var e=!0,t=0,r=this.layers_.length;t<r;++t)if("ready"!==this.layers_[t].getSource().getState()){e=!1;break}return e}},{key:"getImage",value:function(e,t,r,n){var i,o;return this.allSourcesReady_()?(n=this.updateFrameState_(e,t,n),this.requestedFrameState_=n,this.renderedImageCanvas_&&(i=this.renderedImageCanvas_.getResolution(),o=this.renderedImageCanvas_.getExtent(),t===i&&(0,m.equals)(e,o)||(this.renderedImageCanvas_=null)),this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),n.tileQueue.loadMoreTiles(16,16),n.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_):null}},{key:"processSources_",value:function(){for(var e=this.requestedFrameState_,t=this.layers_.length,r=new Array(t),n=0;n<t;++n){e.layerIndex=n;var i=function(e,t){var r=e.getRenderer();if(!r)throw new Error("Unsupported layer type: "+e);if(!r.prepareFrame(t))return null;var e=t.size[0],n=t.size[1];if(0===e||0===n)return null;var i,r=r.renderFrame(t,null);if(r instanceof HTMLCanvasElement)i=r;else{if(!((i=r?r.firstElementChild:i)instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+i);if(i.width===e&&i.height===n)return i.getContext("2d").getImageData(0,0,e,n)}!A||(t=A.canvas).width!==e||t.height!==n?A=(0,y.createCanvasContext2D)(e,n):A.clearRect(0,0,e,n);return A.drawImage(i,0,0,e,n),A.getImageData(0,0,e,n)}(this.layers_[n],e);if(!i)return;r[n]=i}var o={};this.dispatchEvent(new M(C,e,o)),this.processor_.process(r,o,this.onWorkerComplete_.bind(this,e))}},{key:"onWorkerComplete_",value:function(e,t,r,n){var i,o,a,s;!t&&r&&(t=e.extent,(i=e.viewState.resolution)===this.requestedFrameState_.viewState.resolution)&&(0,m.equals)(t,this.requestedFrameState_.extent)&&(this.renderedImageCanvas_?s=this.renderedImageCanvas_.getImage().getContext("2d"):(o=Math.round((0,m.getWidth)(t)/i),a=Math.round((0,m.getHeight)(t)/i),s=(0,y.createCanvasContext2D)(o,a),this.renderedImageCanvas_=new u.default(t,i,1,s.canvas)),s.putImageData(r,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new M(R,e,n)),e.animate)&&requestAnimationFrame(this.changed.bind(this))}},{key:"disposeInternal",value:function(){this.processor_&&this.processor_.dispose(),n(j(a.prototype),"disposeInternal",this).call(this)}}]),a}()),A=(I.prototype.dispose,null);F.default=I}.call(this)}.call(this,D("buffer").Buffer)},{"../Disposable.js":74,"../ImageCanvas.js":79,"../TileQueue.js":96,"../dom.js":123,"../events/Event.js":126,"../events/EventType.js":127,"../extent.js":131,"../layer/Image.js":255,"../layer/Tile.js":259,"../transform.js":377,"../util.js":379,"./Image.js":327,"./Source.js":335,"./Tile.js":337,buffer:6}],335:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../Object.js"))&&n.__esModule?n:{default:n},o=e("../util.js"),a=e("../proj.js");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(r),t=(e=n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=l(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this)).projection=(0,a.get)(e.projection),t.attributions_=h(e.attributions),t.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,t.loading=!1,t.state_=void 0!==e.state?e.state:"ready",t.wrapX_=void 0!==e.wrapX&&e.wrapX,t.interpolate_=!!e.interpolate,t.viewResolver=null,t.viewRejector=null;var r=c(t);return t.viewPromise_=new Promise(function(e,t){r.viewResolver=e,r.viewRejector=t}),t}return t=i,(e=[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(){return(0,o.abstract)()}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(e){this.attributions_=h(e),this.changed()}},{key:"setState",value:function(e){this.state_=e,this.changed()}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function h(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}r.default=e},{"../Object.js":90,"../proj.js":271,"../util.js":379}],336:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./XYZ.js"))&&n.__esModule?n:{default:n};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',e("./OSM.js").ATTRIBUTION],c={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},f={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n,i=u(o);function o(e){var t,r,n;if(this instanceof o)return t=-1==(t=e.layer.indexOf("-"))?e.layer:e.layer.slice(0,t),t=f[t],r=c[e.layer],n=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+r.extension,i.call(this,{attributions:l,cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,maxZoom:(null!=e.maxZoom?e:t).maxZoom,minZoom:(null!=e.minZoom?e:t).minZoom,opaque:r.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:n,wrapX:e.wrapX,zDirection:e.zDirection});throw new TypeError("Cannot call a class as a function")}return t=o,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.default);r.default=e},{"./OSM.js":333,"./XYZ.js":350}],337:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.TileSourceEvent=void 0;var o=n(e("../events/Event.js")),a=n(e("./Source.js")),s=n(e("../TileCache.js")),c=n(e("../TileState.js")),u=e("../util.js"),l=e("../asserts.js"),f=e("../proj.js"),h=e("../tilecoord.js"),p=e("../tilegrid.js"),d=e("../size.js");function n(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function m(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=x(r),t=(e=n?(e=x(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){b(n,a["default"]);var r=w(n);function n(e){var t;y(this,n),(t=r.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate})).on,t.once,t.un,t.opaque_=void 0!==e.opaque&&e.opaque,t.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,t.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;return t.tileGrid&&(0,d.toSize)(t.tileGrid.getTileSize(t.tileGrid.getMinZoom()),[256,256]),t.tileCache=new s.default(e.cacheSize||0),t.tmpSize=[0,0],t.key_=e.key||"",t.tileOptions={transition:e.transition,interpolate:e.interpolate},t.zDirection=e.zDirection||0,t}return m(n,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(e,t){e=this.getTileCacheForProjection(e);e&&e.expireCache(t)}},{key:"forEachLoadedTile",value:function(e,t,r,n){var i=this.getTileCacheForProjection(e);if(!i)return!1;for(var o,a,s=!0,u=r.minX;u<=r.maxX;++u)for(var l=r.minY;l<=r.maxY;++l)o=(0,h.getKeyZXY)(t,u,l),a=!1,(a=i.containsKey(o)?(a=(o=i.get(o)).getState()===c.default.LOADED)&&!1!==n(o):a)||(s=!1);return s}},{key:"getGutterForProjection",value:function(e){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(e){this.key_!==e&&(this.key_=e,this.changed())}},{key:"getOpaque",value:function(e){return this.opaque_}},{key:"getResolutions",value:function(){return this.tileGrid?this.tileGrid.getResolutions():null}},{key:"getTile",value:function(e,t,r,n,i){return(0,u.abstract)()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(e){return this.tileGrid||(0,p.getForProjection)(e)}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();return(0,l.assert)(null===t||(0,f.equivalent)(t,e),68),this.tileCache}},{key:"getTilePixelRatio",value:function(e){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(e,t,r){r=this.getTileGridForProjection(r),t=this.getTilePixelRatio(t),r=(0,d.toSize)(r.getTileSize(e),this.tmpSize);return 1==t?r:(0,d.scale)(r,t,this.tmpSize)}},{key:"getTileCoordForTileUrlFunction",value:function(e,t){t=void 0!==t?t:this.getProjection();var r=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=(0,p.wrapX)(r,e,t)),(0,h.withinExtentAndZ)(e,r)?e:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),v(x(n.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(e,t){t=this.getTileCacheForProjection(t);e>t.highWaterMark&&(t.highWaterMark=e)}},{key:"useTile",value:function(e,t,r,n){}}]),n}(),r.TileSourceEvent=function(){b(n,o["default"]);var r=w(n);function n(e,t){return y(this,n),(e=r.call(this,e)).tile=t,e}return m(n)}();r.default=e},{"../TileCache.js":95,"../TileState.js":98,"../asserts.js":105,"../events/Event.js":126,"../proj.js":271,"../size.js":319,"../tilecoord.js":371,"../tilegrid.js":372,"../util.js":379,"./Source.js":335}],338:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./TileImage.js"))&&n.__esModule?n:{default:n},s=e("../uri.js"),o=e("../extent.js"),u=e("../math.js"),a=e("../size.js"),l=e("../tilecoord.js");function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=h(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:(e=e||{}).attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})).params_=e.params||{},t.hidpi_=void 0===e.hidpi||e.hidpi,t.tmpExtent_=(0,o.createEmpty)(),t.setKey(t.getKeyForParams_()),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getKeyForParams_",value:function(){var e,t=0,r=[];for(e in this.params_)r[t++]=e+"-"+this.params_[e];return r.join("/")}},{key:"getParams",value:function(){return this.params_}},{key:"getRequestUrl_",value:function(e,t,r,n,i,o){var a=this.urls;if(a)return i=i.getCode().split(/:(?=\d+$)/).pop(),o.SIZE=t[0]+","+t[1],o.BBOX=r.join(","),o.BBOXSR=i,o.IMAGESR=i,o.DPI=Math.round(o.DPI?o.DPI*n:90*n),t=(1==a.length?a[0]:a[(0,u.modulo)((0,l.hash)(e),a.length)]).replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),(0,s.appendParams)(t,o)}},{key:"getTilePixelRatio",value:function(e){return this.hidpi_?e:1}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.setKey(this.getKeyForParams_())}},{key:"tileUrlFunction",value:function(e,t,r){var n,i,o=(o=this.getTileGrid())||this.getTileGridForProjection(r);if(!(o.getResolutions().length<=e[0]))return 1==t||this.hidpi_||(t=1),n=o.getTileCoordExtent(e,this.tmpExtent_),o=(0,a.toSize)(o.getTileSize(e[0]),this.tmpSize),1!=t&&(o=(0,a.scale)(o,t,this.tmpSize)),i={F:"image",FORMAT:"PNG32",TRANSPARENT:!0},Object.assign(i,this.params_),this.getRequestUrl_(e,o,n,t,r,i)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../extent.js":131,"../math.js":267,"../size.js":319,"../tilecoord.js":371,"../uri.js":378,"./TileImage.js":341}],339:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./XYZ.js"))&&n.__esModule?n:{default:n},s=e("../dom.js"),u=e("../size.js");function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n,o=f(a);function a(e){var i;if(this instanceof a)return i=o.call(this,{opaque:!1,projection:(e=e||{}).projection,tileGrid:e.tileGrid,wrapX:void 0===e.wrapX||e.wrapX,zDirection:e.zDirection,url:e.template||"z:{z} x:{x} y:{y}",tileLoadFunction:function(e,t){var r=e.getTileCoord()[0],r=(0,u.toSize)(i.tileGrid.getTileSize(r)),n=(0,s.createCanvasContext2D)(r[0],r[1]);n.strokeStyle="grey",n.strokeRect(.5,.5,r[0]+.5,r[1]+.5),n.fillStyle="grey",n.strokeStyle="white",n.textAlign="center",n.textBaseline="middle",n.font="24px sans-serif",n.lineWidth=4,n.strokeText(t,r[0]/2,r[1]/2,r[0]),n.fillText(t,r[0]/2,r[1]/2,r[0]),e.setImage(n.canvas)}});throw new TypeError("Cannot call a class as a function")}return t=a,r&&l(t.prototype,r),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.default);r.default=e},{"../dom.js":123,"../size.js":319,"./XYZ.js":350}],340:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"}},{}],341:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=f(e("../events/EventType.js")),o=f(e("../ImageTile.js")),d=f(e("../reproj/Tile.js")),s=f(e("../TileCache.js")),l=f(e("../TileState.js")),n=f(e("./UrlTile.js")),y=e("../proj.js"),g=e("../tilecoord.js"),u=e("../tilegrid.js"),c=e("../util.js");function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e);var r,n=v(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction||_,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:void 0===e.interpolate||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})).crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,t.tileClass=void 0!==e.tileClass?e.tileClass:o.default,t.tileCacheForProjection={},t.tileGridForProjection={},t.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,t.renderReprojectionEdges_=!1,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(e,t){var r,n=this.getTileCacheForProjection(e);for(r in this.tileCache.expireCache(this.tileCache==n?t:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[r];i.expireCache(i==n?t:{})}}},{key:"getGutterForProjection",value:function(e){return this.getProjection()&&e&&!(0,y.equivalent)(this.getProjection(),e)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var e=p(b(i.prototype),"getKey",this).call(this);return this.getInterpolate()||(e+=":disable-interpolation"),e}},{key:"getOpaque",value:function(e){return!(this.getProjection()&&e&&!(0,y.equivalent)(this.getProjection(),e))&&p(b(i.prototype),"getOpaque",this).call(this,e)}},{key:"getTileGridForProjection",value:function(e){var t=this.getProjection();return!this.tileGrid||t&&!(0,y.equivalent)(t,e)?((t=(0,c.getUid)(e))in this.tileGridForProjection||(this.tileGridForProjection[t]=(0,u.getForProjection)(e)),this.tileGridForProjection[t]):this.tileGrid}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();return!t||(0,y.equivalent)(t,e)?this.tileCache:((t=(0,c.getUid)(e))in this.tileCacheForProjection||(this.tileCacheForProjection[t]=new s.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[t])}},{key:"createTile_",value:function(e,t,r,n,i,o){e=[e,t,r],t=this.getTileCoordForTileUrlFunction(e,i),r=t?this.tileUrlFunction(t,n,i):void 0,t=new this.tileClass(e,void 0!==r?l.default.IDLE:l.default.EMPTY,void 0!==r?r:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return t.key=o,t.addEventListener(a.default.CHANGE,this.handleTileChange.bind(this)),t}},{key:"getTile",value:function(e,t,r,n,i){var o,a,s,u,l,c,f,h,p=this.getProjection();return p&&i&&!(0,y.equivalent)(p,i)?(o=this.getTileCacheForProjection(i),u=(0,g.getKey)(a=[e,t,r]),o.containsKey(u)&&(s=o.get(u)),l=this.getKey(),s&&s.key==l?s:(h=this.getTileGridForProjection(p),c=this.getTileGridForProjection(i),f=this.getTileCoordForTileUrlFunction(a,i),(h=new d.default(p,h,i,c,a,f,this.getTilePixelRatio(n),this.getGutter(),function(e,t,r,n){return this.getTileInternal(e,t,r,n,p)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate())).key=l,s?(h.interimTile=s,h.refreshInterimChain(),o.replace(u,h)):o.set(u,h),h)):this.getTileInternal(e,t,r,n,p||i)}},{key:"getTileInternal",value:function(e,t,r,n,i){var o,a=null,s=(0,g.getKeyZXY)(e,t,r),u=this.getKey();return this.tileCache.containsKey(s)?(a=this.tileCache.get(s)).key!=u&&(o=a,a=this.createTile_(e,t,r,n,i,u),o.getState()==l.default.IDLE?a.interimTile=o.interimTile:a.interimTile=o,a.refreshInterimChain(),this.tileCache.replace(s,a)):(a=this.createTile_(e,t,r,n,i,u),this.tileCache.set(s,a)),a}},{key:"setRenderReprojectionEdges",value:function(e){if(this.renderReprojectionEdges_!=e){for(var t in this.renderReprojectionEdges_=e,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(e,t){var e=(0,y.get)(e);!e||(e=(0,c.getUid)(e))in this.tileGridForProjection||(this.tileGridForProjection[e]=t)}},{key:"clear",value:function(){for(var e in p(b(i.prototype),"clear",this).call(this),this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function _(e,t){e.getImage().src=t}r.default=e},{"../ImageTile.js":81,"../TileCache.js":95,"../TileState.js":98,"../events/EventType.js":127,"../proj.js":271,"../reproj/Tile.js":314,"../tilecoord.js":371,"../tilegrid.js":372,"../util.js":379,"./UrlTile.js":345}],342:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./TileImage.js"))&&n.__esModule?n:{default:n},a=e("../extent.js"),o=e("../asserts.js"),s=e("../tileurlfunction.js"),u=e("../tilegrid.js"),l=e("../proj.js"),c=e("../net.js");function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){var t,r;if(this instanceof i)return(t=n.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:(0,l.get)("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})).tileJSON_=null,t.tileSize_=e.tileSize,e.url?e.jsonp?(0,c.jsonp)(e.url,t.handleTileJSONResponse.bind(d(t)),t.handleTileJSONError.bind(d(t))):((r=new XMLHttpRequest).addEventListener("load",t.onXHRLoad_.bind(d(t))),r.addEventListener("error",t.onXHRError_.bind(d(t))),r.open("GET",e.url),r.send()):e.tileJSON?t.handleTileJSONResponse(e.tileJSON):(0,o.assert)(!1,51),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"onXHRLoad_",value:function(e){var t,e=e.target;if(!e.status||200<=e.status&&e.status<300){try{t=JSON.parse(e.responseText)}catch(e){return void this.handleTileJSONError()}this.handleTileJSONResponse(t)}else this.handleTileJSONError()}},{key:"onXHRError_",value:function(e){this.handleTileJSONError()}},{key:"getTileJSON",value:function(){return this.tileJSON_}},{key:"handleTileJSONResponse",value:function(t){var e,r,n=(0,l.get)("EPSG:4326"),i=this.getProjection(),n=(void 0!==t.bounds&&(n=(0,l.getTransformFromProjections)(n,i),e=(0,a.applyTransform)(t.bounds,n)),(0,u.extentFromProjection)(i)),i=t.minzoom||0,o=t.maxzoom||22,o=(0,u.createXYZ)({extent:n,maxZoom:o,minZoom:i,tileSize:this.tileSize_});this.tileGrid=o,this.tileUrlFunction=(0,s.createFromTemplates)(t.tiles,o),t.attribution&&!this.getAttributions()&&(r=void 0!==e?e:n,this.setAttributions(function(e){return(0,a.intersects)(r,e.extent)?[t.attribution]:null})),this.tileJSON_=t,this.setState("ready")}},{key:"handleTileJSONError",value:function(){this.setState("error")}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../asserts.js":105,"../extent.js":131,"../net.js":268,"../proj.js":271,"../tilegrid.js":372,"../tileurlfunction.js":376,"./TileImage.js":341}],343:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./TileImage.js"))&&n.__esModule?n:{default:n},l=e("./wms.js"),u=e("../uri.js"),c=e("../asserts.js"),f=e("../extent.js"),h=e("../size.js"),p=e("../reproj.js"),o=e("../string.js"),d=e("../proj.js"),y=e("../math.js"),g=e("../tilecoord.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=m(i);function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");e=e||{};var t=Object.assign({},e.params),r=!("TRANSPARENT"in t)||t.TRANSPARENT;return(r=n.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:!r,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})).gutter_=void 0!==e.gutter?e.gutter:0,r.params_=t,r.v13_=!0,r.serverType_=e.serverType,r.hidpi_=void 0===e.hidpi||e.hidpi,r.tmpExtent_=(0,f.createEmpty)(),r.updateV13_(),r.setKey(r.getKeyForParams_()),r}return t=i,(e=[{key:"getFeatureInfoUrl",value:function(e,t,r,n){var i,o,a,r=(0,d.get)(r),s=this.getProjection(),u=this.getTileGrid(),t=(u=u||this.getTileGridForProjection(r)).getZForResolution(t,this.zDirection),t=u.getTileCoordForCoordAndZ(e,t);if(!(u.getResolutions().length<=t[0]))return i=u.getResolution(t[0]),o=u.getTileCoordExtent(t,this.tmpExtent_),u=(0,h.toSize)(u.getTileSize(t[0]),this.tmpSize),0!==(a=this.gutter_)&&(u=(0,h.buffer)(u,a,this.tmpSize),o=(0,f.buffer)(o,i*a,o)),s&&s!==r&&(i=(0,p.calculateSourceResolution)(s,r,e,i),o=(0,d.transformExtent)(o,r,s),e=(0,d.transform)(e,r,s)),a={SERVICE:"WMS",VERSION:l.DEFAULT_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS},Object.assign(a,this.params_,n),n=Math.floor((e[0]-o[0])/i),e=Math.floor((o[3]-e[1])/i),a[this.v13_?"I":"X"]=n,a[this.v13_?"J":"Y"]=e,this.getRequestUrl_(t,u,o,1,s||r,a)}},{key:"getLegendUrl",value:function(e,t){if(void 0!==this.urls[0]){var r={SERVICE:"WMS",VERSION:l.DEFAULT_VERSION,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){var n=this.params_.LAYERS;if(!(!Array.isArray(n)||1===n.length))return;r.LAYER=n}return void 0!==e&&(n=this.getProjection()?this.getProjection().getMetersPerUnit():1,r.SCALE=e*n/28e-5),Object.assign(r,t),(0,u.appendParams)(this.urls[0],r)}}},{key:"getGutter",value:function(){return this.gutter_}},{key:"getParams",value:function(){return this.params_}},{key:"getRequestUrl_",value:function(e,t,r,n,i,o){var a=this.urls;if(a){if(o.WIDTH=t[0],o.HEIGHT=t[1],o[this.v13_?"CRS":"SRS"]=i.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=n)switch(this.serverType_){case"geoserver":var s=90*n+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+s:o.FORMAT_OPTIONS="dpi:"+s;break;case"mapserver":o.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":o.DPI=90*n;break;default:(0,c.assert)(!1,52)}var t=i.getAxisOrientation(),i=r;return this.v13_&&"ne"==t.substr(0,2)&&(t=r[0],i[0]=r[1],i[1]=t,t=r[2],i[2]=r[3],i[3]=t),o.BBOX=i.join(","),r=1==a.length?a[0]:a[(0,y.modulo)((0,g.hash)(e),a.length)],(0,u.appendParams)(r,o)}}},{key:"getTilePixelRatio",value:function(e){return this.hidpi_&&void 0!==this.serverType_?e:1}},{key:"getKeyForParams_",value:function(){var e,t=0,r=[];for(e in this.params_)r[t++]=e+"-"+this.params_[e];return r.join("/")}},{key:"updateParams",value:function(e){Object.assign(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())}},{key:"updateV13_",value:function(){var e=this.params_.VERSION||l.DEFAULT_VERSION;this.v13_=0<=(0,o.compareVersions)(e,"1.3")}},{key:"tileUrlFunction",value:function(e,t,r){var n,i,o,a=(a=this.getTileGrid())||this.getTileGridForProjection(r);if(!(a.getResolutions().length<=e[0]))return 1==t||this.hidpi_&&void 0!==this.serverType_||(t=1),o=a.getResolution(e[0]),n=a.getTileCoordExtent(e,this.tmpExtent_),a=(0,h.toSize)(a.getTileSize(e[0]),this.tmpSize),0!==(i=this.gutter_)&&(a=(0,h.buffer)(a,i,this.tmpSize),n=(0,f.buffer)(n,o*i,n)),1!=t&&(a=(0,h.scale)(a,t,this.tmpSize)),o={SERVICE:"WMS",VERSION:l.DEFAULT_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0},Object.assign(o,this.params_),this.getRequestUrl_(e,a,n,t,r,o)}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../asserts.js":105,"../extent.js":131,"../math.js":267,"../proj.js":271,"../reproj.js":312,"../size.js":319,"../string.js":354,"../tilecoord.js":371,"../uri.js":378,"./TileImage.js":341,"./wms.js":352}],344:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CustomTile=void 0;var n=g(e("../events/EventType.js")),o=g(e("../Tile.js")),a=g(e("./Tile.js")),u=g(e("../TileState.js")),s=e("../extent.js"),l=e("../asserts.js"),c=e("../tileurlfunction.js"),f=e("../tilegrid.js"),h=e("../tilecoord.js"),p=e("../proj.js"),d=e("../events.js"),y=e("../net.js");function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function b(e,t,r){t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=j(r),t=(e=n?(e=j(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(){_(s,o["default"]);var a=x(s);function s(e,t,r,n,i,o){return m(this,s),(e=a.call(this,e,t)).src_=r,e.extent_=n,e.preemptive_=i,e.grid_=null,e.keys_=null,e.data_=null,e.jsonp_=o,e}return b(s,[{key:"getImage",value:function(){return null}},{key:"getData",value:function(e){var t;return!this.grid_||!this.keys_||(t=(e[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),e=(e[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),"string"!=typeof(e=this.grid_[Math.floor((1-e)*this.grid_.length)]))?null:(93<=(t=e.charCodeAt(Math.floor(t*e.length)))&&t--,35<=t&&t--,e=null,(t-=32)in this.keys_&&(t=this.keys_[t],e=this.data_&&t in this.data_?this.data_[t]:t),e)}},{key:"forDataAtCoordinate",value:function(t,r,e){this.state==u.default.EMPTY&&!0===e?(this.state=u.default.IDLE,(0,d.listenOnce)(this,n.default.CHANGE,function(e){r(this.getData(t))},this),this.loadInternal_()):!0===e?setTimeout(function(){r(this.getData(t))}.bind(this),0):r(this.getData(t))}},{key:"getKey",value:function(){return this.src_}},{key:"handleError_",value:function(){this.state=u.default.ERROR,this.changed()}},{key:"handleLoad_",value:function(e){this.grid_=e.grid,this.keys_=e.keys,this.data_=e.data,this.state=u.default.LOADED,this.changed()}},{key:"loadInternal_",value:function(){var e;this.state==u.default.IDLE&&(this.state=u.default.LOADING,this.jsonp_?(0,y.jsonp)(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this)):((e=new XMLHttpRequest).addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",this.src_),e.send()))}},{key:"onXHRLoad_",value:function(e){var t,e=e.target;if(!e.status||200<=e.status&&e.status<300){try{t=JSON.parse(e.responseText)}catch(e){return void this.handleError_()}this.handleLoad_(t)}else this.handleError_()}},{key:"onXHRError_",value:function(e){this.handleError_()}},{key:"load",value:function(){this.preemptive_?this.loadInternal_():this.setState(u.default.EMPTY)}}]),s}(),e=(r.CustomTile=O,function(){_(i,a["default"]);var n=x(i);function i(e){var t,r;return m(this,i),(t=n.call(this,{projection:(0,p.get)("EPSG:3857"),state:"loading",zDirection:e.zDirection})).preemptive_=void 0===e.preemptive||e.preemptive,t.tileUrlFunction_=c.nullTileUrlFunction,t.template_=void 0,t.jsonp_=e.jsonp||!1,e.url?t.jsonp_?(0,y.jsonp)(e.url,t.handleTileJSONResponse.bind(S(t)),t.handleTileJSONError.bind(S(t))):((r=new XMLHttpRequest).addEventListener("load",t.onXHRLoad_.bind(S(t))),r.addEventListener("error",t.onXHRError_.bind(S(t))),r.open("GET",e.url),r.send()):e.tileJSON?t.handleTileJSONResponse(e.tileJSON):(0,l.assert)(!1,51),t}return b(i,[{key:"onXHRLoad_",value:function(e){var t,e=e.target;if(!e.status||200<=e.status&&e.status<300){try{t=JSON.parse(e.responseText)}catch(e){return void this.handleTileJSONError()}this.handleTileJSONResponse(t)}else this.handleTileJSONError()}},{key:"onXHRError_",value:function(e){this.handleTileJSONError()}},{key:"getTemplate",value:function(){return this.template_}},{key:"forDataAtCoordinateAndResolution",value:function(e,t,r,n){this.tileGrid?(t=this.tileGrid.getZForResolution(t,this.zDirection),t=this.tileGrid.getTileCoordForCoordAndZ(e,t),this.getTile(t[0],t[1],t[2],1,this.getProjection()).forDataAtCoordinate(e,r,n)):!0===n?setTimeout(function(){r(null)},0):r(null)}},{key:"handleTileJSONError",value:function(){this.setState("error")}},{key:"handleTileJSONResponse",value:function(t){var e,r,n=(0,p.get)("EPSG:4326"),i=this.getProjection(),n=(void 0!==t.bounds&&(n=(0,p.getTransformFromProjections)(n,i),e=(0,s.applyTransform)(t.bounds,n)),(0,f.extentFromProjection)(i)),i=t.minzoom||0,o=t.maxzoom||22,o=(0,f.createXYZ)({extent:n,maxZoom:o,minZoom:i}),i=(this.tileGrid=o,this.template_=t.template,t.grids);i?(this.tileUrlFunction_=(0,c.createFromTemplates)(i,o),void 0!==t.attribution&&(r=void 0!==e?e:n,this.setAttributions(function(e){return(0,s.intersects)(r,e.extent)?[t.attribution]:null})),this.setState("ready")):this.setState("error")}},{key:"getTile",value:function(e,t,r,n,i){var o=(0,h.getKeyZXY)(e,t,r);return this.tileCache.containsKey(o)?this.tileCache.get(o):(t=this.getTileCoordForTileUrlFunction(e=[e,t,r],i),r=this.tileUrlFunction_(t,n,i),t=new O(e,void 0!==r?u.default.IDLE:u.default.EMPTY,void 0!==r?r:"",this.tileGrid.getTileCoordExtent(e),this.preemptive_,this.jsonp_),this.tileCache.set(o,t),t)}},{key:"useTile",value:function(e,t,r){e=(0,h.getKeyZXY)(e,t,r);this.tileCache.containsKey(e)&&this.tileCache.get(e)}}]),i}());r.default=e},{"../Tile.js":94,"../TileState.js":98,"../asserts.js":105,"../events.js":125,"../events/EventType.js":127,"../extent.js":131,"../net.js":268,"../proj.js":271,"../tilecoord.js":371,"../tilegrid.js":372,"../tileurlfunction.js":376,"./Tile.js":337}],345:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=n(e("./TileEventType.js")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=h(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("./Tile.js")),u=n(e("../TileState.js")),l=e("../tileurlfunction.js"),c=e("../tilecoord.js"),f=e("../util.js");function h(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(h=function(e){return e?r:t})(e))}function n(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=i(r),t=(e=n?(e=i(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=y(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})).generateTileUrlFunction_=t.tileUrlFunction===i.prototype.tileUrlFunction,t.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(t.tileUrlFunction=e.tileUrlFunction),t.urls=null,e.urls?t.setUrls(e.urls):e.url&&t.setUrl(e.url),t.tileLoadingKeys_={},t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(e){var t,e=e.target,r=(0,f.getUid)(e),n=e.getState();n==u.default.LOADING?(this.tileLoadingKeys_[r]=!0,t=o.default.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],t=n==u.default.ERROR?o.default.TILELOADERROR:n==u.default.LOADED?o.default.TILELOADEND:void 0),null!=t&&this.dispatchEvent(new s.TileSourceEvent(t,e))}},{key:"setTileLoadFunction",value:function(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}},{key:"setTileUrlFunction",value:function(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),void 0!==t?this.setKey(t):this.changed()}},{key:"setUrl",value:function(e){e=(0,l.expandUrl)(e);this.urls=e,this.setUrls(e)}},{key:"setUrls",value:function(e){var t=(this.urls=e).join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction((0,l.createFromTemplates)(e,this.tileGrid),t):this.setKey(t)}},{key:"tileUrlFunction",value:function(e,t,r){}},{key:"useTile",value:function(e,t,r){e=(0,c.getKeyZXY)(e,t,r);this.tileCache.containsKey(e)&&this.tileCache.get(e)}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.default);r.default=e},{"../TileState.js":98,"../tilecoord.js":371,"../tileurlfunction.js":376,"../util.js":379,"./Tile.js":337,"./TileEventType.js":340}],346:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.VectorSourceEvent=void 0;var s=a(e("../Collection.js")),n=a(e("../CollectionEventType.js")),o=a(e("../events/Event.js")),u=a(e("../events/EventType.js")),l=a(e("../ObjectEventType.js")),c=a(e("../structs/RBush.js")),f=a(e("./Source.js")),y=a(e("./VectorEventType.js")),h=e("../functions.js"),p=e("../loadingstrategy.js"),d=e("../asserts.js"),g=e("../extent.js"),m=e("../array.js"),v=e("../util.js"),b=e("../obj.js"),_=e("../events.js"),w=e("../featureloader.js");function a(e){return e&&e.__esModule?e:{default:e}}function x(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?S(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function P(e,t,r){return t&&O(e.prototype,t),r&&O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function C(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=R(r),t=(e=n?(e=R(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=function(){E(i,o["default"]);var n=C(i);function i(e,t,r){return k(this,i),(e=n.call(this,e)).feature=t,e.features=r,e}return P(i)}(),e=(r.VectorSourceEvent=M,function(){E(a,f["default"]);var o=C(a);function a(e){k(this,a),(t=o.call(this,{attributions:(e=e||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===e.wrapX||e.wrapX})).on,t.once,t.un,t.loader_=h.VOID,t.format_=e.format,t.overlaps_=void 0===e.overlaps||e.overlaps,t.url_=e.url,void 0!==e.loader?t.loader_=e.loader:void 0!==t.url_&&((0,d.assert)(t.format_,7),t.loader_=(0,w.xhr)(t.url_,t.format_)),t.strategy_=void 0!==e.strategy?e.strategy:p.all;var t,r,n,i=void 0===e.useSpatialIndex||e.useSpatialIndex;return t.featuresRtree_=i?new c.default:null,t.loadedExtentsRtree_=new c.default,t.loadingExtentsCount_=0,t.nullGeometryFeatures_={},t.idIndex_={},t.uidIndex_={},t.featureChangeKeys_={},t.featuresCollection_=null,Array.isArray(e.features)?n=e.features:e.features&&(n=(r=e.features).getArray()),i||void 0!==r||(r=new s.default(n)),void 0!==n&&t.addFeaturesInternal(n),void 0!==r&&t.bindFeaturesCollection_(r),t}return P(a,[{key:"addFeature",value:function(e){this.addFeatureInternal(e),this.changed()}},{key:"addFeatureInternal",value:function(e){var t,r=(0,v.getUid)(e);this.addToIndex_(r,e)?(this.setupChangeEvents_(r,e),(t=e.getGeometry())?(t=t.getExtent(),this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.nullGeometryFeatures_[r]=e,this.dispatchEvent(new M(y.default.ADDFEATURE,e))):this.featuresCollection_&&this.featuresCollection_.remove(e)}},{key:"setupChangeEvents_",value:function(e,t){this.featureChangeKeys_[e]=[(0,_.listen)(t,u.default.CHANGE,this.handleFeatureChange_,this),(0,_.listen)(t,l.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]}},{key:"addToIndex_",value:function(e,t){var r=!0,n=t.getId();return void 0!==n&&(n.toString()in this.idIndex_?r=!1:this.idIndex_[n.toString()]=t),r&&((0,d.assert)(!(e in this.uidIndex_),30),this.uidIndex_[e]=t),r}},{key:"addFeatures",value:function(e){this.addFeaturesInternal(e),this.changed()}},{key:"addFeaturesInternal",value:function(e){for(var t=[],r=[],n=[],i=0,o=e.length;i<o;i++){var a=e[i],s=(0,v.getUid)(a);this.addToIndex_(s,a)&&r.push(a)}for(var u=0,l=r.length;u<l;u++){var c=r[u],f=(0,v.getUid)(c),h=(this.setupChangeEvents_(f,c),c.getGeometry());h?(h=h.getExtent(),t.push(h),n.push(c)):this.nullGeometryFeatures_[f]=c}if(this.featuresRtree_&&this.featuresRtree_.load(t,n),this.hasListener(y.default.ADDFEATURE))for(var p=0,d=r.length;p<d;p++)this.dispatchEvent(new M(y.default.ADDFEATURE,r[p]))}},{key:"bindFeaturesCollection_",value:function(t){var r=!1;this.addEventListener(y.default.ADDFEATURE,function(e){r||(r=!0,t.push(e.feature),r=!1)}),this.addEventListener(y.default.REMOVEFEATURE,function(e){r||(r=!0,t.remove(e.feature),r=!1)}),t.addEventListener(n.default.ADD,function(e){r||(r=!0,this.addFeature(e.element),r=!1)}.bind(this)),t.addEventListener(n.default.REMOVE,function(e){r||(r=!0,this.removeFeature(e.element),r=!1)}.bind(this)),this.featuresCollection_=t}},{key:"clear",value:function(e){if(e){for(var t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(_.unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var r,e=function(e){this.removeFeatureInternal(e)}.bind(this);for(r in this.featuresRtree_.forEach(e),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};e=new M(y.default.CLEAR);this.dispatchEvent(e),this.changed()}},{key:"forEachFeature",value:function(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureAtCoordinateDirect",value:function(t,r){var e=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(e,function(e){if(e.getGeometry().intersectsCoordinate(t))return r(e)})}},{key:"forEachFeatureInExtent",value:function(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureIntersectingExtent",value:function(t,r){return this.forEachFeatureInExtent(t,function(e){if(e.getGeometry().intersectsExtent(t)){e=r(e);if(e)return e}})}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,b.isEmpty)(this.nullGeometryFeatures_)||(0,m.extend)(e,Object.values(this.nullGeometryFeatures_))),e}},{key:"getFeaturesAtCoordinate",value:function(e){var t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t}},{key:"getFeaturesInExtent",value:function(e,t){var r,n=this;return this.featuresRtree_?t&&t.canWrapX()&&this.getWrapX()?(t=(0,g.wrapAndSliceX)(e,t),(r=[]).concat.apply(r,x(t.map(function(e){return n.featuresRtree_.getInExtent(e)})))):this.featuresRtree_.getInExtent(e):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(e,n){var i=e[0],o=e[1],a=null,s=[NaN,NaN],u=1/0,l=[-1/0,-1/0,1/0,1/0];return n=n||h.TRUE,this.featuresRtree_.forEachInExtent(l,function(e){var t,r;n(e)&&(r=e.getGeometry(),t=u,(u=r.closestPointXY(i,o,s,u))<t)&&(a=e,r=Math.sqrt(u),l[0]=i-r,l[1]=o-r,l[2]=i+r,l[3]=o+r)}),a}},{key:"getExtent",value:function(e){return this.featuresRtree_.getExtent(e)}},{key:"getFeatureById",value:function(e){e=this.idIndex_[e.toString()];return void 0!==e?e:null}},{key:"getFeatureByUid",value:function(e){e=this.uidIndex_[e];return void 0!==e?e:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(e){var e=e.target,t=(0,v.getUid)(e),r=e.getGeometry(),r=(r?(r=r.getExtent(),t in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[t],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)):t in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[t]=e),e.getId());void 0!==r?(r=r.toString(),this.idIndex_[r]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[r]=e)):(this.removeFromIdIndex_(e),this.uidIndex_[t]=e),this.changed(),this.dispatchEvent(new M(y.default.CHANGEFEATURE,e))}},{key:"hasFeature",value:function(e){var t=e.getId();return void 0!==t?t in this.idIndex_:(0,v.getUid)(e)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,b.isEmpty)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(e,r,n){for(var i=this,o=this.loadedExtentsRtree_,a=this.strategy_(e,r,n),t=0,s=a.length;t<s;++t)!function(e){var t=a[e];o.forEachInExtent(t,function(e){return(0,g.containsExtent)(e.extent,t)})||(++i.loadingExtentsCount_,i.dispatchEvent(new M(y.default.FEATURESLOADSTART)),i.loader_.call(i,t,r,n,function(e){--this.loadingExtentsCount_,this.dispatchEvent(new M(y.default.FEATURESLOADEND,void 0,e))}.bind(i),function(){--this.loadingExtentsCount_,this.dispatchEvent(new M(y.default.FEATURESLOADERROR))}.bind(i)),o.insert(t,{extent:t.slice()}))}(t);this.loading=!(this.loader_.length<4)&&0<this.loadingExtentsCount_}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),j(R(a.prototype),"refresh",this).call(this)}},{key:"removeLoadedExtent",value:function(t){var r,e=this.loadedExtentsRtree_;e.forEachInExtent(t,function(e){if((0,g.equals)(e.extent,t))return r=e,!0}),r&&e.remove(r)}},{key:"removeFeature",value:function(e){var t;e&&((t=(0,v.getUid)(e))in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.removeFeatureInternal(e))&&this.changed()}},{key:"removeFeatureInternal",value:function(e){var t=(0,v.getUid)(e),r=this.featureChangeKeys_[t];if(r)return r.forEach(_.unlistenByKey),delete this.featureChangeKeys_[t],void 0!==(r=e.getId())&&delete this.idIndex_[r.toString()],delete this.uidIndex_[t],this.dispatchEvent(new M(y.default.REMOVEFEATURE,e)),e}},{key:"removeFromIdIndex_",value:function(e){var t,r=!1;for(t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t],r=!0;break}return r}},{key:"setLoader",value:function(e){this.loader_=e}},{key:"setUrl",value:function(e){(0,d.assert)(this.format_,7),this.url_=e,this.setLoader((0,w.xhr)(e,this.format_))}}]),a}());r.default=e},{"../Collection.js":71,"../CollectionEventType.js":72,"../ObjectEventType.js":91,"../array.js":104,"../asserts.js":105,"../events.js":125,"../events/Event.js":126,"../events/EventType.js":127,"../extent.js":131,"../featureloader.js":133,"../functions.js":189,"../loadingstrategy.js":266,"../obj.js":269,"../structs/RBush.js":357,"../util.js":379,"./Source.js":335,"./VectorEventType.js":347}],347:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"}},{}],348:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.defaultLoadFunction=j;var l=v(e("../events/EventType.js")),o=v(e("../VectorTile.js")),a=v(e("../TileCache.js")),u=v(e("../tilegrid/TileGrid.js")),y=v(e("../TileState.js")),n=v(e("./UrlTile.js")),h=v(e("../VectorRenderTile.js")),c=e("../tilegrid/common.js"),g=e("../extent.js"),s=e("../tilegrid.js"),m=e("../tilecoord.js"),f=e("../obj.js"),p=e("../featureloader.js"),d=e("../size.js");function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function _(){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=S(r),t=(e=n?(e=S(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e);var r,n=x(i);function i(e){var t,r;if(this instanceof i)return r=e.projection||"EPSG:3857",t=e.extent||(0,s.extentFromProjection)(r),t=e.tileGrid||(0,s.createXYZ)({extent:t,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512}),(r=n.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,opaque:!1,projection:r,state:e.state,tileGrid:t,tileLoadFunction:e.tileLoadFunction||j,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection})).format_=e.format||null,r.sourceTileCache=new a.default(r.tileCache.highWaterMark),r.overlaps_=null==e.overlaps||e.overlaps,r.tileClass=e.tileClass||o.default,r.tileGrids_={},r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getFeaturesInExtent",value:function(f){var h,p,d=[],e=this.tileCache;return 0!==e.getCount()&&(h=(0,m.fromKey)(e.peekFirstKey())[0],p=this.tileGrid,e.forEach(function(e){if(e.tileCoord[0]===h&&e.getState()===y.default.LOADED)for(var t=e.getSourceTiles(),r=0,n=t.length;r<n;++r){var i=t[r],o=i.tileCoord;if((0,g.intersects)(f,p.getTileCoordExtent(o))){var a=i.getFeatures();if(a)for(var s=0,u=a.length;s<u;++s){var l=a[s],c=l.getGeometry();(0,g.intersects)(f,c.getExtent())&&d.push(l)}}}})),d}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"clear",value:function(){this.tileCache.clear(),this.sourceTileCache.clear()}},{key:"expireCache",value:function(e,t){var o=this.getTileCacheForProjection(e),r=Object.keys(t).reduce(function(e,t){t=(0,m.getCacheKeyForTileKey)(t),t=o.peek(t);if(t)for(var r=t.sourceTiles,n=0,i=r.length;n<i;++n)e[r[n].getKey()]=!0;return e},{});_(S(i.prototype),"expireCache",this).call(this,e,t),this.sourceTileCache.expireCache(r)}},{key:"getSourceTiles",value:function(i,o,a){var e,t,s,r,u=this;return a.getState()===y.default.IDLE&&(a.setState(y.default.LOADING),r=a.wrappedTileCoord,e=(t=this.getTileGridForProjection(o)).getTileCoordExtent(r),r=r[0],t=t.getResolution(r),(0,g.buffer)(e,-t,e),(r=(s=this.tileGrid).getExtent())&&(0,g.getIntersection)(e,r,e),r=s.getZForResolution(t,this.zDirection),s.forEachTileCoord(e,r,function(e){var t=u.tileUrlFunction(e,i,o),n=u.sourceTileCache.containsKey(t)?u.sourceTileCache.get(t):new u.tileClass(e,t?y.default.IDLE:y.default.EMPTY,t,u.format_,u.tileLoadFunction),r=(a.sourceTiles.push(n),n.getState());r<y.default.LOADED&&(n.addEventListener(l.default.CHANGE,function e(t){u.handleTileChange(t);var r,t=n.getState();t!==y.default.LOADED&&t!==y.default.ERROR||((r=n.getKey())in a.errorTileKeys?n.getState()===y.default.LOADED&&delete a.errorTileKeys[r]:a.loadingSourceTiles--,t===y.default.ERROR?a.errorTileKeys[r]=!0:n.removeEventListener(l.default.CHANGE,e),0===a.loadingSourceTiles&&a.setState((0,f.isEmpty)(a.errorTileKeys)?y.default.LOADED:y.default.ERROR))}),a.loadingSourceTiles++),r===y.default.IDLE&&(n.extent=s.getTileCoordExtent(e),n.projection=o,n.resolution=s.getResolution(e[0]),u.sourceTileCache.set(t,n),n.load())}),a.loadingSourceTiles||a.setState(a.sourceTiles.some(function(e){return e.getState()===y.default.ERROR})?y.default.ERROR:y.default.LOADED)),a.sourceTiles}},{key:"getTile",value:function(e,t,r,n,i){var o,a,s,u,l,c=(0,m.getKeyZXY)(e,t,r),f=this.getKey();return this.tileCache.containsKey(c)&&(o=this.tileCache.get(c)).key===f?o:(r=this.getTileCoordForTileUrlFunction(t=[e,t,r],i),s=this.getTileGrid().getExtent(),u=this.getTileGridForProjection(i),r&&s&&(l=u.getTileCoordExtent(r),(0,g.buffer)(l,-u.getResolution(e),l),(0,g.intersects)(s,l)||(r=null)),a=!0,null!==r&&(s=this.tileGrid,l=u.getResolution(e),e=s.getZForResolution(l,1),u=u.getTileCoordExtent(r),(0,g.buffer)(u,-l,u),s.forEachTileCoord(u,e,function(e){a=a&&!this.tileUrlFunction(e,n,i)}.bind(this))),(l=new h.default(t,a?y.default.EMPTY:y.default.IDLE,r,this.getSourceTiles.bind(this,n,i))).key=f,o?(l.interimTile=o,l.refreshInterimChain(),this.tileCache.replace(c,l)):this.tileCache.set(c,l),l)}},{key:"getTileGridForProjection",value:function(e){var e=e.getCode(),t=this.tileGrids_[e];if(!t){for(var r=this.tileGrid,n=r.getResolutions().slice(),i=n.map(function(e,t){return r.getOrigin(t)}),o=n.map(function(e,t){return r.getTileSize(t)}),a=c.DEFAULT_MAX_ZOOM+1,s=n.length;s<a;++s)n.push(n[s-1]/2),i.push(i[s-1]),o.push(o[s-1]);t=new u.default({extent:r.getExtent(),origins:i,resolutions:n,tileSizes:o}),this.tileGrids_[e]=t}return t}},{key:"getTilePixelRatio",value:function(e){return e}},{key:"getTilePixelSize",value:function(e,t,r){r=this.getTileGridForProjection(r),r=(0,d.toSize)(r.getTileSize(e),this.tmpSize);return[Math.round(r[0]*t),Math.round(r[1]*t)]}},{key:"updateCacheSize",value:function(e,t){_(S(i.prototype),"updateCacheSize",this).call(this,2*e,t),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(t).highWaterMark}}])&&b(t.prototype,e),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);function j(n,i){n.setLoader(function(e,t,r){(0,p.loadFeaturesXhr)(i,n.getFormat(),e,t,r,n.onLoad.bind(n),n.onError.bind(n))})}r.default=e},{"../TileCache.js":95,"../TileState.js":98,"../VectorRenderTile.js":99,"../VectorTile.js":100,"../events/EventType.js":127,"../extent.js":131,"../featureloader.js":133,"../obj.js":269,"../size.js":319,"../tilecoord.js":371,"../tilegrid.js":372,"../tilegrid/TileGrid.js":373,"../tilegrid/common.js":375,"./UrlTile.js":345}],349:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.optionsFromCapabilities=function(e,i){var t=e.Contents.Layer.find(function(e){return e.Identifier==i.layer});if(!t)return null;var o=e.Contents.TileMatrixSet;s=1<t.TileMatrixSetLink.length?"projection"in i?t.TileMatrixSetLink.findIndex(function(t){var e=o.find(function(e){return e.Identifier==t.TileMatrixSet}).SupportedCRS,r=(0,P.get)(e),n=(0,P.get)(i.projection);return r&&n?(0,P.equivalent)(r,n):e==i.projection}):t.TileMatrixSetLink.findIndex(function(e){return e.TileMatrixSet==i.matrixSet}):0;s<0&&(s=0);var r=t.TileMatrixSetLink[s].TileMatrixSet,n=t.TileMatrixSetLink[s].TileMatrixSetLimits,a=t.Format[0];"format"in i&&(a=i.format);(s=t.Style.findIndex(function(e){return"style"in i?e.Title==i.style:e.isDefault}))<0&&(s=0);var s=t.Style[s].Identifier,u={};"Dimension"in t&&t.Dimension.forEach(function(e,t,r){var n=e.Identifier,i=e.Default;void 0===i&&(i=e.Value[0]),u[n]=i});var l,c=e.Contents.TileMatrixSet.find(function(e){return e.Identifier==r}),f=c.SupportedCRS;f&&(l=(0,P.get)(f));"projection"in i&&(!(f=(0,P.get)(i.projection))||l&&!(0,P.equivalent)(f,l)||(l=f));var f=!1,h="ne"==l.getAxisOrientation().substr(0,2),p=c.TileMatrix[0],d={MinTileCol:0,MinTileRow:0,MaxTileCol:p.MatrixWidth-1,MaxTileRow:p.MatrixHeight-1};n&&(d=n[n.length-1],y=c.TileMatrix.find(function(e){return e.Identifier===d.TileMatrix||c.Identifier+":"+e.Identifier===d.TileMatrix}))&&(p=y);var y=28e-5*p.ScaleDenominator/l.getMetersPerUnit(),g=h?[p.TopLeftCorner[1],p.TopLeftCorner[0]]:p.TopLeftCorner,m=p.TileWidth*y,p=p.TileHeight*y,y=c.BoundingBox;y&&h&&(y=[y[1],y[0],y[3],y[2]]);h=[g[0]+m*d.MinTileCol,g[1]-p*(1+d.MaxTileRow),g[0]+m*(1+d.MaxTileCol),g[1]-p*d.MinTileRow];void 0===y||(0,j.containsExtent)(y,h)||(m=t.WGS84BoundingBox,g=(0,P.get)("EPSG:4326").getExtent(),h=y,f=m?m[0]===g[0]&&m[2]===g[2]:(p=(0,P.transformExtent)(y,c.SupportedCRS,"EPSG:4326"))[0]-1e-10<=g[0]&&p[2]+1e-10>=g[2]);var m=(0,O.createFromCapabilitiesMatrixSet)(c,h,n),v=[],b=i.requestEncoding;if(b=void 0!==b?b:"","OperationsMetadata"in e&&"GetTile"in e.OperationsMetadata)for(var _=e.OperationsMetadata.GetTile.DCP.HTTP.Get,w=0,x=_.length;w<x;++w)if(_[w].Constraint){var S=_[w].Constraint.find(function(e){return"GetEncoding"==e.name}).AllowedValues.Value;if("KVP"!==(b=""===b?S[0]:b))break;S.includes("KVP")&&v.push(_[w].href)}else _[w].href&&(b="KVP",v.push(_[w].href));0===v.length&&(b="REST",t.ResourceURL.forEach(function(e){"tile"===e.resourceType&&(a=e.format,v.push(e.template))}));return{urls:v,layer:i.layer,matrixSet:r,format:a,projection:l,requestEncoding:b,tileGrid:m,style:s,dimensions:u,wrapX:f,crossOrigin:i.crossOrigin}};var n=(n=e("./TileImage.js"))&&n.__esModule?n:{default:n},u=e("../uri.js"),j=e("../extent.js"),O=e("../tilegrid/WMTS.js"),a=e("../tileurlfunction.js"),P=e("../proj.js");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var r,i=c(o);function o(e){var t,r,n;if(this instanceof o)return t=void 0!==e.requestEncoding?e.requestEncoding:"KVP",r=e.tileGrid,void 0===(n=e.urls)&&void 0!==e.url&&(n=(0,a.expandUrl)(e.url)),(r=i.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:n,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection})).version_=void 0!==e.version?e.version:"1.0.0",r.format_=void 0!==e.format?e.format:"image/jpeg",r.dimensions_=void 0!==e.dimensions?e.dimensions:{},r.layer_=e.layer,r.matrixSet_=e.matrixSet,r.style_=e.style,r.requestEncoding_=t,r.setKey(r.getKeyForDimensions_()),n&&0<n.length&&(r.tileUrlFunction=(0,a.createFromTileUrlFunctions)(n.map(r.createFromWMTSTemplate.bind(f(r))))),r;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"setUrls",value:function(e){var t=(this.urls=e).join("\n");this.setTileUrlFunction((0,a.createFromTileUrlFunctions)(e.map(this.createFromWMTSTemplate.bind(this))),t)}},{key:"getDimensions",value:function(){return this.dimensions_}},{key:"getFormat",value:function(){return this.format_}},{key:"getLayer",value:function(){return this.layer_}},{key:"getMatrixSet",value:function(){return this.matrixSet_}},{key:"getRequestEncoding",value:function(){return this.requestEncoding_}},{key:"getStyle",value:function(){return this.style_}},{key:"getVersion",value:function(){return this.version_}},{key:"getKeyForDimensions_",value:function(){var e,t=0,r=[];for(e in this.dimensions_)r[t++]=e+"-"+this.dimensions_[e];return r.join("/")}},{key:"updateDimensions",value:function(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}},{key:"createFromWMTSTemplate",value:function(i){var o=this.requestEncoding_,r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_},a=("KVP"==o&&Object.assign(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),i="KVP"==o?(0,u.appendParams)(i,r):i.replace(/\{(\w+?)\}/g,function(e,t){return t.toLowerCase()in r?r[t.toLowerCase()]:e}),this.tileGrid),s=this.dimensions_;return function(e,t,r){var n;if(e)return n={TileMatrix:a.getMatrixId(e[0]),TileCol:e[1],TileRow:e[2]},Object.assign(n,s),e=i,"KVP"==o?(0,u.appendParams)(e,n):e.replace(/\{(\w+?)\}/g,function(e,t){return n[t]})}}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e},{"../extent.js":131,"../proj.js":271,"../tilegrid/WMTS.js":374,"../tileurlfunction.js":376,"../uri.js":378,"./TileImage.js":341}],350:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("./TileImage.js"))&&n.__esModule?n:{default:n},o=e("../tilegrid.js");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(i);function i(e){var t,r;if(this instanceof i)return r=void 0!==(e=e||{}).projection?e.projection:"EPSG:3857",t=void 0!==e.tileGrid?e.tileGrid:(0,o.createXYZ)({extent:(0,o.extentFromProjection)(r),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize}),(r=n.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:r,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:t,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})).gutter_=void 0!==e.gutter?e.gutter:0,r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getGutter",value:function(){return this.gutter_}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../tilegrid.js":372,"./TileImage.js":341}],351:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CustomTile=void 0;var b=e("../tilegrid/common.js"),n=s(e("../ImageTile.js")),_=s(e("../tilegrid/TileGrid.js")),o=s(e("./TileImage.js")),a=s(e("../TileState.js")),w=e("../asserts.js"),l=e("../dom.js"),x=e("../tileurlfunction.js"),S=e("../extent.js"),j=e("../size.js");function s(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return P(t)}}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(){h(u,n["default"]);var s=d(u);function u(e,t,r,n,i,o,a){return O(this,u),(t=s.call(this,t,r,n,i,o,a)).zoomifyImage_=null,t.tileSize_=e,t}return c(u,[{key:"getImage",value:function(){var e,t;return this.zoomifyImage_||(e=f(y(u.prototype),"getImage",this).call(this),this.state==a.default.LOADED?(t=this.tileSize_,e.width==t[0]&&e.height==t[1]?this.zoomifyImage_=e:((t=(0,l.createCanvasContext2D)(t[0],t[1])).drawImage(e,0,0),this.zoomifyImage_=t.canvas,t.canvas)):e)}}]),u}(),e=(r.CustomTile=k,function(){h(v,o["default"]);var m=d(v);function v(e){O(this,v);var t=e.size,r=void 0!==e.tierSizeCalculation?e.tierSizeCalculation:"default",n=e.tilePixelRatio||1,i=t[0],o=t[1],u=[],a=e.tileSize||b.DEFAULT_TILE_SIZE,s=a*n;switch(r){case"default":for(;s<i||s<o;)u.push([Math.ceil(i/s),Math.ceil(o/s)]),s+=s;break;case"truncated":for(var l=i,c=o;s<l||s<c;)u.push([Math.ceil(l/s),Math.ceil(c/s)]),l>>=1,c>>=1;break;default:(0,w.assert)(!1,53)}u.push([1,1]),u.reverse();for(var f=[n],h=[0],p=1,d=u.length;p<d;p++)f.push(n<<p),h.push(u[p-1][0]*u[p-1][1]+h[p-1]);f.reverse();var t=new _.default({tileSize:a,extent:e.extent||[0,-o,i,0],resolutions:f}),r=e.url,r=(!r||r.includes("{TileGroup}")||r.includes("{tileIndex}")||(r+="{TileGroup}/{z}-{x}-{y}.jpg"),(0,x.expandUrl)(r)),y=a*n;var r=(0,x.createFromTileUrlFunctions)(r.map(function(s){return function(e,t,r){var n,i,o,a;if(e)return n=e[0],o=(i=e[1])+(e=e[2])*u[n][0],a={z:n,x:i,y:e,tileIndex:o,TileGroup:"TileGroup"+((o+h[n])/y|0)},s.replace(/\{(\w+?)\}/g,function(e,t){return a[t]})}})),g=k.bind(null,(0,j.toSize)(a*n));(g=m.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,tilePixelRatio:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:g,tileGrid:t,tileUrlFunction:r,transition:e.transition})).zDirection=e.zDirection;e=r(t.getTileCoordForCoordAndResolution((0,S.getCenter)(t.getExtent()),f[f.length-1]),1,null),r=new Image;return r.addEventListener("error",function(){y=a,this.changed()}.bind(P(g))),r.src=e,g}return c(v)}());r.default=e},{"../ImageTile.js":81,"../TileState.js":98,"../asserts.js":105,"../dom.js":123,"../extent.js":131,"../size.js":319,"../tilegrid/TileGrid.js":373,"../tilegrid/common.js":375,"../tileurlfunction.js":376,"./TileImage.js":341}],352:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_VERSION=void 0;r.DEFAULT_VERSION="1.3.0"},{}],353:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_RADIUS=void 0,r.getArea=function e(t,r){r=r||{};var n=r.radius||d;var i=r.projection||"EPSG:3857";var o=t.getType();"GeometryCollection"!==o&&(t=t.clone().transform(i,"EPSG:4326"));var a=0;var s,u,l,c,f,h;switch(o){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(s=t.getCoordinates(),a=Math.abs(g(s[0],n)),l=1,c=s.length;l<c;++l)a-=Math.abs(g(s[l],n));break;case"MultiPolygon":for(s=t.getCoordinates(),l=0,c=s.length;l<c;++l)for(u=s[l],a+=Math.abs(g(u[0],n)),f=1,h=u.length;f<h;++f)a-=Math.abs(g(u[f],n));break;case"GeometryCollection":var p=t.getGeometries();for(l=0,c=p.length;l<c;++l)a+=e(p[l],r);break;default:throw new Error("Unsupported geometry type: "+o)}return a},r.getDistance=o,r.getLength=function e(t,r){r=r||{};var n=r.radius||d;var i=r.projection||"EPSG:3857";var o=t.getType();"GeometryCollection"!==o&&(t=t.clone().transform(i,"EPSG:4326"));var a=0;var s,u,l,c,f,h;switch(o){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":s=t.getCoordinates(),a=y(s,n);break;case"MultiLineString":case"Polygon":for(s=t.getCoordinates(),l=0,c=s.length;l<c;++l)a+=y(s[l],n);break;case"MultiPolygon":for(s=t.getCoordinates(),l=0,c=s.length;l<c;++l)for(u=s[l],f=0,h=u.length;f<h;++f)a+=y(u[f],n);break;case"GeometryCollection":var p=t.getGeometries();for(l=0,c=p.length;l<c;++l)a+=e(p[l],r);break;default:throw new Error("Unsupported geometry type: "+o)}return a},r.offset=function(e,t,r,n){n=n||d;var i=(0,l.toRadians)(e[1]),e=(0,l.toRadians)(e[0]),t=t/n,n=Math.asin(Math.sin(i)*Math.cos(t)+Math.cos(i)*Math.sin(t)*Math.cos(r)),e=e+Math.atan2(Math.sin(r)*Math.sin(t)*Math.cos(i),Math.cos(t)-Math.sin(i)*Math.sin(n));return[(0,l.toDegrees)(e),(0,l.toDegrees)(n)]};var l=e("./math.js"),d=6371008.8;function o(e,t,r){r=r||d;var n=(0,l.toRadians)(e[1]),i=(0,l.toRadians)(t[1]),o=(i-n)/2,t=(0,l.toRadians)(t[0]-e[0])/2,e=Math.sin(o)*Math.sin(o)+Math.sin(t)*Math.sin(t)*Math.cos(n)*Math.cos(i);return 2*r*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))}function y(e,t){for(var r=0,n=0,i=e.length;n<i-1;++n)r+=o(e[n],e[n+1],t);return r}function g(e,t){for(var r=0,n=e.length,i=e[n-1][0],o=e[n-1][1],a=0;a<n;a++){var s=e[a][0],u=e[a][1];r+=(0,l.toRadians)(s-i)*(2+Math.sin((0,l.toRadians)(o))+Math.sin((0,l.toRadians)(u))),i=s,o=u}return r*t*t/2}r.DEFAULT_RADIUS=d},{"./math.js":267}],354:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compareVersions=function(e,t){for(var r=(""+e).split("."),n=(""+t).split("."),i=0;i<Math.max(r.length,n.length);i++){var o=parseInt(r[i]||"0",10),a=parseInt(n[i]||"0",10);if(a<o)return 1;if(o<a)return-1}return 0},r.padNumber=function(e,t,r){r=void 0!==r?e.toFixed(r):""+e,e=r.indexOf(".");return(e=-1===e?r.length:e)>t?r:new Array(1+t-e).join("0")+r}},{}],355:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../asserts.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}e=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}var e,r,n;return e=t,(r=[{key:"canExpireCache",value:function(){return 0<this.highWaterMark&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(e){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(e){return this.entries_.hasOwnProperty(e)}},{key:"forEach",value:function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer}},{key:"get",value:function(e,t){e=this.entries_[e];return(0,i.assert)(void 0!==e,15),e!==this.newest_&&(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e),e.value_}},{key:"remove",value:function(e){var t=this.entries_[e];return(0,i.assert)(void 0!==t,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){for(var e=new Array(this.count_),t=0,r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}},{key:"getValues",value:function(){for(var e=new Array(this.count_),t=0,r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"peek",value:function(e){if(this.containsKey(e))return this.entries_[e].value_}},{key:"pop",value:function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}},{key:"replace",value:function(e,t){this.get(e),this.entries_[e].value_=t}},{key:"set",value:function(e,t){(0,i.assert)(!(e in this.entries_),16);t={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=t:this.oldest_=t,this.newest_=t,this.entries_[e]=t,++this.count_}},{key:"setSize",value:function(e){this.highWaterMark=e}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=e},{"../asserts.js":105}],356:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.DROP=void 0;var i=e("../asserts.js"),o=e("../obj.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}r.DROP=1/0;e=function(){function r(e,t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}var e,t,n;return e=r,(t=[{key:"clear",value:function(){this.elements_.length=0,(this.priorities_.length=0,o.clear)(this.queuedElements_)}},{key:"dequeue",value:function(){var e=this.elements_,t=this.priorities_,r=e[0],e=(1==e.length?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0)),this.keyFunction_(r));return delete this.queuedElements_[e],r}},{key:"enqueue",value:function(e){(0,i.assert)(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=1/0&&(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(e){return 2*e+1}},{key:"getRightChildIndex_",value:function(e){return 2*e+2}},{key:"getParentIndex_",value:function(e){return e-1>>1}},{key:"heapify_",value:function(){for(var e=(this.elements_.length>>1)-1;0<=e;e--)this.siftUp_(e)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(e){return e in this.queuedElements_}},{key:"isQueued",value:function(e){return this.isKeyQueued(this.keyFunction_(e))}},{key:"siftUp_",value:function(e){for(var t=this.elements_,r=this.priorities_,n=t.length,i=t[e],o=r[e],a=e;e<n>>1;){var s=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),u=u<n&&r[u]<r[s]?u:s;t[e]=t[u],r[e]=r[u],e=u}t[e]=i,r[e]=o,this.siftDown_(a,e)}},{key:"siftDown_",value:function(e,t){for(var r=this.elements_,n=this.priorities_,i=r[t],o=n[t];e<t;){var a=this.getParentIndex_(t);if(!(n[a]>o))break;r[t]=r[a],n[t]=n[a],t=a}r[t]=i,n[t]=o}},{key:"reprioritize",value:function(){for(var e,t,r=this.priorityFunction_,n=this.elements_,i=this.priorities_,o=0,a=n.length,s=0;s<a;++s)(t=r(e=n[s]))==1/0?delete this.queuedElements_[this.keyFunction_(e)]:(i[o]=t,n[o++]=e);n.length=o,i.length=o,this.heapify_()}}])&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}();r.default=e},{"../asserts.js":105,"../obj.js":269}],357:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(n=e("rbush"))&&n.__esModule?n:{default:n},o=e("../extent.js"),s=e("../util.js"),a=e("../obj.js");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===u(e)?e:String(e)}(n.key),n)}}var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.rbush_=new i.default(e),this.items_={}}var e,r,n;return e=t,(r=[{key:"insert",value:function(e,t){e={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(e),this.items_[(0,s.getUid)(t)]=e}},{key:"load",value:function(e,t){for(var r=new Array(t.length),n=0,i=t.length;n<i;n++){var o=e[n],a=t[n],o={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};r[n]=o,this.items_[(0,s.getUid)(a)]=o}this.rbush_.load(r)}},{key:"remove",value:function(e){var e=(0,s.getUid)(e),t=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(t)}},{key:"update",value:function(e,t){var r=this.items_[(0,s.getUid)(t)],r=[r.minX,r.minY,r.maxX,r.maxY];(0,o.equals)(r,e)||(this.remove(t),this.insert(e,t))}},{key:"getAll",value:function(){return this.rbush_.all().map(function(e){return e.value})}},{key:"getInExtent",value:function(e){e={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(e).map(function(e){return e.value})}},{key:"forEach",value:function(e){return this.forEach_(this.getAll(),e)}},{key:"forEachInExtent",value:function(e,t){return this.forEach_(this.getInExtent(e),t)}},{key:"forEach_",value:function(e,t){for(var r,n=0,i=e.length;n<i;n++)if(r=t(e[n]))return r;return r}},{key:"isEmpty",value:function(){return(0,a.isEmpty)(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(e){var t=this.rbush_.toJSON();return(0,o.createOrUpdate)(t.minX,t.minY,t.maxX,t.maxY,e)}},{key:"concat",value:function(e){for(var t in this.rbush_.load(e.rbush_.all()),e.items_)this.items_[t]=e.items_[t]}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=n},{"../extent.js":131,"../obj.js":269,"../util.js":379,rbush:398}],358:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Circle",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"Fill",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"Icon",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"IconImage",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"RegularShape",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"Stroke",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"Style",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"Text",{enumerable:!0,get:function(){return f.default}});var n=h(e("./style/Circle.js")),i=h(e("./style/Fill.js")),o=h(e("./style/Icon.js")),a=h(e("./style/IconImage.js")),s=h(e("./style/Image.js")),u=h(e("./style/RegularShape.js")),l=h(e("./style/Stroke.js")),c=h(e("./style/Style.js")),f=h(e("./style/Text.js"));function h(e){return e&&e.__esModule?e:{default:e}}},{"./style/Circle.js":359,"./style/Fill.js":360,"./style/Icon.js":361,"./style/IconImage.js":362,"./style/Image.js":364,"./style/RegularShape.js":365,"./style/Stroke.js":366,"./style/Style.js":367,"./style/Text.js":368}],359:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(e){if(this instanceof i)return n.call(this,{points:1/0,fill:(e=e||{radius:5}).fill,radius:e.radius,stroke:e.stroke,scale:void 0!==e.scale?e.scale:1,rotation:void 0!==e.rotation?e.rotation:0,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode});throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){var e=this.getScale(),e=new i({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},{key:"setRadius",value:function(e){this.radius_=e,this.render()}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(((e=e("./RegularShape.js"))&&e.__esModule?e:{default:e}).default);r.default=e},{"./RegularShape.js":365}],360:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.color_=void 0!==(e=e||{}).color?e.color:null}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(e){this.color_=e}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=n},{}],361:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("../events/EventType.js")),s=a(e("../ImageState.js")),o=a(e("./Image.js")),u=e("../color.js"),l=e("../asserts.js"),c=e("./IconImage.js"),f=e("../util.js");function a(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,o=d(a);function a(e){var t,r,n,i;if(this instanceof a)return t=void 0!==(e=e||{}).opacity?e.opacity:1,r=void 0!==e.rotation?e.rotation:0,n=void 0!==e.scale?e.scale:1,i=void 0!==e.rotateWithView&&e.rotateWithView,(t=o.call(this,{opacity:t,rotation:r,scale:n,displacement:void 0!==e.displacement?e.displacement:[0,0],rotateWithView:i,declutterMode:e.declutterMode})).anchor_=void 0!==e.anchor?e.anchor:[.5,.5],t.normalizedAnchor_=null,t.anchorOrigin_=void 0!==e.anchorOrigin?e.anchorOrigin:"top-left",t.anchorXUnits_=void 0!==e.anchorXUnits?e.anchorXUnits:"fraction",t.anchorYUnits_=void 0!==e.anchorYUnits?e.anchorYUnits:"fraction",t.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,r=void 0!==e.img?e.img:null,t.imgSize_=e.imgSize,n=e.src,(0,l.assert)(!(void 0!==n&&r),4),(0,l.assert)(!r||t.imgSize_,5),void 0!==n&&0!==n.length||!r||(n=r.src||(0,f.getUid)(r)),(0,l.assert)(void 0!==n&&0<n.length,6),i=void 0!==e.src?s.default.IDLE:s.default.LOADED,t.color_=void 0!==e.color?(0,u.asArray)(e.color):null,t.iconImage_=(0,c.get)(r,n,void 0!==t.imgSize_?t.imgSize_:null,t.crossOrigin_,i,t.color_),t.offset_=void 0!==e.offset?e.offset:[0,0],t.offsetOrigin_=void 0!==e.offsetOrigin?e.offsetOrigin:"top-left",t.origin_=null,t.size_=void 0!==e.size?e.size:null,t;throw new TypeError("Cannot call a class as a function")}return t=a,(e=[{key:"clone",value:function(){var e=this.getScale();return new a({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(e)?e.slice():e,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getAnchor",value:function(){if(!(e=this.normalizedAnchor_)){var e=this.anchor_,t=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!t)return null;e=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(e[0]*=t[0]),"fraction"==this.anchorYUnits_&&(e[1]*=t[1])}if("top-left"!=this.anchorOrigin_){if(!t)return null;e===this.anchor_&&(e=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(e[0]=-e[0]+t[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(e[1]=-e[1]+t[1])}this.normalizedAnchor_=e}var t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}},{key:"setAnchor",value:function(e){this.anchor_=e,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(e){return this.iconImage_.getImage(e)}},{key:"getPixelRatio",value:function(e){return this.iconImage_.getPixelRatio(e)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(!this.origin_){var e=this.offset_;if("top-left"!=this.offsetOrigin_){var t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(e[0]=r[0]-t[0]-e[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(e[1]=r[1]-t[1]-e[1])}this.origin_=e}return this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_||this.iconImage_.getSize()}},{key:"listenImageChange",value:function(e){this.iconImage_.addEventListener(n.default.CHANGE,e)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(e){this.iconImage_.removeEventListener(n.default.CHANGE,e)}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.default);r.default=e},{"../ImageState.js":80,"../asserts.js":105,"../color.js":107,"../events/EventType.js":127,"../util.js":379,"./IconImage.js":362,"./Image.js":364}],362:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.get=function(e,t,r,n,i,o){var a=s.shared.get(t,n,o);a||(a=new m(e,t,r,n,i,o),s.shared.set(t,n,o,a));return a};var n=u(e("../events/Target.js")),o=u(e("../events/EventType.js")),a=u(e("../ImageState.js")),l=e("../color.js"),c=e("../dom.js"),s=e("./IconImageCache.js"),f=e("../Image.js");function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=null,m=function(e){var t=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,s=d(u);function u(e,t,r,n,i,o){var a;if(this instanceof u)return(a=s.call(this)).hitDetectionImage_=null,a.image_=e,a.crossOrigin_=n,a.canvas_={},a.color_=o,a.unlisten_=null,a.imageState_=i,a.size_=r,a.src_=t,a.tainted_,a;throw new TypeError("Cannot call a class as a function")}return t=u,(e=[{key:"initializeImage_",value:function(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}},{key:"isTainted_",value:function(){if(void 0===this.tainted_&&this.imageState_===a.default.LOADED){(g=g||(0,c.createCanvasContext2D)(1,1)).drawImage(this.image_,0,0);try{g.getImageData(0,0,1,1),this.tainted_=!1}catch(e){g=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(o.default.CHANGE)}},{key:"handleImageError_",value:function(){this.imageState_=a.default.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=a.default.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"getImage",value:function(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]||this.image_}},{key:"getPixelRatio",value:function(e){return this.replaceColor_(e),this.canvas_[e]?e:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){var e,t,r;return this.image_||this.initializeImage_(),this.hitDetectionImage_||(this.isTainted_()?(e=this.size_[0],t=this.size_[1],(r=(0,c.createCanvasContext2D)(e,t)).fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas):this.hitDetectionImage_=this.image_),this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){if(this.imageState_===a.default.IDLE){this.image_||this.initializeImage_(),this.imageState_=a.default.LOADING;try{this.image_.src=this.src_}catch(e){this.handleImageError_()}this.unlisten_=(0,f.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(e){var t,r,n;this.color_&&!this.canvas_[e]&&this.imageState_===a.default.LOADED&&(t=this.image_,(r=document.createElement("canvas")).width=Math.ceil(t.width*e),r.height=Math.ceil(t.height*e),(n=r.getContext("2d")).scale(e,e),n.drawImage(t,0,0),n.globalCompositeOperation="multiply",n.fillStyle=(0,l.asString)(this.color_),n.fillRect(0,0,r.width/e,r.height/e),n.globalCompositeOperation="destination-in",n.drawImage(t,0,0),this.canvas_[e]=r)}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n.default);r.default=m},{"../Image.js":77,"../ImageState.js":80,"../color.js":107,"../dom.js":123,"../events/EventType.js":127,"../events/Target.js":129,"./IconImageCache.js":363}],363:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shared=r.default=void 0;var n=e("../color.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}e=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}var t,r,n;return t=e,(r=[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var e,t=0;for(e in this.cache_){var r=this.cache_[e];0!=(3&t++)||r.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}},{key:"get",value:function(e,t,r){e=a(e,t,r);return e in this.cache_?this.cache_[e]:null}},{key:"set",value:function(e,t,r,n){e=a(e,t,r);this.cache_[e]=n,++this.cacheSize_}},{key:"setSize",value:function(e){this.maxCacheSize_=e,this.expire()}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e,t,r){return t+":"+e+":"+(r?(0,n.asString)(r):"null")}e=new(r.default=e);r.shared=e},{"../color.js":107}],364:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../util.js"),o=e("../size.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}e=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=(0,o.toSize)(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"getAnchor",value:function(){return(0,i.abstract)()}},{key:"getImage",value:function(e){return(0,i.abstract)()}},{key:"getHitDetectionImage",value:function(){return(0,i.abstract)()}},{key:"getPixelRatio",value:function(e){return 1}},{key:"getImageState",value:function(){return(0,i.abstract)()}},{key:"getImageSize",value:function(){return(0,i.abstract)()}},{key:"getOrigin",value:function(){return(0,i.abstract)()}},{key:"getSize",value:function(){return(0,i.abstract)()}},{key:"setDisplacement",value:function(e){this.displacement_=e}},{key:"setOpacity",value:function(e){this.opacity_=e}},{key:"setRotateWithView",value:function(e){this.rotateWithView_=e}},{key:"setRotation",value:function(e){this.rotation_=e}},{key:"setScale",value:function(e){this.scale_=e,this.scaleArray_=(0,o.toSize)(e)}},{key:"listenImageChange",value:function(e){(0,i.abstract)()}},{key:"load",value:function(){(0,i.abstract)()}},{key:"unlistenImageChange",value:function(e){(0,i.abstract)()}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=e},{"../size.js":319,"../util.js":379}],365:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=c(e("../ImageState.js")),n=c(e("./Image.js")),a=e("../color.js"),u=e("../colorlike.js"),s=e("../dom.js"),l=e("../render/canvas.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);var r,n=p(i);function i(e){var t;if(this instanceof i)return t=void 0!==e.rotateWithView&&e.rotateWithView,(t=n.call(this,{opacity:1,rotateWithView:t,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode})).canvas_=void 0,t.hitDetectionCanvas_=null,t.fill_=void 0!==e.fill?e.fill:null,t.origin_=[0,0],t.points_=e.points,t.radius_=void 0!==e.radius?e.radius:e.radius1,t.radius2_=e.radius2,t.angle_=void 0!==e.angle?e.angle:0,t.stroke_=void 0!==e.stroke?e.stroke:null,t.size_=null,t.renderOptions_=null,t.render(),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){var e=this.getScale(),e=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},{key:"getAnchor",value:function(){var e,t,r=this.size_;return r?(e=this.getDisplacement(),t=this.getScaleArray(),[r[0]/2-e[0]/t[0],r[1]/2+e[1]/t[1]]):null}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(e){this.fill_=e,this.render()}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}},{key:"getImage",value:function(e){var t,r,n=this.canvas_[e];return n||(t=this.renderOptions_,r=(0,s.createCanvasContext2D)(t.size*e,t.size*e),this.draw_(t,r,e),n=r.canvas,this.canvas_[e]=n),n}},{key:"getPixelRatio",value:function(e){return e}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return o.default.LOADED}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius_}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(e){this.stroke_=e,this.render()}},{key:"listenImageChange",value:function(e){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(e){}},{key:"calculateLineJoinSize_",value:function(e,t,r){var n,i,o,a,s,u;return 0===t||this.points_===1/0||"bevel"!==e&&"miter"!==e?t:((n=this.radius_)<(i=void 0===this.radius2_?n:this.radius2_)&&(o=n,n=i,i=o),o=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/o,s=i*Math.sin(o),u=n-Math.sqrt(i*i-s*s),s=(a=Math.sqrt(s*s+u*u))/s,"miter"===e&&s<=r?s*t:(s=t/2/s,u=t/2*(u/a),a=Math.sqrt((n+s)*(n+s)+u*u)-n,void 0!==this.radius2_&&"bevel"!==e&&(s=n*Math.sin(o),u=i-Math.sqrt(n*n-s*s),(e=Math.sqrt(s*s+u*u)/s)<=r)?2*Math.max(a,e*t/2-i-n):2*a))}},{key:"createRenderOptions",value:function(){var e,t=l.defaultLineJoin,r=0,n=null,i=0,o=0,a=(this.stroke_&&(null===(e=this.stroke_.getColor())&&(e=l.defaultStrokeStyle),e=(0,u.asColorLike)(e),void 0===(o=this.stroke_.getWidth())&&(o=l.defaultLineWidth),n=this.stroke_.getLineDash(),i=this.stroke_.getLineDashOffset(),void 0===(t=this.stroke_.getLineJoin())&&(t=l.defaultLineJoin),void 0===(r=this.stroke_.getMiterLimit()))&&(r=l.defaultMiterLimit),this.calculateLineJoinSize_(t,o,r)),s=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:e,strokeWidth:o,size:Math.ceil(2*s+a),lineDash:n,lineDashOffset:i,lineJoin:t,miterLimit:r}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var e=this.renderOptions_.size;this.canvas_={},this.size_=[e,e]}},{key:"draw_",value:function(e,t,r){t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_&&(null===(r=this.fill_.getColor())&&(r=l.defaultFillStyle),t.fillStyle=(0,u.asColorLike)(r),t.fill()),this.stroke_&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}},{key:"createHitDetectionCanvas_",value:function(e){var t,r;this.fill_&&(t=0,null===(r="string"==typeof(r=this.fill_.getColor())?(0,a.asArray)(r):r)?t=1:Array.isArray(r)&&(t=4===r.length?r[3]:1),0===t)&&(r=(0,s.createCanvasContext2D)(e.size,e.size),this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(e,r)),this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}},{key:"createPath_",value:function(e){var t=this.points_,r=this.radius_;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{for(var n=void 0===this.radius2_?r:this.radius2_,i=(void 0!==this.radius2_&&(t*=2),this.angle_-Math.PI/2),o=2*Math.PI/t,a=0;a<t;a++){var s=i+a*o,u=a%2==0?r:n;e.lineTo(u*Math.cos(s),u*Math.sin(s))}e.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=l.defaultFillStyle,t.fill(),this.stroke_&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../ImageState.js":80,"../color.js":107,"../colorlike.js":108,"../dom.js":123,"../render/canvas.js":285,"./Image.js":364}],366:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.color_=void 0!==(e=e||{}).color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(e){this.color_=e}},{key:"setLineCap",value:function(e){this.lineCap_=e}},{key:"setLineDash",value:function(e){this.lineDash_=e}},{key:"setLineDashOffset",value:function(e){this.lineDashOffset_=e}},{key:"setLineJoin",value:function(e){this.lineJoin_=e}},{key:"setMiterLimit",value:function(e){this.miterLimit_=e}},{key:"setWidth",value:function(e){this.width_=e}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=n},{}],367:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createDefaultStyle=function(e,t){{var r,n;f||(r=new o.default({color:"rgba(255,255,255,0.4)"}),n=new a.default({color:"#3399CC",width:1.25}),f=[new c({image:new i.default({fill:r,stroke:n,radius:5}),fill:r,stroke:n})])}return f},r.createEditingStyle=function(){var e={},t=[255,255,255,1],r=[0,153,255,1];return e.Polygon=[new c({fill:new o.default({color:[255,255,255,.5]})})],e.MultiPolygon=e.Polygon,e.LineString=[new c({stroke:new a.default({color:t,width:5})}),new c({stroke:new a.default({color:r,width:3})})],e.MultiLineString=e.LineString,e.Circle=e.Polygon.concat(e.LineString),e.Point=[new c({image:new i.default({radius:6,fill:new o.default({color:r}),stroke:new a.default({color:t,width:1.5})}),zIndex:1/0})],e.MultiPoint=e.Point,e.GeometryCollection=e.Polygon.concat(e.LineString,e.Point),e},r.default=void 0,r.toFunction=function(e){var t;e="function"==typeof e?e:(t=Array.isArray(e)?e:((0,n.assert)("function"==typeof e.getZIndex,41),[e]),function(){return t});return e};var i=s(e("./Circle.js")),o=s(e("./Fill.js")),a=s(e("./Stroke.js")),n=e("../asserts.js");function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===u(e)?e:String(e)}(n.key),n)}}var c=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");e=e||{},this.geometry_=null,this.geometryFunction_=h,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getGeometry();return new t({geometry:e=e&&"object"===u(e)?e.clone():e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(e){this.renderer_=e}},{key:"setHitDetectionRenderer",value:function(e){this.hitDetectionRenderer_=e}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(e){this.fill_=e}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(e){this.image_=e}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(e){this.stroke_=e}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(e){this.text_=e}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=h,this.geometry_=t}},{key:"setZIndex",value:function(e){this.zIndex_=e}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var f=null;function h(e){return e.getGeometry()}r.default=c},{"../asserts.js":105,"./Circle.js":359,"./Fill.js":360,"./Stroke.js":366}],368:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=(n=e("./Fill.js"))&&n.__esModule?n:{default:n},o=e("../size.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.font_=(e=e||{}).font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=(0,o.toSize)(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new i.default({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill||null,this.backgroundStroke_=e.backgroundStroke||null,this.padding_=void 0===e.padding?null:e.padding}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"setOverflow",value:function(e){this.overflow_=e}},{key:"setFont",value:function(e){this.font_=e}},{key:"setMaxAngle",value:function(e){this.maxAngle_=e}},{key:"setOffsetX",value:function(e){this.offsetX_=e}},{key:"setOffsetY",value:function(e){this.offsetY_=e}},{key:"setPlacement",value:function(e){this.placement_=e}},{key:"setRotateWithView",value:function(e){this.rotateWithView_=e}},{key:"setFill",value:function(e){this.fill_=e}},{key:"setRotation",value:function(e){this.rotation_=e}},{key:"setScale",value:function(e){this.scale_=e,this.scaleArray_=(0,o.toSize)(void 0!==e?e:1)}},{key:"setStroke",value:function(e){this.stroke_=e}},{key:"setText",value:function(e){this.text_=e}},{key:"setTextAlign",value:function(e){this.textAlign_=e}},{key:"setJustify",value:function(e){this.justify_=e}},{key:"setTextBaseline",value:function(e){this.textBaseline_=e}},{key:"setBackgroundFill",value:function(e){this.backgroundFill_=e}},{key:"setBackgroundStroke",value:function(e){this.backgroundStroke_=e}},{key:"setPadding",value:function(e){this.padding_=e}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();r.default=n},{"../size.js":319,"./Fill.js":360}],369:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ValueTypes=r.PALETTE_TEXTURE_ARRAY=r.Operators=void 0,r.arrayToGlsl=a,r.colorToGlsl=s,r.expressionToGlsl=m,r.getStringNumberEquivalent=u,r.getValueType=o,r.isTypeUnique=i,r.numberToGlsl=g,r.stringToGlsl=c,r.uniformNameForVariable=P;var n,f=(n=e("../webgl/PaletteTexture.js"))&&n.__esModule?n:{default:n},l=e("../renderer/webgl/TileLayer.js"),h=e("../color.js");var d={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},y=(r.ValueTypes=d,{});function o(e){if("number"==typeof e)return d.NUMBER;if("boolean"==typeof e)return d.BOOLEAN;if("string"==typeof e)return(0,h.isStringColor)(e)?d.COLOR|d.STRING:d.STRING;if(!Array.isArray(e))throw new Error("Unhandled value type: ".concat(JSON.stringify(e)));if(e.every(function(e){return"number"==typeof e}))return 3===e.length||4===e.length?d.COLOR|d.NUMBER_ARRAY:d.NUMBER_ARRAY;if("string"!=typeof e[0])throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(e)));var t=y[e[0]];if(void 0===t)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return t.getReturnType(e.slice(1))}function i(e){return Math.log2(e)%1==0}function g(e){e=e.toString();return e.includes(".")?e:e+".0"}function a(e){if(e.length<2||4<e.length)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(e.length,"(").concat(e.map(g).join(", "),")")}function s(e){e=(0,h.asArray)(e).slice();return e.length<4&&e.push(1),a(e.map(function(e,t){return t<3?e/255:e}))}function u(e,t){return void 0===e.stringLiteralsMap[t]&&(e.stringLiteralsMap[t]=Object.keys(e.stringLiteralsMap).length),e.stringLiteralsMap[t]}function c(e,t){return g(u(e,t))}function m(e,t,r){if(Array.isArray(t)&&"string"==typeof t[0]){var n=y[t[0]];if(void 0===n)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(t)));return n.toGlsl(e,t.slice(1),r)}n=o(t);if(0<(n&d.NUMBER))return g(t);if(0<(n&d.BOOLEAN))return t.toString();if(0<(n&d.STRING)&&(void 0===r||r==d.STRING))return c(e,t.toString());if(0<(n&d.COLOR)&&(void 0===r||r==d.COLOR))return s(t);if(0<(n&d.NUMBER_ARRAY))return a(t);throw new Error("Unexpected expression ".concat(t," (expected type ").concat(r,")"))}function p(e){if(!(o(e)&d.NUMBER))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(e)," instead"))}function v(e){for(var t=0;t<e.length;t++)p(e[t])}function b(e){if(!(o(e)&d.STRING))throw new Error("A string value was expected, got ".concat(JSON.stringify(e)," instead"))}function _(e){if(!(o(e)&d.BOOLEAN))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(e)," instead"))}function w(e,t){if(e.length!==t)throw new Error("Exactly ".concat(t," arguments were expected, got ").concat(e.length," instead"))}function x(e,t){if(e.length<t)throw new Error("At least ".concat(t," arguments were expected, got ").concat(e.length," instead"))}function S(e,t){if(e.length>t)throw new Error("At most ".concat(t," arguments were expected, got ").concat(e.length," instead"))}function j(e){if(e.length%2!=0)throw new Error("An even amount of arguments was expected, got ".concat(e," instead"))}function O(e,t){if(!i(t))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(e)))}function P(e){return"u_var_"+e}(r.Operators=y).get={getReturnType:function(e){return d.ANY},toGlsl:function(e,t){w(t,1),b(t[0]);t=t[0].toString();return e.attributes.includes(t)||e.attributes.push(t),(e.inFragmentShader?"v_":"a_")+t}},y.var={getReturnType:function(e){return d.ANY},toGlsl:function(e,t){w(t,1),b(t[0]);t=t[0].toString();return e.variables.includes(t)||e.variables.push(t),P(t)}};var k="u_paletteTextures",E=(r.PALETTE_TEXTURE_ARRAY=k,y.palette={getReturnType:function(e){return d.COLOR},toGlsl:function(e,t){w(t,2),p(t[0]);var r=m(e,t[0]),n=t[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");for(var i=n.length,o=new Uint8Array(4*i),a=0;a<i;a++){var s=n[a],u=void 0;if("string"==typeof s)u=(0,h.fromString)(s);else{if(!Array.isArray(s))throw new Error("The second argument of palette must be an array of strings or colors");var l=s.length;if(4===l)u=s;else{if(3!==l)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(l));u=[s[0],s[1],s[2],1]}}l=4*a;o[l]=u[0],o[1+l]=u[1],o[2+l]=u[2],o[3+l]=255*u[3]}e.paletteTextures||(e.paletteTextures=[]);var t="".concat(k,"[").concat(e.paletteTextures.length,"]"),c=new f.default(t,o);return e.paletteTextures.push(c),"texture2D(".concat(t,", vec2((").concat(r," + 0.5) / ").concat(i,".0, 0.5))")}},"getBandValue");function T(i){return{getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){w(t,2);for(var r=d.ANY,n=0;n<t.length;n++)r&=o(t[n]);if(r===d.NONE)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(t)," instead"));return r&=~d.COLOR,"(".concat(m(e,t[0],r)," ").concat(i," ").concat(m(e,t[1],r),")")}}}function C(i){return{getReturnType:function(e){return d.BOOLEAN},toGlsl:function(t,e){x(e,2);for(var r=0;r<e.length;r++)_(e[r]);var n=e.map(function(e){return m(t,e)}).join(" ".concat(i," "));return"(".concat(n,")")}}}y.band={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){x(t,1),S(t,3);var r=t[0];if(!(E in e.functions)){for(var n="",i=e.bandCount||1,o=0;o<i;o++){var a=Math.floor(o/4),s=o%4,a=(o===i-1&&1===s&&(s=3),"".concat(l.Uniforms.TILE_TEXTURE_ARRAY,"[").concat(a,"]"));n+="\n          if (band == ".concat(o+1,".0) {\n            return texture2D(").concat(a,", v_textureCoord + vec2(dx, dy))[").concat(s,"];\n          }\n        ")}e.functions[E]="\n        float getBandValue(float band, float xOffset, float yOffset) {\n          float dx = xOffset / ".concat(l.Uniforms.TEXTURE_PIXEL_WIDTH,";\n          float dy = yOffset / ").concat(l.Uniforms.TEXTURE_PIXEL_HEIGHT,";\n          ").concat(n,"\n        }\n      ")}var r=m(e,r),u=m(e,t[1]||0),e=m(e,t[2]||0);return"".concat(E,"(").concat(r,", ").concat(u,", ").concat(e,")")}},y.time={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,0),"u_time"}},y.zoom={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,0),"u_zoom"}},y.resolution={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,0),"u_resolution"}},y["*"]={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," * ").concat(m(e,t[1]),")")}},y["/"]={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," / ").concat(m(e,t[1]),")")}},y["+"]={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," + ").concat(m(e,t[1]),")")}},y["-"]={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," - ").concat(m(e,t[1]),")")}},y.clamp={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){w(t,3),v(t);var r=m(e,t[1]),n=m(e,t[2]);return"clamp(".concat(m(e,t[0]),", ").concat(r,", ").concat(n,")")}},y["%"]={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,2),v(t),"mod(".concat(m(e,t[0]),", ").concat(m(e,t[1]),")")}},y["^"]={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,2),v(t),"pow(".concat(m(e,t[0]),", ").concat(m(e,t[1]),")")}},y.abs={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,1),v(t),"abs(".concat(m(e,t[0]),")")}},y.floor={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,1),v(t),"floor(".concat(m(e,t[0]),")")}},y.round={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,1),v(t),"floor(".concat(m(e,t[0])," + 0.5)")}},y.ceil={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,1),v(t),"ceil(".concat(m(e,t[0]),")")}},y.sin={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,1),v(t),"sin(".concat(m(e,t[0]),")")}},y.cos={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return w(t,1),v(t),"cos(".concat(m(e,t[0]),")")}},y.atan={getReturnType:function(e){return d.NUMBER},toGlsl:function(e,t){return x(t,1),S(t,2),v(t),2===t.length?"atan(".concat(m(e,t[0]),", ").concat(m(e,t[1]),")"):"atan(".concat(m(e,t[0]),")")}},y[">"]={getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," > ").concat(m(e,t[1]),")")}},y[">="]={getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," >= ").concat(m(e,t[1]),")")}},y["<"]={getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," < ").concat(m(e,t[1]),")")}},y["<="]={getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){return w(t,2),v(t),"(".concat(m(e,t[0])," <= ").concat(m(e,t[1]),")")}},y["=="]=T("=="),y["!="]=T("!="),y["!"]={getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){return w(t,1),_(t[0]),"(!".concat(m(e,t[0]),")")}},y.all=C("&&"),y.any=C("||"),y.between={getReturnType:function(e){return d.BOOLEAN},toGlsl:function(e,t){w(t,3),v(t);var r=m(e,t[1]),n=m(e,t[2]),e=m(e,t[0]);return"(".concat(e," >= ").concat(r," && ").concat(e," <= ").concat(n,")")}},y.array={getReturnType:function(e){return d.NUMBER_ARRAY},toGlsl:function(t,e){x(e,2),S(e,4),v(e);var r=e.map(function(e){return m(t,e,d.NUMBER)});return"vec".concat(e.length,"(").concat(r.join(", "),")")}},y.color={getReturnType:function(e){return d.COLOR},toGlsl:function(r,e){x(e,3),S(e,4),v(e);var t=e,t=(3===e.length&&t.push(1),e.map(function(e,t){return m(r,e,d.NUMBER)+(t<3?" / 255.0":"")}));return"vec".concat(e.length,"(").concat(t.join(", "),")")}},y.interpolate={getReturnType:function(e){for(var t=d.COLOR|d.NUMBER,r=3;r<e.length;r+=2)t&=o(e[r]);return t},toGlsl:function(e,t,r){j(t),x(t,6);var n,i=t[0];switch(i[0]){case"linear":n=1;break;case"exponential":n=i[1];break;default:n=null}if(!n)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(i)));r=void 0!==r?r:d.ANY;for(var o=y.interpolate.getReturnType(t)&r,a=(O(t,o),m(e,t[1])),s=g(n),u="",l=2;l<t.length-2;l+=2)var c=m(e,t[l]),f=u||m(e,t[l+1],o),h=m(e,t[l+2]),p=m(e,t[l+3],o),u="mix(".concat(f,", ").concat(p,", pow(clamp((").concat(a," - ").concat(c,") / (").concat(h," - ").concat(c,"), 0.0, 1.0), ").concat(s,"))");return u}},y.match={getReturnType:function(e){for(var t=d.ANY,r=2;r<e.length;r+=2)t&=o(e[r]);return t&=o(e[e.length-1])},toGlsl:function(e,t,r){j(t),x(t,4),r=void 0!==r?r:d.ANY;for(var n=y.match.getReturnType(t)&r,i=(O(t,n),m(e,t[0])),o=m(e,t[t.length-1],n),a=null,s=t.length-3;1<=s;s-=2)var u=m(e,t[s]),l=m(e,t[s+1],n),a="(".concat(i," == ").concat(u," ? ").concat(l," : ").concat(a||o,")");return a}},y.case={getReturnType:function(e){for(var t=d.ANY,r=1;r<e.length;r+=2)t&=o(e[r]);return t&=o(e[e.length-1])},toGlsl:function(e,t,r){var n=t;if(n.length%2==0)throw new Error("An odd amount of arguments was expected, got ".concat(n," instead"));x(t,3),r=void 0!==r?r:d.ANY;var i=y.case.getReturnType(t)&r;O(t,i);for(var o=0;o<t.length-1;o+=2)_(t[o]);for(var a=m(e,t[t.length-1],i),s=null,u=t.length-3;0<=u;u-=2)var l=m(e,t[u]),c=m(e,t[u+1],i),s="(".concat(l," ? ").concat(c," : ").concat(s||a,")");return s}}},{"../color.js":107,"../renderer/webgl/TileLayer.js":311,"../webgl/PaletteTexture.js":385}],370:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toStyle=function(e){return new u.default({fill:f(e,""),stroke:h(e,""),text:function(e){var t=e["text-value"];if(t)return new l.default({text:t,font:e["text-font"],maxAngle:e["text-max-angle"],offsetX:e["text-offset-x"],offsetY:e["text-offset-y"],overflow:e["text-overflow"],placement:e["text-placement"],scale:e["text-scale"],rotateWithView:e["text-rotate-with-view"],rotation:e["text-rotation"],textAlign:e["text-align"],justify:e["text-justify"],textBaseline:e["text-baseline"],padding:e["text-padding"],fill:f(e,"text-"),backgroundFill:f(e,"text-background-"),stroke:h(e,"text-"),backgroundStroke:h(e,"text-background-")})}(e),image:function(e){var t=e["icon-src"],r=e["icon-img"];if(t||r)return new o.default({src:t,img:r,imgSize:e["icon-img-size"],anchor:e["icon-anchor"],anchorOrigin:e["icon-anchor-origin"],anchorXUnits:e["icon-anchor-x-units"],anchorYUnits:e["icon-anchor-y-units"],color:e["icon-color"],crossOrigin:e["icon-cross-origin"],offset:e["icon-offset"],displacement:e["icon-displacement"],opacity:e["icon-opacity"],scale:e["icon-scale"],rotation:e["icon-rotation"],rotateWithView:e["icon-rotate-with-view"],size:e["icon-size"],declutterMode:e["icon-declutter-mode"]});t=e["shape-points"];if(t)return new a.default({points:t,fill:f(e,"shape-"),stroke:h(e,"shape-"),radius:e["shape-radius"],radius1:e["shape-radius1"],radius2:e["shape-radius2"],angle:e["shape-angle"],displacement:e["shape-displacement"],rotation:e["shape-rotation"],rotateWithView:e["shape-rotate-with-view"],scale:e["shape-scale"],declutterMode:e["shape-declutter-mode"]});r=e["circle-radius"];if(r)return new n.default({radius:r,fill:f(e,"circle-"),stroke:h(e,"circle-"),displacement:e["circle-displacement"],scale:e["circle-scale"],rotation:e["circle-rotation"],rotateWithView:e["circle-rotate-with-view"],declutterMode:e["circle-declutter-mode"]})}(e)})};var n=c(e("../style/Circle.js")),i=c(e("./Fill.js")),o=c(e("./Icon.js")),a=c(e("./RegularShape.js")),s=c(e("./Stroke.js")),u=c(e("./Style.js")),l=c(e("./Text.js"));function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){e=e[t+"fill-color"];if(e)return new i.default({color:e})}function h(e,t){var r=e[t+"stroke-width"],n=e[t+"stroke-color"];if(r||n)return new s.default({width:r,color:n,lineCap:e[t+"stroke-line-cap"],lineJoin:e[t+"stroke-line-join"],lineDash:e[t+"stroke-line-dash"],lineDashOffset:e[t+"stroke-line-dash-offset"],miterLimit:e[t+"stroke-miter-limit"]})}},{"../style/Circle.js":359,"./Fill.js":360,"./Icon.js":361,"./RegularShape.js":365,"./Stroke.js":366,"./Style.js":367,"./Text.js":368}],371:[function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t,r){return e+"/"+t+"/"+r}Object.defineProperty(r,"__esModule",{value:!0}),r.createOrUpdate=function(e,t,r,n){return void 0!==n?(n[0]=e,n[1]=t,n[2]=r,n):[e,t,r]},r.fromKey=function(e){return e.split("/").map(Number)},r.getCacheKeyForTileKey=function(e){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.substring(e.lastIndexOf("/")+1,e.length).split(",").map(Number),3),t=e[0],r=e[1],e=e[2];return i(t,r,e)},r.getKey=function(e){return i(e[0],e[1],e[2])},r.getKeyZXY=i,r.hash=function(e){return(e[1]<<e[0])+e[2]},r.withinExtentAndZ=function(e,t){var r=e[0],n=e[1],e=e[2];if(t.getMinZoom()>r||r>t.getMaxZoom())return!1;t=t.getFullTileRange(r);return!t||t.containsXY(n,e)}},{}],372:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createForExtent=o,r.createForProjection=s,r.createXYZ=function(e){var e=e||{},t=e.extent||(0,n.get)("EPSG:3857").getExtent(),t={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:a(t,e.maxZoom,e.tileSize,e.maxResolution)};return new i.default(t)},r.extentFromProjection=f,r.getForProjection=function(e){var t=e.getDefaultTileGrid();t||(t=s(e),e.setDefaultTileGrid(t));return t},r.wrapX=function(e,t,r){var n=t[0],i=e.getTileCoordCenter(t),r=f(r);return(0,l.containsCoordinate)(r,i)?t:(t=(0,l.getWidth)(r),r=Math.ceil((r[0]-i[0])/t),i[0]+=t*r,e.getTileCoordForCoordAndZ(i,n))};var i=(r=e("./tilegrid/TileGrid.js"))&&r.__esModule?r:{default:r},u=e("./tilegrid/common.js"),n=e("./proj.js"),l=e("./extent.js"),c=e("./size.js");function o(e,t,r,n){n=void 0!==n?n:"top-left";t=a(e,t,r);return new i.default({extent:e,origin:(0,l.getCorner)(e,n),resolutions:t,tileSize:r})}function a(e,t,r,n){t=void 0!==t?t:u.DEFAULT_MAX_ZOOM,r=(0,c.toSize)(void 0!==r?r:u.DEFAULT_TILE_SIZE);for(var i=(0,l.getHeight)(e),e=(0,l.getWidth)(e),o=(n=0<n?n:Math.max(e/r[0],i/r[1]),t+1),a=new Array(o),s=0;s<o;++s)a[s]=n/Math.pow(2,s);return a}function s(e,t,r,n){return o(f(e),t,r,n)}function f(e){var t=(e=(0,n.get)(e)).getExtent();return t||(e=180*n.METERS_PER_UNIT.degrees/e.getMetersPerUnit(),t=(0,l.createOrUpdate)(-e,-e,e,e)),t}},{"./extent.js":131,"./proj.js":271,"./size.js":319,"./tilegrid/TileGrid.js":373,"./tilegrid/common.js":375}],373:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==y(e)&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("../TileRange.js")),a=e("./common.js"),s=e("../asserts.js"),c=e("../math.js"),u=e("../extent.js"),f=e("../tilecoord.js"),n=e("../geom/flat/intersectsextent.js"),h=e("../array.js"),p=e("../size.js");function d(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(d=function(e){return e?r:t})(e))}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==y(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===y(e)?e:String(e)}(n.key),n)}}var g=[0,0,0],e=function(){function o(e){var t;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");if(this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,(0,s.assert)((0,h.isSorted)(this.resolutions_,function(e,t){return t-e},!0),17),!e.origins)for(var r=0,n=this.resolutions_.length-1;r<n;++r)if(t){if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}else t=this.resolutions_[r]/this.resolutions_[r+1];this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,(0,s.assert)(this.origins_.length==this.resolutions_.length,20));var i=e.extent;void 0===i||this.origin_||this.origins_||(this.origin_=(0,u.getTopLeft)(i)),(0,s.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,(0,s.assert)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:a.DEFAULT_TILE_SIZE,(0,s.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map(function(e,t){e=new l.default(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));return i&&(t=this.getTileRangeForExtentAndZ(i,t),e.minX=Math.max(t.minX,e.minX),e.maxX=Math.min(t.maxX,e.maxX),e.minY=Math.max(t.minY,e.minY),e.maxY=Math.min(t.maxY,e.maxY)),e},this):i&&this.calculateTileRanges_(i)}var e,t,r;return e=o,(t=[{key:"forEachTileCoord",value:function(e,t,r){for(var n=this.getTileRangeForExtentAndZ(e,t),i=n.minX,o=n.maxX;i<=o;++i)for(var a=n.minY,s=n.maxY;a<=s;++a)r([t,i,a])}},{key:"forEachTileCoordParentTileRange",value:function(e,t,r,n){var i,o,a=null,s=e[0]-1;for(2===this.zoomFactor_?(i=e[1],o=e[2]):a=this.getTileCoordExtent(e,n);s>=this.minZoom;){if(t(s,2===this.zoomFactor_?(i=Math.floor(i/2),o=Math.floor(o/2),(0,l.createOrUpdate)(i,i,o,o,r)):this.getTileRangeForExtentAndZ(a,s,r)))return!0;--s}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(e){return this.origin_||this.origins_[e]}},{key:"getResolution",value:function(e){return this.resolutions_[e]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(e,t,r){var n,i;return e[0]<this.maxZoom?2===this.zoomFactor_?(i=2*e[1],n=2*e[2],(0,l.createOrUpdate)(i,1+i,n,1+n,t)):(i=this.getTileCoordExtent(e,r||this.tmpExtent_),this.getTileRangeForExtentAndZ(i,e[0]+1,t)):null}},{key:"getTileRangeForTileCoordAndZ",value:function(e,t,r){var n,i,o,a,s,u;return t>this.maxZoom||t<this.minZoom?null:(a=e[0],s=e[1],n=e[2],t===a?(0,l.createOrUpdate)(s,n,s,n,r):this.zoomFactor_?(u=Math.pow(this.zoomFactor_,t-a),i=Math.floor(s*u),o=Math.floor(n*u),t<a?(0,l.createOrUpdate)(i,i,o,o,r):(a=Math.floor(u*(s+1))-1,s=Math.floor(u*(n+1))-1,(0,l.createOrUpdate)(i,a,o,s,r))):(u=this.getTileCoordExtent(e,this.tmpExtent_),this.getTileRangeForExtentAndZ(u,t,r)))}},{key:"getTileRangeExtent",value:function(e,t,r){var n=this.getOrigin(e),i=this.getResolution(e),e=(0,p.toSize)(this.getTileSize(e),this.tmpSize_),o=n[0]+t.minX*e[0]*i,a=n[0]+(t.maxX+1)*e[0]*i,s=n[1]+t.minY*e[1]*i,n=n[1]+(t.maxY+1)*e[1]*i;return(0,u.createOrUpdate)(o,s,a,n,r)}},{key:"getTileRangeForExtentAndZ",value:function(e,t,r){var n=g,i=(this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,n),n[1]),o=n[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,n),(0,l.createOrUpdate)(i,n[1],o,n[2],r)}},{key:"getTileCoordCenter",value:function(e){var t=this.getOrigin(e[0]),r=this.getResolution(e[0]),n=(0,p.toSize)(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*n[0]*r,t[1]-(e[2]+.5)*n[1]*r]}},{key:"getTileCoordExtent",value:function(e,t){var r=this.getOrigin(e[0]),n=this.getResolution(e[0]),i=(0,p.toSize)(this.getTileSize(e[0]),this.tmpSize_),o=r[0]+e[1]*i[0]*n,r=r[1]-(e[2]+1)*i[1]*n,e=o+i[0]*n,i=r+i[1]*n;return(0,u.createOrUpdate)(o,r,e,i,t)}},{key:"getTileCoordForCoordAndResolution",value:function(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}},{key:"getTileCoordForXYAndResolution_",value:function(e,t,r,n,i){var o=this.getZForResolution(r),a=r/this.getResolution(o),s=this.getOrigin(o),u=(0,p.toSize)(this.getTileSize(o),this.tmpSize_),e=a*(e-s[0])/r/u[0],a=a*(s[1]-t)/r/u[1],a=n?(e=(0,c.ceil)(e,5)-1,(0,c.ceil)(a,5)-1):(e=(0,c.floor)(e,5),(0,c.floor)(a,5));return(0,f.createOrUpdate)(o,e,a,i)}},{key:"getTileCoordForXYAndZ_",value:function(e,t,r,n,i){var o=this.getOrigin(r),a=this.getResolution(r),s=(0,p.toSize)(this.getTileSize(r),this.tmpSize_),e=(e-o[0])/a/s[0],o=(o[1]-t)/a/s[1],o=n?(e=(0,c.ceil)(e,5)-1,(0,c.ceil)(o,5)-1):(e=(0,c.floor)(e,5),(0,c.floor)(o,5));return(0,f.createOrUpdate)(r,e,o,i)}},{key:"getTileCoordForCoordAndZ",value:function(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}},{key:"getTileCoordResolution",value:function(e){return this.resolutions_[e[0]]}},{key:"getTileSize",value:function(e){return this.tileSize_||this.tileSizes_[e]}},{key:"getFullTileRange",value:function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}},{key:"getZForResolution",value:function(e,t){e=(0,h.linearFindNearest)(this.resolutions_,e,t||0);return(0,c.clamp)(e,this.minZoom,this.maxZoom)}},{key:"tileCoordIntersectsViewport",value:function(e,t){return(0,n.intersectsLinearRing)(t,0,t.length,2,this.getTileCoordExtent(e))}},{key:"calculateTileRanges_",value:function(e){for(var t=this.resolutions_.length,r=new Array(t),n=this.minZoom;n<t;++n)r[n]=this.getTileRangeForExtentAndZ(e,n);this.fullTileRanges_=r}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();r.default=e},{"../TileRange.js":97,"../array.js":104,"../asserts.js":105,"../extent.js":131,"../geom/flat/intersectsextent.js":212,"../math.js":267,"../size.js":319,"../tilecoord.js":371,"./common.js":375}],374:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.createFromCapabilitiesMatrixSet=function(i,e,o){var a=[],s=[],u=[],l=[],c=[];o=void 0!==o?o:[];var f="TileMatrix",h="Identifier",p="ScaleDenominator",d="TopLeftCorner",t=i.SupportedCRS,t=(0,m.get)(t),y=t.getMetersPerUnit(),g="ne"==t.getAxisOrientation().substr(0,2);return i[f].sort(function(e,t){return t[p]-e[p]}),i[f].forEach(function(t){var e,r,n=!(0<o.length)||o.find(function(e){return t[h]==e[f]||!t[h].includes(":")&&i[h]+":"+t[h]===e[f]});n&&(s.push(t[h]),n=28e-5*t[p]/y,e=t.TileWidth,r=t.TileHeight,u.push(g?[t[d][1],t[d][0]]:t[d]),a.push(n),l.push(e==r?e:[e,r]),c.push([t.MatrixWidth,t.MatrixHeight]))}),new v({extent:e,origins:u,resolutions:a,matrixIds:s,tileSizes:l,sizes:c})},r.default=void 0;var n=(n=e("./TileGrid.js"))&&n.__esModule?n:{default:n},m=e("../proj.js");function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);var r,n=s(i);function i(e){var t;if(this instanceof i)return(t=n.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})).matrixIds_=e.matrixIds,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getMatrixId",value:function(e){return this.matrixIds_[e]}},{key:"getMatrixIds",value:function(){return this.matrixIds_}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=v},{"../proj.js":271,"./TileGrid.js":373}],375:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_TILE_SIZE=r.DEFAULT_MAX_ZOOM=void 0;r.DEFAULT_MAX_ZOOM=42;r.DEFAULT_TILE_SIZE=256},{}],376:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createFromTemplate=s,r.createFromTemplates=function(e,t){for(var r=e.length,n=new Array(r),i=0;i<r;++i)n[i]=s(e[i],t);return u(n)},r.createFromTileUrlFunctions=u,r.expandUrl=function(e){var t=[],r=/\{([a-z])-([a-z])\}/.exec(e);if(r){var n,i=r[1].charCodeAt(0),o=r[2].charCodeAt(0);for(n=i;n<=o;++n)t.push(e.replace(r[0],String.fromCharCode(n)))}else if(r=/\{(\d+)-(\d+)\}/.exec(e))for(var a=parseInt(r[2],10),s=parseInt(r[1],10);s<=a;s++)t.push(e.replace(r[0],s.toString()));else t.push(e);return t},r.nullTileUrlFunction=function(e,t,r){return};var l=e("./asserts.js"),o=e("./math.js"),a=e("./tilecoord.js");function s(n,i){var o=/\{z\}/g,a=/\{x\}/g,s=/\{y\}/g,u=/\{-y\}/g;return function(t,e,r){if(t)return n.replace(o,t[0].toString()).replace(a,t[1].toString()).replace(s,t[2].toString()).replace(u,function(){var e=t[0],e=i.getFullTileRange(e);return(0,l.assert)(e,55),(e.getHeight()-t[2]-1).toString()})}}function u(i){return 1===i.length?i[0]:function(e,t,r){var n;if(e)return n=(0,a.hash)(e),n=(0,o.modulo)(n,i.length),i[n](e,t,r)}}},{"./asserts.js":105,"./math.js":267,"./tilecoord.js":371}],377:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.apply=function(e,t){var r=t[0],n=t[1];return t[0]=e[0]*r+e[2]*n+e[4],t[1]=e[1]*r+e[3]*n+e[5],t},r.compose=c,r.composeCssTransform=function(e,t,r,n,i,o,a){return p(c(s(),e,t,r,n,i,o,a))},r.create=s,r.determinant=h,r.invert=function(e){return f(e,e)},r.makeInverse=f,r.makeScale=function(e,t,r){return l(e,t,0,0,r,0,0)},r.multiply=a,r.reset=function(e){return l(e,1,0,0,1,0,0)},r.rotate=function(e,t){var r=Math.cos(t),t=Math.sin(t);return a(e,l(o,r,t,-t,r,0,0))},r.scale=function(e,t,r){return a(e,l(o,t,0,0,r,0,0))},r.set=l,r.setFromArray=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.toString=p,r.translate=function(e,t,r){return a(e,l(o,1,0,0,1,t,r))};var n,i=e("./has.js"),u=e("./asserts.js"),o=new Array(6);function s(){return[1,0,0,1,0,0]}function a(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=t[0],l=t[1],c=t[2],f=t[3],h=t[4],t=t[5];return e[0]=r*u+i*l,e[1]=n*u+o*l,e[2]=r*c+i*f,e[3]=n*c+o*f,e[4]=r*h+i*t+a,e[5]=n*h+o*t+s,e}function l(e,t,r,n,i,o,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e}function c(e,t,r,n,i,o,a,s){var u=Math.sin(o),o=Math.cos(o);return e[0]=n*o,e[1]=i*u,e[2]=-n*u,e[3]=i*o,e[4]=a*n*o-s*n*u+t,e[5]=a*i*u+s*i*o+r,e}function f(e,t){var r=h(t),n=((0,u.assert)(0!==r,32),t[0]),i=t[1],o=t[2],a=t[3],s=t[4],t=t[5];return e[0]=a/r,e[1]=-i/r,e[2]=-o/r,e[3]=n/r,e[4]=(o*t-a*s)/r,e[5]=-(n*t-i*s)/r,e}function h(e){return e[0]*e[3]-e[1]*e[2]}function p(e){var t,e="matrix("+e.join(", ")+")";return i.WORKER_OFFSCREEN_CANVAS?e:((t=n=n||document.createElement("div")).style.transform=e,t.style.transform)}},{"./asserts.js":105,"./has.js":221}],378:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.appendParams=function(e,t){var r=[],n=(Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&r.push(e+"="+encodeURIComponent(t[e]))}),r.join("&"));return e=e.replace(/[?&]$/,""),(e+=e.includes("?")?"&":"?")+n}},{}],379:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION=void 0,r.abstract=function(){throw new Error("Unimplemented abstract method.")},r.getUid=function(e){return e.ol_uid||(e.ol_uid=String(++n))};var n=0;r.VERSION="7.1.0"},{}],380:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r.fromTransform=function(e,t){return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}},{}],381:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UNSIGNED_SHORT=r.UNSIGNED_INT=r.UNSIGNED_BYTE=r.STREAM_DRAW=r.STATIC_DRAW=r.FLOAT=r.ELEMENT_ARRAY_BUFFER=r.DYNAMIC_DRAW=r.ARRAY_BUFFER=void 0,r.getContext=i,r.getSupportedExtensions=function(){{var e;n||(e=i(document.createElement("canvas")))&&(n=e.getSupportedExtensions())}return n};var n,o=e("./has.js"),a=(r.ARRAY_BUFFER=34962,r.ELEMENT_ARRAY_BUFFER=34963,r.STREAM_DRAW=35040,r.STATIC_DRAW=35044,r.DYNAMIC_DRAW=35048,r.UNSIGNED_BYTE=5121,r.UNSIGNED_SHORT=5123,r.UNSIGNED_INT=5125,r.FLOAT=5126,["experimental-webgl","webgl","webkit-3d","moz-webgl"]);function i(e,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!o.SAFARI_BUG_237906},t);for(var r=a.length,n=0;n<r;++n)try{var i=e.getContext(a[n],t);if(i)return i}catch(e){}return null}},{"./has.js":221}],382:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BufferUsage=void 0,r.getArrayClassForType=l;var i=e("../webgl.js"),o=e("../asserts.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}var u={STATIC_DRAW:i.STATIC_DRAW,STREAM_DRAW:i.STREAM_DRAW,DYNAMIC_DRAW:i.DYNAMIC_DRAW},e=(r.BufferUsage=u,function(){function r(e,t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.array=null,this.type=e,(0,o.assert)(e===i.ARRAY_BUFFER||e===i.ELEMENT_ARRAY_BUFFER,62),this.usage=void 0!==t?t:u.STATIC_DRAW}var e,t,n;return e=r,(t=[{key:"ofSize",value:function(e){this.array=new(l(this.type))(e)}},{key:"fromArray",value:function(e){this.array=l(this.type).from(e)}},{key:"fromArrayBuffer",value:function(e){this.array=new(l(this.type))(e)}},{key:"getType",value:function(){return this.type}},{key:"getArray",value:function(){return this.array}},{key:"getUsage",value:function(){return this.usage}},{key:"getSize",value:function(){return this.array?this.array.length:0}}])&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}());function l(e){switch(e){case i.ARRAY_BUFFER:return Float32Array;case i.ELEMENT_ARRAY_BUFFER:return Uint32Array;default:return Float32Array}}r.default=e},{"../asserts.js":105,"../webgl.js":381}],383:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"}},{}],384:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.ShaderType=r.DefaultUniform=r.AttributeType=void 0,r.computeAttributesStride=S,r.default=void 0;var u=a(e("../webgl/ContextEventType.js")),n=a(e("../Disposable.js")),l=a(e("./PostProcessingPass.js")),c=e("../webgl.js"),o=e("../obj.js"),f=e("../transform.js"),h=e("../vec/mat4.js"),p=e("../util.js");function a(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.ShaderType={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633};var v={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",SIZE_PX:"u_sizePx",PIXEL_RATIO:"u_pixelRatio"},b=(r.DefaultUniform=v,{UNSIGNED_BYTE:c.UNSIGNED_BYTE,UNSIGNED_SHORT:c.UNSIGNED_SHORT,UNSIGNED_INT:c.UNSIGNED_INT,FLOAT:c.FLOAT}),_=(r.AttributeType=b,{});function w(e){return"shared/"+e}var x=0;e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,a=g(s);function s(e){var t,r,n,i;if(!(this instanceof s))throw new TypeError("Cannot call a class as a function");e=e||{},(t=a.call(this)).boundHandleWebGLContextLost_=t.handleWebGLContextLost.bind(m(t)),t.boundHandleWebGLContextRestored_=t.handleWebGLContextRestored.bind(m(t)),t.canvasCacheKey_=e.canvasCacheKey?w(e.canvasCacheKey):(r="unique/"+x,x+=1,r),t.canvas_=(r=t.canvasCacheKey_,(i=_[r])||((n=document.createElement("canvas")).style.position="absolute",n.style.left="0",_[r]=i={users:0,canvas:n}),i.users+=1,i.canvas),t.gl_=(0,c.getContext)(t.canvas_),t.bufferCache_={},t.extensionCache_={},t.currentProgram_=null,t.canvas_.addEventListener(u.default.LOST,t.boundHandleWebGLContextLost_),t.canvas_.addEventListener(u.default.RESTORED,t.boundHandleWebGLContextRestored_),t.offsetRotateMatrix_=(0,f.create)(),t.offsetScaleMatrix_=(0,f.create)(),t.tmpMat4_=(0,h.create)(),t.uniformLocations_={},t.attribLocations_={},t.uniforms_=[],e.uniforms&&t.setUniforms(e.uniforms);var o=t.getGL();return t.postProcessPasses_=e.postProcesses?e.postProcesses.map(function(e){return new l.default({webGlContext:o,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})}):[new l.default({webGlContext:o})],t.shaderCompileErrors_=null,t.startTime_=Date.now(),t}return t=s,(e=[{key:"setUniforms",value:function(e){for(var t in this.uniforms_=[],e)this.uniforms_.push({name:t,value:e[t]});this.uniformLocations_={}}},{key:"canvasCacheKeyMatches",value:function(e){return this.canvasCacheKey_===w(e)}},{key:"getExtension",value:function(e){var t;return e in this.extensionCache_?this.extensionCache_[e]:(t=this.gl_.getExtension(e),this.extensionCache_[e]=t)}},{key:"bindBuffer",value:function(e){var t=this.getGL(),r=(0,p.getUid)(e),n=this.bufferCache_[r];n||(n={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=n),t.bindBuffer(e.getType(),n.webGlBuffer)}},{key:"flushBufferData",value:function(e){var t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}},{key:"deleteBuffer",value:function(e){var t=this.getGL(),e=(0,p.getUid)(e),r=this.bufferCache_[e];r&&!t.isContextLost()&&t.deleteBuffer(r.webGlBuffer),delete this.bufferCache_[e]}},{key:"disposeInternal",value:function(){var e,t;this.canvas_.removeEventListener(u.default.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(u.default.RESTORED,this.boundHandleWebGLContextRestored_),e=this.canvasCacheKey_,(t=_[e])&&(--t.users,0<t.users||(t=t.canvas,(t=(0,c.getContext)(t).getExtension("WEBGL_lose_context"))&&t.loseContext(),delete _[e])),delete this.gl_,delete this.canvas_}},{key:"prepareDraw",value:function(e,t){var r=this.getGL(),n=this.getCanvas(),i=e.size,o=e.pixelRatio;n.width=i[0]*o,n.height=i[1]*o,n.style.width=i[0]+"px",n.style.height=i[1]+"px";for(var a=this.postProcessPasses_.length-1;0<=a;a--)this.postProcessPasses_[a].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,t?r.ZERO:r.ONE_MINUS_SRC_ALPHA)}},{key:"prepareDrawToRenderTarget",value:function(e,t,r){var n=this.getGL(),i=t.getSize();n.bindFramebuffer(n.FRAMEBUFFER,t.getFramebuffer()),n.viewport(0,0,i[0],i[1]),n.bindTexture(n.TEXTURE_2D,t.getTexture()),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,r?n.ZERO:n.ONE_MINUS_SRC_ALPHA)}},{key:"drawElements",value:function(e,t){var r=this.getGL(),n=(this.getExtension("OES_element_index_uint"),r.UNSIGNED_INT);r.drawElements(r.TRIANGLES,t-e,n,4*e)}},{key:"finalizeDraw",value:function(e,t,r){for(var n=0,i=this.postProcessPasses_.length;n<i;n++)n===i-1?this.postProcessPasses_[n].apply(e,null,t,r):this.postProcessPasses_[n].apply(e,this.postProcessPasses_[n+1])}},{key:"getCanvas",value:function(){return this.canvas_}},{key:"getGL",value:function(){return this.gl_}},{key:"applyFrameState",value:function(e){var t=e.size,r=e.viewState.rotation,n=e.pixelRatio,i=(0,f.reset)(this.offsetScaleMatrix_),o=((0,f.scale)(i,2/t[0],2/t[1]),(0,f.reset)(this.offsetRotateMatrix_));0!==r&&(0,f.rotate)(o,-r),this.setUniformMatrixValue(v.OFFSET_SCALE_MATRIX,(0,h.fromTransform)(this.tmpMat4_,i)),this.setUniformMatrixValue(v.OFFSET_ROTATION_MATRIX,(0,h.fromTransform)(this.tmpMat4_,o)),this.setUniformFloatValue(v.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(v.ZOOM,e.viewState.zoom),this.setUniformFloatValue(v.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(v.PIXEL_RATIO,n),this.setUniformFloatVec2(v.SIZE_PX,[t[0],t[1]])}},{key:"applyUniforms",value:function(t){var r,n=this.getGL(),i=0;this.uniforms_.forEach(function(e){if((r="function"==typeof e.value?e.value(t):e.value)instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData)e.texture||(e.prevValue=void 0,e.texture=n.createTexture()),n.activeTexture(n["TEXTURE".concat(i)]),n.bindTexture(n.TEXTURE_2D,e.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r instanceof HTMLImageElement&&!r.complete||e.prevValue===r||(e.prevValue=r,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)),n.uniform1i(this.getUniformLocation(e.name),i++);else if(Array.isArray(r)&&6===r.length)this.setUniformMatrixValue(e.name,(0,h.fromTransform)(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:return void n.uniform2f(this.getUniformLocation(e.name),r[0],r[1]);case 3:return void n.uniform3f(this.getUniformLocation(e.name),r[0],r[1],r[2]);case 4:return void n.uniform4f(this.getUniformLocation(e.name),r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&n.uniform1f(this.getUniformLocation(e.name),r)}.bind(this))}},{key:"useProgram",value:function(e,t){this.getGL().useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},this.applyFrameState(t),this.applyUniforms(t)}},{key:"compileShader",value:function(e,t){var r=this.getGL(),t=r.createShader(t);return r.shaderSource(t,e),r.compileShader(t),t}},{key:"getProgram",value:function(e,t){var r,n=this.getGL(),e=this.compileShader(e,n.FRAGMENT_SHADER),t=this.compileShader(t,n.VERTEX_SHADER),i=n.createProgram();if(n.attachShader(i,e),n.attachShader(i,t),n.linkProgram(i),!n.getShaderParameter(e,n.COMPILE_STATUS))throw r="Fragment shader compliation failed: ".concat(n.getShaderInfoLog(e)),new Error(r);if(n.deleteShader(e),!n.getShaderParameter(t,n.COMPILE_STATUS))throw r="Vertex shader compilation failed: ".concat(n.getShaderInfoLog(t)),new Error(r);if(n.deleteShader(t),n.getProgramParameter(i,n.LINK_STATUS))return i;throw e="GL program linking failed: ".concat(n.getShaderInfoLog(t)),new Error(e)}},{key:"getUniformLocation",value:function(e){return void 0===this.uniformLocations_[e]&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]}},{key:"getAttributeLocation",value:function(e){return void 0===this.attribLocations_[e]&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]}},{key:"makeProjectionTransform",value:function(e,t){var r=e.size,n=e.viewState.rotation,i=e.viewState.resolution,e=e.viewState.center;return(0,f.reset)(t),(0,f.compose)(t,0,0,2/(i*r[0]),2/(i*r[1]),-n,-e[0],-e[1]),t}},{key:"setUniformFloatValue",value:function(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)}},{key:"setUniformFloatVec2",value:function(e,t){this.getGL().uniform2fv(this.getUniformLocation(e),t)}},{key:"setUniformFloatVec4",value:function(e,t){this.getGL().uniform4fv(this.getUniformLocation(e),t)}},{key:"setUniformMatrixValue",value:function(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)}},{key:"enableAttributeArray_",value:function(e,t,r,n,i){e=this.getAttributeLocation(e);e<0||(this.getGL().enableVertexAttribArray(e),this.getGL().vertexAttribPointer(e,t,r,!1,n,i))}},{key:"enableAttributes",value:function(e){for(var t=S(e),r=0,n=0;n<e.length;n++){var i=e[n];this.enableAttributeArray_(i.name,i.size,i.type||c.FLOAT,t,r),r+=i.size*j(i.type)}}},{key:"handleWebGLContextLost",value:function(){(0,o.clear)(this.bufferCache_),this.currentProgram_=null}},{key:"handleWebGLContextRestored",value:function(){}},{key:"createTexture",value:function(e,t,r){var n=this.getGL(),i=(r=r||n.createTexture(),n.RGBA),o=n.RGBA,a=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,r),t?n.texImage2D(n.TEXTURE_2D,0,i,o,a,t):n.texImage2D(n.TEXTURE_2D,0,i,e[0],e[1],0,o,a,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r}}])&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default);function S(e){for(var t=0,r=0;r<e.length;r++){var n=e[r];t+=n.size*j(n.type)}return t}function j(e){switch(e){case b.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case b.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case b.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;default:b.FLOAT;return Float32Array.BYTES_PER_ELEMENT}}r.default=e},{"../Disposable.js":74,"../obj.js":269,"../transform.js":377,"../util.js":379,"../vec/mat4.js":380,"../webgl.js":381,"../webgl/ContextEventType.js":383,"./PostProcessingPass.js":386}],385:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function r(e,t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.name=e,this.data=t,this.texture_=null}var e,t,n;return e=r,(t=[{key:"getTexture",value:function(e){var t;return this.texture_||(t=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t),this.texture_}}])&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}();r.default=n},{}],386:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=e("../util.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}e=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.gl_=t.webGlContext;var r=this.gl_,e=(this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=r.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=r.createFramebuffer(),r.createShader(r.VERTEX_SHADER)),n=(r.shaderSource(e,t.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),r.compileShader(e),r.createShader(r.FRAGMENT_SHADER));r.shaderSource(n,t.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),r.compileShader(n),this.renderTargetProgram_=r.createProgram(),r.attachShader(this.renderTargetProgram_,e),r.attachShader(this.renderTargetProgram_,n),r.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),r.STATIC_DRAW),this.renderTargetAttribLocation_=r.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(function(e){this.uniforms_.push({value:t.uniforms[e],location:r.getUniformLocation(this.renderTargetProgram_,e)})}.bind(this))}var e,t,r;return e=i,(t=[{key:"getGL",value:function(){return this.gl_}},{key:"init",value:function(e){var t,r,n,i=this.getGL(),o=[i.drawingBufferWidth*this.scaleRatio_,i.drawingBufferHeight*this.scaleRatio_];i.bindFramebuffer(i.FRAMEBUFFER,this.getFrameBuffer()),i.viewport(0,0,o[0],o[1]),this.renderTargetTextureSize_&&this.renderTargetTextureSize_[0]===o[0]&&this.renderTargetTextureSize_[1]===o[1]||(this.renderTargetTextureSize_=o,t=i.RGBA,r=i.RGBA,n=i.UNSIGNED_BYTE,i.bindTexture(i.TEXTURE_2D,this.renderTargetTexture_),i.texImage2D(i.TEXTURE_2D,0,t,o[0],o[1],0,r,n,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.renderTargetTexture_,0))}},{key:"apply",value:function(e,t,r,n){var i=this.getGL(),o=e.size,a=(i.bindFramebuffer(i.FRAMEBUFFER,t?t.getFrameBuffer():null),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.renderTargetTexture_),t||(t=(0,s.getUid)(i.canvas),e.renderTargets[t])||((a=i.getContextAttributes())&&a.preserveDrawingBuffer&&(i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT)),e.renderTargets[t]=!0),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),i.useProgram(this.renderTargetProgram_),i.enableVertexAttribArray(this.renderTargetAttribLocation_),i.vertexAttribPointer(this.renderTargetAttribLocation_,2,i.FLOAT,!1,0,0),i.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),i.uniform1i(this.renderTargetTextureLocation_,0),e.layerStatesArray[e.layerIndex].opacity);i.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),r&&r(i,e),i.drawArrays(i.TRIANGLES,0,6),n&&n(i,e)}},{key:"getFrameBuffer",value:function(){return this.frameBuffer_}},{key:"applyUniforms",value:function(t){var r,n=this.getGL(),i=1;this.uniforms_.forEach(function(e){if((r="function"==typeof e.value?e.value(t):e.value)instanceof HTMLCanvasElement||r instanceof ImageData)e.texture||(e.texture=n.createTexture()),n.activeTexture(n["TEXTURE".concat(i)]),n.bindTexture(n.TEXTURE_2D,e.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,r.width,r.height,0,n.UNSIGNED_BYTE,new Uint8Array(r.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.uniform1i(e.location,i++);else if(Array.isArray(r))switch(r.length){case 2:return void n.uniform2f(e.location,r[0],r[1]);case 3:return void n.uniform3f(e.location,r[0],r[1],r[2]);case 4:return void n.uniform4f(e.location,r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&n.uniform1f(e.location,r)})}}])&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();r.default=e},{"../util.js":379}],387:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../array.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}var s=new Uint8Array(4),e=function(){function r(e,t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");e=(this.helper_=e).getGL();this.texture_=e.createTexture(),this.framebuffer_=e.createFramebuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}var e,t,n;return e=r,(t=[{key:"setSize",value:function(e){(0,i.equals)(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}},{key:"getSize",value:function(){return this.size_}},{key:"clearCachedData",value:function(){this.dataCacheDirty_=!0}},{key:"readAll",value:function(){var e,t;return this.dataCacheDirty_&&(e=this.size_,(t=this.helper_.getGL()).bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1),this.data_}},{key:"readPixel",value:function(e,t){return e<0||t<0||e>this.size_[0]||t>=this.size_[1]?(s[0]=0,s[1]=0,s[2]=0,s[3]=0):(this.readAll(),e=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0],s[0]=this.data_[4*e],s[1]=this.data_[4*e+1],s[2]=this.data_[4*e+2],s[3]=this.data_[4*e+3]),s}},{key:"getTexture",value:function(){return this.texture_}},{key:"getFramebuffer",value:function(){return this.framebuffer_}},{key:"updateSize_",value:function(){var e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(e[0]*e[1]*4)}}])&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}();r.default=e},{"../array.js":104}],388:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShaderBuilder=void 0,r.parseLiteralStyle=function(r){var e=r.symbol,t=void 0!==e.size?e.size:1,n=e.color||"white",i=e.textureCoord||[0,0,1,1],o=e.offset||[0,0],a=void 0!==e.opacity?e.opacity:1,s=void 0!==e.rotation?e.rotation:0,u={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{},functions:{}},l=(0,m.expressionToGlsl)(u,t,m.ValueTypes.NUMBER_ARRAY|m.ValueTypes.NUMBER),o=(0,m.expressionToGlsl)(u,o,m.ValueTypes.NUMBER_ARRAY),i=(0,m.expressionToGlsl)(u,i,m.ValueTypes.NUMBER_ARRAY),s=(0,m.expressionToGlsl)(u,s,m.ValueTypes.NUMBER),c={inFragmentShader:!0,variables:u.variables,attributes:[],stringLiteralsMap:u.stringLiteralsMap,functions:{}},n=(0,m.expressionToGlsl)(c,n,m.ValueTypes.COLOR),a=(0,m.expressionToGlsl)(c,a,m.ValueTypes.NUMBER),f="1.0",h="vec2(".concat((0,m.expressionToGlsl)(c,t,m.ValueTypes.NUMBER_ARRAY|m.ValueTypes.NUMBER),").x");switch(e.symbolType){case"square":case"image":break;case"circle":f="(1.0-smoothstep(1.-4./".concat(h,",1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))");break;case"triangle":var p="(v_quadCoord*2.-1.)",d="(atan(".concat(p,".x,").concat(p,".y))");f="(1.0-smoothstep(.5-3./".concat(h,",.5,cos(floor(.5+").concat(d,"/2.094395102)*2.094395102-").concat(d,")*length(").concat(p,")))");break;default:throw new Error("Unexpected symbol type: "+e.symbolType)}var y=(new v).setSizeExpression("vec2(".concat(l,")")).setRotationExpression(s).setSymbolOffsetExpression(o).setTextureCoordinateExpression(i).setSymbolRotateWithView(!!e.rotateWithView).setColorExpression("vec4(".concat(n,".rgb, ").concat(n,".a * ").concat(a," * ").concat(f,")"));r.filter&&(t=(0,m.expressionToGlsl)(c,r.filter,m.ValueTypes.BOOLEAN),y.setFragmentDiscardExpression("!".concat(t)));var g={};c.variables.forEach(function(t){var e=(0,m.uniformNameForVariable)(t);y.addUniform("float ".concat(e)),g[e]=function(){var e;if(r.variables&&void 0!==r.variables[t])return void 0!==(e="string"==typeof(e=r.variables[t])?(0,m.getStringNumberEquivalent)(u,e):e)?e:-9999999;throw new Error("The following variable is missing from the style: ".concat(t))}}),"image"===e.symbolType&&e.src&&((l=new Image).crossOrigin=void 0===e.crossOrigin?"anonymous":e.crossOrigin,l.src=e.src,y.addUniform("sampler2D u_texture").setColorExpression(y.getColorExpression()+" * texture2D(u_texture, v_texCoord)"),g.u_texture=l);return c.attributes.forEach(function(e){u.attributes.includes(e)||u.attributes.push(e),y.addVarying("v_".concat(e),"float","a_".concat(e))}),u.attributes.forEach(function(e){y.addAttribute("float a_".concat(e))}),{builder:y,attributes:u.attributes.map(function(r){return{name:r,callback:function(e,t){t=t[r];return void 0!==(t="string"==typeof t?(0,m.getStringNumberEquivalent)(u,t):t)?t:-9999999}}}),uniforms:g}};var m=e("../style/expressions.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}var v=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.uniforms=[],this.attributes=[],this.varyings=[],this.sizeExpression="vec2(1.0)",this.rotationExpression="0.0",this.offsetExpression="vec2(0.0)",this.colorExpression="vec4(1.0)",this.texCoordExpression="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression="false",this.rotateWithView=!1}var t,r,n;return t=e,(r=[{key:"addUniform",value:function(e){return this.uniforms.push(e),this}},{key:"addAttribute",value:function(e){return this.attributes.push(e),this}},{key:"addVarying",value:function(e,t,r){return this.varyings.push({name:e,type:t,expression:r}),this}},{key:"setSizeExpression",value:function(e){return this.sizeExpression=e,this}},{key:"setRotationExpression",value:function(e){return this.rotationExpression=e,this}},{key:"setSymbolOffsetExpression",value:function(e){return this.offsetExpression=e,this}},{key:"setColorExpression",value:function(e){return this.colorExpression=e,this}},{key:"setTextureCoordinateExpression",value:function(e){return this.texCoordExpression=e,this}},{key:"setFragmentDiscardExpression",value:function(e){return this.discardExpression=e,this}},{key:"setSymbolRotateWithView",value:function(e){return this.rotateWithView=e,this}},{key:"getSizeExpression",value:function(){return this.sizeExpression}},{key:"getOffsetExpression",value:function(){return this.offsetExpression}},{key:"getColorExpression",value:function(){return this.colorExpression}},{key:"getTextureCoordinateExpression",value:function(){return this.texCoordExpression}},{key:"getFragmentDiscardExpression",value:function(){return this.discardExpression}},{key:"getSymbolVertexShader",value:function(e){var t=this.rotateWithView?"u_offsetScaleMatrix * u_offsetRotateMatrix":"u_offsetScaleMatrix",r=this.attributes,n=this.varyings;return e&&(r=r.concat("vec4 a_hitColor"),n=n.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),"precision mediump float;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\n".concat(this.uniforms.map(function(e){return"uniform "+e+";"}).join("\n"),"\nattribute vec2 a_position;\nattribute float a_index;\n").concat(r.map(function(e){return"attribute "+e+";"}).join("\n"),"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n").concat(n.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n"),"\nvoid main(void) {\n  mat4 offsetMatrix = ").concat(t,";\n  vec2 halfSize = ").concat(this.sizeExpression," * 0.5;\n  vec2 offset = ").concat(this.offsetExpression,";\n  float angle = ").concat(this.rotationExpression,";\n  float offsetX;\n  float offsetY;\n  if (a_index == 0.0) {\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\n  } else if (a_index == 1.0) {\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\n  } else if (a_index == 2.0) {\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\n  } else {\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\n  }\n  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  vec4 texCoord = ").concat(this.texCoordExpression,";\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;\n  v_texCoord = vec2(u, v);\n  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v_quadCoord = vec2(u, v);\n").concat(n.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n"),"\n}")}},{key:"getSymbolFragmentShader",value:function(e){var t=e?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"",r=this.varyings;return e&&(r=r.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),"precision mediump float;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\n".concat(this.uniforms.map(function(e){return"uniform "+e+";"}).join("\n"),"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n").concat(r.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n"),"\nvoid main(void) {\n  if (").concat(this.discardExpression,") { discard; }\n  gl_FragColor = ").concat(this.colorExpression,";\n  gl_FragColor.rgb *= gl_FragColor.a;\n").concat(t,"\n}")}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.ShaderBuilder=v},{"../style/expressions.js":369}],389:[function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var h=c(e("../DataTile.js")),n=c(e("../events/Target.js")),o=c(e("../events/EventType.js")),T=c(e("../ImageTile.js")),C=c(e("../reproj/Tile.js")),a=c(e("../TileState.js")),s=c(e("./Buffer.js")),u=e("../webgl.js"),l=e("../size.js");function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,r){r=r?e.LINEAR:e.NEAREST;e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r)}function M(e,t,r,n,i,o){var a,s,u=e.getGL(),t=(e=r instanceof Float32Array?(a=u.FLOAT,e.getExtension("OES_texture_float"),null!==e.getExtension("OES_texture_float_linear")):(a=u.UNSIGNED_BYTE,!0),R(u,t,o&&e),r.byteLength/n[1]),o=1;switch(t%8==0?o=8:t%4==0?o=4:t%2==0&&(o=2),i){case 1:s=u.LUMINANCE;break;case 2:s=u.LUMINANCE_ALPHA;break;case 3:s=u.RGB;break;case 4:s=u.RGBA;break;default:throw new Error("Unsupported number of bands: ".concat(i))}e=u.getParameter(u.UNPACK_ALIGNMENT);u.pixelStorei(u.UNPACK_ALIGNMENT,o),u.texImage2D(u.TEXTURE_2D,0,s,n[0],n[1],0,s,a,r),u.pixelStorei(u.UNPACK_ALIGNMENT,e)}var m=null;e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(i);function i(e){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this)).tile,t.textures=[],t.handleTileChange_=t.handleTileChange_.bind(y(t)),t.renderSize_=(0,l.toSize)(e.grid.getTileSize(e.tile.tileCoord[0])),t.gutter_=e.gutter||0,t.bandCount=NaN,t.helper_=e.helper;var r=new s.default(u.ARRAY_BUFFER,u.STATIC_DRAW);return r.fromArray([0,1,1,1,1,0,0,0]),t.helper_.flushBufferData(r),t.coords=r,t.setTile(e.tile),t}return t=i,(e=[{key:"setTile",value:function(e){var t;e!==this.tile&&(this.tile&&this.tile.removeEventListener(o.default.CHANGE,this.handleTileChange_),this.tile=e,this.textures.length=0,this.loaded=e.getState()===a.default.LOADED,this.loaded?this.uploadTile_():(e instanceof T.default&&(t=e.getImage())instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous"),e.addEventListener(o.default.CHANGE,this.handleTileChange_)))}},{key:"uploadTile_",value:function(){var e=this.helper_,t=e.getGL(),r=this.tile;if(r instanceof T.default||r instanceof C.default)o=t.createTexture(),this.textures.push(o),this.bandCount=4,i=t,o=o,n=r.getImage(),u=r.interpolate,R(i,o,u),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n);else{var n,i,o=r.getSize(),a=[o[0]+2*this.gutter_,o[1]+2*this.gutter_],s=r.getData(),u=s instanceof Float32Array,l=a[0]*a[1],c=u?Float32Array:Uint8Array,f=c.BYTES_PER_ELEMENT,h=s.byteLength/a[1],p=(this.bandCount=Math.floor(h/f/a[0]),Math.ceil(this.bandCount/4));if(1===p)i=t.createTexture(),this.textures.push(i),M(e,i,s,a,this.bandCount,r.interpolate);else{for(var d=new Array(p),y=0;y<p;++y){var g=t.createTexture(),g=(this.textures.push(g),y<p-1?4:(this.bandCount-1)%4+1);d[y]=new c(l*g)}for(var m=0,v=0,b=a[0]*this.bandCount,_=0;_<a[1];++_){for(var w=0;w<b;++w){var x=s[v+w],S=Math.floor(m/this.bandCount),j=w%this.bandCount,O=d[Math.floor(j/4)];O[S*(O.length/l)+j%4]=x,++m}v+=h/f}for(var P=0;P<p;++P){var k=this.textures[P],E=d[P];M(e,k,E,a,E.length/l,r.interpolate)}}}}},{key:"handleTileChange_",value:function(){this.tile.getState()===a.default.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(o.default.CHANGE))}},{key:"disposeInternal",value:function(){var e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t]);this.tile.removeEventListener(o.default.CHANGE,this.handleTileChange_)}},{key:"getPixelData",value:function(e,t){if(!this.loaded)return null;var r,n=this.renderSize_[0],i=this.renderSize_[1],o=this.gutter_;if(this.tile instanceof h.default)return u=(l=(s=this.tile.getSize())[0])+2*o,f=(s=s[1])+2*o,l=o+Math.floor(l*(e/n)),s=o+Math.floor(s*(t/i)),(c=this.tile.getData())instanceof DataView?(f=c.byteLength/(u*f),r=c.buffer.slice(r=f*(s*u+l),r+f),new DataView(r)):(f=this.bandCount*(s*u+l),c.slice(f,f+this.bandCount));m||((r=document.createElement("canvas")).width=1,r.height=1,m=r.getContext("2d")),m.clearRect(0,0,1,1);var a,s=this.tile.getImage(),u=s.width,l=s.height-2*o,c=o+Math.floor(e/n*(u-2*o)),f=o+Math.floor(t/i*l);try{m.drawImage(s,c,f,1,1,0,0,1,1),a=m.getImageData(0,0,1,1).data}catch(e){return m=null}return a}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e},{"../DataTile.js":73,"../ImageTile.js":81,"../TileState.js":98,"../events/EventType.js":127,"../events/Target.js":129,"../reproj/Tile.js":314,"../size.js":319,"../webgl.js":381,"./Buffer.js":382}],390:[function(e,t,r){!function(t){!function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var e='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS",r="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";r.includes("firefox");r.includes("safari")&&!r.includes("chrom")&&(r.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(r)),r.includes("webkit")&&r.includes("edge"),r.includes("macintosh"),"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch(e){}}();const o={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:\'`renderMode` must be `"hybrid"` or `"vector"`\',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection"};class i extends Error{constructor(e){const t=o[e];super(t),this.code=e,this.name="AssertionError",this.message=t}}function s(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function a(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new i(t)}(0!==n,32);const o=t[0],s=t[1],a=t[2],u=t[3],x=t[4],f=t[5];return e[0]=u/n,e[1]=-s/n,e[2]=-a/n,e[3]=o/n,e[4]=(a*f-u*x)/n,e[5]=-(o*f-s*x)/n,e}new Array(6);var u={exports:{}};function x(e,t,n){n=n||2;var r,o,i,s,a,u,x,y=t&&t.length,d=y?t[0]*n:e.length,h=f(e,0,d,n,!0),v=[];if(!h||h.next===h.prev)return v;if(y&&(h=function(e,t,n,r){var o,i,s,a=[];for(o=0,i=t.length;o<i;o++)(s=f(e,t[o]*r,o<i-1?t[o+1]*r:e.length,r,!1))===s.next&&(s.steiner=!0),a.push(w(s));for(a.sort(p),o=0;o<a.length;o++)n=l(n=g(a[o],n),n.next);return n}(e,t,h,n)),e.length>80*n){r=i=e[0],o=s=e[1];for(var b=n;b<d;b+=n)(a=e[b])<r&&(r=a),(u=e[b+1])<o&&(o=u),a>i&&(i=a),u>s&&(s=u);x=0!==(x=Math.max(i-r,s-o))?1/x:0}return c(h,v,n,r,o,x),v}function f(e,t,n,r,o){var i,s;if(o===B(e,t,n,r)>0)for(i=t;i<n;i+=r)s=U(i,e[i],e[i+1],s);else for(i=n-r;i>=t;i-=r)s=U(i,e[i],e[i+1],s);return s&&M(s,s.next)&&(z(s),s=s.next),s}function l(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!M(r,r.next)&&0!==Z(r.prev,r,r.next))r=r.next;else{if(z(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function c(e,t,n,r,o,i,s){if(e){!s&&i&&function(e,t,n,r){var o=e;do{null===o.z&&(o.z=m(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,s,a,u,x=1;do{for(n=e,e=null,i=null,s=0;n;){for(s++,r=n,a=0,t=0;t<x&&(a++,r=r.nextZ);t++);for(u=x;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(o=n,n=n.nextZ,a--):(o=r,r=r.nextZ,u--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,x*=2}while(s>1)}(o)}(e,r,o,i);for(var a,u,x=e;e.prev!==e.next;)if(a=e.prev,u=e.next,i?d(e,r,o,i):y(e))t.push(a.i/n),t.push(e.i/n),t.push(u.i/n),z(e),e=u.next,x=u.next;else if((e=u)===x){s?1===s?c(e=h(l(e),t,n),t,n,r,o,i,2):2===s&&v(e,t,n,r,o,i):c(l(e),t,n,r,o,i,1);break}}}function y(e){var t=e.prev,n=e,r=e.next;if(Z(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(A(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&Z(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function d(e,t,n,r){var o=e.prev,i=e,s=e.next;if(Z(o,i,s)>=0)return!1;for(var a=o.x<i.x?o.x<s.x?o.x:s.x:i.x<s.x?i.x:s.x,u=o.y<i.y?o.y<s.y?o.y:s.y:i.y<s.y?i.y:s.y,x=o.x>i.x?o.x>s.x?o.x:s.x:i.x>s.x?i.x:s.x,f=o.y>i.y?o.y>s.y?o.y:s.y:i.y>s.y?i.y:s.y,l=m(a,u,t,n,r),c=m(x,f,t,n,r),y=e.prevZ,d=e.nextZ;y&&y.z>=l&&d&&d.z<=c;){if(y!==e.prev&&y!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,y.x,y.y)&&Z(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,d!==e.prev&&d!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,d.x,d.y)&&Z(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;y&&y.z>=l;){if(y!==e.prev&&y!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,y.x,y.y)&&Z(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;d&&d.z<=c;){if(d!==e.prev&&d!==e.next&&A(o.x,o.y,i.x,i.y,s.x,s.y,d.x,d.y)&&Z(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function h(e,t,n){var r=e;do{var o=r.prev,i=r.next.next;!M(o,i)&&F(o,r,r.next,i)&&k(o,i)&&k(i,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(i.i/n),z(r),z(r.next),r=e=i),r=r.next}while(r!==e);return l(r)}function v(e,t,n,r,o,i){var s=e;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&E(s,a)){var u=S(s,a);return s=l(s,s.next),u=l(u,u.next),c(s,t,n,r,o,i),void c(u,t,n,r,o,i)}a=a.next}s=s.next}while(s!==e)}function p(e,t){return e.x-t.x}function g(e,t){var n=function(e,t){var n,r=t,o=e.x,i=e.y,s=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>s){if(s=a,a===o){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(o===s)return n;var u,x=n,f=n.x,l=n.y,c=1/0;r=n;do{o>=r.x&&r.x>=f&&o!==r.x&&A(i<l?o:s,i,f,l,i<l?s:o,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(o-r.x),k(r,e)&&(u<c||u===c&&(r.x>n.x||r.x===n.x&&b(n,r)))&&(n=r,c=u)),r=r.next}while(r!==x);return n}(e,t);if(!n)return t;var r=S(n,e),o=l(n,n.next);return l(r,r.next),t===n?o:t}function b(e,t){return Z(e.prev,e,t.prev)<0&&Z(t.next,e,e.next)<0}function m(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function w(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function A(e,t,n,r,o,i,s,a){return(o-s)*(t-a)-(e-s)*(i-a)>=0&&(e-s)*(r-a)-(n-s)*(t-a)>=0&&(n-s)*(i-a)-(o-s)*(r-a)>=0}function E(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&F(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(k(e,t)&&k(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Z(e.prev,e,t.prev)||Z(e,t.prev,t))||M(e,t)&&Z(e.prev,e,e.next)>0&&Z(t.prev,t,t.next)>0)}function Z(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function M(e,t){return e.x===t.x&&e.y===t.y}function F(e,t,n,r){var o=I(Z(e,t,n)),i=I(Z(e,t,r)),s=I(Z(n,r,e)),a=I(Z(n,r,t));return o!==i&&s!==a||(!(0!==o||!T(e,n,t))||(!(0!==i||!T(e,r,t))||(!(0!==s||!T(n,e,r))||!(0!==a||!T(n,t,r)))))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function k(e,t){return Z(e.prev,e,e.next)<0?Z(e,t,e.next)>=0&&Z(e,e.prev,t)>=0:Z(e,t,e.prev)<0||Z(e,e.next,t)<0}function S(e,t){var n=new R(e.i,e.x,e.y),r=new R(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function U(e,t,n,r){var o=new R(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function R(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(e,t,n,r){for(var o=0,i=t,s=n-r;i<n;i+=r)o+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return o}u.exports=x,u.exports.default=x,x.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,s=Math.abs(B(e,0,i,n));if(o)for(var a=0,u=t.length;a<u;a++){var x=t[a]*n,f=a<u-1?t[a+1]*n:e.length;s-=Math.abs(B(e,x,f,n))}var l=0;for(a=0;a<r.length;a+=3){var c=r[a]*n,y=r[a+1]*n,d=r[a+2]*n;l+=Math.abs((e[c]-e[d])*(e[y+1]-e[c+1])-(e[c]-e[y])*(e[d+1]-e[c+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},x.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var s=0;s<t;s++)n.vertices.push(e[o][i][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};const P=[],C={vertexPosition:0,indexPosition:0};function N(e,t,n,r,o){e[t+0]=n,e[t+1]=r,e[t+2]=o}function _(e,t,n,r,o,i){const s=3+o,a=e[t+0],u=e[t+1],x=P;x.length=o;for(let n=0;n<x.length;n++)x[n]=e[t+2+n];let f=i?i.vertexPosition:0,l=i?i.indexPosition:0;const c=f/s;return N(n,f,a,u,0),x.length&&n.set(x,f+3),f+=s,N(n,f,a,u,1),x.length&&n.set(x,f+3),f+=s,N(n,f,a,u,2),x.length&&n.set(x,f+3),f+=s,N(n,f,a,u,3),x.length&&n.set(x,f+3),f+=s,r[l++]=c,r[l++]=c+1,r[l++]=c+3,r[l++]=c+1,r[l++]=c+2,r[l++]=c+3,C.vertexPosition=f,C.indexPosition=l,C}function L(e,t,n,r,o,i,a,u,x,f){const l=5+u.length,c=i.length/l,y=[e[t+0],e[t+1]],d=[e[n],e[n+1]],h=s(f,[...y]),v=s(f,[...d]);function p(e,t,n){const r=1e4;return Math.round(1500*t)+Math.round(1500*n)*r+e*r*r}function g(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),o=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-o[1],o[0]],s=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),a=[(n[0]-e[0])/s,(n[1]-e[1])/s],u=0===r||0===s?0:Math.acos((x=a[0]*o[0]+a[1]*o[1],f=-1,l=1,Math.min(Math.max(x,f),l)));var x,f,l;return a[0]*i[0]+a[1]*i[1]>0?u:2*Math.PI-u}const b=null!==o;let m=0,w=0;if(null!==r){m=g(h,v,s(f,[...[e[r],e[r+1]]]))}if(b){w=g(v,h,s(f,[...[e[o],e[o+1]]]))}i.push(y[0],y[1],d[0],d[1],p(0,m,w)),i.push(...u),i.push(y[0],y[1],d[0],d[1],p(1,m,w)),i.push(...u),i.push(y[0],y[1],d[0],d[1],p(2,m,w)),i.push(...u),i.push(y[0],y[1],d[0],d[1],p(3,m,w)),i.push(...u),a.push(c,c+1,c+2,c+1,c+3,c+2)}function G(e,t,n,r,o){const i=2+o;let s=t;const a=e.slice(s,s+o);s+=o;const x=e[s++];let f=0;const l=new Array(x-1);for(let t=0;t<x;t++)f+=e[s++],t<x-1&&(l[t]=f);const c=e.slice(s,s+2*f),y=u.exports(c,l,2);for(let e=0;e<y.length;e++)r.push(y[e]+n.length/i);for(let e=0;e<c.length;e+=2)n.push(c[e],c[e+1],...a);return s+2*f}const O=self;O.onmessage=r=>{const o=r.data;switch(o.type){case t:{const e=3,t=2,n=o.customAttributesCount,r=t+n,i=new Float32Array(o.renderInstructions),s=i.length/r,a=4*s*(n+e),u=new Uint32Array(6*s),x=new Float32Array(a);let f;for(let e=0;e<i.length;e+=r)f=_(i,e,x,u,n,f);const l=Object.assign({vertexBuffer:x.buffer,indexBuffer:u.buffer,renderInstructions:i.buffer},o);O.postMessage(l,[x.buffer,u.buffer,i.buffer]);break}case n:{const e=[],t=[],n=o.customAttributesCount,r=2,i=new Float32Array(o.renderInstructions);let s=0;const u=o.renderInstructionsTransform,x=[1,0,0,1,0,0];let f,l;for(a(x,u);s<i.length;){l=Array.from(i.slice(s,s+n)),s+=n,f=i[s++];for(let n=0;n<f-1;n++)L(i,s+n*r,s+(n+1)*r,n>0?s+(n-1)*r:null,n<f-2?s+(n+2)*r:null,e,t,l,0,x);s+=f*r}const c=Uint32Array.from(t),y=Float32Array.from(e),d=Object.assign({vertexBuffer:y.buffer,indexBuffer:c.buffer,renderInstructions:i.buffer},o);O.postMessage(d,[y.buffer,c.buffer,i.buffer]);break}case e:{const e=[],t=[],n=o.customAttributesCount,r=new Float32Array(o.renderInstructions);let i=0;for(;i<r.length;)i=G(r,i,e,t,n);const s=Uint32Array.from(t),a=Float32Array.from(e),u=Object.assign({vertexBuffer:a.buffer,indexBuffer:s.buffer,renderInstructions:r.buffer},o);O.postMessage(u,[a.buffer,s.buffer,r.buffer]);break}}};';return new Worker("undefined"==typeof Blob?"data:application/javascript;base64,"+t.from(e,"binary").toString("base64"):URL.createObjectURL(new Blob([e],{type:"application/javascript"})))}}.call(this)}.call(this,e("buffer").Buffer)},{buffer:6}],391:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.XML_SCHEMA_INSTANCE_URI=r.OBJECT_PROPERTY_NODE_FACTORY=void 0,r.createElementNS=a,r.getAllTextContent=function(e,t){return o(e,t,[]).join("")},r.getAllTextContent_=o,r.getAttributeNS=function(e,t,r){return e.getAttributeNS(t,r)||""},r.getDocument=f,r.getXMLSerializer=function(){void 0===n&&"undefined"!=typeof XMLSerializer&&(n=new XMLSerializer);return n},r.isDocument=function(e){return"documentElement"in e},r.makeArrayExtender=function(r,n){return function(e,t){e=r.call(void 0!==n?n:this,e,t);void 0!==e&&(t=t[t.length-1],(0,i.extend)(t,e))}},r.makeArrayPusher=function(r,n){return function(e,t){e=r.call(void 0!==n?n:this,e,t);void 0!==e&&t[t.length-1].push(e)}},r.makeArraySerializer=function(i,e){var o,a;return function(e,t,r){var n;void 0===o&&(o={},(n={})[e.localName]=i,o[e.namespaceURI]=n,a=s(e.localName)),l(o,a,t,r)}},r.makeChildAppender=function(n,i){return function(e,t,r){n.call(void 0!==i?i:this,e,t,r),r[r.length-1].node.appendChild(e)}},r.makeObjectPropertyPusher=function(i,o,a){return function(e,t){var r,n=i.call(void 0!==a?a:this,e,t);void 0!==n&&(t=t[t.length-1],(e=void 0!==o?o:e.localName)in t?r=t[e]:t[e]=r=[],r.push(n))}},r.makeObjectPropertySetter=function(n,i,o){return function(e,t){var r=n.call(void 0!==o?o:this,e,t);void 0!==r&&(t[t.length-1][void 0!==i?i:e.localName]=r)}},r.makeReplacer=function(r,n){return function(e,t){e=r.call(void 0!==n?n:this,e,t);void 0!==e&&(t[t.length-1]=e)}},r.makeSequence=function(e,t){for(var r=t.length,n=new Array(r),i=0;i<r;++i)n[i]=e[t[i]];return n},r.makeSimpleNodeFactory=s,r.makeStructureNS=function(e,t,r){var n,i;for(r=void 0!==r?r:{},n=0,i=e.length;n<i;++n)r[e[n]]=t;return r},r.parse=function(e){return(new DOMParser).parseFromString(e,"application/xml")},r.parseNode=u,r.pushParseAndPop=function(e,t,r,n,i){return n.push(e),u(t,r,n,i),n.pop()},r.pushSerializeAndPop=function(e,t,r,n,i,o,a){return i.push(e),l(t,r,n,i,o,a),i.pop()},r.registerDocument=function(e){c=e},r.registerXMLSerializer=function(e){n=e},r.serialize=l;var i=e("./array.js");function a(e,t){return f().createElementNS(e,t)}function o(e,t,r){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)t?r.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(e.nodeValue);else for(var n=e.firstChild;n;n=n.nextSibling)o(n,t,r);return r}function s(i,o){return function(e,t,r){var t=t[t.length-1].node,n=i;return a(void 0!==o?o:t.namespaceURI,n=void 0===n?r:n)}}r.XML_SCHEMA_INSTANCE_URI="http://www.w3.org/2001/XMLSchema-instance";e=s();function u(e,t,r,n){for(var i=t.firstElementChild;i;i=i.nextElementSibling){var o=e[i.namespaceURI];void 0!==o&&void 0!==(o=o[i.localName])&&o.call(n,i,r)}}function l(e,t,r,n,i,o){for(var a,s,u=(void 0!==i?i:r).length,l=0;l<u;++l)void 0!==(a=r[l])&&void 0!==(s=t.call(void 0!==o?o:this,a,n,void 0!==i?i[l]:void 0))&&e[s.namespaceURI][s.localName].call(o,s,a,n)}r.OBJECT_PROPERTY_NODE_FACTORY=e;var n=void 0;var c=void 0;function f(){return c=void 0===c&&"undefined"!=typeof document?document.implementation.createDocument("","",null):c}},{"./array.js":104}],392:[function(e,t,r){"use strict";t.exports=i;var n=e("ieee754");function i(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,a=1/o,p="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function s(e){return e.type===i.Bytes?e.readVarint()+e.pos:e.pos+1}function u(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function l(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;e<=i;i--)r.buf[i+n]=r.buf[i]}function c(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function f(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function h(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function d(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function y(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function g(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function m(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function v(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function b(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function _(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function w(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function x(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=_(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=x(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=_(this.buf,this.pos)+_(this.buf,this.pos+4)*o;return this.pos+=8,e},readSFixed64:function(){var e=_(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,e},readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,r=t[this.pos++],n=127&r;if(r<128)return n;if(n|=(127&(r=t[this.pos++]))<<7,r<128)return n;if(n|=(127&(r=t[this.pos++]))<<14,r<128)return n;if(n|=(127&(r=t[this.pos++]))<<21,r<128)return n;var i,o,r=n|=(15&t[this.pos])<<28,t=e,n=this,e=n.buf;if(o=e[n.pos++],i=(112&o)>>4,o<128)return u(r,i,t);if(o=e[n.pos++],i|=(127&o)<<3,o<128)return u(r,i,t);if(o=e[n.pos++],i|=(127&o)<<10,o<128)return u(r,i,t);if(o=e[n.pos++],i|=(127&o)<<17,o<128)return u(r,i,t);if(o=e[n.pos++],i|=(127&o)<<24,o<128)return u(r,i,t);if(o=e[n.pos++],i|=(1&o)<<31,o<128)return u(r,i,t);throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;if(12<=(this.pos=e)-t&&p)return r=this.buf,p.decode(r.subarray(t,e));for(var r,n,i,o,a=this.buf,s=e,u="",l=t;l<s;){var c=a[l],f=null,h=239<c?4:223<c?3:191<c?2:1;if(s<l+h)break;1===h?c<128&&(f=c):2===h?128==(192&(n=a[l+1]))&&(f=(31&c)<<6|63&n)<=127&&(f=null):3===h?(n=a[l+1],i=a[l+2],128==(192&n)&&128==(192&i)&&((f=(15&c)<<12|(63&n)<<6|63&i)<=2047||55296<=f&&f<=57343)&&(f=null)):4===h&&(n=a[l+1],i=a[l+2],o=a[l+3],128==(192&n))&&128==(192&i)&&128==(192&o)&&((f=(15&c)<<18|(63&n)<<12|(63&i)<<6|63&o)<=65535||1114112<=f)&&(f=null),null===f?(f=65533,h=1):65535<f&&(f-=65536,u+=String.fromCharCode(f>>>10&1023|55296),f=56320|1023&f),u+=String.fromCharCode(f),l+=h}return u},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==i.Bytes)return e.push(this.readVarint(t));var r=s(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed64());var t=s(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){e&=7;if(e===i.Varint)for(;127<this.buf[this.pos++];);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t,r=this.length||16;r<this.pos+e;)r*=2;r!==this.length&&((t=new Uint8Array(r)).set(this.buf),this.buf=t,this.length=r)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),w(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),w(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),w(this.buf,-1&e,this.pos),w(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),w(this.buf,-1&e,this.pos),w(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeVarint:function(e){if(268435455<(e=+e||0)||e<0){var t=e,r=this;if(0<=t?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:i=i+1|(n=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10);var t=n,n=r,t=(n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t,i),i=r,r=(7&t)<<4;i.buf[i.pos++]|=r|((t>>>=3)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t)&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t)&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t)&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t)&&(i.buf[i.pos++]=127&t)}else this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127)||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127)||(this.buf[this.pos++]=e>>>7&127)},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos,e=(this.pos=function(e,t,r){for(var n,i,o=0;o<t.length;o++){if(55295<(n=t.charCodeAt(o))&&n<57344){if(!i){56319<n||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos),this.pos-t);128<=e&&l(t,e,this),this.pos=t-1,this.writeVarint(e),this.pos+=e},writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),n.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos,e=(e(t,this),this.pos-r);128<=e&&l(r,e,this),this.pos=r-1,this.writeVarint(e),this.pos+=e},writeMessage:function(e,t,r){this.writeTag(e,i.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,y,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,b,t)},writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,i.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},{ieee754:60}],393:[function(e,t,r){"use strict";var n,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return(n=setTimeout)(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}var u,l=[],c=!1,f=-1;function h(){c&&u&&(c=!1,u.length?l=u.concat(l):f=-1,l.length)&&p()}function p(){if(!c){for(var e=s(h),t=(c=!0,l.length);t;){for(u=l,l=[];++f<t;)u&&u[f].run();f=-1,t=l.length}u=null,c=!1,!function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function y(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new d(e,t)),1!==l.length||c||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=y,t.addListener=y,t.once=y,t.off=y,t.removeListener=y,t.removeAllListeners=y,t.emit=y,t.prependListener=y,t.prependOnceListener=y,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],394:[function(e,T,C){!function(E){!function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var e=void 0,r="object"==(void 0===C?"undefined":t(C))&&C&&!C.nodeType&&C,n="object"==(void 0===T?"undefined":t(T))&&T&&!T.nodeType&&T,i="object"==(void 0===E?"undefined":t(E))&&E;i.global!==i&&i.window!==i&&i.self!==i||(e=i);var o,a,g=2147483647,m=36,v=26,s=38,u=700,l=/^xn--/,c=/[^\x20-\x7E]/,f=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=m-1,b=Math.floor,_=String.fromCharCode;function w(e){throw new RangeError(h[e])}function d(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function y(e,t){var r=e.split("@"),n="",r=(1<r.length&&(n=r[0]+"@",e=r[1]),(e=e.replace(f,".")).split("."));return n+d(r,t).join(".")}function x(e){for(var t,r,n=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function S(e){return d(e,function(e){var t="";return 65535<e&&(t+=_((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=_(e)}).join("")}function j(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,r){var n=0;for(e=r?b(e/u):e>>1,e+=b(e/t);p*v>>1<e;n+=m)e=b(e/p);return b(n+(p+1)*e/(e+s))}function P(e){var t,r,n,i,o,a,s,u=[],l=e.length,c=0,f=128,h=72,p=e.lastIndexOf("-");for(p<0&&(p=0),r=0;r<p;++r)128<=e.charCodeAt(r)&&w("not-basic"),u.push(e.charCodeAt(r));for(n=0<p?p+1:0;n<l;){for(i=c,o=1,a=m;l<=n&&w("invalid-input"),s=e.charCodeAt(n++),(m<=(s=s-48<10?s-22:s-65<26?s-65:s-97<26?s-97:m)||s>b((g-c)/o))&&w("overflow"),c+=s*o,!(s<(s=a<=h?1:h+v<=a?v:a-h));a+=m)o>b(g/(s=m-s))&&w("overflow"),o*=s;h=O(c-i,t=u.length+1,0==i),b(c/t)>g-f&&w("overflow"),f+=b(c/t),c%=t,u.splice(c++,0,f)}return S(u)}function k(e){for(var t,r,n,i,o,a,s,u,l,c,f=[],h=(e=x(e)).length,p=128,d=72,y=t=0;y<h;++y)(s=e[y])<128&&f.push(_(s));for(r=n=f.length,n&&f.push("-");r<h;){for(i=g,y=0;y<h;++y)p<=(s=e[y])&&s<i&&(i=s);for(i-p>b((g-t)/(u=r+1))&&w("overflow"),t+=(i-p)*u,p=i,y=0;y<h;++y)if((s=e[y])<p&&++t>g&&w("overflow"),s==p){for(o=t,a=m;!(o<(l=a<=d?1:d+v<=a?v:a-d));a+=m)f.push(_(j(l+(c=o-l)%(l=m-l),0))),o=b(c/l);f.push(_(j(o,0))),d=O(t,u,r==n),t=0,++r}++t,++p}return f.join("")}if(o={version:"1.4.1",ucs2:{decode:x,encode:S},decode:P,encode:k,toASCII:function(e){return y(e,function(e){return c.test(e)?"xn--"+k(e):e})},toUnicode:function(e){return y(e,function(e){return l.test(e)?P(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==t(define.amd)&&define.amd)define("punycode",function(){return o});else if(r&&n)if(T.exports==r)n.exports=o;else for(a in o)o.hasOwnProperty(a)&&(r[a]=o[a]);else e.punycode=o}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],395:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"==typeof e&&0!==e.length){var o=/\+/g,t=(e=e.split(t),1e3),a=(n&&"number"==typeof n.maxKeys&&(t=n.maxKeys),e.length);0<t&&t<a&&(a=t);for(var s=0;s<a;++s){var u,l=e[s].replace(o,"%20"),c=l.indexOf(r),c=0<=c?(u=l.substr(0,c),l.substr(c+1)):(u=l,""),l=decodeURIComponent(u),c=decodeURIComponent(c);Object.prototype.hasOwnProperty.call(i,l)?f(i[l])?i[l].push(c):i[l]=[i[l],c]:i[l]=c}}return i};var f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],396:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){switch(o(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}t.exports=function(r,n,i,e){return n=n||"&",i=i||"=","object"===o(r=null===r?void 0:r)?u(l(r),function(e){var t=encodeURIComponent(a(e))+i;return s(r[e])?u(r[e],function(e){return t+encodeURIComponent(a(e))}).join(n):t+encodeURIComponent(a(r[e]))}).join(n):e?encodeURIComponent(a(e))+i+encodeURIComponent(a(r)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function u(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var l=Object.keys||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r}},{}],397:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":395,"./encode":396}],398:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i;i=function(){function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function u(e,t){return e<t?-1:t<e?1:0}function e(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function d(e,t){y(e,0,e.children.length,t,e)}function y(e,t,r,n,i){(i=i||v(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=t;o<r;o++){var a=e.children[o];h(i,e.leaf?n(a):a)}return i}function h(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function o(e,t){return e.minX-t.minX}function a(e,t){return e.minY-t.minY}function g(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function m(e){return e.maxX-e.minX+(e.maxY-e.minY)}function c(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function l(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function v(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function b(e,t,r,n,i){for(var o,a,s=[t,r];s.length;)(r=s.pop())-(t=s.pop())<=n||(o=t+Math.ceil((r-t)/n/2)*n,function e(t,r,n,i,o){for(;n<i;){600<i-n&&(a=i-n+1,s=r-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),l=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1),e(t,r,Math.max(n,Math.floor(r-s*u/a+l)),Math.min(i,Math.floor(r+(a-s)*u/a+l)),o));var a,s,u,l,c=t[r],f=n,h=i;for(p(t,n,r),0<o(t[i],c)&&p(t,n,i);f<h;){for(p(t,f,h),f++,h--;o(t[f],c)<0;)f++;for(;0<o(t[h],c);)h--}0===o(t[n],c)?p(t,n,h):p(t,++h,i),h<=r&&(n=h+1),r<=h&&(i=h-1)}}(a=e,o,t||0,r||a.length-1,i||u),s.push(t,o,o,r))}return e.prototype.all=function(){return this._all(this.data,[])},e.prototype.search=function(e){var t=this.data,r=[];if(l(e,t))for(var n=this.toBBox,i=[];t;){for(var o=0;o<t.children.length;o++){var a=t.children[o],s=t.leaf?n(a):a;l(e,s)&&(t.leaf?r.push(a):c(e,s)?this._all(a,r):i.push(a))}t=i.pop()}return r},e.prototype.collides=function(e){var t=this.data;if(l(e,t))for(var r=[];t;){for(var n=0;n<t.children.length;n++){var i=t.children[n],o=t.leaf?this.toBBox(i):i;if(l(e,o)){if(t.leaf||c(e,o))return!0;r.push(i)}}t=r.pop()}return!1},e.prototype.load=function(e){if(e&&e.length)if(e.length<this._minEntries)for(var t=0;t<e.length;t++)this.insert(e[t]);else{var r,n=this._build(e.slice(),0,e.length-1,0);this.data.children.length?this.data.height===n.height?this._splitRoot(this.data,n):(this.data.height<n.height&&(r=this.data,this.data=n,n=r),this._insert(n,this.data.height-n.height-1,!0)):this.data=n}return this},e.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},e.prototype.clear=function(){return this.data=v([]),this},e.prototype.remove=function(e,t){if(e)for(var r,n,i,o=this.data,a=this.toBBox(e),s=[],u=[];o||s.length;){if(o||(o=s.pop(),n=s[s.length-1],r=u.pop(),i=!0),o.leaf){var l=function(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}(e,o.children,t);if(-1!==l)return o.children.splice(l,1),s.push(o),this._condense(s),this}i||o.leaf||!c(o,a)?n?(r++,o=n.children[r],i=!1):o=null:(s.push(o),u.push(r),o=(n=o).children[r=0])}return this},e.prototype.toBBox=function(e){return e},e.prototype.compareMinX=function(e,t){return e.minX-t.minX},e.prototype.compareMinY=function(e,t){return e.minY-t.minY},e.prototype.toJSON=function(){return this.data},e.prototype.fromJSON=function(e){return this.data=e,this},e.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},e.prototype._build=function(e,t,r,n){var i,o=r-t+1,a=this._maxEntries;if(o<=a)d(i=v(e.slice(t,r+1)),this.toBBox);else{n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(i=v([])).leaf=!1,i.height=n;var s=Math.ceil(o/a),u=s*Math.ceil(Math.sqrt(a));b(e,t,r,u,this.compareMinX);for(var l=t;l<=r;l+=u){var c=Math.min(l+u-1,r);b(e,l,c,s,this.compareMinY);for(var f=l;f<=c;f+=s){var h=Math.min(f+s-1,c);i.children.push(this._build(e,f,h,n-1))}}d(i,this.toBBox)}return i},e.prototype._chooseSubtree=function(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,a=void 0,s=0;s<t.children.length;s++){var u=t.children[s],l=g(u),c=(f=e,c=u,(Math.max(c.maxX,f.maxX)-Math.min(c.minX,f.minX))*(Math.max(c.maxY,f.maxY)-Math.min(c.minY,f.minY))-l);c<o?(o=c,i=l<i?l:i,a=u):c===o&&l<i&&(i=l,a=u)}t=a||t.children[0]}var f,c;return t},e.prototype._insert=function(e,t,r){var r=r?e:this.toBBox(e),n=[],i=this._chooseSubtree(r,this.data,t,n);for(i.children.push(e),h(i,r);0<=t&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(r,n,t)},e.prototype._split=function(e,t){var r=e[t],n=r.children.length,i=this._minEntries,i=(this._chooseSplitAxis(r,i,n),this._chooseSplitIndex(r,i,n)),n=v(r.children.splice(i,r.children.length-i));n.height=r.height,n.leaf=r.leaf,d(r,this.toBBox),d(n,this.toBBox),t?e[t-1].children.push(n):this._splitRoot(r,n)},e.prototype._splitRoot=function(e,t){this.data=v([e,t]),this.data.height=e.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},e.prototype._chooseSplitIndex=function(e,t,r){for(var n,i,o,a,s=1/0,u=1/0,l=t;l<=r-t;l++){var c=y(e,0,l,this.toBBox),f=y(e,l,r,this.toBBox),h=(a=c,h=f,0,i=Math.max(a.minX,h.minX),o=Math.max(a.minY,h.minY),p=Math.min(a.maxX,h.maxX),a=Math.min(a.maxY,h.maxY),Math.max(0,p-i)*Math.max(0,a-o)),p=g(c)+g(f);h<s?(s=h,n=l,u=p<u?p:u):h===s&&p<u&&(u=p,n=l)}return n||r-t},e.prototype._chooseSplitAxis=function(e,t,r){var n=e.leaf?this.compareMinX:o,i=e.leaf?this.compareMinY:a;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)},e.prototype._allDistMargin=function(e,t,r,n){e.children.sort(n);for(var i=this.toBBox,o=y(e,0,t,i),a=y(e,r-t,r,i),s=m(o)+m(a),u=t;u<r-t;u++){var l=e.children[u];h(o,e.leaf?i(l):l),s+=m(o)}for(var c=r-t-1;t<=c;c--){var f=e.children[c];h(a,e.leaf?i(f):f),s+=m(a)}return s},e.prototype._adjustParentBBoxes=function(e,t,r){for(var n=r;0<=n;n--)h(t[n],e)},e.prototype._condense=function(e){for(var t=e.length-1,r=void 0;0<=t;t--)0===e[t].children.length?0<t?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():d(e[t],this.toBBox)},e},"object"==(void 0===r?"undefined":n(r))&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):self.RBush=i()},{}],399:[function(n,e,i){!function(l){!function(){"use strict";var a=n("./lib/request"),e=n("./lib/response"),s=n("xtend"),t=n("builtin-status-codes"),u=n("url"),r=i;r.request=function(e,t){e="string"==typeof e?u.parse(e):s(e);var r=-1===l.location.protocol.search(/^https?:$/)?"http:":"",r=e.protocol||r,n=e.hostname||e.host,i=e.port,o=e.path||"/",r=(n&&-1!==n.indexOf(":")&&(n="["+n+"]"),e.url=(n?r+"//"+n:"")+(i?":"+i:"")+o,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{},new a(e));return t&&r.on("response",t),r},r.get=function(e,t){e=r.request(e,t);return e.end(),e},r.ClientRequest=a,r.IncomingMessage=e.IncomingMessage,r.Agent=function(){},r.Agent.defaultMaxSockets=4,r.globalAgent=new r.Agent,r.STATUS_CODES=t,r.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":401,"./lib/response":402,"builtin-status-codes":7,url:420,xtend:430}],400:[function(e,t,o){!function(i){!function(){"use strict";var t;function r(){if(void 0===t)if(i.XMLHttpRequest){t=new i.XMLHttpRequest;try{t.open("GET",i.XDomainRequest?"/":"https://example.com")}catch(e){t=null}}else t=null;return t}function e(e){var t=r();if(t)try{return t.responseType=e,t.responseType===e}catch(e){}return!1}function n(e){return"function"==typeof e}o.fetch=n(i.fetch)&&n(i.ReadableStream),o.writableStream=n(i.WritableStream),o.abortController=n(i.AbortController),o.arraybuffer=o.fetch||e("arraybuffer"),o.msstream=!o.fetch&&e("ms-stream"),o.mozchunkedarraybuffer=!o.fetch&&e("moz-chunked-arraybuffer"),o.overrideMimeType=o.fetch||!!r()&&n(r().overrideMimeType),t=null}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],401:[function(a,s,e){!function(c,f,o){!function(){"use strict";var u=a("./capability"),e=a("inherits"),t=a("./response"),i=a("readable-stream"),r=t.IncomingMessage,l=t.readyStates;t=s.exports=function(t){var e,r=this,n=(i.Writable.call(r),r._opts=t,r._body=[],r._headers={},t.auth&&r.setHeader("Authorization","Basic "+o.from(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){r.setHeader(e,t.headers[e])}),!0);if("disable-fetch"===t.mode||"requestTimeout"in t&&!u.abortController)e=!(n=!1);else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!u.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}r._mode=(e=e,n=n,u.fetch&&n?"fetch":u.mozchunkedarraybuffer?"moz-chunked-arraybuffer":u.msstream?"ms-stream":u.arraybuffer&&e?"arraybuffer":"text"),r._fetchTimer=null,r.on("finish",function(){r._onFinish()})};e(t,i.Writable),t.prototype.setHeader=function(e,t){var r=e.toLowerCase();-1===n.indexOf(r)&&(this._headers[r]={name:e,value:t})},t.prototype.getHeader=function(e){e=this._headers[e.toLowerCase()];return e?e.value:null},t.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},t.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts,r=t._headers,n=null,i=("GET"!==e.method&&"HEAD"!==e.method&&(n=new Blob(t._body,{type:(r["content-type"]||{}).value||""})),[]);if(Object.keys(r).forEach(function(e){var t=r[e].name,e=r[e].value;Array.isArray(e)?e.forEach(function(e){i.push([t,e])}):i.push([t,e])}),"fetch"===t._mode){var o,a=null;u.abortController&&(a=(o=new AbortController).signal,t._fetchAbortController=o,"requestTimeout"in e)&&0!==e.requestTimeout&&(t._fetchTimer=f.setTimeout(function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()},e.requestTimeout)),f.fetch(t._opts.url,{method:t._opts.method,headers:i,body:n||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin",signal:a}).then(function(e){t._fetchResponse=e,t._connect()},function(e){f.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",e)})}else{var s=t._xhr=new f.XMLHttpRequest;try{s.open(t._opts.method,t._opts.url,!0)}catch(e){return void c.nextTick(function(){t.emit("error",e)})}"responseType"in s&&(s.responseType=t._mode),"withCredentials"in s&&(s.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in e&&(s.timeout=e.requestTimeout,s.ontimeout=function(){t.emit("requestTimeout")}),i.forEach(function(e){s.setRequestHeader(e[0],e[1])}),t._response=null,s.onreadystatechange=function(){switch(s.readyState){case l.LOADING:case l.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(s.onprogress=function(){t._onXHRProgress()}),s.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{s.send(n)}catch(e){c.nextTick(function(){t.emit("error",e)})}}}},t.prototype._onXHRProgress=function(){!function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){}}(this._xhr)||this._destroyed||(this._response||this._connect(),this._response._onXHRProgress())},t.prototype._connect=function(){var t=this;t._destroyed||(t._response=new r(t._xhr,t._fetchResponse,t._mode,t._fetchTimer),t._response.on("error",function(e){t.emit("error",e)}),t.emit("response",t._response))},t.prototype._write=function(e,t,r){this._body.push(e),r()},t.prototype.abort=t.prototype.destroy=function(){this._destroyed=!0,f.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},t.prototype.end=function(e,t,r){"function"==typeof e&&(r=e,e=void 0),i.Writable.prototype.end.call(this,e,t,r)},t.prototype.flushHeaders=function(){},t.prototype.setTimeout=function(){},t.prototype.setNoDelay=function(){},t.prototype.setSocketKeepAlive=function(){};var n=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}.call(this)}.call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"./capability":400,"./response":402,_process:393,buffer:6,inherits:61,"readable-stream":417}],402:[function(r,e,n){!function(c,f,h){!function(){"use strict";var s=r("./capability"),e=r("inherits"),u=r("readable-stream"),l=n.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},t=n.IncomingMessage=function(e,t,r,n){var i=this;if(u.Readable.call(i),i._mode=r,i.headers={},i.rawHeaders=[],i.trailers={},i.rawTrailers=[],i.on("end",function(){c.nextTick(function(){i.emit("close")})}),"fetch"===r){r=function t(){a.read().then(function(e){i._destroyed||(e.done?(f.clearTimeout(n),i.push(null)):(i.push(h.from(e.value)),t()))}).catch(function(e){f.clearTimeout(n),i._destroyed||i.emit("error",e)})};if(i._fetchResponse=t,i.url=t.url,i.statusCode=t.status,i.statusMessage=t.statusText,t.headers.forEach(function(e,t){i.headers[t.toLowerCase()]=e,i.rawHeaders.push(t,e)}),s.writableStream){var o=new WritableStream({write:function(r){return new Promise(function(e,t){i._destroyed?t():i.push(h.from(r))?e():i._resumeFetch=e})},close:function(){f.clearTimeout(n),i._destroyed||i.push(null)},abort:function(e){i._destroyed||i.emit("error",e)}});try{return void t.body.pipeTo(o).catch(function(e){f.clearTimeout(n),i._destroyed||i.emit("error",e)})}catch(e){}}var a=t.body.getReader();r()}else i._xhr=e,i._pos=0,i.url=e.responseURL,i.statusCode=e.status,i.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var t,e=e.match(/^([^:]+):\s*(.*)/);e&&("set-cookie"===(t=e[1].toLowerCase())?(void 0===i.headers[t]&&(i.headers[t]=[]),i.headers[t].push(e[2])):void 0!==i.headers[t]?i.headers[t]+=", "+e[2]:i.headers[t]=e[2],i.rawHeaders.push(e[1],e[2]))}),i._charset="x-user-defined",s.overrideMimeType||((o=i.rawHeaders["mime-type"])&&(t=o.match(/;\s*charset=([^;])(;|$)/))&&(i._charset=t[1].toLowerCase()),i._charset)||(i._charset="utf-8")};e(t,u.Readable),t.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},t.prototype._onXHRProgress=function(){var e=this,t=e._xhr,r=null;switch(e._mode){case"text":if((r=t.responseText).length>e._pos){var n=r.substr(e._pos);if("x-user-defined"===e._charset){for(var i=h.alloc(n.length),o=0;o<n.length;o++)i[o]=255&n.charCodeAt(o);e.push(i)}else e.push(n,e._charset);e._pos=r.length}break;case"arraybuffer":t.readyState===l.DONE&&t.response&&(r=t.response,e.push(h.from(new Uint8Array(r))));break;case"moz-chunked-arraybuffer":r=t.response,t.readyState===l.LOADING&&r&&e.push(h.from(new Uint8Array(r)));break;case"ms-stream":var a,r=t.response;t.readyState===l.LOADING&&((a=new f.MSStreamReader).onprogress=function(){a.result.byteLength>e._pos&&(e.push(h.from(new Uint8Array(a.result.slice(e._pos)))),e._pos=a.result.byteLength)},a.onload=function(){e.push(null)},a.readAsArrayBuffer(r))}e._xhr.readyState===l.DONE&&"ms-stream"!==e._mode&&e.push(null)}}.call(this)}.call(this,r("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},r("buffer").Buffer)},{"./capability":400,_process:393,buffer:6,inherits:61,"readable-stream":417}],403:[function(e,t,r){"use strict";function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n={};function i(e,i,t){var r=function(n){var e,t;function r(e,t,r){return n.call(this,(e=e,t=t,r=r,"string"==typeof i?i:i(e,t,r)))||this}return t=n,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,r}(t=t||Error);r.prototype.name=t.name,r.prototype.code=e,n[e]=r}function l(e,t){var r;return Array.isArray(e)?(r=e.length,e=e.map(function(e){return String(e)}),2<r?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])):"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(e,t,r){var n,i,o,a,s;return"string"==typeof t&&(a="not ",t.substr(!o||o<0?0:+o,a.length)===a)?(n="must not be",t=t.replace(/^not /,"")):n="must be",o=e,a=" argument",(void 0===s||s>o.length)&&(s=o.length),o=(o.substring(s-a.length,s)===a?"The ".concat(e," "):(s=(i="number"!=typeof i?0:i)+(o=".").length>(s=e).length||-1===s.indexOf(o,i)?"argument":"property",'The "'.concat(e,'" ').concat(s," "))).concat(n," ").concat(l(t,"type")),o+=". Received type ".concat(u(r))},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],404:[function(c,f,e){!function(l){!function(){"use strict";var e=Object.keys||function(e){var t,r=[];for(t in e)r.push(t);return r},t=(f.exports=a,c("./_stream_readable")),r=c("./_stream_writable");c("inherits")(a,t);for(var n=e(r.prototype),i=0;i<n.length;i++){var o=n[i];a.prototype[o]||(a.prototype[o]=r.prototype[o])}function a(e){if(!(this instanceof a))return new a(e);t.call(this,e),r.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen)&&(this.allowHalfOpen=!1,this.once("end",s))}function s(){this._writableState.ended||l.nextTick(u,this)}function u(e){e.end()}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}.call(this)}.call(this,c("_process"))},{"./_stream_readable":406,"./_stream_writable":408,_process:393,inherits:61}],405:[function(e,t,r){"use strict";t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":407,inherits:61}],406:[function(B,G,e){!function(F,N){!function(){"use strict";function d(e,t){return e.listeners(t).length}(G.exports=_).ReadableState=b,B("events").EventEmitter;var n,i=B("./internal/streams/stream"),c=B("buffer").Buffer,f=N.Uint8Array||function(){};var o,e,r,t=B("util"),y=t&&t.debuglog?t.debuglog("stream"):function(){},a=B("./internal/streams/buffer_list"),t=B("./internal/streams/destroy"),s=B("./internal/streams/state").getHighWaterMark,u=B("../errors").codes,h=u.ERR_INVALID_ARG_TYPE,p=u.ERR_STREAM_PUSH_AFTER_EOF,l=u.ERR_METHOD_NOT_IMPLEMENTED,g=u.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,m=(B("inherits")(_,i),t.errorOrDestroy),v=["error","close","destroy","pause","resume"];function b(e,t,r){n=n||B("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=t instanceof n),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=s(this,e,"readableHighWaterMark",r),this.buffer=new a,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o=o||B("string_decoder/").StringDecoder,this.decoder=new o(e.encoding),this.encoding=e.encoding)}function _(e){if(n=n||B("./_stream_duplex"),!(this instanceof _))return new _(e);var t=this instanceof n;this._readableState=new b(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy)&&(this._destroy=e.destroy),i.call(this)}function w(e,t,r,n,i){y("readableAddChunk",t);var o,a,s,u,l=e._readableState;if(null===t)l.reading=!1,a=e,s=l,y("onEofChunk"),s.ended||(s.decoder&&(u=s.decoder.end())&&u.length&&(s.buffer.push(u),s.length+=s.objectMode?1:u.length),s.ended=!0,s.sync?O(a):(s.needReadable=!1,s.emittedReadable||(s.emittedReadable=!0,P(a))));else if(o=i?o:function(e,t){var r;!function(e){return c.isBuffer(e)||e instanceof f}(t)&&"string"!=typeof t&&void 0!==t&&!e.objectMode&&(r=new h("chunk",["string","Buffer","Uint8Array"],t));return r}(l,t))m(e,o);else if(l.objectMode||t&&0<t.length)if("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===c.prototype||(u=t,t=c.from(u)),n)l.endEmitted?m(e,new g):x(e,l,t,!0);else if(l.ended)m(e,new p);else{if(l.destroyed)return!1;l.reading=!1,!l.decoder||r||(t=l.decoder.write(t),l.objectMode)||0!==t.length?x(e,l,t,!1):k(e,l)}else n||(l.reading=!1,k(e,l));return!l.ended&&(l.length<l.highWaterMark||0===l.length)}function x(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&O(e)),k(e,t)}Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=t.destroy,_.prototype._undestroy=t.undestroy,_.prototype._destroy=function(e,t){t(e)},_.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),w(this,e,t,!1,r)},_.prototype.unshift=function(e){return w(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){for(var t=new(o=o||B("string_decoder/").StringDecoder)(e),r=(this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding,this._readableState.buffer.head),n="";null!==r;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var S=1073741824;function j(e,t){var r;return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?(t.flowing&&t.length?t.buffer.head.data:t).length:(e>t.highWaterMark&&(t.highWaterMark=(S<=(r=e)?r=S:(r--,r=(r=(r=(r=(r|=r>>>1)|r>>>2)|r>>>4)|r>>>8)|r>>>16,r++),r)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;y("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(y("emitReadable",t.flowing),t.emittedReadable=!0,F.nextTick(P,e))}function P(e){var t=e._readableState;y("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,M(e)}function k(e,t){t.readingMore||(t.readingMore=!0,F.nextTick(E,e,t))}function E(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(y("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function T(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function C(e){y("readable nexttick read 0"),e.read(0)}function R(e,t){y("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){var r;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r)}function A(e){var t=e._readableState;y("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,F.nextTick(D,t,e))}function D(e,t){y("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy&&(!(e=t._writableState)||e.autoDestroy&&e.finished)&&t.destroy())}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}_.prototype.read=function(e){y("read",e),e=parseInt(e,10);var t,r=this._readableState,n=e;return 0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:0<r.length)||r.ended)?(y("read: emitReadable",r.length,r.ended),(0===r.length&&r.ended?A:O)(this),null):0===(e=j(e,r))&&r.ended?(0===r.length&&A(this),null):(t=r.needReadable,y("need readable",t),(0===r.length||r.length-e<r.highWaterMark)&&y("length less than watermark",t=!0),r.ended||r.reading?y("reading or ended",t=!1):t&&(y("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=j(n,r))),null===(t=0<e?I(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.awaitDrain=0),0===r.length&&(r.ended||(r.needReadable=!0),n!==e)&&r.ended&&A(this),null!==t&&this.emit("data",t),t)},_.prototype._read=function(e){m(this,new l("_read()"))},_.prototype.pipe=function(r,e){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r)}i.pipesCount+=1,y("pipe count=%d opts=%j",i.pipesCount,e);e=(!e||!1!==e.end)&&r!==F.stdout&&r!==F.stderr?a:p;function o(e,t){y("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,y("cleanup"),r.removeListener("close",f),r.removeListener("finish",h),r.removeListener("drain",s),r.removeListener("error",c),r.removeListener("unpipe",o),n.removeListener("end",a),n.removeListener("end",p),n.removeListener("data",l),u=!0,!i.awaitDrain||r._writableState&&!r._writableState.needDrain||s())}function a(){y("onend"),r.end()}i.endEmitted?F.nextTick(e):n.once("end",e),r.on("unpipe",o);t=n;var t,s=function(){var e=t._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&d(t,"data")&&(e.flowing=!0,M(t))},u=(r.on("drain",s),!1);function l(e){y("ondata");e=r.write(e);y("dest.write",e),!1===e&&((1===i.pipesCount&&i.pipes===r||1<i.pipesCount&&-1!==L(i.pipes,r))&&!u&&(y("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function c(e){y("onerror",e),p(),r.removeListener("error",c),0===d(r,"error")&&m(r,e)}function f(){r.removeListener("finish",h),p()}function h(){y("onfinish"),r.removeListener("close",f),p()}function p(){y("unpipe"),n.unpipe(r)}return n.on("data",l),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(r,"error",c),r.once("close",f),r.once("finish",h),r.emit("pipe",n),i.flowing||(y("pipe resume"),n.resume()),r},_.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0!==t.pipesCount)if(1===t.pipesCount)e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r));else if(e){var n=L(t.pipes,e);-1!==n&&(t.pipes.splice(n,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r))}else{var i=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<o;a++)i[a].emit("unpipe",this,{hasUnpiped:!1})}return this},_.prototype.addListener=_.prototype.on=function(e,t){var t=i.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=0<this.listenerCount("readable"),!1!==r.flowing&&this.resume()):"readable"!==e||r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,y("on readable",r.length,r.reading),r.length?O(this):r.reading||F.nextTick(C,this)),t},_.prototype.removeListener=function(e,t){t=i.prototype.removeListener.call(this,e,t);return"readable"===e&&F.nextTick(T,this),t},_.prototype.removeAllListeners=function(e){var t=i.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||F.nextTick(T,this),t},_.prototype.resume=function(){var e,t,r=this._readableState;return r.flowing||(y("resume"),r.flowing=!r.readableListening,e=this,(t=r).resumeScheduled)||(t.resumeScheduled=!0,F.nextTick(R,e,t)),r.paused=!1,this},_.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},_.prototype.wrap=function(t){var e,r=this,n=this._readableState,i=!1;for(e in t.on("end",function(){var e;y("wrapped end"),n.decoder&&!n.ended&&(e=n.decoder.end())&&e.length&&r.push(e),r.push(null)}),t.on("data",function(e){y("wrapped data"),n.decoder&&(e=n.decoder.write(e)),n.objectMode&&null==e||(n.objectMode||e&&e.length)&&!r.push(e)&&(i=!0,t.pause())}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var o=0;o<v.length;o++)t.on(v[o],this.emit.bind(this,v[o]));return this._read=function(e){y("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"==typeof Symbol&&(_.prototype[Symbol.asyncIterator]=function(){return(e=void 0===e?B("./internal/streams/async_iterator"):e)(this)}),Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(_.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(_.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),_._fromList=I,Object.defineProperty(_.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(_.from=function(e,t){return(r=void 0===r?B("./internal/streams/from"):r)(_,e,t)})}.call(this)}.call(this,B("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":403,"./_stream_duplex":404,"./internal/streams/async_iterator":409,"./internal/streams/buffer_list":410,"./internal/streams/destroy":411,"./internal/streams/from":413,"./internal/streams/state":415,"./internal/streams/stream":416,_process:393,buffer:6,events:9,inherits:61,"string_decoder/":418,util:4}],407:[function(e,t,r){"use strict";t.exports=u;var t=e("../errors").codes,n=t.ERR_METHOD_NOT_IMPLEMENTED,i=t.ERR_MULTIPLE_CALLBACK,o=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=t.ERR_TRANSFORM_WITH_LENGTH_0,s=e("./_stream_duplex");function u(e){if(!(this instanceof u))return new u(e);s.call(this,e),this._transformState={afterTransform:function(e,t){var r=this._transformState,n=(r.transforming=!1,r.writecb);if(null===n)return this.emit("error",new i);r.writechunk=null,(r.writecb=null)!=t&&this.push(t),n(e),(r=this._readableState).reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush)&&(this._flush=e.flush),this.on("prefinish",l)}function l(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?c(this,null,null):this._flush(function(e,t){c(r,e,t)})}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;e.push(null)}e("inherits")(u,s),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new n("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming&&(r=this._readableState,n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){s.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":403,"./_stream_duplex":404,inherits:61}],408:[function(C,R,e){!function(E,T){!function(){"use strict";function f(o){var a=this;this.next=null,this.entry=null,this.finish=function(){var e=a,t=o,r=void 0,n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}}(R.exports=w).WritableState=_;var r,e={deprecate:C("util-deprecate")},n=C("./internal/streams/stream"),l=C("buffer").Buffer,c=T.Uint8Array||function(){};var i,t=C("./internal/streams/destroy"),o=C("./internal/streams/state").getHighWaterMark,a=C("../errors").codes,h=a.ERR_INVALID_ARG_TYPE,s=a.ERR_METHOD_NOT_IMPLEMENTED,p=a.ERR_MULTIPLE_CALLBACK,u=a.ERR_STREAM_CANNOT_PIPE,d=a.ERR_STREAM_DESTROYED,y=a.ERR_STREAM_NULL_VALUES,g=a.ERR_STREAM_WRITE_AFTER_END,m=a.ERR_UNKNOWN_ENCODING,v=t.errorOrDestroy;function b(){}function _(e,c,t){r=r||C("./_stream_duplex"),e=e||{},"boolean"!=typeof t&&(t=c instanceof r),this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=o(this,e,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;t=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!t,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){var t=c,r=t._writableState,n=r.sync,i=r.writecb;if("function"!=typeof i)throw new p;var o,a,s,u,l=r;l.writing=!1,l.writecb=null,l.length-=l.writelen,l.writelen=0,e?(l=t,a=n,s=e,u=i,--(o=r).pendingcb,a?(E.nextTick(u,s),E.nextTick(k,l,o),l._writableState.errorEmitted=!0,v(l,s)):(u(s),l._writableState.errorEmitted=!0,v(l,s),k(l,o))):((e=O(r)||t.destroyed)||r.corked||r.bufferProcessing||!r.bufferedRequest||j(t,r),n?E.nextTick(S,t,r,e,i):S(t,r,e,i))},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new f(this)}C("inherits")(w,n),_.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};try{Object.defineProperty(_.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}function w(e){var t=this instanceof(r=r||C("./_stream_duplex"));if(!t&&!i.call(w,this))return new w(e);this._writableState=new _(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final)&&(this._final=e.final),n.call(this)}function x(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new d("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function S(e,t,r,n){var i;r||(r=e,0===(i=t).length&&i.needDrain&&(i.needDrain=!1,r.emit("drain"))),t.pendingcb--,n(),k(e,t)}function j(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){for(var n=t.bufferedRequestCount,i=new Array(n),n=t.corkedRequestsFree,o=(n.entry=r,0),a=!0;r;)(i[o]=r).isBuf||(a=!1),r=r.next,o+=1;i.allBuffers=a,x(e,t,!0,t.length,i,"",n.finish),t.pendingcb++,t.lastBufferedRequest=null,n.next?(t.corkedRequestsFree=n.next,n.next=null):t.corkedRequestsFree=new f(t),t.bufferedRequestCount=0}else{for(;r;){var s=r.chunk,u=r.encoding,l=r.callback;if(x(e,t,!1,t.objectMode?1:s.length,s,u,l),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(t,r){t._final(function(e){r.pendingcb--,e&&v(t,e),r.prefinished=!0,t.emit("prefinish"),k(t,r)})}function k(e,t){var r,n,i=O(t);return i&&(r=e,(n=t).prefinished||n.finalCalled||("function"!=typeof r._final||n.destroyed?(n.prefinished=!0,r.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,E.nextTick(P,r,n))),0===t.pendingcb)&&(t.finished=!0,e.emit("finish"),t.autoDestroy)&&(!(r=e._readableState)||r.autoDestroy&&r.endEmitted)&&e.destroy(),i}"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(i=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(e){return!!i.call(this,e)||this===w&&e&&e._writableState instanceof _}})):i=function(e){return e instanceof this},w.prototype.pipe=function(){v(this,new u)},w.prototype.write=function(e,t,r){var n,i,o,a=this._writableState,s=!1,u=!a.objectMode&&(u=e,l.isBuffer(u)||u instanceof c);return u&&!l.isBuffer(e)&&(n=e,e=l.from(n)),"function"==typeof t&&(r=t,t=null),t=u?"buffer":t||a.defaultEncoding,"function"!=typeof r&&(r=b),a.ending?(n=this,i=r,o=new g,v(n,o),E.nextTick(i,o)):(u||function(e,t,r,n){var i;if(null===r?i=new y:"string"==typeof r||t.objectMode||(i=new h("chunk",["string","Buffer"],r)),!i)return 1;v(e,i),E.nextTick(n,i)}(this,a,e,r))&&(a.pendingcb++,s=function(e,t,r,n,i,o){r||(a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,i),n!==a&&(r=!0,i="buffer",n=a));var a=t.objectMode?1:n.length,s=(t.length+=a,t.length<t.highWaterMark);s||(t.needDrain=!0);{var u;t.writing||t.corked?(u=t.lastBufferedRequest,t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):x(e,t,!1,a,n,i,o)}return s}(this,a,u,e,t,r)),s},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||j(this,e))},w.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase()))return this._writableState.defaultEncoding=e,this;throw new m(e)},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(e,t,r){r(new s("_write()"))},w.prototype._writev=null,w.prototype.end=function(e,t,r){var n=this._writableState;if("function"==typeof e?(r=e,t=e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),!n.ending){e=this,t=n,n=r;t.ending=!0,k(e,t),n&&(t.finished?E.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}return this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),w.prototype.destroy=t.destroy,w.prototype._undestroy=t.undestroy,w.prototype._destroy=function(e,t){t(e)}}.call(this)}.call(this,C("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":403,"./_stream_duplex":404,"./internal/streams/destroy":411,"./internal/streams/state":415,"./internal/streams/stream":416,_process:393,buffer:6,inherits:61,"util-deprecate":422}],409:[function(n,g,e){!function(y){!function(){"use strict";var e;function r(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}var i=n("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),s=Symbol("error"),u=Symbol("ended"),l=Symbol("lastPromise"),c=Symbol("handlePromise"),f=Symbol("stream");function h(e,t){return{value:e,done:t}}function p(e){var t,r=e[o];null!==r&&null!==(t=e[f].read())&&(e[l]=null,e[o]=null,e[a]=null,r(h(t,!1)))}var t=Object.getPrototypeOf(function(){}),d=Object.setPrototypeOf((r(e={get stream(){return this[f]},next:function(){var r=this,e=this[s];if(null!==e)return Promise.reject(e);if(this[u])return Promise.resolve(h(void 0,!0));if(this[f].destroyed)return new Promise(function(e,t){y.nextTick(function(){r[s]?t(r[s]):e(h(void 0,!0))})});var t,n,i,e=this[l];if(e)t=new Promise((n=e,i=this,function(e,t){n.then(function(){i[u]?e(h(void 0,!0)):i[c](e,t)},t)}));else{e=this[f].read();if(null!==e)return Promise.resolve(h(e,!1));t=new Promise(this[c])}return this[l]=t}},Symbol.asyncIterator,function(){return this}),r(e,"return",function(){var e=this;return new Promise(function(t,r){e[f].destroy(null,function(e){e?r(e):t(h(void 0,!0))})})}),e),t);g.exports=function(e){var t,n=Object.create(d,(r(t={},f,{value:e,writable:!0}),r(t,o,{value:null,writable:!0}),r(t,a,{value:null,writable:!0}),r(t,s,{value:null,writable:!0}),r(t,u,{value:e._readableState.endEmitted,writable:!0}),r(t,c,{value:function(e,t){var r=n[f].read();r?(n[l]=null,n[o]=null,n[a]=null,e(h(r,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[l]=null,i(e,function(e){var t;e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code?(null!==(t=n[a])&&(n[l]=null,n[o]=null,n[a]=null,t(e)),n[s]=e):(null!==(t=n[o])&&(n[l]=null,n[o]=null,t(h(void 0,!(n[a]=null)))),n[u]=!0)}),e.on("readable",function(e){y.nextTick(p,e)}.bind(null,n)),n}}.call(this)}.call(this,n("_process"))},{"./end-of-stream":412,_process:393}],410:[function(e,t,r){"use strict";function o(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function i(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=e("buffer").Buffer,u=e("util").inspect,l=u&&u.custom||"inspect";t.exports=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.head=null,this.tail=null,this.length=0}var t,r,n;return t=e,(r=[{key:"push",value:function(e){e={data:e,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(e){e={data:e,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){var e;if(0!==this.length)return e=this.head.data,1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n=s.allocUnsafe(e>>>0),i=this.head,o=0;i;)t=i.data,r=o,s.prototype.copy.call(t,n,r),o+=i.data.length,i=i.next;return n}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?n+=i:n+=i.slice(0,e),0===(e-=o)){o===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t).data=i.slice(o);break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0===(e-=o)){o===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r).data=i.slice(o);break}++n}return this.length-=n,t}},{key:l,value:function(e,t){return u(this,i({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),n&&a(t,n),e}()},{buffer:6,util:4}],411:[function(e,t,r){!function(u){!function(){"use strict";function o(e,t){s(e,t),a(e)}function a(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,u.nextTick(s,this,e)):u.nextTick(s,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted?u.nextTick(a,r):(r._writableState.errorEmitted=!0,u.nextTick(o,r,e)):u.nextTick(o,r,e):t?(u.nextTick(a,r),t(e)):u.nextTick(a,r)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}.call(this)}.call(this,e("_process"))},{_process:393}],412:[function(e,t,r){"use strict";var m=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function v(){}t.exports=function e(t,r,n){var i,o,a,s,u,l,c,f,h,p,d,y,g;return"function"==typeof r?e(t,null,r):(i=n||v,o=!1,n=function(){if(!o){o=!0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i.apply(this,t)}},a=(r=r||{}).readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){l=!(s=!1),a||n.call(t)},f=t._readableState&&t._readableState.endEmitted,h=function(){f=!(a=!1),s||n.call(t)},p=function(e){n.call(t,e)},d=function(){var e;return a&&!f?(t._readableState&&t._readableState.ended||(e=new m),n.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new m),n.call(t,e)):void 0},y=function(){t.req.on("finish",c)},(g=t).setHeader&&"function"==typeof g.abort?(t.on("complete",c),t.on("abort",d),t.req?y():t.on("request",y)):s&&!t._writableState&&(t.on("end",u),t.on("close",u)),t.on("end",h),t.on("finish",c),!1!==r.error&&t.on("error",p),t.on("close",d),function(){t.removeListener("complete",c),t.removeListener("abort",d),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",h),t.removeListener("error",p),t.removeListener("close",d)})}},{"../../../errors":403}],413:[function(e,t,r){"use strict";t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],414:[function(u,e,t){"use strict";var l;var r=u("../../../errors").codes,s=r.ERR_MISSING_ARGS,c=r.ERR_STREAM_DESTROYED;function f(e){if(e)throw e}function h(r,e,t,n){i=n,o=!1;var i,o,a=!(n=function(){o||(o=!0,i.apply(void 0,arguments))}),s=(r.on("close",function(){a=!0}),(l=void 0===l?u("./end-of-stream"):l)(r,{readable:e,writable:t},function(e){if(e)return n(e);a=!0,n()}),!1);return function(e){var t;if(!a&&!s)return s=!0,(t=r).setHeader&&"function"==typeof t.abort?r.abort():"function"==typeof r.destroy?r.destroy():void n(e||new c("pipe"))}}function p(e){e()}function d(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var r,i,o=!(r=n).length||"function"!=typeof r[r.length-1]?f:r.pop();if((n=Array.isArray(n[0])?n[0]:n).length<2)throw new s("streams");var a=n.map(function(e,t){var r=t<n.length-1;return h(e,r,0<t,function(e){i=i||e,e&&a.forEach(p),r||(a.forEach(p),o(i))})});return n.reduce(d)}},{"../../../errors":403,"./end-of-stream":412}],415:[function(e,t,r){"use strict";var a=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,n){o=n,i=r;var i,o=null!=(t=t).highWaterMark?t.highWaterMark:o?t[i]:null;if(null==o)return e.objectMode?16:16384;if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new a(n?r:"highWaterMark",o);return Math.floor(o)}}},{"../../../errors":403}],416:[function(e,t,r){"use strict";t.exports=e("events").EventEmitter},{events:9}],417:[function(e,t,r){"use strict";(((r=t.exports=e("./lib/_stream_readable.js")).Stream=r).Readable=r).Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":404,"./lib/_stream_passthrough.js":405,"./lib/_stream_readable.js":406,"./lib/_stream_transform.js":407,"./lib/_stream_writable.js":408,"./lib/internal/streams/end-of-stream.js":412,"./lib/internal/streams/pipeline.js":414}],418:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"==typeof t||n.isEncoding!==i&&i(e))return t||e;throw new Error("Unknown encoding: "+e)}function a(e){var t;switch(this.encoding=o(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=u,t=4;break;case"base64":this.text=f,this.end=h,t=3;break;default:return this.write=p,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function u(e){var t,r=this.lastTotal-this.lastNeed,n=(t=this,128!=(192&(n=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<n.length?128!=(192&n[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<n.length&&128!=(192&n[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,r,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var r=t.charCodeAt(t.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function c(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function f(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function p(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}(r.StringDecoder=a).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},a.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(!(n<r)){var i=s(t[n]);if(0<=i)return 0<i&&(e.lastNeed=i-1),i;if(!(--n<r||-2===i)){if(0<=(i=s(t[n])))return 0<i&&(e.lastNeed=i-2),i;if(!(--n<r||-2===i)&&0<=(i=s(t[n])))return 0<i&&(2===i?i=0:e.lastNeed=i-3),i}}return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":419}],419:[function(e,t,r){"use strict";var n=e("buffer"),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(o(n,r),r.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=i(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:6}],420:[function(e,t,r){"use strict";function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j=e("punycode"),O=e("./util");function w(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=i,r.resolve=function(e,t){return i(e,!1,!0).resolve(t)},r.resolveObject=function(e,t){return e?i(e,!1,!0).resolveObject(t):t},r.format=function(e){O.isString(e)&&(e=i(e));return e instanceof w?e.format():w.prototype.format.call(e)},r.Url=w;var P=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,k=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,r=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),E=["'"].concat(r),T=["%","/","?",";","#"].concat(E),C=["/","?","#"],R=/^[+a-z0-9A-Z_-]{0,63}$/,M=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,I={javascript:!0,"javascript:":!0},A={javascript:!0,"javascript:":!0},L={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},D=e("querystring");function i(e,t,r){var n;return e&&O.isObject(e)&&e instanceof w?e:((n=new w).parse(e,t,r),n)}w.prototype.parse=function(e,t,r){if(!O.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+S(e));var n=e.indexOf("?"),n=-1!==n&&n<e.indexOf("#")?"?":"#",i=e.split(n);i[0]=i[0].replace(/\\/g,"/");var o=(o=e=i.join(n)).trim();if(!r&&1===e.split("#").length){i=k.exec(o);if(i)return this.path=o,this.href=o,this.pathname=i[1],i[2]?(this.search=i[2],this.query=t?D.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var a,n=P.exec(o);if(n&&(a=(n=n[0]).toLowerCase(),this.protocol=a,o=o.substr(n.length)),!(r||n||o.match(/^\/\/[^@\/]+@[^@\/]+/))||!(_="//"===o.substr(0,2))||n&&A[n]||(o=o.substr(2),this.slashes=!0),!A[n]&&(_||n&&!L[n])){for(var s=-1,u=0;u<C.length;u++)-1!==(l=o.indexOf(C[u]))&&(-1===s||l<s)&&(s=l);-1!==(e=-1===s?o.lastIndexOf("@"):o.lastIndexOf("@",s))&&(i=o.slice(0,e),o=o.slice(e+1),this.auth=decodeURIComponent(i));for(var l,s=-1,u=0;u<T.length;u++)-1!==(l=o.indexOf(T[u]))&&(-1===s||l<s)&&(s=l);-1===s&&(s=o.length),this.host=o.slice(0,s),o=o.slice(s),this.parseHost(),this.hostname=this.hostname||"";r="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!r)for(var c=this.hostname.split(/\./),u=0,f=c.length;u<f;u++){var h=c[u];if(h&&!h.match(R)){for(var p="",d=0,y=h.length;d<y;d++)127<h.charCodeAt(d)?p+="x":p+=h[d];if(!p.match(R)){var g=c.slice(0,u),m=c.slice(u+1),v=h.match(M);v&&(g.push(v[1]),m.unshift(v[2])),m.length&&(o="/"+m.join(".")+o),this.hostname=g.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),r||(this.hostname=j.toASCII(this.hostname));var b=this.port?":"+this.port:"",_=this.hostname||"";this.host=_+b,this.href+=this.host,r&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0])&&(o="/"+o)}if(!I[a])for(u=0,f=E.length;u<f;u++){var w,x=E[u];-1!==o.indexOf(x)&&((w=encodeURIComponent(x))===x&&(w=escape(x)),o=o.split(x).join(w))}n=o.indexOf("#"),-1!==n&&(this.hash=o.substr(n),o=o.slice(0,n)),e=o.indexOf("?");return-1!==e?(this.search=o.substr(e),this.query=o.substr(e+1),t&&(this.query=D.parse(this.query)),o=o.slice(0,e)):t&&(this.search="",this.query={}),o&&(this.pathname=o),L[a]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(b=this.pathname||"",i=this.search||"",this.path=b+i),this.href=this.format(),this},w.prototype.format=function(){var e=this.auth||"",t=(e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@"),this.protocol||""),r=this.pathname||"",n=this.hash||"",i=!1,o="",e=(this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port)&&(i+=":"+this.port),this.query&&O.isObject(this.query)&&Object.keys(this.query).length&&(o=D.stringify(this.query)),this.search||o&&"?"+o||"");return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||L[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i=i||"",n&&"#"!==n.charAt(0)&&(n="#"+n),e&&"?"!==e.charAt(0)&&(e="?"+e),t+i+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(e=e.replace("#","%23"))+n},w.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},w.prototype.resolveObject=function(e){O.isString(e)&&((h=new w).parse(e,!1,!0),e=h);for(var t=new w,r=Object.keys(this),n=0;n<r.length;n++){var i=r[n];t[i]=this[i]}if(t.hash=e.hash,""!==e.href)if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var s=o[a];"protocol"!==s&&(t[s]=e[s])}L[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/")}else if(e.protocol&&e.protocol!==t.protocol)if(L[e.protocol]){if(t.protocol=e.protocol,e.host||A[e.protocol])t.pathname=e.pathname;else{for(var u=(e.pathname||"").split("/");u.length&&!(e.host=u.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==u[0]&&u.unshift(""),u.length<2&&u.unshift(""),t.pathname=u.join("/")}t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(h=t.pathname||"",p=t.search||"",t.path=h+p),t.slashes=t.slashes||e.slashes}else for(var l=Object.keys(e),c=0;c<l.length;c++){var f=l[c];t[f]=e[f]}else{var h=t.pathname&&"/"===t.pathname.charAt(0),p=e.host||e.pathname&&"/"===e.pathname.charAt(0),h=p||h||t.host&&e.pathname,d=h,y=t.pathname&&t.pathname.split("/")||[],u=e.pathname&&e.pathname.split("/")||[],g=t.protocol&&!L[t.protocol];if(g&&(t.hostname="",t.port=null,t.host&&(""===y[0]?y[0]=t.host:y.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===u[0]?u[0]=e.host:u.unshift(e.host)),e.host=null),h=h&&(""===u[0]||""===y[0])),p)t.host=(e.host||""===e.host?e:t).host,t.hostname=(e.hostname||""===e.hostname?e:t).hostname,t.search=e.search,t.query=e.query,y=u;else if(u.length)(y=y||[]).pop(),y=y.concat(u),t.search=e.search,t.query=e.query;else if(!O.isNullOrUndefined(e.search))return g&&(t.hostname=t.host=y.shift(),_=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=_.shift(),t.host=t.hostname=_.shift()),t.search=e.search,t.query=e.query,O.isNull(t.pathname)&&O.isNull(t.search)||(t.path=(t.pathname||"")+(t.search||"")),t.href=t.format(),t;if(y.length){for(var m=y.slice(-1)[0],p=(t.host||e.host||1<y.length)&&("."===m||".."===m)||""===m,v=0,b=y.length;0<=b;b--)"."===(m=y[b])?y.splice(b,1):".."===m?(y.splice(b,1),v++):v&&(y.splice(b,1),v--);if(!h&&!d)for(;v--;)y.unshift("..");!h||""===y[0]||y[0]&&"/"===y[0].charAt(0)||y.unshift(""),p&&"/"!==y.join("/").substr(-1)&&y.push("");var _,d=""===y[0]||y[0]&&"/"===y[0].charAt(0);g&&(t.hostname=t.host=!d&&y.length?y.shift():"",_=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=_.shift(),t.host=t.hostname=_.shift()),(h=h||t.host&&y.length)&&!d&&y.unshift(""),y.length?t.pathname=y.join("/"):(t.pathname=null,t.path=null),O.isNull(t.pathname)&&O.isNull(t.search)||(t.path=(t.pathname||"")+(t.search||"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes}else t.pathname=null,t.search?t.path="/"+t.search:t.path=null}return t.href=t.format(),t},w.prototype.parseHost=function(){var e=this.host,t=n.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":421,punycode:394,querystring:397}],421:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"===n(e)&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],422:[function(e,r,t){!function(t){!function(){"use strict";function n(e){try{if(!t.localStorage)return}catch(e){return}e=t.localStorage[e];return null!=e&&"true"===String(e).toLowerCase()}r.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],423:[function(e,t,r){"use strict";t.exports=Worker},{}],424:[function(e,t,r){"use strict";function n(e,t){t=new RegExp(t,"g"),e=e.match(t);return e?e.length:0}t.exports=n,t.exports.default=n},{}],425:[function(e,t,r){"use strict";function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=e("./index-of-match.js"),d=e("./index-of-match-end.js"),y=e("./count-substring.js");function n(e,t,r){var n=r&&r.debug||!1,i=!(r&&!1===h(r.nested)),o=r&&r.startIndex||0,r=(n&&console.log("[xml-utils] starting findTagByName with",t," and ",r),p(e,"<".concat(t,"[ >/]"),o));if(n&&console.log("[xml-utils] start:",r),-1!==r){var a=e.slice(r+t.length),s=d(a,"^[^<]*[ /]>",0),o=-1!==s&&"/"===a[s-1];if(n&&console.log("[xml-utils] selfClosing:",o),!1==o)if(i)for(var u=0,l=1,c=0;-1!==(s=d(a,"[ /]"+t+">",u));){var f=a.substring(u,s+1);if((l+=y(f,"<"+t))<=(c+=y(f,"/"+t+">")))break;u=s}else s=d(a,"[ /]"+t+">",0);i=r+t.length+s+1;if(n&&console.log("[xml-utils] end:",i),-1!==i)return n=e.slice(r,i),{inner:o?null:n.slice(n.indexOf(">")+1,n.lastIndexOf("<")),outer:n,start:r,end:i}}}t.exports=n,t.exports.default=n},{"./count-substring.js":424,"./index-of-match-end.js":428,"./index-of-match.js":429}],426:[function(e,t,r){"use strict";var u=e("./find-tag-by-name.js");function n(e,t,r){for(var n,i=[],o=r&&r.debug||!1,a=!r||"boolean"!=typeof r.nested||r.nested,s=r&&r.startIndex||0;n=u(e,t,{debug:o,startIndex:s});)s=a?n.start+1+t.length:n.end,i.push(n);return o&&console.log("findTagsByName found",i.length,"tags"),i}t.exports=n,t.exports.default=n},{"./find-tag-by-name.js":425}],427:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r){r=r&&r.debug||!1,r&&console.log("getting "+t+" in "+e),e="object"===n(e)?e.outer:e,t="".concat(t,'\\="([^"]*)"');r&&console.log("pattern:",t);t=new RegExp(t).exec(e);if(r&&console.log("match:",t),t)return t[1]}t.exports=i,t.exports.default=i},{}],428:[function(e,t,r){"use strict";function n(e,t,r){t=new RegExp(t).exec(e.slice(r));return t?r+t.index+t[0].length-1:-1}t.exports=n,t.exports.default=n},{}],429:[function(e,t,r){"use strict";function n(e,t,r){t=new RegExp(t).exec(e.slice(r));return t?r+t.index:-1}t.exports=n,t.exports.default=n},{}],430:[function(e,t,r){"use strict";t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r,n=arguments[t];for(r in n)i.call(n,r)&&(e[r]=n[r])}return e};var i=Object.prototype.hasOwnProperty},{}],431:[function(e,t,r){"use strict";function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){O=function(){return a};var a={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i,o,a,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return l(t,"_invoke",{value:(i=e,o=r,a=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return S()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=c(i,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function h(){}function p(){}function d(){}var t={},y=(o(t,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(x([]))),g=(y&&y!==e&&u.call(y,n)&&(t=y),d.prototype=h.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;l(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,i){var o,e=c(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=d,configurable:!0}),l(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(s(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(g),o(g,i,"Generator"),o(g,n,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}t.exports=function(e){e.prototype[Symbol.iterator]=O().mark(function e(){var t;return O().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(t)return e.next=4,t.value;e.next=7;break;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}},e,this)})}},{}],432:[function(e,t,r){"use strict";function o(e){var t=this;if((t=t instanceof o?t:new o).tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(0<arguments.length)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this).prev=t:this.prev=null,r?(r.prev=this).next=r:this.next=null}(t.exports=o).Node=a,(o.create=o).prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},o.prototype.unshiftNode=function(e){var t;e!==this.head&&(e.list&&e.list.removeNode(e),t=this.head,e.list=this,(e.next=t)&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++)},o.prototype.pushNode=function(e){var t;e!==this.tail&&(e.list&&e.list.removeNode(e),t=this.tail,e.list=this,(e.prev=t)&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++)},o.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++){n=r=void 0;var r=this,n=arguments[e];r.tail=new a(n,r.tail,null,r),r.head||(r.head=r.tail),r.length++}return this.length},o.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++){n=r=void 0;var r=this,n=arguments[e];r.head=new a(n,null,r.head,r),r.tail||(r.tail=r.head),r.length++}return this.length},o.prototype.pop=function(){var e;if(this.tail)return e=this.tail.value,this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e},o.prototype.shift=function(){var e;if(this.head)return e=this.head.value,this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e},o.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},o.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},o.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},o.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},o.prototype.map=function(e,t){t=t||this;for(var r=new o,n=this.head;null!==n;)r.push(e.call(t,n.value,this)),n=n.next;return r},o.prototype.mapReverse=function(e,t){t=t||this;for(var r=new o,n=this.tail;null!==n;)r.push(e.call(t,n.value,this)),n=n.prev;return r},o.prototype.reduce=function(e,t){var r,n=this.head;if(1<arguments.length)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},o.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(1<arguments.length)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},o.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},o.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},o.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new o;if(!(t<e||t<0)){e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;for(;null!==i&&n<t;n++,i=i.next)r.push(i.value)}return r},o.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new o;if(!(t<e||t<0)){e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;null!==i&&t<n;n--)i=i.prev;for(;null!==i&&e<n;n--,i=i.prev)r.push(i.value)}return r},o.prototype.splice=function(e,t){(e=e>this.length?this.length-1:e)<0&&(e=this.length+e);for(var r=0,n=this.head;null!==n&&r<e;r++)n=n.next;for(var i=[],r=0;n&&r<t;r++)i.push(n.value),n=this.removeNode(n);(n=null===n?this.tail:n)!==this.head&&n!==this.tail&&(n=n.prev);for(r=0;r<(arguments.length<=2?0:arguments.length-2);r++)n=function(e,t,r){r=t===e.head?new a(r,null,t,e):new a(r,t,t.next,e);null===r.next&&(e.tail=r);null===r.prev&&(e.head=r);return e.length++,r}(this,n,r+2<2||arguments.length<=r+2?void 0:arguments[r+2]);return i},o.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{e("./iterator.js")(o)}catch(e){}},{"./iterator.js":431}]},{},[1]),!function(F,N){"use strict";var t;function r(e){var t=null,r=!0,o=F.extend(!0,{},e),i=250,n={},a=!!F(".light").length;function s(e,t){var r=F("body");o.utils.trigger(r,e,t)}function u(){return o.utils.t.apply(this,arguments)}function l(){var e=o.system.adsense.parameters;window.adsbygoogle=window.adsbygoogle||[],F("ins.adsbygoogle").each(function(){window.adsbygoogle.push({params:F.extend({},e)})})}function c(){var e=window.location.hash.replace("#",""),t=F("#p-donate"),r=F("#p-loading"),n=r.find(".progressbar"),i=F(".progress-label");F(".section, .searchbtn").addClass("ui-corner-all"),F(".view").addClass("ui-corner-br ui-corner-tr"),F(".search-field").addClass("ui-corner-bl ui-corner-tl"),F("#p-poll").dialog({closeText:u("close"),modal:!0,title:u("poll"),width:a?"95%":500,open:function(){E("poll")},close:function(){k()},autoOpen:"poll"==e}),o.system.raterMasterSw&&!o.context.session.userHasRatedOne&&S(!1),F("#p-contact").dialog({closeText:u("close"),modal:!0,title:u("contactUs"),width:a?"95%":500,open:function(){E("contact")},close:function(){k()},autoOpen:"contact"==e}),F(".contact-button").button({icons:{secondary:"ui-icon-mail-closed"}}),t.find("input.dont-show-again").prop("checked",M("p-donate")),F(".help-1").find("input.dont-show-again").prop("checked",M("help-1")),t.dialog({closeText:u("close"),modal:!0,title:u("donate"),width:a?"95%":750,open:function(){E("donate")},close:function(){k()},autoOpen:"donate"==e}),t.find(".progressbar").progressbar({value:o.donations.total,max:o.donations.max}),n.progressbar({value:!1,change:function(){i.text(Math.round(n.progressbar("value"))+"%")},complete:function(){i.text("Complete!")}}),F("#p-about").dialog({closeText:u("close"),modal:!0,title:u("about"),width:a?"95%":"70%",open:function(){E("about")},close:function(){k()},autoOpen:"about"==e}),F("body").on("history.indexchanged",function(e,t){t=t.data;A(t.currentIndex,t.maxIndex)}),F("#p-info").dialog({closeText:u("close"),modal:!0,title:"Information",width:a?"95%":750,autoOpen:!0}),F("#csvFeatures").hide(),F("#language").find(">dt>a").button({icons:{secondary:"ui-icon-triangle-1-s"}}),o.system.facebookEnabled&&(window.fbAsyncInit=function(){FB.init({appId:o.system.facebookAppId,xfbml:!0,version:"v2.2"})},F.fn.getXDomain({url:"http://connect.facebook.net/"+o.context.locale+"/sdk.js"})),r.dialog({dialogClass:"no-close",modal:!0,title:u("loading"),autoOpen:!0}),F(".ui-widget-overlay").css({backgroundImage:"none",opacity:.7})}function f(e){return e.closest(".converter-container").hasClass("source")?"source":"destination"}function h(){var e=F("a.snippet"),t=F("#converter"),r=F("body");e.on("mouseenter",function(){F("body").append('<div id="Tip" style="z-index:9999;" class="ui-corner-all"><img src="'+this.href+'" alt="'+this.href+'"></div>')}),e.on("mousemove",function(e){F("#Tip").css({left:e.pageX+16,top:e.pageY+16}).show()}),e.on("mouseout",function(){F("#Tip").remove()}),e.click(function(e){e.preventDefault()}),F(".search-crs").click(function(e){var t=f(F(this));e.preventDefault(),F("#select").val(t),F("#p-research").dialog("open")}),t.on("converter.info",P),t.on("click",".show-p-new",function(e){var t=f(F(this));e.preventDefault(),F('#new-form input[name="target"]').val(t),F("#p-new").dialog("open")}),r.on("click","#view-reference",function(e){var t="http://spatialreference.org/ref/?search="+encodeURIComponent(F("#find-reference").val());e.preventDefault(),window.open(t)}),r.on("submit","#reference-form",function(e){e.preventDefault(),F("#view-reference").click()}),F("#crsResult").on("change",function(e){var e=F(e.target).val(),t=F("#select").val();F("#closeSearch").prop("checked")&&F("#p-research").dialog("close"),App.TWCCConverter.setSelection(t,e)}),F("#research").click(function(e){var t;e.preventDefault(),(t=F("#crsResult")).html('<option value="#" class="disabledoption">'+u("loading")+"</option>").prop("disabled",!0),F.post(o.system.httpServer+"/"+o.system.dirWsIncludes+"c.php",{l:o.context.languageCode,i:F("#crsCountry").val(),c:F("#crsCode").val(),n:F("#crsName").val(),f:""}).done(function(e){t.html(""),F(e).length?(t.prop("disabled",!1),F.each(e,function(r,e){F.each(e,function(e,t){o.utils.addOptionToSelect(r,e,F("#crsResult"),t.def)})})):t.append(F("<option>",{val:"",text:u("resultEmpty"),classname:"disabledoption"}))}).fail(function(){t.html(""),t.append(F("<option>",{val:"",text:u("resultEmpty"),classname:"disabledoption"}))})}),new N("#converter .octicon-clippy",{text:function(e){e=F(e).closest(".converter-container");if(e.length)return e.converter("value").toString()}}).on("success",function(e){F(e.trigger).animate({opacity:.3},500,function(){F(this).animate({opacity:1},500)}),s("clipboard.aftercopy")})}function p(){a||(F("#help").animate({opacity:"hide"},i),F(".crs-list").first().btOn())}function d(e){I(e),s("ui.csv_changed",e)}function y(){F(".convention").click(function(e){e.preventDefault(),F("#p-convention_help").dialog("open")}),F("#full-screen").click(function(e){e.preventDefault(),s("ui.full_screen")}),F("#auto-zoom-toggle").click(function(){o.utils.enableAutoZoom(F(this).is(":checked"))}),F('input[name="csv"]').click(function(){d(!!+F(this).val())}),F('input[name="convention"]').click(function(){var e;e=!!+F(this).val(),r=e,s("ui.convergence_changed")}),F("body").on("converterset.csv_changed main.ready",function(e,t){var r,t=(void 0===t.data?t:t.data).csv;(r=t)!==!!+F('input[name="csv"]:checked').val()&&(F('input[name="csv"][value="'+ +r+'"]').prop("checked",!0),F(".csv-radio").buttonset("refresh")),I(t)})}function g(){var e=F("body");F(".toggle-next").click(function(e){e.preventDefault(),F(this).parent().find(".toogle-me").toggle()}),F(document).on("fullscreenchange",function(){C(),!a&&F(document).fullScreen()?F(".trsp-panel, .spare, #converter, #h-container").fadeOut():F(".trsp-panel, .spare, #converter, #h-container").fadeIn()}),F(document).on("mousemove",function(e){var t;e=e.target,t=".trsp-panel, #converter",!a&&F(document).fullScreen()&&(F(t).is(":hidden")?F(t).fadeIn():F(e).closest(t).length?clearInterval(n[t]):(clearInterval(n[t]),n[t]=setTimeout(function(){F(document).fullScreen()&&F(t).fadeOut()},1e3)))}),e.on("click",".show-p-poll",function(e){e.preventDefault(),S()}),e.on("mousedown","#view-map, .donate_btn, .about, converter.info, .convert-button, .contact, .search-crs, .show-p-new",function(){C()}),e.on("map.metrics_changed",function(e,t){w(t.data)}),e.on("map.tiles_loaded",function(){l()}),e.on("converter.changed",function(e,t){t=t.data.magneticDeclinationInDegrees;t=void 0===t?"":o.math.round(t,4).toString(),F("#magneticDeclinationContainer").text(t)}),F("#p-donate").find("input.dont-show-again").on("change",function(){R("p-donate",F(this)[0].checked)}),F(".donate_btn").click(function(e){e.preventDefault(),F("#p-donate").dialog("open")}),F(".about").click(function(e){e.preventDefault(),F("#p-about").dialog("open")}),e.one("main.ready",function(){setTimeout(b,800),a&&l()}),e.on("main.start",_),e.on("main.failed",{message:": failure! "+u("contactUs"),className:"failure"},function(){_.apply(this,arguments),b()}),e.on("main.succeeded",{message:": success.",className:"success"},function(){var e=F("#p-loading").find(".progressbar"),t=e.progressbar("value")||0;_.apply(this,arguments),e.progressbar("value",t+20)}),e.on("click",".ui-widget-overlay",function(){C()})}function m(e){F(".contact").click(function(e){e.preventDefault(),F("#p-contact").dialog("open")}),e||(F("#contact-form").on("submit",function(e){e.preventDefault(),F("#send-message").click()}),F("#send-message").click(function(e){e.preventDefault(),F("#p-contact").dialog("close"),function(){if(F("#message").val().length<1)return alert(u("messageNotSent")+"empty msg."),void F("#p-contact").dialog("open");if(F("#email").val().length<1)return alert(u("messageWrongEmail")),void F("#p-contact").dialog("open");return 1}()&&o.utils.sendMsg(F("#message").val(),F("#email").val(),T)}))}function v(){var e,t,r,n;F(".previous.history").button({icons:{primary:"ui-icon-seek-first"},text:!1}),F("#help").button({icons:{primary:"ui-icon-help"},text:!1}),F(".next.history").button({icons:{primary:"ui-icon-seek-end"},text:!1}),F(".source .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-s"}}),F(".destination .convert-button").button({icons:{primary:"ui-icon-arrowthick-1-n"}}),F("#converter").draggable({handle:".drag-handle"}),F('input[type="text"]',"#p-research").addClass("ui-corner-all"),F("#p-new").dialog({closeText:u("close"),modal:!0,title:u("customSystem"),width:a?"95%":400,autoOpen:!1}),F("#p-crs").dialog({closeText:u("close"),modal:!0,title:u("systemDefinition"),width:a?"95%":500,autoOpen:!1}),F("#p-research").dialog({closeText:u("close"),modal:!0,title:u("research"),width:a?"95%":400,autoOpen:!1}),A(0,0),F(".button-set").buttonset(),F("#auto-zoom-toggle").button({icons:{primary:"ui-icon-zoomin"},text:!1,disabled:!0}),a||F("#full-screen").button({icons:{primary:"ui-icon-arrow-4-diag"},text:!1}).closest("p").toggle(null!==F(document).fullScreen()),F("#o-container").accordion({collapsible:!0,active:!1,heightStyle:"content",icons:{header:"ui-icon-gear"}}),F("#p-convention_help").dialog({closeText:u("close"),modal:!0,title:u("conventionTitle"),width:a?"95%":840,autoOpen:!1}),e={trigger:"none",showTip:function(e){F(e).fadeIn(i)},hideTip:function(e,t){F(e).animate({opacity:0},i,t)},shrinkToFit:!0,padding:"0px",windowMargin:"0px",fill:"rgba(0, 0, 0, .9)",cornerRadius:10,strokeWidth:1,shadow:!0,shadowOffsetX:3,shadowOffsetY:3,shadowBlur:3,shadowColor:"rgba(6,6,6,.5)",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#666",strokeWidth:1},positions:["left","top"],cssStyles:{color:"#FFF"},closeWhenOthersOpen:!0,clickAnywhereToClose:!1},t=F(".crs-list"),F.extend(F.bt.defaults,e),t.first().bt({contentSelector:"$('.help-1')"}),t.last().bt({contentSelector:"$('.help-2')"}),F(".source .container").bt({contentSelector:"$('.help-3')"}),F(".source .convert-button").bt({contentSelector:"$('.help-4')"}),F(".next_button").button({icons:{secondary:"ui-icon-seek-next"}}),c(),h(),y(),F(".close_button, .help-4 .next_button").click(function(e){e.preventDefault(),F("#help").animate({opacity:"show"},i)}),F(".next_button").click(function(e){e.preventDefault()}),F(".close_button",".help-1").click(function(){F(".crs-list").first().btOff()}),F(".close_button",".help-2").click(function(){F(".crs-list").last().btOff()}),F(".close_button",".help-3").click(function(){F(".source .container").btOff()}),F(".close_button, .next_button",".help-4").click(function(){F(".source .convert-button").btOff()}),F(".next_button",".help-1").click(function(){F(".crs-list").last().btOn()}),F(".next_button",".help-2").click(function(){F(".source .container").btOn()}),F(".next_button",".help-3").click(function(){F(".source .convert-button").btOn()}),F(".help-1").find("input.dont-show-again").on("change",function(){R("help-1",F(this)[0].checked)}),F("#help").click(function(){event.preventDefault(),p()}),g(),m(),r=F(".dropdown dd ul"),(n=F(".dropdown dt a")).click(function(e){e.preventDefault(),r.slideToggle(200)}),r.find("li a").click(function(e){e.preventDefault(),e=F(this).html(),F(this).parent().find("span.value").text(),n.find("span").html(e),r.hide(),document.location.href=F(this).prop("href")}),F(document).click(function(e){F(e.target).parents().hasClass("dropdown")||r.hide()}),F(document).keyup(function(e){switch(e.keyCode){case 27:e.preventDefault(),C();break;case 122:e.preventDefault(),s("ui.full_screen")}})}function b(){var e=F("#p-loading");e.find(".failure").length?e.closest(".no-close").find(".ui-dialog-titlebar-close").show():(e.dialog("close"),M("p-donate")||o.context.GET.isSetNoDonate||F("#p-donate").dialog("open")),F(".ui-widget-overlay").removeAttr("style")}function _(e,t){var t=t.data,r=t.name,n=F("#p-loading .logs"),i="loading-"+r.toLowerCase().replace(/\s/gi,"-"),e=e.data,t=t.message?": "+t.message:e?e.message:void 0;n.find("."+i).length||(r=F("<div>",{class:i}).text("Loading "+r),n.append(r)),r=n.find("."+i),e&&t&&e.className&&r.length&&!r.hasClass(e.className)&&r.addClass(e.className).append(t)}function w(e){var t,r,n;void 0!==e&&(t=e.length,r=u("unitMeter"),n=0,t&&void 0!==t?(999<t&&(r=u("unitKilometer"),t/=1e3,n=1),F("#lengthContainer").text(o.math.round(t,n).toString()+r)):F("#lengthContainer").text("-"+r),t=e.area,n=u("unitMeter")+"<sup>2</sup>",r=0,t&&void 0!==t?(999999<t&&(n=u("unitKilometer")+"<sup>2</sup>",t/=1e6,r=1),F("#areaContainer").html(o.math.round(t,r).toString()+n)):F("#areaContainer").html("-"+n))}function x(){return'<div class="loading"><img src="'+o.system.dirWsImages+'loading.gif" alt="" width="35" height="35">'+u("loading")+"</div>"}function S(e){e=void 0===e||e,F("#poll-info").html(x()),e&&C(),F("#p-poll").dialog("open"),j()}function j(e){e=e||"",F("#poll-info").html(x()),F.post(o.system.dirWsModules+"rater/forms.php","rater=true&"+e,O)}function O(e){var t=F("#poll-info");t.html(e),t.find("form").each(function(){F(this).on("submit",function(e){e.preventDefault(),j(F(this).serialize())}),m(!0)})}function P(e,t){var r=F("#crs-info");r.html(x()),F.post(o.system.dirWsIncludes+"crs_info.php",{c:t.srsCode,d:t.definitionString,l:o.context.languageCode},function(e){r.html(e)}),F("#p-crs").dialog("open")}function k(){window.location.hash=""}function E(e){window.location.hash="#"+e}function T(e){switch(e){case"1":alert(u("messageSent"));break;case"-3":alert(u("messageWrongEmail"));break;default:alert(u("messageNotSent")+e)}"1"==e?(F("#email").val(""),F("#message").val("")):F("#p-contact").dialog("open")}function C(){F(".crs-list, .source .container, .source .convert-button").each(function(){F(this).btOff()}),F("#help").animate({opacity:"show"},i),F("#p-new").dialog("close"),F("#p-contact").dialog("close"),F("#p-about").dialog("close"),F("#p-crs").dialog("close"),F("#p-poll").dialog("close"),F("#p-info").dialog("close"),F("#p-donate").dialog("close"),F("#p-research").dialog("close"),F("#p-convention_help").dialog("close")}function R(e,t){o.utils.setPreferenceCookie(e,t)}function M(e){return o.utils.getPreferenceCookie(e)}function I(e){e=!!e,F("#manualFeatures").toggle(!e),F("#csvFeatures").toggle(e),e?(F("#auto-zoom-toggle").button("enable"),F(".convention-radio").buttonset("disable"),w()):(F("#auto-zoom-toggle").button("disable"),F(".convention-radio").buttonset("enable"))}function A(e,t){t=e<t,e=0<e;F(".previous.history").button("option","disabled",!e),F(".next.history").button("option","disabled",!t)}function L(){t.resolve()}function D(){var e;!App.system.adsense.bannerAdsEnabled||(e=window.adsbygoogle)&&e.loaded?L():t.reject(u("pleaseDisableYourAdblock"))}return t=function(){return o.utils.newDeferred.apply(this,arguments)}("UI"),v(),a?t.resolve():F(window).load(D),{promise:t.promise(),getConvergenceConvention:function(){return r},startHelp:function(){M("help-1")||p()},setCsvMode:d}}void 0===window.TWCCUi&&(window.TWCCUi={getInstance:function(e){return t=t||r(e)}})}(jQuery,ClipboardJS),!function(_){"use strict";var t,r;void 0===window.TWCCConverter&&(r=function(e){var t,r,n,i,o,a,s,u=null,f=null,h=0,p=_.extend(!0,{},e);function d(){return p.utils.t.apply(this,arguments)}function l(e){return d("errorContactUs").replace("%s",e.status.toString())}function y(n,i){var o="",a=new RegExp("\\+title=[^\\+]+","i");return""===n?"":(n=n.toString().replace(a,""),_.each(f.options.definitions,function(r,e){if(_.each(e,function(e,t){t=t.def||"";if(e.toUpperCase()==n.toUpperCase()||t.toUpperCase().replace(a,"")==n.toUpperCase())return o=d("crsAlreadyExists")+r+" > "+(t?p.utils.getTitleFromDefinitionString(t,e):e),b(i,e),!1}),""!==o)return!1}),o)}function g(e,t){alert(e),_("#loadingxtra").hide(),_("#new-form").show(),t?h--:(_("#p-new").dialog("close"),_("#find-reference").val(""),_("#add-reference").val(""))}function m(e,t,r){var n=e.split(":");return r=r||!1,t.replace(/\$\{\d\}/gi,function(e){e=e.match(/\d+/)[0];e=n[e]||e;return r?e.toUpperCase():e.toLowerCase()})}function v(e,t,r){window.Proj4js={defs:{}},t(r).done(function(){c(Proj4js.defs[e])}).fail(function(e){g(l(e),!0)}).always(function(){delete window.Proj4js})}function c(r){var n,e,i,o=_("#new-form input[name='target']").val(),t=r.toUpperCase(),a=0===t.indexOf("EPSG:"),s=0===t.indexOf("ESRI:"),u=0===t.indexOf("IAU2000:"),l=0===t.indexOf("SR-ORG:"),c=0===t.indexOf("IGNF:");_("#new-form").hide(),_("#loadingxtra").show(),(e=y(r,o))?g(e):a||s||u||l?(s=m(a=n=t,"http://spatialreference.org/ref/${0}/${1}/proj4js/"),window.Proj4js={defs:{}},v(a,_.fn.getXDomain,{url:s})):c?(l=m(u=n=t,"/js/data/defs/${0}${1}.js",!0),v(u,_.ajax,{url:l,cache:!0,dataType:"script"})):(null!==(a=r.match(new RegExp('^[^\\[]+\\["([^\\]]+)"\\][\\s=]+"([^"]+)";$',"i")))&&(r=a[2]),s=p.utils.getTitleFromDefinitionString(r,""),n="UD"+ ++h,void 0===s&&(s=d("undefinedTitle"),r="+title="+s+" "+r),i=n+" "+s,r=r.replace("+title="+s,"+title="+i),(e=(e=y(n,o))||y(r,o))?g(e):(c=r,t=n,(u={"*[UD]":{}})["*[UD]"][t]={def:c,isConnector:!1},f.mergeDefinitions(u).done(function(){_("#loadingxtra").hide(),_("#new-form").show();var t=b(o);try{b(o,n),alert(d("newSystemAdded")+'"'+i+'".'),_("#p-new").dialog("close"),_("#find-reference").val(""),_("#add-reference").val(""),p.utils.sendMsg("New user-defined system:\n\r"+n+' = "'+r+'"')}catch(e){h--,b(o,t),t=n,f.unloadCRS(t),""===r?alert(d("errorContactUs").replace("%s","-2 (NotFound)")):alert(d("errorContactUs").replace("%s","-1 (WrongFormat:"+r+")"))}})))}function b(e,t){e="pushPull"+(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1);return f[e]("selection",t)}return e=p.context.converter,t=e.defaultSourceSrs,r=e.defaultDestSrs,n=e.defaultWgs84,i=!(""===n||""===n.x||""===n.y),o=_("#converter"),a=_("body"),s={units:{dms:{D:d("unitDegree"),M:d("unitMinute"),S:d("unitSecond")},dd:{x:{DD:d("unitDegreeEast")},y:{DD:d("unitDegreeNorth")}},cartesian:{XY:{m:d("unitMeter"),km:d("unitKilometer"),"us-ft":d("unitFeet")},CONVERGENCE:d("unitDegree")}},labels:{spherical:{x:d("labelLng"),y:d("labelLat"),convergence:d("labelConvergence")},cartesian:{x:d("labelX"),y:d("labelY"),z:d("labelZone"),h:d("labelHemi"),convergence:d("labelConvergence")},csv:{csv:d("labelCsv"),l:d("labelFormat")}},options:{x:{E:d("optionE"),W:d("optionW")},y:{N:d("optionN"),S:d("optionS")},o:{_DMS:d("optionDMS"),_DM:d("optionDM"),_DD:d("optionDD")},h:{n:d("optionNorth"),s:d("optionSouth")},u:{_M:d("optionM"),_KM:d("optionKM"),_F:d("optionF")}}},e.fromUrl&&!i&&alert("Invalid URL"),n=e.fromUrl&&i?[n]:e.fromRss?[{x:10,y:10}]:null,p.context.converter.fromUrl=!1,p.context.converter.fromRss=!1,u=function(){return p.utils.newDeferred.apply(this,arguments)}("Converter"),f=o.converterSet({units:s.units,labels:s.labels,options:s.options,wgs84:n,defaultWgs84:[p.utils.getRandomCityLocation()],value:{x:0,y:0},selections:{source:t,destination:r},url:p.system.httpServer+"/"+p.system.dirWsIncludes+"c.php"}).data("twccConverterSet"),o.one("converterset.done",function(e,t){u.resolve(t)}),o.on("converterset.fail",function(e,t){t=l.call(null,t);alert(t)}),a.on("click","#new-reference",function(e){e.preventDefault(),c(_("#add-reference").val())}),a.on("submit","#new-form",function(e){e.preventDefault(),_("#new-reference").click()}),a.on("ui.convergence_changed",function(){f.setConvergence()}),a.on("ui.csv_changed",function(e,t){f.csv(t.data)}),_(".to-remove").remove(),{promise:u.promise(),converterWidget:f,setSelection:b}},window.TWCCConverter={getInstance:function(e){return t=t||r(e)}})}(jQuery),!function(e,t,h,p){"use strict";var r,n;n=t,(r=e).GoogleAnalyticsObject="ga",r.ga=r.ga||function(){(r.ga.q=r.ga.q||[]).push(arguments)},r.ga.l=+new Date,e=n.createElement("script"),n=n.getElementsByTagName("script")[0],e.async=1,e.src="//www.google-analytics.com/analytics.js",n.parentNode.insertBefore(e,n),ga("create","UA-17790812-2","auto"),ga("send","pageview"),h(t).ready(function(){function i(e,t,r,n){try{ga("send","event",e,t,r,n)}catch(e){}}function e(e,t){i("main","fails",t.data.name)}function t(e,t){i("xhr","fails",t.data)}function r(e,t){i("layer","change",t.data)}function n(e){i("select","change",h(e.target).find("option:selected").text())}function o(e){i("radio","click",h(e.target).val())}function a(e){i("radio","click",h(e.target).prop("name"))}function s(){i("clipboard","click")}function u(){i("clipboard","success")}function l(){i("converter","changed")}function c(){var e=(new Date).getTime()-p.context.startTime,t="TWCC",r="Render infowindow",n=void 0;try{ga("send","timing",t,r,e,n)}catch(e){}i("infowindow","opened")}var f;(f=h("body")).on("change",".crs-list",n),f.on("click",'#converter input[type="radio"]',o),f.on("click",'#o-container input[type="radio"]',a),f.on("click",".octicon-clippy",s),f.on("clipboard.aftercopy",u),f.on("converter.changed",l),f.on("xhr.failed",t),f.on("map.layer.change",r),f.one("infowindow.dom_ready",c),f.one("main.failed",e),f.one("main.ready",function(e,t){(void 0===t.data?t:t.data).csv&&f.off("infowindow.dom_ready",c)})})}(window,document,jQuery,App);